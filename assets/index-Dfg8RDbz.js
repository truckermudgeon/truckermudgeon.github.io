var C8=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var h0e=C8(Cr=>{function n5(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in t)){const l=Object.getOwnPropertyDescriptor(r,o);l&&Object.defineProperty(t,o,l.get?l:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();var qI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function JT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function E8(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var o=!1;try{o=this instanceof r}catch{}return o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}var OS={exports:{}},Qy={},FS={exports:{}},Hr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XI;function T8(){if(XI)return Hr;XI=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),w=Symbol.iterator;function E(Ee){return Ee===null||typeof Ee!="object"?null:(Ee=w&&Ee[w]||Ee["@@iterator"],typeof Ee=="function"?Ee:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,z={};function I(Ee,Qe,jt){this.props=Ee,this.context=Qe,this.refs=z,this.updater=jt||T}I.prototype.isReactComponent={},I.prototype.setState=function(Ee,Qe){if(typeof Ee!="object"&&typeof Ee!="function"&&Ee!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ee,Qe,"setState")},I.prototype.forceUpdate=function(Ee){this.updater.enqueueForceUpdate(this,Ee,"forceUpdate")};function L(){}L.prototype=I.prototype;function V(Ee,Qe,jt){this.props=Ee,this.context=Qe,this.refs=z,this.updater=jt||T}var B=V.prototype=new L;B.constructor=V,R(B,I.prototype),B.isPureReactComponent=!0;var W=Array.isArray,X=Object.prototype.hasOwnProperty,q={current:null},te={key:!0,ref:!0,__self:!0,__source:!0};function se(Ee,Qe,jt){var je,ft={},At=null,ht=null;if(Qe!=null)for(je in Qe.ref!==void 0&&(ht=Qe.ref),Qe.key!==void 0&&(At=""+Qe.key),Qe)X.call(Qe,je)&&!te.hasOwnProperty(je)&&(ft[je]=Qe[je]);var lt=arguments.length-2;if(lt===1)ft.children=jt;else if(1<lt){for(var bt=Array(lt),St=0;St<lt;St++)bt[St]=arguments[St+2];ft.children=bt}if(Ee&&Ee.defaultProps)for(je in lt=Ee.defaultProps,lt)ft[je]===void 0&&(ft[je]=lt[je]);return{$$typeof:t,type:Ee,key:At,ref:ht,props:ft,_owner:q.current}}function re(Ee,Qe){return{$$typeof:t,type:Ee.type,key:Qe,ref:Ee.ref,props:Ee.props,_owner:Ee._owner}}function $(Ee){return typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===t}function ce(Ee){var Qe={"=":"=0",":":"=2"};return"$"+Ee.replace(/[=:]/g,function(jt){return Qe[jt]})}var Ce=/\/+/g;function Se(Ee,Qe){return typeof Ee=="object"&&Ee!==null&&Ee.key!=null?ce(""+Ee.key):Qe.toString(36)}function Xe(Ee,Qe,jt,je,ft){var At=typeof Ee;(At==="undefined"||At==="boolean")&&(Ee=null);var ht=!1;if(Ee===null)ht=!0;else switch(At){case"string":case"number":ht=!0;break;case"object":switch(Ee.$$typeof){case t:case e:ht=!0}}if(ht)return ht=Ee,ft=ft(ht),Ee=je===""?"."+Se(ht,0):je,W(ft)?(jt="",Ee!=null&&(jt=Ee.replace(Ce,"$&/")+"/"),Xe(ft,Qe,jt,"",function(St){return St})):ft!=null&&($(ft)&&(ft=re(ft,jt+(!ft.key||ht&&ht.key===ft.key?"":(""+ft.key).replace(Ce,"$&/")+"/")+Ee)),Qe.push(ft)),1;if(ht=0,je=je===""?".":je+":",W(Ee))for(var lt=0;lt<Ee.length;lt++){At=Ee[lt];var bt=je+Se(At,lt);ht+=Xe(At,Qe,jt,bt,ft)}else if(bt=E(Ee),typeof bt=="function")for(Ee=bt.call(Ee),lt=0;!(At=Ee.next()).done;)At=At.value,bt=je+Se(At,lt++),ht+=Xe(At,Qe,jt,bt,ft);else if(At==="object")throw Qe=String(Ee),Error("Objects are not valid as a React child (found: "+(Qe==="[object Object]"?"object with keys {"+Object.keys(Ee).join(", ")+"}":Qe)+"). If you meant to render a collection of children, use an array instead.");return ht}function Fe(Ee,Qe,jt){if(Ee==null)return Ee;var je=[],ft=0;return Xe(Ee,je,"","",function(At){return Qe.call(jt,At,ft++)}),je}function Me(Ee){if(Ee._status===-1){var Qe=Ee._result;Qe=Qe(),Qe.then(function(jt){(Ee._status===0||Ee._status===-1)&&(Ee._status=1,Ee._result=jt)},function(jt){(Ee._status===0||Ee._status===-1)&&(Ee._status=2,Ee._result=jt)}),Ee._status===-1&&(Ee._status=0,Ee._result=Qe)}if(Ee._status===1)return Ee._result.default;throw Ee._result}var Te={current:null},Ie={transition:null},Ke={ReactCurrentDispatcher:Te,ReactCurrentBatchConfig:Ie,ReactCurrentOwner:q};function st(){throw Error("act(...) is not supported in production builds of React.")}return Hr.Children={map:Fe,forEach:function(Ee,Qe,jt){Fe(Ee,function(){Qe.apply(this,arguments)},jt)},count:function(Ee){var Qe=0;return Fe(Ee,function(){Qe++}),Qe},toArray:function(Ee){return Fe(Ee,function(Qe){return Qe})||[]},only:function(Ee){if(!$(Ee))throw Error("React.Children.only expected to receive a single React element child.");return Ee}},Hr.Component=I,Hr.Fragment=n,Hr.Profiler=o,Hr.PureComponent=V,Hr.StrictMode=r,Hr.Suspense=m,Hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ke,Hr.act=st,Hr.cloneElement=function(Ee,Qe,jt){if(Ee==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Ee+".");var je=R({},Ee.props),ft=Ee.key,At=Ee.ref,ht=Ee._owner;if(Qe!=null){if(Qe.ref!==void 0&&(At=Qe.ref,ht=q.current),Qe.key!==void 0&&(ft=""+Qe.key),Ee.type&&Ee.type.defaultProps)var lt=Ee.type.defaultProps;for(bt in Qe)X.call(Qe,bt)&&!te.hasOwnProperty(bt)&&(je[bt]=Qe[bt]===void 0&&lt!==void 0?lt[bt]:Qe[bt])}var bt=arguments.length-2;if(bt===1)je.children=jt;else if(1<bt){lt=Array(bt);for(var St=0;St<bt;St++)lt[St]=arguments[St+2];je.children=lt}return{$$typeof:t,type:Ee.type,key:ft,ref:At,props:je,_owner:ht}},Hr.createContext=function(Ee){return Ee={$$typeof:c,_currentValue:Ee,_currentValue2:Ee,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Ee.Provider={$$typeof:l,_context:Ee},Ee.Consumer=Ee},Hr.createElement=se,Hr.createFactory=function(Ee){var Qe=se.bind(null,Ee);return Qe.type=Ee,Qe},Hr.createRef=function(){return{current:null}},Hr.forwardRef=function(Ee){return{$$typeof:s,render:Ee}},Hr.isValidElement=$,Hr.lazy=function(Ee){return{$$typeof:b,_payload:{_status:-1,_result:Ee},_init:Me}},Hr.memo=function(Ee,Qe){return{$$typeof:y,type:Ee,compare:Qe===void 0?null:Qe}},Hr.startTransition=function(Ee){var Qe=Ie.transition;Ie.transition={};try{Ee()}finally{Ie.transition=Qe}},Hr.unstable_act=st,Hr.useCallback=function(Ee,Qe){return Te.current.useCallback(Ee,Qe)},Hr.useContext=function(Ee){return Te.current.useContext(Ee)},Hr.useDebugValue=function(){},Hr.useDeferredValue=function(Ee){return Te.current.useDeferredValue(Ee)},Hr.useEffect=function(Ee,Qe){return Te.current.useEffect(Ee,Qe)},Hr.useId=function(){return Te.current.useId()},Hr.useImperativeHandle=function(Ee,Qe,jt){return Te.current.useImperativeHandle(Ee,Qe,jt)},Hr.useInsertionEffect=function(Ee,Qe){return Te.current.useInsertionEffect(Ee,Qe)},Hr.useLayoutEffect=function(Ee,Qe){return Te.current.useLayoutEffect(Ee,Qe)},Hr.useMemo=function(Ee,Qe){return Te.current.useMemo(Ee,Qe)},Hr.useReducer=function(Ee,Qe,jt){return Te.current.useReducer(Ee,Qe,jt)},Hr.useRef=function(Ee){return Te.current.useRef(Ee)},Hr.useState=function(Ee){return Te.current.useState(Ee)},Hr.useSyncExternalStore=function(Ee,Qe,jt){return Te.current.useSyncExternalStore(Ee,Qe,jt)},Hr.useTransition=function(){return Te.current.useTransition()},Hr.version="18.3.1",Hr}var ZI;function QT(){return ZI||(ZI=1,FS.exports=T8()),FS.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YI;function P8(){if(YI)return Qy;YI=1;var t=QT(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(s,m,y){var b,w={},E=null,T=null;y!==void 0&&(E=""+y),m.key!==void 0&&(E=""+m.key),m.ref!==void 0&&(T=m.ref);for(b in m)r.call(m,b)&&!l.hasOwnProperty(b)&&(w[b]=m[b]);if(s&&s.defaultProps)for(b in m=s.defaultProps,m)w[b]===void 0&&(w[b]=m[b]);return{$$typeof:e,type:s,key:E,ref:T,props:w,_owner:o.current}}return Qy.Fragment=n,Qy.jsx=c,Qy.jsxs=c,Qy}var KI;function A8(){return KI||(KI=1,OS.exports=P8()),OS.exports}var oe=A8();const e0={grey:{50:"#FBFCFE",100:"#F0F4F8",200:"#DDE7EE",300:"#CDD7E1",400:"#9FA6AD",500:"#636B74",600:"#555E68",700:"#32383E",800:"#171A1C",900:"#0B0D0E"},blue:{50:"#EDF5FD",100:"#E3EFFB",200:"#C7DFF7",300:"#97C3F0",400:"#4393E4",500:"#0B6BCB",600:"#185EA5",700:"#12467B",800:"#0A2744",900:"#051423"},yellow:{50:"#FEFAF6",100:"#FDF0E1",200:"#FCE1C2",300:"#F3C896",400:"#EA9A3E",500:"#9A5B13",600:"#72430D",700:"#492B08",800:"#2E1B05",900:"#1D1002"},red:{50:"#FEF6F6",100:"#FCE4E4",200:"#F7C5C5",300:"#F09898",400:"#E47474",500:"#C41C1C",600:"#A51818",700:"#7D1212",800:"#430A0A",900:"#240505"},green:{50:"#F6FEF6",100:"#E3FBE3",200:"#C7F7C7",300:"#A1E8A1",400:"#51BC51",500:"#1F7A1F",600:"#136C13",700:"#0A470A",800:"#042F04",900:"#021D02"}},P_="$$joy";function s_(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function ve(){return ve=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ve.apply(null,arguments)}var H=QT();const D0=JT(H),u2=n5({__proto__:null,default:D0},[H]);function I8(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function R8(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var L8=function(){function t(n){var r=this;this._insertTag=function(o){var l;r.tags.length===0?r.insertionPoint?l=r.insertionPoint.nextSibling:r.prepend?l=r.container.firstChild:l=r.before:l=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(o,l),r.tags.push(o)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(R8(this));var o=this.tags[this.tags.length-1];if(this.isSpeedy){var l=I8(o);try{l.insertRule(r,l.cssRules.length)}catch{}}else o.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var o;return(o=r.parentNode)==null?void 0:o.removeChild(r)}),this.tags=[],this.ctr=0},t}(),aa="-ms-",p1="-moz-",di="-webkit-",r5="comm",eP="rule",tP="decl",D8="@import",i5="@keyframes",k8="@layer",z8=Math.abs,ow=String.fromCharCode,O8=Object.assign;function F8(t,e){return Hs(t,0)^45?(((e<<2^Hs(t,0))<<2^Hs(t,1))<<2^Hs(t,2))<<2^Hs(t,3):0}function o5(t){return t.trim()}function N8(t,e){return(t=e.exec(t))?t[0]:t}function fi(t,e,n){return t.replace(e,n)}function h2(t,e){return t.indexOf(e)}function Hs(t,e){return t.charCodeAt(e)|0}function a_(t,e,n){return t.slice(e,n)}function vh(t){return t.length}function nP(t){return t.length}function Xx(t,e){return e.push(t),t}function B8(t,e){return t.map(e).join("")}var sw=1,Vv=1,s5=0,rl=0,Ko=0,sy="";function aw(t,e,n,r,o,l,c){return{value:t,root:e,parent:n,type:r,props:o,children:l,line:sw,column:Vv,length:c,return:""}}function t0(t,e){return O8(aw("",null,null,"",null,null,0),t,{length:-t.length},e)}function U8(){return Ko}function $8(){return Ko=rl>0?Hs(sy,--rl):0,Vv--,Ko===10&&(Vv=1,sw--),Ko}function Vl(){return Ko=rl<s5?Hs(sy,rl++):0,Vv++,Ko===10&&(Vv=1,sw++),Ko}function Sh(){return Hs(sy,rl)}function Ub(){return rl}function A_(t,e){return a_(sy,t,e)}function l_(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function a5(t){return sw=Vv=1,s5=vh(sy=t),rl=0,[]}function l5(t){return sy="",t}function $b(t){return o5(A_(rl-1,d2(t===91?t+2:t===40?t+1:t)))}function V8(t){for(;(Ko=Sh())&&Ko<33;)Vl();return l_(t)>2||l_(Ko)>3?"":" "}function j8(t,e){for(;--e&&Vl()&&!(Ko<48||Ko>102||Ko>57&&Ko<65||Ko>70&&Ko<97););return A_(t,Ub()+(e<6&&Sh()==32&&Vl()==32))}function d2(t){for(;Vl();)switch(Ko){case t:return rl;case 34:case 39:t!==34&&t!==39&&d2(Ko);break;case 40:t===41&&d2(t);break;case 92:Vl();break}return rl}function H8(t,e){for(;Vl()&&t+Ko!==57;)if(t+Ko===84&&Sh()===47)break;return"/*"+A_(e,rl-1)+"*"+ow(t===47?t:Vl())}function G8(t){for(;!l_(Sh());)Vl();return A_(t,rl)}function W8(t){return l5(Vb("",null,null,null,[""],t=a5(t),0,[0],t))}function Vb(t,e,n,r,o,l,c,s,m){for(var y=0,b=0,w=c,E=0,T=0,R=0,z=1,I=1,L=1,V=0,B="",W=o,X=l,q=r,te=B;I;)switch(R=V,V=Vl()){case 40:if(R!=108&&Hs(te,w-1)==58){h2(te+=fi($b(V),"&","&\f"),"&\f")!=-1&&(L=-1);break}case 34:case 39:case 91:te+=$b(V);break;case 9:case 10:case 13:case 32:te+=V8(R);break;case 92:te+=j8(Ub()-1,7);continue;case 47:switch(Sh()){case 42:case 47:Xx(q8(H8(Vl(),Ub()),e,n),m);break;default:te+="/"}break;case 123*z:s[y++]=vh(te)*L;case 125*z:case 59:case 0:switch(V){case 0:case 125:I=0;case 59+b:L==-1&&(te=fi(te,/\f/g,"")),T>0&&vh(te)-w&&Xx(T>32?QI(te+";",r,n,w-1):QI(fi(te," ","")+";",r,n,w-2),m);break;case 59:te+=";";default:if(Xx(q=JI(te,e,n,y,b,o,s,B,W=[],X=[],w),l),V===123)if(b===0)Vb(te,e,q,q,W,l,w,s,X);else switch(E===99&&Hs(te,3)===110?100:E){case 100:case 108:case 109:case 115:Vb(t,q,q,r&&Xx(JI(t,q,q,0,0,o,s,B,o,W=[],w),X),o,X,w,s,r?W:X);break;default:Vb(te,q,q,q,[""],X,0,s,X)}}y=b=T=0,z=L=1,B=te="",w=c;break;case 58:w=1+vh(te),T=R;default:if(z<1){if(V==123)--z;else if(V==125&&z++==0&&$8()==125)continue}switch(te+=ow(V),V*z){case 38:L=b>0?1:(te+="\f",-1);break;case 44:s[y++]=(vh(te)-1)*L,L=1;break;case 64:Sh()===45&&(te+=$b(Vl())),E=Sh(),b=w=vh(B=te+=G8(Ub())),V++;break;case 45:R===45&&vh(te)==2&&(z=0)}}return l}function JI(t,e,n,r,o,l,c,s,m,y,b){for(var w=o-1,E=o===0?l:[""],T=nP(E),R=0,z=0,I=0;R<r;++R)for(var L=0,V=a_(t,w+1,w=z8(z=c[R])),B=t;L<T;++L)(B=o5(z>0?E[L]+" "+V:fi(V,/&\f/g,E[L])))&&(m[I++]=B);return aw(t,e,n,o===0?eP:s,m,y,b)}function q8(t,e,n){return aw(t,e,n,r5,ow(U8()),a_(t,2,-2),0)}function QI(t,e,n,r){return aw(t,e,n,tP,a_(t,0,r),a_(t,r+1,-1),r)}function Av(t,e){for(var n="",r=nP(t),o=0;o<r;o++)n+=e(t[o],o,t,e)||"";return n}function X8(t,e,n,r){switch(t.type){case k8:if(t.children.length)break;case D8:case tP:return t.return=t.return||t.value;case r5:return"";case i5:return t.return=t.value+"{"+Av(t.children,r)+"}";case eP:t.value=t.props.join(",")}return vh(n=Av(t.children,r))?t.return=t.value+"{"+n+"}":""}function Z8(t){var e=nP(t);return function(n,r,o,l){for(var c="",s=0;s<e;s++)c+=t[s](n,r,o,l)||"";return c}}function Y8(t){return function(e){e.root||(e=e.return)&&t(e)}}function c5(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var K8=function(e,n,r){for(var o=0,l=0;o=l,l=Sh(),o===38&&l===12&&(n[r]=1),!l_(l);)Vl();return A_(e,rl)},J8=function(e,n){var r=-1,o=44;do switch(l_(o)){case 0:o===38&&Sh()===12&&(n[r]=1),e[r]+=K8(rl-1,n,r);break;case 2:e[r]+=$b(o);break;case 4:if(o===44){e[++r]=Sh()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=ow(o)}while(o=Vl());return e},Q8=function(e,n){return l5(J8(a5(e),n))},eR=new WeakMap,eV=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,o=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!eR.get(r))&&!o){eR.set(e,!0);for(var l=[],c=Q8(n,l),s=r.props,m=0,y=0;m<c.length;m++)for(var b=0;b<s.length;b++,y++)e.props[y]=l[m]?c[m].replace(/&\f/g,s[b]):s[b]+" "+c[m]}}},tV=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function u5(t,e){switch(F8(t,e)){case 5103:return di+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return di+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return di+t+p1+t+aa+t+t;case 6828:case 4268:return di+t+aa+t+t;case 6165:return di+t+aa+"flex-"+t+t;case 5187:return di+t+fi(t,/(\w+).+(:[^]+)/,di+"box-$1$2"+aa+"flex-$1$2")+t;case 5443:return di+t+aa+"flex-item-"+fi(t,/flex-|-self/,"")+t;case 4675:return di+t+aa+"flex-line-pack"+fi(t,/align-content|flex-|-self/,"")+t;case 5548:return di+t+aa+fi(t,"shrink","negative")+t;case 5292:return di+t+aa+fi(t,"basis","preferred-size")+t;case 6060:return di+"box-"+fi(t,"-grow","")+di+t+aa+fi(t,"grow","positive")+t;case 4554:return di+fi(t,/([^-])(transform)/g,"$1"+di+"$2")+t;case 6187:return fi(fi(fi(t,/(zoom-|grab)/,di+"$1"),/(image-set)/,di+"$1"),t,"")+t;case 5495:case 3959:return fi(t,/(image-set\([^]*)/,di+"$1$`$1");case 4968:return fi(fi(t,/(.+:)(flex-)?(.*)/,di+"box-pack:$3"+aa+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+di+t+t;case 4095:case 3583:case 4068:case 2532:return fi(t,/(.+)-inline(.+)/,di+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(vh(t)-1-e>6)switch(Hs(t,e+1)){case 109:if(Hs(t,e+4)!==45)break;case 102:return fi(t,/(.+:)(.+)-([^]+)/,"$1"+di+"$2-$3$1"+p1+(Hs(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~h2(t,"stretch")?u5(fi(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Hs(t,e+1)!==115)break;case 6444:switch(Hs(t,vh(t)-3-(~h2(t,"!important")&&10))){case 107:return fi(t,":",":"+di)+t;case 101:return fi(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+di+(Hs(t,14)===45?"inline-":"")+"box$3$1"+di+"$2$3$1"+aa+"$2box$3")+t}break;case 5936:switch(Hs(t,e+11)){case 114:return di+t+aa+fi(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return di+t+aa+fi(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return di+t+aa+fi(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return di+t+aa+t+t}return t}var nV=function(e,n,r,o){if(e.length>-1&&!e.return)switch(e.type){case tP:e.return=u5(e.value,e.length);break;case i5:return Av([t0(e,{value:fi(e.value,"@","@"+di)})],o);case eP:if(e.length)return B8(e.props,function(l){switch(N8(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Av([t0(e,{props:[fi(l,/:(read-\w+)/,":"+p1+"$1")]})],o);case"::placeholder":return Av([t0(e,{props:[fi(l,/:(plac\w+)/,":"+di+"input-$1")]}),t0(e,{props:[fi(l,/:(plac\w+)/,":"+p1+"$1")]}),t0(e,{props:[fi(l,/:(plac\w+)/,aa+"input-$1")]})],o)}return""})}},rV=[nV],iV=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(z){var I=z.getAttribute("data-emotion");I.indexOf(" ")!==-1&&(document.head.appendChild(z),z.setAttribute("data-s",""))})}var o=e.stylisPlugins||rV,l={},c,s=[];c=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(z){for(var I=z.getAttribute("data-emotion").split(" "),L=1;L<I.length;L++)l[I[L]]=!0;s.push(z)});var m,y=[eV,tV];{var b,w=[X8,Y8(function(z){b.insert(z)})],E=Z8(y.concat(o,w)),T=function(I){return Av(W8(I),E)};m=function(I,L,V,B){b=V,T(I?I+"{"+L.styles+"}":L.styles),B&&(R.inserted[L.name]=!0)}}var R={key:n,sheet:new L8({key:n,container:c,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:m};return R.sheet.hydrate(s),R},NS={exports:{}},vi={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tR;function oV(){if(tR)return vi;tR=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,o=t?Symbol.for("react.strict_mode"):60108,l=t?Symbol.for("react.profiler"):60114,c=t?Symbol.for("react.provider"):60109,s=t?Symbol.for("react.context"):60110,m=t?Symbol.for("react.async_mode"):60111,y=t?Symbol.for("react.concurrent_mode"):60111,b=t?Symbol.for("react.forward_ref"):60112,w=t?Symbol.for("react.suspense"):60113,E=t?Symbol.for("react.suspense_list"):60120,T=t?Symbol.for("react.memo"):60115,R=t?Symbol.for("react.lazy"):60116,z=t?Symbol.for("react.block"):60121,I=t?Symbol.for("react.fundamental"):60117,L=t?Symbol.for("react.responder"):60118,V=t?Symbol.for("react.scope"):60119;function B(X){if(typeof X=="object"&&X!==null){var q=X.$$typeof;switch(q){case e:switch(X=X.type,X){case m:case y:case r:case l:case o:case w:return X;default:switch(X=X&&X.$$typeof,X){case s:case b:case R:case T:case c:return X;default:return q}}case n:return q}}}function W(X){return B(X)===y}return vi.AsyncMode=m,vi.ConcurrentMode=y,vi.ContextConsumer=s,vi.ContextProvider=c,vi.Element=e,vi.ForwardRef=b,vi.Fragment=r,vi.Lazy=R,vi.Memo=T,vi.Portal=n,vi.Profiler=l,vi.StrictMode=o,vi.Suspense=w,vi.isAsyncMode=function(X){return W(X)||B(X)===m},vi.isConcurrentMode=W,vi.isContextConsumer=function(X){return B(X)===s},vi.isContextProvider=function(X){return B(X)===c},vi.isElement=function(X){return typeof X=="object"&&X!==null&&X.$$typeof===e},vi.isForwardRef=function(X){return B(X)===b},vi.isFragment=function(X){return B(X)===r},vi.isLazy=function(X){return B(X)===R},vi.isMemo=function(X){return B(X)===T},vi.isPortal=function(X){return B(X)===n},vi.isProfiler=function(X){return B(X)===l},vi.isStrictMode=function(X){return B(X)===o},vi.isSuspense=function(X){return B(X)===w},vi.isValidElementType=function(X){return typeof X=="string"||typeof X=="function"||X===r||X===y||X===l||X===o||X===w||X===E||typeof X=="object"&&X!==null&&(X.$$typeof===R||X.$$typeof===T||X.$$typeof===c||X.$$typeof===s||X.$$typeof===b||X.$$typeof===I||X.$$typeof===L||X.$$typeof===V||X.$$typeof===z)},vi.typeOf=B,vi}var nR;function sV(){return nR||(nR=1,NS.exports=oV()),NS.exports}var BS,rR;function aV(){if(rR)return BS;rR=1;var t=sV(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};l[t.ForwardRef]=r,l[t.Memo]=o;function c(R){return t.isMemo(R)?o:l[R.$$typeof]||e}var s=Object.defineProperty,m=Object.getOwnPropertyNames,y=Object.getOwnPropertySymbols,b=Object.getOwnPropertyDescriptor,w=Object.getPrototypeOf,E=Object.prototype;function T(R,z,I){if(typeof z!="string"){if(E){var L=w(z);L&&L!==E&&T(R,L,I)}var V=m(z);y&&(V=V.concat(y(z)));for(var B=c(R),W=c(z),X=0;X<V.length;++X){var q=V[X];if(!n[q]&&!(I&&I[q])&&!(W&&W[q])&&!(B&&B[q])){var te=b(z,q);try{s(R,q,te)}catch{}}}}return R}return BS=T,BS}aV();var lV=!0;function h5(t,e,n){var r="";return n.split(" ").forEach(function(o){t[o]!==void 0?e.push(t[o]+";"):o&&(r+=o+" ")}),r}var rP=function(e,n,r){var o=e.key+"-"+n.name;(r===!1||lV===!1)&&e.registered[o]===void 0&&(e.registered[o]=n.styles)},iP=function(e,n,r){rP(e,n,r);var o=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var l=n;do e.insert(n===l?"."+o:"",l,e.sheet,!0),l=l.next;while(l!==void 0)}};function cV(t){for(var e=0,n,r=0,o=t.length;o>=4;++r,o-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(o){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var uV={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hV=/[A-Z]|^ms/g,dV=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d5=function(e){return e.charCodeAt(1)===45},iR=function(e){return e!=null&&typeof e!="boolean"},US=c5(function(t){return d5(t)?t:t.replace(hV,"-$&").toLowerCase()}),oR=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(dV,function(r,o,l){return yh={name:o,styles:l,next:yh},o})}return uV[e]!==1&&!d5(e)&&typeof n=="number"&&n!==0?n+"px":n};function c_(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var o=n;if(o.anim===1)return yh={name:o.name,styles:o.styles,next:yh},o.name;var l=n;if(l.styles!==void 0){var c=l.next;if(c!==void 0)for(;c!==void 0;)yh={name:c.name,styles:c.styles,next:yh},c=c.next;var s=l.styles+";";return s}return fV(t,e,n)}case"function":{if(t!==void 0){var m=yh,y=n(t);return yh=m,c_(t,e,y)}break}}var b=n;if(e==null)return b;var w=e[b];return w!==void 0?w:b}function fV(t,e,n){var r="";if(Array.isArray(n))for(var o=0;o<n.length;o++)r+=c_(t,e,n[o])+";";else for(var l in n){var c=n[l];if(typeof c!="object"){var s=c;e!=null&&e[s]!==void 0?r+=l+"{"+e[s]+"}":iR(s)&&(r+=US(l)+":"+oR(l,s)+";")}else if(Array.isArray(c)&&typeof c[0]=="string"&&(e==null||e[c[0]]===void 0))for(var m=0;m<c.length;m++)iR(c[m])&&(r+=US(l)+":"+oR(l,c[m])+";");else{var y=c_(t,e,c);switch(l){case"animation":case"animationName":{r+=US(l)+":"+y+";";break}default:r+=l+"{"+y+"}"}}}return r}var sR=/label:\s*([^\s;{]+)\s*(;|$)/g,yh;function I_(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,o="";yh=void 0;var l=t[0];if(l==null||l.raw===void 0)r=!1,o+=c_(n,e,l);else{var c=l;o+=c[0]}for(var s=1;s<t.length;s++)if(o+=c_(n,e,t[s]),r){var m=l;o+=m[s]}sR.lastIndex=0;for(var y="",b;(b=sR.exec(o))!==null;)y+="-"+b[1];var w=cV(o)+y;return{name:w,styles:o,next:yh}}var pV=function(e){return e()},f5=u2.useInsertionEffect?u2.useInsertionEffect:!1,p5=f5||pV,aR=f5||H.useLayoutEffect,m5=H.createContext(typeof HTMLElement<"u"?iV({key:"css"}):null);m5.Provider;var oP=function(e){return H.forwardRef(function(n,r){var o=H.useContext(m5);return e(n,o,r)})},R_=H.createContext({}),sP={}.hasOwnProperty,f2="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",mV=function(e,n){var r={};for(var o in n)sP.call(n,o)&&(r[o]=n[o]);return r[f2]=e,r},gV=function(e){var n=e.cache,r=e.serialized,o=e.isStringTag;return rP(n,r,o),p5(function(){return iP(n,r,o)}),null},vV=oP(function(t,e,n){var r=t.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var o=t[f2],l=[r],c="";typeof t.className=="string"?c=h5(e.registered,l,t.className):t.className!=null&&(c=t.className+" ");var s=I_(l,void 0,H.useContext(R_));c+=e.key+"-"+s.name;var m={};for(var y in t)sP.call(t,y)&&y!=="css"&&y!==f2&&(m[y]=t[y]);return m.className=c,n&&(m.ref=n),H.createElement(H.Fragment,null,H.createElement(gV,{cache:e,serialized:s,isStringTag:typeof o=="string"}),H.createElement(o,m))}),yV=vV,lR=function(e,n){var r=arguments;if(n==null||!sP.call(n,"css"))return H.createElement.apply(void 0,r);var o=r.length,l=new Array(o);l[0]=yV,l[1]=mV(e,n);for(var c=2;c<o;c++)l[c]=r[c];return H.createElement.apply(null,l)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(lR||(lR={}));var _V=oP(function(t,e){var n=t.styles,r=I_([n],void 0,H.useContext(R_)),o=H.useRef();return aR(function(){var l=e.key+"-global",c=new e.sheet.constructor({key:l,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),s=!1,m=document.querySelector('style[data-emotion="'+l+" "+r.name+'"]');return e.sheet.tags.length&&(c.before=e.sheet.tags[0]),m!==null&&(s=!0,m.setAttribute("data-emotion",l),c.hydrate([m])),o.current=[c,s],function(){c.flush()}},[e]),aR(function(){var l=o.current,c=l[0],s=l[1];if(s){l[1]=!1;return}if(r.next!==void 0&&iP(e,r.next,!0),c.tags.length){var m=c.tags[c.tags.length-1].nextElementSibling;c.before=m,c.flush()}e.insert("",r,c,!1)},[e,r.name]),null});function g5(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return I_(e)}function aP(){var t=g5.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var xV=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,bV=c5(function(t){return xV.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),wV=bV,SV=function(e){return e!=="theme"},cR=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?wV:SV},uR=function(e,n,r){var o;if(n){var l=n.shouldForwardProp;o=e.__emotion_forwardProp&&l?function(c){return e.__emotion_forwardProp(c)&&l(c)}:l}return typeof o!="function"&&r&&(o=e.__emotion_forwardProp),o},MV=function(e){var n=e.cache,r=e.serialized,o=e.isStringTag;return rP(n,r,o),p5(function(){return iP(n,r,o)}),null},CV=function t(e,n){var r=e.__emotion_real===e,o=r&&e.__emotion_base||e,l,c;n!==void 0&&(l=n.label,c=n.target);var s=uR(e,n,r),m=s||cR(o),y=!m("as");return function(){var b=arguments,w=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(l!==void 0&&w.push("label:"+l+";"),b[0]==null||b[0].raw===void 0)w.push.apply(w,b);else{var E=b[0];w.push(E[0]);for(var T=b.length,R=1;R<T;R++)w.push(b[R],E[R])}var z=oP(function(I,L,V){var B=y&&I.as||o,W="",X=[],q=I;if(I.theme==null){q={};for(var te in I)q[te]=I[te];q.theme=H.useContext(R_)}typeof I.className=="string"?W=h5(L.registered,X,I.className):I.className!=null&&(W=I.className+" ");var se=I_(w.concat(X),L.registered,q);W+=L.key+"-"+se.name,c!==void 0&&(W+=" "+c);var re=y&&s===void 0?cR(B):m,$={};for(var ce in I)y&&ce==="as"||re(ce)&&($[ce]=I[ce]);return $.className=W,V&&($.ref=V),H.createElement(H.Fragment,null,H.createElement(MV,{cache:L,serialized:se,isStringTag:typeof B=="string"}),H.createElement(B,$))});return z.displayName=l!==void 0?l:"Styled("+(typeof o=="string"?o:o.displayName||o.name||"Component")+")",z.defaultProps=e.defaultProps,z.__emotion_real=z,z.__emotion_base=o,z.__emotion_styles=w,z.__emotion_forwardProp=s,Object.defineProperty(z,"toString",{value:function(){return"."+c}}),z.withComponent=function(I,L){var V=t(I,ve({},n,L,{shouldForwardProp:uR(z,L,!0)}));return V.apply(void 0,w)},z}},EV=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],m1=CV.bind(null);EV.forEach(function(t){m1[t]=m1(t)});function TV(t){return t==null||Object.keys(t).length===0}function jb(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?o=>e(TV(o)?n:o):e;return oe.jsx(_V,{styles:r})}function v5(t,e){return m1(t,e)}const PV=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))};function ir(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Hf(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function y5(t){if(H.isValidElement(t)||!Hf(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=y5(t[n])}),e}function jl(t,e,n={clone:!0}){const r=n.clone?ve({},t):t;return Hf(t)&&Hf(e)&&Object.keys(e).forEach(o=>{H.isValidElement(e[o])?r[o]=e[o]:Hf(e[o])&&Object.prototype.hasOwnProperty.call(t,o)&&Hf(t[o])?r[o]=jl(t[o],e[o],n):n.clone?r[o]=Hf(e[o])?y5(e[o]):e[o]:r[o]=e[o]}),r}const AV=["values","unit","step"],IV=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>ve({},n,{[r.key]:r.val}),{})};function _5(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,o=ir(t,AV),l=IV(e),c=Object.keys(l);function s(E){return`@media (min-width:${typeof e[E]=="number"?e[E]:E}${n})`}function m(E){return`@media (max-width:${(typeof e[E]=="number"?e[E]:E)-r/100}${n})`}function y(E,T){const R=c.indexOf(T);return`@media (min-width:${typeof e[E]=="number"?e[E]:E}${n}) and (max-width:${(R!==-1&&typeof e[c[R]]=="number"?e[c[R]]:T)-r/100}${n})`}function b(E){return c.indexOf(E)+1<c.length?y(E,c[c.indexOf(E)+1]):s(E)}function w(E){const T=c.indexOf(E);return T===0?s(c[1]):T===c.length-1?m(c[T]):y(E,c[c.indexOf(E)+1]).replace("@media","@media not all and")}return ve({keys:c,values:l,up:s,down:m,between:y,only:b,not:w,unit:n},o)}const RV={borderRadius:4};function k0(t,e){return e?jl(t,e,{clone:!1}):t}const lP={xs:0,sm:600,md:900,lg:1200,xl:1536},hR={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${lP[t]}px)`};function wu(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const l=r.breakpoints||hR;return e.reduce((c,s,m)=>(c[l.up(l.keys[m])]=n(e[m]),c),{})}if(typeof e=="object"){const l=r.breakpoints||hR;return Object.keys(e).reduce((c,s)=>{if(Object.keys(l.values||lP).indexOf(s)!==-1){const m=l.up(s);c[m]=n(e[s],s)}else{const m=s;c[m]=e[m]}return c},{})}return n(e)}function x5(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,o)=>{const l=t.up(o);return r[l]={},r},{}))||{}}function b5(t,e){return t.reduce((n,r)=>{const o=n[r];return(!o||Object.keys(o).length===0)&&delete n[r],n},e)}function LV(t,...e){const n=x5(t),r=[n,...e].reduce((o,l)=>jl(o,l),{});return b5(Object.keys(n),r)}function DV(t,e){if(typeof t!="object")return{};const n={},r=Object.keys(e);return Array.isArray(t)?r.forEach((o,l)=>{l<t.length&&(n[o]=!0)}):r.forEach(o=>{t[o]!=null&&(n[o]=!0)}),n}function $S({values:t,breakpoints:e,base:n}){const r=n||DV(t,e),o=Object.keys(r);if(o.length===0)return t;let l;return o.reduce((c,s,m)=>(Array.isArray(t)?(c[s]=t[m]!=null?t[m]:t[l],l=m):typeof t=="object"?(c[s]=t[s]!=null?t[s]:t[l],l=s):c[s]=t,c),{})}function Dn(t){if(typeof t!="string")throw new Error(s_(7));return t.charAt(0).toUpperCase()+t.slice(1)}function rp(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((o,l)=>o&&o[l]?o[l]:null,t);if(r!=null)return r}return e.split(".").reduce((r,o)=>r&&r[o]!=null?r[o]:null,t)}function g1(t,e,n,r=n){let o;return typeof t=="function"?o=t(n):Array.isArray(t)?o=t[n]||r:o=rp(t,n)||r,e&&(o=e(o,r,t)),o}function Oo(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:o}=t,l=c=>{if(c[e]==null)return null;const s=c[e],m=c.theme,y=rp(m,r)||{};return wu(c,s,w=>{let E=g1(y,o,w);return w===E&&typeof w=="string"&&(E=g1(y,o,`${e}${w==="default"?"":Dn(w)}`,w)),n===!1?E:{[n]:E}})};return l.propTypes={},l.filterProps=[e],l}function kV(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const zV={m:"margin",p:"padding"},OV={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},dR={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},FV=kV(t=>{if(t.length>2)if(dR[t])t=dR[t];else return[t];const[e,n]=t.split(""),r=zV[e],o=OV[n]||"";return Array.isArray(o)?o.map(l=>r+l):[r+o]}),cP=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],uP=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...cP,...uP];function L_(t,e,n,r){var o;const l=(o=rp(t,e,!1))!=null?o:n;return typeof l=="number"?c=>typeof c=="string"?c:l*c:Array.isArray(l)?c=>typeof c=="string"?c:l[c]:typeof l=="function"?l:()=>{}}function hP(t){return L_(t,"spacing",8)}function Fm(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function NV(t,e){return n=>t.reduce((r,o)=>(r[o]=Fm(e,n),r),{})}function BV(t,e,n,r){if(e.indexOf(n)===-1)return null;const o=FV(n),l=NV(o,r),c=t[n];return wu(t,c,l)}function w5(t,e){const n=hP(t.theme);return Object.keys(t).map(r=>BV(t,e,r,n)).reduce(k0,{})}function bo(t){return w5(t,cP)}bo.propTypes={};bo.filterProps=cP;function wo(t){return w5(t,uP)}wo.propTypes={};wo.filterProps=uP;function S5(t=8){if(t.mui)return t;const e=hP({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(l=>{const c=e(l);return typeof c=="number"?`${c}px`:c}).join(" ");return n.mui=!0,n}function lw(...t){const e=t.reduce((r,o)=>(o.filterProps.forEach(l=>{r[l]=o}),r),{}),n=r=>Object.keys(r).reduce((o,l)=>e[l]?k0(o,e[l](r)):o,{});return n.propTypes={},n.filterProps=t.reduce((r,o)=>r.concat(o.filterProps),[]),n}function Ec(t){return typeof t!="number"?t:`${t}px solid`}function Lc(t,e){return Oo({prop:t,themeKey:"borders",transform:e})}const UV=Lc("border",Ec),$V=Lc("borderTop",Ec),VV=Lc("borderRight",Ec),jV=Lc("borderBottom",Ec),HV=Lc("borderLeft",Ec),GV=Lc("borderColor"),WV=Lc("borderTopColor"),qV=Lc("borderRightColor"),XV=Lc("borderBottomColor"),ZV=Lc("borderLeftColor"),YV=Lc("outline",Ec),KV=Lc("outlineColor"),cw=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=L_(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Fm(e,r)});return wu(t,t.borderRadius,n)}return null};cw.propTypes={};cw.filterProps=["borderRadius"];lw(UV,$V,VV,jV,HV,GV,WV,qV,XV,ZV,cw,YV,KV);const uw=t=>{if(t.gap!==void 0&&t.gap!==null){const e=L_(t.theme,"spacing",8),n=r=>({gap:Fm(e,r)});return wu(t,t.gap,n)}return null};uw.propTypes={};uw.filterProps=["gap"];const hw=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=L_(t.theme,"spacing",8),n=r=>({columnGap:Fm(e,r)});return wu(t,t.columnGap,n)}return null};hw.propTypes={};hw.filterProps=["columnGap"];const dw=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=L_(t.theme,"spacing",8),n=r=>({rowGap:Fm(e,r)});return wu(t,t.rowGap,n)}return null};dw.propTypes={};dw.filterProps=["rowGap"];const JV=Oo({prop:"gridColumn"}),QV=Oo({prop:"gridRow"}),ej=Oo({prop:"gridAutoFlow"}),tj=Oo({prop:"gridAutoColumns"}),nj=Oo({prop:"gridAutoRows"}),rj=Oo({prop:"gridTemplateColumns"}),ij=Oo({prop:"gridTemplateRows"}),oj=Oo({prop:"gridTemplateAreas"}),sj=Oo({prop:"gridArea"});lw(uw,hw,dw,JV,QV,ej,tj,nj,rj,ij,oj,sj);function Iv(t,e){return e==="grey"?e:t}const aj=Oo({prop:"color",themeKey:"palette",transform:Iv}),lj=Oo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Iv}),cj=Oo({prop:"backgroundColor",themeKey:"palette",transform:Iv});lw(aj,lj,cj);function Nl(t){return t<=1&&t!==0?`${t*100}%`:t}const uj=Oo({prop:"width",transform:Nl}),dP=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,o;const l=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||lP[n];return l?((o=t.theme)==null||(o=o.breakpoints)==null?void 0:o.unit)!=="px"?{maxWidth:`${l}${t.theme.breakpoints.unit}`}:{maxWidth:l}:{maxWidth:Nl(n)}};return wu(t,t.maxWidth,e)}return null};dP.filterProps=["maxWidth"];const hj=Oo({prop:"minWidth",transform:Nl}),dj=Oo({prop:"height",transform:Nl}),fj=Oo({prop:"maxHeight",transform:Nl}),pj=Oo({prop:"minHeight",transform:Nl});Oo({prop:"size",cssProperty:"width",transform:Nl});Oo({prop:"size",cssProperty:"height",transform:Nl});const mj=Oo({prop:"boxSizing"});lw(uj,dP,hj,dj,fj,pj,mj);const fw={border:{themeKey:"borders",transform:Ec},borderTop:{themeKey:"borders",transform:Ec},borderRight:{themeKey:"borders",transform:Ec},borderBottom:{themeKey:"borders",transform:Ec},borderLeft:{themeKey:"borders",transform:Ec},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Ec},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:cw},color:{themeKey:"palette",transform:Iv},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Iv},backgroundColor:{themeKey:"palette",transform:Iv},p:{style:wo},pt:{style:wo},pr:{style:wo},pb:{style:wo},pl:{style:wo},px:{style:wo},py:{style:wo},padding:{style:wo},paddingTop:{style:wo},paddingRight:{style:wo},paddingBottom:{style:wo},paddingLeft:{style:wo},paddingX:{style:wo},paddingY:{style:wo},paddingInline:{style:wo},paddingInlineStart:{style:wo},paddingInlineEnd:{style:wo},paddingBlock:{style:wo},paddingBlockStart:{style:wo},paddingBlockEnd:{style:wo},m:{style:bo},mt:{style:bo},mr:{style:bo},mb:{style:bo},ml:{style:bo},mx:{style:bo},my:{style:bo},margin:{style:bo},marginTop:{style:bo},marginRight:{style:bo},marginBottom:{style:bo},marginLeft:{style:bo},marginX:{style:bo},marginY:{style:bo},marginInline:{style:bo},marginInlineStart:{style:bo},marginInlineEnd:{style:bo},marginBlock:{style:bo},marginBlockStart:{style:bo},marginBlockEnd:{style:bo},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:uw},rowGap:{style:dw},columnGap:{style:hw},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Nl},maxWidth:{style:dP},minWidth:{transform:Nl},height:{transform:Nl},maxHeight:{transform:Nl},minHeight:{transform:Nl},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function gj(...t){const e=t.reduce((r,o)=>r.concat(Object.keys(o)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function vj(t,e){return typeof t=="function"?t(e):t}function yj(){function t(n,r,o,l){const c={[n]:r,theme:o},s=l[n];if(!s)return{[n]:r};const{cssProperty:m=n,themeKey:y,transform:b,style:w}=s;if(r==null)return null;if(y==="typography"&&r==="inherit")return{[n]:r};const E=rp(o,y)||{};return w?w(c):wu(c,r,R=>{let z=g1(E,b,R);return R===z&&typeof R=="string"&&(z=g1(E,b,`${n}${R==="default"?"":Dn(R)}`,R)),m===!1?z:{[m]:z}})}function e(n){var r;const{sx:o,theme:l={}}=n||{};if(!o)return null;const c=(r=l.unstable_sxConfig)!=null?r:fw;function s(m){let y=m;if(typeof m=="function")y=m(l);else if(typeof m!="object")return m;if(!y)return null;const b=x5(l.breakpoints),w=Object.keys(b);let E=b;return Object.keys(y).forEach(T=>{const R=vj(y[T],l);if(R!=null)if(typeof R=="object")if(c[T])E=k0(E,t(T,R,l,c));else{const z=wu({theme:l},R,I=>({[T]:I}));gj(z,R)?E[T]=e({sx:R,theme:l}):E=k0(E,z)}else E=k0(E,t(T,R,l,c))}),b5(w,E)}return Array.isArray(o)?o.map(s):s(o)}return e}const D_=yj();D_.filterProps=["sx"];function M5(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const _j=["breakpoints","palette","spacing","shape"];function fP(t={},...e){const{breakpoints:n={},palette:r={},spacing:o,shape:l={}}=t,c=ir(t,_j),s=_5(n),m=S5(o);let y=jl({breakpoints:s,direction:"ltr",components:{},palette:ve({mode:"light"},r),spacing:m,shape:ve({},RV,l)},c);return y.applyStyles=M5,y=e.reduce((b,w)=>jl(b,w),y),y.unstable_sxConfig=ve({},fw,c?.unstable_sxConfig),y.unstable_sx=function(w){return D_({sx:w,theme:this})},y}function xj(t){return Object.keys(t).length===0}function C5(t=null){const e=H.useContext(R_);return!e||xj(e)?t:e}const bj=fP();function pP(t=bj){return C5(t)}function wj({styles:t,themeId:e,defaultTheme:n={}}){const r=pP(n),o=typeof t=="function"?t(e&&r[e]||r):t;return oe.jsx(jb,{styles:o})}const Sj=["sx"],Mj=t=>{var e,n;const r={systemProps:{},otherProps:{}},o=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:fw;return Object.keys(t).forEach(l=>{o[l]?r.systemProps[l]=t[l]:r.otherProps[l]=t[l]}),r};function mP(t){const{sx:e}=t,n=ir(t,Sj),{systemProps:r,otherProps:o}=Mj(n);let l;return Array.isArray(e)?l=[r,...e]:typeof e=="function"?l=(...c)=>{const s=e(...c);return Hf(s)?ve({},r,s):r}:l=ve({},r,e),ve({},o,{sx:l})}const fR=t=>t,Cj=()=>{let t=fR;return{configure(e){t=e},generate(e){return t(e)},reset(){t=fR}}},E5=Cj();function T5(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=T5(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function co(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=T5(t))&&(r&&(r+=" "),r+=e);return r}const Ej=["className","component"];function Tj(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:o}=t,l=v5("div",{shouldForwardProp:s=>s!=="theme"&&s!=="sx"&&s!=="as"})(D_);return H.forwardRef(function(m,y){const b=pP(n),w=mP(m),{className:E,component:T="div"}=w,R=ir(w,Ej);return oe.jsx(l,ve({as:T,ref:y,className:co(E,o?o(r):r),theme:e&&b[e]||b},R))})}const P5={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function gP(t,e,n="Mui"){const r=P5[e];return r?`${n}-${r}`:`${E5.generate(t)}-${e}`}function A5(t,e,n="Mui"){const r={};return e.forEach(o=>{r[o]=gP(t,o,n)}),r}const Pj=["ownerState"],Aj=["variants"],Ij=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Rj(t){return Object.keys(t).length===0}function Lj(t){return typeof t=="string"&&t.charCodeAt(0)>96}function VS(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Dj=fP(),kj=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function Zx({defaultTheme:t,theme:e,themeId:n}){return Rj(e)?t:e[n]||e}function zj(t){return t?(e,n)=>n[t]:null}function Hb(t,e){let{ownerState:n}=e,r=ir(e,Pj);const o=typeof t=="function"?t(ve({ownerState:n},r)):t;if(Array.isArray(o))return o.flatMap(l=>Hb(l,ve({ownerState:n},r)));if(o&&typeof o=="object"&&Array.isArray(o.variants)){const{variants:l=[]}=o;let s=ir(o,Aj);return l.forEach(m=>{let y=!0;typeof m.props=="function"?y=m.props(ve({ownerState:n},r,n)):Object.keys(m.props).forEach(b=>{n?.[b]!==m.props[b]&&r[b]!==m.props[b]&&(y=!1)}),y&&(Array.isArray(s)||(s=[s]),s.push(typeof m.style=="function"?m.style(ve({ownerState:n},r,n)):m.style))}),s}return o}function I5(t={}){const{themeId:e,defaultTheme:n=Dj,rootShouldForwardProp:r=VS,slotShouldForwardProp:o=VS}=t,l=c=>D_(ve({},c,{theme:Zx(ve({},c,{defaultTheme:n,themeId:e}))}));return l.__mui_systemSx=!0,(c,s={})=>{PV(c,X=>X.filter(q=>!(q!=null&&q.__mui_systemSx)));const{name:m,slot:y,skipVariantsResolver:b,skipSx:w,overridesResolver:E=zj(kj(y))}=s,T=ir(s,Ij),R=b!==void 0?b:y&&y!=="Root"&&y!=="root"||!1,z=w||!1;let I,L=VS;y==="Root"||y==="root"?L=r:y?L=o:Lj(c)&&(L=void 0);const V=v5(c,ve({shouldForwardProp:L,label:I},T)),B=X=>typeof X=="function"&&X.__emotion_real!==X||Hf(X)?q=>Hb(X,ve({},q,{theme:Zx({theme:q.theme,defaultTheme:n,themeId:e})})):X,W=(X,...q)=>{let te=B(X);const se=q?q.map(B):[];m&&E&&se.push(ce=>{const Ce=Zx(ve({},ce,{defaultTheme:n,themeId:e}));if(!Ce.components||!Ce.components[m]||!Ce.components[m].styleOverrides)return null;const Se=Ce.components[m].styleOverrides,Xe={};return Object.entries(Se).forEach(([Fe,Me])=>{Xe[Fe]=Hb(Me,ve({},ce,{theme:Ce}))}),E(ce,Xe)}),m&&!R&&se.push(ce=>{var Ce;const Se=Zx(ve({},ce,{defaultTheme:n,themeId:e})),Xe=Se==null||(Ce=Se.components)==null||(Ce=Ce[m])==null?void 0:Ce.variants;return Hb({variants:Xe},ve({},ce,{theme:Se}))}),z||se.push(l);const re=se.length-q.length;if(Array.isArray(X)&&re>0){const ce=new Array(re).fill("");te=[...X,...ce],te.raw=[...X.raw,...ce]}const $=V(te,...se);return c.muiName&&($.muiName=c.muiName),$};return V.withConfig&&(W.withConfig=V.withConfig),W}}const Oj=I5();function R5(t,e){const n=ve({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=ve({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const o=t[r]||{},l=e[r];n[r]={},!l||!Object.keys(l)?n[r]=o:!o||!Object.keys(o)?n[r]=l:(n[r]=ve({},l),Object.keys(o).forEach(c=>{n[r][c]=R5(o[c],l[c])}))}else n[r]===void 0&&(n[r]=t[r])}),n}function Fj(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:R5(e.components[n].defaultProps,r)}function L5({props:t,name:e,defaultTheme:n,themeId:r}){let o=pP(n);return r&&(o=o[r]||o),Fj({theme:o,name:e,props:t})}const jd=typeof window<"u"?H.useLayoutEffect:H.useEffect;function Nj(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,o)=>o<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function D5(t){if(t.type)return t;if(t.charAt(0)==="#")return D5(Nj(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(s_(9,t));let r=t.substring(e+1,t.length-1),o;if(n==="color"){if(r=r.split(" "),o=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(o)===-1)throw new Error(s_(10,o))}else r=r.split(",");return r=r.map(l=>parseFloat(l)),{type:n,values:r,colorSpace:o}}const mm=t=>{const e=D5(t);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};function pR(...t){return t.reduce((e,n)=>n==null?e:function(...o){e.apply(this,o),n.apply(this,o)},()=>{})}function vP(t,e){var n,r;return H.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Hl(t){return t&&t.ownerDocument||document}function yP(t){return Hl(t).defaultView||window}function v1(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let mR=0;function Bj(t){const[e,n]=H.useState(t),r=t||e;return H.useEffect(()=>{e==null&&(mR+=1,n(`mui-${mR}`))},[e]),r}const gR=u2.useId;function il(t){if(gR!==void 0){const e=gR();return t??e}return Bj(t)}function Rv({controlled:t,default:e,name:n,state:r="value"}){const{current:o}=H.useRef(t!==void 0),[l,c]=H.useState(e),s=o?t:l,m=H.useCallback(y=>{o||c(y)},[]);return[s,m]}function yu(t){const e=H.useRef(t);return jd(()=>{e.current=t}),H.useRef((...n)=>(0,e.current)(...n)).current}function bi(...t){return H.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{v1(n,e)})},t)}const vR={};function Uj(t,e){const n=H.useRef(vR);return n.current===vR&&(n.current=t(e)),n}const $j=[];function Vj(t){H.useEffect(t,$j)}class k_{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new k_}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function w0(){const t=Uj(k_.create).current;return Vj(t.disposeEffect),t}let pw=!0,p2=!1;const jj=new k_,Hj={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Gj(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&Hj[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function Wj(t){t.metaKey||t.altKey||t.ctrlKey||(pw=!0)}function jS(){pw=!1}function qj(){this.visibilityState==="hidden"&&p2&&(pw=!0)}function Xj(t){t.addEventListener("keydown",Wj,!0),t.addEventListener("mousedown",jS,!0),t.addEventListener("pointerdown",jS,!0),t.addEventListener("touchstart",jS,!0),t.addEventListener("visibilitychange",qj,!0)}function Zj(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return pw||Gj(e)}function _P(){const t=H.useCallback(o=>{o!=null&&Xj(o.ownerDocument)},[]),e=H.useRef(!1);function n(){return e.current?(p2=!0,jj.start(100,()=>{p2=!1}),e.current=!1,!0):!1}function r(o){return Zj(o)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function Yj(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const Kj=t=>{const e=H.useRef({});return H.useEffect(()=>{e.current=t}),e.current},Jj={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function Wr(t,e,n=void 0){const r={};return Object.keys(t).forEach(o=>{r[o]=t[o].reduce((l,c)=>{if(c){const s=e(c);s!==""&&l.push(s),n&&n[c]&&l.push(n[c])}return l},[]).join(" ")}),r}function Qj(t){return typeof t=="string"}function k5(t,e,n){return t===void 0||Qj(t)?e:ve({},e,{ownerState:ve({},e.ownerState,n)})}function ps(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function yR(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function z5(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:o,className:l}=t;if(!e){const T=co(n?.className,l,o?.className,r?.className),R=ve({},n?.style,o?.style,r?.style),z=ve({},n,o,r);return T.length>0&&(z.className=T),Object.keys(R).length>0&&(z.style=R),{props:z,internalRef:void 0}}const c=ps(ve({},o,r)),s=yR(r),m=yR(o),y=e(c),b=co(y?.className,n?.className,l,o?.className,r?.className),w=ve({},y?.style,n?.style,o?.style,r?.style),E=ve({},y,n,m,s);return b.length>0&&(E.className=b),Object.keys(w).length>0&&(E.style=w),{props:E,internalRef:y.ref}}function O5(t,e,n){return typeof t=="function"?t(e,n):t}const e9=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function F5(t){var e;const{elementType:n,externalSlotProps:r,ownerState:o,skipResolvingSlotProps:l=!1}=t,c=ir(t,e9),s=l?{}:O5(r,o),{props:m,internalRef:y}=z5(ve({},c,{externalSlotProps:s})),b=bi(y,s?.ref,(e=t.additionalProps)==null?void 0:e.ref);return k5(n,ve({},m,{ref:b}),o)}function mw(t){if(parseInt(H.version,10)>=19){var e;return(t==null||(e=t.props)==null?void 0:e.ref)||null}return t?.ref||null}const N5=H.createContext(null);function xP(){return H.useContext(N5)}const t9=typeof Symbol=="function"&&Symbol.for,n9=t9?Symbol.for("mui.nested"):"__THEME_NESTED__";function r9(t,e){return typeof e=="function"?e(t):ve({},t,e)}function i9(t){const{children:e,theme:n}=t,r=xP(),o=H.useMemo(()=>{const l=r===null?n:r9(r,n);return l!=null&&(l[n9]=r!==null),l},[n,r]);return oe.jsx(N5.Provider,{value:o,children:e})}const o9=["value"],s9=H.createContext();function a9(t){let{value:e}=t,n=ir(t,o9);return oe.jsx(s9.Provider,ve({value:e??!0},n))}const l9=H.createContext(void 0);function c9({value:t,children:e}){return oe.jsx(l9.Provider,{value:t,children:e})}const _R={};function xR(t,e,n,r=!1){return H.useMemo(()=>{const o=t&&e[t]||e;if(typeof n=="function"){const l=n(o),c=t?ve({},e,{[t]:l}):l;return r?()=>c:c}return t?ve({},e,{[t]:n}):ve({},e,n)},[t,e,n,r])}function u9(t){const{children:e,theme:n,themeId:r}=t,o=C5(_R),l=xP()||_R,c=xR(r,o,n),s=xR(r,l,n,!0),m=c.direction==="rtl";return oe.jsx(i9,{theme:s,children:oe.jsx(R_.Provider,{value:c,children:oe.jsx(a9,{value:m,children:oe.jsx(c9,{value:c?.components,children:e})})})})}const bP="mode",wP="color-scheme",B5="data-color-scheme";function h9(t){const{defaultMode:e="light",defaultLightColorScheme:n="light",defaultDarkColorScheme:r="dark",modeStorageKey:o=bP,colorSchemeStorageKey:l=wP,attribute:c=B5,colorSchemeNode:s="document.documentElement",nonce:m}=t||{};return oe.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?m:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  var mode = localStorage.getItem('${o}') || '${e}';
  var colorScheme = '';
  if (mode === 'system') {
    // handle system mode
    var mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = localStorage.getItem('${l}-dark') || '${r}';
    } else {
      colorScheme = localStorage.getItem('${l}-light') || '${n}';
    }
  }
  if (mode === 'light') {
    colorScheme = localStorage.getItem('${l}-light') || '${n}';
  }
  if (mode === 'dark') {
    colorScheme = localStorage.getItem('${l}-dark') || '${r}';
  }
  if (colorScheme) {
    ${s}.setAttribute('${c}', colorScheme);
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function bR(t){if(typeof window<"u"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function U5(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function d9(t){return U5(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function HS(t,e){if(typeof window>"u")return;let n;try{n=localStorage.getItem(t)||void 0,n||localStorage.setItem(t,e)}catch{}return n||e}function f9(t){const{defaultMode:e="light",defaultLightColorScheme:n,defaultDarkColorScheme:r,supportedColorSchemes:o=[],modeStorageKey:l=bP,colorSchemeStorageKey:c=wP,storageWindow:s=typeof window>"u"?void 0:window}=t,m=o.join(","),[y,b]=H.useState(()=>{const I=HS(l,e),L=HS(`${c}-light`,n),V=HS(`${c}-dark`,r);return{mode:I,systemMode:bR(I),lightColorScheme:L,darkColorScheme:V}}),w=d9(y),E=H.useCallback(I=>{b(L=>{if(I===L.mode)return L;const V=I??e;try{localStorage.setItem(l,V)}catch{}return ve({},L,{mode:V,systemMode:bR(V)})})},[l,e]),T=H.useCallback(I=>{I?typeof I=="string"?I&&!m.includes(I)?console.error(`\`${I}\` does not exist in \`theme.colorSchemes\`.`):b(L=>{const V=ve({},L);return U5(L,B=>{try{localStorage.setItem(`${c}-${B}`,I)}catch{}B==="light"&&(V.lightColorScheme=I),B==="dark"&&(V.darkColorScheme=I)}),V}):b(L=>{const V=ve({},L),B=I.light===null?n:I.light,W=I.dark===null?r:I.dark;if(B)if(!m.includes(B))console.error(`\`${B}\` does not exist in \`theme.colorSchemes\`.`);else{V.lightColorScheme=B;try{localStorage.setItem(`${c}-light`,B)}catch{}}if(W)if(!m.includes(W))console.error(`\`${W}\` does not exist in \`theme.colorSchemes\`.`);else{V.darkColorScheme=W;try{localStorage.setItem(`${c}-dark`,W)}catch{}}return V}):b(L=>{try{localStorage.setItem(`${c}-light`,n),localStorage.setItem(`${c}-dark`,r)}catch{}return ve({},L,{lightColorScheme:n,darkColorScheme:r})})},[m,c,n,r]),R=H.useCallback(I=>{y.mode==="system"&&b(L=>{const V=I!=null&&I.matches?"dark":"light";return L.systemMode===V?L:ve({},L,{systemMode:V})})},[y.mode]),z=H.useRef(R);return z.current=R,H.useEffect(()=>{const I=(...V)=>z.current(...V),L=window.matchMedia("(prefers-color-scheme: dark)");return L.addListener(I),I(L),()=>{L.removeListener(I)}},[]),H.useEffect(()=>{if(s){const I=L=>{const V=L.newValue;typeof L.key=="string"&&L.key.startsWith(c)&&(!V||m.match(V))&&(L.key.endsWith("light")&&T({light:V}),L.key.endsWith("dark")&&T({dark:V})),L.key===l&&(!V||["light","dark","system"].includes(V))&&E(V||e)};return s.addEventListener("storage",I),()=>{s.removeEventListener("storage",I)}}},[T,E,l,c,m,e,s]),ve({},y,{colorScheme:w,setMode:E,setColorScheme:T})}const p9=["colorSchemes","components","generateCssVars","cssVarPrefix"],m9="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function g9(t){const{themeId:e,theme:n={},attribute:r=B5,modeStorageKey:o=bP,colorSchemeStorageKey:l=wP,defaultMode:c="light",defaultColorScheme:s,disableTransitionOnChange:m=!1,resolveTheme:y,excludeVariablesFromRoot:b}=t;(!n.colorSchemes||typeof s=="string"&&!n.colorSchemes[s]||typeof s=="object"&&!n.colorSchemes[s?.light]||typeof s=="object"&&!n.colorSchemes[s?.dark])&&console.error(`MUI: \`${s}\` does not exist in \`theme.colorSchemes\`.`);const w=H.createContext(void 0),E=()=>{const L=H.useContext(w);if(!L)throw new Error(s_(19));return L};function T(L){const{children:V,theme:B=n,modeStorageKey:W=o,colorSchemeStorageKey:X=l,attribute:q=r,defaultMode:te=c,defaultColorScheme:se=s,disableTransitionOnChange:re=m,storageWindow:$=typeof window>"u"?void 0:window,documentNode:ce=typeof document>"u"?void 0:document,colorSchemeNode:Ce=typeof document>"u"?void 0:document.documentElement,colorSchemeSelector:Se=":root",disableNestedContext:Xe=!1,disableStyleSheetGeneration:Fe=!1}=L,Me=H.useRef(!1),Te=xP(),Ie=H.useContext(w),Ke=!!Ie&&!Xe,st=B[e],Ee=st||B,{colorSchemes:Qe={},components:jt={},generateCssVars:je=()=>({vars:{},css:{}}),cssVarPrefix:ft}=Ee,At=ir(Ee,p9),ht=Object.keys(Qe),lt=typeof se=="string"?se:se.light,bt=typeof se=="string"?se:se.dark,{mode:St,setMode:dn,systemMode:En,lightColorScheme:un,darkColorScheme:et,colorScheme:Ln,setColorScheme:Jt}=f9({supportedColorSchemes:ht,defaultLightColorScheme:lt,defaultDarkColorScheme:bt,modeStorageKey:W,colorSchemeStorageKey:X,defaultMode:te,storageWindow:$});let fn=St,$t=Ln;Ke&&(fn=Ie.mode,$t=Ie.colorScheme);const Nn=fn||(te==="system"?c:te),vn=$t||(Nn==="dark"?bt:lt),{css:Ue,vars:we}=je(),yt=ve({},At,{components:jt,colorSchemes:Qe,cssVarPrefix:ft,vars:we,getColorSchemeSelector:Zt=>`[${q}="${Zt}"] &`}),Nt={},Ht={};Object.entries(Qe).forEach(([Zt,Fn])=>{const{css:Yt,vars:Pe}=je(Zt);yt.vars=jl(yt.vars,Pe),Zt===vn&&(Object.keys(Fn).forEach(ue=>{Fn[ue]&&typeof Fn[ue]=="object"?yt[ue]=ve({},yt[ue],Fn[ue]):yt[ue]=Fn[ue]}),yt.palette&&(yt.palette.colorScheme=Zt));const ae=typeof se=="string"?se:te==="dark"?se.dark:se.light;if(Zt===ae){if(b){const ue={};b(ft).forEach(ee=>{ue[ee]=Yt[ee],delete Yt[ee]}),Nt[`[${q}="${Zt}"]`]=ue}Nt[`${Se}, [${q}="${Zt}"]`]=Yt}else Ht[`${Se===":root"?"":Se}[${q}="${Zt}"]`]=Yt}),yt.vars=jl(yt.vars,we),H.useEffect(()=>{$t&&Ce&&Ce.setAttribute(q,$t)},[$t,q,Ce]),H.useEffect(()=>{let Zt;if(re&&Me.current&&ce){const Fn=ce.createElement("style");Fn.appendChild(ce.createTextNode(m9)),ce.head.appendChild(Fn),window.getComputedStyle(ce.body),Zt=setTimeout(()=>{ce.head.removeChild(Fn)},1)}return()=>{clearTimeout(Zt)}},[$t,re,ce]),H.useEffect(()=>(Me.current=!0,()=>{Me.current=!1}),[]);const Ot=H.useMemo(()=>({allColorSchemes:ht,colorScheme:$t,darkColorScheme:et,lightColorScheme:un,mode:fn,setColorScheme:Jt,setMode:dn,systemMode:En}),[ht,$t,et,un,fn,Jt,dn,En]);let ln=!0;(Fe||Ke&&Te?.cssVarPrefix===ft)&&(ln=!1);const Gt=oe.jsxs(H.Fragment,{children:[ln&&oe.jsxs(H.Fragment,{children:[oe.jsx(jb,{styles:{[Se]:Ue}}),oe.jsx(jb,{styles:Nt}),oe.jsx(jb,{styles:Ht})]}),oe.jsx(u9,{themeId:st?e:void 0,theme:y?y(yt):yt,children:V})]});return Ke?Gt:oe.jsx(w.Provider,{value:Ot,children:Gt})}const R=typeof s=="string"?s:s.light,z=typeof s=="string"?s:s.dark;return{CssVarsProvider:T,useColorScheme:E,getInitColorSchemeScript:L=>h9(ve({attribute:r,colorSchemeStorageKey:l,defaultMode:c,defaultLightColorScheme:R,defaultDarkColorScheme:z,modeStorageKey:o},L))}}function SP(t=""){function e(...r){if(!r.length)return"";const o=r[0];return typeof o=="string"&&!o.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${o}${e(...r.slice(1))})`:`, ${o}`}return(r,...o)=>`var(--${t?`${t}-`:""}${r}${e(...o)})`}const wR=(t,e,n,r=[])=>{let o=t;e.forEach((l,c)=>{c===e.length-1?Array.isArray(o)?o[Number(l)]=n:o&&typeof o=="object"&&(o[l]=n):o&&typeof o=="object"&&(o[l]||(o[l]=r.includes(l)?[]:{}),o=o[l])})},v9=(t,e,n)=>{function r(o,l=[],c=[]){Object.entries(o).forEach(([s,m])=>{(!n||n&&!n([...l,s]))&&m!=null&&(typeof m=="object"&&Object.keys(m).length>0?r(m,[...l,s],Array.isArray(m)?[...c,s]:c):e([...l,s],m,c))})}r(t)},y9=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>t.includes(r))||t[t.length-1].toLowerCase().indexOf("opacity")>=0?e:`${e}px`:e;function GS(t,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},o={},l={},c={};return v9(t,(s,m,y)=>{if((typeof m=="string"||typeof m=="number")&&(!r||!r(s,m))){const b=`--${n?`${n}-`:""}${s.join("-")}`;Object.assign(o,{[b]:y9(s,m)}),wR(l,s,`var(${b})`,y),wR(c,s,`var(${b}, ${m})`,y)}},s=>s[0]==="vars"),{css:o,vars:l,varsWithDefaults:c}}function u_(t){"@babel/helpers - typeof";return u_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u_(t)}function _9(t,e){if(u_(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(u_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function x9(t){var e=_9(t,"string");return u_(e)=="symbol"?e:e+""}const b9=["colorSchemes","components","defaultColorScheme"];function w9(t,e){const{colorSchemes:n={},defaultColorScheme:r="light"}=t,o=ir(t,b9),{vars:l,css:c,varsWithDefaults:s}=GS(o,e);let m=s;const y={},{[r]:b}=n,w=ir(n,[r].map(x9));if(Object.entries(w||{}).forEach(([T,R])=>{const{vars:z,css:I,varsWithDefaults:L}=GS(R,e);m=jl(m,L),y[T]={css:I,vars:z}}),b){const{css:T,vars:R,varsWithDefaults:z}=GS(b,e);m=jl(m,z),y[r]={css:T,vars:R}}return{vars:m,generateCssVars:T=>{var R;if(!T){var z;const L=ve({},c);return{css:L,vars:l,selector:(e==null||(z=e.getSelector)==null?void 0:z.call(e,T,L))||":root"}}const I=ve({},y[T].css);return{css:I,vars:y[T].vars,selector:(e==null||(R=e.getSelector)==null?void 0:R.call(e,T,I))||":root"}}}}const S9=["component","direction","spacing","divider","children","className","useFlexGap"],M9=fP(),C9=Oj("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function E9(t){return L5({props:t,name:"MuiStack",defaultTheme:M9})}function T9(t,e){const n=H.Children.toArray(t).filter(Boolean);return n.reduce((r,o,l)=>(r.push(o),l<n.length-1&&r.push(H.cloneElement(e,{key:`separator-${l}`})),r),[])}const P9=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],A9=({ownerState:t,theme:e})=>{let n=ve({display:"flex",flexDirection:"column"},wu({theme:e},$S({values:t.direction,breakpoints:e.breakpoints.values}),r=>({flexDirection:r})));if(t.spacing){const r=hP(e),o=Object.keys(e.breakpoints.values).reduce((m,y)=>((typeof t.spacing=="object"&&t.spacing[y]!=null||typeof t.direction=="object"&&t.direction[y]!=null)&&(m[y]=!0),m),{}),l=$S({values:t.direction,base:o}),c=$S({values:t.spacing,base:o});typeof l=="object"&&Object.keys(l).forEach((m,y,b)=>{if(!l[m]){const E=y>0?l[b[y-1]]:"column";l[m]=E}}),n=jl(n,wu({theme:e},c,(m,y)=>t.useFlexGap?{gap:Fm(r,m)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${P9(y?l[y]:t.direction)}`]:Fm(r,m)}}))}return n=LV(e.breakpoints,n),n};function I9(t={}){const{createStyledComponent:e=C9,useThemeProps:n=E9,componentName:r="MuiStack"}=t,o=()=>Wr({root:["root"]},m=>gP(r,m),{}),l=e(A9);return H.forwardRef(function(m,y){const b=n(m),w=mP(b),{component:E="div",direction:T="column",spacing:R=0,divider:z,children:I,className:L,useFlexGap:V=!1}=w,B=ir(w,S9),W={direction:T,spacing:R,useFlexGap:V},X=o();return oe.jsx(l,ve({as:E,ownerState:W,ref:y,className:co(X.root,L)},B,{children:z?T9(I,z):I}))})}const R9=ve({},fw,{borderRadius:{themeKey:"radius"},boxShadow:{themeKey:"shadow"},fontFamily:{themeKey:"fontFamily"},fontSize:{themeKey:"fontSize"},fontWeight:{themeKey:"fontWeight"},letterSpacing:{themeKey:"letterSpacing"},lineHeight:{themeKey:"lineHeight"}});function L9(t){var e;return!!t[0].match(/^(typography|variants|breakpoints)$/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!((e=t[1])!=null&&e.match(/^(mode)$/))||t[0]==="focus"&&t[1]!=="thickness"}const qr=(t,e)=>gP(t,e,"Mui"),$r=(t,e)=>A5(t,e,"Mui"),D9=t=>t&&typeof t=="object"&&Object.keys(t).some(e=>{var n;return(n=e.match)==null?void 0:n.call(e,/^(plain(Hover|Active|Disabled)?(Color|Bg)|outlined(Hover|Active|Disabled)?(Color|Border|Bg)|soft(Hover|Active|Disabled)?(Color|Bg)|solid(Hover|Active|Disabled)?(Color|Bg))$/)}),SR=(t,e,n)=>{e.includes("Color")&&(t.color=n),e.includes("Bg")&&(t.backgroundColor=n),e.includes("Border")&&(t.borderColor=n)},MR=(t,e,n)=>{const r={};return Object.entries(e||{}).forEach(([o,l])=>{if(o.match(new RegExp(`${t}(color|bg|border)`,"i"))&&l){const c=n?n(o):l;o.includes("Disabled")&&(r.pointerEvents="none",r.cursor="default",r["--Icon-color"]="currentColor"),o.match(/(Hover|Active|Disabled)/)||(r["--variant-borderWidth"]||(r["--variant-borderWidth"]="0px"),o.includes("Border")&&(r["--variant-borderWidth"]="1px",r.border="var(--variant-borderWidth) solid")),SR(r,o,c)}}),r},ia=(t,e)=>{let n={};if(e){const{getCssVar:r,palette:o}=e;Object.entries(o).forEach(l=>{const[c,s]=l;D9(s)&&typeof s=="object"&&(n=ve({},n,{[c]:MR(t,s,m=>`var(--variant-${m}, ${r(`palette-${c}-${m}`,o[c][m])})`)}))})}return n.context=MR(t,{plainColor:"var(--variant-plainColor)",plainHoverColor:"var(--variant-plainHoverColor)",plainHoverBg:"var(--variant-plainHoverBg)",plainActiveBg:"var(--variant-plainActiveBg)",plainDisabledColor:"var(--variant-plainDisabledColor)",outlinedColor:"var(--variant-outlinedColor)",outlinedBorder:"var(--variant-outlinedBorder)",outlinedHoverColor:"var(--variant-outlinedHoverColor)",outlinedHoverBorder:"var(--variant-outlinedHoverBorder)",outlinedHoverBg:"var(--variant-outlinedHoverBg)",outlinedActiveBg:"var(--variant-outlinedActiveBg)",outlinedDisabledColor:"var(--variant-outlinedDisabledColor)",outlinedDisabledBorder:"var(--variant-outlinedDisabledBorder)",softColor:"var(--variant-softColor)",softBg:"var(--variant-softBg)",softHoverColor:"var(--variant-softHoverColor)",softHoverBg:"var(--variant-softHoverBg)",softActiveBg:"var(--variant-softActiveBg)",softDisabledColor:"var(--variant-softDisabledColor)",softDisabledBg:"var(--variant-softDisabledBg)",solidColor:"var(--variant-solidColor)",solidBg:"var(--variant-solidBg)",solidHoverBg:"var(--variant-solidHoverBg)",solidActiveBg:"var(--variant-solidActiveBg)",solidDisabledColor:"var(--variant-solidDisabledColor)",solidDisabledBg:"var(--variant-solidDisabledBg)"}),n},k9=["cssVarPrefix","breakpoints","spacing","components","variants","shouldSkipGeneratingVar"],z9=["colorSchemes"],O9=(t="joy")=>SP(t);function $5(t){var e,n,r,o,l,c,s,m,y,b;const w=t||{},{cssVarPrefix:E="joy",breakpoints:T,spacing:R,components:z,variants:I,shouldSkipGeneratingVar:L=L9}=w,V=ir(w,k9),B=O9(E),W={primary:e0.blue,neutral:e0.grey,danger:e0.red,success:e0.green,warning:e0.yellow,common:{white:"#FFF",black:"#000"}},X=lt=>{var bt;const St=lt.split("-"),dn=St[1],En=St[2];return B(lt,(bt=W[dn])==null?void 0:bt[En])},q=lt=>({plainColor:X(`palette-${lt}-500`),plainHoverBg:X(`palette-${lt}-100`),plainActiveBg:X(`palette-${lt}-200`),plainDisabledColor:X("palette-neutral-400"),outlinedColor:X(`palette-${lt}-500`),outlinedBorder:X(`palette-${lt}-300`),outlinedHoverBg:X(`palette-${lt}-100`),outlinedActiveBg:X(`palette-${lt}-200`),outlinedDisabledColor:X("palette-neutral-400"),outlinedDisabledBorder:X("palette-neutral-200"),softColor:X(`palette-${lt}-700`),softBg:X(`palette-${lt}-100`),softHoverBg:X(`palette-${lt}-200`),softActiveColor:X(`palette-${lt}-800`),softActiveBg:X(`palette-${lt}-300`),softDisabledColor:X("palette-neutral-400"),softDisabledBg:X("palette-neutral-50"),solidColor:X("palette-common-white"),solidBg:X(`palette-${lt}-500`),solidHoverBg:X(`palette-${lt}-600`),solidActiveBg:X(`palette-${lt}-700`),solidDisabledColor:X("palette-neutral-400"),solidDisabledBg:X("palette-neutral-100")}),te=lt=>({plainColor:X(`palette-${lt}-300`),plainHoverBg:X(`palette-${lt}-800`),plainActiveBg:X(`palette-${lt}-700`),plainDisabledColor:X("palette-neutral-500"),outlinedColor:X(`palette-${lt}-200`),outlinedBorder:X(`palette-${lt}-700`),outlinedHoverBg:X(`palette-${lt}-800`),outlinedActiveBg:X(`palette-${lt}-700`),outlinedDisabledColor:X("palette-neutral-500"),outlinedDisabledBorder:X("palette-neutral-800"),softColor:X(`palette-${lt}-200`),softBg:X(`palette-${lt}-800`),softHoverBg:X(`palette-${lt}-700`),softActiveColor:X(`palette-${lt}-100`),softActiveBg:X(`palette-${lt}-600`),softDisabledColor:X("palette-neutral-500"),softDisabledBg:X("palette-neutral-800"),solidColor:X("palette-common-white"),solidBg:X(`palette-${lt}-500`),solidHoverBg:X(`palette-${lt}-600`),solidActiveBg:X(`palette-${lt}-700`),solidDisabledColor:X("palette-neutral-500"),solidDisabledBg:X("palette-neutral-800")}),se={palette:{mode:"light",primary:ve({},W.primary,q("primary")),neutral:ve({},W.neutral,q("neutral"),{plainColor:X("palette-neutral-700"),plainHoverColor:X("palette-neutral-900"),outlinedColor:X("palette-neutral-700")}),danger:ve({},W.danger,q("danger")),success:ve({},W.success,q("success")),warning:ve({},W.warning,q("warning")),common:{white:"#FFF",black:"#000"},text:{primary:X("palette-neutral-800"),secondary:X("palette-neutral-700"),tertiary:X("palette-neutral-600"),icon:X("palette-neutral-500")},background:{body:X("palette-common-white"),surface:X("palette-neutral-50"),popup:X("palette-common-white"),level1:X("palette-neutral-100"),level2:X("palette-neutral-200"),level3:X("palette-neutral-300"),tooltip:X("palette-neutral-500"),backdrop:`rgba(${B("palette-neutral-darkChannel",mm(W.neutral[900]))} / 0.25)`},divider:`rgba(${B("palette-neutral-mainChannel",mm(W.neutral[500]))} / 0.2)`,focusVisible:X("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"21 21 21",shadowOpacity:"0.08"},re={palette:{mode:"dark",primary:ve({},W.primary,te("primary")),neutral:ve({},W.neutral,te("neutral"),{plainColor:X("palette-neutral-300"),plainHoverColor:X("palette-neutral-300")}),danger:ve({},W.danger,te("danger")),success:ve({},W.success,te("success")),warning:ve({},W.warning,te("warning")),common:{white:"#FFF",black:"#000"},text:{primary:X("palette-neutral-100"),secondary:X("palette-neutral-300"),tertiary:X("palette-neutral-400"),icon:X("palette-neutral-400")},background:{body:X("palette-common-black"),surface:X("palette-neutral-900"),popup:X("palette-common-black"),level1:X("palette-neutral-800"),level2:X("palette-neutral-700"),level3:X("palette-neutral-600"),tooltip:X("palette-neutral-600"),backdrop:`rgba(${B("palette-neutral-darkChannel",mm(W.neutral[50]))} / 0.25)`},divider:`rgba(${B("palette-neutral-mainChannel",mm(W.neutral[500]))} / 0.16)`,focusVisible:X("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"0 0 0",shadowOpacity:"0.6"},$='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',ce=ve({body:`"Inter", ${B(`fontFamily-fallback, ${$}`)}`,display:`"Inter", ${B(`fontFamily-fallback, ${$}`)}`,code:"Source Code Pro,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace",fallback:$},V.fontFamily),Ce=ve({sm:300,md:500,lg:600,xl:700},V.fontWeight),Se=ve({xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem",xl2:"1.5rem",xl3:"1.875rem",xl4:"2.25rem"},V.fontSize),Xe=ve({xs:"1.33334",sm:"1.42858",md:"1.5",lg:"1.55556",xl:"1.66667"},V.lineHeight),Fe=(e=(n=V.colorSchemes)==null||(n=n.light)==null?void 0:n.shadowRing)!=null?e:se.shadowRing,Me=(r=(o=V.colorSchemes)==null||(o=o.light)==null?void 0:o.shadowChannel)!=null?r:se.shadowChannel,Te=(l=(c=V.colorSchemes)==null||(c=c.light)==null?void 0:c.shadowOpacity)!=null?l:se.shadowOpacity,Ie={colorSchemes:{light:se,dark:re},fontSize:Se,fontFamily:ce,fontWeight:Ce,focus:{thickness:"2px",selector:`&.${qr("","focusVisible")}, &:focus-visible`,default:{outlineOffset:`var(--focus-outline-offset, ${B("focus-thickness",(s=(m=V.focus)==null?void 0:m.thickness)!=null?s:"2px")})`,outline:`${B("focus-thickness",(y=(b=V.focus)==null?void 0:b.thickness)!=null?y:"2px")} solid ${B("palette-focusVisible",W.primary[500])}`}},lineHeight:Xe,radius:{xs:"2px",sm:"6px",md:"8px",lg:"12px",xl:"16px"},shadow:{xs:`${B("shadowRing",Fe)}, 0px 1px 2px 0px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)})`,sm:`${B("shadowRing",Fe)}, 0px 1px 2px 0px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)}), 0px 2px 4px 0px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)})`,md:`${B("shadowRing",Fe)}, 0px 2px 8px -2px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)}), 0px 6px 12px -2px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)})`,lg:`${B("shadowRing",Fe)}, 0px 2px 8px -2px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)}), 0px 12px 16px -4px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)})`,xl:`${B("shadowRing",Fe)}, 0px 2px 8px -2px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)}), 0px 20px 24px -4px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Te)})`},zIndex:{badge:1,table:10,popup:1e3,modal:1300,snackbar:1400,tooltip:1500},typography:{h1:{fontFamily:B(`fontFamily-display, ${ce.display}`),fontWeight:B(`fontWeight-xl, ${Ce.xl}`),fontSize:B(`fontSize-xl4, ${Se.xl4}`),lineHeight:B(`lineHeight-xs, ${Xe.xs}`),letterSpacing:"-0.025em",color:B(`palette-text-primary, ${se.palette.text.primary}`)},h2:{fontFamily:B(`fontFamily-display, ${ce.display}`),fontWeight:B(`fontWeight-xl, ${Ce.xl}`),fontSize:B(`fontSize-xl3, ${Se.xl3}`),lineHeight:B(`lineHeight-xs, ${Xe.xs}`),letterSpacing:"-0.025em",color:B(`palette-text-primary, ${se.palette.text.primary}`)},h3:{fontFamily:B(`fontFamily-display, ${ce.display}`),fontWeight:B(`fontWeight-lg, ${Ce.lg}`),fontSize:B(`fontSize-xl2, ${Se.xl2}`),lineHeight:B(`lineHeight-xs, ${Xe.xs}`),letterSpacing:"-0.025em",color:B(`palette-text-primary, ${se.palette.text.primary}`)},h4:{fontFamily:B(`fontFamily-display, ${ce.display}`),fontWeight:B(`fontWeight-lg, ${Ce.lg}`),fontSize:B(`fontSize-xl, ${Se.xl}`),lineHeight:B(`lineHeight-md, ${Xe.md}`),letterSpacing:"-0.025em",color:B(`palette-text-primary, ${se.palette.text.primary}`)},"title-lg":{fontFamily:B(`fontFamily-body, ${ce.body}`),fontWeight:B(`fontWeight-lg, ${Ce.lg}`),fontSize:B(`fontSize-lg, ${Se.lg}`),lineHeight:B(`lineHeight-xs, ${Xe.xs}`),color:B(`palette-text-primary, ${se.palette.text.primary}`)},"title-md":{fontFamily:B(`fontFamily-body, ${ce.body}`),fontWeight:B(`fontWeight-md, ${Ce.md}`),fontSize:B(`fontSize-md, ${Se.md}`),lineHeight:B(`lineHeight-md, ${Xe.md}`),color:B(`palette-text-primary, ${se.palette.text.primary}`)},"title-sm":{fontFamily:B(`fontFamily-body, ${ce.body}`),fontWeight:B(`fontWeight-md, ${Ce.md}`),fontSize:B(`fontSize-sm, ${Se.sm}`),lineHeight:B(`lineHeight-sm, ${Xe.sm}`),color:B(`palette-text-primary, ${se.palette.text.primary}`)},"body-lg":{fontFamily:B(`fontFamily-body, ${ce.body}`),fontSize:B(`fontSize-lg, ${Se.lg}`),lineHeight:B(`lineHeight-md, ${Xe.md}`),color:B(`palette-text-secondary, ${se.palette.text.secondary}`)},"body-md":{fontFamily:B(`fontFamily-body, ${ce.body}`),fontSize:B(`fontSize-md, ${Se.md}`),lineHeight:B(`lineHeight-md, ${Xe.md}`),color:B(`palette-text-secondary, ${se.palette.text.secondary}`)},"body-sm":{fontFamily:B(`fontFamily-body, ${ce.body}`),fontSize:B(`fontSize-sm, ${Se.sm}`),lineHeight:B(`lineHeight-md, ${Xe.md}`),color:B(`palette-text-tertiary, ${se.palette.text.tertiary}`)},"body-xs":{fontFamily:B(`fontFamily-body, ${ce.body}`),fontWeight:B(`fontWeight-md, ${Ce.md}`),fontSize:B(`fontSize-xs, ${Se.xs}`),lineHeight:B(`lineHeight-md, ${Xe.md}`),color:B(`palette-text-tertiary, ${se.palette.text.tertiary}`)}}},Ke=V?jl(Ie,V):Ie,{colorSchemes:st}=Ke,Ee=ir(Ke,z9),Qe=ve({colorSchemes:st},Ee,{breakpoints:_5(T??{}),components:jl({MuiSvgIcon:{defaultProps:{fontSize:"xl2"},styleOverrides:{root:({ownerState:lt,theme:bt})=>{var St;const dn=lt.instanceFontSize;return ve({margin:"var(--Icon-margin)"},lt.fontSize&&lt.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${bt.vars.fontSize[lt.fontSize]})`},!lt.htmlColor&&ve({color:`var(--Icon-color, ${Qe.vars.palette.text.icon})`},lt.color&&lt.color!=="inherit"&&bt.vars.palette[lt.color]&&{color:`rgba(${(St=bt.vars.palette[lt.color])==null?void 0:St.mainChannel} / 1)`}),dn&&dn!=="inherit"&&{"--Icon-fontSize":bt.vars.fontSize[dn]})}}}},z),cssVarPrefix:E,getCssVar:B,spacing:S5(R)});function jt(lt,bt){Object.keys(bt).forEach(St=>{const dn={main:"500",light:"200",dark:"700"};lt==="dark"&&(dn.main=400),!bt[St].mainChannel&&bt[St][dn.main]&&(bt[St].mainChannel=mm(bt[St][dn.main])),!bt[St].lightChannel&&bt[St][dn.light]&&(bt[St].lightChannel=mm(bt[St][dn.light])),!bt[St].darkChannel&&bt[St][dn.dark]&&(bt[St].darkChannel=mm(bt[St][dn.dark]))})}Object.entries(Qe.colorSchemes).forEach(([lt,bt])=>{jt(lt,bt.palette)});const je={prefix:E,shouldSkipGeneratingVar:L},{vars:ft,generateCssVars:At}=w9(ve({colorSchemes:st},Ee),je);Qe.vars=ft,Qe.generateCssVars=At,Qe.unstable_sxConfig=ve({},R9,t?.unstable_sxConfig),Qe.unstable_sx=function(bt){return D_({sx:bt,theme:this})},Qe.getColorSchemeSelector=lt=>lt==="light"?"&":`&[data-joy-color-scheme="${lt}"], [data-joy-color-scheme="${lt}"] &`;const ht={getCssVar:B,palette:Qe.colorSchemes.light.palette};return Qe.variants=jl({plain:ia("plain",ht),plainHover:ia("plainHover",ht),plainActive:ia("plainActive",ht),plainDisabled:ia("plainDisabled",ht),outlined:ia("outlined",ht),outlinedHover:ia("outlinedHover",ht),outlinedActive:ia("outlinedActive",ht),outlinedDisabled:ia("outlinedDisabled",ht),soft:ia("soft",ht),softHover:ia("softHover",ht),softActive:ia("softActive",ht),softDisabled:ia("softDisabled",ht),solid:ia("solid",ht),solidHover:ia("solidHover",ht),solidActive:ia("solidActive",ht),solidDisabled:ia("solidDisabled",ht)},I),Qe.palette=ve({},Qe.colorSchemes.light.palette,{colorScheme:"light"}),Qe.shouldSkipGeneratingVar=L,Qe.applyStyles=M5,Qe}const ay=$5(),n0={attribute:"data-joy-color-scheme",colorSchemeStorageKey:"joy-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"joy-mode"},{CssVarsProvider:F9,useColorScheme:MP}=g9({themeId:P_,theme:ay,attribute:n0.attribute,modeStorageKey:n0.modeStorageKey,colorSchemeStorageKey:n0.colorSchemeStorageKey,defaultColorScheme:{light:n0.defaultLightColorScheme,dark:n0.defaultDarkColorScheme}}),_n=I5({defaultTheme:ay,themeId:P_});function Xr({props:t,name:e}){return L5({props:t,name:e,defaultTheme:ve({},ay,{components:{}}),themeId:P_})}function N9(t){return oe.jsx(wj,ve({},t,{defaultTheme:ay,themeId:P_}))}function CR(t,e,n=(r,o)=>r===o){return t.length===e.length&&t.every((r,o)=>n(r,e[o]))}const B9={disableDefaultClasses:!1},U9=H.createContext(B9);function $9(t){const{disableDefaultClasses:e}=H.useContext(U9);return n=>e?"":t(n)}function V9(t){const{rootElementName:e=""}=t,[n,r]=H.useState(e.toUpperCase()),o=H.useCallback(l=>{var c;r((c=l?.tagName)!=null?c:"")},[]);return[n,o]}const V5="base";function j9(t){return`${V5}--${t}`}function H9(t,e){return`${V5}-${t}-${e}`}function G9(t,e){const n=P5[e];return n?j9(n):H9(t,e)}function Lh(t={}){const{disabled:e=!1,focusableWhenDisabled:n,href:r,rootRef:o,tabIndex:l,to:c,type:s,rootElementName:m}=t,y=H.useRef(null),[b,w]=H.useState(!1),{isFocusVisibleRef:E,onFocus:T,onBlur:R,ref:z}=_P(),[I,L]=H.useState(!1);e&&!n&&I&&L(!1),H.useEffect(()=>{E.current=I},[I,E]);const[V,B]=V9({rootElementName:m??(r||c?"a":void 0)}),W=Fe=>Me=>{var Te;I&&Me.preventDefault(),(Te=Fe.onMouseLeave)==null||Te.call(Fe,Me)},X=Fe=>Me=>{var Te;R(Me),E.current===!1&&L(!1),(Te=Fe.onBlur)==null||Te.call(Fe,Me)},q=Fe=>Me=>{var Te;if(y.current||(y.current=Me.currentTarget),T(Me),E.current===!0){var Ie;L(!0),(Ie=Fe.onFocusVisible)==null||Ie.call(Fe,Me)}(Te=Fe.onFocus)==null||Te.call(Fe,Me)},te=()=>{const Fe=y.current;return V==="BUTTON"||V==="INPUT"&&["button","submit","reset"].includes(Fe?.type)||V==="A"&&Fe?.href},se=Fe=>Me=>{if(!e){var Te;(Te=Fe.onClick)==null||Te.call(Fe,Me)}},re=Fe=>Me=>{var Te;e||(w(!0),document.addEventListener("mouseup",()=>{w(!1)},{once:!0})),(Te=Fe.onMouseDown)==null||Te.call(Fe,Me)},$=Fe=>Me=>{var Te;if((Te=Fe.onKeyDown)==null||Te.call(Fe,Me),!Me.defaultMuiPrevented&&(Me.target===Me.currentTarget&&!te()&&Me.key===" "&&Me.preventDefault(),Me.target===Me.currentTarget&&Me.key===" "&&!e&&w(!0),Me.target===Me.currentTarget&&!te()&&Me.key==="Enter"&&!e)){var Ie;(Ie=Fe.onClick)==null||Ie.call(Fe,Me),Me.preventDefault()}},ce=Fe=>Me=>{var Te;if(Me.target===Me.currentTarget&&w(!1),(Te=Fe.onKeyUp)==null||Te.call(Fe,Me),Me.target===Me.currentTarget&&!te()&&!e&&Me.key===" "&&!Me.defaultMuiPrevented){var Ie;(Ie=Fe.onClick)==null||Ie.call(Fe,Me)}},Ce=bi(B,o,z,y),Se={};return l!==void 0&&(Se.tabIndex=l),V==="BUTTON"?(Se.type=s??"button",n?Se["aria-disabled"]=e:Se.disabled=e):V==="INPUT"?s&&["button","submit","reset"].includes(s)&&(n?Se["aria-disabled"]=e:Se.disabled=e):V!==""&&(!r&&!c&&(Se.role="button",Se.tabIndex=l??0),e&&(Se["aria-disabled"]=e,Se.tabIndex=n?l??0:-1)),{getRootProps:(Fe={})=>{const Me=ve({},ps(t),ps(Fe)),Te=ve({type:s},Me,Se,Fe,{onBlur:X(Me),onClick:se(Me),onFocus:q(Me),onKeyDown:$(Me),onKeyUp:ce(Me),onMouseDown:re(Me),onMouseLeave:W(Me),ref:Ce});return delete Te.onFocusVisible,Te},focusVisible:I,setFocusVisible:L,active:b,rootRef:Ce}}function ER(t){return t.substring(2).toLowerCase()}function W9(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function q9(t){const{children:e,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:o,touchEvent:l="onTouchEnd"}=t,c=H.useRef(!1),s=H.useRef(null),m=H.useRef(!1),y=H.useRef(!1);H.useEffect(()=>(setTimeout(()=>{m.current=!0},0),()=>{m.current=!1}),[]);const b=bi(mw(e),s),w=yu(R=>{const z=y.current;y.current=!1;const I=Hl(s.current);if(!m.current||!s.current||"clientX"in R&&W9(R,I))return;if(c.current){c.current=!1;return}let L;R.composedPath?L=R.composedPath().indexOf(s.current)>-1:L=!I.documentElement.contains(R.target)||s.current.contains(R.target),!L&&(n||!z)&&o(R)}),E=R=>z=>{y.current=!0;const I=e.props[R];I&&I(z)},T={ref:b};return l!==!1&&(T[l]=E(l)),H.useEffect(()=>{if(l!==!1){const R=ER(l),z=Hl(s.current),I=()=>{c.current=!0};return z.addEventListener(R,w),z.addEventListener("touchmove",I),()=>{z.removeEventListener(R,w),z.removeEventListener("touchmove",I)}}},[w,l]),r!==!1&&(T[r]=E(r)),H.useEffect(()=>{if(r!==!1){const R=ER(r),z=Hl(s.current);return z.addEventListener(R,w),()=>{z.removeEventListener(R,w)}}},[w,r]),oe.jsx(H.Fragment,{children:H.cloneElement(e,T)})}const gw=H.createContext(null);function X9(t,e){return t===e}const WS={},TR=()=>{};function m2(t,e){const n=ve({},t);return Object.keys(e).forEach(r=>{e[r]!==void 0&&(n[r]=e[r])}),n}function Z9(t){const{nextState:e,initialState:n,stateComparers:r,onStateChange:o,controlledProps:l,lastActionRef:c}=t,s=H.useRef(n);H.useEffect(()=>{if(c.current===null)return;const m=m2(s.current,l);Object.keys(e).forEach(y=>{var b;const w=(b=r[y])!=null?b:X9,E=e[y],T=m[y];if(T==null&&E!=null||T!=null&&E==null||T!=null&&E!=null&&!w(E,T)){var R,z;o?.((R=c.current.event)!=null?R:null,y,E,(z=c.current.type)!=null?z:"",e)}}),s.current=e,c.current=null},[s,e,c,o,r,l])}function j5(t){const e=H.useRef(null),{reducer:n,initialState:r,controlledProps:o=WS,stateComparers:l=WS,onStateChange:c=TR,actionContext:s,componentName:m=""}=t;H.useRef(o);const y=H.useCallback((T,R)=>{e.current=R;const z=m2(T,o);return n(z,R)},[o,n]),[b,w]=H.useReducer(y,r),E=H.useCallback(T=>{w(ve({},T,{context:s}))},[s]);return Z9({nextState:b,initialState:r,stateComparers:l??WS,onStateChange:c??TR,controlledProps:o,lastActionRef:e}),[m2(b,o),E]}const gu={blur:"dropdown:blur",escapeKeyDown:"dropdown:escapeKeyDown",toggle:"dropdown:toggle",open:"dropdown:open",close:"dropdown:close"};function Y9(t,e){switch(e.type){case gu.blur:return{open:!1,changeReason:e.event};case gu.escapeKeyDown:return{open:!1,changeReason:e.event};case gu.toggle:return{open:!t.open,changeReason:e.event};case gu.open:return{open:!0,changeReason:e.event};case gu.close:return{open:!1,changeReason:e.event};default:throw new Error("Unhandled action")}}function K9(t={}){const{defaultOpen:e,onOpenChange:n,open:r,componentName:o="useDropdown"}=t,[l,c]=H.useState(""),[s,m]=H.useState(null),y=H.useRef(null),b=H.useCallback((z,I,L,V)=>{I==="open"&&n?.(z,L),y.current=V},[n]),w=H.useMemo(()=>r!==void 0?{open:r}:{},[r]),[E,T]=j5({controlledProps:w,initialState:e?{open:!0,changeReason:null}:{open:!1,changeReason:null},onStateChange:b,reducer:Y9,componentName:o});return H.useEffect(()=>{!E.open&&y.current!==null&&y.current!==gu.blur&&s?.focus()},[E.open,s]),{contextValue:{state:E,dispatch:T,popupId:l,registerPopup:c,registerTrigger:m,triggerElement:s},open:E.open}}function J9(t){const{children:e,open:n,defaultOpen:r,onOpenChange:o}=t,{contextValue:l}=K9({defaultOpen:r,onOpenChange:o,open:n});return oe.jsx(gw.Provider,{value:l,children:e})}const Q9=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function e7(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function t7(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function n7(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||t7(t))}function r7(t){const e=[],n=[];return Array.from(t.querySelectorAll(Q9)).forEach((r,o)=>{const l=e7(r);l===-1||!n7(r)||(l===0?e.push(r):n.push({documentOrder:o,tabIndex:l,node:r}))}),n.sort((r,o)=>r.tabIndex===o.tabIndex?r.documentOrder-o.documentOrder:r.tabIndex-o.tabIndex).map(r=>r.node).concat(e)}function i7(){return!0}function o7(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:o=!1,getTabbable:l=r7,isEnabled:c=i7,open:s}=t,m=H.useRef(!1),y=H.useRef(null),b=H.useRef(null),w=H.useRef(null),E=H.useRef(null),T=H.useRef(!1),R=H.useRef(null),z=bi(mw(e),R),I=H.useRef(null);H.useEffect(()=>{!s||!R.current||(T.current=!n)},[n,s]),H.useEffect(()=>{if(!s||!R.current)return;const B=Hl(R.current);return R.current.contains(B.activeElement)||(R.current.hasAttribute("tabIndex")||R.current.setAttribute("tabIndex","-1"),T.current&&R.current.focus()),()=>{o||(w.current&&w.current.focus&&(m.current=!0,w.current.focus()),w.current=null)}},[s]),H.useEffect(()=>{if(!s||!R.current)return;const B=Hl(R.current),W=te=>{I.current=te,!(r||!c()||te.key!=="Tab")&&B.activeElement===R.current&&te.shiftKey&&(m.current=!0,b.current&&b.current.focus())},X=()=>{const te=R.current;if(te===null)return;if(!B.hasFocus()||!c()||m.current){m.current=!1;return}if(te.contains(B.activeElement)||r&&B.activeElement!==y.current&&B.activeElement!==b.current)return;if(B.activeElement!==E.current)E.current=null;else if(E.current!==null)return;if(!T.current)return;let se=[];if((B.activeElement===y.current||B.activeElement===b.current)&&(se=l(R.current)),se.length>0){var re,$;const ce=!!((re=I.current)!=null&&re.shiftKey&&(($=I.current)==null?void 0:$.key)==="Tab"),Ce=se[0],Se=se[se.length-1];typeof Ce!="string"&&typeof Se!="string"&&(ce?Se.focus():Ce.focus())}else te.focus()};B.addEventListener("focusin",X),B.addEventListener("keydown",W,!0);const q=setInterval(()=>{B.activeElement&&B.activeElement.tagName==="BODY"&&X()},50);return()=>{clearInterval(q),B.removeEventListener("focusin",X),B.removeEventListener("keydown",W,!0)}},[n,r,o,c,s,l]);const L=B=>{w.current===null&&(w.current=B.relatedTarget),T.current=!0,E.current=B.target;const W=e.props.onFocus;W&&W(B)},V=B=>{w.current===null&&(w.current=B.relatedTarget),T.current=!0};return oe.jsxs(H.Fragment,{children:[oe.jsx("div",{tabIndex:s?0:-1,onFocus:V,ref:y,"data-testid":"sentinelStart"}),H.cloneElement(e,{ref:z,onFocus:L}),oe.jsx("div",{tabIndex:s?0:-1,onFocus:V,ref:b,"data-testid":"sentinelEnd"})]})}const s7=H.createContext(void 0);function a7(){return H.useContext(s7)}function l7(t={}){const{defaultValue:e,disabled:n=!1,error:r=!1,onBlur:o,onChange:l,onFocus:c,required:s=!1,value:m,inputRef:y}=t,b=a7();let w,E,T,R,z;if(b){var I,L,V;w=void 0,E=(I=b.disabled)!=null?I:!1,T=(L=b.error)!=null?L:!1,R=(V=b.required)!=null?V:!1,z=b.value}else w=e,E=n,T=r,R=s,z=m;const{current:B}=H.useRef(z!=null),W=H.useCallback(Fe=>{},[]),X=H.useRef(null),q=bi(X,y,W),[te,se]=H.useState(!1);H.useEffect(()=>{!b&&E&&te&&(se(!1),o?.())},[b,E,te,o]);const re=Fe=>Me=>{var Te;if(b!=null&&b.disabled){Me.stopPropagation();return}if((Te=Fe.onFocus)==null||Te.call(Fe,Me),b&&b.onFocus){var Ie;b==null||(Ie=b.onFocus)==null||Ie.call(b)}else se(!0)},$=Fe=>Me=>{var Te;(Te=Fe.onBlur)==null||Te.call(Fe,Me),b&&b.onBlur?b.onBlur():se(!1)},ce=Fe=>(Me,...Te)=>{var Ie,Ke;if(!B&&(Me.target||X.current)==null)throw new Error(s_(17));b==null||(Ie=b.onChange)==null||Ie.call(b,Me),(Ke=Fe.onChange)==null||Ke.call(Fe,Me,...Te)},Ce=Fe=>Me=>{var Te;X.current&&Me.currentTarget===Me.target&&X.current.focus(),(Te=Fe.onClick)==null||Te.call(Fe,Me)};return{disabled:E,error:T,focused:te,formControlContext:b,getInputProps:(Fe={})=>{const Te=ve({},{onBlur:o,onChange:l,onFocus:c},ps(Fe)),Ie=ve({},Te,{onBlur:$(Te),onChange:ce(Te),onFocus:re(Te)});return ve({},Ie,{"aria-invalid":T||void 0,defaultValue:w,value:z,required:R,disabled:E},Fe,{ref:q},Ie)},getRootProps:(Fe={})=>{const Me=ps(t,["onBlur","onChange","onFocus"]),Te=ve({},Me,ps(Fe));return ve({},Fe,Te,{onClick:Ce(Te)})},inputRef:q,required:R,value:z}}const Li={blur:"list:blur",itemClick:"list:itemClick",itemHover:"list:itemHover",itemsChange:"list:itemsChange",keyDown:"list:keyDown",resetHighlight:"list:resetHighlight",highlightLast:"list:highlightLast",textNavigation:"list:textNavigation",clearSelection:"list:clearSelection"};function c7(t,e,n,r,o,l){if(n.length===0||!r&&n.every((s,m)=>o(s,m)))return-1;let c=t;for(;;){if(!l&&e==="next"&&c===n.length||!l&&e==="previous"&&c===-1)return-1;if(r?!1:o(n[c],c))c+=e==="next"?1:-1,l&&(c=(c+n.length)%n.length);else return c}}function Ps(t,e,n){var r;const{items:o,isItemDisabled:l,disableListWrap:c,disabledItemsFocusable:s,itemComparer:m,focusManagement:y}=n,b=y==="DOM"?0:-1,w=o.length-1,E=t==null?-1:o.findIndex(L=>m(L,t));let T,R,z=!c;switch(e){case"reset":if(b===-1)return null;T=0,R="next",z=!1;break;case"start":T=0,R="next",z=!1;break;case"end":T=w,R="previous",z=!1;break;default:{const L=E+e;L<0?!z&&E!==-1||Math.abs(e)>1?(T=0,R="next"):(T=w,R="previous"):L>w?!z||Math.abs(e)>1?(T=w,R="previous"):(T=0,R="next"):(T=L,R=e>=0?"next":"previous")}}const I=c7(T,R,o,s,l,z);return I===-1&&t!==null&&!l(t,E)?t:(r=o[I])!=null?r:null}function u7(t,e,n,r){return n==="none"?[]:n==="single"?r(e[0],t)?e:[t]:e.some(o=>r(o,t))?e.filter(o=>!r(o,t)):[...e,t]}function CP(t,e,n){const{itemComparer:r,isItemDisabled:o,selectionMode:l,items:c}=n,{selectedValues:s}=e,m=c.findIndex(b=>r(t,b));if(o(t,m))return e;const y=u7(t,s,l,r);return ve({},e,{selectedValues:y,highlightedValue:t})}function h7(t,e,n){const r=e.highlightedValue,{orientation:o,pageSize:l}=n;switch(t){case"Home":return ve({},e,{highlightedValue:Ps(r,"start",n)});case"End":return ve({},e,{highlightedValue:Ps(r,"end",n)});case"PageUp":return ve({},e,{highlightedValue:Ps(r,-l,n)});case"PageDown":return ve({},e,{highlightedValue:Ps(r,l,n)});case"ArrowUp":if(o!=="vertical")break;return ve({},e,{highlightedValue:Ps(r,-1,n)});case"ArrowDown":if(o!=="vertical")break;return ve({},e,{highlightedValue:Ps(r,1,n)});case"ArrowLeft":{if(o==="vertical")break;return ve({},e,{highlightedValue:Ps(r,o==="horizontal-ltr"?-1:1,n)})}case"ArrowRight":{if(o==="vertical")break;return ve({},e,{highlightedValue:Ps(r,o==="horizontal-ltr"?1:-1,n)})}case"Enter":case" ":return e.highlightedValue===null?e:CP(e.highlightedValue,e,n)}return e}function d7(t,e){return e.focusManagement==="DOM"?t:ve({},t,{highlightedValue:null})}function f7(t,e,n){var r;const o=(r=n(t))==null?void 0:r.trim().toLowerCase();return!o||o.length===0?!1:o.indexOf(e)===0}function p7(t,e,n){const{items:r,isItemDisabled:o,disabledItemsFocusable:l,getItemAsString:c}=n,s=e.length>1;let m=s?t.highlightedValue:Ps(t.highlightedValue,1,n);for(let y=0;y<r.length;y+=1){if(!m||!s&&t.highlightedValue===m)return t;if(f7(m,e,c)&&(!o(m,r.indexOf(m))||l))return ve({},t,{highlightedValue:m});m=Ps(m,1,n)}return t}function m7(t,e,n,r){var o;const{itemComparer:l,focusManagement:c}=r;let s=null;if(n.highlightedValue!=null){var m;s=(m=t.find(w=>l(w,n.highlightedValue)))!=null?m:null}else c==="DOM"&&e.length===0&&(s=Ps(null,"reset",r));const b=((o=n.selectedValues)!=null?o:[]).filter(w=>t.some(E=>l(E,w)));return ve({},n,{highlightedValue:s,selectedValues:b})}function g7(t,e){return ve({},t,{highlightedValue:Ps(null,"reset",e)})}function v7(t,e){return ve({},t,{highlightedValue:Ps(null,"end",e)})}function y7(t,e){return ve({},t,{selectedValues:[],highlightedValue:Ps(null,"reset",e)})}function vw(t,e){const{type:n,context:r}=e;switch(n){case Li.keyDown:return h7(e.key,t,r);case Li.itemClick:return CP(e.item,t,r);case Li.blur:return d7(t,r);case Li.textNavigation:return p7(t,e.searchString,r);case Li.itemsChange:return m7(e.items,e.previousItems,t,r);case Li.resetHighlight:return g7(t,r);case Li.highlightLast:return v7(t,r);case Li.clearSelection:return y7(t,r);default:return t}}const _7=500;function x7(t){const e=H.useRef({searchString:"",lastTime:null});return H.useCallback(n=>{if(n.key.length===1&&n.key!==" "){const r=e.current,o=n.key.toLowerCase(),l=performance.now();r.searchString.length>0&&r.lastTime&&l-r.lastTime>_7?r.searchString=o:(r.searchString.length!==1||o!==r.searchString)&&(r.searchString+=o),r.lastTime=l,t(r.searchString,n)}},[t])}const PR={},b7=()=>{},w7=(t,e)=>t===e,S7=()=>!1,M7=t=>typeof t=="string"?t:String(t),C7=()=>({highlightedValue:null,selectedValues:[]});function EP(t){const{controlledProps:e=PR,disabledItemsFocusable:n=!1,disableListWrap:r=!1,focusManagement:o="activeDescendant",getInitialState:l=C7,getItemDomElement:c,getItemId:s,isItemDisabled:m=S7,rootRef:y,onStateChange:b=b7,items:w,itemComparer:E=w7,getItemAsString:T=M7,onChange:R,onHighlightChange:z,onItemsChange:I,orientation:L="vertical",pageSize:V=5,reducerActionContext:B=PR,selectionMode:W="single",stateReducer:X,componentName:q="useList"}=t,te=H.useRef(null),se=bi(y,te),re=H.useCallback((ht,lt,bt)=>{if(z?.(ht,lt,bt),o==="DOM"&&lt!=null&&(bt===Li.itemClick||bt===Li.keyDown||bt===Li.textNavigation)){var St;c==null||(St=c(lt))==null||St.focus()}},[c,z,o]),$=H.useMemo(()=>({highlightedValue:E,selectedValues:(ht,lt)=>CR(ht,lt,E)}),[E]),ce=H.useCallback((ht,lt,bt,St,dn)=>{switch(b?.(ht,lt,bt,St,dn),lt){case"highlightedValue":re(ht,bt,St);break;case"selectedValues":R?.(ht,bt,St);break}},[re,R,b]),Ce=H.useMemo(()=>({disabledItemsFocusable:n,disableListWrap:r,focusManagement:o,isItemDisabled:m,itemComparer:E,items:w,getItemAsString:T,onHighlightChange:re,orientation:L,pageSize:V,selectionMode:W,stateComparers:$}),[n,r,o,m,E,w,T,re,L,V,W,$]),Se=l(),Xe=X??vw,Fe=H.useMemo(()=>ve({},B,Ce),[B,Ce]),[Me,Te]=j5({reducer:Xe,actionContext:Fe,initialState:Se,controlledProps:e,stateComparers:$,onStateChange:ce,componentName:q}),{highlightedValue:Ie,selectedValues:Ke}=Me,st=x7((ht,lt)=>Te({type:Li.textNavigation,event:lt,searchString:ht})),Ee=H.useRef([]);H.useEffect(()=>{CR(Ee.current,w,E)||(Te({type:Li.itemsChange,event:null,items:w,previousItems:Ee.current}),Ee.current=w,I?.(w))},[w,E,Te,I]);const Qe=ht=>lt=>{var bt;if((bt=ht.onKeyDown)==null||bt.call(ht,lt),lt.defaultMuiPrevented)return;const St=["Home","End","PageUp","PageDown"];L==="vertical"?St.push("ArrowUp","ArrowDown"):St.push("ArrowLeft","ArrowRight"),o==="activeDescendant"&&St.push(" ","Enter"),St.includes(lt.key)&&lt.preventDefault(),Te({type:Li.keyDown,key:lt.key,event:lt}),st(lt)},jt=ht=>lt=>{var bt,St;(bt=ht.onBlur)==null||bt.call(ht,lt),!lt.defaultMuiPrevented&&((St=te.current)!=null&&St.contains(lt.relatedTarget)||Te({type:Li.blur,event:lt}))},je=(ht={})=>{const lt=ps(ht);return ve({},ht,{"aria-activedescendant":o==="activeDescendant"&&Ie!=null?s(Ie):void 0,tabIndex:o==="DOM"?-1:0,ref:se},lt,{onBlur:jt(lt),onKeyDown:Qe(lt)})},ft=H.useCallback(ht=>{const lt=(Ke??[]).some(dn=>dn!=null&&E(ht,dn)),bt=Ie!=null&&E(ht,Ie);return{focusable:o==="DOM",highlighted:bt,selected:lt}},[E,Ke,Ie,o]),At=H.useMemo(()=>({dispatch:Te,getItemState:ft}),[Te,ft]);return H.useDebugValue({state:Me}),{contextValue:At,dispatch:Te,getRootProps:je,rootRef:se,state:Me}}const pp=H.createContext(null);function TP(t){const{handlePointerOverEvents:e=!1,item:n}=t,r=H.useContext(pp);if(!r)throw new Error("useListItem must be used within a ListProvider");const{dispatch:o,getItemState:l}=r,{highlighted:c,selected:s,focusable:m}=l(n),y=H.useCallback(T=>R=>{var z;(z=T.onClick)==null||z.call(T,R),!R.defaultPrevented&&o({type:Li.itemClick,item:n,event:R})},[o,n]),b=H.useCallback(T=>R=>{var z;(z=T.onMouseOver)==null||z.call(T,R),!R.defaultPrevented&&o({type:Li.itemHover,item:n,event:R})},[o,n]);let w;return m&&(w=c?0:-1),{getRootProps:(T={})=>{const R=ps(T);return ve({},T,{onClick:y(R),onPointerOver:e?b(R):void 0,tabIndex:w})},highlighted:c,selected:s}}function E7(t,e){if(e.type===Li.itemHover)return ve({},t,{highlightedValue:e.item});const n=vw(t,e);if(n.highlightedValue===null&&e.context.items.length>0)return ve({},n,{highlightedValue:e.context.items[0]});if(e.type===Li.keyDown&&e.event.key==="Escape")return ve({},n,{open:!1});if(e.type===Li.blur){var r;if(!((r=e.context.listboxRef.current)!=null&&r.contains(e.event.relatedTarget))){var o,l;const c=(o=e.context.listboxRef.current)==null?void 0:o.getAttribute("id"),s=(l=e.event.relatedTarget)==null?void 0:l.getAttribute("aria-controls");return c&&s&&c===s?n:ve({},n,{open:!1,highlightedValue:e.context.items[0]})}}return n}const z_=H.createContext(null);function T7(t){const e=Array.from(t.keys()).map(n=>{const r=t.get(n);return{key:n,subitem:r}});return e.sort((n,r)=>{const o=n.subitem.ref.current,l=r.subitem.ref.current;return o===null||l===null||o===l?0:o.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_PRECEDING?1:-1}),new Map(e.map(n=>[n.key,n.subitem]))}function yw(){const[t,e]=H.useState(new Map),n=H.useRef(new Set),r=H.useCallback(function(y){n.current.delete(y),e(b=>{const w=new Map(b);return w.delete(y),w})},[]),o=H.useCallback(function(y,b){let w;return typeof y=="function"?w=y(n.current):w=y,n.current.add(w),e(E=>{const T=new Map(E);return T.set(w,b),T}),{id:w,deregister:()=>r(w)}},[r]),l=H.useMemo(()=>T7(t),[t]),c=H.useCallback(function(y){return Array.from(l.keys()).indexOf(y)},[l]);return{contextValue:H.useMemo(()=>({getItemIndex:c,registerItem:o,totalSubitemCount:t.size}),[c,o,t.size]),subitems:l}}function _w(t,e){const n=H.useContext(z_);if(n===null)throw new Error("useCompoundItem must be used within a useCompoundParent");const{registerItem:r}=n,[o,l]=H.useState(typeof t=="function"?void 0:t);return jd(()=>{const{id:c,deregister:s}=r(t,e);return l(c),s},[r,e,t]),{id:o,index:o!==void 0?n.getItemIndex(o):-1,totalItemCount:n.totalSubitemCount}}function Hd(t,e){return function(r={}){const o=ve({},r,t(r));return ve({},o,e(o))}}const P7={dispatch:()=>{},registerPopup:()=>{},state:{open:!0,changeReason:null},triggerElement:null};function A7(t={}){var e,n;const{listboxRef:r,onItemsChange:o,id:l,disabledItemsFocusable:c=!0,disableListWrap:s=!1,autoFocus:m=!0,componentName:y="useMenu"}=t,b=H.useRef(null),w=bi(b,r),E=(e=il(l))!=null?e:"",{state:{open:T,changeReason:R},dispatch:z,triggerElement:I,registerPopup:L}=(n=H.useContext(gw))!=null?n:P7,V=H.useRef(T),{subitems:B,contextValue:W}=yw(),X=H.useMemo(()=>Array.from(B.keys()),[B]),q=H.useCallback(Ke=>{var st,Ee;return Ke==null?null:(st=(Ee=B.get(Ke))==null?void 0:Ee.ref.current)!=null?st:null},[B]),te=H.useCallback(Ke=>{var st;return(B==null||(st=B.get(Ke))==null?void 0:st.disabled)||!1},[B]),se=H.useCallback(Ke=>{var st,Ee;return((st=B.get(Ke))==null?void 0:st.label)||((Ee=B.get(Ke))==null||(Ee=Ee.ref.current)==null?void 0:Ee.innerText)},[B]),re=H.useMemo(()=>({listboxRef:b}),[b]),{dispatch:$,getRootProps:ce,contextValue:Ce,state:{highlightedValue:Se},rootRef:Xe}=EP({disabledItemsFocusable:c,disableListWrap:s,focusManagement:"DOM",getItemDomElement:q,getInitialState:()=>({selectedValues:[],highlightedValue:null}),isItemDisabled:te,items:X,getItemAsString:se,rootRef:w,onItemsChange:o,reducerActionContext:re,selectionMode:"none",stateReducer:E7,componentName:y});jd(()=>{L(E)},[E,L]),jd(()=>{T&&R?.type==="keydown"&&R.key==="ArrowUp"&&$({type:Li.highlightLast,event:R})},[T,R,$]),H.useEffect(()=>{if(T&&m&&Se&&!V.current){var Ke;(Ke=B.get(Se))==null||(Ke=Ke.ref)==null||(Ke=Ke.current)==null||Ke.focus()}},[T,m,Se,B,X]),H.useEffect(()=>{var Ke;if((Ke=b.current)!=null&&Ke.contains(document.activeElement)&&Se!==null){var st;B==null||(st=B.get(Se))==null||(st=st.ref.current)==null||st.focus()}},[Se,B]);const Fe=Ke=>st=>{var Ee,Qe;(Ee=Ke.onBlur)==null||Ee.call(Ke,st),!st.defaultMuiPrevented&&((Qe=b.current)!=null&&Qe.contains(st.relatedTarget)||st.relatedTarget===I||z({type:gu.blur,event:st}))},Me=Ke=>st=>{var Ee;(Ee=Ke.onKeyDown)==null||Ee.call(Ke,st),!st.defaultMuiPrevented&&st.key==="Escape"&&z({type:gu.escapeKeyDown,event:st})},Te=(Ke={})=>({onBlur:Fe(Ke),onKeyDown:Me(Ke)}),Ie=(Ke={})=>{const st=Hd(Te,ce),Ee=ps(Ke);return ve({},Ke,Ee,st(Ee),{id:E,role:"menu"})};return H.useDebugValue({subitems:B,highlightedValue:Se}),{contextValue:ve({},W,Ce),dispatch:$,getListboxProps:Ie,highlightedValue:Se,listboxRef:Xe,menuItems:B,open:T,triggerElement:I}}function I7(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:o,getItemState:l,registerItem:c,totalSubitemCount:s}=e,m=H.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:o}),[r,o,l]),y=H.useMemo(()=>({getItemIndex:o,registerItem:c,totalSubitemCount:s}),[c,o,s]);return oe.jsx(z_.Provider,{value:y,children:oe.jsx(pp.Provider,{value:m,children:n})})}var qS={exports:{}},Ga={},XS={exports:{}},ZS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AR;function R7(){return AR||(AR=1,function(t){function e(Ie,Ke){var st=Ie.length;Ie.push(Ke);e:for(;0<st;){var Ee=st-1>>>1,Qe=Ie[Ee];if(0<o(Qe,Ke))Ie[Ee]=Ke,Ie[st]=Qe,st=Ee;else break e}}function n(Ie){return Ie.length===0?null:Ie[0]}function r(Ie){if(Ie.length===0)return null;var Ke=Ie[0],st=Ie.pop();if(st!==Ke){Ie[0]=st;e:for(var Ee=0,Qe=Ie.length,jt=Qe>>>1;Ee<jt;){var je=2*(Ee+1)-1,ft=Ie[je],At=je+1,ht=Ie[At];if(0>o(ft,st))At<Qe&&0>o(ht,ft)?(Ie[Ee]=ht,Ie[At]=st,Ee=At):(Ie[Ee]=ft,Ie[je]=st,Ee=je);else if(At<Qe&&0>o(ht,st))Ie[Ee]=ht,Ie[At]=st,Ee=At;else break e}}return Ke}function o(Ie,Ke){var st=Ie.sortIndex-Ke.sortIndex;return st!==0?st:Ie.id-Ke.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,s=c.now();t.unstable_now=function(){return c.now()-s}}var m=[],y=[],b=1,w=null,E=3,T=!1,R=!1,z=!1,I=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(Ie){for(var Ke=n(y);Ke!==null;){if(Ke.callback===null)r(y);else if(Ke.startTime<=Ie)r(y),Ke.sortIndex=Ke.expirationTime,e(m,Ke);else break;Ke=n(y)}}function W(Ie){if(z=!1,B(Ie),!R)if(n(m)!==null)R=!0,Me(X);else{var Ke=n(y);Ke!==null&&Te(W,Ke.startTime-Ie)}}function X(Ie,Ke){R=!1,z&&(z=!1,L(se),se=-1),T=!0;var st=E;try{for(B(Ke),w=n(m);w!==null&&(!(w.expirationTime>Ke)||Ie&&!ce());){var Ee=w.callback;if(typeof Ee=="function"){w.callback=null,E=w.priorityLevel;var Qe=Ee(w.expirationTime<=Ke);Ke=t.unstable_now(),typeof Qe=="function"?w.callback=Qe:w===n(m)&&r(m),B(Ke)}else r(m);w=n(m)}if(w!==null)var jt=!0;else{var je=n(y);je!==null&&Te(W,je.startTime-Ke),jt=!1}return jt}finally{w=null,E=st,T=!1}}var q=!1,te=null,se=-1,re=5,$=-1;function ce(){return!(t.unstable_now()-$<re)}function Ce(){if(te!==null){var Ie=t.unstable_now();$=Ie;var Ke=!0;try{Ke=te(!0,Ie)}finally{Ke?Se():(q=!1,te=null)}}else q=!1}var Se;if(typeof V=="function")Se=function(){V(Ce)};else if(typeof MessageChannel<"u"){var Xe=new MessageChannel,Fe=Xe.port2;Xe.port1.onmessage=Ce,Se=function(){Fe.postMessage(null)}}else Se=function(){I(Ce,0)};function Me(Ie){te=Ie,q||(q=!0,Se())}function Te(Ie,Ke){se=I(function(){Ie(t.unstable_now())},Ke)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ie){Ie.callback=null},t.unstable_continueExecution=function(){R||T||(R=!0,Me(X))},t.unstable_forceFrameRate=function(Ie){0>Ie||125<Ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<Ie?Math.floor(1e3/Ie):5},t.unstable_getCurrentPriorityLevel=function(){return E},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(Ie){switch(E){case 1:case 2:case 3:var Ke=3;break;default:Ke=E}var st=E;E=Ke;try{return Ie()}finally{E=st}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ie,Ke){switch(Ie){case 1:case 2:case 3:case 4:case 5:break;default:Ie=3}var st=E;E=Ie;try{return Ke()}finally{E=st}},t.unstable_scheduleCallback=function(Ie,Ke,st){var Ee=t.unstable_now();switch(typeof st=="object"&&st!==null?(st=st.delay,st=typeof st=="number"&&0<st?Ee+st:Ee):st=Ee,Ie){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=st+Qe,Ie={id:b++,callback:Ke,priorityLevel:Ie,startTime:st,expirationTime:Qe,sortIndex:-1},st>Ee?(Ie.sortIndex=st,e(y,Ie),n(m)===null&&Ie===n(y)&&(z?(L(se),se=-1):z=!0,Te(W,st-Ee))):(Ie.sortIndex=Qe,e(m,Ie),R||T||(R=!0,Me(X))),Ie},t.unstable_shouldYield=ce,t.unstable_wrapCallback=function(Ie){var Ke=E;return function(){var st=E;E=Ke;try{return Ie.apply(this,arguments)}finally{E=st}}}}(ZS)),ZS}var IR;function L7(){return IR||(IR=1,XS.exports=R7()),XS.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RR;function D7(){if(RR)return Ga;RR=1;var t=QT(),e=L7();function n(f){for(var v="https://reactjs.org/docs/error-decoder.html?invariant="+f,P=1;P<arguments.length;P++)v+="&args[]="+encodeURIComponent(arguments[P]);return"Minified React error #"+f+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,o={};function l(f,v){c(f,v),c(f+"Capture",v)}function c(f,v){for(o[f]=v,f=0;f<v.length;f++)r.add(v[f])}var s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b={},w={};function E(f){return m.call(w,f)?!0:m.call(b,f)?!1:y.test(f)?w[f]=!0:(b[f]=!0,!1)}function T(f,v,P,O){if(P!==null&&P.type===0)return!1;switch(typeof v){case"function":case"symbol":return!0;case"boolean":return O?!1:P!==null?!P.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function R(f,v,P,O){if(v===null||typeof v>"u"||T(f,v,P,O))return!0;if(O)return!1;if(P!==null)switch(P.type){case 3:return!v;case 4:return v===!1;case 5:return isNaN(v);case 6:return isNaN(v)||1>v}return!1}function z(f,v,P,O,G,J,be){this.acceptsBooleans=v===2||v===3||v===4,this.attributeName=O,this.attributeNamespace=G,this.mustUseProperty=P,this.propertyName=f,this.type=v,this.sanitizeURL=J,this.removeEmptyString=be}var I={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){I[f]=new z(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var v=f[0];I[v]=new z(v,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){I[f]=new z(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){I[f]=new z(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){I[f]=new z(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){I[f]=new z(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){I[f]=new z(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){I[f]=new z(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){I[f]=new z(f,5,!1,f.toLowerCase(),null,!1,!1)});var L=/[\-:]([a-z])/g;function V(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var v=f.replace(L,V);I[v]=new z(v,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var v=f.replace(L,V);I[v]=new z(v,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var v=f.replace(L,V);I[v]=new z(v,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){I[f]=new z(f,1,!1,f.toLowerCase(),null,!1,!1)}),I.xlinkHref=new z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){I[f]=new z(f,1,!1,f.toLowerCase(),null,!0,!0)});function B(f,v,P,O){var G=I.hasOwnProperty(v)?I[v]:null;(G!==null?G.type!==0:O||!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(R(v,P,G,O)&&(P=null),O||G===null?E(v)&&(P===null?f.removeAttribute(v):f.setAttribute(v,""+P)):G.mustUseProperty?f[G.propertyName]=P===null?G.type===3?!1:"":P:(v=G.attributeName,O=G.attributeNamespace,P===null?f.removeAttribute(v):(G=G.type,P=G===3||G===4&&P===!0?"":""+P,O?f.setAttributeNS(O,v,P):f.setAttribute(v,P))))}var W=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,X=Symbol.for("react.element"),q=Symbol.for("react.portal"),te=Symbol.for("react.fragment"),se=Symbol.for("react.strict_mode"),re=Symbol.for("react.profiler"),$=Symbol.for("react.provider"),ce=Symbol.for("react.context"),Ce=Symbol.for("react.forward_ref"),Se=Symbol.for("react.suspense"),Xe=Symbol.for("react.suspense_list"),Fe=Symbol.for("react.memo"),Me=Symbol.for("react.lazy"),Te=Symbol.for("react.offscreen"),Ie=Symbol.iterator;function Ke(f){return f===null||typeof f!="object"?null:(f=Ie&&f[Ie]||f["@@iterator"],typeof f=="function"?f:null)}var st=Object.assign,Ee;function Qe(f){if(Ee===void 0)try{throw Error()}catch(P){var v=P.stack.trim().match(/\n( *(at )?)/);Ee=v&&v[1]||""}return`
`+Ee+f}var jt=!1;function je(f,v){if(!f||jt)return"";jt=!0;var P=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(v)if(v=function(){throw Error()},Object.defineProperty(v.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(v,[])}catch(Bt){var O=Bt}Reflect.construct(f,[],v)}else{try{v.call()}catch(Bt){O=Bt}f.call(v.prototype)}else{try{throw Error()}catch(Bt){O=Bt}f()}}catch(Bt){if(Bt&&O&&typeof Bt.stack=="string"){for(var G=Bt.stack.split(`
`),J=O.stack.split(`
`),be=G.length-1,ot=J.length-1;1<=be&&0<=ot&&G[be]!==J[ot];)ot--;for(;1<=be&&0<=ot;be--,ot--)if(G[be]!==J[ot]){if(be!==1||ot!==1)do if(be--,ot--,0>ot||G[be]!==J[ot]){var gt=`
`+G[be].replace(" at new "," at ");return f.displayName&&gt.includes("<anonymous>")&&(gt=gt.replace("<anonymous>",f.displayName)),gt}while(1<=be&&0<=ot);break}}}finally{jt=!1,Error.prepareStackTrace=P}return(f=f?f.displayName||f.name:"")?Qe(f):""}function ft(f){switch(f.tag){case 5:return Qe(f.type);case 16:return Qe("Lazy");case 13:return Qe("Suspense");case 19:return Qe("SuspenseList");case 0:case 2:case 15:return f=je(f.type,!1),f;case 11:return f=je(f.type.render,!1),f;case 1:return f=je(f.type,!0),f;default:return""}}function At(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case te:return"Fragment";case q:return"Portal";case re:return"Profiler";case se:return"StrictMode";case Se:return"Suspense";case Xe:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case ce:return(f.displayName||"Context")+".Consumer";case $:return(f._context.displayName||"Context")+".Provider";case Ce:var v=f.render;return f=f.displayName,f||(f=v.displayName||v.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case Fe:return v=f.displayName||null,v!==null?v:At(f.type)||"Memo";case Me:v=f._payload,f=f._init;try{return At(f(v))}catch{}}return null}function ht(f){var v=f.type;switch(f.tag){case 24:return"Cache";case 9:return(v.displayName||"Context")+".Consumer";case 10:return(v._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=v.render,f=f.displayName||f.name||"",v.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return v;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return At(v);case 8:return v===se?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof v=="function")return v.displayName||v.name||null;if(typeof v=="string")return v}return null}function lt(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function bt(f){var v=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(v==="checkbox"||v==="radio")}function St(f){var v=bt(f)?"checked":"value",P=Object.getOwnPropertyDescriptor(f.constructor.prototype,v),O=""+f[v];if(!f.hasOwnProperty(v)&&typeof P<"u"&&typeof P.get=="function"&&typeof P.set=="function"){var G=P.get,J=P.set;return Object.defineProperty(f,v,{configurable:!0,get:function(){return G.call(this)},set:function(be){O=""+be,J.call(this,be)}}),Object.defineProperty(f,v,{enumerable:P.enumerable}),{getValue:function(){return O},setValue:function(be){O=""+be},stopTracking:function(){f._valueTracker=null,delete f[v]}}}}function dn(f){f._valueTracker||(f._valueTracker=St(f))}function En(f){if(!f)return!1;var v=f._valueTracker;if(!v)return!0;var P=v.getValue(),O="";return f&&(O=bt(f)?f.checked?"true":"false":f.value),f=O,f!==P?(v.setValue(f),!0):!1}function un(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function et(f,v){var P=v.checked;return st({},v,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:P??f._wrapperState.initialChecked})}function Ln(f,v){var P=v.defaultValue==null?"":v.defaultValue,O=v.checked!=null?v.checked:v.defaultChecked;P=lt(v.value!=null?v.value:P),f._wrapperState={initialChecked:O,initialValue:P,controlled:v.type==="checkbox"||v.type==="radio"?v.checked!=null:v.value!=null}}function Jt(f,v){v=v.checked,v!=null&&B(f,"checked",v,!1)}function fn(f,v){Jt(f,v);var P=lt(v.value),O=v.type;if(P!=null)O==="number"?(P===0&&f.value===""||f.value!=P)&&(f.value=""+P):f.value!==""+P&&(f.value=""+P);else if(O==="submit"||O==="reset"){f.removeAttribute("value");return}v.hasOwnProperty("value")?Nn(f,v.type,P):v.hasOwnProperty("defaultValue")&&Nn(f,v.type,lt(v.defaultValue)),v.checked==null&&v.defaultChecked!=null&&(f.defaultChecked=!!v.defaultChecked)}function $t(f,v,P){if(v.hasOwnProperty("value")||v.hasOwnProperty("defaultValue")){var O=v.type;if(!(O!=="submit"&&O!=="reset"||v.value!==void 0&&v.value!==null))return;v=""+f._wrapperState.initialValue,P||v===f.value||(f.value=v),f.defaultValue=v}P=f.name,P!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,P!==""&&(f.name=P)}function Nn(f,v,P){(v!=="number"||un(f.ownerDocument)!==f)&&(P==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+P&&(f.defaultValue=""+P))}var vn=Array.isArray;function Ue(f,v,P,O){if(f=f.options,v){v={};for(var G=0;G<P.length;G++)v["$"+P[G]]=!0;for(P=0;P<f.length;P++)G=v.hasOwnProperty("$"+f[P].value),f[P].selected!==G&&(f[P].selected=G),G&&O&&(f[P].defaultSelected=!0)}else{for(P=""+lt(P),v=null,G=0;G<f.length;G++){if(f[G].value===P){f[G].selected=!0,O&&(f[G].defaultSelected=!0);return}v!==null||f[G].disabled||(v=f[G])}v!==null&&(v.selected=!0)}}function we(f,v){if(v.dangerouslySetInnerHTML!=null)throw Error(n(91));return st({},v,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function yt(f,v){var P=v.value;if(P==null){if(P=v.children,v=v.defaultValue,P!=null){if(v!=null)throw Error(n(92));if(vn(P)){if(1<P.length)throw Error(n(93));P=P[0]}v=P}v==null&&(v=""),P=v}f._wrapperState={initialValue:lt(P)}}function Nt(f,v){var P=lt(v.value),O=lt(v.defaultValue);P!=null&&(P=""+P,P!==f.value&&(f.value=P),v.defaultValue==null&&f.defaultValue!==P&&(f.defaultValue=P)),O!=null&&(f.defaultValue=""+O)}function Ht(f){var v=f.textContent;v===f._wrapperState.initialValue&&v!==""&&v!==null&&(f.value=v)}function Ot(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ln(f,v){return f==null||f==="http://www.w3.org/1999/xhtml"?Ot(v):f==="http://www.w3.org/2000/svg"&&v==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var Gt,Zt=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(v,P,O,G){MSApp.execUnsafeLocalFunction(function(){return f(v,P,O,G)})}:f}(function(f,v){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=v;else{for(Gt=Gt||document.createElement("div"),Gt.innerHTML="<svg>"+v.valueOf().toString()+"</svg>",v=Gt.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;v.firstChild;)f.appendChild(v.firstChild)}});function Fn(f,v){if(v){var P=f.firstChild;if(P&&P===f.lastChild&&P.nodeType===3){P.nodeValue=v;return}}f.textContent=v}var Yt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pe=["Webkit","ms","Moz","O"];Object.keys(Yt).forEach(function(f){Pe.forEach(function(v){v=v+f.charAt(0).toUpperCase()+f.substring(1),Yt[v]=Yt[f]})});function ae(f,v,P){return v==null||typeof v=="boolean"||v===""?"":P||typeof v!="number"||v===0||Yt.hasOwnProperty(f)&&Yt[f]?(""+v).trim():v+"px"}function ue(f,v){f=f.style;for(var P in v)if(v.hasOwnProperty(P)){var O=P.indexOf("--")===0,G=ae(P,v[P],O);P==="float"&&(P="cssFloat"),O?f.setProperty(P,G):f[P]=G}}var ee=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fe(f,v){if(v){if(ee[f]&&(v.children!=null||v.dangerouslySetInnerHTML!=null))throw Error(n(137,f));if(v.dangerouslySetInnerHTML!=null){if(v.children!=null)throw Error(n(60));if(typeof v.dangerouslySetInnerHTML!="object"||!("__html"in v.dangerouslySetInnerHTML))throw Error(n(61))}if(v.style!=null&&typeof v.style!="object")throw Error(n(62))}}function Oe(f,v){if(f.indexOf("-")===-1)return typeof v.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ye=null;function ye(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Ae=null,Be=null,$e=null;function He(f){if(f=Xc(f)){if(typeof Ae!="function")throw Error(n(280));var v=f.stateNode;v&&(v=Bu(v),Ae(f.stateNode,f.type,v))}}function ut(f){Be?$e?$e.push(f):$e=[f]:Be=f}function We(){if(Be){var f=Be,v=$e;if($e=Be=null,He(f),v)for(f=0;f<v.length;f++)He(v[f])}}function Ut(f,v){return f(v)}function Kt(){}var Re=!1;function it(f,v,P){if(Re)return f(v,P);Re=!0;try{return Ut(f,v,P)}finally{Re=!1,(Be!==null||$e!==null)&&(Kt(),We())}}function mt(f,v){var P=f.stateNode;if(P===null)return null;var O=Bu(P);if(O===null)return null;P=O[v];e:switch(v){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(O=!O.disabled)||(f=f.type,O=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!O;break e;default:f=!1}if(f)return null;if(P&&typeof P!="function")throw Error(n(231,v,typeof P));return P}var Wt=!1;if(s)try{var tn={};Object.defineProperty(tn,"passive",{get:function(){Wt=!0}}),window.addEventListener("test",tn,tn),window.removeEventListener("test",tn,tn)}catch{Wt=!1}function pn(f,v,P,O,G,J,be,ot,gt){var Bt=Array.prototype.slice.call(arguments,3);try{v.apply(P,Bt)}catch(bn){this.onError(bn)}}var rn=!1,on=null,kn=!1,Ct=null,Gn={onError:function(f){rn=!0,on=f}};function On(f,v,P,O,G,J,be,ot,gt){rn=!1,on=null,pn.apply(Gn,arguments)}function or(f,v,P,O,G,J,be,ot,gt){if(On.apply(this,arguments),rn){if(rn){var Bt=on;rn=!1,on=null}else throw Error(n(198));kn||(kn=!0,Ct=Bt)}}function It(f){var v=f,P=f;if(f.alternate)for(;v.return;)v=v.return;else{f=v;do v=f,(v.flags&4098)!==0&&(P=v.return),f=v.return;while(f)}return v.tag===3?P:null}function nt(f){if(f.tag===13){var v=f.memoizedState;if(v===null&&(f=f.alternate,f!==null&&(v=f.memoizedState)),v!==null)return v.dehydrated}return null}function qt(f){if(It(f)!==f)throw Error(n(188))}function cn(f){var v=f.alternate;if(!v){if(v=It(f),v===null)throw Error(n(188));return v!==f?null:f}for(var P=f,O=v;;){var G=P.return;if(G===null)break;var J=G.alternate;if(J===null){if(O=G.return,O!==null){P=O;continue}break}if(G.child===J.child){for(J=G.child;J;){if(J===P)return qt(G),f;if(J===O)return qt(G),v;J=J.sibling}throw Error(n(188))}if(P.return!==O.return)P=G,O=J;else{for(var be=!1,ot=G.child;ot;){if(ot===P){be=!0,P=G,O=J;break}if(ot===O){be=!0,O=G,P=J;break}ot=ot.sibling}if(!be){for(ot=J.child;ot;){if(ot===P){be=!0,P=J,O=G;break}if(ot===O){be=!0,O=J,P=G;break}ot=ot.sibling}if(!be)throw Error(n(189))}}if(P.alternate!==O)throw Error(n(190))}if(P.tag!==3)throw Error(n(188));return P.stateNode.current===P?f:v}function Rn(f){return f=cn(f),f!==null?Ir(f):null}function Ir(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var v=Ir(f);if(v!==null)return v;f=f.sibling}return null}var _r=e.unstable_scheduleCallback,xe=e.unstable_cancelCallback,vt=e.unstable_shouldYield,kt=e.unstable_requestPaint,xt=e.unstable_now,wt=e.unstable_getCurrentPriorityLevel,hn=e.unstable_ImmediatePriority,Pn=e.unstable_UserBlockingPriority,mn=e.unstable_NormalPriority,Tn=e.unstable_LowPriority,Qt=e.unstable_IdlePriority,Zn=null,An=null;function Wn(f){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(Zn,f,void 0,(f.current.flags&128)===128)}catch{}}var tr=Math.clz32?Math.clz32:wr,Or=Math.log,Fr=Math.LN2;function wr(f){return f>>>=0,f===0?32:31-(Or(f)/Fr|0)|0}var ur=64,ui=4194304;function Lr(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Eo(f,v){var P=f.pendingLanes;if(P===0)return 0;var O=0,G=f.suspendedLanes,J=f.pingedLanes,be=P&268435455;if(be!==0){var ot=be&~G;ot!==0?O=Lr(ot):(J&=be,J!==0&&(O=Lr(J)))}else be=P&~G,be!==0?O=Lr(be):J!==0&&(O=Lr(J));if(O===0)return 0;if(v!==0&&v!==O&&(v&G)===0&&(G=O&-O,J=v&-v,G>=J||G===16&&(J&4194240)!==0))return v;if((O&4)!==0&&(O|=P&16),v=f.entangledLanes,v!==0)for(f=f.entanglements,v&=O;0<v;)P=31-tr(v),G=1<<P,O|=f[P],v&=~G;return O}function Ys(f,v){switch(f){case 1:case 2:case 4:return v+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jo(f,v){for(var P=f.suspendedLanes,O=f.pingedLanes,G=f.expirationTimes,J=f.pendingLanes;0<J;){var be=31-tr(J),ot=1<<be,gt=G[be];gt===-1?((ot&P)===0||(ot&O)!==0)&&(G[be]=Ys(ot,v)):gt<=v&&(f.expiredLanes|=ot),J&=~ot}}function Ia(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Zr(){var f=ur;return ur<<=1,(ur&4194240)===0&&(ur=64),f}function uo(f){for(var v=[],P=0;31>P;P++)v.push(f);return v}function Xi(f,v,P){f.pendingLanes|=v,v!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,v=31-tr(v),f[v]=P}function ho(f,v){var P=f.pendingLanes&~v;f.pendingLanes=v,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=v,f.mutableReadLanes&=v,f.entangledLanes&=v,v=f.entanglements;var O=f.eventTimes;for(f=f.expirationTimes;0<P;){var G=31-tr(P),J=1<<G;v[G]=0,O[G]=-1,f[G]=-1,P&=~J}}function Vi(f,v){var P=f.entangledLanes|=v;for(f=f.entanglements;P;){var O=31-tr(P),G=1<<O;G&v|f[O]&v&&(f[O]|=v),P&=~G}}var Nr=0;function io(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var Er,ua,Ra,Xl,tf,zh=!1,Qo=[],No=null,vr=null,Ks=null,Zl=new Map,Oc=new Map,Di=[],Zi="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function To(f,v){switch(f){case"focusin":case"focusout":No=null;break;case"dragenter":case"dragleave":vr=null;break;case"mouseover":case"mouseout":Ks=null;break;case"pointerover":case"pointerout":Zl.delete(v.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oc.delete(v.pointerId)}}function Ni(f,v,P,O,G,J){return f===null||f.nativeEvent!==J?(f={blockedOn:v,domEventName:P,eventSystemFlags:O,nativeEvent:J,targetContainers:[G]},v!==null&&(v=Xc(v),v!==null&&ua(v)),f):(f.eventSystemFlags|=O,v=f.targetContainers,G!==null&&v.indexOf(G)===-1&&v.push(G),f)}function Pi(f,v,P,O,G){switch(v){case"focusin":return No=Ni(No,f,v,P,O,G),!0;case"dragenter":return vr=Ni(vr,f,v,P,O,G),!0;case"mouseover":return Ks=Ni(Ks,f,v,P,O,G),!0;case"pointerover":var J=G.pointerId;return Zl.set(J,Ni(Zl.get(J)||null,f,v,P,O,G)),!0;case"gotpointercapture":return J=G.pointerId,Oc.set(J,Ni(Oc.get(J)||null,f,v,P,O,G)),!0}return!1}function Oh(f){var v=ta(f.target);if(v!==null){var P=It(v);if(P!==null){if(v=P.tag,v===13){if(v=nt(P),v!==null){f.blockedOn=v,tf(f.priority,function(){Ra(P)});return}}else if(v===3&&P.stateNode.current.memoizedState.isDehydrated){f.blockedOn=P.tag===3?P.stateNode.containerInfo:null;return}}}f.blockedOn=null}function Tr(f){if(f.blockedOn!==null)return!1;for(var v=f.targetContainers;0<v.length;){var P=Js(f.domEventName,f.eventSystemFlags,v[0],f.nativeEvent);if(P===null){P=f.nativeEvent;var O=new P.constructor(P.type,P);Ye=O,P.target.dispatchEvent(O),Ye=null}else return v=Xc(P),v!==null&&ua(v),f.blockedOn=P,!1;v.shift()}return!0}function es(f,v,P){Tr(f)&&P.delete(v)}function yr(){zh=!1,No!==null&&Tr(No)&&(No=null),vr!==null&&Tr(vr)&&(vr=null),Ks!==null&&Tr(Ks)&&(Ks=null),Zl.forEach(es),Oc.forEach(es)}function gr(f,v){f.blockedOn===v&&(f.blockedOn=null,zh||(zh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yr)))}function ha(f){function v(G){return gr(G,f)}if(0<Qo.length){gr(Qo[0],f);for(var P=1;P<Qo.length;P++){var O=Qo[P];O.blockedOn===f&&(O.blockedOn=null)}}for(No!==null&&gr(No,f),vr!==null&&gr(vr,f),Ks!==null&&gr(Ks,f),Zl.forEach(v),Oc.forEach(v),P=0;P<Di.length;P++)O=Di[P],O.blockedOn===f&&(O.blockedOn=null);for(;0<Di.length&&(P=Di[0],P.blockedOn===null);)Oh(P),P.blockedOn===null&&Di.shift()}var sr=W.ReactCurrentBatchConfig,La=!0;function ts(f,v,P,O){var G=Nr,J=sr.transition;sr.transition=null;try{Nr=1,Bo(f,v,P,O)}finally{Nr=G,sr.transition=J}}function Cu(f,v,P,O){var G=Nr,J=sr.transition;sr.transition=null;try{Nr=4,Bo(f,v,P,O)}finally{Nr=G,sr.transition=J}}function Bo(f,v,P,O){if(La){var G=Js(f,v,P,O);if(G===null)Ou(f,v,O,Eu,P),To(f,O);else if(Pi(G,f,v,P,O))O.stopPropagation();else if(To(f,O),v&4&&-1<Zi.indexOf(f)){for(;G!==null;){var J=Xc(G);if(J!==null&&Er(J),J=Js(f,v,P,O),J===null&&Ou(f,v,O,Eu,P),J===G)break;G=J}G!==null&&O.stopPropagation()}else Ou(f,v,O,null,P)}}var Eu=null;function Js(f,v,P,O){if(Eu=null,f=ye(O),f=ta(f),f!==null)if(v=It(f),v===null)f=null;else if(P=v.tag,P===13){if(f=nt(v),f!==null)return f;f=null}else if(P===3){if(v.stateNode.current.memoizedState.isDehydrated)return v.tag===3?v.stateNode.containerInfo:null;f=null}else v!==f&&(f=null);return Eu=f,null}function Cp(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wt()){case hn:return 1;case Pn:return 4;case mn:case Tn:return 16;case Qt:return 536870912;default:return 16}default:return 16}}var ll=null,Fc=null,Yl=null;function Qs(){if(Yl)return Yl;var f,v=Fc,P=v.length,O,G="value"in ll?ll.value:ll.textContent,J=G.length;for(f=0;f<P&&v[f]===G[f];f++);var be=P-f;for(O=1;O<=be&&v[P-O]===G[J-O];O++);return Yl=G.slice(f,1<O?1-O:void 0)}function ji(f){var v=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&v===13&&(f=13)):f=v,f===10&&(f=13),32<=f||f===13?f:0}function cl(){return!0}function Tu(){return!1}function fo(f){function v(P,O,G,J,be){this._reactName=P,this._targetInst=G,this.type=O,this.nativeEvent=J,this.target=be,this.currentTarget=null;for(var ot in f)f.hasOwnProperty(ot)&&(P=f[ot],this[ot]=P?P(J):J[ot]);return this.isDefaultPrevented=(J.defaultPrevented!=null?J.defaultPrevented:J.returnValue===!1)?cl:Tu,this.isPropagationStopped=Tu,this}return st(v.prototype,{preventDefault:function(){this.defaultPrevented=!0;var P=this.nativeEvent;P&&(P.preventDefault?P.preventDefault():typeof P.returnValue!="unknown"&&(P.returnValue=!1),this.isDefaultPrevented=cl)},stopPropagation:function(){var P=this.nativeEvent;P&&(P.stopPropagation?P.stopPropagation():typeof P.cancelBubble!="unknown"&&(P.cancelBubble=!0),this.isPropagationStopped=cl)},persist:function(){},isPersistent:cl}),v}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=fo(Si),Da=st({},Si,{view:0,detail:0}),Pu=fo(Da),Ep,ka,ul,Au=st({},Da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lu,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==ul&&(ul&&f.type==="mousemove"?(Ep=f.screenX-ul.screenX,ka=f.screenY-ul.screenY):ka=Ep=0,ul=f),Ep)},movementY:function(f){return"movementY"in f?f.movementY:ka}}),Qm=fo(Au),ns=st({},Au,{dataTransfer:0}),Iu=fo(ns),Ls=st({},Da,{relatedTarget:0}),Uo=fo(Ls),Tp=st({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),Fh=fo(Tp),Ru=st({},Si,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),Pp=fo(Ru),vy=st({},Si,{data:0}),eg=fo(vy),yy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_y={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rf(f){var v=this.nativeEvent;return v.getModifierState?v.getModifierState(f):(f=nf[f])?!!v[f]:!1}function Lu(){return rf}var Nh=st({},Da,{key:function(f){if(f.key){var v=yy[f.key]||f.key;if(v!=="Unidentified")return v}return f.type==="keypress"?(f=ji(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?_y[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lu,charCode:function(f){return f.type==="keypress"?ji(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?ji(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),Ap=fo(Nh),of=st({},Au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),da=fo(of),xy=st({},Da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lu}),Ip=fo(xy),Bh=st({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uh=fo(Bh),tg=st({},Au,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),$h=fo(tg),ng=[9,13,27,32],Kl=s&&"CompositionEvent"in window,Vh=null;s&&"documentMode"in document&&(Vh=document.documentMode);var rg=s&&"TextEvent"in window&&!Vh,ig=s&&(!Kl||Vh&&8<Vh&&11>=Vh),jh=" ",sf=!1;function Rp(f,v){switch(f){case"keyup":return ng.indexOf(v.keyCode)!==-1;case"keydown":return v.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lp(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Jl=!1;function Dp(f,v){switch(f){case"compositionend":return Lp(v);case"keypress":return v.which!==32?null:(sf=!0,jh);case"textInput":return f=v.data,f===jh&&sf?null:f;default:return null}}function Bc(f,v){if(Jl)return f==="compositionend"||!Kl&&Rp(f,v)?(f=Qs(),Yl=Fc=ll=null,Jl=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(v.ctrlKey||v.altKey||v.metaKey)||v.ctrlKey&&v.altKey){if(v.char&&1<v.char.length)return v.char;if(v.which)return String.fromCharCode(v.which)}return null;case"compositionend":return ig&&v.locale!=="ko"?null:v.data;default:return null}}var og={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function af(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v==="input"?!!og[f.type]:v==="textarea"}function Uc(f,v,P,O){ut(O),v=Hc(v,"onChange"),0<v.length&&(P=new Nc("onChange","change",null,P,O),f.push({event:P,listeners:v}))}var Hh=null,Ql=null;function by(f){jp(f,0)}function Gh(f){var v=Na(f);if(En(v))return f}function sg(f,v){if(f==="change")return v}var kp=!1;if(s){var lf;if(s){var Wh="oninput"in document;if(!Wh){var Vr=document.createElement("div");Vr.setAttribute("oninput","return;"),Wh=typeof Vr.oninput=="function"}lf=Wh}else lf=!1;kp=lf&&(!document.documentMode||9<document.documentMode)}function qh(){Hh&&(Hh.detachEvent("onpropertychange",za),Ql=Hh=null)}function za(f){if(f.propertyName==="value"&&Gh(Ql)){var v=[];Uc(v,Ql,f,ye(f)),it(by,v)}}function zp(f,v,P){f==="focusin"?(qh(),Hh=v,Ql=P,Hh.attachEvent("onpropertychange",za)):f==="focusout"&&qh()}function Op(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return Gh(Ql)}function Fp(f,v){if(f==="click")return Gh(v)}function ag(f,v){if(f==="input"||f==="change")return Gh(v)}function Np(f,v){return f===v&&(f!==0||1/f===1/v)||f!==f&&v!==v}var Po=typeof Object.is=="function"?Object.is:Np;function $c(f,v){if(Po(f,v))return!0;if(typeof f!="object"||f===null||typeof v!="object"||v===null)return!1;var P=Object.keys(f),O=Object.keys(v);if(P.length!==O.length)return!1;for(O=0;O<P.length;O++){var G=P[O];if(!m.call(v,G)||!Po(f[G],v[G]))return!1}return!0}function lg(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function cg(f,v){var P=lg(f);f=0;for(var O;P;){if(P.nodeType===3){if(O=f+P.textContent.length,f<=v&&O>=v)return{node:P,offset:v-f};f=O}e:{for(;P;){if(P.nextSibling){P=P.nextSibling;break e}P=P.parentNode}P=void 0}P=lg(P)}}function ug(f,v){return f&&v?f===v?!0:f&&f.nodeType===3?!1:v&&v.nodeType===3?ug(f,v.parentNode):"contains"in f?f.contains(v):f.compareDocumentPosition?!!(f.compareDocumentPosition(v)&16):!1:!1}function hg(){for(var f=window,v=un();v instanceof f.HTMLIFrameElement;){try{var P=typeof v.contentWindow.location.href=="string"}catch{P=!1}if(P)f=v.contentWindow;else break;v=un(f.document)}return v}function cf(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v&&(v==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||v==="textarea"||f.contentEditable==="true")}function wy(f){var v=hg(),P=f.focusedElem,O=f.selectionRange;if(v!==P&&P&&P.ownerDocument&&ug(P.ownerDocument.documentElement,P)){if(O!==null&&cf(P)){if(v=O.start,f=O.end,f===void 0&&(f=v),"selectionStart"in P)P.selectionStart=v,P.selectionEnd=Math.min(f,P.value.length);else if(f=(v=P.ownerDocument||document)&&v.defaultView||window,f.getSelection){f=f.getSelection();var G=P.textContent.length,J=Math.min(O.start,G);O=O.end===void 0?J:Math.min(O.end,G),!f.extend&&J>O&&(G=O,O=J,J=G),G=cg(P,J);var be=cg(P,O);G&&be&&(f.rangeCount!==1||f.anchorNode!==G.node||f.anchorOffset!==G.offset||f.focusNode!==be.node||f.focusOffset!==be.offset)&&(v=v.createRange(),v.setStart(G.node,G.offset),f.removeAllRanges(),J>O?(f.addRange(v),f.extend(be.node,be.offset)):(v.setEnd(be.node,be.offset),f.addRange(v)))}}for(v=[],f=P;f=f.parentNode;)f.nodeType===1&&v.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<v.length;P++)f=v[P],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var dg=s&&"documentMode"in document&&11>=document.documentMode,hl=null,Du=null,ec=null,Xh=!1;function tc(f,v,P){var O=P.window===P?P.document:P.nodeType===9?P:P.ownerDocument;Xh||hl==null||hl!==un(O)||(O=hl,"selectionStart"in O&&cf(O)?O={start:O.selectionStart,end:O.selectionEnd}:(O=(O.ownerDocument&&O.ownerDocument.defaultView||window).getSelection(),O={anchorNode:O.anchorNode,anchorOffset:O.anchorOffset,focusNode:O.focusNode,focusOffset:O.focusOffset}),ec&&$c(ec,O)||(ec=O,O=Hc(Du,"onSelect"),0<O.length&&(v=new Nc("onSelect","select",null,v,P),f.push({event:v,listeners:O}),v.target=hl)))}function nc(f,v){var P={};return P[f.toLowerCase()]=v.toLowerCase(),P["Webkit"+f]="webkit"+v,P["Moz"+f]="moz"+v,P}var fa={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},vs={},Bp={};s&&(Bp=document.createElement("div").style,"AnimationEvent"in window||(delete fa.animationend.animation,delete fa.animationiteration.animation,delete fa.animationstart.animation),"TransitionEvent"in window||delete fa.transitionend.transition);function Zh(f){if(vs[f])return vs[f];if(!fa[f])return f;var v=fa[f],P;for(P in v)if(v.hasOwnProperty(P)&&P in Bp)return vs[f]=v[P];return f}var uf=Zh("animationend"),rc=Zh("animationiteration"),Yh=Zh("animationstart"),Kh=Zh("transitionend"),ku=new Map,Vc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function dl(f,v){ku.set(f,v),l(v,[f])}for(var ic=0;ic<Vc.length;ic++){var oc=Vc[ic],Up=oc.toLowerCase(),$p=oc[0].toUpperCase()+oc.slice(1);dl(Up,"on"+$p)}dl(uf,"onAnimationEnd"),dl(rc,"onAnimationIteration"),dl(Yh,"onAnimationStart"),dl("dblclick","onDoubleClick"),dl("focusin","onFocus"),dl("focusout","onBlur"),dl(Kh,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jc=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sr));function Vp(f,v,P){var O=f.type||"unknown-event";f.currentTarget=P,or(O,v,void 0,f),f.currentTarget=null}function jp(f,v){v=(v&4)!==0;for(var P=0;P<f.length;P++){var O=f[P],G=O.event;O=O.listeners;e:{var J=void 0;if(v)for(var be=O.length-1;0<=be;be--){var ot=O[be],gt=ot.instance,Bt=ot.currentTarget;if(ot=ot.listener,gt!==J&&G.isPropagationStopped())break e;Vp(G,ot,Bt),J=gt}else for(be=0;be<O.length;be++){if(ot=O[be],gt=ot.instance,Bt=ot.currentTarget,ot=ot.listener,gt!==J&&G.isPropagationStopped())break e;Vp(G,ot,Bt),J=gt}}}if(kn)throw f=Ct,kn=!1,Ct=null,f}function oi(f,v){var P=v[Fu];P===void 0&&(P=v[Fu]=new Set);var O=f+"__bubble";P.has(O)||(Gp(v,f,2,!1),P.add(O))}function Hp(f,v,P){var O=0;v&&(O|=4),Gp(P,f,O,v)}var hf="_reactListening"+Math.random().toString(36).slice(2);function zu(f){if(!f[hf]){f[hf]=!0,r.forEach(function(P){P!=="selectionchange"&&(jc.has(P)||Hp(P,!1,f),Hp(P,!0,f))});var v=f.nodeType===9?f:f.ownerDocument;v===null||v[hf]||(v[hf]=!0,Hp("selectionchange",!1,v))}}function Gp(f,v,P,O){switch(Cp(v)){case 1:var G=ts;break;case 4:G=Cu;break;default:G=Bo}P=G.bind(null,v,P,f),G=void 0,!Wt||v!=="touchstart"&&v!=="touchmove"&&v!=="wheel"||(G=!0),O?G!==void 0?f.addEventListener(v,P,{capture:!0,passive:G}):f.addEventListener(v,P,!0):G!==void 0?f.addEventListener(v,P,{passive:G}):f.addEventListener(v,P,!1)}function Ou(f,v,P,O,G){var J=O;if((v&1)===0&&(v&2)===0&&O!==null)e:for(;;){if(O===null)return;var be=O.tag;if(be===3||be===4){var ot=O.stateNode.containerInfo;if(ot===G||ot.nodeType===8&&ot.parentNode===G)break;if(be===4)for(be=O.return;be!==null;){var gt=be.tag;if((gt===3||gt===4)&&(gt=be.stateNode.containerInfo,gt===G||gt.nodeType===8&&gt.parentNode===G))return;be=be.return}for(;ot!==null;){if(be=ta(ot),be===null)return;if(gt=be.tag,gt===5||gt===6){O=J=be;continue e}ot=ot.parentNode}}O=O.return}it(function(){var Bt=J,bn=ye(P),Mn=[];e:{var yn=ku.get(f);if(yn!==void 0){var Un=Nc,Yn=f;switch(f){case"keypress":if(ji(P)===0)break e;case"keydown":case"keyup":Un=Ap;break;case"focusin":Yn="focus",Un=Uo;break;case"focusout":Yn="blur",Un=Uo;break;case"beforeblur":case"afterblur":Un=Uo;break;case"click":if(P.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Un=Qm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Un=Iu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Un=Ip;break;case uf:case rc:case Yh:Un=Fh;break;case Kh:Un=Uh;break;case"scroll":Un=Pu;break;case"wheel":Un=$h;break;case"copy":case"cut":case"paste":Un=Pp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Un=da}var rr=(v&4)!==0,Wi=!rr&&f==="scroll",Lt=rr?yn!==null?yn+"Capture":null:yn;rr=[];for(var _t=Bt,zt;_t!==null;){zt=_t;var In=zt.stateNode;if(zt.tag===5&&In!==null&&(zt=In,Lt!==null&&(In=mt(_t,Lt),In!=null&&rr.push(sc(_t,In,zt)))),Wi)break;_t=_t.return}0<rr.length&&(yn=new Un(yn,Yn,null,P,bn),Mn.push({event:yn,listeners:rr}))}}if((v&7)===0){e:{if(yn=f==="mouseover"||f==="pointerover",Un=f==="mouseout"||f==="pointerout",yn&&P!==Ye&&(Yn=P.relatedTarget||P.fromElement)&&(ta(Yn)||Yn[Yi]))break e;if((Un||yn)&&(yn=bn.window===bn?bn:(yn=bn.ownerDocument)?yn.defaultView||yn.parentWindow:window,Un?(Yn=P.relatedTarget||P.toElement,Un=Bt,Yn=Yn?ta(Yn):null,Yn!==null&&(Wi=It(Yn),Yn!==Wi||Yn.tag!==5&&Yn.tag!==6)&&(Yn=null)):(Un=null,Yn=Bt),Un!==Yn)){if(rr=Qm,In="onMouseLeave",Lt="onMouseEnter",_t="mouse",(f==="pointerout"||f==="pointerover")&&(rr=da,In="onPointerLeave",Lt="onPointerEnter",_t="pointer"),Wi=Un==null?yn:Na(Un),zt=Yn==null?yn:Na(Yn),yn=new rr(In,_t+"leave",Un,P,bn),yn.target=Wi,yn.relatedTarget=zt,In=null,ta(bn)===Bt&&(rr=new rr(Lt,_t+"enter",Yn,P,bn),rr.target=zt,rr.relatedTarget=Wi,In=rr),Wi=In,Un&&Yn)t:{for(rr=Un,Lt=Yn,_t=0,zt=rr;zt;zt=Oa(zt))_t++;for(zt=0,In=Lt;In;In=Oa(In))zt++;for(;0<_t-zt;)rr=Oa(rr),_t--;for(;0<zt-_t;)Lt=Oa(Lt),zt--;for(;_t--;){if(rr===Lt||Lt!==null&&rr===Lt.alternate)break t;rr=Oa(rr),Lt=Oa(Lt)}rr=null}else rr=null;Un!==null&&Jh(Mn,yn,Un,rr,!1),Yn!==null&&Wi!==null&&Jh(Mn,Wi,Yn,rr,!0)}}e:{if(yn=Bt?Na(Bt):window,Un=yn.nodeName&&yn.nodeName.toLowerCase(),Un==="select"||Un==="input"&&yn.type==="file")var cr=sg;else if(af(yn))if(kp)cr=ag;else{cr=Op;var fr=zp}else(Un=yn.nodeName)&&Un.toLowerCase()==="input"&&(yn.type==="checkbox"||yn.type==="radio")&&(cr=Fp);if(cr&&(cr=cr(f,Bt))){Uc(Mn,cr,P,bn);break e}fr&&fr(f,yn,Bt),f==="focusout"&&(fr=yn._wrapperState)&&fr.controlled&&yn.type==="number"&&Nn(yn,"number",yn.value)}switch(fr=Bt?Na(Bt):window,f){case"focusin":(af(fr)||fr.contentEditable==="true")&&(hl=fr,Du=Bt,ec=null);break;case"focusout":ec=Du=hl=null;break;case"mousedown":Xh=!0;break;case"contextmenu":case"mouseup":case"dragend":Xh=!1,tc(Mn,P,bn);break;case"selectionchange":if(dg)break;case"keydown":case"keyup":tc(Mn,P,bn)}var pr;if(Kl)e:{switch(f){case"compositionstart":var mr="onCompositionStart";break e;case"compositionend":mr="onCompositionEnd";break e;case"compositionupdate":mr="onCompositionUpdate";break e}mr=void 0}else Jl?Rp(f,P)&&(mr="onCompositionEnd"):f==="keydown"&&P.keyCode===229&&(mr="onCompositionStart");mr&&(ig&&P.locale!=="ko"&&(Jl||mr!=="onCompositionStart"?mr==="onCompositionEnd"&&Jl&&(pr=Qs()):(ll=bn,Fc="value"in ll?ll.value:ll.textContent,Jl=!0)),fr=Hc(Bt,mr),0<fr.length&&(mr=new eg(mr,f,null,P,bn),Mn.push({event:mr,listeners:fr}),pr?mr.data=pr:(pr=Lp(P),pr!==null&&(mr.data=pr)))),(pr=rg?Dp(f,P):Bc(f,P))&&(Bt=Hc(Bt,"onBeforeInput"),0<Bt.length&&(bn=new eg("onBeforeInput","beforeinput",null,P,bn),Mn.push({event:bn,listeners:Bt}),bn.data=pr))}jp(Mn,v)})}function sc(f,v,P){return{instance:f,listener:v,currentTarget:P}}function Hc(f,v){for(var P=v+"Capture",O=[];f!==null;){var G=f,J=G.stateNode;G.tag===5&&J!==null&&(G=J,J=mt(f,P),J!=null&&O.unshift(sc(f,J,G)),J=mt(f,v),J!=null&&O.push(sc(f,J,G))),f=f.return}return O}function Oa(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function Jh(f,v,P,O,G){for(var J=v._reactName,be=[];P!==null&&P!==O;){var ot=P,gt=ot.alternate,Bt=ot.stateNode;if(gt!==null&&gt===O)break;ot.tag===5&&Bt!==null&&(ot=Bt,G?(gt=mt(P,J),gt!=null&&be.unshift(sc(P,gt,ot))):G||(gt=mt(P,J),gt!=null&&be.push(sc(P,gt,ot)))),P=P.return}be.length!==0&&f.push({event:v,listeners:be})}var Wp=/\r\n?/g,Qh=/\u0000|\uFFFD/g;function Gc(f){return(typeof f=="string"?f:""+f).replace(Wp,`
`).replace(Qh,"")}function fl(f,v,P){if(v=Gc(v),Gc(f)!==v&&P)throw Error(n(425))}function ac(){}var ed=null,Fa=null;function qp(f,v){return f==="textarea"||f==="noscript"||typeof v.children=="string"||typeof v.children=="number"||typeof v.dangerouslySetInnerHTML=="object"&&v.dangerouslySetInnerHTML!==null&&v.dangerouslySetInnerHTML.__html!=null}var df=typeof setTimeout=="function"?setTimeout:void 0,ff=typeof clearTimeout=="function"?clearTimeout:void 0,pf=typeof Promise=="function"?Promise:void 0,fg=typeof queueMicrotask=="function"?queueMicrotask:typeof pf<"u"?function(f){return pf.resolve(null).then(f).catch(pg)}:df;function pg(f){setTimeout(function(){throw f})}function Wc(f,v){var P=v,O=0;do{var G=P.nextSibling;if(f.removeChild(P),G&&G.nodeType===8)if(P=G.data,P==="/$"){if(O===0){f.removeChild(G),ha(v);return}O--}else P!=="$"&&P!=="$?"&&P!=="$!"||O++;P=G}while(P);ha(v)}function pa(f){for(;f!=null;f=f.nextSibling){var v=f.nodeType;if(v===1||v===3)break;if(v===8){if(v=f.data,v==="$"||v==="$!"||v==="$?")break;if(v==="/$")return null}}return f}function td(f){f=f.previousSibling;for(var v=0;f;){if(f.nodeType===8){var P=f.data;if(P==="$"||P==="$!"||P==="$?"){if(v===0)return f;v--}else P==="/$"&&v++}f=f.previousSibling}return null}var qc=Math.random().toString(36).slice(2),Yr="__reactFiber$"+qc,ea="__reactProps$"+qc,Yi="__reactContainer$"+qc,Fu="__reactEvents$"+qc,nd="__reactListeners$"+qc,Nu="__reactHandles$"+qc;function ta(f){var v=f[Yr];if(v)return v;for(var P=f.parentNode;P;){if(v=P[Yi]||P[Yr]){if(P=v.alternate,v.child!==null||P!==null&&P.child!==null)for(f=td(f);f!==null;){if(P=f[Yr])return P;f=td(f)}return v}f=P,P=f.parentNode}return null}function Xc(f){return f=f[Yr]||f[Yi],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function Na(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(n(33))}function Bu(f){return f[ea]||null}var mf=[],Zc=-1;function Ds(f){return{current:f}}function ri(f){0>Zc||(f.current=mf[Zc],mf[Zc]=null,Zc--)}function Pr(f,v){Zc++,mf[Zc]=f.current,f.current=v}var po={},mo=Ds(po),rs=Ds(!1),lc=po;function ma(f,v){var P=f.type.contextTypes;if(!P)return po;var O=f.stateNode;if(O&&O.__reactInternalMemoizedUnmaskedChildContext===v)return O.__reactInternalMemoizedMaskedChildContext;var G={},J;for(J in P)G[J]=v[J];return O&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=v,f.__reactInternalMemoizedMaskedChildContext=G),G}function $o(f){return f=f.childContextTypes,f!=null}function Yc(){ri(rs),ri(mo)}function Xp(f,v,P){if(mo.current!==po)throw Error(n(168));Pr(mo,v),Pr(rs,P)}function rd(f,v,P){var O=f.stateNode;if(v=v.childContextTypes,typeof O.getChildContext!="function")return P;O=O.getChildContext();for(var G in O)if(!(G in v))throw Error(n(108,ht(f)||"Unknown",G));return st({},P,O)}function Kc(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||po,lc=mo.current,Pr(mo,f),Pr(rs,rs.current),!0}function Jc(f,v,P){var O=f.stateNode;if(!O)throw Error(n(169));P?(f=rd(f,v,lc),O.__reactInternalMemoizedMergedChildContext=f,ri(rs),ri(mo),Pr(mo,f)):ri(rs),Pr(rs,P)}var Ki=null,ys=!1,gf=!1;function Vo(f){Ki===null?Ki=[f]:Ki.push(f)}function Uu(f){ys=!0,Vo(f)}function cc(){if(!gf&&Ki!==null){gf=!0;var f=0,v=Nr;try{var P=Ki;for(Nr=1;f<P.length;f++){var O=P[f];do O=O(!0);while(O!==null)}Ki=null,ys=!1}catch(G){throw Ki!==null&&(Ki=Ki.slice(f+1)),_r(hn,cc),G}finally{Nr=v,gf=!1}}return null}var pl=[],$u=0,Vu=null,uc=0,Ao=[],Hi=0,zn=null,ga=1,ks="";function ml(f,v){pl[$u++]=uc,pl[$u++]=Vu,Vu=f,uc=v}function ju(f,v,P){Ao[Hi++]=ga,Ao[Hi++]=ks,Ao[Hi++]=zn,zn=f;var O=ga;f=ks;var G=32-tr(O)-1;O&=~(1<<G),P+=1;var J=32-tr(v)+G;if(30<J){var be=G-G%5;J=(O&(1<<be)-1).toString(32),O>>=be,G-=be,ga=1<<32-tr(v)+G|P<<G|O,ks=J+f}else ga=1<<J|P<<G|O,ks=f}function hc(f){f.return!==null&&(ml(f,1),ju(f,1,0))}function id(f){for(;f===Vu;)Vu=pl[--$u],pl[$u]=null,uc=pl[--$u],pl[$u]=null;for(;f===zn;)zn=Ao[--Hi],Ao[Hi]=null,ks=Ao[--Hi],Ao[Hi]=null,ga=Ao[--Hi],Ao[Hi]=null}var dr=null,is=null,Mi=!1,_s=null;function mg(f,v){var P=Ha(5,null,null,0);P.elementType="DELETED",P.stateNode=v,P.return=f,v=f.deletions,v===null?(f.deletions=[P],f.flags|=16):v.push(P)}function gg(f,v){switch(f.tag){case 5:var P=f.type;return v=v.nodeType!==1||P.toLowerCase()!==v.nodeName.toLowerCase()?null:v,v!==null?(f.stateNode=v,dr=f,is=pa(v.firstChild),!0):!1;case 6:return v=f.pendingProps===""||v.nodeType!==3?null:v,v!==null?(f.stateNode=v,dr=f,is=null,!0):!1;case 13:return v=v.nodeType!==8?null:v,v!==null?(P=zn!==null?{id:ga,overflow:ks}:null,f.memoizedState={dehydrated:v,treeContext:P,retryLane:1073741824},P=Ha(18,null,null,0),P.stateNode=v,P.return=f,f.child=P,dr=f,is=null,!0):!1;default:return!1}}function od(f){return(f.mode&1)!==0&&(f.flags&128)===0}function Hu(f){if(Mi){var v=is;if(v){var P=v;if(!gg(f,v)){if(od(f))throw Error(n(418));v=pa(P.nextSibling);var O=dr;v&&gg(f,v)?mg(O,P):(f.flags=f.flags&-4097|2,Mi=!1,dr=f)}}else{if(od(f))throw Error(n(418));f.flags=f.flags&-4097|2,Mi=!1,dr=f}}}function vf(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;dr=f}function sd(f){if(f!==dr)return!1;if(!Mi)return vf(f),Mi=!0,!1;var v;if((v=f.tag!==3)&&!(v=f.tag!==5)&&(v=f.type,v=v!=="head"&&v!=="body"&&!qp(f.type,f.memoizedProps)),v&&(v=is)){if(od(f))throw Gu(),Error(n(418));for(;v;)mg(f,v),v=pa(v.nextSibling)}if(vf(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(n(317));e:{for(f=f.nextSibling,v=0;f;){if(f.nodeType===8){var P=f.data;if(P==="/$"){if(v===0){is=pa(f.nextSibling);break e}v--}else P!=="$"&&P!=="$!"&&P!=="$?"||v++}f=f.nextSibling}is=null}}else is=dr?pa(f.stateNode.nextSibling):null;return!0}function Gu(){for(var f=is;f;)f=pa(f.nextSibling)}function Wu(){is=dr=null,Mi=!1}function ad(f){_s===null?_s=[f]:_s.push(f)}var dc=W.ReactCurrentBatchConfig;function si(f,v,P){if(f=P.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(P._owner){if(P=P._owner,P){if(P.tag!==1)throw Error(n(309));var O=P.stateNode}if(!O)throw Error(n(147,f));var G=O,J=""+f;return v!==null&&v.ref!==null&&typeof v.ref=="function"&&v.ref._stringRef===J?v.ref:(v=function(be){var ot=G.refs;be===null?delete ot[J]:ot[J]=be},v._stringRef=J,v)}if(typeof f!="string")throw Error(n(284));if(!P._owner)throw Error(n(290,f))}return f}function fc(f,v){throw f=Object.prototype.toString.call(v),Error(n(31,f==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":f))}function ld(f){var v=f._init;return v(f._payload)}function yf(f){function v(Lt,_t){if(f){var zt=Lt.deletions;zt===null?(Lt.deletions=[_t],Lt.flags|=16):zt.push(_t)}}function P(Lt,_t){if(!f)return null;for(;_t!==null;)v(Lt,_t),_t=_t.sibling;return null}function O(Lt,_t){for(Lt=new Map;_t!==null;)_t.key!==null?Lt.set(_t.key,_t):Lt.set(_t.index,_t),_t=_t.sibling;return Lt}function G(Lt,_t){return Lt=iu(Lt,_t),Lt.index=0,Lt.sibling=null,Lt}function J(Lt,_t,zt){return Lt.index=zt,f?(zt=Lt.alternate,zt!==null?(zt=zt.index,zt<_t?(Lt.flags|=2,_t):zt):(Lt.flags|=2,_t)):(Lt.flags|=1048576,_t)}function be(Lt){return f&&Lt.alternate===null&&(Lt.flags|=2),Lt}function ot(Lt,_t,zt,In){return _t===null||_t.tag!==6?(_t=Dg(zt,Lt.mode,In),_t.return=Lt,_t):(_t=G(_t,zt),_t.return=Lt,_t)}function gt(Lt,_t,zt,In){var cr=zt.type;return cr===te?bn(Lt,_t,zt.props.children,In,zt.key):_t!==null&&(_t.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Me&&ld(cr)===_t.type)?(In=G(_t,zt.props),In.ref=si(Lt,_t,zt),In.return=Lt,In):(In=Lg(zt.type,zt.key,zt.props,null,Lt.mode,In),In.ref=si(Lt,_t,zt),In.return=Lt,In)}function Bt(Lt,_t,zt,In){return _t===null||_t.tag!==4||_t.stateNode.containerInfo!==zt.containerInfo||_t.stateNode.implementation!==zt.implementation?(_t=am(zt,Lt.mode,In),_t.return=Lt,_t):(_t=G(_t,zt.children||[]),_t.return=Lt,_t)}function bn(Lt,_t,zt,In,cr){return _t===null||_t.tag!==7?(_t=Cd(zt,Lt.mode,In,cr),_t.return=Lt,_t):(_t=G(_t,zt),_t.return=Lt,_t)}function Mn(Lt,_t,zt){if(typeof _t=="string"&&_t!==""||typeof _t=="number")return _t=Dg(""+_t,Lt.mode,zt),_t.return=Lt,_t;if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case X:return zt=Lg(_t.type,_t.key,_t.props,null,Lt.mode,zt),zt.ref=si(Lt,null,_t),zt.return=Lt,zt;case q:return _t=am(_t,Lt.mode,zt),_t.return=Lt,_t;case Me:var In=_t._init;return Mn(Lt,In(_t._payload),zt)}if(vn(_t)||Ke(_t))return _t=Cd(_t,Lt.mode,zt,null),_t.return=Lt,_t;fc(Lt,_t)}return null}function yn(Lt,_t,zt,In){var cr=_t!==null?_t.key:null;if(typeof zt=="string"&&zt!==""||typeof zt=="number")return cr!==null?null:ot(Lt,_t,""+zt,In);if(typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case X:return zt.key===cr?gt(Lt,_t,zt,In):null;case q:return zt.key===cr?Bt(Lt,_t,zt,In):null;case Me:return cr=zt._init,yn(Lt,_t,cr(zt._payload),In)}if(vn(zt)||Ke(zt))return cr!==null?null:bn(Lt,_t,zt,In,null);fc(Lt,zt)}return null}function Un(Lt,_t,zt,In,cr){if(typeof In=="string"&&In!==""||typeof In=="number")return Lt=Lt.get(zt)||null,ot(_t,Lt,""+In,cr);if(typeof In=="object"&&In!==null){switch(In.$$typeof){case X:return Lt=Lt.get(In.key===null?zt:In.key)||null,gt(_t,Lt,In,cr);case q:return Lt=Lt.get(In.key===null?zt:In.key)||null,Bt(_t,Lt,In,cr);case Me:var fr=In._init;return Un(Lt,_t,zt,fr(In._payload),cr)}if(vn(In)||Ke(In))return Lt=Lt.get(zt)||null,bn(_t,Lt,In,cr,null);fc(_t,In)}return null}function Yn(Lt,_t,zt,In){for(var cr=null,fr=null,pr=_t,mr=_t=0,Io=null;pr!==null&&mr<zt.length;mr++){pr.index>mr?(Io=pr,pr=null):Io=pr.sibling;var ni=yn(Lt,pr,zt[mr],In);if(ni===null){pr===null&&(pr=Io);break}f&&pr&&ni.alternate===null&&v(Lt,pr),_t=J(ni,_t,mr),fr===null?cr=ni:fr.sibling=ni,fr=ni,pr=Io}if(mr===zt.length)return P(Lt,pr),Mi&&ml(Lt,mr),cr;if(pr===null){for(;mr<zt.length;mr++)pr=Mn(Lt,zt[mr],In),pr!==null&&(_t=J(pr,_t,mr),fr===null?cr=pr:fr.sibling=pr,fr=pr);return Mi&&ml(Lt,mr),cr}for(pr=O(Lt,pr);mr<zt.length;mr++)Io=Un(pr,Lt,mr,zt[mr],In),Io!==null&&(f&&Io.alternate!==null&&pr.delete(Io.key===null?mr:Io.key),_t=J(Io,_t,mr),fr===null?cr=Io:fr.sibling=Io,fr=Io);return f&&pr.forEach(function(xc){return v(Lt,xc)}),Mi&&ml(Lt,mr),cr}function rr(Lt,_t,zt,In){var cr=Ke(zt);if(typeof cr!="function")throw Error(n(150));if(zt=cr.call(zt),zt==null)throw Error(n(151));for(var fr=cr=null,pr=_t,mr=_t=0,Io=null,ni=zt.next();pr!==null&&!ni.done;mr++,ni=zt.next()){pr.index>mr?(Io=pr,pr=null):Io=pr.sibling;var xc=yn(Lt,pr,ni.value,In);if(xc===null){pr===null&&(pr=Io);break}f&&pr&&xc.alternate===null&&v(Lt,pr),_t=J(xc,_t,mr),fr===null?cr=xc:fr.sibling=xc,fr=xc,pr=Io}if(ni.done)return P(Lt,pr),Mi&&ml(Lt,mr),cr;if(pr===null){for(;!ni.done;mr++,ni=zt.next())ni=Mn(Lt,ni.value,In),ni!==null&&(_t=J(ni,_t,mr),fr===null?cr=ni:fr.sibling=ni,fr=ni);return Mi&&ml(Lt,mr),cr}for(pr=O(Lt,pr);!ni.done;mr++,ni=zt.next())ni=Un(pr,Lt,mr,ni.value,In),ni!==null&&(f&&ni.alternate!==null&&pr.delete(ni.key===null?mr:ni.key),_t=J(ni,_t,mr),fr===null?cr=ni:fr.sibling=ni,fr=ni);return f&&pr.forEach(function(Ux){return v(Lt,Ux)}),Mi&&ml(Lt,mr),cr}function Wi(Lt,_t,zt,In){if(typeof zt=="object"&&zt!==null&&zt.type===te&&zt.key===null&&(zt=zt.props.children),typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case X:e:{for(var cr=zt.key,fr=_t;fr!==null;){if(fr.key===cr){if(cr=zt.type,cr===te){if(fr.tag===7){P(Lt,fr.sibling),_t=G(fr,zt.props.children),_t.return=Lt,Lt=_t;break e}}else if(fr.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Me&&ld(cr)===fr.type){P(Lt,fr.sibling),_t=G(fr,zt.props),_t.ref=si(Lt,fr,zt),_t.return=Lt,Lt=_t;break e}P(Lt,fr);break}else v(Lt,fr);fr=fr.sibling}zt.type===te?(_t=Cd(zt.props.children,Lt.mode,In,zt.key),_t.return=Lt,Lt=_t):(In=Lg(zt.type,zt.key,zt.props,null,Lt.mode,In),In.ref=si(Lt,_t,zt),In.return=Lt,Lt=In)}return be(Lt);case q:e:{for(fr=zt.key;_t!==null;){if(_t.key===fr)if(_t.tag===4&&_t.stateNode.containerInfo===zt.containerInfo&&_t.stateNode.implementation===zt.implementation){P(Lt,_t.sibling),_t=G(_t,zt.children||[]),_t.return=Lt,Lt=_t;break e}else{P(Lt,_t);break}else v(Lt,_t);_t=_t.sibling}_t=am(zt,Lt.mode,In),_t.return=Lt,Lt=_t}return be(Lt);case Me:return fr=zt._init,Wi(Lt,_t,fr(zt._payload),In)}if(vn(zt))return Yn(Lt,_t,zt,In);if(Ke(zt))return rr(Lt,_t,zt,In);fc(Lt,zt)}return typeof zt=="string"&&zt!==""||typeof zt=="number"?(zt=""+zt,_t!==null&&_t.tag===6?(P(Lt,_t.sibling),_t=G(_t,zt),_t.return=Lt,Lt=_t):(P(Lt,_t),_t=Dg(zt,Lt.mode,In),_t.return=Lt,Lt=_t),be(Lt)):P(Lt,_t)}return Wi}var Qc=yf(!0),Zp=yf(!1),_f=Ds(null),zs=null,gl=null,$n=null;function ar(){$n=gl=zs=null}function qu(f){var v=_f.current;ri(_f),f._currentValue=v}function cd(f,v,P){for(;f!==null;){var O=f.alternate;if((f.childLanes&v)!==v?(f.childLanes|=v,O!==null&&(O.childLanes|=v)):O!==null&&(O.childLanes&v)!==v&&(O.childLanes|=v),f===P)break;f=f.return}}function Ba(f,v){zs=f,$n=gl=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&v)!==0&&(Bs=!0),f.firstContext=null)}function gi(f){var v=f._currentValue;if($n!==f)if(f={context:f,memoizedValue:v,next:null},gl===null){if(zs===null)throw Error(n(308));gl=f,zs.dependencies={lanes:0,firstContext:f}}else gl=gl.next=f;return v}var pc=null;function oo(f){pc===null?pc=[f]:pc.push(f)}function Yp(f,v,P,O){var G=v.interleaved;return G===null?(P.next=P,oo(v)):(P.next=G.next,G.next=P),v.interleaved=P,os(f,O)}function os(f,v){f.lanes|=v;var P=f.alternate;for(P!==null&&(P.lanes|=v),P=f,f=f.return;f!==null;)f.childLanes|=v,P=f.alternate,P!==null&&(P.childLanes|=v),P=f,f=f.return;return P.tag===3?P.stateNode:null}var ei=!1;function Ci(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kp(f,v){f=f.updateQueue,v.updateQueue===f&&(v.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function jo(f,v){return{eventTime:f,lane:v,tag:0,payload:null,callback:null,next:null}}function ss(f,v,P){var O=f.updateQueue;if(O===null)return null;if(O=O.shared,(Jr&2)!==0){var G=O.pending;return G===null?v.next=v:(v.next=G.next,G.next=v),O.pending=v,os(f,P)}return G=O.interleaved,G===null?(v.next=v,oo(O)):(v.next=G.next,G.next=v),O.interleaved=v,os(f,P)}function Xu(f,v,P){if(v=v.updateQueue,v!==null&&(v=v.shared,(P&4194240)!==0)){var O=v.lanes;O&=f.pendingLanes,P|=O,v.lanes=P,Vi(f,P)}}function ud(f,v){var P=f.updateQueue,O=f.alternate;if(O!==null&&(O=O.updateQueue,P===O)){var G=null,J=null;if(P=P.firstBaseUpdate,P!==null){do{var be={eventTime:P.eventTime,lane:P.lane,tag:P.tag,payload:P.payload,callback:P.callback,next:null};J===null?G=J=be:J=J.next=be,P=P.next}while(P!==null);J===null?G=J=v:J=J.next=v}else G=J=v;P={baseState:O.baseState,firstBaseUpdate:G,lastBaseUpdate:J,shared:O.shared,effects:O.effects},f.updateQueue=P;return}f=P.lastBaseUpdate,f===null?P.firstBaseUpdate=v:f.next=v,P.lastBaseUpdate=v}function Ua(f,v,P,O){var G=f.updateQueue;ei=!1;var J=G.firstBaseUpdate,be=G.lastBaseUpdate,ot=G.shared.pending;if(ot!==null){G.shared.pending=null;var gt=ot,Bt=gt.next;gt.next=null,be===null?J=Bt:be.next=Bt,be=gt;var bn=f.alternate;bn!==null&&(bn=bn.updateQueue,ot=bn.lastBaseUpdate,ot!==be&&(ot===null?bn.firstBaseUpdate=Bt:ot.next=Bt,bn.lastBaseUpdate=gt))}if(J!==null){var Mn=G.baseState;be=0,bn=Bt=gt=null,ot=J;do{var yn=ot.lane,Un=ot.eventTime;if((O&yn)===yn){bn!==null&&(bn=bn.next={eventTime:Un,lane:0,tag:ot.tag,payload:ot.payload,callback:ot.callback,next:null});e:{var Yn=f,rr=ot;switch(yn=v,Un=P,rr.tag){case 1:if(Yn=rr.payload,typeof Yn=="function"){Mn=Yn.call(Un,Mn,yn);break e}Mn=Yn;break e;case 3:Yn.flags=Yn.flags&-65537|128;case 0:if(Yn=rr.payload,yn=typeof Yn=="function"?Yn.call(Un,Mn,yn):Yn,yn==null)break e;Mn=st({},Mn,yn);break e;case 2:ei=!0}}ot.callback!==null&&ot.lane!==0&&(f.flags|=64,yn=G.effects,yn===null?G.effects=[ot]:yn.push(ot))}else Un={eventTime:Un,lane:yn,tag:ot.tag,payload:ot.payload,callback:ot.callback,next:null},bn===null?(Bt=bn=Un,gt=Mn):bn=bn.next=Un,be|=yn;if(ot=ot.next,ot===null){if(ot=G.shared.pending,ot===null)break;yn=ot,ot=yn.next,yn.next=null,G.lastBaseUpdate=yn,G.shared.pending=null}}while(!0);if(bn===null&&(gt=Mn),G.baseState=gt,G.firstBaseUpdate=Bt,G.lastBaseUpdate=bn,v=G.shared.interleaved,v!==null){G=v;do be|=G.lane,G=G.next;while(G!==v)}else J===null&&(G.shared.lanes=0);ih|=be,f.lanes=be,f.memoizedState=Mn}}function Zu(f,v,P){if(f=v.effects,v.effects=null,f!==null)for(v=0;v<f.length;v++){var O=f[v],G=O.callback;if(G!==null){if(O.callback=null,O=P,typeof G!="function")throw Error(n(191,G));G.call(O)}}}var eu={},Os=Ds(eu),tu=Ds(eu),S=Ds(eu);function i(f){if(f===eu)throw Error(n(174));return f}function u(f,v){switch(Pr(S,v),Pr(tu,f),Pr(Os,eu),f=v.nodeType,f){case 9:case 11:v=(v=v.documentElement)?v.namespaceURI:ln(null,"");break;default:f=f===8?v.parentNode:v,v=f.namespaceURI||null,f=f.tagName,v=ln(v,f)}ri(Os),Pr(Os,v)}function g(){ri(Os),ri(tu),ri(S)}function _(f){i(S.current);var v=i(Os.current),P=ln(v,f.type);v!==P&&(Pr(tu,f),Pr(Os,P))}function M(f){tu.current===f&&(ri(Os),ri(tu))}var D=Ds(0);function F(f){for(var v=f;v!==null;){if(v.tag===13){var P=v.memoizedState;if(P!==null&&(P=P.dehydrated,P===null||P.data==="$?"||P.data==="$!"))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if((v.flags&128)!==0)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}var U=[];function Z(){for(var f=0;f<U.length;f++)U[f]._workInProgressVersionPrimary=null;U.length=0}var K=W.ReactCurrentDispatcher,ie=W.ReactCurrentBatchConfig,ne=0,le=null,ge=null,Le=null,ze=!1,Ne=!1,Ge=0,Je=0;function qe(){throw Error(n(321))}function at(f,v){if(v===null)return!1;for(var P=0;P<v.length&&P<f.length;P++)if(!Po(f[P],v[P]))return!1;return!0}function ct(f,v,P,O,G,J){if(ne=J,le=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,K.current=f===null||f.memoizedState===null?ao:vg,f=P(O,G),Ne){J=0;do{if(Ne=!1,Ge=0,25<=J)throw Error(n(301));J+=1,Le=ge=null,v.updateQueue=null,K.current=Sy,f=P(O,G)}while(Ne)}if(K.current=yo,v=ge!==null&&ge.next!==null,ne=0,Le=ge=le=null,ze=!1,v)throw Error(n(300));return f}function Ze(){var f=Ge!==0;return Ge=0,f}function pt(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Le===null?le.memoizedState=Le=f:Le=Le.next=f,Le}function Tt(){if(ge===null){var f=le.alternate;f=f!==null?f.memoizedState:null}else f=ge.next;var v=Le===null?le.memoizedState:Le.next;if(v!==null)Le=v,ge=f;else{if(f===null)throw Error(n(310));ge=f,f={memoizedState:ge.memoizedState,baseState:ge.baseState,baseQueue:ge.baseQueue,queue:ge.queue,next:null},Le===null?le.memoizedState=Le=f:Le=Le.next=f}return Le}function Mt(f,v){return typeof v=="function"?v(f):v}function Et(f){var v=Tt(),P=v.queue;if(P===null)throw Error(n(311));P.lastRenderedReducer=f;var O=ge,G=O.baseQueue,J=P.pending;if(J!==null){if(G!==null){var be=G.next;G.next=J.next,J.next=be}O.baseQueue=G=J,P.pending=null}if(G!==null){J=G.next,O=O.baseState;var ot=be=null,gt=null,Bt=J;do{var bn=Bt.lane;if((ne&bn)===bn)gt!==null&&(gt=gt.next={lane:0,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null}),O=Bt.hasEagerState?Bt.eagerState:f(O,Bt.action);else{var Mn={lane:bn,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null};gt===null?(ot=gt=Mn,be=O):gt=gt.next=Mn,le.lanes|=bn,ih|=bn}Bt=Bt.next}while(Bt!==null&&Bt!==J);gt===null?be=O:gt.next=ot,Po(O,v.memoizedState)||(Bs=!0),v.memoizedState=O,v.baseState=be,v.baseQueue=gt,P.lastRenderedState=O}if(f=P.interleaved,f!==null){G=f;do J=G.lane,le.lanes|=J,ih|=J,G=G.next;while(G!==f)}else G===null&&(P.lanes=0);return[v.memoizedState,P.dispatch]}function Dt(f){var v=Tt(),P=v.queue;if(P===null)throw Error(n(311));P.lastRenderedReducer=f;var O=P.dispatch,G=P.pending,J=v.memoizedState;if(G!==null){P.pending=null;var be=G=G.next;do J=f(J,be.action),be=be.next;while(be!==G);Po(J,v.memoizedState)||(Bs=!0),v.memoizedState=J,v.baseQueue===null&&(v.baseState=J),P.lastRenderedState=J}return[J,O]}function Sn(){}function wn(f,v){var P=le,O=Tt(),G=v(),J=!Po(O.memoizedState,G);if(J&&(O.memoizedState=G,Bs=!0),O=O.queue,Ar(br.bind(null,P,O,f),[f]),O.getSnapshot!==v||J||Le!==null&&Le.memoizedState.tag&1){if(P.flags|=2048,ci(9,Vn.bind(null,P,O,G,v),void 0,null),Ji===null)throw Error(n(349));(ne&30)!==0||nn(P,v,G)}return G}function nn(f,v,P){f.flags|=16384,f={getSnapshot:v,value:P},v=le.updateQueue,v===null?(v={lastEffect:null,stores:null},le.updateQueue=v,v.stores=[f]):(P=v.stores,P===null?v.stores=[f]:P.push(f))}function Vn(f,v,P,O){v.value=P,v.getSnapshot=O,jr(v)&&Ei(f)}function br(f,v,P){return P(function(){jr(v)&&Ei(f)})}function jr(f){var v=f.getSnapshot;f=f.value;try{var P=v();return!Po(f,P)}catch{return!0}}function Ei(f){var v=os(f,1);v!==null&&na(v,f,1,-1)}function ii(f){var v=pt();return typeof f=="function"&&(f=f()),v.memoizedState=v.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mt,lastRenderedState:f},v.queue=f,f=f.dispatch=mc.bind(null,le,f),[v.memoizedState,f]}function ci(f,v,P,O){return f={tag:f,create:v,destroy:P,deps:O,next:null},v=le.updateQueue,v===null?(v={lastEffect:null,stores:null},le.updateQueue=v,v.lastEffect=f.next=f):(P=v.lastEffect,P===null?v.lastEffect=f.next=f:(O=P.next,P.next=f,f.next=O,v.lastEffect=f)),f}function ai(){return Tt().memoizedState}function Kr(f,v,P,O){var G=pt();le.flags|=f,G.memoizedState=ci(1|v,P,void 0,O===void 0?null:O)}function ti(f,v,P,O){var G=Tt();O=O===void 0?null:O;var J=void 0;if(ge!==null){var be=ge.memoizedState;if(J=be.destroy,O!==null&&at(O,be.deps)){G.memoizedState=ci(v,P,J,O);return}}le.flags|=f,G.memoizedState=ci(1|v,P,J,O)}function go(f,v){return Kr(8390656,8,f,v)}function Ar(f,v){return ti(2048,8,f,v)}function so(f,v){return ti(4,2,f,v)}function vo(f,v){return ti(4,4,f,v)}function vl(f,v){if(typeof v=="function")return f=f(),v(f),function(){v(null)};if(v!=null)return f=f(),v.current=f,function(){v.current=null}}function yl(f,v,P){return P=P!=null?P.concat([f]):null,ti(4,4,vl.bind(null,v,f),P)}function $a(){}function va(f,v){var P=Tt();v=v===void 0?null:v;var O=P.memoizedState;return O!==null&&v!==null&&at(v,O[1])?O[0]:(P.memoizedState=[f,v],f)}function Yu(f,v){var P=Tt();v=v===void 0?null:v;var O=P.memoizedState;return O!==null&&v!==null&&at(v,O[1])?O[0]:(f=f(),P.memoizedState=[f,v],f)}function Ku(f,v,P){return(ne&21)===0?(f.baseState&&(f.baseState=!1,Bs=!0),f.memoizedState=P):(Po(P,v)||(P=Zr(),le.lanes|=P,ih|=P,f.baseState=!0),v)}function Ju(f,v){var P=Nr;Nr=P!==0&&4>P?P:4,f(!0);var O=ie.transition;ie.transition={};try{f(!1),v()}finally{Nr=P,ie.transition=O}}function as(){return Tt().memoizedState}function ya(f,v,P){var O=ru(f);if(P={lane:O,action:P,hasEagerState:!1,eagerState:null,next:null},gc(f))ki(v,P);else if(P=Yp(f,v,P,O),P!==null){var G=Ss();na(P,f,O,G),hi(P,v,O)}}function mc(f,v,P){var O=ru(f),G={lane:O,action:P,hasEagerState:!1,eagerState:null,next:null};if(gc(f))ki(v,G);else{var J=f.alternate;if(f.lanes===0&&(J===null||J.lanes===0)&&(J=v.lastRenderedReducer,J!==null))try{var be=v.lastRenderedState,ot=J(be,P);if(G.hasEagerState=!0,G.eagerState=ot,Po(ot,be)){var gt=v.interleaved;gt===null?(G.next=G,oo(v)):(G.next=gt.next,gt.next=G),v.interleaved=G;return}}catch{}finally{}P=Yp(f,v,G,O),P!==null&&(G=Ss(),na(P,f,O,G),hi(P,v,O))}}function gc(f){var v=f.alternate;return f===le||v!==null&&v===le}function ki(f,v){Ne=ze=!0;var P=f.pending;P===null?v.next=v:(v.next=P.next,P.next=v),f.pending=v}function hi(f,v,P){if((P&4194240)!==0){var O=v.lanes;O&=f.pendingLanes,P|=O,v.lanes=P,Vi(f,P)}}var yo={readContext:gi,useCallback:qe,useContext:qe,useEffect:qe,useImperativeHandle:qe,useInsertionEffect:qe,useLayoutEffect:qe,useMemo:qe,useReducer:qe,useRef:qe,useState:qe,useDebugValue:qe,useDeferredValue:qe,useTransition:qe,useMutableSource:qe,useSyncExternalStore:qe,useId:qe,unstable_isNewReconciler:!1},ao={readContext:gi,useCallback:function(f,v){return pt().memoizedState=[f,v===void 0?null:v],f},useContext:gi,useEffect:go,useImperativeHandle:function(f,v,P){return P=P!=null?P.concat([f]):null,Kr(4194308,4,vl.bind(null,v,f),P)},useLayoutEffect:function(f,v){return Kr(4194308,4,f,v)},useInsertionEffect:function(f,v){return Kr(4,2,f,v)},useMemo:function(f,v){var P=pt();return v=v===void 0?null:v,f=f(),P.memoizedState=[f,v],f},useReducer:function(f,v,P){var O=pt();return v=P!==void 0?P(v):v,O.memoizedState=O.baseState=v,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:v},O.queue=f,f=f.dispatch=ya.bind(null,le,f),[O.memoizedState,f]},useRef:function(f){var v=pt();return f={current:f},v.memoizedState=f},useState:ii,useDebugValue:$a,useDeferredValue:function(f){return pt().memoizedState=f},useTransition:function(){var f=ii(!1),v=f[0];return f=Ju.bind(null,f[1]),pt().memoizedState=f,[v,f]},useMutableSource:function(){},useSyncExternalStore:function(f,v,P){var O=le,G=pt();if(Mi){if(P===void 0)throw Error(n(407));P=P()}else{if(P=v(),Ji===null)throw Error(n(349));(ne&30)!==0||nn(O,v,P)}G.memoizedState=P;var J={value:P,getSnapshot:v};return G.queue=J,go(br.bind(null,O,J,f),[f]),O.flags|=2048,ci(9,Vn.bind(null,O,J,P,v),void 0,null),P},useId:function(){var f=pt(),v=Ji.identifierPrefix;if(Mi){var P=ks,O=ga;P=(O&~(1<<32-tr(O)-1)).toString(32)+P,v=":"+v+"R"+P,P=Ge++,0<P&&(v+="H"+P.toString(32)),v+=":"}else P=Je++,v=":"+v+"r"+P.toString(32)+":";return f.memoizedState=v},unstable_isNewReconciler:!1},vg={readContext:gi,useCallback:va,useContext:gi,useEffect:Ar,useImperativeHandle:yl,useInsertionEffect:so,useLayoutEffect:vo,useMemo:Yu,useReducer:Et,useRef:ai,useState:function(){return Et(Mt)},useDebugValue:$a,useDeferredValue:function(f){var v=Tt();return Ku(v,ge.memoizedState,f)},useTransition:function(){var f=Et(Mt)[0],v=Tt().memoizedState;return[f,v]},useMutableSource:Sn,useSyncExternalStore:wn,useId:as,unstable_isNewReconciler:!1},Sy={readContext:gi,useCallback:va,useContext:gi,useEffect:Ar,useImperativeHandle:yl,useInsertionEffect:so,useLayoutEffect:vo,useMemo:Yu,useReducer:Dt,useRef:ai,useState:function(){return Dt(Mt)},useDebugValue:$a,useDeferredValue:function(f){var v=Tt();return ge===null?v.memoizedState=f:Ku(v,ge.memoizedState,f)},useTransition:function(){var f=Dt(Mt)[0],v=Tt().memoizedState;return[f,v]},useMutableSource:Sn,useSyncExternalStore:wn,useId:as,unstable_isNewReconciler:!1};function Fs(f,v){if(f&&f.defaultProps){v=st({},v),f=f.defaultProps;for(var P in f)v[P]===void 0&&(v[P]=f[P]);return v}return v}function nu(f,v,P,O){v=f.memoizedState,P=P(O,v),P=P==null?v:st({},v,P),f.memoizedState=P,f.lanes===0&&(f.updateQueue.baseState=P)}var _l={isMounted:function(f){return(f=f._reactInternals)?It(f)===f:!1},enqueueSetState:function(f,v,P){f=f._reactInternals;var O=Ss(),G=ru(f),J=jo(O,G);J.payload=v,P!=null&&(J.callback=P),v=ss(f,J,G),v!==null&&(na(v,f,G,O),Xu(v,f,G))},enqueueReplaceState:function(f,v,P){f=f._reactInternals;var O=Ss(),G=ru(f),J=jo(O,G);J.tag=1,J.payload=v,P!=null&&(J.callback=P),v=ss(f,J,G),v!==null&&(na(v,f,G,O),Xu(v,f,G))},enqueueForceUpdate:function(f,v){f=f._reactInternals;var P=Ss(),O=ru(f),G=jo(P,O);G.tag=2,v!=null&&(G.callback=v),v=ss(f,G,O),v!==null&&(na(v,f,O,P),Xu(v,f,O))}};function Va(f,v,P,O,G,J,be){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(O,J,be):v.prototype&&v.prototype.isPureReactComponent?!$c(P,O)||!$c(G,J):!0}function _o(f,v,P){var O=!1,G=po,J=v.contextType;return typeof J=="object"&&J!==null?J=gi(J):(G=$o(v)?lc:mo.current,O=v.contextTypes,J=(O=O!=null)?ma(f,G):po),v=new v(P,J),f.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=_l,f.stateNode=v,v._reactInternals=f,O&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=G,f.__reactInternalMemoizedMaskedChildContext=J),v}function ja(f,v,P,O){f=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(P,O),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(P,O),v.state!==f&&_l.enqueueReplaceState(v,v.state,null)}function hd(f,v,P,O){var G=f.stateNode;G.props=P,G.state=f.memoizedState,G.refs={},Ci(f);var J=v.contextType;typeof J=="object"&&J!==null?G.context=gi(J):(J=$o(v)?lc:mo.current,G.context=ma(f,J)),G.state=f.memoizedState,J=v.getDerivedStateFromProps,typeof J=="function"&&(nu(f,v,J,P),G.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(v=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),v!==G.state&&_l.enqueueReplaceState(G,G.state,null),Ua(f,P,G,O),G.state=f.memoizedState),typeof G.componentDidMount=="function"&&(f.flags|=4194308)}function Ns(f,v){try{var P="",O=v;do P+=ft(O),O=O.return;while(O);var G=P}catch(J){G=`
Error generating stack: `+J.message+`
`+J.stack}return{value:f,source:v,stack:G,digest:null}}function dd(f,v,P){return{value:f,source:null,stack:P??null,digest:v??null}}function fd(f,v){try{console.error(v.value)}catch(P){setTimeout(function(){throw P})}}var pd=typeof WeakMap=="function"?WeakMap:Map;function My(f,v,P){P=jo(-1,P),P.tag=3,P.payload={element:null};var O=v.value;return P.callback=function(){Ag||(Ag=!0,Ny=O),fd(f,v)},P}function Qu(f,v,P){P=jo(-1,P),P.tag=3;var O=f.type.getDerivedStateFromError;if(typeof O=="function"){var G=v.value;P.payload=function(){return O(G)},P.callback=function(){fd(f,v)}}var J=f.stateNode;return J!==null&&typeof J.componentDidCatch=="function"&&(P.callback=function(){fd(f,v),typeof O!="function"&&(oh===null?oh=new Set([this]):oh.add(this));var be=v.stack;this.componentDidCatch(v.value,{componentStack:be!==null?be:""})}),P}function eh(f,v,P){var O=f.pingCache;if(O===null){O=f.pingCache=new pd;var G=new Set;O.set(v,G)}else G=O.get(v),G===void 0&&(G=new Set,O.set(v,G));G.has(P)||(G.add(P),f=Lx.bind(null,f,v,P),v.then(f,f))}function Cy(f){do{var v;if((v=f.tag===13)&&(v=f.memoizedState,v=v!==null?v.dehydrated!==null:!0),v)return f;f=f.return}while(f!==null);return null}function vx(f,v,P,O,G){return(f.mode&1)===0?(f===v?f.flags|=65536:(f.flags|=128,P.flags|=131072,P.flags&=-52805,P.tag===1&&(P.alternate===null?P.tag=17:(v=jo(-1,1),v.tag=2,ss(P,v,1))),P.lanes|=1),f):(f.flags|=65536,f.lanes=G,f)}var Ey=W.ReactCurrentOwner,Bs=!1;function Us(f,v,P,O){v.child=f===null?Zp(v,null,P,O):Qc(v,f.child,P,O)}function Ty(f,v,P,O,G){P=P.render;var J=v.ref;return Ba(v,G),O=ct(f,v,P,O,J,G),P=Ze(),f!==null&&!Bs?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~G,xl(f,v,G)):(Mi&&P&&hc(v),v.flags|=1,Us(f,v,O,G),v.child)}function yx(f,v,P,O,G){if(f===null){var J=P.type;return typeof J=="function"&&!Gy(J)&&J.defaultProps===void 0&&P.compare===null&&P.defaultProps===void 0?(v.tag=15,v.type=J,yg(f,v,J,O,G)):(f=Lg(P.type,null,O,v,v.mode,G),f.ref=v.ref,f.return=v,v.child=f)}if(J=f.child,(f.lanes&G)===0){var be=J.memoizedProps;if(P=P.compare,P=P!==null?P:$c,P(be,O)&&f.ref===v.ref)return xl(f,v,G)}return v.flags|=1,f=iu(J,O),f.ref=v.ref,f.return=v,v.child=f}function yg(f,v,P,O,G){if(f!==null){var J=f.memoizedProps;if($c(J,O)&&f.ref===v.ref)if(Bs=!1,v.pendingProps=O=J,(f.lanes&G)!==0)(f.flags&131072)!==0&&(Bs=!0);else return v.lanes=f.lanes,xl(f,v,G)}return xg(f,v,P,O,G)}function _x(f,v,P){var O=v.pendingProps,G=O.children,J=f!==null?f.memoizedState:null;if(O.mode==="hidden")if((v.mode&1)===0)v.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pr(Sl,ws),ws|=P;else{if((P&1073741824)===0)return f=J!==null?J.baseLanes|P:P,v.lanes=v.childLanes=1073741824,v.memoizedState={baseLanes:f,cachePool:null,transitions:null},v.updateQueue=null,Pr(Sl,ws),ws|=f,null;v.memoizedState={baseLanes:0,cachePool:null,transitions:null},O=J!==null?J.baseLanes:P,Pr(Sl,ws),ws|=O}else J!==null?(O=J.baseLanes|P,v.memoizedState=null):O=P,Pr(Sl,ws),ws|=O;return Us(f,v,G,P),v.child}function _g(f,v){var P=v.ref;(f===null&&P!==null||f!==null&&f.ref!==P)&&(v.flags|=512,v.flags|=2097152)}function xg(f,v,P,O,G){var J=$o(P)?lc:mo.current;return J=ma(v,J),Ba(v,G),P=ct(f,v,P,O,J,G),O=Ze(),f!==null&&!Bs?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~G,xl(f,v,G)):(Mi&&O&&hc(v),v.flags|=1,Us(f,v,P,G),v.child)}function Py(f,v,P,O,G){if($o(P)){var J=!0;Kc(v)}else J=!1;if(Ba(v,G),v.stateNode===null)Mg(f,v),_o(v,P,O),hd(v,P,O,G),O=!0;else if(f===null){var be=v.stateNode,ot=v.memoizedProps;be.props=ot;var gt=be.context,Bt=P.contextType;typeof Bt=="object"&&Bt!==null?Bt=gi(Bt):(Bt=$o(P)?lc:mo.current,Bt=ma(v,Bt));var bn=P.getDerivedStateFromProps,Mn=typeof bn=="function"||typeof be.getSnapshotBeforeUpdate=="function";Mn||typeof be.UNSAFE_componentWillReceiveProps!="function"&&typeof be.componentWillReceiveProps!="function"||(ot!==O||gt!==Bt)&&ja(v,be,O,Bt),ei=!1;var yn=v.memoizedState;be.state=yn,Ua(v,O,be,G),gt=v.memoizedState,ot!==O||yn!==gt||rs.current||ei?(typeof bn=="function"&&(nu(v,P,bn,O),gt=v.memoizedState),(ot=ei||Va(v,P,ot,O,yn,gt,Bt))?(Mn||typeof be.UNSAFE_componentWillMount!="function"&&typeof be.componentWillMount!="function"||(typeof be.componentWillMount=="function"&&be.componentWillMount(),typeof be.UNSAFE_componentWillMount=="function"&&be.UNSAFE_componentWillMount()),typeof be.componentDidMount=="function"&&(v.flags|=4194308)):(typeof be.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=O,v.memoizedState=gt),be.props=O,be.state=gt,be.context=Bt,O=ot):(typeof be.componentDidMount=="function"&&(v.flags|=4194308),O=!1)}else{be=v.stateNode,Kp(f,v),ot=v.memoizedProps,Bt=v.type===v.elementType?ot:Fs(v.type,ot),be.props=Bt,Mn=v.pendingProps,yn=be.context,gt=P.contextType,typeof gt=="object"&&gt!==null?gt=gi(gt):(gt=$o(P)?lc:mo.current,gt=ma(v,gt));var Un=P.getDerivedStateFromProps;(bn=typeof Un=="function"||typeof be.getSnapshotBeforeUpdate=="function")||typeof be.UNSAFE_componentWillReceiveProps!="function"&&typeof be.componentWillReceiveProps!="function"||(ot!==Mn||yn!==gt)&&ja(v,be,O,gt),ei=!1,yn=v.memoizedState,be.state=yn,Ua(v,O,be,G);var Yn=v.memoizedState;ot!==Mn||yn!==Yn||rs.current||ei?(typeof Un=="function"&&(nu(v,P,Un,O),Yn=v.memoizedState),(Bt=ei||Va(v,P,Bt,O,yn,Yn,gt)||!1)?(bn||typeof be.UNSAFE_componentWillUpdate!="function"&&typeof be.componentWillUpdate!="function"||(typeof be.componentWillUpdate=="function"&&be.componentWillUpdate(O,Yn,gt),typeof be.UNSAFE_componentWillUpdate=="function"&&be.UNSAFE_componentWillUpdate(O,Yn,gt)),typeof be.componentDidUpdate=="function"&&(v.flags|=4),typeof be.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof be.componentDidUpdate!="function"||ot===f.memoizedProps&&yn===f.memoizedState||(v.flags|=4),typeof be.getSnapshotBeforeUpdate!="function"||ot===f.memoizedProps&&yn===f.memoizedState||(v.flags|=1024),v.memoizedProps=O,v.memoizedState=Yn),be.props=O,be.state=Yn,be.context=gt,O=Bt):(typeof be.componentDidUpdate!="function"||ot===f.memoizedProps&&yn===f.memoizedState||(v.flags|=4),typeof be.getSnapshotBeforeUpdate!="function"||ot===f.memoizedProps&&yn===f.memoizedState||(v.flags|=1024),O=!1)}return th(f,v,P,O,J,G)}function th(f,v,P,O,G,J){_g(f,v);var be=(v.flags&128)!==0;if(!O&&!be)return G&&Jc(v,P,!1),xl(f,v,J);O=v.stateNode,Ey.current=v;var ot=be&&typeof P.getDerivedStateFromError!="function"?null:O.render();return v.flags|=1,f!==null&&be?(v.child=Qc(v,f.child,null,J),v.child=Qc(v,null,ot,J)):Us(f,v,ot,J),v.memoizedState=O.state,G&&Jc(v,P,!0),v.child}function xx(f){var v=f.stateNode;v.pendingContext?Xp(f,v.pendingContext,v.pendingContext!==v.context):v.context&&Xp(f,v.context,!1),u(f,v.containerInfo)}function xf(f,v,P,O,G){return Wu(),ad(G),v.flags|=256,Us(f,v,P,O),v.child}var bf={dehydrated:null,treeContext:null,retryLane:0};function wf(f){return{baseLanes:f,cachePool:null,transitions:null}}function Ay(f,v,P){var O=v.pendingProps,G=D.current,J=!1,be=(v.flags&128)!==0,ot;if((ot=be)||(ot=f!==null&&f.memoizedState===null?!1:(G&2)!==0),ot?(J=!0,v.flags&=-129):(f===null||f.memoizedState!==null)&&(G|=1),Pr(D,G&1),f===null)return Hu(v),f=v.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((v.mode&1)===0?v.lanes=1:f.data==="$!"?v.lanes=8:v.lanes=1073741824,null):(be=O.children,f=O.fallback,J?(O=v.mode,J=v.child,be={mode:"hidden",children:be},(O&1)===0&&J!==null?(J.childLanes=0,J.pendingProps=be):J=ch(be,O,0,null),f=Cd(f,O,P,null),J.return=v,f.return=v,J.sibling=f,v.child=J,v.child.memoizedState=wf(P),v.memoizedState=bf,f):bg(v,be));if(G=f.memoizedState,G!==null&&(ot=G.dehydrated,ot!==null))return hS(f,v,be,O,ot,G,P);if(J){J=O.fallback,be=v.mode,G=f.child,ot=G.sibling;var gt={mode:"hidden",children:O.children};return(be&1)===0&&v.child!==G?(O=v.child,O.childLanes=0,O.pendingProps=gt,v.deletions=null):(O=iu(G,gt),O.subtreeFlags=G.subtreeFlags&14680064),ot!==null?J=iu(ot,J):(J=Cd(J,be,P,null),J.flags|=2),J.return=v,O.return=v,O.sibling=J,v.child=O,O=J,J=v.child,be=f.child.memoizedState,be=be===null?wf(P):{baseLanes:be.baseLanes|P,cachePool:null,transitions:be.transitions},J.memoizedState=be,J.childLanes=f.childLanes&~P,v.memoizedState=bf,O}return J=f.child,f=J.sibling,O=iu(J,{mode:"visible",children:O.children}),(v.mode&1)===0&&(O.lanes=P),O.return=v,O.sibling=null,f!==null&&(P=v.deletions,P===null?(v.deletions=[f],v.flags|=16):P.push(f)),v.child=O,v.memoizedState=null,O}function bg(f,v){return v=ch({mode:"visible",children:v},f.mode,0,null),v.return=f,f.child=v}function wg(f,v,P,O){return O!==null&&ad(O),Qc(v,f.child,null,P),f=bg(v,v.pendingProps.children),f.flags|=2,v.memoizedState=null,f}function hS(f,v,P,O,G,J,be){if(P)return v.flags&256?(v.flags&=-257,O=dd(Error(n(422))),wg(f,v,be,O)):v.memoizedState!==null?(v.child=f.child,v.flags|=128,null):(J=O.fallback,G=v.mode,O=ch({mode:"visible",children:O.children},G,0,null),J=Cd(J,G,be,null),J.flags|=2,O.return=v,J.return=v,O.sibling=J,v.child=O,(v.mode&1)!==0&&Qc(v,f.child,null,be),v.child.memoizedState=wf(be),v.memoizedState=bf,J);if((v.mode&1)===0)return wg(f,v,be,null);if(G.data==="$!"){if(O=G.nextSibling&&G.nextSibling.dataset,O)var ot=O.dgst;return O=ot,J=Error(n(419)),O=dd(J,O,void 0),wg(f,v,be,O)}if(ot=(be&f.childLanes)!==0,Bs||ot){if(O=Ji,O!==null){switch(be&-be){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}G=(G&(O.suspendedLanes|be))!==0?0:G,G!==0&&G!==J.retryLane&&(J.retryLane=G,os(f,G),na(O,f,G,-1))}return Vy(),O=dd(Error(n(421))),wg(f,v,be,O)}return G.data==="$?"?(v.flags|=128,v.child=f.child,v=Dx.bind(null,f),G._reactRetry=v,null):(f=J.treeContext,is=pa(G.nextSibling),dr=v,Mi=!0,_s=null,f!==null&&(Ao[Hi++]=ga,Ao[Hi++]=ks,Ao[Hi++]=zn,ga=f.id,ks=f.overflow,zn=v),v=bg(v,O.children),v.flags|=4096,v)}function Iy(f,v,P){f.lanes|=v;var O=f.alternate;O!==null&&(O.lanes|=v),cd(f.return,v,P)}function Sg(f,v,P,O,G){var J=f.memoizedState;J===null?f.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:O,tail:P,tailMode:G}:(J.isBackwards=v,J.rendering=null,J.renderingStartTime=0,J.last=O,J.tail=P,J.tailMode=G)}function Ry(f,v,P){var O=v.pendingProps,G=O.revealOrder,J=O.tail;if(Us(f,v,O.children,P),O=D.current,(O&2)!==0)O=O&1|2,v.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=v.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&Iy(f,P,v);else if(f.tag===19)Iy(f,P,v);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===v)break e;for(;f.sibling===null;){if(f.return===null||f.return===v)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}O&=1}if(Pr(D,O),(v.mode&1)===0)v.memoizedState=null;else switch(G){case"forwards":for(P=v.child,G=null;P!==null;)f=P.alternate,f!==null&&F(f)===null&&(G=P),P=P.sibling;P=G,P===null?(G=v.child,v.child=null):(G=P.sibling,P.sibling=null),Sg(v,!1,G,P,J);break;case"backwards":for(P=null,G=v.child,v.child=null;G!==null;){if(f=G.alternate,f!==null&&F(f)===null){v.child=G;break}f=G.sibling,G.sibling=P,P=G,G=f}Sg(v,!0,P,null,J);break;case"together":Sg(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function Mg(f,v){(v.mode&1)===0&&f!==null&&(f.alternate=null,v.alternate=null,v.flags|=2)}function xl(f,v,P){if(f!==null&&(v.dependencies=f.dependencies),ih|=v.lanes,(P&v.childLanes)===0)return null;if(f!==null&&v.child!==f.child)throw Error(n(153));if(v.child!==null){for(f=v.child,P=iu(f,f.pendingProps),v.child=P,P.return=v;f.sibling!==null;)f=f.sibling,P=P.sibling=iu(f,f.pendingProps),P.return=v;P.sibling=null}return v.child}function bx(f,v,P){switch(v.tag){case 3:xx(v),Wu();break;case 5:_(v);break;case 1:$o(v.type)&&Kc(v);break;case 4:u(v,v.stateNode.containerInfo);break;case 10:var O=v.type._context,G=v.memoizedProps.value;Pr(_f,O._currentValue),O._currentValue=G;break;case 13:if(O=v.memoizedState,O!==null)return O.dehydrated!==null?(Pr(D,D.current&1),v.flags|=128,null):(P&v.child.childLanes)!==0?Ay(f,v,P):(Pr(D,D.current&1),f=xl(f,v,P),f!==null?f.sibling:null);Pr(D,D.current&1);break;case 19:if(O=(P&v.childLanes)!==0,(f.flags&128)!==0){if(O)return Ry(f,v,P);v.flags|=128}if(G=v.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),Pr(D,D.current),O)break;return null;case 22:case 23:return v.lanes=0,_x(f,v,P)}return xl(f,v,P)}var Cg,md,xs,Ly;Cg=function(f,v){for(var P=v.child;P!==null;){if(P.tag===5||P.tag===6)f.appendChild(P.stateNode);else if(P.tag!==4&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===v)break;for(;P.sibling===null;){if(P.return===null||P.return===v)return;P=P.return}P.sibling.return=P.return,P=P.sibling}},md=function(){},xs=function(f,v,P,O){var G=f.memoizedProps;if(G!==O){f=v.stateNode,i(Os.current);var J=null;switch(P){case"input":G=et(f,G),O=et(f,O),J=[];break;case"select":G=st({},G,{value:void 0}),O=st({},O,{value:void 0}),J=[];break;case"textarea":G=we(f,G),O=we(f,O),J=[];break;default:typeof G.onClick!="function"&&typeof O.onClick=="function"&&(f.onclick=ac)}fe(P,O);var be;P=null;for(Bt in G)if(!O.hasOwnProperty(Bt)&&G.hasOwnProperty(Bt)&&G[Bt]!=null)if(Bt==="style"){var ot=G[Bt];for(be in ot)ot.hasOwnProperty(be)&&(P||(P={}),P[be]="")}else Bt!=="dangerouslySetInnerHTML"&&Bt!=="children"&&Bt!=="suppressContentEditableWarning"&&Bt!=="suppressHydrationWarning"&&Bt!=="autoFocus"&&(o.hasOwnProperty(Bt)?J||(J=[]):(J=J||[]).push(Bt,null));for(Bt in O){var gt=O[Bt];if(ot=G?.[Bt],O.hasOwnProperty(Bt)&&gt!==ot&&(gt!=null||ot!=null))if(Bt==="style")if(ot){for(be in ot)!ot.hasOwnProperty(be)||gt&&gt.hasOwnProperty(be)||(P||(P={}),P[be]="");for(be in gt)gt.hasOwnProperty(be)&&ot[be]!==gt[be]&&(P||(P={}),P[be]=gt[be])}else P||(J||(J=[]),J.push(Bt,P)),P=gt;else Bt==="dangerouslySetInnerHTML"?(gt=gt?gt.__html:void 0,ot=ot?ot.__html:void 0,gt!=null&&ot!==gt&&(J=J||[]).push(Bt,gt)):Bt==="children"?typeof gt!="string"&&typeof gt!="number"||(J=J||[]).push(Bt,""+gt):Bt!=="suppressContentEditableWarning"&&Bt!=="suppressHydrationWarning"&&(o.hasOwnProperty(Bt)?(gt!=null&&Bt==="onScroll"&&oi("scroll",f),J||ot===gt||(J=[])):(J=J||[]).push(Bt,gt))}P&&(J=J||[]).push("style",P);var Bt=J;(v.updateQueue=Bt)&&(v.flags|=4)}},Ly=function(f,v,P,O){P!==O&&(v.flags|=4)};function gd(f,v){if(!Mi)switch(f.tailMode){case"hidden":v=f.tail;for(var P=null;v!==null;)v.alternate!==null&&(P=v),v=v.sibling;P===null?f.tail=null:P.sibling=null;break;case"collapsed":P=f.tail;for(var O=null;P!==null;)P.alternate!==null&&(O=P),P=P.sibling;O===null?v||f.tail===null?f.tail=null:f.tail.sibling=null:O.sibling=null}}function bs(f){var v=f.alternate!==null&&f.alternate.child===f.child,P=0,O=0;if(v)for(var G=f.child;G!==null;)P|=G.lanes|G.childLanes,O|=G.subtreeFlags&14680064,O|=G.flags&14680064,G.return=f,G=G.sibling;else for(G=f.child;G!==null;)P|=G.lanes|G.childLanes,O|=G.subtreeFlags,O|=G.flags,G.return=f,G=G.sibling;return f.subtreeFlags|=O,f.childLanes=P,v}function wx(f,v,P){var O=v.pendingProps;switch(id(v),v.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bs(v),null;case 1:return $o(v.type)&&Yc(),bs(v),null;case 3:return O=v.stateNode,g(),ri(rs),ri(mo),Z(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(f===null||f.child===null)&&(sd(v)?v.flags|=4:f===null||f.memoizedState.isDehydrated&&(v.flags&256)===0||(v.flags|=1024,_s!==null&&(wd(_s),_s=null))),md(f,v),bs(v),null;case 5:M(v);var G=i(S.current);if(P=v.type,f!==null&&v.stateNode!=null)xs(f,v,P,O,G),f.ref!==v.ref&&(v.flags|=512,v.flags|=2097152);else{if(!O){if(v.stateNode===null)throw Error(n(166));return bs(v),null}if(f=i(Os.current),sd(v)){O=v.stateNode,P=v.type;var J=v.memoizedProps;switch(O[Yr]=v,O[ea]=J,f=(v.mode&1)!==0,P){case"dialog":oi("cancel",O),oi("close",O);break;case"iframe":case"object":case"embed":oi("load",O);break;case"video":case"audio":for(G=0;G<Sr.length;G++)oi(Sr[G],O);break;case"source":oi("error",O);break;case"img":case"image":case"link":oi("error",O),oi("load",O);break;case"details":oi("toggle",O);break;case"input":Ln(O,J),oi("invalid",O);break;case"select":O._wrapperState={wasMultiple:!!J.multiple},oi("invalid",O);break;case"textarea":yt(O,J),oi("invalid",O)}fe(P,J),G=null;for(var be in J)if(J.hasOwnProperty(be)){var ot=J[be];be==="children"?typeof ot=="string"?O.textContent!==ot&&(J.suppressHydrationWarning!==!0&&fl(O.textContent,ot,f),G=["children",ot]):typeof ot=="number"&&O.textContent!==""+ot&&(J.suppressHydrationWarning!==!0&&fl(O.textContent,ot,f),G=["children",""+ot]):o.hasOwnProperty(be)&&ot!=null&&be==="onScroll"&&oi("scroll",O)}switch(P){case"input":dn(O),$t(O,J,!0);break;case"textarea":dn(O),Ht(O);break;case"select":case"option":break;default:typeof J.onClick=="function"&&(O.onclick=ac)}O=G,v.updateQueue=O,O!==null&&(v.flags|=4)}else{be=G.nodeType===9?G:G.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=Ot(P)),f==="http://www.w3.org/1999/xhtml"?P==="script"?(f=be.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof O.is=="string"?f=be.createElement(P,{is:O.is}):(f=be.createElement(P),P==="select"&&(be=f,O.multiple?be.multiple=!0:O.size&&(be.size=O.size))):f=be.createElementNS(f,P),f[Yr]=v,f[ea]=O,Cg(f,v,!1,!1),v.stateNode=f;e:{switch(be=Oe(P,O),P){case"dialog":oi("cancel",f),oi("close",f),G=O;break;case"iframe":case"object":case"embed":oi("load",f),G=O;break;case"video":case"audio":for(G=0;G<Sr.length;G++)oi(Sr[G],f);G=O;break;case"source":oi("error",f),G=O;break;case"img":case"image":case"link":oi("error",f),oi("load",f),G=O;break;case"details":oi("toggle",f),G=O;break;case"input":Ln(f,O),G=et(f,O),oi("invalid",f);break;case"option":G=O;break;case"select":f._wrapperState={wasMultiple:!!O.multiple},G=st({},O,{value:void 0}),oi("invalid",f);break;case"textarea":yt(f,O),G=we(f,O),oi("invalid",f);break;default:G=O}fe(P,G),ot=G;for(J in ot)if(ot.hasOwnProperty(J)){var gt=ot[J];J==="style"?ue(f,gt):J==="dangerouslySetInnerHTML"?(gt=gt?gt.__html:void 0,gt!=null&&Zt(f,gt)):J==="children"?typeof gt=="string"?(P!=="textarea"||gt!=="")&&Fn(f,gt):typeof gt=="number"&&Fn(f,""+gt):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(o.hasOwnProperty(J)?gt!=null&&J==="onScroll"&&oi("scroll",f):gt!=null&&B(f,J,gt,be))}switch(P){case"input":dn(f),$t(f,O,!1);break;case"textarea":dn(f),Ht(f);break;case"option":O.value!=null&&f.setAttribute("value",""+lt(O.value));break;case"select":f.multiple=!!O.multiple,J=O.value,J!=null?Ue(f,!!O.multiple,J,!1):O.defaultValue!=null&&Ue(f,!!O.multiple,O.defaultValue,!0);break;default:typeof G.onClick=="function"&&(f.onclick=ac)}switch(P){case"button":case"input":case"select":case"textarea":O=!!O.autoFocus;break e;case"img":O=!0;break e;default:O=!1}}O&&(v.flags|=4)}v.ref!==null&&(v.flags|=512,v.flags|=2097152)}return bs(v),null;case 6:if(f&&v.stateNode!=null)Ly(f,v,f.memoizedProps,O);else{if(typeof O!="string"&&v.stateNode===null)throw Error(n(166));if(P=i(S.current),i(Os.current),sd(v)){if(O=v.stateNode,P=v.memoizedProps,O[Yr]=v,(J=O.nodeValue!==P)&&(f=dr,f!==null))switch(f.tag){case 3:fl(O.nodeValue,P,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&fl(O.nodeValue,P,(f.mode&1)!==0)}J&&(v.flags|=4)}else O=(P.nodeType===9?P:P.ownerDocument).createTextNode(O),O[Yr]=v,v.stateNode=O}return bs(v),null;case 13:if(ri(D),O=v.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(Mi&&is!==null&&(v.mode&1)!==0&&(v.flags&128)===0)Gu(),Wu(),v.flags|=98560,J=!1;else if(J=sd(v),O!==null&&O.dehydrated!==null){if(f===null){if(!J)throw Error(n(318));if(J=v.memoizedState,J=J!==null?J.dehydrated:null,!J)throw Error(n(317));J[Yr]=v}else Wu(),(v.flags&128)===0&&(v.memoizedState=null),v.flags|=4;bs(v),J=!1}else _s!==null&&(wd(_s),_s=null),J=!0;if(!J)return v.flags&65536?v:null}return(v.flags&128)!==0?(v.lanes=P,v):(O=O!==null,O!==(f!==null&&f.memoizedState!==null)&&O&&(v.child.flags|=8192,(v.mode&1)!==0&&(f===null||(D.current&1)!==0?Gi===0&&(Gi=3):Vy())),v.updateQueue!==null&&(v.flags|=4),bs(v),null);case 4:return g(),md(f,v),f===null&&zu(v.stateNode.containerInfo),bs(v),null;case 10:return qu(v.type._context),bs(v),null;case 17:return $o(v.type)&&Yc(),bs(v),null;case 19:if(ri(D),J=v.memoizedState,J===null)return bs(v),null;if(O=(v.flags&128)!==0,be=J.rendering,be===null)if(O)gd(J,!1);else{if(Gi!==0||f!==null&&(f.flags&128)!==0)for(f=v.child;f!==null;){if(be=F(f),be!==null){for(v.flags|=128,gd(J,!1),O=be.updateQueue,O!==null&&(v.updateQueue=O,v.flags|=4),v.subtreeFlags=0,O=P,P=v.child;P!==null;)J=P,f=O,J.flags&=14680066,be=J.alternate,be===null?(J.childLanes=0,J.lanes=f,J.child=null,J.subtreeFlags=0,J.memoizedProps=null,J.memoizedState=null,J.updateQueue=null,J.dependencies=null,J.stateNode=null):(J.childLanes=be.childLanes,J.lanes=be.lanes,J.child=be.child,J.subtreeFlags=0,J.deletions=null,J.memoizedProps=be.memoizedProps,J.memoizedState=be.memoizedState,J.updateQueue=be.updateQueue,J.type=be.type,f=be.dependencies,J.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),P=P.sibling;return Pr(D,D.current&1|2),v.child}f=f.sibling}J.tail!==null&&xt()>bd&&(v.flags|=128,O=!0,gd(J,!1),v.lanes=4194304)}else{if(!O)if(f=F(be),f!==null){if(v.flags|=128,O=!0,P=f.updateQueue,P!==null&&(v.updateQueue=P,v.flags|=4),gd(J,!0),J.tail===null&&J.tailMode==="hidden"&&!be.alternate&&!Mi)return bs(v),null}else 2*xt()-J.renderingStartTime>bd&&P!==1073741824&&(v.flags|=128,O=!0,gd(J,!1),v.lanes=4194304);J.isBackwards?(be.sibling=v.child,v.child=be):(P=J.last,P!==null?P.sibling=be:v.child=be,J.last=be)}return J.tail!==null?(v=J.tail,J.rendering=v,J.tail=v.sibling,J.renderingStartTime=xt(),v.sibling=null,P=D.current,Pr(D,O?P&1|2:P&1),v):(bs(v),null);case 22:case 23:return Uy(),O=v.memoizedState!==null,f!==null&&f.memoizedState!==null!==O&&(v.flags|=8192),O&&(v.mode&1)!==0?(ws&1073741824)!==0&&(bs(v),v.subtreeFlags&6&&(v.flags|=8192)):bs(v),null;case 24:return null;case 25:return null}throw Error(n(156,v.tag))}function dS(f,v){switch(id(v),v.tag){case 1:return $o(v.type)&&Yc(),f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 3:return g(),ri(rs),ri(mo),Z(),f=v.flags,(f&65536)!==0&&(f&128)===0?(v.flags=f&-65537|128,v):null;case 5:return M(v),null;case 13:if(ri(D),f=v.memoizedState,f!==null&&f.dehydrated!==null){if(v.alternate===null)throw Error(n(340));Wu()}return f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 19:return ri(D),null;case 4:return g(),null;case 10:return qu(v.type._context),null;case 22:case 23:return Uy(),null;case 24:return null;default:return null}}var Eg=!1,ls=!1,fS=typeof WeakSet=="function"?WeakSet:Set,er=null;function vd(f,v){var P=f.ref;if(P!==null)if(typeof P=="function")try{P(null)}catch(O){Ui(f,v,O)}else P.current=null}function Tg(f,v,P){try{P()}catch(O){Ui(f,v,O)}}var Sx=!1;function pS(f,v){if(ed=La,f=hg(),cf(f)){if("selectionStart"in f)var P={start:f.selectionStart,end:f.selectionEnd};else e:{P=(P=f.ownerDocument)&&P.defaultView||window;var O=P.getSelection&&P.getSelection();if(O&&O.rangeCount!==0){P=O.anchorNode;var G=O.anchorOffset,J=O.focusNode;O=O.focusOffset;try{P.nodeType,J.nodeType}catch{P=null;break e}var be=0,ot=-1,gt=-1,Bt=0,bn=0,Mn=f,yn=null;t:for(;;){for(var Un;Mn!==P||G!==0&&Mn.nodeType!==3||(ot=be+G),Mn!==J||O!==0&&Mn.nodeType!==3||(gt=be+O),Mn.nodeType===3&&(be+=Mn.nodeValue.length),(Un=Mn.firstChild)!==null;)yn=Mn,Mn=Un;for(;;){if(Mn===f)break t;if(yn===P&&++Bt===G&&(ot=be),yn===J&&++bn===O&&(gt=be),(Un=Mn.nextSibling)!==null)break;Mn=yn,yn=Mn.parentNode}Mn=Un}P=ot===-1||gt===-1?null:{start:ot,end:gt}}else P=null}P=P||{start:0,end:0}}else P=null;for(Fa={focusedElem:f,selectionRange:P},La=!1,er=v;er!==null;)if(v=er,f=v.child,(v.subtreeFlags&1028)!==0&&f!==null)f.return=v,er=f;else for(;er!==null;){v=er;try{var Yn=v.alternate;if((v.flags&1024)!==0)switch(v.tag){case 0:case 11:case 15:break;case 1:if(Yn!==null){var rr=Yn.memoizedProps,Wi=Yn.memoizedState,Lt=v.stateNode,_t=Lt.getSnapshotBeforeUpdate(v.elementType===v.type?rr:Fs(v.type,rr),Wi);Lt.__reactInternalSnapshotBeforeUpdate=_t}break;case 3:var zt=v.stateNode.containerInfo;zt.nodeType===1?zt.textContent="":zt.nodeType===9&&zt.documentElement&&zt.removeChild(zt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(In){Ui(v,v.return,In)}if(f=v.sibling,f!==null){f.return=v.return,er=f;break}er=v.return}return Yn=Sx,Sx=!1,Yn}function Jp(f,v,P){var O=v.updateQueue;if(O=O!==null?O.lastEffect:null,O!==null){var G=O=O.next;do{if((G.tag&f)===f){var J=G.destroy;G.destroy=void 0,J!==void 0&&Tg(v,P,J)}G=G.next}while(G!==O)}}function Sf(f,v){if(v=v.updateQueue,v=v!==null?v.lastEffect:null,v!==null){var P=v=v.next;do{if((P.tag&f)===f){var O=P.create;P.destroy=O()}P=P.next}while(P!==v)}}function Qp(f){var v=f.ref;if(v!==null){var P=f.stateNode;switch(f.tag){case 5:f=P;break;default:f=P}typeof v=="function"?v(f):v.current=f}}function Dy(f){var v=f.alternate;v!==null&&(f.alternate=null,Dy(v)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(v=f.stateNode,v!==null&&(delete v[Yr],delete v[ea],delete v[Fu],delete v[nd],delete v[Nu])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function nh(f){return f.tag===5||f.tag===3||f.tag===4}function Mf(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||nh(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function ky(f,v,P){var O=f.tag;if(O===5||O===6)f=f.stateNode,v?P.nodeType===8?P.parentNode.insertBefore(f,v):P.insertBefore(f,v):(P.nodeType===8?(v=P.parentNode,v.insertBefore(f,P)):(v=P,v.appendChild(f)),P=P._reactRootContainer,P!=null||v.onclick!==null||(v.onclick=ac));else if(O!==4&&(f=f.child,f!==null))for(ky(f,v,P),f=f.sibling;f!==null;)ky(f,v,P),f=f.sibling}function zy(f,v,P){var O=f.tag;if(O===5||O===6)f=f.stateNode,v?P.insertBefore(f,v):P.appendChild(f);else if(O!==4&&(f=f.child,f!==null))for(zy(f,v,P),f=f.sibling;f!==null;)zy(f,v,P),f=f.sibling}var cs=null,bl=!1;function rh(f,v,P){for(P=P.child;P!==null;)Mx(f,v,P),P=P.sibling}function Mx(f,v,P){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(Zn,P)}catch{}switch(P.tag){case 5:ls||vd(P,v);case 6:var O=cs,G=bl;cs=null,rh(f,v,P),cs=O,bl=G,cs!==null&&(bl?(f=cs,P=P.stateNode,f.nodeType===8?f.parentNode.removeChild(P):f.removeChild(P)):cs.removeChild(P.stateNode));break;case 18:cs!==null&&(bl?(f=cs,P=P.stateNode,f.nodeType===8?Wc(f.parentNode,P):f.nodeType===1&&Wc(f,P),ha(f)):Wc(cs,P.stateNode));break;case 4:O=cs,G=bl,cs=P.stateNode.containerInfo,bl=!0,rh(f,v,P),cs=O,bl=G;break;case 0:case 11:case 14:case 15:if(!ls&&(O=P.updateQueue,O!==null&&(O=O.lastEffect,O!==null))){G=O=O.next;do{var J=G,be=J.destroy;J=J.tag,be!==void 0&&((J&2)!==0||(J&4)!==0)&&Tg(P,v,be),G=G.next}while(G!==O)}rh(f,v,P);break;case 1:if(!ls&&(vd(P,v),O=P.stateNode,typeof O.componentWillUnmount=="function"))try{O.props=P.memoizedProps,O.state=P.memoizedState,O.componentWillUnmount()}catch(ot){Ui(P,v,ot)}rh(f,v,P);break;case 21:rh(f,v,P);break;case 22:P.mode&1?(ls=(O=ls)||P.memoizedState!==null,rh(f,v,P),ls=O):rh(f,v,P);break;default:rh(f,v,P)}}function Cx(f){var v=f.updateQueue;if(v!==null){f.updateQueue=null;var P=f.stateNode;P===null&&(P=f.stateNode=new fS),v.forEach(function(O){var G=yS.bind(null,f,O);P.has(O)||(P.add(O),O.then(G,G))})}}function _a(f,v){var P=v.deletions;if(P!==null)for(var O=0;O<P.length;O++){var G=P[O];try{var J=f,be=v,ot=be;e:for(;ot!==null;){switch(ot.tag){case 5:cs=ot.stateNode,bl=!1;break e;case 3:cs=ot.stateNode.containerInfo,bl=!0;break e;case 4:cs=ot.stateNode.containerInfo,bl=!0;break e}ot=ot.return}if(cs===null)throw Error(n(160));Mx(J,be,G),cs=null,bl=!1;var gt=G.alternate;gt!==null&&(gt.return=null),G.return=null}catch(Bt){Ui(G,v,Bt)}}if(v.subtreeFlags&12854)for(v=v.child;v!==null;)Ex(v,f),v=v.sibling}function Ex(f,v){var P=f.alternate,O=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(_a(v,f),wl(f),O&4){try{Jp(3,f,f.return),Sf(3,f)}catch(rr){Ui(f,f.return,rr)}try{Jp(5,f,f.return)}catch(rr){Ui(f,f.return,rr)}}break;case 1:_a(v,f),wl(f),O&512&&P!==null&&vd(P,P.return);break;case 5:if(_a(v,f),wl(f),O&512&&P!==null&&vd(P,P.return),f.flags&32){var G=f.stateNode;try{Fn(G,"")}catch(rr){Ui(f,f.return,rr)}}if(O&4&&(G=f.stateNode,G!=null)){var J=f.memoizedProps,be=P!==null?P.memoizedProps:J,ot=f.type,gt=f.updateQueue;if(f.updateQueue=null,gt!==null)try{ot==="input"&&J.type==="radio"&&J.name!=null&&Jt(G,J),Oe(ot,be);var Bt=Oe(ot,J);for(be=0;be<gt.length;be+=2){var bn=gt[be],Mn=gt[be+1];bn==="style"?ue(G,Mn):bn==="dangerouslySetInnerHTML"?Zt(G,Mn):bn==="children"?Fn(G,Mn):B(G,bn,Mn,Bt)}switch(ot){case"input":fn(G,J);break;case"textarea":Nt(G,J);break;case"select":var yn=G._wrapperState.wasMultiple;G._wrapperState.wasMultiple=!!J.multiple;var Un=J.value;Un!=null?Ue(G,!!J.multiple,Un,!1):yn!==!!J.multiple&&(J.defaultValue!=null?Ue(G,!!J.multiple,J.defaultValue,!0):Ue(G,!!J.multiple,J.multiple?[]:"",!1))}G[ea]=J}catch(rr){Ui(f,f.return,rr)}}break;case 6:if(_a(v,f),wl(f),O&4){if(f.stateNode===null)throw Error(n(162));G=f.stateNode,J=f.memoizedProps;try{G.nodeValue=J}catch(rr){Ui(f,f.return,rr)}}break;case 3:if(_a(v,f),wl(f),O&4&&P!==null&&P.memoizedState.isDehydrated)try{ha(v.containerInfo)}catch(rr){Ui(f,f.return,rr)}break;case 4:_a(v,f),wl(f);break;case 13:_a(v,f),wl(f),G=f.child,G.flags&8192&&(J=G.memoizedState!==null,G.stateNode.isHidden=J,!J||G.alternate!==null&&G.alternate.memoizedState!==null||(nm=xt())),O&4&&Cx(f);break;case 22:if(bn=P!==null&&P.memoizedState!==null,f.mode&1?(ls=(Bt=ls)||bn,_a(v,f),ls=Bt):_a(v,f),wl(f),O&8192){if(Bt=f.memoizedState!==null,(f.stateNode.isHidden=Bt)&&!bn&&(f.mode&1)!==0)for(er=f,bn=f.child;bn!==null;){for(Mn=er=bn;er!==null;){switch(yn=er,Un=yn.child,yn.tag){case 0:case 11:case 14:case 15:Jp(4,yn,yn.return);break;case 1:vd(yn,yn.return);var Yn=yn.stateNode;if(typeof Yn.componentWillUnmount=="function"){O=yn,P=yn.return;try{v=O,Yn.props=v.memoizedProps,Yn.state=v.memoizedState,Yn.componentWillUnmount()}catch(rr){Ui(O,P,rr)}}break;case 5:vd(yn,yn.return);break;case 22:if(yn.memoizedState!==null){yd(Mn);continue}}Un!==null?(Un.return=yn,er=Un):yd(Mn)}bn=bn.sibling}e:for(bn=null,Mn=f;;){if(Mn.tag===5){if(bn===null){bn=Mn;try{G=Mn.stateNode,Bt?(J=G.style,typeof J.setProperty=="function"?J.setProperty("display","none","important"):J.display="none"):(ot=Mn.stateNode,gt=Mn.memoizedProps.style,be=gt!=null&&gt.hasOwnProperty("display")?gt.display:null,ot.style.display=ae("display",be))}catch(rr){Ui(f,f.return,rr)}}}else if(Mn.tag===6){if(bn===null)try{Mn.stateNode.nodeValue=Bt?"":Mn.memoizedProps}catch(rr){Ui(f,f.return,rr)}}else if((Mn.tag!==22&&Mn.tag!==23||Mn.memoizedState===null||Mn===f)&&Mn.child!==null){Mn.child.return=Mn,Mn=Mn.child;continue}if(Mn===f)break e;for(;Mn.sibling===null;){if(Mn.return===null||Mn.return===f)break e;bn===Mn&&(bn=null),Mn=Mn.return}bn===Mn&&(bn=null),Mn.sibling.return=Mn.return,Mn=Mn.sibling}}break;case 19:_a(v,f),wl(f),O&4&&Cx(f);break;case 21:break;default:_a(v,f),wl(f)}}function wl(f){var v=f.flags;if(v&2){try{e:{for(var P=f.return;P!==null;){if(nh(P)){var O=P;break e}P=P.return}throw Error(n(160))}switch(O.tag){case 5:var G=O.stateNode;O.flags&32&&(Fn(G,""),O.flags&=-33);var J=Mf(f);zy(f,J,G);break;case 3:case 4:var be=O.stateNode.containerInfo,ot=Mf(f);ky(f,ot,be);break;default:throw Error(n(161))}}catch(gt){Ui(f,f.return,gt)}f.flags&=-3}v&4096&&(f.flags&=-4097)}function em(f,v,P){er=f,Tx(f)}function Tx(f,v,P){for(var O=(f.mode&1)!==0;er!==null;){var G=er,J=G.child;if(G.tag===22&&O){var be=G.memoizedState!==null||Eg;if(!be){var ot=G.alternate,gt=ot!==null&&ot.memoizedState!==null||ls;ot=Eg;var Bt=ls;if(Eg=be,(ls=gt)&&!Bt)for(er=G;er!==null;)be=er,gt=be.child,be.tag===22&&be.memoizedState!==null?Oy(G):gt!==null?(gt.return=be,er=gt):Oy(G);for(;J!==null;)er=J,Tx(J),J=J.sibling;er=G,Eg=ot,ls=Bt}Bi(f)}else(G.subtreeFlags&8772)!==0&&J!==null?(J.return=G,er=J):Bi(f)}}function Bi(f){for(;er!==null;){var v=er;if((v.flags&8772)!==0){var P=v.alternate;try{if((v.flags&8772)!==0)switch(v.tag){case 0:case 11:case 15:ls||Sf(5,v);break;case 1:var O=v.stateNode;if(v.flags&4&&!ls)if(P===null)O.componentDidMount();else{var G=v.elementType===v.type?P.memoizedProps:Fs(v.type,P.memoizedProps);O.componentDidUpdate(G,P.memoizedState,O.__reactInternalSnapshotBeforeUpdate)}var J=v.updateQueue;J!==null&&Zu(v,J,O);break;case 3:var be=v.updateQueue;if(be!==null){if(P=null,v.child!==null)switch(v.child.tag){case 5:P=v.child.stateNode;break;case 1:P=v.child.stateNode}Zu(v,be,P)}break;case 5:var ot=v.stateNode;if(P===null&&v.flags&4){P=ot;var gt=v.memoizedProps;switch(v.type){case"button":case"input":case"select":case"textarea":gt.autoFocus&&P.focus();break;case"img":gt.src&&(P.src=gt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(v.memoizedState===null){var Bt=v.alternate;if(Bt!==null){var bn=Bt.memoizedState;if(bn!==null){var Mn=bn.dehydrated;Mn!==null&&ha(Mn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ls||v.flags&512&&Qp(v)}catch(yn){Ui(v,v.return,yn)}}if(v===f){er=null;break}if(P=v.sibling,P!==null){P.return=v.return,er=P;break}er=v.return}}function yd(f){for(;er!==null;){var v=er;if(v===f){er=null;break}var P=v.sibling;if(P!==null){P.return=v.return,er=P;break}er=v.return}}function Oy(f){for(;er!==null;){var v=er;try{switch(v.tag){case 0:case 11:case 15:var P=v.return;try{Sf(4,v)}catch(gt){Ui(v,P,gt)}break;case 1:var O=v.stateNode;if(typeof O.componentDidMount=="function"){var G=v.return;try{O.componentDidMount()}catch(gt){Ui(v,G,gt)}}var J=v.return;try{Qp(v)}catch(gt){Ui(v,J,gt)}break;case 5:var be=v.return;try{Qp(v)}catch(gt){Ui(v,be,gt)}}}catch(gt){Ui(v,v.return,gt)}if(v===f){er=null;break}var ot=v.sibling;if(ot!==null){ot.return=v.return,er=ot;break}er=v.return}}var Pg=Math.ceil,_d=W.ReactCurrentDispatcher,xd=W.ReactCurrentOwner,xa=W.ReactCurrentBatchConfig,Jr=0,Ji=null,Qi=null,eo=0,ws=0,Sl=Ds(0),Gi=0,tm=null,ih=0,vc=0,Fy=0,Cf=null,Ho=null,nm=0,bd=1/0,yc=null,Ag=!1,Ny=null,oh=null,Ig=!1,sh=null,Ef=0,Tf=0,rm=null,im=-1,Pf=0;function Ss(){return(Jr&6)!==0?xt():im!==-1?im:im=xt()}function ru(f){return(f.mode&1)===0?1:(Jr&2)!==0&&eo!==0?eo&-eo:dc.transition!==null?(Pf===0&&(Pf=Zr()),Pf):(f=Nr,f!==0||(f=window.event,f=f===void 0?16:Cp(f.type)),f)}function na(f,v,P,O){if(50<Tf)throw Tf=0,rm=null,Error(n(185));Xi(f,P,O),((Jr&2)===0||f!==Ji)&&(f===Ji&&((Jr&2)===0&&(vc|=P),Gi===4&&_c(f,eo)),$s(f,O),P===1&&Jr===0&&(v.mode&1)===0&&(bd=xt()+500,ys&&cc()))}function $s(f,v){var P=f.callbackNode;Jo(f,v);var O=Eo(f,f===Ji?eo:0);if(O===0)P!==null&&xe(P),f.callbackNode=null,f.callbackPriority=0;else if(v=O&-O,f.callbackPriority!==v){if(P!=null&&xe(P),v===1)f.tag===0?Uu(Af.bind(null,f)):Vo(Af.bind(null,f)),fg(function(){(Jr&6)===0&&cc()}),P=null;else{switch(io(O)){case 1:P=hn;break;case 4:P=Pn;break;case 16:P=mn;break;case 536870912:P=Qt;break;default:P=mn}P=kx(P,By.bind(null,f))}f.callbackPriority=v,f.callbackNode=P}}function By(f,v){if(im=-1,Pf=0,(Jr&6)!==0)throw Error(n(327));var P=f.callbackNode;if(If()&&f.callbackNode!==P)return null;var O=Eo(f,f===Ji?eo:0);if(O===0)return null;if((O&30)!==0||(O&f.expiredLanes)!==0||v)v=lh(f,O);else{v=O;var G=Jr;Jr|=2;var J=Px();(Ji!==f||eo!==v)&&(yc=null,bd=xt()+500,ah(f,v));do try{gS();break}catch(ot){$y(f,ot)}while(!0);ar(),_d.current=J,Jr=G,Qi!==null?v=0:(Ji=null,eo=0,v=Gi)}if(v!==0){if(v===2&&(G=Ia(f),G!==0&&(O=G,v=Rg(f,G))),v===1)throw P=tm,ah(f,0),_c(f,O),$s(f,xt()),P;if(v===6)_c(f,O);else{if(G=f.current.alternate,(O&30)===0&&!mS(G)&&(v=lh(f,O),v===2&&(J=Ia(f),J!==0&&(O=J,v=Rg(f,J))),v===1))throw P=tm,ah(f,0),_c(f,O),$s(f,xt()),P;switch(f.finishedWork=G,f.finishedLanes=O,v){case 0:case 1:throw Error(n(345));case 2:Md(f,Ho,yc);break;case 3:if(_c(f,O),(O&130023424)===O&&(v=nm+500-xt(),10<v)){if(Eo(f,0)!==0)break;if(G=f.suspendedLanes,(G&O)!==O){Ss(),f.pingedLanes|=f.suspendedLanes&G;break}f.timeoutHandle=df(Md.bind(null,f,Ho,yc),v);break}Md(f,Ho,yc);break;case 4:if(_c(f,O),(O&4194240)===O)break;for(v=f.eventTimes,G=-1;0<O;){var be=31-tr(O);J=1<<be,be=v[be],be>G&&(G=be),O&=~J}if(O=G,O=xt()-O,O=(120>O?120:480>O?480:1080>O?1080:1920>O?1920:3e3>O?3e3:4320>O?4320:1960*Pg(O/1960))-O,10<O){f.timeoutHandle=df(Md.bind(null,f,Ho,yc),O);break}Md(f,Ho,yc);break;case 5:Md(f,Ho,yc);break;default:throw Error(n(329))}}}return $s(f,xt()),f.callbackNode===P?By.bind(null,f):null}function Rg(f,v){var P=Cf;return f.current.memoizedState.isDehydrated&&(ah(f,v).flags|=256),f=lh(f,v),f!==2&&(v=Ho,Ho=P,v!==null&&wd(v)),f}function wd(f){Ho===null?Ho=f:Ho.push.apply(Ho,f)}function mS(f){for(var v=f;;){if(v.flags&16384){var P=v.updateQueue;if(P!==null&&(P=P.stores,P!==null))for(var O=0;O<P.length;O++){var G=P[O],J=G.getSnapshot;G=G.value;try{if(!Po(J(),G))return!1}catch{return!1}}}if(P=v.child,v.subtreeFlags&16384&&P!==null)P.return=v,v=P;else{if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function _c(f,v){for(v&=~Fy,v&=~vc,f.suspendedLanes|=v,f.pingedLanes&=~v,f=f.expirationTimes;0<v;){var P=31-tr(v),O=1<<P;f[P]=-1,v&=~O}}function Af(f){if((Jr&6)!==0)throw Error(n(327));If();var v=Eo(f,0);if((v&1)===0)return $s(f,xt()),null;var P=lh(f,v);if(f.tag!==0&&P===2){var O=Ia(f);O!==0&&(v=O,P=Rg(f,O))}if(P===1)throw P=tm,ah(f,0),_c(f,v),$s(f,xt()),P;if(P===6)throw Error(n(345));return f.finishedWork=f.current.alternate,f.finishedLanes=v,Md(f,Ho,yc),$s(f,xt()),null}function om(f,v){var P=Jr;Jr|=1;try{return f(v)}finally{Jr=P,Jr===0&&(bd=xt()+500,ys&&cc())}}function Sd(f){sh!==null&&sh.tag===0&&(Jr&6)===0&&If();var v=Jr;Jr|=1;var P=xa.transition,O=Nr;try{if(xa.transition=null,Nr=1,f)return f()}finally{Nr=O,xa.transition=P,Jr=v,(Jr&6)===0&&cc()}}function Uy(){ws=Sl.current,ri(Sl)}function ah(f,v){f.finishedWork=null,f.finishedLanes=0;var P=f.timeoutHandle;if(P!==-1&&(f.timeoutHandle=-1,ff(P)),Qi!==null)for(P=Qi.return;P!==null;){var O=P;switch(id(O),O.tag){case 1:O=O.type.childContextTypes,O!=null&&Yc();break;case 3:g(),ri(rs),ri(mo),Z();break;case 5:M(O);break;case 4:g();break;case 13:ri(D);break;case 19:ri(D);break;case 10:qu(O.type._context);break;case 22:case 23:Uy()}P=P.return}if(Ji=f,Qi=f=iu(f.current,null),eo=ws=v,Gi=0,tm=null,Fy=vc=ih=0,Ho=Cf=null,pc!==null){for(v=0;v<pc.length;v++)if(P=pc[v],O=P.interleaved,O!==null){P.interleaved=null;var G=O.next,J=P.pending;if(J!==null){var be=J.next;J.next=G,O.next=be}P.pending=O}pc=null}return f}function $y(f,v){do{var P=Qi;try{if(ar(),K.current=yo,ze){for(var O=le.memoizedState;O!==null;){var G=O.queue;G!==null&&(G.pending=null),O=O.next}ze=!1}if(ne=0,Le=ge=le=null,Ne=!1,Ge=0,xd.current=null,P===null||P.return===null){Gi=1,tm=v,Qi=null;break}e:{var J=f,be=P.return,ot=P,gt=v;if(v=eo,ot.flags|=32768,gt!==null&&typeof gt=="object"&&typeof gt.then=="function"){var Bt=gt,bn=ot,Mn=bn.tag;if((bn.mode&1)===0&&(Mn===0||Mn===11||Mn===15)){var yn=bn.alternate;yn?(bn.updateQueue=yn.updateQueue,bn.memoizedState=yn.memoizedState,bn.lanes=yn.lanes):(bn.updateQueue=null,bn.memoizedState=null)}var Un=Cy(be);if(Un!==null){Un.flags&=-257,vx(Un,be,ot,J,v),Un.mode&1&&eh(J,Bt,v),v=Un,gt=Bt;var Yn=v.updateQueue;if(Yn===null){var rr=new Set;rr.add(gt),v.updateQueue=rr}else Yn.add(gt);break e}else{if((v&1)===0){eh(J,Bt,v),Vy();break e}gt=Error(n(426))}}else if(Mi&&ot.mode&1){var Wi=Cy(be);if(Wi!==null){(Wi.flags&65536)===0&&(Wi.flags|=256),vx(Wi,be,ot,J,v),ad(Ns(gt,ot));break e}}J=gt=Ns(gt,ot),Gi!==4&&(Gi=2),Cf===null?Cf=[J]:Cf.push(J),J=be;do{switch(J.tag){case 3:J.flags|=65536,v&=-v,J.lanes|=v;var Lt=My(J,gt,v);ud(J,Lt);break e;case 1:ot=gt;var _t=J.type,zt=J.stateNode;if((J.flags&128)===0&&(typeof _t.getDerivedStateFromError=="function"||zt!==null&&typeof zt.componentDidCatch=="function"&&(oh===null||!oh.has(zt)))){J.flags|=65536,v&=-v,J.lanes|=v;var In=Qu(J,ot,v);ud(J,In);break e}}J=J.return}while(J!==null)}Rx(P)}catch(cr){v=cr,Qi===P&&P!==null&&(Qi=P=P.return);continue}break}while(!0)}function Px(){var f=_d.current;return _d.current=yo,f===null?yo:f}function Vy(){(Gi===0||Gi===3||Gi===2)&&(Gi=4),Ji===null||(ih&268435455)===0&&(vc&268435455)===0||_c(Ji,eo)}function lh(f,v){var P=Jr;Jr|=2;var O=Px();(Ji!==f||eo!==v)&&(yc=null,ah(f,v));do try{Ax();break}catch(G){$y(f,G)}while(!0);if(ar(),Jr=P,_d.current=O,Qi!==null)throw Error(n(261));return Ji=null,eo=0,Gi}function Ax(){for(;Qi!==null;)Ix(Qi)}function gS(){for(;Qi!==null&&!vt();)Ix(Qi)}function Ix(f){var v=sm(f.alternate,f,ws);f.memoizedProps=f.pendingProps,v===null?Rx(f):Qi=v,xd.current=null}function Rx(f){var v=f;do{var P=v.alternate;if(f=v.return,(v.flags&32768)===0){if(P=wx(P,v,ws),P!==null){Qi=P;return}}else{if(P=dS(P,v),P!==null){P.flags&=32767,Qi=P;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{Gi=6,Qi=null;return}}if(v=v.sibling,v!==null){Qi=v;return}Qi=v=f}while(v!==null);Gi===0&&(Gi=5)}function Md(f,v,P){var O=Nr,G=xa.transition;try{xa.transition=null,Nr=1,vS(f,v,P,O)}finally{xa.transition=G,Nr=O}return null}function vS(f,v,P,O){do If();while(sh!==null);if((Jr&6)!==0)throw Error(n(327));P=f.finishedWork;var G=f.finishedLanes;if(P===null)return null;if(f.finishedWork=null,f.finishedLanes=0,P===f.current)throw Error(n(177));f.callbackNode=null,f.callbackPriority=0;var J=P.lanes|P.childLanes;if(ho(f,J),f===Ji&&(Qi=Ji=null,eo=0),(P.subtreeFlags&2064)===0&&(P.flags&2064)===0||Ig||(Ig=!0,kx(mn,function(){return If(),null})),J=(P.flags&15990)!==0,(P.subtreeFlags&15990)!==0||J){J=xa.transition,xa.transition=null;var be=Nr;Nr=1;var ot=Jr;Jr|=4,xd.current=null,pS(f,P),Ex(P,f),wy(Fa),La=!!ed,Fa=ed=null,f.current=P,em(P),kt(),Jr=ot,Nr=be,xa.transition=J}else f.current=P;if(Ig&&(Ig=!1,sh=f,Ef=G),J=f.pendingLanes,J===0&&(oh=null),Wn(P.stateNode),$s(f,xt()),v!==null)for(O=f.onRecoverableError,P=0;P<v.length;P++)G=v[P],O(G.value,{componentStack:G.stack,digest:G.digest});if(Ag)throw Ag=!1,f=Ny,Ny=null,f;return(Ef&1)!==0&&f.tag!==0&&If(),J=f.pendingLanes,(J&1)!==0?f===rm?Tf++:(Tf=0,rm=f):Tf=0,cc(),null}function If(){if(sh!==null){var f=io(Ef),v=xa.transition,P=Nr;try{if(xa.transition=null,Nr=16>f?16:f,sh===null)var O=!1;else{if(f=sh,sh=null,Ef=0,(Jr&6)!==0)throw Error(n(331));var G=Jr;for(Jr|=4,er=f.current;er!==null;){var J=er,be=J.child;if((er.flags&16)!==0){var ot=J.deletions;if(ot!==null){for(var gt=0;gt<ot.length;gt++){var Bt=ot[gt];for(er=Bt;er!==null;){var bn=er;switch(bn.tag){case 0:case 11:case 15:Jp(8,bn,J)}var Mn=bn.child;if(Mn!==null)Mn.return=bn,er=Mn;else for(;er!==null;){bn=er;var yn=bn.sibling,Un=bn.return;if(Dy(bn),bn===Bt){er=null;break}if(yn!==null){yn.return=Un,er=yn;break}er=Un}}}var Yn=J.alternate;if(Yn!==null){var rr=Yn.child;if(rr!==null){Yn.child=null;do{var Wi=rr.sibling;rr.sibling=null,rr=Wi}while(rr!==null)}}er=J}}if((J.subtreeFlags&2064)!==0&&be!==null)be.return=J,er=be;else e:for(;er!==null;){if(J=er,(J.flags&2048)!==0)switch(J.tag){case 0:case 11:case 15:Jp(9,J,J.return)}var Lt=J.sibling;if(Lt!==null){Lt.return=J.return,er=Lt;break e}er=J.return}}var _t=f.current;for(er=_t;er!==null;){be=er;var zt=be.child;if((be.subtreeFlags&2064)!==0&&zt!==null)zt.return=be,er=zt;else e:for(be=_t;er!==null;){if(ot=er,(ot.flags&2048)!==0)try{switch(ot.tag){case 0:case 11:case 15:Sf(9,ot)}}catch(cr){Ui(ot,ot.return,cr)}if(ot===be){er=null;break e}var In=ot.sibling;if(In!==null){In.return=ot.return,er=In;break e}er=ot.return}}if(Jr=G,cc(),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(Zn,f)}catch{}O=!0}return O}finally{Nr=P,xa.transition=v}}return!1}function jy(f,v,P){v=Ns(P,v),v=My(f,v,1),f=ss(f,v,1),v=Ss(),f!==null&&(Xi(f,1,v),$s(f,v))}function Ui(f,v,P){if(f.tag===3)jy(f,f,P);else for(;v!==null;){if(v.tag===3){jy(v,f,P);break}else if(v.tag===1){var O=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(oh===null||!oh.has(O))){f=Ns(P,f),f=Qu(v,f,1),v=ss(v,f,1),f=Ss(),v!==null&&(Xi(v,1,f),$s(v,f));break}}v=v.return}}function Lx(f,v,P){var O=f.pingCache;O!==null&&O.delete(v),v=Ss(),f.pingedLanes|=f.suspendedLanes&P,Ji===f&&(eo&P)===P&&(Gi===4||Gi===3&&(eo&130023424)===eo&&500>xt()-nm?ah(f,0):Fy|=P),$s(f,v)}function Hy(f,v){v===0&&((f.mode&1)===0?v=1:(v=ui,ui<<=1,(ui&130023424)===0&&(ui=4194304)));var P=Ss();f=os(f,v),f!==null&&(Xi(f,v,P),$s(f,P))}function Dx(f){var v=f.memoizedState,P=0;v!==null&&(P=v.retryLane),Hy(f,P)}function yS(f,v){var P=0;switch(f.tag){case 13:var O=f.stateNode,G=f.memoizedState;G!==null&&(P=G.retryLane);break;case 19:O=f.stateNode;break;default:throw Error(n(314))}O!==null&&O.delete(v),Hy(f,P)}var sm;sm=function(f,v,P){if(f!==null)if(f.memoizedProps!==v.pendingProps||rs.current)Bs=!0;else{if((f.lanes&P)===0&&(v.flags&128)===0)return Bs=!1,bx(f,v,P);Bs=(f.flags&131072)!==0}else Bs=!1,Mi&&(v.flags&1048576)!==0&&ju(v,uc,v.index);switch(v.lanes=0,v.tag){case 2:var O=v.type;Mg(f,v),f=v.pendingProps;var G=ma(v,mo.current);Ba(v,P),G=ct(null,v,O,f,G,P);var J=Ze();return v.flags|=1,typeof G=="object"&&G!==null&&typeof G.render=="function"&&G.$$typeof===void 0?(v.tag=1,v.memoizedState=null,v.updateQueue=null,$o(O)?(J=!0,Kc(v)):J=!1,v.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,Ci(v),G.updater=_l,v.stateNode=G,G._reactInternals=v,hd(v,O,f,P),v=th(null,v,O,!0,J,P)):(v.tag=0,Mi&&J&&hc(v),Us(null,v,G,P),v=v.child),v;case 16:O=v.elementType;e:{switch(Mg(f,v),f=v.pendingProps,G=O._init,O=G(O._payload),v.type=O,G=v.tag=_S(O),f=Fs(O,f),G){case 0:v=xg(null,v,O,f,P);break e;case 1:v=Py(null,v,O,f,P);break e;case 11:v=Ty(null,v,O,f,P);break e;case 14:v=yx(null,v,O,Fs(O.type,f),P);break e}throw Error(n(306,O,""))}return v;case 0:return O=v.type,G=v.pendingProps,G=v.elementType===O?G:Fs(O,G),xg(f,v,O,G,P);case 1:return O=v.type,G=v.pendingProps,G=v.elementType===O?G:Fs(O,G),Py(f,v,O,G,P);case 3:e:{if(xx(v),f===null)throw Error(n(387));O=v.pendingProps,J=v.memoizedState,G=J.element,Kp(f,v),Ua(v,O,null,P);var be=v.memoizedState;if(O=be.element,J.isDehydrated)if(J={element:O,isDehydrated:!1,cache:be.cache,pendingSuspenseBoundaries:be.pendingSuspenseBoundaries,transitions:be.transitions},v.updateQueue.baseState=J,v.memoizedState=J,v.flags&256){G=Ns(Error(n(423)),v),v=xf(f,v,O,P,G);break e}else if(O!==G){G=Ns(Error(n(424)),v),v=xf(f,v,O,P,G);break e}else for(is=pa(v.stateNode.containerInfo.firstChild),dr=v,Mi=!0,_s=null,P=Zp(v,null,O,P),v.child=P;P;)P.flags=P.flags&-3|4096,P=P.sibling;else{if(Wu(),O===G){v=xl(f,v,P);break e}Us(f,v,O,P)}v=v.child}return v;case 5:return _(v),f===null&&Hu(v),O=v.type,G=v.pendingProps,J=f!==null?f.memoizedProps:null,be=G.children,qp(O,G)?be=null:J!==null&&qp(O,J)&&(v.flags|=32),_g(f,v),Us(f,v,be,P),v.child;case 6:return f===null&&Hu(v),null;case 13:return Ay(f,v,P);case 4:return u(v,v.stateNode.containerInfo),O=v.pendingProps,f===null?v.child=Qc(v,null,O,P):Us(f,v,O,P),v.child;case 11:return O=v.type,G=v.pendingProps,G=v.elementType===O?G:Fs(O,G),Ty(f,v,O,G,P);case 7:return Us(f,v,v.pendingProps,P),v.child;case 8:return Us(f,v,v.pendingProps.children,P),v.child;case 12:return Us(f,v,v.pendingProps.children,P),v.child;case 10:e:{if(O=v.type._context,G=v.pendingProps,J=v.memoizedProps,be=G.value,Pr(_f,O._currentValue),O._currentValue=be,J!==null)if(Po(J.value,be)){if(J.children===G.children&&!rs.current){v=xl(f,v,P);break e}}else for(J=v.child,J!==null&&(J.return=v);J!==null;){var ot=J.dependencies;if(ot!==null){be=J.child;for(var gt=ot.firstContext;gt!==null;){if(gt.context===O){if(J.tag===1){gt=jo(-1,P&-P),gt.tag=2;var Bt=J.updateQueue;if(Bt!==null){Bt=Bt.shared;var bn=Bt.pending;bn===null?gt.next=gt:(gt.next=bn.next,bn.next=gt),Bt.pending=gt}}J.lanes|=P,gt=J.alternate,gt!==null&&(gt.lanes|=P),cd(J.return,P,v),ot.lanes|=P;break}gt=gt.next}}else if(J.tag===10)be=J.type===v.type?null:J.child;else if(J.tag===18){if(be=J.return,be===null)throw Error(n(341));be.lanes|=P,ot=be.alternate,ot!==null&&(ot.lanes|=P),cd(be,P,v),be=J.sibling}else be=J.child;if(be!==null)be.return=J;else for(be=J;be!==null;){if(be===v){be=null;break}if(J=be.sibling,J!==null){J.return=be.return,be=J;break}be=be.return}J=be}Us(f,v,G.children,P),v=v.child}return v;case 9:return G=v.type,O=v.pendingProps.children,Ba(v,P),G=gi(G),O=O(G),v.flags|=1,Us(f,v,O,P),v.child;case 14:return O=v.type,G=Fs(O,v.pendingProps),G=Fs(O.type,G),yx(f,v,O,G,P);case 15:return yg(f,v,v.type,v.pendingProps,P);case 17:return O=v.type,G=v.pendingProps,G=v.elementType===O?G:Fs(O,G),Mg(f,v),v.tag=1,$o(O)?(f=!0,Kc(v)):f=!1,Ba(v,P),_o(v,O,G),hd(v,O,G,P),th(null,v,O,!0,f,P);case 19:return Ry(f,v,P);case 22:return _x(f,v,P)}throw Error(n(156,v.tag))};function kx(f,v){return _r(f,v)}function zx(f,v,P,O){this.tag=f,this.key=P,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ha(f,v,P,O){return new zx(f,v,P,O)}function Gy(f){return f=f.prototype,!(!f||!f.isReactComponent)}function _S(f){if(typeof f=="function")return Gy(f)?1:0;if(f!=null){if(f=f.$$typeof,f===Ce)return 11;if(f===Fe)return 14}return 2}function iu(f,v){var P=f.alternate;return P===null?(P=Ha(f.tag,v,f.key,f.mode),P.elementType=f.elementType,P.type=f.type,P.stateNode=f.stateNode,P.alternate=f,f.alternate=P):(P.pendingProps=v,P.type=f.type,P.flags=0,P.subtreeFlags=0,P.deletions=null),P.flags=f.flags&14680064,P.childLanes=f.childLanes,P.lanes=f.lanes,P.child=f.child,P.memoizedProps=f.memoizedProps,P.memoizedState=f.memoizedState,P.updateQueue=f.updateQueue,v=f.dependencies,P.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},P.sibling=f.sibling,P.index=f.index,P.ref=f.ref,P}function Lg(f,v,P,O,G,J){var be=2;if(O=f,typeof f=="function")Gy(f)&&(be=1);else if(typeof f=="string")be=5;else e:switch(f){case te:return Cd(P.children,G,J,v);case se:be=8,G|=8;break;case re:return f=Ha(12,P,v,G|2),f.elementType=re,f.lanes=J,f;case Se:return f=Ha(13,P,v,G),f.elementType=Se,f.lanes=J,f;case Xe:return f=Ha(19,P,v,G),f.elementType=Xe,f.lanes=J,f;case Te:return ch(P,G,J,v);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case $:be=10;break e;case ce:be=9;break e;case Ce:be=11;break e;case Fe:be=14;break e;case Me:be=16,O=null;break e}throw Error(n(130,f==null?f:typeof f,""))}return v=Ha(be,P,v,G),v.elementType=f,v.type=O,v.lanes=J,v}function Cd(f,v,P,O){return f=Ha(7,f,O,v),f.lanes=P,f}function ch(f,v,P,O){return f=Ha(22,f,O,v),f.elementType=Te,f.lanes=P,f.stateNode={isHidden:!1},f}function Dg(f,v,P){return f=Ha(6,f,null,v),f.lanes=P,f}function am(f,v,P){return v=Ha(4,f.children!==null?f.children:[],f.key,v),v.lanes=P,v.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},v}function Ox(f,v,P,O,G){this.tag=v,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uo(0),this.expirationTimes=uo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uo(0),this.identifierPrefix=O,this.onRecoverableError=G,this.mutableSourceEagerHydrationData=null}function to(f,v,P,O,G,J,be,ot,gt){return f=new Ox(f,v,P,ot,gt),v===1?(v=1,J===!0&&(v|=8)):v=0,J=Ha(3,null,null,v),f.current=J,J.stateNode=f,J.memoizedState={element:O,isDehydrated:P,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ci(J),f}function Wy(f,v,P){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:q,key:O==null?null:""+O,children:f,containerInfo:v,implementation:P}}function Fx(f){if(!f)return po;f=f._reactInternals;e:{if(It(f)!==f||f.tag!==1)throw Error(n(170));var v=f;do{switch(v.tag){case 3:v=v.stateNode.context;break e;case 1:if($o(v.type)){v=v.stateNode.__reactInternalMemoizedMergedChildContext;break e}}v=v.return}while(v!==null);throw Error(n(171))}if(f.tag===1){var P=f.type;if($o(P))return rd(f,P,v)}return v}function qy(f,v,P,O,G,J,be,ot,gt){return f=to(P,O,!0,f,G,J,be,ot,gt),f.context=Fx(null),P=f.current,O=Ss(),G=ru(P),J=jo(O,G),J.callback=v??null,ss(P,J,G),f.current.lanes=G,Xi(f,G,O),$s(f,O),f}function Ml(f,v,P,O){var G=v.current,J=Ss(),be=ru(G);return P=Fx(P),v.context===null?v.context=P:v.pendingContext=P,v=jo(J,be),v.payload={element:f},O=O===void 0?null:O,O!==null&&(v.callback=O),f=ss(G,v,be),f!==null&&(na(f,G,be,J),Xu(f,G,be)),be}function Rf(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function Nx(f,v){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var P=f.retryLane;f.retryLane=P!==0&&P<v?P:v}}function Xy(f,v){Nx(f,v),(f=f.alternate)&&Nx(f,v)}function xS(){return null}var Zy=typeof reportError=="function"?reportError:function(f){console.error(f)};function lm(f){this._internalRoot=f}cm.prototype.render=lm.prototype.render=function(f){var v=this._internalRoot;if(v===null)throw Error(n(409));Ml(f,v,null,null)},cm.prototype.unmount=lm.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var v=f.containerInfo;Sd(function(){Ml(null,f,null,null)}),v[Yi]=null}};function cm(f){this._internalRoot=f}cm.prototype.unstable_scheduleHydration=function(f){if(f){var v=Xl();f={blockedOn:null,target:f,priority:v};for(var P=0;P<Di.length&&v!==0&&v<Di[P].priority;P++);Di.splice(P,0,f),P===0&&Oh(f)}};function Ed(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function ou(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function um(){}function kg(f,v,P,O,G){if(G){if(typeof O=="function"){var J=O;O=function(){var Bt=Rf(be);J.call(Bt)}}var be=qy(v,O,f,0,null,!1,!1,"",um);return f._reactRootContainer=be,f[Yi]=be.current,zu(f.nodeType===8?f.parentNode:f),Sd(),be}for(;G=f.lastChild;)f.removeChild(G);if(typeof O=="function"){var ot=O;O=function(){var Bt=Rf(gt);ot.call(Bt)}}var gt=to(f,0,!1,null,null,!1,!1,"",um);return f._reactRootContainer=gt,f[Yi]=gt.current,zu(f.nodeType===8?f.parentNode:f),Sd(function(){Ml(v,gt,P,O)}),gt}function zg(f,v,P,O,G){var J=P._reactRootContainer;if(J){var be=J;if(typeof G=="function"){var ot=G;G=function(){var gt=Rf(be);ot.call(gt)}}Ml(v,be,f,G)}else be=kg(P,v,f,G,O);return Rf(be)}Er=function(f){switch(f.tag){case 3:var v=f.stateNode;if(v.current.memoizedState.isDehydrated){var P=Lr(v.pendingLanes);P!==0&&(Vi(v,P|1),$s(v,xt()),(Jr&6)===0&&(bd=xt()+500,cc()))}break;case 13:Sd(function(){var O=os(f,1);if(O!==null){var G=Ss();na(O,f,1,G)}}),Xy(f,1)}},ua=function(f){if(f.tag===13){var v=os(f,134217728);if(v!==null){var P=Ss();na(v,f,134217728,P)}Xy(f,134217728)}},Ra=function(f){if(f.tag===13){var v=ru(f),P=os(f,v);if(P!==null){var O=Ss();na(P,f,v,O)}Xy(f,v)}},Xl=function(){return Nr},tf=function(f,v){var P=Nr;try{return Nr=f,v()}finally{Nr=P}},Ae=function(f,v,P){switch(v){case"input":if(fn(f,P),v=P.name,P.type==="radio"&&v!=null){for(P=f;P.parentNode;)P=P.parentNode;for(P=P.querySelectorAll("input[name="+JSON.stringify(""+v)+'][type="radio"]'),v=0;v<P.length;v++){var O=P[v];if(O!==f&&O.form===f.form){var G=Bu(O);if(!G)throw Error(n(90));En(O),fn(O,G)}}}break;case"textarea":Nt(f,P);break;case"select":v=P.value,v!=null&&Ue(f,!!P.multiple,v,!1)}},Ut=om,Kt=Sd;var bS={usingClientEntryPoint:!1,Events:[Xc,Na,Bu,ut,We,om]},Lf={findFiberByHostInstance:ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Bx={bundleType:Lf.bundleType,version:Lf.version,rendererPackageName:Lf.rendererPackageName,rendererConfig:Lf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:W.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=Rn(f),f===null?null:f.stateNode},findFiberByHostInstance:Lf.findFiberByHostInstance||xS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Og=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Og.isDisabled&&Og.supportsFiber)try{Zn=Og.inject(Bx),An=Og}catch{}}return Ga.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bS,Ga.createPortal=function(f,v){var P=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ed(v))throw Error(n(200));return Wy(f,v,null,P)},Ga.createRoot=function(f,v){if(!Ed(f))throw Error(n(299));var P=!1,O="",G=Zy;return v!=null&&(v.unstable_strictMode===!0&&(P=!0),v.identifierPrefix!==void 0&&(O=v.identifierPrefix),v.onRecoverableError!==void 0&&(G=v.onRecoverableError)),v=to(f,1,!1,null,null,P,!1,O,G),f[Yi]=v.current,zu(f.nodeType===8?f.parentNode:f),new lm(v)},Ga.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var v=f._reactInternals;if(v===void 0)throw typeof f.render=="function"?Error(n(188)):(f=Object.keys(f).join(","),Error(n(268,f)));return f=Rn(v),f=f===null?null:f.stateNode,f},Ga.flushSync=function(f){return Sd(f)},Ga.hydrate=function(f,v,P){if(!ou(v))throw Error(n(200));return zg(null,f,v,!0,P)},Ga.hydrateRoot=function(f,v,P){if(!Ed(f))throw Error(n(405));var O=P!=null&&P.hydratedSources||null,G=!1,J="",be=Zy;if(P!=null&&(P.unstable_strictMode===!0&&(G=!0),P.identifierPrefix!==void 0&&(J=P.identifierPrefix),P.onRecoverableError!==void 0&&(be=P.onRecoverableError)),v=qy(v,null,f,1,P??null,G,!1,J,be),f[Yi]=v.current,zu(f),O)for(f=0;f<O.length;f++)P=O[f],G=P._getVersion,G=G(P._source),v.mutableSourceEagerHydrationData==null?v.mutableSourceEagerHydrationData=[P,G]:v.mutableSourceEagerHydrationData.push(P,G);return new cm(v)},Ga.render=function(f,v,P){if(!ou(v))throw Error(n(200));return zg(null,f,v,!1,P)},Ga.unmountComponentAtNode=function(f){if(!ou(f))throw Error(n(40));return f._reactRootContainer?(Sd(function(){zg(null,null,f,!1,function(){f._reactRootContainer=null,f[Yi]=null})}),!0):!1},Ga.unstable_batchedUpdates=om,Ga.unstable_renderSubtreeIntoContainer=function(f,v,P,O){if(!ou(P))throw Error(n(200));if(f==null||f._reactInternals===void 0)throw Error(n(38));return zg(f,v,P,!1,O)},Ga.version="18.3.1-next-f1338f8080-20240426",Ga}var LR;function H5(){if(LR)return qS.exports;LR=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),qS.exports=D7(),qS.exports}var xw=H5();function k7(t){return typeof t=="function"?t():t}const G5=H.forwardRef(function(e,n){const{children:r,container:o,disablePortal:l=!1}=e,[c,s]=H.useState(null),m=bi(H.isValidElement(r)?mw(r):null,n);if(jd(()=>{l||s(k7(o)||document.body)},[o,l]),jd(()=>{if(c&&!l)return v1(n,c),()=>{v1(n,null)}},[n,c,l]),l){if(H.isValidElement(r)){const y={ref:m};return H.cloneElement(r,y)}return oe.jsx(H.Fragment,{children:r})}return oe.jsx(H.Fragment,{children:c&&xw.createPortal(r,c)})});function z7(t={}){const{disabled:e=!1,focusableWhenDisabled:n,rootRef:r}=t,o=H.useContext(gw);if(o===null)throw new Error("useMenuButton: no menu context available.");const{state:l,dispatch:c,registerTrigger:s,popupId:m}=o,{getRootProps:y,rootRef:b,active:w}=Lh({disabled:e,focusableWhenDisabled:n,rootRef:r}),E=bi(b,s),T=L=>V=>{var B;(B=L.onClick)==null||B.call(L,V),!V.defaultMuiPrevented&&c({type:gu.toggle,event:V})},R=L=>V=>{var B;(B=L.onKeyDown)==null||B.call(L,V),!V.defaultMuiPrevented&&(V.key==="ArrowDown"||V.key==="ArrowUp")&&(V.preventDefault(),c({type:gu.open,event:V}))},z=(L={})=>({onClick:T(L),onKeyDown:R(L)});return{active:w,getRootProps:(L={})=>{const V=ps(L),B=Hd(z,y);return ve({"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":m},L,V,B(V),{tabIndex:0,ref:E})},open:l.open,rootRef:E}}function O7(t){return`menu-item-${t.size}`}const F7={dispatch:()=>{}};function N7(t){var e;const{disabled:n=!1,id:r,rootRef:o,label:l,disableFocusOnHover:c=!1}=t,s=il(r),m=H.useRef(null),y=H.useMemo(()=>({disabled:n,id:s??"",label:l,ref:m}),[n,s,l]),{dispatch:b}=(e=H.useContext(gw))!=null?e:F7,{getRootProps:w,highlighted:E}=TP({item:s,handlePointerOverEvents:!c}),{index:T,totalItemCount:R}=_w(s??O7,y),{getRootProps:z,focusVisible:I,rootRef:L}=Lh({disabled:n,focusableWhenDisabled:!0}),V=bi(L,o,m);H.useDebugValue({id:s,highlighted:E,disabled:n,label:l});const B=q=>te=>{var se;(se=q.onClick)==null||se.call(q,te),!te.defaultMuiPrevented&&b({type:gu.close,event:te})},W=(q={})=>ve({},q,{onClick:B(q)});function X(q={}){const te=ps(q),se=Hd(W,Hd(z,w));return ve({},q,te,se(te),{id:s,ref:V,role:"menuitem"})}return s===void 0?{getRootProps:X,disabled:!1,focusVisible:I,highlighted:!1,index:-1,totalItemCount:0,rootRef:V}:{getRootProps:X,disabled:n,focusVisible:I,highlighted:E,index:T,totalItemCount:R,rootRef:V}}function B7(t){const e=H.useContext(pp);if(!e)throw new Error("MenuItem: ListContext was not found.");const n=il(t),{getItemState:r,dispatch:o}=e;let l;n!=null?l=r(n):l={focusable:!0,highlighted:!1,selected:!1};const{highlighted:c,selected:s,focusable:m}=l,y=H.useCallback(w=>{if(w!==n)throw new Error(["Base UI MenuItem: Tried to access the state of another MenuItem.",`itemValue: ${w} | id: ${n}`,"This is unsupported when the MenuItem uses the MenuItemContextStabilizer as a performance optimization."].join("/n"));return{highlighted:c,selected:s,focusable:m}},[c,s,m,n]);return{contextValue:H.useMemo(()=>({dispatch:o,getItemState:y}),[o,y]),id:n}}function U7(t){const e=Hl(t);return e.body===t?yP(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function z0(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function DR(t){return parseInt(yP(t).getComputedStyle(t).paddingRight,10)||0}function $7(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function kR(t,e,n,r,o){const l=[e,n,...r];[].forEach.call(t.children,c=>{const s=l.indexOf(c)===-1,m=!$7(c);s&&m&&z0(c,o)})}function YS(t,e){let n=-1;return t.some((r,o)=>e(r)?(n=o,!0):!1),n}function V7(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(U7(r)){const c=Yj(Hl(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${DR(r)+c}px`;const s=Hl(r).querySelectorAll(".mui-fixed");[].forEach.call(s,m=>{n.push({value:m.style.paddingRight,property:"padding-right",el:m}),m.style.paddingRight=`${DR(m)+c}px`})}let l;if(r.parentNode instanceof DocumentFragment)l=Hl(r).body;else{const c=r.parentElement,s=yP(r);l=c?.nodeName==="HTML"&&s.getComputedStyle(c).overflowY==="scroll"?c:r}n.push({value:l.style.overflow,property:"overflow",el:l},{value:l.style.overflowX,property:"overflow-x",el:l},{value:l.style.overflowY,property:"overflow-y",el:l}),l.style.overflow="hidden"}return()=>{n.forEach(({value:l,el:c,property:s})=>{l?c.style.setProperty(s,l):c.style.removeProperty(s)})}}function j7(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class H7{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&z0(e.modalRef,!1);const o=j7(n);kR(n,e.mount,e.modalRef,o,!0);const l=YS(this.containers,c=>c.container===n);return l!==-1?(this.containers[l].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:o}),r)}mount(e,n){const r=YS(this.containers,l=>l.modals.indexOf(e)!==-1),o=this.containers[r];o.restore||(o.restore=V7(o,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const o=YS(this.containers,c=>c.modals.indexOf(e)!==-1),l=this.containers[o];if(l.modals.splice(l.modals.indexOf(e),1),this.modals.splice(r,1),l.modals.length===0)l.restore&&l.restore(),e.modalRef&&z0(e.modalRef,n),kR(l.container,e.mount,e.modalRef,l.hiddenSiblings,!1),this.containers.splice(o,1);else{const c=l.modals[l.modals.length-1];c.modalRef&&z0(c.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function G7(t){return typeof t=="function"?t():t}function W7(t){return t?t.props.hasOwnProperty("in"):!1}const q7=new H7;function X7(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:o=q7,closeAfterTransition:l=!1,onTransitionEnter:c,onTransitionExited:s,children:m,onClose:y,open:b,rootRef:w}=t,E=H.useRef({}),T=H.useRef(null),R=H.useRef(null),z=bi(R,w),[I,L]=H.useState(!b),V=W7(m);let B=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(B=!1);const W=()=>Hl(T.current),X=()=>(E.current.modalRef=R.current,E.current.mount=T.current,E.current),q=()=>{o.mount(X(),{disableScrollLock:r}),R.current&&(R.current.scrollTop=0)},te=yu(()=>{const Me=G7(e)||W().body;o.add(X(),Me),R.current&&q()}),se=H.useCallback(()=>o.isTopModal(X()),[o]),re=yu(Me=>{T.current=Me,Me&&(b&&se()?q():R.current&&z0(R.current,B))}),$=H.useCallback(()=>{o.remove(X(),B)},[B,o]);H.useEffect(()=>()=>{$()},[$]),H.useEffect(()=>{b?te():(!V||!l)&&$()},[b,$,V,l,te]);const ce=Me=>Te=>{var Ie;(Ie=Me.onKeyDown)==null||Ie.call(Me,Te),!(Te.key!=="Escape"||Te.which===229||!se())&&(n||(Te.stopPropagation(),y&&y(Te,"escapeKeyDown")))},Ce=Me=>Te=>{var Ie;(Ie=Me.onClick)==null||Ie.call(Me,Te),Te.target===Te.currentTarget&&y&&y(Te,"backdropClick")};return{getRootProps:(Me={})=>{const Te=ps(t);delete Te.onTransitionEnter,delete Te.onTransitionExited;const Ie=ve({},Te,Me);return ve({role:"presentation"},Ie,{onKeyDown:ce(Ie),ref:z})},getBackdropProps:(Me={})=>{const Te=Me;return ve({"aria-hidden":!0},Te,{onClick:Ce(Te),open:b})},getTransitionProps:()=>{const Me=()=>{L(!1),c&&c()},Te=()=>{L(!0),s&&s(),l&&$()};return{onEnter:pR(Me,m?.props.onEnter),onExited:pR(Te,m?.props.onExited)}},rootRef:z,portalRef:re,isTopModal:se,exited:I,hasTransition:V}}function Z7(t){const{value:e,label:n,disabled:r,rootRef:o,id:l}=t,{getRootProps:c,highlighted:s,selected:m}=TP({item:e}),{getRootProps:y,rootRef:b}=Lh({disabled:r,focusableWhenDisabled:!0}),w=il(l),E=H.useRef(null),T=H.useMemo(()=>({disabled:r,label:n,value:e,ref:E,id:w}),[r,n,e,w]),{index:R}=_w(e,T),z=bi(o,E,b),I=V=>B=>{var W;(W=V.onKeyDown)==null||W.call(V,B),!B.defaultMuiPrevented&&[" ","Enter"].includes(B.key)&&(B.defaultMuiPrevented=!0)},L=(V={})=>({onKeyDown:I(V)});return{getRootProps:(V={})=>{const B=ps(V),W=Hd(c,Hd(y,L));return ve({},V,B,W(B),{id:w,ref:z,role:"option","aria-selected":m})},highlighted:s,index:R,selected:m,rootRef:z}}function Y7(t){const e=H.useContext(pp);if(!e)throw new Error("Option: ListContext was not found.");const{getItemState:n,dispatch:r}=e,{highlighted:o,selected:l,focusable:c}=n(t),s=H.useCallback(y=>{if(y!==t)throw new Error(["Base UI Option: Tried to access the state of another Option.","This is unsupported when the Option uses the OptionContextStabilizer as a performance optimization."].join("/n"));return{highlighted:o,selected:l,focusable:c}},[o,l,c,t]);return{contextValue:H.useMemo(()=>({dispatch:r,getItemState:s}),[r,s])}}var Qa="top",Ac="bottom",Ic="right",el="left",PP="auto",O_=[Qa,Ac,Ic,el],jv="start",h_="end",K7="clippingParents",W5="viewport",r0="popper",J7="reference",zR=O_.reduce(function(t,e){return t.concat([e+"-"+jv,e+"-"+h_])},[]),q5=[].concat(O_,[PP]).reduce(function(t,e){return t.concat([e,e+"-"+jv,e+"-"+h_])},[]),Q7="beforeRead",eH="read",tH="afterRead",nH="beforeMain",rH="main",iH="afterMain",oH="beforeWrite",sH="write",aH="afterWrite",lH=[Q7,eH,tH,nH,rH,iH,oH,sH,aH];function Ph(t){return t?(t.nodeName||"").toLowerCase():null}function ql(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Nm(t){var e=ql(t).Element;return t instanceof e||t instanceof Element}function Pc(t){var e=ql(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function AP(t){if(typeof ShadowRoot>"u")return!1;var e=ql(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function cH(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},o=e.attributes[n]||{},l=e.elements[n];!Pc(l)||!Ph(l)||(Object.assign(l.style,r),Object.keys(o).forEach(function(c){var s=o[c];s===!1?l.removeAttribute(c):l.setAttribute(c,s===!0?"":s)}))})}function uH(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var o=e.elements[r],l=e.attributes[r]||{},c=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),s=c.reduce(function(m,y){return m[y]="",m},{});!Pc(o)||!Ph(o)||(Object.assign(o.style,s),Object.keys(l).forEach(function(m){o.removeAttribute(m)}))})}}const hH={name:"applyStyles",enabled:!0,phase:"write",fn:cH,effect:uH,requires:["computeStyles"]};function Mh(t){return t.split("-")[0]}var km=Math.max,y1=Math.min,Hv=Math.round;function g2(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function X5(){return!/^((?!chrome|android).)*safari/i.test(g2())}function Gv(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),o=1,l=1;e&&Pc(t)&&(o=t.offsetWidth>0&&Hv(r.width)/t.offsetWidth||1,l=t.offsetHeight>0&&Hv(r.height)/t.offsetHeight||1);var c=Nm(t)?ql(t):window,s=c.visualViewport,m=!X5()&&n,y=(r.left+(m&&s?s.offsetLeft:0))/o,b=(r.top+(m&&s?s.offsetTop:0))/l,w=r.width/o,E=r.height/l;return{width:w,height:E,top:b,right:y+w,bottom:b+E,left:y,x:y,y:b}}function IP(t){var e=Gv(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Z5(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&AP(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Gd(t){return ql(t).getComputedStyle(t)}function dH(t){return["table","td","th"].indexOf(Ph(t))>=0}function mp(t){return((Nm(t)?t.ownerDocument:t.document)||window.document).documentElement}function bw(t){return Ph(t)==="html"?t:t.assignedSlot||t.parentNode||(AP(t)?t.host:null)||mp(t)}function OR(t){return!Pc(t)||Gd(t).position==="fixed"?null:t.offsetParent}function fH(t){var e=/firefox/i.test(g2()),n=/Trident/i.test(g2());if(n&&Pc(t)){var r=Gd(t);if(r.position==="fixed")return null}var o=bw(t);for(AP(o)&&(o=o.host);Pc(o)&&["html","body"].indexOf(Ph(o))<0;){var l=Gd(o);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return o;o=o.parentNode}return null}function F_(t){for(var e=ql(t),n=OR(t);n&&dH(n)&&Gd(n).position==="static";)n=OR(n);return n&&(Ph(n)==="html"||Ph(n)==="body"&&Gd(n).position==="static")?e:n||fH(t)||e}function RP(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function O0(t,e,n){return km(t,y1(e,n))}function pH(t,e,n){var r=O0(t,e,n);return r>n?n:r}function Y5(){return{top:0,right:0,bottom:0,left:0}}function K5(t){return Object.assign({},Y5(),t)}function J5(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var mH=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,K5(typeof e!="number"?e:J5(e,O_))};function gH(t){var e,n=t.state,r=t.name,o=t.options,l=n.elements.arrow,c=n.modifiersData.popperOffsets,s=Mh(n.placement),m=RP(s),y=[el,Ic].indexOf(s)>=0,b=y?"height":"width";if(!(!l||!c)){var w=mH(o.padding,n),E=IP(l),T=m==="y"?Qa:el,R=m==="y"?Ac:Ic,z=n.rects.reference[b]+n.rects.reference[m]-c[m]-n.rects.popper[b],I=c[m]-n.rects.reference[m],L=F_(l),V=L?m==="y"?L.clientHeight||0:L.clientWidth||0:0,B=z/2-I/2,W=w[T],X=V-E[b]-w[R],q=V/2-E[b]/2+B,te=O0(W,q,X),se=m;n.modifiersData[r]=(e={},e[se]=te,e.centerOffset=te-q,e)}}function vH(t){var e=t.state,n=t.options,r=n.element,o=r===void 0?"[data-popper-arrow]":r;o!=null&&(typeof o=="string"&&(o=e.elements.popper.querySelector(o),!o)||Z5(e.elements.popper,o)&&(e.elements.arrow=o))}const yH={name:"arrow",enabled:!0,phase:"main",fn:gH,effect:vH,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Wv(t){return t.split("-")[1]}var _H={top:"auto",right:"auto",bottom:"auto",left:"auto"};function xH(t,e){var n=t.x,r=t.y,o=e.devicePixelRatio||1;return{x:Hv(n*o)/o||0,y:Hv(r*o)/o||0}}function FR(t){var e,n=t.popper,r=t.popperRect,o=t.placement,l=t.variation,c=t.offsets,s=t.position,m=t.gpuAcceleration,y=t.adaptive,b=t.roundOffsets,w=t.isFixed,E=c.x,T=E===void 0?0:E,R=c.y,z=R===void 0?0:R,I=typeof b=="function"?b({x:T,y:z}):{x:T,y:z};T=I.x,z=I.y;var L=c.hasOwnProperty("x"),V=c.hasOwnProperty("y"),B=el,W=Qa,X=window;if(y){var q=F_(n),te="clientHeight",se="clientWidth";if(q===ql(n)&&(q=mp(n),Gd(q).position!=="static"&&s==="absolute"&&(te="scrollHeight",se="scrollWidth")),q=q,o===Qa||(o===el||o===Ic)&&l===h_){W=Ac;var re=w&&q===X&&X.visualViewport?X.visualViewport.height:q[te];z-=re-r.height,z*=m?1:-1}if(o===el||(o===Qa||o===Ac)&&l===h_){B=Ic;var $=w&&q===X&&X.visualViewport?X.visualViewport.width:q[se];T-=$-r.width,T*=m?1:-1}}var ce=Object.assign({position:s},y&&_H),Ce=b===!0?xH({x:T,y:z},ql(n)):{x:T,y:z};if(T=Ce.x,z=Ce.y,m){var Se;return Object.assign({},ce,(Se={},Se[W]=V?"0":"",Se[B]=L?"0":"",Se.transform=(X.devicePixelRatio||1)<=1?"translate("+T+"px, "+z+"px)":"translate3d("+T+"px, "+z+"px, 0)",Se))}return Object.assign({},ce,(e={},e[W]=V?z+"px":"",e[B]=L?T+"px":"",e.transform="",e))}function bH(t){var e=t.state,n=t.options,r=n.gpuAcceleration,o=r===void 0?!0:r,l=n.adaptive,c=l===void 0?!0:l,s=n.roundOffsets,m=s===void 0?!0:s,y={placement:Mh(e.placement),variation:Wv(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:o,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,FR(Object.assign({},y,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,FR(Object.assign({},y,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const wH={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:bH,data:{}};var Yx={passive:!0};function SH(t){var e=t.state,n=t.instance,r=t.options,o=r.scroll,l=o===void 0?!0:o,c=r.resize,s=c===void 0?!0:c,m=ql(e.elements.popper),y=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&y.forEach(function(b){b.addEventListener("scroll",n.update,Yx)}),s&&m.addEventListener("resize",n.update,Yx),function(){l&&y.forEach(function(b){b.removeEventListener("scroll",n.update,Yx)}),s&&m.removeEventListener("resize",n.update,Yx)}}const MH={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:SH,data:{}};var CH={left:"right",right:"left",bottom:"top",top:"bottom"};function Gb(t){return t.replace(/left|right|bottom|top/g,function(e){return CH[e]})}var EH={start:"end",end:"start"};function NR(t){return t.replace(/start|end/g,function(e){return EH[e]})}function LP(t){var e=ql(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function DP(t){return Gv(mp(t)).left+LP(t).scrollLeft}function TH(t,e){var n=ql(t),r=mp(t),o=n.visualViewport,l=r.clientWidth,c=r.clientHeight,s=0,m=0;if(o){l=o.width,c=o.height;var y=X5();(y||!y&&e==="fixed")&&(s=o.offsetLeft,m=o.offsetTop)}return{width:l,height:c,x:s+DP(t),y:m}}function PH(t){var e,n=mp(t),r=LP(t),o=(e=t.ownerDocument)==null?void 0:e.body,l=km(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),c=km(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-r.scrollLeft+DP(t),m=-r.scrollTop;return Gd(o||n).direction==="rtl"&&(s+=km(n.clientWidth,o?o.clientWidth:0)-l),{width:l,height:c,x:s,y:m}}function kP(t){var e=Gd(t),n=e.overflow,r=e.overflowX,o=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function Q5(t){return["html","body","#document"].indexOf(Ph(t))>=0?t.ownerDocument.body:Pc(t)&&kP(t)?t:Q5(bw(t))}function F0(t,e){var n;e===void 0&&(e=[]);var r=Q5(t),o=r===((n=t.ownerDocument)==null?void 0:n.body),l=ql(r),c=o?[l].concat(l.visualViewport||[],kP(r)?r:[]):r,s=e.concat(c);return o?s:s.concat(F0(bw(c)))}function v2(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function AH(t,e){var n=Gv(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function BR(t,e,n){return e===W5?v2(TH(t,n)):Nm(e)?AH(e,n):v2(PH(mp(t)))}function IH(t){var e=F0(bw(t)),n=["absolute","fixed"].indexOf(Gd(t).position)>=0,r=n&&Pc(t)?F_(t):t;return Nm(r)?e.filter(function(o){return Nm(o)&&Z5(o,r)&&Ph(o)!=="body"}):[]}function RH(t,e,n,r){var o=e==="clippingParents"?IH(t):[].concat(e),l=[].concat(o,[n]),c=l[0],s=l.reduce(function(m,y){var b=BR(t,y,r);return m.top=km(b.top,m.top),m.right=y1(b.right,m.right),m.bottom=y1(b.bottom,m.bottom),m.left=km(b.left,m.left),m},BR(t,c,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function e4(t){var e=t.reference,n=t.element,r=t.placement,o=r?Mh(r):null,l=r?Wv(r):null,c=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2,m;switch(o){case Qa:m={x:c,y:e.y-n.height};break;case Ac:m={x:c,y:e.y+e.height};break;case Ic:m={x:e.x+e.width,y:s};break;case el:m={x:e.x-n.width,y:s};break;default:m={x:e.x,y:e.y}}var y=o?RP(o):null;if(y!=null){var b=y==="y"?"height":"width";switch(l){case jv:m[y]=m[y]-(e[b]/2-n[b]/2);break;case h_:m[y]=m[y]+(e[b]/2-n[b]/2);break}}return m}function d_(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=r===void 0?t.placement:r,l=n.strategy,c=l===void 0?t.strategy:l,s=n.boundary,m=s===void 0?K7:s,y=n.rootBoundary,b=y===void 0?W5:y,w=n.elementContext,E=w===void 0?r0:w,T=n.altBoundary,R=T===void 0?!1:T,z=n.padding,I=z===void 0?0:z,L=K5(typeof I!="number"?I:J5(I,O_)),V=E===r0?J7:r0,B=t.rects.popper,W=t.elements[R?V:E],X=RH(Nm(W)?W:W.contextElement||mp(t.elements.popper),m,b,c),q=Gv(t.elements.reference),te=e4({reference:q,element:B,placement:o}),se=v2(Object.assign({},B,te)),re=E===r0?se:q,$={top:X.top-re.top+L.top,bottom:re.bottom-X.bottom+L.bottom,left:X.left-re.left+L.left,right:re.right-X.right+L.right},ce=t.modifiersData.offset;if(E===r0&&ce){var Ce=ce[o];Object.keys($).forEach(function(Se){var Xe=[Ic,Ac].indexOf(Se)>=0?1:-1,Fe=[Qa,Ac].indexOf(Se)>=0?"y":"x";$[Se]+=Ce[Fe]*Xe})}return $}function LH(t,e){e===void 0&&(e={});var n=e,r=n.placement,o=n.boundary,l=n.rootBoundary,c=n.padding,s=n.flipVariations,m=n.allowedAutoPlacements,y=m===void 0?q5:m,b=Wv(r),w=b?s?zR:zR.filter(function(R){return Wv(R)===b}):O_,E=w.filter(function(R){return y.indexOf(R)>=0});E.length===0&&(E=w);var T=E.reduce(function(R,z){return R[z]=d_(t,{placement:z,boundary:o,rootBoundary:l,padding:c})[Mh(z)],R},{});return Object.keys(T).sort(function(R,z){return T[R]-T[z]})}function DH(t){if(Mh(t)===PP)return[];var e=Gb(t);return[NR(t),e,NR(e)]}function kH(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var o=n.mainAxis,l=o===void 0?!0:o,c=n.altAxis,s=c===void 0?!0:c,m=n.fallbackPlacements,y=n.padding,b=n.boundary,w=n.rootBoundary,E=n.altBoundary,T=n.flipVariations,R=T===void 0?!0:T,z=n.allowedAutoPlacements,I=e.options.placement,L=Mh(I),V=L===I,B=m||(V||!R?[Gb(I)]:DH(I)),W=[I].concat(B).reduce(function(je,ft){return je.concat(Mh(ft)===PP?LH(e,{placement:ft,boundary:b,rootBoundary:w,padding:y,flipVariations:R,allowedAutoPlacements:z}):ft)},[]),X=e.rects.reference,q=e.rects.popper,te=new Map,se=!0,re=W[0],$=0;$<W.length;$++){var ce=W[$],Ce=Mh(ce),Se=Wv(ce)===jv,Xe=[Qa,Ac].indexOf(Ce)>=0,Fe=Xe?"width":"height",Me=d_(e,{placement:ce,boundary:b,rootBoundary:w,altBoundary:E,padding:y}),Te=Xe?Se?Ic:el:Se?Ac:Qa;X[Fe]>q[Fe]&&(Te=Gb(Te));var Ie=Gb(Te),Ke=[];if(l&&Ke.push(Me[Ce]<=0),s&&Ke.push(Me[Te]<=0,Me[Ie]<=0),Ke.every(function(je){return je})){re=ce,se=!1;break}te.set(ce,Ke)}if(se)for(var st=R?3:1,Ee=function(ft){var At=W.find(function(ht){var lt=te.get(ht);if(lt)return lt.slice(0,ft).every(function(bt){return bt})});if(At)return re=At,"break"},Qe=st;Qe>0;Qe--){var jt=Ee(Qe);if(jt==="break")break}e.placement!==re&&(e.modifiersData[r]._skip=!0,e.placement=re,e.reset=!0)}}const zH={name:"flip",enabled:!0,phase:"main",fn:kH,requiresIfExists:["offset"],data:{_skip:!1}};function UR(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function $R(t){return[Qa,Ic,Ac,el].some(function(e){return t[e]>=0})}function OH(t){var e=t.state,n=t.name,r=e.rects.reference,o=e.rects.popper,l=e.modifiersData.preventOverflow,c=d_(e,{elementContext:"reference"}),s=d_(e,{altBoundary:!0}),m=UR(c,r),y=UR(s,o,l),b=$R(m),w=$R(y);e.modifiersData[n]={referenceClippingOffsets:m,popperEscapeOffsets:y,isReferenceHidden:b,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":b,"data-popper-escaped":w})}const FH={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:OH};function NH(t,e,n){var r=Mh(t),o=[el,Qa].indexOf(r)>=0?-1:1,l=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,c=l[0],s=l[1];return c=c||0,s=(s||0)*o,[el,Ic].indexOf(r)>=0?{x:s,y:c}:{x:c,y:s}}function BH(t){var e=t.state,n=t.options,r=t.name,o=n.offset,l=o===void 0?[0,0]:o,c=q5.reduce(function(b,w){return b[w]=NH(w,e.rects,l),b},{}),s=c[e.placement],m=s.x,y=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=y),e.modifiersData[r]=c}const UH={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:BH};function $H(t){var e=t.state,n=t.name;e.modifiersData[n]=e4({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const VH={name:"popperOffsets",enabled:!0,phase:"read",fn:$H,data:{}};function jH(t){return t==="x"?"y":"x"}function HH(t){var e=t.state,n=t.options,r=t.name,o=n.mainAxis,l=o===void 0?!0:o,c=n.altAxis,s=c===void 0?!1:c,m=n.boundary,y=n.rootBoundary,b=n.altBoundary,w=n.padding,E=n.tether,T=E===void 0?!0:E,R=n.tetherOffset,z=R===void 0?0:R,I=d_(e,{boundary:m,rootBoundary:y,padding:w,altBoundary:b}),L=Mh(e.placement),V=Wv(e.placement),B=!V,W=RP(L),X=jH(W),q=e.modifiersData.popperOffsets,te=e.rects.reference,se=e.rects.popper,re=typeof z=="function"?z(Object.assign({},e.rects,{placement:e.placement})):z,$=typeof re=="number"?{mainAxis:re,altAxis:re}:Object.assign({mainAxis:0,altAxis:0},re),ce=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ce={x:0,y:0};if(q){if(l){var Se,Xe=W==="y"?Qa:el,Fe=W==="y"?Ac:Ic,Me=W==="y"?"height":"width",Te=q[W],Ie=Te+I[Xe],Ke=Te-I[Fe],st=T?-se[Me]/2:0,Ee=V===jv?te[Me]:se[Me],Qe=V===jv?-se[Me]:-te[Me],jt=e.elements.arrow,je=T&&jt?IP(jt):{width:0,height:0},ft=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Y5(),At=ft[Xe],ht=ft[Fe],lt=O0(0,te[Me],je[Me]),bt=B?te[Me]/2-st-lt-At-$.mainAxis:Ee-lt-At-$.mainAxis,St=B?-te[Me]/2+st+lt+ht+$.mainAxis:Qe+lt+ht+$.mainAxis,dn=e.elements.arrow&&F_(e.elements.arrow),En=dn?W==="y"?dn.clientTop||0:dn.clientLeft||0:0,un=(Se=ce?.[W])!=null?Se:0,et=Te+bt-un-En,Ln=Te+St-un,Jt=O0(T?y1(Ie,et):Ie,Te,T?km(Ke,Ln):Ke);q[W]=Jt,Ce[W]=Jt-Te}if(s){var fn,$t=W==="x"?Qa:el,Nn=W==="x"?Ac:Ic,vn=q[X],Ue=X==="y"?"height":"width",we=vn+I[$t],yt=vn-I[Nn],Nt=[Qa,el].indexOf(L)!==-1,Ht=(fn=ce?.[X])!=null?fn:0,Ot=Nt?we:vn-te[Ue]-se[Ue]-Ht+$.altAxis,ln=Nt?vn+te[Ue]+se[Ue]-Ht-$.altAxis:yt,Gt=T&&Nt?pH(Ot,vn,ln):O0(T?Ot:we,vn,T?ln:yt);q[X]=Gt,Ce[X]=Gt-vn}e.modifiersData[r]=Ce}}const GH={name:"preventOverflow",enabled:!0,phase:"main",fn:HH,requiresIfExists:["offset"]};function WH(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function qH(t){return t===ql(t)||!Pc(t)?LP(t):WH(t)}function XH(t){var e=t.getBoundingClientRect(),n=Hv(e.width)/t.offsetWidth||1,r=Hv(e.height)/t.offsetHeight||1;return n!==1||r!==1}function ZH(t,e,n){n===void 0&&(n=!1);var r=Pc(e),o=Pc(e)&&XH(e),l=mp(e),c=Gv(t,o,n),s={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(r||!r&&!n)&&((Ph(e)!=="body"||kP(l))&&(s=qH(e)),Pc(e)?(m=Gv(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):l&&(m.x=DP(l))),{x:c.left+s.scrollLeft-m.x,y:c.top+s.scrollTop-m.y,width:c.width,height:c.height}}function YH(t){var e=new Map,n=new Set,r=[];t.forEach(function(l){e.set(l.name,l)});function o(l){n.add(l.name);var c=[].concat(l.requires||[],l.requiresIfExists||[]);c.forEach(function(s){if(!n.has(s)){var m=e.get(s);m&&o(m)}}),r.push(l)}return t.forEach(function(l){n.has(l.name)||o(l)}),r}function KH(t){var e=YH(t);return lH.reduce(function(n,r){return n.concat(e.filter(function(o){return o.phase===r}))},[])}function JH(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function QH(t){var e=t.reduce(function(n,r){var o=n[r.name];return n[r.name]=o?Object.assign({},o,r,{options:Object.assign({},o.options,r.options),data:Object.assign({},o.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var VR={placement:"bottom",modifiers:[],strategy:"absolute"};function jR(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function eG(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,o=e.defaultOptions,l=o===void 0?VR:o;return function(s,m,y){y===void 0&&(y=l);var b={placement:"bottom",orderedModifiers:[],options:Object.assign({},VR,l),modifiersData:{},elements:{reference:s,popper:m},attributes:{},styles:{}},w=[],E=!1,T={state:b,setOptions:function(L){var V=typeof L=="function"?L(b.options):L;z(),b.options=Object.assign({},l,b.options,V),b.scrollParents={reference:Nm(s)?F0(s):s.contextElement?F0(s.contextElement):[],popper:F0(m)};var B=KH(QH([].concat(r,b.options.modifiers)));return b.orderedModifiers=B.filter(function(W){return W.enabled}),R(),T.update()},forceUpdate:function(){if(!E){var L=b.elements,V=L.reference,B=L.popper;if(jR(V,B)){b.rects={reference:ZH(V,F_(B),b.options.strategy==="fixed"),popper:IP(B)},b.reset=!1,b.placement=b.options.placement,b.orderedModifiers.forEach(function($){return b.modifiersData[$.name]=Object.assign({},$.data)});for(var W=0;W<b.orderedModifiers.length;W++){if(b.reset===!0){b.reset=!1,W=-1;continue}var X=b.orderedModifiers[W],q=X.fn,te=X.options,se=te===void 0?{}:te,re=X.name;typeof q=="function"&&(b=q({state:b,options:se,name:re,instance:T})||b)}}}},update:JH(function(){return new Promise(function(I){T.forceUpdate(),I(b)})}),destroy:function(){z(),E=!0}};if(!jR(s,m))return T;T.setOptions(y).then(function(I){!E&&y.onFirstUpdate&&y.onFirstUpdate(I)});function R(){b.orderedModifiers.forEach(function(I){var L=I.name,V=I.options,B=V===void 0?{}:V,W=I.effect;if(typeof W=="function"){var X=W({state:b,name:L,instance:T,options:B}),q=function(){};w.push(X||q)}})}function z(){w.forEach(function(I){return I()}),w=[]}return T}}var tG=[MH,VH,wH,hH,UH,zH,GH,yH,FH],nG=eG({defaultModifiers:tG});const rG="Popper";function iG(t){return G9(rG,t)}const oG=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],sG=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function aG(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function y2(t){return typeof t=="function"?t():t}function lG(t){return t.nodeType!==void 0}const cG=()=>Wr({root:["root"]},$9(iG)),uG={},hG=H.forwardRef(function(e,n){var r;const{anchorEl:o,children:l,direction:c,disablePortal:s,modifiers:m,open:y,placement:b,popperOptions:w,popperRef:E,slotProps:T={},slots:R={},TransitionProps:z}=e,I=ir(e,oG),L=H.useRef(null),V=bi(L,n),B=H.useRef(null),W=bi(B,E),X=H.useRef(W);jd(()=>{X.current=W},[W]),H.useImperativeHandle(E,()=>B.current,[]);const q=aG(b,c),[te,se]=H.useState(q),[re,$]=H.useState(y2(o));H.useEffect(()=>{B.current&&B.current.forceUpdate()}),H.useEffect(()=>{o&&$(y2(o))},[o]),jd(()=>{if(!re||!y)return;const Fe=Ie=>{se(Ie.placement)};let Me=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Ie})=>{Fe(Ie)}}];m!=null&&(Me=Me.concat(m)),w&&w.modifiers!=null&&(Me=Me.concat(w.modifiers));const Te=nG(re,L.current,ve({placement:q},w,{modifiers:Me}));return X.current(Te),()=>{Te.destroy(),X.current(null)}},[re,s,m,y,w,q]);const ce={placement:te};z!==null&&(ce.TransitionProps=z);const Ce=cG(),Se=(r=R.root)!=null?r:"div",Xe=F5({elementType:Se,externalSlotProps:T.root,externalForwardedProps:I,additionalProps:{role:"tooltip",ref:V},ownerState:e,className:Ce.root});return oe.jsx(Se,ve({},Xe,{children:typeof l=="function"?l(ce):l}))}),ww=H.forwardRef(function(e,n){const{anchorEl:r,children:o,container:l,direction:c="ltr",disablePortal:s=!1,keepMounted:m=!1,modifiers:y,open:b,placement:w="bottom",popperOptions:E=uG,popperRef:T,style:R,transition:z=!1,slotProps:I={},slots:L={}}=e,V=ir(e,sG),[B,W]=H.useState(!0),X=()=>{W(!1)},q=()=>{W(!0)};if(!m&&!b&&(!z||B))return null;let te;if(l)te=l;else if(r){const $=y2(r);te=$&&lG($)?Hl($).body:Hl(null).body}const se=!b&&m&&(!z||B)?"none":void 0,re=z?{in:b,onEnter:X,onExited:q}:void 0;return oe.jsx(G5,{disablePortal:s,container:te,children:oe.jsx(hG,ve({anchorEl:r,direction:c,disablePortal:s,modifiers:y,ref:n,open:z?!B:b,placement:w,popperOptions:E,popperRef:T,slotProps:I,slots:L},V,{style:ve({position:"fixed",top:0,left:0,display:se},R),TransitionProps:re,children:o}))})}),_1={buttonClick:"buttonClick",browserAutoFill:"browserAutoFill"},dG=t=>{const{label:e,value:n}=t;return typeof e=="string"?e:typeof n=="string"?n:String(t)};function fG(t,e){const{open:n}=t,{context:{selectionMode:r}}=e;if(e.type===_1.buttonClick){var o;const m=(o=t.selectedValues[0])!=null?o:Ps(null,"start",e.context);return ve({},t,{open:!n,highlightedValue:n?null:m})}if(e.type===_1.browserAutoFill)return CP(e.item,t,e.context);const l=vw(t,e);switch(e.type){case Li.keyDown:if(t.open){if(e.event.key==="Escape")return ve({},l,{open:!1})}else{if(e.event.key==="ArrowDown"){var c;return ve({},t,{open:!0,highlightedValue:(c=t.selectedValues[0])!=null?c:Ps(null,"start",e.context)})}if(e.event.key==="ArrowUp"){var s;return ve({},t,{open:!0,highlightedValue:(s=t.selectedValues[0])!=null?s:Ps(null,"end",e.context)})}}break;case Li.itemClick:if(r==="single")return ve({},l,{open:!1});break;case Li.blur:return ve({},l,{open:!1});default:return l}return l}function pG(t){return Array.isArray(t)?t.length===0?"":JSON.stringify(t.map(e=>e.value)):t?.value==null?"":typeof t.value=="string"||typeof t.value=="number"?t.value:JSON.stringify(t.value)}function mG(t){const{areOptionsEqual:e,buttonRef:n,defaultOpen:r=!1,defaultValue:o,disabled:l=!1,listboxId:c,listboxRef:s,multiple:m=!1,name:y,required:b,onChange:w,onHighlightChange:E,onOpenChange:T,open:R,options:z,getOptionAsString:I=dG,getSerializedValue:L=pG,value:V,componentName:B="useSelect"}=t,W=H.useRef(null),X=bi(n,W),q=H.useRef(null),te=il(c);let se;V===void 0&&o===void 0?se=[]:o!==void 0&&(m?se=o:se=o==null?[]:[o]);const re=H.useMemo(()=>{if(V!==void 0)return m?V:V==null?[]:[V]},[V,m]),{subitems:$,contextValue:ce}=yw(),Ce=H.useMemo(()=>z!=null?new Map(z.map((Pe,ae)=>[Pe.value,{value:Pe.value,label:Pe.label,disabled:Pe.disabled,ref:H.createRef(),id:`${te}_${ae}`}])):$,[z,$,te]),Se=bi(s,q),{getRootProps:Xe,active:Fe,focusVisible:Me,rootRef:Te}=Lh({disabled:l,rootRef:X}),Ie=H.useMemo(()=>Array.from(Ce.keys()),[Ce]),Ke=H.useCallback(Pe=>{if(e!==void 0){const ae=Ie.find(ue=>e(ue,Pe));return Ce.get(ae)}return Ce.get(Pe)},[Ce,e,Ie]),st=H.useCallback(Pe=>{var ae;const ue=Ke(Pe);return(ae=ue?.disabled)!=null?ae:!1},[Ke]),Ee=H.useCallback(Pe=>{const ae=Ke(Pe);return ae?I(ae):""},[Ke,I]),Qe=H.useMemo(()=>({selectedValues:re,open:R}),[re,R]),jt=H.useCallback(Pe=>{var ae;return(ae=Ce.get(Pe))==null?void 0:ae.id},[Ce]),je=H.useCallback((Pe,ae)=>{if(m)w?.(Pe,ae);else{var ue;w?.(Pe,(ue=ae[0])!=null?ue:null)}},[m,w]),ft=H.useCallback((Pe,ae)=>{E?.(Pe,ae??null)},[E]),At=H.useCallback((Pe,ae,ue)=>{if(ae==="open"&&(T?.(ue),ue===!1&&Pe?.type!=="blur")){var ee;(ee=W.current)==null||ee.focus()}},[T]),ht=H.useCallback(Pe=>{var ae,ue;return Pe==null?null:(ae=(ue=$.get(Pe))==null?void 0:ue.ref.current)!=null?ae:null},[$]),lt={getInitialState:()=>{var Pe;return{highlightedValue:null,selectedValues:(Pe=se)!=null?Pe:[],open:r}},getItemId:jt,controlledProps:Qe,focusManagement:"DOM",getItemDomElement:ht,itemComparer:e,isItemDisabled:st,rootRef:Se,onChange:je,onHighlightChange:ft,onStateChange:At,reducerActionContext:H.useMemo(()=>({multiple:m}),[m]),items:Ie,getItemAsString:Ee,selectionMode:m?"multiple":"single",stateReducer:fG,componentName:B},{dispatch:bt,getRootProps:St,contextValue:dn,state:{open:En,highlightedValue:un,selectedValues:et},rootRef:Ln}=EP(lt),Jt=H.useRef(En);jd(()=>{if(En&&un!==null){var Pe;const ae=(Pe=Ke(un))==null?void 0:Pe.ref;if(!q.current||!(ae!=null&&ae.current))return;Jt.current||ae.current.focus({preventScroll:!0});const ue=q.current.getBoundingClientRect(),ee=ae.current.getBoundingClientRect();ee.top<ue.top?q.current.scrollTop-=ue.top-ee.top:ee.bottom>ue.bottom&&(q.current.scrollTop+=ee.bottom-ue.bottom)}},[En,un,Ke]);const fn=H.useCallback(Pe=>Ke(Pe),[Ke]),$t=Pe=>ae=>{var ue;if(Pe==null||(ue=Pe.onClick)==null||ue.call(Pe,ae),!ae.defaultMuiPrevented){const ee={type:_1.buttonClick,event:ae};bt(ee)}},Nn=Pe=>ae=>{var ue;(ue=Pe.onKeyDown)==null||ue.call(Pe,ae),!ae.defaultMuiPrevented&&(ae.key==="ArrowDown"||ae.key==="ArrowUp")&&(ae.preventDefault(),bt({type:Li.keyDown,key:ae.key,event:ae}))},vn=(Pe={})=>({onClick:$t(Pe),onKeyDown:Nn(Pe)}),Ue=(Pe={})=>ve({},Pe,vn(Pe),{role:"combobox","aria-expanded":En,"aria-controls":te}),we=(Pe={})=>{const ae=ps(Pe),ue=Hd(Ue,Xe);return ve({},Pe,ue(ae))},yt=Pe=>ae=>{var ue,ee;(ue=Pe.onBlur)==null||ue.call(Pe,ae),!ae.defaultMuiPrevented&&((ee=q.current)!=null&&ee.contains(ae.relatedTarget)||ae.relatedTarget===W.current)&&(ae.defaultMuiPrevented=!0)},Nt=(Pe={})=>({onBlur:yt(Pe)}),Ht=(Pe={})=>{const ae=ps(Pe),ue=Hd(Nt,St);return ve({id:te,role:"listbox","aria-multiselectable":m?"true":void 0},Pe,ue(ae))};H.useDebugValue({selectedOptions:et,highlightedOption:un,open:En});const Ot=H.useMemo(()=>ve({},dn,ce),[dn,ce]);let ln;t.multiple?ln=et:ln=et.length>0?et[0]:null;let Gt;if(m)Gt=ln.map(Pe=>fn(Pe)).filter(Pe=>Pe!==void 0);else{var Zt;Gt=(Zt=fn(ln))!=null?Zt:null}const Fn=Pe=>ae=>{var ue;if(Pe==null||(ue=Pe.onChange)==null||ue.call(Pe,ae),ae.defaultMuiPrevented)return;const ee=Ce.get(ae.target.value);ae.target.value===""?bt({type:Li.clearSelection}):ee!==void 0&&bt({type:_1.browserAutoFill,item:ee.value,event:ae})};return{buttonActive:Fe,buttonFocusVisible:Me,buttonRef:Te,contextValue:Ot,disabled:l,dispatch:bt,getButtonProps:we,getHiddenInputProps:(Pe={})=>{const ae=ps(Pe);return ve({name:y,tabIndex:-1,"aria-hidden":!0,required:b?!0:void 0,value:L(Gt),style:Jj},Pe,{onChange:Fn(ae)})},getListboxProps:Ht,getOptionMetadata:fn,listboxRef:Ln,open:En,options:Ie,value:ln,highlightedOption:un}}function gG(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:o,getItemState:l,registerItem:c,totalSubitemCount:s}=e,m=H.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:o}),[r,o,l]),y=H.useMemo(()=>({getItemIndex:o,registerItem:c,totalSubitemCount:s}),[c,o,s]);return oe.jsx(z_.Provider,{value:y,children:oe.jsx(pp.Provider,{value:m,children:n})})}function vG(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:n=!1,onClose:r,open:o,resumeHideDuration:l}=t,c=w0();H.useEffect(()=>{if(!o)return;function L(V){V.defaultPrevented||(V.key==="Escape"||V.key==="Esc")&&r?.(V,"escapeKeyDown")}return document.addEventListener("keydown",L),()=>{document.removeEventListener("keydown",L)}},[o,r]);const s=yu((L,V)=>{r?.(L,V)}),m=yu(L=>{!r||L==null||c.start(L,()=>{s(null,"timeout")})});H.useEffect(()=>(o&&m(e),c.clear),[o,e,m,c]);const y=L=>{r?.(L,"clickaway")},b=c.clear,w=H.useCallback(()=>{e!=null&&m(l??e*.5)},[e,l,m]),E=L=>V=>{const B=L.onBlur;B?.(V),w()},T=L=>V=>{const B=L.onFocus;B?.(V),b()},R=L=>V=>{const B=L.onMouseEnter;B?.(V),b()},z=L=>V=>{const B=L.onMouseLeave;B?.(V),w()};return H.useEffect(()=>{if(!n&&o)return window.addEventListener("focus",w),window.addEventListener("blur",b),()=>{window.removeEventListener("focus",w),window.removeEventListener("blur",b)}},[n,o,w,b]),{getRootProps:(L={})=>{const V=ve({},ps(t),ps(L));return ve({role:"presentation"},L,V,{onBlur:E(V),onFocus:T(V),onMouseEnter:R(V),onMouseLeave:z(V)})},onClickAway:y}}function yG(t){const{checked:e,defaultChecked:n,disabled:r,onBlur:o,onChange:l,onFocus:c,onFocusVisible:s,readOnly:m,required:y}=t,[b,w]=Rv({controlled:e,default:!!n,name:"Switch",state:"checked"}),E=se=>re=>{var $;re.nativeEvent.defaultPrevented||(w(re.target.checked),l?.(re),($=se.onChange)==null||$.call(se,re))},{isFocusVisibleRef:T,onBlur:R,onFocus:z,ref:I}=_P(),[L,V]=H.useState(!1);r&&L&&V(!1),H.useEffect(()=>{T.current=L},[L,T]);const B=H.useRef(null),W=se=>re=>{var $;B.current||(B.current=re.currentTarget),z(re),T.current===!0&&(V(!0),s?.(re)),c?.(re),($=se.onFocus)==null||$.call(se,re)},X=se=>re=>{var $;R(re),T.current===!1&&V(!1),o?.(re),($=se.onBlur)==null||$.call(se,re)},q=bi(I,B);return{checked:b,disabled:!!r,focusVisible:L,getInputProps:(se={})=>ve({checked:e,defaultChecked:n,disabled:r,readOnly:m,ref:q,required:y,type:"checkbox",role:"switch","aria-checked":e},se,{onChange:E(se),onFocus:W(se),onBlur:X(se)}),inputRef:q,readOnly:!!m}}function _G(t){const{value:e,defaultValue:n,onChange:r,orientation:o="horizontal",direction:l="ltr",selectionFollowsFocus:c=!1}=t,[s,m]=Rv({controlled:e,default:n,name:"Tabs",state:"value"}),y=H.useCallback((I,L)=>{m(L),r?.(I,L)},[r,m]),{subitems:b,contextValue:w}=yw(),E=H.useRef(()=>{}),T=H.useCallback(I=>{var L;return(L=b.get(I))==null?void 0:L.id},[b]),R=H.useCallback(I=>E.current(I),[]),z=H.useCallback(I=>{E.current=I},[]);return{contextValue:ve({direction:l,getTabId:R,getTabPanelId:T,onSelected:y,orientation:o,registerTabIdLookup:z,selectionFollowsFocus:c,value:s},w)}}const t4=H.createContext(null);function Sw(){const t=H.useContext(t4);if(t==null)throw new Error("No TabsContext provided");return t}function xG(t){const{value:e,children:n}=t,{direction:r,getItemIndex:o,onSelected:l,orientation:c,registerItem:s,registerTabIdLookup:m,selectionFollowsFocus:y,totalSubitemCount:b,value:w,getTabId:E,getTabPanelId:T}=e,R=H.useMemo(()=>({getItemIndex:o,registerItem:s,totalSubitemCount:b}),[s,o,b]),z=H.useMemo(()=>({direction:r,getTabId:E,getTabPanelId:T,onSelected:l,orientation:c,registerTabIdLookup:m,selectionFollowsFocus:y,value:w}),[r,E,T,l,c,m,y,w]);return oe.jsx(z_.Provider,{value:R,children:oe.jsx(t4.Provider,{value:z,children:n})})}function bG(t){return t.size}function wG(t){const{value:e,id:n,rootRef:r}=t,o=Sw();if(o===null)throw new Error("No TabContext provided");const{value:l,getTabId:c}=o,s=il(n),m=H.useRef(null),y=bi(m,r),b=H.useMemo(()=>({id:s,ref:m}),[s]),{id:w}=_w(e??bG,b),E=w!==l,T=w!==void 0?c(w):void 0;return{hidden:E,getRootProps:(z={})=>ve({"aria-labelledby":T??void 0,hidden:E,id:s??void 0},z,{ref:y}),rootRef:y}}const n4={valueChange:"valueChange"};function SG(t,e){if(e.type===n4.valueChange)return ve({},t,{highlightedValue:e.value});const n=vw(t,e),{context:{selectionFollowsFocus:r}}=e;if(e.type===Li.itemsChange){if(n.selectedValues.length>0)return ve({},n,{highlightedValue:n.selectedValues[0]});Ps(null,"reset",e.context)}return r&&n.highlightedValue!=null?ve({},n,{selectedValues:[n.highlightedValue]}):n}function MG(t){var e;const{rootRef:n}=t,{direction:r="ltr",onSelected:o,orientation:l="horizontal",value:c,registerTabIdLookup:s,selectionFollowsFocus:m}=Sw(),{subitems:y,contextValue:b}=yw(),w=H.useCallback(ce=>{var Ce;return(Ce=y.get(ce))==null?void 0:Ce.id},[y]);s(w);const E=H.useMemo(()=>Array.from(y.keys()),[y]),T=H.useCallback(ce=>{var Ce,Se;return ce==null?null:(Ce=(Se=y.get(ce))==null?void 0:Se.ref.current)!=null?Ce:null},[y]),R=r==="rtl";let z;l==="vertical"?z="vertical":z=R?"horizontal-rtl":"horizontal-ltr";const I=H.useCallback((ce,Ce)=>{var Se;o(ce,(Se=Ce[0])!=null?Se:null)},[o]),L=H.useMemo(()=>c===void 0?{}:c!=null?{selectedValues:[c]}:{selectedValues:[]},[c]),V=H.useCallback(ce=>{var Ce,Se;return(Ce=(Se=y.get(ce))==null?void 0:Se.disabled)!=null?Ce:!1},[y]),{contextValue:B,dispatch:W,getRootProps:X,state:{highlightedValue:q,selectedValues:te},rootRef:se}=EP({controlledProps:L,disabledItemsFocusable:!m,focusManagement:"DOM",getItemDomElement:T,isItemDisabled:V,items:E,rootRef:n,onChange:I,orientation:z,reducerActionContext:H.useMemo(()=>({selectionFollowsFocus:m||!1}),[m]),selectionMode:"single",stateReducer:SG});H.useEffect(()=>{c!==void 0&&c!=null&&W({type:n4.valueChange,value:c})},[W,c]);const re=(ce={})=>ve({},ce,X(ce),{"aria-orientation":l==="vertical"?"vertical":void 0,role:"tablist"});return{contextValue:H.useMemo(()=>ve({},b,B),[b,B]),dispatch:W,getRootProps:re,highlightedValue:q,isRtl:R,orientation:l,rootRef:se,selectedValue:(e=te[0])!=null?e:null}}function CG(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:o,getItemState:l,registerItem:c,totalSubitemCount:s}=e,m=H.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:o}),[r,o,l]),y=H.useMemo(()=>({getItemIndex:o,registerItem:c,totalSubitemCount:s}),[c,o,s]);return oe.jsx(z_.Provider,{value:y,children:oe.jsx(pp.Provider,{value:m,children:n})})}function EG(t){return t.size}function TG(t){const{value:e,rootRef:n,disabled:r=!1,id:o}=t,l=H.useRef(null),c=il(o),{value:s,selectionFollowsFocus:m,getTabPanelId:y}=Sw(),b=H.useMemo(()=>({disabled:r,ref:l,id:c}),[r,l,c]),{id:w,index:E,totalItemCount:T}=_w(e??EG,b),{getRootProps:R,highlighted:z,selected:I}=TP({item:w}),{getRootProps:L,rootRef:V,active:B,focusVisible:W,setFocusVisible:X}=Lh({disabled:r,focusableWhenDisabled:!m,type:"button"}),q=bi(l,n,V),te=w!==void 0?y(w):void 0;return{getRootProps:(re={})=>{const $=ps(re),ce=Hd(R,L);return ve({},re,ce($),{role:"tab","aria-controls":te,"aria-selected":I,id:c,ref:q})},active:B,focusVisible:W,highlighted:z,index:E,rootRef:q,selected:I||w===s,setFocusVisible:X,totalTabsCount:T}}function HR(t){return typeof t.normalize<"u"?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):t}function r4(t={}){const{ignoreAccents:e=!0,ignoreCase:n=!0,limit:r,matchFrom:o="any",stringify:l,trim:c=!1}=t;return(s,{inputValue:m,getOptionLabel:y})=>{let b=c?m.trim():m;n&&(b=b.toLowerCase()),e&&(b=HR(b));const w=b?s.filter(E=>{let T=(l||y)(E);return n&&(T=T.toLowerCase()),e&&(T=HR(T)),o==="start"?T.indexOf(b)===0:T.indexOf(b)>-1}):s;return typeof r=="number"?w.slice(0,r):w}}function Kx(t,e){for(let n=0;n<t.length;n+=1)if(e(t[n]))return n;return-1}const PG=r4(),GR=5,AG=t=>{var e;return t.current!==null&&((e=t.current.parentElement)==null?void 0:e.contains(document.activeElement))},IG=[];function RG(t){const{unstable_isActiveElementInListbox:e=AG,unstable_classNamePrefix:n="Mui",autoComplete:r=!1,autoHighlight:o=!1,autoSelect:l=!1,blurOnSelect:c=!1,clearOnBlur:s=!t.freeSolo,clearOnEscape:m=!1,componentName:y="useAutocomplete",defaultValue:b=t.multiple?IG:null,disableClearable:w=!1,disableCloseOnSelect:E=!1,disabled:T,disabledItemsFocusable:R=!1,disableListWrap:z=!1,filterOptions:I=PG,filterSelectedOptions:L=!1,freeSolo:V=!1,getOptionDisabled:B,getOptionKey:W,getOptionLabel:X=It=>{var nt;return(nt=It.label)!=null?nt:It},groupBy:q,handleHomeEndKeys:te=!t.freeSolo,id:se,includeInputInList:re=!1,inputValue:$,isOptionEqualToValue:ce=(It,nt)=>It===nt,multiple:Ce=!1,onChange:Se,onClose:Xe,onHighlightChange:Fe,onInputChange:Me,onOpen:Te,open:Ie,openOnFocus:Ke=!1,options:st,readOnly:Ee=!1,selectOnFocus:Qe=!t.freeSolo,value:jt}=t,je=il(se);let ft=X;ft=It=>{const nt=X(It);return typeof nt!="string"?String(nt):nt};const At=H.useRef(!1),ht=H.useRef(!0),lt=H.useRef(null),bt=H.useRef(null),[St,dn]=H.useState(null),[En,un]=H.useState(-1),et=o?0:-1,Ln=H.useRef(et),[Jt,fn]=Rv({controlled:jt,default:b,name:y}),[$t,Nn]=Rv({controlled:$,default:"",name:y,state:"inputValue"}),[vn,Ue]=H.useState(!1),we=H.useCallback((It,nt)=>{if(!(Ce?Jt.length<nt.length:nt!==null)&&!s)return;let cn;if(Ce)cn="";else if(nt==null)cn="";else{const Rn=ft(nt);cn=typeof Rn=="string"?Rn:""}$t!==cn&&(Nn(cn),Me&&Me(It,cn,"reset"))},[ft,$t,Ce,Me,Nn,s,Jt]),[yt,Nt]=Rv({controlled:Ie,default:!1,name:y,state:"open"}),[Ht,Ot]=H.useState(!0),ln=!Ce&&Jt!=null&&$t===ft(Jt),Gt=yt&&!Ee,Zt=Gt?I(st.filter(It=>!(L&&(Ce?Jt:[Jt]).some(nt=>nt!==null&&ce(It,nt)))),{inputValue:ln&&Ht?"":$t,getOptionLabel:ft}):[],Fn=Kj({filteredOptions:Zt,value:Jt,inputValue:$t});H.useEffect(()=>{const It=Jt!==Fn.value;vn&&!It||V&&!It||we(null,Jt)},[Jt,we,vn,Fn.value,V]);const Yt=yt&&Zt.length>0&&!Ee,Pe=yu(It=>{It===-1?lt.current.focus():St.querySelector(`[data-tag-index="${It}"]`).focus()});H.useEffect(()=>{Ce&&En>Jt.length-1&&(un(-1),Pe(-1))},[Jt,Ce,En,Pe]);function ae(It,nt){if(!bt.current||It<0||It>=Zt.length)return-1;let qt=It;for(;;){const cn=bt.current.querySelector(`[data-option-index="${qt}"]`),Rn=R?!1:!cn||cn.disabled||cn.getAttribute("aria-disabled")==="true";if(cn&&cn.hasAttribute("tabindex")&&!Rn)return qt;if(nt==="next"?qt=(qt+1)%Zt.length:qt=(qt-1+Zt.length)%Zt.length,qt===It)return-1}}const ue=yu(({event:It,index:nt,reason:qt="auto"})=>{if(Ln.current=nt,nt===-1?lt.current.removeAttribute("aria-activedescendant"):lt.current.setAttribute("aria-activedescendant",`${je}-option-${nt}`),Fe&&Fe(It,nt===-1?null:Zt[nt],qt),!bt.current)return;const cn=bt.current.querySelector(`[role="option"].${n}-focused`);cn&&(cn.classList.remove(`${n}-focused`),cn.classList.remove(`${n}-focusVisible`));let Rn=bt.current;if(bt.current.getAttribute("role")!=="listbox"&&(Rn=bt.current.parentElement.querySelector('[role="listbox"]')),!Rn)return;if(nt===-1){Rn.scrollTop=0;return}const Ir=bt.current.querySelector(`[data-option-index="${nt}"]`);if(Ir&&(Ir.classList.add(`${n}-focused`),qt==="keyboard"&&Ir.classList.add(`${n}-focusVisible`),Rn.scrollHeight>Rn.clientHeight&&qt!=="mouse"&&qt!=="touch")){const _r=Ir,xe=Rn.clientHeight+Rn.scrollTop,vt=_r.offsetTop+_r.offsetHeight;vt>xe?Rn.scrollTop=vt-Rn.clientHeight:_r.offsetTop-_r.offsetHeight*(q?1.3:0)<Rn.scrollTop&&(Rn.scrollTop=_r.offsetTop-_r.offsetHeight*(q?1.3:0))}}),ee=yu(({event:It,diff:nt,direction:qt="next",reason:cn="auto"})=>{if(!Gt)return;const Ir=ae((()=>{const _r=Zt.length-1;if(nt==="reset")return et;if(nt==="start")return 0;if(nt==="end")return _r;const xe=Ln.current+nt;return xe<0?xe===-1&&re?-1:z&&Ln.current!==-1||Math.abs(nt)>1?0:_r:xe>_r?xe===_r+1&&re?-1:z||Math.abs(nt)>1?_r:0:xe})(),qt);if(ue({index:Ir,reason:cn,event:It}),r&&nt!=="reset")if(Ir===-1)lt.current.value=$t;else{const _r=ft(Zt[Ir]);lt.current.value=_r,_r.toLowerCase().indexOf($t.toLowerCase())===0&&$t.length>0&&lt.current.setSelectionRange($t.length,_r.length)}}),fe=()=>{const It=(nt,qt)=>{const cn=nt?ft(nt):"",Rn=qt?ft(qt):"";return cn===Rn};if(Ln.current!==-1&&Fn.filteredOptions&&Fn.filteredOptions.length!==Zt.length&&Fn.inputValue===$t&&(Ce?Jt.length===Fn.value.length&&Fn.value.every((nt,qt)=>ft(Jt[qt])===ft(nt)):It(Fn.value,Jt))){const nt=Fn.filteredOptions[Ln.current];if(nt)return Kx(Zt,qt=>ft(qt)===ft(nt))}return-1},Oe=H.useCallback(()=>{if(!Gt)return;const It=fe();if(It!==-1){Ln.current=It;return}const nt=Ce?Jt[0]:Jt;if(Zt.length===0||nt==null){ee({diff:"reset"});return}if(bt.current){if(nt!=null){const qt=Zt[Ln.current];if(Ce&&qt&&Kx(Jt,Rn=>ce(qt,Rn))!==-1)return;const cn=Kx(Zt,Rn=>ce(Rn,nt));cn===-1?ee({diff:"reset"}):ue({index:cn});return}if(Ln.current>=Zt.length-1){ue({index:Zt.length-1});return}ue({index:Ln.current})}},[Zt.length,Ce?!1:Jt,L,ee,ue,Gt,$t,Ce]),Ye=yu(It=>{v1(bt,It),It&&Oe()});H.useEffect(()=>{Oe()},[Oe]);const ye=It=>{yt||(Nt(!0),Ot(!0),Te&&Te(It))},Ae=(It,nt)=>{yt&&(Nt(!1),Xe&&Xe(It,nt))},Be=(It,nt,qt,cn)=>{if(Ce){if(Jt.length===nt.length&&Jt.every((Rn,Ir)=>Rn===nt[Ir]))return}else if(Jt===nt)return;Se&&Se(It,nt,qt,cn),fn(nt)},$e=H.useRef(!1),He=(It,nt,qt="selectOption",cn="options")=>{let Rn=qt,Ir=nt;if(Ce){Ir=Array.isArray(Jt)?Jt.slice():[];const _r=Kx(Ir,xe=>ce(nt,xe));_r===-1?Ir.push(nt):cn!=="freeSolo"&&(Ir.splice(_r,1),Rn="removeOption")}we(It,Ir),Be(It,Ir,Rn,{option:nt}),!E&&(!It||!It.ctrlKey&&!It.metaKey)&&Ae(It,Rn),(c===!0||c==="touch"&&$e.current||c==="mouse"&&!$e.current)&&lt.current.blur()};function ut(It,nt){if(It===-1)return-1;let qt=It;for(;;){if(nt==="next"&&qt===Jt.length||nt==="previous"&&qt===-1)return-1;const cn=St.querySelector(`[data-tag-index="${qt}"]`);if(!cn||!cn.hasAttribute("tabindex")||cn.disabled||cn.getAttribute("aria-disabled")==="true")qt+=nt==="next"?1:-1;else return qt}}const We=(It,nt)=>{if(!Ce)return;$t===""&&Ae(It,"toggleInput");let qt=En;En===-1?$t===""&&nt==="previous"&&(qt=Jt.length-1):(qt+=nt==="next"?1:-1,qt<0&&(qt=0),qt===Jt.length&&(qt=-1)),qt=ut(qt,nt),un(qt),Pe(qt)},Ut=It=>{At.current=!0,Nn(""),Me&&Me(It,"","clear"),Be(It,Ce?[]:null,"clear")},Kt=It=>nt=>{if(It.onKeyDown&&It.onKeyDown(nt),!nt.defaultMuiPrevented&&(En!==-1&&["ArrowLeft","ArrowRight"].indexOf(nt.key)===-1&&(un(-1),Pe(-1)),nt.which!==229))switch(nt.key){case"Home":Gt&&te&&(nt.preventDefault(),ee({diff:"start",direction:"next",reason:"keyboard",event:nt}));break;case"End":Gt&&te&&(nt.preventDefault(),ee({diff:"end",direction:"previous",reason:"keyboard",event:nt}));break;case"PageUp":nt.preventDefault(),ee({diff:-GR,direction:"previous",reason:"keyboard",event:nt}),ye(nt);break;case"PageDown":nt.preventDefault(),ee({diff:GR,direction:"next",reason:"keyboard",event:nt}),ye(nt);break;case"ArrowDown":nt.preventDefault(),ee({diff:1,direction:"next",reason:"keyboard",event:nt}),ye(nt);break;case"ArrowUp":nt.preventDefault(),ee({diff:-1,direction:"previous",reason:"keyboard",event:nt}),ye(nt);break;case"ArrowLeft":We(nt,"previous");break;case"ArrowRight":We(nt,"next");break;case"Enter":if(Ln.current!==-1&&Gt){const qt=Zt[Ln.current],cn=B?B(qt):!1;if(nt.preventDefault(),cn)return;He(nt,qt,"selectOption"),r&&lt.current.setSelectionRange(lt.current.value.length,lt.current.value.length)}else V&&$t!==""&&ln===!1&&(Ce&&nt.preventDefault(),He(nt,$t,"createOption","freeSolo"));break;case"Escape":Gt?(nt.preventDefault(),nt.stopPropagation(),Ae(nt,"escape")):m&&($t!==""||Ce&&Jt.length>0)&&(nt.preventDefault(),nt.stopPropagation(),Ut(nt));break;case"Backspace":if(Ce&&!Ee&&$t===""&&Jt.length>0){const qt=En===-1?Jt.length-1:En,cn=Jt.slice();cn.splice(qt,1),Be(nt,cn,"removeOption",{option:Jt[qt]})}break;case"Delete":if(Ce&&!Ee&&$t===""&&Jt.length>0&&En!==-1){const qt=En,cn=Jt.slice();cn.splice(qt,1),Be(nt,cn,"removeOption",{option:Jt[qt]})}break}},Re=It=>{Ue(!0),Ke&&!At.current&&ye(It)},it=It=>{if(e(bt)){lt.current.focus();return}Ue(!1),ht.current=!0,At.current=!1,l&&Ln.current!==-1&&Gt?He(It,Zt[Ln.current],"blur"):l&&V&&$t!==""?He(It,$t,"blur","freeSolo"):s&&we(It,Jt),Ae(It,"blur")},mt=It=>{const nt=It.target.value;$t!==nt&&(Nn(nt),Ot(!1),Me&&Me(It,nt,"input")),nt===""?!w&&!Ce&&Be(It,null,"clear"):ye(It)},Wt=It=>{const nt=Number(It.currentTarget.getAttribute("data-option-index"));Ln.current!==nt&&ue({event:It,index:nt,reason:"mouse"})},tn=It=>{ue({event:It,index:Number(It.currentTarget.getAttribute("data-option-index")),reason:"touch"}),$e.current=!0},pn=It=>{const nt=Number(It.currentTarget.getAttribute("data-option-index"));He(It,Zt[nt],"selectOption"),$e.current=!1},rn=It=>nt=>{const qt=Jt.slice();qt.splice(It,1),Be(nt,qt,"removeOption",{option:Jt[It]})},on=It=>{yt?Ae(It,"toggleInput"):ye(It)},kn=It=>{It.currentTarget.contains(It.target)&&It.target.getAttribute("id")!==je&&It.preventDefault()},Ct=It=>{It.currentTarget.contains(It.target)&&(lt.current.focus(),Qe&&ht.current&&lt.current.selectionEnd-lt.current.selectionStart===0&&lt.current.select(),ht.current=!1)},Gn=It=>{!T&&($t===""||!yt)&&on(It)};let On=V&&$t.length>0;On=On||(Ce?Jt.length>0:Jt!==null);let or=Zt;return q&&(or=Zt.reduce((It,nt,qt)=>{const cn=q(nt);return It.length>0&&It[It.length-1].group===cn?It[It.length-1].options.push(nt):It.push({key:qt,index:qt,group:cn,options:[nt]}),It},[])),T&&vn&&it(),{getRootProps:(It={})=>ve({"aria-owns":Yt?`${je}-listbox`:null},It,{onKeyDown:Kt(It),onMouseDown:kn,onClick:Ct}),getInputLabelProps:()=>({id:`${je}-label`,htmlFor:je}),getInputProps:()=>({id:je,value:$t,onBlur:it,onFocus:Re,onChange:mt,onMouseDown:Gn,"aria-activedescendant":Gt?"":null,"aria-autocomplete":r?"both":"list","aria-controls":Yt?`${je}-listbox`:void 0,"aria-expanded":Yt,autoComplete:"off",ref:lt,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:T}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Ut}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:on}),getTagProps:({index:It})=>ve({key:It,"data-tag-index":It,tabIndex:-1},!Ee&&{onDelete:rn(It)}),getListboxProps:()=>({role:"listbox",id:`${je}-listbox`,"aria-labelledby":`${je}-label`,ref:Ye,onMouseDown:It=>{It.preventDefault()}}),getOptionProps:({index:It,option:nt})=>{var qt;const cn=(Ce?Jt:[Jt]).some(Ir=>Ir!=null&&ce(nt,Ir)),Rn=B?B(nt):!1;return{key:(qt=W?.(nt))!=null?qt:ft(nt),tabIndex:-1,role:"option",id:`${je}-option-${It}`,onMouseMove:Wt,onClick:pn,onTouchStart:tn,"data-option-index":It,"aria-disabled":Rn,"aria-selected":cn}},id:je,inputValue:$t,value:Jt,dirty:On,expanded:Gt&&St,popupOpen:Gt,focused:vn||En!==-1,anchorEl:St,setAnchorEl:dn,focusedTag:En,groupedOptions:or}}const LG=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],DG=["component","slots","slotProps"],kG=["component"];function Bn(t,e){const{className:n,elementType:r,ownerState:o,externalForwardedProps:l,getSlotOwnerState:c,internalForwardedProps:s}=e,m=ir(e,LG),{component:y,slots:b={[t]:void 0},slotProps:w={[t]:void 0}}=l,E=ir(l,DG),T=b[t]||r,R=O5(w[t],o),z=z5(ve({className:n},m,{externalForwardedProps:t==="root"?E:void 0,externalSlotProps:R})),{props:{component:I},internalRef:L}=z,V=ir(z.props,kG),B=bi(L,R?.ref,e.ref),W=c?c(V):{},X=ve({},o,W),q=t==="root"?I||y:I,te=k5(T,ve({},t==="root"&&!y&&!b[t]&&s,t!=="root"&&!b[t]&&s,V,q&&{as:q},{ref:B}),X);return Object.keys(W).forEach(se=>{delete te[se]}),[T,te]}function zG(t){return qr("MuiListItem",t)}const x1=$r("MuiListItem",["root","startAction","endAction","nested","nesting","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]),b1=H.createContext(!1),ly=H.createContext(!1),i4=H.createContext(!1),zP=H.createContext(void 0),o4=H.createContext(void 0),Mw=H.createContext(void 0),OG=["component","className","children","nested","sticky","variant","color","startAction","endAction","role","slots","slotProps"],FG=t=>{const{sticky:e,nested:n,nesting:r,variant:o,color:l}=t,c={root:["root",n&&"nested",r&&"nesting",e&&"sticky",l&&`color${Dn(l)}`,o&&`variant${Dn(o)}`],startAction:["startAction"],endAction:["endAction"]};return Wr(c,zG,{})},NG=_n("li")(({theme:t,ownerState:e})=>{var n;return[!e.nested&&{"--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItemButton-marginBlock":"calc(-1 * var(--ListItem-paddingY))",alignItems:"center",gap:"var(--ListItem-gap)",marginInline:"var(--ListItem-marginInline)"},e.nested&&{"--NestedList-marginRight":"calc(-1 * var(--ListItem-paddingRight))","--NestedList-marginLeft":"calc(-1 * var(--ListItem-paddingLeft))","--NestedListItem-paddingLeft":"calc(var(--ListItem-paddingLeft) + var(--List-nestedInsetStart))","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItem-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))",flexDirection:"column"},ve({"--unstable_actionRadius":"calc(var(--ListItem-radius) - var(--variant-borderWidth, 0px))"},e.startAction&&{"--unstable_startActionWidth":"2rem"},e.endAction&&{"--unstable_endActionWidth":"2.5rem"},{boxSizing:"border-box",borderRadius:"var(--ListItem-radius)",display:"var(--_ListItem-display)","&:not([hidden])":{"--_ListItem-display":"var(--_List-markerDisplay, flex)"},flex:"none",listStyleType:"var(--_List-markerType, disc)",position:"relative",paddingBlockStart:e.nested?0:"var(--ListItem-paddingY)",paddingBlockEnd:e.nested?0:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)"},e["data-first-child"]===void 0&&ve({},e.row?{marginInlineStart:"var(--List-gap)"}:{marginBlockStart:"var(--List-gap)"}),e.row&&e.wrap&&{marginInlineStart:"var(--List-gap)",marginBlockStart:"var(--List-gap)"},{minBlockSize:"var(--ListItem-minHeight)"},e.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:`var(--ListItem-stickyBackground, ${t.vars.palette.background.body})`},{[`.${x1.nested} > &`]:{"--_ListItem-display":"flex"}}),(n=t.variants[e.variant])==null?void 0:n[e.color]]}),BG=_n(NG,{name:"JoyListItem",slot:"Root",overridesResolver:(t,e)=>e.root})({}),UG=_n("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(t,e)=>e.startAction})(({ownerState:t})=>({display:"inherit",position:"absolute",top:t.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",left:0,transform:"translate(var(--ListItem-startActionTranslateX), -50%)",zIndex:1})),$G=_n("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(t,e)=>e.startAction})(({ownerState:t})=>({display:"inherit",position:"absolute",top:t.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",right:0,transform:"translate(var(--ListItem-endActionTranslateX), -50%)"})),gp=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListItem"}),o=H.useContext(Mw),l=H.useContext(zP),c=H.useContext(ly),s=H.useContext(i4),m=H.useContext(b1),{component:y,className:b,children:w,nested:E=!1,sticky:T=!1,variant:R="plain",color:z="neutral",startAction:I,endAction:L,role:V,slots:B={},slotProps:W={}}=r,X=ir(r,OG),[q,te]=H.useState(""),[se,re]=l?.split(":")||["",""],$=y||(se&&!se.match(/^(ul|ol|menu)$/)?"div":void 0);let ce=o==="menu"?"none":void 0;l&&(ce={menu:"none",menubar:"none",group:"presentation"}[re]),V&&(ce=V);const Ce=ve({},r,{sticky:T,startAction:I,endAction:L,row:c,wrap:s,variant:R,color:z,nesting:m,nested:E,component:$,role:ce}),Se=FG(Ce),Xe=ve({},X,{component:$,slots:B,slotProps:W}),[Fe,Me]=Bn("root",{additionalProps:{role:ce},ref:n,className:co(Se.root,b),elementType:BG,externalForwardedProps:Xe,ownerState:Ce}),[Te,Ie]=Bn("startAction",{className:Se.startAction,elementType:UG,externalForwardedProps:Xe,ownerState:Ce}),[Ke,st]=Bn("endAction",{className:Se.endAction,elementType:$G,externalForwardedProps:Xe,ownerState:Ce});return oe.jsx(o4.Provider,{value:te,children:oe.jsx(b1.Provider,{value:E?q||!0:!1,children:oe.jsxs(Fe,ve({},Me,{children:[I&&oe.jsx(Te,ve({},Ie,{children:I})),H.Children.map(w,(Ee,Qe)=>{var jt;return H.isValidElement(Ee)?H.cloneElement(Ee,ve({},Qe===0&&{"data-first-child":""},vP(Ee,["ListItem"])&&{component:((jt=Ee.props)==null?void 0:jt.component)||"div"})):Ee}),L&&oe.jsx(Ke,ve({},st,{children:L}))]}))})})});gp.muiName="ListItem";const Cw={"--NestedList-marginRight":"0px","--NestedList-marginLeft":"0px","--NestedListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px"};function N_(t){const{children:e,nested:n,row:r=!1,wrap:o=!1}=t,l=oe.jsx(ly.Provider,{value:r,children:oe.jsx(i4.Provider,{value:o,children:H.Children.map(e,(c,s)=>H.isValidElement(c)?H.cloneElement(c,ve({},s===0&&{"data-first-child":""},s===H.Children.count(e)-1&&{"data-last-child":""})):c)})});return n===void 0?l:oe.jsx(b1.Provider,{value:n,children:l})}const qm=({theme:t,ownerState:e},n)=>{let r={};function o(l){if(typeof l=="function"){const c=l(t);o(c)}else Array.isArray(l)?l.forEach(c=>{typeof c!="boolean"&&o(c)}):typeof l=="object"&&(r=ve({},r,l))}return e.sx&&(o(e.sx),n.forEach(l=>{const c=r[l];if(typeof c=="string"||typeof c=="number")if(l==="borderRadius")if(typeof c=="number")r[l]=`${c}px`;else{var s;r[l]=((s=t.vars)==null?void 0:s.radius[c])||c}else["p","padding","m","margin"].indexOf(l)!==-1&&typeof c=="number"?r[l]=t.spacing(c):r[l]=c;else typeof c=="function"?r[l]=c(t):r[l]=void 0})),r};function VG(t){return qr("MuiList",t)}const jG=$r("MuiList",["root","nesting","scoped","sizeSm","sizeMd","sizeLg","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","horizontal","vertical"]),HG=H.createContext(void 0),GG=["component","className","children","size","orientation","wrap","variant","color","role","slots","slotProps"],WG=t=>{const{variant:e,color:n,size:r,nesting:o,orientation:l,instanceSize:c}=t,s={root:["root",l,e&&`variant${Dn(e)}`,n&&`color${Dn(n)}`,!c&&!o&&r&&`size${Dn(r)}`,c&&`size${Dn(c)}`,o&&"nesting"]};return Wr(s,VG,{})},B_=_n("ul")(({theme:t,ownerState:e})=>{var n;const{p:r,padding:o,borderRadius:l}=qm({theme:t,ownerState:e},["p","padding","borderRadius"]);function c(s){return s==="sm"?{"--ListDivider-gap":"0.25rem","--ListItem-minHeight":"2rem","--ListItem-paddingY":"3px","--ListItem-paddingX":e.marker?"3px":"0.5rem","--ListItem-gap":"0.5rem","--ListItemDecorator-size":e.orientation==="horizontal"?"1.5rem":"2rem","--Icon-fontSize":t.vars.fontSize.lg}:s==="md"?{"--ListDivider-gap":"0.375rem","--ListItem-minHeight":"2.25rem","--ListItem-paddingY":"0.25rem","--ListItem-paddingX":e.marker?"0.25rem":"0.75rem","--ListItem-gap":"0.625rem","--ListItemDecorator-size":e.orientation==="horizontal"?"1.75rem":"2.5rem","--Icon-fontSize":t.vars.fontSize.xl}:s==="lg"?{"--ListDivider-gap":"0.5rem","--ListItem-minHeight":"2.75rem","--ListItem-paddingY":"0.375rem","--ListItem-paddingX":e.marker?"0.5rem":"1rem","--ListItem-gap":"0.75rem","--ListItemDecorator-size":e.orientation==="horizontal"?"2.25rem":"3rem","--Icon-fontSize":t.vars.fontSize.xl2}:{}}return[e.nesting&&ve({},c(e.instanceSize),{"--ListItem-paddingRight":"var(--ListItem-paddingX)","--ListItem-paddingLeft":"var(--NestedListItem-paddingLeft)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px",padding:0},e.marker&&{paddingInlineStart:"calc(3ch - var(--_List-markerDeduct, 0px))"},{marginInlineStart:"var(--NestedList-marginLeft)",marginInlineEnd:"var(--NestedList-marginRight)",marginBlockStart:"var(--List-gap)",marginBlockEnd:"initial"}),!e.nesting&&ve({},c(e.size),{"--List-gap":"0px","--List-nestedInsetStart":"0px","--ListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItem-paddingRight":"var(--ListItem-paddingX)"},e.marker&&{"--_List-markerDeduct":"1ch"},{"--unstable_List-childRadius":"calc(max(var(--List-radius) - var(--List-padding), min(var(--List-padding) / 2, var(--List-radius) / 2)) - var(--variant-borderWidth, 0px))","--ListItem-radius":"var(--unstable_List-childRadius)","--ListItem-startActionTranslateX":"calc(0.5 * var(--ListItem-paddingLeft))","--ListItem-endActionTranslateX":"calc(-0.5 * var(--ListItem-paddingRight))",margin:"initial"},t.typography[`body-${e.size}`],e.orientation==="horizontal"?ve({},e.wrap?{padding:"var(--List-padding)",marginInlineStart:"calc(-1 * var(--List-gap))",marginBlockStart:"calc(-1 * var(--List-gap))"}:{paddingInline:"var(--List-padding, var(--ListDivider-gap))",paddingBlock:"var(--List-padding)"}):{paddingBlock:"var(--List-padding, var(--ListDivider-gap))",paddingInline:"var(--List-padding)"},e.marker&&{paddingInlineStart:"3ch"}),ve({boxSizing:"border-box",borderRadius:"var(--List-radius)",listStyle:"none",display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column"},e.wrap&&{flexWrap:"wrap"},e.marker&&{"--_List-markerDisplay":"list-item","--_List-markerType":e.marker,lineHeight:"calc(var(--ListItem-minHeight) - 2 * var(--ListItem-paddingY))"},{flexGrow:1,position:"relative"},(n=t.variants[e.variant])==null?void 0:n[e.color],{"--unstable_List-borderWidth":"var(--variant-borderWidth, 0px)"},l!==void 0&&{"--List-radius":l},r!==void 0&&{"--List-padding":r},o!==void 0&&{"--List-padding":o})]}),qG=_n(B_,{name:"JoyList",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Ew=H.forwardRef(function(e,n){var r;const o=H.useContext(b1),l=H.useContext(Mw),c=H.useContext(HG),s=Xr({props:e,name:"JoyList"}),{component:m,className:y,children:b,size:w,orientation:E="vertical",wrap:T=!1,variant:R="plain",color:z="neutral",role:I,slots:L={},slotProps:V={}}=s,B=ir(s,GG),W=w||((r=e.size)!=null?r:"md");let X;l&&(X="group"),c&&(X="presentation"),I&&(X=I);const q=ve({},s,{instanceSize:e.size,size:W,nesting:o,orientation:E,wrap:T,variant:R,color:z,role:X}),te=WG(q),se=ve({},B,{component:m,slots:L,slotProps:V}),[re,$]=Bn("root",{ref:n,className:co(te.root,y),elementType:qG,externalForwardedProps:se,ownerState:q,additionalProps:{as:m,role:X,"aria-labelledby":typeof o=="string"?o:void 0}});return oe.jsx(re,ve({},$,{children:oe.jsx(zP.Provider,{value:`${typeof m=="string"?m:""}:${X||""}`,children:oe.jsx(N_,{row:E==="horizontal",wrap:T,children:b})})}))}),Wb=$r("MuiListItemButton",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","variantPlain","variantSoft","variantOutlined","variantSolid"]),OP=H.createContext("horizontal"),U_=_n("div")(({theme:t,ownerState:e})=>{var n,r,o,l,c,s;return ve({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,WebkitTapHighlightColor:"transparent",boxSizing:"border-box",position:"relative",font:"inherit",display:"flex",flexDirection:"row",alignItems:"center",alignSelf:"stretch",gap:"var(--ListItem-gap)"},e.orientation==="vertical"&&{flexDirection:"column",justifyContent:"center"},{textAlign:"initial",textDecoration:"initial",backgroundColor:"initial",cursor:"pointer",marginInline:"var(--ListItemButton-marginInline)",marginBlock:"var(--ListItemButton-marginBlock)"},e["data-first-child"]===void 0&&{marginInlineStart:e.row?"var(--List-gap)":void 0,marginBlockStart:e.row?void 0:"var(--List-gap)"},{paddingBlock:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px))",paddingInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItem-startActionWidth, var(--unstable_startActionWidth, 0px)))",paddingInlineEnd:"calc(var(--ListItem-paddingRight) + var(--ListItem-endActionWidth, var(--unstable_endActionWidth, 0px)))",minBlockSize:"var(--ListItem-minHeight)",border:"1px solid transparent",borderRadius:"var(--ListItem-radius)",flex:"var(--unstable_ListItem-flex, none)",fontSize:"inherit",lineHeight:"inherit",minInlineSize:0,[t.focus.selector]:ve({},t.focus.default,{zIndex:1})},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:active":(r=t.variants[`${e.variant}Active`])==null?void 0:r[e.color],[`.${x1.root} > &`]:{"--unstable_ListItem-flex":"1 0 0%"},[`&.${Wb.selected}`]:ve({},(o=t.variants[`${e.variant}Active`])==null?void 0:o[e.color],{"--Icon-color":"currentColor"}),[`&:not(.${Wb.selected}, [aria-selected="true"])`]:{"&:hover":(l=t.variants[`${e.variant}Hover`])==null?void 0:l[e.color],"&:active":(c=t.variants[`${e.variant}Active`])==null?void 0:c[e.color]},[`&.${Wb.disabled}`]:ve({},(s=t.variants[`${e.variant}Disabled`])==null?void 0:s[e.color])})});_n(U_,{name:"JoyListItemButton",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>ve({},!t.row&&{[`&.${Wb.selected}`]:{fontWeight:e.vars.fontWeight.md}}));function XG(t){return qr("MuiSvgIcon",t)}$r("MuiSvgIcon",["root","colorInherit","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","fontSizeInherit","fontSizeXs","fontSizeSm","fontSizeMd","fontSizeLg","fontSizeXl","fontSizeXl2","fontSizeXl3","fontSizeXl4","sizeSm","sizeMd","sizeLg"]);const ZG=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox","size","slots","slotProps"],YG=t=>{const{color:e,size:n,fontSize:r}=t,o={root:["root",e&&e!=="inherit"&&`color${Dn(e)}`,n&&`size${Dn(n)}`,r&&`fontSize${Dn(r)}`]};return Wr(o,XG,{})},WR={sm:"xl",md:"xl2",lg:"xl3"},KG=_n("svg",{name:"JoySvgIcon",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return ve({},e.instanceSize&&{"--Icon-fontSize":t.vars.fontSize[WR[e.instanceSize]]},e.instanceFontSize&&e.instanceFontSize!=="inherit"&&{"--Icon-fontSize":t.vars.fontSize[e.instanceFontSize]},{userSelect:"none",margin:"var(--Icon-margin)",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,fontSize:`var(--Icon-fontSize, ${t.vars.fontSize[WR[e.size]]||"unset"})`},e.fontSize&&e.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${t.fontSize[e.fontSize]})`},!e.htmlColor&&ve({color:`var(--Icon-color, ${t.vars.palette.text.icon})`},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&t.vars.palette[e.color]&&{color:`rgba(${(n=t.vars.palette[e.color])==null?void 0:n.mainChannel} / 1)`}))}),qR=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoySvgIcon"}),{children:o,className:l,color:c,component:s="svg",fontSize:m,htmlColor:y,inheritViewBox:b=!1,titleAccess:w,viewBox:E="0 0 24 24",size:T="md",slots:R={},slotProps:z={}}=r,I=ir(r,ZG),L=H.isValidElement(o)&&o.type==="svg",V=ve({},r,{color:c,component:s,size:T,instanceSize:e.size,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:b,viewBox:E,hasSvgAsChild:L}),B=YG(V),W=ve({},I,{component:s,slots:R,slotProps:z}),[X,q]=Bn("root",{ref:n,className:co(B.root,l),elementType:KG,externalForwardedProps:W,ownerState:V,additionalProps:ve({color:y,focusable:!1},w&&{role:"img"},!w&&{"aria-hidden":!0},!b&&{viewBox:E},L&&o.props)});return oe.jsxs(X,ve({},q,{children:[L?o.props.children:o,w?oe.jsx("title",{children:w}):null]}))});function Xm(t,e){function n(r,o){return oe.jsx(qR,ve({"data-testid":`${e}Icon`,ref:o},r,{children:t}))}return n.muiName=qR.muiName,H.memo(H.forwardRef(n))}const FP=t=>e=>`--${t?`${t}-`:""}${e.replace(/^--/,"")}`,qv="data-skip-inverted-colors",s4=`& :not([${qv}], [${qv}] *)`,a4=t=>{var e,n,r,o,l,c,s,m,y,b,w,E,T,R,z,I,L,V,B,W,X,q;const te=FP(t.cssVarPrefix);return{"--variant-plainColor":"var(--variant-plainColor) !important","--variant-plainHoverColor":"var(--variant-plainHoverColor) !important","--variant-plainHoverBg":"var(--variant-plainHoverBg) !important","--variant-plainActiveBg":"var(--variant-plainActiveBg) !important","--variant-plainDisabledColor":"var(--variant-plainDisabledColor) !important","--variant-outlinedColor":"var(--variant-outlinedColor) !important","--variant-outlinedBorder":"var(--variant-outlinedBorder) !important","--variant-outlinedHoverColor":"var(--variant-outlinedHoverColor) !important","--variant-outlinedHoverBorder":"var(--variant-outlinedHoverBorder) !important","--variant-outlinedHoverBg":"var(--variant-outlinedHoverBg) !important","--variant-outlinedActiveBg":"var(--variant-outlinedActiveBg) !important","--variant-outlinedDisabledColor":"var(--variant-outlinedDisabledColor) !important","--variant-outlinedDisabledBorder":"var(--variant-outlinedDisabledBorder) !important","--variant-softColor":"var(--variant-softColor) !important","--variant-softHoverColor":"var(--variant-softHoverColor) !important","--variant-softBg":"var(--variant-softBg) !important","--variant-softHoverBg":"var(--variant-softHoverBg) !important","--variant-softActiveBg":"var(--variant-softActiveBg) !important","--variant-softActiveColor":"var(--variant-softActiveColor) !important","--variant-softDisabledColor":"var(--variant-softDisabledColor) !important","--variant-softDisabledBg":"var(--variant-softDisabledBg) !important","--variant-solidColor":"var(--variant-solidColor) !important","--variant-solidBg":"var(--variant-solidBg) !important","--variant-solidHoverBg":"var(--variant-solidHoverBg) !important","--variant-solidActiveBg":"var(--variant-solidActiveBg) !important","--variant-solidDisabledColor":"var(--variant-solidDisabledColor) !important","--variant-solidDisabledBg":"var(--variant-solidDisabledBg) !important","--Badge-ringColor":"var(--Badge-ringColor) !important",colorScheme:"unset",[t.getColorSchemeSelector("light")]:{[te("--palette-focusVisible")]:`${(e=t.colorSchemes.light)==null?void 0:e.palette.focusVisible} !important`,[te("--palette-background-body")]:`${(n=t.colorSchemes.light)==null?void 0:n.palette.background.body} !important`,[te("--palette-background-surface")]:`${(r=t.colorSchemes.light)==null?void 0:r.palette.background.surface} !important`,[te("--palette-background-popup")]:`${(o=t.colorSchemes.light)==null?void 0:o.palette.background.popup} !important`,[te("--palette-background-level1")]:`${(l=t.colorSchemes.light)==null?void 0:l.palette.background.level1} !important`,[te("--palette-background-level2")]:`${(c=t.colorSchemes.light)==null?void 0:c.palette.background.level2} !important`,[te("--palette-background-level3")]:`${(s=t.colorSchemes.light)==null?void 0:s.palette.background.level3} !important`,[te("--palette-text-primary")]:`${(m=t.colorSchemes.light)==null?void 0:m.palette.text.primary} !important`,[te("--palette-text-secondary")]:`${(y=t.colorSchemes.light)==null?void 0:y.palette.text.secondary} !important`,[te("--palette-text-tertiary")]:`${(b=t.colorSchemes.light)==null?void 0:b.palette.text.tertiary} !important`,[te("--palette-divider")]:`${(w=t.colorSchemes.light)==null?void 0:w.palette.divider} !important`},[t.getColorSchemeSelector("dark")]:{[te("--palette-focusVisible")]:`${(E=t.colorSchemes.dark)==null?void 0:E.palette.focusVisible} !important`,[te("--palette-background-body")]:`${(T=t.colorSchemes.dark)==null?void 0:T.palette.background.body} !important`,[te("--palette-background-surface")]:`${(R=t.colorSchemes.dark)==null?void 0:R.palette.background.surface} !important`,[te("--palette-background-popup")]:`${(z=t.colorSchemes.dark)==null?void 0:z.palette.background.popup} !important`,[te("--palette-background-level1")]:`${(I=t.colorSchemes.dark)==null?void 0:I.palette.background.level1} !important`,[te("--palette-background-level2")]:`${(L=t.colorSchemes.dark)==null?void 0:L.palette.background.level2} !important`,[te("--palette-background-level3")]:`${(V=t.colorSchemes.dark)==null?void 0:V.palette.background.level3} !important`,[te("--palette-text-primary")]:`${(B=t.colorSchemes.dark)==null?void 0:B.palette.text.primary} !important`,[te("--palette-text-secondary")]:`${(W=t.colorSchemes.dark)==null?void 0:W.palette.text.secondary} !important`,[te("--palette-text-tertiary")]:`${(X=t.colorSchemes.dark)==null?void 0:X.palette.text.tertiary} !important`,[te("--palette-divider")]:`${(q=t.colorSchemes.dark)==null?void 0:q.palette.divider} !important`}}};function JG(t){return t.theme!==void 0}const $_=t=>e=>{const n=JG(e)?e.theme:e,r=SP(n.cssVarPrefix),o=FP(n.cssVarPrefix),l=c=>{const s=c.split("-");return r(c,n.palette[s[1]][s[2]])};return{[s4]:{"--Badge-ringColor":l(`palette-${t}-solidBg`),"--Icon-color":"currentColor",[`${n.getColorSchemeSelector("light")}, ${n.getColorSchemeSelector("dark")}`]:{colorScheme:"dark",[o("--palette-focusVisible")]:l(`palette-${t}-200`),[o("--palette-background-body")]:"rgba(0 0 0 / 0.1)",[o("--palette-background-surface")]:"rgba(0 0 0 / 0.06)",[o("--palette-background-popup")]:l(`palette-${t}-700`),[o("--palette-background-level1")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.2)`,[o("--palette-background-level2")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.36)`,[o("--palette-background-level3")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.6)`,[o("--palette-text-primary")]:l("palette-common-white"),[o("--palette-text-secondary")]:l(`palette-${t}-200`),[o("--palette-text-tertiary")]:l(`palette-${t}-300`),[o("--palette-text-icon")]:l(`palette-${t}-200`),[o("--palette-divider")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-plainColor":l(`palette-${t}-50`),"--variant-plainHoverColor":"#fff","--variant-plainHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-outlinedColor":l(`palette-${t}-50`),"--variant-outlinedBorder":`rgba(${l(`palette-${t}-lightChannel`)} / 0.5)`,"--variant-outlinedHoverColor":"#fff","--variant-outlinedHoverBorder":l(`palette-${t}-300`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":"rgba(255 255 255 / 0.2)","--variant-softColor":l("palette-common-white"),"--variant-softHoverColor":l("palette-common-white"),"--variant-softBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.24)`,"--variant-softHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.36)`,"--variant-softActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.16)`,"--variant-softActiveColor":"#fff","--variant-softDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.1)`,"--variant-solidColor":l(`palette-${t}-${t==="neutral"?"600":"500"}`),"--variant-solidBg":l("palette-common-white"),"--variant-solidHoverBg":l("palette-common-white"),"--variant-solidActiveBg":l(`palette-${t}-100`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.1)`}},[`&, & [${qv}]`]:a4(n)}},V_=t=>e=>{const{theme:n=e}=e,r=SP(n.cssVarPrefix),o=FP(n.cssVarPrefix),l=c=>{const s=c.split("-");return r(c,n.palette[s[1]][s[2]])};return{[s4]:{"--Badge-ringColor":l(`palette-${t}-softBg`),"--Icon-color":"currentColor",[n.getColorSchemeSelector("dark")]:{[o("--palette-focusVisible")]:l(`palette-${t}-300`),[o("--palette-background-body")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.1)`,[o("--palette-background-surface")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,[o("--palette-background-level1")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,[o("--palette-background-level2")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,[o("--palette-background-level3")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,[o("--palette-text-primary")]:l(`palette-${t}-100`),[o("--palette-text-secondary")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,[o("--palette-text-tertiary")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.6)`,[o("--palette-text-icon")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.6)`,[o("--palette-divider")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.2)`,"--variant-plainColor":`rgba(${l(`palette-${t}-lightChannel`)} / 1)`,"--variant-plainHoverColor":l(`palette-${t}-50`),"--variant-plainHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.16)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-outlinedColor":`rgba(${l(`palette-${t}-lightChannel`)} / 1)`,"--variant-outlinedHoverColor":l(`palette-${t}-50`),"--variant-outlinedBg":"initial","--variant-outlinedBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverBorder":l(`palette-${t}-600`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.16)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,"--variant-softColor":l(`palette-${t}-200`),"--variant-softBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-softHoverColor":"#fff","--variant-softHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-softActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.48)`,"--variant-softDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-solidColor":"#fff","--variant-solidBg":l(`palette-${t}-500`),"--variant-solidHoverColor":"#fff","--variant-solidHoverBg":l(`palette-${t}-600`),"--variant-solidActiveBg":l(`palette-${t}-600`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`},[n.getColorSchemeSelector("light")]:{[o("--palette-focusVisible")]:l(`palette-${t}-500`),[o("--palette-background-body")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.1)`,[o("--palette-background-surface")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,[o("--palette-background-level1")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,[o("--palette-background-level2")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,[o("--palette-background-level3")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.48)`,[o("--palette-text-primary")]:l(`palette-${t}-700`),[o("--palette-text-secondary")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.8)`,[o("--palette-text-tertiary")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.68)`,[o("--palette-text-icon")]:l(`palette-${t}-500`),[o("--palette-divider")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-plainColor":`rgba(${l(`palette-${t}-darkChannel`)} / 0.8)`,"--variant-plainHoverColor":`rgba(${l(`palette-${t}-darkChannel`)} / 1)`,"--variant-plainHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-outlinedColor":`rgba(${l(`palette-${t}-mainChannel`)} / 1)`,"--variant-outlinedBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverColor":l(`palette-${t}-600`),"--variant-outlinedHoverBorder":l(`palette-${t}-300`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-outlinedDisabledBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-softColor":l(`palette-${t}-600`),"--variant-softBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.8)`,"--variant-softHoverColor":l(`palette-${t}-700`),"--variant-softHoverBg":l(`palette-${t}-200`),"--variant-softActiveBg":l(`palette-${t}-300`),"--variant-softDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,"--variant-solidColor":l("palette-common-white"),"--variant-solidBg":l(`palette-${t}-${t==="neutral"?"700":"500"}`),"--variant-solidHoverColor":l("palette-common-white"),"--variant-solidHoverBg":l(`palette-${t}-600`),"--variant-solidActiveBg":l(`palette-${t}-600`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`}},[`&, & [${qv}]`]:a4(n)}},l4=Xm(oe.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),QG=Xm(oe.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),c4=H.createContext(void 0);function wm(t,e){let n=e,r=t;return t==="outlined"&&(n="neutral",r="plain"),t==="plain"&&(n="neutral"),{variant:r,color:n}}function Tw(t,e,n=!1){const r=H.useContext(c4),[o,l]=typeof r=="string"?r.split(":"):[],c=wm(o||void 0,l||void 0);return c.variant=t||c.variant,c.color=e||(n?l:c.color),c}function Pw({children:t,color:e,variant:n}){return oe.jsx(c4.Provider,{value:`${n||""}:${e||""}`,children:t})}function eW(t){return qr("MuiIconButton",t)}$r("MuiIconButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","loading","loadingIndicator"]);const NP=H.createContext({}),u4=H.createContext(void 0);function tW(t){return qr("MuiCircularProgress",t)}$r("MuiCircularProgress",["root","determinate","svg","track","progress","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);let nW=t=>t,XR;const rW=["color","backgroundColor"],iW=["children","className","color","size","variant","thickness","determinate","value","component","slots","slotProps"],oW=aP({"0%":{transform:"rotate(-90deg)"},"100%":{transform:"rotate(270deg)"}}),sW=t=>{const{determinate:e,color:n,variant:r,size:o}=t,l={root:["root",e&&"determinate",n&&`color${Dn(n)}`,r&&`variant${Dn(r)}`,o&&`size${Dn(o)}`],svg:["svg"],track:["track"],progress:["progress"]};return Wr(l,tW,{})};function Hg(t,e){return`var(--CircularProgress-${t}Thickness, var(--CircularProgress-thickness, ${e}))`}const aW=_n("span",{name:"JoyCircularProgress",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,o,l;const c=((n=e.variants[t.variant])==null?void 0:n[t.color])||{},{color:s,backgroundColor:m}=c,y=ir(c,rW);return ve({"--Icon-fontSize":"calc(0.4 * var(--_root-size))","--CircularProgress-trackColor":m,"--CircularProgress-progressColor":s,"--CircularProgress-percent":t.value,"--CircularProgress-linecap":"round"},t.size==="sm"&&{"--_root-size":"var(--CircularProgress-size, 24px)","--_track-thickness":Hg("track","3px"),"--_progress-thickness":Hg("progress","3px")},t.instanceSize==="sm"&&{"--CircularProgress-size":"24px"},t.size==="md"&&{"--_track-thickness":Hg("track","6px"),"--_progress-thickness":Hg("progress","6px"),"--_root-size":"var(--CircularProgress-size, 40px)"},t.instanceSize==="md"&&{"--CircularProgress-size":"40px"},t.size==="lg"&&{"--_track-thickness":Hg("track","8px"),"--_progress-thickness":Hg("progress","8px"),"--_root-size":"var(--CircularProgress-size, 64px)"},t.instanceSize==="lg"&&{"--CircularProgress-size":"64px"},t.thickness&&{"--_track-thickness":`${t.thickness}px`,"--_progress-thickness":`${t.thickness}px`},{"--_thickness-diff":"calc(var(--_track-thickness) - var(--_progress-thickness))","--_inner-size":"calc(var(--_root-size) - 2 * var(--variant-borderWidth, 0px))","--_outlined-inset":"max(var(--_track-thickness), var(--_progress-thickness))",width:"var(--_root-size)",height:"var(--_root-size)",borderRadius:"var(--_root-size)",margin:"var(--CircularProgress-margin)",boxSizing:"border-box",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0,position:"relative",color:s},t.children&&{fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.md,fontSize:"calc(0.2 * var(--_root-size))"},y,t.variant==="outlined"&&{"&::before":ve({content:'""',display:"block",position:"absolute",borderRadius:"inherit",top:"var(--_outlined-inset)",left:"var(--_outlined-inset)",right:"var(--_outlined-inset)",bottom:"var(--_outlined-inset)"},y)},t.variant==="soft"&&{"--CircularProgress-trackColor":e.variants.soft.neutral.backgroundColor,"--CircularProgress-progressColor":(r=e.variants.solid)==null?void 0:r[t.color].backgroundColor},t.variant==="solid"&&{"--CircularProgress-trackColor":(o=e.variants.softHover)==null?void 0:o[t.color].backgroundColor,"--CircularProgress-progressColor":(l=e.variants.solid)==null?void 0:l[t.color].backgroundColor})}),lW=_n("svg",{name:"JoyCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({width:"inherit",height:"inherit",display:"inherit",boxSizing:"inherit",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))"}),cW=_n("circle",{name:"JoyCircularProgress",slot:"track",overridesResolver:(t,e)=>e.track})({cx:"50%",cy:"50%",r:"calc(var(--_inner-size) / 2 - var(--_track-thickness) / 2 + min(0px, var(--_thickness-diff) / 2))",fill:"transparent",strokeWidth:"var(--_track-thickness)",stroke:"var(--CircularProgress-trackColor)"}),uW=_n("circle",{name:"JoyCircularProgress",slot:"progress",overridesResolver:(t,e)=>e.progress})({"--_progress-radius":"calc(var(--_inner-size) / 2 - var(--_progress-thickness) / 2 - max(0px, var(--_thickness-diff) / 2))","--_progress-length":"calc(2 * 3.1415926535 * var(--_progress-radius))",cx:"50%",cy:"50%",r:"var(--_progress-radius)",fill:"transparent",strokeWidth:"var(--_progress-thickness)",stroke:"var(--CircularProgress-progressColor)",strokeLinecap:"var(--CircularProgress-linecap, round)",strokeDasharray:"var(--_progress-length)",strokeDashoffset:"calc(var(--_progress-length) - var(--CircularProgress-percent) * var(--_progress-length) / 100)",transformOrigin:"center",transform:"rotate(-90deg)"},({ownerState:t})=>!t.determinate&&g5(XR||(XR=nW`
      animation: var(--CircularProgress-circulation, 0.8s linear 0s infinite normal none running)
        ${0};
    `),oW)),BP=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyCircularProgress"}),{children:o,className:l,color:c="primary",size:s="md",variant:m="soft",thickness:y,determinate:b=!1,value:w=b?0:25,component:E,slots:T={},slotProps:R={}}=r,z=ir(r,iW),I=ve({},r,{color:c,size:s,variant:m,thickness:y,value:w,determinate:b,instanceSize:e.size}),L=sW(I),V=ve({},z,{component:E,slots:T,slotProps:R}),[B,W]=Bn("root",{ref:n,className:co(L.root,l),elementType:aW,externalForwardedProps:V,ownerState:I,additionalProps:ve({role:"progressbar",style:{"--CircularProgress-percent":w}},w&&b&&{"aria-valuenow":Math.round(typeof w=="number"?w:Number(w||0))})}),[X,q]=Bn("svg",{className:L.svg,elementType:lW,externalForwardedProps:V,ownerState:I}),[te,se]=Bn("track",{className:L.track,elementType:cW,externalForwardedProps:V,ownerState:I}),[re,$]=Bn("progress",{className:L.progress,elementType:uW,externalForwardedProps:V,ownerState:I});return oe.jsxs(B,ve({},W,{children:[oe.jsxs(X,ve({},q,{children:[oe.jsx(te,ve({},se)),oe.jsx(re,ve({},$))]})),o]}))}),hW=["children","action","component","color","disabled","variant","loading","loadingIndicator","size","slots","slotProps"],dW=t=>{const{color:e,disabled:n,focusVisible:r,focusVisibleClassName:o,size:l,variant:c,loading:s}=t,m={root:["root",n&&"disabled",r&&"focusVisible",c&&`variant${Dn(c)}`,e&&`color${Dn(e)}`,l&&`size${Dn(l)}`,s&&"loading"],loadingIndicator:["loadingIndicator"]},y=Wr(m,eW,{});return r&&o&&(y.root+=` ${o}`),y},j_=_n("button")(({theme:t,ownerState:e})=>{var n,r,o,l;return[ve({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},e.instanceSize&&{"--IconButton-size":{sm:"2rem",md:"2.25rem",lg:"2.75rem"}[e.instanceSize]},e.size==="sm"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.6)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:t.vars.fontSize.sm,paddingInline:"2px"},e.size==="md"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.25rem) / 1.5)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2.25rem)",minHeight:"var(--IconButton-size, 2.25rem)",fontSize:t.vars.fontSize.md,paddingInline:"0.25rem"},e.size==="lg"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.75rem) / 1.571)","--CircularProgress-size":"28px","--CircularProgress-thickness":"4px",minWidth:"var(--IconButton-size, 2.75rem)",minHeight:"var(--IconButton-size, 2.75rem)",fontSize:t.vars.fontSize.lg,paddingInline:"0.375rem"},{WebkitTapHighlightColor:"transparent",paddingBlock:0,fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.md,margin:"var(--IconButton-margin)",borderRadius:`var(--IconButton-radius, ${t.vars.radius.sm})`,border:"none",boxSizing:"border-box",backgroundColor:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",[t.focus.selector]:ve({"--Icon-color":"currentColor"},t.focus.default)}),ve({},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":{"@media (hover: hover)":ve({"--Icon-color":"currentColor"},(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color])},'&:active, &[aria-pressed="true"]':ve({"--Icon-color":"currentColor"},(o=t.variants[`${e.variant}Active`])==null?void 0:o[e.color]),"&:disabled":(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]})]}),fW=_n(j_,{name:"JoyIconButton",slot:"Root",overridesResolver:(t,e)=>e.root})({}),pW=_n("span",{name:"JoyIconButton",slot:"LoadingIndicator",overridesResolver:(t,e)=>e.loadingIndicator})(({theme:t,ownerState:e})=>{var n,r;return ve({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),Ah=H.forwardRef(function(e,n){var r;const o=Xr({props:e,name:"JoyIconButton"}),{children:l,action:c,component:s="button",color:m="neutral",disabled:y,variant:b="plain",loading:w=!1,loadingIndicator:E,size:T="md",slots:R={},slotProps:z={}}=o,I=ir(o,hW),L=H.useContext(NP),V=H.useContext(u4),B=e.variant||L.variant||b,W=e.size||L.size||T,X=e.color||L.color||m,q=(r=e.loading||e.disabled)!=null?r:L.disabled||w||y,te=H.useRef(null),se=bi(te,n),{focusVisible:re,setFocusVisible:$,getRootProps:ce}=Lh(ve({},o,{disabled:q,rootRef:se})),Ce=E??oe.jsx(BP,{color:X,thickness:{sm:2,md:3,lg:4}[W]||3});H.useImperativeHandle(c,()=>({focusVisible:()=>{var Qe;$(!0),(Qe=te.current)==null||Qe.focus()}}),[$]);const Se=ve({},o,{component:s,color:X,disabled:q,variant:B,loading:w,size:W,focusVisible:re,instanceSize:e.size}),Xe=dW(Se),Fe=Qe=>{var jt;let je=o.onClick;if(typeof z.root=="function"?je=z.root(Se).onClick:z.root&&(je=z.root.onClick),(jt=je)==null||jt(Qe),V){var ft;(ft=V.onClick)==null||ft.call(V,Qe,o.value)}};let Me=o["aria-pressed"];typeof z.root=="function"?Me=z.root(Se)["aria-pressed"]:z.root&&(Me=z.root["aria-pressed"]),V!=null&&V.value&&(Array.isArray(V.value)?Me=V.value.indexOf(o.value)!==-1:Me=V.value===o.value);const Te=ve({},I,{component:s,slots:R,slotProps:z}),[Ie,Ke]=Bn("root",{ref:n,className:Xe.root,elementType:fW,getSlotProps:ce,externalForwardedProps:Te,ownerState:Se,additionalProps:{onClick:Fe,"aria-pressed":Me}}),[st,Ee]=Bn("loadingIndicator",{className:Xe.loadingIndicator,elementType:pW,externalForwardedProps:Te,ownerState:Se});return oe.jsx(Ie,ve({},Ke,{children:w?oe.jsx(st,ve({},Ee,{children:Ce})):l}))});Ah.muiName="IconButton";function mW(t){return qr("MuiChip",t)}const _2=$r("MuiChip",["root","clickable","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","disabled","endDecorator","focusVisible","label","labelSm","labelMd","labelLg","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantSolid","variantSoft","variantOutlined"]),h4=H.createContext({disabled:void 0,variant:void 0,color:void 0}),gW=["children","className","color","onClick","disabled","size","variant","startDecorator","endDecorator","component","slots","slotProps"],vW=t=>{const{disabled:e,size:n,color:r,clickable:o,variant:l,focusVisible:c}=t,s={root:["root",e&&"disabled",r&&`color${Dn(r)}`,n&&`size${Dn(n)}`,l&&`variant${Dn(l)}`,o&&"clickable"],action:["action",e&&"disabled",c&&"focusVisible"],label:["label",n&&`label${Dn(n)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Wr(s,mW,{})},yW=_n("div",{name:"JoyChip",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,o;const l=(n=t.variants[e.variant])==null?void 0:n[e.color],{borderRadius:c}=qm({theme:t,ownerState:e},["borderRadius"]);return[ve({"--Chip-decoratorChildOffset":"min(calc(var(--Chip-paddingInline) - (var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2), var(--Chip-paddingInline))","--Chip-decoratorChildRadius":"max(var(--_Chip-radius) - var(--variant-borderWidth, 0px) - var(--_Chip-paddingBlock), min(var(--_Chip-paddingBlock) + var(--variant-borderWidth, 0px), var(--_Chip-radius) / 2))","--Chip-deleteRadius":"var(--Chip-decoratorChildRadius)","--Chip-deleteSize":"var(--Chip-decoratorChildHeight)","--Avatar-radius":"var(--Chip-decoratorChildRadius)","--Avatar-size":"var(--Chip-decoratorChildHeight)","--Icon-margin":"initial","--Icon-color":"currentColor","--unstable_actionRadius":"var(--_Chip-radius)"},e.size==="sm"&&{"--Chip-paddingInline":"0.375rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.sm,"--_Chip-minHeight":"var(--Chip-minHeight, 1.25rem)",gap:"3px"},e.size==="md"&&{"--Chip-paddingInline":"0.5rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.25rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.md,"--_Chip-minHeight":"var(--Chip-minHeight, 1.5rem)",gap:"0.25rem"},e.size==="lg"&&{"--Chip-paddingInline":"0.75rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.375rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.lg,"--_Chip-minHeight":"var(--Chip-minHeight, 1.75rem)",gap:"0.375rem"},{"--_Chip-radius":"var(--Chip-radius, 1.5rem)","--_Chip-paddingBlock":"max((var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2, 0px)",minHeight:"var(--_Chip-minHeight)",maxWidth:"max-content",paddingInline:"var(--Chip-paddingInline)",borderRadius:"var(--_Chip-radius)",position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",textDecoration:"none",verticalAlign:"middle",boxSizing:"border-box"},t.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],{fontWeight:t.vars.fontWeight.md,[`&.${_2.disabled}`]:{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color}}),...e.clickable?[{"--variant-borderWidth":"0px",color:l?.color}]:[ve({backgroundColor:t.vars.palette.background.surface},l,{[`&.${_2.disabled}`]:(o=t.variants[`${e.variant}Disabled`])==null?void 0:o[e.color]})],c!==void 0&&{"--_Chip-radius":c}]}),_W=_n("span",{name:"JoyChip",slot:"Label",overridesResolver:(t,e)=>e.label})(({ownerState:t})=>ve({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",order:1,minInlineSize:0,flexGrow:1},t.clickable&&{zIndex:1,pointerEvents:"none"})),xW=_n("button",{name:"JoyChip",slot:"Action",overridesResolver:(t,e)=>e.action})(({theme:t,ownerState:e})=>{var n,r,o,l;return[{"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,position:"absolute",zIndex:0,top:0,left:0,bottom:0,right:0,width:"100%",border:"none",cursor:"pointer",padding:"initial",margin:"initial",backgroundColor:"initial",textDecoration:"none",borderRadius:"inherit",[t.focus.selector]:t.focus.default},ve({backgroundColor:t.vars.palette.background.surface},(n=t.variants[e.variant])==null?void 0:n[e.color]),{"&:hover":{"@media (hover: hover)":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]}},{"&:active":(o=t.variants[`${e.variant}Active`])==null?void 0:o[e.color]},{[`&.${_2.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]}]}),bW=_n("span",{name:"JoyChip",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Avatar-marginInlineStart":"calc(var(--Chip-decoratorChildOffset) * -1)","--IconButton-margin":"0 calc(-1 * var(--Chip-paddingInline) / 3) 0 calc(var(--Chip-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Chip-paddingInline) / -4)",display:"inherit",order:0,zIndex:1,pointerEvents:"none"}),wW=_n("span",{name:"JoyChip",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--IconButton-margin":"0 calc(var(--Chip-decoratorChildOffset) * -1) 0 calc(-1 * var(--Chip-paddingInline) / 3)","--Icon-margin":"0 calc(var(--Chip-paddingInline) / -4) 0 0",display:"inherit",order:2,zIndex:1,pointerEvents:"none"}),d4=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyChip"}),{children:o,className:l,color:c="neutral",onClick:s,disabled:m=!1,size:y="md",variant:b="soft",startDecorator:w,endDecorator:E,component:T,slots:R={},slotProps:z={}}=r,I=ir(r,gW),L=!!s||!!z.action,V=ve({},r,{disabled:m,size:y,color:c,variant:b,clickable:L,focusVisible:!1}),B=typeof z.action=="function"?z.action(V):z.action,W=H.useRef(null),{focusVisible:X,getRootProps:q}=Lh(ve({},B,{disabled:m,rootRef:W}));V.focusVisible=X;const te=vW(V),se=ve({},I,{component:T,slots:R,slotProps:z}),[re,$]=Bn("root",{ref:n,className:co(te.root,l),elementType:yW,externalForwardedProps:se,ownerState:V}),[ce,Ce]=Bn("label",{className:te.label,elementType:_W,externalForwardedProps:se,ownerState:V}),Se=il(Ce.id),[Xe,Fe]=Bn("action",{className:te.action,elementType:xW,externalForwardedProps:se,ownerState:V,getSlotProps:q,additionalProps:{"aria-labelledby":Se,as:B?.component,onClick:s}}),[Me,Te]=Bn("startDecorator",{className:te.startDecorator,elementType:bW,externalForwardedProps:se,ownerState:V}),[Ie,Ke]=Bn("endDecorator",{className:te.endDecorator,elementType:wW,externalForwardedProps:se,ownerState:V}),st=H.useMemo(()=>({disabled:m}),[m]);return oe.jsx(h4.Provider,{value:st,children:oe.jsx(Pw,{variant:b,color:c,children:oe.jsxs(re,ve({},$,{children:[L&&oe.jsx(Xe,ve({},Fe)),oe.jsx(ce,ve({},Ce,{id:Se,children:o})),w&&oe.jsx(Me,ve({},Te,{children:w})),E&&oe.jsx(Ie,ve({},Ke,{children:E}))]}))})})}),SW=Xm(oe.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Cancel");function MW(t){return qr("MuiChipDelete",t)}$r("MuiChipDelete",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSolid","variantSoft","variantOutlined"]);var ZR;const CW=["children","variant","color","disabled","onKeyDown","onDelete","onClick","component","slots","slotProps"],EW=["onDelete"],TW=t=>{const{focusVisible:e,variant:n,color:r,disabled:o}=t,l={root:["root",o&&"disabled",e&&"focusVisible",n&&`variant${Dn(n)}`,r&&`color${Dn(r)}`]};return Wr(l,MW,{})},PW=_n(j_,{name:"JoyChipDelete",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({"--IconButton-size":"var(--Chip-deleteSize, 2rem)","--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.3)",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:t.vars.fontSize.sm,paddingInline:"2px",pointerEvents:"visible",borderRadius:"var(--Chip-deleteRadius, 50%)",zIndex:1,padding:0})),AW=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyChipDelete"}),{children:o,variant:l="plain",color:c="neutral",disabled:s,onKeyDown:m,onDelete:y,onClick:b,component:w,slots:E={},slotProps:T={}}=r,R=ir(r,CW),z=H.useContext(h4),{variant:I=l,color:L=c}=Tw(e.variant,e.color,!0),V=e.color||L,B=s??z.disabled,W=H.useRef(null),X=bi(W,n),{focusVisible:q,getRootProps:te}=Lh(ve({},r,{disabled:B,rootRef:X})),se=ve({},r,{disabled:B,variant:I,color:V,focusVisible:q}),re=TW(se),$=ve({},R,{component:w,slots:E,slotProps:T}),ce=Me=>{!B&&y&&y(Me),b&&b(Me)},Ce=Me=>{["Backspace","Enter","Delete"].includes(Me.key)&&(Me.preventDefault(),!B&&y&&y(Me)),m&&m(Me)},[Se,Xe]=Bn("root",{ref:n,elementType:PW,getSlotProps:te,externalForwardedProps:$,ownerState:se,additionalProps:{as:w,onKeyDown:Ce,onClick:ce},className:re.root}),Fe=ir(Xe,EW);return oe.jsx(Se,ve({},Fe,{children:o??(ZR||(ZR=oe.jsx(SW,{})))}))});function IW(t){return qr("MuiInput",t)}const f4=$r("MuiInput",["root","input","formControl","focused","disabled","error","adornedStart","adornedEnd","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid","fullWidth","startDecorator","endDecorator"]),Aw=H.createContext(void 0),RW=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoFocus","className","defaultValue","disabled","disabledInProp","error","id","name","onClick","onChange","onKeyDown","onKeyUp","onFocus","onBlur","placeholder","readOnly","required","type","value"];function LW(t,e){var n;const r=H.useContext(Aw),{"aria-describedby":o,"aria-label":l,"aria-labelledby":c,autoComplete:s,autoFocus:m,className:y,defaultValue:b,disabled:w,disabledInProp:E,error:T,id:R,name:z,onClick:I,onChange:L,onKeyDown:V,onKeyUp:B,onFocus:W,onBlur:X,placeholder:q,readOnly:te,required:se,type:re,value:$}=t,ce=ir(t,RW),{getRootProps:Ce,getInputProps:Se,focused:Xe,error:Fe,disabled:Me}=l7({disabled:(n=E??r?.disabled)!=null?n:w,defaultValue:b,error:T,onBlur:X,onClick:I,onChange:L,onFocus:W,required:se??r?.required,value:$}),Te={[e.disabled]:Me,[e.error]:Fe,[e.focused]:Xe,[e.formControl]:!!r,[y]:y},Ie={[e.disabled]:Me};return ve({formControl:r,propsToForward:{"aria-describedby":o,"aria-label":l,"aria-labelledby":c,autoComplete:s,autoFocus:m,disabled:Me,id:R,onKeyDown:V,onKeyUp:B,name:z,placeholder:q,readOnly:te,type:re},rootStateClasses:Te,inputStateClasses:Ie,getRootProps:Ce,getInputProps:Se,focused:Xe,error:Fe,disabled:Me},ce)}const DW=["propsToForward","rootStateClasses","inputStateClasses","getRootProps","getInputProps","formControl","focused","error","disabled","fullWidth","size","color","variant","startDecorator","endDecorator","component","slots","slotProps"],kW=t=>{const{disabled:e,fullWidth:n,variant:r,color:o,size:l}=t,c={root:["root",e&&"disabled",n&&"fullWidth",r&&`variant${Dn(r)}`,o&&`color${Dn(o)}`,l&&`size${Dn(l)}`],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Wr(c,IW,{})},p4=_n("div")(({theme:t,ownerState:e})=>{var n,r,o,l,c,s;const m=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color];return[ve({"--Input-radius":t.vars.radius.sm,"--Input-gap":"0.5rem","--Input-placeholderColor":"inherit","--Input-placeholderOpacity":.64,"--Input-decoratorColor":t.vars.palette.text.icon,"--Input-focused":"0","--Input-focusedThickness":t.vars.focus.thickness,"--Input-focusedHighlight":(r=t.vars.palette[e.color==="neutral"?"primary":e.color])==null?void 0:r[500],[`&:not([${qv}])`]:ve({},e.instanceColor&&{"--_Input-focusedHighlight":(o=t.vars.palette[e.instanceColor==="neutral"?"primary":e.instanceColor])==null?void 0:o[500]},{"--Input-focusedHighlight":`var(--_Input-focusedHighlight, ${t.vars.palette.focusVisible})`})},e.size==="sm"&&{"--Input-minHeight":"2rem","--Input-paddingInline":"0.5rem","--Input-decoratorChildHeight":"min(1.5rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl},e.size==="md"&&{"--Input-minHeight":"2.25rem","--Input-paddingInline":"0.75rem","--Input-decoratorChildHeight":"min(1.75rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},e.size==="lg"&&{"--Input-minHeight":"2.75rem","--Input-paddingInline":"1rem","--Input-gap":"0.75rem","--Input-decoratorChildHeight":"min(2.25rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},{"--Input-decoratorChildOffset":"min(calc(var(--Input-paddingInline) - (var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2), var(--Input-paddingInline))","--_Input-paddingBlock":"max((var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2, 0px)","--Input-decoratorChildRadius":"max(var(--Input-radius) - var(--variant-borderWidth, 0px) - var(--_Input-paddingBlock), min(var(--_Input-paddingBlock) + var(--variant-borderWidth, 0px), var(--Input-radius) / 2))","--Button-minHeight":"var(--Input-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Input-decoratorChildHeight)","--Button-radius":"var(--Input-decoratorChildRadius)","--IconButton-radius":"var(--Input-decoratorChildRadius)",boxSizing:"border-box"},e.variant!=="plain"&&{boxShadow:t.shadow.xs},{minWidth:0,minHeight:"var(--Input-minHeight)"},e.fullWidth&&{width:"100%"},{cursor:"text",position:"relative",display:"flex",paddingInline:"var(--Input-paddingInline)",borderRadius:"var(--Input-radius)"},t.typography[`body-${e.size}`],m,{backgroundColor:(l=m?.backgroundColor)!=null?l:t.vars.palette.background.surface,"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)",boxShadow:"var(--Input-focusedInset, inset) 0 0 0 calc(var(--Input-focused) * var(--Input-focusedThickness)) var(--Input-focusedHighlight)"}}),{"&:hover":ve({},(c=t.variants[`${e.variant}Hover`])==null?void 0:c[e.color],{backgroundColor:null}),[`&.${f4.disabled}`]:(s=t.variants[`${e.variant}Disabled`])==null?void 0:s[e.color],"&:focus-within::before":{"--Input-focused":"1"}}]}),m4=_n("input")(({ownerState:t})=>({border:"none",minWidth:0,outline:0,padding:0,flex:1,color:"inherit",backgroundColor:"transparent",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"inherit",textOverflow:"ellipsis","&:-webkit-autofill":ve({paddingInline:"var(--Input-paddingInline)"},!t.startDecorator&&{marginInlineStart:"calc(-1 * var(--Input-paddingInline))",paddingInlineStart:"var(--Input-paddingInline)",borderTopLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"},!t.endDecorator&&{marginInlineEnd:"calc(-1 * var(--Input-paddingInline))",paddingInlineEnd:"var(--Input-paddingInline)",borderTopRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"}),"&::-webkit-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-moz-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&:-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"}})),g4=_n("div")({"--Button-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Input-paddingInline) / -4)",display:"inherit",alignItems:"center",paddingBlock:"var(--unstable_InputPaddingBlock)",flexWrap:"wrap",marginInlineEnd:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),v4=_n("div")({"--Button-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Input-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",marginInlineStart:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),zW=_n(p4,{name:"JoyInput",slot:"Root",overridesResolver:(t,e)=>e.root})({}),OW=_n(m4,{name:"JoyInput",slot:"Input",overridesResolver:(t,e)=>e.input})({}),FW=_n(g4,{name:"JoyInput",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({}),NW=_n(v4,{name:"JoyInput",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({}),BW=H.forwardRef(function(e,n){var r,o,l,c,s,m;const y=Xr({props:e,name:"JoyInput"}),b=LW(ve({},y,{disabledInProp:e.disabled}),f4),{propsToForward:w,rootStateClasses:E,inputStateClasses:T,getRootProps:R,getInputProps:z,formControl:I,focused:L,error:V=!1,disabled:B,fullWidth:W=!1,size:X="md",color:q="neutral",variant:te="outlined",startDecorator:se,endDecorator:re,component:$,slots:ce={},slotProps:Ce={}}=b,Se=ir(b,DW),Xe=(r=(o=e.error)!=null?o:I?.error)!=null?r:V,Fe=(l=(c=e.size)!=null?c:I?.size)!=null?l:X,Me=(s=e.color)!=null?s:Xe?"danger":(m=I?.color)!=null?m:q,Te=ve({instanceColor:Xe?"danger":e.color},y,{fullWidth:W,color:Me,disabled:B,error:Xe,focused:L,size:Fe,variant:te}),Ie=kW(Te),Ke=ve({},Se,{component:$,slots:ce,slotProps:Ce}),[st,Ee]=Bn("root",{ref:n,className:[Ie.root,E],elementType:zW,getSlotProps:R,externalForwardedProps:Ke,ownerState:Te}),[Qe,jt]=Bn("input",ve({},I&&{additionalProps:{id:I.htmlFor,"aria-describedby":I["aria-describedby"]}},{className:[Ie.input,T],elementType:OW,getSlotProps:z,internalForwardedProps:w,externalForwardedProps:Ke,ownerState:Te})),[je,ft]=Bn("startDecorator",{className:Ie.startDecorator,elementType:FW,externalForwardedProps:Ke,ownerState:Te}),[At,ht]=Bn("endDecorator",{className:Ie.endDecorator,elementType:NW,externalForwardedProps:Ke,ownerState:Te});return oe.jsxs(st,ve({},Ee,{children:[se&&oe.jsx(je,ve({},ft,{children:se})),oe.jsx(Qe,ve({},jt)),re&&oe.jsx(At,ve({},ht,{children:re}))]}))});function UW(t){return qr("MuiListSubheader",t)}$r("MuiListSubheader",["root","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const $W=["component","className","children","id","sticky","variant","color","slots","slotProps"],VW=t=>{const{variant:e,color:n,sticky:r}=t,o={root:["root",r&&"sticky",n&&`color${Dn(n)}`,e&&`variant${Dn(e)}`]};return Wr(o,UW,{})},jW=_n("div",{name:"JoyListSubheader",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;return ve({boxSizing:"border-box",display:"flex",alignItems:"center",marginInline:"var(--ListItem-marginInline)",paddingBlock:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)",minBlockSize:"var(--ListItem-minHeight)"},t.typography["body-xs"],{fontSize:"max(0.75em, 0.625rem)",textTransform:"uppercase",letterSpacing:"0.1em"},e.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:"var(--ListItem-stickyBackground)"},{color:e.color?`var(--_Link-color, rgba(${(n=t.vars.palette[e.color])==null?void 0:n.mainChannel} / 1))`:t.vars.palette.text.tertiary},e.instanceColor&&{[`&:not([${qv}])`]:{"--_Link-color":t.vars.palette.text.secondary}},(r=t.variants[e.variant])==null?void 0:r[e.color])}),HW=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListSubheader"}),{component:o,className:l,children:c,id:s,sticky:m=!1,variant:y,color:b,slots:w={},slotProps:E={}}=r,T=ir(r,$W),R=il(s),z=H.useContext(o4);H.useEffect(()=>{z&&z(R||"")},[z,R]);const I=ve({instanceColor:e.color},r,{id:R,sticky:m,variant:y,color:y?b??"neutral":b}),L=VW(I),V=ve({},T,{component:o,slots:w,slotProps:E}),[B,W]=Bn("root",{ref:n,className:co(L.root,l),elementType:jW,externalForwardedProps:V,ownerState:I,additionalProps:{as:o,id:R}});return oe.jsx(B,ve({},W,{children:c}))});function GW(t){return qr("MuiAutocomplete",t)}const Gf=$r("MuiAutocomplete",["root","wrapper","input","startDecorator","endDecorator","formControl","focused","disabled","error","multiple","limitTag","hasPopupIcon","hasClearIcon","clearIndicator","popupIndicator","popupIndicatorOpen","listbox","option","loading","noOptions","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]),y4=_n(B_)(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return ve({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":r?.backgroundColor||r?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},Cw,{boxShadow:t.shadow.md,borderRadius:`var(--List-radius, ${t.vars.radius.sm})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup},{zIndex:t.vars.zIndex.popup,overflow:"auto",maxHeight:"40vh",position:"relative","&:empty":{visibility:"hidden"},[`& .${x1.nested}, & .${x1.nested} .${jG.root}`]:{position:"initial"}})});_n(y4,{name:"JoyAutocompleteListbox",slot:"Root",overridesResolver:(t,e)=>e.root})({});function WW(t){return qr("MuiAutocompleteOption",t)}$r("MuiAutocompleteOption",["root","focused","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const qW=["children","component","color","variant","className","slots","slotProps"],XW=t=>{const{color:e,variant:n}=t,r={root:["root",e&&`color${Dn(e)}`,n&&`variant${Dn(n)}`]};return Wr(r,WW,{})},_4=_n(U_)(({theme:t,ownerState:e})=>{var n,r;return{'&[aria-disabled="true"]':(n=t.variants[`${e.variant}Disabled`])==null?void 0:n[e.color],'&[aria-selected="true"]':ve({},(r=t.variants[`${e.variant}Active`])==null?void 0:r[e.color],{fontWeight:t.vars.fontWeight.md})}}),ZW=_n(_4,{name:"JoyAutocompleteOption",slot:"Root",overridesResolver:(t,e)=>e.root})({}),x4=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyAutocompleteOption"}),{children:o,component:l="li",color:c="neutral",variant:s="plain",className:m,slots:y={},slotProps:b={}}=r,w=ir(r,qW),{variant:E=s,color:T=c}=Tw(e.variant,e.color),R=ve({},r,{component:l,color:T,variant:E}),z=XW(R),I=ve({},w,{component:l,slots:y,slotProps:b}),[L,V]=Bn("root",{ref:n,className:co(z.root,m),elementType:ZW,externalForwardedProps:I,ownerState:R,additionalProps:{as:l,role:"option"}});return oe.jsx(L,ve({},V,{children:o}))});var YR,KR;const YW=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoHighlight","autoSelect","autoFocus","blurOnSelect","clearIcon","clearOnBlur","clearOnEscape","clearText","closeText","defaultValue","disableCloseOnSelect","disabledItemsFocusable","disableListWrap","disableClearable","disabled","endDecorator","error","filterOptions","filterSelectedOptions","forcePopupIcon","freeSolo","getLimitTagsText","getOptionDisabled","getOptionKey","getOptionLabel","handleHomeEndKeys","includeInputInList","isOptionEqualToValue","groupBy","id","inputValue","limitTags","loading","loadingText","multiple","name","noOptionsText","onChange","onClose","onHighlightChange","onInputChange","onOpen","open","openOnFocus","openText","options","placeholder","popupIcon","readOnly","renderGroup","renderOption","renderTags","required","type","startDecorator","size","color","variant","value","component","selectOnFocus","slots","slotProps"],KW=["onDelete"],JW=["key"],QW=["onBlur","onFocus","onMouseDown"],eq=["key"],tq=t=>t.current!==null&&t.current.contains(document.activeElement),nq=t=>{var e;return(e=t.label)!=null?e:t},rq=t=>`+${t}`,iq=t=>oe.jsxs(gp,{nested:!0,children:[oe.jsx(HW,{sticky:!0,children:t.group}),oe.jsx(Ew,{children:t.children})]},t.key),oq=t=>{const{disabled:e,focused:n,hasClearIcon:r,hasPopupIcon:o,popupOpen:l,variant:c,color:s,size:m,multiple:y}=t,b={root:["root",n&&"focused",r&&"hasClearIcon",o&&"hasPopupIcon",c&&`variant${Dn(c)}`,s&&`color${Dn(s)}`,m&&`size${Dn(m)}`],wrapper:["wrapper",y&&"multiple"],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",l&&"popupIndicatorOpen",e&&"disabled"],listbox:["listbox"],option:["option"],loading:["loading"],noOptions:["noOptions"],limitTag:["limitTag"]};return Wr(b,GW,{})},sq=_n(p4,{name:"JoyAutocomplete",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>ve({},t.size==="sm"&&{"--Autocomplete-wrapperGap":"3px"},t.size==="md"&&{"--Autocomplete-wrapperGap":"3px"},t.size==="lg"&&{"--Autocomplete-wrapperGap":"4px"},{"@media (pointer: fine)":{[`&:hover .${Gf.clearIndicator}`]:{visibility:"visible"}}},t.multiple&&!t.startDecorator&&{paddingInlineStart:0})),aq=_n("div",{name:"JoyAutocomplete",slot:"Wrapper",overridesResolver:(t,e)=>e.wrapper})(({ownerState:t})=>({flex:1,minWidth:0,display:"flex",alignItems:"center",flexWrap:"wrap",gap:"var(--Autocomplete-wrapperGap)",[`&.${Gf.multiple}`]:ve({paddingBlock:"var(--Autocomplete-wrapperGap)"},!t.startDecorator&&{paddingInlineStart:"var(--Autocomplete-wrapperGap)"},!t.endDecorator&&{paddingInlineEnd:"var(--Autocomplete-wrapperGap)"})})),lq=_n(m4,{name:"JoyAutocomplete",slot:"Input",overridesResolver:(t,e)=>e.input})(({ownerState:t})=>ve({minWidth:30,minHeight:"var(--Chip-minHeight)"},t.multiple&&{marginInlineStart:"calc(var(--Autocomplete-wrapperGap) * 2.5)"})),cq=_n(g4,{name:"JoyAutocomplete",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({}),uq=_n(v4,{name:"JoyAutocomplete",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})(({ownerState:t})=>ve({},(t.hasClearIcon||t.hasPopupIcon)&&{"--Button-margin":"0px","--IconButton-margin":"0px","--Icon-margin":"0px"})),hq=_n(j_,{name:"JoyAutocomplete",slot:"ClearIndicator",overridesResolver:(t,e)=>e.clearIndicator})(({ownerState:t})=>ve({alignSelf:"center"},!t.hasPopupIcon&&{marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)"},{marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",visibility:t.focused?"visible":"hidden"})),dq=_n(j_,{name:"JoyAutocomplete",slot:"PopupIndicator",overridesResolver:(t,e)=>e.popupIndicator})({alignSelf:"center",marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)",[`&.${Gf.popupIndicatorOpen}`]:{transform:"rotate(180deg)","--Icon-color":"currentColor"}}),fq=_n(y4,{name:"JoyAutocomplete",slot:"Listbox",overridesResolver:(t,e)=>e.listbox})(({theme:t})=>({zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`})),pq=_n(_4,{name:"JoyAutocomplete",slot:"Option",overridesResolver:(t,e)=>e.option})({}),mq=_n(gp,{name:"JoyAutocomplete",slot:"Loading",overridesResolver:(t,e)=>e.loading})(({theme:t})=>({color:(t.vars||t).palette.text.secondary})),gq=_n(gp,{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(t,e)=>e.noOptions})(({theme:t})=>({color:(t.vars||t).palette.text.secondary})),vq=_n("div",{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(t,e)=>e.noOptions})({marginInlineStart:"calc(var(--Input-paddingInline) / 2)",marginBlockStart:"var(--_Input-paddingBlock)"}),w1=H.forwardRef(function(e,n){var r,o,l,c,s,m,y;const b=Xr({props:e,name:"JoyAutocomplete"}),{"aria-describedby":w,"aria-label":E,"aria-labelledby":T,autoFocus:R,clearIcon:z=YR||(YR=oe.jsx(l4,{fontSize:"md"})),clearText:I="Clear",closeText:L="Close",disableClearable:V=!1,disabled:B,endDecorator:W,error:X=!1,forcePopupIcon:q="auto",freeSolo:te=!1,getLimitTagsText:se=rq,getOptionLabel:re=nq,groupBy:$,id:ce,limitTags:Ce=-1,loading:Se=!1,loadingText:Xe="Loading…",multiple:Fe=!1,name:Me,noOptionsText:Te="No options",openText:Ie="Open",placeholder:Ke,popupIcon:st=KR||(KR=oe.jsx(QG,{})),readOnly:Ee=!1,renderGroup:Qe=iq,renderOption:jt,renderTags:je,required:ft,type:At,startDecorator:ht,size:lt="md",color:bt="neutral",variant:St="outlined",component:dn,slots:En={},slotProps:un={}}=b,et=ir(b,YW),Ln=H.useContext(Aw),Jt=(r=(o=e.error)!=null?o:Ln?.error)!=null?r:X,fn=(l=(c=e.size)!=null?c:Ln?.size)!=null?l:lt,$t=(s=e.color)!=null?s:Jt?"danger":(m=Ln?.color)!=null?m:bt,Nn=(y=B??Ln?.disabled)!=null?y:!1,{getRootProps:vn,getInputProps:Ue,getPopupIndicatorProps:we,getClearProps:yt,getTagProps:Nt,getListboxProps:Ht,getOptionProps:Ot,value:ln,dirty:Gt,popupOpen:Zt,focused:Fn,focusedTag:Yt,anchorEl:Pe,setAnchorEl:ae,inputValue:ue,groupedOptions:ee}=RG(ve({},b,{id:ce??Ln?.htmlFor,componentName:"Autocomplete",unstable_classNamePrefix:"Mui",unstable_isActiveElementInListbox:tq})),{onMouseDown:fe}=Ue(),{onClick:Oe}=vn(),Ye=!V&&!Nn&&Gt&&!Ee,ye=(!te||q===!0)&&q!==!1,Ae=ve({instanceColor:e.color},b,{value:ln,disabled:Nn,focused:Fn,getOptionLabel:re,hasOptions:!!ee.length,hasClearIcon:Ye,hasPopupIcon:ye,inputFocused:Yt===-1,popupOpen:Zt,size:fn,color:$t,variant:St}),Be=oq(Ae),$e=ve({},et,{component:dn,slots:En,slotProps:un});let He;if(Fe&&ln.length>0){const Qt=Zn=>{const An=Nt(Zn),{onDelete:Wn}=An,tr=ir(An,KW);return ve({disabled:Nn,size:fn,onClick:Wn},tr)};je?He=je(ln,Qt,Ae):He=ln.map((Zn,An)=>{const Wn=Qt({index:An}),{key:tr}=Wn,Or=ir(Wn,JW);return oe.jsx(d4,{size:fn,variant:"soft",color:"neutral",endDecorator:oe.jsx(AW,ve({},Or),tr),sx:{minWidth:0},children:re(Zn)},An)})}const ut=bi(n,ae),We={[Gf.disabled]:Nn,[Gf.error]:Jt,[Gf.focused]:Fn,[Gf.formControl]:!!Ln},[Ut,Kt]=Bn("root",{ref:ut,className:[Be.root,We],elementType:sq,externalForwardedProps:$e,ownerState:Ae,getSlotProps:vn,additionalProps:{onClick:Qt=>{Oe&&Oe(Qt),Qt.currentTarget===Qt.target&&fe&&fe(Qt)}}}),[Re,it]=Bn("wrapper",{className:Be.wrapper,elementType:aq,externalForwardedProps:$e,ownerState:Ae}),mt={[Gf.disabled]:Nn},[Wt,tn]=Bn("input",{className:[Be.input,mt],elementType:lq,getSlotProps:Qt=>{const Zn=Ue(),{onBlur:An,onFocus:Wn,onMouseDown:tr}=Zn,Or=ir(Zn,QW);return ve({},Or,{onBlur:Fr=>{var wr;An?.(Fr),(wr=Qt.onBlur)==null||wr.call(Qt,Fr)},onFocus:Fr=>{var wr;Wn?.(Fr),(wr=Qt.onFocus)==null||wr.call(Qt,Fr)},onMouseDown:Fr=>{var wr;tr?.(Fr),(wr=Qt.onMouseDown)==null||wr.call(Qt,Fr)}})},externalForwardedProps:$e,ownerState:Ae,additionalProps:{autoFocus:R,placeholder:Ke,name:Me,readOnly:Ee,disabled:Nn,required:ft??Ln?.required,type:At,"aria-invalid":Jt||void 0,"aria-label":E,"aria-labelledby":T,"aria-describedby":w??Ln?.["aria-describedby"]}}),[pn,rn]=Bn("startDecorator",{className:Be.startDecorator,elementType:cq,externalForwardedProps:$e,ownerState:Ae}),[on,kn]=Bn("endDecorator",{className:Be.endDecorator,elementType:uq,externalForwardedProps:$e,ownerState:Ae}),[Ct,Gn]=Bn("clearIndicator",{className:Be.clearIndicator,elementType:hq,getSlotProps:yt,externalForwardedProps:$e,ownerState:Ae,getSlotOwnerState:Qt=>({size:Qt.size||fn,variant:Qt.variant||wm(St,$t).variant||"plain",color:Qt.color||wm(St,$t).color||"neutral",disableColorInversion:!!e.color}),additionalProps:{"aria-label":I,title:I}}),[On,or]=Bn("popupIndicator",{className:Be.popupIndicator,elementType:dq,getSlotProps:we,externalForwardedProps:$e,ownerState:Ae,getSlotOwnerState:Qt=>({size:Qt.size||fn,variant:Qt.variant||wm(St,$t).variant||"plain",color:Qt.color||wm(St,$t).color||"neutral",disableColorInversion:!!e.color}),additionalProps:{disabled:Nn,"aria-label":Zt?L:Ie,title:Zt?L:Ie,type:"button"}}),[It,nt]=Bn("listbox",{className:Be.listbox,elementType:fq,getSlotProps:Ht,externalForwardedProps:$e,ownerState:Ae,getSlotOwnerState:Qt=>({size:Qt.size||fn,variant:Qt.variant||St,color:Qt.color||$t,disableColorInversion:!Qt.disablePortal}),additionalProps:{anchorEl:Pe,open:Zt,style:Pe?{width:Pe.clientWidth}:{}}}),[qt,cn]=Bn("loading",{className:Be.loading,elementType:mq,externalForwardedProps:$e,ownerState:Ae}),[Rn,Ir]=Bn("noOptions",{className:Be.noOptions,elementType:gq,externalForwardedProps:$e,ownerState:Ae,additionalProps:{role:"presentation",onMouseDown:Qt=>{Qt.preventDefault()}}}),[_r,xe]=Bn("limitTag",{className:Be.limitTag,elementType:vq,externalForwardedProps:$e,ownerState:Ae});if(Ce>-1&&Array.isArray(He)){const Qt=He.length-Ce;!Fn&&Qt>0&&(He=He.splice(0,Ce),He.push(oe.jsx(_r,ve({},xe,{children:se(Qt)}),He.length)))}const[vt,kt]=Bn("option",{className:Be.option,elementType:pq,externalForwardedProps:$e,ownerState:Ae,getSlotOwnerState:Qt=>({variant:Qt.variant||wm(St,$t).variant||"plain",color:Qt.color||wm(St,$t).color||"neutral",disableColorInversion:!nt.disablePortal}),additionalProps:{as:"li"}}),wt=jt||((Qt,Zn)=>{const{key:An}=Qt,Wn=ir(Qt,eq);return oe.jsx(vt,ve({},Wn,{children:re(Zn)}),An)}),hn=(Qt,Zn)=>{const An=Ot({option:Qt,index:Zn});return wt(ve({},kt,An),Qt,{selected:!!An["aria-selected"],inputValue:ue,ownerState:Ae})},Pn=H.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...nt.modifiers||[]],[nt.modifiers]);let mn=null;if(Pe){var Tn;mn=oe.jsx(Pw,{variant:St,color:$t,children:oe.jsx(N_,{nested:!0,children:oe.jsxs(It,ve({},nt,{className:co(nt.className),modifiers:Pn},!((Tn=b.slots)!=null&&Tn.listbox)&&{as:ww,slots:{root:nt.as||"ul"}},{children:[ee.map((Qt,Zn)=>{if($){const An=Qt;return Qe({key:String(An.key),group:An.group,children:An.options.map((Wn,tr)=>hn(Wn,An.index+tr))})}return hn(Qt,Zn)}),Se&&ee.length===0?oe.jsx(qt,ve({},cn,{children:Xe})):null,ee.length===0&&!te&&!Se?oe.jsx(Rn,ve({},Ir,{children:Te})):null]}))})})}return oe.jsxs(H.Fragment,{children:[oe.jsxs(Ut,ve({},Kt,{children:[ht&&oe.jsx(pn,ve({},rn,{children:ht})),oe.jsxs(Re,ve({},it,{children:[He,oe.jsx(Wt,ve({},tn))]})),W&&oe.jsx(on,ve({},kn,{children:W})),Ye?oe.jsx(Ct,ve({},Gn,{children:z})):null,ye?oe.jsx(On,ve({},or,{children:st})):null]})),mn]})}),yq=Xm(oe.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function _q(t){return qr("MuiAvatar",t)}$r("MuiAvatar",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","fallback","sizeSm","sizeMd","sizeLg","img","variantOutlined","variantSoft","variantSolid"]);const xq=H.createContext(void 0);_n("div",{name:"JoyAvatarGroup",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>ve({},t.size==="sm"&&{"--AvatarGroup-gap":"-0.375rem","--Avatar-ringSize":"2px"},t.size==="md"&&{"--AvatarGroup-gap":"-0.5rem","--Avatar-ringSize":"2px"},t.size==="lg"&&{"--AvatarGroup-gap":"-0.625rem","--Avatar-ringSize":"4px"},{"--Avatar-ring":`0 0 0 var(--Avatar-ringSize) var(--Avatar-ringColor, ${e.vars.palette.background.surface})`,"--Avatar-marginInlineStart":"var(--AvatarGroup-gap)",display:"flex",marginInlineStart:"calc(-1 * var(--AvatarGroup-gap))"}));const bq=["alt","color","size","variant","src","srcSet","children","component","slots","slotProps"],wq=t=>{const{size:e,variant:n,color:r,src:o,srcSet:l}=t,c={root:["root",n&&`variant${Dn(n)}`,r&&`color${Dn(r)}`,e&&`size${Dn(e)}`],img:[(o||l)&&"img"],fallback:["fallback"]};return Wr(c,_q,{})},Sq=_n("div",{name:"JoyAvatar",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return ve({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},t.typography[`title-${e.size}`],e.size==="sm"&&{width:"var(--Avatar-size, 2rem)",height:"var(--Avatar-size, 2rem)",fontSize:"calc(var(--Avatar-size, 2rem) * 0.4375)"},e.size==="md"&&{width:"var(--Avatar-size, 2.5rem)",height:"var(--Avatar-size, 2.5rem)",fontSize:"calc(var(--Avatar-size, 2.5rem) * 0.4)"},e.size==="lg"&&{width:"var(--Avatar-size, 3rem)",height:"var(--Avatar-size, 3rem)",fontSize:"calc(var(--Avatar-size, 3rem) * 0.375)"},{marginInlineStart:"var(--Avatar-marginInlineStart)",boxShadow:"var(--Avatar-ring)",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,lineHeight:1,overflow:"hidden",borderRadius:"var(--Avatar-radius, 50%)",userSelect:"none"},(n=t.variants[e.variant])==null?void 0:n[e.color])}),Mq=_n("img",{name:"JoyAvatar",slot:"Img",overridesResolver:(t,e)=>e.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),Cq=_n(yq,{name:"JoyAvatar",slot:"Fallback",overridesResolver:(t,e)=>e.fallback})({width:"64%",height:"64%"});function Eq({crossOrigin:t,referrerPolicy:e,src:n,srcSet:r}){const[o,l]=H.useState(!1);return H.useEffect(()=>{if(!n&&!r)return;l(!1);let c=!0;const s=new Image;return s.onload=()=>{c&&l("loaded")},s.onerror=()=>{c&&l("error")},s.crossOrigin=t,s.referrerPolicy=e,n&&(s.src=n),r&&(s.srcset=r),()=>{c=!1}},[t,e,n,r]),o}const Tq=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyAvatar"}),o=H.useContext(xq),{alt:l,color:c="neutral",size:s="md",variant:m="soft",src:y,srcSet:b,children:w,component:E,slots:T={},slotProps:R={}}=r,z=ir(r,bq),I=e.variant||o?.variant||m,L=e.color||o?.color||c,V=e.size||o?.size||s;let B=null;const W=ve({},r,{color:L,size:V,variant:I,grouped:!!o}),X=wq(W),q=ve({},z,{component:E,slots:T,slotProps:R}),[te,se]=Bn("root",{ref:n,className:X.root,elementType:Sq,externalForwardedProps:q,ownerState:W}),[re,$]=Bn("img",{additionalProps:{alt:l,src:y,srcSet:b},className:X.img,elementType:Mq,externalForwardedProps:q,ownerState:W}),[ce,Ce]=Bn("fallback",{className:X.fallback,elementType:Cq,externalForwardedProps:q,ownerState:W}),Se=Eq(ve({},$,{src:y,srcSet:b}));return(y||b)&&Se!=="error"?B=oe.jsx(re,ve({},$)):w!=null?B=w:l?B=l[0]:B=oe.jsx(ce,ve({},Ce)),oe.jsx(te,ve({},se,{children:B}))}),Pq=A5("MuiBox",["root"]),b4=Tj({themeId:P_,defaultTheme:ay,defaultClassName:Pq.root,generateClassName:E5.generate});function Aq(t){return qr("MuiTypography",t)}$r("MuiTypography",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","noWrap","gutterBottom","startDecorator","endDecorator","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const Iq=["color","textColor"],Rq=["component","gutterBottom","noWrap","level","levelMapping","children","endDecorator","startDecorator","variant","slots","slotProps"],x2=H.createContext(!1),Lq=H.createContext(!1),Dq=t=>{const{gutterBottom:e,noWrap:n,level:r,color:o,variant:l}=t,c={root:["root",r,e&&"gutterBottom",n&&"noWrap",o&&`color${Dn(o)}`,l&&`variant${Dn(l)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Wr(c,Aq,{})},kq=_n("span",{name:"JoyTypography",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),zq=_n("span",{name:"JoyTypography",slot:"endDecorator",overridesResolver:(t,e)=>e.endDecorator})({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),Oq=_n("span",{name:"JoyTypography",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,o,l,c;const s=e.level!=="inherit"?(n=t.typography[e.level])==null?void 0:n.lineHeight:"1";return ve({"--Icon-fontSize":`calc(1em * ${s})`},e.color&&{"--Icon-color":"currentColor"},{margin:"var(--Typography-margin, 0px)"},e.nesting?{display:"inline"}:ve({display:"block"},e.unstable_hasSkeleton&&{position:"relative"}),(e.startDecorator||e.endDecorator)&&ve({display:"flex",alignItems:"center"},e.nesting&&ve({display:"inline-flex"},e.startDecorator&&{verticalAlign:"bottom"})),e.level&&e.level!=="inherit"&&t.typography[e.level],{fontSize:`var(--Typography-fontSize, ${e.level&&e.level!=="inherit"&&(r=(o=t.typography[e.level])==null?void 0:o.fontSize)!=null?r:"inherit"})`},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.color&&{color:`var(--variant-plainColor, rgba(${(l=t.vars.palette[e.color])==null?void 0:l.mainChannel} / 1))`},e.variant&&ve({borderRadius:t.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!e.nesting&&{marginInline:"-0.25em"},(c=t.variants[e.variant])==null?void 0:c[e.color]))}),JR={h1:"h1",h2:"h2",h3:"h3",h4:"h4","title-lg":"p","title-md":"p","title-sm":"p","body-lg":"p","body-md":"p","body-sm":"p","body-xs":"span",inherit:"p"},Fi=H.forwardRef(function(e,n){var r;const o=Xr({props:e,name:"JoyTypography"}),{color:l,textColor:c}=o,s=ir(o,Iq),m=H.useContext(x2),y=H.useContext(Lq),b=mP(ve({},s,{color:c})),{component:w,gutterBottom:E=!1,noWrap:T=!1,level:R="body-md",levelMapping:z=JR,children:I,endDecorator:L,startDecorator:V,variant:B,slots:W={},slotProps:X={}}=b,q=ir(b,Rq),te=(r=e.color)!=null?r:B?l??"neutral":l,se=m||y?e.level||"inherit":R,re=vP(I,["Skeleton"]),$=w||(m?"span":z[se]||JR[se]||"span"),ce=ve({},b,{level:se,component:$,color:te,gutterBottom:E,noWrap:T,nesting:m,variant:B,unstable_hasSkeleton:re}),Ce=Dq(ce),Se=ve({},q,{component:$,slots:W,slotProps:X}),[Xe,Fe]=Bn("root",{ref:n,className:Ce.root,elementType:Oq,externalForwardedProps:Se,ownerState:ce}),[Me,Te]=Bn("startDecorator",{className:Ce.startDecorator,elementType:kq,externalForwardedProps:Se,ownerState:ce}),[Ie,Ke]=Bn("endDecorator",{className:Ce.endDecorator,elementType:zq,externalForwardedProps:Se,ownerState:ce});return oe.jsx(x2.Provider,{value:!0,children:oe.jsxs(Xe,ve({},Fe,{children:[V&&oe.jsx(Me,ve({},Te,{children:V})),re?H.cloneElement(I,{variant:I.props.variant||"inline"}):I,L&&oe.jsx(Ie,ve({},Ke,{children:L}))]}))})});Fi.muiName="Typography";function Fq(t){return qr("MuiButton",t)}const QR=$r("MuiButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]),Nq=["children","action","color","variant","size","fullWidth","startDecorator","endDecorator","loading","loadingPosition","loadingIndicator","disabled","component","slots","slotProps"],Bq=t=>{const{color:e,disabled:n,focusVisible:r,focusVisibleClassName:o,fullWidth:l,size:c,variant:s,loading:m}=t,y={root:["root",n&&"disabled",r&&"focusVisible",l&&"fullWidth",s&&`variant${Dn(s)}`,e&&`color${Dn(e)}`,c&&`size${Dn(c)}`,m&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]},b=Wr(y,Fq,{});return r&&o&&(b.root+=` ${o}`),b},Uq=_n("span",{name:"JoyButton",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),$q=_n("span",{name:"JoyButton",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),Vq=_n("span",{name:"JoyButton",slot:"LoadingCenter",overridesResolver:(t,e)=>e.loadingIndicatorCenter})(({theme:t,ownerState:e})=>{var n,r;return ve({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),w4=({theme:t,ownerState:e})=>{var n,r,o,l;return[ve({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},e.size==="sm"&&{"--Icon-fontSize":t.vars.fontSize.lg,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.375rem",minHeight:"var(--Button-minHeight, 2rem)",fontSize:t.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.25rem)",paddingInline:"0.75rem"},e.size==="md"&&{"--Icon-fontSize":t.vars.fontSize.xl,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.5rem",minHeight:"var(--Button-minHeight, 2.25rem)",fontSize:t.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.375rem)",paddingInline:"1rem"},e.size==="lg"&&{"--Icon-fontSize":t.vars.fontSize.xl2,"--CircularProgress-size":"28px","--CircularProgress-thickness":"4px","--Button-gap":"0.75rem",minHeight:"var(--Button-minHeight, 2.75rem)",fontSize:t.vars.fontSize.md,paddingBlock:"var(--Button-paddingBlock, 0.5rem)",paddingInline:"1.5rem"},{WebkitTapHighlightColor:"transparent",boxSizing:"border-box",borderRadius:`var(--Button-radius, ${t.vars.radius.sm})`,margin:"var(--Button-margin)",border:"none",backgroundColor:"transparent",cursor:"pointer",userSelect:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",textDecoration:"none",fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.lg,lineHeight:t.vars.lineHeight.md},e.fullWidth&&{width:"100%"},{[t.focus.selector]:t.focus.default}),ve({},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":{"@media (hover: hover)":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]},'&:active, &[aria-pressed="true"]':(o=t.variants[`${e.variant}Active`])==null?void 0:o[e.color],[`&.${QR.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]},e.loadingPosition==="center"&&{[`&.${QR.loading}`]:{color:"transparent"}})]},jq=_n("button",{name:"JoyButton",slot:"Root",overridesResolver:(t,e)=>e.root})(w4),S4=H.forwardRef(function(e,n){var r;const o=Xr({props:e,name:"JoyButton"}),{children:l,action:c,color:s="primary",variant:m="solid",size:y="md",fullWidth:b=!1,startDecorator:w,endDecorator:E,loading:T=!1,loadingPosition:R="center",loadingIndicator:z,disabled:I,component:L,slots:V={},slotProps:B={}}=o,W=ir(o,Nq),X=H.useContext(NP),q=H.useContext(u4),te=e.variant||X.variant||m,se=e.size||X.size||y,re=e.color||X.color||s,$=(r=e.loading||e.disabled)!=null?r:X.disabled||T||I,ce=H.useRef(null),Ce=bi(ce,n),{focusVisible:Se,setFocusVisible:Xe,getRootProps:Fe}=Lh(ve({},o,{disabled:$,rootRef:Ce})),Me=z??oe.jsx(BP,{color:re,thickness:{sm:2,md:3,lg:4}[se]||3});H.useImperativeHandle(c,()=>({focusVisible:()=>{var St;Xe(!0),(St=ce.current)==null||St.focus()}}),[Xe]);const Te=ve({},o,{color:re,fullWidth:b,variant:te,size:se,focusVisible:Se,loading:T,loadingPosition:R,disabled:$}),Ie=Bq(Te),Ke=St=>{var dn;let En=o.onClick;if(typeof B.root=="function"?En=B.root(Te).onClick:B.root&&(En=B.root.onClick),(dn=En)==null||dn(St),q){var un;(un=q.onClick)==null||un.call(q,St,o.value)}};let st=o["aria-pressed"];typeof B.root=="function"?st=B.root(Te)["aria-pressed"]:B.root&&(st=B.root["aria-pressed"]),q!=null&&q.value&&(Array.isArray(q.value)?st=q.value.indexOf(o.value)!==-1:st=q.value===o.value);const Ee=ve({},W,{component:L,slots:V,slotProps:B}),[Qe,jt]=Bn("root",{ref:n,className:Ie.root,elementType:jq,externalForwardedProps:Ee,getSlotProps:Fe,ownerState:Te,additionalProps:{onClick:Ke,"aria-pressed":st}}),[je,ft]=Bn("startDecorator",{className:Ie.startDecorator,elementType:Uq,externalForwardedProps:Ee,ownerState:Te}),[At,ht]=Bn("endDecorator",{className:Ie.endDecorator,elementType:$q,externalForwardedProps:Ee,ownerState:Te}),[lt,bt]=Bn("loadingIndicatorCenter",{className:Ie.loadingIndicatorCenter,elementType:Vq,externalForwardedProps:Ee,ownerState:Te});return oe.jsxs(Qe,ve({},jt,{children:[(w||T&&R==="start")&&oe.jsx(je,ve({},ft,{children:T&&R==="start"?Me:w})),l,T&&R==="center"&&oe.jsx(lt,ve({},bt,{children:Me})),(E||T&&R==="end")&&oe.jsx(At,ve({},ht,{children:T&&R==="end"?Me:E}))]}))});S4.muiName="Button";function Hq(t){return qr("MuiCard",t)}$r("MuiCard",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","horizontal","vertical"]);const Gq=["className","color","component","invertedColors","size","variant","children","orientation","slots","slotProps"],Wq=t=>{const{size:e,variant:n,color:r,orientation:o}=t,l={root:["root",o,n&&`variant${Dn(n)}`,r&&`color${Dn(r)}`,e&&`size${Dn(e)}`]};return Wr(l,Hq,{})},qq=_n("div")(({theme:t,ownerState:e})=>{var n;const{p:r,padding:o,borderRadius:l}=qm({theme:t,ownerState:e},["p","padding","borderRadius"]);return[ve({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,"--Card-childRadius":"max((var(--Card-radius) - var(--variant-borderWidth, 0px)) - var(--Card-padding), min(var(--Card-padding) / 2, (var(--Card-radius) - var(--variant-borderWidth, 0px)) / 2))","--AspectRatio-radius":"var(--Card-childRadius)","--unstable_actionMargin":"calc(-1 * var(--variant-borderWidth, 0px))","--unstable_actionRadius":"var(--Card-radius)","--CardCover-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--CardOverflow-offset":"calc(-1 * var(--Card-padding))","--CardOverflow-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--Divider-inset":"calc(-1 * var(--Card-padding))"},e.size==="sm"&&{"--Card-radius":t.vars.radius.sm,"--Card-padding":"0.625rem",gap:"0.5rem"},e.size==="md"&&{"--Card-radius":t.vars.radius.md,"--Card-padding":"1rem",gap:"0.75rem 1rem"},e.size==="lg"&&{"--Card-radius":t.vars.radius.lg,"--Card-padding":"1.5rem",gap:"1rem 1.5rem"},{padding:"var(--Card-padding)",borderRadius:"var(--Card-radius)",backgroundColor:t.vars.palette.background.surface,position:"relative",display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column"},t.typography[`body-${e.size}`],e.variant==="solid"&&e.color&&e.invertedColors&&$_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&V_(e.color)(t),(n=t.variants[e.variant])==null?void 0:n[e.color]),r!==void 0&&{"--Card-padding":r},o!==void 0&&{"--Card-padding":o},l!==void 0&&{"--Card-radius":l}]}),Xq=_n(qq,{name:"JoyCard",slot:"Root",overridesResolver:(t,e)=>e.root})({}),b2=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyCard"}),{className:o,color:l="neutral",component:c="div",invertedColors:s=!1,size:m="md",variant:y="outlined",children:b,orientation:w="vertical",slots:E={},slotProps:T={}}=r,R=ir(r,Gq),z=ve({},r,{color:l,component:c,orientation:w,size:m,variant:y,invertedColors:s}),I=Wq(z),L=ve({},R,{component:c,slots:E,slotProps:T}),[V,B]=Bn("root",{ref:n,className:co(I.root,o),elementType:Xq,externalForwardedProps:L,ownerState:z});return oe.jsx(V,ve({},B,{children:H.Children.map(b,(W,X)=>{if(!H.isValidElement(W))return W;const q={};if(vP(W,["Divider"])){var te,se;const re=W.props;q.inset=(te=re?.inset)!=null?te:"context";const $=w==="vertical"?"horizontal":"vertical";q.orientation=(se=re?.orientation)!=null?se:$}return X===0&&(q["data-first-child"]=""),X===H.Children.count(b)-1&&(q["data-last-child"]=""),H.cloneElement(W,q)})}))}),M4=$r("MuiCardOverflow",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);function Zq(t){return qr("MuiDivider",t)}$r("MuiDivider",["root","horizontal","vertical","insetContext","insetNone"]);const C4=_n("div")(({ownerState:t})=>({display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column",flex:9999,zIndex:1,columnGap:"var(--Card-padding)",rowGap:"max(2px, calc(0.1875 * var(--Card-padding)))",padding:"var(--unstable_padding)",[`.${M4.root} > &`]:{"--unstable_padding":"calc(var(--Card-padding) * 0.75) 0px"}}));_n(C4,{name:"JoyCardContent",slot:"Root",overridesResolver:(t,e)=>e.root})({});const Yq=$r("MuiModalDialog",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","layoutCenter","layoutFullscreen"]);function Kq(t){return qr("MuiCheckbox",t)}const zm=$r("MuiCheckbox",["root","checkbox","action","input","label","checked","disabled","focusVisible","indeterminate","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantOutlined","variantSoft","variantSolid"]),Jq=Xm(oe.jsx("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"}),"Check"),Qq=Xm(oe.jsx("path",{d:"M19 13H5c-.55 0-1-.45-1-1s.45-1 1-1h14c.55 0 1 .45 1 1s-.45 1-1 1z"}),"HorizontalRule"),eX=["checked","uncheckedIcon","checkedIcon","label","defaultChecked","disabled","disableIcon","overlay","id","indeterminate","indeterminateIcon","name","onBlur","onChange","onFocus","onFocusVisible","readOnly","required","value","color","variant","size","component","slots","slotProps"],tX=t=>{const{checked:e,disabled:n,disableIcon:r,focusVisible:o,color:l,variant:c,size:s,indeterminate:m}=t,y={root:["root",e&&"checked",n&&"disabled",o&&"focusVisible",c&&`variant${Dn(c)}`,l&&`color${Dn(l)}`,s&&`size${Dn(s)}`],checkbox:["checkbox",e&&"checked",m&&"indeterminate",n&&"disabled"],action:["action",e&&"checked",r&&n&&"disabled",o&&"focusVisible"],input:["input"],label:["label"]};return Wr(y,Kq,{})},nX=_n("span",{name:"JoyCheckbox",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,o;return ve({"--Icon-fontSize":"var(--Checkbox-size)"},t.size==="sm"&&{"--Checkbox-size":"1rem","& ~ *":{"--FormHelperText-margin":"0 0 0 1.5rem"},fontSize:e.vars.fontSize.sm,gap:"var(--Checkbox-gap, 0.5rem)"},t.size==="md"&&{"--Checkbox-size":"1.25rem","& ~ *":{"--FormHelperText-margin":"0.25rem 0 0 1.875rem"},fontSize:e.vars.fontSize.md,gap:"var(--Checkbox-gap, 0.625rem)"},t.size==="lg"&&{"--Checkbox-size":"1.5rem","& ~ *":{"--FormHelperText-margin":"0.375rem 0 0 2.25rem"},fontSize:e.vars.fontSize.lg,gap:"var(--Checkbox-gap, 0.75rem)"},{position:t.overlay?"initial":"relative",display:"inline-flex",fontFamily:e.vars.fontFamily.body,lineHeight:"var(--Checkbox-size)",color:e.vars.palette.text.primary,[`&.${zm.disabled}`]:{color:(n=e.variants.plainDisabled)==null||(n=n[t.color])==null?void 0:n.color}},t.disableIcon&&{color:(r=e.variants[t.variant])==null||(r=r[t.color])==null?void 0:r.color,[`&.${zm.disabled}`]:{color:(o=e.variants[`${t.variant}Disabled`])==null||(o=o[t.color])==null?void 0:o.color}})}),rX=_n("span",{name:"JoyCheckbox",slot:"Checkbox",overridesResolver:(t,e)=>e.checkbox})(({theme:t,ownerState:e})=>{var n,r,o,l,c;const s=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color];return[ve({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,boxSizing:"border-box",borderRadius:`min(${t.vars.radius.sm}, 0.25rem)`,width:"var(--Checkbox-size)",height:"var(--Checkbox-size)",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},e.disableIcon&&{display:"contents"},{[`&.${zm.checked}, &.${zm.indeterminate}`]:{"--Icon-color":"currentColor"}}),...e.disableIcon?[]:[ve({},s,{backgroundColor:(r=s?.backgroundColor)!=null?r:t.vars.palette.background.surface}),{"&:hover":{"@media (hover: hover)":(o=t.variants[`${e.variant}Hover`])==null?void 0:o[e.color]}},{"&:active":(l=t.variants[`${e.variant}Active`])==null?void 0:l[e.color]},{[`&.${zm.disabled}`]:(c=t.variants[`${e.variant}Disabled`])==null?void 0:c[e.color]}]]}),iX=_n("span",{name:"JoyCheckbox",slot:"Action",overridesResolver:(t,e)=>e.action})(({theme:t,ownerState:e})=>{var n,r,o,l;return[{borderRadius:`var(--Checkbox-actionRadius, ${e.overlay?"var(--unstable_actionRadius, inherit)":"inherit"})`,textAlign:"left",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",zIndex:1,[t.focus.selector]:t.focus.default},...e.disableIcon?[(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]},{"&:active":(o=t.variants[`${e.variant}Active`])==null?void 0:o[e.color]},{[`&.${zm.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]}]:[]]}),oX=_n("input",{name:"JoyCheckbox",slot:"Input",overridesResolver:(t,e)=>e.input})(()=>({margin:0,opacity:0,position:"absolute",width:"100%",height:"100%",cursor:"pointer"})),sX=_n("label",{name:"JoyCheckbox",slot:"Label",overridesResolver:(t,e)=>e.label})(({ownerState:t})=>ve({flex:1,minWidth:0},t.disableIcon&&{zIndex:1,pointerEvents:"none"})),aX=oe.jsx(Jq,{}),lX=oe.jsx(Qq,{}),Bm=H.forwardRef(function(e,n){var r,o,l,c,s;const m=Xr({props:e,name:"JoyCheckbox"}),{checked:y,uncheckedIcon:b,checkedIcon:w=aX,label:E,defaultChecked:T,disabled:R,disableIcon:z=!1,overlay:I,id:L,indeterminate:V=!1,indeterminateIcon:B=lX,name:W,onBlur:X,onChange:q,onFocus:te,onFocusVisible:se,readOnly:re,required:$,value:ce,color:Ce,variant:Se,size:Xe="md",component:Fe,slots:Me={},slotProps:Te={}}=m,Ie=ir(m,eX),Ke=H.useContext(Aw),st=(r=(o=e.disabled)!=null?o:Ke?.disabled)!=null?r:R,Ee=(l=(c=e.size)!=null?c:Ke?.size)!=null?l:Xe,Qe=il(L??Ke?.htmlFor),jt={checked:y,defaultChecked:T,disabled:st,onBlur:X,onChange:q,onFocus:te,onFocusVisible:se},{getInputProps:je,checked:ft,disabled:At,focusVisible:ht}=yG(jt),lt=ft||V,dn=lt?Se||"solid":Se||"outlined",En=e.color||(Ke!=null&&Ke.error?"danger":(s=Ke?.color)!=null?s:Ce),Ln=ve({},m,{checked:ft,disabled:At,disableIcon:z,overlay:I,focusVisible:ht,color:lt?En||"primary":En||"neutral",variant:dn,size:Ee}),Jt=tX(Ln),fn=ve({},Ie,{component:Fe,slots:Me,slotProps:Te}),[$t,Nn]=Bn("root",{ref:n,className:Jt.root,elementType:nX,externalForwardedProps:fn,ownerState:Ln}),[vn,Ue]=Bn("checkbox",{className:Jt.checkbox,elementType:rX,externalForwardedProps:fn,ownerState:Ln}),[we,yt]=Bn("action",{className:Jt.action,elementType:iX,externalForwardedProps:fn,ownerState:Ln}),[Nt,Ht]=Bn("input",{additionalProps:ve({id:Qe,name:W,value:ce,readOnly:re,role:void 0,required:$??Ke?.required,"aria-describedby":Ke?.["aria-describedby"]},V&&{"aria-checked":"mixed"}),className:Jt.input,elementType:oX,externalForwardedProps:fn,getSlotProps:je,ownerState:Ln}),[Ot,ln]=Bn("label",{additionalProps:{htmlFor:Qe},className:Jt.label,elementType:sX,externalForwardedProps:fn,ownerState:Ln});let Gt=b;return z?Gt=null:V?Gt=B:ft&&(Gt=w),oe.jsxs($t,ve({},Nn,{children:[oe.jsxs(vn,ve({},Ue,{children:[oe.jsx(we,ve({},yt,{children:oe.jsx(Nt,ve({},Ht))})),Gt]})),E&&oe.jsx(x2.Provider,{value:!0,children:oe.jsx(Ot,ve({},ln,{children:E}))})]}))});function cX(t){const{children:e,disableColorScheme:n=!1}=t;return oe.jsxs(H.Fragment,{children:[oe.jsx(N9,{styles:r=>{var o,l;const c={};n||Object.entries(r.colorSchemes).forEach(([m,y])=>{var b;c[r.getColorSchemeSelector(m).replace(/\s*&/,"")]={colorScheme:(b=y.palette)==null?void 0:b.mode}});const s=(o=(l=r.components)==null||(l=l.JoyTypography)==null||(l=l.defaultProps)==null?void 0:l.level)!=null?o:"body-md";return ve({html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:r.vars.fontWeight.lg},body:ve({margin:0,color:r.vars.palette.text.primary,fontFamily:r.vars.fontFamily.body},r.typography[s],{backgroundColor:r.vars.palette.background.body,"@media print":{backgroundColor:r.vars.palette.common.white},"&::backdrop":{backgroundColor:r.vars.palette.background.backdrop}})},c)},defaultTheme:ay}),e]})}function uX(t){return qr("MuiDialogContent",t)}$r("MuiDialogContent",["root"]);const Iw=H.createContext(void 0);function hX(t){return qr("MuiDialogTitle",t)}const E4=$r("MuiDialogTitle",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),dX=["component","children","orientation","slots","slotProps"],fX=()=>Wr({root:["root"]},uX,{}),pX=_n(C4,{name:"JoyDialogContent",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({color:`var(--DialogContent-color, ${t.vars.palette.text.tertiary})`,overflow:"auto",margin:"var(--unstable_DialogContent-margin)",[`.${Yq.root} > .${E4.root} + &`]:{"--unstable_DialogContent-margin":"-0.375em 0 0 0"}})),T4=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyDialogContent"}),o=H.useContext(Iw),{component:l="div",children:c,orientation:s="vertical",slots:m={},slotProps:y={}}=r,b=ir(r,dX),w=ve({},b,{component:l,slots:m,slotProps:y}),E=ve({},r,{component:l,orientation:s}),T=fX(),[R,z]=Bn("root",{ref:n,className:T.root,elementType:pX,externalForwardedProps:w,ownerState:E,additionalProps:{id:o?.describedBy}});return oe.jsx(R,ve({},z,{children:c}))}),UP=H.createContext(void 0),mX=["component","children","variant","color","level","slots","slotProps"],gX=t=>{const{level:e,color:n,variant:r}=t,o={root:["root",e,n&&`color${Dn(n)}`,r&&`variant${Dn(r)}`]};return Wr(o,hX,{})},vX=_n("h2",{name:"JoyDialogTitle",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const o=e.level!=="inherit"?(n=t.typography[e.level])==null?void 0:n.lineHeight:"1";return ve({"--Icon-fontSize":`calc(1em * ${o})`},e.color&&{"--Icon-color":"currentColor"},{display:"flex",gap:"clamp(4px, 0.375em, 0.75rem)",margin:"var(--unstable_DialogTitle-margin, 0px)"},e.level&&e.level!=="inherit"&&t.typography[e.level],{color:"inherit"},e.variant&&ve({borderRadius:t.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},(r=t.variants[e.variant])==null?void 0:r[e.color]),{[`.${M4.root} > &`]:{"--unstable_DialogTitle-margin":"var(--Card-padding) 0"}})}),yX={sm:"title-md",md:"title-lg",lg:"h4"},P4=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyDialogTitle"}),o=H.useContext(UP),l=H.useContext(Iw),{component:c="h2",children:s,variant:m,color:y,level:b=yX[o||"md"],slots:w={},slotProps:E={}}=r,T=ir(r,mX),R=e.color||(m?y??"neutral":y),z=ve({},T,{component:c,slots:w,slotProps:E}),I=ve({},r,{component:c,color:R,variant:m,level:b}),L=gX(I),[V,B]=Bn("root",{ref:n,className:L.root,elementType:vX,externalForwardedProps:z,ownerState:I,additionalProps:{id:l?.labelledBy}});return oe.jsx(V,ve({},B,{children:s}))}),_X=["className","children","component","inset","orientation","role","slots","slotProps"],xX=t=>{const{orientation:e,inset:n}=t,r={root:["root",e,n&&`inset${Dn(n)}`]};return Wr(r,Zq,{})},A4=_n("hr",{name:"JoyDivider",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>ve({"--Divider-thickness":"1px","--Divider-lineColor":t.vars.palette.divider},e.inset==="none"&&{"--_Divider-inset":"0px"},e.inset==="context"&&{"--_Divider-inset":"var(--Divider-inset, 0px)"},{margin:"initial",marginInline:e.orientation==="vertical"?"initial":"var(--_Divider-inset)",marginBlock:e.orientation==="vertical"?"var(--_Divider-inset)":"initial",position:"relative",alignSelf:"stretch",flexShrink:0},e.children?ve({"--Divider-gap":t.spacing(1),"--Divider-childPosition":"50%",display:"flex",flexDirection:e.orientation==="vertical"?"column":"row",alignItems:"center",whiteSpace:"nowrap",textAlign:"center",border:0},t.typography["body-sm"],{"&::before, &::after":{position:"relative",inlineSize:e.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:e.orientation==="vertical"?"initial":"var(--Divider-thickness)",backgroundColor:"var(--Divider-lineColor)",content:'""'},"&::before":{marginInlineEnd:e.orientation==="vertical"?"initial":"min(var(--Divider-childPosition) * 999, var(--Divider-gap))",marginBlockEnd:e.orientation==="vertical"?"min(var(--Divider-childPosition) * 999, var(--Divider-gap))":"initial",flexBasis:"var(--Divider-childPosition)"},"&::after":{marginInlineStart:e.orientation==="vertical"?"initial":"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))",marginBlockStart:e.orientation==="vertical"?"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))":"initial",flexBasis:"calc(100% - var(--Divider-childPosition))"}}):{border:"none",listStyle:"none",backgroundColor:"var(--Divider-lineColor)",inlineSize:e.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:e.orientation==="vertical"?"initial":"var(--Divider-thickness)"})),Rw=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyDivider"}),{className:o,children:l,component:c=l!=null?"div":"hr",inset:s,orientation:m="horizontal",role:y=c!=="hr"?"separator":void 0,slots:b={},slotProps:w={}}=r,E=ir(r,_X),T=ve({},r,{inset:s,role:y,orientation:m,component:c}),R=xX(T),z=ve({},E,{component:c,slots:b,slotProps:w}),[I,L]=Bn("root",{ref:n,className:co(R.root,o),elementType:A4,externalForwardedProps:z,ownerState:T,additionalProps:ve({as:c,role:y},y==="separator"&&m==="vertical"&&{"aria-orientation":"vertical"})});return oe.jsx(I,ve({},L,{children:l}))});Rw.muiName="Divider";const I4=H.createContext(void 0),R4=_n("div")(({ownerState:t,theme:e})=>ve({"--unstable_popup-zIndex":`calc(${e.vars.zIndex.modal} + 1)`,'& ~ [role="listbox"]':{"--unstable_popup-zIndex":`calc(${e.vars.zIndex.modal} + 1)`},position:"fixed",zIndex:e.vars.zIndex.modal,right:0,bottom:0,top:0,left:0},!t.open&&{visibility:"hidden"}));_n(R4,{name:"JoyModal",slot:"Root",overridesResolver:(t,e)=>e.root})({});const L4=_n("div")(({theme:t})=>({zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:t.vars.palette.background.backdrop,WebkitTapHighlightColor:"transparent",backdropFilter:"blur(8px)"}));_n(L4,{name:"JoyModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({});function bX(t){return qr("MuiDrawer",t)}$r("MuiDrawer",["root","hidden","backdrop","content","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const wX=["children","anchor","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","color","variant","invertedColors","size","onClose","onKeyDown","open","component","slots","slotProps"],SX=t=>{const{open:e,variant:n,color:r,size:o}=t,l={root:["root",!e&&"hidden",n&&`variant${Dn(n)}`,r&&`color${Dn(r)}`,o&&`size${Dn(o)}`],backdrop:["backdrop"],content:["content"]};return Wr(l,bX,{})},MX=_n(R4,{name:"JoyDrawer",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>ve({"--Drawer-transitionDuration":"0.3s","--Drawer-transitionFunction":"ease","--ModalClose-radius":"max((var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) - var(--ModalClose-inset), min(var(--ModalClose-inset) / 2, (var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) / 2))"},t.size==="sm"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(350px, 30%, 100%)","--Drawer-horizontalSize":"clamp(256px, 20%, 100%)","--Drawer-titleMargin":"0.625rem 0.75rem calc(0.625rem / 2)"},t.size==="md"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(400px, 45%, 100%)","--Drawer-horizontalSize":"clamp(300px, 30%, 100%)","--Drawer-titleMargin":"0.75rem 0.75rem calc(0.75rem / 2)"},t.size==="lg"&&{"--ModalClose-inset":"0.75rem","--Drawer-verticalSize":"clamp(500px, 60%, 100%)","--Drawer-horizontalSize":"clamp(440px, 60%, 100%)","--Drawer-titleMargin":"1rem 1rem calc(1rem / 2)"},{transitionProperty:"visibility",transitionDelay:t.open?"0s":"var(--Drawer-transitionDuration)"},!t.open&&{visibility:"hidden"})),CX=_n(L4,{name:"JoyDrawer",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})(({ownerState:t})=>({opacity:t.open?1:0,transition:"opacity var(--Drawer-transitionDuration) ease-in-out"})),EX=_n("div",{name:"JoyDrawer",slot:"Content",overridesResolver:(t,e)=>e.content})(({theme:t,ownerState:e})=>{var n;return ve({},t.typography[`body-${e.size}`],{boxShadow:t.shadow.md,backgroundColor:t.vars.palette.background.surface,outline:0,display:"flex",flexDirection:"column",position:"fixed",boxSizing:"border-box",overflow:"auto"},e.anchor==="left"&&{top:0,left:0,transform:e.open?"translateX(0)":"translateX(-100%)"},e.anchor==="right"&&{top:0,right:0,transform:e.open?"translateX(0)":"translateX(100%)"},e.anchor==="top"&&{top:0,transform:e.open?"translateY(0)":"translateY(-100%)"},e.anchor==="bottom"&&{bottom:0,transform:e.open?"translateY(0)":"translateY(100%)"},{height:e.anchor.match(/(left|right)/)?"100%":"min(100vh, var(--Drawer-verticalSize))",width:e.anchor.match(/(top|bottom)/)?"100vw":"min(100vw, var(--Drawer-horizontalSize))",transition:"transform var(--Drawer-transitionDuration) var(--Drawer-transitionFunction)"},e.variant==="solid"&&e.color&&e.invertedColors&&$_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&V_(e.color)(t),(n=t.variants[e.variant])==null?void 0:n[e.color],{[`& > .${E4.root}`]:{"--unstable_DialogTitle-margin":"var(--Drawer-titleMargin)"}})}),D4=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyDrawer"}),{children:o,anchor:l="left",container:c,disableAutoFocus:s=!1,disableEnforceFocus:m=!1,disableEscapeKeyDown:y=!1,disablePortal:b=!1,disableRestoreFocus:w=!1,disableScrollLock:E=!1,hideBackdrop:T=!1,color:R="neutral",variant:z="plain",invertedColors:I=!1,size:L="md",onClose:V,open:B,component:W,slots:X={},slotProps:q={}}=r,te=ir(r,wX),se=ve({},r,{anchor:l,disableAutoFocus:s,disableEnforceFocus:m,disableEscapeKeyDown:y,disablePortal:b,disableRestoreFocus:w,disableScrollLock:E,hideBackdrop:T,invertedColors:I,color:R,variant:z,size:L}),{getRootProps:re,getBackdropProps:$,rootRef:ce,portalRef:Ce,isTopModal:Se}=X7(ve({},se,{rootRef:n,children:null})),Xe=SX(se),Fe=ve({},te,{component:W,slots:X,slotProps:q}),Me=il(),Te=il(),Ie=H.useMemo(()=>({variant:z,color:R,labelledBy:Me,describedBy:Te}),[R,z,Me,Te]),[Ke,st]=Bn("root",{ref:ce,className:Xe.root,elementType:MX,externalForwardedProps:Fe,getSlotProps:re,ownerState:se}),[Ee,Qe]=Bn("backdrop",{className:Xe.backdrop,elementType:CX,externalForwardedProps:Fe,getSlotProps:$,ownerState:se}),[jt,je]=Bn("content",{className:Xe.content,elementType:EX,additionalProps:{tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":Me,"aria-describedby":Te},externalForwardedProps:Fe,ownerState:se});return oe.jsx(I4.Provider,{value:V,children:oe.jsx(UP.Provider,{value:L,children:oe.jsx(Iw.Provider,{value:Ie,children:oe.jsx(G5,{ref:Ce,container:c,disablePortal:b,children:oe.jsxs(Ke,ve({},st,{children:[T?null:oe.jsx(Ee,ve({},Qe)),oe.jsx(o7,{disableEnforceFocus:m,disableAutoFocus:s,disableRestoreFocus:w,isEnabled:Se,open:B,children:oe.jsx(jt,ve({},je,{children:o}))})]}))})})})})});function TX(t){return qr("MuiListDivider",t)}$r("MuiListDivider",["root","insetGutter","insetStartDecorator","insetStartContent","horizontal","vertical"]);const PX=["component","role","className","children","inset","orientation","slots","slotProps"],AX=t=>{const{orientation:e,inset:n}=t,r={root:["root",e,n&&n!=="context"&&`inset${Dn(n)}`]};return Wr(r,TX,{})},IX=_n(A4,{name:"JoyListDivider",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>ve({},t.inset==="context"&&{"--Divider-inset":"calc(-1 * var(--List-padding))"},t.row&&ve({marginInline:"var(--ListDivider-gap)"},t.inset==="gutter"&&{marginBlock:"var(--ListItem-paddingY)"},t["data-first-child"]===void 0&&{marginInlineStart:"calc(var(--List-gap) + var(--ListDivider-gap))"}),!t.row&&ve({},t["data-first-child"]===void 0&&{marginBlockStart:"calc(var(--List-gap) + var(--ListDivider-gap))"},{marginBlockEnd:"var(--ListDivider-gap)"},t.inset==="gutter"&&{marginInlineStart:"var(--ListItem-paddingLeft)",marginInlineEnd:"var(--ListItem-paddingRight)"},t.inset==="startDecorator"&&{marginInlineStart:"var(--ListItem-paddingLeft)"},t.inset==="startContent"&&{marginInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItemDecorator-size))"}))),w2=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListDivider"}),o=H.useContext(ly),l=H.useContext(zP),{component:c,role:s,className:m,children:y,inset:b="context",orientation:w,slots:E={},slotProps:T={}}=r,R=ir(r,PX),[z]=l?.split(":")||["",""],I=c||(z&&!z.match(/^(ul|ol|menu)$/)?"div":"li"),L=s||(I==="li"?"separator":void 0),V=w||(o?"vertical":"horizontal"),B=ve({},r,{inset:b,row:o,orientation:V,component:I,role:L}),W=AX(B),X=ve({},R,{component:I,slots:E,slotProps:T}),[q,te]=Bn("root",{ref:n,className:co(W.root,m),elementType:IX,externalForwardedProps:X,ownerState:B,additionalProps:ve({as:I,role:L},L==="separator"&&V==="vertical"&&{"aria-orientation":"vertical"})});return oe.jsx(q,ve({},te,{children:y}))});function RX(t){return qr("MuiListItemContent",t)}$r("MuiListItemContent",["root"]);const LX=["component","className","children","slots","slotProps"],DX=()=>Wr({root:["root"]},RX,{}),kX=_n("div",{name:"JoyListItemContent",slot:"Root",overridesResolver:(t,e)=>e.root})({flex:"1 1 auto",minWidth:0}),f_=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListItemContent"}),{component:o,className:l,children:c,slots:s={},slotProps:m={}}=r,y=ir(r,LX),b=ve({},r),w=DX(),E=ve({},y,{component:o,slots:s,slotProps:m}),[T,R]=Bn("root",{ref:n,className:co(w.root,l),elementType:kX,externalForwardedProps:E,ownerState:b});return oe.jsx(T,ve({},R,{children:c}))});function zX(t){return qr("MuiListItemDecorator",t)}$r("MuiListItemDecorator",["root"]);const OX=["component","className","children","slots","slotProps"],FX=()=>Wr({root:["root"]},zX,{}),NX=_n("span",{name:"JoyListItemDecorator",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>ve({boxSizing:"border-box",display:"inline-flex",alignItems:`var(--unstable_ListItemDecorator-alignItems, ${t.parentOrientation==="horizontal"?"center":"initial"})`},t.parentOrientation==="horizontal"?{minInlineSize:"var(--ListItemDecorator-size)",marginInlineEnd:"calc(-1 * var(--ListItem-gap))"}:{minBlockSize:"var(--ListItemDecorator-size)",justifyContent:"center",marginBlockEnd:"calc(-1 * var(--ListItem-gap))"})),Lv=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListItemDecorator"}),{component:o,className:l,children:c,slots:s={},slotProps:m={}}=r,y=ir(r,OX),b=H.useContext(OP),w=ve({parentOrientation:b},r),E=FX(),T=ve({},y,{component:o,slots:s,slotProps:m}),[R,z]=Bn("root",{ref:n,className:co(E.root,l),elementType:NX,externalForwardedProps:T,ownerState:w});return oe.jsx(R,ve({},z,{children:c}))});function BX(t){return qr("MuiMenu",t)}$r("MuiMenu",["root","listbox","expanded","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const UX=["actions","children","color","component","disablePortal","keepMounted","id","invertedColors","onItemsChange","modifiers","variant","size","slots","slotProps"],$X=t=>{const{open:e,variant:n,color:r,size:o}=t,l={root:["root",e&&"expanded",n&&`variant${Dn(n)}`,r&&`color${Dn(r)}`,o&&`size${Dn(o)}`],listbox:["listbox"]};return Wr(l,BX,{})},e3=_n(B_,{name:"JoyMenu",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const o=(n=t.variants[e.variant])==null?void 0:n[e.color];return[ve({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":o?.backgroundColor||o?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},Cw,{borderRadius:`var(--List-radius, ${t.vars.radius.sm})`,boxShadow:t.shadow.md,overflow:"auto",zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`},!(o!=null&&o.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup},e.variant==="solid"&&e.color&&e.invertedColors&&$_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&V_(e.color)(t),(r=t.variants[e.variant])==null?void 0:r[e.color])]}),k4=H.forwardRef(function(e,n){var r;const o=Xr({props:e,name:"JoyMenu"}),{actions:l,children:c,color:s="neutral",component:m,disablePortal:y=!1,keepMounted:b=!1,id:w,invertedColors:E=!1,onItemsChange:T,modifiers:R,variant:z="outlined",size:I="md",slots:L={},slotProps:V={}}=o,B=ir(o,UX),{contextValue:W,getListboxProps:X,dispatch:q,open:te,triggerElement:se}=A7({onItemsChange:T,id:w,listboxRef:n});H.useImperativeHandle(l,()=>({dispatch:q,resetHighlight:()=>q({type:Li.resetHighlight,event:null})}),[q]);const re=ve({},o,{disablePortal:y,invertedColors:E,color:s,variant:z,size:I,open:te,nesting:!1,row:!1}),$=$X(re),ce=ve({},B,{component:m,slots:L,slotProps:V}),Ce=H.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...R||[]],[R]),Se=F5({elementType:e3,getSlotProps:X,externalForwardedProps:ce,externalSlotProps:{},ownerState:re,additionalProps:{anchorEl:se,open:te&&se!==null,disablePortal:y,keepMounted:b,modifiers:Ce},className:$.root});return oe.jsx(e3,ve({},Se,!((r=o.slots)!=null&&r.root)&&{as:ww,slots:{root:m||"ul"}},{children:oe.jsx(I7,{value:W,children:oe.jsx(Pw,{variant:E?void 0:z,color:s,children:oe.jsx(Mw.Provider,{value:"menu",children:oe.jsx(N_,{nested:!0,children:c})})})})}))});function VX(t){return qr("MuiMenuButton",t)}$r("MuiMenuButton",["root","colorPrimary","colorNeutral","colorDanger","colorInfo","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]);const jX=["children","color","component","disabled","endDecorator","loading","loadingPosition","loadingIndicator","size","slotProps","slots","startDecorator","variant"],HX=t=>{const{color:e,disabled:n,fullWidth:r,size:o,variant:l,loading:c}=t,s={root:["root",n&&"disabled",r&&"fullWidth",l&&`variant${Dn(l)}`,e&&`color${Dn(e)}`,o&&`size${Dn(o)}`,c&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]};return Wr(s,VX,{})},GX=_n("button",{name:"JoyMenuButton",slot:"Root",overridesResolver:(t,e)=>e.root})(w4),WX=_n("span",{name:"JoyMenuButton",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),qX=_n("span",{name:"JoyMenuButton",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),XX=_n("span",{name:"JoyMenuButton",slot:"LoadingCenter",overridesResolver:(t,e)=>e.loadingIndicatorCenter})(({theme:t,ownerState:e})=>{var n,r;return ve({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),ZX=H.forwardRef(function(e,n){var r;const o=Xr({props:e,name:"JoyMenuButton"}),{children:l,color:c="neutral",component:s,disabled:m=!1,endDecorator:y,loading:b=!1,loadingPosition:w="center",loadingIndicator:E,size:T="md",slotProps:R={},slots:z={},startDecorator:I,variant:L="outlined"}=o,V=ir(o,jX),B=H.useContext(NP),W=e.variant||B.variant||L,X=e.size||B.size||T,q=(r=e.disabled)!=null?r:B.disabled||m||b,{getRootProps:te,open:se,active:re}=z7({rootRef:n,disabled:q}),$=E??oe.jsx(BP,{color:c,thickness:{sm:2,md:3,lg:4}[X]||3}),ce=ve({},o,{active:re,color:c,disabled:q,open:se,size:X,variant:W}),Ce=HX(ce),Se=ve({},V,{component:s,slots:z,slotProps:R}),[Xe,Fe]=Bn("root",{elementType:GX,getSlotProps:te,externalForwardedProps:Se,ref:n,ownerState:ce,className:Ce.root}),[Me,Te]=Bn("startDecorator",{className:Ce.startDecorator,elementType:WX,externalForwardedProps:Se,ownerState:ce}),[Ie,Ke]=Bn("endDecorator",{className:Ce.endDecorator,elementType:qX,externalForwardedProps:Se,ownerState:ce}),[st,Ee]=Bn("loadingIndicatorCenter",{className:Ce.loadingIndicatorCenter,elementType:XX,externalForwardedProps:Se,ownerState:ce});return oe.jsxs(Xe,ve({},Fe,{children:[(I||b&&w==="start")&&oe.jsx(Me,ve({},Te,{children:b&&w==="start"?$:I})),l,b&&w==="center"&&oe.jsx(st,ve({},Ee,{children:$})),(y||b&&w==="end")&&oe.jsx(Ie,ve({},Ke,{children:b&&w==="end"?$:y}))]}))});function YX(t){return qr("MuiMenuItem",t)}$r("MuiMenuItem",["root","focusVisible","disabled","selected","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const KX=["children","disabled","component","selected","color","orientation","variant","slots","slotProps","id"],JX=t=>{const{focusVisible:e,disabled:n,selected:r,color:o,variant:l}=t,c={root:["root",e&&"focusVisible",n&&"disabled",r&&"selected",o&&`color${Dn(o)}`,l&&`variant${Dn(l)}`]};return Wr(c,YX,{})},QX=_n(U_,{name:"JoyMenuItem",slot:"Root",overridesResolver:(t,e)=>e.root})({}),eZ=H.memo(H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyMenuItem"}),o=H.useContext(ly),{children:l,disabled:c=!1,component:s="li",selected:m=!1,color:y="neutral",orientation:b="horizontal",variant:w="plain",slots:E={},slotProps:T={},id:R}=r,z=ir(r,KX),{variant:I=w,color:L=y}=Tw(e.variant,e.color),{getRootProps:V,disabled:B,focusVisible:W}=N7({id:R,disabled:c,rootRef:n}),X=ve({},r,{component:s,color:L,disabled:B,focusVisible:W,orientation:b,selected:m,row:o,variant:I}),q=JX(X),te=ve({},z,{component:s,slots:E,slotProps:T}),[se,re]=Bn("root",{ref:n,elementType:QX,getSlotProps:V,externalForwardedProps:te,className:q.root,ownerState:X});return oe.jsx(OP.Provider,{value:b,children:oe.jsx(se,ve({},re,{children:l}))})})),Im=H.forwardRef(function(e,n){const{contextValue:r,id:o}=B7(e.id);return oe.jsx(pp.Provider,{value:r,children:oe.jsx(eZ,ve({},e,{id:o,ref:n}))})});function tZ(t){return qr("MuiModalClose",t)}$r("MuiModalClose",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);var t3;const nZ=["component","color","variant","size","onClick","slots","slotProps"],rZ=t=>{const{variant:e,color:n,disabled:r,focusVisible:o,size:l}=t,c={root:["root",r&&"disabled",o&&"focusVisible",e&&`variant${Dn(e)}`,n&&`color${Dn(n)}`,l&&`size${Dn(l)}`]};return Wr(c,tZ,{})},iZ=_n(j_,{name:"JoyModalClose",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n;return ve({},t.size==="sm"&&{"--IconButton-size":"1.75rem"},t.size==="md"&&{"--IconButton-size":"2rem"},t.size==="lg"&&{"--IconButton-size":"2.25rem"},{position:"absolute",zIndex:1,top:"var(--ModalClose-inset, 0.625rem)",right:"var(--ModalClose-inset, 0.625rem)",borderRadius:`var(--ModalClose-radius, ${e.vars.radius.sm})`},!((n=e.variants[t.variant])!=null&&(n=n[t.color])!=null&&n.backgroundColor)&&{color:e.vars.palette.text.secondary})}),oZ={plain:"plain",outlined:"plain",soft:"soft",solid:"solid"},z4=H.forwardRef(function(e,n){var r,o,l,c,s,m;const y=Xr({props:e,name:"JoyModalClose"}),{component:b="button",color:w="neutral",variant:E="plain",size:T="md",onClick:R,slots:z={},slotProps:I={}}=y,L=ir(y,nZ),V=H.useContext(I4),B=H.useContext(Iw),W=(r=(o=e.variant)!=null?o:oZ[B?.variant])!=null?r:E,X=(l=(c=e.color)!=null?c:B?.color)!=null?l:w,q=H.useContext(UP),te=(s=(m=e.size)!=null?m:q)!=null?s:T,{focusVisible:se,getRootProps:re}=Lh(ve({},y,{rootRef:n})),$=ve({},y,{color:X,component:b,variant:W,size:te,focusVisible:se}),ce=rZ($),[Ce,Se]=Bn("root",{ref:n,elementType:iZ,getSlotProps:re,externalForwardedProps:ve({onClick:Xe=>{V?.(Xe,"closeClick"),R?.(Xe)}},L,{component:b,slots:z,slotProps:I}),className:ce.root,ownerState:$});return oe.jsx(Ce,ve({},Se,{children:t3||(t3=oe.jsx(l4,{}))}))});function sZ(t){return qr("MuiOption",t)}const aZ=$r("MuiOption",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","highlighted","variantPlain","variantSoft","variantOutlined","variantSolid"]),lZ=["component","children","disabled","value","label","variant","color","slots","slotProps"],cZ=t=>{const{disabled:e,highlighted:n,selected:r}=t;return Wr({root:["root",e&&"disabled",n&&"highlighted",r&&"selected"]},sZ,{})},uZ=_n(U_,{name:"JoyOption",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[`${e.variant}Hover`])==null?void 0:n[e.color];return{[`&.${aZ.highlighted}:not([aria-selected="true"])`]:{backgroundColor:r?.backgroundColor}}}),hZ=H.memo(H.forwardRef(function(e,n){var r;const o=Xr({props:e,name:"JoyOption"}),{component:l="li",children:c,disabled:s=!1,value:m,label:y,variant:b="plain",color:w="neutral",slots:E={},slotProps:T={}}=o,R=ir(o,lZ),z=H.useContext(ly),{variant:I=b,color:L=w}=Tw(e.variant,e.color),V=H.useRef(null),B=bi(V,n),W=y??(typeof c=="string"?c:(r=V.current)==null?void 0:r.innerText),{getRootProps:X,selected:q,highlighted:te,index:se}=Z7({disabled:s,label:W,value:m,rootRef:B}),re=ve({},o,{disabled:s,selected:q,highlighted:te,index:se,component:l,variant:I,color:L,row:z}),$=cZ(re),ce=ve({},R,{component:l,slots:E,slotProps:T}),[Ce,Se]=Bn("root",{ref:n,getSlotProps:X,elementType:uZ,externalForwardedProps:ce,className:$.root,ownerState:re});return oe.jsx(Ce,ve({},Se,{children:c}))})),dZ=H.forwardRef(function(e,n){const{contextValue:r}=Y7(e.value);return oe.jsx(pp.Provider,{value:r,children:oe.jsx(hZ,ve({},e,{ref:n}))})}),fZ=Xm(oe.jsx("path",{d:"m12 5.83 2.46 2.46c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 3.7a.9959.9959 0 0 0-1.41 0L8.12 6.88c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 5.83zm0 12.34-2.46-2.46a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l3.17 3.18c.39.39 1.02.39 1.41 0l3.17-3.17c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L12 18.17z"}),"Unfold");function pZ(t){return qr("MuiSelect",t)}const Dv=$r("MuiSelect",["root","button","indicator","startDecorator","endDecorator","popper","listbox","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","focusVisible","disabled","expanded","multiple"]);var n3;const mZ=["action","autoFocus","children","defaultValue","defaultListboxOpen","disabled","getSerializedValue","placeholder","listboxId","listboxOpen","onChange","onListboxOpenChange","onClose","renderValue","required","value","size","variant","color","startDecorator","endDecorator","indicator","aria-describedby","aria-label","aria-labelledby","id","name","multiple","slots","slotProps"];function gZ(t){var e;return Array.isArray(t)?oe.jsx(H.Fragment,{children:t.map(n=>n.label).join(", ")}):(e=t?.label)!=null?e:""}const vZ=[{name:"offset",options:{offset:[0,4]}},{name:"equalWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`}}],yZ=t=>{const{color:e,disabled:n,focusVisible:r,size:o,variant:l,open:c,multiple:s}=t,m={root:["root",n&&"disabled",r&&"focusVisible",c&&"expanded",l&&`variant${Dn(l)}`,e&&`color${Dn(e)}`,o&&`size${Dn(o)}`,s&&"multiple"],button:["button"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],indicator:["indicator",c&&"expanded"],listbox:["listbox",c&&"expanded",n&&"disabled"]};return Wr(m,pZ,{})},_Z=_n("div",{name:"JoySelect",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,o,l,c;const s=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color],{borderRadius:m}=qm({theme:t,ownerState:e},["borderRadius"]);return[ve({"--Select-radius":t.vars.radius.sm,"--Select-gap":"0.5rem","--Select-placeholderOpacity":.64,"--Select-decoratorColor":t.vars.palette.text.icon,"--Select-focusedThickness":t.vars.focus.thickness,"--Select-focusedHighlight":(r=t.vars.palette[e.color==="neutral"?"primary":e.color])==null?void 0:r[500],'&:not([data-inverted-colors="false"])':ve({},e.instanceColor&&{"--_Select-focusedHighlight":(o=t.vars.palette[e.instanceColor==="neutral"?"primary":e.instanceColor])==null?void 0:o[500]},{"--Select-focusedHighlight":t.vars.palette.focusVisible}),"--Select-indicatorColor":s!=null&&s.backgroundColor?s?.color:t.vars.palette.text.tertiary},e.size==="sm"&&{"--Select-minHeight":"2rem","--Select-paddingInline":"0.5rem","--Select-decoratorChildHeight":"min(1.5rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl},e.size==="md"&&{"--Select-minHeight":"2.25rem","--Select-paddingInline":"0.75rem","--Select-decoratorChildHeight":"min(1.75rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},e.size==="lg"&&{"--Select-minHeight":"2.75rem","--Select-paddingInline":"1rem","--Select-decoratorChildHeight":"min(2.375rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},{"--Select-decoratorChildOffset":"min(calc(var(--Select-paddingInline) - (var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2), var(--Select-paddingInline))","--_Select-paddingBlock":"max((var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2, 0px)","--Select-decoratorChildRadius":"max(var(--Select-radius) - var(--variant-borderWidth, 0px) - var(--_Select-paddingBlock), min(var(--_Select-paddingBlock) + var(--variant-borderWidth, 0px), var(--Select-radius) / 2))","--Button-minHeight":"var(--Select-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Select-decoratorChildHeight)","--Button-radius":"var(--Select-decoratorChildRadius)","--IconButton-radius":"var(--Select-decoratorChildRadius)",boxSizing:"border-box"},e.variant!=="plain"&&{boxShadow:t.shadow.xs},{minWidth:0,minHeight:"var(--Select-minHeight)",position:"relative",display:"flex",alignItems:"center",borderRadius:"var(--Select-radius)",cursor:"pointer"},!(s!=null&&s.backgroundColor)&&{backgroundColor:t.vars.palette.background.surface},e.size&&{paddingBlock:{sm:2,md:3,lg:4}[e.size]},{paddingInline:"var(--Select-paddingInline)"},t.typography[`body-${e.size}`],s,{"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)"},[`&.${Dv.focusVisible}`]:{"--Select-indicatorColor":s?.color,"&::before":{boxShadow:"inset 0 0 0 var(--Select-focusedThickness) var(--Select-focusedHighlight)"}},[`&.${Dv.disabled}`]:{"--Select-indicatorColor":"inherit"}}),{"&:hover":(l=t.variants[`${e.variant}Hover`])==null?void 0:l[e.color],[`&.${Dv.disabled}`]:(c=t.variants[`${e.variant}Disabled`])==null?void 0:c[e.color]},m!==void 0&&{"--Select-radius":m}]}),xZ=_n("button",{name:"JoySelect",slot:"Button",overridesResolver:(t,e)=>e.button})(({ownerState:t})=>ve({border:0,outline:0,background:"none",padding:0,fontSize:"inherit",color:"inherit",alignSelf:"stretch",display:"flex",alignItems:"center",flex:1,fontFamily:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden"},(t.value===null||t.value===void 0)&&{opacity:"var(--Select-placeholderOpacity)"},{"&::before":{content:'""',display:"block",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",borderRadius:"var(--Select-radius)"}})),bZ=_n(B_,{name:"JoySelect",slot:"Listbox",overridesResolver:(t,e)=>e.listbox})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return ve({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":r?.backgroundColor||r?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},Cw,{minWidth:"max-content",maxHeight:"44vh",overflow:"auto",outline:0,boxShadow:t.shadow.md,borderRadius:`var(--List-radius, ${t.vars.radius.sm})`,zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup})}),wZ=_n("span",{name:"JoySelect",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Button-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Select-paddingInline) / -4)",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineEnd:"var(--Select-gap)"}),SZ=_n("span",{name:"JoySelect",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Button-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Select-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineStart:"var(--Select-gap)"}),MZ=_n("span",{name:"JoySelect",slot:"Indicator"})(({ownerState:t,theme:e})=>ve({},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.lg},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.xl},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl2},{"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,display:"inherit",alignItems:"center",marginInlineStart:"var(--Select-gap)",marginInlineEnd:"calc(var(--Select-paddingInline) / -4)",[`.${Dv.endDecorator} + &`]:{marginInlineStart:"calc(var(--Select-gap) / 2)"},[`&.${Dv.expanded}, .${Dv.disabled} > &`]:{"--Icon-color":"currentColor"}})),CZ=H.forwardRef(function(e,n){var r,o,l,c,s,m,y;const b=Xr({props:e,name:"JoySelect"}),w=b,{action:E,autoFocus:T,children:R,defaultValue:z,defaultListboxOpen:I=!1,disabled:L,getSerializedValue:V,placeholder:B,listboxId:W,listboxOpen:X,onChange:q,onListboxOpenChange:te,onClose:se,renderValue:re,required:$=!1,value:ce,size:Ce="md",variant:Se="outlined",color:Xe="neutral",startDecorator:Fe,endDecorator:Me,indicator:Te=n3||(n3=oe.jsx(fZ,{})),"aria-describedby":Ie,"aria-label":Ke,"aria-labelledby":st,id:Ee,name:Qe,multiple:jt=!1,slots:je={},slotProps:ft={}}=w,At=ir(w,mZ),ht=H.useContext(Aw),lt=(r=(o=e.disabled)!=null?o:ht?.disabled)!=null?r:L,bt=(l=(c=e.size)!=null?c:ht?.size)!=null?l:Ce,St=(s=e.color)!=null?s:ht!=null&&ht.error?"danger":(m=ht?.color)!=null?m:Xe,dn=re??gZ,[En,un]=H.useState(null),et=H.useRef(null),Ln=H.useRef(null),Jt=bi(n,et);H.useImperativeHandle(E,()=>({focusVisible:()=>{var Ut;(Ut=Ln.current)==null||Ut.focus()}}),[]),H.useEffect(()=>{un(et.current)},[]),H.useEffect(()=>{T&&Ln.current.focus()},[T]);const fn=H.useCallback(Ut=>{te?.(Ut),Ut||se?.()},[se,te]),{buttonActive:$t,buttonFocusVisible:Nn,contextValue:vn,disabled:Ue,getButtonProps:we,getListboxProps:yt,getHiddenInputProps:Nt,getOptionMetadata:Ht,open:Ot,value:ln}=mG({buttonRef:Ln,defaultOpen:I,defaultValue:z,disabled:lt,getSerializedValue:V,listboxId:W,multiple:jt,name:Qe,required:$,onChange:q,onOpenChange:fn,open:X,value:ce}),Gt=ve({},b,{active:$t,defaultListboxOpen:I,disabled:Ue,focusVisible:Nn,open:Ot,renderValue:dn,value:ln,size:bt,variant:Se,color:St}),Zt=yZ(Gt),Fn=ve({},At,{slots:je,slotProps:ft}),Yt=H.useMemo(()=>{let Ut;if(jt)Ut=ln.map(Re=>Ht(Re)).filter(Re=>Re!==void 0);else{var Kt;Ut=(Kt=Ht(ln))!=null?Kt:null}return Ut},[Ht,ln,jt]),[Pe,ae]=Bn("root",{ref:Jt,className:Zt.root,elementType:_Z,externalForwardedProps:Fn,ownerState:Gt}),[ue,ee]=Bn("button",{additionalProps:{"aria-describedby":Ie??ht?.["aria-describedby"],"aria-label":Ke,"aria-labelledby":st??ht?.labelId,"aria-required":$?"true":void 0,id:Ee??ht?.htmlFor,name:Qe},className:Zt.button,elementType:xZ,externalForwardedProps:Fn,getSlotProps:we,ownerState:Gt}),[fe,Oe]=Bn("listbox",{additionalProps:{anchorEl:En,open:Ot,placement:"bottom",keepMounted:!0},className:Zt.listbox,elementType:bZ,externalForwardedProps:Fn,getSlotProps:yt,ownerState:ve({},Gt,{nesting:!1,row:!1,wrap:!1}),getSlotOwnerState:Ut=>({size:Ut.size||bt,variant:Ut.variant||Se,color:Ut.color||(Ut.disablePortal?St:Xe),disableColorInversion:!Ut.disablePortal})}),[Ye,ye]=Bn("startDecorator",{className:Zt.startDecorator,elementType:wZ,externalForwardedProps:Fn,ownerState:Gt}),[Ae,Be]=Bn("endDecorator",{className:Zt.endDecorator,elementType:SZ,externalForwardedProps:Fn,ownerState:Gt}),[$e,He]=Bn("indicator",{className:Zt.indicator,elementType:MZ,externalForwardedProps:Fn,ownerState:Gt}),ut=H.useMemo(()=>[...vZ,...Oe.modifiers||[]],[Oe.modifiers]);let We=B;return(Array.isArray(Yt)&&Yt.length>0||!Array.isArray(Yt)&&Yt)&&(We=dn(Yt)),oe.jsxs(H.Fragment,{children:[oe.jsxs(Pe,ve({},ae,{children:[Fe&&oe.jsx(Ye,ve({},ye,{children:Fe})),oe.jsx(ue,ve({},ee,{children:We})),Me&&oe.jsx(Ae,ve({},Be,{children:Me})),Te&&oe.jsx($e,ve({},He,{children:Te})),oe.jsx("input",ve({},Nt()))]})),En&&oe.jsx(fe,ve({},Oe,{className:co(Oe.className),modifiers:ut},!((y=b.slots)!=null&&y.listbox)&&{as:ww,slots:{root:Oe.as||"ul"}},{children:oe.jsx(gG,{value:vn,children:oe.jsx(Pw,{variant:Se,color:Xe,children:oe.jsx(Mw.Provider,{value:"select",children:oe.jsx(N_,{nested:!0,children:R})})})})}))]})});function EZ(t){return qr("MuiSheet",t)}$r("MuiSheet",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const TZ=["className","color","component","variant","invertedColors","slots","slotProps"],PZ=t=>{const{variant:e,color:n}=t,r={root:["root",e&&`variant${Dn(e)}`,n&&`color${Dn(n)}`]};return Wr(r,EZ,{})},AZ=_n("div",{name:"JoySheet",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const o=(n=t.variants[e.variant])==null?void 0:n[e.color],{borderRadius:l,bgcolor:c,backgroundColor:s,background:m}=qm({theme:t,ownerState:e},["borderRadius","bgcolor","backgroundColor","background"]),y=rp(t,`palette.${c}`)||c||rp(t,`palette.${s}`)||s||m||o?.backgroundColor||o?.background||t.vars.palette.background.surface;return[ve({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,"--ListItem-stickyBackground":y==="transparent"?"initial":y,"--Sheet-background":y==="transparent"?"initial":y},l!==void 0&&{"--List-radius":`calc(${l} - var(--variant-borderWidth, 0px))`,"--unstable_actionRadius":`calc(${l} - var(--variant-borderWidth, 0px))`},{backgroundColor:t.vars.palette.background.surface,position:"relative"}),ve({},t.typography["body-md"],e.variant==="solid"&&e.color&&e.invertedColors&&$_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&V_(e.color)(t),(r=t.variants[e.variant])==null?void 0:r[e.color],o)]}),O4=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoySheet"}),{className:o,color:l="neutral",component:c="div",variant:s="plain",invertedColors:m=!1,slots:y={},slotProps:b={}}=r,w=ir(r,TZ),E=ve({},r,{color:l,component:c,invertedColors:m,variant:s}),T=PZ(E),R=ve({},w,{component:c,slots:y,slotProps:b}),[z,I]=Bn("root",{ref:n,className:co(T.root,o),elementType:AZ,externalForwardedProps:R,ownerState:E});return oe.jsx(z,ve({},I))});function IZ(t){return qr("MuiSnackbar",t)}$r("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","endDecorator","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantOutlined","variantSoft","variantSolid"]);const RZ=["anchorOrigin","animationDuration","autoHideDuration","color","children","className","component","disableWindowBlurListener","endDecorator","invertedColors","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","onUnmount","open","resumeHideDuration","size","slots","slotProps","startDecorator","variant"];let F4=t=>t,r3,i3;const LZ=t=>{const{variant:e,color:n,size:r,anchorOrigin:o}=t,l={root:["root",r&&`size${Dn(r)}`,n&&`color${Dn(n)}`,e&&`variant${Dn(e)}`,`anchorOrigin${Dn(o.vertical)}${Dn(o.horizontal)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Wr(l,IZ,{})},DZ=aP(r3||(r3=F4`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
  }
`)),kZ=aP(i3||(i3=F4`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
`)),zZ=_n("div",{name:"JoySnackbar",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,o,l,c,s,m;const{p:y,padding:b,borderRadius:w}=qm({theme:t,ownerState:e},["p","padding","borderRadius"]);return[ve({"--Snackbar-radius":t.vars.radius.sm,"--Snackbar-decoratorChildRadius":"max((var(--Snackbar-radius) - var(--variant-borderWidth, 0px)) - var(--Snackbar-padding), min(var(--Snackbar-padding) + var(--variant-borderWidth, 0px), var(--Snackbar-radius) / 2))","--Button-minHeight":"var(--Snackbar-decoratorChildHeight)","--IconButton-size":"var(--Snackbar-decoratorChildHeight)","--Button-radius":"var(--Snackbar-decoratorChildRadius)","--IconButton-radius":"var(--Snackbar-decoratorChildRadius)","--Icon-color":"currentColor"},e.size==="sm"&&{"--Snackbar-padding":"0.75rem","--Snackbar-inset":"0.5rem","--Snackbar-decoratorChildHeight":"1.5rem","--Icon-fontSize":t.vars.fontSize.xl,gap:"0.5rem"},e.size==="md"&&{"--Snackbar-padding":"1rem","--Snackbar-inset":"0.75rem","--Snackbar-decoratorChildHeight":"2rem","--Icon-fontSize":t.vars.fontSize.xl,gap:"0.625rem"},e.size==="lg"&&{"--Snackbar-padding":"1.25rem","--Snackbar-inset":"1rem","--Snackbar-decoratorChildHeight":"2.375rem","--Icon-fontSize":t.vars.fontSize.xl2,gap:"0.875rem"},{zIndex:t.vars.zIndex.snackbar,position:"fixed",display:"flex",alignItems:"center",minWidth:300,top:((n=e.anchorOrigin)==null?void 0:n.vertical)==="top"?"var(--Snackbar-inset)":void 0,left:((r=e.anchorOrigin)==null?void 0:r.horizontal)==="left"?"var(--Snackbar-inset)":void 0,bottom:((o=e.anchorOrigin)==null?void 0:o.vertical)==="bottom"?"var(--Snackbar-inset)":void 0,right:((l=e.anchorOrigin)==null?void 0:l.horizontal)==="right"?"var(--Snackbar-inset)":void 0},((c=e.anchorOrigin)==null?void 0:c.horizontal)==="center"&&{"--Snackbar-translateX":"-50%",left:"50%",transform:"translateX(var(--Snackbar-translateX))"},((s=e.anchorOrigin)==null?void 0:s.vertical)==="top"&&{"--_Snackbar-anchorBottom":"-1"},{animation:`${DZ} ${e.animationDuration}ms forwards`},!e.open&&{animationName:kZ},{boxShadow:t.vars.shadow.lg,backgroundColor:t.vars.palette.background.surface,padding:"var(--Snackbar-padding)",borderRadius:"var(--Snackbar-radius)"},t.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],e.variant==="solid"&&e.color&&e.invertedColors&&$_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&V_(e.color)(t),(m=t.variants[e.variant])==null?void 0:m[e.color]),y!==void 0&&{"--Snackbar-padding":y},b!==void 0&&{"--Snackbar-padding":b},w!==void 0&&{"--Snackbar-radius":w}]}),OZ=_n("span",{name:"JoySnackbar",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({display:"inherit",flex:"none"}),FZ=_n("span",{name:"JoySnackbar",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({display:"inherit",flex:"none",marginLeft:"auto"}),NZ={vertical:"bottom",horizontal:"right"},N4=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoySnackbar"}),{anchorOrigin:o=NZ,animationDuration:l=300,autoHideDuration:c=null,color:s="neutral",children:m,className:y,component:b,disableWindowBlurListener:w=!1,endDecorator:E,invertedColors:T=!1,onUnmount:R,open:z,size:I="md",slots:L={},slotProps:V,startDecorator:B,variant:W="outlined"}=r,X=ir(r,RZ),[q,te]=H.useState(!0),[se,re]=H.useState(!1),$=H.useRef(R);$.current=R,H.useEffect(()=>{if(z)re(!1),te(!1);else{re(!0);const je=setTimeout(()=>{var ft;te(!0),re(!1),(ft=$.current)==null||ft.call($)},l);return()=>{clearTimeout(je)}}},[z,l]);const ce=ve({},r,{anchorOrigin:o,autoHideDuration:c,color:s,animationDuration:l,disableWindowBlurListener:w,invertedColors:T,size:I,variant:W});delete ce.onUnmount;const Ce=LZ(ce),{getRootProps:Se,onClickAway:Xe}=vG(ce),Fe=je=>{se||Xe(je)},Me=ve({},X,{component:b,slots:L,slotProps:V}),[Te,Ie]=Bn("root",{ref:n,className:co(Ce.root,y),elementType:zZ,externalForwardedProps:Me,getSlotProps:Se,ownerState:ce}),[Ke,st]=Bn("startDecorator",{className:Ce.startDecorator,elementType:OZ,externalForwardedProps:Me,ownerState:ce}),[Ee,Qe]=Bn("endDecorator",{className:Ce.endDecorator,elementType:FZ,externalForwardedProps:Me,ownerState:ce}),jt=L.clickAway||q9;return!z&&q?null:oe.jsx(jt,ve({onClickAway:Fe},typeof V?.clickAway=="function"?V.clickAway(ce):V?.clickAway,{children:oe.jsxs(Te,ve({},Ie,{children:[B&&oe.jsx(Ke,ve({},st,{children:B})),m,E&&oe.jsx(Ee,ve({},Qe,{children:E}))]}))}))}),Ya=I9({createStyledComponent:_n("div",{name:"JoyStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>Xr({props:t,name:"JoyStack"})});function BZ(t){return qr("MuiTab",t)}const UZ=$r("MuiTab",["root","disabled","focusVisible","selected","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),$Z=["action","children","value","disabled","onChange","onClick","onFocus","component","orientation","variant","color","disableIndicator","indicatorPlacement","indicatorInset","slots","slotProps"],VZ=t=>{const{selected:e,disabled:n,focusVisible:r,variant:o,color:l,orientation:c}=t,s={root:["root",c,n&&"disabled",r&&"focusVisible",e&&"selected",o&&`variant${Dn(o)}`,l&&`color${Dn(l)}`]};return Wr(s,BZ,{})},jZ=_n(U_,{name:"JoyTab",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>[{flex:"initial",justifyContent:t.row?"center":"initial","--unstable_ListItemDecorator-alignItems":"center","--unstable_offset":"min(calc(-1 * var(--variant-borderWidth, 0px)), -1px)"},!t.disableIndicator&&{'&[aria-selected="true"]':{"--Tab-indicatorColor":"currentColor",zIndex:1},"&::after":{content:'""',display:"block",position:"absolute",margin:"auto",background:"var(--Tab-indicatorColor)",borderRadius:"var(--Tab-indicatorRadius)"}},!t.disableIndicator&&t.indicatorPlacement==="bottom"&&{paddingBottom:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:t.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:t.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",bottom:"calc(-1px - var(--unstable_TabList-underlineBottom, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="top"&&{paddingTop:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:t.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:t.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",top:"calc(-1px - var(--unstable_TabList-underlineTop, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="right"&&{paddingRight:"calc(var(--ListItem-paddingRight) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",right:"calc(-1px - var(--unstable_TabList-underlineRight, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="left"&&{paddingLeft:"calc(var(--ListItem-paddingLeft) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",left:"calc(-1px - var(--unstable_TabList-underlineLeft, 0px))"}}]),KS=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyTab"}),o=H.useContext(ly),{action:l,children:c,disabled:s=!1,component:m="button",orientation:y="horizontal",variant:b="plain",color:w="neutral",disableIndicator:E=!1,indicatorPlacement:T=o?"bottom":"right",indicatorInset:R=!1,slots:z={},slotProps:I={}}=r,L=ir(r,$Z),V=H.useRef(null),B=bi(V,n),{active:W,focusVisible:X,setFocusVisible:q,selected:te,getRootProps:se}=TG(ve({},r,{rootRef:B}));H.useImperativeHandle(l,()=>({focusVisible:()=>{q(!0),V.current.focus()}}),[q]);const re=ve({},r,{disableIndicator:E,indicatorPlacement:T,indicatorInset:R,orientation:y,row:o,active:W,focusVisible:X,disabled:s,selected:te,variant:b,color:w}),$=VZ(re),ce=ve({},L,{component:m,slots:z,slotProps:I}),[Ce,Se]=Bn("root",{ref:n,elementType:jZ,getSlotProps:se,externalForwardedProps:ce,ownerState:re,className:$.root});return oe.jsx(OP.Provider,{value:y,children:oe.jsx(Ce,ve({},Se,{children:c}))})}),$P=H.createContext("md");function HZ(t){return qr("MuiTabList",t)}$r("MuiTabList",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const GZ=["component","children","variant","color","size","disableUnderline","underlinePlacement","tabFlex","sticky","slots","slotProps"],WZ=t=>{const{orientation:e,size:n,variant:r,color:o}=t,l={root:["root",e,r&&`variant${Dn(r)}`,o&&`color${Dn(o)}`,n&&`size${Dn(n)}`]};return Wr(l,HZ,{})},qZ=_n(B_,{name:"JoyTabList",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return ve({"--List-gap":"0px","--ListDivider-gap":"0px","--ListItem-paddingX":"var(--Tabs-spacing)","--ListItem-gap":"0.375rem","--unstable_TabList-hasUnderline":e.disableUnderline?"var(--unknown,)":"initial"},Cw,{flexGrow:"initial",flexDirection:e.orientation==="vertical"?"column":"row",borderRadius:"var(--List-radius, 0px)",padding:"var(--List-padding, 0px)",zIndex:1},e.sticky&&{position:"sticky",top:e.sticky==="top"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",bottom:e.sticky==="bottom"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",backgroundColor:r?.backgroundColor||`var(--TabList-stickyBackground, ${t.vars.palette.background.body})`},!e.disableUnderline&&ve({},e.underlinePlacement==="bottom"&&{"--unstable_TabList-underlineBottom":"1px",paddingBottom:1,boxShadow:`inset 0 -1px ${t.vars.palette.divider}`},e.underlinePlacement==="top"&&{"--unstable_TabList-underlineTop":"1px",paddingTop:1,boxShadow:`inset 0 1px ${t.vars.palette.divider}`},e.underlinePlacement==="right"&&{"--unstable_TabList-underlineRight":"1px",paddingRight:1,boxShadow:`inset -1px 0 ${t.vars.palette.divider}`},e.underlinePlacement==="left"&&{"--unstable_TabList-underlineLeft":"1px",paddingLeft:1,boxShadow:`inset 1px 0 ${t.vars.palette.divider}`}),e.tabFlex&&{[`& .${UZ.root}`]:{flex:e.tabFlex}})}),XZ=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyTabList"}),o=H.useContext($P),{isRtl:l,orientation:c,getRootProps:s,contextValue:m}=MG({rootRef:n}),{component:y="div",children:b,variant:w="plain",color:E="neutral",size:T,disableUnderline:R=!1,underlinePlacement:z=c==="horizontal"?"bottom":"right",tabFlex:I,sticky:L,slots:V={},slotProps:B={}}=r,W=ir(r,GZ),q=ve({},r,{isRtl:l,orientation:c,variant:w,color:E,size:T??o,sticky:L,tabFlex:I,nesting:!1,disableUnderline:R,underlinePlacement:z}),te=WZ(q),se=ve({},W,{component:y,slots:V,slotProps:B}),[re,$]=Bn("root",{ref:n,elementType:qZ,getSlotProps:s,externalForwardedProps:se,ownerState:q,className:te.root});return oe.jsx(re,ve({},$,{children:oe.jsx(CG,{value:m,children:oe.jsx(N_,{row:c==="horizontal",nested:!0,children:b})})}))});function ZZ(t){return qr("MuiTabPanel",t)}$r("MuiTabPanel",["root","hidden","sizeSm","sizeMd","sizeLg","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const YZ=["children","value","component","color","variant","size","slots","slotProps","keepMounted"],KZ=t=>{const{hidden:e,size:n,variant:r,color:o,orientation:l}=t,c={root:["root",e&&"hidden",n&&`size${Dn(n)}`,l,r&&`variant${Dn(r)}`,o&&`color${Dn(o)}`,n&&`size${Dn(n)}`]};return Wr(c,ZZ,{})},JZ=_n("div",{name:"JoyTabPanel",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return ve({display:e.hidden?"none":"block",padding:"var(--Tabs-spacing)",flexGrow:1,fontFamily:t.vars.fontFamily.body},t.typography[`body-${e.size}`],(n=t.variants[e.variant])==null?void 0:n[e.color])}),JS=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyTabPanel"}),{orientation:o}=Sw()||{orientation:"horizontal"},l=H.useContext($P),{children:c,value:s=0,component:m,color:y="neutral",variant:b="plain",size:w,slots:E={},slotProps:T={},keepMounted:R=!1}=r,z=ir(r,YZ),{hidden:I,getRootProps:L}=wG(ve({},r,{value:s})),B=ve({},r,{orientation:o,hidden:I,size:w??l,color:y,variant:b}),W=KZ(B),X=ve({},z,{component:m,slots:E,slotProps:T}),[q,te]=Bn("root",{ref:n,elementType:JZ,getSlotProps:L,externalForwardedProps:X,additionalProps:{role:"tabpanel",ref:n,as:m},ownerState:B,className:W.root});return R?oe.jsx(q,ve({},te,{children:c})):oe.jsx(q,ve({},te,{children:!I&&c}))});function QZ(t){return qr("MuiTabs",t)}$r("MuiTabs",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const eY=["children","value","defaultValue","orientation","direction","component","onChange","selectionFollowsFocus","variant","color","size","slots","slotProps"],tY=t=>{const{orientation:e,variant:n,color:r,size:o}=t,l={root:["root",e,n&&`variant${Dn(n)}`,r&&`color${Dn(r)}`,o&&`size${Dn(o)}`]};return Wr(l,QZ,{})},nY=_n("div",{name:"JoyTabs",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r;const o=(n=e.variants[t.variant])==null?void 0:n[t.color],{bgcolor:l,backgroundColor:c,background:s,p:m,padding:y}=qm({theme:e,ownerState:t},["bgcolor","backgroundColor","background","p","padding"]),b=rp(e,`palette.${l}`)||l||rp(e,`palette.${c}`)||c||s||o?.backgroundColor||o?.background||e.vars.palette.background.surface;return ve({},t.size==="sm"&&{"--Tabs-spacing":"0.75rem"},t.size==="md"&&{"--Tabs-spacing":"1rem"},t.size==="lg"&&{"--Tabs-spacing":"1.25rem"},{"--Tab-indicatorThickness":"2px","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--TabList-stickyBackground":b==="transparent"?"initial":b,display:"flex",flexDirection:"column"},t.orientation==="vertical"&&{flexDirection:"row"},{backgroundColor:e.vars.palette.background.surface,position:"relative"},e.typography[`body-${t.size}`],(r=e.variants[t.variant])==null?void 0:r[t.color],m!==void 0&&{"--Tabs-padding":m},y!==void 0&&{"--Tabs-padding":y})}),o3=H.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyTabs"}),{children:o,value:l,defaultValue:c,orientation:s="horizontal",direction:m="ltr",component:y,variant:b="plain",color:w="neutral",size:E="md",slots:T={},slotProps:R={}}=r,z=ir(r,eY),I=c||(l===void 0?0:void 0),{contextValue:L}=_G(ve({},r,{orientation:s,defaultValue:I})),V=ve({},r,{orientation:s,direction:m,variant:b,color:w,size:E}),B=tY(V),W=ve({},z,{component:y,slots:T,slotProps:R}),[X,q]=Bn("root",{ref:n,elementType:nY,externalForwardedProps:W,additionalProps:{ref:n,as:y},ownerState:V,className:B.root});return oe.jsx(X,ve({},q,{children:oe.jsx(xG,{value:L,children:oe.jsx($P.Provider,{value:E,children:o})})}))});function rY(t){return qr("MuiTooltip",t)}$r("MuiTooltip",["root","tooltipArrow","arrow","touch","placementLeft","placementRight","placementTop","placementBottom","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);const iY=["children","className","component","arrow","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","disablePortal","direction","keepMounted","modifiers","placement","title","color","variant","size","slots","slotProps"],oY=t=>{const{arrow:e,variant:n,color:r,size:o,placement:l,touch:c}=t,s={root:["root",e&&"tooltipArrow",c&&"touch",o&&`size${Dn(o)}`,r&&`color${Dn(r)}`,n&&`variant${Dn(n)}`,`tooltipPlacement${Dn(l.split("-")[0])}`],arrow:["arrow"]};return Wr(s,rY,{})},sY=_n("div",{name:"JoyTooltip",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,o;const l=(n=e.variants[t.variant])==null?void 0:n[t.color];return ve({},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.md,"--Tooltip-arrowSize":"8px",padding:e.spacing(.25,.625)},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.lg,"--Tooltip-arrowSize":"10px",padding:e.spacing(.5,.75)},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl,"--Tooltip-arrowSize":"12px",padding:e.spacing(.75,1)},{zIndex:e.vars.zIndex.tooltip,borderRadius:e.vars.radius.sm,boxShadow:e.shadow.sm,wordWrap:"break-word",position:"relative"},t.disableInteractive&&{pointerEvents:"none"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],l,!l.backgroundColor&&{backgroundColor:e.vars.palette.background.surface},{"&::before":{content:'""',display:"block",position:"absolute",width:(r=t.placement)!=null&&r.match(/(top|bottom)/)?"100%":"calc(10px + var(--variant-borderWidth, 0px))",height:(o=t.placement)!=null&&o.match(/(top|bottom)/)?"calc(10px + var(--variant-borderWidth, 0px))":"100%"},'&[data-popper-placement*="bottom"]::before':{top:0,left:0,transform:"translateY(-100%)"},'&[data-popper-placement*="left"]::before':{top:0,right:0,transform:"translateX(100%)"},'&[data-popper-placement*="right"]::before':{top:0,left:0,transform:"translateX(-100%)"},'&[data-popper-placement*="top"]::before':{bottom:0,left:0,transform:"translateY(100%)"}})}),aY=_n("span",{name:"JoyTooltip",slot:"Arrow",overridesResolver:(t,e)=>e.arrow})(({theme:t,ownerState:e})=>{var n,r,o;const l=(n=t.variants[e.variant])==null?void 0:n[e.color];return{"--unstable_Tooltip-arrowRotation":0,width:"var(--Tooltip-arrowSize)",height:"var(--Tooltip-arrowSize)",boxSizing:"border-box","&::before":{content:'""',display:"block",position:"absolute",width:0,height:0,border:"calc(var(--Tooltip-arrowSize) / 2) solid",borderLeftColor:"transparent",borderBottomColor:"transparent",borderTopColor:(r=l?.backgroundColor)!=null?r:t.vars.palette.background.surface,borderRightColor:(o=l?.backgroundColor)!=null?o:t.vars.palette.background.surface,borderRadius:"0px 2px 0px 0px",boxShadow:`var(--variant-borderWidth, 0px) calc(-1 * var(--variant-borderWidth, 0px)) 0px 0px ${l.borderColor}`,transformOrigin:"center center",transform:"rotate(calc(-45deg + 90deg * var(--unstable_Tooltip-arrowRotation)))"},'[data-popper-placement*="bottom"] &':{top:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="top"] &':{"--unstable_Tooltip-arrowRotation":2,bottom:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="left"] &':{"--unstable_Tooltip-arrowRotation":1,right:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="right"] &':{"--unstable_Tooltip-arrowRotation":3,left:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"}}});let Jx=!1;const s3=new k_;let i0={x:0,y:0};function a3(t,e){return n=>{e&&e(n),t(n)}}function l3(t,e){return(n,...r)=>{e&&e(n,...r),t(n,...r)}}const B4=H.forwardRef(function(e,n){var r;const o=Xr({props:e,name:"JoyTooltip"}),{children:l,className:c,component:s,arrow:m=!1,describeChild:y=!1,disableFocusListener:b=!1,disableHoverListener:w=!1,disableInteractive:E=!1,disableTouchListener:T=!1,enterDelay:R=100,enterNextDelay:z=0,enterTouchDelay:I=700,followCursor:L=!1,id:V,leaveDelay:B=0,leaveTouchDelay:W=1500,onClose:X,onOpen:q,open:te,disablePortal:se,direction:re,keepMounted:$,modifiers:ce,placement:Ce="bottom",title:Se,color:Xe="neutral",variant:Fe="solid",size:Me="md",slots:Te={},slotProps:Ie={}}=o,Ke=ir(o,iY),[st,Ee]=H.useState(),[Qe,jt]=H.useState(null),je=H.useRef(!1),ft=E||L,At=w0(),ht=w0(),lt=w0(),bt=w0(),[St,dn]=Rv({controlled:te,default:!1,name:"Tooltip",state:"open"});let En=St;const un=il(V),et=H.useRef(void 0),Ln=yu(()=>{et.current!==void 0&&(document.body.style.WebkitUserSelect=et.current,et.current=void 0),bt.clear()});H.useEffect(()=>Ln,[Ln]);const Jt=Kt=>{s3.clear(),Jx=!0,dn(!0),q&&!En&&q(Kt)},fn=yu(Kt=>{s3.start(800+B,()=>{Jx=!1}),dn(!1),X&&En&&X(Kt),At.start(150,()=>{je.current=!1})}),$t=Kt=>{je.current&&Kt.type!=="touchstart"||(st&&st.removeAttribute("title"),ht.clear(),lt.clear(),R||Jx&&z?ht.start(Jx?z:R,()=>{Jt(Kt)}):Jt(Kt))},Nn=Kt=>{ht.clear(),lt.start(B,()=>{fn(Kt)})},{isFocusVisibleRef:vn,onBlur:Ue,onFocus:we,ref:yt}=_P(),[,Nt]=H.useState(!1),Ht=Kt=>{Ue(Kt),vn.current===!1&&(Nt(!1),Nn(Kt))},Ot=Kt=>{st||Ee(Kt.currentTarget),we(Kt),vn.current===!0&&(Nt(!0),$t(Kt))},ln=Kt=>{je.current=!0;const Re=l.props;Re.onTouchStart&&Re.onTouchStart(Kt)},Gt=Kt=>{ln(Kt),lt.clear(),At.clear(),Ln(),et.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",bt.start(I,()=>{document.body.style.WebkitUserSelect=et.current,$t(Kt)})},Zt=Kt=>{l.props.onTouchEnd&&l.props.onTouchEnd(Kt),Ln(),lt.start(W,()=>{fn(Kt)})};H.useEffect(()=>{if(!En)return;function Kt(Re){(Re.key==="Escape"||Re.key==="Esc")&&fn(Re)}return document.addEventListener("keydown",Kt),()=>{document.removeEventListener("keydown",Kt)}},[fn,En]);const Fn=bi(Ee,n),Yt=bi(yt,Fn),Pe=bi(mw(l),Yt);typeof Se!="number"&&!Se&&(En=!1);const ae=H.useRef(null),ue=Kt=>{const Re=l.props;Re.onMouseMove&&Re.onMouseMove(Kt),i0={x:Kt.clientX,y:Kt.clientY},ae.current&&ae.current.update()},ee={},fe=typeof Se=="string";y?(ee.title=!En&&fe&&!w?Se:null,ee["aria-describedby"]=En?un:null):(ee["aria-label"]=fe?Se:null,ee["aria-labelledby"]=En&&!fe?un:null);const Oe=ve({},ee,Ke,{component:s},l.props,{className:co(c,l.props.className),onTouchStart:ln,ref:Pe},L?{onMouseMove:ue}:{}),Ye={};T||(Oe.onTouchStart=Gt,Oe.onTouchEnd=Zt),w||(Oe.onMouseOver=a3($t,Oe.onMouseOver),Oe.onMouseLeave=a3(Nn,Oe.onMouseLeave),ft||(Ye.onMouseOver=$t,Ye.onMouseLeave=Nn)),b||(Oe.onFocus=l3(Ot,Oe.onFocus),Oe.onBlur=l3(Ht,Oe.onBlur),ft||(Ye.onFocus=Ot,Ye.onBlur=Ht));const ye=ve({},o,{arrow:m,disableInteractive:ft,placement:Ce,touch:je.current,color:Xe,variant:Fe,size:Me}),Ae=oY(ye),Be=ve({},Ke,{component:s,slots:Te,slotProps:Ie}),$e=H.useMemo(()=>[{name:"arrow",enabled:!!Qe,options:{element:Qe,padding:6}},{name:"offset",options:{offset:[0,10]}},...ce||[]],[Qe,ce]),[He,ut]=Bn("root",{additionalProps:ve({id:un,popperRef:ae,placement:Ce,anchorEl:L?{getBoundingClientRect:()=>({top:i0.y,left:i0.x,right:i0.x,bottom:i0.y,width:0,height:0})}:st,open:st?En:!1,disablePortal:se,keepMounted:$,direction:re,modifiers:$e},Ye),ref:null,className:Ae.root,elementType:sY,externalForwardedProps:Be,ownerState:ye}),[We,Ut]=Bn("arrow",{ref:jt,className:Ae.arrow,elementType:aY,externalForwardedProps:Be,ownerState:ye});return oe.jsxs(H.Fragment,{children:[H.isValidElement(l)&&H.cloneElement(l,Oe),oe.jsxs(He,ve({},ut,!((r=o.slots)!=null&&r.root)&&{as:ww,slots:{root:s||"div"}},{children:[Se,m?oe.jsx(We,ve({},Ut)):null]}))]})});var Qx={},c3;function lY(){if(c3)return Qx;c3=1;var t=H5();return Qx.createRoot=t.createRoot,Qx.hydrateRoot=t.hydrateRoot,Qx}var cY=lY(),o0={},u3;function uY(){if(u3)return o0;u3=1,Object.defineProperty(o0,"__esModule",{value:!0}),o0.parse=c,o0.serialize=y;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,l=(()=>{const E=function(){};return E.prototype=Object.create(null),E})();function c(E,T){const R=new l,z=E.length;if(z<2)return R;const I=T?.decode||b;let L=0;do{const V=E.indexOf("=",L);if(V===-1)break;const B=E.indexOf(";",L),W=B===-1?z:B;if(V>W){L=E.lastIndexOf(";",V-1)+1;continue}const X=s(E,L,V),q=m(E,V,X),te=E.slice(X,q);if(R[te]===void 0){let se=s(E,V+1,W),re=m(E,W,se);const $=I(E.slice(se,re));R[te]=$}L=W+1}while(L<z);return R}function s(E,T,R){do{const z=E.charCodeAt(T);if(z!==32&&z!==9)return T}while(++T<R);return R}function m(E,T,R){for(;T>R;){const z=E.charCodeAt(--T);if(z!==32&&z!==9)return T+1}return R}function y(E,T,R){const z=R?.encode||encodeURIComponent;if(!t.test(E))throw new TypeError(`argument name is invalid: ${E}`);const I=z(T);if(!e.test(I))throw new TypeError(`argument val is invalid: ${T}`);let L=E+"="+I;if(!R)return L;if(R.maxAge!==void 0){if(!Number.isInteger(R.maxAge))throw new TypeError(`option maxAge is invalid: ${R.maxAge}`);L+="; Max-Age="+R.maxAge}if(R.domain){if(!n.test(R.domain))throw new TypeError(`option domain is invalid: ${R.domain}`);L+="; Domain="+R.domain}if(R.path){if(!r.test(R.path))throw new TypeError(`option path is invalid: ${R.path}`);L+="; Path="+R.path}if(R.expires){if(!w(R.expires)||!Number.isFinite(R.expires.valueOf()))throw new TypeError(`option expires is invalid: ${R.expires}`);L+="; Expires="+R.expires.toUTCString()}if(R.httpOnly&&(L+="; HttpOnly"),R.secure&&(L+="; Secure"),R.partitioned&&(L+="; Partitioned"),R.priority)switch(typeof R.priority=="string"?R.priority.toLowerCase():void 0){case"low":L+="; Priority=Low";break;case"medium":L+="; Priority=Medium";break;case"high":L+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${R.priority}`)}if(R.sameSite)switch(typeof R.sameSite=="string"?R.sameSite.toLowerCase():R.sameSite){case!0:case"strict":L+="; SameSite=Strict";break;case"lax":L+="; SameSite=Lax";break;case"none":L+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${R.sameSite}`)}return L}function b(E){if(E.indexOf("%")===-1)return E;try{return decodeURIComponent(E)}catch{return E}}function w(E){return o.call(E)==="[object Date]"}return o0}uY();/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var U4=t=>{throw TypeError(t)},hY=(t,e,n)=>e.has(t)||U4("Cannot "+n),QS=(t,e,n)=>(hY(t,e,"read from private field"),n?n.call(t):e.get(t)),dY=(t,e,n)=>e.has(t)?U4("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),h3="popstate";function fY(t={}){function e(r,o){let{pathname:l,search:c,hash:s}=r.location;return p_("",{pathname:l,search:c,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:ip(o)}return mY(e,n,null,t)}function Ur(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zo(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function pY(){return Math.random().toString(36).substring(2,10)}function d3(t,e){return{usr:t.state,key:t.key,idx:e}}function p_(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?vp(e):e,state:n,key:e&&e.key||r||pY()}}function ip({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function vp(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function mY(t,e,n,r={}){let{window:o=document.defaultView,v5Compat:l=!1}=r,c=o.history,s="POP",m=null,y=b();y==null&&(y=0,c.replaceState({...c.state,idx:y},""));function b(){return(c.state||{idx:null}).idx}function w(){s="POP";let I=b(),L=I==null?null:I-y;y=I,m&&m({action:s,location:z.location,delta:L})}function E(I,L){s="PUSH";let V=p_(z.location,I,L);y=b()+1;let B=d3(V,y),W=z.createHref(V);try{c.pushState(B,"",W)}catch(X){if(X instanceof DOMException&&X.name==="DataCloneError")throw X;o.location.assign(W)}l&&m&&m({action:s,location:z.location,delta:1})}function T(I,L){s="REPLACE";let V=p_(z.location,I,L);y=b();let B=d3(V,y),W=z.createHref(V);c.replaceState(B,"",W),l&&m&&m({action:s,location:z.location,delta:0})}function R(I){return $4(I)}let z={get action(){return s},get location(){return t(o,c)},listen(I){if(m)throw new Error("A history only accepts one active listener");return o.addEventListener(h3,w),m=I,()=>{o.removeEventListener(h3,w),m=null}},createHref(I){return e(o,I)},createURL:R,encodeLocation(I){let L=R(I);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:E,replace:T,go(I){return c.go(I)}};return z}function $4(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ur(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:ip(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}var S0,f3=class{constructor(t){if(dY(this,S0,new Map),t)for(let[e,n]of t)this.set(e,n)}get(t){if(QS(this,S0).has(t))return QS(this,S0).get(t);if(t.defaultValue!==void 0)return t.defaultValue;throw new Error("No value found for context")}set(t,e){QS(this,S0).set(t,e)}};S0=new WeakMap;var gY=new Set(["lazy","caseSensitive","path","id","index","children"]);function vY(t){return gY.has(t)}var yY=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function _Y(t){return yY.has(t)}function xY(t){return t.index===!0}function S1(t,e,n=[],r={}){return t.map((o,l)=>{let c=[...n,String(l)],s=typeof o.id=="string"?o.id:c.join("-");if(Ur(o.index!==!0||!o.children,"Cannot specify children on an index route"),Ur(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),xY(o)){let m={...o,...e(o),id:s};return r[s]=m,m}else{let m={...o,...e(o),id:s,children:void 0};return r[s]=m,o.children&&(m.children=S1(o.children,e,c,r)),m}})}function Wf(t,e,n="/"){return qb(t,e,n,!1)}function qb(t,e,n,r){let o=typeof e=="string"?vp(e):e,l=Rc(o.pathname||"/",n);if(l==null)return null;let c=V4(t);wY(c);let s=null;for(let m=0;s==null&&m<c.length;++m){let y=DY(l);s=RY(c[m],y,r)}return s}function bY(t,e){let{route:n,pathname:r,params:o}=t;return{id:n.id,pathname:r,params:o,data:e[n.id],handle:n.handle}}function V4(t,e=[],n=[],r=""){let o=(l,c,s)=>{let m={relativePath:s===void 0?l.path||"":s,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};m.relativePath.startsWith("/")&&(Ur(m.relativePath.startsWith(r),`Absolute route path "${m.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(r.length));let y=Ch([r,m.relativePath]),b=n.concat(m);l.children&&l.children.length>0&&(Ur(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),V4(l.children,e,b,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:AY(y,l.index),routesMeta:b})};return t.forEach((l,c)=>{if(l.path===""||!l.path?.includes("?"))o(l,c);else for(let s of j4(l.path))o(l,c,s)}),e}function j4(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),l=n.replace(/\?$/,"");if(r.length===0)return o?[l,""]:[l];let c=j4(r.join("/")),s=[];return s.push(...c.map(m=>m===""?l:[l,m].join("/"))),o&&s.push(...c),s.map(m=>t.startsWith("/")&&m===""?"/":m)}function wY(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:IY(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var SY=/^:[\w-]+$/,MY=3,CY=2,EY=1,TY=10,PY=-2,p3=t=>t==="*";function AY(t,e){let n=t.split("/"),r=n.length;return n.some(p3)&&(r+=PY),e&&(r+=CY),n.filter(o=>!p3(o)).reduce((o,l)=>o+(SY.test(l)?MY:l===""?EY:TY),r)}function IY(t,e){return t.length===e.length&&t.slice(0,-1).every((r,o)=>r===e[o])?t[t.length-1]-e[e.length-1]:0}function RY(t,e,n=!1){let{routesMeta:r}=t,o={},l="/",c=[];for(let s=0;s<r.length;++s){let m=r[s],y=s===r.length-1,b=l==="/"?e:e.slice(l.length)||"/",w=M1({path:m.relativePath,caseSensitive:m.caseSensitive,end:y},b),E=m.route;if(!w&&y&&n&&!r[r.length-1].route.index&&(w=M1({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},b)),!w)return null;Object.assign(o,w.params),c.push({params:o,pathname:Ch([l,w.pathname]),pathnameBase:OY(Ch([l,w.pathnameBase])),route:E}),w.pathnameBase!=="/"&&(l=Ch([l,w.pathnameBase]))}return c}function M1(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=LY(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let l=o[0],c=l.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((y,{paramName:b,isOptional:w},E)=>{if(b==="*"){let R=s[E]||"";c=l.slice(0,l.length-R.length).replace(/(.)\/+$/,"$1")}const T=s[E];return w&&!T?y[b]=void 0:y[b]=(T||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:c,pattern:t}}function LY(t,e=!1,n=!0){zo(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,s,m)=>(r.push({paramName:s,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function DY(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zo(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Rc(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function kY(t,e="/"){let{pathname:n,search:r="",hash:o=""}=typeof t=="string"?vp(t):t;return{pathname:n?n.startsWith("/")?n:zY(n,e):e,search:FY(r),hash:NY(o)}}function zY(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function eM(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function H4(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function VP(t){let e=H4(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function jP(t,e,n,r=!1){let o;typeof t=="string"?o=vp(t):(o={...t},Ur(!o.pathname||!o.pathname.includes("?"),eM("?","pathname","search",o)),Ur(!o.pathname||!o.pathname.includes("#"),eM("#","pathname","hash",o)),Ur(!o.search||!o.search.includes("#"),eM("#","search","hash",o)));let l=t===""||o.pathname==="",c=l?"/":o.pathname,s;if(c==null)s=n;else{let w=e.length-1;if(!r&&c.startsWith("..")){let E=c.split("/");for(;E[0]==="..";)E.shift(),w-=1;o.pathname=E.join("/")}s=w>=0?e[w]:"/"}let m=kY(o,s),y=c&&c!=="/"&&c.endsWith("/"),b=(l||c===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(y||b)&&(m.pathname+="/"),m}var Ch=t=>t.join("/").replace(/\/\/+/g,"/"),OY=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),FY=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,NY=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,C1=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function m_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var G4=["POST","PUT","PATCH","DELETE"],BY=new Set(G4),UY=["GET",...G4],$Y=new Set(UY),VY=new Set([301,302,303,307,308]),jY=new Set([307,308]),tM={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},HY={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},s0={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},HP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,GY=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),W4="remix-router-transitions",q4=Symbol("ResetLoaderData");function WY(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";Ur(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=t.hydrationRouteProperties||[],o=t.mapRouteProperties||GY,l={},c=S1(t.routes,o,void 0,l),s,m=t.basename||"/",y=t.dataStrategy||KY,b={unstable_middleware:!1,...t.future},w=null,E=new Set,T=null,R=null,z=null,I=t.hydrationData!=null,L=Wf(c,t.history.location,m),V=!1,B=null,W;if(L==null&&!t.patchRoutesOnNavigation){let Re=Mc(404,{pathname:t.history.location.pathname}),{matches:it,route:mt}=E3(c);W=!0,L=it,B={[mt.id]:Re}}else if(L&&!t.hydrationData&&ut(L,c,t.history.location.pathname).active&&(L=null),L)if(L.some(Re=>Re.route.lazy))W=!1;else if(!L.some(Re=>Re.route.loader))W=!0;else{let Re=t.hydrationData?t.hydrationData.loaderData:null,it=t.hydrationData?t.hydrationData.errors:null;if(it){let mt=L.findIndex(Wt=>it[Wt.route.id]!==void 0);W=L.slice(0,mt+1).every(Wt=>!M2(Wt.route,Re,it))}else W=L.every(mt=>!M2(mt.route,Re,it))}else{W=!1,L=[];let Re=ut(null,c,t.history.location.pathname);Re.active&&Re.matches&&(V=!0,L=Re.matches)}let X,q={historyAction:t.history.action,location:t.history.location,matches:L,initialized:W,navigation:tM,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||B,fetchers:new Map,blockers:new Map},te="POP",se=!1,re,$=!1,ce=new Map,Ce=null,Se=!1,Xe=!1,Fe=new Set,Me=new Map,Te=0,Ie=-1,Ke=new Map,st=new Set,Ee=new Map,Qe=new Map,jt=new Set,je=new Map,ft,At=null;function ht(){if(w=t.history.listen(({action:Re,location:it,delta:mt})=>{if(ft){ft(),ft=void 0;return}zo(je.size===0||mt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Wt=Ye({currentLocation:q.location,nextLocation:it,historyAction:Re});if(Wt&&mt!=null){let tn=new Promise(pn=>{ft=pn});t.history.go(mt*-1),Oe(Wt,{state:"blocked",location:it,proceed(){Oe(Wt,{state:"proceeding",proceed:void 0,reset:void 0,location:it}),tn.then(()=>t.history.go(mt))},reset(){let pn=new Map(q.blockers);pn.set(Wt,s0),St({blockers:pn})}});return}return et(Re,it)}),n){lK(e,ce);let Re=()=>cK(e,ce);e.addEventListener("pagehide",Re),Ce=()=>e.removeEventListener("pagehide",Re)}return q.initialized||et("POP",q.location,{initialHydration:!0}),X}function lt(){w&&w(),Ce&&Ce(),E.clear(),re&&re.abort(),q.fetchers.forEach((Re,it)=>Zt(it)),q.blockers.forEach((Re,it)=>fe(it))}function bt(Re){return E.add(Re),()=>E.delete(Re)}function St(Re,it={}){q={...q,...Re};let mt=[],Wt=[];q.fetchers.forEach((tn,pn)=>{tn.state==="idle"&&(jt.has(pn)?mt.push(pn):Wt.push(pn))}),jt.forEach(tn=>{!q.fetchers.has(tn)&&!Me.has(tn)&&mt.push(tn)}),[...E].forEach(tn=>tn(q,{deletedFetchers:mt,viewTransitionOpts:it.viewTransitionOpts,flushSync:it.flushSync===!0})),mt.forEach(tn=>Zt(tn)),Wt.forEach(tn=>q.fetchers.delete(tn))}function dn(Re,it,{flushSync:mt}={}){let Wt=q.actionData!=null&&q.navigation.formMethod!=null&&zl(q.navigation.formMethod)&&q.navigation.state==="loading"&&Re.state?._isRedirect!==!0,tn;it.actionData?Object.keys(it.actionData).length>0?tn=it.actionData:tn=null:Wt?tn=q.actionData:tn=null;let pn=it.loaderData?M3(q.loaderData,it.loaderData,it.matches||[],it.errors):q.loaderData,rn=q.blockers;rn.size>0&&(rn=new Map(rn),rn.forEach((Ct,Gn)=>rn.set(Gn,s0)));let on=se===!0||q.navigation.formMethod!=null&&zl(q.navigation.formMethod)&&Re.state?._isRedirect!==!0;s&&(c=s,s=void 0),Se||te==="POP"||(te==="PUSH"?t.history.push(Re,Re.state):te==="REPLACE"&&t.history.replace(Re,Re.state));let kn;if(te==="POP"){let Ct=ce.get(q.location.pathname);Ct&&Ct.has(Re.pathname)?kn={currentLocation:q.location,nextLocation:Re}:ce.has(Re.pathname)&&(kn={currentLocation:Re,nextLocation:q.location})}else if($){let Ct=ce.get(q.location.pathname);Ct?Ct.add(Re.pathname):(Ct=new Set([Re.pathname]),ce.set(q.location.pathname,Ct)),kn={currentLocation:q.location,nextLocation:Re}}St({...it,actionData:tn,loaderData:pn,historyAction:te,location:Re,initialized:!0,navigation:tM,revalidation:"idle",restoreScrollPosition:He(Re,it.matches||q.matches),preventScrollReset:on,blockers:rn},{viewTransitionOpts:kn,flushSync:mt===!0}),te="POP",se=!1,$=!1,Se=!1,Xe=!1,At?.resolve(),At=null}async function En(Re,it){if(typeof Re=="number"){t.history.go(Re);return}let mt=S2(q.location,q.matches,m,Re,it?.fromRouteId,it?.relative),{path:Wt,submission:tn,error:pn}=m3(!1,mt,it),rn=q.location,on=p_(q.location,Wt,it&&it.state);on={...on,...t.history.encodeLocation(on)};let kn=it&&it.replace!=null?it.replace:void 0,Ct="PUSH";kn===!0?Ct="REPLACE":kn===!1||tn!=null&&zl(tn.formMethod)&&tn.formAction===q.location.pathname+q.location.search&&(Ct="REPLACE");let Gn=it&&"preventScrollReset"in it?it.preventScrollReset===!0:void 0,On=(it&&it.flushSync)===!0,or=Ye({currentLocation:rn,nextLocation:on,historyAction:Ct});if(or){Oe(or,{state:"blocked",location:on,proceed(){Oe(or,{state:"proceeding",proceed:void 0,reset:void 0,location:on}),En(Re,it)},reset(){let It=new Map(q.blockers);It.set(or,s0),St({blockers:It})}});return}await et(Ct,on,{submission:tn,pendingError:pn,preventScrollReset:Gn,replace:it&&it.replace,enableViewTransition:it&&it.viewTransition,flushSync:On})}function un(){At||(At=uK()),Ht(),St({revalidation:"loading"});let Re=At.promise;return q.navigation.state==="submitting"?Re:q.navigation.state==="idle"?(et(q.historyAction,q.location,{startUninterruptedRevalidation:!0}),Re):(et(te||q.historyAction,q.navigation.location,{overrideNavigation:q.navigation,enableViewTransition:$===!0}),Re)}async function et(Re,it,mt){re&&re.abort(),re=null,te=Re,Se=(mt&&mt.startUninterruptedRevalidation)===!0,$e(q.location,q.matches),se=(mt&&mt.preventScrollReset)===!0,$=(mt&&mt.enableViewTransition)===!0;let Wt=s||c,tn=mt&&mt.overrideNavigation,pn=mt?.initialHydration&&q.matches&&q.matches.length>0&&!V?q.matches:Wf(Wt,it,m),rn=(mt&&mt.flushSync)===!0;if(pn&&q.initialized&&!Xe&&rK(q.location,it)&&!(mt&&mt.submission&&zl(mt.submission.formMethod))){dn(it,{matches:pn},{flushSync:rn});return}let on=ut(pn,Wt,it.pathname);if(on.active&&on.matches&&(pn=on.matches),!pn){let{error:qt,notFoundMatches:cn,route:Rn}=ye(it.pathname);dn(it,{matches:cn,loaderData:{},errors:{[Rn.id]:qt}},{flushSync:rn});return}re=new AbortController;let kn=pv(t.history,it,re.signal,mt&&mt.submission),Ct=new f3(t.unstable_getContext?await t.unstable_getContext():void 0),Gn;if(mt&&mt.pendingError)Gn=[Em(pn).route.id,{type:"error",error:mt.pendingError}];else if(mt&&mt.submission&&zl(mt.submission.formMethod)){let qt=await Ln(kn,it,mt.submission,pn,Ct,on.active,mt&&mt.initialHydration===!0,{replace:mt.replace,flushSync:rn});if(qt.shortCircuited)return;if(qt.pendingActionResult){let[cn,Rn]=qt.pendingActionResult;if(kl(Rn)&&m_(Rn.error)&&Rn.error.status===404){re=null,dn(it,{matches:qt.matches,loaderData:{},errors:{[cn]:Rn.error}});return}}pn=qt.matches||pn,Gn=qt.pendingActionResult,tn=nM(it,mt.submission),rn=!1,on.active=!1,kn=pv(t.history,kn.url,kn.signal)}let{shortCircuited:On,matches:or,loaderData:It,errors:nt}=await Jt(kn,it,pn,Ct,on.active,tn,mt&&mt.submission,mt&&mt.fetcherSubmission,mt&&mt.replace,mt&&mt.initialHydration===!0,rn,Gn);On||(re=null,dn(it,{matches:or||pn,...C3(Gn),loaderData:It,errors:nt}))}async function Ln(Re,it,mt,Wt,tn,pn,rn,on={}){Ht();let kn=sK(it,mt);if(St({navigation:kn},{flushSync:on.flushSync===!0}),pn){let On=await We(Wt,it.pathname,Re.signal);if(On.type==="aborted")return{shortCircuited:!0};if(On.type==="error"){let or=Em(On.partialMatches).route.id;return{matches:On.partialMatches,pendingActionResult:[or,{type:"error",error:On.error}]}}else if(On.matches)Wt=On.matches;else{let{notFoundMatches:or,error:It,route:nt}=ye(it.pathname);return{matches:or,pendingActionResult:[nt.id,{type:"error",error:It}]}}}let Ct,Gn=M0(Wt,it);if(!Gn.route.action&&!Gn.route.lazy)Ct={type:"error",error:Mc(405,{method:Re.method,pathname:it.pathname,routeId:Gn.route.id})};else{let On=kv(o,l,Re,Wt,Gn,rn?[]:r,tn),or=await yt(Re,On,tn,null);if(Ct=or[Gn.route.id],!Ct){for(let It of Wt)if(or[It.route.id]){Ct=or[It.route.id];break}}if(Re.signal.aborted)return{shortCircuited:!0}}if(Rm(Ct)){let On;return on&&on.replace!=null?On=on.replace:On=b3(Ct.response.headers.get("Location"),new URL(Re.url),m)===q.location.pathname+q.location.search,await we(Re,Ct,!0,{submission:mt,replace:On}),{shortCircuited:!0}}if(kl(Ct)){let On=Em(Wt,Gn.route.id);return(on&&on.replace)!==!0&&(te="PUSH"),{matches:Wt,pendingActionResult:[On.route.id,Ct,Gn.route.id]}}return{matches:Wt,pendingActionResult:[Gn.route.id,Ct]}}async function Jt(Re,it,mt,Wt,tn,pn,rn,on,kn,Ct,Gn,On){let or=pn||nM(it,rn),It=rn||on||P3(or),nt=!Se&&!Ct;if(tn){if(nt){let Tn=fn(On);St({navigation:or,...Tn!==void 0?{actionData:Tn}:{}},{flushSync:Gn})}let mn=await We(mt,it.pathname,Re.signal);if(mn.type==="aborted")return{shortCircuited:!0};if(mn.type==="error"){let Tn=Em(mn.partialMatches).route.id;return{matches:mn.partialMatches,loaderData:{},errors:{[Tn]:mn.error}}}else if(mn.matches)mt=mn.matches;else{let{error:Tn,notFoundMatches:Qt,route:Zn}=ye(it.pathname);return{matches:Qt,loaderData:{},errors:{[Zn.id]:Tn}}}}let qt=s||c,{dsMatches:cn,revalidatingFetchers:Rn}=g3(Re,Wt,o,l,t.history,q,mt,It,it,Ct?[]:r,Ct===!0,Xe,Fe,jt,Ee,st,qt,m,t.patchRoutesOnNavigation!=null,On);if(Ie=++Te,!t.dataStrategy&&!cn.some(mn=>mn.shouldLoad)&&Rn.length===0){let mn=ae();return dn(it,{matches:mt,loaderData:{},errors:On&&kl(On[1])?{[On[0]]:On[1].error}:null,...C3(On),...mn?{fetchers:new Map(q.fetchers)}:{}},{flushSync:Gn}),{shortCircuited:!0}}if(nt){let mn={};if(!tn){mn.navigation=or;let Tn=fn(On);Tn!==void 0&&(mn.actionData=Tn)}Rn.length>0&&(mn.fetchers=$t(Rn)),St(mn,{flushSync:Gn})}Rn.forEach(mn=>{Yt(mn.key),mn.controller&&Me.set(mn.key,mn.controller)});let Ir=()=>Rn.forEach(mn=>Yt(mn.key));re&&re.signal.addEventListener("abort",Ir);let{loaderResults:_r,fetcherResults:xe}=await Nt(cn,Rn,Re,Wt);if(Re.signal.aborted)return{shortCircuited:!0};re&&re.signal.removeEventListener("abort",Ir),Rn.forEach(mn=>Me.delete(mn.key));let vt=eb(_r);if(vt)return await we(Re,vt.result,!0,{replace:kn}),{shortCircuited:!0};if(vt=eb(xe),vt)return st.add(vt.key),await we(Re,vt.result,!0,{replace:kn}),{shortCircuited:!0};let{loaderData:kt,errors:xt}=S3(q,mt,_r,On,Rn,xe);Ct&&q.errors&&(xt={...q.errors,...xt});let wt=ae(),hn=ue(Ie),Pn=wt||hn||Rn.length>0;return{matches:mt,loaderData:kt,errors:xt,...Pn?{fetchers:new Map(q.fetchers)}:{}}}function fn(Re){if(Re&&!kl(Re[1]))return{[Re[0]]:Re[1].data};if(q.actionData)return Object.keys(q.actionData).length===0?null:q.actionData}function $t(Re){return Re.forEach(it=>{let mt=q.fetchers.get(it.key),Wt=a0(void 0,mt?mt.data:void 0);q.fetchers.set(it.key,Wt)}),new Map(q.fetchers)}async function Nn(Re,it,mt,Wt){Yt(Re);let tn=(Wt&&Wt.flushSync)===!0,pn=s||c,rn=S2(q.location,q.matches,m,mt,it,Wt?.relative),on=Wf(pn,rn,m),kn=ut(on,pn,rn);if(kn.active&&kn.matches&&(on=kn.matches),!on){ln(Re,it,Mc(404,{pathname:rn}),{flushSync:tn});return}let{path:Ct,submission:Gn,error:On}=m3(!0,rn,Wt);if(On){ln(Re,it,On,{flushSync:tn});return}let or=M0(on,Ct),It=new f3(t.unstable_getContext?await t.unstable_getContext():void 0),nt=(Wt&&Wt.preventScrollReset)===!0;if(Gn&&zl(Gn.formMethod)){await vn(Re,it,Ct,or,on,It,kn.active,tn,nt,Gn);return}Ee.set(Re,{routeId:it,path:Ct}),await Ue(Re,it,Ct,or,on,It,kn.active,tn,nt,Gn)}async function vn(Re,it,mt,Wt,tn,pn,rn,on,kn,Ct){Ht(),Ee.delete(Re);function Gn(Wn){if(!Wn.route.action&&!Wn.route.lazy){let tr=Mc(405,{method:Ct.formMethod,pathname:mt,routeId:it});return ln(Re,it,tr,{flushSync:on}),!0}return!1}if(!rn&&Gn(Wt))return;let On=q.fetchers.get(Re);Ot(Re,aK(Ct,On),{flushSync:on});let or=new AbortController,It=pv(t.history,mt,or.signal,Ct);if(rn){let Wn=await We(tn,mt,It.signal,Re);if(Wn.type==="aborted")return;if(Wn.type==="error"){ln(Re,it,Wn.error,{flushSync:on});return}else if(Wn.matches){if(tn=Wn.matches,Wt=M0(tn,mt),Gn(Wt))return}else{ln(Re,it,Mc(404,{pathname:mt}),{flushSync:on});return}}Me.set(Re,or);let nt=Te,qt=kv(o,l,It,tn,Wt,r,pn),Rn=(await yt(It,qt,pn,Re))[Wt.route.id];if(It.signal.aborted){Me.get(Re)===or&&Me.delete(Re);return}if(jt.has(Re)){if(Rm(Rn)||kl(Rn)){Ot(Re,Vf(void 0));return}}else{if(Rm(Rn))if(Me.delete(Re),Ie>nt){Ot(Re,Vf(void 0));return}else return st.add(Re),Ot(Re,a0(Ct)),we(It,Rn,!1,{fetcherSubmission:Ct,preventScrollReset:kn});if(kl(Rn)){ln(Re,it,Rn.error);return}}let Ir=q.navigation.location||q.location,_r=pv(t.history,Ir,or.signal),xe=s||c,vt=q.navigation.state!=="idle"?Wf(xe,q.navigation.location,m):q.matches;Ur(vt,"Didn't find any matches after fetcher action");let kt=++Te;Ke.set(Re,kt);let xt=a0(Ct,Rn.data);q.fetchers.set(Re,xt);let{dsMatches:wt,revalidatingFetchers:hn}=g3(_r,pn,o,l,t.history,q,vt,Ct,Ir,r,!1,Xe,Fe,jt,Ee,st,xe,m,t.patchRoutesOnNavigation!=null,[Wt.route.id,Rn]);hn.filter(Wn=>Wn.key!==Re).forEach(Wn=>{let tr=Wn.key,Or=q.fetchers.get(tr),Fr=a0(void 0,Or?Or.data:void 0);q.fetchers.set(tr,Fr),Yt(tr),Wn.controller&&Me.set(tr,Wn.controller)}),St({fetchers:new Map(q.fetchers)});let Pn=()=>hn.forEach(Wn=>Yt(Wn.key));or.signal.addEventListener("abort",Pn);let{loaderResults:mn,fetcherResults:Tn}=await Nt(wt,hn,_r,pn);if(or.signal.aborted)return;if(or.signal.removeEventListener("abort",Pn),Ke.delete(Re),Me.delete(Re),hn.forEach(Wn=>Me.delete(Wn.key)),q.fetchers.has(Re)){let Wn=Vf(Rn.data);q.fetchers.set(Re,Wn)}let Qt=eb(mn);if(Qt)return we(_r,Qt.result,!1,{preventScrollReset:kn});if(Qt=eb(Tn),Qt)return st.add(Qt.key),we(_r,Qt.result,!1,{preventScrollReset:kn});let{loaderData:Zn,errors:An}=S3(q,vt,mn,void 0,hn,Tn);ue(kt),q.navigation.state==="loading"&&kt>Ie?(Ur(te,"Expected pending action"),re&&re.abort(),dn(q.navigation.location,{matches:vt,loaderData:Zn,errors:An,fetchers:new Map(q.fetchers)})):(St({errors:An,loaderData:M3(q.loaderData,Zn,vt,An),fetchers:new Map(q.fetchers)}),Xe=!1)}async function Ue(Re,it,mt,Wt,tn,pn,rn,on,kn,Ct){let Gn=q.fetchers.get(Re);Ot(Re,a0(Ct,Gn?Gn.data:void 0),{flushSync:on});let On=new AbortController,or=pv(t.history,mt,On.signal);if(rn){let Rn=await We(tn,mt,or.signal,Re);if(Rn.type==="aborted")return;if(Rn.type==="error"){ln(Re,it,Rn.error,{flushSync:on});return}else if(Rn.matches)tn=Rn.matches,Wt=M0(tn,mt);else{ln(Re,it,Mc(404,{pathname:mt}),{flushSync:on});return}}Me.set(Re,On);let It=Te,nt=kv(o,l,or,tn,Wt,r,pn),cn=(await yt(or,nt,pn,Re))[Wt.route.id];if(Me.get(Re)===On&&Me.delete(Re),!or.signal.aborted){if(jt.has(Re)){Ot(Re,Vf(void 0));return}if(Rm(cn))if(Ie>It){Ot(Re,Vf(void 0));return}else{st.add(Re),await we(or,cn,!1,{preventScrollReset:kn});return}if(kl(cn)){ln(Re,it,cn.error);return}Ot(Re,Vf(cn.data))}}async function we(Re,it,mt,{submission:Wt,fetcherSubmission:tn,preventScrollReset:pn,replace:rn}={}){it.response.headers.has("X-Remix-Revalidate")&&(Xe=!0);let on=it.response.headers.get("Location");Ur(on,"Expected a Location header on the redirect Response"),on=b3(on,new URL(Re.url),m);let kn=p_(q.location,on,{_isRedirect:!0});if(n){let nt=!1;if(it.response.headers.has("X-Remix-Reload-Document"))nt=!0;else if(HP.test(on)){const qt=$4(on,!0);nt=qt.origin!==e.location.origin||Rc(qt.pathname,m)==null}if(nt){rn?e.location.replace(on):e.location.assign(on);return}}re=null;let Ct=rn===!0||it.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:Gn,formAction:On,formEncType:or}=q.navigation;!Wt&&!tn&&Gn&&On&&or&&(Wt=P3(q.navigation));let It=Wt||tn;if(jY.has(it.response.status)&&It&&zl(It.formMethod))await et(Ct,kn,{submission:{...It,formAction:on},preventScrollReset:pn||se,enableViewTransition:mt?$:void 0});else{let nt=nM(kn,Wt);await et(Ct,kn,{overrideNavigation:nt,fetcherSubmission:tn,preventScrollReset:pn||se,enableViewTransition:mt?$:void 0})}}async function yt(Re,it,mt,Wt){let tn,pn={};try{tn=await JY(y,Re,it,Wt,mt,!1)}catch(rn){return it.filter(on=>on.shouldLoad).forEach(on=>{pn[on.route.id]={type:"error",error:rn}}),pn}if(Re.signal.aborted)return pn;for(let[rn,on]of Object.entries(tn))if(iK(on)){let kn=on.result;pn[rn]={type:"redirect",response:tK(kn,Re,rn,it,m)}}else pn[rn]=await eK(on);return pn}async function Nt(Re,it,mt,Wt){let tn=yt(mt,Re,Wt,null),pn=Promise.all(it.map(async kn=>{if(kn.matches&&kn.match&&kn.request&&kn.controller){let Gn=(await yt(kn.request,kn.matches,Wt,kn.key))[kn.match.route.id];return{[kn.key]:Gn}}else return Promise.resolve({[kn.key]:{type:"error",error:Mc(404,{pathname:kn.path})}})})),rn=await tn,on=(await pn).reduce((kn,Ct)=>Object.assign(kn,Ct),{});return{loaderResults:rn,fetcherResults:on}}function Ht(){Xe=!0,Ee.forEach((Re,it)=>{Me.has(it)&&Fe.add(it),Yt(it)})}function Ot(Re,it,mt={}){q.fetchers.set(Re,it),St({fetchers:new Map(q.fetchers)},{flushSync:(mt&&mt.flushSync)===!0})}function ln(Re,it,mt,Wt={}){let tn=Em(q.matches,it);Zt(Re),St({errors:{[tn.route.id]:mt},fetchers:new Map(q.fetchers)},{flushSync:(Wt&&Wt.flushSync)===!0})}function Gt(Re){return Qe.set(Re,(Qe.get(Re)||0)+1),jt.has(Re)&&jt.delete(Re),q.fetchers.get(Re)||HY}function Zt(Re){let it=q.fetchers.get(Re);Me.has(Re)&&!(it&&it.state==="loading"&&Ke.has(Re))&&Yt(Re),Ee.delete(Re),Ke.delete(Re),st.delete(Re),jt.delete(Re),Fe.delete(Re),q.fetchers.delete(Re)}function Fn(Re){let it=(Qe.get(Re)||0)-1;it<=0?(Qe.delete(Re),jt.add(Re)):Qe.set(Re,it),St({fetchers:new Map(q.fetchers)})}function Yt(Re){let it=Me.get(Re);it&&(it.abort(),Me.delete(Re))}function Pe(Re){for(let it of Re){let mt=Gt(it),Wt=Vf(mt.data);q.fetchers.set(it,Wt)}}function ae(){let Re=[],it=!1;for(let mt of st){let Wt=q.fetchers.get(mt);Ur(Wt,`Expected fetcher: ${mt}`),Wt.state==="loading"&&(st.delete(mt),Re.push(mt),it=!0)}return Pe(Re),it}function ue(Re){let it=[];for(let[mt,Wt]of Ke)if(Wt<Re){let tn=q.fetchers.get(mt);Ur(tn,`Expected fetcher: ${mt}`),tn.state==="loading"&&(Yt(mt),Ke.delete(mt),it.push(mt))}return Pe(it),it.length>0}function ee(Re,it){let mt=q.blockers.get(Re)||s0;return je.get(Re)!==it&&je.set(Re,it),mt}function fe(Re){q.blockers.delete(Re),je.delete(Re)}function Oe(Re,it){let mt=q.blockers.get(Re)||s0;Ur(mt.state==="unblocked"&&it.state==="blocked"||mt.state==="blocked"&&it.state==="blocked"||mt.state==="blocked"&&it.state==="proceeding"||mt.state==="blocked"&&it.state==="unblocked"||mt.state==="proceeding"&&it.state==="unblocked",`Invalid blocker state transition: ${mt.state} -> ${it.state}`);let Wt=new Map(q.blockers);Wt.set(Re,it),St({blockers:Wt})}function Ye({currentLocation:Re,nextLocation:it,historyAction:mt}){if(je.size===0)return;je.size>1&&zo(!1,"A router only supports one blocker at a time");let Wt=Array.from(je.entries()),[tn,pn]=Wt[Wt.length-1],rn=q.blockers.get(tn);if(!(rn&&rn.state==="proceeding")&&pn({currentLocation:Re,nextLocation:it,historyAction:mt}))return tn}function ye(Re){let it=Mc(404,{pathname:Re}),mt=s||c,{matches:Wt,route:tn}=E3(mt);return{notFoundMatches:Wt,route:tn,error:it}}function Ae(Re,it,mt){if(T=Re,z=it,R=mt||null,!I&&q.navigation===tM){I=!0;let Wt=He(q.location,q.matches);Wt!=null&&St({restoreScrollPosition:Wt})}return()=>{T=null,z=null,R=null}}function Be(Re,it){return R&&R(Re,it.map(Wt=>bY(Wt,q.loaderData)))||Re.key}function $e(Re,it){if(T&&z){let mt=Be(Re,it);T[mt]=z()}}function He(Re,it){if(T){let mt=Be(Re,it),Wt=T[mt];if(typeof Wt=="number")return Wt}return null}function ut(Re,it,mt){if(t.patchRoutesOnNavigation)if(Re){if(Object.keys(Re[0].params).length>0)return{active:!0,matches:qb(it,mt,m,!0)}}else return{active:!0,matches:qb(it,mt,m,!0)||[]};return{active:!1,matches:null}}async function We(Re,it,mt,Wt){if(!t.patchRoutesOnNavigation)return{type:"success",matches:Re};let tn=Re;for(;;){let pn=s==null,rn=s||c,on=l;try{await t.patchRoutesOnNavigation({signal:mt,path:it,matches:tn,fetcherKey:Wt,patch:(Gn,On)=>{mt.aborted||v3(Gn,On,rn,on,o)}})}catch(Gn){return{type:"error",error:Gn,partialMatches:tn}}finally{pn&&!mt.aborted&&(c=[...c])}if(mt.aborted)return{type:"aborted"};let kn=Wf(rn,it,m);if(kn)return{type:"success",matches:kn};let Ct=qb(rn,it,m,!0);if(!Ct||tn.length===Ct.length&&tn.every((Gn,On)=>Gn.route.id===Ct[On].route.id))return{type:"success",matches:null};tn=Ct}}function Ut(Re){l={},s=S1(Re,o,void 0,l)}function Kt(Re,it){let mt=s==null;v3(Re,it,s||c,l,o),mt&&(c=[...c],St({}))}return X={get basename(){return m},get future(){return b},get state(){return q},get routes(){return c},get window(){return e},initialize:ht,subscribe:bt,enableScrollRestoration:Ae,navigate:En,fetch:Nn,revalidate:un,createHref:Re=>t.history.createHref(Re),encodeLocation:Re=>t.history.encodeLocation(Re),getFetcher:Gt,deleteFetcher:Fn,dispose:lt,getBlocker:ee,deleteBlocker:fe,patchRoutes:Kt,_internalFetchControllers:Me,_internalSetRoutes:Ut},X}function qY(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function S2(t,e,n,r,o,l){let c,s;if(o){c=[];for(let y of e)if(c.push(y),y.route.id===o){s=y;break}}else c=e,s=e[e.length-1];let m=jP(r||".",VP(c),Rc(t.pathname,n)||t.pathname,l==="path");if(r==null&&(m.search=t.search,m.hash=t.hash),(r==null||r===""||r===".")&&s){let y=GP(m.search);if(s.route.index&&!y)m.search=m.search?m.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&y){let b=new URLSearchParams(m.search),w=b.getAll("index");b.delete("index"),w.filter(T=>T).forEach(T=>b.append("index",T));let E=b.toString();m.search=E?`?${E}`:""}}return n!=="/"&&(m.pathname=m.pathname==="/"?n:Ch([n,m.pathname])),ip(m)}function m3(t,e,n){if(!n||!qY(n))return{path:e};if(n.formMethod&&!oK(n.formMethod))return{path:e,error:Mc(405,{method:n.formMethod})};let r=()=>({path:e,error:Mc(400,{type:"invalid-body"})}),l=(n.formMethod||"get").toUpperCase(),c=Q4(e);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!zl(l))return r();let w=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((E,[T,R])=>`${E}${T}=${R}
`,""):String(n.body);return{path:e,submission:{formMethod:l,formAction:c,formEncType:n.formEncType,formData:void 0,json:void 0,text:w}}}else if(n.formEncType==="application/json"){if(!zl(l))return r();try{let w=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:e,submission:{formMethod:l,formAction:c,formEncType:n.formEncType,formData:void 0,json:w,text:void 0}}}catch{return r()}}}Ur(typeof FormData=="function","FormData is not available in this environment");let s,m;if(n.formData)s=E2(n.formData),m=n.formData;else if(n.body instanceof FormData)s=E2(n.body),m=n.body;else if(n.body instanceof URLSearchParams)s=n.body,m=w3(s);else if(n.body==null)s=new URLSearchParams,m=new FormData;else try{s=new URLSearchParams(n.body),m=w3(s)}catch{return r()}let y={formMethod:l,formAction:c,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:m,json:void 0,text:void 0};if(zl(y.formMethod))return{path:e,submission:y};let b=vp(e);return t&&b.search&&GP(b.search)&&s.append("index",""),b.search=`?${s}`,{path:ip(b),submission:y}}function g3(t,e,n,r,o,l,c,s,m,y,b,w,E,T,R,z,I,L,V,B){let W=B?kl(B[1])?B[1].error:B[1].data:void 0,X=o.createURL(l.location),q=o.createURL(m),te;if(b&&l.errors){let Se=Object.keys(l.errors)[0];te=c.findIndex(Xe=>Xe.route.id===Se)}else if(B&&kl(B[1])){let Se=B[0];te=c.findIndex(Xe=>Xe.route.id===Se)-1}let se=B?B[1].statusCode:void 0,re=se&&se>=400,$={currentUrl:X,currentParams:l.matches[0]?.params||{},nextUrl:q,nextParams:c[0].params,...s,actionResult:W,actionStatus:se},ce=c.map((Se,Xe)=>{let{route:Fe}=Se,Me=null;if(te!=null&&Xe>te?Me=!1:Fe.lazy?Me=!0:Fe.loader==null?Me=!1:b?Me=M2(Fe,l.loaderData,l.errors):XY(l.loaderData,l.matches[Xe],Se)&&(Me=!0),Me!==null)return C2(n,r,t,Se,y,e,Me);let Te=re?!1:w||X.pathname+X.search===q.pathname+q.search||X.search!==q.search||ZY(l.matches[Xe],Se),Ie={...$,defaultShouldRevalidate:Te},Ke=E1(Se,Ie);return C2(n,r,t,Se,y,e,Ke,Ie)}),Ce=[];return R.forEach((Se,Xe)=>{if(b||!c.some(Qe=>Qe.route.id===Se.routeId)||T.has(Xe))return;let Fe=l.fetchers.get(Xe),Me=Fe&&Fe.state!=="idle"&&Fe.data===void 0,Te=Wf(I,Se.path,L);if(!Te){if(V&&Me)return;Ce.push({key:Xe,routeId:Se.routeId,path:Se.path,matches:null,match:null,request:null,controller:null});return}if(z.has(Xe))return;let Ie=M0(Te,Se.path),Ke=new AbortController,st=pv(o,Se.path,Ke.signal),Ee=null;if(E.has(Xe))E.delete(Xe),Ee=kv(n,r,st,Te,Ie,y,e);else if(Me)w&&(Ee=kv(n,r,st,Te,Ie,y,e));else{let Qe={...$,defaultShouldRevalidate:re?!1:w};E1(Ie,Qe)&&(Ee=kv(n,r,st,Te,Ie,y,e,Qe))}Ee&&Ce.push({key:Xe,routeId:Se.routeId,path:Se.path,matches:Ee,match:Ie,request:st,controller:Ke})}),{dsMatches:ce,revalidatingFetchers:Ce}}function M2(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&t.id in e,o=n!=null&&n[t.id]!==void 0;return!r&&o?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!o}function XY(t,e,n){let r=!e||n.route.id!==e.route.id,o=!t.hasOwnProperty(n.route.id);return r||o}function ZY(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function E1(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function v3(t,e,n,r,o){let l;if(t){let m=r[t];Ur(m,`No route found to patch children into: routeId = ${t}`),m.children||(m.children=[]),l=m.children}else l=n;let c=e.filter(m=>!l.some(y=>X4(m,y))),s=S1(c,o,[t||"_","patch",String(l?.length||"0")],r);l.push(...s)}function X4(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>e.children?.some(o=>X4(n,o))):!1}var y3=new WeakMap,Z4=({key:t,route:e,manifest:n,mapRouteProperties:r})=>{let o=n[e.id];if(Ur(o,"No route found in manifest"),!o.lazy||typeof o.lazy!="object")return;let l=o.lazy[t];if(!l)return;let c=y3.get(o);c||(c={},y3.set(o,c));let s=c[t];if(s)return s;let m=(async()=>{let y=vY(t),w=o[t]!==void 0&&t!=="hasErrorBoundary";if(y)zo(!y,"Route property "+t+" is not a supported lazy route property. This property will be ignored."),c[t]=Promise.resolve();else if(w)zo(!1,`Route "${o.id}" has a static property "${t}" defined. The lazy property will be ignored.`);else{let E=await l();E!=null&&(Object.assign(o,{[t]:E}),Object.assign(o,r(o)))}typeof o.lazy=="object"&&(o.lazy[t]=void 0,Object.values(o.lazy).every(E=>E===void 0)&&(o.lazy=void 0))})();return c[t]=m,m},_3=new WeakMap;function YY(t,e,n,r,o){let l=n[t.id];if(Ur(l,"No route found in manifest"),!t.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof t.lazy=="function"){let b=_3.get(l);if(b)return{lazyRoutePromise:b,lazyHandlerPromise:b};let w=(async()=>{Ur(typeof t.lazy=="function","No lazy route function found");let E=await t.lazy(),T={};for(let R in E){let z=E[R];if(z===void 0)continue;let I=_Y(R),V=l[R]!==void 0&&R!=="hasErrorBoundary";I?zo(!I,"Route property "+R+" is not a supported property to be returned from a lazy route function. This property will be ignored."):V?zo(!V,`Route "${l.id}" has a static property "${R}" defined but its lazy function is also returning a value for this property. The lazy route property "${R}" will be ignored.`):T[R]=z}Object.assign(l,T),Object.assign(l,{...r(l),lazy:void 0})})();return _3.set(l,w),w.catch(()=>{}),{lazyRoutePromise:w,lazyHandlerPromise:w}}let c=Object.keys(t.lazy),s=[],m;for(let b of c){if(o&&o.includes(b))continue;let w=Z4({key:b,route:t,manifest:n,mapRouteProperties:r});w&&(s.push(w),b===e&&(m=w))}let y=s.length>0?Promise.all(s).then(()=>{}):void 0;return y?.catch(()=>{}),m?.catch(()=>{}),{lazyRoutePromise:y,lazyHandlerPromise:m}}async function x3(t){let e=t.matches.filter(o=>o.shouldLoad),n={};return(await Promise.all(e.map(o=>o.resolve()))).forEach((o,l)=>{n[e[l].route.id]=o}),n}async function KY(t){return t.matches.some(e=>e.route.unstable_middleware)?Y4(t,!1,()=>x3(t),(e,n)=>({[n]:{type:"error",result:e}})):x3(t)}async function Y4(t,e,n,r){let{matches:o,request:l,params:c,context:s}=t,m={handlerResult:void 0};try{let y=o.flatMap(w=>w.route.unstable_middleware?w.route.unstable_middleware.map(E=>[w.route.id,E]):[]),b=await K4({request:l,params:c,context:s},y,e,m,n);return e?b:m.handlerResult}catch(y){if(!m.middlewareError)throw y;let b=await r(m.middlewareError.error,m.middlewareError.routeId);return m.handlerResult?Object.assign(m.handlerResult,b):b}}async function K4(t,e,n,r,o,l=0){let{request:c}=t;if(c.signal.aborted)throw c.signal.reason?c.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${c.method} ${c.url}`);let s=e[l];if(!s)return r.handlerResult=await o(),r.handlerResult;let[m,y]=s,b=!1,w,E=async()=>{if(b)throw new Error("You may only call `next()` once per middleware");b=!0,await K4(t,e,n,r,o,l+1)};try{let T=await y({request:t.request,params:t.params,context:t.context},E);return b?T===void 0?w:T:E()}catch(T){throw r.middlewareError?r.middlewareError.error!==T&&(r.middlewareError={routeId:m,error:T}):r.middlewareError={routeId:m,error:T},T}}function J4(t,e,n,r,o){let l=Z4({key:"unstable_middleware",route:r.route,manifest:e,mapRouteProperties:t}),c=YY(r.route,zl(n.method)?"action":"loader",e,t,o);return{middleware:l,route:c.lazyRoutePromise,handler:c.lazyHandlerPromise}}function C2(t,e,n,r,o,l,c,s=null){let m=!1,y=J4(t,e,n,r,o);return{...r,_lazyPromises:y,shouldLoad:c,unstable_shouldRevalidateArgs:s,unstable_shouldCallHandler(b){return m=!0,s?typeof b=="boolean"?E1(r,{...s,defaultShouldRevalidate:b}):E1(r,s):c},resolve(b){return m||c||b&&n.method==="GET"&&(r.route.lazy||r.route.loader)?QY({request:n,match:r,lazyHandlerPromise:y?.handler,lazyRoutePromise:y?.route,handlerOverride:b,scopedContext:l}):Promise.resolve({type:"data",result:void 0})}}}function kv(t,e,n,r,o,l,c,s=null){return r.map(m=>m.route.id!==o.route.id?{...m,shouldLoad:!1,unstable_shouldRevalidateArgs:s,unstable_shouldCallHandler:()=>!1,_lazyPromises:J4(t,e,n,m,l),resolve:()=>Promise.resolve({type:"data",result:void 0})}:C2(t,e,n,m,l,c,!0,s))}async function JY(t,e,n,r,o,l){n.some(y=>y._lazyPromises?.middleware)&&await Promise.all(n.map(y=>y._lazyPromises?.middleware));let c={request:e,params:n[0].params,context:o,matches:n},m=await t({...c,fetcherKey:r,unstable_runClientMiddleware:y=>{let b=c;return Y4(b,!1,()=>y({...b,fetcherKey:r,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}}),(w,E)=>({[E]:{type:"error",result:w}}))}});try{await Promise.all(n.flatMap(y=>[y._lazyPromises?.handler,y._lazyPromises?.route]))}catch{}return m}async function QY({request:t,match:e,lazyHandlerPromise:n,lazyRoutePromise:r,handlerOverride:o,scopedContext:l}){let c,s,m=zl(t.method),y=m?"action":"loader",b=w=>{let E,T=new Promise((I,L)=>E=L);s=()=>E(),t.signal.addEventListener("abort",s);let R=I=>typeof w!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${y}" [routeId: ${e.route.id}]`)):w({request:t,params:e.params,context:l},...I!==void 0?[I]:[]),z=(async()=>{try{return{type:"data",result:await(o?o(L=>R(L)):R())}}catch(I){return{type:"error",result:I}}})();return Promise.race([z,T])};try{let w=m?e.route.action:e.route.loader;if(n||r)if(w){let E,[T]=await Promise.all([b(w).catch(R=>{E=R}),n,r]);if(E!==void 0)throw E;c=T}else{await n;let E=m?e.route.action:e.route.loader;if(E)[c]=await Promise.all([b(E),r]);else if(y==="action"){let T=new URL(t.url),R=T.pathname+T.search;throw Mc(405,{method:t.method,pathname:R,routeId:e.route.id})}else return{type:"data",result:void 0}}else if(w)c=await b(w);else{let E=new URL(t.url),T=E.pathname+E.search;throw Mc(404,{pathname:T})}}catch(w){return{type:"error",result:w}}finally{s&&t.signal.removeEventListener("abort",s)}return c}async function eK(t){let{result:e,type:n}=t;if(eF(e)){let r;try{let o=e.headers.get("Content-Type");o&&/\bapplication\/json\b/.test(o)?e.body==null?r=null:r=await e.json():r=await e.text()}catch(o){return{type:"error",error:o}}return n==="error"?{type:"error",error:new C1(e.status,e.statusText,r),statusCode:e.status,headers:e.headers}:{type:"data",data:r,statusCode:e.status,headers:e.headers}}return n==="error"?T3(e)?e.data instanceof Error?{type:"error",error:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:new C1(e.init?.status||500,void 0,e.data),statusCode:m_(e)?e.status:void 0,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:e,statusCode:m_(e)?e.status:void 0}:T3(e)?{type:"data",data:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function tK(t,e,n,r,o){let l=t.headers.get("Location");if(Ur(l,"Redirects returned/thrown from loaders/actions must have a Location header"),!HP.test(l)){let c=r.slice(0,r.findIndex(s=>s.route.id===n)+1);l=S2(new URL(e.url),c,o,l),t.headers.set("Location",l)}return t}function b3(t,e,n){if(HP.test(t)){let r=t,o=r.startsWith("//")?new URL(e.protocol+r):new URL(r),l=Rc(o.pathname,n)!=null;if(o.origin===e.origin&&l)return o.pathname+o.search+o.hash}return t}function pv(t,e,n,r){let o=t.createURL(Q4(e)).toString(),l={signal:n};if(r&&zl(r.formMethod)){let{formMethod:c,formEncType:s}=r;l.method=c.toUpperCase(),s==="application/json"?(l.headers=new Headers({"Content-Type":s}),l.body=JSON.stringify(r.json)):s==="text/plain"?l.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?l.body=E2(r.formData):l.body=r.formData}return new Request(o,l)}function E2(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function w3(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function nK(t,e,n,r=!1,o=!1){let l={},c=null,s,m=!1,y={},b=n&&kl(n[1])?n[1].error:void 0;return t.forEach(w=>{if(!(w.route.id in e))return;let E=w.route.id,T=e[E];if(Ur(!Rm(T),"Cannot handle redirect results in processLoaderData"),kl(T)){let R=T.error;if(b!==void 0&&(R=b,b=void 0),c=c||{},o)c[E]=R;else{let z=Em(t,E);c[z.route.id]==null&&(c[z.route.id]=R)}r||(l[E]=q4),m||(m=!0,s=m_(T.error)?T.error.status:500),T.headers&&(y[E]=T.headers)}else l[E]=T.data,T.statusCode&&T.statusCode!==200&&!m&&(s=T.statusCode),T.headers&&(y[E]=T.headers)}),b!==void 0&&n&&(c={[n[0]]:b},n[2]&&(l[n[2]]=void 0)),{loaderData:l,errors:c,statusCode:s||200,loaderHeaders:y}}function S3(t,e,n,r,o,l){let{loaderData:c,errors:s}=nK(e,n,r);return o.filter(m=>!m.matches||m.matches.some(y=>y.shouldLoad)).forEach(m=>{let{key:y,match:b,controller:w}=m,E=l[y];if(Ur(E,"Did not find corresponding fetcher result"),!(w&&w.signal.aborted))if(kl(E)){let T=Em(t.matches,b?.route.id);s&&s[T.route.id]||(s={...s,[T.route.id]:E.error}),t.fetchers.delete(y)}else if(Rm(E))Ur(!1,"Unhandled fetcher revalidation redirect");else{let T=Vf(E.data);t.fetchers.set(y,T)}}),{loaderData:c,errors:s}}function M3(t,e,n,r){let o=Object.entries(e).filter(([,l])=>l!==q4).reduce((l,[c,s])=>(l[c]=s,l),{});for(let l of n){let c=l.route.id;if(!e.hasOwnProperty(c)&&t.hasOwnProperty(c)&&l.route.loader&&(o[c]=t[c]),r&&r.hasOwnProperty(c))break}return o}function C3(t){return t?kl(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Em(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function E3(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Mc(t,{pathname:e,routeId:n,method:r,type:o,message:l}={}){let c="Unknown Server Error",s="Unknown @remix-run/router error";return t===400?(c="Bad Request",r&&e&&n?s=`You made a ${r} request to "${e}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:o==="invalid-body"&&(s="Unable to encode submission body")):t===403?(c="Forbidden",s=`Route "${n}" does not match URL "${e}"`):t===404?(c="Not Found",s=`No route matches URL "${e}"`):t===405&&(c="Method Not Allowed",r&&e&&n?s=`You made a ${r.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new C1(t||500,c,new Error(s),!0)}function eb(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,o]=e[n];if(Rm(o))return{key:r,result:o}}}function Q4(t){let e=typeof t=="string"?vp(t):t;return ip({...e,hash:""})}function rK(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function iK(t){return eF(t.result)&&VY.has(t.result.status)}function kl(t){return t.type==="error"}function Rm(t){return(t&&t.type)==="redirect"}function T3(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function eF(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function oK(t){return $Y.has(t.toUpperCase())}function zl(t){return BY.has(t.toUpperCase())}function GP(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function M0(t,e){let n=typeof e=="string"?vp(e).search:e.search;if(t[t.length-1].route.index&&GP(n||""))return t[t.length-1];let r=H4(t);return r[r.length-1]}function P3(t){let{formMethod:e,formAction:n,formEncType:r,text:o,formData:l,json:c}=t;if(!(!e||!n||!r)){if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:o};if(l!=null)return{formMethod:e,formAction:n,formEncType:r,formData:l,json:void 0,text:void 0};if(c!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:c,text:void 0}}}function nM(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function sK(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function a0(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function aK(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Vf(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function lK(t,e){try{let n=t.sessionStorage.getItem(W4);if(n){let r=JSON.parse(n);for(let[o,l]of Object.entries(r||{}))l&&Array.isArray(l)&&e.set(o,new Set(l||[]))}}catch{}}function cK(t,e){if(e.size>0){let n={};for(let[r,o]of e)n[r]=[...o];try{t.sessionStorage.setItem(W4,JSON.stringify(n))}catch(r){zo(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function uK(){let t,e,n=new Promise((r,o)=>{t=async l=>{r(l);try{await n}catch{}},e=async l=>{o(l);try{await n}catch{}}});return{promise:n,resolve:t,reject:e}}var Zm=H.createContext(null);Zm.displayName="DataRouter";var H_=H.createContext(null);H_.displayName="DataRouterState";var WP=H.createContext({isTransitioning:!1});WP.displayName="ViewTransition";var tF=H.createContext(new Map);tF.displayName="Fetchers";var hK=H.createContext(null);hK.displayName="Await";var Dh=H.createContext(null);Dh.displayName="Navigation";var Lw=H.createContext(null);Lw.displayName="Location";var Kd=H.createContext({outlet:null,matches:[],isDataRoute:!1});Kd.displayName="Route";var qP=H.createContext(null);qP.displayName="RouteError";function dK(t,{relative:e}={}){Ur(G_(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=H.useContext(Dh),{hash:o,pathname:l,search:c}=W_(t,{relative:e}),s=l;return n!=="/"&&(s=l==="/"?n:Ch([n,l])),r.createHref({pathname:s,search:c,hash:o})}function G_(){return H.useContext(Lw)!=null}function yp(){return Ur(G_(),"useLocation() may be used only in the context of a <Router> component."),H.useContext(Lw).location}var nF="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function rF(t){H.useContext(Dh).static||H.useLayoutEffect(t)}function iF(){let{isDataRoute:t}=H.useContext(Kd);return t?CK():fK()}function fK(){Ur(G_(),"useNavigate() may be used only in the context of a <Router> component.");let t=H.useContext(Zm),{basename:e,navigator:n}=H.useContext(Dh),{matches:r}=H.useContext(Kd),{pathname:o}=yp(),l=JSON.stringify(VP(r)),c=H.useRef(!1);return rF(()=>{c.current=!0}),H.useCallback((m,y={})=>{if(zo(c.current,nF),!c.current)return;if(typeof m=="number"){n.go(m);return}let b=jP(m,JSON.parse(l),o,y.relative==="path");t==null&&e!=="/"&&(b.pathname=b.pathname==="/"?e:Ch([e,b.pathname])),(y.replace?n.replace:n.push)(b,y.state,y)},[e,n,l,o,t])}H.createContext(null);function W_(t,{relative:e}={}){let{matches:n}=H.useContext(Kd),{pathname:r}=yp(),o=JSON.stringify(VP(n));return H.useMemo(()=>jP(t,JSON.parse(o),r,e==="path"),[t,o,r,e])}function pK(t,e,n,r){Ur(G_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=H.useContext(Dh),{matches:l}=H.useContext(Kd),c=l[l.length-1],s=c?c.params:{},m=c?c.pathname:"/",y=c?c.pathnameBase:"/",b=c&&c.route;{let L=b&&b.path||"";oF(m,!b||L.endsWith("*")||L.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${L}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${L}"> to <Route path="${L==="/"?"*":`${L}/*`}">.`)}let w=yp(),E;E=w;let T=E.pathname||"/",R=T;if(y!=="/"){let L=y.replace(/^\//,"").split("/");R="/"+T.replace(/^\//,"").split("/").slice(L.length).join("/")}let z=Wf(t,{pathname:R});return zo(b||z!=null,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),zo(z==null||z[z.length-1].route.element!==void 0||z[z.length-1].route.Component!==void 0||z[z.length-1].route.lazy!==void 0,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_K(z&&z.map(L=>Object.assign({},L,{params:Object.assign({},s,L.params),pathname:Ch([y,o.encodeLocation?o.encodeLocation(L.pathname).pathname:L.pathname]),pathnameBase:L.pathnameBase==="/"?y:Ch([y,o.encodeLocation?o.encodeLocation(L.pathnameBase).pathname:L.pathnameBase])})),l,n,r)}function mK(){let t=MK(),e=m_(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},l={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=H.createElement(H.Fragment,null,H.createElement("p",null,"💿 Hey developer 👋"),H.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",H.createElement("code",{style:l},"ErrorBoundary")," or"," ",H.createElement("code",{style:l},"errorElement")," prop on your route.")),H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},e),n?H.createElement("pre",{style:o},n):null,c)}var gK=H.createElement(mK,null),vK=class extends H.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?H.createElement(Kd.Provider,{value:this.props.routeContext},H.createElement(qP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function yK({routeContext:t,match:e,children:n}){let r=H.useContext(Zm);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),H.createElement(Kd.Provider,{value:t},n)}function _K(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=n?.errors;if(l!=null){let m=o.findIndex(y=>y.route.id&&l?.[y.route.id]!==void 0);Ur(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,m+1))}let c=!1,s=-1;if(n)for(let m=0;m<o.length;m++){let y=o[m];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(s=m),y.route.id){let{loaderData:b,errors:w}=n,E=y.route.loader&&!b.hasOwnProperty(y.route.id)&&(!w||w[y.route.id]===void 0);if(y.route.lazy||E){c=!0,s>=0?o=o.slice(0,s+1):o=[o[0]];break}}}return o.reduceRight((m,y,b)=>{let w,E=!1,T=null,R=null;n&&(w=l&&y.route.id?l[y.route.id]:void 0,T=y.route.errorElement||gK,c&&(s<0&&b===0?(oF("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),E=!0,R=null):s===b&&(E=!0,R=y.route.hydrateFallbackElement||null)));let z=e.concat(o.slice(0,b+1)),I=()=>{let L;return w?L=T:E?L=R:y.route.Component?L=H.createElement(y.route.Component,null):y.route.element?L=y.route.element:L=m,H.createElement(yK,{match:y,routeContext:{outlet:m,matches:z,isDataRoute:n!=null},children:L})};return n&&(y.route.ErrorBoundary||y.route.errorElement||b===0)?H.createElement(vK,{location:n.location,revalidation:n.revalidation,component:T,error:w,children:I(),routeContext:{outlet:null,matches:z,isDataRoute:!0}}):I()},null)}function XP(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function xK(t){let e=H.useContext(Zm);return Ur(e,XP(t)),e}function bK(t){let e=H.useContext(H_);return Ur(e,XP(t)),e}function wK(t){let e=H.useContext(Kd);return Ur(e,XP(t)),e}function ZP(t){let e=wK(t),n=e.matches[e.matches.length-1];return Ur(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function SK(){return ZP("useRouteId")}function MK(){let t=H.useContext(qP),e=bK("useRouteError"),n=ZP("useRouteError");return t!==void 0?t:e.errors?.[n]}function CK(){let{router:t}=xK("useNavigate"),e=ZP("useNavigate"),n=H.useRef(!1);return rF(()=>{n.current=!0}),H.useCallback(async(o,l={})=>{zo(n.current,nF),n.current&&(typeof o=="number"?t.navigate(o):await t.navigate(o,{fromRouteId:e,...l}))},[t,e])}var A3={};function oF(t,e,n){!e&&!A3[t]&&(A3[t]=!0,zo(!1,n))}var I3={};function R3(t,e){!t&&!I3[e]&&(I3[e]=!0,console.warn(e))}function EK(t){let e={hasErrorBoundary:t.hasErrorBoundary||t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&(t.element&&zo(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:H.createElement(t.Component),Component:void 0})),t.HydrateFallback&&(t.hydrateFallbackElement&&zo(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:H.createElement(t.HydrateFallback),HydrateFallback:void 0})),t.ErrorBoundary&&(t.errorElement&&zo(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:H.createElement(t.ErrorBoundary),ErrorBoundary:void 0})),e}var TK=["HydrateFallback","hydrateFallbackElement"],PK=class{constructor(){this.status="pending",this.promise=new Promise((t,e)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",e(n))}})}};function AK({router:t,flushSync:e}){let[n,r]=H.useState(t.state),[o,l]=H.useState(),[c,s]=H.useState({isTransitioning:!1}),[m,y]=H.useState(),[b,w]=H.useState(),[E,T]=H.useState(),R=H.useRef(new Map),z=H.useCallback((B,{deletedFetchers:W,flushSync:X,viewTransitionOpts:q})=>{B.fetchers.forEach((se,re)=>{se.data!==void 0&&R.current.set(re,se.data)}),W.forEach(se=>R.current.delete(se)),R3(X===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let te=t.window!=null&&t.window.document!=null&&typeof t.window.document.startViewTransition=="function";if(R3(q==null||te,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!q||!te){e&&X?e(()=>r(B)):H.startTransition(()=>r(B));return}if(e&&X){e(()=>{b&&(m&&m.resolve(),b.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:q.currentLocation,nextLocation:q.nextLocation})});let se=t.window.document.startViewTransition(()=>{e(()=>r(B))});se.finished.finally(()=>{e(()=>{y(void 0),w(void 0),l(void 0),s({isTransitioning:!1})})}),e(()=>w(se));return}b?(m&&m.resolve(),b.skipTransition(),T({state:B,currentLocation:q.currentLocation,nextLocation:q.nextLocation})):(l(B),s({isTransitioning:!0,flushSync:!1,currentLocation:q.currentLocation,nextLocation:q.nextLocation}))},[t.window,e,b,m]);H.useLayoutEffect(()=>t.subscribe(z),[t,z]),H.useEffect(()=>{c.isTransitioning&&!c.flushSync&&y(new PK)},[c]),H.useEffect(()=>{if(m&&o&&t.window){let B=o,W=m.promise,X=t.window.document.startViewTransition(async()=>{H.startTransition(()=>r(B)),await W});X.finished.finally(()=>{y(void 0),w(void 0),l(void 0),s({isTransitioning:!1})}),w(X)}},[o,m,t.window]),H.useEffect(()=>{m&&o&&n.location.key===o.location.key&&m.resolve()},[m,b,n.location,o]),H.useEffect(()=>{!c.isTransitioning&&E&&(l(E.state),s({isTransitioning:!0,flushSync:!1,currentLocation:E.currentLocation,nextLocation:E.nextLocation}),T(void 0))},[c.isTransitioning,E]);let I=H.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:B=>t.navigate(B),push:(B,W,X)=>t.navigate(B,{state:W,preventScrollReset:X?.preventScrollReset}),replace:(B,W,X)=>t.navigate(B,{replace:!0,state:W,preventScrollReset:X?.preventScrollReset})}),[t]),L=t.basename||"/",V=H.useMemo(()=>({router:t,navigator:I,static:!1,basename:L}),[t,I,L]);return H.createElement(H.Fragment,null,H.createElement(Zm.Provider,{value:V},H.createElement(H_.Provider,{value:n},H.createElement(tF.Provider,{value:R.current},H.createElement(WP.Provider,{value:c},H.createElement(LK,{basename:L,location:n.location,navigationType:n.historyAction,navigator:I},H.createElement(IK,{routes:t.routes,future:t.future,state:n})))))),null)}var IK=H.memo(RK);function RK({routes:t,future:e,state:n}){return pK(t,void 0,n,e)}function Xb(t){Ur(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function LK({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:o,static:l=!1}){Ur(!G_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),s=H.useMemo(()=>({basename:c,navigator:o,static:l,future:{}}),[c,o,l]);typeof n=="string"&&(n=vp(n));let{pathname:m="/",search:y="",hash:b="",state:w=null,key:E="default"}=n,T=H.useMemo(()=>{let R=Rc(m,c);return R==null?null:{location:{pathname:R,search:y,hash:b,state:w,key:E},navigationType:r}},[c,m,y,b,w,E,r]);return zo(T!=null,`<Router basename="${c}"> is not able to match the URL "${m}${y}${b}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:H.createElement(Dh.Provider,{value:s},H.createElement(Lw.Provider,{children:e,value:T}))}function T2(t,e=[]){let n=[];return H.Children.forEach(t,(r,o)=>{if(!H.isValidElement(r))return;let l=[...e,o];if(r.type===H.Fragment){n.push.apply(n,T2(r.props.children,l));return}Ur(r.type===Xb,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ur(!r.props.index||!r.props.children,"An index route cannot have child routes.");let c={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=T2(r.props.children,l)),n.push(c)}),n}var DK=T2,Zb="get",Yb="application/x-www-form-urlencoded";function Dw(t){return t!=null&&typeof t.tagName=="string"}function kK(t){return Dw(t)&&t.tagName.toLowerCase()==="button"}function zK(t){return Dw(t)&&t.tagName.toLowerCase()==="form"}function OK(t){return Dw(t)&&t.tagName.toLowerCase()==="input"}function FK(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function NK(t,e){return t.button===0&&(!e||e==="_self")&&!FK(t)}function P2(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(o=>[n,o]):[[n,r]])},[]))}function BK(t,e){let n=P2(t);return e&&e.forEach((r,o)=>{n.has(o)||e.getAll(o).forEach(l=>{n.append(o,l)})}),n}var tb=null;function UK(){if(tb===null)try{new FormData(document.createElement("form"),0),tb=!1}catch{tb=!0}return tb}var $K=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rM(t){return t!=null&&!$K.has(t)?(zo(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Yb}"`),null):t}function VK(t,e){let n,r,o,l,c;if(zK(t)){let s=t.getAttribute("action");r=s?Rc(s,e):null,n=t.getAttribute("method")||Zb,o=rM(t.getAttribute("enctype"))||Yb,l=new FormData(t)}else if(kK(t)||OK(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=t.getAttribute("formaction")||s.getAttribute("action");if(r=m?Rc(m,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||Zb,o=rM(t.getAttribute("formenctype"))||rM(s.getAttribute("enctype"))||Yb,l=new FormData(s,t),!UK()){let{name:y,type:b,value:w}=t;if(b==="image"){let E=y?`${y}.`:"";l.append(`${E}x`,"0"),l.append(`${E}y`,"0")}else y&&l.append(y,w)}}else{if(Dw(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Zb,r=null,o=Yb,c=t}return l&&o==="text/plain"&&(c=l,l=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:l,body:c}}function YP(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function jK(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function HK(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function GK(t,e,n){let r=await Promise.all(t.map(async o=>{let l=e.routes[o.route.id];if(l){let c=await jK(l,n);return c.links?c.links():[]}return[]}));return ZK(r.flat(1).filter(HK).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function L3(t,e,n,r,o,l){let c=(m,y)=>n[y]?m.route.id!==n[y].route.id:!0,s=(m,y)=>n[y].pathname!==m.pathname||n[y].route.path?.endsWith("*")&&n[y].params["*"]!==m.params["*"];return l==="assets"?e.filter((m,y)=>c(m,y)||s(m,y)):l==="data"?e.filter((m,y)=>{let b=r.routes[m.route.id];if(!b||!b.hasLoader)return!1;if(c(m,y)||s(m,y))return!0;if(m.route.shouldRevalidate){let w=m.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function WK(t,e,{includeHydrateFallback:n}={}){return qK(t.map(r=>{let o=e.routes[r.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function qK(t){return[...new Set(t)]}function XK(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function ZK(t,e){let n=new Set;return new Set(e),t.reduce((r,o)=>{let l=JSON.stringify(XK(o));return n.has(l)||(n.add(l),r.push({key:l,link:o})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var YK=new Set([100,101,204,205]);function KK(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Rc(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function sF(){let t=H.useContext(Zm);return YP(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function JK(){let t=H.useContext(H_);return YP(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var KP=H.createContext(void 0);KP.displayName="FrameworkContext";function aF(){let t=H.useContext(KP);return YP(t,"You must render this element inside a <HydratedRouter> element"),t}function QK(t,e){let n=H.useContext(KP),[r,o]=H.useState(!1),[l,c]=H.useState(!1),{onFocus:s,onBlur:m,onMouseEnter:y,onMouseLeave:b,onTouchStart:w}=e,E=H.useRef(null);H.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let z=L=>{L.forEach(V=>{c(V.isIntersecting)})},I=new IntersectionObserver(z,{threshold:.5});return E.current&&I.observe(E.current),()=>{I.disconnect()}}},[t]),H.useEffect(()=>{if(r){let z=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(z)}}},[r]);let T=()=>{o(!0)},R=()=>{o(!1),c(!1)};return n?t!=="intent"?[l,E,{}]:[l,E,{onFocus:l0(s,T),onBlur:l0(m,R),onMouseEnter:l0(y,T),onMouseLeave:l0(b,R),onTouchStart:l0(w,T)}]:[!1,E,{}]}function l0(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function eJ({page:t,...e}){let{router:n}=sF(),r=H.useMemo(()=>Wf(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?H.createElement(nJ,{page:t,matches:r,...e}):null}function tJ(t){let{manifest:e,routeModules:n}=aF(),[r,o]=H.useState([]);return H.useEffect(()=>{let l=!1;return GK(t,e,n).then(c=>{l||o(c)}),()=>{l=!0}},[t,e,n]),r}function nJ({page:t,matches:e,...n}){let r=yp(),{manifest:o,routeModules:l}=aF(),{basename:c}=sF(),{loaderData:s,matches:m}=JK(),y=H.useMemo(()=>L3(t,e,m,o,r,"data"),[t,e,m,o,r]),b=H.useMemo(()=>L3(t,e,m,o,r,"assets"),[t,e,m,o,r]),w=H.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let R=new Set,z=!1;if(e.forEach(L=>{let V=o.routes[L.route.id];!V||!V.hasLoader||(!y.some(B=>B.route.id===L.route.id)&&L.route.id in s&&l[L.route.id]?.shouldRevalidate||V.hasClientLoader?z=!0:R.add(L.route.id))}),R.size===0)return[];let I=KK(t,c);return z&&R.size>0&&I.searchParams.set("_routes",e.filter(L=>R.has(L.route.id)).map(L=>L.route.id).join(",")),[I.pathname+I.search]},[c,s,r,o,y,e,t,l]),E=H.useMemo(()=>WK(b,o),[b,o]),T=tJ(b);return H.createElement(H.Fragment,null,w.map(R=>H.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...n})),E.map(R=>H.createElement("link",{key:R,rel:"modulepreload",href:R,...n})),T.map(({key:R,link:z})=>H.createElement("link",{key:R,...z})))}function rJ(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var lF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{lF&&(window.__reactRouterVersion="7.6.3")}catch{}function iJ(t,e){return WY({basename:e?.basename,unstable_getContext:e?.unstable_getContext,future:e?.future,history:fY({window:e?.window}),hydrationData:oJ(),routes:t,mapRouteProperties:EK,hydrationRouteProperties:TK,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function oJ(){let t=window?.__staticRouterHydrationData;return t&&t.errors&&(t={...t,errors:sJ(t.errors)}),t}function sJ(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,o]of e)if(o&&o.__type==="RouteErrorResponse")n[r]=new C1(o.status,o.statusText,o.data,o.internal===!0);else if(o&&o.__type==="Error"){if(o.__subType){let l=window[o.__subType];if(typeof l=="function")try{let c=new l(o.message);c.stack="",n[r]=c}catch{}}if(n[r]==null){let l=new Error(o.message);l.stack="",n[r]=l}}else n[r]=o;return n}var cF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,uF=H.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:o,reloadDocument:l,replace:c,state:s,target:m,to:y,preventScrollReset:b,viewTransition:w,...E},T){let{basename:R}=H.useContext(Dh),z=typeof y=="string"&&cF.test(y),I,L=!1;if(typeof y=="string"&&z&&(I=y,lF))try{let re=new URL(window.location.href),$=y.startsWith("//")?new URL(re.protocol+y):new URL(y),ce=Rc($.pathname,R);$.origin===re.origin&&ce!=null?y=ce+$.search+$.hash:L=!0}catch{zo(!1,`<Link to="${y}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let V=dK(y,{relative:o}),[B,W,X]=QK(r,E),q=uJ(y,{replace:c,state:s,target:m,preventScrollReset:b,relative:o,viewTransition:w});function te(re){e&&e(re),re.defaultPrevented||q(re)}let se=H.createElement("a",{...E,...X,href:I||V,onClick:L||l?e:te,ref:rJ(T,W),target:m,"data-discover":!z&&n==="render"?"true":void 0});return B&&!z?H.createElement(H.Fragment,null,se,H.createElement(eJ,{page:V})):se});uF.displayName="Link";var aJ=H.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:o=!1,style:l,to:c,viewTransition:s,children:m,...y},b){let w=W_(c,{relative:y.relative}),E=yp(),T=H.useContext(H_),{navigator:R,basename:z}=H.useContext(Dh),I=T!=null&&gJ(w)&&s===!0,L=R.encodeLocation?R.encodeLocation(w).pathname:w.pathname,V=E.pathname,B=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;n||(V=V.toLowerCase(),B=B?B.toLowerCase():null,L=L.toLowerCase()),B&&z&&(B=Rc(B,z)||B);const W=L!=="/"&&L.endsWith("/")?L.length-1:L.length;let X=V===L||!o&&V.startsWith(L)&&V.charAt(W)==="/",q=B!=null&&(B===L||!o&&B.startsWith(L)&&B.charAt(L.length)==="/"),te={isActive:X,isPending:q,isTransitioning:I},se=X?e:void 0,re;typeof r=="function"?re=r(te):re=[r,X?"active":null,q?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let $=typeof l=="function"?l(te):l;return H.createElement(uF,{...y,"aria-current":se,className:re,ref:b,style:$,to:c,viewTransition:s},typeof m=="function"?m(te):m)});aJ.displayName="NavLink";var lJ=H.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:o,state:l,method:c=Zb,action:s,onSubmit:m,relative:y,preventScrollReset:b,viewTransition:w,...E},T)=>{let R=pJ(),z=mJ(s,{relative:y}),I=c.toLowerCase()==="get"?"get":"post",L=typeof s=="string"&&cF.test(s),V=B=>{if(m&&m(B),B.defaultPrevented)return;B.preventDefault();let W=B.nativeEvent.submitter,X=W?.getAttribute("formmethod")||c;R(W||B.currentTarget,{fetcherKey:e,method:X,navigate:n,replace:o,state:l,relative:y,preventScrollReset:b,viewTransition:w})};return H.createElement("form",{ref:T,method:I,action:z,onSubmit:r?m:V,...E,"data-discover":!L&&t==="render"?"true":void 0})});lJ.displayName="Form";function cJ(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function hF(t){let e=H.useContext(Zm);return Ur(e,cJ(t)),e}function uJ(t,{target:e,replace:n,state:r,preventScrollReset:o,relative:l,viewTransition:c}={}){let s=iF(),m=yp(),y=W_(t,{relative:l});return H.useCallback(b=>{if(NK(b,e)){b.preventDefault();let w=n!==void 0?n:ip(m)===ip(y);s(t,{replace:w,state:r,preventScrollReset:o,relative:l,viewTransition:c})}},[m,s,y,n,r,e,t,o,l,c])}function hJ(t){zo(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=H.useRef(P2(t)),n=H.useRef(!1),r=yp(),o=H.useMemo(()=>BK(r.search,n.current?null:e.current),[r.search]),l=iF(),c=H.useCallback((s,m)=>{const y=P2(typeof s=="function"?s(o):s);n.current=!0,l("?"+y,m)},[l,o]);return[o,c]}var dJ=0,fJ=()=>`__${String(++dJ)}__`;function pJ(){let{router:t}=hF("useSubmit"),{basename:e}=H.useContext(Dh),n=SK();return H.useCallback(async(r,o={})=>{let{action:l,method:c,encType:s,formData:m,body:y}=VK(r,e);if(o.navigate===!1){let b=o.fetcherKey||fJ();await t.fetch(b,n,o.action||l,{preventScrollReset:o.preventScrollReset,formData:m,body:y,formMethod:o.method||c,formEncType:o.encType||s,flushSync:o.flushSync})}else await t.navigate(o.action||l,{preventScrollReset:o.preventScrollReset,formData:m,body:y,formMethod:o.method||c,formEncType:o.encType||s,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[t,e,n])}function mJ(t,{relative:e}={}){let{basename:n}=H.useContext(Dh),r=H.useContext(Kd);Ur(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),l={...W_(t||".",{relative:e})},c=yp();if(t==null){l.search=c.search;let s=new URLSearchParams(l.search),m=s.getAll("index");if(m.some(b=>b==="")){s.delete("index"),m.filter(w=>w).forEach(w=>s.append("index",w));let b=s.toString();l.search=b?`?${b}`:""}}return(!t||t===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Ch([n,l.pathname])),ip(l)}function gJ(t,e={}){let n=H.useContext(WP);Ur(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=hF("useViewTransitionState"),o=W_(t,{relative:e.relative});if(!n.isTransitioning)return!1;let l=Rc(n.currentLocation.pathname,r)||n.currentLocation.pathname,c=Rc(n.nextLocation.pathname,r)||n.nextLocation.pathname;return M1(o.pathname,c)!=null||M1(o.pathname,l)!=null}[...YK];/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vJ(t){return H.createElement(AK,{flushSync:xw.flushSync,...t})}const D3=t=>t,yJ=()=>{let t=D3;return{configure(e){t=e},generate(e){return t(e)},reset(){t=D3}}},_J=yJ();function Um(t,...e){const n=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(r=>n.searchParams.append("args[]",r)),`Minified MUI error #${t}; visit ${n} for the full message.`}function Xv(t){if(typeof t!="string")throw new Error(Um(7));return t.charAt(0).toUpperCase()+t.slice(1)}function xJ(t,e,n=void 0){const r={};for(const o in t){const l=t[o];let c="",s=!0;for(let m=0;m<l.length;m+=1){const y=l[m];y&&(c+=(s===!0?"":" ")+e(y),s=!1,n&&n[y]&&(c+=" "+n[y]))}r[o]=c}return r}var iM={exports:{}},Ii={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k3;function bJ(){if(k3)return Ii;k3=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),E=Symbol.for("react.view_transition"),T=Symbol.for("react.client.reference");function R(z){if(typeof z=="object"&&z!==null){var I=z.$$typeof;switch(I){case t:switch(z=z.type,z){case n:case o:case r:case m:case y:case E:return z;default:switch(z=z&&z.$$typeof,z){case c:case s:case w:case b:return z;case l:return z;default:return I}}case e:return I}}}return Ii.ContextConsumer=l,Ii.ContextProvider=c,Ii.Element=t,Ii.ForwardRef=s,Ii.Fragment=n,Ii.Lazy=w,Ii.Memo=b,Ii.Portal=e,Ii.Profiler=o,Ii.StrictMode=r,Ii.Suspense=m,Ii.SuspenseList=y,Ii.isContextConsumer=function(z){return R(z)===l},Ii.isContextProvider=function(z){return R(z)===c},Ii.isElement=function(z){return typeof z=="object"&&z!==null&&z.$$typeof===t},Ii.isForwardRef=function(z){return R(z)===s},Ii.isFragment=function(z){return R(z)===n},Ii.isLazy=function(z){return R(z)===w},Ii.isMemo=function(z){return R(z)===b},Ii.isPortal=function(z){return R(z)===e},Ii.isProfiler=function(z){return R(z)===o},Ii.isStrictMode=function(z){return R(z)===r},Ii.isSuspense=function(z){return R(z)===m},Ii.isSuspenseList=function(z){return R(z)===y},Ii.isValidElementType=function(z){return typeof z=="string"||typeof z=="function"||z===n||z===o||z===r||z===m||z===y||typeof z=="object"&&z!==null&&(z.$$typeof===w||z.$$typeof===b||z.$$typeof===c||z.$$typeof===l||z.$$typeof===s||z.$$typeof===T||z.getModuleId!==void 0)},Ii.typeOf=R,Ii}var z3;function wJ(){return z3||(z3=1,iM.exports=bJ()),iM.exports}var dF=wJ();function Fd(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function fF(t){if(H.isValidElement(t)||dF.isValidElementType(t)||!Fd(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=fF(t[n])}),e}function Gl(t,e,n={clone:!0}){const r=n.clone?{...t}:t;return Fd(t)&&Fd(e)&&Object.keys(e).forEach(o=>{H.isValidElement(e[o])||dF.isValidElementType(e[o])?r[o]=e[o]:Fd(e[o])&&Object.prototype.hasOwnProperty.call(t,o)&&Fd(t[o])?r[o]=Gl(t[o],e[o],n):n.clone?r[o]=Fd(e[o])?fF(e[o]):e[o]:r[o]=e[o]}),r}function N0(t,e){return e?Gl(t,e,{clone:!1}):t}function O3(t,e){if(!t.containerQueries)return e;const n=Object.keys(e).filter(r=>r.startsWith("@container")).sort((r,o)=>{const l=/min-width:\s*([0-9.]+)/;return+(r.match(l)?.[1]||0)-+(o.match(l)?.[1]||0)});return n.length?n.reduce((r,o)=>{const l=e[o];return delete r[o],r[o]=l,r},{...e}):e}function SJ(t,e){return e==="@"||e.startsWith("@")&&(t.some(n=>e.startsWith(`@${n}`))||!!e.match(/^@\d/))}function MJ(t,e){const n=e.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,o]=n,l=Number.isNaN(+r)?r||0:+r;return t.containerQueries(o).up(l)}function CJ(t){const e=(l,c)=>l.replace("@media",c?`@container ${c}`:"@container");function n(l,c){l.up=(...s)=>e(t.breakpoints.up(...s),c),l.down=(...s)=>e(t.breakpoints.down(...s),c),l.between=(...s)=>e(t.breakpoints.between(...s),c),l.only=(...s)=>e(t.breakpoints.only(...s),c),l.not=(...s)=>{const m=e(t.breakpoints.not(...s),c);return m.includes("not all and")?m.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):m}}const r={},o=l=>(n(r,l),r);return n(o),{...t,containerQueries:o}}const kw={xs:0,sm:600,md:900,lg:1200,xl:1536},F3={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${kw[t]}px)`},EJ={containerQueries:t=>({up:e=>{let n=typeof e=="number"?e:kw[e]||e;return typeof n=="number"&&(n=`${n}px`),t?`@container ${t} (min-width:${n})`:`@container (min-width:${n})`}})};function Wd(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const l=r.breakpoints||F3;return e.reduce((c,s,m)=>(c[l.up(l.keys[m])]=n(e[m]),c),{})}if(typeof e=="object"){const l=r.breakpoints||F3;return Object.keys(e).reduce((c,s)=>{if(SJ(l.keys,s)){const m=MJ(r.containerQueries?r:EJ,s);m&&(c[m]=n(e[s],s))}else if(Object.keys(l.values||kw).includes(s)){const m=l.up(s);c[m]=n(e[s],s)}else{const m=s;c[m]=e[m]}return c},{})}return n(e)}function TJ(t={}){return t.keys?.reduce((n,r)=>{const o=t.up(r);return n[o]={},n},{})||{}}function N3(t,e){return t.reduce((n,r)=>{const o=n[r];return(!o||Object.keys(o).length===0)&&delete n[r],n},e)}function zw(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((o,l)=>o&&o[l]?o[l]:null,t);if(r!=null)return r}return e.split(".").reduce((r,o)=>r&&r[o]!=null?r[o]:null,t)}function T1(t,e,n,r=n){let o;return typeof t=="function"?o=t(n):Array.isArray(t)?o=t[n]||r:o=zw(t,n)||r,e&&(o=e(o,r,t)),o}function Fo(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:o}=t,l=c=>{if(c[e]==null)return null;const s=c[e],m=c.theme,y=zw(m,r)||{};return Wd(c,s,w=>{let E=T1(y,o,w);return w===E&&typeof w=="string"&&(E=T1(y,o,`${e}${w==="default"?"":Xv(w)}`,w)),n===!1?E:{[n]:E}})};return l.propTypes={},l.filterProps=[e],l}function PJ(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const AJ={m:"margin",p:"padding"},IJ={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},B3={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},RJ=PJ(t=>{if(t.length>2)if(B3[t])t=B3[t];else return[t];const[e,n]=t.split(""),r=AJ[e],o=IJ[n]||"";return Array.isArray(o)?o.map(l=>r+l):[r+o]}),JP=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],QP=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...JP,...QP];function q_(t,e,n,r){const o=zw(t,e,!0)??n;return typeof o=="number"||typeof o=="string"?l=>typeof l=="string"?l:typeof o=="string"?o.startsWith("var(")&&l===0?0:o.startsWith("var(")&&l===1?o:`calc(${l} * ${o})`:o*l:Array.isArray(o)?l=>{if(typeof l=="string")return l;const c=Math.abs(l),s=o[c];return l>=0?s:typeof s=="number"?-s:typeof s=="string"&&s.startsWith("var(")?`calc(-1 * ${s})`:`-${s}`}:typeof o=="function"?o:()=>{}}function eA(t){return q_(t,"spacing",8)}function X_(t,e){return typeof e=="string"||e==null?e:t(e)}function LJ(t,e){return n=>t.reduce((r,o)=>(r[o]=X_(e,n),r),{})}function DJ(t,e,n,r){if(!e.includes(n))return null;const o=RJ(n),l=LJ(o,r),c=t[n];return Wd(t,c,l)}function pF(t,e){const n=eA(t.theme);return Object.keys(t).map(r=>DJ(t,e,r,n)).reduce(N0,{})}function So(t){return pF(t,JP)}So.propTypes={};So.filterProps=JP;function Mo(t){return pF(t,QP)}Mo.propTypes={};Mo.filterProps=QP;function Ow(...t){const e=t.reduce((r,o)=>(o.filterProps.forEach(l=>{r[l]=o}),r),{}),n=r=>Object.keys(r).reduce((o,l)=>e[l]?N0(o,e[l](r)):o,{});return n.propTypes={},n.filterProps=t.reduce((r,o)=>r.concat(o.filterProps),[]),n}function Tc(t){return typeof t!="number"?t:`${t}px solid`}function Dc(t,e){return Fo({prop:t,themeKey:"borders",transform:e})}const kJ=Dc("border",Tc),zJ=Dc("borderTop",Tc),OJ=Dc("borderRight",Tc),FJ=Dc("borderBottom",Tc),NJ=Dc("borderLeft",Tc),BJ=Dc("borderColor"),UJ=Dc("borderTopColor"),$J=Dc("borderRightColor"),VJ=Dc("borderBottomColor"),jJ=Dc("borderLeftColor"),HJ=Dc("outline",Tc),GJ=Dc("outlineColor"),Fw=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=q_(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:X_(e,r)});return Wd(t,t.borderRadius,n)}return null};Fw.propTypes={};Fw.filterProps=["borderRadius"];Ow(kJ,zJ,OJ,FJ,NJ,BJ,UJ,$J,VJ,jJ,Fw,HJ,GJ);const Nw=t=>{if(t.gap!==void 0&&t.gap!==null){const e=q_(t.theme,"spacing",8),n=r=>({gap:X_(e,r)});return Wd(t,t.gap,n)}return null};Nw.propTypes={};Nw.filterProps=["gap"];const Bw=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=q_(t.theme,"spacing",8),n=r=>({columnGap:X_(e,r)});return Wd(t,t.columnGap,n)}return null};Bw.propTypes={};Bw.filterProps=["columnGap"];const Uw=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=q_(t.theme,"spacing",8),n=r=>({rowGap:X_(e,r)});return Wd(t,t.rowGap,n)}return null};Uw.propTypes={};Uw.filterProps=["rowGap"];const WJ=Fo({prop:"gridColumn"}),qJ=Fo({prop:"gridRow"}),XJ=Fo({prop:"gridAutoFlow"}),ZJ=Fo({prop:"gridAutoColumns"}),YJ=Fo({prop:"gridAutoRows"}),KJ=Fo({prop:"gridTemplateColumns"}),JJ=Fo({prop:"gridTemplateRows"}),QJ=Fo({prop:"gridTemplateAreas"}),eQ=Fo({prop:"gridArea"});Ow(Nw,Bw,Uw,WJ,qJ,XJ,ZJ,YJ,KJ,JJ,QJ,eQ);function zv(t,e){return e==="grey"?e:t}const tQ=Fo({prop:"color",themeKey:"palette",transform:zv}),nQ=Fo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:zv}),rQ=Fo({prop:"backgroundColor",themeKey:"palette",transform:zv});Ow(tQ,nQ,rQ);function Bl(t){return t<=1&&t!==0?`${t*100}%`:t}const iQ=Fo({prop:"width",transform:Bl}),tA=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{const r=t.theme?.breakpoints?.values?.[n]||kw[n];return r?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${r}${t.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:Bl(n)}};return Wd(t,t.maxWidth,e)}return null};tA.filterProps=["maxWidth"];const oQ=Fo({prop:"minWidth",transform:Bl}),sQ=Fo({prop:"height",transform:Bl}),aQ=Fo({prop:"maxHeight",transform:Bl}),lQ=Fo({prop:"minHeight",transform:Bl});Fo({prop:"size",cssProperty:"width",transform:Bl});Fo({prop:"size",cssProperty:"height",transform:Bl});const cQ=Fo({prop:"boxSizing"});Ow(iQ,tA,oQ,sQ,aQ,lQ,cQ);const $w={border:{themeKey:"borders",transform:Tc},borderTop:{themeKey:"borders",transform:Tc},borderRight:{themeKey:"borders",transform:Tc},borderBottom:{themeKey:"borders",transform:Tc},borderLeft:{themeKey:"borders",transform:Tc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Tc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Fw},color:{themeKey:"palette",transform:zv},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:zv},backgroundColor:{themeKey:"palette",transform:zv},p:{style:Mo},pt:{style:Mo},pr:{style:Mo},pb:{style:Mo},pl:{style:Mo},px:{style:Mo},py:{style:Mo},padding:{style:Mo},paddingTop:{style:Mo},paddingRight:{style:Mo},paddingBottom:{style:Mo},paddingLeft:{style:Mo},paddingX:{style:Mo},paddingY:{style:Mo},paddingInline:{style:Mo},paddingInlineStart:{style:Mo},paddingInlineEnd:{style:Mo},paddingBlock:{style:Mo},paddingBlockStart:{style:Mo},paddingBlockEnd:{style:Mo},m:{style:So},mt:{style:So},mr:{style:So},mb:{style:So},ml:{style:So},mx:{style:So},my:{style:So},margin:{style:So},marginTop:{style:So},marginRight:{style:So},marginBottom:{style:So},marginLeft:{style:So},marginX:{style:So},marginY:{style:So},marginInline:{style:So},marginInlineStart:{style:So},marginInlineEnd:{style:So},marginBlock:{style:So},marginBlockStart:{style:So},marginBlockEnd:{style:So},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Nw},rowGap:{style:Uw},columnGap:{style:Bw},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Bl},maxWidth:{style:tA},minWidth:{transform:Bl},height:{transform:Bl},maxHeight:{transform:Bl},minHeight:{transform:Bl},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function uQ(...t){const e=t.reduce((r,o)=>r.concat(Object.keys(o)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function hQ(t,e){return typeof t=="function"?t(e):t}function dQ(){function t(n,r,o,l){const c={[n]:r,theme:o},s=l[n];if(!s)return{[n]:r};const{cssProperty:m=n,themeKey:y,transform:b,style:w}=s;if(r==null)return null;if(y==="typography"&&r==="inherit")return{[n]:r};const E=zw(o,y)||{};return w?w(c):Wd(c,r,R=>{let z=T1(E,b,R);return R===z&&typeof R=="string"&&(z=T1(E,b,`${n}${R==="default"?"":Xv(R)}`,R)),m===!1?z:{[m]:z}})}function e(n){const{sx:r,theme:o={},nested:l}=n||{};if(!r)return null;const c=o.unstable_sxConfig??$w;function s(m){let y=m;if(typeof m=="function")y=m(o);else if(typeof m!="object")return m;if(!y)return null;const b=TJ(o.breakpoints),w=Object.keys(b);let E=b;return Object.keys(y).forEach(T=>{const R=hQ(y[T],o);if(R!=null)if(typeof R=="object")if(c[T])E=N0(E,t(T,R,o,c));else{const z=Wd({theme:o},R,I=>({[T]:I}));uQ(z,R)?E[T]=e({sx:R,theme:o,nested:!0}):E=N0(E,z)}else E=N0(E,t(T,R,o,c))}),!l&&o.modularCssLayers?{"@layer sx":O3(o,N3(w,E))}:O3(o,N3(w,E))}return Array.isArray(r)?r.map(s):s(r)}return e}const Zv=dQ();Zv.filterProps=["sx"];function fQ(t,e){return m1(t,e)}function pQ(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const U3=[];function Om(t){return U3[0]=t,I_(U3)}const mQ=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>({...n,[r.key]:r.val}),{})};function gQ(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...o}=t,l=mQ(e),c=Object.keys(l);function s(E){return`@media (min-width:${typeof e[E]=="number"?e[E]:E}${n})`}function m(E){return`@media (max-width:${(typeof e[E]=="number"?e[E]:E)-r/100}${n})`}function y(E,T){const R=c.indexOf(T);return`@media (min-width:${typeof e[E]=="number"?e[E]:E}${n}) and (max-width:${(R!==-1&&typeof e[c[R]]=="number"?e[c[R]]:T)-r/100}${n})`}function b(E){return c.indexOf(E)+1<c.length?y(E,c[c.indexOf(E)+1]):s(E)}function w(E){const T=c.indexOf(E);return T===0?s(c[1]):T===c.length-1?m(c[T]):y(E,c[c.indexOf(E)+1]).replace("@media","@media not all and")}return{keys:c,values:l,up:s,down:m,between:y,only:b,not:w,unit:n,...o}}const vQ={borderRadius:4};function mF(t=8,e=eA({spacing:t})){if(t.mui)return t;const n=(...r)=>(r.length===0?[1]:r).map(l=>{const c=e(l);return typeof c=="number"?`${c}px`:c}).join(" ");return n.mui=!0,n}function yQ(t,e){const n=this;if(n.vars){if(!n.colorSchemes?.[t]||typeof n.getColorSchemeSelector!="function")return{};let r=n.getColorSchemeSelector(t);return r==="&"?e:((r.includes("data-")||r.includes("."))&&(r=`*:where(${r.replace(/\s*&$/,"")}) &`),{[r]:e})}return n.palette.mode===t?e:{}}function gF(t={},...e){const{breakpoints:n={},palette:r={},spacing:o,shape:l={},...c}=t,s=gQ(n),m=mF(o);let y=Gl({breakpoints:s,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:m,shape:{...vQ,...l}},c);return y=CJ(y),y.applyStyles=yQ,y=e.reduce((b,w)=>Gl(b,w),y),y.unstable_sxConfig={...$w,...c?.unstable_sxConfig},y.unstable_sx=function(w){return Zv({sx:w,theme:this})},y}const _Q={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function vF(t,e,n="Mui"){const r=_Q[e];return r?`${n}-${r}`:`${_J.generate(t)}-${e}`}function xQ(t,e,n="Mui"){const r={};return e.forEach(o=>{r[o]=vF(t,o,n)}),r}function yF(t){const{variants:e,...n}=t,r={variants:e,style:Om(n),isProcessed:!0};return r.style===n||e&&e.forEach(o=>{typeof o.style!="function"&&(o.style=Om(o.style))}),r}const bQ=gF();function oM(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Lm(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function wQ(t){return t?(e,n)=>n[t]:null}function SQ(t,e,n){t.theme=EQ(t.theme)?n:t.theme[e]||t.theme}function Kb(t,e,n){const r=typeof e=="function"?e(t):e;if(Array.isArray(r))return r.flatMap(o=>Kb(t,o,n));if(Array.isArray(r?.variants)){let o;if(r.isProcessed)o=n?Lm(r.style,n):r.style;else{const{variants:l,...c}=r;o=n?Lm(Om(c),n):c}return _F(t,r.variants,[o],n)}return r?.isProcessed?n?Lm(Om(r.style),n):r.style:n?Lm(Om(r),n):r}function _F(t,e,n=[],r=void 0){let o;e:for(let l=0;l<e.length;l+=1){const c=e[l];if(typeof c.props=="function"){if(o??={...t,...t.ownerState,ownerState:t.ownerState},!c.props(o))continue}else for(const s in c.props)if(t[s]!==c.props[s]&&t.ownerState?.[s]!==c.props[s])continue e;typeof c.style=="function"?(o??={...t,...t.ownerState,ownerState:t.ownerState},n.push(r?Lm(Om(c.style(o)),r):c.style(o))):n.push(r?Lm(Om(c.style),r):c.style)}return n}function MQ(t={}){const{themeId:e,defaultTheme:n=bQ,rootShouldForwardProp:r=oM,slotShouldForwardProp:o=oM}=t;function l(s){SQ(s,e,n)}return(s,m={})=>{pQ(s,q=>q.filter(te=>te!==Zv));const{name:y,slot:b,skipVariantsResolver:w,skipSx:E,overridesResolver:T=wQ(PQ(b)),...R}=m,z=y&&y.startsWith("Mui")||b?"components":"custom",I=w!==void 0?w:b&&b!=="Root"&&b!=="root"||!1,L=E||!1;let V=oM;b==="Root"||b==="root"?V=r:b?V=o:TQ(s)&&(V=void 0);const B=fQ(s,{shouldForwardProp:V,label:CQ(),...R}),W=q=>{if(q.__emotion_real===q)return q;if(typeof q=="function")return function(se){return Kb(se,q,se.theme.modularCssLayers?z:void 0)};if(Fd(q)){const te=yF(q);return function(re){return te.variants?Kb(re,te,re.theme.modularCssLayers?z:void 0):re.theme.modularCssLayers?Lm(te.style,z):te.style}}return q},X=(...q)=>{const te=[],se=q.map(W),re=[];if(te.push(l),y&&T&&re.push(function(Se){const Fe=Se.theme.components?.[y]?.styleOverrides;if(!Fe)return null;const Me={};for(const Te in Fe)Me[Te]=Kb(Se,Fe[Te],Se.theme.modularCssLayers?"theme":void 0);return T(Se,Me)}),y&&!I&&re.push(function(Se){const Fe=Se.theme?.components?.[y]?.variants;return Fe?_F(Se,Fe,[],Se.theme.modularCssLayers?"theme":void 0):null}),L||re.push(Zv),Array.isArray(se[0])){const Ce=se.shift(),Se=new Array(te.length).fill(""),Xe=new Array(re.length).fill("");let Fe;Fe=[...Se,...Ce,...Xe],Fe.raw=[...Se,...Ce.raw,...Xe],te.unshift(Fe)}const $=[...te,...se,...re],ce=B(...$);return s.muiName&&(ce.muiName=s.muiName),ce};return B.withConfig&&(X.withConfig=B.withConfig),X}}function CQ(t,e){return void 0}function EQ(t){for(const e in t)return!1;return!0}function TQ(t){return typeof t=="string"&&t.charCodeAt(0)>96}function PQ(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function A2(t,e,n=!1){const r={...e};for(const o in t)if(Object.prototype.hasOwnProperty.call(t,o)){const l=o;if(l==="components"||l==="slots")r[l]={...t[l],...r[l]};else if(l==="componentsProps"||l==="slotProps"){const c=t[l],s=e[l];if(!s)r[l]=c||{};else if(!c)r[l]=s;else{r[l]={...s};for(const m in c)if(Object.prototype.hasOwnProperty.call(c,m)){const y=m;r[l][y]=A2(c[y],s[y],n)}}}else l==="className"&&n&&e.className?r.className=co(t?.className,e?.className):l==="style"&&n&&e.style?r.style={...t?.style,...e?.style}:r[l]===void 0&&(r[l]=t[l])}return r}function AQ(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}function nA(t,e=0,n=1){return AQ(t,e,n)}function IQ(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,o)=>o<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function op(t){if(t.type)return t;if(t.charAt(0)==="#")return op(IQ(t));const e=t.indexOf("("),n=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(Um(9,t));let r=t.substring(e+1,t.length-1),o;if(n==="color"){if(r=r.split(" "),o=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(o))throw new Error(Um(10,o))}else r=r.split(",");return r=r.map(l=>parseFloat(l)),{type:n,values:r,colorSpace:o}}const RQ=t=>{const e=op(t);return e.values.slice(0,3).map((n,r)=>e.type.includes("hsl")&&r!==0?`${n}%`:n).join(" ")},C0=(t,e)=>{try{return RQ(t)}catch{return t}};function Vw(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.includes("rgb")?r=r.map((o,l)=>l<3?parseInt(o,10):o):e.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.includes("color")?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function xF(t){t=op(t);const{values:e}=t,n=e[0],r=e[1]/100,o=e[2]/100,l=r*Math.min(o,1-o),c=(y,b=(y+n/30)%12)=>o-l*Math.max(Math.min(b-3,9-b,1),-1);let s="rgb";const m=[Math.round(c(0)*255),Math.round(c(8)*255),Math.round(c(4)*255)];return t.type==="hsla"&&(s+="a",m.push(e[3])),Vw({type:s,values:m})}function I2(t){t=op(t);let e=t.type==="hsl"||t.type==="hsla"?op(xF(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function LQ(t,e){const n=I2(t),r=I2(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function DQ(t,e){return t=op(t),e=nA(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,Vw(t)}function nb(t,e,n){try{return DQ(t,e)}catch{return t}}function rA(t,e){if(t=op(t),e=nA(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]*=1-e;return Vw(t)}function zi(t,e,n){try{return rA(t,e)}catch{return t}}function iA(t,e){if(t=op(t),e=nA(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return Vw(t)}function Oi(t,e,n){try{return iA(t,e)}catch{return t}}function kQ(t,e=.15){return I2(t)>.5?rA(t,e):iA(t,e)}function rb(t,e,n){try{return kQ(t,e)}catch{return t}}const zQ=H.createContext(void 0);function OQ(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const o=e.components[n];return o.defaultProps?A2(o.defaultProps,r,e.components.mergeClassNameAndStyle):!o.styleOverrides&&!o.variants?A2(o,r,e.components.mergeClassNameAndStyle):r}function FQ({props:t,name:e}){const n=H.useContext(zQ);return OQ({props:t,name:e,theme:{components:n}})}const $3={theme:void 0};function NQ(t){let e,n;return function(o){let l=e;return(l===void 0||o.theme!==n)&&($3.theme=o.theme,l=yF(t($3)),e=l,n=o.theme),l}}function BQ(t=""){function e(...r){if(!r.length)return"";const o=r[0];return typeof o=="string"&&!o.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${o}${e(...r.slice(1))})`:`, ${o}`}return(r,...o)=>`var(--${t?`${t}-`:""}${r}${e(...o)})`}const V3=(t,e,n,r=[])=>{let o=t;e.forEach((l,c)=>{c===e.length-1?Array.isArray(o)?o[Number(l)]=n:o&&typeof o=="object"&&(o[l]=n):o&&typeof o=="object"&&(o[l]||(o[l]=r.includes(l)?[]:{}),o=o[l])})},UQ=(t,e,n)=>{function r(o,l=[],c=[]){Object.entries(o).forEach(([s,m])=>{(!n||n&&!n([...l,s]))&&m!=null&&(typeof m=="object"&&Object.keys(m).length>0?r(m,[...l,s],Array.isArray(m)?[...c,s]:c):e([...l,s],m,c))})}r(t)},$Q=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>t.includes(r))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function sM(t,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},o={},l={},c={};return UQ(t,(s,m,y)=>{if((typeof m=="string"||typeof m=="number")&&(!r||!r(s,m))){const b=`--${n?`${n}-`:""}${s.join("-")}`,w=$Q(s,m);Object.assign(o,{[b]:w}),V3(l,s,`var(${b})`,y),V3(c,s,`var(${b}, ${w})`,y)}},s=>s[0]==="vars"),{css:o,vars:l,varsWithDefaults:c}}function VQ(t,e={}){const{getSelector:n=I,disableCssColorScheme:r,colorSchemeSelector:o}=e,{colorSchemes:l={},components:c,defaultColorScheme:s="light",...m}=t,{vars:y,css:b,varsWithDefaults:w}=sM(m,e);let E=w;const T={},{[s]:R,...z}=l;if(Object.entries(z||{}).forEach(([B,W])=>{const{vars:X,css:q,varsWithDefaults:te}=sM(W,e);E=Gl(E,te),T[B]={css:q,vars:X}}),R){const{css:B,vars:W,varsWithDefaults:X}=sM(R,e);E=Gl(E,X),T[s]={css:B,vars:W}}function I(B,W){let X=o;if(o==="class"&&(X=".%s"),o==="data"&&(X="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(X=`[${o}="%s"]`),B){if(X==="media")return t.defaultColorScheme===B?":root":{[`@media (prefers-color-scheme: ${l[B]?.palette?.mode||B})`]:{":root":W}};if(X)return t.defaultColorScheme===B?`:root, ${X.replace("%s",String(B))}`:X.replace("%s",String(B))}return":root"}return{vars:E,generateThemeVars:()=>{let B={...y};return Object.entries(T).forEach(([,{vars:W}])=>{B=Gl(B,W)}),B},generateStyleSheets:()=>{const B=[],W=t.defaultColorScheme||"light";function X(se,re){Object.keys(re).length&&B.push(typeof se=="string"?{[se]:{...re}}:se)}X(n(void 0,{...b}),b);const{[W]:q,...te}=T;if(q){const{css:se}=q,re=l[W]?.palette?.mode,$=!r&&re?{colorScheme:re,...se}:{...se};X(n(W,{...$}),$)}return Object.entries(te).forEach(([se,{css:re}])=>{const $=l[se]?.palette?.mode,ce=!r&&$?{colorScheme:$,...re}:{...re};X(n(se,{...ce}),ce)}),B}}}function jQ(t){return function(n){return t==="media"?`@media (prefers-color-scheme: ${n})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${n}"] &`:t==="class"?`.${n} &`:t==="data"?`[data-${n}] &`:`${t.replace("%s",n)} &`:"&"}}const g_={black:"#000",white:"#fff"},HQ={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Gg={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Wg={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},c0={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},qg={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Xg={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Zg={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function bF(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:g_.white,default:g_.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const GQ=bF();function wF(){return{text:{primary:g_.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:g_.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const j3=wF();function H3(t,e,n,r){const o=r.light||r,l=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=iA(t.main,o):e==="dark"&&(t.dark=rA(t.main,l)))}function WQ(t="light"){return t==="dark"?{main:qg[200],light:qg[50],dark:qg[400]}:{main:qg[700],light:qg[400],dark:qg[800]}}function qQ(t="light"){return t==="dark"?{main:Gg[200],light:Gg[50],dark:Gg[400]}:{main:Gg[500],light:Gg[300],dark:Gg[700]}}function XQ(t="light"){return t==="dark"?{main:Wg[500],light:Wg[300],dark:Wg[700]}:{main:Wg[700],light:Wg[400],dark:Wg[800]}}function ZQ(t="light"){return t==="dark"?{main:Xg[400],light:Xg[300],dark:Xg[700]}:{main:Xg[700],light:Xg[500],dark:Xg[900]}}function YQ(t="light"){return t==="dark"?{main:Zg[400],light:Zg[300],dark:Zg[700]}:{main:Zg[800],light:Zg[500],dark:Zg[900]}}function KQ(t="light"){return t==="dark"?{main:c0[400],light:c0[300],dark:c0[700]}:{main:"#ed6c02",light:c0[500],dark:c0[900]}}function oA(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2,...o}=t,l=t.primary||WQ(e),c=t.secondary||qQ(e),s=t.error||XQ(e),m=t.info||ZQ(e),y=t.success||YQ(e),b=t.warning||KQ(e);function w(z){return LQ(z,j3.text.primary)>=n?j3.text.primary:GQ.text.primary}const E=({color:z,name:I,mainShade:L=500,lightShade:V=300,darkShade:B=700})=>{if(z={...z},!z.main&&z[L]&&(z.main=z[L]),!z.hasOwnProperty("main"))throw new Error(Um(11,I?` (${I})`:"",L));if(typeof z.main!="string")throw new Error(Um(12,I?` (${I})`:"",JSON.stringify(z.main)));return H3(z,"light",V,r),H3(z,"dark",B,r),z.contrastText||(z.contrastText=w(z.main)),z};let T;return e==="light"?T=bF():e==="dark"&&(T=wF()),Gl({common:{...g_},mode:e,primary:E({color:l,name:"primary"}),secondary:E({color:c,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:E({color:s,name:"error"}),warning:E({color:b,name:"warning"}),info:E({color:m,name:"info"}),success:E({color:y,name:"success"}),grey:HQ,contrastThreshold:n,getContrastText:w,augmentColor:E,tonalOffset:r,...T},o)}function JQ(t){const e={};return Object.entries(t).forEach(r=>{const[o,l]=r;typeof l=="object"&&(e[o]=`${l.fontStyle?`${l.fontStyle} `:""}${l.fontVariant?`${l.fontVariant} `:""}${l.fontWeight?`${l.fontWeight} `:""}${l.fontStretch?`${l.fontStretch} `:""}${l.fontSize||""}${l.lineHeight?`/${l.lineHeight} `:""}${l.fontFamily||""}`)}),e}function QQ(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function eee(t){return Math.round(t*1e5)/1e5}const G3={textTransform:"uppercase"},W3='"Roboto", "Helvetica", "Arial", sans-serif';function tee(t,e){const{fontFamily:n=W3,fontSize:r=14,fontWeightLight:o=300,fontWeightRegular:l=400,fontWeightMedium:c=500,fontWeightBold:s=700,htmlFontSize:m=16,allVariants:y,pxToRem:b,...w}=typeof e=="function"?e(t):e,E=r/14,T=b||(I=>`${I/m*E}rem`),R=(I,L,V,B,W)=>({fontFamily:n,fontWeight:I,fontSize:T(L),lineHeight:V,...n===W3?{letterSpacing:`${eee(B/L)}em`}:{},...W,...y}),z={h1:R(o,96,1.167,-1.5),h2:R(o,60,1.2,-.5),h3:R(l,48,1.167,0),h4:R(l,34,1.235,.25),h5:R(l,24,1.334,0),h6:R(c,20,1.6,.15),subtitle1:R(l,16,1.75,.15),subtitle2:R(c,14,1.57,.1),body1:R(l,16,1.5,.15),body2:R(l,14,1.43,.15),button:R(c,14,1.75,.4,G3),caption:R(l,12,1.66,.4),overline:R(l,12,2.66,1,G3),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Gl({htmlFontSize:m,pxToRem:T,fontFamily:n,fontSize:r,fontWeightLight:o,fontWeightRegular:l,fontWeightMedium:c,fontWeightBold:s,...z},w,{clone:!1})}const nee=.2,ree=.14,iee=.12;function no(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${nee})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${ree})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${iee})`].join(",")}const oee=["none",no(0,2,1,-1,0,1,1,0,0,1,3,0),no(0,3,1,-2,0,2,2,0,0,1,5,0),no(0,3,3,-2,0,3,4,0,0,1,8,0),no(0,2,4,-1,0,4,5,0,0,1,10,0),no(0,3,5,-1,0,5,8,0,0,1,14,0),no(0,3,5,-1,0,6,10,0,0,1,18,0),no(0,4,5,-2,0,7,10,1,0,2,16,1),no(0,5,5,-3,0,8,10,1,0,3,14,2),no(0,5,6,-3,0,9,12,1,0,3,16,2),no(0,6,6,-3,0,10,14,1,0,4,18,3),no(0,6,7,-4,0,11,15,1,0,4,20,3),no(0,7,8,-4,0,12,17,2,0,5,22,4),no(0,7,8,-4,0,13,19,2,0,5,24,4),no(0,7,9,-4,0,14,21,2,0,5,26,4),no(0,8,9,-5,0,15,22,2,0,6,28,5),no(0,8,10,-5,0,16,24,2,0,6,30,5),no(0,8,11,-5,0,17,26,2,0,6,32,5),no(0,9,11,-5,0,18,28,2,0,7,34,6),no(0,9,12,-6,0,19,29,2,0,7,36,6),no(0,10,13,-6,0,20,31,3,0,8,38,7),no(0,10,13,-6,0,21,33,3,0,8,40,7),no(0,10,14,-6,0,22,35,3,0,8,42,7),no(0,11,14,-7,0,23,36,3,0,9,44,8),no(0,11,15,-7,0,24,38,3,0,9,46,8)],see={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},aee={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function q3(t){return`${Math.round(t)}ms`}function lee(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function cee(t){const e={...see,...t.easing},n={...aee,...t.duration};return{getAutoHeightDuration:lee,create:(o=["all"],l={})=>{const{duration:c=n.standard,easing:s=e.easeInOut,delay:m=0,...y}=l;return(Array.isArray(o)?o:[o]).map(b=>`${b} ${typeof c=="string"?c:q3(c)} ${s} ${typeof m=="string"?m:q3(m)}`).join(",")},...t,easing:e,duration:n}}const uee={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function hee(t){return Fd(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function SF(t={}){const e={...t};function n(r){const o=Object.entries(r);for(let l=0;l<o.length;l++){const[c,s]=o[l];!hee(s)||c.startsWith("unstable_")?delete r[c]:Fd(s)&&(r[c]={...s},n(r[c]))}}return n(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function R2(t={},...e){const{breakpoints:n,mixins:r={},spacing:o,palette:l={},transitions:c={},typography:s={},shape:m,...y}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(Um(20));const b=oA(l),w=gF(t);let E=Gl(w,{mixins:QQ(w.breakpoints,r),palette:b,shadows:oee.slice(),typography:tee(b,s),transitions:cee(c),zIndex:{...uee}});return E=Gl(E,y),E=e.reduce((T,R)=>Gl(T,R),E),E.unstable_sxConfig={...$w,...y?.unstable_sxConfig},E.unstable_sx=function(R){return Zv({sx:R,theme:this})},E.toRuntimeSource=SF,E}function dee(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const fee=[...Array(25)].map((t,e)=>{if(e===0)return"none";const n=dee(e);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function MF(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function CF(t){return t==="dark"?fee:[]}function pee(t){const{palette:e={mode:"light"},opacity:n,overlays:r,...o}=t,l=oA(e);return{palette:l,opacity:{...MF(l.mode),...n},overlays:r||CF(l.mode),...o}}function mee(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const gee=t=>[...[...Array(25)].map((e,n)=>`--${t?`${t}-`:""}overlays-${n}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],vee=t=>(e,n)=>{const r=t.rootSelector||":root",o=t.colorSchemeSelector;let l=o;if(o==="class"&&(l=".%s"),o==="data"&&(l="[data-%s]"),o?.startsWith("data-")&&!o.includes("%s")&&(l=`[${o}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const c={};return gee(t.cssVarPrefix).forEach(s=>{c[s]=n[s],delete n[s]}),l==="media"?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:c}}:l?{[l.replace("%s",e)]:c,[`${r}, ${l.replace("%s",e)}`]:n}:{[r]:{...n,...c}}}if(l&&l!=="media")return`${r}, ${l.replace("%s",String(e))}`}else if(e){if(l==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[r]:n}};if(l)return l.replace("%s",String(e))}return r};function yee(t,e){e.forEach(n=>{t[n]||(t[n]={})})}function en(t,e,n){!t[e]&&n&&(t[e]=n)}function E0(t){return typeof t!="string"||!t.startsWith("hsl")?t:xF(t)}function Pd(t,e){`${e}Channel`in t||(t[`${e}Channel`]=C0(E0(t[e])))}function _ee(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const hh=t=>{try{return t()}catch{}},xee=(t="mui")=>BQ(t);function aM(t,e,n,r){if(!e)return;e=e===!0?{}:e;const o=r==="dark"?"dark":"light";if(!n){t[r]=pee({...e,palette:{mode:o,...e?.palette}});return}const{palette:l,...c}=R2({...n,palette:{mode:o,...e?.palette}});return t[r]={...e,palette:l,opacity:{...MF(o),...e?.opacity},overlays:e?.overlays||CF(o)},c}function bee(t={},...e){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:o=!1,cssVarPrefix:l="mui",shouldSkipGeneratingVar:c=mee,colorSchemeSelector:s=n.light&&n.dark?"media":void 0,rootSelector:m=":root",...y}=t,b=Object.keys(n)[0],w=r||(n.light&&b!=="light"?"light":b),E=xee(l),{[w]:T,light:R,dark:z,...I}=n,L={...I};let V=T;if((w==="dark"&&!("dark"in n)||w==="light"&&!("light"in n))&&(V=!0),!V)throw new Error(Um(21,w));const B=aM(L,V,y,w);R&&!L.light&&aM(L,R,void 0,"light"),z&&!L.dark&&aM(L,z,void 0,"dark");let W={defaultColorScheme:w,...B,cssVarPrefix:l,colorSchemeSelector:s,rootSelector:m,getCssVar:E,colorSchemes:L,font:{...JQ(B.typography),...B.font},spacing:_ee(y.spacing)};Object.keys(W.colorSchemes).forEach(re=>{const $=W.colorSchemes[re].palette,ce=Ce=>{const Se=Ce.split("-"),Xe=Se[1],Fe=Se[2];return E(Ce,$[Xe][Fe])};if($.mode==="light"&&(en($.common,"background","#fff"),en($.common,"onBackground","#000")),$.mode==="dark"&&(en($.common,"background","#000"),en($.common,"onBackground","#fff")),yee($,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),$.mode==="light"){en($.Alert,"errorColor",zi($.error.light,.6)),en($.Alert,"infoColor",zi($.info.light,.6)),en($.Alert,"successColor",zi($.success.light,.6)),en($.Alert,"warningColor",zi($.warning.light,.6)),en($.Alert,"errorFilledBg",ce("palette-error-main")),en($.Alert,"infoFilledBg",ce("palette-info-main")),en($.Alert,"successFilledBg",ce("palette-success-main")),en($.Alert,"warningFilledBg",ce("palette-warning-main")),en($.Alert,"errorFilledColor",hh(()=>$.getContrastText($.error.main))),en($.Alert,"infoFilledColor",hh(()=>$.getContrastText($.info.main))),en($.Alert,"successFilledColor",hh(()=>$.getContrastText($.success.main))),en($.Alert,"warningFilledColor",hh(()=>$.getContrastText($.warning.main))),en($.Alert,"errorStandardBg",Oi($.error.light,.9)),en($.Alert,"infoStandardBg",Oi($.info.light,.9)),en($.Alert,"successStandardBg",Oi($.success.light,.9)),en($.Alert,"warningStandardBg",Oi($.warning.light,.9)),en($.Alert,"errorIconColor",ce("palette-error-main")),en($.Alert,"infoIconColor",ce("palette-info-main")),en($.Alert,"successIconColor",ce("palette-success-main")),en($.Alert,"warningIconColor",ce("palette-warning-main")),en($.AppBar,"defaultBg",ce("palette-grey-100")),en($.Avatar,"defaultBg",ce("palette-grey-400")),en($.Button,"inheritContainedBg",ce("palette-grey-300")),en($.Button,"inheritContainedHoverBg",ce("palette-grey-A100")),en($.Chip,"defaultBorder",ce("palette-grey-400")),en($.Chip,"defaultAvatarColor",ce("palette-grey-700")),en($.Chip,"defaultIconColor",ce("palette-grey-700")),en($.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),en($.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),en($.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),en($.LinearProgress,"primaryBg",Oi($.primary.main,.62)),en($.LinearProgress,"secondaryBg",Oi($.secondary.main,.62)),en($.LinearProgress,"errorBg",Oi($.error.main,.62)),en($.LinearProgress,"infoBg",Oi($.info.main,.62)),en($.LinearProgress,"successBg",Oi($.success.main,.62)),en($.LinearProgress,"warningBg",Oi($.warning.main,.62)),en($.Skeleton,"bg",`rgba(${ce("palette-text-primaryChannel")} / 0.11)`),en($.Slider,"primaryTrack",Oi($.primary.main,.62)),en($.Slider,"secondaryTrack",Oi($.secondary.main,.62)),en($.Slider,"errorTrack",Oi($.error.main,.62)),en($.Slider,"infoTrack",Oi($.info.main,.62)),en($.Slider,"successTrack",Oi($.success.main,.62)),en($.Slider,"warningTrack",Oi($.warning.main,.62));const Ce=rb($.background.default,.8);en($.SnackbarContent,"bg",Ce),en($.SnackbarContent,"color",hh(()=>$.getContrastText(Ce))),en($.SpeedDialAction,"fabHoverBg",rb($.background.paper,.15)),en($.StepConnector,"border",ce("palette-grey-400")),en($.StepContent,"border",ce("palette-grey-400")),en($.Switch,"defaultColor",ce("palette-common-white")),en($.Switch,"defaultDisabledColor",ce("palette-grey-100")),en($.Switch,"primaryDisabledColor",Oi($.primary.main,.62)),en($.Switch,"secondaryDisabledColor",Oi($.secondary.main,.62)),en($.Switch,"errorDisabledColor",Oi($.error.main,.62)),en($.Switch,"infoDisabledColor",Oi($.info.main,.62)),en($.Switch,"successDisabledColor",Oi($.success.main,.62)),en($.Switch,"warningDisabledColor",Oi($.warning.main,.62)),en($.TableCell,"border",Oi(nb($.divider,1),.88)),en($.Tooltip,"bg",nb($.grey[700],.92))}if($.mode==="dark"){en($.Alert,"errorColor",Oi($.error.light,.6)),en($.Alert,"infoColor",Oi($.info.light,.6)),en($.Alert,"successColor",Oi($.success.light,.6)),en($.Alert,"warningColor",Oi($.warning.light,.6)),en($.Alert,"errorFilledBg",ce("palette-error-dark")),en($.Alert,"infoFilledBg",ce("palette-info-dark")),en($.Alert,"successFilledBg",ce("palette-success-dark")),en($.Alert,"warningFilledBg",ce("palette-warning-dark")),en($.Alert,"errorFilledColor",hh(()=>$.getContrastText($.error.dark))),en($.Alert,"infoFilledColor",hh(()=>$.getContrastText($.info.dark))),en($.Alert,"successFilledColor",hh(()=>$.getContrastText($.success.dark))),en($.Alert,"warningFilledColor",hh(()=>$.getContrastText($.warning.dark))),en($.Alert,"errorStandardBg",zi($.error.light,.9)),en($.Alert,"infoStandardBg",zi($.info.light,.9)),en($.Alert,"successStandardBg",zi($.success.light,.9)),en($.Alert,"warningStandardBg",zi($.warning.light,.9)),en($.Alert,"errorIconColor",ce("palette-error-main")),en($.Alert,"infoIconColor",ce("palette-info-main")),en($.Alert,"successIconColor",ce("palette-success-main")),en($.Alert,"warningIconColor",ce("palette-warning-main")),en($.AppBar,"defaultBg",ce("palette-grey-900")),en($.AppBar,"darkBg",ce("palette-background-paper")),en($.AppBar,"darkColor",ce("palette-text-primary")),en($.Avatar,"defaultBg",ce("palette-grey-600")),en($.Button,"inheritContainedBg",ce("palette-grey-800")),en($.Button,"inheritContainedHoverBg",ce("palette-grey-700")),en($.Chip,"defaultBorder",ce("palette-grey-700")),en($.Chip,"defaultAvatarColor",ce("palette-grey-300")),en($.Chip,"defaultIconColor",ce("palette-grey-300")),en($.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),en($.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),en($.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),en($.LinearProgress,"primaryBg",zi($.primary.main,.5)),en($.LinearProgress,"secondaryBg",zi($.secondary.main,.5)),en($.LinearProgress,"errorBg",zi($.error.main,.5)),en($.LinearProgress,"infoBg",zi($.info.main,.5)),en($.LinearProgress,"successBg",zi($.success.main,.5)),en($.LinearProgress,"warningBg",zi($.warning.main,.5)),en($.Skeleton,"bg",`rgba(${ce("palette-text-primaryChannel")} / 0.13)`),en($.Slider,"primaryTrack",zi($.primary.main,.5)),en($.Slider,"secondaryTrack",zi($.secondary.main,.5)),en($.Slider,"errorTrack",zi($.error.main,.5)),en($.Slider,"infoTrack",zi($.info.main,.5)),en($.Slider,"successTrack",zi($.success.main,.5)),en($.Slider,"warningTrack",zi($.warning.main,.5));const Ce=rb($.background.default,.98);en($.SnackbarContent,"bg",Ce),en($.SnackbarContent,"color",hh(()=>$.getContrastText(Ce))),en($.SpeedDialAction,"fabHoverBg",rb($.background.paper,.15)),en($.StepConnector,"border",ce("palette-grey-600")),en($.StepContent,"border",ce("palette-grey-600")),en($.Switch,"defaultColor",ce("palette-grey-300")),en($.Switch,"defaultDisabledColor",ce("palette-grey-600")),en($.Switch,"primaryDisabledColor",zi($.primary.main,.55)),en($.Switch,"secondaryDisabledColor",zi($.secondary.main,.55)),en($.Switch,"errorDisabledColor",zi($.error.main,.55)),en($.Switch,"infoDisabledColor",zi($.info.main,.55)),en($.Switch,"successDisabledColor",zi($.success.main,.55)),en($.Switch,"warningDisabledColor",zi($.warning.main,.55)),en($.TableCell,"border",zi(nb($.divider,1),.68)),en($.Tooltip,"bg",nb($.grey[700],.92))}Pd($.background,"default"),Pd($.background,"paper"),Pd($.common,"background"),Pd($.common,"onBackground"),Pd($,"divider"),Object.keys($).forEach(Ce=>{const Se=$[Ce];Ce!=="tonalOffset"&&Se&&typeof Se=="object"&&(Se.main&&en($[Ce],"mainChannel",C0(E0(Se.main))),Se.light&&en($[Ce],"lightChannel",C0(E0(Se.light))),Se.dark&&en($[Ce],"darkChannel",C0(E0(Se.dark))),Se.contrastText&&en($[Ce],"contrastTextChannel",C0(E0(Se.contrastText))),Ce==="text"&&(Pd($[Ce],"primary"),Pd($[Ce],"secondary")),Ce==="action"&&(Se.active&&Pd($[Ce],"active"),Se.selected&&Pd($[Ce],"selected")))})}),W=e.reduce((re,$)=>Gl(re,$),W);const X={prefix:l,disableCssColorScheme:o,shouldSkipGeneratingVar:c,getSelector:vee(W)},{vars:q,generateThemeVars:te,generateStyleSheets:se}=VQ(W,X);return W.vars=q,Object.entries(W.colorSchemes[W.defaultColorScheme]).forEach(([re,$])=>{W[re]=$}),W.generateThemeVars=te,W.generateStyleSheets=se,W.generateSpacing=function(){return mF(y.spacing,eA(this))},W.getColorSchemeSelector=jQ(s),W.spacing=W.generateSpacing(),W.shouldSkipGeneratingVar=c,W.unstable_sxConfig={...$w,...y?.unstable_sxConfig},W.unstable_sx=function($){return Zv({sx:$,theme:this})},W.toRuntimeSource=SF,W}function X3(t,e,n){t.colorSchemes&&n&&(t.colorSchemes[e]={...n!==!0&&n,palette:oA({...n===!0?{}:n.palette,mode:e})})}function wee(t={},...e){const{palette:n,cssVariables:r=!1,colorSchemes:o=n?void 0:{light:!0},defaultColorScheme:l=n?.mode,...c}=t,s=l||"light",m=o?.[s],y={...o,...n?{[s]:{...typeof m!="boolean"&&m,palette:n}}:void 0};if(r===!1){if(!("colorSchemes"in t))return R2(t,...e);let b=n;"palette"in t||y[s]&&(y[s]!==!0?b=y[s].palette:s==="dark"&&(b={mode:"dark"}));const w=R2({...t,palette:b},...e);return w.defaultColorScheme=s,w.colorSchemes=y,w.palette.mode==="light"&&(w.colorSchemes.light={...y.light!==!0&&y.light,palette:w.palette},X3(w,"dark",y.dark)),w.palette.mode==="dark"&&(w.colorSchemes.dark={...y.dark!==!0&&y.dark,palette:w.palette},X3(w,"light",y.light)),w}return!n&&!("light"in y)&&s==="light"&&(y.light=!0),bee({...c,colorSchemes:y,defaultColorScheme:s,...typeof r!="boolean"&&r},...e)}const See=wee(),Mee="$$material";function Cee(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const Eee=t=>Cee(t)&&t!=="classes",Tee=MQ({themeId:Mee,defaultTheme:See,rootShouldForwardProp:Eee}),Pee=NQ;function Aee(t){return FQ(t)}function Iee(t){return vF("MuiSvgIcon",t)}xQ("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Ree=t=>{const{color:e,fontSize:n,classes:r}=t,o={root:["root",e!=="inherit"&&`color${Xv(e)}`,`fontSize${Xv(n)}`]};return xJ(o,Iee,r)},Lee=Tee("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${Xv(n.color)}`],e[`fontSize${Xv(n.fontSize)}`]]}})(Pee(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),L2=H.forwardRef(function(e,n){const r=Aee({props:e,name:"MuiSvgIcon"}),{children:o,className:l,color:c="inherit",component:s="svg",fontSize:m="medium",htmlColor:y,inheritViewBox:b=!1,titleAccess:w,viewBox:E="0 0 24 24",...T}=r,R=H.isValidElement(o)&&o.type==="svg",z={...r,color:c,component:s,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:b,viewBox:E,hasSvgAsChild:R},I={};b||(I.viewBox=E);const L=Ree(z);return oe.jsxs(Lee,{as:s,className:co(L.root,l),focusable:"false",color:y,"aria-hidden":w?void 0:!0,role:w?"img":void 0,ref:n,...I,...T,...R&&o.props,ownerState:z,children:[R?o.props.children:o,w?oe.jsx("title",{children:w}):null]})});L2.muiName="SvgIcon";function Rs(t,e){function n(r,o){return oe.jsx(L2,{"data-testid":void 0,ref:o,...r,children:t})}return n.muiName=L2.muiName,H.memo(H.forwardRef(n))}const sA=Rs(oe.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}));function xr(t,e){if(t==null)throw new Error(e);return t}function EF(t,e){if(!t)throw new Error(`assertion failed: ${e}`);return t}var Ts=(t=>(t[t.Arizona=0]="Arizona",t[t.Arkansas=1]="Arkansas",t[t.Colorado=2]="Colorado",t[t.Idaho=3]="Idaho",t[t.Iowa=4]="Iowa",t[t.Kansas=5]="Kansas",t[t.Missouri=6]="Missouri",t[t.Montana=7]="Montana",t[t.Nebraska=8]="Nebraska",t[t.Nevada=9]="Nevada",t[t.NewMexico=10]="NewMexico",t[t.Oklahoma=11]="Oklahoma",t[t.Oregon=12]="Oregon",t[t.Texas=13]="Texas",t[t.Utah=14]="Utah",t[t.Washington=15]="Washington",t[t.Wyoming=16]="Wyoming",t))(Ts||{});const $m=new Set([9,0,10,12,15,14,3,2,16,7,13,11,5,8,1,6,4]),Dee={9:"Nevada",0:"Arizona",10:"New Mexico",12:"Oregon",15:"Washington",14:"Utah",3:"Idaho",2:"Colorado",16:"Wyoming",7:"Montana",13:"Texas",11:"Oklahoma",5:"Kansas",8:"Nebraska",1:"Arkansas",6:"Missouri",4:"Iowa"},TF={0:new Set,1:new Set([9]),2:new Set([0]),3:new Set([10]),4:new Set([12]),5:new Set([15]),6:new Set([15,12]),7:new Set([14]),8:new Set([14,10]),9:new Set([3]),10:new Set([3,12]),11:new Set([3,14]),12:new Set([3,15]),13:new Set([2]),14:new Set([2,10]),15:new Set([2,14]),16:new Set([16]),17:new Set([16,2]),18:new Set([16,3]),19:new Set([16,14]),20:new Set([13]),21:new Set([13,10]),22:new Set([7]),23:new Set([7,3]),24:new Set([7,16]),25:new Set([11]),26:new Set([11,2]),27:new Set([11,10]),28:new Set([11,13]),29:new Set([5]),30:new Set([5,2]),31:new Set([5,11]),32:new Set([8]),33:new Set([8,2]),34:new Set([8,5]),35:new Set([8,16]),36:new Set([1]),37:new Set([1,11]),38:new Set([1,13]),39:new Set([6]),40:new Set([6,1]),41:new Set([6,5]),42:new Set([6,8]),43:new Set([6,11]),44:new Set([4]),45:new Set([4,6]),46:new Set([4,8])},kee={1:0,2:1,3:2,7:13,13:9,31:3,37:4,43:20,44:7,47:5,17:29,27:22,36:25,50:16,18:32,19:36,26:39,21:44};for(const t of Object.values(kee))t!==0&&EF(TF[t].size===1);function Z_(t){const e=new Set;for(const[n,r]of Object.entries(TF))[...r].every(o=>t.has(o))&&e.add(Number(n));return e}const zee=new Set([0,1,2,3,4,5,6,7,11]),Oee={0:new Set,1:new Set([0]),2:new Set([1]),3:new Set([2]),4:new Set([3]),5:new Set([3,2]),6:new Set([4]),7:new Set([4,0]),8:new Set([4,1]),9:new Set([5]),10:new Set([5,0]),11:new Set([6]),12:new Set([6,2]),16:new Set([7]),17:new Set([7,0]),18:new Set([7,4]),20:new Set([11]),21:new Set([11,0]),22:new Set([11,7])};function Fee(t){const e=new Set;for(const[n,r]of Object.entries(Oee))[...r].every(o=>t.has(o))&&e.add(Number(n));return e}var PF=(t=>(t[t.Road=0]="Road",t[t.Light=1]="Light",t[t.Dark=2]="Dark",t[t.Green=3]="Green",t[t.NavRed=4]="NavRed",t[t.NavGreen=5]="NavGreen",t[t.NavBlue=6]="NavBlue",t[t.NavYellow=7]="NavYellow",t[t.NavPurple=8]="NavPurple",t))(PF||{});const Nee="modulepreload",Bee=function(t){return"/"+t},Z3={},Uee=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){let y=function(b){return Promise.all(b.map(w=>Promise.resolve(w).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};var c=y;document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),m=s?.nonce||s?.getAttribute("nonce");o=y(n.map(b=>{if(b=Bee(b),b in Z3)return;Z3[b]=!0;const w=b.endsWith(".css"),E=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${E}`))return;const T=document.createElement("link");if(T.rel=w?"stylesheet":Nee,w||(T.as="script"),T.crossOrigin="",T.href=b,m&&T.setAttribute("nonce",m),document.head.appendChild(T),w)return new Promise((R,z)=>{T.addEventListener("load",R),T.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${b}`)))})}))}function l(s){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=s,window.dispatchEvent(m),!m.defaultPrevented)throw s}return o.then(s=>{for(const m of s||[])m.status==="rejected"&&l(m.reason);return e().catch(l)})},AF=H.createContext(null);function Y_(){const t=H.useContext(AF)?.maps,e=H.useContext(Ym);return H.useMemo(()=>({...t,current:e?.map}),[t,e])}function $ee(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,o=Array.isArray(e)?e[0]:e?e.x:0,l=Array.isArray(e)?e[1]:e?e.y:0;return n===o&&r===l}function Za(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Za(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const o of n)if(!e.hasOwnProperty(o)||!Za(t[o],e[o]))return!1;return!0}return!1}function Y3(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function K3(t,e){const n=e.viewState||e,r={};if("longitude"in n&&"latitude"in n&&(n.longitude!==t.center.lng||n.latitude!==t.center.lat)){const o=t.center.constructor;r.center=new o(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==t.zoom&&(r.zoom=n.zoom),"bearing"in n&&n.bearing!==t.bearing&&(r.bearing=n.bearing),"pitch"in n&&n.pitch!==t.pitch&&(r.pitch=n.pitch),n.padding&&t.padding&&!Za(n.padding,t.padding)&&(r.padding=n.padding),r}const Vee=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function J3(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let o=null;"interactive"in r&&(o=Object.assign({},r),delete o.interactive);const l=e[r.ref];if(l){o=o||Object.assign({},r),delete o.ref;for(const c of Vee)c in l&&(o[c]=l[c])}return o||r});return{...t,layers:n}}const Q3={version:8,sources:{},layers:[]},eL={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},tL={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},nL={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},jee=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Hee=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Yv{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=o=>{const l=this.props[nL[o.type]];l?l(o):o.type==="error"&&console.error(o.error)},this._onCameraEvent=o=>{if(this._internalUpdate)return;o.viewState=this._propsedCameraUpdate||Y3(this._map.transform);const l=this.props[tL[o.type]];l&&l(o)},this._onCameraUpdate=o=>this._internalUpdate?o:(this._propsedCameraUpdate=Y3(o),K3(o,this.props)),this._onPointerEvent=o=>{(o.type==="mousemove"||o.type==="mouseout")&&this._updateHover(o);const l=this.props[eL[o.type]];l&&(this.props.interactiveLayerIds&&o.type!=="mouseover"&&o.type!=="mouseout"&&(o.features=this._hoveredFeatures||this._queryRenderedFeatures(o.point)),l(o),delete o.features)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n),o=this._updateSize(e),l=this._updateViewState(e);this._updateStyle(e,n),this._updateStyleComponents(e),this._updateHandlers(e,n),(r||o||l&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Yv.savedMaps.pop();if(!r)return null;const o=r.map,l=o.getContainer();for(n.className=l.className;l.childNodes.length>0;)n.appendChild(l.childNodes[0]);o._container=n;const c=o._resizeObserver;c&&(c.disconnect(),c.observe(n)),r.setProps({...e,styleDiffing:!1}),o.resize();const{initialViewState:s}=e;return s&&(s.bounds?o.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):r._updateViewState(s)),o.isStyleLoaded()?o.fire("load"):o.once("style.load",()=>o.fire("load")),o._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=Q3}=n,o={...n,...n.initialViewState,container:e,style:J3(r)},l=o.initialViewState||o.viewState||o;if(Object.assign(o,{center:[l.longitude||0,l.latitude||0],zoom:l.zoom||0,pitch:l.pitch||0,bearing:l.bearing||0}),n.gl){const s=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=s,n.gl)}const c=new this._MapClass(o);l.padding&&c.setPadding(l.padding),n.cursor&&(c.getCanvas().style.cursor=n.cursor),c.transformCameraUpdate=this._onCameraUpdate,c.on("style.load",()=>{this._styleComponents={light:c.getLight(),sky:c.getSky(),projection:c.getProjection?.(),terrain:c.getTerrain()},this._updateStyleComponents(this.props)}),c.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const s in eL)c.on(s,this._onPointerEvent);for(const s in tL)c.on(s,this._onCameraEvent);for(const s in nL)c.on(s,this._onEvent);this._map=c}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),Yv.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e){const n=this._map,r=n.transform;if(!n.isMoving()){const l=K3(r,e);if(Object.keys(l).length>0)return this._internalUpdate=!0,n.jumpTo(l),this._internalUpdate=!1,!0}return!1}_updateSettings(e,n){const r=this._map;let o=!1;for(const l of jee)l in e&&!Za(e[l],n[l])&&(o=!0,r[`set${l[0].toUpperCase()}${l.slice(1)}`]?.call(r,e[l]));return o}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=Q3,styleDiffing:o=!0}=e,l={diff:o};"localIdeographFontFamily"in e&&(l.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(J3(r),l)}}_updateStyleComponents({light:e,projection:n,sky:r,terrain:o}){const l=this._map,c=this._styleComponents;l.style._loaded&&(e&&!Za(e,c.light)&&(c.light=e,l.setLight(e)),n&&!Za(n,c.projection)&&n!==c.projection?.type&&(c.projection=typeof n=="string"?{type:n}:n,l.setProjection?.(c.projection)),r&&!Za(r,c.sky)&&(c.sky=r,l.setSky(r)),o!==void 0&&!Za(o,c.terrain)&&(!o||l.getSource(o.source))&&(c.terrain=o,l.setTerrain(o)))}_updateHandlers(e,n){const r=this._map;for(const o of Hee){const l=e[o]??!0,c=n[o]??!0;Za(l,c)||(l?r[o].enable(l):r[o].disable())}}_queryRenderedFeatures(e){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const o=e.type,l=this._hoveredFeatures?.length>0,c=this._queryRenderedFeatures(e.point),s=c.length>0;!s&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=c,s&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=o}else this._hoveredFeatures=null}}Yv.savedMaps=[];const Gee=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Wee(t){if(!t)return null;const e=t.map,n={getMap:()=>e};for(const r of qee(e))!(r in n)&&!Gee.includes(r)&&(n[r]=e[r].bind(e));return n}function qee(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const Xee=typeof document<"u"?H.useLayoutEffect:H.useEffect;function Zee(t,e){const{RTLTextPlugin:n,maxParallelImageRequests:r,workerCount:o,workerUrl:l}=e;if(n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:c,lazy:s=!0}=typeof n=="string"?{pluginUrl:n}:n;t.setRTLTextPlugin(c,m=>{m&&console.error(m)},s)}r!==void 0&&t.setMaxParallelImageRequests(r),o!==void 0&&t.setWorkerCount(o),l!==void 0&&t.setWorkerUrl(l)}const Ym=H.createContext(null);function Yee(t,e){const n=H.useContext(AF),[r,o]=H.useState(null),l=H.useRef(),{current:c}=H.useRef({mapLib:null,map:null});H.useEffect(()=>{const y=t.mapLib;let b=!0,w;return Promise.resolve(y||Uee(()=>Promise.resolve().then(()=>yte),[])).then(E=>{if(!b)return;if(!E)throw new Error("Invalid mapLib");const T="Map"in E?E:E.default;if(!T.Map)throw new Error("Invalid mapLib");Zee(T,t),t.reuseMaps&&(w=Yv.reuse(t,l.current)),w||(w=new Yv(T.Map,t,l.current)),c.map=Wee(w),c.mapLib=T,o(w),n?.onMapMount(c.map,t.id)}).catch(E=>{const{onError:T}=t;T?T({type:"error",target:null,originalEvent:null,error:E}):console.error(E)}),()=>{b=!1,w&&(n?.onMapUnmount(t.id),t.reuseMaps?w.recycle():w.destroy())}},[]),Xee(()=>{r&&r.setProps(t)}),H.useImperativeHandle(e,()=>c.map,[r]);const s=H.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),m={height:"100%"};return H.createElement("div",{id:t.id,ref:l,style:s},r&&H.createElement(Ym.Provider,{value:c},H.createElement("div",{"mapboxgl-children":"",style:m},t.children)))}const jw=H.forwardRef(Yee),Kee=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Jd(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const o=e[r];Number.isFinite(o)&&!Kee.test(r)?n[r]=`${o}px`:n[r]=o}}function IF(t,e){if(t===e)return null;const n=rL(t),r=rL(e),o=[];for(const l of r)n.has(l)||o.push(l);for(const l of n)r.has(l)||o.push(l);return o.length===0?null:o}function rL(t){return new Set(t?t.trim().split(/\s+/):[])}const aA=H.memo(H.forwardRef((t,e)=>{const{map:n,mapLib:r}=H.useContext(Ym),o=H.useRef({props:t}),l=H.useMemo(()=>{let L=!1;H.Children.forEach(t.children,W=>{W&&(L=!0)});const V={...t,element:L?document.createElement("div"):void 0},B=new r.Marker(V);return B.setLngLat([t.longitude,t.latitude]),B.getElement().addEventListener("click",W=>{o.current.props.onClick?.({type:"click",target:B,originalEvent:W})}),B.on("dragstart",W=>{const X=W;X.lngLat=l.getLngLat(),o.current.props.onDragStart?.(X)}),B.on("drag",W=>{const X=W;X.lngLat=l.getLngLat(),o.current.props.onDrag?.(X)}),B.on("dragend",W=>{const X=W;X.lngLat=l.getLngLat(),o.current.props.onDragEnd?.(X)}),B},[]);H.useEffect(()=>(l.addTo(n.getMap()),()=>{l.remove()}),[]);const{longitude:c,latitude:s,offset:m,style:y,draggable:b=!1,popup:w=null,rotation:E=0,rotationAlignment:T="auto",pitchAlignment:R="auto"}=t;H.useEffect(()=>{Jd(l.getElement(),y)},[y]),H.useImperativeHandle(e,()=>l,[]);const z=o.current.props;(l.getLngLat().lng!==c||l.getLngLat().lat!==s)&&l.setLngLat([c,s]),m&&!$ee(l.getOffset(),m)&&l.setOffset(m),l.isDraggable()!==b&&l.setDraggable(b),l.getRotation()!==E&&l.setRotation(E),l.getRotationAlignment()!==T&&l.setRotationAlignment(T),l.getPitchAlignment()!==R&&l.setPitchAlignment(R),l.getPopup()!==w&&l.setPopup(w);const I=IF(z.className,t.className);if(I)for(const L of I)l.toggleClassName(L);return o.current.props=t,xw.createPortal(t.children,l.getElement())})),Jee=H.memo(H.forwardRef((t,e)=>{const{map:n,mapLib:r}=H.useContext(Ym),o=H.useMemo(()=>document.createElement("div"),[]),l=H.useRef({props:t}),c=H.useMemo(()=>{const s={...t},m=new r.Popup(s);return m.setLngLat([t.longitude,t.latitude]),m.once("open",y=>{l.current.props.onOpen?.(y)}),m},[]);if(H.useEffect(()=>{const s=m=>{l.current.props.onClose?.(m)};return c.on("close",s),c.setDOMContent(o).addTo(n.getMap()),()=>{c.off("close",s),c.isOpen()&&c.remove()}},[]),H.useEffect(()=>{Jd(c.getElement(),t.style)},[t.style]),H.useImperativeHandle(e,()=>c,[]),c.isOpen()){const s=l.current.props;(c.getLngLat().lng!==t.longitude||c.getLngLat().lat!==t.latitude)&&c.setLngLat([t.longitude,t.latitude]),t.offset&&!Za(s.offset,t.offset)&&c.setOffset(t.offset),(s.anchor!==t.anchor||s.maxWidth!==t.maxWidth)&&(c.options.anchor=t.anchor,c.setMaxWidth(t.maxWidth));const m=IF(s.className,t.className);if(m)for(const y of m)c.toggleClassName(y);l.current.props=t}return xw.createPortal(t.children,o)}));function kc(t,e,n,r){const o=H.useContext(Ym),l=H.useMemo(()=>t(o),[]);return H.useEffect(()=>{const c=e,s=null,m=typeof e=="function"?e:null,{map:y}=o;return y.hasControl(l)||(y.addControl(l,c?.position),s&&s(o)),()=>{m&&m(o),y.hasControl(l)&&y.removeControl(l)}},[]),l}function Qee(t){const e=kc(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return H.useEffect(()=>{Jd(e._container,t.style)},[t.style]),null}const RF=H.memo(Qee);function ete(t){const e=kc(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return H.useEffect(()=>{Jd(e._controlContainer,t.style)},[t.style]),null}const LF=H.memo(ete);function tte(t,e){const n=H.useRef({props:t}),r=kc(({mapLib:o})=>{const l=new o.GeolocateControl(t),c=l._setupUI;return l._setupUI=()=>{l._container.hasChildNodes()||c()},l.on("geolocate",s=>{n.current.props.onGeolocate?.(s)}),l.on("error",s=>{n.current.props.onError?.(s)}),l.on("outofmaxbounds",s=>{n.current.props.onOutOfMaxBounds?.(s)}),l.on("trackuserlocationstart",s=>{n.current.props.onTrackUserLocationStart?.(s)}),l.on("trackuserlocationend",s=>{n.current.props.onTrackUserLocationEnd?.(s)}),l},{position:t.position});return n.current.props=t,H.useImperativeHandle(e,()=>r,[]),H.useEffect(()=>{Jd(r._container,t.style)},[t.style]),null}H.memo(H.forwardRef(tte));function nte(t){const e=kc(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return H.useEffect(()=>{Jd(e._container,t.style)},[t.style]),null}const DF=H.memo(nte);function rte(t){const e=kc(({mapLib:l})=>new l.ScaleControl(t),{position:t.position}),n=H.useRef(t),r=n.current;n.current=t;const{style:o}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),H.useEffect(()=>{Jd(e._container,o)},[o]),null}H.memo(rte);function ite(t){const e=kc(({mapLib:n})=>new n.TerrainControl(t),{position:t.position});return H.useEffect(()=>{Jd(e._container,t.style)},[t.style]),null}H.memo(ite);function ote(t){const e=kc(({mapLib:n})=>new n.LogoControl(t),{position:t.position});return H.useEffect(()=>{Jd(e._container,t.style)},[t.style]),null}H.memo(ote);function P1(t,e){if(!t)throw new Error(e)}let ste=0;function ate(t,e,n){if(t.style&&t.style._loaded){const r={...n};return delete r.id,delete r.children,t.addSource(e,r),t.getSource(e)}return null}function lte(t,e,n){P1(e.id===n.id,"source id changed"),P1(e.type===n.type,"source type changed");let r="",o=0;for(const c in e)c!=="children"&&c!=="id"&&!Za(n[c],e[c])&&(r=c,o++);if(!o)return;const l=e.type;if(l==="geojson")t.setData(e.data);else if(l==="image")t.updateImage({url:e.url,coordinates:e.coordinates});else switch(r){case"coordinates":t.setCoordinates?.(e.coordinates);break;case"url":t.setUrl?.(e.url);break;case"tiles":t.setTiles?.(e.tiles);break;default:console.warn(`Unable to update <Source> prop: ${r}`)}}function sp(t){const e=H.useContext(Ym).map.getMap(),n=H.useRef(t),[,r]=H.useState(0),o=H.useMemo(()=>t.id||`jsx-source-${ste++}`,[]);H.useEffect(()=>{if(e){const c=()=>setTimeout(()=>r(s=>s+1),0);return e.on("styledata",c),c(),()=>{if(e.off("styledata",c),e.style&&e.style._loaded&&e.getSource(o)){const s=e.getStyle()?.layers;if(s)for(const m of s)m.source===o&&e.removeLayer(m.id);e.removeSource(o)}}}},[e]);let l=e&&e.style&&e.getSource(o);return l?lte(l,t,n.current):l=ate(e,o,t),n.current=t,l&&H.Children.map(t.children,c=>c&&H.cloneElement(c,{source:o}))||null}function cte(t,e,n,r){if(P1(n.id===r.id,"layer id changed"),P1(n.type===r.type,"layer type changed"),n.type==="custom"||r.type==="custom")return;const{layout:o={},paint:l={},filter:c,minzoom:s,maxzoom:m,beforeId:y}=n;if(y!==r.beforeId&&t.moveLayer(e,y),o!==r.layout){const b=r.layout||{};for(const w in o)Za(o[w],b[w])||t.setLayoutProperty(e,w,o[w]);for(const w in b)o.hasOwnProperty(w)||t.setLayoutProperty(e,w,void 0)}if(l!==r.paint){const b=r.paint||{};for(const w in l)Za(l[w],b[w])||t.setPaintProperty(e,w,l[w]);for(const w in b)l.hasOwnProperty(w)||t.setPaintProperty(e,w,void 0)}Za(c,r.filter)||t.setFilter(e,c),(s!==r.minzoom||m!==r.maxzoom)&&t.setLayerZoomRange(e,s,m)}function ute(t,e,n){if(t.style&&t.style._loaded&&(!("source"in n)||t.getSource(n.source))){const r={...n,id:e};delete r.beforeId,t.addLayer(r,n.beforeId)}}let hte=0;function kr(t){const e=H.useContext(Ym).map.getMap(),n=H.useRef(t),[,r]=H.useState(0),o=H.useMemo(()=>t.id||`jsx-layer-${hte++}`,[]);if(H.useEffect(()=>{if(e){const c=()=>r(s=>s+1);return e.on("styledata",c),c(),()=>{e.off("styledata",c),e.style&&e.style._loaded&&e.getLayer(o)&&e.removeLayer(o)}}},[e]),e&&e.style&&e.getLayer(o))try{cte(e,o,t,n.current)}catch(c){console.warn(c)}else ute(e,o,t);return n.current=t,null}const dte={"text-color":"hsl(42, 10%, 14%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},fte={"text-color":"hsl(42, 10%, 24%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},pte={"text-color":"hsl(42, 10%, 86%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},mte={"text-color":"hsl(42, 10%, 76%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},lA={light:{water:"#b2cdfb",land:"#f8f8f8",stateBorder:"#aaa",countryBorder:"#ccc",primaryTextPaint:dte,secondaryTextPaint:fte,hiddenRoad:"#e9e9e8",footprint:"#e9e9e8",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#eeeeffcc",trainLine:"#aaa",trainLabel:"#555c",trainHalo:"#eefc",mapAreaOutline:"#999a"},dark:{water:"#36415d",land:"#1a1a1a",stateBorder:"#555",countryBorder:"#333",primaryTextPaint:pte,secondaryTextPaint:mte,hiddenRoad:"#404038",footprint:"#30302f88",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#303028cc",trainLine:"#888",trainLabel:"#eeec",trainHalo:"#303028cc",mapAreaOutline:"#777a"}};var Jb={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.1/LICENSE.txt
 */var gte=Jb.exports,iL;function vte(){return iL||(iL=1,function(t,e){(function(n,r){t.exports=r()})(gte,function(){var n={},r={};function o(c,s,m){if(r[c]=m,c==="index"){var y="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",b={};return r.shared(b),r.index(n,b),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([y],{type:"text/javascript"}))),n}}o("shared",["exports"],function(c){function s(d,a,h,p){return new(h||(h=Promise))(function(x,C){function A(j){try{N(p.next(j))}catch(Y){C(Y)}}function k(j){try{N(p.throw(j))}catch(Y){C(Y)}}function N(j){var Y;j.done?x(j.value):(Y=j.value,Y instanceof h?Y:new h(function(Q){Q(Y)})).then(A,k)}N((p=p.apply(d,a||[])).next())})}function m(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var y,b;function w(){if(b)return y;function d(a,h){this.x=a,this.y=h}return b=1,y=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,h){return this.clone()._rotateAround(a,h)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var h=a.x-this.x,p=a.y-this.y;return h*h+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,h){return Math.atan2(this.x*h-this.y*a,this.x*a+this.y*h)},_matMult:function(a){var h=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=h,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var h=Math.cos(a),p=Math.sin(a),x=p*this.x+h*this.y;return this.x=h*this.x-p*this.y,this.y=x,this},_rotateAround:function(a,h){var p=Math.cos(a),x=Math.sin(a),C=h.y+x*(this.x-h.x)+p*(this.y-h.y);return this.x=h.x+p*(this.x-h.x)-x*(this.y-h.y),this.y=C,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(a){return a instanceof d?a:Array.isArray(a)?new d(a[0],a[1]):a},y}typeof SuppressedError=="function"&&SuppressedError;var E,T,R=m(w()),z=function(){if(T)return E;function d(a,h,p,x){this.cx=3*a,this.bx=3*(p-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(x-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=h,this.p2x=p,this.p2y=x}return T=1,E=d,d.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,h){if(h===void 0&&(h=1e-6),a<0)return 0;if(a>1)return 1;for(var p=a,x=0;x<8;x++){var C=this.sampleCurveX(p)-a;if(Math.abs(C)<h)return p;var A=this.sampleCurveDerivativeX(p);if(Math.abs(A)<1e-6)break;p-=C/A}var k=0,N=1;for(p=a,x=0;x<20&&(C=this.sampleCurveX(p),!(Math.abs(C-a)<h));x++)a>C?k=p:N=p,p=.5*(N-k)+k;return p},solve:function(a,h){return this.sampleCurveY(this.solveCurveX(a,h))}},E}(),I=m(z);let L,V;function B(){return L==null&&(L=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),L}function W(){if(V==null&&(V=!1,B())){const a=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(a){for(let p=0;p<5*5;p++){const x=4*p;a.fillStyle=`rgb(${x},${x+1},${x+2})`,a.fillRect(p%5,Math.floor(p/5),1,1)}const h=a.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&h[p]!==p){V=!0;break}}}return V||!1}var X=1e-6,q=typeof Float32Array<"u"?Float32Array:Array;function te(){var d=new q(9);return q!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d}function se(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}function re(){var d=new q(3);return q!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d}function $(d){return Math.hypot(d[0],d[1],d[2])}function ce(d,a,h){var p=new q(3);return p[0]=d,p[1]=a,p[2]=h,p}function Ce(d,a,h){return d[0]=a[0]+h[0],d[1]=a[1]+h[1],d[2]=a[2]+h[2],d}function Se(d,a,h){return d[0]=a[0]*h,d[1]=a[1]*h,d[2]=a[2]*h,d}function Xe(d,a,h){var p=a[0],x=a[1],C=a[2],A=h[0],k=h[1],N=h[2];return d[0]=x*N-C*k,d[1]=C*A-p*N,d[2]=p*k-x*A,d}Math.hypot||(Math.hypot=function(){for(var d=0,a=arguments.length;a--;)d+=arguments[a]*arguments[a];return Math.sqrt(d)});var Fe,Me=$;function Te(d,a,h){var p=a[0],x=a[1],C=a[2],A=a[3];return d[0]=h[0]*p+h[4]*x+h[8]*C+h[12]*A,d[1]=h[1]*p+h[5]*x+h[9]*C+h[13]*A,d[2]=h[2]*p+h[6]*x+h[10]*C+h[14]*A,d[3]=h[3]*p+h[7]*x+h[11]*C+h[15]*A,d}function Ie(){var d=new q(4);return q!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d[3]=1,d}function Ke(d,a,h,p){var x=.5*Math.PI/180;a*=x,h*=x,p*=x;var C=Math.sin(a),A=Math.cos(a),k=Math.sin(h),N=Math.cos(h),j=Math.sin(p),Y=Math.cos(p);return d[0]=C*N*Y-A*k*j,d[1]=A*k*Y+C*N*j,d[2]=A*N*j-C*k*Y,d[3]=A*N*Y+C*k*j,d}function st(){var d=new q(2);return q!=Float32Array&&(d[0]=0,d[1]=0),d}function Ee(d,a){var h=new q(2);return h[0]=d,h[1]=a,h}re(),Fe=new q(4),q!=Float32Array&&(Fe[0]=0,Fe[1]=0,Fe[2]=0,Fe[3]=0),re(),ce(1,0,0),ce(0,1,0),Ie(),Ie(),te(),st();const Qe=8192;function jt(d,a,h){return a*(Qe/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}function je(d,a){return(d%a+a)%a}function ft(d,a,h){return d*(1-h)+a*h}function At(d){if(d<=0)return 0;if(d>=1)return 1;const a=d*d,h=a*d;return 4*(d<.5?h:3*(d-a)+h-.75)}function ht(d,a,h,p){const x=new I(d,a,h,p);return C=>x.solve(C)}const lt=ht(.25,.1,.25,1);function bt(d,a,h){return Math.min(h,Math.max(a,d))}function St(d,a,h){const p=h-a,x=((d-a)%p+p)%p+a;return x===a?h:x}function dn(d,...a){for(const h of a)for(const p in h)d[p]=h[p];return d}let En=1;function un(d,a,h){const p={};for(const x in d)p[x]=a.call(this,d[x],x,d);return p}function et(d,a,h){const p={};for(const x in d)a.call(this,d[x],x,d)&&(p[x]=d[x]);return p}function Ln(d){return Array.isArray(d)?d.map(Ln):typeof d=="object"&&d?un(d,Ln):d}const Jt={};function fn(d){Jt[d]||(typeof console<"u"&&console.warn(d),Jt[d]=!0)}function $t(d,a,h){return(h.y-d.y)*(a.x-d.x)>(a.y-d.y)*(h.x-d.x)}function Nn(d){return typeof WorkerGlobalScope<"u"&&d!==void 0&&d instanceof WorkerGlobalScope}let vn=null;function Ue(d){return typeof ImageBitmap<"u"&&d instanceof ImageBitmap}const we="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function yt(d,a,h,p,x){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const C=new VideoFrame(d,{timestamp:0});try{const A=C?.format;if(!A||!A.startsWith("BGR")&&!A.startsWith("RGB"))throw new Error(`Unrecognized format ${A}`);const k=A.startsWith("BGR"),N=new Uint8ClampedArray(p*x*4);if(yield C.copyTo(N,function(j,Y,Q,he,pe){const me=4*Math.max(-Y,0),_e=(Math.max(0,Q)-Q)*he*4+me,ke=4*he,Ve=Math.max(0,Y),dt=Math.max(0,Q);return{rect:{x:Ve,y:dt,width:Math.min(j.width,Y+he)-Ve,height:Math.min(j.height,Q+pe)-dt},layout:[{offset:_e,stride:ke}]}}(d,a,h,p,x)),k)for(let j=0;j<N.length;j+=4){const Y=N[j];N[j]=N[j+2],N[j+2]=Y}return N}finally{C.close()}})}let Nt,Ht;function Ot(d,a,h,p){return d.addEventListener(a,h,p),{unsubscribe:()=>{d.removeEventListener(a,h,p)}}}function ln(d){return d*Math.PI/180}function Gt(d){return d/Math.PI*180}const Zt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Fn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Yt="AbortError";function Pe(){return new Error(Yt)}const ae={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ue(d){return ae.REGISTERED_PROTOCOLS[d.substring(0,d.indexOf("://"))]}const ee="global-dispatcher";class fe extends Error{constructor(a,h,p,x){super(`AJAXError: ${h} (${a}): ${p}`),this.status=a,this.statusText=h,this.url=p,this.body=x}}const Oe=()=>Nn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ye=function(d,a){if(/:\/\//.test(d.url)&&!/^https?:|^file:/.test(d.url)){const p=ue(d.url);if(p)return p(d,a);if(Nn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,targetMapId:ee},a)}if(!(/^file:/.test(h=d.url)||/^file:/.test(Oe())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(p,x){return s(this,void 0,void 0,function*(){const C=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:Oe(),signal:x.signal});let A,k;p.type!=="json"||C.headers.has("Accept")||C.headers.set("Accept","application/json");try{A=yield fetch(C)}catch(j){throw new fe(0,j.message,p.url,new Blob)}if(!A.ok){const j=yield A.blob();throw new fe(A.status,A.statusText,p.url,j)}k=p.type==="arrayBuffer"||p.type==="image"?A.arrayBuffer():p.type==="json"?A.json():A.text();const N=yield k;if(x.signal.aborted)throw Pe();return{data:N,cacheControl:A.headers.get("Cache-Control"),expires:A.headers.get("Expires")}})}(d,a);if(Nn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,mustQueue:!0,targetMapId:ee},a)}var h;return function(p,x){return new Promise((C,A)=>{var k;const N=new XMLHttpRequest;N.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(N.responseType="arraybuffer");for(const j in p.headers)N.setRequestHeader(j,p.headers[j]);p.type==="json"&&(N.responseType="text",!((k=p.headers)===null||k===void 0)&&k.Accept||N.setRequestHeader("Accept","application/json")),N.withCredentials=p.credentials==="include",N.onerror=()=>{A(new Error(N.statusText))},N.onload=()=>{if(!x.signal.aborted)if((N.status>=200&&N.status<300||N.status===0)&&N.response!==null){let j=N.response;if(p.type==="json")try{j=JSON.parse(N.response)}catch(Y){return void A(Y)}C({data:j,cacheControl:N.getResponseHeader("Cache-Control"),expires:N.getResponseHeader("Expires")})}else{const j=new Blob([N.response],{type:N.getResponseHeader("Content-Type")});A(new fe(N.status,N.statusText,p.url,j))}},x.signal.addEventListener("abort",()=>{N.abort(),A(Pe())}),N.send(p.body)})}(d,a)};function ye(d){if(!d||d.indexOf("://")<=0||d.indexOf("data:image/")===0||d.indexOf("blob:")===0)return!0;const a=new URL(d),h=window.location;return a.protocol===h.protocol&&a.host===h.host}function Ae(d,a,h){h[d]&&h[d].indexOf(a)!==-1||(h[d]=h[d]||[],h[d].push(a))}function Be(d,a,h){if(h&&h[d]){const p=h[d].indexOf(a);p!==-1&&h[d].splice(p,1)}}class $e{constructor(a,h={}){dn(this,h),this.type=a}}class He extends $e{constructor(a,h={}){super("error",dn({error:a},h))}}class ut{on(a,h){return this._listeners=this._listeners||{},Ae(a,h,this._listeners),{unsubscribe:()=>{this.off(a,h)}}}off(a,h){return Be(a,h,this._listeners),Be(a,h,this._oneTimeListeners),this}once(a,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Ae(a,h,this._oneTimeListeners),this):new Promise(p=>this.once(a,p))}fire(a,h){typeof a=="string"&&(a=new $e(a,h||{}));const p=a.type;if(this.listens(p)){a.target=this;const x=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const k of x)k.call(this,a);const C=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const k of C)Be(p,k,this._oneTimeListeners),k.call(this,a);const A=this._eventedParent;A&&(dn(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),A.fire(a))}else a instanceof He&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,h){return this._eventedParent=a,this._eventedParentData=h,this}}var We={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ut=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Kt(d,a){const h={};for(const p in d)p!=="ref"&&(h[p]=d[p]);return Ut.forEach(p=>{p in a&&(h[p]=a[p])}),h}function Re(d,a){if(Array.isArray(d)){if(!Array.isArray(a)||d.length!==a.length)return!1;for(let h=0;h<d.length;h++)if(!Re(d[h],a[h]))return!1;return!0}if(typeof d=="object"&&d!==null&&a!==null){if(typeof a!="object"||Object.keys(d).length!==Object.keys(a).length)return!1;for(const h in d)if(!Re(d[h],a[h]))return!1;return!0}return d===a}function it(d,a){d.push(a)}function mt(d,a,h){it(h,{command:"addSource",args:[d,a[d]]})}function Wt(d,a,h){it(a,{command:"removeSource",args:[d]}),h[d]=!0}function tn(d,a,h,p){Wt(d,h,p),mt(d,a,h)}function pn(d,a,h){let p;for(p in d[h])if(Object.prototype.hasOwnProperty.call(d[h],p)&&p!=="data"&&!Re(d[h][p],a[h][p]))return!1;for(p in a[h])if(Object.prototype.hasOwnProperty.call(a[h],p)&&p!=="data"&&!Re(d[h][p],a[h][p]))return!1;return!0}function rn(d,a,h,p,x,C){d=d||{},a=a||{};for(const A in d)Object.prototype.hasOwnProperty.call(d,A)&&(Re(d[A],a[A])||h.push({command:C,args:[p,A,a[A],x]}));for(const A in a)Object.prototype.hasOwnProperty.call(a,A)&&!Object.prototype.hasOwnProperty.call(d,A)&&(Re(d[A],a[A])||h.push({command:C,args:[p,A,a[A],x]}))}function on(d){return d.id}function kn(d,a){return d[a.id]=a,d}class Ct{constructor(a,h,p,x){this.message=(a?`${a}: `:"")+p,x&&(this.identifier=x),h!=null&&h.__line__&&(this.line=h.__line__)}}function Gn(d,...a){for(const h of a)for(const p in h)d[p]=h[p];return d}class On extends Error{constructor(a,h){super(h),this.message=h,this.key=a}}class or{constructor(a,h=[]){this.parent=a,this.bindings={};for(const[p,x]of h)this.bindings[p]=x}concat(a){return new or(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const It={kind:"null"},nt={kind:"number"},qt={kind:"string"},cn={kind:"boolean"},Rn={kind:"color"},Ir={kind:"projectionDefinition"},_r={kind:"object"},xe={kind:"value"},vt={kind:"collator"},kt={kind:"formatted"},xt={kind:"padding"},wt={kind:"colorArray"},hn={kind:"numberArray"},Pn={kind:"resolvedImage"},mn={kind:"variableAnchorOffsetCollection"};function Tn(d,a){return{kind:"array",itemType:d,N:a}}function Qt(d){if(d.kind==="array"){const a=Qt(d.itemType);return typeof d.N=="number"?`array<${a}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${a}>`}return d.kind}const Zn=[It,nt,qt,cn,Rn,Ir,kt,_r,Tn(xe),xt,hn,wt,Pn,mn];function An(d,a){if(a.kind==="error")return null;if(d.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!An(d.itemType,a.itemType))&&(typeof d.N!="number"||d.N===a.N))return null}else{if(d.kind===a.kind)return null;if(d.kind==="value"){for(const h of Zn)if(!An(h,a))return null}}return`Expected ${Qt(d)} but found ${Qt(a)} instead.`}function Wn(d,a){return a.some(h=>h.kind===d.kind)}function tr(d,a){return a.some(h=>h==="null"?d===null:h==="array"?Array.isArray(d):h==="object"?d&&!Array.isArray(d)&&typeof d=="object":h===typeof d)}function Or(d,a){return d.kind==="array"&&a.kind==="array"?d.itemType.kind===a.itemType.kind&&typeof d.N=="number":d.kind===a.kind}const Fr=.96422,wr=.82521,ur=4/29,ui=6/29,Lr=3*ui*ui,Eo=ui*ui*ui,Ys=Math.PI/180,Jo=180/Math.PI;function Ia(d){return(d%=360)<0&&(d+=360),d}function Zr([d,a,h,p]){let x,C;const A=Xi((.2225045*(d=uo(d))+.7168786*(a=uo(a))+.0606169*(h=uo(h)))/1);d===a&&a===h?x=C=A:(x=Xi((.4360747*d+.3850649*a+.1430804*h)/Fr),C=Xi((.0139322*d+.0971045*a+.7141733*h)/wr));const k=116*A-16;return[k<0?0:k,500*(x-A),200*(A-C),p]}function uo(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function Xi(d){return d>Eo?Math.pow(d,1/3):d/Lr+ur}function ho([d,a,h,p]){let x=(d+16)/116,C=isNaN(a)?x:x+a/500,A=isNaN(h)?x:x-h/200;return x=1*Nr(x),C=Fr*Nr(C),A=wr*Nr(A),[Vi(3.1338561*C-1.6168667*x-.4906146*A),Vi(-.9787684*C+1.9161415*x+.033454*A),Vi(.0719453*C-.2289914*x+1.4052427*A),p]}function Vi(d){return(d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055)<0?0:d>1?1:d}function Nr(d){return d>ui?d*d*d:Lr*(d-ur)}const io=Object.hasOwn||function(d,a){return Object.prototype.hasOwnProperty.call(d,a)};function Er(d,a){return io(d,a)?d[a]:void 0}function ua(d){return parseInt(d.padEnd(2,d),16)/255}function Ra(d,a){return Xl(a?d/100:d,0,1)}function Xl(d,a,h){return Math.min(Math.max(a,d),h)}function tf(d){return!d.some(Number.isNaN)}const zh={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Qo(d,a,h){return d+h*(a-d)}function No(d,a,h){return d.map((p,x)=>Qo(p,a[x],h))}class vr{constructor(a,h,p,x=1,C=!0){this.r=a,this.g=h,this.b=p,this.a=x,C||(this.r*=x,this.g*=x,this.b*=x,x||this.overwriteGetter("rgb",[a,h,p,x]))}static parse(a){if(a instanceof vr)return a;if(typeof a!="string")return;const h=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const x=Er(zh,p);if(x){const[A,k,N]=x;return[A/255,k/255,N/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const A=p.length<6?1:2;let k=1;return[ua(p.slice(k,k+=A)),ua(p.slice(k,k+=A)),ua(p.slice(k,k+=A)),ua(p.slice(k,k+A)||"ff")]}if(p.startsWith("rgb")){const A=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(A){const[k,N,j,Y,Q,he,pe,me,_e,ke,Ve,dt]=A,tt=[Y||" ",pe||" ",ke].join("");if(tt==="  "||tt==="  /"||tt===",,"||tt===",,,"){const de=[j,he,_e].join(""),De=de==="%%%"?100:de===""?255:0;if(De){const rt=[Xl(+N/De,0,1),Xl(+Q/De,0,1),Xl(+me/De,0,1),Ve?Ra(+Ve,dt):1];if(tf(rt))return rt}}return}}const C=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[A,k,N,j,Y,Q,he,pe,me]=C,_e=[N||" ",Y||" ",he].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const ke=[+k,Xl(+j,0,100),Xl(+Q,0,100),pe?Ra(+pe,me):1];if(tf(ke))return function([Ve,dt,tt,de]){function De(rt){const Rt=(rt+Ve/30)%12,sn=dt*Math.min(tt,1-tt);return tt-sn*Math.max(-1,Math.min(Rt-3,9-Rt,1))}return Ve=Ia(Ve),dt/=100,tt/=100,[De(0),De(8),De(4),de]}(ke)}}}(a);return h?new vr(...h,!1):void 0}get rgb(){const{r:a,g:h,b:p,a:x}=this,C=x||1/0;return this.overwriteGetter("rgb",[a/C,h/C,p/C,x])}get hcl(){return this.overwriteGetter("hcl",function(a){const[h,p,x,C]=Zr(a),A=Math.sqrt(p*p+x*x);return[Math.round(1e4*A)?Ia(Math.atan2(x,p)*Jo):NaN,A,h,C]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Zr(this.rgb))}overwriteGetter(a,h){return Object.defineProperty(this,a,{value:h}),h}toString(){const[a,h,p,x]=this.rgb;return`rgba(${[a,h,p].map(C=>Math.round(255*C)).join(",")},${x})`}static interpolate(a,h,p,x="rgb"){switch(x){case"rgb":{const[C,A,k,N]=No(a.rgb,h.rgb,p);return new vr(C,A,k,N,!1)}case"hcl":{const[C,A,k,N]=a.hcl,[j,Y,Q,he]=h.hcl;let pe,me;if(isNaN(C)||isNaN(j))isNaN(C)?isNaN(j)?pe=NaN:(pe=j,k!==1&&k!==0||(me=Y)):(pe=C,Q!==1&&Q!==0||(me=A));else{let tt=j-C;j>C&&tt>180?tt-=360:j<C&&C-j>180&&(tt+=360),pe=C+p*tt}const[_e,ke,Ve,dt]=function([tt,de,De,rt]){return tt=isNaN(tt)?0:tt*Ys,ho([De,Math.cos(tt)*de,Math.sin(tt)*de,rt])}([pe,me??Qo(A,Y,p),Qo(k,Q,p),Qo(N,he,p)]);return new vr(_e,ke,Ve,dt,!1)}case"lab":{const[C,A,k,N]=ho(No(a.lab,h.lab,p));return new vr(C,A,k,N,!1)}}}}vr.black=new vr(0,0,0,1),vr.white=new vr(1,1,1,1),vr.transparent=new vr(0,0,0,0),vr.red=new vr(1,0,0,1);class Ks{constructor(a,h,p){this.sensitivity=a?h?"variant":"case":h?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,h){return this.collator.compare(a,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Zl=["bottom","center","top"];class Oc{constructor(a,h,p,x,C,A){this.text=a,this.image=h,this.scale=p,this.fontStack=x,this.textColor=C,this.verticalAlign=A}}class Di{constructor(a){this.sections=a}static fromString(a){return new Di([new Oc(a,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof Di?a:Di.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class Zi{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Zi)return a;if(typeof a=="number")return new Zi([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const h of a)if(typeof h!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new Zi(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,p){return new Zi(No(a.values,h.values,p))}}class To{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof To)return a;if(typeof a=="number")return new To([a]);if(Array.isArray(a)){for(const h of a)if(typeof h!="number")return;return new To(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,p){return new To(No(a.values,h.values,p))}}class Ni{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Ni)return a;if(typeof a=="string"){const p=vr.parse(a);return p?new Ni([p]):void 0}if(!Array.isArray(a))return;const h=[];for(const p of a){if(typeof p!="string")return;const x=vr.parse(p);if(!x)return;h.push(x)}return new Ni(h)}toString(){return JSON.stringify(this.values)}static interpolate(a,h,p,x="rgb"){const C=[];if(a.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${a.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let A=0;A<a.values.length;A++)C.push(vr.interpolate(a.values[A],h.values[A],p,x));return new Ni(C)}}class Pi extends Error{constructor(a){super(a),this.name="RuntimeError"}toJSON(){return this.message}}const Oh=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Tr{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Tr)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let h=0;h<a.length;h+=2){const p=a[h],x=a[h+1];if(typeof p!="string"||!Oh.has(p)||!Array.isArray(x)||x.length!==2||typeof x[0]!="number"||typeof x[1]!="number")return}return new Tr(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,p){const x=a.values,C=h.values;if(x.length!==C.length)throw new Pi(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${h.toString()}`);const A=[];for(let k=0;k<x.length;k+=2){if(x[k]!==C[k])throw new Pi(`Cannot interpolate values containing mismatched anchors. from[${k}]: ${x[k]}, to[${k}]: ${C[k]}`);A.push(x[k]);const[N,j]=x[k+1],[Y,Q]=C[k+1];A.push([Qo(N,Y,p),Qo(j,Q,p)])}return new Tr(A)}}class es{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new es({name:a,available:!1}):null}}class yr{constructor(a,h,p){this.from=a,this.to=h,this.transition=p}static interpolate(a,h,p){return new yr(a,h,p)}static parse(a){return a instanceof yr?a:Array.isArray(a)&&a.length===3&&typeof a[0]=="string"&&typeof a[1]=="string"&&typeof a[2]=="number"?new yr(a[0],a[1],a[2]):typeof a=="object"&&typeof a.from=="string"&&typeof a.to=="string"&&typeof a.transition=="number"?new yr(a.from,a.to,a.transition):typeof a=="string"?new yr(a,a,1):void 0}}function gr(d,a,h,p){return typeof d=="number"&&d>=0&&d<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof h=="number"&&h>=0&&h<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[d,a,h,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[d,a,h,p]:[d,a,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ha(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof yr||d instanceof vr||d instanceof Ks||d instanceof Di||d instanceof Zi||d instanceof To||d instanceof Ni||d instanceof Tr||d instanceof es)return!0;if(Array.isArray(d)){for(const a of d)if(!ha(a))return!1;return!0}if(typeof d=="object"){for(const a in d)if(!ha(d[a]))return!1;return!0}return!1}function sr(d){if(d===null)return It;if(typeof d=="string")return qt;if(typeof d=="boolean")return cn;if(typeof d=="number")return nt;if(d instanceof vr)return Rn;if(d instanceof yr)return Ir;if(d instanceof Ks)return vt;if(d instanceof Di)return kt;if(d instanceof Zi)return xt;if(d instanceof To)return hn;if(d instanceof Ni)return wt;if(d instanceof Tr)return mn;if(d instanceof es)return Pn;if(Array.isArray(d)){const a=d.length;let h;for(const p of d){const x=sr(p);if(h){if(h===x)continue;h=xe;break}h=x}return Tn(h||xe,a)}return _r}function La(d){const a=typeof d;return d===null?"":a==="string"||a==="number"||a==="boolean"?String(d):d instanceof vr||d instanceof yr||d instanceof Di||d instanceof Zi||d instanceof To||d instanceof Ni||d instanceof Tr||d instanceof es?d.toString():JSON.stringify(d)}class ts{constructor(a,h){this.type=a,this.value=h}static parse(a,h){if(a.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!ha(a[1]))return h.error("invalid value");const p=a[1];let x=sr(p);const C=h.expectedType;return x.kind!=="array"||x.N!==0||!C||C.kind!=="array"||typeof C.N=="number"&&C.N!==0||(x=C),new ts(x,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Cu={string:qt,number:nt,boolean:cn,object:_r};class Bo{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let p,x=1;const C=a[0];if(C==="array"){let k,N;if(a.length>2){const j=a[1];if(typeof j!="string"||!(j in Cu)||j==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);k=Cu[j],x++}else k=xe;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return h.error('The length argument to "array" must be a positive integer literal',2);N=a[2],x++}p=Tn(k,N)}else{if(!Cu[C])throw new Error(`Types doesn't contain name = ${C}`);p=Cu[C]}const A=[];for(;x<a.length;x++){const k=h.parse(a[x],x,xe);if(!k)return null;A.push(k)}return new Bo(p,A)}evaluate(a){for(let h=0;h<this.args.length;h++){const p=this.args[h].evaluate(a);if(!An(this.type,sr(p)))return p;if(h===this.args.length-1)throw new Pi(`Expected value to be of type ${Qt(this.type)}, but found ${Qt(sr(p))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Eu={"to-boolean":cn,"to-color":Rn,"to-number":nt,"to-string":qt};class Js{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const p=a[0];if(!Eu[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&a.length!==2)return h.error("Expected one argument.");const x=Eu[p],C=[];for(let A=1;A<a.length;A++){const k=h.parse(a[A],A,xe);if(!k)return null;C.push(k)}return new Js(x,C)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let h,p;for(const x of this.args){if(h=x.evaluate(a),p=null,h instanceof vr)return h;if(typeof h=="string"){const C=a.parseColor(h);if(C)return C}else if(Array.isArray(h)&&(p=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:gr(h[0],h[1],h[2],h[3]),!p))return new vr(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Pi(p||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const p of this.args){h=p.evaluate(a);const x=Zi.parse(h);if(x)return x}throw new Pi(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const p of this.args){h=p.evaluate(a);const x=To.parse(h);if(x)return x}throw new Pi(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const p of this.args){h=p.evaluate(a);const x=Ni.parse(h);if(x)return x}throw new Pi(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const p of this.args){h=p.evaluate(a);const x=Tr.parse(h);if(x)return x}throw new Pi(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const p of this.args){if(h=p.evaluate(a),h===null)return 0;const x=Number(h);if(!isNaN(x))return x}throw new Pi(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return Di.fromString(La(this.args[0].evaluate(a)));case"resolvedImage":return es.fromString(La(this.args[0].evaluate(a)));case"projectionDefinition":return this.args[0].evaluate(a);default:return La(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Cp=["Unknown","Point","LineString","Polygon"];class ll{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Cp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let h=this._parseColorCache.get(a);return h||(h=vr.parse(a),this._parseColorCache.set(a,h)),h}}class Fc{constructor(a,h,p=[],x,C=new or,A=[]){this.registry=a,this.path=p,this.key=p.map(k=>`[${k}]`).join(""),this.scope=C,this.errors=A,this.expectedType=x,this._isConstant=h}parse(a,h,p,x,C={}){return h?this.concat(h,p,x)._parse(a,C):this._parse(a,C)}_parse(a,h){function p(x,C,A){return A==="assert"?new Bo(C,[x]):A==="coerce"?new Js(C,[x]):x}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const x=a[0];if(typeof x!="string")return this.error(`Expression name must be a string, but found ${typeof x} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const C=this.registry[x];if(C){let A=C.parse(a,this);if(!A)return null;if(this.expectedType){const k=this.expectedType,N=A.type;if(k.kind!=="string"&&k.kind!=="number"&&k.kind!=="boolean"&&k.kind!=="object"&&k.kind!=="array"||N.kind!=="value"){if(k.kind==="projectionDefinition"&&["string","array"].includes(N.kind)||["color","formatted","resolvedImage"].includes(k.kind)&&["value","string"].includes(N.kind)||["padding","numberArray"].includes(k.kind)&&["value","number","array"].includes(N.kind)||k.kind==="colorArray"&&["value","string","array"].includes(N.kind)||k.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(N.kind))A=p(A,k,h.typeAnnotation||"coerce");else if(this.checkSubtype(k,N))return null}else A=p(A,k,h.typeAnnotation||"assert")}if(!(A instanceof ts)&&A.type.kind!=="resolvedImage"&&this._isConstant(A)){const k=new ll;try{A=new ts(A.type,A.evaluate(k))}catch(N){return this.error(N.message),null}}return A}return this.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,h,p){const x=typeof a=="number"?this.path.concat(a):this.path,C=p?this.scope.concat(p):this.scope;return new Fc(this.registry,this._isConstant,x,h||null,C,this.errors)}error(a,...h){const p=`${this.key}${h.map(x=>`[${x}]`).join("")}`;this.errors.push(new On(p,a))}checkSubtype(a,h){const p=An(a,h);return p&&this.error(p),p}}class Yl{constructor(a,h){this.type=h.type,this.bindings=[].concat(a),this.result=h}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const h of this.bindings)a(h[1]);a(this.result)}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const p=[];for(let C=1;C<a.length-1;C+=2){const A=a[C];if(typeof A!="string")return h.error(`Expected string, but found ${typeof A} instead.`,C);if(/[^a-zA-Z0-9_]/.test(A))return h.error("Variable names must contain only alphanumeric characters or '_'.",C);const k=h.parse(a[C+1],C+1);if(!k)return null;p.push([A,k])}const x=h.parse(a[a.length-1],a.length-1,h.expectedType,p);return x?new Yl(p,x):null}outputDefined(){return this.result.outputDefined()}}class Qs{constructor(a,h){this.type=h.type,this.name=a,this.boundExpression=h}static parse(a,h){if(a.length!==2||typeof a[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const p=a[1];return h.scope.has(p)?new Qs(p,h.scope.get(p)):h.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class ji{constructor(a,h,p){this.type=a,this.index=h,this.input=p}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=h.parse(a[1],1,nt),x=h.parse(a[2],2,Tn(h.expectedType||xe));return p&&x?new ji(x.type.itemType,p,x):null}evaluate(a){const h=this.index.evaluate(a),p=this.input.evaluate(a);if(h<0)throw new Pi(`Array index out of bounds: ${h} < 0.`);if(h>=p.length)throw new Pi(`Array index out of bounds: ${h} > ${p.length-1}.`);if(h!==Math.floor(h))throw new Pi(`Array index must be an integer, but found ${h} instead.`);return p[h]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class cl{constructor(a,h){this.type=cn,this.needle=a,this.haystack=h}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=h.parse(a[1],1,xe),x=h.parse(a[2],2,xe);return p&&x?Wn(p.type,[cn,qt,nt,It,xe])?new cl(p,x):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qt(p.type)} instead`):null}evaluate(a){const h=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!p)return!1;if(!tr(h,["boolean","string","number","null"]))throw new Pi(`Expected first argument to be of type boolean, string, number or null, but found ${Qt(sr(h))} instead.`);if(!tr(p,["string","array"]))throw new Pi(`Expected second argument to be of type array or string, but found ${Qt(sr(p))} instead.`);return p.indexOf(h)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class Tu{constructor(a,h,p){this.type=nt,this.needle=a,this.haystack=h,this.fromIndex=p}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=h.parse(a[1],1,xe),x=h.parse(a[2],2,xe);if(!p||!x)return null;if(!Wn(p.type,[cn,qt,nt,It,xe]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qt(p.type)} instead`);if(a.length===4){const C=h.parse(a[3],3,nt);return C?new Tu(p,x,C):null}return new Tu(p,x)}evaluate(a){const h=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!tr(h,["boolean","string","number","null"]))throw new Pi(`Expected first argument to be of type boolean, string, number or null, but found ${Qt(sr(h))} instead.`);let x;if(this.fromIndex&&(x=this.fromIndex.evaluate(a)),tr(p,["string"])){const C=p.indexOf(h,x);return C===-1?-1:[...p.slice(0,C)].length}if(tr(p,["array"]))return p.indexOf(h,x);throw new Pi(`Expected second argument to be of type array or string, but found ${Qt(sr(p))} instead.`)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class fo{constructor(a,h,p,x,C,A){this.inputType=a,this.type=h,this.input=p,this.cases=x,this.outputs=C,this.otherwise=A}static parse(a,h){if(a.length<5)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return h.error("Expected an even number of arguments.");let p,x;h.expectedType&&h.expectedType.kind!=="value"&&(x=h.expectedType);const C={},A=[];for(let j=2;j<a.length-1;j+=2){let Y=a[j];const Q=a[j+1];Array.isArray(Y)||(Y=[Y]);const he=h.concat(j);if(Y.length===0)return he.error("Expected at least one branch label.");for(const me of Y){if(typeof me!="number"&&typeof me!="string")return he.error("Branch labels must be numbers or strings.");if(typeof me=="number"&&Math.abs(me)>Number.MAX_SAFE_INTEGER)return he.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof me=="number"&&Math.floor(me)!==me)return he.error("Numeric branch labels must be integer values.");if(p){if(he.checkSubtype(p,sr(me)))return null}else p=sr(me);if(C[String(me)]!==void 0)return he.error("Branch labels must be unique.");C[String(me)]=A.length}const pe=h.parse(Q,j,x);if(!pe)return null;x=x||pe.type,A.push(pe)}const k=h.parse(a[1],1,xe);if(!k)return null;const N=h.parse(a[a.length-1],a.length-1,x);return N?k.type.kind!=="value"&&h.concat(1).checkSubtype(p,k.type)?null:new fo(p,x,k,C,A,N):null}evaluate(a){const h=this.input.evaluate(a);return(sr(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class Si{constructor(a,h,p){this.type=a,this.branches=h,this.otherwise=p}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return h.error("Expected an odd number of arguments.");let p;h.expectedType&&h.expectedType.kind!=="value"&&(p=h.expectedType);const x=[];for(let A=1;A<a.length-1;A+=2){const k=h.parse(a[A],A,cn);if(!k)return null;const N=h.parse(a[A+1],A+1,p);if(!N)return null;x.push([k,N]),p=p||N.type}const C=h.parse(a[a.length-1],a.length-1,p);if(!C)return null;if(!p)throw new Error("Can't infer output type");return new Si(p,x,C)}evaluate(a){for(const[h,p]of this.branches)if(h.evaluate(a))return p.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[h,p]of this.branches)a(h),a(p);a(this.otherwise)}outputDefined(){return this.branches.every(([a,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class Nc{constructor(a,h,p,x){this.type=a,this.input=h,this.beginIndex=p,this.endIndex=x}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=h.parse(a[1],1,xe),x=h.parse(a[2],2,nt);if(!p||!x)return null;if(!Wn(p.type,[Tn(xe),qt,xe]))return h.error(`Expected first argument to be of type array or string, but found ${Qt(p.type)} instead`);if(a.length===4){const C=h.parse(a[3],3,nt);return C?new Nc(p.type,p,x,C):null}return new Nc(p.type,p,x)}evaluate(a){const h=this.input.evaluate(a),p=this.beginIndex.evaluate(a);let x;if(this.endIndex&&(x=this.endIndex.evaluate(a)),tr(h,["string"]))return[...h].slice(p,x).join("");if(tr(h,["array"]))return h.slice(p,x);throw new Pi(`Expected first argument to be of type array or string, but found ${Qt(sr(h))} instead.`)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function Da(d,a){const h=d.length-1;let p,x,C=0,A=h,k=0;for(;C<=A;)if(k=Math.floor((C+A)/2),p=d[k],x=d[k+1],p<=a){if(k===h||a<x)return k;C=k+1}else{if(!(p>a))throw new Pi("Input is not a number.");A=k-1}return 0}class Pu{constructor(a,h,p){this.type=a,this.input=h,this.labels=[],this.outputs=[];for(const[x,C]of p)this.labels.push(x),this.outputs.push(C)}static parse(a,h){if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");const p=h.parse(a[1],1,nt);if(!p)return null;const x=[];let C=null;h.expectedType&&h.expectedType.kind!=="value"&&(C=h.expectedType);for(let A=1;A<a.length;A+=2){const k=A===1?-1/0:a[A],N=a[A+1],j=A,Y=A+1;if(typeof k!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(x.length&&x[x.length-1][0]>=k)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const Q=h.parse(N,Y,C);if(!Q)return null;C=C||Q.type,x.push([k,Q])}return new Pu(C,p,x)}evaluate(a){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(a);const x=this.input.evaluate(a);if(x<=h[0])return p[0].evaluate(a);const C=h.length;return x>=h[C-1]?p[C-1].evaluate(a):p[Da(h,x)].evaluate(a)}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Ep(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var ka,ul,Au=function(){if(ul)return ka;function d(a,h,p,x){this.cx=3*a,this.bx=3*(p-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(x-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=h,this.p2x=p,this.p2y=x}return ul=1,ka=d,d.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,h){if(h===void 0&&(h=1e-6),a<0)return 0;if(a>1)return 1;for(var p=a,x=0;x<8;x++){var C=this.sampleCurveX(p)-a;if(Math.abs(C)<h)return p;var A=this.sampleCurveDerivativeX(p);if(Math.abs(A)<1e-6)break;p-=C/A}var k=0,N=1;for(p=a,x=0;x<20&&(C=this.sampleCurveX(p),!(Math.abs(C-a)<h));x++)a>C?k=p:N=p,p=.5*(N-k)+k;return p},solve:function(a,h){return this.sampleCurveY(this.solveCurveX(a,h))}},ka}(),Qm=Ep(Au);class ns{constructor(a,h,p,x,C){this.type=a,this.operator=h,this.interpolation=p,this.input=x,this.labels=[],this.outputs=[];for(const[A,k]of C)this.labels.push(A),this.outputs.push(k)}static interpolationFactor(a,h,p,x){let C=0;if(a.name==="exponential")C=Iu(h,a.base,p,x);else if(a.name==="linear")C=Iu(h,1,p,x);else if(a.name==="cubic-bezier"){const A=a.controlPoints;C=new Qm(A[0],A[1],A[2],A[3]).solve(Iu(h,1,p,x))}return C}static parse(a,h){let[p,x,C,...A]=a;if(!Array.isArray(x)||x.length===0)return h.error("Expected an interpolation type expression.",1);if(x[0]==="linear")x={name:"linear"};else if(x[0]==="exponential"){const j=x[1];if(typeof j!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);x={name:"exponential",base:j}}else{if(x[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(x[0])}`,1,0);{const j=x.slice(1);if(j.length!==4||j.some(Y=>typeof Y!="number"||Y<0||Y>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);x={name:"cubic-bezier",controlPoints:j}}}if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(C=h.parse(C,2,nt),!C)return null;const k=[];let N=null;p!=="interpolate-hcl"&&p!=="interpolate-lab"||h.expectedType==wt?h.expectedType&&h.expectedType.kind!=="value"&&(N=h.expectedType):N=Rn;for(let j=0;j<A.length;j+=2){const Y=A[j],Q=A[j+1],he=j+3,pe=j+4;if(typeof Y!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',he);if(k.length&&k[k.length-1][0]>=Y)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',he);const me=h.parse(Q,pe,N);if(!me)return null;N=N||me.type,k.push([Y,me])}return Or(N,nt)||Or(N,Ir)||Or(N,Rn)||Or(N,xt)||Or(N,hn)||Or(N,wt)||Or(N,mn)||Or(N,Tn(nt))?new ns(N,p,x,C,k):h.error(`Type ${Qt(N)} is not interpolatable.`)}evaluate(a){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(a);const x=this.input.evaluate(a);if(x<=h[0])return p[0].evaluate(a);const C=h.length;if(x>=h[C-1])return p[C-1].evaluate(a);const A=Da(h,x),k=ns.interpolationFactor(this.interpolation,x,h[A],h[A+1]),N=p[A].evaluate(a),j=p[A+1].evaluate(a);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Qo(N,j,k);case"color":return vr.interpolate(N,j,k);case"padding":return Zi.interpolate(N,j,k);case"colorArray":return Ni.interpolate(N,j,k);case"numberArray":return To.interpolate(N,j,k);case"variableAnchorOffsetCollection":return Tr.interpolate(N,j,k);case"array":return No(N,j,k);case"projectionDefinition":return yr.interpolate(N,j,k)}case"interpolate-hcl":switch(this.type.kind){case"color":return vr.interpolate(N,j,k,"hcl");case"colorArray":return Ni.interpolate(N,j,k,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return vr.interpolate(N,j,k,"lab");case"colorArray":return Ni.interpolate(N,j,k,"lab")}}}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Iu(d,a,h,p){const x=p-h,C=d-h;return x===0?0:a===1?C/x:(Math.pow(a,C)-1)/(Math.pow(a,x)-1)}const Ls={color:vr.interpolate,number:Qo,padding:Zi.interpolate,numberArray:To.interpolate,colorArray:Ni.interpolate,variableAnchorOffsetCollection:Tr.interpolate,array:No};class Uo{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let p=null;const x=h.expectedType;x&&x.kind!=="value"&&(p=x);const C=[];for(const k of a.slice(1)){const N=h.parse(k,1+C.length,p,void 0,{typeAnnotation:"omit"});if(!N)return null;p=p||N.type,C.push(N)}if(!p)throw new Error("No output type");const A=x&&C.some(k=>An(x,k.type));return new Uo(A?xe:p,C)}evaluate(a){let h,p=null,x=0;for(const C of this.args)if(x++,p=C.evaluate(a),p&&p instanceof es&&!p.available&&(h||(h=p.name),p=null,x===this.args.length&&(p=h)),p!==null)break;return p}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}function Tp(d,a){return d==="=="||d==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function Fh(d,a,h,p){return p.compare(a,h)===0}function Ru(d,a,h){const p=d!=="=="&&d!=="!=";return class kF{constructor(C,A,k){this.type=cn,this.lhs=C,this.rhs=A,this.collator=k,this.hasUntypedArgument=C.type.kind==="value"||A.type.kind==="value"}static parse(C,A){if(C.length!==3&&C.length!==4)return A.error("Expected two or three arguments.");const k=C[0];let N=A.parse(C[1],1,xe);if(!N)return null;if(!Tp(k,N.type))return A.concat(1).error(`"${k}" comparisons are not supported for type '${Qt(N.type)}'.`);let j=A.parse(C[2],2,xe);if(!j)return null;if(!Tp(k,j.type))return A.concat(2).error(`"${k}" comparisons are not supported for type '${Qt(j.type)}'.`);if(N.type.kind!==j.type.kind&&N.type.kind!=="value"&&j.type.kind!=="value")return A.error(`Cannot compare types '${Qt(N.type)}' and '${Qt(j.type)}'.`);p&&(N.type.kind==="value"&&j.type.kind!=="value"?N=new Bo(j.type,[N]):N.type.kind!=="value"&&j.type.kind==="value"&&(j=new Bo(N.type,[j])));let Y=null;if(C.length===4){if(N.type.kind!=="string"&&j.type.kind!=="string"&&N.type.kind!=="value"&&j.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(Y=A.parse(C[3],3,vt),!Y)return null}return new kF(N,j,Y)}evaluate(C){const A=this.lhs.evaluate(C),k=this.rhs.evaluate(C);if(p&&this.hasUntypedArgument){const N=sr(A),j=sr(k);if(N.kind!==j.kind||N.kind!=="string"&&N.kind!=="number")throw new Pi(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${N.kind}, ${j.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const N=sr(A),j=sr(k);if(N.kind!=="string"||j.kind!=="string")return a(C,A,k)}return this.collator?h(C,A,k,this.collator.evaluate(C)):a(C,A,k)}eachChild(C){C(this.lhs),C(this.rhs),this.collator&&C(this.collator)}outputDefined(){return!0}}}const Pp=Ru("==",function(d,a,h){return a===h},Fh),vy=Ru("!=",function(d,a,h){return a!==h},function(d,a,h,p){return!Fh(0,a,h,p)}),eg=Ru("<",function(d,a,h){return a<h},function(d,a,h,p){return p.compare(a,h)<0}),yy=Ru(">",function(d,a,h){return a>h},function(d,a,h,p){return p.compare(a,h)>0}),_y=Ru("<=",function(d,a,h){return a<=h},function(d,a,h,p){return p.compare(a,h)<=0}),nf=Ru(">=",function(d,a,h){return a>=h},function(d,a,h,p){return p.compare(a,h)>=0});class rf{constructor(a,h,p){this.type=vt,this.locale=p,this.caseSensitive=a,this.diacriticSensitive=h}static parse(a,h){if(a.length!==2)return h.error("Expected one argument.");const p=a[1];if(typeof p!="object"||Array.isArray(p))return h.error("Collator options argument must be an object.");const x=h.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,cn);if(!x)return null;const C=h.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,cn);if(!C)return null;let A=null;return p.locale&&(A=h.parse(p.locale,1,qt),!A)?null:new rf(x,C,A)}evaluate(a){return new Ks(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}class Lu{constructor(a,h,p,x,C){this.type=qt,this.number=a,this.locale=h,this.currency=p,this.minFractionDigits=x,this.maxFractionDigits=C}static parse(a,h){if(a.length!==3)return h.error("Expected two arguments.");const p=h.parse(a[1],1,nt);if(!p)return null;const x=a[2];if(typeof x!="object"||Array.isArray(x))return h.error("NumberFormat options argument must be an object.");let C=null;if(x.locale&&(C=h.parse(x.locale,1,qt),!C))return null;let A=null;if(x.currency&&(A=h.parse(x.currency,1,qt),!A))return null;let k=null;if(x["min-fraction-digits"]&&(k=h.parse(x["min-fraction-digits"],1,nt),!k))return null;let N=null;return x["max-fraction-digits"]&&(N=h.parse(x["max-fraction-digits"],1,nt),!N)?null:new Lu(p,C,A,k,N)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class Nh{constructor(a){this.type=kt,this.sections=a}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const p=a[1];if(!Array.isArray(p)&&typeof p=="object")return h.error("First argument must be an image or text section.");const x=[];let C=!1;for(let A=1;A<=a.length-1;++A){const k=a[A];if(C&&typeof k=="object"&&!Array.isArray(k)){C=!1;let N=null;if(k["font-scale"]&&(N=h.parse(k["font-scale"],1,nt),!N))return null;let j=null;if(k["text-font"]&&(j=h.parse(k["text-font"],1,Tn(qt)),!j))return null;let Y=null;if(k["text-color"]&&(Y=h.parse(k["text-color"],1,Rn),!Y))return null;let Q=null;if(k["vertical-align"]){if(typeof k["vertical-align"]=="string"&&!Zl.includes(k["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${k["vertical-align"]}' instead.`);if(Q=h.parse(k["vertical-align"],1,qt),!Q)return null}const he=x[x.length-1];he.scale=N,he.font=j,he.textColor=Y,he.verticalAlign=Q}else{const N=h.parse(a[A],1,xe);if(!N)return null;const j=N.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");C=!0,x.push({content:N,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Nh(x)}evaluate(a){return new Di(this.sections.map(h=>{const p=h.content.evaluate(a);return sr(p)===Pn?new Oc("",p,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(a):null):new Oc(La(p),null,h.scale?h.scale.evaluate(a):null,h.font?h.font.evaluate(a).join(","):null,h.textColor?h.textColor.evaluate(a):null,h.verticalAlign?h.verticalAlign.evaluate(a):null)}))}eachChild(a){for(const h of this.sections)a(h.content),h.scale&&a(h.scale),h.font&&a(h.font),h.textColor&&a(h.textColor),h.verticalAlign&&a(h.verticalAlign)}outputDefined(){return!1}}class Ap{constructor(a){this.type=Pn,this.input=a}static parse(a,h){if(a.length!==2)return h.error("Expected two arguments.");const p=h.parse(a[1],1,qt);return p?new Ap(p):h.error("No image name provided.")}evaluate(a){const h=this.input.evaluate(a),p=es.fromString(h);return p&&a.availableImages&&(p.available=a.availableImages.indexOf(h)>-1),p}eachChild(a){a(this.input)}outputDefined(){return!1}}class of{constructor(a){this.type=nt,this.input=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const p=h.parse(a[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Qt(p.type)} instead.`):new of(p):null}evaluate(a){const h=this.input.evaluate(a);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new Pi(`Expected value to be of type string or array, but found ${Qt(sr(h))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const da=8192;function xy(d,a){const h=(180+d[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,x=Math.pow(2,a.z);return[Math.round(h*x*da),Math.round(p*x*da)]}function Ip(d,a){const h=Math.pow(2,a.z);return[(x=(d[0]/da+a.x)/h,360*x-180),(p=(d[1]/da+a.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,x}function Bh(d,a){d[0]=Math.min(d[0],a[0]),d[1]=Math.min(d[1],a[1]),d[2]=Math.max(d[2],a[0]),d[3]=Math.max(d[3],a[1])}function Uh(d,a){return!(d[0]<=a[0]||d[2]>=a[2]||d[1]<=a[1]||d[3]>=a[3])}function tg(d,a,h){const p=d[0]-a[0],x=d[1]-a[1],C=d[0]-h[0],A=d[1]-h[1];return p*A-C*x==0&&p*C<=0&&x*A<=0}function $h(d,a,h,p){return(x=[p[0]-h[0],p[1]-h[1]])[0]*(C=[a[0]-d[0],a[1]-d[1]])[1]-x[1]*C[0]!=0&&!(!jh(d,a,h,p)||!jh(h,p,d,a));var x,C}function ng(d,a,h){for(const p of h)for(let x=0;x<p.length-1;++x)if($h(d,a,p[x],p[x+1]))return!0;return!1}function Kl(d,a,h=!1){let p=!1;for(const k of a)for(let N=0;N<k.length-1;N++){if(tg(d,k[N],k[N+1]))return h;(C=k[N])[1]>(x=d)[1]!=(A=k[N+1])[1]>x[1]&&x[0]<(A[0]-C[0])*(x[1]-C[1])/(A[1]-C[1])+C[0]&&(p=!p)}var x,C,A;return p}function Vh(d,a){for(const h of a)if(Kl(d,h))return!0;return!1}function rg(d,a){for(const h of d)if(!Kl(h,a))return!1;for(let h=0;h<d.length-1;++h)if(ng(d[h],d[h+1],a))return!1;return!0}function ig(d,a){for(const h of a)if(rg(d,h))return!0;return!1}function jh(d,a,h,p){const x=p[0]-h[0],C=p[1]-h[1],A=(d[0]-h[0])*C-x*(d[1]-h[1]),k=(a[0]-h[0])*C-x*(a[1]-h[1]);return A>0&&k<0||A<0&&k>0}function sf(d,a,h){const p=[];for(let x=0;x<d.length;x++){const C=[];for(let A=0;A<d[x].length;A++){const k=xy(d[x][A],h);Bh(a,k),C.push(k)}p.push(C)}return p}function Rp(d,a,h){const p=[];for(let x=0;x<d.length;x++){const C=sf(d[x],a,h);p.push(C)}return p}function Lp(d,a,h,p){if(d[0]<h[0]||d[0]>h[2]){const x=.5*p;let C=d[0]-h[0]>x?-p:h[0]-d[0]>x?p:0;C===0&&(C=d[0]-h[2]>x?-p:h[2]-d[0]>x?p:0),d[0]+=C}Bh(a,d)}function Jl(d,a,h,p){const x=Math.pow(2,p.z)*da,C=[p.x*da,p.y*da],A=[];for(const k of d)for(const N of k){const j=[N.x+C[0],N.y+C[1]];Lp(j,a,h,x),A.push(j)}return A}function Dp(d,a,h,p){const x=Math.pow(2,p.z)*da,C=[p.x*da,p.y*da],A=[];for(const N of d){const j=[];for(const Y of N){const Q=[Y.x+C[0],Y.y+C[1]];Bh(a,Q),j.push(Q)}A.push(j)}if(a[2]-a[0]<=x/2){(k=a)[0]=k[1]=1/0,k[2]=k[3]=-1/0;for(const N of A)for(const j of N)Lp(j,a,h,x)}var k;return A}class Bc{constructor(a,h){this.type=cn,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(ha(a[1])){const p=a[1];if(p.type==="FeatureCollection"){const x=[];for(const C of p.features){const{type:A,coordinates:k}=C.geometry;A==="Polygon"&&x.push(k),A==="MultiPolygon"&&x.push(...k)}if(x.length)return new Bc(p,{type:"MultiPolygon",coordinates:x})}else if(p.type==="Feature"){const x=p.geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new Bc(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Bc(p,p)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,p){const x=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],A=h.canonicalID();if(p.type==="Polygon"){const k=sf(p.coordinates,C,A),N=Jl(h.geometry(),x,C,A);if(!Uh(x,C))return!1;for(const j of N)if(!Kl(j,k))return!1}if(p.type==="MultiPolygon"){const k=Rp(p.coordinates,C,A),N=Jl(h.geometry(),x,C,A);if(!Uh(x,C))return!1;for(const j of N)if(!Vh(j,k))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,p){const x=[1/0,1/0,-1/0,-1/0],C=[1/0,1/0,-1/0,-1/0],A=h.canonicalID();if(p.type==="Polygon"){const k=sf(p.coordinates,C,A),N=Dp(h.geometry(),x,C,A);if(!Uh(x,C))return!1;for(const j of N)if(!rg(j,k))return!1}if(p.type==="MultiPolygon"){const k=Rp(p.coordinates,C,A),N=Dp(h.geometry(),x,C,A);if(!Uh(x,C))return!1;for(const j of N)if(!ig(j,k))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let og=class{constructor(d=[],a=(h,p)=>h<p?-1:h>p?1:0){if(this.data=d,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(d){this.data.push(d),this._up(this.length++)}pop(){if(this.length===0)return;const d=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),d}peek(){return this.data[0]}_up(d){const{data:a,compare:h}=this,p=a[d];for(;d>0;){const x=d-1>>1,C=a[x];if(h(p,C)>=0)break;a[d]=C,d=x}a[d]=p}_down(d){const{data:a,compare:h}=this,p=this.length>>1,x=a[d];for(;d<p;){let C=1+(d<<1);const A=C+1;if(A<this.length&&h(a[A],a[C])<0&&(C=A),h(a[C],x)>=0)break;a[d]=a[C],d=C}a[d]=x}};function af(d,a,h=0,p=d.length-1,x=Hh){for(;p>h;){if(p-h>600){const N=p-h+1,j=a-h+1,Y=Math.log(N),Q=.5*Math.exp(2*Y/3),he=.5*Math.sqrt(Y*Q*(N-Q)/N)*(j-N/2<0?-1:1);af(d,a,Math.max(h,Math.floor(a-j*Q/N+he)),Math.min(p,Math.floor(a+(N-j)*Q/N+he)),x)}const C=d[a];let A=h,k=p;for(Uc(d,h,a),x(d[p],C)>0&&Uc(d,h,p);A<k;){for(Uc(d,A,k),A++,k--;x(d[A],C)<0;)A++;for(;x(d[k],C)>0;)k--}x(d[h],C)===0?Uc(d,h,k):(k++,Uc(d,k,p)),k<=a&&(h=k+1),a<=k&&(p=k-1)}}function Uc(d,a,h){const p=d[a];d[a]=d[h],d[h]=p}function Hh(d,a){return d<a?-1:d>a?1:0}function Ql(d,a){if(d.length<=1)return[d];const h=[];let p,x;for(const C of d){const A=Gh(C);A!==0&&(C.area=Math.abs(A),x===void 0&&(x=A<0),x===A<0?(p&&h.push(p),p=[C]):p.push(C))}if(p&&h.push(p),a>1)for(let C=0;C<h.length;C++)h[C].length<=a||(af(h[C],a,1,h[C].length-1,by),h[C]=h[C].slice(0,a));return h}function by(d,a){return a.area-d.area}function Gh(d){let a=0;for(let h,p,x=0,C=d.length,A=C-1;x<C;A=x++)h=d[x],p=d[A],a+=(p.x-h.x)*(h.y+p.y);return a}const sg=1/298.257223563,kp=sg*(2-sg),lf=Math.PI/180;class Wh{constructor(a){const h=6378.137*lf*1e3,p=Math.cos(a*lf),x=1/(1-kp*(1-p*p)),C=Math.sqrt(x);this.kx=h*C*p,this.ky=h*C*x*(1-kp)}distance(a,h){const p=this.wrap(a[0]-h[0])*this.kx,x=(a[1]-h[1])*this.ky;return Math.sqrt(p*p+x*x)}pointOnLine(a,h){let p,x,C,A,k=1/0;for(let N=0;N<a.length-1;N++){let j=a[N][0],Y=a[N][1],Q=this.wrap(a[N+1][0]-j)*this.kx,he=(a[N+1][1]-Y)*this.ky,pe=0;Q===0&&he===0||(pe=(this.wrap(h[0]-j)*this.kx*Q+(h[1]-Y)*this.ky*he)/(Q*Q+he*he),pe>1?(j=a[N+1][0],Y=a[N+1][1]):pe>0&&(j+=Q/this.kx*pe,Y+=he/this.ky*pe)),Q=this.wrap(h[0]-j)*this.kx,he=(h[1]-Y)*this.ky;const me=Q*Q+he*he;me<k&&(k=me,p=j,x=Y,C=N,A=pe)}return{point:[p,x],index:C,t:Math.max(0,Math.min(1,A))}}wrap(a){for(;a<-180;)a+=360;for(;a>180;)a-=360;return a}}function Vr(d,a){return a[0]-d[0]}function qh(d){return d[1]-d[0]+1}function za(d,a){return d[1]>=d[0]&&d[1]<a}function zp(d,a){if(d[0]>d[1])return[null,null];const h=qh(d);if(a){if(h===2)return[d,null];const x=Math.floor(h/2);return[[d[0],d[0]+x],[d[0]+x,d[1]]]}if(h===1)return[d,null];const p=Math.floor(h/2)-1;return[[d[0],d[0]+p],[d[0]+p+1,d[1]]]}function Op(d,a){if(!za(a,d.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let p=a[0];p<=a[1];++p)Bh(h,d[p]);return h}function Fp(d){const a=[1/0,1/0,-1/0,-1/0];for(const h of d)for(const p of h)Bh(a,p);return a}function ag(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function Np(d,a,h){if(!ag(d)||!ag(a))return NaN;let p=0,x=0;return d[2]<a[0]&&(p=a[0]-d[2]),d[0]>a[2]&&(p=d[0]-a[2]),d[1]>a[3]&&(x=d[1]-a[3]),d[3]<a[1]&&(x=a[1]-d[3]),h.distance([0,0],[p,x])}function Po(d,a,h){const p=h.pointOnLine(a,d);return h.distance(d,p.point)}function $c(d,a,h,p,x){const C=Math.min(Po(d,[h,p],x),Po(a,[h,p],x)),A=Math.min(Po(h,[d,a],x),Po(p,[d,a],x));return Math.min(C,A)}function lg(d,a,h,p,x){if(!za(a,d.length)||!za(p,h.length))return 1/0;let C=1/0;for(let A=a[0];A<a[1];++A){const k=d[A],N=d[A+1];for(let j=p[0];j<p[1];++j){const Y=h[j],Q=h[j+1];if($h(k,N,Y,Q))return 0;C=Math.min(C,$c(k,N,Y,Q,x))}}return C}function cg(d,a,h,p,x){if(!za(a,d.length)||!za(p,h.length))return NaN;let C=1/0;for(let A=a[0];A<=a[1];++A)for(let k=p[0];k<=p[1];++k)if(C=Math.min(C,x.distance(d[A],h[k])),C===0)return C;return C}function ug(d,a,h){if(Kl(d,a,!0))return 0;let p=1/0;for(const x of a){const C=x[0],A=x[x.length-1];if(C!==A&&(p=Math.min(p,Po(d,[A,C],h)),p===0))return p;const k=h.pointOnLine(x,d);if(p=Math.min(p,h.distance(d,k.point)),p===0)return p}return p}function hg(d,a,h,p){if(!za(a,d.length))return NaN;for(let C=a[0];C<=a[1];++C)if(Kl(d[C],h,!0))return 0;let x=1/0;for(let C=a[0];C<a[1];++C){const A=d[C],k=d[C+1];for(const N of h)for(let j=0,Y=N.length,Q=Y-1;j<Y;Q=j++){const he=N[Q],pe=N[j];if($h(A,k,he,pe))return 0;x=Math.min(x,$c(A,k,he,pe,p))}}return x}function cf(d,a){for(const h of d)for(const p of h)if(Kl(p,a,!0))return!0;return!1}function wy(d,a,h,p=1/0){const x=Fp(d),C=Fp(a);if(p!==1/0&&Np(x,C,h)>=p)return p;if(Uh(x,C)){if(cf(d,a))return 0}else if(cf(a,d))return 0;let A=1/0;for(const k of d)for(let N=0,j=k.length,Y=j-1;N<j;Y=N++){const Q=k[Y],he=k[N];for(const pe of a)for(let me=0,_e=pe.length,ke=_e-1;me<_e;ke=me++){const Ve=pe[ke],dt=pe[me];if($h(Q,he,Ve,dt))return 0;A=Math.min(A,$c(Q,he,Ve,dt,h))}}return A}function dg(d,a,h,p,x,C){if(!C)return;const A=Np(Op(p,C),x,h);A<a&&d.push([A,C,[0,0]])}function hl(d,a,h,p,x,C,A){if(!C||!A)return;const k=Np(Op(p,C),Op(x,A),h);k<a&&d.push([k,C,A])}function Du(d,a,h,p,x=1/0){let C=Math.min(p.distance(d[0],h[0][0]),x);if(C===0)return C;const A=new og([[0,[0,d.length-1],[0,0]]],Vr),k=Fp(h);for(;A.length>0;){const N=A.pop();if(N[0]>=C)continue;const j=N[1],Y=a?50:100;if(qh(j)<=Y){if(!za(j,d.length))return NaN;if(a){const Q=hg(d,j,h,p);if(isNaN(Q)||Q===0)return Q;C=Math.min(C,Q)}else for(let Q=j[0];Q<=j[1];++Q){const he=ug(d[Q],h,p);if(C=Math.min(C,he),C===0)return 0}}else{const Q=zp(j,a);dg(A,C,p,d,k,Q[0]),dg(A,C,p,d,k,Q[1])}}return C}function ec(d,a,h,p,x,C=1/0){let A=Math.min(C,x.distance(d[0],h[0]));if(A===0)return A;const k=new og([[0,[0,d.length-1],[0,h.length-1]]],Vr);for(;k.length>0;){const N=k.pop();if(N[0]>=A)continue;const j=N[1],Y=N[2],Q=a?50:100,he=p?50:100;if(qh(j)<=Q&&qh(Y)<=he){if(!za(j,d.length)&&za(Y,h.length))return NaN;let pe;if(a&&p)pe=lg(d,j,h,Y,x),A=Math.min(A,pe);else if(a&&!p){const me=d.slice(j[0],j[1]+1);for(let _e=Y[0];_e<=Y[1];++_e)if(pe=Po(h[_e],me,x),A=Math.min(A,pe),A===0)return A}else if(!a&&p){const me=h.slice(Y[0],Y[1]+1);for(let _e=j[0];_e<=j[1];++_e)if(pe=Po(d[_e],me,x),A=Math.min(A,pe),A===0)return A}else pe=cg(d,j,h,Y,x),A=Math.min(A,pe)}else{const pe=zp(j,a),me=zp(Y,p);hl(k,A,x,d,h,pe[0],me[0]),hl(k,A,x,d,h,pe[0],me[1]),hl(k,A,x,d,h,pe[1],me[0]),hl(k,A,x,d,h,pe[1],me[1])}}return A}function Xh(d){return d.type==="MultiPolygon"?d.coordinates.map(a=>({type:"Polygon",coordinates:a})):d.type==="MultiLineString"?d.coordinates.map(a=>({type:"LineString",coordinates:a})):d.type==="MultiPoint"?d.coordinates.map(a=>({type:"Point",coordinates:a})):[d]}class tc{constructor(a,h){this.type=nt,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${a.length-1} instead.`);if(ha(a[1])){const p=a[1];if(p.type==="FeatureCollection")return new tc(p,p.features.map(x=>Xh(x.geometry)).flat());if(p.type==="Feature")return new tc(p,Xh(p.geometry));if("type"in p&&"coordinates"in p)return new tc(p,Xh(p))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,p){const x=h.geometry(),C=x.flat().map(N=>Ip([N.x,N.y],h.canonical));if(x.length===0)return NaN;const A=new Wh(C[0][1]);let k=1/0;for(const N of p){switch(N.type){case"Point":k=Math.min(k,ec(C,!1,[N.coordinates],!1,A,k));break;case"LineString":k=Math.min(k,ec(C,!1,N.coordinates,!0,A,k));break;case"Polygon":k=Math.min(k,Du(C,!1,N.coordinates,A,k))}if(k===0)return k}return k}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,p){const x=h.geometry(),C=x.flat().map(N=>Ip([N.x,N.y],h.canonical));if(x.length===0)return NaN;const A=new Wh(C[0][1]);let k=1/0;for(const N of p){switch(N.type){case"Point":k=Math.min(k,ec(C,!0,[N.coordinates],!1,A,k));break;case"LineString":k=Math.min(k,ec(C,!0,N.coordinates,!0,A,k));break;case"Polygon":k=Math.min(k,Du(C,!0,N.coordinates,A,k))}if(k===0)return k}return k}(a,this.geometries);if(a.geometryType()==="Polygon")return function(h,p){const x=h.geometry();if(x.length===0||x[0].length===0)return NaN;const C=Ql(x,0).map(N=>N.map(j=>j.map(Y=>Ip([Y.x,Y.y],h.canonical)))),A=new Wh(C[0][0][0][1]);let k=1/0;for(const N of p)for(const j of C){switch(N.type){case"Point":k=Math.min(k,Du([N.coordinates],!1,j,A,k));break;case"LineString":k=Math.min(k,Du(N.coordinates,!0,j,A,k));break;case"Polygon":k=Math.min(k,wy(j,N.coordinates,A,k))}if(k===0)return k}return k}(a,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class nc{constructor(a){this.type=xe,this.key=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const p=a[1];return p==null?h.error("Global state property must be defined."):typeof p!="string"?h.error(`Global state property must be string, but found ${typeof a[1]} instead.`):new nc(p)}evaluate(a){var h;const p=(h=a.globals)===null||h===void 0?void 0:h.globalState;return p&&Object.keys(p).length!==0?Er(p,this.key):null}eachChild(){}outputDefined(){return!1}}const fa={"==":Pp,"!=":vy,">":yy,"<":eg,">=":nf,"<=":_y,array:Bo,at:ji,boolean:Bo,case:Si,coalesce:Uo,collator:rf,format:Nh,image:Ap,in:cl,"index-of":Tu,interpolate:ns,"interpolate-hcl":ns,"interpolate-lab":ns,length:of,let:Yl,literal:ts,match:fo,number:Bo,"number-format":Lu,object:Bo,slice:Nc,step:Pu,string:Bo,"to-boolean":Js,"to-color":Js,"to-number":Js,"to-string":Js,var:Qs,within:Bc,distance:tc,"global-state":nc};class vs{constructor(a,h,p,x){this.name=a,this.type=h,this._evaluate=p,this.args=x}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,h){const p=a[0],x=vs.definitions[p];if(!x)return h.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const C=Array.isArray(x)?x[0]:x.type,A=Array.isArray(x)?[[x[1],x[2]]]:x.overloads,k=A.filter(([j])=>!Array.isArray(j)||j.length===a.length-1);let N=null;for(const[j,Y]of k){N=new Fc(h.registry,Yh,h.path,null,h.scope);const Q=[];let he=!1;for(let pe=1;pe<a.length;pe++){const me=a[pe],_e=Array.isArray(j)?j[pe-1]:j.type,ke=N.parse(me,1+Q.length,_e);if(!ke){he=!0;break}Q.push(ke)}if(!he)if(Array.isArray(j)&&j.length!==Q.length)N.error(`Expected ${j.length} arguments, but found ${Q.length} instead.`);else{for(let pe=0;pe<Q.length;pe++){const me=Array.isArray(j)?j[pe]:j.type,_e=Q[pe];N.concat(pe+1).checkSubtype(me,_e.type)}if(N.errors.length===0)return new vs(p,C,Y,Q)}}if(k.length===1)h.errors.push(...N.errors);else{const j=(k.length?k:A).map(([Q])=>{return he=Q,Array.isArray(he)?`(${he.map(Qt).join(", ")})`:`(${Qt(he.type)}...)`;var he}).join(" | "),Y=[];for(let Q=1;Q<a.length;Q++){const he=h.parse(a[Q],1+Y.length);if(!he)return null;Y.push(Qt(he.type))}h.error(`Expected arguments of type ${j}, but found (${Y.join(", ")}) instead.`)}return null}static register(a,h){vs.definitions=h;for(const p in h)a[p]=vs}}function Bp(d,[a,h,p,x]){a=a.evaluate(d),h=h.evaluate(d),p=p.evaluate(d);const C=x?x.evaluate(d):1,A=gr(a,h,p,C);if(A)throw new Pi(A);return new vr(a/255,h/255,p/255,C,!1)}function Zh(d,a){return d in a}function uf(d,a){const h=a[d];return h===void 0?null:h}function rc(d){return{type:d}}function Yh(d){if(d instanceof Qs)return Yh(d.boundExpression);if(d instanceof vs&&d.name==="error"||d instanceof rf||d instanceof Bc||d instanceof tc||d instanceof nc)return!1;const a=d instanceof Js||d instanceof Bo;let h=!0;return d.eachChild(p=>{h=a?h&&Yh(p):h&&p instanceof ts}),!!h&&Kh(d)&&Vc(d,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Kh(d){if(d instanceof vs&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Bc||d instanceof tc)return!1;let a=!0;return d.eachChild(h=>{a&&!Kh(h)&&(a=!1)}),a}function ku(d){if(d instanceof vs&&d.name==="feature-state")return!1;let a=!0;return d.eachChild(h=>{a&&!ku(h)&&(a=!1)}),a}function Vc(d,a){if(d instanceof vs&&a.indexOf(d.name)>=0)return!1;let h=!0;return d.eachChild(p=>{h&&!Vc(p,a)&&(h=!1)}),h}function dl(d){return{result:"success",value:d}}function ic(d){return{result:"error",value:d}}function oc(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function Up(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function $p(d){return!!d.expression&&d.expression.interpolated}function Sr(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function jc(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)&&sr(d)===_r}function Vp(d){return d}function jp(d,a){const h=d.stops&&typeof d.stops[0][0]=="object",p=h||!(h||d.property!==void 0),x=d.type||($p(a)?"exponential":"interval"),C=function(Y){switch(Y.type){case"color":return vr.parse;case"padding":return Zi.parse;case"numberArray":return To.parse;case"colorArray":return Ni.parse;default:return null}}(a);if(C&&((d=Gn({},d)).stops&&(d.stops=d.stops.map(Y=>[Y[0],C(Y[1])])),d.default=C(d.default?d.default:a.default)),d.colorSpace&&(A=d.colorSpace)!=="rgb"&&A!=="hcl"&&A!=="lab")throw new Error(`Unknown color space: "${d.colorSpace}"`);var A;const k=function(Y){switch(Y){case"exponential":return zu;case"interval":return hf;case"categorical":return Hp;case"identity":return Gp;default:throw new Error(`Unknown function type "${Y}"`)}}(x);let N,j;if(x==="categorical"){N=Object.create(null);for(const Y of d.stops)N[Y[0]]=Y[1];j=typeof d.stops[0][0]}if(h){const Y={},Q=[];for(let me=0;me<d.stops.length;me++){const _e=d.stops[me],ke=_e[0].zoom;Y[ke]===void 0&&(Y[ke]={zoom:ke,type:d.type,property:d.property,default:d.default,stops:[]},Q.push(ke)),Y[ke].stops.push([_e[0].value,_e[1]])}const he=[];for(const me of Q)he.push([Y[me].zoom,jp(Y[me],a)]);const pe={name:"linear"};return{kind:"composite",interpolationType:pe,interpolationFactor:ns.interpolationFactor.bind(void 0,pe),zoomStops:he.map(me=>me[0]),evaluate:({zoom:me},_e)=>zu({stops:he,base:d.base},a,me).evaluate(me,_e)}}if(p){const Y=x==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:Y,interpolationFactor:ns.interpolationFactor.bind(void 0,Y),zoomStops:d.stops.map(Q=>Q[0]),evaluate:({zoom:Q})=>k(d,a,Q,N,j)}}return{kind:"source",evaluate(Y,Q){const he=Q&&Q.properties?Q.properties[d.property]:void 0;return he===void 0?oi(d.default,a.default):k(d,a,he,N,j)}}}function oi(d,a,h){return d!==void 0?d:a!==void 0?a:h!==void 0?h:void 0}function Hp(d,a,h,p,x){return oi(typeof h===x?p[h]:void 0,d.default,a.default)}function hf(d,a,h){if(Sr(h)!=="number")return oi(d.default,a.default);const p=d.stops.length;if(p===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[p-1][0])return d.stops[p-1][1];const x=Da(d.stops.map(C=>C[0]),h);return d.stops[x][1]}function zu(d,a,h){const p=d.base!==void 0?d.base:1;if(Sr(h)!=="number")return oi(d.default,a.default);const x=d.stops.length;if(x===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[x-1][0])return d.stops[x-1][1];const C=Da(d.stops.map(Y=>Y[0]),h),A=function(Y,Q,he,pe){const me=pe-he,_e=Y-he;return me===0?0:Q===1?_e/me:(Math.pow(Q,_e)-1)/(Math.pow(Q,me)-1)}(h,p,d.stops[C][0],d.stops[C+1][0]),k=d.stops[C][1],N=d.stops[C+1][1],j=Ls[a.type]||Vp;return typeof k.evaluate=="function"?{evaluate(...Y){const Q=k.evaluate.apply(void 0,Y),he=N.evaluate.apply(void 0,Y);if(Q!==void 0&&he!==void 0)return j(Q,he,A,d.colorSpace)}}:j(k,N,A,d.colorSpace)}function Gp(d,a,h){switch(a.type){case"color":h=vr.parse(h);break;case"formatted":h=Di.fromString(h.toString());break;case"resolvedImage":h=es.fromString(h.toString());break;case"padding":h=Zi.parse(h);break;case"colorArray":h=Ni.parse(h);break;case"numberArray":h=To.parse(h);break;default:Sr(h)===a.type||a.type==="enum"&&a.values[h]||(h=void 0)}return oi(h,d.default,a.default)}vs.register(fa,{error:[{kind:"error"},[qt],(d,[a])=>{throw new Pi(a.evaluate(d))}],typeof:[qt,[xe],(d,[a])=>Qt(sr(a.evaluate(d)))],"to-rgba":[Tn(nt,4),[Rn],(d,[a])=>{const[h,p,x,C]=a.evaluate(d).rgb;return[255*h,255*p,255*x,C]}],rgb:[Rn,[nt,nt,nt],Bp],rgba:[Rn,[nt,nt,nt,nt],Bp],has:{type:cn,overloads:[[[qt],(d,[a])=>Zh(a.evaluate(d),d.properties())],[[qt,_r],(d,[a,h])=>Zh(a.evaluate(d),h.evaluate(d))]]},get:{type:xe,overloads:[[[qt],(d,[a])=>uf(a.evaluate(d),d.properties())],[[qt,_r],(d,[a,h])=>uf(a.evaluate(d),h.evaluate(d))]]},"feature-state":[xe,[qt],(d,[a])=>uf(a.evaluate(d),d.featureState||{})],properties:[_r,[],d=>d.properties()],"geometry-type":[qt,[],d=>d.geometryType()],id:[xe,[],d=>d.id()],zoom:[nt,[],d=>d.globals.zoom],"heatmap-density":[nt,[],d=>d.globals.heatmapDensity||0],elevation:[nt,[],d=>d.globals.elevation||0],"line-progress":[nt,[],d=>d.globals.lineProgress||0],accumulated:[xe,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[nt,rc(nt),(d,a)=>{let h=0;for(const p of a)h+=p.evaluate(d);return h}],"*":[nt,rc(nt),(d,a)=>{let h=1;for(const p of a)h*=p.evaluate(d);return h}],"-":{type:nt,overloads:[[[nt,nt],(d,[a,h])=>a.evaluate(d)-h.evaluate(d)],[[nt],(d,[a])=>-a.evaluate(d)]]},"/":[nt,[nt,nt],(d,[a,h])=>a.evaluate(d)/h.evaluate(d)],"%":[nt,[nt,nt],(d,[a,h])=>a.evaluate(d)%h.evaluate(d)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(d,[a,h])=>Math.pow(a.evaluate(d),h.evaluate(d))],sqrt:[nt,[nt],(d,[a])=>Math.sqrt(a.evaluate(d))],log10:[nt,[nt],(d,[a])=>Math.log(a.evaluate(d))/Math.LN10],ln:[nt,[nt],(d,[a])=>Math.log(a.evaluate(d))],log2:[nt,[nt],(d,[a])=>Math.log(a.evaluate(d))/Math.LN2],sin:[nt,[nt],(d,[a])=>Math.sin(a.evaluate(d))],cos:[nt,[nt],(d,[a])=>Math.cos(a.evaluate(d))],tan:[nt,[nt],(d,[a])=>Math.tan(a.evaluate(d))],asin:[nt,[nt],(d,[a])=>Math.asin(a.evaluate(d))],acos:[nt,[nt],(d,[a])=>Math.acos(a.evaluate(d))],atan:[nt,[nt],(d,[a])=>Math.atan(a.evaluate(d))],min:[nt,rc(nt),(d,a)=>Math.min(...a.map(h=>h.evaluate(d)))],max:[nt,rc(nt),(d,a)=>Math.max(...a.map(h=>h.evaluate(d)))],abs:[nt,[nt],(d,[a])=>Math.abs(a.evaluate(d))],round:[nt,[nt],(d,[a])=>{const h=a.evaluate(d);return h<0?-Math.round(-h):Math.round(h)}],floor:[nt,[nt],(d,[a])=>Math.floor(a.evaluate(d))],ceil:[nt,[nt],(d,[a])=>Math.ceil(a.evaluate(d))],"filter-==":[cn,[qt,xe],(d,[a,h])=>d.properties()[a.value]===h.value],"filter-id-==":[cn,[xe],(d,[a])=>d.id()===a.value],"filter-type-==":[cn,[qt],(d,[a])=>d.geometryType()===a.value],"filter-<":[cn,[qt,xe],(d,[a,h])=>{const p=d.properties()[a.value],x=h.value;return typeof p==typeof x&&p<x}],"filter-id-<":[cn,[xe],(d,[a])=>{const h=d.id(),p=a.value;return typeof h==typeof p&&h<p}],"filter->":[cn,[qt,xe],(d,[a,h])=>{const p=d.properties()[a.value],x=h.value;return typeof p==typeof x&&p>x}],"filter-id->":[cn,[xe],(d,[a])=>{const h=d.id(),p=a.value;return typeof h==typeof p&&h>p}],"filter-<=":[cn,[qt,xe],(d,[a,h])=>{const p=d.properties()[a.value],x=h.value;return typeof p==typeof x&&p<=x}],"filter-id-<=":[cn,[xe],(d,[a])=>{const h=d.id(),p=a.value;return typeof h==typeof p&&h<=p}],"filter->=":[cn,[qt,xe],(d,[a,h])=>{const p=d.properties()[a.value],x=h.value;return typeof p==typeof x&&p>=x}],"filter-id->=":[cn,[xe],(d,[a])=>{const h=d.id(),p=a.value;return typeof h==typeof p&&h>=p}],"filter-has":[cn,[xe],(d,[a])=>a.value in d.properties()],"filter-has-id":[cn,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[cn,[Tn(qt)],(d,[a])=>a.value.indexOf(d.geometryType())>=0],"filter-id-in":[cn,[Tn(xe)],(d,[a])=>a.value.indexOf(d.id())>=0],"filter-in-small":[cn,[qt,Tn(xe)],(d,[a,h])=>h.value.indexOf(d.properties()[a.value])>=0],"filter-in-large":[cn,[qt,Tn(xe)],(d,[a,h])=>function(p,x,C,A){for(;C<=A;){const k=C+A>>1;if(x[k]===p)return!0;x[k]>p?A=k-1:C=k+1}return!1}(d.properties()[a.value],h.value,0,h.value.length-1)],all:{type:cn,overloads:[[[cn,cn],(d,[a,h])=>a.evaluate(d)&&h.evaluate(d)],[rc(cn),(d,a)=>{for(const h of a)if(!h.evaluate(d))return!1;return!0}]]},any:{type:cn,overloads:[[[cn,cn],(d,[a,h])=>a.evaluate(d)||h.evaluate(d)],[rc(cn),(d,a)=>{for(const h of a)if(h.evaluate(d))return!0;return!1}]]},"!":[cn,[cn],(d,[a])=>!a.evaluate(d)],"is-supported-script":[cn,[qt],(d,[a])=>{const h=d.globals&&d.globals.isSupportedScript;return!h||h(a.evaluate(d))}],upcase:[qt,[qt],(d,[a])=>a.evaluate(d).toUpperCase()],downcase:[qt,[qt],(d,[a])=>a.evaluate(d).toLowerCase()],concat:[qt,rc(xe),(d,a)=>a.map(h=>La(h.evaluate(d))).join("")],"resolved-locale":[qt,[vt],(d,[a])=>a.evaluate(d).resolvedLocale()]});class Ou{constructor(a,h){this.expression=a,this._warningHistory={},this._evaluator=new ll,this._defaultValue=h?function(p){if(p.type==="color"&&jc(p.default))return new vr(0,0,0,0);switch(p.type){case"color":return vr.parse(p.default)||null;case"padding":return Zi.parse(p.default)||null;case"numberArray":return To.parse(p.default)||null;case"colorArray":return Ni.parse(p.default)||null;case"variableAnchorOffsetCollection":return Tr.parse(p.default)||null;case"projectionDefinition":return yr.parse(p.default)||null;default:return p.default===void 0?null:p.default}}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(a,h,p,x,C,A){return this._evaluator.globals=a,this._evaluator.feature=h,this._evaluator.featureState=p,this._evaluator.canonical=x,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=A,this.expression.evaluate(this._evaluator)}evaluate(a,h,p,x,C,A){this._evaluator.globals=a,this._evaluator.feature=h||null,this._evaluator.featureState=p||null,this._evaluator.canonical=x,this._evaluator.availableImages=C||null,this._evaluator.formattedSection=A||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new Pi(`Expected value to be one of ${Object.keys(this._enumValues).map(N=>JSON.stringify(N)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function sc(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in fa}function Hc(d,a){const h=new Fc(fa,Yh,[],a?function(x){const C={color:Rn,string:qt,number:nt,enum:qt,boolean:cn,formatted:kt,padding:xt,numberArray:hn,colorArray:wt,projectionDefinition:Ir,resolvedImage:Pn,variableAnchorOffsetCollection:mn};return x.type==="array"?Tn(C[x.value]||xe,x.length):C[x.type]}(a):void 0),p=h.parse(d,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?dl(new Ou(p,a)):ic(h.errors)}class Oa{constructor(a,h){this.kind=a,this._styleExpression=h,this.isStateDependent=a!=="constant"&&!ku(h.expression),this.globalStateRefs=fl(h.expression)}evaluateWithoutErrorHandling(a,h,p,x,C,A){return this._styleExpression.evaluateWithoutErrorHandling(a,h,p,x,C,A)}evaluate(a,h,p,x,C,A){return this._styleExpression.evaluate(a,h,p,x,C,A)}}class Jh{constructor(a,h,p,x){this.kind=a,this.zoomStops=p,this._styleExpression=h,this.isStateDependent=a!=="camera"&&!ku(h.expression),this.globalStateRefs=fl(h.expression),this.interpolationType=x}evaluateWithoutErrorHandling(a,h,p,x,C,A){return this._styleExpression.evaluateWithoutErrorHandling(a,h,p,x,C,A)}evaluate(a,h,p,x,C,A){return this._styleExpression.evaluate(a,h,p,x,C,A)}interpolationFactor(a,h,p){return this.interpolationType?ns.interpolationFactor(this.interpolationType,a,h,p):0}}function Wp(d,a){const h=Hc(d,a);if(h.result==="error")return h;const p=h.value.expression,x=Kh(p);if(!x&&!oc(a))return ic([new On("","data expressions not supported")]);const C=Vc(p,["zoom"]);if(!C&&!Up(a))return ic([new On("","zoom expressions not supported")]);const A=Gc(p);return A||C?A instanceof On?ic([A]):A instanceof ns&&!$p(a)?ic([new On("",'"interpolate" expressions cannot be used with this property')]):dl(A?new Jh(x?"camera":"composite",h.value,A.labels,A instanceof ns?A.interpolation:void 0):new Oa(x?"constant":"source",h.value)):ic([new On("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Qh{constructor(a,h){this._parameters=a,this._specification=h,Gn(this,jp(this._parameters,this._specification))}static deserialize(a){return new Qh(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Gc(d){let a=null;if(d instanceof Yl)a=Gc(d.result);else if(d instanceof Uo){for(const h of d.args)if(a=Gc(h),a)break}else(d instanceof Pu||d instanceof ns)&&d.input instanceof vs&&d.input.name==="zoom"&&(a=d);return a instanceof On||d.eachChild(h=>{const p=Gc(h);p instanceof On?a=p:!a&&p?a=new On("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&p&&a!==p&&(a=new On("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function fl(d,a=new Set){return d instanceof nc&&a.add(d.key),d.eachChild(h=>{fl(h,a)}),a}function ac(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const a of d.slice(1))if(!ac(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}const ed={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fa(d){if(d==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};ac(d)||(d=ff(d));const a=Hc(d,ed);if(a.result==="error")throw new Error(a.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,p,x)=>a.value.evaluate(h,p,{},x),needGeometry:df(d),getGlobalStateRefs:()=>fl(a.value.expression)}}function qp(d,a){return d<a?-1:d>a?1:0}function df(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let a=1;a<d.length;a++)if(df(d[a]))return!0;return!1}function ff(d){if(!d)return!0;const a=d[0];return d.length<=1?a!=="any":a==="=="?pf(d[1],d[2],"=="):a==="!="?Wc(pf(d[1],d[2],"==")):a==="<"||a===">"||a==="<="||a===">="?pf(d[1],d[2],a):a==="any"?(h=d.slice(1),["any"].concat(h.map(ff))):a==="all"?["all"].concat(d.slice(1).map(ff)):a==="none"?["all"].concat(d.slice(1).map(ff).map(Wc)):a==="in"?fg(d[1],d.slice(2)):a==="!in"?Wc(fg(d[1],d.slice(2))):a==="has"?pg(d[1]):a!=="!has"||Wc(pg(d[1]));var h}function pf(d,a,h){switch(d){case"$type":return[`filter-type-${h}`,a];case"$id":return[`filter-id-${h}`,a];default:return[`filter-${h}`,d,a]}}function fg(d,a){if(a.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(h=>typeof h!=typeof a[0])?["filter-in-large",d,["literal",a.sort(qp)]]:["filter-in-small",d,["literal",a]]}}function pg(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function Wc(d){return["!",d]}function pa(d){const a=typeof d;if(a==="number"||a==="boolean"||a==="string"||d==null)return JSON.stringify(d);if(Array.isArray(d)){let x="[";for(const C of d)x+=`${pa(C)},`;return`${x}]`}const h=Object.keys(d).sort();let p="{";for(let x=0;x<h.length;x++)p+=`${JSON.stringify(h[x])}:${pa(d[h[x]])},`;return`${p}}`}function td(d){let a="";for(const h of Ut)a+=`/${pa(d[h])}`;return a}function qc(d){const a=d.value;return a?[new Ct(d.key,a,"constants have been deprecated as of v8")]:[]}function Yr(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function ea(d){if(Array.isArray(d))return d.map(ea);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const a={};for(const h in d)a[h]=ea(d[h]);return a}return Yr(d)}function Yi(d){const a=d.key,h=d.value,p=d.valueSpec||{},x=d.objectElementValidators||{},C=d.style,A=d.styleSpec,k=d.validateSpec;let N=[];const j=Sr(h);if(j!=="object")return[new Ct(a,h,`object expected, ${j} found`)];for(const Y in h){const Q=Y.split(".")[0],he=Er(p,Q)||p["*"];let pe;if(Er(x,Q))pe=x[Q];else if(Er(p,Q))pe=k;else if(x["*"])pe=x["*"];else{if(!p["*"]){N.push(new Ct(a,h[Y],`unknown property "${Y}"`));continue}pe=k}N=N.concat(pe({key:(a&&`${a}.`)+Y,value:h[Y],valueSpec:he,style:C,styleSpec:A,object:h,objectKey:Y,validateSpec:k},h))}for(const Y in p)x[Y]||p[Y].required&&p[Y].default===void 0&&h[Y]===void 0&&N.push(new Ct(a,h,`missing required property "${Y}"`));return N}function Fu(d){const a=d.value,h=d.valueSpec,p=d.style,x=d.styleSpec,C=d.key,A=d.arrayElementValidator||d.validateSpec;if(Sr(a)!=="array")return[new Ct(C,a,`array expected, ${Sr(a)} found`)];if(h.length&&a.length!==h.length)return[new Ct(C,a,`array length ${h.length} expected, length ${a.length} found`)];if(h["min-length"]&&a.length<h["min-length"])return[new Ct(C,a,`array length at least ${h["min-length"]} expected, length ${a.length} found`)];let k={type:h.value,values:h.values};x.$version<7&&(k.function=h.function),Sr(h.value)==="object"&&(k=h.value);let N=[];for(let j=0;j<a.length;j++)N=N.concat(A({array:a,arrayIndex:j,value:a[j],valueSpec:k,validateSpec:d.validateSpec,style:p,styleSpec:x,key:`${C}[${j}]`}));return N}function nd(d){const a=d.key,h=d.value,p=d.valueSpec;let x=Sr(h);return x==="number"&&h!=h&&(x="NaN"),x!=="number"?[new Ct(a,h,`number expected, ${x} found`)]:"minimum"in p&&h<p.minimum?[new Ct(a,h,`${h} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&h>p.maximum?[new Ct(a,h,`${h} is greater than the maximum value ${p.maximum}`)]:[]}function Nu(d){const a=d.valueSpec,h=Yr(d.value.type);let p,x,C,A={};const k=h!=="categorical"&&d.value.property===void 0,N=!k,j=Sr(d.value.stops)==="array"&&Sr(d.value.stops[0])==="array"&&Sr(d.value.stops[0][0])==="object",Y=Yi({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(pe){if(h==="identity")return[new Ct(pe.key,pe.value,'identity function may not have a "stops" property')];let me=[];const _e=pe.value;return me=me.concat(Fu({key:pe.key,value:_e,valueSpec:pe.valueSpec,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec,arrayElementValidator:Q})),Sr(_e)==="array"&&_e.length===0&&me.push(new Ct(pe.key,_e,"array must have at least one stop")),me},default:function(pe){return pe.validateSpec({key:pe.key,value:pe.value,valueSpec:a,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec})}}});return h==="identity"&&k&&Y.push(new Ct(d.key,d.value,'missing required property "property"')),h==="identity"||d.value.stops||Y.push(new Ct(d.key,d.value,'missing required property "stops"')),h==="exponential"&&d.valueSpec.expression&&!$p(d.valueSpec)&&Y.push(new Ct(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(N&&!oc(d.valueSpec)?Y.push(new Ct(d.key,d.value,"property functions not supported")):k&&!Up(d.valueSpec)&&Y.push(new Ct(d.key,d.value,"zoom functions not supported"))),h!=="categorical"&&!j||d.value.property!==void 0||Y.push(new Ct(d.key,d.value,'"property" property is required')),Y;function Q(pe){let me=[];const _e=pe.value,ke=pe.key;if(Sr(_e)!=="array")return[new Ct(ke,_e,`array expected, ${Sr(_e)} found`)];if(_e.length!==2)return[new Ct(ke,_e,`array length 2 expected, length ${_e.length} found`)];if(j){if(Sr(_e[0])!=="object")return[new Ct(ke,_e,`object expected, ${Sr(_e[0])} found`)];if(_e[0].zoom===void 0)return[new Ct(ke,_e,"object stop key must have zoom")];if(_e[0].value===void 0)return[new Ct(ke,_e,"object stop key must have value")];if(C&&C>Yr(_e[0].zoom))return[new Ct(ke,_e[0].zoom,"stop zoom values must appear in ascending order")];Yr(_e[0].zoom)!==C&&(C=Yr(_e[0].zoom),x=void 0,A={}),me=me.concat(Yi({key:`${ke}[0]`,value:_e[0],valueSpec:{zoom:{}},validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec,objectElementValidators:{zoom:nd,value:he}}))}else me=me.concat(he({key:`${ke}[0]`,value:_e[0],validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec},_e));return sc(ea(_e[1]))?me.concat([new Ct(`${ke}[1]`,_e[1],"expressions are not allowed in function stops.")]):me.concat(pe.validateSpec({key:`${ke}[1]`,value:_e[1],valueSpec:a,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec}))}function he(pe,me){const _e=Sr(pe.value),ke=Yr(pe.value),Ve=pe.value!==null?pe.value:me;if(p){if(_e!==p)return[new Ct(pe.key,Ve,`${_e} stop domain type must match previous stop domain type ${p}`)]}else p=_e;if(_e!=="number"&&_e!=="string"&&_e!=="boolean")return[new Ct(pe.key,Ve,"stop domain value must be a number, string, or boolean")];if(_e!=="number"&&h!=="categorical"){let dt=`number expected, ${_e} found`;return oc(a)&&h===void 0&&(dt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ct(pe.key,Ve,dt)]}return h!=="categorical"||_e!=="number"||isFinite(ke)&&Math.floor(ke)===ke?h!=="categorical"&&_e==="number"&&x!==void 0&&ke<x?[new Ct(pe.key,Ve,"stop domain values must appear in ascending order")]:(x=ke,h==="categorical"&&ke in A?[new Ct(pe.key,Ve,"stop domain values must be unique")]:(A[ke]=!0,[])):[new Ct(pe.key,Ve,`integer expected, found ${ke}`)]}}function ta(d){const a=(d.expressionContext==="property"?Wp:Hc)(ea(d.value),d.valueSpec);if(a.result==="error")return a.value.map(p=>new Ct(`${d.key}${p.key}`,d.value,p.message));const h=a.value.expression||a.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!h.outputDefined())return[new Ct(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!ku(h))return[new Ct(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!ku(h))return[new Ct(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!Vc(h,["zoom","feature-state"]))return[new Ct(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!Kh(h))return[new Ct(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xc(d){const a=d.key,h=d.value,p=Sr(h);return p!=="string"?[new Ct(a,h,`color expected, ${p} found`)]:vr.parse(String(h))?[]:[new Ct(a,h,`color expected, "${h}" found`)]}function Na(d){const a=d.key,h=d.value,p=d.valueSpec,x=[];return Array.isArray(p.values)?p.values.indexOf(Yr(h))===-1&&x.push(new Ct(a,h,`expected one of [${p.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(p.values).indexOf(Yr(h))===-1&&x.push(new Ct(a,h,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(h)} found`)),x}function Bu(d){return ac(ea(d.value))?ta(Gn({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):mf(d)}function mf(d){const a=d.value,h=d.key;if(Sr(a)!=="array")return[new Ct(h,a,`array expected, ${Sr(a)} found`)];const p=d.styleSpec;let x,C=[];if(a.length<1)return[new Ct(h,a,"filter array must have at least 1 element")];switch(C=C.concat(Na({key:`${h}[0]`,value:a[0],valueSpec:p.filter_operator,style:d.style,styleSpec:d.styleSpec})),Yr(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&Yr(a[1])==="$type"&&C.push(new Ct(h,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&C.push(new Ct(h,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(x=Sr(a[1]),x!=="string"&&C.push(new Ct(`${h}[1]`,a[1],`string expected, ${x} found`)));for(let A=2;A<a.length;A++)x=Sr(a[A]),Yr(a[1])==="$type"?C=C.concat(Na({key:`${h}[${A}]`,value:a[A],valueSpec:p.geometry_type,style:d.style,styleSpec:d.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&C.push(new Ct(`${h}[${A}]`,a[A],`string, number, or boolean expected, ${x} found`));break;case"any":case"all":case"none":for(let A=1;A<a.length;A++)C=C.concat(mf({key:`${h}[${A}]`,value:a[A],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":x=Sr(a[1]),a.length!==2?C.push(new Ct(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):x!=="string"&&C.push(new Ct(`${h}[1]`,a[1],`string expected, ${x} found`))}return C}function Zc(d,a){const h=d.key,p=d.validateSpec,x=d.style,C=d.styleSpec,A=d.value,k=d.objectKey,N=C[`${a}_${d.layerType}`];if(!N)return[];const j=k.match(/^(.*)-transition$/);if(a==="paint"&&j&&N[j[1]]&&N[j[1]].transition)return p({key:h,value:A,valueSpec:C.transition,style:x,styleSpec:C});const Y=d.valueSpec||N[k];if(!Y)return[new Ct(h,A,`unknown property "${k}"`)];let Q;if(Sr(A)==="string"&&oc(Y)&&!Y.tokens&&(Q=/^{([^}]+)}$/.exec(A)))return[new Ct(h,A,`"${k}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Q[1])} }\`.`)];const he=[];return d.layerType==="symbol"&&(k==="text-field"&&x&&!x.glyphs&&he.push(new Ct(h,A,'use of "text-field" requires a style "glyphs" property')),k==="text-font"&&jc(ea(A))&&Yr(A.type)==="identity"&&he.push(new Ct(h,A,'"text-font" does not support identity functions'))),he.concat(p({key:d.key,value:A,valueSpec:Y,style:x,styleSpec:C,expressionContext:"property",propertyType:a,propertyKey:k}))}function Ds(d){return Zc(d,"paint")}function ri(d){return Zc(d,"layout")}function Pr(d){let a=[];const h=d.value,p=d.key,x=d.style,C=d.styleSpec;if(Sr(h)!=="object")return[new Ct(p,h,`object expected, ${Sr(h)} found`)];h.type||h.ref||a.push(new Ct(p,h,'either "type" or "ref" is required'));let A=Yr(h.type);const k=Yr(h.ref);if(h.id){const N=Yr(h.id);for(let j=0;j<d.arrayIndex;j++){const Y=x.layers[j];Yr(Y.id)===N&&a.push(new Ct(p,h.id,`duplicate layer id "${h.id}", previously used at line ${Y.id.__line__}`))}}if("ref"in h){let N;["type","source","source-layer","filter","layout"].forEach(j=>{j in h&&a.push(new Ct(p,h[j],`"${j}" is prohibited for ref layers`))}),x.layers.forEach(j=>{Yr(j.id)===k&&(N=j)}),N?N.ref?a.push(new Ct(p,h.ref,"ref cannot reference another ref layer")):A=Yr(N.type):a.push(new Ct(p,h.ref,`ref layer "${k}" not found`))}else if(A!=="background")if(h.source){const N=x.sources&&x.sources[h.source],j=N&&Yr(N.type);N?j==="vector"&&A==="raster"?a.push(new Ct(p,h.source,`layer "${h.id}" requires a raster source`)):j!=="raster-dem"&&A==="hillshade"||j!=="raster-dem"&&A==="color-relief"?a.push(new Ct(p,h.source,`layer "${h.id}" requires a raster-dem source`)):j==="raster"&&A!=="raster"?a.push(new Ct(p,h.source,`layer "${h.id}" requires a vector source`)):j!=="vector"||h["source-layer"]?j==="raster-dem"&&A!=="hillshade"&&A!=="color-relief"?a.push(new Ct(p,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):A!=="line"||!h.paint||!h.paint["line-gradient"]||j==="geojson"&&N.lineMetrics||a.push(new Ct(p,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Ct(p,h,`layer "${h.id}" must specify a "source-layer"`)):a.push(new Ct(p,h.source,`source "${h.source}" not found`))}else a.push(new Ct(p,h,'missing required property "source"'));return a=a.concat(Yi({key:p,value:h,valueSpec:C.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*":()=>[],type:()=>d.validateSpec({key:`${p}.type`,value:h.type,valueSpec:C.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:h,objectKey:"type"}),filter:Bu,layout:N=>Yi({layer:h,key:N.key,value:N.value,style:N.style,styleSpec:N.styleSpec,validateSpec:N.validateSpec,objectElementValidators:{"*":j=>ri(Gn({layerType:A},j))}}),paint:N=>Yi({layer:h,key:N.key,value:N.value,style:N.style,styleSpec:N.styleSpec,validateSpec:N.validateSpec,objectElementValidators:{"*":j=>Ds(Gn({layerType:A},j))}})}})),a}function po(d){const a=d.value,h=d.key,p=Sr(a);return p!=="string"?[new Ct(h,a,`string expected, ${p} found`)]:[]}const mo={promoteId:function({key:d,value:a}){if(Sr(a)==="string")return po({key:d,value:a});{const h=[];for(const p in a)h.push(...po({key:`${d}.${p}`,value:a[p]}));return h}}};function rs(d){const a=d.value,h=d.key,p=d.styleSpec,x=d.style,C=d.validateSpec;if(!a.type)return[new Ct(h,a,'"type" is required')];const A=Yr(a.type);let k;switch(A){case"vector":case"raster":return k=Yi({key:h,value:a,valueSpec:p[`source_${A.replace("-","_")}`],style:d.style,styleSpec:p,objectElementValidators:mo,validateSpec:C}),k;case"raster-dem":return k=function(N){var j;const Y=(j=N.sourceName)!==null&&j!==void 0?j:"",Q=N.value,he=N.styleSpec,pe=he.source_raster_dem,me=N.style;let _e=[];const ke=Sr(Q);if(Q===void 0)return _e;if(ke!=="object")return _e.push(new Ct("source_raster_dem",Q,`object expected, ${ke} found`)),_e;const Ve=Yr(Q.encoding)==="custom",dt=["redFactor","greenFactor","blueFactor","baseShift"],tt=N.value.encoding?`"${N.value.encoding}"`:"Default";for(const de in Q)!Ve&&dt.includes(de)?_e.push(new Ct(de,Q[de],`In "${Y}": "${de}" is only valid when "encoding" is set to "custom". ${tt} encoding found`)):pe[de]?_e=_e.concat(N.validateSpec({key:de,value:Q[de],valueSpec:pe[de],validateSpec:N.validateSpec,style:me,styleSpec:he})):_e.push(new Ct(de,Q[de],`unknown property "${de}"`));return _e}({sourceName:h,value:a,style:d.style,styleSpec:p,validateSpec:C}),k;case"geojson":if(k=Yi({key:h,value:a,valueSpec:p.source_geojson,style:x,styleSpec:p,validateSpec:C,objectElementValidators:mo}),a.cluster)for(const N in a.clusterProperties){const[j,Y]=a.clusterProperties[N],Q=typeof j=="string"?[j,["accumulated"],["get",N]]:j;k.push(...ta({key:`${h}.${N}.map`,value:Y,expressionContext:"cluster-map"})),k.push(...ta({key:`${h}.${N}.reduce`,value:Q,expressionContext:"cluster-reduce"}))}return k;case"video":return Yi({key:h,value:a,valueSpec:p.source_video,style:x,validateSpec:C,styleSpec:p});case"image":return Yi({key:h,value:a,valueSpec:p.source_image,style:x,validateSpec:C,styleSpec:p});case"canvas":return[new Ct(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Na({key:`${h}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function lc(d){const a=d.value,h=d.styleSpec,p=h.light,x=d.style;let C=[];const A=Sr(a);if(a===void 0)return C;if(A!=="object")return C=C.concat([new Ct("light",a,`object expected, ${A} found`)]),C;for(const k in a){const N=k.match(/^(.*)-transition$/);C=C.concat(N&&p[N[1]]&&p[N[1]].transition?d.validateSpec({key:k,value:a[k],valueSpec:h.transition,validateSpec:d.validateSpec,style:x,styleSpec:h}):p[k]?d.validateSpec({key:k,value:a[k],valueSpec:p[k],validateSpec:d.validateSpec,style:x,styleSpec:h}):[new Ct(k,a[k],`unknown property "${k}"`)])}return C}function ma(d){const a=d.value,h=d.styleSpec,p=h.sky,x=d.style,C=Sr(a);if(a===void 0)return[];if(C!=="object")return[new Ct("sky",a,`object expected, ${C} found`)];let A=[];for(const k in a)A=A.concat(p[k]?d.validateSpec({key:k,value:a[k],valueSpec:p[k],style:x,styleSpec:h}):[new Ct(k,a[k],`unknown property "${k}"`)]);return A}function $o(d){const a=d.value,h=d.styleSpec,p=h.terrain,x=d.style;let C=[];const A=Sr(a);if(a===void 0)return C;if(A!=="object")return C=C.concat([new Ct("terrain",a,`object expected, ${A} found`)]),C;for(const k in a)C=C.concat(p[k]?d.validateSpec({key:k,value:a[k],valueSpec:p[k],validateSpec:d.validateSpec,style:x,styleSpec:h}):[new Ct(k,a[k],`unknown property "${k}"`)]);return C}function Yc(d){let a=[];const h=d.value,p=d.key;if(Array.isArray(h)){const x=[],C=[];for(const A in h)h[A].id&&x.includes(h[A].id)&&a.push(new Ct(p,h,`all the sprites' ids must be unique, but ${h[A].id} is duplicated`)),x.push(h[A].id),h[A].url&&C.includes(h[A].url)&&a.push(new Ct(p,h,`all the sprites' URLs must be unique, but ${h[A].url} is duplicated`)),C.push(h[A].url),a=a.concat(Yi({key:`${p}[${A}]`,value:h[A],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:d.validateSpec}));return a}return po({key:p,value:h})}function Xp(d){return a=d.value,a&&a.constructor===Object?[]:[new Ct(d.key,d.value,`object expected, ${Sr(d.value)} found`)];var a}const rd={"*":()=>[],array:Fu,boolean:function(d){const a=d.value,h=d.key,p=Sr(a);return p!=="boolean"?[new Ct(h,a,`boolean expected, ${p} found`)]:[]},number:nd,color:Xc,constants:qc,enum:Na,filter:Bu,function:Nu,layer:Pr,object:Yi,source:rs,light:lc,sky:ma,terrain:$o,projection:function(d){const a=d.value,h=d.styleSpec,p=h.projection,x=d.style,C=Sr(a);if(a===void 0)return[];if(C!=="object")return[new Ct("projection",a,`object expected, ${C} found`)];let A=[];for(const k in a)A=A.concat(p[k]?d.validateSpec({key:k,value:a[k],valueSpec:p[k],style:x,styleSpec:h}):[new Ct(k,a[k],`unknown property "${k}"`)]);return A},projectionDefinition:function(d){const a=d.key;let h=d.value;h=h instanceof String?h.valueOf():h;const p=Sr(h);return p!=="array"||function(x){return Array.isArray(x)&&x.length===3&&typeof x[0]=="string"&&typeof x[1]=="string"&&typeof x[2]=="number"}(h)||function(x){return!!["interpolate","step","literal"].includes(x[0])}(h)?["array","string"].includes(p)?[]:[new Ct(a,h,`projection expected, invalid type "${p}" found`)]:[new Ct(a,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:po,formatted:function(d){return po(d).length===0?[]:ta(d)},resolvedImage:function(d){return po(d).length===0?[]:ta(d)},padding:function(d){const a=d.key,h=d.value;if(Sr(h)==="array"){if(h.length<1||h.length>4)return[new Ct(a,h,`padding requires 1 to 4 values; ${h.length} values found`)];const p={type:"number"};let x=[];for(let C=0;C<h.length;C++)x=x.concat(d.validateSpec({key:`${a}[${C}]`,value:h[C],validateSpec:d.validateSpec,valueSpec:p}));return x}return nd({key:a,value:h,valueSpec:{}})},numberArray:function(d){const a=d.key,h=d.value;if(Sr(h)==="array"){const p={type:"number"};if(h.length<1)return[new Ct(a,h,"array length at least 1 expected, length 0 found")];let x=[];for(let C=0;C<h.length;C++)x=x.concat(d.validateSpec({key:`${a}[${C}]`,value:h[C],validateSpec:d.validateSpec,valueSpec:p}));return x}return nd({key:a,value:h,valueSpec:{}})},colorArray:function(d){const a=d.key,h=d.value;if(Sr(h)==="array"){if(h.length<1)return[new Ct(a,h,"array length at least 1 expected, length 0 found")];let p=[];for(let x=0;x<h.length;x++)p=p.concat(Xc({key:`${a}[${x}]`,value:h[x]}));return p}return Xc({key:a,value:h})},variableAnchorOffsetCollection:function(d){const a=d.key,h=d.value,p=Sr(h),x=d.styleSpec;if(p!=="array"||h.length<1||h.length%2!=0)return[new Ct(a,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let C=[];for(let A=0;A<h.length;A+=2)C=C.concat(Na({key:`${a}[${A}]`,value:h[A],valueSpec:x.layout_symbol["text-anchor"]})),C=C.concat(Fu({key:`${a}[${A+1}]`,value:h[A+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:x}));return C},sprite:Yc,state:Xp};function Kc(d){const a=d.value,h=d.valueSpec,p=d.styleSpec;return d.validateSpec=Kc,h.expression&&jc(Yr(a))?Nu(d):h.expression&&sc(ea(a))?ta(d):h.type&&rd[h.type]?rd[h.type](d):Yi(Gn({},d,{valueSpec:h.type?p[h.type]:h}))}function Jc(d){const a=d.value,h=d.key,p=po(d);return p.length||(a.indexOf("{fontstack}")===-1&&p.push(new Ct(h,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&p.push(new Ct(h,a,'"glyphs" url must include a "{range}" token'))),p}function Ki(d,a=We){let h=[];return h=h.concat(Kc({key:"",value:d,valueSpec:a.$root,styleSpec:a,style:d,validateSpec:Kc,objectElementValidators:{glyphs:Jc,"*":()=>[]}})),d.constants&&(h=h.concat(qc({key:"constants",value:d.constants}))),gf(h)}function ys(d){return function(a){return d({...a,validateSpec:Kc})}}function gf(d){return[].concat(d).sort((a,h)=>a.line-h.line)}function Vo(d){return function(...a){return gf(d.apply(this,a))}}Ki.source=Vo(ys(rs)),Ki.sprite=Vo(ys(Yc)),Ki.glyphs=Vo(ys(Jc)),Ki.light=Vo(ys(lc)),Ki.sky=Vo(ys(ma)),Ki.terrain=Vo(ys($o)),Ki.state=Vo(ys(Xp)),Ki.layer=Vo(ys(Pr)),Ki.filter=Vo(ys(Bu)),Ki.paintProperty=Vo(ys(Ds)),Ki.layoutProperty=Vo(ys(ri));const Uu=Ki,cc=Uu.light,pl=Uu.sky,$u=Uu.paintProperty,Vu=Uu.layoutProperty;function uc(d,a){let h=!1;if(a&&a.length)for(const p of a)d.fire(new He(new Error(p.message))),h=!0;return h}class Ao{constructor(a,h,p){const x=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;const A=new Int32Array(this.arrayBuffer);a=A[0],this.d=(h=A[1])+2*(p=A[2]);for(let N=0;N<this.d*this.d;N++){const j=A[3+N],Y=A[3+N+1];x.push(j===Y?null:A.subarray(j,Y))}const k=A[3+x.length+1];this.keys=A.subarray(A[3+x.length],k),this.bboxes=A.subarray(k),this.insert=this._insertReadonly}else{this.d=h+2*p;for(let A=0;A<this.d*this.d;A++)x.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=a,this.padding=p,this.scale=h/a,this.uid=0;const C=p/h*a;this.min=-C,this.max=a+C}insert(a,h,p,x,C){this._forEachCell(h,p,x,C,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(x),this.bboxes.push(C)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,h,p,x,C,A){this.cells[C].push(A)}query(a,h,p,x,C){const A=this.min,k=this.max;if(a<=A&&h<=A&&k<=p&&k<=x&&!C)return Array.prototype.slice.call(this.keys);{const N=[];return this._forEachCell(a,h,p,x,this._queryCell,N,{},C),N}}_queryCell(a,h,p,x,C,A,k,N){const j=this.cells[C];if(j!==null){const Y=this.keys,Q=this.bboxes;for(let he=0;he<j.length;he++){const pe=j[he];if(k[pe]===void 0){const me=4*pe;(N?N(Q[me+0],Q[me+1],Q[me+2],Q[me+3]):a<=Q[me+2]&&h<=Q[me+3]&&p>=Q[me+0]&&x>=Q[me+1])?(k[pe]=!0,A.push(Y[pe])):k[pe]=!1}}}}_forEachCell(a,h,p,x,C,A,k,N){const j=this._convertToCellCoord(a),Y=this._convertToCellCoord(h),Q=this._convertToCellCoord(p),he=this._convertToCellCoord(x);for(let pe=j;pe<=Q;pe++)for(let me=Y;me<=he;me++){const _e=this.d*me+pe;if((!N||N(this._convertFromCellCoord(pe),this._convertFromCellCoord(me),this._convertFromCellCoord(pe+1),this._convertFromCellCoord(me+1)))&&C.call(this,a,h,p,x,_e,A,k,N))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const a=this.cells,h=3+this.cells.length+1+1;let p=0;for(let A=0;A<this.cells.length;A++)p+=this.cells[A].length;const x=new Int32Array(h+p+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;let C=h;for(let A=0;A<a.length;A++){const k=a[A];x[3+A]=C,x.set(k,C),C+=k.length}return x[3+a.length]=C,x.set(this.keys,C),C+=this.keys.length,x[3+a.length+1]=C,x.set(this.bboxes,C),C+=this.bboxes.length,x.buffer}static serialize(a,h){const p=a.toArrayBuffer();return h&&h.push(p),{buffer:p}}static deserialize(a){return new Ao(a.buffer)}}const Hi={};function zn(d,a,h={}){if(Hi[d])throw new Error(`${d} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:d,writeable:!1}),Hi[d]={klass:a,omit:h.omit||[],shallow:h.shallow||[]}}zn("Object",Object),zn("Set",Set),zn("TransferableGridIndex",Ao),zn("Color",vr),zn("Error",Error),zn("AJAXError",fe),zn("ResolvedImage",es),zn("StylePropertyFunction",Qh),zn("StyleExpression",Ou,{omit:["_evaluator"]}),zn("ZoomDependentExpression",Jh),zn("ZoomConstantExpression",Oa),zn("CompoundExpression",vs,{omit:["_evaluate"]});for(const d in fa)fa[d]._classRegistryKey||zn(`Expression_${d}`,fa[d]);function ga(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function ks(d){return d.$name||d.constructor._classRegistryKey}function ml(d){return!function(a){if(a===null||typeof a!="object")return!1;const h=ks(a);return!(!h||h==="Object")}(d)&&(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||d instanceof Blob||d instanceof Error||ga(d)||Ue(d)||ArrayBuffer.isView(d)||d instanceof ImageData)}function ju(d,a){if(ml(d))return(ga(d)||Ue(d))&&a&&a.push(d),ArrayBuffer.isView(d)&&a&&a.push(d.buffer),d instanceof ImageData&&a&&a.push(d.data.buffer),d;if(Array.isArray(d)){const C=[];for(const A of d)C.push(ju(A,a));return C}if(typeof d!="object")throw new Error("can't serialize object of type "+typeof d);const h=ks(d);if(!h)throw new Error(`can't serialize object of unregistered class ${d.constructor.name}`);if(!Hi[h])throw new Error(`${h} is not registered.`);const{klass:p}=Hi[h],x=p.serialize?p.serialize(d,a):{};if(p.serialize){if(a&&x===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const C in d){if(!d.hasOwnProperty(C)||Hi[h].omit.indexOf(C)>=0)continue;const A=d[C];x[C]=Hi[h].shallow.indexOf(C)>=0?A:ju(A,a)}d instanceof Error&&(x.message=d.message)}if(x.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(x.$name=h),x}function hc(d){if(ml(d))return d;if(Array.isArray(d))return d.map(hc);if(typeof d!="object")throw new Error("can't deserialize object of type "+typeof d);const a=ks(d)||"Object";if(!Hi[a])throw new Error(`can't deserialize unregistered class ${a}`);const{klass:h}=Hi[a];if(!h)throw new Error(`can't deserialize unregistered class ${a}`);if(h.deserialize)return h.deserialize(d);const p=Object.create(h.prototype);for(const x of Object.keys(d)){if(x==="$name")continue;const C=d[x];p[x]=Hi[a].shallow.indexOf(x)>=0?C:hc(C)}return p}class id{constructor(){this.first=!0}update(a,h){const p=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=h),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=p,!0))}}const dr={"Latin-1 Supplement":d=>d>=128&&d<=255,"Hangul Jamo":d=>d>=4352&&d<=4607,Khmer:d=>d>=6016&&d<=6143,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Kanbun:d=>d>=12688&&d<=12703,"CJK Strokes":d=>d>=12736&&d<=12783,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Hangul Syllables":d=>d>=44032&&d<=55215,"Private Use Area":d=>d>=57344&&d<=63743,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519};function is(d){for(const a of d)if(Hu(a.charCodeAt(0)))return!0;return!1}function Mi(d){for(const a of d)if(!gg(a.charCodeAt(0)))return!1;return!0}function _s(d){const a=d.map(h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}}).filter(h=>h);return new RegExp(a.join("|"),"u")}const mg=_s(["Arab","Dupl","Mong","Ougr","Syrc"]);function gg(d){return!mg.test(String.fromCodePoint(d))}const od=_s(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Hu(d){return!(d!==746&&d!==747&&(d<4352||!(dr["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||dr["CJK Compatibility"](d)||dr["CJK Strokes"](d)||!(!dr["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||dr["Enclosed CJK Letters and Months"](d)||dr["Ideographic Description Characters"](d)||dr.Kanbun(d)||dr.Katakana(d)&&d!==12540||!(!dr["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!dr["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||dr["Vertical Forms"](d)||dr["Yijing Hexagram Symbols"](d)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(d))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(d))||od.test(String.fromCodePoint(d)))))}function vf(d){return!(Hu(d)||function(a){return!!(dr["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||dr["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||dr["Letterlike Symbols"](a)||dr["Number Forms"](a)||dr["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||dr["Control Pictures"](a)&&a!==9251||dr["Optical Character Recognition"](a)||dr["Enclosed Alphanumerics"](a)||dr["Geometric Shapes"](a)||dr["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||dr["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||dr["CJK Symbols and Punctuation"](a)||dr.Katakana(a)||dr["Private Use Area"](a)||dr["CJK Compatibility Forms"](a)||dr["Small Form Variants"](a)||dr["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(d))}const sd=_s(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Gu(d){return sd.test(String.fromCodePoint(d))}function Wu(d,a){return!(!a&&Gu(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||dr.Khmer(d))}function ad(d){for(const a of d)if(Gu(a.charCodeAt(0)))return!0;return!1}const dc=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(d){this.pluginStatus=d.pluginStatus,this.pluginURL=d.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(d){if(dc.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=d.applyArabicShaping,this.processBidirectionalText=d.processBidirectionalText,this.processStyledBidirectionalText=d.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(d,a){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(d.pluginStatus!=="loading")return this.setState(d),d;const h=d.pluginURL,p=new Promise(C=>{this.loadScriptResolve=C});a(h);const x=new Promise(C=>setTimeout(()=>C(),this.TIMEOUT));if(yield Promise.race([p,x]),this.isParsed()){const C={pluginStatus:"loaded",pluginURL:h};return this.setState(C),C}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)})}};class si{constructor(a,h){this.zoom=a,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new id,this.transition=h.transition||{},this.globalState=h.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new id,this.transition={},this.globalState={})}isSupportedScript(a){return function(h,p){for(const x of h)if(!Wu(x.charCodeAt(0),p))return!1;return!0}(a,dc.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,h=a-Math.floor(a),p=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*h}}}class fc{constructor(a,h){this.property=a,this.value=h,this.expression=function(p,x){if(jc(p))return new Qh(p,x);if(sc(p)){const C=Wp(p,x);if(C.result==="error")throw new Error(C.value.map(A=>`${A.key}: ${A.message}`).join(", "));return C.value}{let C=p;return x.type==="color"&&typeof p=="string"?C=vr.parse(p):x.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?x.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?x.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?x.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?C=Tr.parse(p):x.type==="projectionDefinition"&&typeof p=="string"&&(C=yr.parse(p)):C=Ni.parse(p):C=To.parse(p):C=Zi.parse(p),{globalStateRefs:new Set,kind:"constant",evaluate:()=>C}}}(h===void 0?a.specification.default:h,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(a,h,p){return this.property.possiblyEvaluate(this,a,h,p)}}class ld{constructor(a){this.property=a,this.value=new fc(a,void 0)}transitioned(a,h){return new Qc(this.property,this.value,h,dn({},a.transition,this.transition),a.now)}untransitioned(){return new Qc(this.property,this.value,null,{},0)}}class yf{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Ln(this._values[a].value.value)}setValue(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new ld(this._values[a].property)),this._values[a].value=new fc(this._values[a].property,h===null?void 0:Ln(h))}getTransition(a){return Ln(this._values[a].transition)}setTransition(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new ld(this._values[a].property)),this._values[a].transition=Ln(h)||void 0}serialize(){const a={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(a[h]=p);const x=this.getTransition(h);x!==void 0&&(a[`${h}-transition`]=x)}return a}transitioned(a,h){const p=new Zp(this._properties);for(const x of Object.keys(this._values))p._values[x]=this._values[x].transitioned(a,h._values[x]);return p}untransitioned(){const a=new Zp(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].untransitioned();return a}}class Qc{constructor(a,h,p,x,C){this.property=a,this.value=h,this.begin=C+x.delay||0,this.end=this.begin+x.duration||0,a.specification.transition&&(x.delay||x.duration)&&(this.prior=p)}possiblyEvaluate(a,h,p){const x=a.now||0,C=this.value.possiblyEvaluate(a,h,p),A=this.prior;if(A){if(x>this.end)return this.prior=null,C;if(this.value.isDataDriven())return this.prior=null,C;if(x<this.begin)return A.possiblyEvaluate(a,h,p);{const k=(x-this.begin)/(this.end-this.begin);return this.property.interpolate(A.possiblyEvaluate(a,h,p),C,At(k))}}return C}}class Zp{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,h,p){const x=new gl(this._properties);for(const C of Object.keys(this._values))x._values[C]=this._values[C].possiblyEvaluate(a,h,p);return x}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class _f{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}hasValue(a){return this._values[a].value!==void 0}getValue(a){return Ln(this._values[a].value)}setValue(a,h){this._values[a]=new fc(this._values[a].property,h===null?void 0:Ln(h))}serialize(){const a={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(a[h]=p)}return a}possiblyEvaluate(a,h,p){const x=new gl(this._properties);for(const C of Object.keys(this._values))x._values[C]=this._values[C].possiblyEvaluate(a,h,p);return x}}class zs{constructor(a,h,p){this.property=a,this.value=h,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,h,p,x){return this.property.evaluate(this.value,this.parameters,a,h,p,x)}}class gl{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class $n{constructor(a){this.specification=a}possiblyEvaluate(a,h){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(h)}interpolate(a,h,p){const x=Ls[this.specification.type];return x?x(a,h,p):a}}class ar{constructor(a,h){this.specification=a,this.overrides=h}possiblyEvaluate(a,h,p,x){return new zs(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(h,null,{},p,x)}:a.expression,h)}interpolate(a,h,p){if(a.value.kind!=="constant"||h.value.kind!=="constant")return a;if(a.value.value===void 0||h.value.value===void 0)return new zs(this,{kind:"constant",value:void 0},a.parameters);const x=Ls[this.specification.type];if(x){const C=x(a.value.value,h.value.value,p);return new zs(this,{kind:"constant",value:C},a.parameters)}return a}evaluate(a,h,p,x,C,A){return a.kind==="constant"?a.value:a.evaluate(h,p,x,C,A)}}class qu extends ar{possiblyEvaluate(a,h,p,x){if(a.value===void 0)return new zs(this,{kind:"constant",value:void 0},h);if(a.expression.kind==="constant"){const C=a.expression.evaluate(h,null,{},p,x),A=a.property.specification.type==="resolvedImage"&&typeof C!="string"?C.name:C,k=this._calculate(A,A,A,h);return new zs(this,{kind:"constant",value:k},h)}if(a.expression.kind==="camera"){const C=this._calculate(a.expression.evaluate({zoom:h.zoom-1}),a.expression.evaluate({zoom:h.zoom}),a.expression.evaluate({zoom:h.zoom+1}),h);return new zs(this,{kind:"constant",value:C},h)}return new zs(this,a.expression,h)}evaluate(a,h,p,x,C,A){if(a.kind==="source"){const k=a.evaluate(h,p,x,C,A);return this._calculate(k,k,k,h)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(h.zoom)-1},p,x),a.evaluate({zoom:Math.floor(h.zoom)},p,x),a.evaluate({zoom:Math.floor(h.zoom)+1},p,x),h):a.value}_calculate(a,h,p,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:p,to:h}}interpolate(a){return a}}class cd{constructor(a){this.specification=a}possiblyEvaluate(a,h,p,x){if(a.value!==void 0){if(a.expression.kind==="constant"){const C=a.expression.evaluate(h,null,{},p,x);return this._calculate(C,C,C,h)}return this._calculate(a.expression.evaluate(new si(Math.floor(h.zoom-1),h)),a.expression.evaluate(new si(Math.floor(h.zoom),h)),a.expression.evaluate(new si(Math.floor(h.zoom+1),h)),h)}}_calculate(a,h,p,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:p,to:h}}interpolate(a){return a}}class Ba{constructor(a){this.specification=a}possiblyEvaluate(a,h,p,x){return!!a.expression.evaluate(h,null,{},p,x)}interpolate(){return!1}}class gi{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in a){const p=a[h];p.specification.overridable&&this.overridableProperties.push(h);const x=this.defaultPropertyValues[h]=new fc(p,void 0),C=this.defaultTransitionablePropertyValues[h]=new ld(p);this.defaultTransitioningPropertyValues[h]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=x.possiblyEvaluate({})}}}zn("DataDrivenProperty",ar),zn("DataConstantProperty",$n),zn("CrossFadedDataDrivenProperty",qu),zn("CrossFadedProperty",cd),zn("ColorRampProperty",Ba);const pc="-transition";class oo extends ut{constructor(a,h){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter,this._featureFilter=Fa(a.filter)),h.layout&&(this._unevaluatedLayout=new _f(h.layout)),h.paint)){this._transitionablePaint=new yf(h.paint);for(const p in a.paint)this.setPaintProperty(p,a.paint[p],{validate:!1});for(const p in a.layout)this.setLayoutProperty(p,a.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gl(h.paint)}}setFilter(a){this.filter=a,this._featureFilter=Fa(a)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}getLayoutAffectingGlobalStateRefs(){const a=new Set;if(this._unevaluatedLayout)for(const h in this._unevaluatedLayout._values){const p=this._unevaluatedLayout._values[h];for(const x of p.getGlobalStateRefs())a.add(x)}for(const h of this._featureFilter.getGlobalStateRefs())a.add(h);return a}setLayoutProperty(a,h,p={}){h!=null&&this._validate(Vu,`layers.${this.id}.layout.${a}`,a,h,p)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,h):this.visibility=h)}getPaintProperty(a){return a.endsWith(pc)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,h,p={}){if(h!=null&&this._validate($u,`layers.${this.id}.paint.${a}`,a,h,p))return!1;if(a.endsWith(pc))return this._transitionablePaint.setTransition(a.slice(0,-11),h||void 0),!1;{const x=this._transitionablePaint._values[a],C=x.property.specification["property-type"]==="cross-faded-data-driven",A=x.value.isDataDriven(),k=x.value;this._transitionablePaint.setValue(a,h),this._handleSpecialPaintPropertyUpdate(a);const N=this._transitionablePaint._values[a].value;return N.isDataDriven()||A||C||this._handleOverridablePaintPropertyUpdate(a,k,N)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,h,p){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,h){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,h)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),et(a,(h,p)=>!(h===void 0||p==="layout"&&!Object.keys(h).length||p==="paint"&&!Object.keys(h).length))}_validate(a,h,p,x,C={}){return(!C||C.validate!==!1)&&uc(this,a.call(Uu,{key:h,layerType:this.type,objectKey:p,value:x,styleSpec:We,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const h=this.paint.get(a);if(h instanceof zs&&oc(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const Yp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class os{constructor(a,h){this._structArray=a,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,h){return a._trim(),h&&(a.isTransferred=!0,h.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const h=Object.create(this.prototype);return h.arrayBuffer=a.arrayBuffer,h.length=a.length,h.capacity=a.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ci(d,a=1){let h=0,p=0;return{members:d.map(x=>{const C=Yp[x.type].BYTES_PER_ELEMENT,A=h=Kp(h,Math.max(a,C)),k=x.components||1;return p=Math.max(p,C),h+=C*k,{name:x.name,type:x.type,components:k,offset:A}}),size:Kp(h,Math.max(p,a)),alignment:a}}function Kp(d,a){return Math.ceil(d/a)*a}class jo extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h){const p=this.length;return this.resize(p+1),this.emplace(p,a,h)}emplace(a,h,p){const x=2*a;return this.int16[x+0]=h,this.int16[x+1]=p,a}}jo.prototype.bytesPerElement=4,zn("StructArrayLayout2i4",jo);class ss extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,a,h,p)}emplace(a,h,p,x){const C=3*a;return this.int16[C+0]=h,this.int16[C+1]=p,this.int16[C+2]=x,a}}ss.prototype.bytesPerElement=6,zn("StructArrayLayout3i6",ss);class Xu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,a,h,p,x)}emplace(a,h,p,x,C){const A=4*a;return this.int16[A+0]=h,this.int16[A+1]=p,this.int16[A+2]=x,this.int16[A+3]=C,a}}Xu.prototype.bytesPerElement=8,zn("StructArrayLayout4i8",Xu);class ud extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,p,x,C,A)}emplace(a,h,p,x,C,A,k){const N=6*a;return this.int16[N+0]=h,this.int16[N+1]=p,this.int16[N+2]=x,this.int16[N+3]=C,this.int16[N+4]=A,this.int16[N+5]=k,a}}ud.prototype.bytesPerElement=12,zn("StructArrayLayout2i4i12",ud);class Ua extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,p,x,C,A)}emplace(a,h,p,x,C,A,k){const N=4*a,j=8*a;return this.int16[N+0]=h,this.int16[N+1]=p,this.uint8[j+4]=x,this.uint8[j+5]=C,this.uint8[j+6]=A,this.uint8[j+7]=k,a}}Ua.prototype.bytesPerElement=8,zn("StructArrayLayout2i4ub8",Ua);class Zu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h){const p=this.length;return this.resize(p+1),this.emplace(p,a,h)}emplace(a,h,p){const x=2*a;return this.float32[x+0]=h,this.float32[x+1]=p,a}}Zu.prototype.bytesPerElement=8,zn("StructArrayLayout2f8",Zu);class eu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A,k,N,j,Y){const Q=this.length;return this.resize(Q+1),this.emplace(Q,a,h,p,x,C,A,k,N,j,Y)}emplace(a,h,p,x,C,A,k,N,j,Y,Q){const he=10*a;return this.uint16[he+0]=h,this.uint16[he+1]=p,this.uint16[he+2]=x,this.uint16[he+3]=C,this.uint16[he+4]=A,this.uint16[he+5]=k,this.uint16[he+6]=N,this.uint16[he+7]=j,this.uint16[he+8]=Y,this.uint16[he+9]=Q,a}}eu.prototype.bytesPerElement=20,zn("StructArrayLayout10ui20",eu);class Os extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A,k,N,j,Y,Q,he){const pe=this.length;return this.resize(pe+1),this.emplace(pe,a,h,p,x,C,A,k,N,j,Y,Q,he)}emplace(a,h,p,x,C,A,k,N,j,Y,Q,he,pe){const me=12*a;return this.int16[me+0]=h,this.int16[me+1]=p,this.int16[me+2]=x,this.int16[me+3]=C,this.uint16[me+4]=A,this.uint16[me+5]=k,this.uint16[me+6]=N,this.uint16[me+7]=j,this.int16[me+8]=Y,this.int16[me+9]=Q,this.int16[me+10]=he,this.int16[me+11]=pe,a}}Os.prototype.bytesPerElement=24,zn("StructArrayLayout4i4ui4i24",Os);class tu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,a,h,p)}emplace(a,h,p,x){const C=3*a;return this.float32[C+0]=h,this.float32[C+1]=p,this.float32[C+2]=x,a}}tu.prototype.bytesPerElement=12,zn("StructArrayLayout3f12",tu);class S extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint32[1*a+0]=h,a}}S.prototype.bytesPerElement=4,zn("StructArrayLayout1ul4",S);class i extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A,k,N,j){const Y=this.length;return this.resize(Y+1),this.emplace(Y,a,h,p,x,C,A,k,N,j)}emplace(a,h,p,x,C,A,k,N,j,Y){const Q=10*a,he=5*a;return this.int16[Q+0]=h,this.int16[Q+1]=p,this.int16[Q+2]=x,this.int16[Q+3]=C,this.int16[Q+4]=A,this.int16[Q+5]=k,this.uint32[he+3]=N,this.uint16[Q+8]=j,this.uint16[Q+9]=Y,a}}i.prototype.bytesPerElement=20,zn("StructArrayLayout6i1ul2ui20",i);class u extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,p,x,C,A)}emplace(a,h,p,x,C,A,k){const N=6*a;return this.int16[N+0]=h,this.int16[N+1]=p,this.int16[N+2]=x,this.int16[N+3]=C,this.int16[N+4]=A,this.int16[N+5]=k,a}}u.prototype.bytesPerElement=12,zn("StructArrayLayout2i2i2i12",u);class g extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C){const A=this.length;return this.resize(A+1),this.emplace(A,a,h,p,x,C)}emplace(a,h,p,x,C,A){const k=4*a,N=8*a;return this.float32[k+0]=h,this.float32[k+1]=p,this.float32[k+2]=x,this.int16[N+6]=C,this.int16[N+7]=A,a}}g.prototype.bytesPerElement=16,zn("StructArrayLayout2f1f2i16",g);class _ extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A){const k=this.length;return this.resize(k+1),this.emplace(k,a,h,p,x,C,A)}emplace(a,h,p,x,C,A,k){const N=16*a,j=4*a,Y=8*a;return this.uint8[N+0]=h,this.uint8[N+1]=p,this.float32[j+1]=x,this.float32[j+2]=C,this.int16[Y+6]=A,this.int16[Y+7]=k,a}}_.prototype.bytesPerElement=16,zn("StructArrayLayout2ub2f2i16",_);class M extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,a,h,p)}emplace(a,h,p,x){const C=3*a;return this.uint16[C+0]=h,this.uint16[C+1]=p,this.uint16[C+2]=x,a}}M.prototype.bytesPerElement=6,zn("StructArrayLayout3ui6",M);class D extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A,k,N,j,Y,Q,he,pe,me,_e,ke,Ve){const dt=this.length;return this.resize(dt+1),this.emplace(dt,a,h,p,x,C,A,k,N,j,Y,Q,he,pe,me,_e,ke,Ve)}emplace(a,h,p,x,C,A,k,N,j,Y,Q,he,pe,me,_e,ke,Ve,dt){const tt=24*a,de=12*a,De=48*a;return this.int16[tt+0]=h,this.int16[tt+1]=p,this.uint16[tt+2]=x,this.uint16[tt+3]=C,this.uint32[de+2]=A,this.uint32[de+3]=k,this.uint32[de+4]=N,this.uint16[tt+10]=j,this.uint16[tt+11]=Y,this.uint16[tt+12]=Q,this.float32[de+7]=he,this.float32[de+8]=pe,this.uint8[De+36]=me,this.uint8[De+37]=_e,this.uint8[De+38]=ke,this.uint32[de+10]=Ve,this.int16[tt+22]=dt,a}}D.prototype.bytesPerElement=48,zn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",D);class F extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p,x,C,A,k,N,j,Y,Q,he,pe,me,_e,ke,Ve,dt,tt,de,De,rt,Rt,sn,Ft,Vt,gn,an){const xn=this.length;return this.resize(xn+1),this.emplace(xn,a,h,p,x,C,A,k,N,j,Y,Q,he,pe,me,_e,ke,Ve,dt,tt,de,De,rt,Rt,sn,Ft,Vt,gn,an)}emplace(a,h,p,x,C,A,k,N,j,Y,Q,he,pe,me,_e,ke,Ve,dt,tt,de,De,rt,Rt,sn,Ft,Vt,gn,an,xn){const Xt=32*a,Hn=16*a;return this.int16[Xt+0]=h,this.int16[Xt+1]=p,this.int16[Xt+2]=x,this.int16[Xt+3]=C,this.int16[Xt+4]=A,this.int16[Xt+5]=k,this.int16[Xt+6]=N,this.int16[Xt+7]=j,this.uint16[Xt+8]=Y,this.uint16[Xt+9]=Q,this.uint16[Xt+10]=he,this.uint16[Xt+11]=pe,this.uint16[Xt+12]=me,this.uint16[Xt+13]=_e,this.uint16[Xt+14]=ke,this.uint16[Xt+15]=Ve,this.uint16[Xt+16]=dt,this.uint16[Xt+17]=tt,this.uint16[Xt+18]=de,this.uint16[Xt+19]=De,this.uint16[Xt+20]=rt,this.uint16[Xt+21]=Rt,this.uint16[Xt+22]=sn,this.uint32[Hn+12]=Ft,this.float32[Hn+13]=Vt,this.float32[Hn+14]=gn,this.uint16[Xt+30]=an,this.uint16[Xt+31]=xn,a}}F.prototype.bytesPerElement=64,zn("StructArrayLayout8i15ui1ul2f2ui64",F);class U extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.float32[1*a+0]=h,a}}U.prototype.bytesPerElement=4,zn("StructArrayLayout1f4",U);class Z extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,a,h,p)}emplace(a,h,p,x){const C=3*a;return this.uint16[6*a+0]=h,this.float32[C+1]=p,this.float32[C+2]=x,a}}Z.prototype.bytesPerElement=12,zn("StructArrayLayout1ui2f12",Z);class K extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,p){const x=this.length;return this.resize(x+1),this.emplace(x,a,h,p)}emplace(a,h,p,x){const C=4*a;return this.uint32[2*a+0]=h,this.uint16[C+2]=p,this.uint16[C+3]=x,a}}K.prototype.bytesPerElement=8,zn("StructArrayLayout1ul2ui8",K);class ie extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h){const p=this.length;return this.resize(p+1),this.emplace(p,a,h)}emplace(a,h,p){const x=2*a;return this.uint16[x+0]=h,this.uint16[x+1]=p,a}}ie.prototype.bytesPerElement=4,zn("StructArrayLayout2ui4",ie);class ne extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint16[1*a+0]=h,a}}ne.prototype.bytesPerElement=2,zn("StructArrayLayout1ui2",ne);class le extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,p,x){const C=this.length;return this.resize(C+1),this.emplace(C,a,h,p,x)}emplace(a,h,p,x,C){const A=4*a;return this.float32[A+0]=h,this.float32[A+1]=p,this.float32[A+2]=x,this.float32[A+3]=C,a}}le.prototype.bytesPerElement=16,zn("StructArrayLayout4f16",le);class ge extends os{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new R(this.anchorPointX,this.anchorPointY)}}ge.prototype.size=20;class Le extends i{get(a){return new ge(this,a)}}zn("CollisionBoxArray",Le);class ze extends os{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ze.prototype.size=48;class Ne extends D{get(a){return new ze(this,a)}}zn("PlacedSymbolArray",Ne);class Ge extends os{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ge.prototype.size=64;class Je extends F{get(a){return new Ge(this,a)}}zn("SymbolInstanceArray",Je);class qe extends U{getoffsetX(a){return this.float32[1*a+0]}}zn("GlyphOffsetArray",qe);class at extends ss{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}zn("SymbolLineVertexArray",at);class ct extends os{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ct.prototype.size=12;class Ze extends Z{get(a){return new ct(this,a)}}zn("TextAnchorOffsetArray",Ze);class pt extends os{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}pt.prototype.size=8;class Tt extends K{get(a){return new pt(this,a)}}zn("FeatureIndexArray",Tt);class Mt extends jo{}class Et extends jo{}class Dt extends jo{}class Sn extends ud{}class wn extends Ua{}class nn extends Zu{}class Vn extends eu{}class br extends Os{}class jr extends tu{}class Ei extends S{}class ii extends u{}class ci extends _{}class ai extends M{}class Kr extends ie{}const ti=Ci([{name:"a_pos",components:2,type:"Int16"}],4),{members:go}=ti;class Ar{constructor(a=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=a}prepareSegment(a,h,p,x){const C=this.segments[this.segments.length-1];return a>Ar.MAX_VERTEX_ARRAY_LENGTH&&fn(`Max vertices per segment is ${Ar.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ar.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!C||C.vertexLength+a>Ar.MAX_VERTEX_ARRAY_LENGTH||C.sortKey!==x?this.createNewSegment(h,p,x):C}createNewSegment(a,h,p){const x={vertexOffset:a.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(x.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(x),x}getOrCreateLatestSegment(a,h,p){return this.prepareSegment(0,a,h,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const a of this.segments)for(const h in a.vaos)a.vaos[h].destroy()}static simpleSegment(a,h,p,x){return new Ar([{vertexOffset:a,primitiveOffset:h,vertexLength:p,primitiveLength:x,vaos:{},sortKey:0}])}}function so(d,a){return 256*(d=bt(Math.floor(d),0,255))+bt(Math.floor(a),0,255)}Ar.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zn("SegmentVector",Ar);const vo=Ci([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var vl,yl,$a,va={exports:{}},Yu={exports:{}},Ku={exports:{}},Ju=function(){if($a)return va.exports;$a=1;var d=(vl||(vl=1,Yu.exports=function(h,p){var x,C,A,k,N,j,Y,Q;for(C=h.length-(x=3&h.length),A=p,N=3432918353,j=461845907,Q=0;Q<C;)Y=255&h.charCodeAt(Q)|(255&h.charCodeAt(++Q))<<8|(255&h.charCodeAt(++Q))<<16|(255&h.charCodeAt(++Q))<<24,++Q,A=27492+(65535&(k=5*(65535&(A=(A^=Y=(65535&(Y=(Y=(65535&Y)*N+(((Y>>>16)*N&65535)<<16)&4294967295)<<15|Y>>>17))*j+(((Y>>>16)*j&65535)<<16)&4294967295)<<13|A>>>19))+((5*(A>>>16)&65535)<<16)&4294967295))+((58964+(k>>>16)&65535)<<16);switch(Y=0,x){case 3:Y^=(255&h.charCodeAt(Q+2))<<16;case 2:Y^=(255&h.charCodeAt(Q+1))<<8;case 1:A^=Y=(65535&(Y=(Y=(65535&(Y^=255&h.charCodeAt(Q)))*N+(((Y>>>16)*N&65535)<<16)&4294967295)<<15|Y>>>17))*j+(((Y>>>16)*j&65535)<<16)&4294967295}return A^=h.length,A=2246822507*(65535&(A^=A>>>16))+((2246822507*(A>>>16)&65535)<<16)&4294967295,A=3266489909*(65535&(A^=A>>>13))+((3266489909*(A>>>16)&65535)<<16)&4294967295,(A^=A>>>16)>>>0}),Yu.exports),a=(yl||(yl=1,Ku.exports=function(h,p){for(var x,C=h.length,A=p^C,k=0;C>=4;)x=1540483477*(65535&(x=255&h.charCodeAt(k)|(255&h.charCodeAt(++k))<<8|(255&h.charCodeAt(++k))<<16|(255&h.charCodeAt(++k))<<24))+((1540483477*(x>>>16)&65535)<<16),A=1540483477*(65535&A)+((1540483477*(A>>>16)&65535)<<16)^(x=1540483477*(65535&(x^=x>>>24))+((1540483477*(x>>>16)&65535)<<16)),C-=4,++k;switch(C){case 3:A^=(255&h.charCodeAt(k+2))<<16;case 2:A^=(255&h.charCodeAt(k+1))<<8;case 1:A=1540483477*(65535&(A^=255&h.charCodeAt(k)))+((1540483477*(A>>>16)&65535)<<16)}return A=1540483477*(65535&(A^=A>>>13))+((1540483477*(A>>>16)&65535)<<16),(A^=A>>>15)>>>0}),Ku.exports);return va.exports=d,va.exports.murmur3=d,va.exports.murmur2=a,va.exports}(),as=m(Ju);class ya{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,h,p,x){this.ids.push(mc(a)),this.positions.push(h,p,x)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=mc(a);let p=0,x=this.ids.length-1;for(;p<x;){const A=p+x>>1;this.ids[A]>=h?x=A:p=A+1}const C=[];for(;this.ids[p]===h;)C.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return C}static serialize(a,h){const p=new Float64Array(a.ids),x=new Uint32Array(a.positions);return gc(p,x,0,p.length-1),h&&h.push(p.buffer,x.buffer),{ids:p,positions:x}}static deserialize(a){const h=new ya;return h.ids=a.ids,h.positions=a.positions,h.indexed=!0,h}}function mc(d){const a=+d;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:as(String(d))}function gc(d,a,h,p){for(;h<p;){const x=d[h+p>>1];let C=h-1,A=p+1;for(;;){do C++;while(d[C]<x);do A--;while(d[A]>x);if(C>=A)break;ki(d,C,A),ki(a,3*C,3*A),ki(a,3*C+1,3*A+1),ki(a,3*C+2,3*A+2)}A-h<p-A?(gc(d,a,h,A),h=A+1):(gc(d,a,A+1,p),p=A)}}function ki(d,a,h){const p=d[a];d[a]=d[h],d[h]=p}zn("FeaturePositionMap",ya);class hi{constructor(a,h){this.gl=a.gl,this.location=h}}class yo extends hi{constructor(a,h){super(a,h),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class ao extends hi{constructor(a,h){super(a,h),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class vg extends hi{constructor(a,h){super(a,h),this.current=vr.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const Sy=new Float32Array(16);function Fs(d){return[so(255*d.r,255*d.g),so(255*d.b,255*d.a)]}class nu{constructor(a,h,p){this.value=a,this.uniformNames=h.map(x=>`u_${x}`),this.type=p}setUniform(a,h,p){a.set(p.constantOr(this.value))}getBinding(a,h,p){return this.type==="color"?new vg(a,h):new yo(a,h)}}class _l{constructor(a,h){this.uniformNames=h.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=a.tlbr}setUniform(a,h,p,x){const C=x==="u_pattern_to"?this.patternTo:x==="u_pattern_from"?this.patternFrom:x==="u_pixel_ratio_to"?this.pixelRatioTo:x==="u_pixel_ratio_from"?this.pixelRatioFrom:null;C&&a.set(C)}getBinding(a,h,p){return p.substr(0,9)==="u_pattern"?new ao(a,h):new yo(a,h)}}class Va{constructor(a,h,p,x){this.expression=a,this.type=p,this.maxValue=0,this.paintVertexAttributes=h.map(C=>({name:`a_${C}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new x}populatePaintArray(a,h,p,x,C){const A=this.paintVertexArray.length,k=this.expression.evaluate(new si(0),h,{},x,[],C);this.paintVertexArray.resize(a),this._setPaintValue(A,a,k)}updatePaintArray(a,h,p,x){const C=this.expression.evaluate({zoom:0},p,x);this._setPaintValue(a,h,C)}_setPaintValue(a,h,p){if(this.type==="color"){const x=Fs(p);for(let C=a;C<h;C++)this.paintVertexArray.emplace(C,x[0],x[1])}else{for(let x=a;x<h;x++)this.paintVertexArray.emplace(x,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _o{constructor(a,h,p,x,C,A){this.expression=a,this.uniformNames=h.map(k=>`u_${k}_t`),this.type=p,this.useIntegerZoom=x,this.zoom=C,this.maxValue=0,this.paintVertexAttributes=h.map(k=>({name:`a_${k}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new A}populatePaintArray(a,h,p,x,C){const A=this.expression.evaluate(new si(this.zoom),h,{},x,[],C),k=this.expression.evaluate(new si(this.zoom+1),h,{},x,[],C),N=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(N,a,A,k)}updatePaintArray(a,h,p,x){const C=this.expression.evaluate({zoom:this.zoom},p,x),A=this.expression.evaluate({zoom:this.zoom+1},p,x);this._setPaintValue(a,h,C,A)}_setPaintValue(a,h,p,x){if(this.type==="color"){const C=Fs(p),A=Fs(x);for(let k=a;k<h;k++)this.paintVertexArray.emplace(k,C[0],C[1],A[0],A[1])}else{for(let C=a;C<h;C++)this.paintVertexArray.emplace(C,p,x);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(x))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,h){const p=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,x=bt(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);a.set(x)}getBinding(a,h,p){return new yo(a,h)}}class ja{constructor(a,h,p,x,C,A){this.expression=a,this.type=h,this.useIntegerZoom=p,this.zoom=x,this.layerId=A,this.zoomInPaintVertexArray=new C,this.zoomOutPaintVertexArray=new C}populatePaintArray(a,h,p){const x=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(x,a,h.patterns&&h.patterns[this.layerId],p)}updatePaintArray(a,h,p,x,C){this._setPaintValues(a,h,p.patterns&&p.patterns[this.layerId],C)}_setPaintValues(a,h,p,x){if(!x||!p)return;const{min:C,mid:A,max:k}=p,N=x[C],j=x[A],Y=x[k];if(N&&j&&Y)for(let Q=a;Q<h;Q++)this.zoomInPaintVertexArray.emplace(Q,j.tl[0],j.tl[1],j.br[0],j.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],j.pixelRatio,N.pixelRatio),this.zoomOutPaintVertexArray.emplace(Q,j.tl[0],j.tl[1],j.br[0],j.br[1],Y.tl[0],Y.tl[1],Y.br[0],Y.br[1],j.pixelRatio,Y.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,vo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,vo.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class hd{constructor(a,h,p){this.binders={},this._buffers=[];const x=[];for(const C in a.paint._values){if(!p(C))continue;const A=a.paint.get(C);if(!(A instanceof zs&&oc(A.property.specification)))continue;const k=dd(C,a.type),N=A.value,j=A.property.specification.type,Y=A.property.useIntegerZoom,Q=A.property.specification["property-type"],he=Q==="cross-faded"||Q==="cross-faded-data-driven";if(N.kind==="constant")this.binders[C]=he?new _l(N.value,k):new nu(N.value,k,j),x.push(`/u_${C}`);else if(N.kind==="source"||he){const pe=fd(C,j,"source");this.binders[C]=he?new ja(N,j,Y,h,pe,a.id):new Va(N,k,j,pe),x.push(`/a_${C}`)}else{const pe=fd(C,j,"composite");this.binders[C]=new _o(N,k,j,Y,h,pe),x.push(`/z_${C}`)}}this.cacheKey=x.sort().join("")}getMaxValue(a){const h=this.binders[a];return h instanceof Va||h instanceof _o?h.maxValue:0}populatePaintArrays(a,h,p,x,C){for(const A in this.binders){const k=this.binders[A];(k instanceof Va||k instanceof _o||k instanceof ja)&&k.populatePaintArray(a,h,p,x,C)}}setConstantPatternPositions(a,h){for(const p in this.binders){const x=this.binders[p];x instanceof _l&&x.setConstantPatternPositions(a,h)}}updatePaintArrays(a,h,p,x,C){let A=!1;for(const k in a){const N=h.getPositions(k);for(const j of N){const Y=p.feature(j.index);for(const Q in this.binders){const he=this.binders[Q];if((he instanceof Va||he instanceof _o||he instanceof ja)&&he.expression.isStateDependent===!0){const pe=x.paint.get(Q);he.expression=pe.value,he.updatePaintArray(j.start,j.end,Y,a[k],C),A=!0}}}}return A}defines(){const a=[];for(const h in this.binders){const p=this.binders[h];(p instanceof nu||p instanceof _l)&&a.push(...p.uniformNames.map(x=>`#define HAS_UNIFORM_${x}`))}return a}getBinderAttributes(){const a=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof Va||p instanceof _o)for(let x=0;x<p.paintVertexAttributes.length;x++)a.push(p.paintVertexAttributes[x].name);else if(p instanceof ja)for(let x=0;x<vo.members.length;x++)a.push(vo.members[x].name)}return a}getBinderUniforms(){const a=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof nu||p instanceof _l||p instanceof _o)for(const x of p.uniformNames)a.push(x)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,h){const p=[];for(const x in this.binders){const C=this.binders[x];if(C instanceof nu||C instanceof _l||C instanceof _o){for(const A of C.uniformNames)if(h[A]){const k=C.getBinding(a,h[A],A);p.push({name:A,property:x,binding:k})}}}return p}setUniforms(a,h,p,x){for(const{name:C,property:A,binding:k}of h)this.binders[A].setUniform(k,x,p.get(A),C)}updatePaintBuffers(a){this._buffers=[];for(const h in this.binders){const p=this.binders[h];if(a&&p instanceof ja){const x=a.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;x&&this._buffers.push(x)}else(p instanceof Va||p instanceof _o)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(a){for(const h in this.binders){const p=this.binders[h];(p instanceof Va||p instanceof _o||p instanceof ja)&&p.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const h=this.binders[a];(h instanceof Va||h instanceof _o||h instanceof ja)&&h.destroy()}}}class Ns{constructor(a,h,p=()=>!0){this.programConfigurations={};for(const x of a)this.programConfigurations[x.id]=new hd(x,h,p);this.needsUpload=!1,this._featureMap=new ya,this._bufferOffset=0}populatePaintArrays(a,h,p,x,C,A){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(a,h,x,C,A);h.id!==void 0&&this._featureMap.add(h.id,p,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,h,p,x){for(const C of p)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(a,this._featureMap,h,C,x)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}function dd(d,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[d]||[d.replace(`${a}-`,"").replace(/-/g,"_")]}function fd(d,a,h){const p={color:{source:Zu,composite:le},number:{source:U,composite:Zu}},x=function(C){return{"line-pattern":{source:Vn,composite:Vn},"fill-pattern":{source:Vn,composite:Vn},"fill-extrusion-pattern":{source:Vn,composite:Vn}}[C]}(d);return x&&x[h]||p[a][h]}zn("ConstantBinder",nu),zn("CrossFadedConstantBinder",_l),zn("SourceExpressionBinder",Va),zn("CrossFadedCompositeBinder",ja),zn("CompositeExpressionBinder",_o),zn("ProgramConfiguration",hd,{omit:["_buffers"]}),zn("ProgramConfigurationSet",Ns);const pd=Math.pow(2,14)-1,My=-pd-1;function Qu(d){const a=Qe/d.extent,h=d.loadGeometry();for(let p=0;p<h.length;p++){const x=h[p];for(let C=0;C<x.length;C++){const A=x[C],k=Math.round(A.x*a),N=Math.round(A.y*a);A.x=bt(k,My,pd),A.y=bt(N,My,pd),(k<A.x||k>A.x+1||N<A.y||N>A.y+1)&&fn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function eh(d,a){return{type:d.type,id:d.id,properties:d.properties,geometry:a?Qu(d):[]}}const Cy=-32768;function vx(d,a,h,p,x){d.emplaceBack(Cy+8*a+p,Cy+8*h+x)}class Ey{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Et,this.indexArray=new ai,this.segments=new Ar,this.programConfigurations=new Ns(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,p){const x=this.layers[0],C=[];let A=null,k=!1,N=x.type==="heatmap";if(x.type==="circle"){const Y=x;A=Y.layout.get("circle-sort-key"),k=!A.isConstant(),N=N||Y.paint.get("circle-pitch-alignment")==="map"}const j=N?h.subdivisionGranularity.circle:1;for(const{feature:Y,id:Q,index:he,sourceLayerIndex:pe}of a){const me=this.layers[0]._featureFilter.needGeometry,_e=eh(Y,me);if(!this.layers[0]._featureFilter.filter(new si(this.zoom,{globalState:this.globalState}),_e,p))continue;const ke=k?A.evaluate(_e,{},p):void 0,Ve={id:Q,properties:Y.properties,type:Y.type,sourceLayerIndex:pe,index:he,geometry:me?_e.geometry:Qu(Y),patterns:{},sortKey:ke};C.push(Ve)}k&&C.sort((Y,Q)=>Y.sortKey-Q.sortKey);for(const Y of C){const{geometry:Q,index:he,sourceLayerIndex:pe}=Y,me=a[he].feature;this.addFeature(Y,Q,he,p,j),h.featureIndex.insert(me,Q,he,pe,this.index)}}update(a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,go),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,h,p,x,C=1){let A;switch(C){case 1:A=[0,7];break;case 3:A=[0,2,5,7];break;case 5:A=[0,1,3,4,6,7];break;case 7:A=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${C}; valid values are 1, 3, 5, 7.`)}const k=A.length;for(const N of h)for(const j of N){const Y=j.x,Q=j.y;if(Y<0||Y>=Qe||Q<0||Q>=Qe)continue;const he=this.segments.prepareSegment(k*k,this.layoutVertexArray,this.indexArray,a.sortKey),pe=he.vertexLength;for(let me=0;me<k;me++)for(let _e=0;_e<k;_e++)vx(this.layoutVertexArray,Y,Q,A[_e],A[me]);for(let me=0;me<k-1;me++)for(let _e=0;_e<k-1;_e++){const ke=pe+me*k+_e,Ve=pe+(me+1)*k+_e;this.indexArray.emplaceBack(ke,Ve+1,ke+1),this.indexArray.emplaceBack(ke,Ve,Ve+1)}he.vertexLength+=k*k,he.primitiveLength+=(k-1)*(k-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{},x)}}function Bs(d,a){for(let h=0;h<d.length;h++)if(th(a,d[h]))return!0;for(let h=0;h<a.length;h++)if(th(d,a[h]))return!0;return!!yg(d,a)}function Us(d,a,h){return!!th(d,a)||!!_g(a,d,h)}function Ty(d,a){if(d.length===1)return Py(a,d[0]);for(let h=0;h<a.length;h++){const p=a[h];for(let x=0;x<p.length;x++)if(th(d,p[x]))return!0}for(let h=0;h<d.length;h++)if(Py(a,d[h]))return!0;for(let h=0;h<a.length;h++)if(yg(d,a[h]))return!0;return!1}function yx(d,a,h){if(d.length>1){if(yg(d,a))return!0;for(let p=0;p<a.length;p++)if(_g(a[p],d,h))return!0}for(let p=0;p<d.length;p++)if(_g(d[p],a,h))return!0;return!1}function yg(d,a){if(d.length===0||a.length===0)return!1;for(let h=0;h<d.length-1;h++){const p=d[h],x=d[h+1];for(let C=0;C<a.length-1;C++)if(_x(p,x,a[C],a[C+1]))return!0}return!1}function _x(d,a,h,p){return $t(d,h,p)!==$t(a,h,p)&&$t(d,a,h)!==$t(d,a,p)}function _g(d,a,h){const p=h*h;if(a.length===1)return d.distSqr(a[0])<p;for(let x=1;x<a.length;x++)if(xg(d,a[x-1],a[x])<p)return!0;return!1}function xg(d,a,h){const p=a.distSqr(h);if(p===0)return d.distSqr(a);const x=((d.x-a.x)*(h.x-a.x)+(d.y-a.y)*(h.y-a.y))/p;return d.distSqr(x<0?a:x>1?h:h.sub(a)._mult(x)._add(a))}function Py(d,a){let h,p,x,C=!1;for(let A=0;A<d.length;A++){h=d[A];for(let k=0,N=h.length-1;k<h.length;N=k++)p=h[k],x=h[N],p.y>a.y!=x.y>a.y&&a.x<(x.x-p.x)*(a.y-p.y)/(x.y-p.y)+p.x&&(C=!C)}return C}function th(d,a){let h=!1;for(let p=0,x=d.length-1;p<d.length;x=p++){const C=d[p],A=d[x];C.y>a.y!=A.y>a.y&&a.x<(A.x-C.x)*(a.y-C.y)/(A.y-C.y)+C.x&&(h=!h)}return h}function xx(d,a,h){const p=h[0],x=h[2];if(d.x<p.x&&a.x<p.x||d.x>x.x&&a.x>x.x||d.y<p.y&&a.y<p.y||d.y>x.y&&a.y>x.y)return!1;const C=$t(d,a,h[0]);return C!==$t(d,a,h[1])||C!==$t(d,a,h[2])||C!==$t(d,a,h[3])}function xf(d,a,h){const p=a.paint.get(d).value;return p.kind==="constant"?p.value:h.programConfigurations.get(a.id).getMaxValue(d)}function bf(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function wf(d,a,h,p,x){if(!a[0]&&!a[1])return d;const C=R.convert(a)._mult(x);h==="viewport"&&C._rotate(-p);const A=[];for(let k=0;k<d.length;k++)A.push(d[k].sub(C));return A}let Ay,bg;zn("CircleBucket",Ey,{omit:["layers"]});var wg={get paint(){return bg=bg||new gi({"circle-radius":new ar(We.paint_circle["circle-radius"]),"circle-color":new ar(We.paint_circle["circle-color"]),"circle-blur":new ar(We.paint_circle["circle-blur"]),"circle-opacity":new ar(We.paint_circle["circle-opacity"]),"circle-translate":new $n(We.paint_circle["circle-translate"]),"circle-translate-anchor":new $n(We.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new $n(We.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new $n(We.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ar(We.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ar(We.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ar(We.paint_circle["circle-stroke-opacity"])})},get layout(){return Ay=Ay||new gi({"circle-sort-key":new ar(We.layout_circle["circle-sort-key"])})}};class hS extends oo{constructor(a){super(a,wg)}createBucket(a){return new Ey(a)}queryRadius(a){const h=a;return xf("circle-radius",this,h)+xf("circle-stroke-width",this,h)+bf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:a,feature:h,featureState:p,geometry:x,transform:C,pixelsToTileUnits:A,unwrappedTileID:k,getElevation:N}){const j=wf(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-C.bearingInRadians,A),Y=this.paint.get("circle-radius").evaluate(h,p)+this.paint.get("circle-stroke-width").evaluate(h,p),Q=this.paint.get("circle-pitch-alignment")==="map",he=Q?j:function(me,_e,ke,Ve){return me.map(dt=>Iy(dt,_e,ke,Ve))}(j,C,k,N),pe=Q?Y*A:Y;for(const me of x)for(const _e of me){const ke=Q?_e:Iy(_e,C,k,N);let Ve=pe;const dt=C.projectTileCoordinates(_e.x,_e.y,k,N).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ve*=dt/C.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ve*=C.cameraToCenterDistance/dt),Us(he,ke,Ve))return!0}return!1}}function Iy(d,a,h,p){const x=a.projectTileCoordinates(d.x,d.y,h,p).point;return new R((.5*x.x+.5)*a.width,(.5*-x.y+.5)*a.height)}class Sg extends Ey{}let Ry;zn("HeatmapBucket",Sg,{omit:["layers"]});var Mg={get paint(){return Ry=Ry||new gi({"heatmap-radius":new ar(We.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ar(We.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new $n(We.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ba(We.paint_heatmap["heatmap-color"]),"heatmap-opacity":new $n(We.paint_heatmap["heatmap-opacity"])})}};function xl(d,{width:a,height:h},p,x){if(x){if(x instanceof Uint8ClampedArray)x=new Uint8Array(x.buffer);else if(x.length!==a*h*p)throw new RangeError(`mismatched image size. expected: ${x.length} but got: ${a*h*p}`)}else x=new Uint8Array(a*h*p);return d.width=a,d.height=h,d.data=x,d}function bx(d,{width:a,height:h},p){if(a===d.width&&h===d.height)return;const x=xl({},{width:a,height:h},p);Cg(d,x,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,a),height:Math.min(d.height,h)},p),d.width=a,d.height=h,d.data=x.data}function Cg(d,a,h,p,x,C){if(x.width===0||x.height===0)return a;if(x.width>d.width||x.height>d.height||h.x>d.width-x.width||h.y>d.height-x.height)throw new RangeError("out of range source coordinates for image copy");if(x.width>a.width||x.height>a.height||p.x>a.width-x.width||p.y>a.height-x.height)throw new RangeError("out of range destination coordinates for image copy");const A=d.data,k=a.data;if(A===k)throw new Error("srcData equals dstData, so image is already copied");for(let N=0;N<x.height;N++){const j=((h.y+N)*d.width+h.x)*C,Y=((p.y+N)*a.width+p.x)*C;for(let Q=0;Q<x.width*C;Q++)k[Y+Q]=A[j+Q]}return a}class md{constructor(a,h){xl(this,a,1,h)}resize(a){bx(this,a,1)}clone(){return new md({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,p,x,C){Cg(a,h,p,x,C,1)}}class xs{constructor(a,h){xl(this,a,4,h)}resize(a){bx(this,a,4)}replace(a,h){h?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new xs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,p,x,C){Cg(a,h,p,x,C,4)}setPixel(a,h,p){const x=4*(a*this.width+h);this.data[x+0]=Math.round(255*p.r/p.a),this.data[x+1]=Math.round(255*p.g/p.a),this.data[x+2]=Math.round(255*p.b/p.a),this.data[x+3]=Math.round(255*p.a)}}function Ly(d){const a={},h=d.resolution||256,p=d.clips?d.clips.length:1,x=d.image||new xs({width:h,height:p});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const C=(A,k,N)=>{a[d.evaluationKey]=N;const j=d.expression.evaluate(a);x.setPixel(A/4/h,k/4,j)};if(d.clips)for(let A=0,k=0;A<p;++A,k+=4*h)for(let N=0,j=0;N<h;N++,j+=4){const Y=N/(h-1),{start:Q,end:he}=d.clips[A];C(k,j,Q*(1-Y)+he*Y)}else for(let A=0,k=0;A<h;A++,k+=4)C(0,k,A/(h-1));return x}zn("AlphaImage",md),zn("RGBAImage",xs);const gd="big-fb";class bs extends oo{createBucket(a){return new Sg(a)}constructor(a){super(a,Mg),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ly({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(gd)&&this.heatmapFbos.delete(gd)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let wx;var dS={get paint(){return wx=wx||new gi({"hillshade-illumination-direction":new $n(We.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new $n(We.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new $n(We.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new $n(We.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new $n(We.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new $n(We.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new $n(We.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new $n(We.paint_hillshade["hillshade-method"])})}};class Eg extends oo{constructor(a){super(a,dS),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let a=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,p=this.paint.get("hillshade-highlight-color").values,x=this.paint.get("hillshade-shadow-color").values;const C=Math.max(a.length,h.length,p.length,x.length);a=a.concat(Array(C-a.length).fill(a.at(-1))),h=h.concat(Array(C-h.length).fill(h.at(-1))),p=p.concat(Array(C-p.length).fill(p.at(-1))),x=x.concat(Array(C-x.length).fill(x.at(-1)));const A=h.map(ln);return{directionRadians:a.map(ln),altitudeRadians:A,shadowColor:x,highlightColor:p}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let ls;var fS={get paint(){return ls=ls||new gi({"color-relief-opacity":new $n(We["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Ba(We["paint_color-relief"]["color-relief-color"])})}};class er{constructor(a,h,p,x){this.context=a,this.format=p,this.texture=a.gl.createTexture(),this.update(h,x)}update(a,h,p){const{width:x,height:C}=a,A=!(this.size&&this.size[0]===x&&this.size[1]===C||p),{context:k}=this,{gl:N}=k;if(this.useMipmap=!!(h&&h.useMipmap),N.bindTexture(N.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===N.RGBA&&(!h||h.premultiply!==!1)),A)this.size=[x,C],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||Ue(a)?N.texImage2D(N.TEXTURE_2D,0,this.format,this.format,N.UNSIGNED_BYTE,a):N.texImage2D(N.TEXTURE_2D,0,this.format,x,C,0,this.format,N.UNSIGNED_BYTE,a.data);else{const{x:j,y:Y}=p||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||Ue(a)?N.texSubImage2D(N.TEXTURE_2D,0,j,Y,N.RGBA,N.UNSIGNED_BYTE,a):N.texSubImage2D(N.TEXTURE_2D,0,j,Y,x,C,N.RGBA,N.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&N.generateMipmap(N.TEXTURE_2D),k.pixelStoreUnpackFlipY.setDefault(),k.pixelStoreUnpack.setDefault(),k.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(a,h,p){const{context:x}=this,{gl:C}=x;C.bindTexture(C.TEXTURE_2D,this.texture),p!==C.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=C.LINEAR),a!==this.filter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,a),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,p||a),this.filter=a),h!==this.wrap&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,h),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class vd{constructor(a,h,p,x=1,C=1,A=1,k=0){if(this.uid=a,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void fn(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const N=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=x,this.greenFactor=C,this.blueFactor=A,this.baseShift=k;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let j=0;j<N;j++)this.data[this._idx(-1,j)]=this.data[this._idx(0,j)],this.data[this._idx(N,j)]=this.data[this._idx(N-1,j)],this.data[this._idx(j,-1)]=this.data[this._idx(j,0)],this.data[this._idx(j,N)]=this.data[this._idx(j,N-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(N,-1)]=this.data[this._idx(N-1,0)],this.data[this._idx(-1,N)]=this.data[this._idx(0,N-1)],this.data[this._idx(N,N)]=this.data[this._idx(N-1,N-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let j=0;j<N;j++)for(let Y=0;Y<N;Y++){const Q=this.get(j,Y);Q>this.max&&(this.max=Q),Q<this.min&&(this.min=Q)}}get(a,h){const p=new Uint8Array(this.data.buffer),x=4*this._idx(a,h);return this.unpack(p[x],p[x+1],p[x+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,h){if(a<-1||a>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(a+1)}unpack(a,h,p){return a*this.redFactor+h*this.greenFactor+p*this.blueFactor-this.baseShift}pack(a){return Tg(a,this.getUnpackVector())}getPixels(){return new xs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,h,p){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let x=h*this.dim,C=h*this.dim+this.dim,A=p*this.dim,k=p*this.dim+this.dim;switch(h){case-1:x=C-1;break;case 1:C=x+1}switch(p){case-1:A=k-1;break;case 1:k=A+1}const N=-h*this.dim,j=-p*this.dim;for(let Y=A;Y<k;Y++)for(let Q=x;Q<C;Q++)this.data[this._idx(Q,Y)]=a.data[this._idx(Q+N,Y+j)]}}function Tg(d,a){const h=a[0],p=a[1],x=a[2],C=a[3],A=Math.min(h,p,x),k=Math.round((d+C)/A);return{r:Math.floor(k*A/h)%256,g:Math.floor(k*A/p)%256,b:Math.floor(k*A/x)%256}}zn("DEMData",vd);class Sx extends oo{constructor(a){super(a,fS)}_createColorRamp(a){const h={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values["color-relief-color"].value.expression;if(p instanceof Oa&&p._styleExpression.expression instanceof ns){this.colorRampExpression=p;const A=p._styleExpression.expression;h.elevationStops=A.labels,h.colorStops=[];for(const k of h.elevationStops)h.colorStops.push(A.evaluate({globals:{elevation:k}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[vr.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=a)return h;const x={elevationStops:[],colorStops:[]},C=(h.elevationStops.length-1)/(a-1);for(let A=0;A<h.elevationStops.length-.5;A+=C)x.elevationStops.push(h.elevationStops[Math.round(A)]),x.colorStops.push(h.colorStops[Math.round(A)]);return fn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),x}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(a,h,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const x=this._createColorRamp(h),C=new xs({width:x.colorStops.length,height:1}),A=new xs({width:x.colorStops.length,height:1});for(let k=0;k<x.elevationStops.length;k++){const N=Tg(x.elevationStops[k],p);A.setPixel(0,k,new vr(N.r/255,N.g/255,N.b/255,1)),C.setPixel(0,k,x.colorStops[k])}return this.colorRampTextures={elevationTexture:new er(a,A,a.gl.RGBA),colorTexture:new er(a,C,a.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const pS=Ci([{name:"a_pos",components:2,type:"Int16"}],4),{members:Jp}=pS;function Sf(d,a,h){const p=h.patternDependencies;let x=!1;for(const C of a){const A=C.paint.get(`${d}-pattern`);A.isConstant()||(x=!0);const k=A.constantOr(null);k&&(x=!0,p[k.to]=!0,p[k.from]=!0)}return x}function Qp(d,a,h,p,x){const C=x.patternDependencies;for(const A of a){const k=A.paint.get(`${d}-pattern`).value;if(k.kind!=="constant"){let N=k.evaluate({zoom:p-1},h,{},x.availableImages),j=k.evaluate({zoom:p},h,{},x.availableImages),Y=k.evaluate({zoom:p+1},h,{},x.availableImages);N=N&&N.name?N.name:N,j=j&&j.name?j.name:j,Y=Y&&Y.name?Y.name:Y,C[N]=!0,C[j]=!0,C[Y]=!0,h.patterns[A.id]={min:N,mid:j,max:Y}}}return h}function Dy(d,a,h,p,x){let C;if(x===function(A,k,N,j){let Y=0;for(let Q=k,he=N-j;Q<N;Q+=j)Y+=(A[he]-A[Q])*(A[Q+1]+A[he+1]),he=Q;return Y}(d,a,h,p)>0)for(let A=a;A<h;A+=p)C=Jr(A/p|0,d[A],d[A+1],C);else for(let A=h-p;A>=a;A-=p)C=Jr(A/p|0,d[A],d[A+1],C);return C&&yd(C,C.next)&&(Ji(C),C=C.next),C}function nh(d,a){if(!d)return d;a||(a=d);let h,p=d;do if(h=!1,p.steiner||!yd(p,p.next)&&Bi(p.prev,p,p.next)!==0)p=p.next;else{if(Ji(p),p=a=p.prev,p===p.next)break;h=!0}while(h||p!==a);return a}function Mf(d,a,h,p,x,C,A){if(!d)return;!A&&C&&function(N,j,Y,Q){let he=N;do he.z===0&&(he.z=_a(he.x,he.y,j,Y,Q)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==N);he.prevZ.nextZ=null,he.prevZ=null,function(pe){let me,_e=1;do{let ke,Ve=pe;pe=null;let dt=null;for(me=0;Ve;){me++;let tt=Ve,de=0;for(let rt=0;rt<_e&&(de++,tt=tt.nextZ,tt);rt++);let De=_e;for(;de>0||De>0&&tt;)de!==0&&(De===0||!tt||Ve.z<=tt.z)?(ke=Ve,Ve=Ve.nextZ,de--):(ke=tt,tt=tt.nextZ,De--),dt?dt.nextZ=ke:pe=ke,ke.prevZ=dt,dt=ke;Ve=tt}dt.nextZ=null,_e*=2}while(me>1)}(he)}(d,p,x,C);let k=d;for(;d.prev!==d.next;){const N=d.prev,j=d.next;if(C?zy(d,p,x,C):ky(d))a.push(N.i,d.i,j.i),Ji(d),d=j.next,k=j.next;else if((d=j)===k){A?A===1?Mf(d=cs(nh(d),a),a,h,p,x,C,2):A===2&&bl(d,a,h,p,x,C):Mf(nh(d),a,h,p,x,C,1);break}}}function ky(d){const a=d.prev,h=d,p=d.next;if(Bi(a,h,p)>=0)return!1;const x=a.x,C=h.x,A=p.x,k=a.y,N=h.y,j=p.y,Y=Math.min(x,C,A),Q=Math.min(k,N,j),he=Math.max(x,C,A),pe=Math.max(k,N,j);let me=p.next;for(;me!==a;){if(me.x>=Y&&me.x<=he&&me.y>=Q&&me.y<=pe&&em(x,k,C,N,A,j,me.x,me.y)&&Bi(me.prev,me,me.next)>=0)return!1;me=me.next}return!0}function zy(d,a,h,p){const x=d.prev,C=d,A=d.next;if(Bi(x,C,A)>=0)return!1;const k=x.x,N=C.x,j=A.x,Y=x.y,Q=C.y,he=A.y,pe=Math.min(k,N,j),me=Math.min(Y,Q,he),_e=Math.max(k,N,j),ke=Math.max(Y,Q,he),Ve=_a(pe,me,a,h,p),dt=_a(_e,ke,a,h,p);let tt=d.prevZ,de=d.nextZ;for(;tt&&tt.z>=Ve&&de&&de.z<=dt;){if(tt.x>=pe&&tt.x<=_e&&tt.y>=me&&tt.y<=ke&&tt!==x&&tt!==A&&em(k,Y,N,Q,j,he,tt.x,tt.y)&&Bi(tt.prev,tt,tt.next)>=0||(tt=tt.prevZ,de.x>=pe&&de.x<=_e&&de.y>=me&&de.y<=ke&&de!==x&&de!==A&&em(k,Y,N,Q,j,he,de.x,de.y)&&Bi(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;tt&&tt.z>=Ve;){if(tt.x>=pe&&tt.x<=_e&&tt.y>=me&&tt.y<=ke&&tt!==x&&tt!==A&&em(k,Y,N,Q,j,he,tt.x,tt.y)&&Bi(tt.prev,tt,tt.next)>=0)return!1;tt=tt.prevZ}for(;de&&de.z<=dt;){if(de.x>=pe&&de.x<=_e&&de.y>=me&&de.y<=ke&&de!==x&&de!==A&&em(k,Y,N,Q,j,he,de.x,de.y)&&Bi(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function cs(d,a){let h=d;do{const p=h.prev,x=h.next.next;!yd(p,x)&&Oy(p,h,h.next,x)&&xd(p,x)&&xd(x,p)&&(a.push(p.i,h.i,x.i),Ji(h),Ji(h.next),h=d=x),h=h.next}while(h!==d);return nh(h)}function bl(d,a,h,p,x,C){let A=d;do{let k=A.next.next;for(;k!==A.prev;){if(A.i!==k.i&&Tx(A,k)){let N=xa(A,k);return A=nh(A,A.next),N=nh(N,N.next),Mf(A,a,h,p,x,C,0),void Mf(N,a,h,p,x,C,0)}k=k.next}A=A.next}while(A!==d)}function rh(d,a){let h=d.x-a.x;return h===0&&(h=d.y-a.y,h===0)&&(h=(d.next.y-d.y)/(d.next.x-d.x)-(a.next.y-a.y)/(a.next.x-a.x)),h}function Mx(d,a){const h=function(x,C){let A=C;const k=x.x,N=x.y;let j,Y=-1/0;if(yd(x,A))return A;do{if(yd(x,A.next))return A.next;if(N<=A.y&&N>=A.next.y&&A.next.y!==A.y){const _e=A.x+(N-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(_e<=k&&_e>Y&&(Y=_e,j=A.x<A.next.x?A:A.next,_e===k))return j}A=A.next}while(A!==C);if(!j)return null;const Q=j,he=j.x,pe=j.y;let me=1/0;A=j;do{if(k>=A.x&&A.x>=he&&k!==A.x&&wl(N<pe?k:Y,N,he,pe,N<pe?Y:k,N,A.x,A.y)){const _e=Math.abs(N-A.y)/(k-A.x);xd(A,x)&&(_e<me||_e===me&&(A.x>j.x||A.x===j.x&&Cx(j,A)))&&(j=A,me=_e)}A=A.next}while(A!==Q);return j}(d,a);if(!h)return a;const p=xa(h,d);return nh(p,p.next),nh(h,h.next)}function Cx(d,a){return Bi(d.prev,d,a.prev)<0&&Bi(a.next,d,d.next)<0}function _a(d,a,h,p,x){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-h)*x|0)|d<<8))|d<<4))|d<<2))|d<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-p)*x|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function Ex(d){let a=d,h=d;do(a.x<h.x||a.x===h.x&&a.y<h.y)&&(h=a),a=a.next;while(a!==d);return h}function wl(d,a,h,p,x,C,A,k){return(x-A)*(a-k)>=(d-A)*(C-k)&&(d-A)*(p-k)>=(h-A)*(a-k)&&(h-A)*(C-k)>=(x-A)*(p-k)}function em(d,a,h,p,x,C,A,k){return!(d===A&&a===k)&&wl(d,a,h,p,x,C,A,k)}function Tx(d,a){return d.next.i!==a.i&&d.prev.i!==a.i&&!function(h,p){let x=h;do{if(x.i!==h.i&&x.next.i!==h.i&&x.i!==p.i&&x.next.i!==p.i&&Oy(x,x.next,h,p))return!0;x=x.next}while(x!==h);return!1}(d,a)&&(xd(d,a)&&xd(a,d)&&function(h,p){let x=h,C=!1;const A=(h.x+p.x)/2,k=(h.y+p.y)/2;do x.y>k!=x.next.y>k&&x.next.y!==x.y&&A<(x.next.x-x.x)*(k-x.y)/(x.next.y-x.y)+x.x&&(C=!C),x=x.next;while(x!==h);return C}(d,a)&&(Bi(d.prev,d,a.prev)||Bi(d,a.prev,a))||yd(d,a)&&Bi(d.prev,d,d.next)>0&&Bi(a.prev,a,a.next)>0)}function Bi(d,a,h){return(a.y-d.y)*(h.x-a.x)-(a.x-d.x)*(h.y-a.y)}function yd(d,a){return d.x===a.x&&d.y===a.y}function Oy(d,a,h,p){const x=_d(Bi(d,a,h)),C=_d(Bi(d,a,p)),A=_d(Bi(h,p,d)),k=_d(Bi(h,p,a));return x!==C&&A!==k||!(x!==0||!Pg(d,h,a))||!(C!==0||!Pg(d,p,a))||!(A!==0||!Pg(h,d,p))||!(k!==0||!Pg(h,a,p))}function Pg(d,a,h){return a.x<=Math.max(d.x,h.x)&&a.x>=Math.min(d.x,h.x)&&a.y<=Math.max(d.y,h.y)&&a.y>=Math.min(d.y,h.y)}function _d(d){return d>0?1:d<0?-1:0}function xd(d,a){return Bi(d.prev,d,d.next)<0?Bi(d,a,d.next)>=0&&Bi(d,d.prev,a)>=0:Bi(d,a,d.prev)<0||Bi(d,d.next,a)<0}function xa(d,a){const h=Qi(d.i,d.x,d.y),p=Qi(a.i,a.x,a.y),x=d.next,C=a.prev;return d.next=a,a.prev=d,h.next=x,x.prev=h,p.next=h,h.prev=p,C.next=p,p.prev=C,p}function Jr(d,a,h,p){const x=Qi(d,a,h);return p?(x.next=p.next,x.prev=p,p.next.prev=x,p.next=x):(x.prev=x,x.next=x),x}function Ji(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function Qi(d,a,h){return{i:d,x:a,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class eo{constructor(a,h){if(h>a)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=a,this._minGranularity=h}getGranularityForZoomLevel(a){return Math.max(Math.floor(this._baseZoomGranularity/(1<<a)),this._minGranularity,1)}}class ws{constructor(a){this.fill=a.fill,this.line=a.line,this.tile=a.tile,this.stencil=a.stencil,this.circle=a.circle}}ws.noSubdivision=new ws({fill:new eo(0,0),line:new eo(0,0),tile:new eo(0,0),stencil:new eo(0,0),circle:1}),zn("SubdivisionGranularityExpression",eo),zn("SubdivisionGranularitySetting",ws);const Sl=-32768,Gi=32767;class tm{constructor(a,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=a,this._granularityCellSize=Qe/a,this._canonical=h}_getKey(a,h){return(a+=32768)<<16|h+32768}_vertexToIndex(a,h){if(a<-32768||h<-32768||a>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const p=0|Math.round(a),x=0|Math.round(h),C=this._getKey(p,x);if(this._vertexDictionary.has(C))return this._vertexDictionary.get(C);const A=this._vertexBuffer.length/2;return this._vertexDictionary.set(C,A),this._vertexBuffer.push(p,x),A}_subdivideTrianglesScanline(a){if(this._granularity<2)return function(x,C){const A=[];for(let k=0;k<C.length;k+=3){const N=C[k],j=C[k+1],Y=C[k+2],Q=x[2*N],he=x[2*N+1];(x[2*j]-Q)*(x[2*Y+1]-he)-(x[2*j+1]-he)*(x[2*Y]-Q)>0?(A.push(N),A.push(Y),A.push(j)):(A.push(N),A.push(j),A.push(Y))}return A}(this._vertexBuffer,a);const h=[],p=a.length;for(let x=0;x<p;x+=3){const C=[a[x+0],a[x+1],a[x+2]],A=[this._vertexBuffer[2*a[x+0]+0],this._vertexBuffer[2*a[x+0]+1],this._vertexBuffer[2*a[x+1]+0],this._vertexBuffer[2*a[x+1]+1],this._vertexBuffer[2*a[x+2]+0],this._vertexBuffer[2*a[x+2]+1]];let k=1/0,N=1/0,j=-1/0,Y=-1/0;for(let _e=0;_e<3;_e++){const ke=A[2*_e],Ve=A[2*_e+1];k=Math.min(k,ke),j=Math.max(j,ke),N=Math.min(N,Ve),Y=Math.max(Y,Ve)}if(k===j||N===Y)continue;const Q=Math.floor(k/this._granularityCellSize),he=Math.ceil(j/this._granularityCellSize),pe=Math.floor(N/this._granularityCellSize),me=Math.ceil(Y/this._granularityCellSize);if(Q!==he||pe!==me)for(let _e=pe;_e<me;_e++){const ke=this._scanlineGenerateVertexRingForCellRow(_e,A,C);Fy(this._vertexBuffer,ke,h)}else h.push(...C)}return h}_scanlineGenerateVertexRingForCellRow(a,h,p){const x=a*this._granularityCellSize,C=x+this._granularityCellSize,A=[];for(let k=0;k<3;k++){const N=h[2*k],j=h[2*k+1],Y=h[2*(k+1)%6],Q=h[(2*(k+1)+1)%6],he=h[2*(k+2)%6],pe=h[(2*(k+2)+1)%6],me=Y-N,_e=Q-j,ke=me===0,Ve=_e===0,dt=(x-j)/_e,tt=(C-j)/_e,de=Math.min(dt,tt),De=Math.max(dt,tt);if(!Ve&&(de>=1||De<=0)||Ve&&(j<x||j>C)){Q>=x&&Q<=C&&A.push(p[(k+1)%3]);continue}!Ve&&de>0&&A.push(this._vertexToIndex(N+me*de,j+_e*de));const rt=N+me*Math.max(de,0),Rt=N+me*Math.min(De,1);ke||this._generateIntraEdgeVertices(A,N,j,Y,Q,rt,Rt),!Ve&&De<1&&A.push(this._vertexToIndex(N+me*De,j+_e*De)),(Ve||Q>=x&&Q<=C)&&A.push(p[(k+1)%3]),!Ve&&(Q<=x||Q>=C)&&this._generateInterEdgeVertices(A,N,j,Y,Q,he,pe,Rt,x,C)}return A}_generateIntraEdgeVertices(a,h,p,x,C,A,k){const N=x-h,j=C-p,Y=j===0,Q=Y?Math.min(h,x):Math.min(A,k),he=Y?Math.max(h,x):Math.max(A,k),pe=Math.floor(Q/this._granularityCellSize)+1,me=Math.ceil(he/this._granularityCellSize)-1;if(Y?h<x:A<k)for(let _e=pe;_e<=me;_e++){const ke=_e*this._granularityCellSize;a.push(this._vertexToIndex(ke,p+j*(ke-h)/N))}else for(let _e=me;_e>=pe;_e--){const ke=_e*this._granularityCellSize;a.push(this._vertexToIndex(ke,p+j*(ke-h)/N))}}_generateInterEdgeVertices(a,h,p,x,C,A,k,N,j,Y){const Q=C-p,he=A-x,pe=k-C,me=(j-C)/pe,_e=(Y-C)/pe,ke=Math.min(me,_e),Ve=Math.max(me,_e),dt=x+he*ke;let tt=Math.floor(Math.min(dt,N)/this._granularityCellSize)+1,de=Math.ceil(Math.max(dt,N)/this._granularityCellSize)-1,De=N<dt;const rt=pe===0;if(rt&&(k===j||k===Y))return;if(rt||ke>=1||Ve<=0){const sn=p-k,Ft=A+(h-A)*Math.min((j-k)/sn,(Y-k)/sn);tt=Math.floor(Math.min(Ft,N)/this._granularityCellSize)+1,de=Math.ceil(Math.max(Ft,N)/this._granularityCellSize)-1,De=N<Ft}const Rt=Q>0?Y:j;if(De)for(let sn=tt;sn<=de;sn++)a.push(this._vertexToIndex(sn*this._granularityCellSize,Rt));else for(let sn=de;sn>=tt;sn--)a.push(this._vertexToIndex(sn*this._granularityCellSize,Rt))}_generateOutline(a){const h=[];for(const p of a){const x=vc(p,this._granularity,!0),C=this._pointArrayToIndices(x),A=[];for(let k=1;k<C.length;k++)A.push(C[k-1]),A.push(C[k]);h.push(A)}return h}_handlePoles(a){let h=!1,p=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(h||p)&&this._fillPoles(a,h,p)}_ensureNoPoleVertices(){const a=this._vertexBuffer;for(let h=0;h<a.length;h+=2){const p=a[h+1];p===Sl&&(a[h+1]=-32767),p===Gi&&(a[h+1]=32766)}}_generatePoleQuad(a,h,p,x,C,A){x>C!=(A===Sl)?(a.push(h),a.push(p),a.push(this._vertexToIndex(x,A)),a.push(p),a.push(this._vertexToIndex(C,A)),a.push(this._vertexToIndex(x,A))):(a.push(p),a.push(h),a.push(this._vertexToIndex(x,A)),a.push(this._vertexToIndex(C,A)),a.push(p),a.push(this._vertexToIndex(x,A)))}_fillPoles(a,h,p){const x=this._vertexBuffer,C=Qe,A=a.length;for(let k=2;k<A;k+=3){const N=a[k-2],j=a[k-1],Y=a[k],Q=x[2*N],he=x[2*N+1],pe=x[2*j],me=x[2*j+1],_e=x[2*Y],ke=x[2*Y+1];h&&(he===0&&me===0&&this._generatePoleQuad(a,N,j,Q,pe,Sl),me===0&&ke===0&&this._generatePoleQuad(a,j,Y,pe,_e,Sl),ke===0&&he===0&&this._generatePoleQuad(a,Y,N,_e,Q,Sl)),p&&(he===C&&me===C&&this._generatePoleQuad(a,N,j,Q,pe,Gi),me===C&&ke===C&&this._generatePoleQuad(a,j,Y,pe,_e,Gi),ke===C&&he===C&&this._generatePoleQuad(a,Y,N,_e,Q,Gi))}}_initializeVertices(a){for(let h=0;h<a.length;h+=2)this._vertexToIndex(a[h],a[h+1])}subdividePolygonInternal(a,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:p,holeIndices:x}=function(k){const N=[],j=[];for(const Y of k)if(Y.length!==0){Y!==k[0]&&N.push(j.length/2);for(let Q=0;Q<Y.length;Q++)j.push(Y[Q].x),j.push(Y[Q].y)}return{flattened:j,holeIndices:N}}(a);let C;this._initializeVertices(p);try{const k=function(j,Y,Q=2){const he=Y&&Y.length,pe=he?Y[0]*Q:j.length;let me=Dy(j,0,pe,Q,!0);const _e=[];if(!me||me.next===me.prev)return _e;let ke,Ve,dt;if(he&&(me=function(tt,de,De,rt){const Rt=[];for(let sn=0,Ft=de.length;sn<Ft;sn++){const Vt=Dy(tt,de[sn]*rt,sn<Ft-1?de[sn+1]*rt:tt.length,rt,!1);Vt===Vt.next&&(Vt.steiner=!0),Rt.push(Ex(Vt))}Rt.sort(rh);for(let sn=0;sn<Rt.length;sn++)De=Mx(Rt[sn],De);return De}(j,Y,me,Q)),j.length>80*Q){ke=1/0,Ve=1/0;let tt=-1/0,de=-1/0;for(let De=Q;De<pe;De+=Q){const rt=j[De],Rt=j[De+1];rt<ke&&(ke=rt),Rt<Ve&&(Ve=Rt),rt>tt&&(tt=rt),Rt>de&&(de=Rt)}dt=Math.max(tt-ke,de-Ve),dt=dt!==0?32767/dt:0}return Mf(me,_e,Q,ke,Ve,dt,0),_e}(p,x),N=this._convertIndices(p,k);C=this._subdivideTrianglesScanline(N)}catch(k){console.error(k)}let A=[];return h&&(A=this._generateOutline(a)),this._ensureNoPoleVertices(),this._handlePoles(C),{verticesFlattened:this._vertexBuffer,indicesTriangles:C,indicesLineList:A}}_convertIndices(a,h){const p=[];for(let x=0;x<h.length;x++)p.push(this._vertexToIndex(a[2*h[x]],a[2*h[x]+1]));return p}_pointArrayToIndices(a){const h=[];for(let p=0;p<a.length;p++){const x=a[p];h.push(this._vertexToIndex(x.x,x.y))}return h}}function ih(d,a,h,p=!0){return new tm(h,a).subdividePolygonInternal(d,p)}function vc(d,a,h=!1){if(!d||d.length<1)return[];if(d.length<2)return[];const p=d[0],x=d[d.length-1],C=h&&(p.x!==x.x||p.y!==x.y);if(a<2)return C?[...d,d[0]]:[...d];const A=Math.floor(Qe/a),k=[];k.push(new R(d[0].x,d[0].y));const N=d.length,j=C?N:N-1;for(let Y=0;Y<j;Y++){const Q=d[Y],he=Y<N-1?d[Y+1]:d[0],pe=Q.x,me=Q.y,_e=he.x,ke=he.y,Ve=pe!==_e,dt=me!==ke;if(!Ve&&!dt)continue;const tt=_e-pe,de=ke-me,De=Math.abs(tt),rt=Math.abs(de);let Rt=pe,sn=me;for(;;){const Vt=tt>0?(Math.floor(Rt/A)+1)*A:(Math.ceil(Rt/A)-1)*A,gn=de>0?(Math.floor(sn/A)+1)*A:(Math.ceil(sn/A)-1)*A,an=Math.abs(Rt-Vt),xn=Math.abs(sn-gn),Xt=Math.abs(Rt-_e),Hn=Math.abs(sn-ke),hr=Ve?an/De:Number.POSITIVE_INFINITY,lr=dt?xn/rt:Number.POSITIVE_INFINITY;if((Xt<=an||!Ve)&&(Hn<=xn||!dt))break;if(hr<lr&&Ve||!dt){Rt=Vt,sn+=de*hr;const Jn=new R(Rt,Math.round(sn));k[k.length-1].x===Jn.x&&k[k.length-1].y===Jn.y||k.push(Jn)}else{Rt+=tt*lr,sn=gn;const Jn=new R(Math.round(Rt),sn);k[k.length-1].x===Jn.x&&k[k.length-1].y===Jn.y||k.push(Jn)}}const Ft=new R(_e,ke);k[k.length-1].x===Ft.x&&k[k.length-1].y===Ft.y||k.push(Ft)}return k}function Fy(d,a,h){if(a.length===0)throw new Error("Subdivision vertex ring is empty.");let p=0,x=d[2*a[0]];for(let N=1;N<a.length;N++){const j=d[2*a[N]];j<x&&(x=j,p=N)}const C=a.length;let A=p,k=(A+1)%C;for(;;){const N=A-1>=0?A-1:C-1,j=(k+1)%C,Y=d[2*a[N]],Q=d[2*a[j]],he=d[2*a[A]],pe=d[2*a[A]+1],me=d[2*a[k]+1];let _e=!1;if(Y<Q)_e=!0;else if(Y>Q)_e=!1;else{const ke=me-pe,Ve=-(d[2*a[k]]-he),dt=pe<me?1:-1;((Y-he)*ke+(d[2*a[N]+1]-pe)*Ve)*dt>((Q-he)*ke+(d[2*a[j]+1]-pe)*Ve)*dt&&(_e=!0)}if(_e){const ke=a[N],Ve=a[A],dt=a[k];ke!==Ve&&ke!==dt&&Ve!==dt&&h.push(dt,Ve,ke),A--,A<0&&(A=C-1)}else{const ke=a[j],Ve=a[A],dt=a[k];ke!==Ve&&ke!==dt&&Ve!==dt&&h.push(dt,Ve,ke),k++,k>=C&&(k=0)}if(N===j)break}}function Cf(d,a,h,p,x,C,A,k,N){const j=x.length/2,Y=A&&k&&N;if(j<Ar.MAX_VERTEX_ARRAY_LENGTH){const Q=a.prepareSegment(j,h,p),he=Q.vertexLength;for(let _e=0;_e<C.length;_e+=3)p.emplaceBack(he+C[_e],he+C[_e+1],he+C[_e+2]);let pe,me;Q.vertexLength+=j,Q.primitiveLength+=C.length/3,Y&&(me=A.prepareSegment(j,h,k),pe=me.vertexLength,me.vertexLength+=j);for(let _e=0;_e<x.length;_e+=2)d(x[_e],x[_e+1]);if(Y)for(let _e=0;_e<N.length;_e++){const ke=N[_e];for(let Ve=1;Ve<ke.length;Ve+=2)k.emplaceBack(pe+ke[Ve-1],pe+ke[Ve]);me.primitiveLength+=ke.length/2}}else(function(Q,he,pe,me,_e,ke){const Ve=[];for(let rt=0;rt<me.length/2;rt++)Ve.push(-1);const dt={count:0};let tt=0,de=Q.getOrCreateLatestSegment(he,pe),De=de.vertexLength;for(let rt=2;rt<_e.length;rt+=3){const Rt=_e[rt-2],sn=_e[rt-1],Ft=_e[rt];let Vt=Ve[Rt]<tt,gn=Ve[sn]<tt,an=Ve[Ft]<tt;de.vertexLength+((Vt?1:0)+(gn?1:0)+(an?1:0))>Ar.MAX_VERTEX_ARRAY_LENGTH&&(de=Q.createNewSegment(he,pe),tt=dt.count,Vt=!0,gn=!0,an=!0,De=0);const xn=Ho(Ve,me,ke,dt,Rt,Vt,de),Xt=Ho(Ve,me,ke,dt,sn,gn,de),Hn=Ho(Ve,me,ke,dt,Ft,an,de);pe.emplaceBack(De+xn-tt,De+Xt-tt,De+Hn-tt),de.primitiveLength++}})(a,h,p,x,C,d),Y&&function(Q,he,pe,me,_e,ke){const Ve=[];for(let rt=0;rt<me.length/2;rt++)Ve.push(-1);const dt={count:0};let tt=0,de=Q.getOrCreateLatestSegment(he,pe),De=de.vertexLength;for(let rt=0;rt<_e.length;rt++){const Rt=_e[rt];for(let sn=1;sn<_e[rt].length;sn+=2){const Ft=Rt[sn-1],Vt=Rt[sn];let gn=Ve[Ft]<tt,an=Ve[Vt]<tt;de.vertexLength+((gn?1:0)+(an?1:0))>Ar.MAX_VERTEX_ARRAY_LENGTH&&(de=Q.createNewSegment(he,pe),tt=dt.count,gn=!0,an=!0,De=0);const xn=Ho(Ve,me,ke,dt,Ft,gn,de),Xt=Ho(Ve,me,ke,dt,Vt,an,de);pe.emplaceBack(De+xn-tt,De+Xt-tt),de.primitiveLength++}}}(A,h,k,x,N,d),a.forceNewSegmentOnNextPrepare(),A?.forceNewSegmentOnNextPrepare()}function Ho(d,a,h,p,x,C,A){if(C){const k=p.count;return h(a[2*x],a[2*x+1]),d[x]=p.count,p.count++,A.vertexLength++,k}return d[x]}class nm{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Dt,this.indexArray=new ai,this.indexArray2=new Kr,this.programConfigurations=new Ns(a.layers,a.zoom),this.segments=new Ar,this.segments2=new Ar,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,p){this.hasPattern=Sf("fill",this.layers,h);const x=this.layers[0].layout.get("fill-sort-key"),C=!x.isConstant(),A=[];for(const{feature:k,id:N,index:j,sourceLayerIndex:Y}of a){const Q=this.layers[0]._featureFilter.needGeometry,he=eh(k,Q);if(!this.layers[0]._featureFilter.filter(new si(this.zoom,{globalState:this.globalState}),he,p))continue;const pe=C?x.evaluate(he,{},p,h.availableImages):void 0,me={id:N,properties:k.properties,type:k.type,sourceLayerIndex:Y,index:j,geometry:Q?he.geometry:Qu(k),patterns:{},sortKey:pe};A.push(me)}C&&A.sort((k,N)=>k.sortKey-N.sortKey);for(const k of A){const{geometry:N,index:j,sourceLayerIndex:Y}=k;if(this.hasPattern){const Q=Qp("fill",this.layers,k,this.zoom,h);this.patternFeatures.push(Q)}else this.addFeature(k,N,j,p,{},h.subdivisionGranularity);h.featureIndex.insert(a[j].feature,N,j,Y,this.index)}}update(a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,p)}addFeatures(a,h,p){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,h,p,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Jp),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,h,p,x,C,A){for(const k of Ql(h,500)){const N=ih(k,x,A.fill.getGranularityForZoomLevel(x.z)),j=this.layoutVertexArray;Cf((Y,Q)=>{j.emplaceBack(Y,Q)},this.segments,this.layoutVertexArray,this.indexArray,N.verticesFlattened,N.indicesTriangles,this.segments2,this.indexArray2,N.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,C,x)}}let bd,yc;zn("FillBucket",nm,{omit:["layers","patternFeatures"]});var Ag={get paint(){return yc=yc||new gi({"fill-antialias":new $n(We.paint_fill["fill-antialias"]),"fill-opacity":new ar(We.paint_fill["fill-opacity"]),"fill-color":new ar(We.paint_fill["fill-color"]),"fill-outline-color":new ar(We.paint_fill["fill-outline-color"]),"fill-translate":new $n(We.paint_fill["fill-translate"]),"fill-translate-anchor":new $n(We.paint_fill["fill-translate-anchor"]),"fill-pattern":new qu(We.paint_fill["fill-pattern"])})},get layout(){return bd=bd||new gi({"fill-sort-key":new ar(We.layout_fill["fill-sort-key"])})}};class Ny extends oo{constructor(a){super(a,Ag)}recalculate(a,h){super.recalculate(a,h);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new nm(a)}queryRadius(){return bf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:a,geometry:h,transform:p,pixelsToTileUnits:x}){return Ty(wf(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-p.bearingInRadians,x),h)}isTileClipped(){return!0}}const oh=Ci([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ig=Ci([{name:"a_centroid",components:2,type:"Int16"}],4),{members:sh}=oh;var Ef,Tf,rm,im,Pf,Ss,ru,na={};function $s(){if(Tf)return Ef;Tf=1;var d=w();function a(x,C,A,k,N){this.properties={},this.extent=A,this.type=0,this._pbf=x,this._geometry=-1,this._keys=k,this._values=N,x.readFields(h,this,C)}function h(x,C,A){x==1?C.id=A.readVarint():x==2?function(k,N){for(var j=k.readVarint()+k.pos;k.pos<j;){var Y=N._keys[k.readVarint()],Q=N._values[k.readVarint()];N.properties[Y]=Q}}(A,C):x==3?C.type=A.readVarint():x==4&&(C._geometry=A.pos)}function p(x){for(var C,A,k=0,N=0,j=x.length,Y=j-1;N<j;Y=N++)k+=((A=x[Y]).x-(C=x[N]).x)*(C.y+A.y);return k}return Ef=a,a.types=["Unknown","Point","LineString","Polygon"],a.prototype.loadGeometry=function(){var x=this._pbf;x.pos=this._geometry;for(var C,A=x.readVarint()+x.pos,k=1,N=0,j=0,Y=0,Q=[];x.pos<A;){if(N<=0){var he=x.readVarint();k=7&he,N=he>>3}if(N--,k===1||k===2)j+=x.readSVarint(),Y+=x.readSVarint(),k===1&&(C&&Q.push(C),C=[]),C.push(new d(j,Y));else{if(k!==7)throw new Error("unknown command "+k);C&&C.push(C[0].clone())}}return C&&Q.push(C),Q},a.prototype.bbox=function(){var x=this._pbf;x.pos=this._geometry;for(var C=x.readVarint()+x.pos,A=1,k=0,N=0,j=0,Y=1/0,Q=-1/0,he=1/0,pe=-1/0;x.pos<C;){if(k<=0){var me=x.readVarint();A=7&me,k=me>>3}if(k--,A===1||A===2)(N+=x.readSVarint())<Y&&(Y=N),N>Q&&(Q=N),(j+=x.readSVarint())<he&&(he=j),j>pe&&(pe=j);else if(A!==7)throw new Error("unknown command "+A)}return[Y,he,Q,pe]},a.prototype.toGeoJSON=function(x,C,A){var k,N,j=this.extent*Math.pow(2,A),Y=this.extent*x,Q=this.extent*C,he=this.loadGeometry(),pe=a.types[this.type];function me(Ve){for(var dt=0;dt<Ve.length;dt++){var tt=Ve[dt];Ve[dt]=[360*(tt.x+Y)/j-180,360/Math.PI*Math.atan(Math.exp((180-360*(tt.y+Q)/j)*Math.PI/180))-90]}}switch(this.type){case 1:var _e=[];for(k=0;k<he.length;k++)_e[k]=he[k][0];me(he=_e);break;case 2:for(k=0;k<he.length;k++)me(he[k]);break;case 3:for(he=function(Ve){var dt=Ve.length;if(dt<=1)return[Ve];for(var tt,de,De=[],rt=0;rt<dt;rt++){var Rt=p(Ve[rt]);Rt!==0&&(de===void 0&&(de=Rt<0),de===Rt<0?(tt&&De.push(tt),tt=[Ve[rt]]):tt.push(Ve[rt]))}return tt&&De.push(tt),De}(he),k=0;k<he.length;k++)for(N=0;N<he[k].length;N++)me(he[k][N])}he.length===1?he=he[0]:pe="Multi"+pe;var ke={type:"Feature",geometry:{type:pe,coordinates:he},properties:this.properties};return"id"in this&&(ke.id=this.id),ke},Ef}function By(){if(im)return rm;im=1;var d=$s();function a(p,x){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(h,this,x),this.length=this._features.length}function h(p,x,C){p===15?x.version=C.readVarint():p===1?x.name=C.readString():p===5?x.extent=C.readVarint():p===2?x._features.push(C.pos):p===3?x._keys.push(C.readString()):p===4&&x._values.push(function(A){for(var k=null,N=A.readVarint()+A.pos;A.pos<N;){var j=A.readVarint()>>3;k=j===1?A.readString():j===2?A.readFloat():j===3?A.readDouble():j===4?A.readVarint64():j===5?A.readVarint():j===6?A.readSVarint():j===7?A.readBoolean():null}return k}(C))}return rm=a,a.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var x=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,x,this.extent,this._keys,this._values)},rm}function Rg(){return ru||(ru=1,na.VectorTile=function(){if(Ss)return Pf;Ss=1;var d=By();function a(h,p,x){if(h===3){var C=new d(x,x.readVarint()+x.pos);C.length&&(p[C.name]=C)}}return Pf=function(h,p){this.layers=h.readFields(a,{},p)},Pf}(),na.VectorTileFeature=$s(),na.VectorTileLayer=By()),na}var wd=m(Rg());const mS=wd.VectorTileFeature.types,_c=Math.pow(2,13);function Af(d,a,h,p,x,C,A,k){d.emplaceBack(a,h,2*Math.floor(p*_c)+A,x*_c*2,C*_c*2,Math.round(k))}class om{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Sn,this.centroidVertexArray=new Mt,this.indexArray=new ai,this.programConfigurations=new Ns(a.layers,a.zoom),this.segments=new Ar,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,p){this.features=[],this.hasPattern=Sf("fill-extrusion",this.layers,h);for(const{feature:x,id:C,index:A,sourceLayerIndex:k}of a){const N=this.layers[0]._featureFilter.needGeometry,j=eh(x,N);if(!this.layers[0]._featureFilter.filter(new si(this.zoom,{globalState:this.globalState}),j,p))continue;const Y={id:C,sourceLayerIndex:k,index:A,geometry:N?j.geometry:Qu(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(Qp("fill-extrusion",this.layers,Y,this.zoom,h)):this.addFeature(Y,Y.geometry,A,p,{},h.subdivisionGranularity),h.featureIndex.insert(x,Y.geometry,A,k,this.index,!0)}}addFeatures(a,h,p){for(const x of this.features){const{geometry:C}=x;this.addFeature(x,C,x.index,h,p,a.subdivisionGranularity)}}update(a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,sh),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,Ig.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,h,p,x,C,A){for(const k of Ql(h,500)){const N={x:0,y:0,sampleCount:0},j=this.layoutVertexArray.length;this.processPolygon(N,x,a,k,A);const Y=this.layoutVertexArray.length-j,Q=Math.floor(N.x/N.sampleCount),he=Math.floor(N.y/N.sampleCount);for(let pe=0;pe<Y;pe++)this.centroidVertexArray.emplaceBack(Q,he)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,C,x)}processPolygon(a,h,p,x,C){if(x.length<1||ah(x[0]))return;for(const Q of x)Q.length!==0&&Sd(a,Q);const A={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},k=C.fill.getGranularityForZoomLevel(h.z),N=mS[p.type]==="Polygon";for(const Q of x){if(Q.length===0||ah(Q))continue;const he=vc(Q,k,N);this._generateSideFaces(he,A)}if(!N)return;const j=ih(x,h,k,!1),Y=this.layoutVertexArray;Cf((Q,he)=>{Af(Y,Q,he,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,j.verticesFlattened,j.indicesTriangles)}_generateSideFaces(a,h){let p=0;for(let x=1;x<a.length;x++){const C=a[x],A=a[x-1];if(Uy(C,A))continue;h.segment.vertexLength+4>Ar.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const k=C.sub(A)._perp()._unit(),N=A.dist(C);p+N>32768&&(p=0),Af(this.layoutVertexArray,C.x,C.y,k.x,k.y,0,0,p),Af(this.layoutVertexArray,C.x,C.y,k.x,k.y,0,1,p),p+=N,Af(this.layoutVertexArray,A.x,A.y,k.x,k.y,0,0,p),Af(this.layoutVertexArray,A.x,A.y,k.x,k.y,0,1,p);const j=h.segment.vertexLength;this.indexArray.emplaceBack(j,j+2,j+1),this.indexArray.emplaceBack(j+1,j+2,j+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function Sd(d,a){for(let h=0;h<a.length;h++){const p=a[h];h===a.length-1&&a[0].x===p.x&&a[0].y===p.y||(d.x+=p.x,d.y+=p.y,d.sampleCount++)}}function Uy(d,a){return d.x===a.x&&(d.x<0||d.x>Qe)||d.y===a.y&&(d.y<0||d.y>Qe)}function ah(d){return d.every(a=>a.x<0)||d.every(a=>a.x>Qe)||d.every(a=>a.y<0)||d.every(a=>a.y>Qe)}let $y;zn("FillExtrusionBucket",om,{omit:["layers","features"]});var Px={get paint(){return $y=$y||new gi({"fill-extrusion-opacity":new $n(We["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ar(We["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new $n(We["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new $n(We["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qu(We["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ar(We["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ar(We["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new $n(We["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Vy extends oo{constructor(a){super(a,Px)}createBucket(a){return new om(a)}queryRadius(){return bf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:a,feature:h,featureState:p,geometry:x,transform:C,pixelsToTileUnits:A,pixelPosMatrix:k}){const N=wf(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-C.bearingInRadians,A),j=this.paint.get("fill-extrusion-height").evaluate(h,p),Y=this.paint.get("fill-extrusion-base").evaluate(h,p),Q=function(pe,me){const _e=[];for(const ke of pe){const Ve=[ke.x,ke.y,0,1];Te(Ve,Ve,me),_e.push(new R(Ve[0]/Ve[3],Ve[1]/Ve[3]))}return _e}(N,k),he=function(pe,me,_e,ke){const Ve=[],dt=[],tt=ke[8]*me,de=ke[9]*me,De=ke[10]*me,rt=ke[11]*me,Rt=ke[8]*_e,sn=ke[9]*_e,Ft=ke[10]*_e,Vt=ke[11]*_e;for(const gn of pe){const an=[],xn=[];for(const Xt of gn){const Hn=Xt.x,hr=Xt.y,lr=ke[0]*Hn+ke[4]*hr+ke[12],Jn=ke[1]*Hn+ke[5]*hr+ke[13],Dr=ke[2]*Hn+ke[6]*hr+ke[14],qi=ke[3]*Hn+ke[7]*hr+ke[15],Ro=Dr+De,Cs=qi+rt,El=lr+Rt,ba=Jn+sn,us=Dr+Ft,$i=qi+Vt,Go=new R((lr+tt)/Cs,(Jn+de)/Cs);Go.z=Ro/Cs,an.push(Go);const hs=new R(El/$i,ba/$i);hs.z=us/$i,xn.push(hs)}Ve.push(an),dt.push(xn)}return[Ve,dt]}(x,Y,j,k);return function(pe,me,_e){let ke=1/0;Ty(_e,me)&&(ke=Ax(_e,me[0]));for(let Ve=0;Ve<me.length;Ve++){const dt=me[Ve],tt=pe[Ve];for(let de=0;de<dt.length-1;de++){const De=dt[de],rt=[De,dt[de+1],tt[de+1],tt[de],De];Bs(_e,rt)&&(ke=Math.min(ke,Ax(_e,rt)))}}return ke!==1/0&&ke}(he[0],he[1],Q)}}function lh(d,a){return d.x*a.x+d.y*a.y}function Ax(d,a){if(d.length===1){let h=0;const p=a[h++];let x;for(;!x||p.equals(x);)if(x=a[h++],!x)return 1/0;for(;h<a.length;h++){const C=a[h],A=d[0],k=x.sub(p),N=C.sub(p),j=A.sub(p),Y=lh(k,k),Q=lh(k,N),he=lh(N,N),pe=lh(j,k),me=lh(j,N),_e=Y*he-Q*Q,ke=(he*pe-Q*me)/_e,Ve=(Y*me-Q*pe)/_e,dt=p.z*(1-ke-Ve)+x.z*ke+C.z*Ve;if(isFinite(dt))return dt}return 1/0}{let h=1/0;for(const p of a)h=Math.min(h,p.z);return h}}const gS=Ci([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ix}=gS,Rx=Ci([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Md}=Rx,vS=wd.VectorTileFeature.types,If=Math.cos(Math.PI/180*37.5),jy=Math.pow(2,14)/.5;class Ui{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new wn,this.layoutVertexArray2=new nn,this.indexArray=new ai,this.programConfigurations=new Ns(a.layers,a.zoom),this.segments=new Ar,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,p){this.hasPattern=Sf("line",this.layers,h);const x=this.layers[0].layout.get("line-sort-key"),C=!x.isConstant(),A=[];for(const{feature:k,id:N,index:j,sourceLayerIndex:Y}of a){const Q=this.layers[0]._featureFilter.needGeometry,he=eh(k,Q);if(!this.layers[0]._featureFilter.filter(new si(this.zoom,{globalState:this.globalState}),he,p))continue;const pe=C?x.evaluate(he,{},p):void 0,me={id:N,properties:k.properties,type:k.type,sourceLayerIndex:Y,index:j,geometry:Q?he.geometry:Qu(k),patterns:{},sortKey:pe};A.push(me)}C&&A.sort((k,N)=>k.sortKey-N.sortKey);for(const k of A){const{geometry:N,index:j,sourceLayerIndex:Y}=k;if(this.hasPattern){const Q=Qp("line",this.layers,k,this.zoom,h);this.patternFeatures.push(Q)}else this.addFeature(k,N,j,p,{},h.subdivisionGranularity);h.featureIndex.insert(a[j].feature,N,j,Y,this.index)}}update(a,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,p)}addFeatures(a,h,p){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,h,p,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Md)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ix),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,h,p,x,C,A){const k=this.layers[0].layout,N=k.get("line-join").evaluate(a,{}),j=k.get("line-cap"),Y=k.get("line-miter-limit"),Q=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const he of h)this.addLine(he,a,N,j,Y,Q,x,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,C,x)}addLine(a,h,p,x,C,A,k,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,a=vc(a,k?N.line.getGranularityForZoomLevel(k.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let tt=0;tt<a.length-1;tt++)this.totalDistance+=a[tt].dist(a[tt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=vS[h.type]==="Polygon";let Y=a.length;for(;Y>=2&&a[Y-1].equals(a[Y-2]);)Y--;let Q=0;for(;Q<Y-1&&a[Q].equals(a[Q+1]);)Q++;if(Y<(j?3:2))return;p==="bevel"&&(C=1.05);const he=this.overscaling<=16?122880/(512*this.overscaling):0,pe=this.segments.prepareSegment(10*Y,this.layoutVertexArray,this.indexArray);let me,_e,ke,Ve,dt;this.e1=this.e2=-1,j&&(me=a[Y-2],dt=a[Q].sub(me)._unit()._perp());for(let tt=Q;tt<Y;tt++){if(ke=tt===Y-1?j?a[Q+1]:void 0:a[tt+1],ke&&a[tt].equals(ke))continue;dt&&(Ve=dt),me&&(_e=me),me=a[tt],dt=ke?ke.sub(me)._unit()._perp():Ve,Ve=Ve||dt;let de=Ve.add(dt);de.x===0&&de.y===0||de._unit();const De=Ve.x*dt.x+Ve.y*dt.y,rt=de.x*dt.x+de.y*dt.y,Rt=rt!==0?1/rt:1/0,sn=2*Math.sqrt(2-2*rt),Ft=rt<If&&_e&&ke,Vt=Ve.x*dt.y-Ve.y*dt.x>0;if(Ft&&tt>Q){const xn=me.dist(_e);if(xn>2*he){const Xt=me.sub(me.sub(_e)._mult(he/xn)._round());this.updateDistance(_e,Xt),this.addCurrentVertex(Xt,Ve,0,0,pe),_e=Xt}}const gn=_e&&ke;let an=gn?p:j?"butt":x;if(gn&&an==="round"&&(Rt<A?an="miter":Rt<=2&&(an="fakeround")),an==="miter"&&Rt>C&&(an="bevel"),an==="bevel"&&(Rt>2&&(an="flipbevel"),Rt<C&&(an="miter")),_e&&this.updateDistance(_e,me),an==="miter")de._mult(Rt),this.addCurrentVertex(me,de,0,0,pe);else if(an==="flipbevel"){if(Rt>100)de=dt.mult(-1);else{const xn=Rt*Ve.add(dt).mag()/Ve.sub(dt).mag();de._perp()._mult(xn*(Vt?-1:1))}this.addCurrentVertex(me,de,0,0,pe),this.addCurrentVertex(me,de.mult(-1),0,0,pe)}else if(an==="bevel"||an==="fakeround"){const xn=-Math.sqrt(Rt*Rt-1),Xt=Vt?xn:0,Hn=Vt?0:xn;if(_e&&this.addCurrentVertex(me,Ve,Xt,Hn,pe),an==="fakeround"){const hr=Math.round(180*sn/Math.PI/20);for(let lr=1;lr<hr;lr++){let Jn=lr/hr;if(Jn!==.5){const qi=Jn-.5;Jn+=Jn*qi*(Jn-1)*((1.0904+De*(De*(3.55645-1.43519*De)-3.2452))*qi*qi+(.848013+De*(.215638*De-1.06021)))}const Dr=dt.sub(Ve)._mult(Jn)._add(Ve)._unit()._mult(Vt?-1:1);this.addHalfVertex(me,Dr.x,Dr.y,!1,Vt,0,pe)}}ke&&this.addCurrentVertex(me,dt,-Xt,-Hn,pe)}else if(an==="butt")this.addCurrentVertex(me,de,0,0,pe);else if(an==="square"){const xn=_e?1:-1;this.addCurrentVertex(me,de,xn,xn,pe)}else an==="round"&&(_e&&(this.addCurrentVertex(me,Ve,0,0,pe),this.addCurrentVertex(me,Ve,1,1,pe,!0)),ke&&(this.addCurrentVertex(me,dt,-1,-1,pe,!0),this.addCurrentVertex(me,dt,0,0,pe)));if(Ft&&tt<Y-1){const xn=me.dist(ke);if(xn>2*he){const Xt=me.add(ke.sub(me)._mult(he/xn)._round());this.updateDistance(me,Xt),this.addCurrentVertex(Xt,dt,0,0,pe),me=Xt}}}}addCurrentVertex(a,h,p,x,C,A=!1){const k=h.y*x-h.x,N=-h.y-h.x*x;this.addHalfVertex(a,h.x+h.y*p,h.y-h.x*p,A,!1,p,C),this.addHalfVertex(a,k,N,A,!0,-x,C),this.distance>jy/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,h,p,x,C,A))}addHalfVertex({x:a,y:h},p,x,C,A,k,N){const j=.5*(this.lineClips?this.scaledDistance*(jy-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(C?1:0),(h<<1)+(A?1:0),Math.round(63*p)+128,Math.round(63*x)+128,1+(k===0?0:k<0?-1:1)|(63&j)<<2,j>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Y=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,Y,this.e2),N.primitiveLength++),A?this.e2=Y:this.e1=Y}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,h){this.distance+=a.dist(h),this.updateScaledDistance()}}let Lx,Hy;zn("LineBucket",Ui,{omit:["layers","patternFeatures"]});var Dx={get paint(){return Hy=Hy||new gi({"line-opacity":new ar(We.paint_line["line-opacity"]),"line-color":new ar(We.paint_line["line-color"]),"line-translate":new $n(We.paint_line["line-translate"]),"line-translate-anchor":new $n(We.paint_line["line-translate-anchor"]),"line-width":new ar(We.paint_line["line-width"]),"line-gap-width":new ar(We.paint_line["line-gap-width"]),"line-offset":new ar(We.paint_line["line-offset"]),"line-blur":new ar(We.paint_line["line-blur"]),"line-dasharray":new cd(We.paint_line["line-dasharray"]),"line-pattern":new qu(We.paint_line["line-pattern"]),"line-gradient":new Ba(We.paint_line["line-gradient"])})},get layout(){return Lx=Lx||new gi({"line-cap":new $n(We.layout_line["line-cap"]),"line-join":new ar(We.layout_line["line-join"]),"line-miter-limit":new $n(We.layout_line["line-miter-limit"]),"line-round-limit":new $n(We.layout_line["line-round-limit"]),"line-sort-key":new ar(We.layout_line["line-sort-key"])})}};class yS extends ar{possiblyEvaluate(a,h){return h=new si(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(a,h)}evaluate(a,h,p,x){return h=dn({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(a,h,p,x)}}let sm;class kx extends oo{constructor(a){super(a,Dx),this.gradientVersion=0,sm||(sm=new yS(Dx.paint.properties["line-width"].specification),sm.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof Pu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,h){super.recalculate(a,h),this.paint._values["line-floorwidth"]=sm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Ui(a)}queryRadius(a){const h=a,p=zx(xf("line-width",this,h),xf("line-gap-width",this,h)),x=xf("line-offset",this,h);return p/2+Math.abs(x)+bf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:a,feature:h,featureState:p,geometry:x,transform:C,pixelsToTileUnits:A}){const k=wf(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-C.bearingInRadians,A),N=A/2*zx(this.paint.get("line-width").evaluate(h,p),this.paint.get("line-gap-width").evaluate(h,p)),j=this.paint.get("line-offset").evaluate(h,p);return j&&(x=function(Y,Q){const he=[];for(let pe=0;pe<Y.length;pe++){const me=Y[pe],_e=[];for(let ke=0;ke<me.length;ke++){const Ve=me[ke-1],dt=me[ke],tt=me[ke+1],de=ke===0?new R(0,0):dt.sub(Ve)._unit()._perp(),De=ke===me.length-1?new R(0,0):tt.sub(dt)._unit()._perp(),rt=de._add(De)._unit(),Rt=rt.x*De.x+rt.y*De.y;Rt!==0&&rt._mult(1/Rt),_e.push(rt._mult(Q)._add(dt))}he.push(_e)}return he}(x,j*A)),function(Y,Q,he){for(let pe=0;pe<Q.length;pe++){const me=Q[pe];if(Y.length>=3){for(let _e=0;_e<me.length;_e++)if(th(Y,me[_e]))return!0}if(yx(Y,me,he))return!0}return!1}(k,x,N)}isTileClipped(){return!0}}function zx(d,a){return a>0?a+2*d:d}const Ha=Ci([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Gy=Ci([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ci([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const _S=Ci([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ci([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const iu=Ci([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Lg=Ci([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Cd(d,a,h){return d.sections.forEach(p=>{p.text=function(x,C,A){const k=C.layout.get("text-transform").evaluate(A,{});return k==="uppercase"?x=x.toLocaleUpperCase():k==="lowercase"&&(x=x.toLocaleLowerCase()),dc.applyArabicShaping&&(x=dc.applyArabicShaping(x)),x}(p.text,a,h)}),d}Ci([{name:"triangle",components:3,type:"Uint16"}]),Ci([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ci([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ci([{type:"Float32",name:"offsetX"}]),Ci([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ci([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const ch={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Dg,am,Ox,to=24,Wy={};function Fx(){return Dg||(Dg=1,Wy.read=function(d,a,h,p,x){var C,A,k=8*x-p-1,N=(1<<k)-1,j=N>>1,Y=-7,Q=h?x-1:0,he=h?-1:1,pe=d[a+Q];for(Q+=he,C=pe&(1<<-Y)-1,pe>>=-Y,Y+=k;Y>0;C=256*C+d[a+Q],Q+=he,Y-=8);for(A=C&(1<<-Y)-1,C>>=-Y,Y+=p;Y>0;A=256*A+d[a+Q],Q+=he,Y-=8);if(C===0)C=1-j;else{if(C===N)return A?NaN:1/0*(pe?-1:1);A+=Math.pow(2,p),C-=j}return(pe?-1:1)*A*Math.pow(2,C-p)},Wy.write=function(d,a,h,p,x,C){var A,k,N,j=8*C-x-1,Y=(1<<j)-1,Q=Y>>1,he=x===23?Math.pow(2,-24)-Math.pow(2,-77):0,pe=p?0:C-1,me=p?1:-1,_e=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(k=isNaN(a)?1:0,A=Y):(A=Math.floor(Math.log(a)/Math.LN2),a*(N=Math.pow(2,-A))<1&&(A--,N*=2),(a+=A+Q>=1?he/N:he*Math.pow(2,1-Q))*N>=2&&(A++,N/=2),A+Q>=Y?(k=0,A=Y):A+Q>=1?(k=(a*N-1)*Math.pow(2,x),A+=Q):(k=a*Math.pow(2,Q-1)*Math.pow(2,x),A=0));x>=8;d[h+pe]=255&k,pe+=me,k/=256,x-=8);for(A=A<<x|k,j+=x;j>0;d[h+pe]=255&A,pe+=me,A/=256,j-=8);d[h+pe-me]|=128*_e}),Wy}function qy(){if(Ox)return am;Ox=1,am=a;var d=Fx();function a(de){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(de)?de:new Uint8Array(de||0),this.pos=0,this.type=0,this.length=this.buf.length}a.Varint=0,a.Fixed64=1,a.Bytes=2,a.Fixed32=5;var h=4294967296,p=1/h,x=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function C(de){return de.type===a.Bytes?de.readVarint()+de.pos:de.pos+1}function A(de,De,rt){return rt?4294967296*De+(de>>>0):4294967296*(De>>>0)+(de>>>0)}function k(de,De,rt){var Rt=De<=16383?1:De<=2097151?2:De<=268435455?3:Math.floor(Math.log(De)/(7*Math.LN2));rt.realloc(Rt);for(var sn=rt.pos-1;sn>=de;sn--)rt.buf[sn+Rt]=rt.buf[sn]}function N(de,De){for(var rt=0;rt<de.length;rt++)De.writeVarint(de[rt])}function j(de,De){for(var rt=0;rt<de.length;rt++)De.writeSVarint(de[rt])}function Y(de,De){for(var rt=0;rt<de.length;rt++)De.writeFloat(de[rt])}function Q(de,De){for(var rt=0;rt<de.length;rt++)De.writeDouble(de[rt])}function he(de,De){for(var rt=0;rt<de.length;rt++)De.writeBoolean(de[rt])}function pe(de,De){for(var rt=0;rt<de.length;rt++)De.writeFixed32(de[rt])}function me(de,De){for(var rt=0;rt<de.length;rt++)De.writeSFixed32(de[rt])}function _e(de,De){for(var rt=0;rt<de.length;rt++)De.writeFixed64(de[rt])}function ke(de,De){for(var rt=0;rt<de.length;rt++)De.writeSFixed64(de[rt])}function Ve(de,De){return(de[De]|de[De+1]<<8|de[De+2]<<16)+16777216*de[De+3]}function dt(de,De,rt){de[rt]=De,de[rt+1]=De>>>8,de[rt+2]=De>>>16,de[rt+3]=De>>>24}function tt(de,De){return(de[De]|de[De+1]<<8|de[De+2]<<16)+(de[De+3]<<24)}return a.prototype={destroy:function(){this.buf=null},readFields:function(de,De,rt){for(rt=rt||this.length;this.pos<rt;){var Rt=this.readVarint(),sn=Rt>>3,Ft=this.pos;this.type=7&Rt,de(sn,De,this),this.pos===Ft&&this.skip(Rt)}return De},readMessage:function(de,De){return this.readFields(de,De,this.readVarint()+this.pos)},readFixed32:function(){var de=Ve(this.buf,this.pos);return this.pos+=4,de},readSFixed32:function(){var de=tt(this.buf,this.pos);return this.pos+=4,de},readFixed64:function(){var de=Ve(this.buf,this.pos)+Ve(this.buf,this.pos+4)*h;return this.pos+=8,de},readSFixed64:function(){var de=Ve(this.buf,this.pos)+tt(this.buf,this.pos+4)*h;return this.pos+=8,de},readFloat:function(){var de=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,de},readDouble:function(){var de=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,de},readVarint:function(de){var De,rt,Rt=this.buf;return De=127&(rt=Rt[this.pos++]),rt<128?De:(De|=(127&(rt=Rt[this.pos++]))<<7,rt<128?De:(De|=(127&(rt=Rt[this.pos++]))<<14,rt<128?De:(De|=(127&(rt=Rt[this.pos++]))<<21,rt<128?De:function(sn,Ft,Vt){var gn,an,xn=Vt.buf;if(gn=(112&(an=xn[Vt.pos++]))>>4,an<128||(gn|=(127&(an=xn[Vt.pos++]))<<3,an<128)||(gn|=(127&(an=xn[Vt.pos++]))<<10,an<128)||(gn|=(127&(an=xn[Vt.pos++]))<<17,an<128)||(gn|=(127&(an=xn[Vt.pos++]))<<24,an<128)||(gn|=(1&(an=xn[Vt.pos++]))<<31,an<128))return A(sn,gn,Ft);throw new Error("Expected varint not more than 10 bytes")}(De|=(15&(rt=Rt[this.pos]))<<28,de,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var de=this.readVarint();return de%2==1?(de+1)/-2:de/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var de=this.readVarint()+this.pos,De=this.pos;return this.pos=de,de-De>=12&&x?function(rt,Rt,sn){return x.decode(rt.subarray(Rt,sn))}(this.buf,De,de):function(rt,Rt,sn){for(var Ft="",Vt=Rt;Vt<sn;){var gn,an,xn,Xt=rt[Vt],Hn=null,hr=Xt>239?4:Xt>223?3:Xt>191?2:1;if(Vt+hr>sn)break;hr===1?Xt<128&&(Hn=Xt):hr===2?(192&(gn=rt[Vt+1]))==128&&(Hn=(31&Xt)<<6|63&gn)<=127&&(Hn=null):hr===3?(an=rt[Vt+2],(192&(gn=rt[Vt+1]))==128&&(192&an)==128&&((Hn=(15&Xt)<<12|(63&gn)<<6|63&an)<=2047||Hn>=55296&&Hn<=57343)&&(Hn=null)):hr===4&&(an=rt[Vt+2],xn=rt[Vt+3],(192&(gn=rt[Vt+1]))==128&&(192&an)==128&&(192&xn)==128&&((Hn=(15&Xt)<<18|(63&gn)<<12|(63&an)<<6|63&xn)<=65535||Hn>=1114112)&&(Hn=null)),Hn===null?(Hn=65533,hr=1):Hn>65535&&(Hn-=65536,Ft+=String.fromCharCode(Hn>>>10&1023|55296),Hn=56320|1023&Hn),Ft+=String.fromCharCode(Hn),Vt+=hr}return Ft}(this.buf,De,de)},readBytes:function(){var de=this.readVarint()+this.pos,De=this.buf.subarray(this.pos,de);return this.pos=de,De},readPackedVarint:function(de,De){if(this.type!==a.Bytes)return de.push(this.readVarint(De));var rt=C(this);for(de=de||[];this.pos<rt;)de.push(this.readVarint(De));return de},readPackedSVarint:function(de){if(this.type!==a.Bytes)return de.push(this.readSVarint());var De=C(this);for(de=de||[];this.pos<De;)de.push(this.readSVarint());return de},readPackedBoolean:function(de){if(this.type!==a.Bytes)return de.push(this.readBoolean());var De=C(this);for(de=de||[];this.pos<De;)de.push(this.readBoolean());return de},readPackedFloat:function(de){if(this.type!==a.Bytes)return de.push(this.readFloat());var De=C(this);for(de=de||[];this.pos<De;)de.push(this.readFloat());return de},readPackedDouble:function(de){if(this.type!==a.Bytes)return de.push(this.readDouble());var De=C(this);for(de=de||[];this.pos<De;)de.push(this.readDouble());return de},readPackedFixed32:function(de){if(this.type!==a.Bytes)return de.push(this.readFixed32());var De=C(this);for(de=de||[];this.pos<De;)de.push(this.readFixed32());return de},readPackedSFixed32:function(de){if(this.type!==a.Bytes)return de.push(this.readSFixed32());var De=C(this);for(de=de||[];this.pos<De;)de.push(this.readSFixed32());return de},readPackedFixed64:function(de){if(this.type!==a.Bytes)return de.push(this.readFixed64());var De=C(this);for(de=de||[];this.pos<De;)de.push(this.readFixed64());return de},readPackedSFixed64:function(de){if(this.type!==a.Bytes)return de.push(this.readSFixed64());var De=C(this);for(de=de||[];this.pos<De;)de.push(this.readSFixed64());return de},skip:function(de){var De=7&de;if(De===a.Varint)for(;this.buf[this.pos++]>127;);else if(De===a.Bytes)this.pos=this.readVarint()+this.pos;else if(De===a.Fixed32)this.pos+=4;else{if(De!==a.Fixed64)throw new Error("Unimplemented type: "+De);this.pos+=8}},writeTag:function(de,De){this.writeVarint(de<<3|De)},realloc:function(de){for(var De=this.length||16;De<this.pos+de;)De*=2;if(De!==this.length){var rt=new Uint8Array(De);rt.set(this.buf),this.buf=rt,this.length=De}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(de){this.realloc(4),dt(this.buf,de,this.pos),this.pos+=4},writeSFixed32:function(de){this.realloc(4),dt(this.buf,de,this.pos),this.pos+=4},writeFixed64:function(de){this.realloc(8),dt(this.buf,-1&de,this.pos),dt(this.buf,Math.floor(de*p),this.pos+4),this.pos+=8},writeSFixed64:function(de){this.realloc(8),dt(this.buf,-1&de,this.pos),dt(this.buf,Math.floor(de*p),this.pos+4),this.pos+=8},writeVarint:function(de){(de=+de||0)>268435455||de<0?function(De,rt){var Rt,sn;if(De>=0?(Rt=De%4294967296|0,sn=De/4294967296|0):(sn=~(-De/4294967296),4294967295^(Rt=~(-De%4294967296))?Rt=Rt+1|0:(Rt=0,sn=sn+1|0)),De>=18446744073709552e3||De<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");rt.realloc(10),function(Ft,Vt,gn){gn.buf[gn.pos++]=127&Ft|128,Ft>>>=7,gn.buf[gn.pos++]=127&Ft|128,Ft>>>=7,gn.buf[gn.pos++]=127&Ft|128,Ft>>>=7,gn.buf[gn.pos++]=127&Ft|128,gn.buf[gn.pos]=127&(Ft>>>=7)}(Rt,0,rt),function(Ft,Vt){var gn=(7&Ft)<<4;Vt.buf[Vt.pos++]|=gn|((Ft>>>=3)?128:0),Ft&&(Vt.buf[Vt.pos++]=127&Ft|((Ft>>>=7)?128:0),Ft&&(Vt.buf[Vt.pos++]=127&Ft|((Ft>>>=7)?128:0),Ft&&(Vt.buf[Vt.pos++]=127&Ft|((Ft>>>=7)?128:0),Ft&&(Vt.buf[Vt.pos++]=127&Ft|((Ft>>>=7)?128:0),Ft&&(Vt.buf[Vt.pos++]=127&Ft)))))}(sn,rt)}(de,this):(this.realloc(4),this.buf[this.pos++]=127&de|(de>127?128:0),de<=127||(this.buf[this.pos++]=127&(de>>>=7)|(de>127?128:0),de<=127||(this.buf[this.pos++]=127&(de>>>=7)|(de>127?128:0),de<=127||(this.buf[this.pos++]=de>>>7&127))))},writeSVarint:function(de){this.writeVarint(de<0?2*-de-1:2*de)},writeBoolean:function(de){this.writeVarint(!!de)},writeString:function(de){de=String(de),this.realloc(4*de.length),this.pos++;var De=this.pos;this.pos=function(Rt,sn,Ft){for(var Vt,gn,an=0;an<sn.length;an++){if((Vt=sn.charCodeAt(an))>55295&&Vt<57344){if(!gn){Vt>56319||an+1===sn.length?(Rt[Ft++]=239,Rt[Ft++]=191,Rt[Ft++]=189):gn=Vt;continue}if(Vt<56320){Rt[Ft++]=239,Rt[Ft++]=191,Rt[Ft++]=189,gn=Vt;continue}Vt=gn-55296<<10|Vt-56320|65536,gn=null}else gn&&(Rt[Ft++]=239,Rt[Ft++]=191,Rt[Ft++]=189,gn=null);Vt<128?Rt[Ft++]=Vt:(Vt<2048?Rt[Ft++]=Vt>>6|192:(Vt<65536?Rt[Ft++]=Vt>>12|224:(Rt[Ft++]=Vt>>18|240,Rt[Ft++]=Vt>>12&63|128),Rt[Ft++]=Vt>>6&63|128),Rt[Ft++]=63&Vt|128)}return Ft}(this.buf,de,this.pos);var rt=this.pos-De;rt>=128&&k(De,rt,this),this.pos=De-1,this.writeVarint(rt),this.pos+=rt},writeFloat:function(de){this.realloc(4),d.write(this.buf,de,this.pos,!0,23,4),this.pos+=4},writeDouble:function(de){this.realloc(8),d.write(this.buf,de,this.pos,!0,52,8),this.pos+=8},writeBytes:function(de){var De=de.length;this.writeVarint(De),this.realloc(De);for(var rt=0;rt<De;rt++)this.buf[this.pos++]=de[rt]},writeRawMessage:function(de,De){this.pos++;var rt=this.pos;de(De,this);var Rt=this.pos-rt;Rt>=128&&k(rt,Rt,this),this.pos=rt-1,this.writeVarint(Rt),this.pos+=Rt},writeMessage:function(de,De,rt){this.writeTag(de,a.Bytes),this.writeRawMessage(De,rt)},writePackedVarint:function(de,De){De.length&&this.writeMessage(de,N,De)},writePackedSVarint:function(de,De){De.length&&this.writeMessage(de,j,De)},writePackedBoolean:function(de,De){De.length&&this.writeMessage(de,he,De)},writePackedFloat:function(de,De){De.length&&this.writeMessage(de,Y,De)},writePackedDouble:function(de,De){De.length&&this.writeMessage(de,Q,De)},writePackedFixed32:function(de,De){De.length&&this.writeMessage(de,pe,De)},writePackedSFixed32:function(de,De){De.length&&this.writeMessage(de,me,De)},writePackedFixed64:function(de,De){De.length&&this.writeMessage(de,_e,De)},writePackedSFixed64:function(de,De){De.length&&this.writeMessage(de,ke,De)},writeBytesField:function(de,De){this.writeTag(de,a.Bytes),this.writeBytes(De)},writeFixed32Field:function(de,De){this.writeTag(de,a.Fixed32),this.writeFixed32(De)},writeSFixed32Field:function(de,De){this.writeTag(de,a.Fixed32),this.writeSFixed32(De)},writeFixed64Field:function(de,De){this.writeTag(de,a.Fixed64),this.writeFixed64(De)},writeSFixed64Field:function(de,De){this.writeTag(de,a.Fixed64),this.writeSFixed64(De)},writeVarintField:function(de,De){this.writeTag(de,a.Varint),this.writeVarint(De)},writeSVarintField:function(de,De){this.writeTag(de,a.Varint),this.writeSVarint(De)},writeStringField:function(de,De){this.writeTag(de,a.Bytes),this.writeString(De)},writeFloatField:function(de,De){this.writeTag(de,a.Fixed32),this.writeFloat(De)},writeDoubleField:function(de,De){this.writeTag(de,a.Fixed64),this.writeDouble(De)},writeBooleanField:function(de,De){this.writeVarintField(de,!!De)}},am}var Ml,Rf=m(qy());function Nx(d,a,h){d===1&&h.readMessage(Xy,a)}function Xy(d,a,h){if(d===3){const{id:p,bitmap:x,width:C,height:A,left:k,top:N,advance:j}=h.readMessage(xS,{});a.push({id:p,bitmap:new md({width:C+6,height:A+6},x),metrics:{width:C,height:A,left:k,top:N,advance:j}})}}function xS(d,a,h){d===1?a.id=h.readVarint():d===2?a.bitmap=h.readBytes():d===3?a.width=h.readVarint():d===4?a.height=h.readVarint():d===5?a.left=h.readSVarint():d===6?a.top=h.readSVarint():d===7&&(a.advance=h.readVarint())}function Zy(d){let a=0,h=0;for(const A of d)a+=A.w*A.h,h=Math.max(h,A.w);d.sort((A,k)=>k.h-A.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),h),h:1/0}];let x=0,C=0;for(const A of d)for(let k=p.length-1;k>=0;k--){const N=p[k];if(!(A.w>N.w||A.h>N.h)){if(A.x=N.x,A.y=N.y,C=Math.max(C,A.y+A.h),x=Math.max(x,A.x+A.w),A.w===N.w&&A.h===N.h){const j=p.pop();k<p.length&&(p[k]=j)}else A.h===N.h?(N.x+=A.w,N.w-=A.w):A.w===N.w?(N.y+=A.h,N.h-=A.h):(p.push({x:N.x+A.w,y:N.y,w:N.w-A.w,h:A.h}),N.y+=A.h,N.h-=A.h);break}}return{w:x,h:C,fill:a/(x*C)||0}}class lm{constructor(a,{pixelRatio:h,version:p,stretchX:x,stretchY:C,content:A,textFitWidth:k,textFitHeight:N}){this.paddedRect=a,this.pixelRatio=h,this.stretchX=x,this.stretchY=C,this.content=A,this.version=p,this.textFitWidth=k,this.textFitHeight=N}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class cm{constructor(a,h){const p={},x={};this.haveRenderCallbacks=[];const C=[];this.addImages(a,p,C),this.addImages(h,x,C);const{w:A,h:k}=Zy(C),N=new xs({width:A||1,height:k||1});for(const j in a){const Y=a[j],Q=p[j].paddedRect;xs.copy(Y.data,N,{x:0,y:0},{x:Q.x+1,y:Q.y+1},Y.data)}for(const j in h){const Y=h[j],Q=x[j].paddedRect,he=Q.x+1,pe=Q.y+1,me=Y.data.width,_e=Y.data.height;xs.copy(Y.data,N,{x:0,y:0},{x:he,y:pe},Y.data),xs.copy(Y.data,N,{x:0,y:_e-1},{x:he,y:pe-1},{width:me,height:1}),xs.copy(Y.data,N,{x:0,y:0},{x:he,y:pe+_e},{width:me,height:1}),xs.copy(Y.data,N,{x:me-1,y:0},{x:he-1,y:pe},{width:1,height:_e}),xs.copy(Y.data,N,{x:0,y:0},{x:he+me,y:pe},{width:1,height:_e})}this.image=N,this.iconPositions=p,this.patternPositions=x}addImages(a,h,p){for(const x in a){const C=a[x],A={x:0,y:0,w:C.data.width+2,h:C.data.height+2};p.push(A),h[x]=new lm(A,C),C.hasRenderCallback&&this.haveRenderCallbacks.push(x)}}patchUpdatedImages(a,h){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in a.updatedImages)this.patchUpdatedImage(this.iconPositions[p],a.getImage(p),h),this.patchUpdatedImage(this.patternPositions[p],a.getImage(p),h)}patchUpdatedImage(a,h,p){if(!a||!h||a.version===h.version)return;a.version=h.version;const[x,C]=a.tl;p.update(h.data,void 0,{x,y:C})}}zn("ImagePosition",lm),zn("ImageAtlas",cm),c.an=void 0,(Ml=c.an||(c.an={}))[Ml.none=0]="none",Ml[Ml.horizontal=1]="horizontal",Ml[Ml.vertical=2]="vertical",Ml[Ml.horizontalOnly=3]="horizontalOnly";class Ed{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(a,h,p){const x=new Ed;return x.scale=a||1,x.fontStack=h,x.verticalAlign=p||"bottom",x}static forImage(a,h){const p=new Ed;return p.imageName=a,p.verticalAlign=h||"bottom",p}}class ou{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,h){const p=new ou;for(let x=0;x<a.sections.length;x++){const C=a.sections[x];C.image?p.addImageSection(C):p.addTextSection(C,h)}return p}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let h="";for(let p=0;p<a.length;p++){const x=a.charCodeAt(p+1)||null,C=a.charCodeAt(p-1)||null;h+=x&&vf(x)&&!ch[a[p+1]]||C&&vf(C)&&!ch[a[p-1]]||!ch[a[p]]?a[p]:ch[a[p]]}return h}(this.text)}trim(){let a=0;for(let p=0;p<this.text.length&&kg[this.text.charCodeAt(p)];p++)a++;let h=this.text.length;for(let p=this.text.length-1;p>=0&&p>=a&&kg[this.text.charCodeAt(p)];p--)h--;this.text=this.text.substring(a,h),this.sectionIndex=this.sectionIndex.slice(a,h)}substring(a,h){const p=new ou;return p.text=this.text.substring(a,h),p.sectionIndex=this.sectionIndex.slice(a,h),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,h)=>Math.max(a,this.sections[h].scale),0)}getMaxImageSize(a){let h=0,p=0;for(let x=0;x<this.length();x++){const C=this.getSection(x);if(C.imageName){const A=a[C.imageName];if(!A)continue;const k=A.displaySize;h=Math.max(h,k[0]),p=Math.max(p,k[1])}}return{maxImageWidth:h,maxImageHeight:p}}addTextSection(a,h){this.text+=a.text,this.sections.push(Ed.forText(a.scale,a.fontStack||h,a.verticalAlign));const p=this.sections.length-1;for(let x=0;x<a.text.length;++x)this.sectionIndex.push(p)}addImageSection(a){const h=a.image?a.image.name:"";if(h.length===0)return void fn("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Ed.forImage(h,a.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):fn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function um(d,a,h,p,x,C,A,k,N,j,Y,Q,he,pe,me){const _e=ou.fromFeature(d,x);let ke;Q===c.an.vertical&&_e.verticalizePunctuation();const{processBidirectionalText:Ve,processStyledBidirectionalText:dt}=dc;if(Ve&&_e.sections.length===1){ke=[];const De=Ve(_e.toString(),P(_e,j,C,a,p,pe));for(const rt of De){const Rt=new ou;Rt.text=rt,Rt.sections=_e.sections;for(let sn=0;sn<rt.length;sn++)Rt.sectionIndex.push(0);ke.push(Rt)}}else if(dt){ke=[];const De=dt(_e.text,_e.sectionIndex,P(_e,j,C,a,p,pe));for(const rt of De){const Rt=new ou;Rt.text=rt[0],Rt.sectionIndex=rt[1],Rt.sections=_e.sections,ke.push(Rt)}}else ke=function(De,rt){const Rt=[],sn=De.text;let Ft=0;for(const Vt of rt)Rt.push(De.substring(Ft,Vt)),Ft=Vt;return Ft<sn.length&&Rt.push(De.substring(Ft,sn.length)),Rt}(_e,P(_e,j,C,a,p,pe));const tt=[],de={positionedLines:tt,text:_e.toString(),top:Y[1],bottom:Y[1],left:Y[0],right:Y[0],writingMode:Q,iconsInText:!1,verticalizable:!1};return function(De,rt,Rt,sn,Ft,Vt,gn,an,xn,Xt,Hn,hr){let lr=0,Jn=0,Dr=0,qi=0;const Ro=an==="right"?1:an==="left"?0:.5,Cs=to/hr;let El=0;for(const $i of Ft){$i.trim();const Go=$i.getMaxScale(),hs={positionedGlyphs:[],lineOffset:0};De.positionedLines[El]=hs;const ds=hs.positionedGlyphs;let ra=0;if(!$i.length()){Jn+=Vt,++El;continue}const Tl=G(sn,$i,Cs);for(let wa=0;wa<$i.length();wa++){const Lo=$i.getSection(wa),qo=$i.getSectionIndex(wa),Xo=$i.getCharCode(wa),xo=be(xn,Hn,Xo);let Ai;if(Lo.imageName){if(De.iconsInText=!0,Lo.scale=Lo.scale*Cs,Ai=gt(Lo,xo,Go,Tl,sn),!Ai)continue;ra=Math.max(ra,Ai.imageOffset)}else if(Ai=ot(Lo,Xo,xo,Tl,rt,Rt),!Ai)continue;const{rect:su,metrics:Bg,baselineOffset:au}=Ai;ds.push({glyph:Xo,imageName:Lo.imageName,x:lr,y:Jn+au+-17,vertical:xo,scale:Lo.scale,fontStack:Lo.fontStack,sectionIndex:qo,metrics:Bg,rect:su}),xo?(De.verticalizable=!0,lr+=(Lo.imageName?Bg.advance:to)*Lo.scale+Xt):lr+=Bg.advance*Lo.scale+Xt}ds.length!==0&&(Dr=Math.max(lr-Xt,Dr),Bt(ds,0,ds.length-1,Ro)),lr=0,hs.lineOffset=Math.max(ra,(Go-1)*to);const Wo=Vt*Go+ra;Jn+=Wo,qi=Math.max(Wo,qi),++El}const{horizontalAlign:ba,verticalAlign:us}=O(gn);(function($i,Go,hs,ds,ra,Tl,Wo,wa,Lo){const qo=(Go-hs)*ra;let Xo=0;Xo=Tl!==Wo?-wa*ds- -17:-ds*Lo*Wo+.5*Wo;for(const xo of $i)for(const Ai of xo.positionedGlyphs)Ai.x+=qo,Ai.y+=Xo})(De.positionedLines,Ro,ba,us,Dr,qi,Vt,Jn,Ft.length),De.top+=-us*Jn,De.bottom=De.top+Jn,De.left+=-ba*Dr,De.right=De.left+Dr}(de,a,h,p,ke,A,k,N,Q,j,he,me),!function(De){for(const rt of De)if(rt.positionedGlyphs.length!==0)return!1;return!0}(tt)&&de}const kg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},zg={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},bS={40:!0};function Lf(d,a,h,p,x,C){if(a.imageName){const A=p[a.imageName];return A?A.displaySize[0]*a.scale*to/C+x:0}{const A=h[a.fontStack],k=A&&A[d];return k?k.metrics.advance*a.scale+x:0}}function Bx(d,a,h,p){const x=Math.pow(d-a,2);return p?d<a?x/2:2*x:x+Math.abs(h)*h}function Og(d,a,h){let p=0;return d===10&&(p-=1e4),h&&(p+=150),d!==40&&d!==65288||(p+=50),a!==41&&a!==65289||(p+=50),p}function f(d,a,h,p,x,C){let A=null,k=Bx(a,h,x,C);for(const N of p){const j=Bx(a-N.x,h,x,C)+N.badness;j<=k&&(A=N,k=j)}return{index:d,x:a,priorBreak:A,badness:k}}function v(d){return d?v(d.priorBreak).concat(d.index):[]}function P(d,a,h,p,x,C){if(!d)return[];const A=[],k=function(Q,he,pe,me,_e,ke){let Ve=0;for(let dt=0;dt<Q.length();dt++){const tt=Q.getSection(dt);Ve+=Lf(Q.getCharCode(dt),tt,me,_e,he,ke)}return Ve/Math.max(1,Math.ceil(Ve/pe))}(d,a,h,p,x,C),N=d.text.indexOf("​")>=0;let j=0;for(let Q=0;Q<d.length();Q++){const he=d.getSection(Q),pe=d.getCharCode(Q);if(kg[pe]||(j+=Lf(pe,he,p,x,a,C)),Q<d.length()-1){const me=!((Y=pe)<11904)&&(!!dr["CJK Compatibility Forms"](Y)||!!dr["CJK Compatibility"](Y)||!!dr["CJK Strokes"](Y)||!!dr["CJK Symbols and Punctuation"](Y)||!!dr["Enclosed CJK Letters and Months"](Y)||!!dr["Halfwidth and Fullwidth Forms"](Y)||!!dr["Ideographic Description Characters"](Y)||!!dr["Vertical Forms"](Y)||od.test(String.fromCodePoint(Y)));(zg[pe]||me||he.imageName||Q!==d.length()-2&&bS[d.getCharCode(Q+1)])&&A.push(f(Q+1,j,k,A,Og(pe,d.getCharCode(Q+1),me&&N),!1))}}var Y;return v(f(d.length(),j,k,A,0,!0))}function O(d){let a=.5,h=.5;switch(d){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:a,verticalAlign:h}}function G(d,a,h){const p=a.getMaxScale()*to,{maxImageWidth:x,maxImageHeight:C}=a.getMaxImageSize(d),A=Math.max(p,C*h);return{verticalLineContentWidth:Math.max(p,x*h),horizontalLineContentHeight:A}}function J(d){switch(d){case"top":return 0;case"center":return .5;default:return 1}}function be(d,a,h){return!(d===c.an.horizontal||!a&&!Hu(h)||a&&(kg[h]||(p=h,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(p)))));var p}function ot(d,a,h,p,x,C){const A=C[d.fontStack],k=function(j,Y,Q,he){if(j&&j.rect)return j;const pe=Y[Q.fontStack],me=pe&&pe[he];return me?{rect:null,metrics:me.metrics}:null}(A&&A[a],x,d,a);if(k===null)return null;let N;if(h)N=p.verticalLineContentWidth-d.scale*to;else{const j=J(d.verticalAlign);N=(p.horizontalLineContentHeight-d.scale*to)*j}return{rect:k.rect,metrics:k.metrics,baselineOffset:N}}function gt(d,a,h,p,x){const C=x[d.imageName];if(!C)return null;const A=C.paddedRect,k=C.displaySize,N={width:k[0],height:k[1],left:1,top:-3,advance:a?k[1]:k[0]};let j;if(a)j=p.verticalLineContentWidth-k[1]*d.scale;else{const Y=J(d.verticalAlign);j=(p.horizontalLineContentHeight-k[1]*d.scale)*Y}return{rect:A,metrics:N,baselineOffset:j,imageOffset:(a?k[0]:k[1])*d.scale-to*h}}function Bt(d,a,h,p){if(p===0)return;const x=d[h],C=(d[h].x+x.metrics.advance*x.scale)*p;for(let A=a;A<=h;A++)d[A].x-=C}function bn(d,a,h){const{horizontalAlign:p,verticalAlign:x}=O(h),C=a[0]-d.displaySize[0]*p,A=a[1]-d.displaySize[1]*x;return{image:d,top:A,bottom:A+d.displaySize[1],left:C,right:C+d.displaySize[0]}}function Mn(d){var a,h;let p=d.left,x=d.top,C=d.right-p,A=d.bottom-x;const k=(a=d.image.textFitWidth)!==null&&a!==void 0?a:"stretchOrShrink",N=(h=d.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",j=(d.image.content[2]-d.image.content[0])/(d.image.content[3]-d.image.content[1]);if(N==="proportional"){if(k==="stretchOnly"&&C/A<j||k==="proportional"){const Y=Math.ceil(A*j);p*=Y/C,C=Y}}else if(k==="proportional"&&N==="stretchOnly"&&j!==0&&C/A>j){const Y=Math.ceil(C/j);x*=Y/A,A=Y}return{x1:p,y1:x,x2:p+C,y2:x+A}}function yn(d,a,h,p,x,C){const A=d.image;let k;if(A.content){const ke=A.content,Ve=A.pixelRatio||1;k=[ke[0]/Ve,ke[1]/Ve,A.displaySize[0]-ke[2]/Ve,A.displaySize[1]-ke[3]/Ve]}const N=a.left*C,j=a.right*C;let Y,Q,he,pe;h==="width"||h==="both"?(pe=x[0]+N-p[3],Q=x[0]+j+p[1]):(pe=x[0]+(N+j-A.displaySize[0])/2,Q=pe+A.displaySize[0]);const me=a.top*C,_e=a.bottom*C;return h==="height"||h==="both"?(Y=x[1]+me-p[0],he=x[1]+_e+p[2]):(Y=x[1]+(me+_e-A.displaySize[1])/2,he=Y+A.displaySize[1]),{image:A,top:Y,right:Q,bottom:he,left:pe,collisionPadding:k}}const Un=128,Yn=32640;function rr(d,a){const{expression:h}=a;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new si(d+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:x}=h;let C=0;for(;C<p.length&&p[C]<=d;)C++;C=Math.max(0,C-1);let A=C;for(;A<p.length&&p[A]<d+1;)A++;A=Math.min(p.length-1,A);const k=p[C],N=p[A];return h.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:N,interpolationType:x}:{kind:"camera",minZoom:k,maxZoom:N,minSize:h.evaluate(new si(k)),maxSize:h.evaluate(new si(N)),interpolationType:x}}}function Wi(d,a,h){let p="never";const x=d.get(a);return x?p=x:d.get(h)&&(p="always"),p}const Lt=wd.VectorTileFeature.types,_t=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function zt(d,a,h,p,x,C,A,k,N,j,Y,Q,he){const pe=k?Math.min(Yn,Math.round(k[0])):0,me=k?Math.min(Yn,Math.round(k[1])):0;d.emplaceBack(a,h,Math.round(32*p),Math.round(32*x),C,A,(pe<<1)+(N?1:0),me,16*j,16*Y,256*Q,256*he)}function In(d,a,h){d.emplaceBack(a.x,a.y,h),d.emplaceBack(a.x,a.y,h),d.emplaceBack(a.x,a.y,h),d.emplaceBack(a.x,a.y,h)}function cr(d){for(const a of d.sections)if(ad(a.text))return!0;return!1}class fr{constructor(a){this.layoutVertexArray=new br,this.indexArray=new ai,this.programConfigurations=a,this.segments=new Ar,this.dynamicLayoutVertexArray=new jr,this.opacityVertexArray=new Ei,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ne}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,h,p,x){this.isEmpty()||(p&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ha.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Gy.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,_t,!0),this.opacityVertexBuffer.itemSize=1),(p||x)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}zn("SymbolBuffers",fr);class pr{constructor(a,h,p){this.layoutVertexArray=new a,this.layoutAttributes=h,this.indexArray=new p,this.segments=new Ar,this.collisionVertexArray=new ci}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,_S.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}zn("CollisionBuffers",pr);class mr{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(A=>A.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=rr(this.zoom,h["text-size"]),this.iconSizeData=rr(this.zoom,h["icon-size"]);const p=this.layers[0].layout,x=p.get("symbol-sort-key"),C=p.get("symbol-z-order");this.canOverlap=Wi(p,"text-overlap","text-allow-overlap")!=="never"||Wi(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=C!=="viewport-y"&&!x.isConstant(),this.sortFeaturesByY=(C==="viewport-y"||C==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(A=>c.an[A])),this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id),this.sourceID=a.sourceID}createArrays(){this.text=new fr(new Ns(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new fr(new Ns(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new qe,this.lineVertexArray=new at,this.symbolInstances=new Je,this.textAnchorOffsets=new Ze}calculateGlyphDependencies(a,h,p,x,C){for(let A=0;A<a.length;A++)if(h[a.charCodeAt(A)]=!0,(p||x)&&C){const k=ch[a.charAt(A)];k&&(h[k.charCodeAt(0)]=!0)}}populate(a,h,p){const x=this.layers[0],C=x.layout,A=C.get("text-font"),k=C.get("text-field"),N=C.get("icon-image"),j=(k.value.kind!=="constant"||k.value.value instanceof Di&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),Y=N.value.kind!=="constant"||!!N.value.value||Object.keys(N.parameters).length>0,Q=C.get("symbol-sort-key");if(this.features=[],!j&&!Y)return;const he=h.iconDependencies,pe=h.glyphDependencies,me=h.availableImages,_e=new si(this.zoom,{globalState:this.globalState});for(const{feature:ke,id:Ve,index:dt,sourceLayerIndex:tt}of a){const de=x._featureFilter.needGeometry,De=eh(ke,de);if(!x._featureFilter.filter(_e,De,p))continue;let rt,Rt;if(de||(De.geometry=Qu(ke)),j){const Ft=x.getValueAndResolveTokens("text-field",De,p,me),Vt=Di.factory(Ft),gn=this.hasRTLText=this.hasRTLText||cr(Vt);(!gn||dc.getRTLTextPluginStatus()==="unavailable"||gn&&dc.isParsed())&&(rt=Cd(Vt,x,De))}if(Y){const Ft=x.getValueAndResolveTokens("icon-image",De,p,me);Rt=Ft instanceof es?Ft:es.fromString(Ft)}if(!rt&&!Rt)continue;const sn=this.sortFeaturesByKey?Q.evaluate(De,{},p):void 0;if(this.features.push({id:Ve,text:rt,icon:Rt,index:dt,sourceLayerIndex:tt,geometry:De.geometry,properties:ke.properties,type:Lt[ke.type],sortKey:sn}),Rt&&(he[Rt.name]=!0),rt){const Ft=A.evaluate(De,{},p).join(","),Vt=C.get("text-rotation-alignment")!=="viewport"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.an.vertical)>=0;for(const gn of rt.sections)if(gn.image)he[gn.image.name]=!0;else{const an=is(rt.toString()),xn=gn.fontStack||Ft,Xt=pe[xn]=pe[xn]||{};this.calculateGlyphDependencies(gn.text,Xt,Vt,this.allowVerticalPlacement,an)}}}C.get("symbol-placement")==="line"&&(this.features=function(ke){const Ve={},dt={},tt=[];let de=0;function De(Ft){tt.push(ke[Ft]),de++}function rt(Ft,Vt,gn){const an=dt[Ft];return delete dt[Ft],dt[Vt]=an,tt[an].geometry[0].pop(),tt[an].geometry[0]=tt[an].geometry[0].concat(gn[0]),an}function Rt(Ft,Vt,gn){const an=Ve[Vt];return delete Ve[Vt],Ve[Ft]=an,tt[an].geometry[0].shift(),tt[an].geometry[0]=gn[0].concat(tt[an].geometry[0]),an}function sn(Ft,Vt,gn){const an=gn?Vt[0][Vt[0].length-1]:Vt[0][0];return`${Ft}:${an.x}:${an.y}`}for(let Ft=0;Ft<ke.length;Ft++){const Vt=ke[Ft],gn=Vt.geometry,an=Vt.text?Vt.text.toString():null;if(!an){De(Ft);continue}const xn=sn(an,gn),Xt=sn(an,gn,!0);if(xn in dt&&Xt in Ve&&dt[xn]!==Ve[Xt]){const Hn=Rt(xn,Xt,gn),hr=rt(xn,Xt,tt[Hn].geometry);delete Ve[xn],delete dt[Xt],dt[sn(an,tt[hr].geometry,!0)]=hr,tt[Hn].geometry=null}else xn in dt?rt(xn,Xt,gn):Xt in Ve?Rt(xn,Xt,gn):(De(Ft),Ve[xn]=de-1,dt[Xt]=de-1)}return tt.filter(Ft=>Ft.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ke,Ve)=>ke.sortKey-Ve.sortKey)}update(a,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,h,this.layers,p),this.icon.programConfigurations.updatePaintArrays(a,h,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,h){const p=this.lineVertexArray.length;if(a.segment!==void 0){let x=a.dist(h[a.segment+1]),C=a.dist(h[a.segment]);const A={};for(let k=a.segment+1;k<h.length;k++)A[k]={x:h[k].x,y:h[k].y,tileUnitDistanceFromAnchor:x},k<h.length-1&&(x+=h[k+1].dist(h[k]));for(let k=a.segment||0;k>=0;k--)A[k]={x:h[k].x,y:h[k].y,tileUnitDistanceFromAnchor:C},k>0&&(C+=h[k-1].dist(h[k]));for(let k=0;k<h.length;k++){const N=A[k];this.lineVertexArray.emplaceBack(N.x,N.y,N.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(a,h,p,x,C,A,k,N,j,Y,Q,he){const pe=a.indexArray,me=a.layoutVertexArray,_e=a.segments.prepareSegment(4*h.length,me,pe,this.canOverlap?A.sortKey:void 0),ke=this.glyphOffsetArray.length,Ve=_e.vertexLength,dt=this.allowVerticalPlacement&&k===c.an.vertical?Math.PI/2:0,tt=A.text&&A.text.sections;for(let de=0;de<h.length;de++){const{tl:De,tr:rt,bl:Rt,br:sn,tex:Ft,pixelOffsetTL:Vt,pixelOffsetBR:gn,minFontScaleX:an,minFontScaleY:xn,glyphOffset:Xt,isSDF:Hn,sectionIndex:hr}=h[de],lr=_e.vertexLength,Jn=Xt[1];zt(me,N.x,N.y,De.x,Jn+De.y,Ft.x,Ft.y,p,Hn,Vt.x,Vt.y,an,xn),zt(me,N.x,N.y,rt.x,Jn+rt.y,Ft.x+Ft.w,Ft.y,p,Hn,gn.x,Vt.y,an,xn),zt(me,N.x,N.y,Rt.x,Jn+Rt.y,Ft.x,Ft.y+Ft.h,p,Hn,Vt.x,gn.y,an,xn),zt(me,N.x,N.y,sn.x,Jn+sn.y,Ft.x+Ft.w,Ft.y+Ft.h,p,Hn,gn.x,gn.y,an,xn),In(a.dynamicLayoutVertexArray,N,dt),pe.emplaceBack(lr,lr+2,lr+1),pe.emplaceBack(lr+1,lr+2,lr+3),_e.vertexLength+=4,_e.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Xt[0]),de!==h.length-1&&hr===h[de+1].sectionIndex||a.programConfigurations.populatePaintArrays(me.length,A,A.index,{},he,tt&&tt[hr])}a.placedSymbolArray.emplaceBack(N.x,N.y,ke,this.glyphOffsetArray.length-ke,Ve,j,Y,N.segment,p?p[0]:0,p?p[1]:0,x[0],x[1],k,0,!1,0,Q)}_addCollisionDebugVertex(a,h,p,x,C,A){return h.emplaceBack(0,0),a.emplaceBack(p.x,p.y,x,C,Math.round(A.x),Math.round(A.y))}addCollisionDebugVertices(a,h,p,x,C,A,k){const N=C.segments.prepareSegment(4,C.layoutVertexArray,C.indexArray),j=N.vertexLength,Y=C.layoutVertexArray,Q=C.collisionVertexArray,he=k.anchorX,pe=k.anchorY;this._addCollisionDebugVertex(Y,Q,A,he,pe,new R(a,h)),this._addCollisionDebugVertex(Y,Q,A,he,pe,new R(p,h)),this._addCollisionDebugVertex(Y,Q,A,he,pe,new R(p,x)),this._addCollisionDebugVertex(Y,Q,A,he,pe,new R(a,x)),N.vertexLength+=4;const me=C.indexArray;me.emplaceBack(j,j+1),me.emplaceBack(j+1,j+2),me.emplaceBack(j+2,j+3),me.emplaceBack(j+3,j),N.primitiveLength+=4}addDebugCollisionBoxes(a,h,p,x){for(let C=a;C<h;C++){const A=this.collisionBoxArray.get(C);this.addCollisionDebugVertices(A.x1,A.y1,A.x2,A.y2,x?this.textCollisionBox:this.iconCollisionBox,A.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pr(ii,iu.members,Kr),this.iconCollisionBox=new pr(ii,iu.members,Kr);for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(a,h,p,x,C,A,k,N,j){const Y={};for(let Q=h;Q<p;Q++){const he=a.get(Q);Y.textBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Y.textFeatureIndex=he.featureIndex;break}for(let Q=x;Q<C;Q++){const he=a.get(Q);Y.verticalTextBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Y.verticalTextFeatureIndex=he.featureIndex;break}for(let Q=A;Q<k;Q++){const he=a.get(Q);Y.iconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Y.iconFeatureIndex=he.featureIndex;break}for(let Q=N;Q<j;Q++){const he=a.get(Q);Y.verticalIconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Y.verticalIconFeatureIndex=he.featureIndex;break}return Y}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,h){const p=a.placedSymbolArray.get(h),x=p.vertexStartIndex+4*p.numGlyphs;for(let C=p.vertexStartIndex;C<x;C+=4)a.indexArray.emplaceBack(C,C+2,C+1),a.indexArray.emplaceBack(C+1,C+2,C+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(a),p=Math.cos(a),x=[],C=[],A=[];for(let k=0;k<this.symbolInstances.length;++k){A.push(k);const N=this.symbolInstances.get(k);x.push(0|Math.round(h*N.anchorX+p*N.anchorY)),C.push(N.featureIndex)}return A.sort((k,N)=>x[k]-x[N]||C[N]-C[k]),A}addToSortKeyRanges(a,h){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===h?p.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((x,C,A)=>{x>=0&&A.indexOf(x)===C&&this.addIndicesForPlacedSymbol(this.text,x)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Io,ni;zn("SymbolBucket",mr,{omit:["layers","collisionBoxArray","features","compareText"]}),mr.MAX_GLYPHS=65535,mr.addDynamicAttributes=In;var xc={get paint(){return ni=ni||new gi({"icon-opacity":new ar(We.paint_symbol["icon-opacity"]),"icon-color":new ar(We.paint_symbol["icon-color"]),"icon-halo-color":new ar(We.paint_symbol["icon-halo-color"]),"icon-halo-width":new ar(We.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ar(We.paint_symbol["icon-halo-blur"]),"icon-translate":new $n(We.paint_symbol["icon-translate"]),"icon-translate-anchor":new $n(We.paint_symbol["icon-translate-anchor"]),"text-opacity":new ar(We.paint_symbol["text-opacity"]),"text-color":new ar(We.paint_symbol["text-color"],{runtimeType:Rn,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new ar(We.paint_symbol["text-halo-color"]),"text-halo-width":new ar(We.paint_symbol["text-halo-width"]),"text-halo-blur":new ar(We.paint_symbol["text-halo-blur"]),"text-translate":new $n(We.paint_symbol["text-translate"]),"text-translate-anchor":new $n(We.paint_symbol["text-translate-anchor"])})},get layout(){return Io=Io||new gi({"symbol-placement":new $n(We.layout_symbol["symbol-placement"]),"symbol-spacing":new $n(We.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new $n(We.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ar(We.layout_symbol["symbol-sort-key"]),"symbol-z-order":new $n(We.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new $n(We.layout_symbol["icon-allow-overlap"]),"icon-overlap":new $n(We.layout_symbol["icon-overlap"]),"icon-ignore-placement":new $n(We.layout_symbol["icon-ignore-placement"]),"icon-optional":new $n(We.layout_symbol["icon-optional"]),"icon-rotation-alignment":new $n(We.layout_symbol["icon-rotation-alignment"]),"icon-size":new ar(We.layout_symbol["icon-size"]),"icon-text-fit":new $n(We.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $n(We.layout_symbol["icon-text-fit-padding"]),"icon-image":new ar(We.layout_symbol["icon-image"]),"icon-rotate":new ar(We.layout_symbol["icon-rotate"]),"icon-padding":new ar(We.layout_symbol["icon-padding"]),"icon-keep-upright":new $n(We.layout_symbol["icon-keep-upright"]),"icon-offset":new ar(We.layout_symbol["icon-offset"]),"icon-anchor":new ar(We.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new $n(We.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new $n(We.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new $n(We.layout_symbol["text-rotation-alignment"]),"text-field":new ar(We.layout_symbol["text-field"]),"text-font":new ar(We.layout_symbol["text-font"]),"text-size":new ar(We.layout_symbol["text-size"]),"text-max-width":new ar(We.layout_symbol["text-max-width"]),"text-line-height":new $n(We.layout_symbol["text-line-height"]),"text-letter-spacing":new ar(We.layout_symbol["text-letter-spacing"]),"text-justify":new ar(We.layout_symbol["text-justify"]),"text-radial-offset":new ar(We.layout_symbol["text-radial-offset"]),"text-variable-anchor":new $n(We.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ar(We.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ar(We.layout_symbol["text-anchor"]),"text-max-angle":new $n(We.layout_symbol["text-max-angle"]),"text-writing-mode":new $n(We.layout_symbol["text-writing-mode"]),"text-rotate":new ar(We.layout_symbol["text-rotate"]),"text-padding":new $n(We.layout_symbol["text-padding"]),"text-keep-upright":new $n(We.layout_symbol["text-keep-upright"]),"text-transform":new ar(We.layout_symbol["text-transform"]),"text-offset":new ar(We.layout_symbol["text-offset"]),"text-allow-overlap":new $n(We.layout_symbol["text-allow-overlap"]),"text-overlap":new $n(We.layout_symbol["text-overlap"]),"text-ignore-placement":new $n(We.layout_symbol["text-ignore-placement"]),"text-optional":new $n(We.layout_symbol["text-optional"])})}};class Ux{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:It,this.defaultValue=a}evaluate(a){if(a.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(a.formattedSection))return h.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zn("FormatSectionOverride",Ux,{omit:["defaultValue"]});class $x extends oo{constructor(a){super(a,xc)}recalculate(a,h){if(super.recalculate(a,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const x=[];for(const C of p)x.indexOf(C)<0&&x.push(C);this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,h,p,x){const C=this.layout.get(a).evaluate(h,{},p,x),A=this._unevaluatedLayout._values[a];return A.isDataDriven()||sc(A.value)||!C?C:function(k,N){return N.replace(/{([^{}]+)}/g,(j,Y)=>k&&Y in k?String(k[Y]):"")}(h.properties,C)}createBucket(a){return new mr(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const a of xc.paint.overridableProperties){if(!$x.hasPaintOverride(this.layout,a))continue;const h=this.paint.get(a),p=new Ux(h),x=new Ou(p,h.property.specification);let C=null;C=h.value.kind==="constant"||h.value.kind==="source"?new Oa("source",x):new Jh("composite",x,h.value.zoomStops),this.paint._values[a]=new zs(h.property,C,h.parameters)}}_handleOverridablePaintPropertyUpdate(a,h,p){return!(!this.layout||h.isDataDriven()||p.isDataDriven())&&$x.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,h){const p=a.get("text-field"),x=xc.paint.properties[h];let C=!1;const A=k=>{for(const N of k)if(x.overrides&&x.overrides.hasOverride(N))return void(C=!0)};if(p.value.kind==="constant"&&p.value.value instanceof Di)A(p.value.value.sections);else if(p.value.kind==="source"){const k=j=>{C||(j instanceof ts&&sr(j.value)===kt?A(j.value.sections):j instanceof Nh?A(j.sections):j.eachChild(k))},N=p.value;N._styleExpression&&k(N._styleExpression.expression)}return C}}let hI;var K$={get paint(){return hI=hI||new gi({"background-color":new $n(We.paint_background["background-color"]),"background-pattern":new cd(We.paint_background["background-pattern"]),"background-opacity":new $n(We.paint_background["background-opacity"])})}};class J$ extends oo{constructor(a){super(a,K$)}}let dI;var Q$={get paint(){return dI=dI||new gi({"raster-opacity":new $n(We.paint_raster["raster-opacity"]),"raster-hue-rotate":new $n(We.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new $n(We.paint_raster["raster-brightness-min"]),"raster-brightness-max":new $n(We.paint_raster["raster-brightness-max"]),"raster-saturation":new $n(We.paint_raster["raster-saturation"]),"raster-contrast":new $n(We.paint_raster["raster-contrast"]),"raster-resampling":new $n(We.paint_raster["raster-resampling"]),"raster-fade-duration":new $n(We.paint_raster["raster-fade-duration"])})}};class e8 extends oo{constructor(a){super(a,Q$)}}class t8 extends oo{constructor(a){super(a,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class n8{constructor(a){this._methodToThrottle=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const r8={once:!0},wS=63710088e-1;class Df{constructor(a,h){if(isNaN(a)||isNaN(h))throw new Error(`Invalid LngLat object: (${a}, ${h})`);if(this.lng=+a,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Df(St(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const h=Math.PI/180,p=this.lat*h,x=a.lat*h,C=Math.sin(p)*Math.sin(x)+Math.cos(p)*Math.cos(x)*Math.cos((a.lng-this.lng)*h);return wS*Math.acos(Math.min(C,1))}static convert(a){if(a instanceof Df)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Df(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Df(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const fI=2*Math.PI*wS;function pI(d){return fI*Math.cos(d*Math.PI/180)}function mI(d){return(180+d)/360}function gI(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function vI(d,a){return d/pI(a)}function SS(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function yI(d,a){return d*pI(SS(a))}class Yy{constructor(a,h,p=0){this.x=+a,this.y=+h,this.z=+p}static fromLngLat(a,h=0){const p=Df.convert(a);return new Yy(mI(p.lng),gI(p.lat),vI(h,p.lat))}toLngLat(){return new Df(360*this.x-180,SS(this.y))}toAltitude(){return yI(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/fI*(a=SS(this.y),1/Math.cos(a*Math.PI/180));var a}}function _I(d,a,h){var p=2*Math.PI*6378137/256/Math.pow(2,h);return[d*p-2*Math.PI*6378137/2,a*p-2*Math.PI*6378137/2]}class MS{constructor(a,h,p){if(!function(x,C,A){return!(x<0||x>25||A<0||A>=Math.pow(2,x)||C<0||C>=Math.pow(2,x))}(a,h,p))throw new Error(`x=${h}, y=${p}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=h,this.y=p,this.key=Fg(0,a,a,h,p)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,h,p){const x=(A=this.y,k=this.z,N=_I(256*(C=this.x),256*(A=Math.pow(2,k)-A-1),k),j=_I(256*(C+1),256*(A+1),k),N[0]+","+N[1]+","+j[0]+","+j[1]);var C,A,k,N,j;const Y=function(Q,he,pe){let me,_e="";for(let ke=Q;ke>0;ke--)me=1<<ke-1,_e+=(he&me?1:0)+(pe&me?2:0);return _e}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,Y).replace(/{bbox-epsg-3857}/g,x)}isChildOf(a){const h=this.z-a.z;return h>0&&a.x===this.x>>h&&a.y===this.y>>h}getTilePoint(a){const h=Math.pow(2,this.z);return new R((a.x*h-this.x)*Qe,(a.y*h-this.y)*Qe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xI{constructor(a,h){this.wrap=a,this.canonical=h,this.key=Fg(a,h.z,h.z,h.x,h.y)}}class Cl{constructor(a,h,p,x,C){if(this.terrainRttPosMatrix32f=null,a<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${p}`);this.overscaledZ=a,this.wrap=h,this.canonical=new MS(p,+x,+C),this.key=Fg(h,a,p,x,C)}clone(){return new Cl(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-a;return a>this.canonical.z?new Cl(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Cl(a,this.wrap,a,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(a,h){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-a;return a>this.canonical.z?Fg(this.wrap*+h,a,this.canonical.z,this.canonical.x,this.canonical.y):Fg(this.wrap*+h,a,a,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(a){if(a.wrap!==this.wrap)return!1;const h=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>h&&a.canonical.y===this.canonical.y>>h}children(a){if(this.overscaledZ>=a)return[new Cl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,p=2*this.canonical.x,x=2*this.canonical.y;return[new Cl(h,this.wrap,h,p,x),new Cl(h,this.wrap,h,p+1,x),new Cl(h,this.wrap,h,p,x+1),new Cl(h,this.wrap,h,p+1,x+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new Cl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new Cl(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xI(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new Yy(a.x-this.wrap,a.y))}}function Fg(d,a,h,p,x){(d*=2)<0&&(d=-1*d-1);const C=1<<h;return(C*C*d+C*x+p).toString(36)+h.toString(36)+a.toString(36)}zn("CanonicalTileID",MS),zn("OverscaledTileID",Cl,{omit:["terrainRttPosMatrix32f"]});class hm{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(a){return this.minX=Math.min(this.minX,a.x),this.minY=Math.min(this.minY,a.y),this.maxX=Math.max(this.maxX,a.x),this.maxY=Math.max(this.maxY,a.y),this}expandBy(a){return this.minX-=a,this.minY-=a,this.maxX+=a,this.maxY+=a,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(a){return this.expandBy(-a)}map(a){const h=new hm;return h.extend(a(new R(this.minX,this.minY))),h.extend(a(new R(this.maxX,this.minY))),h.extend(a(new R(this.minX,this.maxY))),h.extend(a(new R(this.maxX,this.maxY))),h}static fromPoints(a){const h=new hm;for(const p of a)h.extend(p);return h}contains(a){return a.x>=this.minX&&a.x<=this.maxX&&a.y>=this.minY&&a.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(a){return!this.empty()&&!a.empty()&&a.minX>=this.minX&&a.maxX<=this.maxX&&a.minY>=this.minY&&a.maxY<=this.maxY}intersects(a){return!this.empty()&&!a.empty()&&a.minX<=this.maxX&&a.maxX>=this.minX&&a.minY<=this.maxY&&a.maxY>=this.minY}}class bI{constructor(a){this._stringToNumber={},this._numberToString=[];for(let h=0;h<a.length;h++){const p=a[h];this._stringToNumber[p]=h,this._numberToString[h]=p}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class wI{constructor(a,h,p,x,C){this.type="Feature",this._vectorTileFeature=a,a._z=h,a._x=p,a._y=x,this.properties=a.properties,this.id=C}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(a[h]=this[h]);return a}}class SI{constructor(a,h){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Ao(Qe,16,0),this.grid3D=new Ao(Qe,16,0),this.featureIndexArray=new Tt,this.promoteId=h}insert(a,h,p,x,C,A){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,x,C);const N=A?this.grid3D:this.grid;for(let j=0;j<h.length;j++){const Y=h[j],Q=[1/0,1/0,-1/0,-1/0];for(let he=0;he<Y.length;he++){const pe=Y[he];Q[0]=Math.min(Q[0],pe.x),Q[1]=Math.min(Q[1],pe.y),Q[2]=Math.max(Q[2],pe.x),Q[3]=Math.max(Q[3],pe.y)}Q[0]<Qe&&Q[1]<Qe&&Q[2]>=0&&Q[3]>=0&&N.insert(k,Q[0],Q[1],Q[2],Q[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new wd.VectorTile(new Rf(this.rawTileData)).layers,this.sourceLayerCoder=new bI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,h,p,x){this.loadVTLayers();const C=a.params,A=Qe/a.tileSize/a.scale,k=Fa(C.filter),N=a.queryGeometry,j=a.queryPadding*A,Y=hm.fromPoints(N),Q=this.grid.query(Y.minX-j,Y.minY-j,Y.maxX+j,Y.maxY+j),he=hm.fromPoints(a.cameraQueryGeometry).expandBy(j),pe=this.grid3D.query(he.minX,he.minY,he.maxX,he.maxY,(ke,Ve,dt,tt)=>function(de,De,rt,Rt,sn){for(const Vt of de)if(De<=Vt.x&&rt<=Vt.y&&Rt>=Vt.x&&sn>=Vt.y)return!0;const Ft=[new R(De,rt),new R(De,sn),new R(Rt,sn),new R(Rt,rt)];if(de.length>2){for(const Vt of Ft)if(th(de,Vt))return!0}for(let Vt=0;Vt<de.length-1;Vt++)if(xx(de[Vt],de[Vt+1],Ft))return!0;return!1}(a.cameraQueryGeometry,ke-j,Ve-j,dt+j,tt+j));for(const ke of pe)Q.push(ke);Q.sort(i8);const me={};let _e;for(let ke=0;ke<Q.length;ke++){const Ve=Q[ke];if(Ve===_e)continue;_e=Ve;const dt=this.featureIndexArray.get(Ve);let tt=null;this.loadMatchingFeature(me,dt.bucketIndex,dt.sourceLayerIndex,dt.featureIndex,k,C.layers,C.availableImages,h,p,x,(de,De,rt)=>(tt||(tt=Qu(de)),De.queryIntersectsFeature({queryGeometry:N,feature:de,featureState:rt,geometry:tt,zoom:this.z,transform:a.transform,pixelsToTileUnits:A,pixelPosMatrix:a.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:a.getElevation})))}return me}loadMatchingFeature(a,h,p,x,C,A,k,N,j,Y,Q){const he=this.bucketLayerIDs[h];if(A&&!he.some(ke=>A.has(ke)))return;const pe=this.sourceLayerCoder.decode(p),me=this.vtLayers[pe].feature(x);if(C.needGeometry){const ke=eh(me,!0);if(!C.filter(new si(this.tileID.overscaledZ),ke,this.tileID.canonical))return}else if(!C.filter(new si(this.tileID.overscaledZ),me))return;const _e=this.getId(me,pe);for(let ke=0;ke<he.length;ke++){const Ve=he[ke];if(A&&!A.has(Ve))continue;const dt=N[Ve];if(!dt)continue;let tt={};_e&&Y&&(tt=Y.getState(dt.sourceLayer||"_geojsonTileLayer",_e));const de=dn({},j[Ve]);de.paint=MI(de.paint,dt.paint,me,tt,k),de.layout=MI(de.layout,dt.layout,me,tt,k);const De=!Q||Q(me,dt,tt);if(!De)continue;const rt=new wI(me,this.z,this.x,this.y,_e);rt.layer=de;let Rt=a[Ve];Rt===void 0&&(Rt=a[Ve]=[]),Rt.push({featureIndex:x,feature:rt,intersectionZ:De})}}lookupSymbolFeatures(a,h,p,x,C,A,k,N){const j={};this.loadVTLayers();const Y=Fa(C);for(const Q of a)this.loadMatchingFeature(j,p,x,Q,Y,A,k,N,h);return j}hasLayer(a){for(const h of this.bucketLayerIDs)for(const p of h)if(a===p)return!0;return!1}getId(a,h){var p;let x=a.id;return this.promoteId&&(x=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof x=="boolean"&&(x=Number(x)),x===void 0&&(!((p=a.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(x=Number(a.properties.cluster_id))),x}}function MI(d,a,h,p,x){return un(d,(C,A)=>{const k=a instanceof gl?a.get(A):null;return k&&k.evaluate?k.evaluate(h,p,x):k})}function i8(d,a){return a-d}function CI(d,a,h,p,x){const C=[];for(let A=0;A<d.length;A++){const k=d[A];let N;for(let j=0;j<k.length-1;j++){let Y=k[j],Q=k[j+1];Y.x<a&&Q.x<a||(Y.x<a?Y=new R(a,Y.y+(a-Y.x)/(Q.x-Y.x)*(Q.y-Y.y))._round():Q.x<a&&(Q=new R(a,Y.y+(a-Y.x)/(Q.x-Y.x)*(Q.y-Y.y))._round()),Y.y<h&&Q.y<h||(Y.y<h?Y=new R(Y.x+(h-Y.y)/(Q.y-Y.y)*(Q.x-Y.x),h)._round():Q.y<h&&(Q=new R(Y.x+(h-Y.y)/(Q.y-Y.y)*(Q.x-Y.x),h)._round()),Y.x>=p&&Q.x>=p||(Y.x>=p?Y=new R(p,Y.y+(p-Y.x)/(Q.x-Y.x)*(Q.y-Y.y))._round():Q.x>=p&&(Q=new R(p,Y.y+(p-Y.x)/(Q.x-Y.x)*(Q.y-Y.y))._round()),Y.y>=x&&Q.y>=x||(Y.y>=x?Y=new R(Y.x+(x-Y.y)/(Q.y-Y.y)*(Q.x-Y.x),x)._round():Q.y>=x&&(Q=new R(Y.x+(x-Y.y)/(Q.y-Y.y)*(Q.x-Y.x),x)._round()),N&&Y.equals(N[N.length-1])||(N=[Y],C.push(N)),N.push(Q)))))}}return C}zn("FeatureIndex",SI,{omit:["rawTileData","sourceLayerCoder"]});class kf extends R{constructor(a,h,p,x){super(a,h),this.angle=p,x!==void 0&&(this.segment=x)}clone(){return new kf(this.x,this.y,this.angle,this.segment)}}function EI(d,a,h,p,x){if(a.segment===void 0||h===0)return!0;let C=a,A=a.segment+1,k=0;for(;k>-h/2;){if(A--,A<0)return!1;k-=d[A].dist(C),C=d[A]}k+=d[A].dist(d[A+1]),A++;const N=[];let j=0;for(;k<h/2;){const Y=d[A],Q=d[A+1];if(!Q)return!1;let he=d[A-1].angleTo(Y)-Y.angleTo(Q);for(he=Math.abs((he+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:k,angleDelta:he}),j+=he;k-N[0].distance>p;)j-=N.shift().angleDelta;if(j>x)return!1;A++,k+=Y.dist(Q)}return!0}function TI(d){let a=0;for(let h=0;h<d.length-1;h++)a+=d[h].dist(d[h+1]);return a}function PI(d,a,h){return d?.6*a*h:0}function AI(d,a){return Math.max(d?d.right-d.left:0,a?a.right-a.left:0)}function o8(d,a,h,p,x,C){const A=PI(h,x,C),k=AI(h,p)*C;let N=0;const j=TI(d)/2;for(let Y=0;Y<d.length-1;Y++){const Q=d[Y],he=d[Y+1],pe=Q.dist(he);if(N+pe>j){const me=(j-N)/pe,_e=Ls.number(Q.x,he.x,me),ke=Ls.number(Q.y,he.y,me),Ve=new kf(_e,ke,he.angleTo(Q),Y);return Ve._round(),!A||EI(d,Ve,k,A,a)?Ve:void 0}N+=pe}}function s8(d,a,h,p,x,C,A,k,N){const j=PI(p,C,A),Y=AI(p,x),Q=Y*A,he=d[0].x===0||d[0].x===N||d[0].y===0||d[0].y===N;return a-Q<a/4&&(a=Q+a/4),II(d,he?a/2*k%a:(Y/2+2*C)*A*k%a,a,j,h,Q,he,!1,N)}function II(d,a,h,p,x,C,A,k,N){const j=C/2,Y=TI(d);let Q=0,he=a-h,pe=[];for(let me=0;me<d.length-1;me++){const _e=d[me],ke=d[me+1],Ve=_e.dist(ke),dt=ke.angleTo(_e);for(;he+h<Q+Ve;){he+=h;const tt=(he-Q)/Ve,de=Ls.number(_e.x,ke.x,tt),De=Ls.number(_e.y,ke.y,tt);if(de>=0&&de<N&&De>=0&&De<N&&he-j>=0&&he+j<=Y){const rt=new kf(de,De,dt,me);rt._round(),p&&!EI(d,rt,C,p,x)||pe.push(rt)}}Q+=Ve}return k||pe.length||A||(pe=II(d,Q/2,h,p,x,C,A,!0,N)),pe}function RI(d,a,h,p){const x=[],C=d.image,A=C.pixelRatio,k=C.paddedRect.w-2,N=C.paddedRect.h-2;let j={x1:d.left,y1:d.top,x2:d.right,y2:d.bottom};const Y=C.stretchX||[[0,k]],Q=C.stretchY||[[0,N]],he=(Xt,Hn)=>Xt+Hn[1]-Hn[0],pe=Y.reduce(he,0),me=Q.reduce(he,0),_e=k-pe,ke=N-me;let Ve=0,dt=pe,tt=0,de=me,De=0,rt=_e,Rt=0,sn=ke;if(C.content&&p){const Xt=C.content,Hn=Xt[2]-Xt[0],hr=Xt[3]-Xt[1];(C.textFitWidth||C.textFitHeight)&&(j=Mn(d)),Ve=Vx(Y,0,Xt[0]),tt=Vx(Q,0,Xt[1]),dt=Vx(Y,Xt[0],Xt[2]),de=Vx(Q,Xt[1],Xt[3]),De=Xt[0]-Ve,Rt=Xt[1]-tt,rt=Hn-dt,sn=hr-de}const Ft=j.x1,Vt=j.y1,gn=j.x2-Ft,an=j.y2-Vt,xn=(Xt,Hn,hr,lr)=>{const Jn=jx(Xt.stretch-Ve,dt,gn,Ft),Dr=Hx(Xt.fixed-De,rt,Xt.stretch,pe),qi=jx(Hn.stretch-tt,de,an,Vt),Ro=Hx(Hn.fixed-Rt,sn,Hn.stretch,me),Cs=jx(hr.stretch-Ve,dt,gn,Ft),El=Hx(hr.fixed-De,rt,hr.stretch,pe),ba=jx(lr.stretch-tt,de,an,Vt),us=Hx(lr.fixed-Rt,sn,lr.stretch,me),$i=new R(Jn,qi),Go=new R(Cs,qi),hs=new R(Cs,ba),ds=new R(Jn,ba),ra=new R(Dr/A,Ro/A),Tl=new R(El/A,us/A),Wo=a*Math.PI/180;if(Wo){const qo=Math.sin(Wo),Xo=Math.cos(Wo),xo=[Xo,-qo,qo,Xo];$i._matMult(xo),Go._matMult(xo),ds._matMult(xo),hs._matMult(xo)}const wa=Xt.stretch+Xt.fixed,Lo=Hn.stretch+Hn.fixed;return{tl:$i,tr:Go,bl:ds,br:hs,tex:{x:C.paddedRect.x+1+wa,y:C.paddedRect.y+1+Lo,w:hr.stretch+hr.fixed-wa,h:lr.stretch+lr.fixed-Lo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ra,pixelOffsetBR:Tl,minFontScaleX:rt/A/gn,minFontScaleY:sn/A/an,isSDF:h}};if(p&&(C.stretchX||C.stretchY)){const Xt=LI(Y,_e,pe),Hn=LI(Q,ke,me);for(let hr=0;hr<Xt.length-1;hr++){const lr=Xt[hr],Jn=Xt[hr+1];for(let Dr=0;Dr<Hn.length-1;Dr++)x.push(xn(lr,Hn[Dr],Jn,Hn[Dr+1]))}}else x.push(xn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:N+1}));return x}function Vx(d,a,h){let p=0;for(const x of d)p+=Math.max(a,Math.min(h,x[1]))-Math.max(a,Math.min(h,x[0]));return p}function LI(d,a,h){const p=[{fixed:-1,stretch:0}];for(const[x,C]of d){const A=p[p.length-1];p.push({fixed:x-A.stretch,stretch:A.stretch}),p.push({fixed:x-A.stretch,stretch:A.stretch+(C-x)})}return p.push({fixed:a+1,stretch:h}),p}function jx(d,a,h,p){return d/a*h+p}function Hx(d,a,h,p){return d-a*h/p}zn("Anchor",kf);class Gx{constructor(a,h,p,x,C,A,k,N,j,Y){var Q;if(this.boxStartIndex=a.length,j){let he=A.top,pe=A.bottom;const me=A.collisionPadding;me&&(he-=me[1],pe+=me[3]);let _e=pe-he;_e>0&&(_e=Math.max(10,_e),this.circleDiameter=_e)}else{const he=!((Q=A.image)===null||Q===void 0)&&Q.content&&(A.image.textFitWidth||A.image.textFitHeight)?Mn(A):{x1:A.left,y1:A.top,x2:A.right,y2:A.bottom};he.y1=he.y1*k-N[0],he.y2=he.y2*k+N[2],he.x1=he.x1*k-N[3],he.x2=he.x2*k+N[1];const pe=A.collisionPadding;if(pe&&(he.x1-=pe[0]*k,he.y1-=pe[1]*k,he.x2+=pe[2]*k,he.y2+=pe[3]*k),Y){const me=new R(he.x1,he.y1),_e=new R(he.x2,he.y1),ke=new R(he.x1,he.y2),Ve=new R(he.x2,he.y2),dt=Y*Math.PI/180;me._rotate(dt),_e._rotate(dt),ke._rotate(dt),Ve._rotate(dt),he.x1=Math.min(me.x,_e.x,ke.x,Ve.x),he.x2=Math.max(me.x,_e.x,ke.x,Ve.x),he.y1=Math.min(me.y,_e.y,ke.y,Ve.y),he.y2=Math.max(me.y,_e.y,ke.y,Ve.y)}a.emplaceBack(h.x,h.y,he.x1,he.y1,he.x2,he.y2,p,x,C)}this.boxEndIndex=a.length}}class a8{constructor(a=[],h=(p,x)=>p<x?-1:p>x?1:0){if(this.data=a,this.length=this.data.length,this.compare=h,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:h,compare:p}=this,x=h[a];for(;a>0;){const C=a-1>>1,A=h[C];if(p(x,A)>=0)break;h[a]=A,a=C}h[a]=x}_down(a){const{data:h,compare:p}=this,x=this.length>>1,C=h[a];for(;a<x;){let A=1+(a<<1);const k=A+1;if(k<this.length&&p(h[k],h[A])<0&&(A=k),p(h[A],C)>=0)break;h[a]=h[A],a=A}h[a]=C}}function l8(d,a=1,h=!1){const p=hm.fromPoints(d[0]),x=Math.min(p.width(),p.height());let C=x/2;const A=new a8([],c8),{minX:k,minY:N,maxX:j,maxY:Y}=p;if(x===0)return new R(k,N);for(let pe=k;pe<j;pe+=x)for(let me=N;me<Y;me+=x)A.push(new Ng(pe+C,me+C,C,d));let Q=function(pe){let me=0,_e=0,ke=0;const Ve=pe[0];for(let dt=0,tt=Ve.length,de=tt-1;dt<tt;de=dt++){const De=Ve[dt],rt=Ve[de],Rt=De.x*rt.y-rt.x*De.y;_e+=(De.x+rt.x)*Rt,ke+=(De.y+rt.y)*Rt,me+=3*Rt}return new Ng(_e/me,ke/me,0,pe)}(d),he=A.length;for(;A.length;){const pe=A.pop();(pe.d>Q.d||!Q.d)&&(Q=pe,h&&console.log("found best %d after %d probes",Math.round(1e4*pe.d)/1e4,he)),pe.max-Q.d<=a||(C=pe.h/2,A.push(new Ng(pe.p.x-C,pe.p.y-C,C,d)),A.push(new Ng(pe.p.x+C,pe.p.y-C,C,d)),A.push(new Ng(pe.p.x-C,pe.p.y+C,C,d)),A.push(new Ng(pe.p.x+C,pe.p.y+C,C,d)),he+=4)}return h&&(console.log(`num probes: ${he}`),console.log(`best distance: ${Q.d}`)),Q.p}function c8(d,a){return a.max-d.max}function Ng(d,a,h,p){this.p=new R(d,a),this.h=h,this.d=function(x,C){let A=!1,k=1/0;for(let N=0;N<C.length;N++){const j=C[N];for(let Y=0,Q=j.length,he=Q-1;Y<Q;he=Y++){const pe=j[Y],me=j[he];pe.y>x.y!=me.y>x.y&&x.x<(me.x-pe.x)*(x.y-pe.y)/(me.y-pe.y)+pe.x&&(A=!A),k=Math.min(k,xg(x,pe,me))}}return(A?1:-1)*Math.sqrt(k)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var Ms;c.aD=void 0,(Ms=c.aD||(c.aD={}))[Ms.center=1]="center",Ms[Ms.left=2]="left",Ms[Ms.right=3]="right",Ms[Ms.top=4]="top",Ms[Ms.bottom=5]="bottom",Ms[Ms["top-left"]=6]="top-left",Ms[Ms["top-right"]=7]="top-right",Ms[Ms["bottom-left"]=8]="bottom-left",Ms[Ms["bottom-right"]=9]="bottom-right";const CS=Number.POSITIVE_INFINITY;function DI(d,a){return a[1]!==CS?function(h,p,x){let C=0,A=0;switch(p=Math.abs(p),x=Math.abs(x),h){case"top-right":case"top-left":case"top":A=x-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-x}switch(h){case"top-right":case"bottom-right":case"right":C=-p;break;case"top-left":case"bottom-left":case"left":C=p}return[C,A]}(d,a[0],a[1]):function(h,p){let x=0,C=0;p<0&&(p=0);const A=p/Math.SQRT2;switch(h){case"top-right":case"top-left":C=A-7;break;case"bottom-right":case"bottom-left":C=7-A;break;case"bottom":C=7-p;break;case"top":C=p-7}switch(h){case"top-right":case"bottom-right":x=-A;break;case"top-left":case"bottom-left":x=A;break;case"left":x=p;break;case"right":x=-p}return[x,C]}(d,a[0])}function kI(d,a,h){var p;const x=d.layout,C=(p=x.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(a,{},h);if(C){const k=C.values,N=[];for(let j=0;j<k.length;j+=2){const Y=N[j]=k[j],Q=k[j+1].map(he=>he*to);Y.startsWith("top")?Q[1]-=7:Y.startsWith("bottom")&&(Q[1]+=7),N[j+1]=Q}return new Tr(N)}const A=x.get("text-variable-anchor");if(A){let k;k=d._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[x.get("text-radial-offset").evaluate(a,{},h)*to,CS]:x.get("text-offset").evaluate(a,{},h).map(j=>j*to);const N=[];for(const j of A)N.push(j,DI(j,k));return new Tr(N)}return null}function ES(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function u8(d,a,h,p,x,C,A,k,N,j,Y,Q){let he=C.textMaxSize.evaluate(a,{});he===void 0&&(he=A);const pe=d.layers[0].layout,me=pe.get("icon-offset").evaluate(a,{},Y),_e=OI(h.horizontal),ke=A/24,Ve=d.tilePixelRatio*ke,dt=d.tilePixelRatio*he/24,tt=d.tilePixelRatio*k,de=d.tilePixelRatio*pe.get("symbol-spacing"),De=pe.get("text-padding")*d.tilePixelRatio,rt=function(hr,lr,Jn,Dr=1){const qi=hr.get("icon-padding").evaluate(lr,{},Jn),Ro=qi&&qi.values;return[Ro[0]*Dr,Ro[1]*Dr,Ro[2]*Dr,Ro[3]*Dr]}(pe,a,Y,d.tilePixelRatio),Rt=pe.get("text-max-angle")/180*Math.PI,sn=pe.get("text-rotation-alignment")!=="viewport"&&pe.get("symbol-placement")!=="point",Ft=pe.get("icon-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",Vt=pe.get("symbol-placement"),gn=de/2,an=pe.get("icon-text-fit");let xn;p&&an!=="none"&&(d.allowVerticalPlacement&&h.vertical&&(xn=yn(p,h.vertical,an,pe.get("icon-text-fit-padding"),me,ke)),_e&&(p=yn(p,_e,an,pe.get("icon-text-fit-padding"),me,ke)));const Xt=Y?Q.line.getGranularityForZoomLevel(Y.z):1,Hn=(hr,lr)=>{lr.x<0||lr.x>=Qe||lr.y<0||lr.y>=Qe||function(Jn,Dr,qi,Ro,Cs,El,ba,us,$i,Go,hs,ds,ra,Tl,Wo,wa,Lo,qo,Xo,xo,Ai,su,Bg,au,f8){const Ug=Jn.addToLineVertexArray(Dr,qi);let dm,$g,Vg,jg,UI=0,$I=0,VI=0,jI=0,kS=-1,zS=-1;const Td={};let HI=as("");if(Jn.allowVerticalPlacement&&Ro.vertical){const Vs=us.layout.get("text-rotate").evaluate(Ai,{},au)+90;Vg=new Gx($i,Dr,Go,hs,ds,Ro.vertical,ra,Tl,Wo,Vs),ba&&(jg=new Gx($i,Dr,Go,hs,ds,ba,Lo,qo,Wo,Vs))}if(Cs){const Vs=us.layout.get("icon-rotate").evaluate(Ai,{}),Pl=us.layout.get("icon-text-fit")!=="none",fm=RI(Cs,Vs,Bg,Pl),cu=ba?RI(ba,Vs,Bg,Pl):void 0;$g=new Gx($i,Dr,Go,hs,ds,Cs,Lo,qo,!1,Vs),UI=4*fm.length;const pm=Jn.iconSizeData;let uh=null;pm.kind==="source"?(uh=[Un*us.layout.get("icon-size").evaluate(Ai,{})],uh[0]>Yn&&fn(`${Jn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):pm.kind==="composite"&&(uh=[Un*su.compositeIconSizes[0].evaluate(Ai,{},au),Un*su.compositeIconSizes[1].evaluate(Ai,{},au)],(uh[0]>Yn||uh[1]>Yn)&&fn(`${Jn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Jn.addSymbols(Jn.icon,fm,uh,xo,Xo,Ai,c.an.none,Dr,Ug.lineStartIndex,Ug.lineLength,-1,au),kS=Jn.icon.placedSymbolArray.length-1,cu&&($I=4*cu.length,Jn.addSymbols(Jn.icon,cu,uh,xo,Xo,Ai,c.an.vertical,Dr,Ug.lineStartIndex,Ug.lineLength,-1,au),zS=Jn.icon.placedSymbolArray.length-1)}const GI=Object.keys(Ro.horizontal);for(const Vs of GI){const Pl=Ro.horizontal[Vs];if(!dm){HI=as(Pl.text);const cu=us.layout.get("text-rotate").evaluate(Ai,{},au);dm=new Gx($i,Dr,Go,hs,ds,Pl,ra,Tl,Wo,cu)}const fm=Pl.positionedLines.length===1;if(VI+=zI(Jn,Dr,Pl,El,us,Wo,Ai,wa,Ug,Ro.vertical?c.an.horizontal:c.an.horizontalOnly,fm?GI:[Vs],Td,kS,su,au),fm)break}Ro.vertical&&(jI+=zI(Jn,Dr,Ro.vertical,El,us,Wo,Ai,wa,Ug,c.an.vertical,["vertical"],Td,zS,su,au));const p8=dm?dm.boxStartIndex:Jn.collisionBoxArray.length,m8=dm?dm.boxEndIndex:Jn.collisionBoxArray.length,g8=Vg?Vg.boxStartIndex:Jn.collisionBoxArray.length,v8=Vg?Vg.boxEndIndex:Jn.collisionBoxArray.length,y8=$g?$g.boxStartIndex:Jn.collisionBoxArray.length,_8=$g?$g.boxEndIndex:Jn.collisionBoxArray.length,x8=jg?jg.boxStartIndex:Jn.collisionBoxArray.length,b8=jg?jg.boxEndIndex:Jn.collisionBoxArray.length;let lu=-1;const qx=(Vs,Pl)=>Vs&&Vs.circleDiameter?Math.max(Vs.circleDiameter,Pl):Pl;lu=qx(dm,lu),lu=qx(Vg,lu),lu=qx($g,lu),lu=qx(jg,lu);const WI=lu>-1?1:0;WI&&(lu*=f8/to),Jn.glyphOffsetArray.length>=mr.MAX_GLYPHS&&fn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ai.sortKey!==void 0&&Jn.addToSortKeyRanges(Jn.symbolInstances.length,Ai.sortKey);const w8=kI(us,Ai,au),[S8,M8]=function(Vs,Pl){const fm=Vs.length,cu=Pl?.values;if(cu?.length>0)for(let pm=0;pm<cu.length;pm+=2){const uh=cu[pm+1];Vs.emplaceBack(c.aD[cu[pm]],uh[0],uh[1])}return[fm,Vs.length]}(Jn.textAnchorOffsets,w8);Jn.symbolInstances.emplaceBack(Dr.x,Dr.y,Td.right>=0?Td.right:-1,Td.center>=0?Td.center:-1,Td.left>=0?Td.left:-1,Td.vertical||-1,kS,zS,HI,p8,m8,g8,v8,y8,_8,x8,b8,Go,VI,jI,UI,$I,WI,0,ra,lu,S8,M8)}(d,lr,hr,h,p,x,xn,d.layers[0],d.collisionBoxArray,a.index,a.sourceLayerIndex,d.index,Ve,[De,De,De,De],sn,N,tt,rt,Ft,me,a,C,j,Y,A)};if(Vt==="line")for(const hr of CI(a.geometry,0,0,Qe,Qe)){const lr=vc(hr,Xt),Jn=s8(lr,de,Rt,h.vertical||_e,p,24,dt,d.overscaling,Qe);for(const Dr of Jn)_e&&h8(d,_e.text,gn,Dr)||Hn(lr,Dr)}else if(Vt==="line-center"){for(const hr of a.geometry)if(hr.length>1){const lr=vc(hr,Xt),Jn=o8(lr,Rt,h.vertical||_e,p,24,dt);Jn&&Hn(lr,Jn)}}else if(a.type==="Polygon")for(const hr of Ql(a.geometry,0)){const lr=l8(hr,16);Hn(vc(hr[0],Xt,!0),new kf(lr.x,lr.y,0))}else if(a.type==="LineString")for(const hr of a.geometry){const lr=vc(hr,Xt);Hn(lr,new kf(lr[0].x,lr[0].y,0))}else if(a.type==="Point")for(const hr of a.geometry)for(const lr of hr)Hn([lr],new kf(lr.x,lr.y,0))}function zI(d,a,h,p,x,C,A,k,N,j,Y,Q,he,pe,me){const _e=function(dt,tt,de,De,rt,Rt,sn,Ft){const Vt=De.layout.get("text-rotate").evaluate(Rt,{})*Math.PI/180,gn=[];for(const an of tt.positionedLines)for(const xn of an.positionedGlyphs){if(!xn.rect)continue;const Xt=xn.rect||{};let Hn=4,hr=!0,lr=1,Jn=0;const Dr=(rt||Ft)&&xn.vertical,qi=xn.metrics.advance*xn.scale/2;if(Ft&&tt.verticalizable&&(Jn=an.lineOffset/2-(xn.imageName?-(to-xn.metrics.width*xn.scale)/2:(xn.scale-1)*to)),xn.imageName){const qo=sn[xn.imageName];hr=qo.sdf,lr=qo.pixelRatio,Hn=1/lr}const Ro=rt?[xn.x+qi,xn.y]:[0,0];let Cs=rt?[0,0]:[xn.x+qi+de[0],xn.y+de[1]-Jn],El=[0,0];Dr&&(El=Cs,Cs=[0,0]);const ba=xn.metrics.isDoubleResolution?2:1,us=(xn.metrics.left-Hn)*xn.scale-qi+Cs[0],$i=(-xn.metrics.top-Hn)*xn.scale+Cs[1],Go=us+Xt.w/ba*xn.scale/lr,hs=$i+Xt.h/ba*xn.scale/lr,ds=new R(us,$i),ra=new R(Go,$i),Tl=new R(us,hs),Wo=new R(Go,hs);if(Dr){const qo=new R(-qi,qi- -17),Xo=-Math.PI/2,xo=12-qi,Ai=new R(22-xo,-(xn.imageName?xo:0)),su=new R(...El);ds._rotateAround(Xo,qo)._add(Ai)._add(su),ra._rotateAround(Xo,qo)._add(Ai)._add(su),Tl._rotateAround(Xo,qo)._add(Ai)._add(su),Wo._rotateAround(Xo,qo)._add(Ai)._add(su)}if(Vt){const qo=Math.sin(Vt),Xo=Math.cos(Vt),xo=[Xo,-qo,qo,Xo];ds._matMult(xo),ra._matMult(xo),Tl._matMult(xo),Wo._matMult(xo)}const wa=new R(0,0),Lo=new R(0,0);gn.push({tl:ds,tr:ra,bl:Tl,br:Wo,tex:Xt,writingMode:tt.writingMode,glyphOffset:Ro,sectionIndex:xn.sectionIndex,isSDF:hr,pixelOffsetTL:wa,pixelOffsetBR:Lo,minFontScaleX:0,minFontScaleY:0})}return gn}(0,h,k,x,C,A,p,d.allowVerticalPlacement),ke=d.textSizeData;let Ve=null;ke.kind==="source"?(Ve=[Un*x.layout.get("text-size").evaluate(A,{})],Ve[0]>Yn&&fn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ke.kind==="composite"&&(Ve=[Un*pe.compositeTextSizes[0].evaluate(A,{},me),Un*pe.compositeTextSizes[1].evaluate(A,{},me)],(Ve[0]>Yn||Ve[1]>Yn)&&fn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),d.addSymbols(d.text,_e,Ve,k,C,A,j,a,N.lineStartIndex,N.lineLength,he,me);for(const dt of Y)Q[dt]=d.text.placedSymbolArray.length-1;return 4*_e.length}function OI(d){for(const a in d)return d[a];return null}function h8(d,a,h,p){const x=d.compareText;if(a in x){const C=x[a];for(let A=C.length-1;A>=0;A--)if(p.dist(C[A])<h)return!0}else x[a]=[];return x[a].push(p),!1}const FI=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class TS{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,p]=new Uint8Array(a,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const x=p>>4;if(x!==1)throw new Error(`Got v${x} data when expected v1.`);const C=FI[15&p];if(!C)throw new Error("Unrecognized array type.");const[A]=new Uint16Array(a,2,1),[k]=new Uint32Array(a,4,1);return new TS(k,A,C,a)}constructor(a,h=64,p=Float64Array,x){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=p,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const C=FI.indexOf(this.ArrayType),A=2*a*this.ArrayType.BYTES_PER_ELEMENT,k=a*this.IndexArrayType.BYTES_PER_ELEMENT,N=(8-k%8)%8;if(C<0)throw new Error(`Unexpected typed array class: ${p}.`);x&&x instanceof ArrayBuffer?(this.data=x,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+k+N,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+A+k+N),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+k+N,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+C]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=a)}add(a,h){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=a,this.coords[this._pos++]=h,p}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return PS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,h,p,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:C,coords:A,nodeSize:k}=this,N=[0,C.length-1,0],j=[];for(;N.length;){const Y=N.pop()||0,Q=N.pop()||0,he=N.pop()||0;if(Q-he<=k){for(let ke=he;ke<=Q;ke++){const Ve=A[2*ke],dt=A[2*ke+1];Ve>=a&&Ve<=p&&dt>=h&&dt<=x&&j.push(C[ke])}continue}const pe=he+Q>>1,me=A[2*pe],_e=A[2*pe+1];me>=a&&me<=p&&_e>=h&&_e<=x&&j.push(C[pe]),(Y===0?a<=me:h<=_e)&&(N.push(he),N.push(pe-1),N.push(1-Y)),(Y===0?p>=me:x>=_e)&&(N.push(pe+1),N.push(Q),N.push(1-Y))}return j}within(a,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:C,nodeSize:A}=this,k=[0,x.length-1,0],N=[],j=p*p;for(;k.length;){const Y=k.pop()||0,Q=k.pop()||0,he=k.pop()||0;if(Q-he<=A){for(let ke=he;ke<=Q;ke++)BI(C[2*ke],C[2*ke+1],a,h)<=j&&N.push(x[ke]);continue}const pe=he+Q>>1,me=C[2*pe],_e=C[2*pe+1];BI(me,_e,a,h)<=j&&N.push(x[pe]),(Y===0?a-p<=me:h-p<=_e)&&(k.push(he),k.push(pe-1),k.push(1-Y)),(Y===0?a+p>=me:h+p>=_e)&&(k.push(pe+1),k.push(Q),k.push(1-Y))}return N}}function PS(d,a,h,p,x,C){if(x-p<=h)return;const A=p+x>>1;NI(d,a,A,p,x,C),PS(d,a,h,p,A-1,1-C),PS(d,a,h,A+1,x,1-C)}function NI(d,a,h,p,x,C){for(;x>p;){if(x-p>600){const j=x-p+1,Y=h-p+1,Q=Math.log(j),he=.5*Math.exp(2*Q/3),pe=.5*Math.sqrt(Q*he*(j-he)/j)*(Y-j/2<0?-1:1);NI(d,a,h,Math.max(p,Math.floor(h-Y*he/j+pe)),Math.min(x,Math.floor(h+(j-Y)*he/j+pe)),C)}const A=a[2*h+C];let k=p,N=x;for(Ky(d,a,p,h),a[2*x+C]>A&&Ky(d,a,p,x);k<N;){for(Ky(d,a,k,N),k++,N--;a[2*k+C]<A;)k++;for(;a[2*N+C]>A;)N--}a[2*p+C]===A?Ky(d,a,p,N):(N++,Ky(d,a,N,x)),N<=h&&(p=N+1),h<=N&&(x=N-1)}}function Ky(d,a,h,p){AS(d,h,p),AS(a,2*h,2*p),AS(a,2*h+1,2*p+1)}function AS(d,a,h){const p=d[a];d[a]=d[h],d[h]=p}function BI(d,a,h,p){const x=d-h,C=a-p;return x*x+C*C}var IS;c.cw=void 0,(IS=c.cw||(c.cw={})).create="create",IS.load="load",IS.fullLoad="fullLoad";let Wx=null,Jy=[];const RS=1e3/60,LS="loadTime",DS="fullLoadTime",d8={mark(d){performance.mark(d)},frame(d){const a=d;Wx!=null&&Jy.push(a-Wx),Wx=a},clearMetrics(){Wx=null,Jy=[],performance.clearMeasures(LS),performance.clearMeasures(DS);for(const d in c.cw)performance.clearMarks(c.cw[d])},getPerformanceMetrics(){performance.measure(LS,c.cw.create,c.cw.load),performance.measure(DS,c.cw.create,c.cw.fullLoad);const d=performance.getEntriesByName(LS)[0].duration,a=performance.getEntriesByName(DS)[0].duration,h=Jy.length,p=1/(Jy.reduce((C,A)=>C+A,0)/h/1e3),x=Jy.filter(C=>C>RS).reduce((C,A)=>C+(A-RS)/RS,0);return{loadTime:d,fullLoadTime:a,fps:p,percentDroppedFrames:x/(h+x)*100,totalFrames:h}}};c.$=Qe,c.A=q,c.B=function([d,a,h]){return a+=90,a*=Math.PI/180,h*=Math.PI/180,{x:d*Math.cos(a)*Math.sin(h),y:d*Math.sin(a)*Math.sin(h),z:d*Math.cos(h)}},c.C=Ls,c.D=$n,c.E=ut,c.F=si,c.G=pl,c.H=function(d){if(vn==null){const a=d.navigator?d.navigator.userAgent:null;vn=!!d.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return vn},c.I=lm,c.J=class{constructor(d,a){this.target=d,this.mapId=a,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new n8(()=>this.process()),this.subscription=Ot(this.target,"message",h=>this.receive(h),!1),this.globalScope=Nn(self)?d:window}registerMessageHandler(d,a){this.messageHandlers[d]=a}sendAsync(d,a){return new Promise((h,p)=>{const x=Math.round(1e18*Math.random()).toString(36).substring(0,10),C=a?Ot(a.signal,"abort",()=>{C?.unsubscribe(),delete this.resolveRejects[x];const N={id:x,type:"<cancel>",origin:location.origin,targetMapId:d.targetMapId,sourceMapId:this.mapId};this.target.postMessage(N)},r8):null;this.resolveRejects[x]={resolve:N=>{C?.unsubscribe(),h(N)},reject:N=>{C?.unsubscribe(),p(N)}};const A=[],k=Object.assign(Object.assign({},d),{id:x,sourceMapId:this.mapId,origin:location.origin,data:ju(d.data,A)});this.target.postMessage(k,{transfer:A})})}receive(d){const a=d.data,h=a.id;if(!(a.origin!=="file://"&&location.origin!=="file://"&&a.origin!=="resource://android"&&location.origin!=="resource://android"&&a.origin!==location.origin||a.targetMapId&&this.mapId!==a.targetMapId)){if(a.type==="<cancel>"){delete this.tasks[h];const p=this.abortControllers[h];return delete this.abortControllers[h],void(p&&p.abort())}if(Nn(self)||a.mustQueue)return this.tasks[h]=a,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,a)}}process(){if(this.taskQueue.length===0)return;const d=this.taskQueue.shift(),a=this.tasks[d];delete this.tasks[d],this.taskQueue.length>0&&this.invoker.trigger(),a&&this.processTask(d,a)}processTask(d,a){return s(this,void 0,void 0,function*(){if(a.type==="<response>"){const x=this.resolveRejects[d];return delete this.resolveRejects[d],x?void(a.error?x.reject(hc(a.error)):x.resolve(hc(a.data))):void 0}if(!this.messageHandlers[a.type])return void this.completeTask(d,new Error(`Could not find a registered handler for ${a.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=hc(a.data),p=new AbortController;this.abortControllers[d]=p;try{const x=yield this.messageHandlers[a.type](a.sourceMapId,h,p);this.completeTask(d,null,x)}catch(x){this.completeTask(d,x)}})}completeTask(d,a,h){const p=[];delete this.abortControllers[d];const x={id:d,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:a?ju(a):null,data:ju(h,p)};this.target.postMessage(x,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},c.K=ee,c.L=function(){var d=new q(16);return q!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0),d[0]=1,d[5]=1,d[10]=1,d[15]=1,d},c.M=function(d,a,h){var p,x,C,A,k,N,j,Y,Q,he,pe,me,_e=h[0],ke=h[1],Ve=h[2];return a===d?(d[12]=a[0]*_e+a[4]*ke+a[8]*Ve+a[12],d[13]=a[1]*_e+a[5]*ke+a[9]*Ve+a[13],d[14]=a[2]*_e+a[6]*ke+a[10]*Ve+a[14],d[15]=a[3]*_e+a[7]*ke+a[11]*Ve+a[15]):(x=a[1],C=a[2],A=a[3],k=a[4],N=a[5],j=a[6],Y=a[7],Q=a[8],he=a[9],pe=a[10],me=a[11],d[0]=p=a[0],d[1]=x,d[2]=C,d[3]=A,d[4]=k,d[5]=N,d[6]=j,d[7]=Y,d[8]=Q,d[9]=he,d[10]=pe,d[11]=me,d[12]=p*_e+k*ke+Q*Ve+a[12],d[13]=x*_e+N*ke+he*Ve+a[13],d[14]=C*_e+j*ke+pe*Ve+a[14],d[15]=A*_e+Y*ke+me*Ve+a[15]),d},c.N=function(d,a,h){var p=h[0],x=h[1],C=h[2];return d[0]=a[0]*p,d[1]=a[1]*p,d[2]=a[2]*p,d[3]=a[3]*p,d[4]=a[4]*x,d[5]=a[5]*x,d[6]=a[6]*x,d[7]=a[7]*x,d[8]=a[8]*C,d[9]=a[9]*C,d[10]=a[10]*C,d[11]=a[11]*C,d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15],d},c.O=function(d,a,h){var p=a[0],x=a[1],C=a[2],A=a[3],k=a[4],N=a[5],j=a[6],Y=a[7],Q=a[8],he=a[9],pe=a[10],me=a[11],_e=a[12],ke=a[13],Ve=a[14],dt=a[15],tt=h[0],de=h[1],De=h[2],rt=h[3];return d[0]=tt*p+de*k+De*Q+rt*_e,d[1]=tt*x+de*N+De*he+rt*ke,d[2]=tt*C+de*j+De*pe+rt*Ve,d[3]=tt*A+de*Y+De*me+rt*dt,d[4]=(tt=h[4])*p+(de=h[5])*k+(De=h[6])*Q+(rt=h[7])*_e,d[5]=tt*x+de*N+De*he+rt*ke,d[6]=tt*C+de*j+De*pe+rt*Ve,d[7]=tt*A+de*Y+De*me+rt*dt,d[8]=(tt=h[8])*p+(de=h[9])*k+(De=h[10])*Q+(rt=h[11])*_e,d[9]=tt*x+de*N+De*he+rt*ke,d[10]=tt*C+de*j+De*pe+rt*Ve,d[11]=tt*A+de*Y+De*me+rt*dt,d[12]=(tt=h[12])*p+(de=h[13])*k+(De=h[14])*Q+(rt=h[15])*_e,d[13]=tt*x+de*N+De*he+rt*ke,d[14]=tt*C+de*j+De*pe+rt*Ve,d[15]=tt*A+de*Y+De*me+rt*dt,d},c.P=R,c.Q=function(d,a){const h={};for(let p=0;p<a.length;p++){const x=a[p];x in d&&(h[x]=d[x])}return h},c.R=xs,c.S=Df,c.T=er,c.U=gI,c.V=mI,c.W=B,c.X=W,c.Y=yt,c.Z=Cl,c._=s,c.a=ae,c.a$=function(d,a,h){return d[0]=a[0]*h,d[1]=a[1]*h,d[2]=a[2]*h,d[3]=a[3]*h,d},c.a0=Yy,c.a1=hm,c.a2=25,c.a3=MS,c.a4=d=>{const a=window.document.createElement("video");return a.muted=!0,new Promise(h=>{a.onloadstart=()=>{h(a)};for(const p of d){const x=window.document.createElement("source");ye(p)||(a.crossOrigin="Anonymous"),x.src=p,a.appendChild(x)}})},c.a5=Ct,c.a6=function(){return En++},c.a7=Le,c.a8=mr,c.a9=Fa,c.aA=to,c.aB=jt,c.aC=function(d,a,h,p,x=!1){if(!h[0]&&!h[1])return[0,0];const C=x?p==="map"?-d.bearingInRadians:0:p==="viewport"?d.bearingInRadians:0;if(C){const A=Math.sin(C),k=Math.cos(C);h=[h[0]*k-h[1]*A,h[0]*A+h[1]*k]}return[x?h[0]:jt(a,h[0],d.zoom),x?h[1]:jt(a,h[1],d.zoom)]},c.aE=Wi,c.aF=ES,c.aG=O,c.aH=TS,c.aI=Ci,c.aJ=ws,c.aK=Mt,c.aL=Ar,c.aM=ai,c.aN=St,c.aO=Gt,c.aP=yI,c.aQ=Se,c.aR=Ce,c.aS=function(d){var a=new q(3);return a[0]=d[0],a[1]=d[1],a[2]=d[2],a},c.aT=function(d,a,h){return d[0]=a[0]-h[0],d[1]=a[1]-h[1],d[2]=a[2]-h[2],d},c.aU=function(d,a){var h=a[0],p=a[1],x=a[2],C=h*h+p*p+x*x;return C>0&&(C=1/Math.sqrt(C)),d[0]=a[0]*C,d[1]=a[1]*C,d[2]=a[2]*C,d},c.aV=Xe,c.aW=function(d,a){return d[0]*a[0]+d[1]*a[1]+d[2]*a[2]},c.aX=function(d,a,h){return d[0]=a[0]*h[0],d[1]=a[1]*h[1],d[2]=a[2]*h[2],d[3]=a[3]*h[3],d},c.aY=$,c.aZ=function(d,a,h){const p=a[0]*h[0]+a[1]*h[1]+a[2]*h[2];return p===0?null:(-(d[0]*h[0]+d[1]*h[1]+d[2]*h[2])-h[3])/p},c.a_=Me,c.aa=eh,c.ab=wI,c.ac=function(d){const a={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,p,x,C)=>{const A=x||C;return a[p]=!A||A.toLowerCase(),""}),a["max-age"]){const h=parseInt(a["max-age"],10);isNaN(h)?delete a["max-age"]:a["max-age"]=h}return a},c.ad=ln,c.ae=function(d){return Math.pow(2,d)},c.af=se,c.ag=bt,c.ah=85.051129,c.ai=vI,c.aj=function(d){return Math.log(d)/Math.LN2},c.ak=function(d){var a=d[0],h=d[1];return a*a+h*h},c.al=function(d,a){const h=[];for(const p in d)p in a||h.push(p);return h},c.am=function(d,a){let h=0,p=0;if(d.kind==="constant")p=d.layoutSize;else if(d.kind!=="source"){const{interpolationType:x,minZoom:C,maxZoom:A}=d,k=x?bt(ns.interpolationFactor(x,a,C,A),0,1):0;d.kind==="camera"?p=Ls.number(d.minSize,d.maxSize,k):h=k}return{uSizeT:h,uSize:p}},c.ao=function(d,{uSize:a,uSizeT:h},{lowerSize:p,upperSize:x}){return d.kind==="source"?p/Un:d.kind==="composite"?Ls.number(p/Un,x/Un,h):a},c.ap=function(d,a){var h=a[0],p=a[1],x=a[2],C=a[3],A=a[4],k=a[5],N=a[6],j=a[7],Y=a[8],Q=a[9],he=a[10],pe=a[11],me=a[12],_e=a[13],ke=a[14],Ve=a[15],dt=h*k-p*A,tt=h*N-x*A,de=h*j-C*A,De=p*N-x*k,rt=p*j-C*k,Rt=x*j-C*N,sn=Y*_e-Q*me,Ft=Y*ke-he*me,Vt=Y*Ve-pe*me,gn=Q*ke-he*_e,an=Q*Ve-pe*_e,xn=he*Ve-pe*ke,Xt=dt*xn-tt*an+de*gn+De*Vt-rt*Ft+Rt*sn;return Xt?(d[0]=(k*xn-N*an+j*gn)*(Xt=1/Xt),d[1]=(x*an-p*xn-C*gn)*Xt,d[2]=(_e*Rt-ke*rt+Ve*De)*Xt,d[3]=(he*rt-Q*Rt-pe*De)*Xt,d[4]=(N*Vt-A*xn-j*Ft)*Xt,d[5]=(h*xn-x*Vt+C*Ft)*Xt,d[6]=(ke*de-me*Rt-Ve*tt)*Xt,d[7]=(Y*Rt-he*de+pe*tt)*Xt,d[8]=(A*an-k*Vt+j*sn)*Xt,d[9]=(p*Vt-h*an-C*sn)*Xt,d[10]=(me*rt-_e*de+Ve*dt)*Xt,d[11]=(Q*de-Y*rt-pe*dt)*Xt,d[12]=(k*Ft-A*gn-N*sn)*Xt,d[13]=(h*gn-p*Ft+x*sn)*Xt,d[14]=(_e*tt-me*De-ke*dt)*Xt,d[15]=(Y*De-Q*tt+he*dt)*Xt,d):null},c.aq=st,c.ar=function(d){return Math.hypot(d[0],d[1])},c.as=function(d){return d[0]=0,d[1]=0,d},c.at=function(d,a,h){return d[0]=a[0]*h,d[1]=a[1]*h,d},c.au=In,c.av=Te,c.aw=function(d,a,h,p){const x=a.y-d.y,C=a.x-d.x,A=p.y-h.y,k=p.x-h.x,N=A*C-k*x;if(N===0)return null;const j=(k*(d.y-h.y)-A*(d.x-h.x))/N;return new R(d.x+j*C,d.y+j*x)},c.ax=CI,c.ay=Bs,c.az=function(d){let a=1/0,h=1/0,p=-1/0,x=-1/0;for(const C of d)a=Math.min(a,C.x),h=Math.min(h,C.y),p=Math.max(p,C.x),x=Math.max(x,C.y);return[a,h,p,x]},c.b=Ue,c.b$=Lg,c.b0=function(d,a){return d[0]*a[0]+d[1]*a[1]+d[2]*a[2]+d[3]},c.b1=xI,c.b2=Fg,c.b3=function(d,a,h,p,x){var C,A=1/Math.tan(a/2);return d[0]=A/h,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=A,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,x!=null&&x!==1/0?(d[10]=(x+p)*(C=1/(p-x)),d[14]=2*x*p*C):(d[10]=-1,d[14]=-2*p),d},c.b4=function(d){var a=new q(16);return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],a},c.b5=function(d,a,h){var p=Math.sin(h),x=Math.cos(h),C=a[0],A=a[1],k=a[2],N=a[3],j=a[4],Y=a[5],Q=a[6],he=a[7];return a!==d&&(d[8]=a[8],d[9]=a[9],d[10]=a[10],d[11]=a[11],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]),d[0]=C*x+j*p,d[1]=A*x+Y*p,d[2]=k*x+Q*p,d[3]=N*x+he*p,d[4]=j*x-C*p,d[5]=Y*x-A*p,d[6]=Q*x-k*p,d[7]=he*x-N*p,d},c.b6=function(d,a,h){var p=Math.sin(h),x=Math.cos(h),C=a[4],A=a[5],k=a[6],N=a[7],j=a[8],Y=a[9],Q=a[10],he=a[11];return a!==d&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]),d[4]=C*x+j*p,d[5]=A*x+Y*p,d[6]=k*x+Q*p,d[7]=N*x+he*p,d[8]=j*x-C*p,d[9]=Y*x-A*p,d[10]=Q*x-k*p,d[11]=he*x-N*p,d},c.b7=function(){const d=new Float32Array(16);return se(d),d},c.b8=function(){const d=new Float64Array(16);return se(d),d},c.b9=function(){return new Float64Array(16)},c.bA=function(d){return d[0]=0,d[1]=0,d[2]=0,d},c.bB=function(d,a,h,p){const x=Math.sqrt(d*d+a*a),C=Math.sqrt(h*h+p*p);d/=x,a/=x,h/=C,p/=C;const A=Math.acos(d*h+a*p);return-a*h+d*p>0?A:-A},c.bC=function(d,a){const h=je(d,2*Math.PI),p=je(a,2*Math.PI);return Math.min(Math.abs(h-p),Math.abs(h-p+2*Math.PI),Math.abs(h-p-2*Math.PI))},c.bD=function(){const d={},a=We.$version;for(const h in We.$root){const p=We.$root[h];if(p.required){let x=null;x=h==="version"?a:p.type==="array"?[]:{},x!=null&&(d[h]=x)}}return d},c.bE=id,c.bF=Oe,c.bG=function d(a,h){if(Array.isArray(a)){if(!Array.isArray(h)||a.length!==h.length)return!1;for(let p=0;p<a.length;p++)if(!d(a[p],h[p]))return!1;return!0}if(typeof a=="object"&&a!==null&&h!==null){if(typeof h!="object"||Object.keys(a).length!==Object.keys(h).length)return!1;for(const p in a)if(!d(a[p],h[p]))return!1;return!0}return a===h},c.bH=function(d){d=d.slice();const a=Object.create(null);for(let h=0;h<d.length;h++)a[d[h].id]=d[h];for(let h=0;h<d.length;h++)"ref"in d[h]&&(d[h]=Kt(d[h],a[d[h].ref]));return d},c.bI=function(d){if(d.type==="custom")return new t8(d);switch(d.type){case"background":return new J$(d);case"circle":return new hS(d);case"color-relief":return new Sx(d);case"fill":return new Ny(d);case"fill-extrusion":return new Vy(d);case"heatmap":return new bs(d);case"hillshade":return new Eg(d);case"line":return new kx(d);case"raster":return new e8(d);case"symbol":return new $x(d)}},c.bJ=Ln,c.bK=function(d,a){if(!d)return[{command:"setStyle",args:[a]}];let h=[];try{if(!Re(d.version,a.version))return[{command:"setStyle",args:[a]}];Re(d.center,a.center)||h.push({command:"setCenter",args:[a.center]}),Re(d.state,a.state)||h.push({command:"setGlobalState",args:[a.state]}),Re(d.centerAltitude,a.centerAltitude)||h.push({command:"setCenterAltitude",args:[a.centerAltitude]}),Re(d.zoom,a.zoom)||h.push({command:"setZoom",args:[a.zoom]}),Re(d.bearing,a.bearing)||h.push({command:"setBearing",args:[a.bearing]}),Re(d.pitch,a.pitch)||h.push({command:"setPitch",args:[a.pitch]}),Re(d.roll,a.roll)||h.push({command:"setRoll",args:[a.roll]}),Re(d.sprite,a.sprite)||h.push({command:"setSprite",args:[a.sprite]}),Re(d.glyphs,a.glyphs)||h.push({command:"setGlyphs",args:[a.glyphs]}),Re(d.transition,a.transition)||h.push({command:"setTransition",args:[a.transition]}),Re(d.light,a.light)||h.push({command:"setLight",args:[a.light]}),Re(d.terrain,a.terrain)||h.push({command:"setTerrain",args:[a.terrain]}),Re(d.sky,a.sky)||h.push({command:"setSky",args:[a.sky]}),Re(d.projection,a.projection)||h.push({command:"setProjection",args:[a.projection]});const p={},x=[];(function(A,k,N,j){let Y;for(Y in k=k||{},A=A||{})Object.prototype.hasOwnProperty.call(A,Y)&&(Object.prototype.hasOwnProperty.call(k,Y)||Wt(Y,N,j));for(Y in k)Object.prototype.hasOwnProperty.call(k,Y)&&(Object.prototype.hasOwnProperty.call(A,Y)?Re(A[Y],k[Y])||(A[Y].type==="geojson"&&k[Y].type==="geojson"&&pn(A,k,Y)?it(N,{command:"setGeoJSONSourceData",args:[Y,k[Y].data]}):tn(Y,k,N,j)):mt(Y,k,N))})(d.sources,a.sources,x,p);const C=[];d.layers&&d.layers.forEach(A=>{"source"in A&&p[A.source]?h.push({command:"removeLayer",args:[A.id]}):C.push(A)}),h=h.concat(x),function(A,k,N){k=k||[];const j=(A=A||[]).map(on),Y=k.map(on),Q=A.reduce(kn,{}),he=k.reduce(kn,{}),pe=j.slice(),me=Object.create(null);let _e,ke,Ve,dt,tt;for(let de=0,De=0;de<j.length;de++)_e=j[de],Object.prototype.hasOwnProperty.call(he,_e)?De++:(it(N,{command:"removeLayer",args:[_e]}),pe.splice(pe.indexOf(_e,De),1));for(let de=0,De=0;de<Y.length;de++)_e=Y[Y.length-1-de],pe[pe.length-1-de]!==_e&&(Object.prototype.hasOwnProperty.call(Q,_e)?(it(N,{command:"removeLayer",args:[_e]}),pe.splice(pe.lastIndexOf(_e,pe.length-De),1)):De++,dt=pe[pe.length-de],it(N,{command:"addLayer",args:[he[_e],dt]}),pe.splice(pe.length-de,0,_e),me[_e]=!0);for(let de=0;de<Y.length;de++)if(_e=Y[de],ke=Q[_e],Ve=he[_e],!me[_e]&&!Re(ke,Ve))if(Re(ke.source,Ve.source)&&Re(ke["source-layer"],Ve["source-layer"])&&Re(ke.type,Ve.type)){for(tt in rn(ke.layout,Ve.layout,N,_e,null,"setLayoutProperty"),rn(ke.paint,Ve.paint,N,_e,null,"setPaintProperty"),Re(ke.filter,Ve.filter)||it(N,{command:"setFilter",args:[_e,Ve.filter]}),Re(ke.minzoom,Ve.minzoom)&&Re(ke.maxzoom,Ve.maxzoom)||it(N,{command:"setLayerZoomRange",args:[_e,Ve.minzoom,Ve.maxzoom]}),ke)Object.prototype.hasOwnProperty.call(ke,tt)&&tt!=="layout"&&tt!=="paint"&&tt!=="filter"&&tt!=="metadata"&&tt!=="minzoom"&&tt!=="maxzoom"&&(tt.indexOf("paint.")===0?rn(ke[tt],Ve[tt],N,_e,tt.slice(6),"setPaintProperty"):Re(ke[tt],Ve[tt])||it(N,{command:"setLayerProperty",args:[_e,tt,Ve[tt]]}));for(tt in Ve)Object.prototype.hasOwnProperty.call(Ve,tt)&&!Object.prototype.hasOwnProperty.call(ke,tt)&&tt!=="layout"&&tt!=="paint"&&tt!=="filter"&&tt!=="metadata"&&tt!=="minzoom"&&tt!=="maxzoom"&&(tt.indexOf("paint.")===0?rn(ke[tt],Ve[tt],N,_e,tt.slice(6),"setPaintProperty"):Re(ke[tt],Ve[tt])||it(N,{command:"setLayerProperty",args:[_e,tt,Ve[tt]]}))}else it(N,{command:"removeLayer",args:[_e]}),dt=pe[pe.lastIndexOf(_e)+1],it(N,{command:"addLayer",args:[Ve,dt]})}(C,a.layers,h)}catch(p){console.warn("Unable to compute style diff:",p),h=[{command:"setStyle",args:[a]}]}return h},c.bL=function(d){const a=[],h=d.id;return h===void 0&&a.push({message:`layers.${h}: missing required property "id"`}),d.render===void 0&&a.push({message:`layers.${h}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&a.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),a},c.bM=un,c.bN=et,c.bO=class extends hi{constructor(d,a){super(d,a),this.current=0}set(d){this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}},c.bP=vg,c.bQ=class extends hi{constructor(d,a){super(d,a),this.current=Sy}set(d){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let a=1;a<16;a++)if(d[a]!==this.current[a]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}},c.bR=ao,c.bS=class extends hi{constructor(d,a){super(d,a),this.current=[0,0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2]))}},c.bT=class extends hi{constructor(d,a){super(d,a),this.current=[0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1]))}},c.bU=te,c.bV=function(d,a){var h=Math.sin(a),p=Math.cos(a);return d[0]=p,d[1]=h,d[2]=0,d[3]=-h,d[4]=p,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},c.bW=function(d,a,h){var p=a[0],x=a[1],C=a[2];return d[0]=p*h[0]+x*h[3]+C*h[6],d[1]=p*h[1]+x*h[4]+C*h[7],d[2]=p*h[2]+x*h[5]+C*h[8],d},c.bX=function(d,a,h,p,x,C,A){var k=1/(a-h),N=1/(p-x),j=1/(C-A);return d[0]=-2*k,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*N,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*j,d[11]=0,d[12]=(a+h)*k,d[13]=(x+p)*N,d[14]=(A+C)*j,d[15]=1,d},c.bY=class extends hi{constructor(d,a){super(d,a),this.current=new Array}set(d){if(d!=this.current){this.current=d;const a=new Float32Array(4*d.length);for(let h=0;h<d.length;h++)a[4*h]=d[h].r,a[4*h+1]=d[h].g,a[4*h+2]=d[h].b,a[4*h+3]=d[h].a;this.gl.uniform4fv(this.location,a)}}},c.bZ=class extends hi{constructor(d,a){super(d,a),this.current=new Array}set(d){if(d!=this.current){this.current=d;const a=new Float32Array(d);this.gl.uniform1fv(this.location,a)}}},c.b_=class extends g{},c.ba=function(d,a,h){const p=new Float64Array(4);return Ke(p,d,a-90,h),p},c.bb=function(d,a,h,p){var x,C,A,k,N,j=a[0],Y=a[1],Q=a[2],he=a[3],pe=h[0],me=h[1],_e=h[2],ke=h[3];return(C=j*pe+Y*me+Q*_e+he*ke)<0&&(C=-C,pe=-pe,me=-me,_e=-_e,ke=-ke),1-C>X?(x=Math.acos(C),A=Math.sin(x),k=Math.sin((1-p)*x)/A,N=Math.sin(p*x)/A):(k=1-p,N=p),d[0]=k*j+N*pe,d[1]=k*Y+N*me,d[2]=k*Q+N*_e,d[3]=k*he+N*ke,d},c.bc=function(d){const a=new Float64Array(9);var h,p,x,C,A,k,N,j,Y,Q,he,pe,me,_e,ke,Ve,dt,tt;Q=(x=(p=d)[0])*(N=x+x),he=(C=p[1])*N,me=(A=p[2])*N,_e=A*(j=C+C),Ve=(k=p[3])*N,dt=k*j,tt=k*(Y=A+A),(h=a)[0]=1-(pe=C*j)-(ke=A*Y),h[3]=he-tt,h[6]=me+dt,h[1]=he+tt,h[4]=1-Q-ke,h[7]=_e-Ve,h[2]=me-dt,h[5]=_e+Ve,h[8]=1-Q-pe;const de=Gt(-Math.asin(bt(a[2],-1,1)));let De,rt;return Math.hypot(a[5],a[8])<.001?(De=0,rt=-Gt(Math.atan2(a[3],a[4]))):(De=Gt(a[5]===0&&a[8]===0?0:Math.atan2(a[5],a[8])),rt=Gt(a[1]===0&&a[0]===0?0:Math.atan2(a[1],a[0]))),{roll:De,pitch:de+90,bearing:rt}},c.bd=function(d,a){return d.roll==a.roll&&d.pitch==a.pitch&&d.bearing==a.bearing},c.be=vr,c.bf=yo,c.bg=Sl,c.bh=Gi,c.bi=eo,c.bj=ft,c.bk=At,c.bl=yr,c.bm=function(d,a,h,p,x){return ft(p,x,bt((d-a)/(h-a),0,1))},c.bn=je,c.bo=function(){return new Float64Array(3)},c.bp=function(d,a,h,p){return d[0]=a[0]+h[0]*p,d[1]=a[1]+h[1]*p,d[2]=a[2]+h[2]*p,d},c.bq=Ke,c.br=function(d,a,h){var p=h[0],x=h[1],C=h[2],A=a[0],k=a[1],N=a[2],j=x*N-C*k,Y=C*A-p*N,Q=p*k-x*A,he=x*Q-C*Y,pe=C*j-p*Q,me=p*Y-x*j,_e=2*h[3];return Y*=_e,Q*=_e,pe*=2,me*=2,d[0]=A+(j*=_e)+(he*=2),d[1]=k+Y+pe,d[2]=N+Q+me,d},c.bs=function(d,a,h){const p=(x=[d[0],d[1],d[2],a[0],a[1],a[2],h[0],h[1],h[2]])[0]*((Y=x[8])*(A=x[4])-(k=x[5])*(j=x[7]))+x[1]*(-Y*(C=x[3])+k*(N=x[6]))+x[2]*(j*C-A*N);var x,C,A,k,N,j,Y;if(p===0)return null;const Q=Xe([],[a[0],a[1],a[2]],[h[0],h[1],h[2]]),he=Xe([],[h[0],h[1],h[2]],[d[0],d[1],d[2]]),pe=Xe([],[d[0],d[1],d[2]],[a[0],a[1],a[2]]),me=Se([],Q,-d[3]);return Ce(me,me,Se([],he,-a[3])),Ce(me,me,Se([],pe,-h[3])),Se(me,me,1/p),me},c.bt=wS,c.bu=function(){return new Float64Array(4)},c.bv=function(d,a,h,p){var x=[],C=[];return x[0]=a[0]-h[0],x[1]=a[1]-h[1],x[2]=a[2]-h[2],C[0]=x[0]*Math.cos(p)-x[1]*Math.sin(p),C[1]=x[0]*Math.sin(p)+x[1]*Math.cos(p),C[2]=x[2],d[0]=C[0]+h[0],d[1]=C[1]+h[1],d[2]=C[2]+h[2],d},c.bw=function(d,a,h,p){var x=[],C=[];return x[0]=a[0]-h[0],x[1]=a[1]-h[1],x[2]=a[2]-h[2],C[0]=x[0],C[1]=x[1]*Math.cos(p)-x[2]*Math.sin(p),C[2]=x[1]*Math.sin(p)+x[2]*Math.cos(p),d[0]=C[0]+h[0],d[1]=C[1]+h[1],d[2]=C[2]+h[2],d},c.bx=function(d,a,h,p){var x=[],C=[];return x[0]=a[0]-h[0],x[1]=a[1]-h[1],x[2]=a[2]-h[2],C[0]=x[2]*Math.sin(p)+x[0]*Math.cos(p),C[1]=x[1],C[2]=x[2]*Math.cos(p)-x[0]*Math.sin(p),d[0]=C[0]+h[0],d[1]=C[1]+h[1],d[2]=C[2]+h[2],d},c.by=function(d,a,h){var p=Math.sin(h),x=Math.cos(h),C=a[0],A=a[1],k=a[2],N=a[3],j=a[8],Y=a[9],Q=a[10],he=a[11];return a!==d&&(d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]),d[0]=C*x-j*p,d[1]=A*x-Y*p,d[2]=k*x-Q*p,d[3]=N*x-he*p,d[8]=C*p+j*x,d[9]=A*p+Y*x,d[10]=k*p+Q*x,d[11]=N*p+he*x,d},c.bz=function(d,a){const h=je(d,360),p=je(a,360),x=p-h,C=p>h?x-360:x+360;return Math.abs(x)<Math.abs(C)?x:C},c.c=Pe,c.c0=class extends M{},c.c1=gd,c.c2=function(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))},c.c3=Ly,c.c4=function(d,a,h){var p=a[0],x=a[1],C=a[2],A=h[3]*p+h[7]*x+h[11]*C+h[15];return d[0]=(h[0]*p+h[4]*x+h[8]*C+h[12])/(A=A||1),d[1]=(h[1]*p+h[5]*x+h[9]*C+h[13])/A,d[2]=(h[2]*p+h[6]*x+h[10]*C+h[14])/A,d},c.c5=class extends Xu{},c.c6=class extends ne{},c.c7=function(d,a){return d[0]===a[0]&&d[1]===a[1]&&d[2]===a[2]&&d[3]===a[3]&&d[4]===a[4]&&d[5]===a[5]&&d[6]===a[6]&&d[7]===a[7]&&d[8]===a[8]&&d[9]===a[9]&&d[10]===a[10]&&d[11]===a[11]&&d[12]===a[12]&&d[13]===a[13]&&d[14]===a[14]&&d[15]===a[15]},c.c8=function(d,a){var h=d[0],p=d[1],x=d[2],C=d[3],A=d[4],k=d[5],N=d[6],j=d[7],Y=d[8],Q=d[9],he=d[10],pe=d[11],me=d[12],_e=d[13],ke=d[14],Ve=d[15],dt=a[0],tt=a[1],de=a[2],De=a[3],rt=a[4],Rt=a[5],sn=a[6],Ft=a[7],Vt=a[8],gn=a[9],an=a[10],xn=a[11],Xt=a[12],Hn=a[13],hr=a[14],lr=a[15];return Math.abs(h-dt)<=X*Math.max(1,Math.abs(h),Math.abs(dt))&&Math.abs(p-tt)<=X*Math.max(1,Math.abs(p),Math.abs(tt))&&Math.abs(x-de)<=X*Math.max(1,Math.abs(x),Math.abs(de))&&Math.abs(C-De)<=X*Math.max(1,Math.abs(C),Math.abs(De))&&Math.abs(A-rt)<=X*Math.max(1,Math.abs(A),Math.abs(rt))&&Math.abs(k-Rt)<=X*Math.max(1,Math.abs(k),Math.abs(Rt))&&Math.abs(N-sn)<=X*Math.max(1,Math.abs(N),Math.abs(sn))&&Math.abs(j-Ft)<=X*Math.max(1,Math.abs(j),Math.abs(Ft))&&Math.abs(Y-Vt)<=X*Math.max(1,Math.abs(Y),Math.abs(Vt))&&Math.abs(Q-gn)<=X*Math.max(1,Math.abs(Q),Math.abs(gn))&&Math.abs(he-an)<=X*Math.max(1,Math.abs(he),Math.abs(an))&&Math.abs(pe-xn)<=X*Math.max(1,Math.abs(pe),Math.abs(xn))&&Math.abs(me-Xt)<=X*Math.max(1,Math.abs(me),Math.abs(Xt))&&Math.abs(_e-Hn)<=X*Math.max(1,Math.abs(_e),Math.abs(Hn))&&Math.abs(ke-hr)<=X*Math.max(1,Math.abs(ke),Math.abs(hr))&&Math.abs(Ve-lr)<=X*Math.max(1,Math.abs(Ve),Math.abs(lr))},c.c9=function(d,a){return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[8]=a[8],d[9]=a[9],d[10]=a[10],d[11]=a[11],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15],d},c.cA=function(d){delete ae.REGISTERED_PROTOCOLS[d]},c.cB=function(d,a){const h={};for(let x=0;x<d.length;x++){const C=a&&a[d[x].id]||td(d[x]);a&&(a[d[x].id]=C);let A=h[C];A||(A=h[C]=[]),A.push(d[x])}const p=[];for(const x in h)p.push(h[x]);return p},c.cC=zn,c.cD=bI,c.cE=SI,c.cF=cm,c.cG=function(d){d.bucket.createArrays(),d.bucket.tilePixelRatio=Qe/(512*d.bucket.overscaling),d.bucket.compareText={},d.bucket.iconsNeedLinear=!1;const a=d.bucket.layers[0],h=a.layout,p=a._unevaluatedLayout._values,x={layoutIconSize:p["icon-size"].possiblyEvaluate(new si(d.bucket.zoom+1),d.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new si(d.bucket.zoom+1),d.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new si(18))};if(d.bucket.textSizeData.kind==="composite"){const{minZoom:j,maxZoom:Y}=d.bucket.textSizeData;x.compositeTextSizes=[p["text-size"].possiblyEvaluate(new si(j),d.canonical),p["text-size"].possiblyEvaluate(new si(Y),d.canonical)]}if(d.bucket.iconSizeData.kind==="composite"){const{minZoom:j,maxZoom:Y}=d.bucket.iconSizeData;x.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new si(j),d.canonical),p["icon-size"].possiblyEvaluate(new si(Y),d.canonical)]}const C=h.get("text-line-height")*to,A=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",k=h.get("text-keep-upright"),N=h.get("text-size");for(const j of d.bucket.features){const Y=h.get("text-font").evaluate(j,{},d.canonical).join(","),Q=N.evaluate(j,{},d.canonical),he=x.layoutTextSize.evaluate(j,{},d.canonical),pe=x.layoutIconSize.evaluate(j,{},d.canonical),me={horizontal:{},vertical:void 0},_e=j.text;let ke,Ve=[0,0];if(_e){const de=_e.toString(),De=h.get("text-letter-spacing").evaluate(j,{},d.canonical)*to,rt=Mi(de)?De:0,Rt=h.get("text-anchor").evaluate(j,{},d.canonical),sn=kI(a,j,d.canonical);if(!sn){const an=h.get("text-radial-offset").evaluate(j,{},d.canonical);Ve=an?DI(Rt,[an*to,CS]):h.get("text-offset").evaluate(j,{},d.canonical).map(xn=>xn*to)}let Ft=A?"center":h.get("text-justify").evaluate(j,{},d.canonical);const Vt=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(j,{},d.canonical)*to:1/0,gn=()=>{d.bucket.allowVerticalPlacement&&is(de)&&(me.vertical=um(_e,d.glyphMap,d.glyphPositions,d.imagePositions,Y,Vt,C,Rt,"left",rt,Ve,c.an.vertical,!0,he,Q))};if(!A&&sn){const an=new Set;if(Ft==="auto")for(let Xt=0;Xt<sn.values.length;Xt+=2)an.add(ES(sn.values[Xt]));else an.add(Ft);let xn=!1;for(const Xt of an)if(!me.horizontal[Xt])if(xn)me.horizontal[Xt]=me.horizontal[0];else{const Hn=um(_e,d.glyphMap,d.glyphPositions,d.imagePositions,Y,Vt,C,"center",Xt,rt,Ve,c.an.horizontal,!1,he,Q);Hn&&(me.horizontal[Xt]=Hn,xn=Hn.positionedLines.length===1)}gn()}else{Ft==="auto"&&(Ft=ES(Rt));const an=um(_e,d.glyphMap,d.glyphPositions,d.imagePositions,Y,Vt,C,Rt,Ft,rt,Ve,c.an.horizontal,!1,he,Q);an&&(me.horizontal[Ft]=an),gn(),is(de)&&A&&k&&(me.vertical=um(_e,d.glyphMap,d.glyphPositions,d.imagePositions,Y,Vt,C,Rt,Ft,rt,Ve,c.an.vertical,!1,he,Q))}}let dt=!1;if(j.icon&&j.icon.name){const de=d.imageMap[j.icon.name];de&&(ke=bn(d.imagePositions[j.icon.name],h.get("icon-offset").evaluate(j,{},d.canonical),h.get("icon-anchor").evaluate(j,{},d.canonical)),dt=!!de.sdf,d.bucket.sdfIcons===void 0?d.bucket.sdfIcons=dt:d.bucket.sdfIcons!==dt&&fn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(de.pixelRatio!==d.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(d.bucket.iconsNeedLinear=!0))}const tt=OI(me.horizontal)||me.vertical;d.bucket.iconsInText=!!tt&&tt.iconsInText,(tt||ke)&&u8(d.bucket,j,me,ke,d.imageMap,x,he,pe,Ve,dt,d.canonical,d.subdivisionGranularity)}d.showCollisionBoxes&&d.bucket.generateCollisionDebugBuffers()},c.cH=Ui,c.cI=nm,c.cJ=om,c.cK=wd,c.cL=Rf,c.cM=class{constructor(d){this._marks={start:[d.url,"start"].join("#"),end:[d.url,"end"].join("#"),measure:d.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let d=performance.getEntriesByName(this._marks.measure);return d.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),d=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),d}},c.cN=function(d,a,h,p,x){return s(this,void 0,void 0,function*(){if(W())try{return yield yt(d,a,h,p,x)}catch{}return function(C,A,k,N,j){const Y=C.width,Q=C.height;Nt&&Ht||(Nt=new OffscreenCanvas(Y,Q),Ht=Nt.getContext("2d",{willReadFrequently:!0})),Nt.width=Y,Nt.height=Q,Ht.drawImage(C,0,0,Y,Q);const he=Ht.getImageData(A,k,N,j);return Ht.clearRect(0,0,Y,Q),he.data}(d,a,h,p,x)})},c.cO=vd,c.cP=m,c.cQ=w,c.cR=Rg,c.cS=qy,c.cT=Hc,c.cU=dc,c.ca=d=>d.type==="symbol",c.cb=d=>d.type==="circle",c.cc=d=>d.type==="heatmap",c.cd=d=>d.type==="line",c.ce=d=>d.type==="fill",c.cf=d=>d.type==="fill-extrusion",c.cg=d=>d.type==="hillshade",c.ch=d=>d.type==="color-relief",c.ci=d=>d.type==="raster",c.cj=d=>d.type==="background",c.ck=d=>d.type==="custom",c.cl=ht,c.cm=function(d,a,h){const p=Ee(a.x-h.x,a.y-h.y),x=Ee(d.x-h.x,d.y-h.y);var C,A;return Gt(Math.atan2(p[0]*x[1]-p[1]*x[0],(C=p)[0]*(A=x)[0]+C[1]*A[1]))},c.cn=lt,c.co=function(d,a){return Fn[a]&&(d instanceof MouseEvent||d instanceof WheelEvent)},c.cp=function(d,a){return Zt[a]&&"touches"in d},c.cq=function(d){return Zt[d]||Fn[d]},c.cr=function(d,a,h){var p=a[0],x=a[1];return d[0]=h[0]*p+h[4]*x+h[12],d[1]=h[1]*p+h[5]*x+h[13],d},c.cs=function(d,a){const{x:h,y:p}=Yy.fromLngLat(a);return!(d<0||d>25||p<0||p>=1||h<0||h>=1)},c.ct=function(d,a){return d[0]=a[0],d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=a[1],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=a[2],d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d},c.cu=class extends ss{},c.cv=d8,c.cx=function(d){return d.message===Yt},c.cy=fe,c.cz=function(d,a){ae.REGISTERED_PROTOCOLS[d]=a},c.d=ye,c.e=dn,c.f=d=>s(void 0,void 0,void 0,function*(){if(d.byteLength===0)return createImageBitmap(new ImageData(1,1));const a=new Blob([new Uint8Array(d)],{type:"image/png"});try{return createImageBitmap(a)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),c.g=ue,c.h=d=>new Promise((a,h)=>{const p=new Image;p.onload=()=>{a(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=we})},p.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const x=new Blob([new Uint8Array(d)],{type:"image/png"});p.src=d.byteLength?URL.createObjectURL(x):we}),c.i=Nn,c.j=(d,a)=>Ye(dn(d,{type:"json"}),a),c.k=He,c.l=$e,c.m=Ye,c.n=(d,a)=>Ye(dn(d,{type:"arrayBuffer"}),a),c.o=function(d){return new Rf(d).readFields(Nx,[])},c.p=Zy,c.q=md,c.r=gi,c.s=Ot,c.t=yf,c.u=dr,c.v=We,c.w=fn,c.x=cc,c.y=uc,c.z=Uu}),o("worker",["./shared"],function(c){class s{constructor(ae){this.keyCache={},ae&&this.replace(ae)}replace(ae){this._layerConfigs={},this._layers={},this.update(ae,[])}update(ae,ue){for(const fe of ae){this._layerConfigs[fe.id]=fe;const Oe=this._layers[fe.id]=c.bI(fe);Oe._featureFilter=c.a9(Oe.filter),this.keyCache[fe.id]&&delete this.keyCache[fe.id]}for(const fe of ue)delete this.keyCache[fe],delete this._layerConfigs[fe],delete this._layers[fe];this.familiesBySource={};const ee=c.cB(Object.values(this._layerConfigs),this.keyCache);for(const fe of ee){const Oe=fe.map(He=>this._layers[He.id]),Ye=Oe[0];if(Ye.visibility==="none")continue;const ye=Ye.source||"";let Ae=this.familiesBySource[ye];Ae||(Ae=this.familiesBySource[ye]={});const Be=Ye.sourceLayer||"_geojsonTileLayer";let $e=Ae[Be];$e||($e=Ae[Be]=[]),$e.push(Oe)}}}class m{constructor(ae){const ue={},ee=[];for(const ye in ae){const Ae=ae[ye],Be=ue[ye]={};for(const $e in Ae){const He=Ae[+$e];if(!He||He.bitmap.width===0||He.bitmap.height===0)continue;const ut={x:0,y:0,w:He.bitmap.width+2,h:He.bitmap.height+2};ee.push(ut),Be[$e]={rect:ut,metrics:He.metrics}}}const{w:fe,h:Oe}=c.p(ee),Ye=new c.q({width:fe||1,height:Oe||1});for(const ye in ae){const Ae=ae[ye];for(const Be in Ae){const $e=Ae[+Be];if(!$e||$e.bitmap.width===0||$e.bitmap.height===0)continue;const He=ue[ye][Be].rect;c.q.copy($e.bitmap,Ye,{x:0,y:0},{x:He.x+1,y:He.y+1},$e.bitmap)}}this.image=Ye,this.positions=ue}}c.cC("GlyphAtlas",m);class y{constructor(ae){this.tileID=new c.Z(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.uid=ae.uid,this.zoom=ae.zoom,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.collectResourceTiming,this.returnDependencies=!!ae.returnDependencies,this.promoteId=ae.promoteId,this.inFlightDependencies=[],this.globalState=ae.globalState}parse(ae,ue,ee,fe,Oe){return c._(this,void 0,void 0,function*(){this.status="parsing",this.data=ae,this.collisionBoxArray=new c.a7;const Ye=new c.cD(Object.keys(ae.layers).sort()),ye=new c.cE(this.tileID,this.promoteId);ye.bucketLayerIDs=[];const Ae={},Be={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ee,subdivisionGranularity:Oe},$e=ue.familiesBySource[this.source];for(const rn in $e){const on=ae.layers[rn];if(!on)continue;on.version===1&&c.w(`Vector tile source "${this.source}" layer "${rn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const kn=Ye.encode(rn),Ct=[];for(let Gn=0;Gn<on.length;Gn++){const On=on.feature(Gn),or=ye.getId(On,rn);Ct.push({feature:On,id:or,index:Gn,sourceLayerIndex:kn})}for(const Gn of $e[rn]){const On=Gn[0];On.source!==this.source&&c.w(`layer.source = ${On.source} does not equal this.source = ${this.source}`),On.minzoom&&this.zoom<Math.floor(On.minzoom)||On.maxzoom&&this.zoom>=On.maxzoom||On.visibility!=="none"&&(b(Gn,this.zoom,ee),(Ae[On.id]=On.createBucket({index:ye.bucketLayerIDs.length,layers:Gn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:kn,sourceID:this.source,globalState:this.globalState})).populate(Ct,Be,this.tileID.canonical),ye.bucketLayerIDs.push(Gn.map(or=>or.id)))}}const He=c.bM(Be.glyphDependencies,rn=>Object.keys(rn).map(Number));this.inFlightDependencies.forEach(rn=>rn?.abort()),this.inFlightDependencies=[];let ut=Promise.resolve({});if(Object.keys(He).length){const rn=new AbortController;this.inFlightDependencies.push(rn),ut=fe.sendAsync({type:"GG",data:{stacks:He,source:this.source,tileID:this.tileID,type:"glyphs"}},rn)}const We=Object.keys(Be.iconDependencies);let Ut=Promise.resolve({});if(We.length){const rn=new AbortController;this.inFlightDependencies.push(rn),Ut=fe.sendAsync({type:"GI",data:{icons:We,source:this.source,tileID:this.tileID,type:"icons"}},rn)}const Kt=Object.keys(Be.patternDependencies);let Re=Promise.resolve({});if(Kt.length){const rn=new AbortController;this.inFlightDependencies.push(rn),Re=fe.sendAsync({type:"GI",data:{icons:Kt,source:this.source,tileID:this.tileID,type:"patterns"}},rn)}const[it,mt,Wt]=yield Promise.all([ut,Ut,Re]),tn=new m(it),pn=new c.cF(mt,Wt);for(const rn in Ae){const on=Ae[rn];on instanceof c.a8?(b(on.layers,this.zoom,ee),c.cG({bucket:on,glyphMap:it,glyphPositions:tn.positions,imageMap:mt,imagePositions:pn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Be.subdivisionGranularity})):on.hasPattern&&(on instanceof c.cH||on instanceof c.cI||on instanceof c.cJ)&&(b(on.layers,this.zoom,ee),on.addFeatures(Be,this.tileID.canonical,pn.patternPositions))}return this.status="done",{buckets:Object.values(Ae).filter(rn=>!rn.isEmpty()),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:tn.image,imageAtlas:pn,glyphMap:this.returnDependencies?it:null,iconMap:this.returnDependencies?mt:null,glyphPositions:this.returnDependencies?tn.positions:null}})}}function b(Pe,ae,ue){const ee=new c.F(ae);for(const fe of Pe)fe.recalculate(ee,ue)}class w{constructor(ae,ue,ee){this.actor=ae,this.layerIndex=ue,this.availableImages=ee,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ae,ue){return c._(this,void 0,void 0,function*(){const ee=yield c.n(ae.request,ue);try{return{vectorTile:new c.cK.VectorTile(new c.cL(ee.data)),rawData:ee.data,cacheControl:ee.cacheControl,expires:ee.expires}}catch(fe){const Oe=new Uint8Array(ee.data);let Ye=`Unable to parse the tile at ${ae.request.url}, `;throw Ye+=Oe[0]===31&&Oe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${fe.message}`,new Error(Ye)}})}loadTile(ae){return c._(this,void 0,void 0,function*(){const ue=ae.uid,ee=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new c.cM(ae.request),fe=new y(ae);this.loading[ue]=fe;const Oe=new AbortController;fe.abort=Oe;try{const Ye=yield this.loadVectorTile(ae,Oe);if(delete this.loading[ue],!Ye)return null;const ye=Ye.rawData,Ae={};Ye.expires&&(Ae.expires=Ye.expires),Ye.cacheControl&&(Ae.cacheControl=Ye.cacheControl);const Be={};if(ee){const He=ee.finish();He&&(Be.resourceTiming=JSON.parse(JSON.stringify(He)))}fe.vectorTile=Ye.vectorTile;const $e=fe.parse(Ye.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity);this.loaded[ue]=fe,this.fetching[ue]={rawTileData:ye,cacheControl:Ae,resourceTiming:Be};try{const He=yield $e;return c.e({rawTileData:ye.slice(0)},He,Ae,Be)}finally{delete this.fetching[ue]}}catch(Ye){throw delete this.loading[ue],fe.status="done",this.loaded[ue]=fe,Ye}})}reloadTile(ae){return c._(this,void 0,void 0,function*(){const ue=ae.uid;if(!this.loaded||!this.loaded[ue])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ee=this.loaded[ue];if(ee.showCollisionBoxes=ae.showCollisionBoxes,ee.globalState=ae.globalState,ee.status==="parsing"){const fe=yield ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity);let Oe;if(this.fetching[ue]){const{rawTileData:Ye,cacheControl:ye,resourceTiming:Ae}=this.fetching[ue];delete this.fetching[ue],Oe=c.e({rawTileData:Ye.slice(0)},fe,ye,Ae)}else Oe=fe;return Oe}if(ee.status==="done"&&ee.vectorTile)return ee.parse(ee.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity)})}abortTile(ae){return c._(this,void 0,void 0,function*(){const ue=this.loading,ee=ae.uid;ue&&ue[ee]&&ue[ee].abort&&(ue[ee].abort.abort(),delete ue[ee])})}removeTile(ae){return c._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ae.uid]&&delete this.loaded[ae.uid]})}}class E{constructor(){this.loaded={}}loadTile(ae){return c._(this,void 0,void 0,function*(){const{uid:ue,encoding:ee,rawImageData:fe,redFactor:Oe,greenFactor:Ye,blueFactor:ye,baseShift:Ae}=ae,Be=fe.width+2,$e=fe.height+2,He=c.b(fe)?new c.R({width:Be,height:$e},yield c.cN(fe,-1,-1,Be,$e)):fe,ut=new c.cO(ue,He,ee,Oe,Ye,ye,Ae);return this.loaded=this.loaded||{},this.loaded[ue]=ut,ut})}removeTile(ae){const ue=this.loaded,ee=ae.uid;ue&&ue[ee]&&delete ue[ee]}}var T,R,z=function(){if(R)return T;function Pe(ue,ee){if(ue.length!==0){ae(ue[0],ee);for(var fe=1;fe<ue.length;fe++)ae(ue[fe],!ee)}}function ae(ue,ee){for(var fe=0,Oe=0,Ye=0,ye=ue.length,Ae=ye-1;Ye<ye;Ae=Ye++){var Be=(ue[Ye][0]-ue[Ae][0])*(ue[Ae][1]+ue[Ye][1]),$e=fe+Be;Oe+=Math.abs(fe)>=Math.abs(Be)?fe-$e+Be:Be-$e+fe,fe=$e}fe+Oe>=0!=!!ee&&ue.reverse()}return R=1,T=function ue(ee,fe){var Oe,Ye=ee&&ee.type;if(Ye==="FeatureCollection")for(Oe=0;Oe<ee.features.length;Oe++)ue(ee.features[Oe],fe);else if(Ye==="GeometryCollection")for(Oe=0;Oe<ee.geometries.length;Oe++)ue(ee.geometries[Oe],fe);else if(Ye==="Feature")ue(ee.geometry,fe);else if(Ye==="Polygon")Pe(ee.coordinates,fe);else if(Ye==="MultiPolygon")for(Oe=0;Oe<ee.coordinates.length;Oe++)Pe(ee.coordinates[Oe],fe);return ee}}(),I=c.cP(z);const L=c.cK.VectorTileFeature.prototype.toGeoJSON;class V{constructor(ae){this._feature=ae,this.extent=c.$,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const ue of this._feature.geometry)ae.push([new c.P(ue[0],ue[1])]);return ae}{const ae=[];for(const ue of this._feature.geometry){const ee=[];for(const fe of ue)ee.push(new c.P(fe[0],fe[1]));ae.push(ee)}return ae}}toGeoJSON(ae,ue,ee){return L.call(this,ae,ue,ee)}}class B{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.$,this.length=ae.length,this._features=ae}feature(ae){return new V(this._features[ae])}}var W,X,q,te={exports:{}},se=function(){if(q)return te.exports;q=1;var Pe=c.cS(),ae=function(){if(X)return W;X=1;var $e=c.cQ(),He=c.cR().VectorTileFeature;function ut(Ut,Kt){this.options=Kt||{},this.features=Ut,this.length=Ut.length}function We(Ut,Kt){this.id=typeof Ut.id=="number"?Ut.id:void 0,this.type=Ut.type,this.rawGeometry=Ut.type===1?[Ut.geometry]:Ut.geometry,this.properties=Ut.tags,this.extent=Kt||4096}return W=ut,ut.prototype.feature=function(Ut){return new We(this.features[Ut],this.options.extent)},We.prototype.loadGeometry=function(){var Ut=this.rawGeometry;this.geometry=[];for(var Kt=0;Kt<Ut.length;Kt++){for(var Re=Ut[Kt],it=[],mt=0;mt<Re.length;mt++)it.push(new $e(Re[mt][0],Re[mt][1]));this.geometry.push(it)}return this.geometry},We.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ut=this.geometry,Kt=1/0,Re=-1/0,it=1/0,mt=-1/0,Wt=0;Wt<Ut.length;Wt++)for(var tn=Ut[Wt],pn=0;pn<tn.length;pn++){var rn=tn[pn];Kt=Math.min(Kt,rn.x),Re=Math.max(Re,rn.x),it=Math.min(it,rn.y),mt=Math.max(mt,rn.y)}return[Kt,it,Re,mt]},We.prototype.toGeoJSON=He.prototype.toGeoJSON,W}();function ue($e){var He=new Pe;return function(ut,We){for(var Ut in ut.layers)We.writeMessage(3,ee,ut.layers[Ut])}($e,He),He.finish()}function ee($e,He){var ut;He.writeVarintField(15,$e.version||1),He.writeStringField(1,$e.name||""),He.writeVarintField(5,$e.extent||4096);var We={keys:[],values:[],keycache:{},valuecache:{}};for(ut=0;ut<$e.length;ut++)We.feature=$e.feature(ut),He.writeMessage(2,fe,We);var Ut=We.keys;for(ut=0;ut<Ut.length;ut++)He.writeStringField(3,Ut[ut]);var Kt=We.values;for(ut=0;ut<Kt.length;ut++)He.writeMessage(4,Be,Kt[ut])}function fe($e,He){var ut=$e.feature;ut.id!==void 0&&He.writeVarintField(1,ut.id),He.writeMessage(2,Oe,$e),He.writeVarintField(3,ut.type),He.writeMessage(4,Ae,ut)}function Oe($e,He){var ut=$e.feature,We=$e.keys,Ut=$e.values,Kt=$e.keycache,Re=$e.valuecache;for(var it in ut.properties){var mt=ut.properties[it],Wt=Kt[it];if(mt!==null){Wt===void 0&&(We.push(it),Kt[it]=Wt=We.length-1),He.writeVarint(Wt);var tn=typeof mt;tn!=="string"&&tn!=="boolean"&&tn!=="number"&&(mt=JSON.stringify(mt));var pn=tn+":"+mt,rn=Re[pn];rn===void 0&&(Ut.push(mt),Re[pn]=rn=Ut.length-1),He.writeVarint(rn)}}}function Ye($e,He){return(He<<3)+(7&$e)}function ye($e){return $e<<1^$e>>31}function Ae($e,He){for(var ut=$e.loadGeometry(),We=$e.type,Ut=0,Kt=0,Re=ut.length,it=0;it<Re;it++){var mt=ut[it],Wt=1;We===1&&(Wt=mt.length),He.writeVarint(Ye(1,Wt));for(var tn=We===3?mt.length-1:mt.length,pn=0;pn<tn;pn++){pn===1&&We!==1&&He.writeVarint(Ye(2,tn-1));var rn=mt[pn].x-Ut,on=mt[pn].y-Kt;He.writeVarint(ye(rn)),He.writeVarint(ye(on)),Ut+=rn,Kt+=on}We===3&&He.writeVarint(Ye(7,1))}}function Be($e,He){var ut=typeof $e;ut==="string"?He.writeStringField(1,$e):ut==="boolean"?He.writeBooleanField(7,$e):ut==="number"&&($e%1!=0?He.writeDoubleField(3,$e):$e<0?He.writeSVarintField(6,$e):He.writeVarintField(5,$e))}return te.exports=ue,te.exports.fromVectorTileJs=ue,te.exports.fromGeojsonVt=function($e,He){He=He||{};var ut={};for(var We in $e)ut[We]=new ae($e[We].features,He),ut[We].name=We,ut[We].version=He.version,ut[We].extent=He.extent;return ue({layers:ut})},te.exports.GeoJSONWrapper=ae,te.exports}(),re=c.cP(se);const $={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Pe=>Pe},ce=Math.fround||(Ce=new Float32Array(1),Pe=>(Ce[0]=+Pe,Ce[0]));var Ce;class Se{constructor(ae){this.options=Object.assign(Object.create($),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){const{log:ue,minZoom:ee,maxZoom:fe}=this.options;ue&&console.time("total time");const Oe=`prepare ${ae.length} points`;ue&&console.time(Oe),this.points=ae;const Ye=[];for(let Ae=0;Ae<ae.length;Ae++){const Be=ae[Ae];if(!Be.geometry)continue;const[$e,He]=Be.geometry.coordinates,ut=ce(Me($e)),We=ce(Te(He));Ye.push(ut,We,1/0,Ae,-1,1),this.options.reduce&&Ye.push(0)}let ye=this.trees[fe+1]=this._createTree(Ye);ue&&console.timeEnd(Oe);for(let Ae=fe;Ae>=ee;Ae--){const Be=+Date.now();ye=this.trees[Ae]=this._createTree(this._cluster(ye,Ae)),ue&&console.log("z%d: %d clusters in %dms",Ae,ye.numItems,+Date.now()-Be)}return ue&&console.timeEnd("total time"),this}getClusters(ae,ue){let ee=((ae[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,ae[1]));let Oe=ae[2]===180?180:((ae[2]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)ee=-180,Oe=180;else if(ee>Oe){const He=this.getClusters([ee,fe,180,Ye],ue),ut=this.getClusters([-180,fe,Oe,Ye],ue);return He.concat(ut)}const ye=this.trees[this._limitZoom(ue)],Ae=ye.range(Me(ee),Te(Ye),Me(Oe),Te(fe)),Be=ye.data,$e=[];for(const He of Ae){const ut=this.stride*He;$e.push(Be[ut+5]>1?Xe(Be,ut,this.clusterProps):this.points[Be[ut+3]])}return $e}getChildren(ae){const ue=this._getOriginId(ae),ee=this._getOriginZoom(ae),fe="No cluster with the specified id.",Oe=this.trees[ee];if(!Oe)throw new Error(fe);const Ye=Oe.data;if(ue*this.stride>=Ye.length)throw new Error(fe);const ye=this.options.radius/(this.options.extent*Math.pow(2,ee-1)),Ae=Oe.within(Ye[ue*this.stride],Ye[ue*this.stride+1],ye),Be=[];for(const $e of Ae){const He=$e*this.stride;Ye[He+4]===ae&&Be.push(Ye[He+5]>1?Xe(Ye,He,this.clusterProps):this.points[Ye[He+3]])}if(Be.length===0)throw new Error(fe);return Be}getLeaves(ae,ue,ee){const fe=[];return this._appendLeaves(fe,ae,ue=ue||10,ee=ee||0,0),fe}getTile(ae,ue,ee){const fe=this.trees[this._limitZoom(ae)],Oe=Math.pow(2,ae),{extent:Ye,radius:ye}=this.options,Ae=ye/Ye,Be=(ee-Ae)/Oe,$e=(ee+1+Ae)/Oe,He={features:[]};return this._addTileFeatures(fe.range((ue-Ae)/Oe,Be,(ue+1+Ae)/Oe,$e),fe.data,ue,ee,Oe,He),ue===0&&this._addTileFeatures(fe.range(1-Ae/Oe,Be,1,$e),fe.data,Oe,ee,Oe,He),ue===Oe-1&&this._addTileFeatures(fe.range(0,Be,Ae/Oe,$e),fe.data,-1,ee,Oe,He),He.features.length?He:null}getClusterExpansionZoom(ae){let ue=this._getOriginZoom(ae)-1;for(;ue<=this.options.maxZoom;){const ee=this.getChildren(ae);if(ue++,ee.length!==1)break;ae=ee[0].properties.cluster_id}return ue}_appendLeaves(ae,ue,ee,fe,Oe){const Ye=this.getChildren(ue);for(const ye of Ye){const Ae=ye.properties;if(Ae&&Ae.cluster?Oe+Ae.point_count<=fe?Oe+=Ae.point_count:Oe=this._appendLeaves(ae,Ae.cluster_id,ee,fe,Oe):Oe<fe?Oe++:ae.push(ye),ae.length===ee)break}return Oe}_createTree(ae){const ue=new c.aH(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ee=0;ee<ae.length;ee+=this.stride)ue.add(ae[ee],ae[ee+1]);return ue.finish(),ue.data=ae,ue}_addTileFeatures(ae,ue,ee,fe,Oe,Ye){for(const ye of ae){const Ae=ye*this.stride,Be=ue[Ae+5]>1;let $e,He,ut;if(Be)$e=Fe(ue,Ae,this.clusterProps),He=ue[Ae],ut=ue[Ae+1];else{const Kt=this.points[ue[Ae+3]];$e=Kt.properties;const[Re,it]=Kt.geometry.coordinates;He=Me(Re),ut=Te(it)}const We={type:1,geometry:[[Math.round(this.options.extent*(He*Oe-ee)),Math.round(this.options.extent*(ut*Oe-fe))]],tags:$e};let Ut;Ut=Be||this.options.generateId?ue[Ae+3]:this.points[ue[Ae+3]].id,Ut!==void 0&&(We.id=Ut),Ye.features.push(We)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,ue){const{radius:ee,extent:fe,reduce:Oe,minPoints:Ye}=this.options,ye=ee/(fe*Math.pow(2,ue)),Ae=ae.data,Be=[],$e=this.stride;for(let He=0;He<Ae.length;He+=$e){if(Ae[He+2]<=ue)continue;Ae[He+2]=ue;const ut=Ae[He],We=Ae[He+1],Ut=ae.within(Ae[He],Ae[He+1],ye),Kt=Ae[He+5];let Re=Kt;for(const it of Ut){const mt=it*$e;Ae[mt+2]>ue&&(Re+=Ae[mt+5])}if(Re>Kt&&Re>=Ye){let it,mt=ut*Kt,Wt=We*Kt,tn=-1;const pn=(He/$e<<5)+(ue+1)+this.points.length;for(const rn of Ut){const on=rn*$e;if(Ae[on+2]<=ue)continue;Ae[on+2]=ue;const kn=Ae[on+5];mt+=Ae[on]*kn,Wt+=Ae[on+1]*kn,Ae[on+4]=pn,Oe&&(it||(it=this._map(Ae,He,!0),tn=this.clusterProps.length,this.clusterProps.push(it)),Oe(it,this._map(Ae,on)))}Ae[He+4]=pn,Be.push(mt/Re,Wt/Re,1/0,pn,-1,Re),Oe&&Be.push(tn)}else{for(let it=0;it<$e;it++)Be.push(Ae[He+it]);if(Re>1)for(const it of Ut){const mt=it*$e;if(!(Ae[mt+2]<=ue)){Ae[mt+2]=ue;for(let Wt=0;Wt<$e;Wt++)Be.push(Ae[mt+Wt])}}}}return Be}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,ue,ee){if(ae[ue+5]>1){const Ye=this.clusterProps[ae[ue+6]];return ee?Object.assign({},Ye):Ye}const fe=this.points[ae[ue+3]].properties,Oe=this.options.map(fe);return ee&&Oe===fe?Object.assign({},Oe):Oe}}function Xe(Pe,ae,ue){return{type:"Feature",id:Pe[ae+3],properties:Fe(Pe,ae,ue),geometry:{type:"Point",coordinates:[(ee=Pe[ae],360*(ee-.5)),Ie(Pe[ae+1])]}};var ee}function Fe(Pe,ae,ue){const ee=Pe[ae+5],fe=ee>=1e4?`${Math.round(ee/1e3)}k`:ee>=1e3?Math.round(ee/100)/10+"k":ee,Oe=Pe[ae+6],Ye=Oe===-1?{}:Object.assign({},ue[Oe]);return Object.assign(Ye,{cluster:!0,cluster_id:Pe[ae+3],point_count:ee,point_count_abbreviated:fe})}function Me(Pe){return Pe/360+.5}function Te(Pe){const ae=Math.sin(Pe*Math.PI/180),ue=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return ue<0?0:ue>1?1:ue}function Ie(Pe){const ae=(180-360*Pe)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function Ke(Pe,ae,ue,ee){let fe=ee;const Oe=ae+(ue-ae>>1);let Ye,ye=ue-ae;const Ae=Pe[ae],Be=Pe[ae+1],$e=Pe[ue],He=Pe[ue+1];for(let ut=ae+3;ut<ue;ut+=3){const We=st(Pe[ut],Pe[ut+1],Ae,Be,$e,He);if(We>fe)Ye=ut,fe=We;else if(We===fe){const Ut=Math.abs(ut-Oe);Ut<ye&&(Ye=ut,ye=Ut)}}fe>ee&&(Ye-ae>3&&Ke(Pe,ae,Ye,ee),Pe[Ye+2]=fe,ue-Ye>3&&Ke(Pe,Ye,ue,ee))}function st(Pe,ae,ue,ee,fe,Oe){let Ye=fe-ue,ye=Oe-ee;if(Ye!==0||ye!==0){const Ae=((Pe-ue)*Ye+(ae-ee)*ye)/(Ye*Ye+ye*ye);Ae>1?(ue=fe,ee=Oe):Ae>0&&(ue+=Ye*Ae,ee+=ye*Ae)}return Ye=Pe-ue,ye=ae-ee,Ye*Ye+ye*ye}function Ee(Pe,ae,ue,ee){const fe={id:Pe??null,type:ae,geometry:ue,tags:ee,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")Qe(fe,ue);else if(ae==="Polygon")Qe(fe,ue[0]);else if(ae==="MultiLineString")for(const Oe of ue)Qe(fe,Oe);else if(ae==="MultiPolygon")for(const Oe of ue)Qe(fe,Oe[0]);return fe}function Qe(Pe,ae){for(let ue=0;ue<ae.length;ue+=3)Pe.minX=Math.min(Pe.minX,ae[ue]),Pe.minY=Math.min(Pe.minY,ae[ue+1]),Pe.maxX=Math.max(Pe.maxX,ae[ue]),Pe.maxY=Math.max(Pe.maxY,ae[ue+1])}function jt(Pe,ae,ue,ee){if(!ae.geometry)return;const fe=ae.geometry.coordinates;if(fe&&fe.length===0)return;const Oe=ae.geometry.type,Ye=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2);let ye=[],Ae=ae.id;if(ue.promoteId?Ae=ae.properties[ue.promoteId]:ue.generateId&&(Ae=ee||0),Oe==="Point")je(fe,ye);else if(Oe==="MultiPoint")for(const Be of fe)je(Be,ye);else if(Oe==="LineString")ft(fe,ye,Ye,!1);else if(Oe==="MultiLineString"){if(ue.lineMetrics){for(const Be of fe)ye=[],ft(Be,ye,Ye,!1),Pe.push(Ee(Ae,"LineString",ye,ae.properties));return}At(fe,ye,Ye,!1)}else if(Oe==="Polygon")At(fe,ye,Ye,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(const Be of ae.geometry.geometries)jt(Pe,{id:Ae,geometry:Be,properties:ae.properties},ue,ee);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Be of fe){const $e=[];At(Be,$e,Ye,!0),ye.push($e)}}Pe.push(Ee(Ae,Oe,ye,ae.properties))}function je(Pe,ae){ae.push(ht(Pe[0]),lt(Pe[1]),0)}function ft(Pe,ae,ue,ee){let fe,Oe,Ye=0;for(let Ae=0;Ae<Pe.length;Ae++){const Be=ht(Pe[Ae][0]),$e=lt(Pe[Ae][1]);ae.push(Be,$e,0),Ae>0&&(Ye+=ee?(fe*$e-Be*Oe)/2:Math.sqrt(Math.pow(Be-fe,2)+Math.pow($e-Oe,2))),fe=Be,Oe=$e}const ye=ae.length-3;ae[2]=1,Ke(ae,0,ye,ue),ae[ye+2]=1,ae.size=Math.abs(Ye),ae.start=0,ae.end=ae.size}function At(Pe,ae,ue,ee){for(let fe=0;fe<Pe.length;fe++){const Oe=[];ft(Pe[fe],Oe,ue,ee),ae.push(Oe)}}function ht(Pe){return Pe/360+.5}function lt(Pe){const ae=Math.sin(Pe*Math.PI/180),ue=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return ue<0?0:ue>1?1:ue}function bt(Pe,ae,ue,ee,fe,Oe,Ye,ye){if(ee/=ae,Oe>=(ue/=ae)&&Ye<ee)return Pe;if(Ye<ue||Oe>=ee)return null;const Ae=[];for(const Be of Pe){const $e=Be.geometry;let He=Be.type;const ut=fe===0?Be.minX:Be.minY,We=fe===0?Be.maxX:Be.maxY;if(ut>=ue&&We<ee){Ae.push(Be);continue}if(We<ue||ut>=ee)continue;let Ut=[];if(He==="Point"||He==="MultiPoint")St($e,Ut,ue,ee,fe);else if(He==="LineString")dn($e,Ut,ue,ee,fe,!1,ye.lineMetrics);else if(He==="MultiLineString")un($e,Ut,ue,ee,fe,!1);else if(He==="Polygon")un($e,Ut,ue,ee,fe,!0);else if(He==="MultiPolygon")for(const Kt of $e){const Re=[];un(Kt,Re,ue,ee,fe,!0),Re.length&&Ut.push(Re)}if(Ut.length){if(ye.lineMetrics&&He==="LineString"){for(const Kt of Ut)Ae.push(Ee(Be.id,He,Kt,Be.tags));continue}He!=="LineString"&&He!=="MultiLineString"||(Ut.length===1?(He="LineString",Ut=Ut[0]):He="MultiLineString"),He!=="Point"&&He!=="MultiPoint"||(He=Ut.length===3?"Point":"MultiPoint"),Ae.push(Ee(Be.id,He,Ut,Be.tags))}}return Ae.length?Ae:null}function St(Pe,ae,ue,ee,fe){for(let Oe=0;Oe<Pe.length;Oe+=3){const Ye=Pe[Oe+fe];Ye>=ue&&Ye<=ee&&et(ae,Pe[Oe],Pe[Oe+1],Pe[Oe+2])}}function dn(Pe,ae,ue,ee,fe,Oe,Ye){let ye=En(Pe);const Ae=fe===0?Ln:Jt;let Be,$e,He=Pe.start;for(let Re=0;Re<Pe.length-3;Re+=3){const it=Pe[Re],mt=Pe[Re+1],Wt=Pe[Re+2],tn=Pe[Re+3],pn=Pe[Re+4],rn=fe===0?it:mt,on=fe===0?tn:pn;let kn=!1;Ye&&(Be=Math.sqrt(Math.pow(it-tn,2)+Math.pow(mt-pn,2))),rn<ue?on>ue&&($e=Ae(ye,it,mt,tn,pn,ue),Ye&&(ye.start=He+Be*$e)):rn>ee?on<ee&&($e=Ae(ye,it,mt,tn,pn,ee),Ye&&(ye.start=He+Be*$e)):et(ye,it,mt,Wt),on<ue&&rn>=ue&&($e=Ae(ye,it,mt,tn,pn,ue),kn=!0),on>ee&&rn<=ee&&($e=Ae(ye,it,mt,tn,pn,ee),kn=!0),!Oe&&kn&&(Ye&&(ye.end=He+Be*$e),ae.push(ye),ye=En(Pe)),Ye&&(He+=Be)}let ut=Pe.length-3;const We=Pe[ut],Ut=Pe[ut+1],Kt=fe===0?We:Ut;Kt>=ue&&Kt<=ee&&et(ye,We,Ut,Pe[ut+2]),ut=ye.length-3,Oe&&ut>=3&&(ye[ut]!==ye[0]||ye[ut+1]!==ye[1])&&et(ye,ye[0],ye[1],ye[2]),ye.length&&ae.push(ye)}function En(Pe){const ae=[];return ae.size=Pe.size,ae.start=Pe.start,ae.end=Pe.end,ae}function un(Pe,ae,ue,ee,fe,Oe){for(const Ye of Pe)dn(Ye,ae,ue,ee,fe,Oe,!1)}function et(Pe,ae,ue,ee){Pe.push(ae,ue,ee)}function Ln(Pe,ae,ue,ee,fe,Oe){const Ye=(Oe-ae)/(ee-ae);return et(Pe,Oe,ue+(fe-ue)*Ye,1),Ye}function Jt(Pe,ae,ue,ee,fe,Oe){const Ye=(Oe-ue)/(fe-ue);return et(Pe,ae+(ee-ae)*Ye,Oe,1),Ye}function fn(Pe,ae){const ue=[];for(let ee=0;ee<Pe.length;ee++){const fe=Pe[ee],Oe=fe.type;let Ye;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")Ye=$t(fe.geometry,ae);else if(Oe==="MultiLineString"||Oe==="Polygon"){Ye=[];for(const ye of fe.geometry)Ye.push($t(ye,ae))}else if(Oe==="MultiPolygon"){Ye=[];for(const ye of fe.geometry){const Ae=[];for(const Be of ye)Ae.push($t(Be,ae));Ye.push(Ae)}}ue.push(Ee(fe.id,Oe,Ye,fe.tags))}return ue}function $t(Pe,ae){const ue=[];ue.size=Pe.size,Pe.start!==void 0&&(ue.start=Pe.start,ue.end=Pe.end);for(let ee=0;ee<Pe.length;ee+=3)ue.push(Pe[ee]+ae,Pe[ee+1],Pe[ee+2]);return ue}function Nn(Pe,ae){if(Pe.transformed)return Pe;const ue=1<<Pe.z,ee=Pe.x,fe=Pe.y;for(const Oe of Pe.features){const Ye=Oe.geometry,ye=Oe.type;if(Oe.geometry=[],ye===1)for(let Ae=0;Ae<Ye.length;Ae+=2)Oe.geometry.push(vn(Ye[Ae],Ye[Ae+1],ae,ue,ee,fe));else for(let Ae=0;Ae<Ye.length;Ae++){const Be=[];for(let $e=0;$e<Ye[Ae].length;$e+=2)Be.push(vn(Ye[Ae][$e],Ye[Ae][$e+1],ae,ue,ee,fe));Oe.geometry.push(Be)}}return Pe.transformed=!0,Pe}function vn(Pe,ae,ue,ee,fe,Oe){return[Math.round(ue*(Pe*ee-fe)),Math.round(ue*(ae*ee-Oe))]}function Ue(Pe,ae,ue,ee,fe){const Oe=ae===fe.maxZoom?0:fe.tolerance/((1<<ae)*fe.extent),Ye={features:[],numPoints:0,numSimplified:0,numFeatures:Pe.length,source:null,x:ue,y:ee,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ye of Pe)we(Ye,ye,Oe,fe);return Ye}function we(Pe,ae,ue,ee){const fe=ae.geometry,Oe=ae.type,Ye=[];if(Pe.minX=Math.min(Pe.minX,ae.minX),Pe.minY=Math.min(Pe.minY,ae.minY),Pe.maxX=Math.max(Pe.maxX,ae.maxX),Pe.maxY=Math.max(Pe.maxY,ae.maxY),Oe==="Point"||Oe==="MultiPoint")for(let ye=0;ye<fe.length;ye+=3)Ye.push(fe[ye],fe[ye+1]),Pe.numPoints++,Pe.numSimplified++;else if(Oe==="LineString")yt(Ye,fe,Pe,ue,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(let ye=0;ye<fe.length;ye++)yt(Ye,fe[ye],Pe,ue,Oe==="Polygon",ye===0);else if(Oe==="MultiPolygon")for(let ye=0;ye<fe.length;ye++){const Ae=fe[ye];for(let Be=0;Be<Ae.length;Be++)yt(Ye,Ae[Be],Pe,ue,!0,Be===0)}if(Ye.length){let ye=ae.tags||null;if(Oe==="LineString"&&ee.lineMetrics){ye={};for(const Be in ae.tags)ye[Be]=ae.tags[Be];ye.mapbox_clip_start=fe.start/fe.size,ye.mapbox_clip_end=fe.end/fe.size}const Ae={geometry:Ye,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:ye};ae.id!==null&&(Ae.id=ae.id),Pe.features.push(Ae)}}function yt(Pe,ae,ue,ee,fe,Oe){const Ye=ee*ee;if(ee>0&&ae.size<(fe?Ye:ee))return void(ue.numPoints+=ae.length/3);const ye=[];for(let Ae=0;Ae<ae.length;Ae+=3)(ee===0||ae[Ae+2]>Ye)&&(ue.numSimplified++,ye.push(ae[Ae],ae[Ae+1])),ue.numPoints++;fe&&function(Ae,Be){let $e=0;for(let He=0,ut=Ae.length,We=ut-2;He<ut;We=He,He+=2)$e+=(Ae[He]-Ae[We])*(Ae[He+1]+Ae[We+1]);if($e>0===Be)for(let He=0,ut=Ae.length;He<ut/2;He+=2){const We=Ae[He],Ut=Ae[He+1];Ae[He]=Ae[ut-2-He],Ae[He+1]=Ae[ut-1-He],Ae[ut-2-He]=We,Ae[ut-1-He]=Ut}}(ye,Oe),Pe.push(ye)}const Nt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ht{constructor(ae,ue){const ee=(ue=this.options=function(Oe,Ye){for(const ye in Ye)Oe[ye]=Ye[ye];return Oe}(Object.create(Nt),ue)).debug;if(ee&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");let fe=function(Oe,Ye){const ye=[];if(Oe.type==="FeatureCollection")for(let Ae=0;Ae<Oe.features.length;Ae++)jt(ye,Oe.features[Ae],Ye,Ae);else jt(ye,Oe.type==="Feature"?Oe:{geometry:Oe},Ye);return ye}(ae,ue);this.tiles={},this.tileCoords=[],ee&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(Oe,Ye){const ye=Ye.buffer/Ye.extent;let Ae=Oe;const Be=bt(Oe,1,-1-ye,ye,0,-1,2,Ye),$e=bt(Oe,1,1-ye,2+ye,0,-1,2,Ye);return(Be||$e)&&(Ae=bt(Oe,1,-ye,1+ye,0,-1,2,Ye)||[],Be&&(Ae=fn(Be,1).concat(Ae)),$e&&(Ae=Ae.concat(fn($e,-1)))),Ae}(fe,ue),fe.length&&this.splitTile(fe,0,0,0),ee&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ae,ue,ee,fe,Oe,Ye,ye){const Ae=[ae,ue,ee,fe],Be=this.options,$e=Be.debug;for(;Ae.length;){fe=Ae.pop(),ee=Ae.pop(),ue=Ae.pop(),ae=Ae.pop();const He=1<<ue,ut=Ot(ue,ee,fe);let We=this.tiles[ut];if(!We&&($e>1&&console.time("creation"),We=this.tiles[ut]=Ue(ae,ue,ee,fe,Be),this.tileCoords.push({z:ue,x:ee,y:fe}),$e)){$e>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,ee,fe,We.numFeatures,We.numPoints,We.numSimplified),console.timeEnd("creation"));const kn=`z${ue}`;this.stats[kn]=(this.stats[kn]||0)+1,this.total++}if(We.source=ae,Oe==null){if(ue===Be.indexMaxZoom||We.numPoints<=Be.indexMaxPoints)continue}else{if(ue===Be.maxZoom||ue===Oe)continue;if(Oe!=null){const kn=Oe-ue;if(ee!==Ye>>kn||fe!==ye>>kn)continue}}if(We.source=null,ae.length===0)continue;$e>1&&console.time("clipping");const Ut=.5*Be.buffer/Be.extent,Kt=.5-Ut,Re=.5+Ut,it=1+Ut;let mt=null,Wt=null,tn=null,pn=null,rn=bt(ae,He,ee-Ut,ee+Re,0,We.minX,We.maxX,Be),on=bt(ae,He,ee+Kt,ee+it,0,We.minX,We.maxX,Be);ae=null,rn&&(mt=bt(rn,He,fe-Ut,fe+Re,1,We.minY,We.maxY,Be),Wt=bt(rn,He,fe+Kt,fe+it,1,We.minY,We.maxY,Be),rn=null),on&&(tn=bt(on,He,fe-Ut,fe+Re,1,We.minY,We.maxY,Be),pn=bt(on,He,fe+Kt,fe+it,1,We.minY,We.maxY,Be),on=null),$e>1&&console.timeEnd("clipping"),Ae.push(mt||[],ue+1,2*ee,2*fe),Ae.push(Wt||[],ue+1,2*ee,2*fe+1),Ae.push(tn||[],ue+1,2*ee+1,2*fe),Ae.push(pn||[],ue+1,2*ee+1,2*fe+1)}}getTile(ae,ue,ee){ae=+ae,ue=+ue,ee=+ee;const fe=this.options,{extent:Oe,debug:Ye}=fe;if(ae<0||ae>24)return null;const ye=1<<ae,Ae=Ot(ae,ue=ue+ye&ye-1,ee);if(this.tiles[Ae])return Nn(this.tiles[Ae],Oe);Ye>1&&console.log("drilling down to z%d-%d-%d",ae,ue,ee);let Be,$e=ae,He=ue,ut=ee;for(;!Be&&$e>0;)$e--,He>>=1,ut>>=1,Be=this.tiles[Ot($e,He,ut)];return Be&&Be.source?(Ye>1&&(console.log("found parent tile z%d-%d-%d",$e,He,ut),console.time("drilling down")),this.splitTile(Be.source,$e,He,ut,ae,ue,ee),Ye>1&&console.timeEnd("drilling down"),this.tiles[Ae]?Nn(this.tiles[Ae],Oe):null):null}}function Ot(Pe,ae,ue){return 32*((1<<Pe)*ue+ae)+Pe}function ln(Pe,ae){return ae?Pe.properties[ae]:Pe.id}function Gt(Pe,ae){if(Pe==null)return!0;if(Pe.type==="Feature")return ln(Pe,ae)!=null;if(Pe.type==="FeatureCollection"){const ue=new Set;for(const ee of Pe.features){const fe=ln(ee,ae);if(fe==null||ue.has(fe))return!1;ue.add(fe)}return!0}return!1}function Zt(Pe,ae){const ue=new Map;if(Pe!=null)if(Pe.type==="Feature")ue.set(ln(Pe,ae),Pe);else for(const ee of Pe.features)ue.set(ln(ee,ae),ee);return ue}class Fn extends w{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ae,ue){return c._(this,void 0,void 0,function*(){const ee=ae.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const fe=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!fe)return null;const Oe=new B(fe.features);let Ye=re(Oe);return Ye.byteOffset===0&&Ye.byteLength===Ye.buffer.byteLength||(Ye=new Uint8Array(Ye)),{vectorTile:Oe,rawData:Ye.buffer}})}loadData(ae){return c._(this,void 0,void 0,function*(){var ue;(ue=this._pendingRequest)===null||ue===void 0||ue.abort();const ee=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new c.cM(ae.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ae,this._pendingRequest),this._geoJSONIndex=ae.cluster?new Se(function({superclusterOptions:Ye,clusterProperties:ye}){if(!ye||!Ye)return Ye;const Ae={},Be={},$e={accumulated:null,zoom:0},He={properties:null},ut=Object.keys(ye);for(const We of ut){const[Ut,Kt]=ye[We],Re=c.cT(Kt),it=c.cT(typeof Ut=="string"?[Ut,["accumulated"],["get",We]]:Ut);Ae[We]=Re.value,Be[We]=it.value}return Ye.map=We=>{He.properties=We;const Ut={};for(const Kt of ut)Ut[Kt]=Ae[Kt].evaluate($e,He);return Ut},Ye.reduce=(We,Ut)=>{He.properties=Ut;for(const Kt of ut)$e.accumulated=We[Kt],We[Kt]=Be[Kt].evaluate($e,He)},Ye}(ae)).load((yield this._pendingData).features):(fe=yield this._pendingData,new Ht(fe,ae.geojsonVtOptions)),this.loaded={};const Oe={};if(ee){const Ye=ee.finish();Ye&&(Oe.resourceTiming={},Oe.resourceTiming[ae.source]=JSON.parse(JSON.stringify(Ye)))}return Oe}catch(Oe){if(delete this._pendingRequest,c.cx(Oe))return{abandoned:!0};throw Oe}var fe})}getData(){return c._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ae){const ue=this.loaded;return ue&&ue[ae.uid]?super.reloadTile(ae):this.loadTile(ae)}loadAndProcessGeoJSON(ae,ue){return c._(this,void 0,void 0,function*(){let ee=yield this.loadGeoJSON(ae,ue);if(delete this._pendingRequest,typeof ee!="object")throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`);if(I(ee,!0),ae.filter){const fe=c.cT(ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));ee={type:"FeatureCollection",features:ee.features.filter(Ye=>fe.value.evaluate({zoom:0},Ye))}}return ee})}loadGeoJSON(ae,ue){return c._(this,void 0,void 0,function*(){const{promoteId:ee}=ae;if(ae.request){const fe=yield c.j(ae.request,ue);return this._dataUpdateable=Gt(fe.data,ee)?Zt(fe.data,ee):void 0,fe.data}if(typeof ae.data=="string")try{const fe=JSON.parse(ae.data);return this._dataUpdateable=Gt(fe,ee)?Zt(fe,ee):void 0,fe}catch{throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`)}if(!ae.dataDiff)throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ae.source}`);return function(fe,Oe,Ye){var ye,Ae,Be,$e;if(Oe.removeAll&&fe.clear(),Oe.remove)for(const He of Oe.remove)fe.delete(He);if(Oe.add)for(const He of Oe.add){const ut=ln(He,Ye);ut!=null&&fe.set(ut,He)}if(Oe.update)for(const He of Oe.update){let ut=fe.get(He.id);if(ut==null)continue;const We=!He.removeAllProperties&&(((ye=He.removeProperties)===null||ye===void 0?void 0:ye.length)>0||((Ae=He.addOrUpdateProperties)===null||Ae===void 0?void 0:Ae.length)>0);if((He.newGeometry||He.removeAllProperties||We)&&(ut=Object.assign({},ut),fe.set(He.id,ut),We&&(ut.properties=Object.assign({},ut.properties))),He.newGeometry&&(ut.geometry=He.newGeometry),He.removeAllProperties)ut.properties={};else if(((Be=He.removeProperties)===null||Be===void 0?void 0:Be.length)>0)for(const Ut of He.removeProperties)Object.prototype.hasOwnProperty.call(ut.properties,Ut)&&delete ut.properties[Ut];if((($e=He.addOrUpdateProperties)===null||$e===void 0?void 0:$e.length)>0)for(const{key:Ut,value:Kt}of He.addOrUpdateProperties)ut.properties[Ut]=Kt}}(this._dataUpdateable,ae.dataDiff,ee),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ae){return c._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ae){return this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId)}getClusterChildren(ae){return this._geoJSONIndex.getChildren(ae.clusterId)}getClusterLeaves(ae){return this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset)}}class Yt{constructor(ae){this.self=ae,this.actor=new c.J(ae),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ue,ee)=>{if(this.externalWorkerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.externalWorkerSourceTypes[ue]=ee},this.self.addProtocol=c.cz,this.self.removeProtocol=c.cA,this.self.registerRTLTextPlugin=ue=>{c.cU.setMethods(ue)},this.actor.registerMessageHandler("LDT",(ue,ee)=>this._getDEMWorkerSource(ue,ee.source).loadTile(ee)),this.actor.registerMessageHandler("RDT",(ue,ee)=>c._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ue,ee.source).removeTile(ee)})),this.actor.registerMessageHandler("GCEZ",(ue,ee)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ee.type,ee.source).getClusterExpansionZoom(ee)})),this.actor.registerMessageHandler("GCC",(ue,ee)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ee.type,ee.source).getClusterChildren(ee)})),this.actor.registerMessageHandler("GCL",(ue,ee)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ee.type,ee.source).getClusterLeaves(ee)})),this.actor.registerMessageHandler("LD",(ue,ee)=>this._getWorkerSource(ue,ee.type,ee.source).loadData(ee)),this.actor.registerMessageHandler("GD",(ue,ee)=>this._getWorkerSource(ue,ee.type,ee.source).getData()),this.actor.registerMessageHandler("LT",(ue,ee)=>this._getWorkerSource(ue,ee.type,ee.source).loadTile(ee)),this.actor.registerMessageHandler("RT",(ue,ee)=>this._getWorkerSource(ue,ee.type,ee.source).reloadTile(ee)),this.actor.registerMessageHandler("AT",(ue,ee)=>this._getWorkerSource(ue,ee.type,ee.source).abortTile(ee)),this.actor.registerMessageHandler("RMT",(ue,ee)=>this._getWorkerSource(ue,ee.type,ee.source).removeTile(ee)),this.actor.registerMessageHandler("RS",(ue,ee)=>c._(this,void 0,void 0,function*(){if(!this.workerSources[ue]||!this.workerSources[ue][ee.type]||!this.workerSources[ue][ee.type][ee.source])return;const fe=this.workerSources[ue][ee.type][ee.source];delete this.workerSources[ue][ee.type][ee.source],fe.removeSource!==void 0&&fe.removeSource(ee)})),this.actor.registerMessageHandler("RM",ue=>c._(this,void 0,void 0,function*(){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue]})),this.actor.registerMessageHandler("SR",(ue,ee)=>c._(this,void 0,void 0,function*(){this.referrer=ee})),this.actor.registerMessageHandler("SRPS",(ue,ee)=>this._syncRTLPluginState(ue,ee)),this.actor.registerMessageHandler("IS",(ue,ee)=>c._(this,void 0,void 0,function*(){this.self.importScripts(ee)})),this.actor.registerMessageHandler("SI",(ue,ee)=>this._setImages(ue,ee)),this.actor.registerMessageHandler("UL",(ue,ee)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(ue).update(ee.layers,ee.removedIds)})),this.actor.registerMessageHandler("SL",(ue,ee)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(ue).replace(ee)}))}_setImages(ae,ue){return c._(this,void 0,void 0,function*(){this.availableImages[ae]=ue;for(const ee in this.workerSources[ae]){const fe=this.workerSources[ae][ee];for(const Oe in fe)fe[Oe].availableImages=ue}})}_syncRTLPluginState(ae,ue){return c._(this,void 0,void 0,function*(){return yield c.cU.syncState(ue,this.self.importScripts)})}_getAvailableImages(ae){let ue=this.availableImages[ae];return ue||(ue=[]),ue}_getLayerIndex(ae){let ue=this.layerIndexes[ae];return ue||(ue=this.layerIndexes[ae]=new s),ue}_getWorkerSource(ae,ue,ee){if(this.workerSources[ae]||(this.workerSources[ae]={}),this.workerSources[ae][ue]||(this.workerSources[ae][ue]={}),!this.workerSources[ae][ue][ee]){const fe={sendAsync:(Oe,Ye)=>(Oe.targetMapId=ae,this.actor.sendAsync(Oe,Ye))};switch(ue){case"vector":this.workerSources[ae][ue][ee]=new w(fe,this._getLayerIndex(ae),this._getAvailableImages(ae));break;case"geojson":this.workerSources[ae][ue][ee]=new Fn(fe,this._getLayerIndex(ae),this._getAvailableImages(ae));break;default:this.workerSources[ae][ue][ee]=new this.externalWorkerSourceTypes[ue](fe,this._getLayerIndex(ae),this._getAvailableImages(ae))}}return this.workerSources[ae][ue][ee]}_getDEMWorkerSource(ae,ue){return this.demWorkerSources[ae]||(this.demWorkerSources[ae]={}),this.demWorkerSources[ae][ue]||(this.demWorkerSources[ae][ue]=new E),this.demWorkerSources[ae][ue]}}return c.i(self)&&(self.worker=new Yt(self)),Yt}),o("index",["exports","./shared"],function(c,s){var m="5.6.1";function y(){var S=new s.A(4);return s.A!=Float32Array&&(S[1]=0,S[2]=0),S[0]=1,S[3]=1,S}let b,w;const E={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(S,i,u){const g=requestAnimationFrame(M=>{_(),i(M)}),{unsubscribe:_}=s.s(S.signal,"abort",()=>{_(),cancelAnimationFrame(g),u(s.c())},!1)},frameAsync(S){return new Promise((i,u)=>{this.frame(S,i,u)})},getImageData(S,i=0){return this.getImageCanvasContext(S).getImageData(-i,-i,S.width+2*i,S.height+2*i)},getImageCanvasContext(S){const i=window.document.createElement("canvas"),u=i.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return i.width=S.width,i.height=S.height,u.drawImage(S,0,0,S.width,S.height),u},resolveURL:S=>(b||(b=document.createElement("a")),b.href=S,b.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(w==null&&(w=matchMedia("(prefers-reduced-motion: reduce)")),w.matches)}};class T{static testProp(i){if(!T.docStyle)return i[0];for(let u=0;u<i.length;u++)if(i[u]in T.docStyle)return i[u];return i[0]}static create(i,u,g){const _=window.document.createElement(i);return u!==void 0&&(_.className=u),g&&g.appendChild(_),_}static createNS(i,u){return window.document.createElementNS(i,u)}static disableDrag(){T.docStyle&&T.selectProp&&(T.userSelect=T.docStyle[T.selectProp],T.docStyle[T.selectProp]="none")}static enableDrag(){T.docStyle&&T.selectProp&&(T.docStyle[T.selectProp]=T.userSelect)}static setTransform(i,u){i.style[T.transformProp]=u}static addEventListener(i,u,g,_={}){i.addEventListener(u,g,"passive"in _?_:_.capture)}static removeEventListener(i,u,g,_={}){i.removeEventListener(u,g,"passive"in _?_:_.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",T.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",T.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",T.suppressClickInternal,!0)},0)}static getScale(i){const u=i.getBoundingClientRect();return{x:u.width/i.offsetWidth||1,y:u.height/i.offsetHeight||1,boundingClientRect:u}}static getPoint(i,u,g){const _=u.boundingClientRect;return new s.P((g.clientX-_.left)/u.x-i.clientLeft,(g.clientY-_.top)/u.y-i.clientTop)}static mousePos(i,u){const g=T.getScale(i);return T.getPoint(i,g,u)}static touchPos(i,u){const g=[],_=T.getScale(i);for(let M=0;M<u.length;M++)g.push(T.getPoint(i,_,u[M]));return g}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}static sanitize(i){const u=new DOMParser().parseFromString(i,"text/html").body||document.createElement("body"),g=u.querySelectorAll("script");for(const _ of g)_.remove();return T.clean(u),u.innerHTML}static isPossiblyDangerous(i,u){const g=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(i)||!g.includes("javascript:")&&!g.includes("data:"))||!!i.startsWith("on")||void 0}static clean(i){const u=i.children;for(const g of u)T.removeAttributes(g),T.clean(g)}static removeAttributes(i){for(const{name:u,value:g}of i.attributes)T.isPossiblyDangerous(u,g)&&i.removeAttribute(u)}}T.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,T.selectProp=T.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),T.transformProp=T.testProp(["transform","WebkitTransform"]);const R={supported:!1,testSupport:function(S){!L&&I&&(V?B(S):z=S)}};let z,I,L=!1,V=!1;function B(S){const i=S.createTexture();S.bindTexture(S.TEXTURE_2D,i);try{if(S.texImage2D(S.TEXTURE_2D,0,S.RGBA,S.RGBA,S.UNSIGNED_BYTE,I),S.isContextLost())return;R.supported=!0}catch{}S.deleteTexture(i),L=!0}var W;typeof document<"u"&&(I=document.createElement("img"),I.onload=()=>{z&&B(z),z=null,V=!0},I.onerror=()=>{L=!0,z=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(S){let i,u,g,_;S.resetRequestQueue=()=>{i=[],u=0,g=0,_={}},S.addThrottleControl=U=>{const Z=g++;return _[Z]=U,Z},S.removeThrottleControl=U=>{delete _[U],D()},S.getImage=(U,Z,K=!0)=>new Promise((ie,ne)=>{R.supported&&(U.headers||(U.headers={}),U.headers.accept="image/webp,*/*"),s.e(U,{type:"image"}),i.push({abortController:Z,requestParameters:U,supportImageRefresh:K,state:"queued",onError:le=>{ne(le)},onSuccess:le=>{ie(le)}}),D()});const M=U=>s._(this,void 0,void 0,function*(){U.state="running";const{requestParameters:Z,supportImageRefresh:K,onError:ie,onSuccess:ne,abortController:le}=U,ge=K===!1&&!s.i(self)&&!s.g(Z.url)&&(!Z.headers||Object.keys(Z.headers).reduce((Ne,Ge)=>Ne&&Ge==="accept",!0));u++;const Le=ge?F(Z,le):s.m(Z,le);try{const Ne=yield Le;delete U.abortController,U.state="completed",Ne.data instanceof HTMLImageElement||s.b(Ne.data)?ne(Ne):Ne.data&&ne({data:yield(ze=Ne.data,typeof createImageBitmap=="function"?s.f(ze):s.h(ze)),cacheControl:Ne.cacheControl,expires:Ne.expires})}catch(Ne){delete U.abortController,ie(Ne)}finally{u--,D()}var ze}),D=()=>{const U=(()=>{for(const Z of Object.keys(_))if(_[Z]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let Z=u;Z<U&&i.length>0;Z++){const K=i.shift();K.abortController.signal.aborted?Z--:M(K)}},F=(U,Z)=>new Promise((K,ie)=>{const ne=new Image,le=U.url,ge=U.credentials;ge&&ge==="include"?ne.crossOrigin="use-credentials":(ge&&ge==="same-origin"||!s.d(le))&&(ne.crossOrigin="anonymous"),Z.signal.addEventListener("abort",()=>{ne.src="",ie(s.c())}),ne.fetchPriority="high",ne.onload=()=>{ne.onerror=ne.onload=null,K({data:ne})},ne.onerror=()=>{ne.onerror=ne.onload=null,Z.signal.aborted||ie(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},ne.src=le})}(W||(W={})),W.resetRequestQueue();class X{constructor(i){this._transformRequestFn=i}transformRequest(i,u){return this._transformRequestFn&&this._transformRequestFn(i,u)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function q(S){const i=[];if(typeof S=="string")i.push({id:"default",url:S});else if(S&&S.length>0){const u=[];for(const{id:g,url:_}of S){const M=`${g}${_}`;u.indexOf(M)===-1&&(u.push(M),i.push({id:g,url:_}))}}return i}function te(S,i,u){try{const g=new URL(S);return g.pathname+=`${i}${u}`,g.toString()}catch{throw new Error(`Invalid sprite URL "${S}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function se(S){const{userImage:i}=S;return!!(i&&i.render&&i.render())&&(S.data.replace(new Uint8Array(i.data.buffer)),!0)}class re extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:u,promiseResolve:g}of this.requestors)g(this._getImagesForIds(u));this.requestors=[]}}getImage(i){const u=this.images[i];if(u&&!u.data&&u.spriteData){const g=u.spriteData;u.data=new s.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),u.spriteData=null}return u}addImage(i,u){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,u)&&(this.images[i]=u)}_validate(i,u){let g=!0;const _=u.data||u.spriteData;return this._validateStretch(u.stretchX,_&&_.width)||(this.fire(new s.k(new Error(`Image "${i}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,_&&_.height)||(this.fire(new s.k(new Error(`Image "${i}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new s.k(new Error(`Image "${i}" has invalid "content" value`))),g=!1),g}_validateStretch(i,u){if(!i)return!0;let g=0;for(const _ of i){if(_[0]<g||_[1]<_[0]||u<_[1])return!1;g=_[1]}return!0}_validateContent(i,u){if(!i)return!0;if(i.length!==4)return!1;const g=u.spriteData,_=g&&g.width||u.data.width,M=g&&g.height||u.data.height;return!(i[0]<0||_<i[0]||i[1]<0||M<i[1]||i[2]<0||_<i[2]||i[3]<0||M<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,u,g=!0){const _=this.getImage(i);if(g&&(_.data.width!==u.data.width||_.data.height!==u.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=_.version+1,this.images[i]=u,this.updatedImages[i]=!0}removeImage(i){const u=this.images[i];delete this.images[i],delete this.patterns[i],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise((u,g)=>{let _=!0;if(!this.isLoaded())for(const M of i)this.images[M]||(_=!1);this.isLoaded()||_?u(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:u})})}_getImagesForIds(i){const u={};for(const g of i){let _=this.getImage(g);_||(this.fire(new s.l("styleimagemissing",{id:g})),_=this.getImage(g)),_?u[g]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,textFitWidth:_.textFitWidth,textFitHeight:_.textFitHeight,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:s.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:i,height:u}=this.atlasImage;return{width:i,height:u}}getPattern(i){const u=this.patterns[i],g=this.getImage(i);if(!g)return null;if(u&&u.position.version===g.version)return u.position;if(u)u.position.version=g.version;else{const _={w:g.data.width+2,h:g.data.height+2,x:0,y:0},M=new s.I(_,g);this.patterns[i]={bin:_,position:M}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const u=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(i,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const M in this.patterns)i.push(this.patterns[M].bin);const{w:u,h:g}=s.p(i),_=this.atlasImage;_.resize({width:u||1,height:g||1});for(const M in this.patterns){const{bin:D}=this.patterns[M],F=D.x+1,U=D.y+1,Z=this.getImage(M).data,K=Z.width,ie=Z.height;s.R.copy(Z,_,{x:0,y:0},{x:F,y:U},{width:K,height:ie}),s.R.copy(Z,_,{x:0,y:ie-1},{x:F,y:U-1},{width:K,height:1}),s.R.copy(Z,_,{x:0,y:0},{x:F,y:U+ie},{width:K,height:1}),s.R.copy(Z,_,{x:K-1,y:0},{x:F-1,y:U},{width:1,height:ie}),s.R.copy(Z,_,{x:0,y:0},{x:F+K,y:U},{width:1,height:ie})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const u of i){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const g=this.getImage(u);g||s.w(`Image with ID: "${u}" was not found`),se(g)&&this.updateImage(u,g)}}}const $=1e20;function ce(S,i,u,g,_,M,D,F,U){for(let Z=i;Z<i+g;Z++)Ce(S,u*M+Z,M,_,D,F,U);for(let Z=u;Z<u+_;Z++)Ce(S,Z*M+i,1,g,D,F,U)}function Ce(S,i,u,g,_,M,D){M[0]=0,D[0]=-$,D[1]=$,_[0]=S[i];for(let F=1,U=0,Z=0;F<g;F++){_[F]=S[i+F*u];const K=F*F;do{const ie=M[U];Z=(_[F]-_[ie]+K-ie*ie)/(F-ie)/2}while(Z<=D[U]&&--U>-1);U++,M[U]=F,D[U]=Z,D[U+1]=$}for(let F=0,U=0;F<g;F++){for(;D[U+1]<F;)U++;const Z=M[U],K=F-Z;S[i+F*u]=_[Z]+K*K}}class Se{constructor(i,u){this.requestManager=i,this.localIdeographFontFamily=u,this.entries={}}setURL(i){this.url=i}getGlyphs(i){return s._(this,void 0,void 0,function*(){const u=[];for(const M in i)for(const D of i[M])u.push(this._getAndCacheGlyphsPromise(M,D));const g=yield Promise.all(u),_={};for(const{stack:M,id:D,glyph:F}of g)_[M]||(_[M]={}),_[M][D]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics};return _})}_getAndCacheGlyphsPromise(i,u){return s._(this,void 0,void 0,function*(){let g=this.entries[i];g||(g=this.entries[i]={glyphs:{},requests:{},ranges:{}});let _=g.glyphs[u];if(_!==void 0)return{stack:i,id:u,glyph:_};if(_=this._tinySDF(g,i,u),_)return g.glyphs[u]=_,{stack:i,id:u,glyph:_};const M=Math.floor(u/256);if(256*M>65535)throw new Error("glyphs > 65535 not supported");if(g.ranges[M])return{stack:i,id:u,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!g.requests[M]){const F=Se.loadGlyphRange(i,M,this.url,this.requestManager);g.requests[M]=F}const D=yield g.requests[M];for(const F in D)this._doesCharSupportLocalGlyph(+F)||(g.glyphs[+F]=D[+F]);return g.ranges[M]=!0,{stack:i,id:u,glyph:D[u]||null}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(i))||s.u["CJK Unified Ideographs"](i)||s.u["Hangul Syllables"](i)||s.u.Hiragana(i)||s.u.Katakana(i)||s.u["CJK Symbols and Punctuation"](i)||s.u["Halfwidth and Fullwidth Forms"](i))}_tinySDF(i,u,g){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(g))return;let M=i.tinySDF;if(!M){let F="400";/bold/i.test(u)?F="900":/medium/i.test(u)?F="500":/light/i.test(u)&&(F="200"),M=i.tinySDF=new Se.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:F})}const D=M.draw(String.fromCharCode(g));return{id:g,bitmap:new s.q({width:D.width||60,height:D.height||60},D.data),metrics:{width:D.glyphWidth/2||24,height:D.glyphHeight/2||24,left:D.glyphLeft/2+.5||0,top:D.glyphTop/2-27.5||-8,advance:D.glyphAdvance/2||24,isDoubleResolution:!0}}}}Se.loadGlyphRange=function(S,i,u,g){return s._(this,void 0,void 0,function*(){const _=256*i,M=_+255,D=g.transformRequest(u.replace("{fontstack}",S).replace("{range}",`${_}-${M}`),"Glyphs"),F=yield s.n(D,new AbortController);if(!F||!F.data)throw new Error(`Could not load glyph range. range: ${i}, ${_}-${M}`);const U={};for(const Z of s.o(F.data))U[Z.id]=Z;return U})},Se.TinySDF=class{constructor({fontSize:S=24,buffer:i=3,radius:u=8,cutoff:g=.25,fontFamily:_="sans-serif",fontWeight:M="normal",fontStyle:D="normal"}={}){this.buffer=i,this.cutoff=g,this.radius=u;const F=this.size=S+4*i,U=this._createCanvas(F),Z=this.ctx=U.getContext("2d",{willReadFrequently:!0});Z.font=`${D} ${M} ${S}px ${_}`,Z.textBaseline="alphabetic",Z.textAlign="left",Z.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Uint16Array(F)}_createCanvas(S){const i=document.createElement("canvas");return i.width=i.height=S,i}draw(S){const{width:i,actualBoundingBoxAscent:u,actualBoundingBoxDescent:g,actualBoundingBoxLeft:_,actualBoundingBoxRight:M}=this.ctx.measureText(S),D=Math.ceil(u),F=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(M-_))),U=Math.min(this.size-this.buffer,D+Math.ceil(g)),Z=F+2*this.buffer,K=U+2*this.buffer,ie=Math.max(Z*K,0),ne=new Uint8ClampedArray(ie),le={data:ne,width:Z,height:K,glyphWidth:F,glyphHeight:U,glyphTop:D,glyphLeft:0,glyphAdvance:i};if(F===0||U===0)return le;const{ctx:ge,buffer:Le,gridInner:ze,gridOuter:Ne}=this;ge.clearRect(Le,Le,F,U),ge.fillText(S,Le,Le+D);const Ge=ge.getImageData(Le,Le,F,U);Ne.fill($,0,ie),ze.fill(0,0,ie);for(let Je=0;Je<U;Je++)for(let qe=0;qe<F;qe++){const at=Ge.data[4*(Je*F+qe)+3]/255;if(at===0)continue;const ct=(Je+Le)*Z+qe+Le;if(at===1)Ne[ct]=0,ze[ct]=$;else{const Ze=.5-at;Ne[ct]=Ze>0?Ze*Ze:0,ze[ct]=Ze<0?Ze*Ze:0}}ce(Ne,0,0,Z,K,Z,this.f,this.v,this.z),ce(ze,Le,Le,F,U,Z,this.f,this.v,this.z);for(let Je=0;Je<ie;Je++){const qe=Math.sqrt(Ne[Je])-Math.sqrt(ze[Je]);ne[Je]=Math.round(255-255*(qe/this.radius+this.cutoff))}return le}};class Xe{constructor(){this.specification=s.v.light.position}possiblyEvaluate(i,u){return s.B(i.expression.evaluate(u))}interpolate(i,u,g){return{x:s.C.number(i.x,u.x,g),y:s.C.number(i.y,u.y,g),z:s.C.number(i.z,u.z,g)}}}let Fe;class Me extends s.E{constructor(i){super(),Fe=Fe||new s.r({anchor:new s.D(s.v.light.anchor),position:new Xe,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.t(Fe),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,u={}){if(!this._validate(s.x,i,u))for(const g in i){const _=i[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),_):this._transitionable.setValue(g,_)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,g){return(!g||g.validate!==!1)&&s.y(this,i.call(s.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}const Te=new s.r({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class Ie extends s.E{constructor(i){super(),this._transitionable=new s.t(Te),this.setSky(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0))}setSky(i,u={}){if(!this._validate(s.G,i,u)){i||(i={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in i){const _=i[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),_):this._transitionable.setValue(g,_)}}}getSky(){return this._transitionable.serialize()}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,g={}){return g?.validate!==!1&&s.y(this,i.call(s.z,s.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(i){return i<60?0:i<70?(i-60)/10:1}}class Ke{constructor(i,u){this.width=i,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,u){const g=i.join(",")+String(u);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(i,u)),this.dashEntry[g]}getDashRanges(i,u,g){const _=[];let M=i.length%2==1?-i[i.length-1]*g:0,D=i[0]*g,F=!0;_.push({left:M,right:D,isDash:F,zeroLength:i[0]===0});let U=i[0];for(let Z=1;Z<i.length;Z++){F=!F;const K=i[Z];M=U*g,U+=K,D=U*g,_.push({left:M,right:D,isDash:F,zeroLength:K===0})}return _}addRoundDash(i,u,g){const _=u/2;for(let M=-g;M<=g;M++){const D=this.width*(this.nextRow+g+M);let F=0,U=i[F];for(let Z=0;Z<this.width;Z++){Z/U.right>1&&(U=i[++F]);const K=Math.abs(Z-U.left),ie=Math.abs(Z-U.right),ne=Math.min(K,ie);let le;const ge=M/g*(_+1);if(U.isDash){const Le=_-Math.abs(ge);le=Math.sqrt(ne*ne+Le*Le)}else le=_-Math.sqrt(ne*ne+ge*ge);this.data[D+Z]=Math.max(0,Math.min(255,le+128))}}}addRegularDash(i){for(let F=i.length-1;F>=0;--F){const U=i[F],Z=i[F+1];U.zeroLength?i.splice(F,1):Z&&Z.isDash===U.isDash&&(Z.left=U.left,i.splice(F,1))}const u=i[0],g=i[i.length-1];u.isDash===g.isDash&&(u.left=g.left-this.width,g.right=u.right+this.width);const _=this.width*this.nextRow;let M=0,D=i[M];for(let F=0;F<this.width;F++){F/D.right>1&&(D=i[++M]);const U=Math.abs(F-D.left),Z=Math.abs(F-D.right),K=Math.min(U,Z);this.data[_+F]=Math.max(0,Math.min(255,(D.isDash?K:-K)+128))}}addDash(i,u){const g=u?7:0,_=2*g+1;if(this.nextRow+_>this.height)return s.w("LineAtlas out of space"),null;let M=0;for(let F=0;F<i.length;F++)M+=i[F];if(M!==0){const F=this.width/M,U=this.getDashRanges(i,this.width,F);u?this.addRoundDash(U,F,g):this.addRegularDash(U)}const D={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:M};return this.nextRow+=_,this.dirty=!0,D}bind(i){const u=i.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const st="maplibre_preloaded_worker_pool";class Ee{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Ee.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[st]}numActive(){return Object.keys(this.active).length}}const Qe=Math.floor(E.hardwareConcurrency/2);let jt,je;function ft(){return jt||(jt=new Ee),jt}Ee.workerCount=s.H(globalThis)?Math.max(Math.min(Qe,3),1):1;class At{constructor(i,u){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=u;const g=this.workerPool.acquire(u);for(let _=0;_<g.length;_++){const M=new s.J(g[_],u);M.name=`Worker ${_}`,this.actors.push(M)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,u){const g=[];for(const _ of this.actors)g.push(_.sendAsync({type:i,data:u}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,u){for(const g of this.actors)g.registerMessageHandler(i,u)}}function ht(){return je||(je=new At(ft(),s.K),je.registerMessageHandler("GR",(S,i,u)=>s.m(i,u))),je}function lt(S,i){const u=s.L();return s.M(u,u,[1,1,0]),s.N(u,u,[.5*S.width,.5*S.height,1]),S.calculatePosMatrix?s.O(u,u,S.calculatePosMatrix(i.toUnwrapped())):u}function bt(S,i,u,g,_,M,D){var F;const U=function(ne,le,ge){if(ne)for(const Le of ne){const ze=le[Le];if(ze&&ze.source===ge&&ze.type==="fill-extrusion")return!0}else for(const Le in le){const ze=le[Le];if(ze.source===ge&&ze.type==="fill-extrusion")return!0}return!1}((F=_?.layers)!==null&&F!==void 0?F:null,i,S.id),Z=M.maxPitchScaleFactor(),K=S.tilesIn(g,Z,U);K.sort(St);const ie=[];for(const ne of K)ie.push({wrappedTileID:ne.tileID.wrapped().key,queryResults:ne.tile.queryRenderedFeatures(i,u,S._state,ne.queryGeometry,ne.cameraQueryGeometry,ne.scale,_,M,Z,lt(S.transform,ne.tileID),D?(le,ge)=>D(ne.tileID,le,ge):void 0)});return function(ne,le){for(const ge in ne)for(const Le of ne[ge])dn(Le,le);return ne}(function(ne){const le={},ge={};for(const Le of ne){const ze=Le.queryResults,Ne=Le.wrappedTileID,Ge=ge[Ne]=ge[Ne]||{};for(const Je in ze){const qe=ze[Je],at=Ge[Je]=Ge[Je]||{},ct=le[Je]=le[Je]||[];for(const Ze of qe)at[Ze.featureIndex]||(at[Ze.featureIndex]=!0,ct.push(Ze))}}return le}(ie),S)}function St(S,i){const u=S.tileID,g=i.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function dn(S,i){const u=S.feature,g=i.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=g}function En(S,i,u){return s._(this,void 0,void 0,function*(){let g=S;if(S.url?g=(yield s.j(i.transformRequest(S.url,"Source"),u)).data:yield E.frameAsync(u),!g)return null;const _=s.Q(s.e(g,S),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in g&&g.vector_layers&&(_.vectorLayerIds=g.vector_layers.map(M=>M.id)),_})}class un{constructor(i,u){i&&(u?this.setSouthWest(i).setNorthEast(u):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof s.S?new s.S(i.lng,i.lat):s.S.convert(i),this}setSouthWest(i){return this._sw=i instanceof s.S?new s.S(i.lng,i.lat):s.S.convert(i),this}extend(i){const u=this._sw,g=this._ne;let _,M;if(i instanceof s.S)_=i,M=i;else{if(!(i instanceof un))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(un.convert(i)):this.extend(s.S.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(s.S.convert(i)):this;if(_=i._sw,M=i._ne,!_||!M)return this}return u||g?(u.lng=Math.min(_.lng,u.lng),u.lat=Math.min(_.lat,u.lat),g.lng=Math.max(M.lng,g.lng),g.lat=Math.max(M.lat,g.lat)):(this._sw=new s.S(_.lng,_.lat),this._ne=new s.S(M.lng,M.lat)),this}getCenter(){return new s.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.S(this.getWest(),this.getNorth())}getSouthEast(){return new s.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:u,lat:g}=s.S.convert(i);let _=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&_}static convert(i){return i instanceof un?i:i&&new un(i)}static fromLngLat(i,u=0){const g=360*u/40075017,_=g/Math.cos(Math.PI/180*i.lat);return new un(new s.S(i.lng-_,i.lat-g),new s.S(i.lng+_,i.lat+g))}adjustAntiMeridian(){const i=new s.S(this._sw.lng,this._sw.lat),u=new s.S(this._ne.lng,this._ne.lat);return new un(i,i.lng>u.lng?new s.S(u.lng+360,u.lat):u)}}class et{constructor(i,u,g){this.bounds=un.convert(this.validateBounds(i)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const u=Math.pow(2,i.z),g=Math.floor(s.V(this.bounds.getWest())*u),_=Math.floor(s.U(this.bounds.getNorth())*u),M=Math.ceil(s.V(this.bounds.getEast())*u),D=Math.ceil(s.U(this.bounds.getSouth())*u);return i.x>=g&&i.x<M&&i.y>=_&&i.y<D}}class Ln extends s.E{constructor(i,u,g,_){if(super(),this.id=i,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.Q(u,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield En(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(s.e(this,i),i.bounds&&(this.tileBounds=new et(i.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this.fire(new s.k(i))}})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(i){return s._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(u,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};g.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise((M,D)=>{i.reloadPromise={resolve:M,reject:D}})}else i.actor=this.dispatcher.getActor(),_="LT";i.abortController=new AbortController;try{const M=yield i.actor.sendAsync({type:_,data:g},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,M)}catch(M){if(delete i.abortController,i.aborted)return;if(M&&M.status!==404)throw M;this._afterTileLoadWorkerResponse(i,null)}})}_afterTileLoadWorkerResponse(i,u){if(u&&u.resourceTiming&&(i.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&i.setExpiryData(u),i.loadVectorData(u,this.map.painter),i.reloadPromise){const g=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(g.resolve).catch(g.reject)}}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Jt extends s.E{constructor(i,u,g,_){super(),this.id=i,this.dispatcher=g,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},u),s.e(this,s.Q(u,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(i=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield En(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(s.e(this,u),u.bounds&&(this.tileBounds=new et(u.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:i})))}catch(u){this._tileJSONRequest=null,this.fire(new s.k(u))}})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load(!0)}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}serialize(){return s.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return s._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{const g=yield W.getImage(this.map._requestManager.transformRequest(u,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&i.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const _=this.map.painter.context,M=_.gl,D=g.data;i.texture=this.map.painter.getTileTexture(D.width),i.texture?i.texture.update(D,{useMipmap:!0}):(i.texture=new s.T(_,D,M.RGBA,{useMipmap:!0}),i.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST)),i.state="loaded"}}catch(g){if(delete i.abortController,i.aborted)i.state="unloaded";else if(g)throw i.state="errored",g}})}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)})}hasTransition(){return!1}}class fn extends Jt{constructor(i,u,g,_){super(i,u,g,_),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(i){return s._(this,void 0,void 0,function*(){const u=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(u,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{const _=yield W.getImage(g,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(_&&_.data){const M=_.data;this.map._refreshExpiredTiles&&(_.cacheControl||_.expires)&&i.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const D=s.b(M)&&s.W()?M:yield this.readImageNow(M),F={type:this.type,uid:i.uid,source:this.id,rawImageData:D,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();const U=yield i.actor.sendAsync({type:"LDT",data:F});i.dem=U,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(_){if(delete i.abortController,i.aborted)i.state="unloaded";else if(_)throw i.state="errored",_}})}readImageNow(i){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.X()){const u=i.width+2,g=i.height+2;try{return new s.R({width:u,height:g},yield s.Y(i,-1,-1,u,g))}catch{}}return E.getImageData(i,1)})}_getNeighboringTiles(i){const u=i.canonical,g=Math.pow(2,u.z),_=(u.x-1+g)%g,M=u.x===0?i.wrap-1:i.wrap,D=(u.x+1+g)%g,F=u.x+1===g?i.wrap+1:i.wrap,U={};return U[new s.Z(i.overscaledZ,M,u.z,_,u.y).key]={backfilled:!1},U[new s.Z(i.overscaledZ,F,u.z,D,u.y).key]={backfilled:!1},u.y>0&&(U[new s.Z(i.overscaledZ,M,u.z,_,u.y-1).key]={backfilled:!1},U[new s.Z(i.overscaledZ,i.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},U[new s.Z(i.overscaledZ,F,u.z,D,u.y-1).key]={backfilled:!1}),u.y+1<g&&(U[new s.Z(i.overscaledZ,M,u.z,_,u.y+1).key]={backfilled:!1},U[new s.Z(i.overscaledZ,i.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},U[new s.Z(i.overscaledZ,F,u.z,D,u.y+1).key]={backfilled:!1}),U}unloadTile(i){return s._(this,void 0,void 0,function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))})}}class $t extends s.E{constructor(i,u,g,_){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(_),this._data=u.data,this._options=s.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:s.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(i){return i*(s.$/this.tileSize)}_getClusterMaxZoom(i){const u=i?Math.round(i):this.maxzoom-1;return Number.isInteger(i)||i===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${i}" rounded to "${u}"`),u}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData(),this}updateData(i){return this._updateWorkerData(i),this}getData(){return s._(this,void 0,void 0,function*(){const i=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})})}getCoordinatesFromGeometry(i){return i.type==="GeometryCollection"?i.geometries.map(u=>u.coordinates).flat(1/0):i.coordinates.flat(1/0)}getBounds(){return s._(this,void 0,void 0,function*(){const i=new un,u=yield this.getData();let g;switch(u.type){case"FeatureCollection":g=u.features.map(_=>this.getCoordinatesFromGeometry(_.geometry)).flat(1/0);break;case"Feature":g=this.getCoordinatesFromGeometry(u.geometry);break;default:g=this.getCoordinatesFromGeometry(u)}if(g.length==0)return i;for(let _=0;_<g.length-1;_+=2)i.extend([g[_],g[_+1]]);return i})}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(i.clusterRadius)),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(i.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,u,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:u,offset:g}})}_updateWorkerData(i){return s._(this,void 0,void 0,function*(){const u=s.e({type:this.type},this.workerOptions);i?u.dataDiff=i:typeof this._data=="string"?(u.request=this.map._requestManager.transformRequest(E.resolveURL(this._data),"Source"),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new s.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:u});if(this._pendingLoads--,this._removed||g.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));let _=null;g.resourceTiming&&g.resourceTiming[this.id]&&(_=g.resourceTiming[this.id].slice(0));const M={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&s.e(M,{resourceTiming:_}),this.fire(new s.l("data",Object.assign(Object.assign({},M),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},M),{sourceDataType:"content"})))}catch(g){if(this._pendingLoads--,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(g))}})}loaded(){return this._pendingLoads===0}loadTile(i){return s._(this,void 0,void 0,function*(){const u=i.actor?"RT":"LT";i.actor=this.actor;const g={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};i.abortController=new AbortController;const _=yield this.actor.sendAsync({type:u,data:g},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(_,this.map.painter,u==="RT")})}abortTile(i){return s._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0})}unloadTile(i){return s._(this,void 0,void 0,function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Nn extends s.E{constructor(i,u,g,_){super(),this.flippedWindingOrder=!1,this.id=i,this.dispatcher=g,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=u}load(i){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield W.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,i&&(this.coordinates=i),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new s.k(u))}})}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;const u=i.map(s.a0.fromLngLat);var g;return this.tileID=function(_){const M=s.a1.fromPoints(_),D=M.width(),F=M.height(),U=Math.max(D,F),Z=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),K=Math.pow(2,Z);return new s.a3(Z,Math.floor((M.minX+M.maxX)/2*K),Math.floor((M.minY+M.maxY)/2*K))}(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map(_=>this.tileID.getTilePoint(_)._round()),this.flippedWindingOrder=((g=this.tileCoords)[1].x-g[0].x)*(g[2].y-g[0].y)-(g[1].y-g[0].y)*(g[2].x-g[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,u=i.gl;this.texture||(this.texture=new s.T(i,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let g=!1;for(const _ in this.tiles){const M=this.tiles[_];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,g=!0)}g&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(i){const{minX:u,minY:g,maxX:_,maxY:M}=s.a1.fromPoints(i),D={};for(let F=0;F<=s.a2;F++){const U=Math.pow(2,F),Z=Math.floor(u*U),K=Math.floor(g*U),ie=Math.floor(_*U),ne=Math.floor(M*U);D[F]={minTileX:Z,minTileY:K,maxTileX:ie,maxTileY:ne}}return D}}class vn extends Nn{constructor(i,u,g,_){super(i,u,g,_),this.roundZoom=!0,this.type="video",this.options=u}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;const i=this.options;this.urls=[];for(const u of i.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield s.a4(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new s.k(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const u=this.video.seekable;i<u.start(0)||i>u.end(0)?this.fire(new s.k(new s.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,u=i.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(i,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let g=!1;for(const _ in this.tiles){const M=this.tiles[_];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture,g=!0)}g&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ue extends Nn{constructor(i,u,g,_){super(i,u,g,_),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(M=>!Array.isArray(M)||M.length!==2||M.some(D=>typeof D!="number"))||this.fire(new s.k(new s.a5(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.a5(`sources.${i}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.k(new s.a5(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.a5(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.a5(`sources.${i}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,g=u.gl;this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(u,this.canvas,g.RGBA,{premultiply:!0});let _=!1;for(const M in this.tiles){const D=this.tiles[M];D.state!=="loaded"&&(D.state="loaded",D.texture=this.texture,_=!0)}_&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const we={},yt=S=>{switch(S){case"geojson":return $t;case"image":return Nn;case"raster":return Jt;case"raster-dem":return fn;case"vector":return Ln;case"video":return vn;case"canvas":return Ue}return we[S]},Nt="RTLPluginLoaded";class Ht extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ht()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return s._(this,arguments,void 0,function*(u,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=E.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(Nt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ot=null;function ln(){return Ot||(Ot=new Ht),Ot}class Gt{constructor(i,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=i,this.uid=s.a6(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const u=i+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,u,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(_,M){const D={};if(!M)return D;for(const F of _){const U=F.layerIds.map(Z=>M.getLayer(Z)).filter(Boolean);if(U.length!==0){F.layers=U,F.stateDependentLayerIds&&(F.stateDependentLayers=F.stateDependentLayerIds.map(Z=>U.filter(K=>K.id===Z)[0]));for(const Z of U)D[Z.id]=F}}return D}(i.buckets,u?.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const M=this.buckets[_];if(M instanceof s.a8){if(this.hasSymbolBuckets=!0,!g)break;M.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const M=this.buckets[_];if(M instanceof s.a8&&M.hasRTLText){this.hasRTLText=!0,ln().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const M=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(_).queryRadius(M))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new s.a7}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const g in this.buckets){const _=this.buckets[g];_.uploadPending()&&_.upload(i)}const u=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(i,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(i,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,u,g,_,M,D,F,U,Z,K,ie){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:M,scale:D,tileSize:this.tileSize,pixelPosMatrix:K,transform:U,params:F,queryPadding:this.queryPadding*Z,getElevation:ie},i,u,g):{}}querySourceFeatures(i,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const _=g.loadVTLayers(),M=u&&u.sourceLayer?u.sourceLayer:"",D=_._geojsonTileLayer||_[M];if(!D)return;const F=s.a9(u&&u.filter),{z:U,x:Z,y:K}=this.tileID.canonical,ie={z:U,x:Z,y:K};for(let ne=0;ne<D.length;ne++){const le=D.feature(ne);if(F.needGeometry){const ze=s.aa(le,!0);if(!F.filter(new s.F(this.tileID.overscaledZ),ze,this.tileID.canonical))continue}else if(!F.filter(new s.F(this.tileID.overscaledZ),le))continue;const ge=g.getId(le,M),Le=new s.ab(le,U,Z,K,ge);Le.tile=ie,i.push(Le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const u=this.expirationTime;if(i.cacheControl){const g=s.ac(i.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const g=Date.now();let _=!1;if(this.expirationTime>g)_=!1;else if(u)if(this.expirationTime<u)_=!0;else{const M=this.expirationTime-u;M?this.expirationTime=g+Math.max(M,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!u.style.hasLayer(_))continue;const M=this.buckets[_],D=M.layers[0].sourceLayer||"_geojsonTileLayer",F=g[D],U=i[D];if(!F||!U||Object.keys(U).length===0)continue;M.update(U,F,this.imageAtlas&&this.imageAtlas.patternPositions||{});const Z=u&&u.style&&u.style.getLayer(_);Z&&(this.queryPadding=Math.max(this.queryPadding,Z.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<E.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=E.now()+i}setDependencies(i,u){const g={};for(const _ of u)g[_]=!0;this.dependencies[i]=g}hasDependency(i,u){for(const g of i){const _=this.dependencies[g];if(_){for(const M of u)if(_[M])return!0}}return!1}}class Zt{constructor(i,u){this.max=i,this.onRemove=u,this.reset()}reset(){for(const i in this.data)for(const u of this.data[i])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(i,u,g){const _=i.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const M={value:u,timeout:void 0};if(g!==void 0&&(M.timeout=setTimeout(()=>{this.remove(i,M)},g)),this.data[_].push(M),this.order.push(_),this.order.length>this.max){const D=this._getAndRemoveByKey(this.order[0]);D&&this.onRemove(D)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const u=this.data[i].shift();return u.timeout&&clearTimeout(u.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),u.value}getByKey(i){const u=this.data[i];return u?u[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,u){if(!this.has(i))return this;const g=i.wrapped().key,_=u===void 0?0:this.data[g].indexOf(u),M=this.data[g][_];return this.data[g].splice(_,1),M.timeout&&clearTimeout(M.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(M.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(i){const u=[];for(const g in this.data)for(const _ of this.data[g])i(_.value)||u.push(_);for(const g of u)this.remove(g.value.tileID,g)}}class Fn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,u,g){const _=String(u);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][_]=this.stateChanges[i][_]||{},s.e(this.stateChanges[i][_],g),this.deletedStates[i]===null){this.deletedStates[i]={};for(const M in this.state[i])M!==_&&(this.deletedStates[i][M]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][_]===null){this.deletedStates[i][_]={};for(const M in this.state[i][_])g[M]||(this.deletedStates[i][_][M]=null)}else for(const M in g)this.deletedStates[i]&&this.deletedStates[i][_]&&this.deletedStates[i][_][M]===null&&delete this.deletedStates[i][_][M]}removeFeatureState(i,u,g){if(this.deletedStates[i]===null)return;const _=String(u);if(this.deletedStates[i]=this.deletedStates[i]||{},g&&u!==void 0)this.deletedStates[i][_]!==null&&(this.deletedStates[i][_]=this.deletedStates[i][_]||{},this.deletedStates[i][_][g]=null);else if(u!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][_])for(g in this.deletedStates[i][_]={},this.stateChanges[i][_])this.deletedStates[i][_][g]=null;else this.deletedStates[i][_]=null;else this.deletedStates[i]=null}getState(i,u){const g=String(u),_=s.e({},(this.state[i]||{})[g],(this.stateChanges[i]||{})[g]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const M=this.deletedStates[i][u];if(M===null)return{};for(const D in M)delete _[D]}return _}initializeTileState(i,u){i.setFeatureState(this.state,u)}coalesceChanges(i,u){const g={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const M={};for(const D in this.stateChanges[_])this.state[_][D]||(this.state[_][D]={}),s.e(this.state[_][D],this.stateChanges[_][D]),M[D]=this.state[_][D];g[_]=M}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const M={};if(this.deletedStates[_]===null)for(const D in this.state[_])M[D]={},this.state[_][D]={};else for(const D in this.deletedStates[_]){if(this.deletedStates[_][D]===null)this.state[_][D]={};else for(const F of Object.keys(this.deletedStates[_][D]))delete this.state[_][D][F];M[D]=this.state[_][D]}g[_]=g[_]||{},s.e(g[_],M)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const _ in i)i[_].setFeatureState(g,u)}}const Yt=89.25;function Pe(S,i){const u=s.ag(i.lat,-s.ah,s.ah);return new s.P(s.V(i.lng)*S,s.U(u)*S)}function ae(S,i){return new s.a0(i.x/S,i.y/S).toLngLat()}function ue(S){return S.cameraToCenterDistance*Math.min(.85*Math.tan(s.ad(90-S.pitch)),Math.tan(s.ad(Yt-S.pitch)))}function ee(S,i){const u=S.canonical,g=i/s.ae(u.z),_=u.x+Math.pow(2,u.z)*S.wrap,M=s.af(new Float64Array(16));return s.M(M,M,[_*g,u.y*g,0]),s.N(M,M,[g/s.$,g/s.$,1]),M}function fe(S,i,u,g,_){const M=s.a0.fromLngLat(S,i),D=_*s.ai(1,S.lat),F=D*Math.cos(s.ad(u)),U=Math.sqrt(D*D-F*F),Z=U*Math.sin(s.ad(-g)),K=U*Math.cos(s.ad(-g));return new s.a0(M.x+Z,M.y+K,M.z+F)}function Oe(S,i,u){const g=i.intersectsFrustum(S);if(!u||g===0)return g;const _=i.intersectsPlane(u);return _===0?0:g===2&&_===2?2:1}function Ye(S,i,u){let g=0;const _=(u-i)/10;for(let M=0;M<10;M++)g+=_*Math.pow(Math.cos(i+(M+.5)/10*(u-i)),S);return g}function ye(S,i){return function(u,g,_,M,D){const F=2*((S-1)/s.aj(Math.cos(s.ad(Yt-D))/Math.cos(s.ad(Yt)))-1),U=Math.acos(_/M),Z=2*Ye(F-1,0,s.ad(D/2)),K=Math.min(s.ad(Yt),U+s.ad(D/2)),ie=Ye(F-1,Math.min(K,U-s.ad(D/2)),K),ne=Math.atan(g/_),le=Math.hypot(g,_);let ge=u;return ge+=s.aj(M/le/Math.max(.5,Math.cos(s.ad(D/2)))),ge+=F*s.aj(Math.cos(ne))/2,ge-=s.aj(Math.max(1,ie/Z/i))/2,ge}}const Ae=ye(9.314,3);function Be(S,i){const u=(i.roundZoom?Math.round:Math.floor)(S.zoom+s.aj(S.tileSize/i.tileSize));return Math.max(0,u)}function $e(S,i){const u=S.getCameraFrustum(),g=S.getClippingPlane(),_=S.screenPointToMercatorCoordinate(S.getCameraPoint()),M=s.a0.fromLngLat(S.center,S.elevation);_.z=M.z+Math.cos(S.pitchInRadians)*S.cameraToCenterDistance/S.worldSize;const D=S.getCoveringTilesDetailsProvider(),F=D.allowVariableZoom(S,i),U=Be(S,i),Z=i.minzoom||0,K=i.maxzoom!==void 0?i.maxzoom:S.maxZoom,ie=Math.min(Math.max(0,U),K),ne=Math.pow(2,ie),le=[ne*_.x,ne*_.y,0],ge=[ne*M.x,ne*M.y,0],Le=Math.hypot(M.x-_.x,M.y-_.y),ze=Math.abs(M.z-_.z),Ne=Math.hypot(Le,ze),Ge=at=>({zoom:0,x:0,y:0,wrap:at,fullyVisible:!1}),Je=[],qe=[];if(S.renderWorldCopies&&D.allowWorldCopies())for(let at=1;at<=3;at++)Je.push(Ge(-at)),Je.push(Ge(at));for(Je.push(Ge(0));Je.length>0;){const at=Je.pop(),ct=at.x,Ze=at.y;let pt=at.fullyVisible;const Tt={x:ct,y:Ze,z:at.zoom},Mt=D.getTileBoundingVolume(Tt,at.wrap,S.elevation,i);if(!pt){const wn=Oe(u,Mt,g);if(wn===0)continue;pt=wn===2}const Et=D.distanceToTile2d(_.x,_.y,Tt,Mt);let Dt=U;F&&(Dt=(i.calculateTileZoom||Ae)(S.zoom+s.aj(S.tileSize/i.tileSize),Et,ze,Ne,S.fov)),Dt=(i.roundZoom?Math.round:Math.floor)(Dt),Dt=Math.max(0,Dt);const Sn=Math.min(Dt,K);if(at.wrap=D.getWrap(M,Tt,at.wrap),at.zoom>=Sn){if(at.zoom<Z)continue;const wn=ie-at.zoom,nn=le[0]-.5-(ct<<wn),Vn=le[1]-.5-(Ze<<wn),br=i.reparseOverscaled?Math.max(at.zoom,Dt):at.zoom;qe.push({tileID:new s.Z(at.zoom===K?br:at.zoom,at.wrap,at.zoom,ct,Ze),distanceSq:s.ak([ge[0]-.5-ct,ge[1]-.5-Ze]),tileDistanceToCamera:Math.sqrt(nn*nn+Vn*Vn)})}else for(let wn=0;wn<4;wn++)Je.push({zoom:at.zoom+1,x:(ct<<1)+wn%2,y:(Ze<<1)+(wn>>1),wrap:at.wrap,fullyVisible:pt})}return qe.sort((at,ct)=>at.distanceSq-ct.distanceSq).map(at=>at.tileID)}const He=s.a1.fromPoints([new s.P(0,0),new s.P(s.$,s.$)]);class ut extends s.E{constructor(i,u,g){super(),this.id=i,this.dispatcher=g,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,M,D,F)=>{const U=new(yt(M.type))(_,M,D,F);if(U.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${U.id}`);return U})(i,u,g,this),this._tiles={},this._cache=new Zt(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Fn,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const u=this._tiles[i];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,u,g){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,u,g)}catch(_){i.state="errored",_.status!==404?this._source.fire(new s.k(_,{tile:i})):this.update(this.transform,this.terrain)}})}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new s.l("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(i),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(We).map(i=>i.key)}getRenderableIds(i){const u=[];for(const g in this._tiles)this._isIdRenderable(g,i)&&u.push(this._tiles[g]);return i?u.sort((g,_)=>{const M=g.tileID,D=_.tileID,F=new s.P(M.canonical.x,M.canonical.y)._rotate(-this.transform.bearingInRadians),U=new s.P(D.canonical.x,D.canonical.y)._rotate(-this.transform.bearingInRadians);return M.overscaledZ-D.overscaledZ||U.y-F.y||U.x-F.x}).map(g=>g.tileID.key):u.map(g=>g.tileID).sort(We).map(g=>g.key)}hasRenderableParent(i){const u=this.findLoadedParent(i,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(i,u){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(u||!this._tiles[i].holdingForFade())}reload(i){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)i?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(i,u){return s._(this,void 0,void 0,function*(){const g=this._tiles[i];g&&(g.state!=="loading"&&(g.state=u),yield this._loadTile(g,i,u))})}_tileLoaded(i,u,g){i.timeAdded=E.now(),g==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(u,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const u=this.getRenderableIds();for(let _=0;_<u.length;_++){const M=u[_];if(i.neighboringTiles&&i.neighboringTiles[M]){const D=this.getTileByID(M);g(i,D),g(D,i)}}function g(_,M){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let D=M.tileID.canonical.x-_.tileID.canonical.x;const F=M.tileID.canonical.y-_.tileID.canonical.y,U=Math.pow(2,_.tileID.canonical.z),Z=M.tileID.key;D===0&&F===0||Math.abs(F)>1||(Math.abs(D)>1&&(Math.abs(D+U)===1?D+=U:Math.abs(D-U)===1&&(D-=U)),M.dem&&_.dem&&(_.dem.backfillBorder(M.dem,D,F),_.neighboringTiles&&_.neighboringTiles[Z]&&(_.neighboringTiles[Z].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,u,g,_){for(const M in this._tiles){let D=this._tiles[M];if(_[M]||!D.hasData()||D.tileID.overscaledZ<=u||D.tileID.overscaledZ>g)continue;let F=D.tileID;for(;D&&D.tileID.overscaledZ>u+1;){const Z=D.tileID.scaledTo(D.tileID.overscaledZ-1);D=this._tiles[Z.key],D&&D.hasData()&&(F=Z)}let U=F;for(;U.overscaledZ>u;)if(U=U.scaledTo(U.overscaledZ-1),i[U.key]||i[U.canonical.key]){_[F.key]=F;break}}}findLoadedParent(i,u){if(i.key in this._loadedParentTiles){const g=this._loadedParentTiles[i.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=i.overscaledZ-1;g>=u;g--){const _=i.scaledTo(g),M=this._getLoadedTile(_);if(M)return M}}findLoadedSibling(i){return this._getLoadedTile(i)}_getLoadedTile(i){const u=this._tiles[i.key];return u&&u.hasData()?u:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const u=Math.ceil(i.width/this._source.tileSize)+1,g=Math.ceil(i.height/this._source.tileSize)+1,_=Math.floor(u*g*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(M)}handleWrapJump(i){const u=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,u){const g={};for(const _ in this._tiles){const M=this._tiles[_];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+u),g[M.tileID.key]=M}this._tiles=g;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}_updateCoveredAndRetainedTiles(i,u,g,_,M,D){const F={},U={},Z=Object.keys(i),K=E.now();for(const ie of Z){const ne=i[ie],le=this._tiles[ie];if(!le||le.fadeEndTime!==0&&le.fadeEndTime<=K)continue;const ge=this.findLoadedParent(ne,u),Le=this.findLoadedSibling(ne),ze=ge||Le||null;ze&&(this._addTile(ze.tileID),F[ze.tileID.key]=ze.tileID),U[ie]=ne}this._retainLoadedChildren(U,_,g,i);for(const ie in F)i[ie]||(this._coveredTiles[ie]=!0,i[ie]=F[ie]);if(D){const ie={},ne={};for(const le of M)this._tiles[le.key].hasData()?ie[le.key]=le:ne[le.key]=le;for(const le in ne){const ge=ne[le].children(this._source.maxzoom);this._tiles[ge[0].key]&&this._tiles[ge[1].key]&&this._tiles[ge[2].key]&&this._tiles[ge[3].key]&&(ie[ge[0].key]=i[ge[0].key]=ge[0],ie[ge[1].key]=i[ge[1].key]=ge[1],ie[ge[2].key]=i[ge[2].key]=ge[2],ie[ge[3].key]=i[ge[3].key]=ge[3],delete ne[le])}for(const le in ne){const ge=ne[le],Le=this.findLoadedParent(ge,this._source.minzoom),ze=this.findLoadedSibling(ge),Ne=Le||ze||null;if(Ne){ie[Ne.tileID.key]=i[Ne.tileID.key]=Ne.tileID;for(const Ge in ie)ie[Ge].isChildOf(Ne.tileID)&&delete ie[Ge]}}for(const le in this._tiles)ie[le]||(this._coveredTiles[le]=!0)}}update(i,u){if(!this._sourceLoaded||this._paused)return;let g;this.transform=i,this.terrain=u,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(K=>new s.Z(K.canonical.z,K.wrap,K.canonical.z,K.canonical.x,K.canonical.y)):(g=$e(i,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(g=g.filter(K=>this._source.hasTile(K)))):g=[];const _=Be(i,this._source),M=Math.max(_-ut.maxOverzooming,this._source.minzoom),D=Math.max(_+ut.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const K={};for(const ie of g)if(ie.canonical.z>this._source.minzoom){const ne=ie.scaledTo(ie.canonical.z-1);K[ne.key]=ne;const le=ie.scaledTo(Math.max(this._source.minzoom,Math.min(ie.canonical.z,5)));K[le.key]=le}g=g.concat(Object.values(K))}const F=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,F&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const U=this._updateRetainedTiles(g,_);Ut(this._source.type)&&this._updateCoveredAndRetainedTiles(U,M,D,_,g,u);for(const K in U)this._tiles[K].clearFadeHold();const Z=s.al(this._tiles,U);for(const K of Z){const ie=this._tiles[K];ie.hasSymbolBuckets&&!ie.holdingForFade()?ie.setHoldDuration(this.map._fadeDuration):ie.hasSymbolBuckets&&!ie.symbolFadeFinished()||this._removeTile(K)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,u){var g;const _={},M={},D=Math.max(u-ut.maxOverzooming,this._source.minzoom),F=Math.max(u+ut.maxUnderzooming,this._source.minzoom),U={};for(const Z of i){const K=this._addTile(Z);_[Z.key]=Z,K.hasData()||u<this._source.maxzoom&&(U[Z.key]=Z)}this._retainLoadedChildren(U,u,F,_);for(const Z of i){let K=this._tiles[Z.key];if(K.hasData())continue;if(u+1>this._source.maxzoom){const ne=Z.children(this._source.maxzoom)[0],le=this.getTile(ne);if(le&&le.hasData()){_[ne.key]=ne;continue}}else{const ne=Z.children(this._source.maxzoom);if(_[ne[0].key]&&_[ne[1].key]&&_[ne[2].key]&&_[ne[3].key])continue}let ie=K.wasRequested();for(let ne=Z.overscaledZ-1;ne>=D;--ne){const le=Z.scaledTo(ne);if(M[le.key])break;if(M[le.key]=!0,K=this.getTile(le),!K&&ie&&(K=this._addTile(le)),K){const ge=K.hasData();if((ge||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||ie)&&(_[le.key]=le),ie=K.wasRequested(),ge)break}}}return _}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const u=[];let g,_=this._tiles[i].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){g=this._loadedParentTiles[_.key];break}u.push(_.key);const M=_.scaledTo(_.overscaledZ-1);if(g=this._getLoadedTile(M),g)break;_=M}for(const M of u)this._loadedParentTiles[M]=g}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const i in this._tiles){const u=this._tiles[i].tileID,g=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=g}}_addTile(i){let u=this._tiles[i.key];if(u)return u;u=this._cache.getAndRemove(i),u&&(this._setTileReloadTimer(i.key,u),u.tileID=i,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,u)));const g=u;return u||(u=new Gt(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(u,i.key,u.state)),u.uses++,this._tiles[i.key]=u,g||this._source.fire(new s.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(i,u){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const g=u.getExpiryTimeout();g&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},g))}refreshTiles(i){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&i.some(g=>g.equals(this._tiles[u].tileID.canonical))&&this._reloadTile(u,"expired")}_removeTile(i){const u=this._tiles[i];u&&(u.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(i){const u=i.sourceDataType;i.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&i.dataType==="source"&&u==="content"&&(this.reload(i.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,u,g){const _=[],M=this.transform;if(!M)return _;const D=M.getCoveringTilesDetailsProvider().allowWorldCopies(),F=g?M.getCameraQueryGeometry(i):i,U=le=>M.screenPointToMercatorCoordinate(le,this.terrain),Z=this.transformBbox(i,U,!D),K=this.transformBbox(F,U,!D),ie=this.getIds(),ne=s.a1.fromPoints(K);for(let le=0;le<ie.length;le++){const ge=this._tiles[ie[le]];if(ge.holdingForFade())continue;const Le=D?[ge.tileID]:[ge.tileID.unwrapTo(-1),ge.tileID.unwrapTo(0)],ze=Math.pow(2,M.zoom-ge.tileID.overscaledZ),Ne=u*ge.queryPadding*s.$/ge.tileSize/ze;for(const Ge of Le){const Je=ne.map(qe=>Ge.getTilePoint(new s.a0(qe.x,qe.y)));if(Je.expandBy(Ne),Je.intersects(He)){const qe=Z.map(ct=>Ge.getTilePoint(ct)),at=K.map(ct=>Ge.getTilePoint(ct));_.push({tile:ge,tileID:D?Ge:Ge.unwrapTo(0),queryGeometry:qe,cameraQueryGeometry:at,scale:ze})}}}return _}transformBbox(i,u,g){let _=i.map(u);if(g){const M=s.a1.fromPoints(i);M.shrinkBy(.001*Math.min(M.width(),M.height()));const D=M.map(u);s.a1.fromPoints(_).covers(D)||(_=_.map(F=>F.x>.5?new s.a0(F.x-1,F.y,F.z):F))}return _}getVisibleCoordinates(i){const u=this.getRenderableIds(i).map(g=>this._tiles[g].tileID);return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(Ut(this._source.type)){const i=E.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=i)return!0}return!1}setFeatureState(i,u,g){this._state.updateState(i=i||"_geojsonTileLayer",u,g)}removeFeatureState(i,u,g){this._state.removeFeatureState(i=i||"_geojsonTileLayer",u,g)}getFeatureState(i,u){return this._state.getState(i=i||"_geojsonTileLayer",u)}setDependencies(i,u,g){const _=this._tiles[i];_&&_.setDependencies(u,g)}reloadTilesForDependencies(i,u){for(const g in this._tiles)this._tiles[g].hasDependency(i,u)&&this._reloadTile(g,"reloading");this._cache.filter(g=>!g.hasDependency(i,u))}}function We(S,i){const u=Math.abs(2*S.wrap)-+(S.wrap<0),g=Math.abs(2*i.wrap)-+(i.wrap<0);return S.overscaledZ-i.overscaledZ||g-u||i.canonical.y-S.canonical.y||i.canonical.x-S.canonical.x}function Ut(S){return S==="raster"||S==="image"||S==="video"}ut.maxOverzooming=10,ut.maxUnderzooming=3;class Kt{constructor(i,u){this.reset(i,u)}reset(i,u){this.points=i||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=s.ag(i,0,1);let u=1,g=this._distances[u];const _=i*this.paddedLength+this.padding;for(;g<_&&u<this._distances.length;)g=this._distances[++u];const M=u-1,D=this._distances[M],F=g-D,U=F>0?(_-D)/F:0;return this.points[M].mult(1-U).add(this.points[u].mult(U))}}function Re(S,i){let u=!0;return S==="always"||S!=="never"&&i!=="never"||(u=!1),u}class it{constructor(i,u,g){const _=this.boxCells=[],M=this.circleCells=[];this.xCellCount=Math.ceil(i/g),this.yCellCount=Math.ceil(u/g);for(let D=0;D<this.xCellCount*this.yCellCount;D++)_.push([]),M.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=u,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,u,g,_,M){this._forEachCell(u,g,_,M,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(_),this.bboxes.push(M)}insertCircle(i,u,g,_){this._forEachCell(u-_,g-_,u+_,g+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(u),this.circles.push(g),this.circles.push(_)}_insertBoxCell(i,u,g,_,M,D){this.boxCells[M].push(D)}_insertCircleCell(i,u,g,_,M,D){this.circleCells[M].push(D)}_query(i,u,g,_,M,D,F){if(g<0||i>this.width||_<0||u>this.height)return[];const U=[];if(i<=0&&u<=0&&this.width<=g&&this.height<=_){if(M)return[{key:null,x1:i,y1:u,x2:g,y2:_}];for(let Z=0;Z<this.boxKeys.length;Z++)U.push({key:this.boxKeys[Z],x1:this.bboxes[4*Z],y1:this.bboxes[4*Z+1],x2:this.bboxes[4*Z+2],y2:this.bboxes[4*Z+3]});for(let Z=0;Z<this.circleKeys.length;Z++){const K=this.circles[3*Z],ie=this.circles[3*Z+1],ne=this.circles[3*Z+2];U.push({key:this.circleKeys[Z],x1:K-ne,y1:ie-ne,x2:K+ne,y2:ie+ne})}}else this._forEachCell(i,u,g,_,this._queryCell,U,{hitTest:M,overlapMode:D,seenUids:{box:{},circle:{}}},F);return U}query(i,u,g,_){return this._query(i,u,g,_,!1,null)}hitTest(i,u,g,_,M,D){return this._query(i,u,g,_,!0,M,D).length>0}hitTestCircle(i,u,g,_,M){const D=i-g,F=i+g,U=u-g,Z=u+g;if(F<0||D>this.width||Z<0||U>this.height)return!1;const K=[];return this._forEachCell(D,U,F,Z,this._queryCellCircle,K,{hitTest:!0,overlapMode:_,circle:{x:i,y:u,radius:g},seenUids:{box:{},circle:{}}},M),K.length>0}_queryCell(i,u,g,_,M,D,F,U){const{seenUids:Z,hitTest:K,overlapMode:ie}=F,ne=this.boxCells[M];if(ne!==null){const ge=this.bboxes;for(const Le of ne)if(!Z.box[Le]){Z.box[Le]=!0;const ze=4*Le,Ne=this.boxKeys[Le];if(i<=ge[ze+2]&&u<=ge[ze+3]&&g>=ge[ze+0]&&_>=ge[ze+1]&&(!U||U(Ne))&&(!K||!Re(ie,Ne.overlapMode))&&(D.push({key:Ne,x1:ge[ze],y1:ge[ze+1],x2:ge[ze+2],y2:ge[ze+3]}),K))return!0}}const le=this.circleCells[M];if(le!==null){const ge=this.circles;for(const Le of le)if(!Z.circle[Le]){Z.circle[Le]=!0;const ze=3*Le,Ne=this.circleKeys[Le];if(this._circleAndRectCollide(ge[ze],ge[ze+1],ge[ze+2],i,u,g,_)&&(!U||U(Ne))&&(!K||!Re(ie,Ne.overlapMode))){const Ge=ge[ze],Je=ge[ze+1],qe=ge[ze+2];if(D.push({key:Ne,x1:Ge-qe,y1:Je-qe,x2:Ge+qe,y2:Je+qe}),K)return!0}}}return!1}_queryCellCircle(i,u,g,_,M,D,F,U){const{circle:Z,seenUids:K,overlapMode:ie}=F,ne=this.boxCells[M];if(ne!==null){const ge=this.bboxes;for(const Le of ne)if(!K.box[Le]){K.box[Le]=!0;const ze=4*Le,Ne=this.boxKeys[Le];if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,ge[ze+0],ge[ze+1],ge[ze+2],ge[ze+3])&&(!U||U(Ne))&&!Re(ie,Ne.overlapMode))return D.push(!0),!0}}const le=this.circleCells[M];if(le!==null){const ge=this.circles;for(const Le of le)if(!K.circle[Le]){K.circle[Le]=!0;const ze=3*Le,Ne=this.circleKeys[Le];if(this._circlesCollide(ge[ze],ge[ze+1],ge[ze+2],Z.x,Z.y,Z.radius)&&(!U||U(Ne))&&!Re(ie,Ne.overlapMode))return D.push(!0),!0}}}_forEachCell(i,u,g,_,M,D,F,U){const Z=this._convertToXCellCoord(i),K=this._convertToYCellCoord(u),ie=this._convertToXCellCoord(g),ne=this._convertToYCellCoord(_);for(let le=Z;le<=ie;le++)for(let ge=K;ge<=ne;ge++)if(M.call(this,i,u,g,_,this.xCellCount*ge+le,D,F,U))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,u,g,_,M,D){const F=_-i,U=M-u,Z=g+D;return Z*Z>F*F+U*U}_circleAndRectCollide(i,u,g,_,M,D,F){const U=(D-_)/2,Z=Math.abs(i-(_+U));if(Z>U+g)return!1;const K=(F-M)/2,ie=Math.abs(u-(M+K));if(ie>K+g)return!1;if(Z<=U||ie<=K)return!0;const ne=Z-U,le=ie-K;return ne*ne+le*le<=g*g}}function mt(S,i,u){const g=s.L();if(!S){const{vecSouth:ie,vecEast:ne}=tn(i),le=y();le[0]=ne[0],le[1]=ne[1],le[2]=ie[0],le[3]=ie[1],_=le,(K=(D=(M=le)[0])*(Z=M[3])-(U=M[2])*(F=M[1]))&&(_[0]=Z*(K=1/K),_[1]=-F*K,_[2]=-U*K,_[3]=D*K),g[0]=le[0],g[1]=le[1],g[4]=le[2],g[5]=le[3]}var _,M,D,F,U,Z,K;return s.N(g,g,[1/u,1/u,1]),g}function Wt(S,i,u,g){if(S){const _=s.L();if(!i){const{vecSouth:M,vecEast:D}=tn(u);_[0]=D[0],_[1]=D[1],_[4]=M[0],_[5]=M[1]}return s.N(_,_,[g,g,1]),_}return u.pixelsToClipSpaceMatrix}function tn(S){const i=Math.cos(S.rollInRadians),u=Math.sin(S.rollInRadians),g=Math.cos(S.pitchInRadians),_=Math.cos(S.bearingInRadians),M=Math.sin(S.bearingInRadians),D=s.aq();D[0]=-_*g*u-M*i,D[1]=-M*g*u+_*i;const F=s.ar(D);F<1e-9?s.as(D):s.at(D,D,1/F);const U=s.aq();U[0]=_*g*i-M*u,U[1]=M*g*i+_*u;const Z=s.ar(U);return Z<1e-9?s.as(U):s.at(U,U,1/Z),{vecEast:U,vecSouth:D}}function pn(S,i,u,g){let _;g?(_=[S,i,g(S,i),1],s.av(_,_,u)):(_=[S,i,0,1],kt(_,_,u));const M=_[3];return{point:new s.P(_[0]/M,_[1]/M),signedDistanceFromCamera:M,isOccluded:!1}}function rn(S,i){return .5+S/i*.5}function on(S,i){return S.x>=-i[0]&&S.x<=i[0]&&S.y>=-i[1]&&S.y<=i[1]}function kn(S,i,u,g,_,M,D,F,U,Z,K,ie,ne){const le=u?S.textSizeData:S.iconSizeData,ge=s.am(le,i.transform.zoom),Le=[256/i.width*2+1,256/i.height*2+1],ze=u?S.text.dynamicLayoutVertexArray:S.icon.dynamicLayoutVertexArray;ze.clear();const Ne=S.lineVertexArray,Ge=u?S.text.placedSymbolArray:S.icon.placedSymbolArray,Je=i.transform.width/i.transform.height;let qe=!1;for(let at=0;at<Ge.length;at++){const ct=Ge.get(at);if(ct.hidden||ct.writingMode===s.an.vertical&&!qe){vt(ct.numGlyphs,ze);continue}qe=!1;const Ze=new s.P(ct.anchorX,ct.anchorY),pt={getElevation:ne,pitchedLabelPlaneMatrix:g,lineVertexArray:Ne,pitchWithMap:M,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:i.transform,tileAnchorPoint:Ze,unwrappedTileID:U,width:Z,height:K,translation:ie},Tt=cn(ct.anchorX,ct.anchorY,pt);if(!on(Tt.point,Le)){vt(ct.numGlyphs,ze);continue}const Mt=rn(i.transform.cameraToCenterDistance,Tt.signedDistanceFromCamera),Et=s.ao(le,ge,ct),Dt=M?Et*i.transform.getPitchedTextCorrection(ct.anchorX,ct.anchorY,U)/Mt:Et*Mt,Sn=On({projectionContext:pt,pitchedLabelPlaneMatrixInverse:_,symbol:ct,fontSize:Dt,flip:!1,keepUpright:D,glyphOffsetArray:S.glyphOffsetArray,dynamicLayoutVertexArray:ze,aspectRatio:Je,rotateToLine:F});qe=Sn.useVertical,(Sn.notEnoughRoom||qe||Sn.needsFlipping&&On({projectionContext:pt,pitchedLabelPlaneMatrixInverse:_,symbol:ct,fontSize:Dt,flip:!0,keepUpright:D,glyphOffsetArray:S.glyphOffsetArray,dynamicLayoutVertexArray:ze,aspectRatio:Je,rotateToLine:F}).notEnoughRoom)&&vt(ct.numGlyphs,ze)}u?S.text.dynamicLayoutVertexBuffer.updateData(ze):S.icon.dynamicLayoutVertexBuffer.updateData(ze)}function Ct(S,i,u,g,_,M,D,F){const U=M.glyphStartIndex+M.numGlyphs,Z=M.lineStartIndex,K=M.lineStartIndex+M.lineLength,ie=i.getoffsetX(M.glyphStartIndex),ne=i.getoffsetX(U-1),le=_r(S*ie,u,g,_,M.segment,Z,K,F,D);if(!le)return null;const ge=_r(S*ne,u,g,_,M.segment,Z,K,F,D);return ge?F.projectionCache.anyProjectionOccluded?null:{first:le,last:ge}:null}function Gn(S,i,u,g){return S===s.an.horizontal&&Math.abs(u.y-i.y)>Math.abs(u.x-i.x)*g?{useVertical:!0}:(S===s.an.vertical?i.y<u.y:i.x>u.x)?{needsFlipping:!0}:null}function On(S){const{projectionContext:i,pitchedLabelPlaneMatrixInverse:u,symbol:g,fontSize:_,flip:M,keepUpright:D,glyphOffsetArray:F,dynamicLayoutVertexArray:U,aspectRatio:Z,rotateToLine:K}=S,ie=_/24,ne=g.lineOffsetX*ie,le=g.lineOffsetY*ie;let ge;if(g.numGlyphs>1){const Le=g.glyphStartIndex+g.numGlyphs,ze=g.lineStartIndex,Ne=g.lineStartIndex+g.lineLength,Ge=Ct(ie,F,ne,le,M,g,K,i);if(!Ge)return{notEnoughRoom:!0};const Je=qt(Ge.first.point.x,Ge.first.point.y,i,u),qe=qt(Ge.last.point.x,Ge.last.point.y,i,u);if(D&&!M){const at=Gn(g.writingMode,Je,qe,Z);if(at)return at}ge=[Ge.first];for(let at=g.glyphStartIndex+1;at<Le-1;at++){const ct=_r(ie*F.getoffsetX(at),ne,le,M,g.segment,ze,Ne,i,K);if(!ct)return{notEnoughRoom:!0};ge.push(ct)}ge.push(Ge.last)}else{if(D&&!M){const ze=nt(i.tileAnchorPoint.x,i.tileAnchorPoint.y,i).point,Ne=g.lineStartIndex+g.segment+1,Ge=new s.P(i.lineVertexArray.getx(Ne),i.lineVertexArray.gety(Ne)),Je=nt(Ge.x,Ge.y,i),qe=Je.signedDistanceFromCamera>0?Je.point:or(i.tileAnchorPoint,Ge,ze,1,i),at=qt(ze.x,ze.y,i,u),ct=qt(qe.x,qe.y,i,u),Ze=Gn(g.writingMode,at,ct,Z);if(Ze)return Ze}const Le=_r(ie*F.getoffsetX(g.glyphStartIndex),ne,le,M,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,i,K);if(!Le||i.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ge=[Le]}for(const Le of ge)s.au(U,Le.point,Le.angle);return{}}function or(S,i,u,g,_){const M=S.add(S.sub(i)._unit()),D=nt(M.x,M.y,_).point,F=u.sub(D);return u.add(F._mult(g/F.mag()))}function It(S,i,u){const g=i.projectionCache;if(g.projections[S])return g.projections[S];const _=new s.P(i.lineVertexArray.getx(S),i.lineVertexArray.gety(S)),M=nt(_.x,_.y,i);if(M.signedDistanceFromCamera>0)return g.projections[S]=M.point,g.anyProjectionOccluded=g.anyProjectionOccluded||M.isOccluded,M.point;const D=S-u.direction;return or(u.distanceFromAnchor===0?i.tileAnchorPoint:new s.P(i.lineVertexArray.getx(D),i.lineVertexArray.gety(D)),_,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,i)}function nt(S,i,u){const g=S+u.translation[0],_=i+u.translation[1];let M;return u.pitchWithMap?(M=pn(g,_,u.pitchedLabelPlaneMatrix,u.getElevation),M.isOccluded=!1):(M=u.transform.projectTileCoordinates(g,_,u.unwrappedTileID,u.getElevation),M.point.x=(.5*M.point.x+.5)*u.width,M.point.y=(.5*-M.point.y+.5)*u.height),M}function qt(S,i,u,g){if(u.pitchWithMap){const _=[S,i,0,1];return s.av(_,_,g),u.transform.projectTileCoordinates(_[0]/_[3],_[1]/_[3],u.unwrappedTileID,u.getElevation).point}return{x:S/u.width*2-1,y:1-i/u.height*2}}function cn(S,i,u){return u.transform.projectTileCoordinates(S,i,u.unwrappedTileID,u.getElevation)}function Rn(S,i,u){return S._unit()._perp()._mult(i*u)}function Ir(S,i,u,g,_,M,D,F,U){if(F.projectionCache.offsets[S])return F.projectionCache.offsets[S];const Z=u.add(i);if(S+U.direction<g||S+U.direction>=_)return F.projectionCache.offsets[S]=Z,Z;const K=It(S+U.direction,F,U),ie=Rn(K.sub(u),D,U.direction),ne=u.add(ie),le=K.add(ie);return F.projectionCache.offsets[S]=s.aw(M,Z,ne,le)||Z,F.projectionCache.offsets[S]}function _r(S,i,u,g,_,M,D,F,U){const Z=g?S-i:S+i;let K=Z>0?1:-1,ie=0;g&&(K*=-1,ie=Math.PI),K<0&&(ie+=Math.PI);let ne,le=K>0?M+_:M+_+1;F.projectionCache.cachedAnchorPoint?ne=F.projectionCache.cachedAnchorPoint:(ne=nt(F.tileAnchorPoint.x,F.tileAnchorPoint.y,F).point,F.projectionCache.cachedAnchorPoint=ne);let ge,Le,ze=ne,Ne=ne,Ge=0,Je=0;const qe=Math.abs(Z),at=[];let ct;for(;Ge+Je<=qe;){if(le+=K,le<M||le>=D)return null;Ge+=Je,Ne=ze,Le=ge;const Tt={absOffsetX:qe,direction:K,distanceFromAnchor:Ge,previousVertex:Ne};if(ze=It(le,F,Tt),u===0)at.push(Ne),ct=ze.sub(Ne);else{let Mt;const Et=ze.sub(Ne);Mt=Et.mag()===0?Rn(It(le+K,F,Tt).sub(ze),u,K):Rn(Et,u,K),Le||(Le=Ne.add(Mt)),ge=Ir(le,Mt,ze,M,D,Le,u,F,Tt),at.push(Le),ct=ge.sub(Le)}Je=ct.mag()}const Ze=ct._mult((qe-Ge)/Je)._add(Le||Ne),pt=ie+Math.atan2(ze.y-Ne.y,ze.x-Ne.x);return at.push(Ze),{point:Ze,angle:U?pt:0,path:at}}const xe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function vt(S,i){for(let u=0;u<S;u++){const g=i.length;i.resize(g+4),i.float32.set(xe,3*g)}}function kt(S,i,u){const g=i[0],_=i[1];return S[0]=u[0]*g+u[4]*_+u[12],S[1]=u[1]*g+u[5]*_+u[13],S[3]=u[3]*g+u[7]*_+u[15],S}const xt=100;class wt{constructor(i,u=new it(i.width+200,i.height+200,25),g=new it(i.width+200,i.height+200,25)){this.transform=i,this.grid=u,this.ignoredGrid=g,this.pitchFactor=Math.cos(i.pitch*Math.PI/180)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+xt,this.screenBottomBoundary=i.height+xt,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,u,g,_,M,D,F,U,Z,K,ie,ne){const le=this.projectAndGetPerspectiveRatio(i.anchorPointX+U[0],i.anchorPointY+U[1],M,K,ne),ge=g*le.perspectiveRatio;let Le;if(D||F)Le=this._projectCollisionBox(i,ge,_,M,D,F,U,le,K,ie,ne);else{const ct=le.x+(ie?ie.x*ge:0),Ze=le.y+(ie?ie.y*ge:0);Le={allPointsOccluded:!1,box:[ct+i.x1*ge,Ze+i.y1*ge,ct+i.x2*ge,Ze+i.y2*ge]}}const[ze,Ne,Ge,Je]=Le.box,qe=D?Le.allPointsOccluded:le.isOccluded;let at=qe;return at||(at=le.perspectiveRatio<this.perspectiveRatioCutoff),at||(at=!this.isInsideGrid(ze,Ne,Ge,Je)),at||u!=="always"&&this.grid.hitTest(ze,Ne,Ge,Je,u,Z)?{box:[ze,Ne,Ge,Je],placeable:!1,offscreen:!1,occluded:qe}:{box:[ze,Ne,Ge,Je],placeable:!0,offscreen:this.isOffscreen(ze,Ne,Ge,Je),occluded:qe}}placeCollisionCircles(i,u,g,_,M,D,F,U,Z,K,ie,ne,le,ge){const Le=[],ze=new s.P(u.anchorX,u.anchorY),Ne=this.getPerspectiveRatio(ze.x,ze.y,D,ge),Ge=(Z?M*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,D)/Ne:M*Ne)/s.aA,Je={getElevation:ge,pitchedLabelPlaneMatrix:F,lineVertexArray:g,pitchWithMap:Z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ze,unwrappedTileID:D,width:this.transform.width,height:this.transform.height,translation:le},qe=Ct(Ge,_,u.lineOffsetX*Ge,u.lineOffsetY*Ge,!1,u,!1,Je);let at=!1,ct=!1,Ze=!0;if(qe){const pt=.5*ie*Ne+ne,Tt=new s.P(-100,-100),Mt=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Et=new Kt,Dt=qe.first,Sn=qe.last;let wn=[];for(let br=Dt.path.length-1;br>=1;br--)wn.push(Dt.path[br]);for(let br=1;br<Sn.path.length;br++)wn.push(Sn.path[br]);const nn=2.5*pt;if(Z){const br=this.projectPathToScreenSpace(wn,Je);wn=br.some(jr=>jr.signedDistanceFromCamera<=0)?[]:br.map(jr=>jr.point)}let Vn=[];if(wn.length>0){const br=wn[0].clone(),jr=wn[0].clone();for(let Ei=1;Ei<wn.length;Ei++)br.x=Math.min(br.x,wn[Ei].x),br.y=Math.min(br.y,wn[Ei].y),jr.x=Math.max(jr.x,wn[Ei].x),jr.y=Math.max(jr.y,wn[Ei].y);Vn=br.x>=Tt.x&&jr.x<=Mt.x&&br.y>=Tt.y&&jr.y<=Mt.y?[wn]:jr.x<Tt.x||br.x>Mt.x||jr.y<Tt.y||br.y>Mt.y?[]:s.ax([wn],Tt.x,Tt.y,Mt.x,Mt.y)}for(const br of Vn){Et.reset(br,.25*pt);let jr=0;jr=Et.length<=.5*pt?1:Math.ceil(Et.paddedLength/nn)+1;for(let Ei=0;Ei<jr;Ei++){const ii=Ei/Math.max(jr-1,1),ci=Et.lerp(ii),ai=ci.x+xt,Kr=ci.y+xt;Le.push(ai,Kr,pt,0);const ti=ai-pt,go=Kr-pt,Ar=ai+pt,so=Kr+pt;if(Ze=Ze&&this.isOffscreen(ti,go,Ar,so),ct=ct||this.isInsideGrid(ti,go,Ar,so),i!=="always"&&this.grid.hitTestCircle(ai,Kr,pt,i,K)&&(at=!0,!U))return{circles:[],offscreen:!1,collisionDetected:at}}}}return{circles:!U&&at||!ct||Ne<this.perspectiveRatioCutoff?[]:Le,offscreen:Ze,collisionDetected:at}}projectPathToScreenSpace(i,u){const g=function(_,M){const D=s.L();return s.ap(D,M.pitchedLabelPlaneMatrix),_.map(F=>{const U=pn(F.x,F.y,D,M.getElevation),Z=M.transform.projectTileCoordinates(U.point.x,U.point.y,M.unwrappedTileID,M.getElevation);return Z.point.x=(.5*Z.point.x+.5)*M.width,Z.point.y=(.5*-Z.point.y+.5)*M.height,Z})}(i,u);return function(_){let M=0,D=0,F=0,U=0;for(let Z=0;Z<_.length;Z++)_[Z].isOccluded?(F=Z+1,U=0):(U++,U>D&&(D=U,M=F));return _.slice(M,M+D)}(g)}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],g=new s.a1;for(const ie of i){const ne=new s.P(ie.x+xt,ie.y+xt);g.extend(ne),u.push(ne)}const{minX:_,minY:M,maxX:D,maxY:F}=g,U=this.grid.query(_,M,D,F).concat(this.ignoredGrid.query(_,M,D,F)),Z={},K={};for(const ie of U){const ne=ie.key;if(Z[ne.bucketInstanceId]===void 0&&(Z[ne.bucketInstanceId]={}),Z[ne.bucketInstanceId][ne.featureIndex])continue;const le=[new s.P(ie.x1,ie.y1),new s.P(ie.x2,ie.y1),new s.P(ie.x2,ie.y2),new s.P(ie.x1,ie.y2)];s.ay(u,le)&&(Z[ne.bucketInstanceId][ne.featureIndex]=!0,K[ne.bucketInstanceId]===void 0&&(K[ne.bucketInstanceId]=[]),K[ne.bucketInstanceId].push(ne.featureIndex))}return K}insertCollisionBox(i,u,g,_,M,D){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:M,collisionGroupID:D,overlapMode:u},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,u,g,_,M,D){const F=g?this.ignoredGrid:this.grid,U={bucketInstanceId:_,featureIndex:M,collisionGroupID:D,overlapMode:u};for(let Z=0;Z<i.length;Z+=4)F.insertCircle(U,i[Z],i[Z+1],i[Z+2])}projectAndGetPerspectiveRatio(i,u,g,_,M){if(M){let D;_?(D=[i,u,_(i,u),1],s.av(D,D,M)):(D=[i,u,0,1],kt(D,D,M));const F=D[3];return{x:(D[0]/F+1)/2*this.transform.width+xt,y:(-D[1]/F+1)/2*this.transform.height+xt,perspectiveRatio:.5+this.transform.cameraToCenterDistance/F*.5,isOccluded:!1,signedDistanceFromCamera:F}}{const D=this.transform.projectTileCoordinates(i,u,g,_);return{x:(D.point.x+1)/2*this.transform.width+xt,y:(1-D.point.y)/2*this.transform.height+xt,perspectiveRatio:.5+this.transform.cameraToCenterDistance/D.signedDistanceFromCamera*.5,isOccluded:D.isOccluded,signedDistanceFromCamera:D.signedDistanceFromCamera}}}getPerspectiveRatio(i,u,g,_){const M=this.transform.projectTileCoordinates(i,u,g,_);return .5+this.transform.cameraToCenterDistance/M.signedDistanceFromCamera*.5}isOffscreen(i,u,g,_){return g<xt||i>=this.screenRightBoundary||_<xt||u>this.screenBottomBoundary}isInsideGrid(i,u,g,_){return g>=0&&i<this.gridRightBoundary&&_>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const i=s.af([]);return s.M(i,i,[-100,-100,0]),i}_projectCollisionBox(i,u,g,_,M,D,F,U,Z,K,ie){let ne=1,le=0,ge=0,Le=1;const ze=i.anchorPointX+F[0],Ne=i.anchorPointY+F[1];if(D&&!M){const wn=this.projectAndGetPerspectiveRatio(ze+1,Ne,_,Z,ie),nn=wn.x-U.x,Vn=Math.atan((wn.y-U.y)/nn)+(nn<0?Math.PI:0),br=Math.sin(Vn),jr=Math.cos(Vn);ne=jr,le=br,ge=-br,Le=jr}else if(!D&&M){const wn=tn(this.transform);ne=wn.vecEast[0],le=wn.vecEast[1],ge=wn.vecSouth[0],Le=wn.vecSouth[1]}let Ge=U.x,Je=U.y,qe=u;M&&(Ge=ze,Je=Ne,qe=Math.pow(2,-(this.transform.zoom-g.overscaledZ)),qe*=this.transform.getPitchedTextCorrection(ze,Ne,_),K||(qe*=s.ag(.5+U.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),K&&(Ge+=ne*K.x*qe+ge*K.y*qe,Je+=le*K.x*qe+Le*K.y*qe);const at=i.x1*qe,ct=i.x2*qe,Ze=(at+ct)/2,pt=i.y1*qe,Tt=i.y2*qe,Mt=(pt+Tt)/2,Et=[{offsetX:at,offsetY:pt},{offsetX:Ze,offsetY:pt},{offsetX:ct,offsetY:pt},{offsetX:ct,offsetY:Mt},{offsetX:ct,offsetY:Tt},{offsetX:Ze,offsetY:Tt},{offsetX:at,offsetY:Tt},{offsetX:at,offsetY:Mt}];let Dt=[];for(const{offsetX:wn,offsetY:nn}of Et)Dt.push(new s.P(Ge+ne*wn+ge*nn,Je+le*wn+Le*nn));let Sn=!1;if(M){const wn=Dt.map(nn=>this.projectAndGetPerspectiveRatio(nn.x,nn.y,_,Z,ie));Sn=wn.some(nn=>!nn.isOccluded),Dt=wn.map(nn=>new s.P(nn.x,nn.y))}else Sn=!0;return{box:s.az(Dt),allPointsOccluded:!Sn}}}class hn{constructor(i,u,g,_){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?u:-u))):_&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Pn{constructor(i,u,g,_,M){this.text=new hn(i?i.text:null,u,g,M),this.icon=new hn(i?i.icon:null,u,_,M)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class mn{constructor(i,u,g){this.text=i,this.icon=u,this.skipFade=g}}class Tn{constructor(i,u,g,_,M){this.bucketInstanceId=i,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=_,this.tileID=M}}class Qt{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const u=++this.maxGroupID;this.collisionGroups[i]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[i]}}function Zn(S,i,u,g,_){const{horizontalAlign:M,verticalAlign:D}=s.aG(S);return new s.P(-(M-.5)*i+g[0]*_,-(D-.5)*u+g[1]*_)}class An{constructor(i,u,g,_,M){this.transform=i.clone(),this.terrain=u,this.collisionIndex=new wt(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Qt(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=M,M&&(M.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){const u=this.terrain;return u?(g,_)=>u.getElevation(i,g,_):null}getBucketParts(i,u,g,_){const M=g.getBucket(u),D=g.latestFeatureIndex;if(!M||!D||u.id!==M.layerIds[0])return;const F=g.collisionBoxArray,U=M.layers[0].layout,Z=M.layers[0].paint,K=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),ie=g.tileSize/s.$,ne=g.tileID.toUnwrapped(),le=U.get("text-rotation-alignment")==="map",ge=s.aB(g,1,this.transform.zoom),Le=s.aC(this.collisionIndex.transform,g,Z.get("text-translate"),Z.get("text-translate-anchor")),ze=s.aC(this.collisionIndex.transform,g,Z.get("icon-translate"),Z.get("icon-translate-anchor")),Ne=mt(le,this.transform,ge);this.retainedQueryData[M.bucketInstanceId]=new Tn(M.bucketInstanceId,D,M.sourceLayerIndex,M.index,g.tileID);const Ge={bucket:M,layout:U,translationText:Le,translationIcon:ze,unwrappedTileID:ne,pitchedLabelPlaneMatrix:Ne,scale:K,textPixelRatio:ie,holdingForFade:g.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:s.am(M.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(M.sourceID)};if(_)for(const Je of M.sortKeyRanges){const{sortKey:qe,symbolInstanceStart:at,symbolInstanceEnd:ct}=Je;i.push({sortKey:qe,symbolInstanceStart:at,symbolInstanceEnd:ct,parameters:Ge})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:Ge})}attemptAnchorPlacement(i,u,g,_,M,D,F,U,Z,K,ie,ne,le,ge,Le,ze,Ne,Ge,Je,qe){const at=s.aD[i.textAnchor],ct=[i.textOffset0,i.textOffset1],Ze=Zn(at,g,_,ct,M),pt=this.collisionIndex.placeCollisionBox(u,ne,U,Z,K,F,D,ze,ie.predicate,Je,Ze,qe);if((!Ge||this.collisionIndex.placeCollisionBox(Ge,ne,U,Z,K,F,D,Ne,ie.predicate,Je,Ze,qe).placeable)&&pt.placeable){let Tt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[le.crossTileID]&&this.prevPlacement.placements[le.crossTileID]&&this.prevPlacement.placements[le.crossTileID].text&&(Tt=this.prevPlacement.variableOffsets[le.crossTileID].anchor),le.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[le.crossTileID]={textOffset:ct,width:g,height:_,anchor:at,textBoxScale:M,prevAnchor:Tt},this.markUsedJustification(ge,at,le,Le),ge.allowVerticalPlacement&&(this.markUsedOrientation(ge,Le,le),this.placedOrientations[le.crossTileID]=Le),{shift:Ze,placedGlyphBoxes:pt}}}placeLayerBucketPart(i,u,g){const{bucket:_,layout:M,translationText:D,translationIcon:F,unwrappedTileID:U,pitchedLabelPlaneMatrix:Z,textPixelRatio:K,holdingForFade:ie,collisionBoxArray:ne,partiallyEvaluatedTextSize:le,collisionGroup:ge}=i.parameters,Le=M.get("text-optional"),ze=M.get("icon-optional"),Ne=s.aE(M,"text-overlap","text-allow-overlap"),Ge=Ne==="always",Je=s.aE(M,"icon-overlap","icon-allow-overlap"),qe=Je==="always",at=M.get("text-rotation-alignment")==="map",ct=M.get("text-pitch-alignment")==="map",Ze=M.get("icon-text-fit")!=="none",pt=M.get("symbol-z-order")==="viewport-y",Tt=Ge&&(qe||!_.hasIconData()||ze),Mt=qe&&(Ge||!_.hasTextData()||Le);!_.collisionArrays&&ne&&_.deserializeCollisionBoxes(ne);const Et=this.retainedQueryData[_.bucketInstanceId].tileID,Dt=this._getTerrainElevationFunc(Et),Sn=this.transform.getFastPathSimpleProjectionMatrix(Et),wn=(nn,Vn,br)=>{var jr,Ei;if(u[nn.crossTileID])return;if(ie)return void(this.placements[nn.crossTileID]=new mn(!1,!1,!1));let ii=!1,ci=!1,ai=!0,Kr=null,ti={box:null,placeable:!1,offscreen:null,occluded:!1},go={placeable:!1},Ar=null,so=null,vo=null,vl=0,yl=0,$a=0;Vn.textFeatureIndex?vl=Vn.textFeatureIndex:nn.useRuntimeCollisionCircles&&(vl=nn.featureIndex),Vn.verticalTextFeatureIndex&&(yl=Vn.verticalTextFeatureIndex);const va=Vn.textBox;if(va){const as=ki=>{let hi=s.an.horizontal;if(_.allowVerticalPlacement&&!ki&&this.prevPlacement){const yo=this.prevPlacement.placedOrientations[nn.crossTileID];yo&&(this.placedOrientations[nn.crossTileID]=yo,hi=yo,this.markUsedOrientation(_,hi,nn))}return hi},ya=(ki,hi)=>{if(_.allowVerticalPlacement&&nn.numVerticalGlyphVertices>0&&Vn.verticalTextBox){for(const yo of _.writingModes)if(yo===s.an.vertical?(ti=hi(),go=ti):ti=ki(),ti&&ti.placeable)break}else ti=ki()},mc=nn.textAnchorOffsetStartIndex,gc=nn.textAnchorOffsetEndIndex;if(gc===mc){const ki=(hi,yo)=>{const ao=this.collisionIndex.placeCollisionBox(hi,Ne,K,Et,U,ct,at,D,ge.predicate,Dt,void 0,Sn);return ao&&ao.placeable&&(this.markUsedOrientation(_,yo,nn),this.placedOrientations[nn.crossTileID]=yo),ao};ya(()=>ki(va,s.an.horizontal),()=>{const hi=Vn.verticalTextBox;return _.allowVerticalPlacement&&nn.numVerticalGlyphVertices>0&&hi?ki(hi,s.an.vertical):{box:null,offscreen:null}}),as(ti&&ti.placeable)}else{let ki=s.aD[(Ei=(jr=this.prevPlacement)===null||jr===void 0?void 0:jr.variableOffsets[nn.crossTileID])===null||Ei===void 0?void 0:Ei.anchor];const hi=(ao,vg,Sy)=>{const Fs=ao.x2-ao.x1,nu=ao.y2-ao.y1,_l=nn.textBoxScale,Va=Ze&&Je==="never"?vg:null;let _o=null,ja=Ne==="never"?1:2,hd="never";ki&&ja++;for(let Ns=0;Ns<ja;Ns++){for(let dd=mc;dd<gc;dd++){const fd=_.textAnchorOffsets.get(dd);if(ki&&fd.textAnchor!==ki)continue;const pd=this.attemptAnchorPlacement(fd,ao,Fs,nu,_l,at,ct,K,Et,U,ge,hd,nn,_,Sy,D,F,Va,Dt);if(pd&&(_o=pd.placedGlyphBoxes,_o&&_o.placeable))return ii=!0,Kr=pd.shift,_o}ki?ki=null:hd=Ne}return g&&!_o&&(_o={box:this.collisionIndex.placeCollisionBox(va,"always",K,Et,U,ct,at,D,ge.predicate,Dt,void 0,Sn).box,offscreen:!1,placeable:!1,occluded:!1}),_o};ya(()=>hi(va,Vn.iconBox,s.an.horizontal),()=>{const ao=Vn.verticalTextBox;return _.allowVerticalPlacement&&(!ti||!ti.placeable)&&nn.numVerticalGlyphVertices>0&&ao?hi(ao,Vn.verticalIconBox,s.an.vertical):{box:null,occluded:!0,offscreen:null}}),ti&&(ii=ti.placeable,ai=ti.offscreen);const yo=as(ti&&ti.placeable);if(!ii&&this.prevPlacement){const ao=this.prevPlacement.variableOffsets[nn.crossTileID];ao&&(this.variableOffsets[nn.crossTileID]=ao,this.markUsedJustification(_,ao.anchor,nn,yo))}}}if(Ar=ti,ii=Ar&&Ar.placeable,ai=Ar&&Ar.offscreen,nn.useRuntimeCollisionCircles){const as=_.text.placedSymbolArray.get(nn.centerJustifiedTextSymbolIndex),ya=s.ao(_.textSizeData,le,as),mc=M.get("text-padding");so=this.collisionIndex.placeCollisionCircles(Ne,as,_.lineVertexArray,_.glyphOffsetArray,ya,U,Z,g,ct,ge.predicate,nn.collisionCircleDiameter,mc,D,Dt),so.circles.length&&so.collisionDetected&&!g&&s.w("Collisions detected, but collision boxes are not shown"),ii=Ge||so.circles.length>0&&!so.collisionDetected,ai=ai&&so.offscreen}if(Vn.iconFeatureIndex&&($a=Vn.iconFeatureIndex),Vn.iconBox){const as=ya=>this.collisionIndex.placeCollisionBox(ya,Je,K,Et,U,ct,at,F,ge.predicate,Dt,Ze&&Kr?Kr:void 0,Sn);go&&go.placeable&&Vn.verticalIconBox?(vo=as(Vn.verticalIconBox),ci=vo.placeable):(vo=as(Vn.iconBox),ci=vo.placeable),ai=ai&&vo.offscreen}const Yu=Le||nn.numHorizontalGlyphVertices===0&&nn.numVerticalGlyphVertices===0,Ku=ze||nn.numIconVertices===0;Yu||Ku?Ku?Yu||(ci=ci&&ii):ii=ci&&ii:ci=ii=ci&&ii;const Ju=ci&&vo.placeable;if(ii&&Ar.placeable&&this.collisionIndex.insertCollisionBox(Ar.box,Ne,M.get("text-ignore-placement"),_.bucketInstanceId,go&&go.placeable&&yl?yl:vl,ge.ID),Ju&&this.collisionIndex.insertCollisionBox(vo.box,Je,M.get("icon-ignore-placement"),_.bucketInstanceId,$a,ge.ID),so&&ii&&this.collisionIndex.insertCollisionCircles(so.circles,Ne,M.get("text-ignore-placement"),_.bucketInstanceId,vl,ge.ID),g&&this.storeCollisionData(_.bucketInstanceId,br,Vn,Ar,vo,so),nn.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[nn.crossTileID]=new mn((ii||Tt)&&!Ar?.occluded,(ci||Mt)&&!vo?.occluded,ai||_.justReloaded),u[nn.crossTileID]=!0};if(pt){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const nn=_.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Vn=nn.length-1;Vn>=0;--Vn){const br=nn[Vn];wn(_.symbolInstances.get(br),_.collisionArrays[br],br)}}else for(let nn=i.symbolInstanceStart;nn<i.symbolInstanceEnd;nn++)wn(_.symbolInstances.get(nn),_.collisionArrays[nn],nn);_.justReloaded=!1}storeCollisionData(i,u,g,_,M,D){if(g.textBox||g.iconBox){let F,U;this.collisionBoxArrays.has(i)?F=this.collisionBoxArrays.get(i):(F=new Map,this.collisionBoxArrays.set(i,F)),F.has(u)?U=F.get(u):(U={text:null,icon:null},F.set(u,U)),g.textBox&&(U.text=_.box),g.iconBox&&(U.icon=M.box)}if(D){let F=this.collisionCircleArrays[i];F===void 0&&(F=this.collisionCircleArrays[i]=[]);for(let U=0;U<D.circles.length;U+=4)F.push(D.circles[U+0]-xt),F.push(D.circles[U+1]-xt),F.push(D.circles[U+2]),F.push(D.collisionDetected?1:0)}}markUsedJustification(i,u,g,_){let M;M=_===s.an.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[s.aF(u)];const D=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const F of D)F>=0&&(i.text.placedSymbolArray.get(F).crossTileID=M>=0&&F!==M?0:g.crossTileID)}markUsedOrientation(i,u,g){const _=u===s.an.horizontal||u===s.an.horizontalOnly?u:0,M=u===s.an.vertical?u:0,D=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const F of D)i.text.placedSymbolArray.get(F).placedOrientation=_;g.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=M)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const _=u?u.symbolFadeChange(i):1,M=u?u.opacities:{},D=u?u.variableOffsets:{},F=u?u.placedOrientations:{};for(const U in this.placements){const Z=this.placements[U],K=M[U];K?(this.opacities[U]=new Pn(K,_,Z.text,Z.icon),g=g||Z.text!==K.text.placed||Z.icon!==K.icon.placed):(this.opacities[U]=new Pn(null,_,Z.text,Z.icon,Z.skipFade),g=g||Z.text||Z.icon)}for(const U in M){const Z=M[U];if(!this.opacities[U]){const K=new Pn(Z,_,!1,!1);K.isHidden()||(this.opacities[U]=K,g=g||Z.text.placed||Z.icon.placed)}}for(const U in D)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=D[U]);for(const U in F)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=F[U]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:i)}updateLayerOpacities(i,u){const g={};for(const _ of u){const M=_.getBucket(i);M&&_.latestFeatureIndex&&i.id===M.layerIds[0]&&this.updateBucketOpacities(M,_.tileID,g,_.collisionBoxArray)}}updateBucketOpacities(i,u,g,_){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const M=i.layers[0],D=M.layout,F=new Pn(null,0,!1,!1,!0),U=D.get("text-allow-overlap"),Z=D.get("icon-allow-overlap"),K=M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ie=D.get("text-rotation-alignment")==="map",ne=D.get("text-pitch-alignment")==="map",le=D.get("icon-text-fit")!=="none",ge=new Pn(null,0,U&&(Z||!i.hasIconData()||D.get("icon-optional")),Z&&(U||!i.hasTextData()||D.get("text-optional")),!0);!i.collisionArrays&&_&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(_);const Le=(Ne,Ge,Je)=>{for(let qe=0;qe<Ge/4;qe++)Ne.opacityVertexArray.emplaceBack(Je);Ne.hasVisibleVertices=Ne.hasVisibleVertices||Je!==Ys},ze=this.collisionBoxArrays.get(i.bucketInstanceId);for(let Ne=0;Ne<i.symbolInstances.length;Ne++){const Ge=i.symbolInstances.get(Ne),{numHorizontalGlyphVertices:Je,numVerticalGlyphVertices:qe,crossTileID:at}=Ge;let ct=this.opacities[at];g[at]?ct=F:ct||(ct=ge,this.opacities[at]=ct),g[at]=!0;const Ze=Ge.numIconVertices>0,pt=this.placedOrientations[Ge.crossTileID],Tt=pt===s.an.vertical,Mt=pt===s.an.horizontal||pt===s.an.horizontalOnly;if(Je>0||qe>0){const Dt=Eo(ct.text);Le(i.text,Je,Tt?Ys:Dt),Le(i.text,qe,Mt?Ys:Dt);const Sn=ct.text.isHidden();[Ge.rightJustifiedTextSymbolIndex,Ge.centerJustifiedTextSymbolIndex,Ge.leftJustifiedTextSymbolIndex].forEach(Vn=>{Vn>=0&&(i.text.placedSymbolArray.get(Vn).hidden=Sn||Tt?1:0)}),Ge.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(Ge.verticalPlacedTextSymbolIndex).hidden=Sn||Mt?1:0);const wn=this.variableOffsets[Ge.crossTileID];wn&&this.markUsedJustification(i,wn.anchor,Ge,pt);const nn=this.placedOrientations[Ge.crossTileID];nn&&(this.markUsedJustification(i,"left",Ge,nn),this.markUsedOrientation(i,nn,Ge))}if(Ze){const Dt=Eo(ct.icon),Sn=!(le&&Ge.verticalPlacedIconSymbolIndex&&Tt);Ge.placedIconSymbolIndex>=0&&(Le(i.icon,Ge.numIconVertices,Sn?Dt:Ys),i.icon.placedSymbolArray.get(Ge.placedIconSymbolIndex).hidden=ct.icon.isHidden()),Ge.verticalPlacedIconSymbolIndex>=0&&(Le(i.icon,Ge.numVerticalIconVertices,Sn?Ys:Dt),i.icon.placedSymbolArray.get(Ge.verticalPlacedIconSymbolIndex).hidden=ct.icon.isHidden())}const Et=ze&&ze.has(Ne)?ze.get(Ne):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Dt=i.collisionArrays[Ne];if(Dt){let Sn=new s.P(0,0);if(Dt.textBox||Dt.verticalTextBox){let wn=!0;if(K){const nn=this.variableOffsets[at];nn?(Sn=Zn(nn.anchor,nn.width,nn.height,nn.textOffset,nn.textBoxScale),ie&&Sn._rotate(ne?-this.transform.bearingInRadians:this.transform.bearingInRadians)):wn=!1}if(Dt.textBox||Dt.verticalTextBox){let nn;Dt.textBox&&(nn=Tt),Dt.verticalTextBox&&(nn=Mt),Wn(i.textCollisionBox.collisionVertexArray,ct.text.placed,!wn||nn,Et.text,Sn.x,Sn.y)}}if(Dt.iconBox||Dt.verticalIconBox){const wn=!!(!Mt&&Dt.verticalIconBox);let nn;Dt.iconBox&&(nn=wn),Dt.verticalIconBox&&(nn=!wn),Wn(i.iconCollisionBox.collisionVertexArray,ct.icon.placed,nn,Et.icon,le?Sn.x:0,le?Sn.y:0)}}}}if(i.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);i.bucketInstanceId in this.collisionCircleArrays&&(i.collisionCircleArray=this.collisionCircleArrays[i.bucketInstanceId],delete this.collisionCircleArrays[i.bucketInstanceId])}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>i}setStale(){this.stale=!0}}function Wn(S,i,u,g,_,M){g&&g.length!==0||(g=[0,0,0,0]);const D=g[0]-xt,F=g[1]-xt,U=g[2]-xt,Z=g[3]-xt;S.emplaceBack(i?1:0,u?1:0,_||0,M||0,D,F),S.emplaceBack(i?1:0,u?1:0,_||0,M||0,U,F),S.emplaceBack(i?1:0,u?1:0,_||0,M||0,U,Z),S.emplaceBack(i?1:0,u?1:0,_||0,M||0,D,Z)}const tr=Math.pow(2,25),Or=Math.pow(2,24),Fr=Math.pow(2,17),wr=Math.pow(2,16),ur=Math.pow(2,9),ui=Math.pow(2,8),Lr=Math.pow(2,1);function Eo(S){if(S.opacity===0&&!S.placed)return 0;if(S.opacity===1&&S.placed)return 4294967295;const i=S.placed?1:0,u=Math.floor(127*S.opacity);return u*tr+i*Or+u*Fr+i*wr+u*ur+i*ui+u*Lr+i}const Ys=0;class Jo{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,u,g,_,M){const D=this._bucketParts;for(;this._currentTileIndex<i.length;)if(u.getBucketParts(D,_,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,M())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((F,U)=>F.sortKey-U.sortKey));this._currentPartIndex<D.length;)if(u.placeLayerBucketPart(D[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,M())return!0;return!1}}class Ia{constructor(i,u,g,_,M,D,F,U){this.placement=new An(i,u,D,F,U),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=M,this._done=!1}isDone(){return this._done}continuePlacement(i,u,g){const _=E.now(),M=()=>!this._forceFullPlacement&&E.now()-_>2;for(;this._currentPlacementIndex>=0;){const D=u[i[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&(!D.minzoom||D.minzoom<=F)&&(!D.maxzoom||D.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new Jo(D)),this._inProgressLayer.continuePlacement(g[D.source],this.placement,this._showCollisionBoxes,D,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const Zr=512/s.$/2;class uo{constructor(i,u,g){this.tileID=i,this.bucketInstanceId=g,this._symbolsByKey={};const _=new Map;for(let M=0;M<u.length;M++){const D=u.get(M),F=D.key,U=_.get(F);U?U.push(D):_.set(F,[D])}for(const[M,D]of _){const F={positions:D.map(U=>({x:Math.floor(U.anchorX*Zr),y:Math.floor(U.anchorY*Zr)})),crossTileIDs:D.map(U=>U.crossTileID)};if(F.positions.length>128){const U=new s.aH(F.positions.length,16,Uint16Array);for(const{x:Z,y:K}of F.positions)U.add(Z,K);U.finish(),delete F.positions,F.index=U}this._symbolsByKey[M]=F}}getScaledCoordinates(i,u){const{x:g,y:_,z:M}=this.tileID.canonical,{x:D,y:F,z:U}=u.canonical,Z=Zr/Math.pow(2,U-M),K=(F*s.$+i.anchorY)*Z,ie=_*s.$*Zr;return{x:Math.floor((D*s.$+i.anchorX)*Z-g*s.$*Zr),y:Math.floor(K-ie)}}findMatches(i,u,g){const _=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let M=0;M<i.length;M++){const D=i.get(M);if(D.crossTileID)continue;const F=this._symbolsByKey[D.key];if(!F)continue;const U=this.getScaledCoordinates(D,u);if(F.index){const Z=F.index.range(U.x-_,U.y-_,U.x+_,U.y+_).sort();for(const K of Z){const ie=F.crossTileIDs[K];if(!g[ie]){g[ie]=!0,D.crossTileID=ie;break}}}else if(F.positions)for(let Z=0;Z<F.positions.length;Z++){const K=F.positions[Z],ie=F.crossTileIDs[Z];if(Math.abs(K.x-U.x)<=_&&Math.abs(K.y-U.y)<=_&&!g[ie]){g[ie]=!0,D.crossTileID=ie;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:i})=>i)}}class Xi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ho{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const u=Math.round((i-this.lng)/360);if(u!==0)for(const g in this.indexes){const _=this.indexes[g],M={};for(const D in _){const F=_[D];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+u),M[F.tileID.key]=F}this.indexes[g]=M}this.lng=i}addBucket(i,u,g){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let M=0;M<u.symbolInstances.length;M++)u.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const _=this.usedCrossTileIDs[i.overscaledZ];for(const M in this.indexes){const D=this.indexes[M];if(Number(M)>i.overscaledZ)for(const F in D){const U=D[F];U.tileID.isChildOf(i)&&U.findMatches(u.symbolInstances,i,_)}else{const F=D[i.scaledTo(Number(M)).key];F&&F.findMatches(u.symbolInstances,i,_)}}for(let M=0;M<u.symbolInstances.length;M++){const D=u.symbolInstances.get(M);D.crossTileID||(D.crossTileID=g.generate(),_[D.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new uo(i,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(i,u){for(const g of u.getCrossTileIDsLists())for(const _ of g)delete this.usedCrossTileIDs[i][_]}removeStaleBuckets(i){let u=!1;for(const g in this.indexes){const _=this.indexes[g];for(const M in _)i[_[M].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,_[M]),delete _[M],u=!0)}return u}}class Vi{constructor(){this.layerIndexes={},this.crossTileIDs=new Xi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,u,g){let _=this.layerIndexes[i.id];_===void 0&&(_=this.layerIndexes[i.id]=new ho);let M=!1;const D={};_.handleWrapJump(g);for(const F of u){const U=F.getBucket(i);U&&i.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(F.tileID,U,this.crossTileIDs)&&(M=!0),D[U.bucketInstanceId]=!0)}return _.removeStaleBuckets(D)&&(M=!0),M}pruneUnusedLayers(i){const u={};i.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}var Nr="void main() {fragColor=vec4(1.0);}";const io={prelude:Er(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Er("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Er("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Er(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Er(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Er(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Er(Nr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Er(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Er("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Er("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Er("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Er(Nr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Er(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Er(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Er(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Er(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Er(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Er(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Er("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Er("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Er("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Er("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Er(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Er("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Er(S,i){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=i.match(/in ([\w]+) ([\w]+)/g),_=S.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),D=M?M.concat(_):_,F={};return{fragmentSource:S=S.replace(u,(U,Z,K,ie,ne)=>(F[ne]=!0,Z==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
in ${K} ${ie} ${ne};
#else
uniform ${K} ${ie} u_${ne};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ne}
    ${K} ${ie} ${ne} = u_${ne};
#endif
`)),vertexSource:i=i.replace(u,(U,Z,K,ie,ne)=>{const le=ie==="float"?"vec2":"vec4",ge=ne.match(/color/)?"color":le;return F[ne]?Z==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
in ${K} ${le} a_${ne};
out ${K} ${ie} ${ne};
#else
uniform ${K} ${ie} u_${ne};
#endif
`:ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = a_${ne};
#else
    ${K} ${ie} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = unpack_mix_${ge}(a_${ne}, u_${ne}_t);
#else
    ${K} ${ie} ${ne} = u_${ne};
#endif
`:Z==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
in ${K} ${le} a_${ne};
#else
uniform ${K} ${ie} u_${ne};
#endif
`:ge==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${K} ${ie} ${ne} = a_${ne};
#else
    ${K} ${ie} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${K} ${ie} ${ne} = unpack_mix_${ge}(a_${ne}, u_${ne}_t);
#else
    ${K} ${ie} ${ne} = u_${ne};
#endif
`}),staticAttributes:g,staticUniforms:D}}class ua{constructor(i,u,g){this.vertexBuffer=i,this.indexBuffer=u,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ra=s.aI([{name:"a_pos",type:"Int16",components:2}]);const Xl="#define PROJECTION_MERCATOR",tf="mercator";class zh{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return tf}get shaderDefine(){return Xl}get shaderPreludeCode(){return io.projectionMercator}get vertexShaderPreludeCode(){return io.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(i){}getMeshFromTileID(i,u,g,_,M){if(this._cachedMesh)return this._cachedMesh;const D=new s.aK;D.emplaceBack(0,0),D.emplaceBack(s.$,0),D.emplaceBack(0,s.$),D.emplaceBack(s.$,s.$);const F=i.createVertexBuffer(D,Ra.members),U=s.aL.simpleSegment(0,0,4,2),Z=new s.aM;Z.emplaceBack(1,0,2),Z.emplaceBack(1,2,3);const K=i.createIndexBuffer(Z);return this._cachedMesh=new ua(F,K,U),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(i){}}class Qo{constructor(i=0,u=0,g=0,_=0){if(isNaN(i)||i<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=u,this.left=g,this.right=_}interpolate(i,u,g){return u.top!=null&&i.top!=null&&(this.top=s.C.number(i.top,u.top,g)),u.bottom!=null&&i.bottom!=null&&(this.bottom=s.C.number(i.bottom,u.bottom,g)),u.left!=null&&i.left!=null&&(this.left=s.C.number(i.left,u.left,g)),u.right!=null&&i.right!=null&&(this.right=s.C.number(i.right,u.right,g)),this}getCenter(i,u){const g=s.ag((this.left+i-this.right)/2,0,i),_=s.ag((this.top+u-this.bottom)/2,0,u);return new s.P(g,_)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Qo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function No(S,i){if(!S.renderWorldCopies||S.lngRange)return;const u=i.lng-S.center.lng;i.lng+=u>180?-360:u<-180?360:0}function vr(S){return Math.max(0,Math.floor(S))}class Ks{constructor(i,u,g,_,M,D){this._callbacks=i,this._tileSize=512,this._renderWorldCopies=D===void 0||!!D,this._minZoom=u||0,this._maxZoom=g||22,this._minPitch=_??0,this._maxPitch=M??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=vr(this._zoom),this._scale=s.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Qo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(i,u,g){this._latRange=i.latRange,this._lngRange=i.lngRange,this._width=i.width,this._height=i.height,this._center=i.center,this._elevation=i.elevation,this._minElevationForCurrentTile=i.minElevationForCurrentTile,this._zoom=i.zoom,this._tileZoom=vr(this._zoom),this._scale=s.ae(this._zoom),this._bearingInRadians=i.bearingInRadians,this._fovInRadians=i.fovInRadians,this._pitchInRadians=i.pitchInRadians,this._rollInRadians=i.rollInRadians,this._unmodified=i.unmodified,this._edgeInsets=new Qo(i.padding.top,i.padding.bottom,i.padding.left,i.padding.right),this._minZoom=i.minZoom,this._maxZoom=i.maxZoom,this._minPitch=i.minPitch,this._maxPitch=i.maxPitch,this._renderWorldCopies=i.renderWorldCopies,this._cameraToCenterDistance=i.cameraToCenterDistance,this._nearZ=i.nearZ,this._farZ=i.farZ,this._autoCalculateNearFarZ=!g&&i.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(i){this._minElevationForCurrentTile=i}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(i){this._minZoom!==i&&(this._minZoom=i,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(i){this._minPitch!==i&&(this._minPitch=i,this.setPitch(Math.max(this.pitch,i)))}get maxPitch(){return this._maxPitch}setMaxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.setPitch(Math.min(this.pitch,i)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(i){const u=s.aN(i,-180,180)*Math.PI/180;var g,_,M,D,F,U,Z,K,ie;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=y(),g=this._rotationMatrix,M=-this._bearingInRadians,D=(_=this._rotationMatrix)[0],F=_[1],U=_[2],Z=_[3],K=Math.sin(M),ie=Math.cos(M),g[0]=D*ie+U*K,g[1]=F*ie+Z*K,g[2]=D*-K+U*ie,g[3]=F*-K+Z*ie)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(i){const u=s.ag(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(i){const u=i/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aO(this._fovInRadians)}setFov(i){i=s.ag(i,.1,150),this.fov!==i&&(this._unmodified=!1,this._fovInRadians=s.ad(i),this._calcMatrices())}get zoom(){return this._zoom}setZoom(i){const u=this.getConstrained(this._center,i).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=s.ae(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(i,u){this._autoCalculateNearFarZ=!1,this._nearZ=i,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,u,g){this._unmodified=!1,this._edgeInsets.interpolate(i,u,g),this._constrain(),this._calcMatrices()}resize(i,u,g=!0){this._width=i,this._height=u,g&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new un([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(i){i?(this._lngRange=[i.getWest(),i.getEast()],this._latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-s.ah,s.ah])}getConstrained(i,u){return this._callbacks.getConstrained(i,u)}getCameraQueryGeometry(i,u){if(u.length===1)return[u[0],i];{const{minX:g,minY:_,maxX:M,maxY:D}=s.a1.fromPoints(u).extend(i);return[new s.P(g,_),new s.P(M,_),new s.P(M,D),new s.P(g,D),new s.P(g,_)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:u,zoom:g}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(g),this._unmodified=i,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let i=s.af(new Float64Array(16));s.N(i,i,[this._width/2,-this._height/2,1]),s.M(i,i,[1,-1,0]),this._clipSpaceToPixelsMatrix=i,i=s.af(new Float64Array(16)),s.N(i,i,[1,-1,1]),s.M(i,i,[-1,-1,0]),s.N(i,i,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=i,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(i,u,g,_){const M=g!==void 0?g:this.bearing,D=_=_!==void 0?_:this.pitch,F=s.a0.fromLngLat(i,u),U=-Math.cos(s.ad(D)),Z=Math.sin(s.ad(D)),K=Z*Math.sin(s.ad(M)),ie=-Z*Math.cos(s.ad(M));let ne=this.elevation;const le=u-ne;let ge;U*le>=0||Math.abs(U)<.1?(ge=1e4,ne=u+ge*U):ge=-le/U;let Le,ze,Ne=s.aP(1,F.y),Ge=0;do{if(Ge+=1,Ge>10)break;ze=ge/Ne,Le=new s.a0(F.x+K*ze,F.y+ie*ze),Ne=1/Le.meterInMercatorCoordinateUnits()}while(Math.abs(ge-ze*Ne)>1e-12);return{center:Le.toLngLat(),elevation:ne,zoom:s.aj(this.height/2/Math.tan(this.fovInRadians/2)/ze/this.tileSize)}}recalculateZoomAndCenter(i){if(this.elevation-i==0)return;const u=s.ai(1,this.center.lat)*this.worldSize,g=this.cameraToCenterDistance/u,_=s.a0.fromLngLat(this.center,this.elevation),M=fe(this.center,this.elevation,this.pitch,this.bearing,g);this._elevation=i;const D=this.calculateCenterFromCameraLngLatAlt(M.toLngLat(),s.aP(M.z,_.y),this.bearing,this.pitch);this._elevation=D.elevation,this._center=D.center,this.setZoom(D.zoom)}getCameraPoint(){const i=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(i*Math.sin(this.rollInRadians),i*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const i=s.ai(1,this.center.lat)*this.worldSize;return fe(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/i).toLngLat()}getMercatorTileCoordinates(i){if(!i)return[0,0,1,1];const u=i.canonical.z>=0?1<<i.canonical.z:Math.pow(2,i.canonical.z);return[i.canonical.x/u,i.canonical.y/u,1/u/s.$,1/u/s.$]}}class Zl{constructor(i,u){this.min=i,this.max=u,this.center=s.aQ([],s.aR([],this.min,this.max),.5)}quadrant(i){const u=[i%2==0,i<2],g=s.aS(this.min),_=s.aS(this.max);for(let M=0;M<u.length;M++)g[M]=u[M]?this.min[M]:this.center[M],_[M]=u[M]?this.center[M]:this.max[M];return _[2]=this.max[2],new Zl(g,_)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersectsFrustum(i){let u=!0;for(let g=0;g<i.planes.length;g++){const _=this.intersectsPlane(i.planes[g]);if(_===0)return 0;_===1&&(u=!1)}return u?2:i.aabb.min[0]>this.max[0]||i.aabb.min[1]>this.max[1]||i.aabb.min[2]>this.max[2]||i.aabb.max[0]<this.min[0]||i.aabb.max[1]<this.min[1]||i.aabb.max[2]<this.min[2]?0:1}intersectsPlane(i){let u=i[3],g=i[3];for(let _=0;_<3;_++)i[_]>0?(u+=i[_]*this.min[_],g+=i[_]*this.max[_]):(g+=i[_]*this.min[_],u+=i[_]*this.max[_]);return u>=0?2:g<0?0:1}}class Oc{distanceToTile2d(i,u,g,_){const M=_.distanceX([i,u]),D=_.distanceY([i,u]);return Math.hypot(M,D)}getWrap(i,u,g){return g}getTileBoundingVolume(i,u,g,_){var M,D;let F=g,U=g;if(_?.terrain){const K=new s.Z(i.z,u,i.z,i.x,i.y),ie=_.terrain.getMinMaxElevation(K);F=(M=ie.minElevation)!==null&&M!==void 0?M:g,U=(D=ie.maxElevation)!==null&&D!==void 0?D:g}const Z=1<<i.z;return new Zl([u+i.x/Z,i.y/Z,F],[u+(i.x+1)/Z,(i.y+1)/Z,U])}allowVariableZoom(i,u){const g=i.fov*(Math.abs(Math.cos(i.rollInRadians))*i.height+Math.abs(Math.sin(i.rollInRadians))*i.width)/i.height,_=s.ag(78.5-g/2,0,60);return!!u.terrain||i.pitch>_}allowWorldCopies(){return!0}prepareNextFrame(){}}class Di{constructor(i,u,g){this.points=i,this.planes=u,this.aabb=g}static fromInvProjectionMatrix(i,u=1,g=0,_,M){const D=M?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],F=Math.pow(2,g),U=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(ne=>function(le,ge,Le,ze){const Ne=s.av([],le,ge),Ge=1/Ne[3]/Le*ze;return s.aX(Ne,Ne,[Ge,Ge,1/Ne[3],Ge])}(ne,i,u,F));_&&function(ne,le,ge,Le){const ze=Le?4:0,Ne=Le?0:4;let Ge=0;const Je=[],qe=[];for(let Ze=0;Ze<4;Ze++){const pt=s.aT([],ne[Ze+Ne],ne[Ze+ze]),Tt=s.aY(pt);s.aQ(pt,pt,1/Tt),Je.push(Tt),qe.push(pt)}for(let Ze=0;Ze<4;Ze++){const pt=s.aZ(ne[Ze+ze],qe[Ze],ge);Ge=pt!==null&&pt>=0?Math.max(Ge,pt):Math.max(Ge,Je[Ze])}const at=function(Ze,pt){const Tt=s.aT([],Ze[pt[0]],Ze[pt[1]]),Mt=s.aT([],Ze[pt[2]],Ze[pt[1]]),Et=[0,0,0,0];return s.aU(Et,s.aV([],Tt,Mt)),Et[3]=-s.aW(Et,Ze[pt[0]]),Et}(ne,le),ct=function(Ze,pt){const Tt=s.a_(Ze),Mt=s.a$([],Ze,1/Tt),Et=s.aT([],pt,s.aQ([],Mt,s.aW(pt,Mt))),Dt=s.a_(Et);if(Dt>0){const Sn=Math.sqrt(1-Mt[3]*Mt[3]),wn=s.aQ([],Mt,-Mt[3]),nn=s.aR([],wn,s.aQ([],Et,Sn/Dt));return s.b0(pt,nn)}return null}(ge,at);if(ct!==null){const Ze=ct/s.aW(qe[0],at);Ge=Math.min(Ge,Ze)}for(let Ze=0;Ze<4;Ze++){const pt=Math.min(Ge,Je[Ze]);ne[Ze+Ne]=[ne[Ze+ze][0]+qe[Ze][0]*pt,ne[Ze+ze][1]+qe[Ze][1]*pt,ne[Ze+ze][2]+qe[Ze][2]*pt,1]}}(U,D[0],_,M);const Z=D.map(ne=>{const le=s.aT([],U[ne[0]],U[ne[1]]),ge=s.aT([],U[ne[2]],U[ne[1]]),Le=s.aU([],s.aV([],le,ge)),ze=-s.aW(Le,U[ne[1]]);return Le.concat(ze)}),K=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],ie=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const ne of U)for(let le=0;le<3;le++)K[le]=Math.min(K[le],ne[le]),ie[le]=Math.max(ie[le],ne[le]);return new Di(U,Z,new Zl(K,ie))}}class Zi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,u,g){return this._helper.interpolatePadding(i,u,g)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,u,g=!0){this._helper.resize(i,u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,u){this._helper.overrideNearFarZ(i,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(i,u){}constructor(i,u,g,_,M){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ks({calcMatrices:()=>{this._calcMatrices()},getConstrained:(D,F)=>this.getConstrained(D,F)},i,u,g,_,M),this._coveringTilesDetailsProvider=new Oc}clone(){const i=new Zi;return i.apply(this),i}apply(i,u,g){this._helper.apply(i,u,g)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(i){const u=[new s.b1(0,i)];if(this._helper._renderWorldCopies){const g=this.screenPointToMercatorCoordinate(new s.P(0,0)),_=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),M=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),D=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),F=Math.floor(Math.min(g.x,_.x,M.x,D.x)),U=Math.floor(Math.max(g.x,_.x,M.x,D.x)),Z=1;for(let K=F-Z;K<=U+Z;K++)K!==0&&u.push(new s.b1(K,i))}return u}getCameraFrustum(){return Di.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(i){const u=this.screenPointToLocation(this.centerPoint,i),g=i?i.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(g)}setLocationAtPoint(i,u){const g=s.ai(this.elevation,this.center.lat),_=this.screenPointToMercatorCoordinateAtZ(u,g),M=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,g),D=s.a0.fromLngLat(i),F=new s.a0(D.x-(_.x-M.x),D.y-(_.y-M.y));this.setCenter(F?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(i,u){return u?this.coordinatePoint(s.a0.fromLngLat(i),u.getElevationForLngLatZoom(i,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(s.a0.fromLngLat(i))}screenPointToLocation(i,u){var g;return(g=this.screenPointToMercatorCoordinate(i,u))===null||g===void 0?void 0:g.toLngLat()}screenPointToMercatorCoordinate(i,u){if(u){const g=u.pointCoordinate(i);if(g!=null)return g}return this.screenPointToMercatorCoordinateAtZ(i)}screenPointToMercatorCoordinateAtZ(i,u){const g=u||0,_=[i.x,i.y,0,1],M=[i.x,i.y,1,1];s.av(_,_,this._pixelMatrixInverse),s.av(M,M,this._pixelMatrixInverse);const D=_[3],F=M[3],U=_[1]/D,Z=M[1]/F,K=_[2]/D,ie=M[2]/F,ne=K===ie?0:(g-K)/(ie-K);return new s.a0(s.C.number(_[0]/D,M[0]/F,ne)/this.worldSize,s.C.number(U,Z,ne)/this.worldSize,g)}coordinatePoint(i,u=0,g=this._pixelMatrix){const _=[i.x*this.worldSize,i.y*this.worldSize,u,1];return s.av(_,_,g),new s.P(_[0]/_[3],_[1]/_[3])}getBounds(){const i=Math.max(0,this._helper._height/2-ue(this));return new un().extend(this.screenPointToLocation(new s.P(0,i))).extend(this.screenPointToLocation(new s.P(this._helper._width,i))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(i,u){return u?u.pointCoordinate(i)!=null:i.y>this.height/2-ue(this)}calculatePosMatrix(i,u=!1,g){var _;const M=(_=i.key)!==null&&_!==void 0?_:s.b2(i.wrap,i.canonical.z,i.canonical.z,i.canonical.x,i.canonical.y),D=u?this._alignedPosMatrixCache:this._posMatrixCache;if(D.has(M)){const Z=D.get(M);return g?Z.f32:Z.f64}const F=ee(i,this.worldSize);s.O(F,u?this._alignedProjMatrix:this._viewProjMatrix,F);const U={f64:F,f32:new Float32Array(F)};return D.set(M,U),g?U.f32:U.f64}calculateFogMatrix(i){const u=i.key,g=this._fogMatrixCacheF32;if(g.has(u))return g.get(u);const _=ee(i,this.worldSize);return s.O(_,this._fogMatrix,_),g.set(u,new Float32Array(_)),g.get(u)}getConstrained(i,u){u=s.ag(+u,this.minZoom,this.maxZoom);const g={center:new s.S(i.lng,i.lat),zoom:u};let _=this._helper._lngRange;if(!this._helper._renderWorldCopies&&_===null){const Je=179.9999999999;_=[-Je,Je]}const M=this.tileSize*s.ae(g.zoom);let D=0,F=M,U=0,Z=M,K=0,ie=0;const{x:ne,y:le}=this.size;if(this._helper._latRange){const Je=this._helper._latRange;D=s.U(Je[1])*M,F=s.U(Je[0])*M,F-D<le&&(K=le/(F-D))}_&&(U=s.aN(s.V(_[0])*M,0,M),Z=s.aN(s.V(_[1])*M,0,M),Z<U&&(Z+=M),Z-U<ne&&(ie=ne/(Z-U)));const{x:ge,y:Le}=Pe(M,i);let ze,Ne;const Ge=Math.max(ie||0,K||0);if(Ge){const Je=new s.P(ie?(Z+U)/2:ge,K?(F+D)/2:Le);return g.center=ae(M,Je).wrap(),g.zoom+=s.aj(Ge),g}if(this._helper._latRange){const Je=le/2;Le-Je<D&&(Ne=D+Je),Le+Je>F&&(Ne=F-Je)}if(_){const Je=(U+Z)/2;let qe=ge;this._helper._renderWorldCopies&&(qe=s.aN(ge,Je-M/2,Je+M/2));const at=ne/2;qe-at<U&&(ze=U+at),qe+at>Z&&(ze=Z-at)}if(ze!==void 0||Ne!==void 0){const Je=new s.P(ze??ge,Ne??Le);g.center=ae(M,Je).wrap()}return g}calculateCenterFromCameraLngLatAlt(i,u,g,_){return this._helper.calculateCenterFromCameraLngLatAlt(i,u,g,_)}_calculateNearFarZIfNeeded(i,u,g){if(!this._helper.autoCalculateNearFarZ)return;const _=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),M=i-_*this._helper._pixelPerMeter/Math.cos(u),D=_<0?M:i,F=Math.PI/2+this.pitchInRadians,U=s.ad(this.fov)*(Math.abs(Math.cos(s.ad(this.roll)))*this.height+Math.abs(Math.sin(s.ad(this.roll)))*this.width)/this.height*(.5+g.y/this.height),Z=Math.sin(U)*D/Math.sin(s.ag(Math.PI-F-U,.01,Math.PI-.01)),K=ue(this),ie=Math.atan(K/this._helper.cameraToCenterDistance),ne=s.ad(.75),le=ie>ne?2*ie*(.5+g.y/(2*K)):ne,ge=Math.sin(le)*D/Math.sin(s.ag(Math.PI-F-le,.01,Math.PI-.01)),Le=Math.min(Z,ge);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*Le+D),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const i=this.centerOffset,u=Pe(this.worldSize,this.center),g=u.x,_=u.y;this._helper._pixelPerMeter=s.ai(1,this.center.lat)*this.worldSize;const M=s.ad(Math.min(this.pitch,Yt)),D=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(M));let F;this._calculateNearFarZIfNeeded(D,M,i),F=new Float64Array(16),s.b3(F,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.ap(this._invProjMatrix,F),F[8]=2*-i.x/this._helper._width,F[9]=2*i.y/this._helper._height,this._projectionMatrix=s.b4(F),s.N(F,F,[1,-1,1]),s.M(F,F,[0,0,-this._helper.cameraToCenterDistance]),s.b5(F,F,-this.rollInRadians),s.b6(F,F,this.pitchInRadians),s.b5(F,F,-this.bearingInRadians),s.M(F,F,[-g,-_,0]),this._mercatorMatrix=s.N([],F,[this.worldSize,this.worldSize,this.worldSize]),s.N(F,F,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,F),s.M(F,F,[0,0,-this.elevation]),this._viewProjMatrix=F,this._invViewProjMatrix=s.ap([],F);const U=[0,0,-1,1];s.av(U,U,this._invViewProjMatrix),this._cameraPosition=[U[0]/U[3],U[1]/U[3],U[2]/U[3]],this._fogMatrix=new Float64Array(16),s.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,D,this._helper._farZ),this._fogMatrix[8]=2*-i.x/this.width,this._fogMatrix[9]=2*i.y/this.height,s.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.M(this._fogMatrix,this._fogMatrix,[-g,-_,0]),s.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,F);const Z=this._helper._width%2/2,K=this._helper._height%2/2,ie=Math.cos(this.bearingInRadians),ne=Math.sin(-this.bearingInRadians),le=g-Math.round(g)+ie*Z+ne*K,ge=_-Math.round(_)+ie*K+ne*Z,Le=new Float64Array(F);if(s.M(Le,Le,[le>.5?le-1:le,ge>.5?ge-1:ge,0]),this._alignedProjMatrix=Le,F=s.ap(new Float64Array(16),this._pixelMatrix),!F)throw new Error("failed to invert matrix");this._pixelMatrixInverse=F,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const i=this.screenPointToMercatorCoordinate(new s.P(0,0)),u=[i.x*this.worldSize,i.y*this.worldSize,0,1];return s.av(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const i=s.ai(1,this.center.lat)*this.worldSize;return fe(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/i).toLngLat()}lngLatToCameraDepth(i,u){const g=s.a0.fromLngLat(i),_=[g.x*this.worldSize,g.y*this.worldSize,u,1];return s.av(_,_,this._viewProjMatrix),_[2]/_[3]}getProjectionData(i){const{overscaledTileID:u,aligned:g,applyTerrainMatrix:_}=i,M=this._helper.getMercatorTileCoordinates(u),D=u?this.calculatePosMatrix(u,g,!0):null;let F;return F=u&&u.terrainRttPosMatrix32f&&_?u.terrainRttPosMatrix32f:D||s.b7(),{mainMatrix:F,tileMercatorCoords:M,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:F}}isLocationOccluded(i){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(i,u,g){return 1}transformLightDirection(i){return s.aS(i)}getRayDirectionFromPixel(i){throw new Error("Not implemented.")}projectTileCoordinates(i,u,g,_){const M=this.calculatePosMatrix(g);let D;_?(D=[i,u,_(i,u),1],s.av(D,D,M)):(D=[i,u,0,1],kt(D,D,M));const F=D[3];return{point:new s.P(D[0]/F,D[1]/F),signedDistanceFromCamera:F,isOccluded:!1}}populateCache(i){for(const u of i)this.calculatePosMatrix(u)}getMatrixForModel(i,u){const g=s.a0.fromLngLat(i,u),_=g.meterInMercatorCoordinateUnits(),M=s.b8();return s.M(M,M,[g.x,g.y,g.z]),s.b5(M,M,Math.PI),s.b6(M,M,Math.PI/2),s.N(M,M,[-_,_,_]),M}getProjectionDataForCustomLayer(i=!0){const u=new s.Z(0,0,0,0,0),g=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:i}),_=ee(u,this.worldSize);s.O(_,this._viewProjMatrix,_),g.tileMercatorCoords=[0,0,1,1];const M=[s.$,s.$,this.worldSize/this._helper.pixelsPerMeter],D=s.b9();return s.N(D,_,M),g.fallbackMatrix=D,g.mainMatrix=D,g}getFastPathSimpleProjectionMatrix(i){return this.calculatePosMatrix(i)}}function To(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ni(S){if(S.useSlerp)if(S.k<1){const i=s.ba(S.startEulerAngles.roll,S.startEulerAngles.pitch,S.startEulerAngles.bearing),u=s.ba(S.endEulerAngles.roll,S.endEulerAngles.pitch,S.endEulerAngles.bearing),g=new Float64Array(4);s.bb(g,i,u,S.k);const _=s.bc(g);S.tr.setRoll(_.roll),S.tr.setPitch(_.pitch),S.tr.setBearing(_.bearing)}else S.tr.setRoll(S.endEulerAngles.roll),S.tr.setPitch(S.endEulerAngles.pitch),S.tr.setBearing(S.endEulerAngles.bearing);else S.tr.setRoll(s.C.number(S.startEulerAngles.roll,S.endEulerAngles.roll,S.k)),S.tr.setPitch(s.C.number(S.startEulerAngles.pitch,S.endEulerAngles.pitch,S.k)),S.tr.setBearing(s.C.number(S.startEulerAngles.bearing,S.endEulerAngles.bearing,S.k))}function Pi(S,i,u,g,_){const M=_.padding,D=Pe(_.worldSize,u.getNorthWest()),F=Pe(_.worldSize,u.getNorthEast()),U=Pe(_.worldSize,u.getSouthEast()),Z=Pe(_.worldSize,u.getSouthWest()),K=s.ad(-g),ie=D.rotate(K),ne=F.rotate(K),le=U.rotate(K),ge=Z.rotate(K),Le=new s.P(Math.max(ie.x,ne.x,ge.x,le.x),Math.max(ie.y,ne.y,ge.y,le.y)),ze=new s.P(Math.min(ie.x,ne.x,ge.x,le.x),Math.min(ie.y,ne.y,ge.y,le.y)),Ne=Le.sub(ze),Ge=(_.width-(M.left+M.right+i.left+i.right))/Ne.x,Je=(_.height-(M.top+M.bottom+i.top+i.bottom))/Ne.y;if(Je<0||Ge<0)return void To();const qe=Math.min(s.aj(_.scale*Math.min(Ge,Je)),S.maxZoom),at=s.P.convert(S.offset),ct=new s.P((i.left-i.right)/2,(i.top-i.bottom)/2).rotate(s.ad(g)),Ze=at.add(ct).mult(_.scale/s.ae(qe));return{center:ae(_.worldSize,D.add(U).div(2).sub(Ze)),zoom:qe,bearing:g}}class Oh{get useGlobeControls(){return!1}handlePanInertia(i,u){return{easingOffset:i,easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(i,u){i.bearingDelta&&u.setBearing(u.bearing+i.bearingDelta),i.pitchDelta&&u.setPitch(u.pitch+i.pitchDelta),i.rollDelta&&u.setRoll(u.roll+i.rollDelta),i.zoomDelta&&u.setZoom(u.zoom+i.zoomDelta)}handleMapControlsPan(i,u,g){i.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(g,i.around)}cameraForBoxAndBearing(i,u,g,_,M){return Pi(i,u,g,_,M)}handleJumpToCenterZoom(i,u){i.zoom!==(u.zoom!==void 0?+u.zoom:i.zoom)&&i.setZoom(+u.zoom),u.center!==void 0&&i.setCenter(s.S.convert(u.center))}handleEaseTo(i,u){const g=i.zoom,_=i.padding,M={roll:i.roll,pitch:i.pitch,bearing:i.bearing},D={roll:u.roll===void 0?i.roll:u.roll,pitch:u.pitch===void 0?i.pitch:u.pitch,bearing:u.bearing===void 0?i.bearing:u.bearing},F=u.zoom!==void 0,U=!i.isPaddingEqual(u.padding);let Z=!1;const K=F?+u.zoom:i.zoom;let ie=i.centerPoint.add(u.offsetAsPoint);const ne=i.screenPointToLocation(ie),{center:le,zoom:ge}=i.getConstrained(s.S.convert(u.center||ne),K??g);No(i,le);const Le=Pe(i.worldSize,ne),ze=Pe(i.worldSize,le).sub(Le),Ne=s.ae(ge-g);return Z=ge!==g,{easeFunc:Ge=>{if(Z&&i.setZoom(s.C.number(g,ge,Ge)),s.bd(M,D)||Ni({startEulerAngles:M,endEulerAngles:D,tr:i,k:Ge,useSlerp:M.roll!=D.roll}),U&&(i.interpolatePadding(_,u.padding,Ge),ie=i.centerPoint.add(u.offsetAsPoint)),u.around)i.setLocationAtPoint(u.around,u.aroundPoint);else{const Je=s.ae(i.zoom-g),qe=ge>g?Math.min(2,Ne):Math.max(.5,Ne),at=Math.pow(qe,1-Ge),ct=ae(i.worldSize,Le.add(ze.mult(Ge*at)).mult(Je));i.setLocationAtPoint(i.renderWorldCopies?ct.wrap():ct,ie)}},isZooming:Z,elevationCenter:le}}handleFlyTo(i,u){const g=u.zoom!==void 0,_=i.zoom,M=i.getConstrained(s.S.convert(u.center||u.locationAtOffset),g?+u.zoom:_),D=M.center,F=M.zoom;No(i,D);const U=Pe(i.worldSize,u.locationAtOffset),Z=Pe(i.worldSize,D).sub(U),K=Z.mag(),ie=s.ae(F-_);let ne;if(u.minZoom!==void 0){const le=Math.min(+u.minZoom,_,F),ge=i.getConstrained(D,le).zoom;ne=s.ae(ge-_)}return{easeFunc:(le,ge,Le,ze)=>{i.setZoom(le===1?F:_+s.aj(ge));const Ne=le===1?D:ae(i.worldSize,U.add(Z.mult(Le)).mult(ge));i.setLocationAtPoint(i.renderWorldCopies?Ne.wrap():Ne,ze)},scaleOfZoom:ie,targetCenter:D,scaleOfMinZoom:ne,pixelPathLength:K}}}class Tr{constructor(i,u,g){this.blendFunction=i,this.blendColor=u,this.mask=g}}Tr.Replace=[1,0],Tr.disabled=new Tr(Tr.Replace,s.be.transparent,[!1,!1,!1,!1]),Tr.unblended=new Tr(Tr.Replace,s.be.transparent,[!0,!0,!0,!0]),Tr.alphaBlended=new Tr([1,771],s.be.transparent,[!0,!0,!0,!0]);const es=2305;class yr{constructor(i,u,g){this.enable=i,this.mode=u,this.frontFace=g}}yr.disabled=new yr(!1,1029,es),yr.backCCW=new yr(!0,1029,es),yr.frontCCW=new yr(!0,1028,es);class gr{constructor(i,u,g){this.func=i,this.mask=u,this.range=g}}gr.ReadOnly=!1,gr.ReadWrite=!0,gr.disabled=new gr(519,gr.ReadOnly,[0,1]);const ha=7680;class sr{constructor(i,u,g,_,M,D){this.test=i,this.ref=u,this.mask=g,this.fail=_,this.depthFail=M,this.pass=D}}sr.disabled=new sr({func:519,mask:0},0,0,ha,ha,ha);const La=new WeakMap;function ts(S){var i;if(La.has(S))return La.get(S);{const u=(i=S.getParameter(S.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return La.set(S,u),u}}class Cu{get awaitingQuery(){return!!this._readbackQueue}constructor(i){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=i;const u=i.context,g=u.gl;this._texFormat=g.RGBA,this._texType=g.UNSIGNED_BYTE;const _=new s.aK;_.emplaceBack(-1,-1),_.emplaceBack(2,-1),_.emplaceBack(-1,2);const M=new s.aM;M.emplaceBack(0,1,2),this._fullscreenTriangle=new ua(u.createVertexBuffer(_,Ra.members),u.createIndexBuffer(M),s.aL.simpleSegment(0,0,_.length,M.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(g.TEXTURE1);const D=g.createTexture();g.bindTexture(g.TEXTURE_2D,D),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texImage2D(g.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(D),ts(g)&&(this._pbo=g.createBuffer(),g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.bufferData(g.PIXEL_PACK_BUFFER,4,g.STREAM_READ),g.bindBuffer(g.PIXEL_PACK_BUFFER,null))}destroy(){const i=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),i.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(i,u){const g=this._updateCount;return this._readbackQueue?g>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():g>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(i,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const i=this._cachedRenderContext.context,u=i.gl;i.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),i.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(i,u){const g=this._cachedRenderContext.context,_=g.gl;if(this._bindFramebuffer(),g.viewport.set([0,0,this._texWidth,this._texHeight]),g.clear({color:s.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(g,_.TRIANGLES,gr.disabled,sr.disabled,Tr.unblended,yr.disabled,((M,D)=>({u_input:M,u_output_expected:D}))(i,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ts(_)){_.bindBuffer(_.PIXEL_PACK_BUFFER,this._pbo),_.readBuffer(_.COLOR_ATTACHMENT0),_.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),_.bindBuffer(_.PIXEL_PACK_BUFFER,null);const M=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);_.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:M}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const i=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ts(i)){const u=i.clientWaitSync(this._readbackQueue.sync,0,0);if(u===i.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===i.TIMEOUT_EXPIRED)return;i.bindBuffer(i.PIXEL_PACK_BUFFER,this._pbo),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),i.bindBuffer(i.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),i.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Cu._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(i){let u=0;return u+=i[0]/256,u+=i[1]/65536,u+=i[2]/16777216,i[3]<127&&(u=-u),u/128}}const Bo=s.$/128;function Eu(S,i){const u=S.granularity!==void 0?Math.max(S.granularity,1):1,g=u+(S.generateBorders?2:0),_=u+(S.extendToNorthPole||S.generateBorders?1:0)+(S.extendToSouthPole||S.generateBorders?1:0),M=g+1,D=_+1,F=S.generateBorders?-1:0,U=S.generateBorders||S.extendToNorthPole?-1:0,Z=u+(S.generateBorders?1:0),K=u+(S.generateBorders||S.extendToSouthPole?1:0),ie=M*D,ne=g*_*6,le=M*D>65536;if(le&&i==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ge=le||i==="32bit",Le=new Int16Array(2*ie);let ze=0;for(let Je=U;Je<=K;Je++)for(let qe=F;qe<=Z;qe++){let at=qe/u*s.$;qe===-1&&(at=-Bo),qe===u+1&&(at=s.$+Bo);let ct=Je/u*s.$;Je===-1&&(ct=S.extendToNorthPole?s.bg:-Bo),Je===u+1&&(ct=S.extendToSouthPole?s.bh:s.$+Bo),Le[ze++]=at,Le[ze++]=ct}const Ne=ge?new Uint32Array(ne):new Uint16Array(ne);let Ge=0;for(let Je=0;Je<_;Je++)for(let qe=0;qe<g;qe++){const at=qe+1+Je*M,ct=qe+(Je+1)*M,Ze=qe+1+(Je+1)*M;Ne[Ge++]=qe+Je*M,Ne[Ge++]=ct,Ne[Ge++]=at,Ne[Ge++]=at,Ne[Ge++]=ct,Ne[Ge++]=Ze}return{vertices:Le.buffer.slice(0),indices:Ne.buffer.slice(0),uses32bitIndices:ge}}const Js=new s.aJ({fill:new s.bi(128,2),line:new s.bi(512,0),tile:new s.bi(128,32),stencil:new s.bi(128,1),circle:3});class Cp{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return io.projectionGlobe}get vertexShaderPreludeCode(){return io.projectionMercator.vertexSource}get subdivisionGranularity(){return Js}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(i){this._errorMeasurement||(this._errorMeasurement=new Cu(i));const u=s.U(this._errorQueryLatitudeDegrees),g=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,_=this._errorMeasurement.updateErrorLoop(u,g),M=E.now();_!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=_,this._errorMeasurementLastChangeTime=M);const D=Math.min(Math.max((M-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bk(D))}_getMeshKey(i){return`${i.granularity.toString(36)}_${i.generateBorders?"b":""}${i.extendToNorthPole?"n":""}${i.extendToSouthPole?"s":""}`}getMeshFromTileID(i,u,g,_,M){const D=(M==="stencil"?Js.stencil:Js.tile).getGranularityForZoomLevel(u.z);return this._getMesh(i,{granularity:D,generateBorders:g,extendToNorthPole:u.y===0&&_,extendToSouthPole:u.y===(1<<u.z)-1&&_})}_getMesh(i,u){const g=this._getMeshKey(u);if(g in this._tileMeshCache)return this._tileMeshCache[g];const _=function(M,D){const F=Eu(D,"16bit"),U=s.aK.deserialize({arrayBuffer:F.vertices,length:F.vertices.byteLength/2/2}),Z=s.aM.deserialize({arrayBuffer:F.indices,length:F.indices.byteLength/2/3});return new ua(M.createVertexBuffer(U,Ra.members),M.createIndexBuffer(Z),s.aL.simpleSegment(0,0,U.length,Z.length))}(i,u);return this._tileMeshCache[g]=_,_}recalculate(i){}hasTransition(){const i=E.now();let u=!1;return u=u||(i-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(i){this._errorQueryLatitudeDegrees=i}}const ll=new s.r({type:new s.D(s.v.projection.type)});class Fc extends s.E{constructor(i){super(),this._transitionable=new s.t(ll),this.setProjection(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0)),this._mercatorProjection=new zh,this._verticalPerspectiveProjection=new Cp}get transitionState(){const i=this.properties.get("type");if(typeof i=="string"&&i==="mercator")return 0;if(typeof i=="string"&&i==="vertical-perspective")return 1;if(i instanceof s.bl){if(i.from==="vertical-perspective"&&i.to==="mercator")return 1-i.transition;if(i.from==="mercator"&&i.to==="vertical-perspective")return i.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(i){this._mercatorProjection.updateGPUdependent(i),this._verticalPerspectiveProjection.updateGPUdependent(i)}getMeshFromTileID(i,u,g,_,M){return this.currentProjection.getMeshFromTileID(i,u,g,_,M)}setProjection(i){this._transitionable.setValue("type",i?.type||"mercator")}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}setErrorQueryLatitudeDegrees(i){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(i),this._mercatorProjection.setErrorQueryLatitudeDegrees(i)}}function Yl(S){const i=cl(S.worldSize,S.center.lat);return 2*Math.PI*i}function Qs(S,i,u,g,_){const M=1/(1<<_),D=i/s.$*M+g*M,F=s.bn((S/s.$*M+u*M)*Math.PI*2+Math.PI,2*Math.PI),U=2*Math.atan(Math.exp(Math.PI-D*Math.PI*2))-.5*Math.PI,Z=Math.cos(U),K=new Float64Array(3);return K[0]=Math.sin(F)*Z,K[1]=Math.sin(U),K[2]=Math.cos(F)*Z,K}function ji(S){return function(i,u){const g=Math.cos(u),_=new Float64Array(3);return _[0]=Math.sin(i)*g,_[1]=Math.sin(u),_[2]=Math.cos(i)*g,_}(S.lng*Math.PI/180,S.lat*Math.PI/180)}function cl(S,i){return S/(2*Math.PI)/Math.cos(i*Math.PI/180)}function Tu(S){const i=Math.asin(S[1])/Math.PI*180,u=Math.sqrt(S[0]*S[0]+S[2]*S[2]);if(u>1e-6){const g=S[0]/u,_=Math.acos(S[2]/u),M=(g>0?_:-_)/Math.PI*180;return new s.S(s.aN(M,-180,180),i)}return new s.S(0,i)}function fo(S){return Math.cos(S*Math.PI/180)}function Si(S,i){const u=fo(S),g=fo(i);return s.aj(g/u)}function Nc(S,i){const u=S.rotate(i.bearingInRadians),g=i.zoom+Si(i.center.lat,0),_=s.bj(1/fo(i.center.lat),1/fo(Math.min(Math.abs(i.center.lat),60)),s.bm(g,7,3,0,1)),M=360/Yl({worldSize:i.worldSize,center:{lat:i.center.lat}});return new s.S(i.center.lng-u.x*M*_,s.ag(i.center.lat+u.y*M,-s.ah,s.ah))}function Da(S){const i=.5*S,u=Math.sin(i),g=Math.cos(i);return Math.log(u+g)-Math.log(g-u)}function Pu(S,i,u,g){const _=S.lat+u*g;if(Math.abs(u)>1){const M=(Math.sign(S.lat+u)!==Math.sign(S.lat)?-Math.abs(S.lat):Math.abs(S.lat))*Math.PI/180,D=Math.abs(S.lat+u)*Math.PI/180,F=Da(M+g*(D-M)),U=Da(M),Z=Da(D);return new s.S(S.lng+i*((F-U)/(Z-U)),_)}return new s.S(S.lng+i*g,_)}class Ep{constructor(i){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=i}swapBuffers(){if(!this._hadAnyChanges)return;const i=this._cachePrevious;this._cachePrevious=this._cache,this._cache=i,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(i,u,g,_){const M=`${i.z}_${i.x}_${i.y}_${_?.terrain?"t":""}`,D=this._cache.get(M);if(D)return D;const F=this._cachePrevious.get(M);if(F)return this._cache.set(M,F),F;const U=this._boundingVolumeFactory(i,u,g,_);return this._cache.set(M,U),this._hadAnyChanges=!0,U}}class ka{constructor(i,u,g,_){this.min=g,this.max=_,this.points=i,this.planes=u}static fromAabb(i,u){const g=[];for(let _=0;_<8;_++)g.push([1&~_?i[0]:u[0],(_>>1&1)==1?u[1]:i[1],(_>>2&1)==1?u[2]:i[2]]);return new ka(g,[[-1,0,0,u[0]],[1,0,0,-i[0]],[0,-1,0,u[1]],[0,1,0,-i[1]],[0,0,-1,u[2]],[0,0,1,-i[2]]],i,u)}static fromCenterSizeAngles(i,u,g){const _=s.bq([],g[0],g[1],g[2]),M=s.br([],[u[0],0,0],_),D=s.br([],[0,u[1],0],_),F=s.br([],[0,0,u[2]],_),U=[...i],Z=[...i];for(let ie=0;ie<8;ie++)for(let ne=0;ne<3;ne++){const le=i[ne]+M[ne]*(1&~ie?-1:1)+D[ne]*((ie>>1&1)==1?1:-1)+F[ne]*((ie>>2&1)==1?1:-1);U[ne]=Math.min(U[ne],le),Z[ne]=Math.max(Z[ne],le)}const K=[];for(let ie=0;ie<8;ie++){const ne=[...i];s.aR(ne,ne,s.aQ([],M,1&~ie?-1:1)),s.aR(ne,ne,s.aQ([],D,(ie>>1&1)==1?1:-1)),s.aR(ne,ne,s.aQ([],F,(ie>>2&1)==1?1:-1)),K.push(ne)}return new ka(K,[[...M,-s.aW(M,K[0])],[...D,-s.aW(D,K[0])],[...F,-s.aW(F,K[0])],[-M[0],-M[1],-M[2],-s.aW(M,K[7])],[-D[0],-D[1],-D[2],-s.aW(D,K[7])],[-F[0],-F[1],-F[2],-s.aW(F,K[7])]],U,Z)}intersectsFrustum(i){let u=!0;const g=this.points.length,_=this.planes.length,M=i.planes.length,D=i.points.length;for(let F=0;F<M;F++){const U=i.planes[F];let Z=0;for(let K=0;K<g;K++){const ie=this.points[K];U[0]*ie[0]+U[1]*ie[1]+U[2]*ie[2]+U[3]>=0&&Z++}if(Z===0)return 0;Z<g&&(u=!1)}if(u)return 2;for(let F=0;F<_;F++){const U=this.planes[F];let Z=0;for(let K=0;K<D;K++){const ie=i.points[K];U[0]*ie[0]+U[1]*ie[1]+U[2]*ie[2]+U[3]>=0&&Z++}if(Z===0)return 0}return 1}intersectsPlane(i){const u=this.points.length;let g=0;for(let _=0;_<u;_++){const M=this.points[_];i[0]*M[0]+i[1]*M[1]+i[2]*M[2]+i[3]>=0&&g++}return g===u?2:g===0?0:1}}function ul(S,i,u){const g=S-i;return g<0?-g:Math.max(0,g-u)}function Au(S,i,u,g,_){const M=S-u;let D;return D=M<0?Math.min(-M,1+M-_):M>1?Math.min(Math.max(M-_,0),1-M):0,Math.max(D,ul(i,g,_))}class Qm{constructor(){this._boundingVolumeCache=new Ep(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(i,u,g,_){const M=1<<g.z,D=1/M,F=g.x/M,U=g.y/M;let Z=2;return Z=Math.min(Z,Au(i,u,F,U,D)),Z=Math.min(Z,Au(i,u,F+.5,-U-D,D)),Z=Math.min(Z,Au(i,u,F+.5,2-U-D,D)),Z}getWrap(i,u,g){const _=1<<u.z,M=1/_,D=u.x/_,F=ul(i.x,D,M),U=ul(i.x,D-1,M),Z=ul(i.x,D+1,M),K=Math.min(F,U,Z);return K===Z?1:K===U?-1:0}allowVariableZoom(i,u){return Be(i,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(i,u,g,_){return this._boundingVolumeCache.getTileBoundingVolume(i,u,g,_)}_computeTileBoundingVolume(i,u,g,_){var M,D;let F=g,U=g;if(_?.terrain){const Z=new s.Z(i.z,u,i.z,i.x,i.y),K=_.terrain.getMinMaxElevation(Z);F=(M=K.minElevation)!==null&&M!==void 0?M:g,U=(D=K.maxElevation)!==null&&D!==void 0?D:g}if(F/=s.bt,U/=s.bt,F+=1,U+=1,i.z<=0)return ka.fromAabb([-U,-U,-U],[U,U,U]);if(i.z===1)return ka.fromAabb([i.x===0?-U:0,i.y===0?0:-U,-U],[i.x===0?0:U,i.y===0?U:0,U]);{const Z=[Qs(0,0,i.x,i.y,i.z),Qs(s.$,0,i.x,i.y,i.z),Qs(s.$,s.$,i.x,i.y,i.z),Qs(0,s.$,i.x,i.y,i.z)],K=[];for(const Et of Z)K.push(s.aQ([],Et,U));if(U!==F)for(const Et of Z)K.push(s.aQ([],Et,F));i.y===0&&K.push([0,1,0]),i.y===(1<<i.z)-1&&K.push([0,-1,0]);const ie=[1,1,1],ne=[-1,-1,-1];for(const Et of K)for(let Dt=0;Dt<3;Dt++)ie[Dt]=Math.min(ie[Dt],Et[Dt]),ne[Dt]=Math.max(ne[Dt],Et[Dt]);const le=Qs(s.$/2,s.$/2,i.x,i.y,i.z),ge=s.aV([],[0,1,0],le);s.aU(ge,ge);const Le=s.aV([],le,ge);s.aU(Le,Le);const ze=s.aV([],Z[2],Z[1]);s.aU(ze,ze);const Ne=s.aV([],Z[0],Z[3]);s.aU(Ne,Ne),K.push(s.aQ([],le,U)),i.y>=(1<<i.z)/2&&K.push(s.aQ([],Qs(s.$/2,0,i.x,i.y,i.z),U)),i.y<(1<<i.z)/2&&K.push(s.aQ([],Qs(s.$/2,s.$,i.x,i.y,i.z),U));const Ge=ns(le,K),Je=ns(Le,K),qe=[-le[0],-le[1],-le[2],Ge.max],at=[le[0],le[1],le[2],-Ge.min],ct=[-Le[0],-Le[1],-Le[2],Je.max],Ze=[Le[0],Le[1],Le[2],-Je.min],pt=[...ze,0],Tt=[...Ne,0],Mt=[];return i.y===0?Mt.push(s.bs(Tt,pt,qe),s.bs(Tt,pt,at)):Mt.push(s.bs(ct,pt,qe),s.bs(ct,pt,at),s.bs(ct,Tt,qe),s.bs(ct,Tt,at)),i.y===(1<<i.z)-1?Mt.push(s.bs(Tt,pt,qe),s.bs(Tt,pt,at)):Mt.push(s.bs(Ze,pt,qe),s.bs(Ze,pt,at),s.bs(Ze,Tt,qe),s.bs(Ze,Tt,at)),new ka(Mt,[qe,at,ct,Ze,pt,Tt],ie,ne)}}}function ns(S,i){let u=1/0,g=-1/0;for(const _ of i){const M=s.aW(S,_);u=Math.min(u,M),g=Math.max(g,M)}return{min:u,max:g}}class Iu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,u,g){return this._helper.interpolatePadding(i,u,g)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,u){this._helper.resize(i,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,u){this._helper.overrideNearFarZ(i,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(i){}constructor(){this._cachedClippingPlane=s.bu(),this._projectionMatrix=s.b8(),this._globeViewProjMatrix32f=s.b7(),this._globeViewProjMatrixNoCorrection=s.b8(),this._globeViewProjMatrixNoCorrectionInverted=s.b8(),this._globeProjMatrixInverted=s.b8(),this._cameraPosition=s.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ks({calcMatrices:()=>{this._calcMatrices()},getConstrained:(i,u)=>this.getConstrained(i,u)}),this._coveringTilesDetailsProvider=new Qm}clone(){const i=new Iu;return i.apply(this),i}apply(i,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(i)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const i=s.bo();return i[0]=this._cameraPosition[0],i[1]=this._cameraPosition[1],i[2]=this._cameraPosition[2],i}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(i){const{overscaledTileID:u,applyGlobeMatrix:g}=i,_=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:_,clippingPlane:this._cachedClippingPlane,projectionTransition:g?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(i){const u=this.pitchInRadians,g=this.cameraToCenterDistance/i,_=Math.sin(u)*g,M=Math.cos(u)*g+1,D=1/Math.sqrt(_*_+M*M)*1;let F=-_,U=M;const Z=Math.sqrt(F*F+U*U);F/=Z,U/=Z;const K=[0,F,U];s.bv(K,K,[0,0,0],-this.bearingInRadians),s.bw(K,K,[0,0,0],-1*this.center.lat*Math.PI/180),s.bx(K,K,[0,0,0],this.center.lng*Math.PI/180);const ie=1/s.aY(K);return s.aQ(K,K,ie),[...K,-D*ie]}isLocationOccluded(i){return!this.isSurfacePointVisible(ji(i))}transformLightDirection(i){const u=this._helper._center.lng*Math.PI/180,g=this._helper._center.lat*Math.PI/180,_=Math.cos(g),M=[Math.sin(u)*_,Math.sin(g),Math.cos(u)*_],D=[M[2],0,-M[0]],F=[0,0,0];s.aV(F,D,M),s.aU(D,D),s.aU(F,F);const U=[0,0,0];return s.aU(U,[D[0]*i[0]+F[0]*i[1]+M[0]*i[2],D[1]*i[0]+F[1]*i[1]+M[1]*i[2],D[2]*i[0]+F[2]*i[1]+M[2]*i[2]]),U}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(i,u,g){const _=function(F,U,Z){const K=1/(1<<Z.z);return new s.a0(F/s.$*K+Z.x*K,U/s.$*K+Z.y*K)}(i,u,g.canonical),M=(D=_.y,[s.bn(_.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-D*Math.PI*2))-.5*Math.PI]);var D;return this.getCircleRadiusCorrection()/Math.cos(M[1])}projectTileCoordinates(i,u,g,_){const M=g.canonical,D=Qs(i,u,M.x,M.y,M.z),F=1+(_?_(i,u):0)/s.bt,U=[D[0]*F,D[1]*F,D[2]*F,1];s.av(U,U,this._globeViewProjMatrixNoCorrection);const Z=this._cachedClippingPlane,K=Z[0]*D[0]+Z[1]*D[1]+Z[2]*D[2]+Z[3]<0;return{point:new s.P(U[0]/U[3],U[1]/U[3]),signedDistanceFromCamera:U[3],isOccluded:K}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const i=cl(this.worldSize,this.center.lat),u=s.b9(),g=s.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*i),s.b3(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const _=this.centerOffset;u[8]=2*-_.x/this._helper._width,u[9]=2*_.y/this._helper._height,this._projectionMatrix=s.b4(u),this._globeProjMatrixInverted=s.b9(),s.ap(this._globeProjMatrixInverted,u),s.M(u,u,[0,0,-this.cameraToCenterDistance]),s.b5(u,u,this.rollInRadians),s.b6(u,u,-this.pitchInRadians),s.b5(u,u,this.bearingInRadians),s.M(u,u,[0,0,-i]);const M=s.bo();M[0]=i,M[1]=i,M[2]=i,s.b6(g,u,this.center.lat*Math.PI/180),s.by(g,g,-this.center.lng*Math.PI/180),s.N(g,g,M),this._globeViewProjMatrixNoCorrection=g,s.b6(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.by(u,u,-this.center.lng*Math.PI/180),s.N(u,u,M),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=s.b9(),s.ap(this._globeViewProjMatrixNoCorrectionInverted,g);const D=s.bo();this._cameraPosition=s.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/i,s.bv(this._cameraPosition,this._cameraPosition,D,-this.rollInRadians),s.bw(this._cameraPosition,this._cameraPosition,D,this.pitchInRadians),s.bv(this._cameraPosition,this._cameraPosition,D,-this.bearingInRadians),s.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bw(this._cameraPosition,this._cameraPosition,D,-this.center.lat*Math.PI/180),s.bx(this._cameraPosition,this._cameraPosition,D,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(i);const F=s.b4(this._globeViewProjMatrixNoCorrectionInverted);s.N(F,F,[1,1,-1]),this._cachedFrustum=Di.fromInvProjectionMatrix(F,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(i){s.w("calculateFogMatrix is not supported on globe projection.");const u=s.b9();return s.af(u),u}getVisibleUnwrappedCoordinates(i){return[new s.b1(0,i)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(i){i&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(i,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const g=ji(i);s.aQ(g,g,1+u/s.bt);const _=s.bu();return s.av(_,[g[0],g[1],g[2],1],this._globeViewProjMatrixNoCorrection),_[2]/_[3]}populateCache(i){}getBounds(){const i=.5*this.width,u=.5*this.height,g=[new s.P(0,0),new s.P(i,0),new s.P(this.width,0),new s.P(this.width,u),new s.P(this.width,this.height),new s.P(i,this.height),new s.P(0,this.height),new s.P(0,u)],_=[];for(const ie of g)_.push(this.unprojectScreenPoint(ie));let M=0,D=0,F=0,U=0;const Z=this.center;for(const ie of _){const ne=s.bz(Z.lng,ie.lng),le=s.bz(Z.lat,ie.lat);ne<D&&(D=ne),ne>M&&(M=ne),le<U&&(U=le),le>F&&(F=le)}const K=[Z.lng+D,Z.lat+U,Z.lng+M,Z.lat+F];return this.isSurfacePointOnScreen([0,1,0])&&(K[3]=90,K[0]=-180,K[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(K[1]=-90,K[0]=-180,K[2]=180),new un(K)}getConstrained(i,u){const g=s.ag(i.lat,-s.ah,s.ah),_=s.ag(+u,this.minZoom+Si(0,g),this.maxZoom);return{center:new s.S(i.lng,g),zoom:_}}calculateCenterFromCameraLngLatAlt(i,u,g,_){return this._helper.calculateCenterFromCameraLngLatAlt(i,u,g,_)}setLocationAtPoint(i,u){const g=ji(this.unprojectScreenPoint(u)),_=ji(i),M=s.bo();s.bA(M);const D=s.bo();s.bx(D,g,M,-this.center.lng*Math.PI/180),s.bw(D,D,M,this.center.lat*Math.PI/180);const F=_[0]*_[0]+_[2]*_[2],U=D[0]*D[0];if(F<U)return;const Z=Math.sqrt(F-U),K=-Z,ie=s.bB(_[0],_[2],D[0],Z),ne=s.bB(_[0],_[2],D[0],K),le=s.bo();s.bx(le,_,M,-ie);const ge=s.bB(le[1],le[2],D[1],D[2]),Le=s.bo();s.bx(Le,_,M,-ne);const ze=s.bB(Le[1],Le[2],D[1],D[2]),Ne=.5*Math.PI,Ge=ge>=-Ne&&ge<=Ne,Je=ze>=-Ne&&ze<=Ne;let qe,at;if(Ge&&Je){const Tt=this.center.lng*Math.PI/180,Mt=this.center.lat*Math.PI/180;s.bC(ie,Tt)+s.bC(ge,Mt)<s.bC(ne,Tt)+s.bC(ze,Mt)?(qe=ie,at=ge):(qe=ne,at=ze)}else if(Ge)qe=ie,at=ge;else{if(!Je)return;qe=ne,at=ze}const ct=qe/Math.PI*180,Ze=at/Math.PI*180,pt=this.center.lat;this.setCenter(new s.S(ct,s.ag(Ze,-90,90))),this.setZoom(this.zoom+Si(pt,this.center.lat))}locationToScreenPoint(i,u){const g=ji(i);if(u){const _=u.getElevationForLngLatZoom(i,this._helper._tileZoom);s.aQ(g,g,1+_/s.bt)}return this._projectSurfacePointToScreen(g)}_projectSurfacePointToScreen(i){const u=s.bu();return s.av(u,[...i,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new s.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(i,u){if(u){const g=u.pointCoordinate(i);if(g)return g}return s.a0.fromLngLat(this.unprojectScreenPoint(i))}screenPointToLocation(i,u){var g;return(g=this.screenPointToMercatorCoordinate(i,u))===null||g===void 0?void 0:g.toLngLat()}isPointOnMapSurface(i,u){const g=this._cameraPosition,_=this.getRayDirectionFromPixel(i);return!!this.rayPlanetIntersection(g,_)}getRayDirectionFromPixel(i){const u=s.bu();u[0]=i.x/this.width*2-1,u[1]=-1*(i.y/this.height*2-1),u[2]=1,u[3]=1,s.av(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const g=s.bo();g[0]=u[0]-this._cameraPosition[0],g[1]=u[1]-this._cameraPosition[1],g[2]=u[2]-this._cameraPosition[2];const _=s.bo();return s.aU(_,g),_}isSurfacePointVisible(i){const u=this._cachedClippingPlane;return u[0]*i[0]+u[1]*i[1]+u[2]*i[2]+u[3]>=0}isSurfacePointOnScreen(i){if(!this.isSurfacePointVisible(i))return!1;const u=s.bu();return s.av(u,[...i,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(i,u){const g=s.aW(i,u),_=s.bo(),M=s.bo();s.aQ(M,u,g),s.aT(_,i,M);const D=1-s.aW(_,_);if(D<0)return null;const F=s.aW(i,i)-1,U=-g+(g<0?1:-1)*Math.sqrt(D),Z=F/U,K=U;return{tMin:Math.min(Z,K),tMax:Math.max(Z,K)}}unprojectScreenPoint(i){const u=this._cameraPosition,g=this.getRayDirectionFromPixel(i),_=this.rayPlanetIntersection(u,g);if(_){const K=s.bo();s.aR(K,u,[g[0]*_.tMin,g[1]*_.tMin,g[2]*_.tMin]);const ie=s.bo();return s.aU(ie,K),Tu(ie)}const M=this._cachedClippingPlane,D=M[0]*g[0]+M[1]*g[1]+M[2]*g[2],F=-s.b0(M,u)/D,U=s.bo();if(F>0)s.aR(U,u,[g[0]*F,g[1]*F,g[2]*F]);else{const K=s.bo();s.aR(K,u,[2*g[0],2*g[1],2*g[2]]);const ie=s.b0(this._cachedClippingPlane,K);s.aT(U,K,[this._cachedClippingPlane[0]*ie,this._cachedClippingPlane[1]*ie,this._cachedClippingPlane[2]*ie])}const Z=function(K){const ie=s.bo();return ie[0]=K[0]*-K[3],ie[1]=K[1]*-K[3],ie[2]=K[2]*-K[3],{center:ie,radius:Math.sqrt(1-K[3]*K[3])}}(M);return Tu(function(K,ie,ne){const le=s.bo();s.aT(le,ne,K);const ge=s.bo();return s.bp(ge,K,le,ie/s.a_(le)),ge}(Z.center,Z.radius,U))}getMatrixForModel(i,u){const g=s.S.convert(i),_=1/s.bt,M=s.b8();return s.by(M,M,g.lng/180*Math.PI),s.b6(M,M,-g.lat/180*Math.PI),s.M(M,M,[0,0,1+u/s.bt]),s.b6(M,M,.5*Math.PI),s.N(M,M,[_,_,_]),M}getProjectionDataForCustomLayer(i=!0){const u=this.getProjectionData({overscaledTileID:new s.Z(0,0,0,0,0),applyGlobeMatrix:i});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(i){}}class Ls{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,u,g){return this._helper.interpolatePadding(i,u,g)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,u,g=!0){this._helper.resize(i,u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,u){this._helper.overrideNearFarZ(i,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(i,u){this._globeness=i,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ks({calcMatrices:()=>{this._calcMatrices()},getConstrained:(i,u)=>this.getConstrained(i,u)}),this._globeness=1,this._mercatorTransform=new Zi,this._verticalPerspectiveTransform=new Iu}clone(){const i=new Ls;return i._globeness=this._globeness,i._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,i.apply(this),i}apply(i){this._helper.apply(i),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(i){const u=this._mercatorTransform.getProjectionData(i),g=this._verticalPerspectiveTransform.getProjectionData(i);return{mainMatrix:this.isGlobeRendering?g.mainMatrix:u.mainMatrix,clippingPlane:g.clippingPlane,tileMercatorCoords:g.tileMercatorCoords,projectionTransition:i.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(i){return this.currentTransform.isLocationOccluded(i)}transformLightDirection(i){return this.currentTransform.transformLightDirection(i)}getPixelScale(){return s.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(i,u,g){const _=this._mercatorTransform.getPitchedTextCorrection(i,u,g),M=this._verticalPerspectiveTransform.getPitchedTextCorrection(i,u,g);return s.bj(_,M,this._globeness)}projectTileCoordinates(i,u,g,_){return this.currentTransform.projectTileCoordinates(i,u,g,_)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(i){return this.currentTransform.calculateFogMatrix(i)}getVisibleUnwrappedCoordinates(i){return this.currentTransform.getVisibleUnwrappedCoordinates(i)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(i){this._mercatorTransform.recalculateZoomAndCenter(i),this._verticalPerspectiveTransform.recalculateZoomAndCenter(i)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(i,u){return this.currentTransform.lngLatToCameraDepth(i,u)}populateCache(i){this._mercatorTransform.populateCache(i),this._verticalPerspectiveTransform.populateCache(i)}getBounds(){return this.currentTransform.getBounds()}getConstrained(i,u){return this.currentTransform.getConstrained(i,u)}calculateCenterFromCameraLngLatAlt(i,u,g,_){return this._helper.calculateCenterFromCameraLngLatAlt(i,u,g,_)}setLocationAtPoint(i,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(i,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(i,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(i,u){return this.currentTransform.locationToScreenPoint(i,u)}screenPointToMercatorCoordinate(i,u){return this.currentTransform.screenPointToMercatorCoordinate(i,u)}screenPointToLocation(i,u){return this.currentTransform.screenPointToLocation(i,u)}isPointOnMapSurface(i,u){return this.currentTransform.isPointOnMapSurface(i,u)}getRayDirectionFromPixel(i){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(i)}getMatrixForModel(i,u){return this.currentTransform.getMatrixForModel(i,u)}getProjectionDataForCustomLayer(i=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(i);if(!this.isGlobeRendering)return u;const g=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(i);return g.fallbackMatrix=u.mainMatrix,g}getFastPathSimpleProjectionMatrix(i){return this.currentTransform.getFastPathSimpleProjectionMatrix(i)}}class Uo{get useGlobeControls(){return!0}handlePanInertia(i,u){const g=Nc(i,u);return Math.abs(g.lng-u.center.lng)>180&&(g.lng=u.center.lng+179.5*Math.sign(g.lng-u.center.lng)),{easingCenter:g,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(i,u){const g=i.around,_=u.screenPointToLocation(g);i.bearingDelta&&u.setBearing(u.bearing+i.bearingDelta),i.pitchDelta&&u.setPitch(u.pitch+i.pitchDelta),i.rollDelta&&u.setRoll(u.roll+i.rollDelta);const M=u.zoom;i.zoomDelta&&u.setZoom(u.zoom+i.zoomDelta);const D=u.zoom-M;if(D===0)return;const F=s.bz(u.center.lng,_.lng),U=F/(Math.abs(F/180)+1),Z=s.bz(u.center.lat,_.lat),K=u.getRayDirectionFromPixel(g),ie=u.cameraPosition,ne=-1*s.aW(ie,K),le=s.bo();s.aR(le,ie,[K[0]*ne,K[1]*ne,K[2]*ne]);const ge=s.aY(le)-1,Le=Math.exp(.5*-Math.max(ge-.3,0)),ze=cl(u.worldSize,u.center.lat)/Math.min(u.width,u.height),Ne=s.bm(ze,.9,.5,1,.25),Ge=(1-s.ae(-D))*Math.min(Le,Ne),Je=u.center.lat,qe=u.zoom,at=new s.S(u.center.lng+U*Ge,s.ag(u.center.lat+Z*Ge,-s.ah,s.ah));u.setLocationAtPoint(_,g);const ct=u.center,Ze=s.bm(Math.abs(F),45,85,0,1),pt=s.bm(ze,.75,.35,0,1),Tt=Math.pow(Math.max(Ze,pt),.25),Mt=s.bz(ct.lng,at.lng),Et=s.bz(ct.lat,at.lat);u.setCenter(new s.S(ct.lng+Mt*Tt,ct.lat+Et*Tt).wrap()),u.setZoom(qe+Si(Je,u.center.lat))}handleMapControlsPan(i,u,g){if(!i.panDelta)return;const _=u.center.lat,M=u.zoom;u.setCenter(Nc(i.panDelta,u).wrap()),u.setZoom(M+Si(_,u.center.lat))}cameraForBoxAndBearing(i,u,g,_,M){const D=Pi(i,u,g,_,M),F=u.left/M.width*2-1,U=(M.width-u.right)/M.width*2-1,Z=u.top/M.height*-2+1,K=(M.height-u.bottom)/M.height*-2+1,ie=s.bz(g.getWest(),g.getEast())<0,ne=ie?g.getEast():g.getWest(),le=ie?g.getWest():g.getEast(),ge=Math.max(g.getNorth(),g.getSouth()),Le=Math.min(g.getNorth(),g.getSouth()),ze=ne+.5*s.bz(ne,le),Ne=ge+.5*s.bz(ge,Le),Ge=M.clone();Ge.setCenter(D.center),Ge.setBearing(D.bearing),Ge.setPitch(0),Ge.setRoll(0),Ge.setZoom(D.zoom);const Je=Ge.modelViewProjectionMatrix,qe=[ji(g.getNorthWest()),ji(g.getNorthEast()),ji(g.getSouthWest()),ji(g.getSouthEast()),ji(new s.S(le,Ne)),ji(new s.S(ne,Ne)),ji(new s.S(ze,ge)),ji(new s.S(ze,Le))],at=ji(D.center);let ct=Number.POSITIVE_INFINITY;for(const Ze of qe)F<0&&(ct=Uo.getLesserNonNegativeNonNull(ct,Uo.solveVectorScale(Ze,at,Je,"x",F))),U>0&&(ct=Uo.getLesserNonNegativeNonNull(ct,Uo.solveVectorScale(Ze,at,Je,"x",U))),Z>0&&(ct=Uo.getLesserNonNegativeNonNull(ct,Uo.solveVectorScale(Ze,at,Je,"y",Z))),K<0&&(ct=Uo.getLesserNonNegativeNonNull(ct,Uo.solveVectorScale(Ze,at,Je,"y",K)));if(Number.isFinite(ct)&&ct!==0)return D.zoom=Ge.zoom+s.aj(ct),D;To()}handleJumpToCenterZoom(i,u){const g=i.center.lat,_=i.getConstrained(u.center?s.S.convert(u.center):i.center,i.zoom).center;i.setCenter(_.wrap());const M=u.zoom!==void 0?+u.zoom:i.zoom+Si(g,_.lat);i.zoom!==M&&i.setZoom(M)}handleEaseTo(i,u){const g=i.zoom,_=i.center,M=i.padding,D={roll:i.roll,pitch:i.pitch,bearing:i.bearing},F={roll:u.roll===void 0?i.roll:u.roll,pitch:u.pitch===void 0?i.pitch:u.pitch,bearing:u.bearing===void 0?i.bearing:u.bearing},U=u.zoom!==void 0,Z=!i.isPaddingEqual(u.padding);let K=!1;const ie=u.center?s.S.convert(u.center):_,ne=i.getConstrained(ie,g).center;No(i,ne);const le=i.clone();le.setCenter(ne),le.setZoom(U?+u.zoom:g+Si(_.lat,ie.lat)),le.setBearing(u.bearing);const ge=new s.P(s.ag(i.centerPoint.x+u.offsetAsPoint.x,0,i.width),s.ag(i.centerPoint.y+u.offsetAsPoint.y,0,i.height));le.setLocationAtPoint(ne,ge);const Le=(u.offset&&u.offsetAsPoint.mag())>0?le.center:ne,ze=U?+u.zoom:g+Si(_.lat,Le.lat),Ne=g+Si(_.lat,0),Ge=ze+Si(Le.lat,0),Je=s.bz(_.lng,Le.lng),qe=s.bz(_.lat,Le.lat),at=s.ae(Ge-Ne);return K=ze!==g,{easeFunc:ct=>{if(s.bd(D,F)||Ni({startEulerAngles:D,endEulerAngles:F,tr:i,k:ct,useSlerp:D.roll!=F.roll}),Z&&i.interpolatePadding(M,u.padding,ct),u.around)s.w("Easing around a point is not supported under globe projection."),i.setLocationAtPoint(u.around,u.aroundPoint);else{const Ze=Ge>Ne?Math.min(2,at):Math.max(.5,at),pt=Math.pow(Ze,1-ct),Tt=Pu(_,Je,qe,ct*pt);i.setCenter(Tt.wrap())}if(K){const Ze=s.C.number(Ne,Ge,ct)+Si(0,i.center.lat);i.setZoom(Ze)}},isZooming:K,elevationCenter:Le}}handleFlyTo(i,u){const g=u.zoom!==void 0,_=i.center,M=i.zoom,D=i.padding,F=!i.isPaddingEqual(u.padding),U=i.getConstrained(s.S.convert(u.center||u.locationAtOffset),M).center,Z=g?+u.zoom:i.zoom+Si(i.center.lat,U.lat),K=i.clone();K.setCenter(U),K.setZoom(Z),K.setBearing(u.bearing);const ie=new s.P(s.ag(i.centerPoint.x+u.offsetAsPoint.x,0,i.width),s.ag(i.centerPoint.y+u.offsetAsPoint.y,0,i.height));K.setLocationAtPoint(U,ie);const ne=K.center;No(i,ne);const le=function(qe,at,ct){const Ze=ji(at),pt=ji(ct),Tt=s.aW(Ze,pt),Mt=Math.acos(Tt),Et=Yl(qe);return Mt/(2*Math.PI)*Et}(i,_,ne),ge=M+Si(_.lat,0),Le=Z+Si(ne.lat,0),ze=s.ae(Le-ge);let Ne;if(typeof u.minZoom=="number"){const qe=+u.minZoom+Si(ne.lat,0),at=Math.min(qe,ge,Le)+Si(0,ne.lat),ct=i.getConstrained(ne,at).zoom+Si(ne.lat,0);Ne=s.ae(ct-ge)}const Ge=s.bz(_.lng,ne.lng),Je=s.bz(_.lat,ne.lat);return{easeFunc:(qe,at,ct,Ze)=>{const pt=Pu(_,Ge,Je,ct);F&&i.interpolatePadding(D,u.padding,qe);const Tt=qe===1?ne:pt;i.setCenter(Tt.wrap());const Mt=ge+s.aj(at);i.setZoom(qe===1?Z:Mt+Si(0,Tt.lat))},scaleOfZoom:ze,targetCenter:ne,scaleOfMinZoom:Ne,pixelPathLength:le}}static solveVectorScale(i,u,g,_,M){const D=_==="x"?[g[0],g[4],g[8],g[12]]:[g[1],g[5],g[9],g[13]],F=[g[3],g[7],g[11],g[15]],U=i[0]*D[0]+i[1]*D[1]+i[2]*D[2],Z=i[0]*F[0]+i[1]*F[1]+i[2]*F[2],K=u[0]*D[0]+u[1]*D[1]+u[2]*D[2],ie=u[0]*F[0]+u[1]*F[1]+u[2]*F[2];return K+M*Z===U+M*ie||F[3]*(U-K)+D[3]*(ie-Z)+U*ie==K*Z?null:(K+D[3]-M*ie-M*F[3])/(K-U-M*ie+M*Z)}static getLesserNonNegativeNonNull(i,u){return u!==null&&u>=0&&u<i?u:i}}class Tp{constructor(i){this._globe=i,this._mercatorCameraHelper=new Oh,this._verticalPerspectiveCameraHelper=new Uo}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(i,u){return this.currentHelper.handlePanInertia(i,u)}handleMapControlsRollPitchBearingZoom(i,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(i,u)}handleMapControlsPan(i,u,g){this.currentHelper.handleMapControlsPan(i,u,g)}cameraForBoxAndBearing(i,u,g,_,M){return this.currentHelper.cameraForBoxAndBearing(i,u,g,_,M)}handleJumpToCenterZoom(i,u){this.currentHelper.handleJumpToCenterZoom(i,u)}handleEaseTo(i,u){return this.currentHelper.handleEaseTo(i,u)}handleFlyTo(i,u){return this.currentHelper.handleFlyTo(i,u)}}const Fh=(S,i)=>s.y(S,i&&i.filter(u=>u.identifier!=="source.canvas")),Ru=s.bD();class Pp extends s.E{constructor(i,u={}){super(),this._rtlPluginLoaded=()=>{for(const g in this.sourceCaches){const _=this.sourceCaches[g].getSource().type;_!=="vector"&&_!=="geojson"||this.sourceCaches[g].reload()}},this.map=i,this.dispatcher=new At(ft(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",(g,_)=>this.getGlyphs(g,_)),this.dispatcher.registerMessageHandler("GI",(g,_)=>this.getImages(g,_)),this.imageManager=new re,this.imageManager.setEventedParent(this),this.glyphManager=new Se(i._requestManager,u.localIdeographFontFamily),this.lineAtlas=new Ke(256,512),this.crossTileSymbolIndex=new Vi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",s.bF()),ln().on(Nt,this._rtlPluginLoaded),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const _=this.sourceCaches[g.sourceId];if(!_)return;const M=_.getSource();if(M&&M.vectorLayerIds)for(const D in this._layers){const F=this._layers[D];F.source===M.id&&this._validateLayer(F)}})}setGlobalStateProperty(i,u){var g,_,M;this._checkLoaded();const D=u===null?(M=(_=(g=this.stylesheet.state)===null||g===void 0?void 0:g[i])===null||_===void 0?void 0:_.default)!==null&&M!==void 0?M:null:u;if(s.bG(D,this._globalState[i]))return this;this._globalState[i]=D;const F=this._findGlobalStateAffectedSources([i]);for(const U in this.sourceCaches)F.has(U)&&(this._reloadSource(U),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(i){this._checkLoaded();const u=[];for(const _ in i)!s.bG(this._globalState[_],i[_].default)&&(u.push(_),this._globalState[_]=i[_].default);const g=this._findGlobalStateAffectedSources(u);for(const _ in this.sourceCaches)g.has(_)&&(this._reloadSource(_),this._changed=!0)}_findGlobalStateAffectedSources(i){if(i.length===0)return new Set;const u=new Set;for(const g in this._layers){const _=this._layers[g],M=_.getLayoutAffectingGlobalStateRefs();for(const D of i)M.has(D)&&u.add(_.source)}return u}loadURL(i,u={},g){this.fire(new s.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const _=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController;const M=this._loadStyleRequest;s.j(_,this._loadStyleRequest).then(D=>{this._loadStyleRequest=null,this._load(D.data,u,g)}).catch(D=>{this._loadStyleRequest=null,D&&!M.signal.aborted&&this.fire(new s.k(D))})}loadJSON(i,u={},g){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,E.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(i,u,g)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(Ru,{validate:!1})}_load(i,u,g){var _,M,D;const F=u.transformStyle?u.transformStyle(g,i):i;if(!u.validate||!Fh(this,s.z(F))){this._loaded=!0,this.stylesheet=F;for(const U in F.sources)this.addSource(U,F.sources[U],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs),this._createLayers(),this.light=new Me(this.stylesheet.light),this._setProjectionInternal(((_=this.stylesheet.projection)===null||_===void 0?void 0:_.type)||"mercator"),this.sky=new Ie(this.stylesheet.sky),this.map.setTerrain((M=this.stylesheet.terrain)!==null&&M!==void 0?M:null),this.setGlobalState((D=this.stylesheet.state)!==null&&D!==void 0?D:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){const i=s.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",i),this._order=i.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of i){const g=s.bI(u);g.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=g}}_loadSprite(i,u=!1,g=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(M,D,F,U){return s._(this,void 0,void 0,function*(){const Z=q(M),K=F>1?"@2x":"",ie={},ne={};for(const{id:le,url:ge}of Z){const Le=D.transformRequest(te(ge,K,".json"),"SpriteJSON");ie[le]=s.j(Le,U);const ze=D.transformRequest(te(ge,K,".png"),"SpriteImage");ne[le]=W.getImage(ze,U)}return yield Promise.all([...Object.values(ie),...Object.values(ne)]),function(le,ge){return s._(this,void 0,void 0,function*(){const Le={};for(const ze in le){Le[ze]={};const Ne=E.getImageCanvasContext((yield ge[ze]).data),Ge=(yield le[ze]).data;for(const Je in Ge){const{width:qe,height:at,x:ct,y:Ze,sdf:pt,pixelRatio:Tt,stretchX:Mt,stretchY:Et,content:Dt,textFitWidth:Sn,textFitHeight:wn}=Ge[Je];Le[ze][Je]={data:null,pixelRatio:Tt,sdf:pt,stretchX:Mt,stretchY:Et,content:Dt,textFitWidth:Sn,textFitHeight:wn,spriteData:{width:qe,height:at,x:ct,y:Ze,context:Ne}}}}return Le})}(ie,ne)})}(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(M=>{if(this._spriteRequest=null,M)for(const D in M){this._spritesImagesIds[D]=[];const F=this._spritesImagesIds[D]?this._spritesImagesIds[D].filter(U=>!(U in M)):[];for(const U of F)this.imageManager.removeImage(U),this._changedImages[U]=!0;for(const U in M[D]){const Z=D==="default"?U:`${D}:${U}`;this._spritesImagesIds[D].push(Z),Z in this.imageManager.images?this.imageManager.updateImage(Z,M[D][U],!1):this.imageManager.addImage(Z,M[D][U]),u&&(this._changedImages[Z]=!0)}}}).catch(M=>{this._spriteRequest=null,_=M,this.fire(new s.k(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),g&&g(_)})}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(i){const u=this.sourceCaches[i.source];if(!u)return;const g=i.sourceLayer;if(!g)return;const _=u.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(g)===-1)&&this.fire(new s.k(new Error(`Source layer "${g}" does not exist on source "${_.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i,u=!1){const g=this._serializedAllLayers();if(!i||i.length===0)return Object.values(u?s.bJ(g):g);const _=[];for(const M of i)if(g[M]){const D=u?s.bJ(g[M]):g[M];_.push(D)}return _}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const u=Object.keys(this._layers);for(const g of u){const _=this._layers[g];_.type!=="custom"&&(i[g]=_.serialize())}return i}hasTransitions(){var i,u,g;if(!((i=this.light)===null||i===void 0)&&i.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((g=this.projection)===null||g===void 0)&&g.hasTransition())return!0;for(const _ in this.sourceCaches)if(this.sourceCaches[_].hasTransition())return!0;for(const _ in this._layers)if(this._layers[_].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const u=this._changed;if(u){const _=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);(_.length||M.length)&&this._updateWorkerLayers(_,M);for(const D in this._updatedSources){const F=this._updatedSources[D];if(F==="reload")this._reloadSource(D);else{if(F!=="clear")throw new Error(`Invalid action ${F}`);this._clearSource(D)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(i);this.light.updateTransitions(i),this.sky.updateTransitions(i),this._resetUpdates()}const g={};for(const _ in this.sourceCaches){const M=this.sourceCaches[_];g[_]=M.used,M.used=!1}for(const _ of this._order){const M=this._layers[_];M.recalculate(i,this._availableImages),!M.isHidden(i.zoom)&&M.source&&(this.sourceCaches[M.source].used=!0)}for(const _ in g){const M=this.sourceCaches[_];!!g[_]!=!!M.used&&M.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(i),this.sky.recalculate(i),this.projection.recalculate(i),this.z=i.zoom,u&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,u={}){var g;this._checkLoaded();const _=this.serialize();if(i=u.transformStyle?u.transformStyle(_,i):i,((g=u.validate)===null||g===void 0||g)&&Fh(this,s.z(i)))return!1;(i=s.bJ(i)).layers=s.bH(i.layers);const M=s.bK(_,i),D=this._getOperationsToPerform(M);if(D.unimplemented.length>0)throw new Error(`Unimplemented: ${D.unimplemented.join(", ")}.`);if(D.operations.length===0)return!1;for(const F of D.operations)F();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){const u=[],g=[];for(const _ of i)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":u.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":u.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setSky":u.push(()=>this.setSky.apply(this,_.args));break;case"setProjection":this.setProjection.apply(this,_.args);break;case"setGlobalState":u.push(()=>this.setGlobalState.apply(this,_.args));break;case"setTransition":u.push(()=>{});break;default:g.push(_.command)}return{operations:u,unimplemented:g}}addImage(i,u){if(this.getImage(i))return this.fire(new s.k(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,u),this._afterImageUpdated(i)}updateImage(i,u){this.imageManager.updateImage(i,u)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new s.k(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,u,g={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.z.source,`sources.${i}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const _=this.sourceCaches[i]=new ut(i,u,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:i})),_.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===i)return this.fire(new s.k(new Error(`Source "${i}" cannot be removed while layer "${g}" is using it.`)));const u=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],u.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,u){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const g=this.sourceCaches[i].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(u),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,u,g={}){this._checkLoaded();const _=i.id;if(this.getLayer(_))return void this.fire(new s.k(new Error(`Layer "${_}" already exists on this map.`)));let M;if(i.type==="custom"){if(Fh(this,s.bL(i)))return;M=s.bI(i)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(_,i.source),i=s.bJ(i),i=s.e(i,{source:_})),this._validate(s.z.layer,`layers.${_}`,i,{arrayIndex:-1},g))return;M=s.bI(i),this._validateLayer(M),M.setEventedParent(this,{layer:{id:_}})}const D=u?this._order.indexOf(u):this._order.length;if(u&&D===-1)this.fire(new s.k(new Error(`Cannot add layer "${_}" before non-existing layer "${u}".`)));else{if(this._order.splice(D,0,_),this._layerOrderChanged=!0,this._layers[_]=M,this._removedLayers[_]&&M.source&&M.type!=="custom"){const F=this._removedLayers[_];delete this._removedLayers[_],F.type!==M.type?this._updatedSources[M.source]="clear":(this._updatedSources[M.source]="reload",this.sourceCaches[M.source].pause())}this._updateLayer(M),M.onAdd&&M.onAdd(this.map)}}moveLayer(i,u){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new s.k(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===u)return;const g=this._order.indexOf(i);this._order.splice(g,1);const _=u?this._order.indexOf(u):this._order.length;u&&_===-1?this.fire(new s.k(new Error(`Cannot move layer "${i}" before non-existing layer "${u}".`))):(this._order.splice(_,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const u=this._layers[i];if(!u)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${i}".`)));u.setEventedParent(null);const g=this._order.indexOf(i);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=u,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],u.onRemove&&u.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,u,g){this._checkLoaded();const _=this.getLayer(i);_?_.minzoom===u&&_.maxzoom===g||(u!=null&&(_.minzoom=u),g!=null&&(_.maxzoom=g),this._updateLayer(_)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,u,g={}){this._checkLoaded();const _=this.getLayer(i);if(_){if(!s.bG(_.filter,u))return u==null?(_.setFilter(void 0),void this._updateLayer(_)):void(this._validate(s.z.filter,`layers.${_.id}.filter`,u,null,g)||(_.setFilter(s.bJ(u)),this._updateLayer(_)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return s.bJ(this.getLayer(i).filter)}setLayoutProperty(i,u,g,_={}){this._checkLoaded();const M=this.getLayer(i);M?s.bG(M.getLayoutProperty(u),g)||(M.setLayoutProperty(u,g,_),this._updateLayer(M)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,u){const g=this.getLayer(i);if(g)return g.getLayoutProperty(u);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,u,g,_={}){this._checkLoaded();const M=this.getLayer(i);M?s.bG(M.getPaintProperty(u),g)||(M.setPaintProperty(u,g,_)&&this._updateLayer(M),this._changed=!0,this._updatedPaintProps[i]=!0,this._serializedLayers=null):this.fire(new s.k(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,u){return this.getLayer(i).getPaintProperty(u)}setFeatureState(i,u){this._checkLoaded();const g=i.source,_=i.sourceLayer,M=this.sourceCaches[g];if(M===void 0)return void this.fire(new s.k(new Error(`The source '${g}' does not exist in the map's style.`)));const D=M.getSource().type;D==="geojson"&&_?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):D!=="vector"||_?(i.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),M.setFeatureState(_,i.id,u)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,u){this._checkLoaded();const g=i.source,_=this.sourceCaches[g];if(_===void 0)return void this.fire(new s.k(new Error(`The source '${g}' does not exist in the map's style.`)));const M=_.getSource().type,D=M==="vector"?i.sourceLayer:void 0;M!=="vector"||D?u&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(D,i.id,u):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const u=i.source,g=i.sourceLayer,_=this.sourceCaches[u];if(_!==void 0)return _.getSource().type!=="vector"||g?(i.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),_.getFeatureState(g,i.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=s.bM(this.sourceCaches,M=>M.serialize()),u=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,_=this.stylesheet;return s.bN({version:_.version,name:_.name,metadata:_.metadata,light:_.light,sky:_.sky,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,projection:_.projection,sources:i,layers:u,terrain:g},M=>M!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const u=D=>this._layers[D].type==="fill-extrusion",g={},_=[];for(let D=this._order.length-1;D>=0;D--){const F=this._order[D];if(u(F)){g[F]=D;for(const U of i){const Z=U[F];if(Z)for(const K of Z)_.push(K)}}}_.sort((D,F)=>F.intersectionZ-D.intersectionZ);const M=[];for(let D=this._order.length-1;D>=0;D--){const F=this._order[D];if(u(F))for(let U=_.length-1;U>=0;U--){const Z=_[U].feature;if(g[Z.layer.id]<D)break;M.push(Z),_.pop()}else for(const U of i){const Z=U[F];if(Z)for(const K of Z)M.push(K.feature)}}return M}queryRenderedFeatures(i,u,g){u&&u.filter&&this._validate(s.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const _={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const Z of u.layers){const K=this._layers[Z];if(!K)return this.fire(new s.k(new Error(`The layer '${Z}' does not exist in the map's style and cannot be queried for features.`))),[];_[K.source]=!0}}const M=[];u.availableImages=this._availableImages;const D=this._serializedAllLayers(),F=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,U=Object.assign(Object.assign({},u),{layers:F});for(const Z in this.sourceCaches)u.layers&&!_[Z]||M.push(bt(this.sourceCaches[Z],this._layers,D,i,U,g,this.map.terrain?(K,ie,ne)=>this.map.terrain.getElevation(K,ie,ne):void 0));return this.placement&&M.push(function(Z,K,ie,ne,le,ge,Le){const ze={},Ne=ge.queryRenderedSymbols(ne),Ge=[];for(const Je of Object.keys(Ne).map(Number))Ge.push(Le[Je]);Ge.sort(St);for(const Je of Ge){const qe=Je.featureIndex.lookupSymbolFeatures(Ne[Je.bucketInstanceId],K,Je.bucketIndex,Je.sourceLayerIndex,le.filter,le.layers,le.availableImages,Z);for(const at in qe){const ct=ze[at]=ze[at]||[],Ze=qe[at];Ze.sort((pt,Tt)=>{const Mt=Je.featureSortOrder;if(Mt){const Et=Mt.indexOf(pt.featureIndex);return Mt.indexOf(Tt.featureIndex)-Et}return Tt.featureIndex-pt.featureIndex});for(const pt of Ze)ct.push(pt)}}return function(Je,qe,at){for(const ct in Je)for(const Ze of Je[ct])dn(Ze,at[qe[ct].source]);return Je}(ze,Z,ie)}(this._layers,D,this.sourceCaches,i,U,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(M)}querySourceFeatures(i,u){u&&u.filter&&this._validate(s.z.filter,"querySourceFeatures.filter",u.filter,null,u);const g=this.sourceCaches[i];return g?function(_,M){const D=_.getRenderableIds().map(Z=>_.getTileByID(Z)),F=[],U={};for(let Z=0;Z<D.length;Z++){const K=D[Z],ie=K.tileID.canonical.key;U[ie]||(U[ie]=!0,K.querySourceFeatures(F,M))}return F}(g,u):[]}getLight(){return this.light.getLight()}setLight(i,u={}){this._checkLoaded();const g=this.light.getLight();let _=!1;for(const D in i)if(!s.bG(i[D],g[D])){_=!0;break}if(!_)return;const M={now:E.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,u),this.light.updateTransitions(M)}getProjection(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.projection}setProjection(i){if(this._checkLoaded(),this.projection){if(this.projection.name===i.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=i,this._setProjectionInternal(i.type)}getSky(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.sky}setSky(i,u={}){this._checkLoaded();const g=this.getSky();let _=!1;if(!i&&!g)return;if(i&&!g)_=!0;else if(!i&&g)_=!0;else for(const D in i)if(!s.bG(i[D],g[D])){_=!0;break}if(!_)return;const M={now:E.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=i,this.sky.setSky(i,u),this.sky.updateTransitions(M)}_setProjectionInternal(i){const u=function(g){if(Array.isArray(g)){const _=new Fc({type:g});return{projection:_,transform:new Ls,cameraHelper:new Tp(_)}}switch(g){case"mercator":return{projection:new zh,transform:new Zi,cameraHelper:new Oh};case"globe":{const _=new Fc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:_,transform:new Ls,cameraHelper:new Tp(_)}}case"vertical-perspective":return{projection:new Cp,transform:new Iu,cameraHelper:new Uo};default:return s.w(`Unknown projection name: ${g}. Falling back to mercator projection.`),{projection:new zh,transform:new Zi,cameraHelper:new Oh}}}(i);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const g in this.sourceCaches)this.sourceCaches[g].reload()}_validate(i,u,g,_,M={}){return(!M||M.validate!==!1)&&Fh(this,i.call(s.z,s.e({key:u,style:this.serialize(),value:g,styleSpec:s.v},_)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ln().off(Nt,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const g=this.sourceCaches[u];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const u in this.sourceCaches)this.sourceCaches[u].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,u,g,_,M=!1){let D=!1,F=!1;const U={};for(const Z of this._order){const K=this._layers[Z];if(K.type!=="symbol")continue;if(!U[K.source]){const ne=this.sourceCaches[K.source];U[K.source]=ne.getRenderableIds(!0).map(le=>ne.getTileByID(le)).sort((le,ge)=>ge.tileID.overscaledZ-le.tileID.overscaledZ||(le.tileID.isLessThan(ge.tileID)?-1:1))}const ie=this.crossTileSymbolIndex.addLayer(K,U[K.source],i.center.lng);D=D||ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((M=M||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(E.now(),i.zoom))&&(this.pauseablePlacement=new Ia(i,this.map.terrain,this._order,M,u,g,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(E.now()),F=!0),D&&this.pauseablePlacement.placement.setStale()),F||D)for(const Z of this._order){const K=this._layers[Z];K.type==="symbol"&&this.placement.updateLayerOpacities(K,U[K.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(E.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,u){return s._(this,void 0,void 0,function*(){const g=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[u.source];return _&&_.setDependencies(u.tileID.key,u.type,u.icons),g})}getGlyphs(i,u){return s._(this,void 0,void 0,function*(){const g=yield this.glyphManager.getGlyphs(u.stacks),_=this.sourceCaches[u.source];return _&&_.setDependencies(u.tileID.key,u.type,[""]),g})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,u={}){this._checkLoaded(),i&&this._validate(s.z.glyphs,"glyphs",i,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}addSprite(i,u,g={},_){this._checkLoaded();const M=[{id:i,url:u}],D=[...q(this.stylesheet.sprite),...M];this._validate(s.z.sprite,"sprite",D,null,g)||(this.stylesheet.sprite=D,this._loadSprite(M,!0,_))}removeSprite(i){this._checkLoaded();const u=q(this.stylesheet.sprite);if(u.find(g=>g.id===i)){if(this._spritesImagesIds[i])for(const g of this._spritesImagesIds[i])this.imageManager.removeImage(g),this._changedImages[g]=!0;u.splice(u.findIndex(g=>g.id===i),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return q(this.stylesheet.sprite)}setSprite(i,u={},g){this._checkLoaded(),i&&this._validate(s.z.sprite,"sprite",i,null,u)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,g):(this._unloadSprite(),g&&g(null)))}}var vy=s.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class eg{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,u,g,_,M,D,F,U,Z){this.context=i;let K=this.boundPaintVertexBuffers.length!==_.length;for(let ie=0;!K&&ie<_.length;ie++)this.boundPaintVertexBuffers[ie]!==_[ie]&&(K=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||K||this.boundIndexBuffer!==M||this.boundVertexOffset!==D||this.boundDynamicVertexBuffer!==F||this.boundDynamicVertexBuffer2!==U||this.boundDynamicVertexBuffer3!==Z?this.freshBind(u,g,_,M,D,F,U,Z):(i.bindVertexArray.set(this.vao),F&&F.bind(),M&&M.dynamicDraw&&M.bind(),U&&U.bind(),Z&&Z.bind())}freshBind(i,u,g,_,M,D,F,U){const Z=i.numAttributes,K=this.context,ie=K.gl;this.vao&&this.destroy(),this.vao=K.createVertexArray(),K.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=_,this.boundVertexOffset=M,this.boundDynamicVertexBuffer=D,this.boundDynamicVertexBuffer2=F,this.boundDynamicVertexBuffer3=U,u.enableAttributes(ie,i);for(const ne of g)ne.enableAttributes(ie,i);D&&D.enableAttributes(ie,i),F&&F.enableAttributes(ie,i),U&&U.enableAttributes(ie,i),u.bind(),u.setVertexAttribPointers(ie,i,M);for(const ne of g)ne.bind(),ne.setVertexAttribPointers(ie,i,M);D&&(D.bind(),D.setVertexAttribPointers(ie,i,M)),_&&_.bind(),F&&(F.bind(),F.setVertexAttribPointers(ie,i,M)),U&&(U.bind(),U.setVertexAttribPointers(ie,i,M)),K.currentNumAttributes=Z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const yy=(S,i,u,g,_)=>({u_texture:0,u_ele_delta:S,u_fog_matrix:i,u_fog_color:u?u.properties.get("fog-color"):s.be.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:_?0:u?u.calculateFogBlendOpacity(g):0,u_horizon_color:u?u.properties.get("horizon-color"):s.be.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:_?1:0}),_y={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function nf(S){const i=[];for(let u=0;u<S.length;u++){if(S[u]===null)continue;const g=S[u].split(" ");i.push(g.pop())}return i}class rf{constructor(i,u,g,_,M,D,F,U,Z=[]){const K=i.gl;this.program=K.createProgram();const ie=nf(u.staticAttributes),ne=g?g.getBinderAttributes():[],le=ie.concat(ne),ge=io.prelude.staticUniforms?nf(io.prelude.staticUniforms):[],Le=F.staticUniforms?nf(F.staticUniforms):[],ze=u.staticUniforms?nf(u.staticUniforms):[],Ne=g?g.getBinderUniforms():[],Ge=ge.concat(Le).concat(ze).concat(Ne),Je=[];for(const Mt of Ge)Je.indexOf(Mt)<0&&Je.push(Mt);const qe=g?g.defines():[];ts(K)&&qe.unshift("#version 300 es"),M&&qe.push("#define OVERDRAW_INSPECTOR;"),D&&qe.push("#define TERRAIN3D;"),U&&qe.push(U),Z&&qe.push(...Z);let at=qe.concat(io.prelude.fragmentSource,F.fragmentSource,u.fragmentSource).join(`
`),ct=qe.concat(io.prelude.vertexSource,F.vertexSource,u.vertexSource).join(`
`);ts(K)||(at=function(Mt){return Mt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(at),ct=function(Mt){return Mt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ct));const Ze=K.createShader(K.FRAGMENT_SHADER);if(K.isContextLost())return void(this.failedToCreate=!0);if(K.shaderSource(Ze,at),K.compileShader(Ze),!K.getShaderParameter(Ze,K.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${K.getShaderInfoLog(Ze)}`);K.attachShader(this.program,Ze);const pt=K.createShader(K.VERTEX_SHADER);if(K.isContextLost())return void(this.failedToCreate=!0);if(K.shaderSource(pt,ct),K.compileShader(pt),!K.getShaderParameter(pt,K.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${K.getShaderInfoLog(pt)}`);K.attachShader(this.program,pt),this.attributes={};const Tt={};this.numAttributes=le.length;for(let Mt=0;Mt<this.numAttributes;Mt++)le[Mt]&&(K.bindAttribLocation(this.program,Mt,le[Mt]),this.attributes[le[Mt]]=Mt);if(K.linkProgram(this.program),!K.getProgramParameter(this.program,K.LINK_STATUS))throw new Error(`Program failed to link: ${K.getProgramInfoLog(this.program)}`);K.deleteShader(pt),K.deleteShader(Ze);for(let Mt=0;Mt<Je.length;Mt++){const Et=Je[Mt];if(Et&&!Tt[Et]){const Dt=K.getUniformLocation(this.program,Et);Dt&&(Tt[Et]=Dt)}}this.fixedUniforms=_(i,Tt),this.terrainUniforms=((Mt,Et)=>({u_depth:new s.bO(Mt,Et.u_depth),u_terrain:new s.bO(Mt,Et.u_terrain),u_terrain_dim:new s.bf(Mt,Et.u_terrain_dim),u_terrain_matrix:new s.bQ(Mt,Et.u_terrain_matrix),u_terrain_unpack:new s.bR(Mt,Et.u_terrain_unpack),u_terrain_exaggeration:new s.bf(Mt,Et.u_terrain_exaggeration)}))(i,Tt),this.projectionUniforms=((Mt,Et)=>({u_projection_matrix:new s.bQ(Mt,Et.u_projection_matrix),u_projection_tile_mercator_coords:new s.bR(Mt,Et.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.bR(Mt,Et.u_projection_clipping_plane),u_projection_transition:new s.bf(Mt,Et.u_projection_transition),u_projection_fallback_matrix:new s.bQ(Mt,Et.u_projection_fallback_matrix)}))(i,Tt),this.binderUniforms=g?g.getUniforms(i,Tt):[]}draw(i,u,g,_,M,D,F,U,Z,K,ie,ne,le,ge,Le,ze,Ne,Ge,Je){const qe=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(g),i.setStencilMode(_),i.setColorMode(M),i.setCullFace(D),U){i.activeTexture.set(qe.TEXTURE2),qe.bindTexture(qe.TEXTURE_2D,U.depthTexture),i.activeTexture.set(qe.TEXTURE3),qe.bindTexture(qe.TEXTURE_2D,U.texture);for(const ct in this.terrainUniforms)this.terrainUniforms[ct].set(U[ct])}if(Z)for(const ct in Z)this.projectionUniforms[_y[ct]].set(Z[ct]);if(F)for(const ct in this.fixedUniforms)this.fixedUniforms[ct].set(F[ct]);ze&&ze.setUniforms(i,this.binderUniforms,ge,{zoom:Le});let at=0;switch(u){case qe.LINES:at=2;break;case qe.TRIANGLES:at=3;break;case qe.LINE_STRIP:at=1}for(const ct of le.get()){const Ze=ct.vaos||(ct.vaos={});(Ze[K]||(Ze[K]=new eg)).bind(i,this,ie,ze?ze.getPaintVertexBuffers():[],ne,ct.vertexOffset,Ne,Ge,Je),qe.drawElements(u,ct.primitiveLength*at,qe.UNSIGNED_SHORT,ct.primitiveOffset*at*2)}}}function Lu(S,i,u){const g=1/s.aB(u,1,i.transform.tileZoom),_=Math.pow(2,u.tileID.overscaledZ),M=u.tileSize*Math.pow(2,i.transform.tileZoom)/_,D=M*(u.tileID.canonical.x+u.tileID.wrap*_),F=M*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[g,S.fromScale,S.toScale],u_fade:S.t,u_pixel_coord_upper:[D>>16,F>>16],u_pixel_coord_lower:[65535&D,65535&F]}}const Nh=(S,i,u,g)=>{const _=S.style.light,M=_.properties.get("position"),D=[M.x,M.y,M.z],F=s.bU();_.properties.get("anchor")==="viewport"&&s.bV(F,S.transform.bearingInRadians),s.bW(D,D,F);const U=S.transform.transformLightDirection(D),Z=_.properties.get("color");return{u_lightpos:D,u_lightpos_globe:U,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+i,u_opacity:u,u_fill_translate:g}},Ap=(S,i,u,g,_,M,D)=>s.e(Nh(S,i,u,g),Lu(M,S,D),{u_height_factor:-Math.pow(2,_.overscaledZ)/D.tileSize/8}),of=(S,i,u,g)=>s.e(Lu(i,S,u),{u_fill_translate:g}),da=(S,i)=>({u_world:S,u_fill_translate:i}),xy=(S,i,u,g,_)=>s.e(of(S,i,u,_),{u_world:g}),Ip=(S,i,u,g,_)=>{const M=S.transform;let D,F,U=0;if(u.paint.get("circle-pitch-alignment")==="map"){const Z=s.aB(i,1,M.zoom);D=!0,F=[Z,Z],U=Z/(s.$*Math.pow(2,i.tileID.overscaledZ))*2*Math.PI*_}else D=!1,F=M.pixelsToGLUnits;return{u_camera_to_center_distance:M.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+D,u_device_pixel_ratio:S.pixelRatio,u_extrude_scale:F,u_globe_extrude_scale:U,u_translate:g}},Bh=S=>({u_pixel_extrude_scale:[1/S.width,1/S.height]}),Uh=S=>({u_viewport_size:[S.width,S.height]}),tg=(S,i=1)=>({u_color:S,u_overlay:0,u_overlay_scale:i}),$h=(S,i,u,g)=>{const _=s.aB(S,1,i)/(s.$*Math.pow(2,S.tileID.overscaledZ))*2*Math.PI*g;return{u_extrude_scale:s.aB(S,1,i),u_intensity:u,u_globe_extrude_scale:_}},ng=(S,i,u,g)=>{const _=s.L();s.bX(_,0,S.width,S.height,0,0,1);const M=S.context.gl;return{u_matrix:_,u_world:[M.drawingBufferWidth,M.drawingBufferHeight],u_image:u,u_color_ramp:g,u_opacity:i.paint.get("heatmap-opacity")}},Kl=(S,i,u)=>{const g=u.paint.get("hillshade-accent-color");let _;switch(u.paint.get("hillshade-method")){case"basic":_=4;break;case"combined":_=1;break;case"igor":_=2;break;case"multidirectional":_=3;break;default:_=0}const M=u.getIlluminationProperties();for(let D=0;D<M.directionRadians.length;D++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(M.directionRadians[D]+=S.transform.bearingInRadians);return{u_image:0,u_latrange:rg(0,i.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:M.altitudeRadians,u_azimuths:M.directionRadians,u_accent:g,u_method:_,u_highlights:M.highlightColor,u_shadows:M.shadowColor}},Vh=(S,i)=>{const u=i.stride,g=s.L();return s.bX(g,0,s.$,-s.$,0,0,1),s.M(g,g,[0,-s.$,0]),{u_matrix:g,u_image:1,u_dimension:[u,u],u_zoom:S.overscaledZ,u_unpack:i.getUnpackVector()}};function rg(S,i){const u=Math.pow(2,i.canonical.z),g=i.canonical.y;return[new s.a0(0,g/u).toLngLat().lat,new s.a0(0,(g+1)/u).toLngLat().lat]}const ig=(S,i,u=0)=>({u_image:0,u_unpack:i.getUnpackVector(),u_dimension:[i.stride,i.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:S.paint.get("color-relief-opacity")}),jh=(S,i,u,g)=>{const _=S.transform;return{u_translation:Dp(S,i,u),u_ratio:g/s.aB(i,1,_.zoom),u_device_pixel_ratio:S.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},sf=(S,i,u,g,_)=>s.e(jh(S,i,u,g),{u_image:0,u_image_height:_}),Rp=(S,i,u,g,_)=>{const M=S.transform,D=Jl(i,M);return{u_translation:Dp(S,i,u),u_texsize:i.imageAtlasTexture.size,u_ratio:g/s.aB(i,1,M.zoom),u_device_pixel_ratio:S.pixelRatio,u_image:0,u_scale:[D,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}},Lp=(S,i,u,g,_,M)=>{const D=S.lineAtlas,F=Jl(i,S.transform),U=u.layout.get("line-cap")==="round",Z=D.getDash(_.from,U),K=D.getDash(_.to,U),ie=Z.width*M.fromScale,ne=K.width*M.toScale;return s.e(jh(S,i,u,g),{u_patternscale_a:[F/ie,-Z.height/2],u_patternscale_b:[F/ne,-K.height/2],u_sdfgamma:D.width/(256*Math.min(ie,ne)*S.pixelRatio)/2,u_image:0,u_tex_y_a:Z.y,u_tex_y_b:K.y,u_mix:M.t})};function Jl(S,i){return 1/s.aB(S,1,i.tileZoom)}function Dp(S,i,u){return s.aC(S.transform,i,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Bc=(S,i,u,g,_)=>{return{u_tl_parent:S,u_scale_parent:i,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(D=g.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(M=g.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:og(g.paint.get("raster-hue-rotate")),u_coords_top:[_[0].x,_[0].y,_[1].x,_[1].y],u_coords_bottom:[_[3].x,_[3].y,_[2].x,_[2].y]};var M,D};function og(S){S*=Math.PI/180;const i=Math.sin(S),u=Math.cos(S);return[(2*u+1)/3,(-Math.sqrt(3)*i-u+1)/3,(Math.sqrt(3)*i-u+1)/3]}const af=(S,i,u,g,_,M,D,F,U,Z,K,ie,ne)=>{const le=D.transform;return{u_is_size_zoom_constant:+(S==="constant"||S==="source"),u_is_size_feature_constant:+(S==="constant"||S==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:le.cameraToCenterDistance,u_pitch:le.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:le.width/le.height,u_fade_change:D.options.fadeDuration?D.symbolFadeChange:1,u_label_plane_matrix:F,u_coord_matrix:U,u_is_text:+K,u_pitch_with_map:+g,u_is_along_line:_,u_is_variable_anchor:M,u_texsize:ie,u_texture:0,u_translation:Z,u_pitched_scale:ne}},Uc=(S,i,u,g,_,M,D,F,U,Z,K,ie,ne,le)=>{const ge=D.transform;return s.e(af(S,i,u,g,_,M,D,F,U,Z,K,ie,le),{u_gamma_scale:g?Math.cos(ge.pitch*Math.PI/180)*ge.cameraToCenterDistance:1,u_device_pixel_ratio:D.pixelRatio,u_is_halo:1})},Hh=(S,i,u,g,_,M,D,F,U,Z,K,ie,ne)=>s.e(Uc(S,i,u,g,_,M,D,F,U,Z,!0,K,0,ne),{u_texsize_icon:ie,u_texture_icon:1}),Ql=(S,i)=>({u_opacity:S,u_color:i}),by=(S,i,u,g,_)=>s.e(function(M,D,F,U){const Z=F.imageManager.getPattern(M.from.toString()),K=F.imageManager.getPattern(M.to.toString()),{width:ie,height:ne}=F.imageManager.getPixelSize(),le=Math.pow(2,U.tileID.overscaledZ),ge=U.tileSize*Math.pow(2,F.transform.tileZoom)/le,Le=ge*(U.tileID.canonical.x+U.tileID.wrap*le),ze=ge*U.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:K.tl,u_pattern_br_b:K.br,u_texsize:[ie,ne],u_mix:D.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:K.displaySize,u_scale_a:D.fromScale,u_scale_b:D.toScale,u_tile_units_to_pixels:1/s.aB(U,1,F.transform.tileZoom),u_pixel_coord_upper:[Le>>16,ze>>16],u_pixel_coord_lower:[65535&Le,65535&ze]}}(u,_,i,g),{u_opacity:S}),Gh=(S,i)=>{},sg={fillExtrusion:(S,i)=>({u_lightpos:new s.bS(S,i.u_lightpos),u_lightpos_globe:new s.bS(S,i.u_lightpos_globe),u_lightintensity:new s.bf(S,i.u_lightintensity),u_lightcolor:new s.bS(S,i.u_lightcolor),u_vertical_gradient:new s.bf(S,i.u_vertical_gradient),u_opacity:new s.bf(S,i.u_opacity),u_fill_translate:new s.bT(S,i.u_fill_translate)}),fillExtrusionPattern:(S,i)=>({u_lightpos:new s.bS(S,i.u_lightpos),u_lightpos_globe:new s.bS(S,i.u_lightpos_globe),u_lightintensity:new s.bf(S,i.u_lightintensity),u_lightcolor:new s.bS(S,i.u_lightcolor),u_vertical_gradient:new s.bf(S,i.u_vertical_gradient),u_height_factor:new s.bf(S,i.u_height_factor),u_opacity:new s.bf(S,i.u_opacity),u_fill_translate:new s.bT(S,i.u_fill_translate),u_image:new s.bO(S,i.u_image),u_texsize:new s.bT(S,i.u_texsize),u_pixel_coord_upper:new s.bT(S,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(S,i.u_pixel_coord_lower),u_scale:new s.bS(S,i.u_scale),u_fade:new s.bf(S,i.u_fade)}),fill:(S,i)=>({u_fill_translate:new s.bT(S,i.u_fill_translate)}),fillPattern:(S,i)=>({u_image:new s.bO(S,i.u_image),u_texsize:new s.bT(S,i.u_texsize),u_pixel_coord_upper:new s.bT(S,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(S,i.u_pixel_coord_lower),u_scale:new s.bS(S,i.u_scale),u_fade:new s.bf(S,i.u_fade),u_fill_translate:new s.bT(S,i.u_fill_translate)}),fillOutline:(S,i)=>({u_world:new s.bT(S,i.u_world),u_fill_translate:new s.bT(S,i.u_fill_translate)}),fillOutlinePattern:(S,i)=>({u_world:new s.bT(S,i.u_world),u_image:new s.bO(S,i.u_image),u_texsize:new s.bT(S,i.u_texsize),u_pixel_coord_upper:new s.bT(S,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(S,i.u_pixel_coord_lower),u_scale:new s.bS(S,i.u_scale),u_fade:new s.bf(S,i.u_fade),u_fill_translate:new s.bT(S,i.u_fill_translate)}),circle:(S,i)=>({u_camera_to_center_distance:new s.bf(S,i.u_camera_to_center_distance),u_scale_with_map:new s.bO(S,i.u_scale_with_map),u_pitch_with_map:new s.bO(S,i.u_pitch_with_map),u_extrude_scale:new s.bT(S,i.u_extrude_scale),u_device_pixel_ratio:new s.bf(S,i.u_device_pixel_ratio),u_globe_extrude_scale:new s.bf(S,i.u_globe_extrude_scale),u_translate:new s.bT(S,i.u_translate)}),collisionBox:(S,i)=>({u_pixel_extrude_scale:new s.bT(S,i.u_pixel_extrude_scale)}),collisionCircle:(S,i)=>({u_viewport_size:new s.bT(S,i.u_viewport_size)}),debug:(S,i)=>({u_color:new s.bP(S,i.u_color),u_overlay:new s.bO(S,i.u_overlay),u_overlay_scale:new s.bf(S,i.u_overlay_scale)}),depth:Gh,clippingMask:Gh,heatmap:(S,i)=>({u_extrude_scale:new s.bf(S,i.u_extrude_scale),u_intensity:new s.bf(S,i.u_intensity),u_globe_extrude_scale:new s.bf(S,i.u_globe_extrude_scale)}),heatmapTexture:(S,i)=>({u_matrix:new s.bQ(S,i.u_matrix),u_world:new s.bT(S,i.u_world),u_image:new s.bO(S,i.u_image),u_color_ramp:new s.bO(S,i.u_color_ramp),u_opacity:new s.bf(S,i.u_opacity)}),hillshade:(S,i)=>({u_image:new s.bO(S,i.u_image),u_latrange:new s.bT(S,i.u_latrange),u_exaggeration:new s.bf(S,i.u_exaggeration),u_altitudes:new s.bZ(S,i.u_altitudes),u_azimuths:new s.bZ(S,i.u_azimuths),u_accent:new s.bP(S,i.u_accent),u_method:new s.bO(S,i.u_method),u_shadows:new s.bY(S,i.u_shadows),u_highlights:new s.bY(S,i.u_highlights)}),hillshadePrepare:(S,i)=>({u_matrix:new s.bQ(S,i.u_matrix),u_image:new s.bO(S,i.u_image),u_dimension:new s.bT(S,i.u_dimension),u_zoom:new s.bf(S,i.u_zoom),u_unpack:new s.bR(S,i.u_unpack)}),colorRelief:(S,i)=>({u_image:new s.bO(S,i.u_image),u_unpack:new s.bR(S,i.u_unpack),u_dimension:new s.bT(S,i.u_dimension),u_elevation_stops:new s.bO(S,i.u_elevation_stops),u_color_stops:new s.bO(S,i.u_color_stops),u_color_ramp_size:new s.bO(S,i.u_color_ramp_size),u_opacity:new s.bf(S,i.u_opacity)}),line:(S,i)=>({u_translation:new s.bT(S,i.u_translation),u_ratio:new s.bf(S,i.u_ratio),u_device_pixel_ratio:new s.bf(S,i.u_device_pixel_ratio),u_units_to_pixels:new s.bT(S,i.u_units_to_pixels)}),lineGradient:(S,i)=>({u_translation:new s.bT(S,i.u_translation),u_ratio:new s.bf(S,i.u_ratio),u_device_pixel_ratio:new s.bf(S,i.u_device_pixel_ratio),u_units_to_pixels:new s.bT(S,i.u_units_to_pixels),u_image:new s.bO(S,i.u_image),u_image_height:new s.bf(S,i.u_image_height)}),linePattern:(S,i)=>({u_translation:new s.bT(S,i.u_translation),u_texsize:new s.bT(S,i.u_texsize),u_ratio:new s.bf(S,i.u_ratio),u_device_pixel_ratio:new s.bf(S,i.u_device_pixel_ratio),u_image:new s.bO(S,i.u_image),u_units_to_pixels:new s.bT(S,i.u_units_to_pixels),u_scale:new s.bS(S,i.u_scale),u_fade:new s.bf(S,i.u_fade)}),lineSDF:(S,i)=>({u_translation:new s.bT(S,i.u_translation),u_ratio:new s.bf(S,i.u_ratio),u_device_pixel_ratio:new s.bf(S,i.u_device_pixel_ratio),u_units_to_pixels:new s.bT(S,i.u_units_to_pixels),u_patternscale_a:new s.bT(S,i.u_patternscale_a),u_patternscale_b:new s.bT(S,i.u_patternscale_b),u_sdfgamma:new s.bf(S,i.u_sdfgamma),u_image:new s.bO(S,i.u_image),u_tex_y_a:new s.bf(S,i.u_tex_y_a),u_tex_y_b:new s.bf(S,i.u_tex_y_b),u_mix:new s.bf(S,i.u_mix)}),raster:(S,i)=>({u_tl_parent:new s.bT(S,i.u_tl_parent),u_scale_parent:new s.bf(S,i.u_scale_parent),u_buffer_scale:new s.bf(S,i.u_buffer_scale),u_fade_t:new s.bf(S,i.u_fade_t),u_opacity:new s.bf(S,i.u_opacity),u_image0:new s.bO(S,i.u_image0),u_image1:new s.bO(S,i.u_image1),u_brightness_low:new s.bf(S,i.u_brightness_low),u_brightness_high:new s.bf(S,i.u_brightness_high),u_saturation_factor:new s.bf(S,i.u_saturation_factor),u_contrast_factor:new s.bf(S,i.u_contrast_factor),u_spin_weights:new s.bS(S,i.u_spin_weights),u_coords_top:new s.bR(S,i.u_coords_top),u_coords_bottom:new s.bR(S,i.u_coords_bottom)}),symbolIcon:(S,i)=>({u_is_size_zoom_constant:new s.bO(S,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(S,i.u_is_size_feature_constant),u_size_t:new s.bf(S,i.u_size_t),u_size:new s.bf(S,i.u_size),u_camera_to_center_distance:new s.bf(S,i.u_camera_to_center_distance),u_pitch:new s.bf(S,i.u_pitch),u_rotate_symbol:new s.bO(S,i.u_rotate_symbol),u_aspect_ratio:new s.bf(S,i.u_aspect_ratio),u_fade_change:new s.bf(S,i.u_fade_change),u_label_plane_matrix:new s.bQ(S,i.u_label_plane_matrix),u_coord_matrix:new s.bQ(S,i.u_coord_matrix),u_is_text:new s.bO(S,i.u_is_text),u_pitch_with_map:new s.bO(S,i.u_pitch_with_map),u_is_along_line:new s.bO(S,i.u_is_along_line),u_is_variable_anchor:new s.bO(S,i.u_is_variable_anchor),u_texsize:new s.bT(S,i.u_texsize),u_texture:new s.bO(S,i.u_texture),u_translation:new s.bT(S,i.u_translation),u_pitched_scale:new s.bf(S,i.u_pitched_scale)}),symbolSDF:(S,i)=>({u_is_size_zoom_constant:new s.bO(S,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(S,i.u_is_size_feature_constant),u_size_t:new s.bf(S,i.u_size_t),u_size:new s.bf(S,i.u_size),u_camera_to_center_distance:new s.bf(S,i.u_camera_to_center_distance),u_pitch:new s.bf(S,i.u_pitch),u_rotate_symbol:new s.bO(S,i.u_rotate_symbol),u_aspect_ratio:new s.bf(S,i.u_aspect_ratio),u_fade_change:new s.bf(S,i.u_fade_change),u_label_plane_matrix:new s.bQ(S,i.u_label_plane_matrix),u_coord_matrix:new s.bQ(S,i.u_coord_matrix),u_is_text:new s.bO(S,i.u_is_text),u_pitch_with_map:new s.bO(S,i.u_pitch_with_map),u_is_along_line:new s.bO(S,i.u_is_along_line),u_is_variable_anchor:new s.bO(S,i.u_is_variable_anchor),u_texsize:new s.bT(S,i.u_texsize),u_texture:new s.bO(S,i.u_texture),u_gamma_scale:new s.bf(S,i.u_gamma_scale),u_device_pixel_ratio:new s.bf(S,i.u_device_pixel_ratio),u_is_halo:new s.bO(S,i.u_is_halo),u_translation:new s.bT(S,i.u_translation),u_pitched_scale:new s.bf(S,i.u_pitched_scale)}),symbolTextAndIcon:(S,i)=>({u_is_size_zoom_constant:new s.bO(S,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(S,i.u_is_size_feature_constant),u_size_t:new s.bf(S,i.u_size_t),u_size:new s.bf(S,i.u_size),u_camera_to_center_distance:new s.bf(S,i.u_camera_to_center_distance),u_pitch:new s.bf(S,i.u_pitch),u_rotate_symbol:new s.bO(S,i.u_rotate_symbol),u_aspect_ratio:new s.bf(S,i.u_aspect_ratio),u_fade_change:new s.bf(S,i.u_fade_change),u_label_plane_matrix:new s.bQ(S,i.u_label_plane_matrix),u_coord_matrix:new s.bQ(S,i.u_coord_matrix),u_is_text:new s.bO(S,i.u_is_text),u_pitch_with_map:new s.bO(S,i.u_pitch_with_map),u_is_along_line:new s.bO(S,i.u_is_along_line),u_is_variable_anchor:new s.bO(S,i.u_is_variable_anchor),u_texsize:new s.bT(S,i.u_texsize),u_texsize_icon:new s.bT(S,i.u_texsize_icon),u_texture:new s.bO(S,i.u_texture),u_texture_icon:new s.bO(S,i.u_texture_icon),u_gamma_scale:new s.bf(S,i.u_gamma_scale),u_device_pixel_ratio:new s.bf(S,i.u_device_pixel_ratio),u_is_halo:new s.bO(S,i.u_is_halo),u_translation:new s.bT(S,i.u_translation),u_pitched_scale:new s.bf(S,i.u_pitched_scale)}),background:(S,i)=>({u_opacity:new s.bf(S,i.u_opacity),u_color:new s.bP(S,i.u_color)}),backgroundPattern:(S,i)=>({u_opacity:new s.bf(S,i.u_opacity),u_image:new s.bO(S,i.u_image),u_pattern_tl_a:new s.bT(S,i.u_pattern_tl_a),u_pattern_br_a:new s.bT(S,i.u_pattern_br_a),u_pattern_tl_b:new s.bT(S,i.u_pattern_tl_b),u_pattern_br_b:new s.bT(S,i.u_pattern_br_b),u_texsize:new s.bT(S,i.u_texsize),u_mix:new s.bf(S,i.u_mix),u_pattern_size_a:new s.bT(S,i.u_pattern_size_a),u_pattern_size_b:new s.bT(S,i.u_pattern_size_b),u_scale_a:new s.bf(S,i.u_scale_a),u_scale_b:new s.bf(S,i.u_scale_b),u_pixel_coord_upper:new s.bT(S,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(S,i.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bf(S,i.u_tile_units_to_pixels)}),terrain:(S,i)=>({u_texture:new s.bO(S,i.u_texture),u_ele_delta:new s.bf(S,i.u_ele_delta),u_fog_matrix:new s.bQ(S,i.u_fog_matrix),u_fog_color:new s.bP(S,i.u_fog_color),u_fog_ground_blend:new s.bf(S,i.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bf(S,i.u_fog_ground_blend_opacity),u_horizon_color:new s.bP(S,i.u_horizon_color),u_horizon_fog_blend:new s.bf(S,i.u_horizon_fog_blend),u_is_globe_mode:new s.bf(S,i.u_is_globe_mode)}),terrainDepth:(S,i)=>({u_ele_delta:new s.bf(S,i.u_ele_delta)}),terrainCoords:(S,i)=>({u_texture:new s.bO(S,i.u_texture),u_terrain_coords_id:new s.bf(S,i.u_terrain_coords_id),u_ele_delta:new s.bf(S,i.u_ele_delta)}),projectionErrorMeasurement:(S,i)=>({u_input:new s.bf(S,i.u_input),u_output_expected:new s.bf(S,i.u_output_expected)}),atmosphere:(S,i)=>({u_sun_pos:new s.bS(S,i.u_sun_pos),u_atmosphere_blend:new s.bf(S,i.u_atmosphere_blend),u_globe_position:new s.bS(S,i.u_globe_position),u_globe_radius:new s.bf(S,i.u_globe_radius),u_inv_proj_matrix:new s.bQ(S,i.u_inv_proj_matrix)}),sky:(S,i)=>({u_sky_color:new s.bP(S,i.u_sky_color),u_horizon_color:new s.bP(S,i.u_horizon_color),u_horizon:new s.bT(S,i.u_horizon),u_horizon_normal:new s.bT(S,i.u_horizon_normal),u_sky_horizon_blend:new s.bf(S,i.u_sky_horizon_blend),u_sky_blend:new s.bf(S,i.u_sky_blend)})};class kp{constructor(i,u,g){this.context=i;const _=i.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const lf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wh{constructor(i,u,g,_){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=_,this.context=i;const M=i.gl;this.buffer=M.createBuffer(),i.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,u){for(let g=0;g<this.attributes.length;g++){const _=u.attributes[this.attributes[g].name];_!==void 0&&i.enableVertexAttribArray(_)}}setVertexAttribPointers(i,u,g){for(let _=0;_<this.attributes.length;_++){const M=this.attributes[_],D=u.attributes[M.name];D!==void 0&&i.vertexAttribPointer(D,M.components,i[lf[M.type]],!1,this.itemSize,M.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Vr{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class qh extends Vr{getDefault(){return s.be.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class za extends Vr{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class zp extends Vr{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Op extends Vr{getDefault(){return[!0,!0,!0,!0]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Fp extends Vr{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class ag extends Vr{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Np extends Vr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const u=this.current;(i.func!==u.func||i.ref!==u.ref||i.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class Po extends Vr{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class $c extends Vr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=i,this.dirty=!1}}class lg extends Vr{getDefault(){return[0,1]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class cg extends Vr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=i,this.dirty=!1}}class ug extends Vr{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class hg extends Vr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.BLEND):u.disable(u.BLEND),this.current=i,this.dirty=!1}}class cf extends Vr{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class wy extends Vr{getDefault(){return s.be.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class dg extends Vr{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class hl extends Vr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=i,this.dirty=!1}}class Du extends Vr{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class ec extends Vr{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class Xh extends Vr{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class tc extends Vr{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class nc extends Vr{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class fa extends Vr{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class vs extends Vr{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Bp extends Vr{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Zh extends Vr{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class uf extends Vr{getDefault(){return null}set(i){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class rc extends Vr{getDefault(){return null}set(i){var u;if(i===this.current&&!this.dirty)return;const g=this.gl;ts(g)?g.bindVertexArray(i):(u=g.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Yh extends Vr{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Kh extends Vr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class ku extends Vr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Vc extends Vr{constructor(i,u){super(i),this.context=i,this.parent=u}getDefault(){return null}}class dl extends Vc{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class ic extends Vc{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class oc extends Vc{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}const Up="Framebuffer is not complete";class $p{constructor(i,u,g,_,M){this.context=i,this.width=u,this.height=g;const D=i.gl,F=this.framebuffer=D.createFramebuffer();if(this.colorAttachment=new dl(i,F),_)this.depthAttachment=M?new oc(i,F):new ic(i,F);else if(M)throw new Error("Stencil cannot be set without depth");if(D.checkFramebufferStatus(D.FRAMEBUFFER)!==D.FRAMEBUFFER_COMPLETE)throw new Error(Up)}destroy(){const i=this.context.gl,u=this.colorAttachment.get();if(u&&i.deleteTexture(u),this.depthAttachment){const g=this.depthAttachment.get();g&&i.deleteRenderbuffer(g)}i.deleteFramebuffer(this.framebuffer)}}class Sr{constructor(i){var u,g;if(this.gl=i,this.clearColor=new qh(this),this.clearDepth=new za(this),this.clearStencil=new zp(this),this.colorMask=new Op(this),this.depthMask=new Fp(this),this.stencilMask=new ag(this),this.stencilFunc=new Np(this),this.stencilOp=new Po(this),this.stencilTest=new $c(this),this.depthRange=new lg(this),this.depthTest=new cg(this),this.depthFunc=new ug(this),this.blend=new hg(this),this.blendFunc=new cf(this),this.blendColor=new wy(this),this.blendEquation=new dg(this),this.cullFace=new hl(this),this.cullFaceSide=new Du(this),this.frontFace=new ec(this),this.program=new Xh(this),this.activeTexture=new tc(this),this.viewport=new nc(this),this.bindFramebuffer=new fa(this),this.bindRenderbuffer=new vs(this),this.bindTexture=new Bp(this),this.bindVertexBuffer=new Zh(this),this.bindElementBuffer=new uf(this),this.bindVertexArray=new rc(this),this.pixelStoreUnpack=new Yh(this),this.pixelStoreUnpackPremultiplyAlpha=new Kh(this),this.pixelStoreUnpackFlipY=new ku(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),ts(i)){this.HALF_FLOAT=i.HALF_FLOAT;const _=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=i.RGBA16F)!==null&&u!==void 0?u:_?.RGBA16F_EXT,this.RGB16F=(g=i.RGB16F)!==null&&g!==void 0?g:_?.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const _=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=_?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,u){return new kp(this,i,u)}createVertexBuffer(i,u,g){return new Wh(this,i,u,g)}createRenderbuffer(i,u,g){const _=this.gl,M=_.createRenderbuffer();return this.bindRenderbuffer.set(M),_.renderbufferStorage(_.RENDERBUFFER,i,u,g),this.bindRenderbuffer.set(null),M}createFramebuffer(i,u,g,_){return new $p(this,i,u,g,_)}clear({color:i,depth:u,stencil:g}){const _=this.gl;let M=0;i&&(M|=_.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(M|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(M|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),_.clear(M)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){s.bG(i.blendFunction,Tr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return ts(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var u;return ts(this.gl)?this.gl.deleteVertexArray(i):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}let jc;function Vp(S,i,u,g,_){const M=S.context,D=S.transform,F=M.gl,U=S.useProgram("collisionBox"),Z=[];let K=0,ie=0;for(let Ne=0;Ne<g.length;Ne++){const Ge=g[Ne],Je=i.getTile(Ge).getBucket(u);if(!Je)continue;const qe=_?Je.textCollisionBox:Je.iconCollisionBox,at=Je.collisionCircleArray;at.length>0&&(Z.push({circleArray:at,circleOffset:ie,coord:Ge}),K+=at.length/4,ie=K),qe&&U.draw(M,F.LINES,gr.disabled,sr.disabled,S.colorModeForRenderPass(),yr.disabled,Bh(S.transform),S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ge),D.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,null,S.transform.zoom,null,null,qe.collisionVertexBuffer)}if(!_||!Z.length)return;const ne=S.useProgram("collisionCircle"),le=new s.b_;le.resize(4*K),le._trim();let ge=0;for(const Ne of Z)for(let Ge=0;Ge<Ne.circleArray.length/4;Ge++){const Je=4*Ge,qe=Ne.circleArray[Je+0],at=Ne.circleArray[Je+1],ct=Ne.circleArray[Je+2],Ze=Ne.circleArray[Je+3];le.emplace(ge++,qe,at,ct,Ze,0),le.emplace(ge++,qe,at,ct,Ze,1),le.emplace(ge++,qe,at,ct,Ze,2),le.emplace(ge++,qe,at,ct,Ze,3)}(!jc||jc.length<2*K)&&(jc=function(Ne){const Ge=2*Ne,Je=new s.c0;Je.resize(Ge),Je._trim();for(let qe=0;qe<Ge;qe++){const at=6*qe;Je.uint16[at+0]=4*qe+0,Je.uint16[at+1]=4*qe+1,Je.uint16[at+2]=4*qe+2,Je.uint16[at+3]=4*qe+2,Je.uint16[at+4]=4*qe+3,Je.uint16[at+5]=4*qe+0}return Je}(K));const Le=M.createIndexBuffer(jc,!0),ze=M.createVertexBuffer(le,s.b$.members,!0);for(const Ne of Z){const Ge=Uh(S.transform);ne.draw(M,F.TRIANGLES,gr.disabled,sr.disabled,S.colorModeForRenderPass(),yr.disabled,Ge,S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ne.coord),null,u.id,ze,Le,s.aL.simpleSegment(0,2*Ne.circleOffset,Ne.circleArray.length,Ne.circleArray.length/2),null,S.transform.zoom,null,null,null)}ze.destroy(),Le.destroy()}const jp=s.af(new Float32Array(16));function oi(S,i,u,g,_,M){const{horizontalAlign:D,verticalAlign:F}=s.aG(S);return new s.P((-(D-.5)*i/_+g[0])*M,(-(F-.5)*u/_+g[1])*M)}function Hp(S,i,u,g,_,M){const D=i.tileAnchorPoint.add(new s.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let F=g.mult(M);u||(F=F.rotate(-_));const U=D.add(F);return pn(U.x,U.y,i.pitchedLabelPlaneMatrix,i.getElevation).point}if(u){const F=nt(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(S),U=Math.atan(F.y/F.x)+(F.x<0?Math.PI:0);return S.add(g.rotate(U))}return S.add(g)}function hf(S,i,u,g,_,M,D,F,U,Z,K,ie){const ne=S.text.placedSymbolArray,le=S.text.dynamicLayoutVertexArray,ge=S.icon.dynamicLayoutVertexArray,Le={};le.clear();for(let ze=0;ze<ne.length;ze++){const Ne=ne.get(ze),Ge=Ne.hidden||!Ne.crossTileID||S.allowVerticalPlacement&&!Ne.placedOrientation?null:g[Ne.crossTileID];if(Ge){const Je=new s.P(Ne.anchorX,Ne.anchorY),qe={getElevation:ie,width:_.width,height:_.height,pitchedLabelPlaneMatrix:M,pitchWithMap:u,transform:_,tileAnchorPoint:Je,translation:Z,unwrappedTileID:K},at=u?cn(Je.x,Je.y,qe):nt(Je.x,Je.y,qe),ct=rn(_.cameraToCenterDistance,at.signedDistanceFromCamera);let Ze=s.ao(S.textSizeData,F,Ne)*ct/s.aA;u&&(Ze*=S.tilePixelRatio/D);const{width:pt,height:Tt,anchor:Mt,textOffset:Et,textBoxScale:Dt}=Ge,Sn=oi(Mt,pt,Tt,Et,Dt,Ze),wn=_.getPitchedTextCorrection(Je.x+Z[0],Je.y+Z[1],K),nn=Hp(at.point,qe,i,Sn,-_.bearingInRadians,wn),Vn=S.allowVerticalPlacement&&Ne.placedOrientation===s.an.vertical?Math.PI/2:0;for(let br=0;br<Ne.numGlyphs;br++)s.au(le,nn,Vn);U&&Ne.associatedIconIndex>=0&&(Le[Ne.associatedIconIndex]={shiftedAnchor:nn,angle:Vn})}else vt(Ne.numGlyphs,le)}if(U){ge.clear();const ze=S.icon.placedSymbolArray;for(let Ne=0;Ne<ze.length;Ne++){const Ge=ze.get(Ne);if(Ge.hidden)vt(Ge.numGlyphs,ge);else{const Je=Le[Ne];if(Je)for(let qe=0;qe<Ge.numGlyphs;qe++)s.au(ge,Je.shiftedAnchor,Je.angle);else vt(Ge.numGlyphs,ge)}}S.icon.dynamicLayoutVertexBuffer.updateData(ge)}S.text.dynamicLayoutVertexBuffer.updateData(le)}function zu(S,i,u){return u.iconsInText&&i?"symbolTextAndIcon":S?"symbolSDF":"symbolIcon"}function Gp(S,i,u,g,_,M,D,F,U,Z,K,ie,ne){const le=S.context,ge=le.gl,Le=S.transform,ze=F==="map",Ne=U==="map",Ge=F!=="viewport"&&u.layout.get("symbol-placement")!=="point",Je=ze&&!Ne&&!Ge,qe=!u.layout.get("symbol-sort-key").isConstant();let at=!1;const ct=S.getDepthModeForSublayer(0,gr.ReadOnly),Ze=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),pt=[],Tt=Le.getCircleRadiusCorrection();for(const Mt of g){const Et=i.getTile(Mt),Dt=Et.getBucket(u);if(!Dt)continue;const Sn=_?Dt.text:Dt.icon;if(!Sn||!Sn.segments.get().length||!Sn.hasVisibleVertices)continue;const wn=Sn.programConfigurations.get(u.id),nn=_||Dt.sdfIcons,Vn=_?Dt.textSizeData:Dt.iconSizeData,br=Ne||Le.pitch!==0,jr=S.useProgram(zu(nn,_,Dt),wn),Ei=s.am(Vn,Le.zoom),ii=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Mt);let ci,ai,Kr,ti,go=[0,0],Ar=null;if(_)ai=Et.glyphAtlasTexture,Kr=ge.LINEAR,ci=Et.glyphAtlasTexture.size,Dt.iconsInText&&(go=Et.imageAtlasTexture.size,Ar=Et.imageAtlasTexture,ti=br||S.options.rotating||S.options.zooming||Vn.kind==="composite"||Vn.kind==="camera"?ge.LINEAR:ge.NEAREST);else{const ki=u.layout.get("icon-size").constantOr(0)!==1||Dt.iconsNeedLinear;ai=Et.imageAtlasTexture,Kr=nn||S.options.rotating||S.options.zooming||ki||br?ge.LINEAR:ge.NEAREST,ci=Et.imageAtlasTexture.size}const so=s.aB(Et,1,S.transform.zoom),vo=mt(ze,S.transform,so),vl=s.L();s.ap(vl,vo);const yl=Wt(Ne,ze,S.transform,so),$a=s.aC(Le,Et,M,D),va=Le.getProjectionData({overscaledTileID:Mt,applyGlobeMatrix:!ne,applyTerrainMatrix:!0}),Yu=Ze&&Dt.hasTextData(),Ku=u.layout.get("icon-text-fit")!=="none"&&Yu&&Dt.hasIconData();if(Ge){const ki=S.style.map.terrain?(yo,ao)=>S.style.map.terrain.getElevation(Mt,yo,ao):null,hi=u.layout.get("text-rotation-alignment")==="map";kn(Dt,S,_,vo,vl,Ne,Z,hi,Mt.toUnwrapped(),Le.width,Le.height,$a,ki)}const Ju=_&&Ze||Ku,as=Ge||Ju?jp:Ne?vo:S.transform.clipSpaceToPixelsMatrix,ya=nn&&u.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let mc;mc=nn?Dt.iconsInText?Hh(Vn.kind,Ei,Je,Ne,Ge,Ju,S,as,yl,$a,ci,go,Tt):Uc(Vn.kind,Ei,Je,Ne,Ge,Ju,S,as,yl,$a,_,ci,0,Tt):af(Vn.kind,Ei,Je,Ne,Ge,Ju,S,as,yl,$a,_,ci,Tt);const gc={program:jr,buffers:Sn,uniformValues:mc,projectionData:va,atlasTexture:ai,atlasTextureIcon:Ar,atlasInterpolation:Kr,atlasInterpolationIcon:ti,isSDF:nn,hasHalo:ya};if(qe&&Dt.canOverlap){at=!0;const ki=Sn.segments.get();for(const hi of ki)pt.push({segments:new s.aL([hi]),sortKey:hi.sortKey,state:gc,terrainData:ii})}else pt.push({segments:Sn.segments,sortKey:0,state:gc,terrainData:ii})}at&&pt.sort((Mt,Et)=>Mt.sortKey-Et.sortKey);for(const Mt of pt){const Et=Mt.state;if(le.activeTexture.set(ge.TEXTURE0),Et.atlasTexture.bind(Et.atlasInterpolation,ge.CLAMP_TO_EDGE),Et.atlasTextureIcon&&(le.activeTexture.set(ge.TEXTURE1),Et.atlasTextureIcon&&Et.atlasTextureIcon.bind(Et.atlasInterpolationIcon,ge.CLAMP_TO_EDGE)),Et.isSDF){const Dt=Et.uniformValues;Et.hasHalo&&(Dt.u_is_halo=1,Ou(Et.buffers,Mt.segments,u,S,Et.program,ct,K,ie,Dt,Et.projectionData,Mt.terrainData)),Dt.u_is_halo=0}Ou(Et.buffers,Mt.segments,u,S,Et.program,ct,K,ie,Et.uniformValues,Et.projectionData,Mt.terrainData)}}function Ou(S,i,u,g,_,M,D,F,U,Z,K){const ie=g.context;_.draw(ie,ie.gl.TRIANGLES,M,D,F,yr.backCCW,U,K,Z,u.id,S.layoutVertexBuffer,S.indexBuffer,i,u.paint,g.transform.zoom,S.programConfigurations.get(u.id),S.dynamicLayoutVertexBuffer,S.opacityVertexBuffer)}function sc(S,i,u,g,_){const M=S.context,D=M.gl,F=sr.disabled,U=new Tr([D.ONE,D.ONE],s.be.transparent,[!0,!0,!0,!0]),Z=i.getBucket(u);if(!Z)return;const K=g.key;let ie=u.heatmapFbos.get(K);ie||(ie=Oa(M,i.tileSize,i.tileSize),u.heatmapFbos.set(K,ie)),M.bindFramebuffer.set(ie.framebuffer),M.viewport.set([0,0,i.tileSize,i.tileSize]),M.clear({color:s.be.transparent});const ne=Z.programConfigurations.get(u.id),le=S.useProgram("heatmap",ne,!_),ge=S.transform.getProjectionData({overscaledTileID:i.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Le=S.style.map.terrain.getTerrainData(g);le.draw(M,D.TRIANGLES,gr.disabled,F,U,yr.disabled,$h(i,S.transform.zoom,u.paint.get("heatmap-intensity"),1),Le,ge,u.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,u.paint,S.transform.zoom,ne)}function Hc(S,i,u,g,_){const M=S.context,D=M.gl,F=S.transform;M.setColorMode(S.colorModeForRenderPass());const U=Jh(M,i),Z=u.key,K=i.heatmapFbos.get(Z);if(!K)return;M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,K.colorAttachment.get()),M.activeTexture.set(D.TEXTURE1),U.bind(D.LINEAR,D.CLAMP_TO_EDGE);const ie=F.getProjectionData({overscaledTileID:u,applyTerrainMatrix:_,applyGlobeMatrix:!g});S.useProgram("heatmapTexture").draw(M,D.TRIANGLES,gr.disabled,sr.disabled,S.colorModeForRenderPass(),yr.disabled,ng(S,i,0,1),null,ie,i.id,S.rasterBoundsBuffer,S.quadTriangleIndexBuffer,S.rasterBoundsSegments,i.paint,F.zoom),K.destroy(),i.heatmapFbos.delete(Z)}function Oa(S,i,u){var g,_;const M=S.gl,D=M.createTexture();M.bindTexture(M.TEXTURE_2D,D),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,M.LINEAR),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,M.LINEAR);const F=(g=S.HALF_FLOAT)!==null&&g!==void 0?g:M.UNSIGNED_BYTE,U=(_=S.RGBA16F)!==null&&_!==void 0?_:M.RGBA;M.texImage2D(M.TEXTURE_2D,0,U,i,u,0,M.RGBA,F,null);const Z=S.createFramebuffer(i,u,!1,!1);return Z.colorAttachment.set(D),Z}function Jh(S,i){return i.colorRampTexture||(i.colorRampTexture=new s.T(S,i.colorRamp,S.gl.RGBA)),i.colorRampTexture}function Wp(S,i,u,g,_){if(!u||!g||!g.imageAtlas)return;const M=g.imageAtlas.patternPositions;let D=M[u.to.toString()],F=M[u.from.toString()];if(!D&&F&&(D=F),!F&&D&&(F=D),!D||!F){const U=_.getPaintProperty(i);D=M[U],F=M[U]}D&&F&&S.setConstantPatternPositions(D,F)}function Qh(S,i,u,g,_,M,D,F){const U=S.context.gl,Z="fill-pattern",K=u.paint.get(Z),ie=K&&K.constantOr(1),ne=u.getCrossfadeParameters();let le,ge,Le,ze,Ne;const Ge=S.transform,Je=u.paint.get("fill-translate"),qe=u.paint.get("fill-translate-anchor");D?(ge=ie&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",le=U.LINES):(ge=ie?"fillPattern":"fill",le=U.TRIANGLES);const at=K.constantOr(null);for(const ct of g){const Ze=i.getTile(ct);if(ie&&!Ze.patternsLoaded())continue;const pt=Ze.getBucket(u);if(!pt)continue;const Tt=pt.programConfigurations.get(u.id),Mt=S.useProgram(ge,Tt),Et=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ct);ie&&(S.context.activeTexture.set(U.TEXTURE0),Ze.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Tt.updatePaintBuffers(ne)),Wp(Tt,Z,at,Ze,u);const Dt=Ge.getProjectionData({overscaledTileID:ct,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),Sn=s.aC(Ge,Ze,Je,qe);if(D){ze=pt.indexBuffer2,Ne=pt.segments2;const nn=[U.drawingBufferWidth,U.drawingBufferHeight];Le=ge==="fillOutlinePattern"&&ie?xy(S,ne,Ze,nn,Sn):da(nn,Sn)}else ze=pt.indexBuffer,Ne=pt.segments,Le=ie?of(S,ne,Ze,Sn):{u_fill_translate:Sn};const wn=S.stencilModeForClipping(ct);Mt.draw(S.context,le,_,wn,M,yr.backCCW,Le,Et,Dt,u.id,pt.layoutVertexBuffer,ze,Ne,u.paint,S.transform.zoom,Tt)}}function Gc(S,i,u,g,_,M,D,F){const U=S.context,Z=U.gl,K="fill-extrusion-pattern",ie=u.paint.get(K),ne=ie.constantOr(1),le=u.getCrossfadeParameters(),ge=u.paint.get("fill-extrusion-opacity"),Le=ie.constantOr(null),ze=S.transform;for(const Ne of g){const Ge=i.getTile(Ne),Je=Ge.getBucket(u);if(!Je)continue;const qe=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ne),at=Je.programConfigurations.get(u.id),ct=S.useProgram(ne?"fillExtrusionPattern":"fillExtrusion",at);ne&&(S.context.activeTexture.set(Z.TEXTURE0),Ge.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),at.updatePaintBuffers(le));const Ze=ze.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Wp(at,K,Le,Ge,u);const pt=s.aC(ze,Ge,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Tt=u.paint.get("fill-extrusion-vertical-gradient"),Mt=ne?Ap(S,Tt,ge,pt,Ne,le,Ge):Nh(S,Tt,ge,pt);ct.draw(U,U.gl.TRIANGLES,_,M,D,yr.backCCW,Mt,qe,Ze,u.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,u.paint,S.transform.zoom,at,S.style.map.terrain&&Je.centroidVertexBuffer)}}function fl(S,i,u,g,_,M,D,F,U){var Z;const K=S.style.projection,ie=S.context,ne=S.transform,le=ie.gl,ge=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],Le=S.useProgram("hillshade",null,!1,ge),ze=!S.options.moving;for(const Ne of g){const Ge=i.getTile(Ne),Je=Ge.fbo;if(!Je)continue;const qe=K.getMeshFromTileID(ie,Ne.canonical,F,!0,"raster"),at=(Z=S.style.map.terrain)===null||Z===void 0?void 0:Z.getTerrainData(Ne);ie.activeTexture.set(le.TEXTURE0),le.bindTexture(le.TEXTURE_2D,Je.colorAttachment.get());const ct=ne.getProjectionData({overscaledTileID:Ne,aligned:ze,applyGlobeMatrix:!U,applyTerrainMatrix:!0});Le.draw(ie,le.TRIANGLES,M,_[Ne.overscaledZ],D,yr.backCCW,Kl(S,Ge,u),at,ct,u.id,qe.vertexBuffer,qe.indexBuffer,qe.segments)}}function ac(S,i,u,g,_,M,D,F,U){var Z;const K=S.style.projection,ie=S.context,ne=S.transform,le=ie.gl,ge=S.useProgram("colorRelief"),Le=!S.options.moving;let ze=!0,Ne=0;for(const Ge of g){const Je=i.getTile(Ge),qe=Je.dem;if(ze){const Mt=le.getParameter(le.MAX_TEXTURE_SIZE),{elevationTexture:Et,colorTexture:Dt}=u.getColorRampTextures(ie,Mt,qe.getUnpackVector());ie.activeTexture.set(le.TEXTURE1),Et.bind(le.NEAREST,le.CLAMP_TO_EDGE),ie.activeTexture.set(le.TEXTURE4),Dt.bind(le.LINEAR,le.CLAMP_TO_EDGE),ze=!1,Ne=Et.size[0]}if(!qe||!qe.data)continue;const at=qe.stride,ct=qe.getPixels();if(ie.activeTexture.set(le.TEXTURE0),ie.pixelStoreUnpackPremultiplyAlpha.set(!1),Je.demTexture=Je.demTexture||S.getTileTexture(at),Je.demTexture){const Mt=Je.demTexture;Mt.update(ct,{premultiply:!1}),Mt.bind(le.LINEAR,le.CLAMP_TO_EDGE)}else Je.demTexture=new s.T(ie,ct,le.RGBA,{premultiply:!1}),Je.demTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const Ze=K.getMeshFromTileID(ie,Ge.canonical,F,!0,"raster"),pt=(Z=S.style.map.terrain)===null||Z===void 0?void 0:Z.getTerrainData(Ge),Tt=ne.getProjectionData({overscaledTileID:Ge,aligned:Le,applyGlobeMatrix:!U,applyTerrainMatrix:!0});ge.draw(ie,le.TRIANGLES,M,_[Ge.overscaledZ],D,yr.backCCW,ig(u,Je.dem,Ne),pt,Tt,u.id,Ze.vertexBuffer,Ze.indexBuffer,Ze.segments)}}const ed=[new s.P(0,0),new s.P(s.$,0),new s.P(s.$,s.$),new s.P(0,s.$)];function Fa(S,i,u,g,_,M,D,F,U=!1,Z=!1){const K=g[g.length-1].overscaledZ,ie=S.context,ne=ie.gl,le=S.useProgram("raster"),ge=S.transform,Le=S.style.projection,ze=S.colorModeForRenderPass(),Ne=!S.options.moving;for(const Ge of g){const Je=S.getDepthModeForSublayer(Ge.overscaledZ-K,u.paint.get("raster-opacity")===1?gr.ReadWrite:gr.ReadOnly,ne.LESS),qe=i.getTile(Ge);qe.registerFadeDuration(u.paint.get("raster-fade-duration"));const at=i.findLoadedParent(Ge,0),ct=i.findLoadedSibling(Ge),Ze=qp(qe,at||ct||null,i,u,S.transform,S.style.map.terrain);let pt,Tt;const Mt=u.paint.get("raster-resampling")==="nearest"?ne.NEAREST:ne.LINEAR;ie.activeTexture.set(ne.TEXTURE0),qe.texture.bind(Mt,ne.CLAMP_TO_EDGE,ne.LINEAR_MIPMAP_NEAREST),ie.activeTexture.set(ne.TEXTURE1),at?(at.texture.bind(Mt,ne.CLAMP_TO_EDGE,ne.LINEAR_MIPMAP_NEAREST),pt=Math.pow(2,at.tileID.overscaledZ-qe.tileID.overscaledZ),Tt=[qe.tileID.canonical.x*pt%1,qe.tileID.canonical.y*pt%1]):qe.texture.bind(Mt,ne.CLAMP_TO_EDGE,ne.LINEAR_MIPMAP_NEAREST),qe.texture.useMipmap&&ie.extTextureFilterAnisotropic&&S.transform.pitch>20&&ne.texParameterf(ne.TEXTURE_2D,ie.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ie.extTextureFilterAnisotropicMax);const Et=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ge),Dt=ge.getProjectionData({overscaledTileID:Ge,aligned:Ne,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),Sn=Bc(Tt||[0,0],pt||1,Ze,u,F),wn=Le.getMeshFromTileID(ie,Ge.canonical,M,D,"raster");le.draw(ie,ne.TRIANGLES,Je,_?_[Ge.overscaledZ]:sr.disabled,ze,U?yr.frontCCW:yr.backCCW,Sn,Et,Dt,u.id,wn.vertexBuffer,wn.indexBuffer,wn.segments)}}function qp(S,i,u,g,_,M){const D=g.paint.get("raster-fade-duration");if(!M&&D>0){const F=E.now(),U=(F-S.timeAdded)/D,Z=i?(F-i.timeAdded)/D:-1,K=u.getSource(),ie=Be(_,{tileSize:K.tileSize,roundZoom:K.roundZoom}),ne=!i||Math.abs(i.tileID.overscaledZ-ie)>Math.abs(S.tileID.overscaledZ-ie),le=ne&&S.refreshedUponExpiration?1:s.ag(ne?U:1-Z,0,1);return S.refreshedUponExpiration&&U>=1&&(S.refreshedUponExpiration=!1),i?{opacity:1,mix:1-le}:{opacity:le,mix:0}}return{opacity:1,mix:0}}const df=new s.be(1,0,0,1),ff=new s.be(0,1,0,1),pf=new s.be(0,0,1,1),fg=new s.be(1,0,1,1),pg=new s.be(0,1,1,1);function Wc(S,i,u,g){td(S,0,i+u/2,S.transform.width,u,g)}function pa(S,i,u,g){td(S,i-u/2,0,u,S.transform.height,g)}function td(S,i,u,g,_,M){const D=S.context,F=D.gl;F.enable(F.SCISSOR_TEST),F.scissor(i*S.pixelRatio,u*S.pixelRatio,g*S.pixelRatio,_*S.pixelRatio),D.clear({color:M}),F.disable(F.SCISSOR_TEST)}function qc(S,i,u){const g=S.context,_=g.gl,M=S.useProgram("debug"),D=gr.disabled,F=sr.disabled,U=S.colorModeForRenderPass(),Z="$debug",K=S.style.map.terrain&&S.style.map.terrain.getTerrainData(u);g.activeTexture.set(_.TEXTURE0);const ie=i.getTileByID(u.key).latestRawTileData,ne=Math.floor((ie&&ie.byteLength||0)/1024),le=i.getTile(u).tileSize,ge=512/Math.min(le,512)*(u.overscaledZ/S.transform.zoom)*.5;let Le=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Le+=` => ${u.overscaledZ}`),function(Ne,Ge){Ne.initDebugOverlayCanvas();const Je=Ne.debugOverlayCanvas,qe=Ne.context.gl,at=Ne.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,Je.width,Je.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(Ge,5,5),at.strokeText(Ge,5,5),Ne.debugOverlayTexture.update(Je),Ne.debugOverlayTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE)}(S,`${Le} ${ne}kB`);const ze=S.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});M.draw(g,_.TRIANGLES,D,F,Tr.alphaBlended,yr.disabled,tg(s.be.transparent,ge),null,ze,Z,S.debugBuffer,S.quadTriangleIndexBuffer,S.debugSegments),M.draw(g,_.LINE_STRIP,D,F,U,yr.disabled,tg(s.be.red),K,ze,Z,S.debugBuffer,S.tileBorderIndexBuffer,S.debugSegments)}function Yr(S,i,u,g){const{isRenderingGlobe:_}=g,M=S.context,D=M.gl,F=S.transform,U=S.colorModeForRenderPass(),Z=S.getDepthModeFor3D(),K=S.useProgram("terrain");M.bindFramebuffer.set(null),M.viewport.set([0,0,S.width,S.height]);for(const ie of u){const ne=i.getTerrainMesh(ie.tileID),le=S.renderToTexture.getTexture(ie),ge=i.getTerrainData(ie.tileID);M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,le.texture);const Le=i.getMeshFrameDelta(F.zoom),ze=F.calculateFogMatrix(ie.tileID.toUnwrapped()),Ne=yy(Le,ze,S.style.sky,F.pitch,_),Ge=F.getProjectionData({overscaledTileID:ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});K.draw(M,D.TRIANGLES,Z,sr.disabled,U,yr.backCCW,Ne,ge,Ge,"terrain",ne.vertexBuffer,ne.indexBuffer,ne.segments)}}function ea(S,i){if(!i.mesh){const u=new s.aK;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const g=new s.aM;g.emplaceBack(0,1,2),g.emplaceBack(0,2,3),i.mesh=new ua(S.createVertexBuffer(u,Ra.members),S.createIndexBuffer(g),s.aL.simpleSegment(0,0,u.length,g.length))}return i.mesh}class Yi{constructor(i,u){this.context=new Sr(i),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ut.maxUnderzooming+ut.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Vi}resize(i,u,g){if(this.width=Math.floor(i*g),this.height=Math.floor(u*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const i=this.context,u=new s.aK;u.emplaceBack(0,0),u.emplaceBack(s.$,0),u.emplaceBack(0,s.$),u.emplaceBack(s.$,s.$),this.tileExtentBuffer=i.createVertexBuffer(u,Ra.members),this.tileExtentSegments=s.aL.simpleSegment(0,0,4,2);const g=new s.aK;g.emplaceBack(0,0),g.emplaceBack(s.$,0),g.emplaceBack(0,s.$),g.emplaceBack(s.$,s.$),this.debugBuffer=i.createVertexBuffer(g,Ra.members),this.debugSegments=s.aL.simpleSegment(0,0,4,5);const _=new s.c5;_.emplaceBack(0,0,0,0),_.emplaceBack(s.$,0,s.$,0),_.emplaceBack(0,s.$,0,s.$),_.emplaceBack(s.$,s.$,s.$,s.$),this.rasterBoundsBuffer=i.createVertexBuffer(_,vy.members),this.rasterBoundsSegments=s.aL.simpleSegment(0,0,4,2);const M=new s.aK;M.emplaceBack(0,0),M.emplaceBack(s.$,0),M.emplaceBack(0,s.$),M.emplaceBack(s.$,s.$),this.rasterBoundsBufferPosOnly=i.createVertexBuffer(M,Ra.members),this.rasterBoundsSegmentsPosOnly=s.aL.simpleSegment(0,0,4,5);const D=new s.aK;D.emplaceBack(0,0),D.emplaceBack(1,0),D.emplaceBack(0,1),D.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(D,Ra.members),this.viewportSegments=s.aL.simpleSegment(0,0,4,2);const F=new s.c6;F.emplaceBack(0),F.emplaceBack(1),F.emplaceBack(3),F.emplaceBack(2),F.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(F);const U=new s.aM;U.emplaceBack(1,0,2),U.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(U);const Z=this.context.gl;this.stencilClearMode=new sr({func:Z.ALWAYS,mask:0},0,255,Z.ZERO,Z.ZERO,Z.ZERO),this.tileExtentMesh=new ua(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const i=this.context,u=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=s.L();s.bX(g,0,this.width,this.height,0,0,1),s.N(g,g,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const _={mainMatrix:g,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:g};this.useProgram("clippingMask",null,!0).draw(i,u.TRIANGLES,gr.disabled,this.stencilClearMode,Tr.disabled,yr.disabled,null,null,_,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,u,g){if(this.currentStencilSource===i.source||!i.isTileClipped()||!u||!u.length)return;this.currentStencilSource=i.source,this.nextStencilID+u.length>256&&this.clearStencil();const _=this.context;_.setColorMode(Tr.disabled),_.setDepthMode(gr.disabled);const M={};for(const D of u)M[D.key]=this.nextStencilID++;this._renderTileMasks(M,u,g,!0),this._renderTileMasks(M,u,g,!1),this._tileClippingMaskIDs=M}_renderTileMasks(i,u,g,_){const M=this.context,D=M.gl,F=this.style.projection,U=this.transform,Z=this.useProgram("clippingMask");for(const K of u){const ie=i[K.key],ne=this.style.map.terrain&&this.style.map.terrain.getTerrainData(K),le=F.getMeshFromTileID(this.context,K.canonical,_,!0,"stencil"),ge=U.getProjectionData({overscaledTileID:K,applyGlobeMatrix:!g,applyTerrainMatrix:!0});Z.draw(M,D.TRIANGLES,gr.disabled,new sr({func:D.ALWAYS,mask:0},ie,255,D.KEEP,D.KEEP,D.REPLACE),Tr.disabled,g?yr.disabled:yr.backCCW,null,ne,ge,"$clipping",le.vertexBuffer,le.indexBuffer,le.segments)}}_renderTilesDepthBuffer(){const i=this.context,u=i.gl,g=this.style.projection,_=this.transform,M=this.useProgram("depth"),D=this.getDepthModeFor3D(),F=$e(_,{tileSize:_.tileSize});for(const U of F){const Z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),K=g.getMeshFromTileID(this.context,U.canonical,!0,!0,"raster"),ie=_.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!0,applyTerrainMatrix:!0});M.draw(i,u.TRIANGLES,D,sr.disabled,Tr.disabled,yr.backCCW,null,Z,ie,"$clipping",K.vertexBuffer,K.indexBuffer,K.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,u=this.context.gl;return new sr({func:u.NOTEQUAL,mask:255},i,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(i){const u=this.context.gl;return new sr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(i){const u=this.context.gl,g=i.sort((D,F)=>F.overscaledZ-D.overscaledZ),_=g[g.length-1].overscaledZ,M=g[0].overscaledZ-_+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();const D={};for(let F=0;F<M;F++)D[F+_]=new sr({func:u.GEQUAL,mask:255},F+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=M,[D,g]}return[{[_]:sr.disabled},g]}stencilConfigForOverlapTwoPass(i){const u=this.context.gl,g=i.sort((D,F)=>F.overscaledZ-D.overscaledZ),_=g[g.length-1].overscaledZ,M=g[0].overscaledZ-_+1;if(this.clearStencil(),M>1){const D={},F={};for(let U=0;U<M;U++)D[U+_]=new sr({func:u.GREATER,mask:255},M+1+U,255,u.KEEP,u.KEEP,u.REPLACE),F[U+_]=new sr({func:u.GREATER,mask:255},1+U,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*M+1,[D,F,g]}return this.nextStencilID=3,[{[_]:new sr({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[_]:new sr({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},g]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new Tr([i.CONSTANT_COLOR,i.ONE],new s.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Tr.unblended:Tr.alphaBlended}getDepthModeForSublayer(i,u,g){if(!this.opaquePassEnabledForLayer())return gr.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new gr(g||this.context.gl.LEQUAL,u,[_,_])}getDepthModeFor3D(){return new gr(this.context.gl.LEQUAL,gr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,u){var g,_;this.style=i,this.options=u,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(E.now()),this.imageManager.beginFrame();const M=this.style._order,D=this.style.sourceCaches,F={},U={},Z={},K={isRenderingToTexture:!1,isRenderingGlobe:((g=i.projection)===null||g===void 0?void 0:g.transitionState)>0};for(const ne in D){const le=D[ne];le.used&&le.prepare(this.context),F[ne]=le.getVisibleCoordinates(!1),U[ne]=F[ne].slice().reverse(),Z[ne]=le.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ne=0;ne<M.length;ne++)if(this.style._layers[M[ne]].is3D()){this.opaquePassCutoff=ne;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const ne of M){const le=this.style._layers[ne];if(!le.hasOffscreenPass()||le.isHidden(this.transform.zoom))continue;const ge=U[le.source];(le.type==="custom"||ge.length)&&this.renderLayer(this,D[le.source],le,ge,K)}if((_=this.style.projection)===null||_===void 0||_.updateGPUdependent({context:this.context,useProgram:ne=>this.useProgram(ne)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?s.be.black:s.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(ne,le){const ge=ne.context,Le=ge.gl,ze=((ct,Ze,pt)=>{const Tt=Math.cos(Ze.rollInRadians),Mt=Math.sin(Ze.rollInRadians),Et=ue(Ze),Dt=Ze.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ct.properties.get("sky-color"),u_horizon_color:ct.properties.get("horizon-color"),u_horizon:[(Ze.width/2-Et*Mt)*pt,(Ze.height/2+Et*Tt)*pt],u_horizon_normal:[-Mt,Tt],u_sky_horizon_blend:ct.properties.get("sky-horizon-blend")*Ze.height/2*pt,u_sky_blend:Dt}})(le,ne.style.map.transform,ne.pixelRatio),Ne=new gr(Le.LEQUAL,gr.ReadWrite,[0,1]),Ge=sr.disabled,Je=ne.colorModeForRenderPass(),qe=ne.useProgram("sky"),at=ea(ge,le);qe.draw(ge,Le.TRIANGLES,Ne,Ge,Je,yr.disabled,ze,null,void 0,"sky",at.vertexBuffer,at.indexBuffer,at.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){const ne=this.style._layers[M[this.currentLayer]],le=D[ne.source],ge=F[ne.source];this._renderTileClippingMasks(ne,ge,!1),this.renderLayer(this,le,ne,ge,K)}this.renderPass="translucent";let ie=!1;for(this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){const ne=this.style._layers[M[this.currentLayer]],le=D[ne.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(ne,K))continue;this.opaquePassEnabledForLayer()||ie||(ie=!0,K.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ge=(ne.type==="symbol"?Z:U)[ne.source];this._renderTileClippingMasks(ne,F[ne.source],!!this.renderToTexture),this.renderLayer(this,le,ne,ge,K)}if(K.isRenderingGlobe&&function(ne,le,ge){const Le=ne.context,ze=Le.gl,Ne=ne.useProgram("atmosphere"),Ge=new gr(ze.LEQUAL,gr.ReadOnly,[0,1]),Je=ne.transform,qe=function(Dt,Sn){const wn=Dt.properties.get("position"),nn=[-wn.x,-wn.y,-wn.z],Vn=s.af(new Float64Array(16));return Dt.properties.get("anchor")==="map"&&(s.b5(Vn,Vn,Sn.rollInRadians),s.b6(Vn,Vn,-Sn.pitchInRadians),s.b5(Vn,Vn,Sn.bearingInRadians),s.b6(Vn,Vn,Sn.center.lat*Math.PI/180),s.by(Vn,Vn,-Sn.center.lng*Math.PI/180)),s.c4(nn,nn,Vn),nn}(ge,ne.transform),at=Je.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ct=le.properties.get("atmosphere-blend")*at.projectionTransition;if(ct===0)return;const Ze=cl(Je.worldSize,Je.center.lat),pt=Je.inverseProjectionMatrix,Tt=new Float64Array(4);Tt[3]=1,s.av(Tt,Tt,Je.modelViewProjectionMatrix),Tt[0]/=Tt[3],Tt[1]/=Tt[3],Tt[2]/=Tt[3],Tt[3]=1,s.av(Tt,Tt,pt),Tt[0]/=Tt[3],Tt[1]/=Tt[3],Tt[2]/=Tt[3],Tt[3]=1;const Mt=((Dt,Sn,wn,nn,Vn)=>({u_sun_pos:Dt,u_atmosphere_blend:Sn,u_globe_position:wn,u_globe_radius:nn,u_inv_proj_matrix:Vn}))(qe,ct,[Tt[0],Tt[1],Tt[2]],Ze,pt),Et=ea(Le,le);Ne.draw(Le,ze.TRIANGLES,Ge,sr.disabled,Tr.alphaBlended,yr.disabled,Mt,null,null,"atmosphere",Et.vertexBuffer,Et.indexBuffer,Et.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const ne=function(le,ge){let Le=null;const ze=Object.values(le._layers).flatMap(qe=>qe.source&&!qe.isHidden(ge)?[le.sourceCaches[qe.source]]:[]),Ne=ze.filter(qe=>qe.getSource().type==="vector"),Ge=ze.filter(qe=>qe.getSource().type!=="vector"),Je=qe=>{(!Le||Le.getSource().maxzoom<qe.getSource().maxzoom)&&(Le=qe)};return Ne.forEach(qe=>Je(qe)),Le||Ge.forEach(qe=>Je(qe)),Le}(this.style,this.transform.zoom);ne&&function(le,ge,Le){for(let ze=0;ze<Le.length;ze++)qc(le,ge,Le[ze])}(this,ne,ne.getVisibleCoordinates())}this.options.showPadding&&function(ne){const le=ne.transform.padding;Wc(ne,ne.transform.height-(le.top||0),3,df),Wc(ne,le.bottom||0,3,ff),pa(ne,le.left||0,3,pf),pa(ne,ne.transform.width-(le.right||0),3,fg);const ge=ne.transform.centerPoint;(function(Le,ze,Ne,Ge){td(Le,ze-1,Ne-10,2,20,Ge),td(Le,ze-10,Ne-1,20,2,Ge)})(ne,ge.x,ne.transform.height-ge.y,pg)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let _=this.terrainFacilitator.dirty;_||(_=i?!s.c7(u,g):!s.c8(u,g)),_||(_=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),_&&(s.c9(u,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(M,D){const F=M.context,U=F.gl,Z=M.transform,K=Tr.unblended,ie=new gr(U.LEQUAL,gr.ReadWrite,[0,1]),ne=D.sourceCache.getRenderableTiles(),le=M.useProgram("terrainDepth");F.bindFramebuffer.set(D.getFramebuffer("depth").framebuffer),F.viewport.set([0,0,M.width/devicePixelRatio,M.height/devicePixelRatio]),F.clear({color:s.be.transparent,depth:1});for(const ge of ne){const Le=D.getTerrainMesh(ge.tileID),ze=D.getTerrainData(ge.tileID),Ne=Z.getProjectionData({overscaledTileID:ge.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Ge={u_ele_delta:D.getMeshFrameDelta(Z.zoom)};le.draw(F,U.TRIANGLES,ie,sr.disabled,K,yr.backCCW,Ge,ze,Ne,"terrain",Le.vertexBuffer,Le.indexBuffer,Le.segments)}F.bindFramebuffer.set(null),F.viewport.set([0,0,M.width,M.height])}(this,this.style.map.terrain),function(M,D){const F=M.context,U=F.gl,Z=M.transform,K=Tr.unblended,ie=new gr(U.LEQUAL,gr.ReadWrite,[0,1]),ne=D.getCoordsTexture(),le=D.sourceCache.getRenderableTiles(),ge=M.useProgram("terrainCoords");F.bindFramebuffer.set(D.getFramebuffer("coords").framebuffer),F.viewport.set([0,0,M.width/devicePixelRatio,M.height/devicePixelRatio]),F.clear({color:s.be.transparent,depth:1}),D.coordsIndex=[];for(const Le of le){const ze=D.getTerrainMesh(Le.tileID),Ne=D.getTerrainData(Le.tileID);F.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,ne.texture);const Ge={u_terrain_coords_id:(255-D.coordsIndex.length)/255,u_texture:0,u_ele_delta:D.getMeshFrameDelta(Z.zoom)},Je=Z.getProjectionData({overscaledTileID:Le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ge.draw(F,U.TRIANGLES,ie,sr.disabled,K,yr.backCCW,Ge,Ne,Je,"terrain",ze.vertexBuffer,ze.indexBuffer,ze.segments),D.coordsIndex.push(Le.tileID.key)}F.bindFramebuffer.set(null),F.viewport.set([0,0,M.width,M.height])}(this,this.style.map.terrain))}renderLayer(i,u,g,_,M){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="custom"||(_||[]).length)&&(this.id=g.id,s.ca(g)?function(D,F,U,Z,K,ie){if(D.renderPass!=="translucent")return;const{isRenderingToTexture:ne}=ie,le=sr.disabled,ge=D.colorModeForRenderPass();(U._unevaluatedLayout.hasValue("text-variable-anchor")||U._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Le,ze,Ne,Ge,Je,qe,at,ct,Ze){const pt=ze.transform,Tt=ze.style.map.terrain,Mt=Je==="map",Et=qe==="map";for(const Dt of Le){const Sn=Ge.getTile(Dt),wn=Sn.getBucket(Ne);if(!wn||!wn.text||!wn.text.segments.get().length)continue;const nn=s.am(wn.textSizeData,pt.zoom),Vn=s.aB(Sn,1,ze.transform.zoom),br=mt(Mt,ze.transform,Vn),jr=Ne.layout.get("icon-text-fit")!=="none"&&wn.hasIconData();if(nn){const Ei=Math.pow(2,pt.zoom-Sn.tileID.overscaledZ),ii=Tt?(ci,ai)=>Tt.getElevation(Dt,ci,ai):null;hf(wn,Mt,Et,Ze,pt,br,Ei,nn,jr,s.aC(pt,Sn,at,ct),Dt.toUnwrapped(),ii)}}}(Z,D,U,F,U.layout.get("text-rotation-alignment"),U.layout.get("text-pitch-alignment"),U.paint.get("text-translate"),U.paint.get("text-translate-anchor"),K),U.paint.get("icon-opacity").constantOr(1)!==0&&Gp(D,F,U,Z,!1,U.paint.get("icon-translate"),U.paint.get("icon-translate-anchor"),U.layout.get("icon-rotation-alignment"),U.layout.get("icon-pitch-alignment"),U.layout.get("icon-keep-upright"),le,ge,ne),U.paint.get("text-opacity").constantOr(1)!==0&&Gp(D,F,U,Z,!0,U.paint.get("text-translate"),U.paint.get("text-translate-anchor"),U.layout.get("text-rotation-alignment"),U.layout.get("text-pitch-alignment"),U.layout.get("text-keep-upright"),le,ge,ne),F.map.showCollisionBoxes&&(Vp(D,F,U,Z,!0),Vp(D,F,U,Z,!1))}(i,u,g,_,this.style.placement.variableOffsets,M):s.cb(g)?function(D,F,U,Z,K){if(D.renderPass!=="translucent")return;const{isRenderingToTexture:ie}=K,ne=U.paint.get("circle-opacity"),le=U.paint.get("circle-stroke-width"),ge=U.paint.get("circle-stroke-opacity"),Le=!U.layout.get("circle-sort-key").isConstant();if(ne.constantOr(1)===0&&(le.constantOr(1)===0||ge.constantOr(1)===0))return;const ze=D.context,Ne=ze.gl,Ge=D.transform,Je=D.getDepthModeForSublayer(0,gr.ReadOnly),qe=sr.disabled,at=D.colorModeForRenderPass(),ct=[],Ze=Ge.getCircleRadiusCorrection();for(let pt=0;pt<Z.length;pt++){const Tt=Z[pt],Mt=F.getTile(Tt),Et=Mt.getBucket(U);if(!Et)continue;const Dt=U.paint.get("circle-translate"),Sn=U.paint.get("circle-translate-anchor"),wn=s.aC(Ge,Mt,Dt,Sn),nn=Et.programConfigurations.get(U.id),Vn=D.useProgram("circle",nn),br=Et.layoutVertexBuffer,jr=Et.indexBuffer,Ei=D.style.map.terrain&&D.style.map.terrain.getTerrainData(Tt),ii={programConfiguration:nn,program:Vn,layoutVertexBuffer:br,indexBuffer:jr,uniformValues:Ip(D,Mt,U,wn,Ze),terrainData:Ei,projectionData:Ge.getProjectionData({overscaledTileID:Tt,applyGlobeMatrix:!ie,applyTerrainMatrix:!0})};if(Le){const ci=Et.segments.get();for(const ai of ci)ct.push({segments:new s.aL([ai]),sortKey:ai.sortKey,state:ii})}else ct.push({segments:Et.segments,sortKey:0,state:ii})}Le&&ct.sort((pt,Tt)=>pt.sortKey-Tt.sortKey);for(const pt of ct){const{programConfiguration:Tt,program:Mt,layoutVertexBuffer:Et,indexBuffer:Dt,uniformValues:Sn,terrainData:wn,projectionData:nn}=pt.state;Mt.draw(ze,Ne.TRIANGLES,Je,qe,at,yr.backCCW,Sn,wn,nn,U.id,Et,Dt,pt.segments,U.paint,D.transform.zoom,Tt)}}(i,u,g,_,M):s.cc(g)?function(D,F,U,Z,K){if(U.paint.get("heatmap-opacity")===0)return;const ie=D.context,{isRenderingToTexture:ne,isRenderingGlobe:le}=K;if(D.style.map.terrain){for(const ge of Z){const Le=F.getTile(ge);F.hasRenderableParent(ge)||(D.renderPass==="offscreen"?sc(D,Le,U,ge,le):D.renderPass==="translucent"&&Hc(D,U,ge,ne,le))}ie.viewport.set([0,0,D.width,D.height])}else D.renderPass==="offscreen"?function(ge,Le,ze,Ne){const Ge=ge.context,Je=Ge.gl,qe=ge.transform,at=sr.disabled,ct=new Tr([Je.ONE,Je.ONE],s.be.transparent,[!0,!0,!0,!0]);(function(Ze,pt,Tt){const Mt=Ze.gl;Ze.activeTexture.set(Mt.TEXTURE1),Ze.viewport.set([0,0,pt.width/4,pt.height/4]);let Et=Tt.heatmapFbos.get(s.c1);Et?(Mt.bindTexture(Mt.TEXTURE_2D,Et.colorAttachment.get()),Ze.bindFramebuffer.set(Et.framebuffer)):(Et=Oa(Ze,pt.width/4,pt.height/4),Tt.heatmapFbos.set(s.c1,Et))})(Ge,ge,ze),Ge.clear({color:s.be.transparent});for(let Ze=0;Ze<Ne.length;Ze++){const pt=Ne[Ze];if(Le.hasRenderableParent(pt))continue;const Tt=Le.getTile(pt),Mt=Tt.getBucket(ze);if(!Mt)continue;const Et=Mt.programConfigurations.get(ze.id),Dt=ge.useProgram("heatmap",Et),Sn=qe.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),wn=qe.getCircleRadiusCorrection();Dt.draw(Ge,Je.TRIANGLES,gr.disabled,at,ct,yr.backCCW,$h(Tt,qe.zoom,ze.paint.get("heatmap-intensity"),wn),null,Sn,ze.id,Mt.layoutVertexBuffer,Mt.indexBuffer,Mt.segments,ze.paint,qe.zoom,Et)}Ge.viewport.set([0,0,ge.width,ge.height])}(D,F,U,Z):D.renderPass==="translucent"&&function(ge,Le){const ze=ge.context,Ne=ze.gl;ze.setColorMode(ge.colorModeForRenderPass());const Ge=Le.heatmapFbos.get(s.c1);Ge&&(ze.activeTexture.set(Ne.TEXTURE0),Ne.bindTexture(Ne.TEXTURE_2D,Ge.colorAttachment.get()),ze.activeTexture.set(Ne.TEXTURE1),Jh(ze,Le).bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),ge.useProgram("heatmapTexture").draw(ze,Ne.TRIANGLES,gr.disabled,sr.disabled,ge.colorModeForRenderPass(),yr.disabled,ng(ge,Le,0,1),null,null,Le.id,ge.viewportBuffer,ge.quadTriangleIndexBuffer,ge.viewportSegments,Le.paint,ge.transform.zoom))}(D,U)}(i,u,g,_,M):s.cd(g)?function(D,F,U,Z,K){if(D.renderPass!=="translucent")return;const{isRenderingToTexture:ie}=K,ne=U.paint.get("line-opacity"),le=U.paint.get("line-width");if(ne.constantOr(1)===0||le.constantOr(1)===0)return;const ge=D.getDepthModeForSublayer(0,gr.ReadOnly),Le=D.colorModeForRenderPass(),ze=U.paint.get("line-dasharray"),Ne=U.paint.get("line-pattern"),Ge=Ne.constantOr(1),Je=U.paint.get("line-gradient"),qe=U.getCrossfadeParameters(),at=Ge?"linePattern":ze?"lineSDF":Je?"lineGradient":"line",ct=D.context,Ze=ct.gl,pt=D.transform;let Tt=!0;for(const Mt of Z){const Et=F.getTile(Mt);if(Ge&&!Et.patternsLoaded())continue;const Dt=Et.getBucket(U);if(!Dt)continue;const Sn=Dt.programConfigurations.get(U.id),wn=D.context.program.get(),nn=D.useProgram(at,Sn),Vn=Tt||nn.program!==wn,br=D.style.map.terrain&&D.style.map.terrain.getTerrainData(Mt),jr=Ne.constantOr(null);if(jr&&Et.imageAtlas){const Kr=Et.imageAtlas,ti=Kr.patternPositions[jr.to.toString()],go=Kr.patternPositions[jr.from.toString()];ti&&go&&Sn.setConstantPatternPositions(ti,go)}const Ei=pt.getProjectionData({overscaledTileID:Mt,applyGlobeMatrix:!ie,applyTerrainMatrix:!0}),ii=pt.getPixelScale(),ci=Ge?Rp(D,Et,U,ii,qe):ze?Lp(D,Et,U,ii,ze,qe):Je?sf(D,Et,U,ii,Dt.lineClipsArray.length):jh(D,Et,U,ii);if(Ge)ct.activeTexture.set(Ze.TEXTURE0),Et.imageAtlasTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE),Sn.updatePaintBuffers(qe);else if(ze&&(Vn||D.lineAtlas.dirty))ct.activeTexture.set(Ze.TEXTURE0),D.lineAtlas.bind(ct);else if(Je){const Kr=Dt.gradients[U.id];let ti=Kr.texture;if(U.gradientVersion!==Kr.version){let go=256;if(U.stepInterpolant){const Ar=F.getSource().maxzoom,so=Mt.canonical.z===Ar?Math.ceil(1<<D.transform.maxZoom-Mt.canonical.z):1;go=s.ag(s.c2(Dt.maxLineLength/s.$*1024*so),256,ct.maxTextureSize)}Kr.gradient=s.c3({expression:U.gradientExpression(),evaluationKey:"lineProgress",resolution:go,image:Kr.gradient||void 0,clips:Dt.lineClipsArray}),Kr.texture?Kr.texture.update(Kr.gradient):Kr.texture=new s.T(ct,Kr.gradient,Ze.RGBA),Kr.version=U.gradientVersion,ti=Kr.texture}ct.activeTexture.set(Ze.TEXTURE0),ti.bind(U.stepInterpolant?Ze.NEAREST:Ze.LINEAR,Ze.CLAMP_TO_EDGE)}const ai=D.stencilModeForClipping(Mt);nn.draw(ct,Ze.TRIANGLES,ge,ai,Le,yr.disabled,ci,br,Ei,U.id,Dt.layoutVertexBuffer,Dt.indexBuffer,Dt.segments,U.paint,D.transform.zoom,Sn,Dt.layoutVertexBuffer2),Tt=!1}}(i,u,g,_,M):s.ce(g)?function(D,F,U,Z,K){const ie=U.paint.get("fill-color"),ne=U.paint.get("fill-opacity");if(ne.constantOr(1)===0)return;const{isRenderingToTexture:le}=K,ge=D.colorModeForRenderPass(),Le=U.paint.get("fill-pattern"),ze=D.opaquePassEnabledForLayer()&&!Le.constantOr(1)&&ie.constantOr(s.be.transparent).a===1&&ne.constantOr(0)===1?"opaque":"translucent";if(D.renderPass===ze){const Ne=D.getDepthModeForSublayer(1,D.renderPass==="opaque"?gr.ReadWrite:gr.ReadOnly);Qh(D,F,U,Z,Ne,ge,!1,le)}if(D.renderPass==="translucent"&&U.paint.get("fill-antialias")){const Ne=D.getDepthModeForSublayer(U.getPaintProperty("fill-outline-color")?2:0,gr.ReadOnly);Qh(D,F,U,Z,Ne,ge,!0,le)}}(i,u,g,_,M):s.cf(g)?function(D,F,U,Z,K){const ie=U.paint.get("fill-extrusion-opacity");if(ie===0)return;const{isRenderingToTexture:ne}=K;if(D.renderPass==="translucent"){const le=new gr(D.context.gl.LEQUAL,gr.ReadWrite,D.depthRangeFor3D);if(ie!==1||U.paint.get("fill-extrusion-pattern").constantOr(1))Gc(D,F,U,Z,le,sr.disabled,Tr.disabled,ne),Gc(D,F,U,Z,le,D.stencilModeFor3D(),D.colorModeForRenderPass(),ne);else{const ge=D.colorModeForRenderPass();Gc(D,F,U,Z,le,sr.disabled,ge,ne)}}}(i,u,g,_,M):s.cg(g)?function(D,F,U,Z,K){if(D.renderPass!=="offscreen"&&D.renderPass!=="translucent")return;const{isRenderingToTexture:ie}=K,ne=D.context,le=D.style.projection.useSubdivision,ge=D.getDepthModeForSublayer(0,gr.ReadOnly),Le=D.colorModeForRenderPass();if(D.renderPass==="offscreen")(function(ze,Ne,Ge,Je,qe,at,ct){const Ze=ze.context,pt=Ze.gl;for(const Tt of Ge){const Mt=Ne.getTile(Tt),Et=Mt.dem;if(!Et||!Et.data||!Mt.needsHillshadePrepare)continue;const Dt=Et.dim,Sn=Et.stride,wn=Et.getPixels();if(Ze.activeTexture.set(pt.TEXTURE1),Ze.pixelStoreUnpackPremultiplyAlpha.set(!1),Mt.demTexture=Mt.demTexture||ze.getTileTexture(Sn),Mt.demTexture){const Vn=Mt.demTexture;Vn.update(wn,{premultiply:!1}),Vn.bind(pt.NEAREST,pt.CLAMP_TO_EDGE)}else Mt.demTexture=new s.T(Ze,wn,pt.RGBA,{premultiply:!1}),Mt.demTexture.bind(pt.NEAREST,pt.CLAMP_TO_EDGE);Ze.activeTexture.set(pt.TEXTURE0);let nn=Mt.fbo;if(!nn){const Vn=new s.T(Ze,{width:Dt,height:Dt,data:null},pt.RGBA);Vn.bind(pt.LINEAR,pt.CLAMP_TO_EDGE),nn=Mt.fbo=Ze.createFramebuffer(Dt,Dt,!0,!1),nn.colorAttachment.set(Vn.texture)}Ze.bindFramebuffer.set(nn.framebuffer),Ze.viewport.set([0,0,Dt,Dt]),ze.useProgram("hillshadePrepare").draw(Ze,pt.TRIANGLES,qe,at,ct,yr.disabled,Vh(Mt.tileID,Et),null,null,Je.id,ze.rasterBoundsBuffer,ze.quadTriangleIndexBuffer,ze.rasterBoundsSegments),Mt.needsHillshadePrepare=!1}})(D,F,Z,U,ge,sr.disabled,Le),ne.viewport.set([0,0,D.width,D.height]);else if(D.renderPass==="translucent")if(le){const[ze,Ne,Ge]=D.stencilConfigForOverlapTwoPass(Z);fl(D,F,U,Ge,ze,ge,Le,!1,ie),fl(D,F,U,Ge,Ne,ge,Le,!0,ie)}else{const[ze,Ne]=D.getStencilConfigForOverlapAndUpdateStencilID(Z);fl(D,F,U,Ne,ze,ge,Le,!1,ie)}}(i,u,g,_,M):s.ch(g)?function(D,F,U,Z,K){if(D.renderPass!=="translucent"||!Z.length)return;const{isRenderingToTexture:ie}=K,ne=D.style.projection.useSubdivision,le=D.getDepthModeForSublayer(0,gr.ReadOnly),ge=D.colorModeForRenderPass();if(ne){const[Le,ze,Ne]=D.stencilConfigForOverlapTwoPass(Z);ac(D,F,U,Ne,Le,le,ge,!1,ie),ac(D,F,U,Ne,ze,le,ge,!0,ie)}else{const[Le,ze]=D.getStencilConfigForOverlapAndUpdateStencilID(Z);ac(D,F,U,ze,Le,le,ge,!1,ie)}}(i,u,g,_,M):s.ci(g)?function(D,F,U,Z,K){if(D.renderPass!=="translucent"||U.paint.get("raster-opacity")===0||!Z.length)return;const{isRenderingToTexture:ie}=K,ne=F.getSource(),le=D.style.projection.useSubdivision;if(ne instanceof Nn)Fa(D,F,U,Z,null,!1,!1,ne.tileCoords,ne.flippedWindingOrder,ie);else if(le){const[ge,Le,ze]=D.stencilConfigForOverlapTwoPass(Z);Fa(D,F,U,ze,ge,!1,!0,ed,!1,ie),Fa(D,F,U,ze,Le,!0,!0,ed,!1,ie)}else{const[ge,Le]=D.getStencilConfigForOverlapAndUpdateStencilID(Z);Fa(D,F,U,Le,ge,!1,!0,ed,!1,ie)}}(i,u,g,_,M):s.cj(g)?function(D,F,U,Z,K){const ie=U.paint.get("background-color"),ne=U.paint.get("background-opacity");if(ne===0)return;const{isRenderingToTexture:le}=K,ge=D.context,Le=ge.gl,ze=D.style.projection,Ne=D.transform,Ge=Ne.tileSize,Je=U.paint.get("background-pattern");if(D.isPatternMissing(Je))return;const qe=!Je&&ie.a===1&&ne===1&&D.opaquePassEnabledForLayer()?"opaque":"translucent";if(D.renderPass!==qe)return;const at=sr.disabled,ct=D.getDepthModeForSublayer(0,qe==="opaque"?gr.ReadWrite:gr.ReadOnly),Ze=D.colorModeForRenderPass(),pt=D.useProgram(Je?"backgroundPattern":"background"),Tt=Z||$e(Ne,{tileSize:Ge,terrain:D.style.map.terrain});Je&&(ge.activeTexture.set(Le.TEXTURE0),D.imageManager.bind(D.context));const Mt=U.getCrossfadeParameters();for(const Et of Tt){const Dt=Ne.getProjectionData({overscaledTileID:Et,applyGlobeMatrix:!le,applyTerrainMatrix:!0}),Sn=Je?by(ne,D,Je,{tileID:Et,tileSize:Ge},Mt):Ql(ne,ie),wn=D.style.map.terrain&&D.style.map.terrain.getTerrainData(Et),nn=ze.getMeshFromTileID(ge,Et.canonical,!1,!0,"raster");pt.draw(ge,Le.TRIANGLES,ct,at,Ze,yr.backCCW,Sn,wn,Dt,U.id,nn.vertexBuffer,nn.indexBuffer,nn.segments)}}(i,0,g,_,M):s.ck(g)&&function(D,F,U,Z){const{isRenderingGlobe:K}=Z,ie=D.context,ne=U.implementation,le=D.style.projection,ge=D.transform,Le=ge.getProjectionDataForCustomLayer(K),ze={farZ:ge.farZ,nearZ:ge.nearZ,fov:ge.fov*Math.PI/180,modelViewProjectionMatrix:ge.modelViewProjectionMatrix,projectionMatrix:ge.projectionMatrix,shaderData:{variantName:le.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${le.shaderPreludeCode.vertexSource}`,define:le.shaderDefine},defaultProjectionData:Le},Ne=ne.renderingMode?ne.renderingMode:"2d";if(D.renderPass==="offscreen"){const Ge=ne.prerender;Ge&&(D.setCustomLayerDefaults(),ie.setColorMode(D.colorModeForRenderPass()),Ge.call(ne,ie.gl,ze),ie.setDirty(),D.setBaseState())}else if(D.renderPass==="translucent"){D.setCustomLayerDefaults(),ie.setColorMode(D.colorModeForRenderPass()),ie.setStencilMode(sr.disabled);const Ge=Ne==="3d"?D.getDepthModeFor3D():D.getDepthModeForSublayer(0,gr.ReadOnly);ie.setDepthMode(Ge),ne.render(ie.gl,ze),ie.setDirty(),D.setBaseState(),ie.bindFramebuffer.set(null)}}(i,0,g,M))}saveTileTexture(i){const u=this._tileTextures[i.size[0]];u?u.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const u=this._tileTextures[i];return u&&u.length>0?u.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const u=this.imageManager.getPattern(i.from.toString()),g=this.imageManager.getPattern(i.to.toString());return!u||!g}useProgram(i,u,g=!1,_=[]){this.cache=this.cache||{};const M=!!this.style.map.terrain,D=this.style.projection,F=g?io.projectionMercator:D.shaderPreludeCode,U=g?Xl:D.shaderDefine,Z=i+(u?u.cacheKey:"")+`/${g?tf:D.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(M?"/terrain":"")+(_?`/${_.join("/")}`:"");return this.cache[Z]||(this.cache[Z]=new rf(this.context,io[i],u,sg[i],this._showOverdrawInspector,M,F,U,_)),this.cache[Z]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:u}=this.context.gl;return this.width!==i||this.height!==u}}function Fu(S,i){let u,g=!1,_=null,M=null;const D=()=>{_=null,g&&(S.apply(M,u),_=setTimeout(D,i),g=!1)};return(...F)=>(g=!0,M=this,u=F,_||D(),_)}class nd{constructor(i){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let g;return u.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(g=_)}),(g&&g[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const g=u.join("/");let _=g;_.split("&").length>0&&(_=_.split("&")[0]),this._hashName&&(_=`${this._hashName}=${g}`);let M=window.location.hash.replace(_,"");M.startsWith("#&")?M=M.slice(0,1)+M.slice(2):M==="#"&&(M="");let D=window.location.href.replace(/(#.+)?$/,M);D=D.replace("&&","&"),window.history.replaceState(window.history.state,null,D)},this._updateHash=Fu(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(i){const u=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,_=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),M=Math.pow(10,_),D=Math.round(u.lng*M)/M,F=Math.round(u.lat*M)/M,U=this._map.getBearing(),Z=this._map.getPitch();let K="";if(K+=i?`/${D}/${F}/${g}`:`${g}/${F}/${D}`,(U||Z)&&(K+="/"+Math.round(10*U)/10),Z&&(K+=`/${Math.round(Z)}`),this._hashName){const ie=this._hashName;let ne=!1;const le=window.location.hash.slice(1).split("&").map(ge=>{const Le=ge.split("=")[0];return Le===ie?(ne=!0,`${Le}=${K}`):ge}).filter(ge=>ge);return ne||le.push(`${ie}=${K}`),`#${le.join("&")}`}return`#${K}`}_isValidHash(i){if(i.length<3||i.some(isNaN))return!1;try{new s.S(+i[2],+i[1])}catch{return!1}const u=+i[0],g=+(i[3]||0),_=+(i[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&g>=-180&&g<=180&&_>=this._map.getMinPitch()&&_<=this._map.getMaxPitch()}}const Nu={linearity:.3,easing:s.cl(0,0,.3,1)},ta=s.e({deceleration:2500,maxSpeed:1400},Nu),Xc=s.e({deceleration:20,maxSpeed:1400},Nu),Na=s.e({deceleration:1e3,maxSpeed:360},Nu),Bu=s.e({deceleration:1e3,maxSpeed:90},Nu),mf=s.e({deceleration:1e3,maxSpeed:360},Nu);class Zc{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:E.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,u=E.now();for(;i.length>0&&u-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:M}of this._inertiaBuffer)u.zoom+=M.zoomDelta||0,u.bearing+=M.bearingDelta||0,u.pitch+=M.pitchDelta||0,u.roll+=M.rollDelta||0,M.panDelta&&u.pan._add(M.panDelta),M.around&&(u.around=M.around),M.pinchAround&&(u.pinchAround=M.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(u.pan.mag()){const M=ri(u.pan.mag(),g,s.e({},ta,i||{})),D=u.pan.mult(M.amount/u.pan.mag()),F=this._map.cameraHelper.handlePanInertia(D,this._map.transform);_.center=F.easingCenter,_.offset=F.easingOffset,Ds(_,M)}if(u.zoom){const M=ri(u.zoom,g,Xc);_.zoom=this._map.transform.zoom+M.amount,Ds(_,M)}if(u.bearing){const M=ri(u.bearing,g,Na);_.bearing=this._map.transform.bearing+s.ag(M.amount,-179,179),Ds(_,M)}if(u.pitch){const M=ri(u.pitch,g,Bu);_.pitch=this._map.transform.pitch+M.amount,Ds(_,M)}if(u.roll){const M=ri(u.roll,g,mf);_.roll=this._map.transform.roll+s.ag(M.amount,-179,179),Ds(_,M)}if(_.zoom||_.bearing){const M=u.pinchAround===void 0?u.around:u.pinchAround;_.around=M?this._map.unproject(M):this._map.getCenter()}return this.clear(),s.e(_,{noMoveStart:!0})}}function Ds(S,i){(!S.duration||S.duration<i.duration)&&(S.duration=i.duration,S.easing=i.easing)}function ri(S,i,u){const{maxSpeed:g,linearity:_,deceleration:M}=u,D=s.ag(S*_/(i/1e3),-g,g),F=Math.abs(D)/(M*_);return{easing:u.easing,duration:1e3*F,amount:D*(F/2)}}class Pr extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,g,_={}){g=g instanceof MouseEvent?g:new MouseEvent(i,g);const M=T.mousePos(u.getCanvas(),g),D=u.unproject(M);super(i,s.e({point:M,lngLat:D,originalEvent:g},_)),this._defaultPrevented=!1,this.target=u}}class po extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,g){const _=i==="touchend"?g.changedTouches:g.touches,M=T.touchPos(u.getCanvasContainer(),_),D=M.map(U=>u.unproject(U)),F=M.reduce((U,Z,K,ie)=>U.add(Z.div(ie.length)),new s.P(0,0));super(i,{points:M,point:F,lngLats:D,lngLat:u.unproject(F),originalEvent:g}),this._defaultPrevented=!1}}class mo extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,g){super(i,{originalEvent:g}),this._defaultPrevented=!1}}class rs{constructor(i,u){this._map=i,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new mo(i.type,this._map,i))}mousedown(i,u){return this._mousedownPos=u,this._firePreventable(new Pr(i.type,this._map,i))}mouseup(i){this._map.fire(new Pr(i.type,this._map,i))}click(i,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Pr(i.type,this._map,i))}dblclick(i){return this._firePreventable(new Pr(i.type,this._map,i))}mouseover(i){this._map.fire(new Pr(i.type,this._map,i))}mouseout(i){this._map.fire(new Pr(i.type,this._map,i))}touchstart(i){return this._firePreventable(new po(i.type,this._map,i))}touchmove(i){this._map.fire(new po(i.type,this._map,i))}touchend(i){this._map.fire(new po(i.type,this._map,i))}touchcancel(i){this._map.fire(new po(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class lc{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new Pr(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new Pr(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ma{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.screenPointToLocation(s.P.convert(i),this._map.terrain)}}class $o{constructor(i,u){this._map=i,this._tr=new ma(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,u){this.isEnabled()&&i.shiftKey&&i.button===0&&(T.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(i,u){if(!this._active)return;const g=u;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=g,this._box||(this._box=T.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const M=Math.min(_.x,g.x),D=Math.max(_.x,g.x),F=Math.min(_.y,g.y),U=Math.max(_.y,g.y);T.setTransform(this._box,`translate(${M}px,${F}px)`),this._box.style.width=D-M+"px",this._box.style.height=U-F+"px"}mouseupWindow(i,u){if(!this._active||i.button!==0)return;const g=this._startPos,_=u;if(this.reset(),T.suppressClick(),g.x!==_.x||g.y!==_.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:i})),{cameraAnimation:M=>M.fitScreenCoordinates(g,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(T.remove(this._box),this._box=null),T.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,u){return this._map.fire(new s.l(i,{originalEvent:u}))}}function Yc(S,i){if(S.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${S.length}, points ${i.length}`);const u={};for(let g=0;g<S.length;g++)u[S[g].identifier]=i[g];return u}class Xp{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),g.length===this.numTouches&&(this.centroid=function(_){const M=new s.P(0,0);for(const D of _)M._add(D);return M.div(_.length)}(u),this.touches=Yc(g,u)))}touchmove(i,u,g){if(this.aborted||!this.centroid)return;const _=Yc(g,u);for(const M in this.touches){const D=_[M];(!D||D.dist(this.touches[M])>30)&&(this.aborted=!0)}}touchend(i,u,g){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class rd{constructor(i){this.singleTap=new Xp(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,u,g){this.singleTap.touchstart(i,u,g)}touchmove(i,u,g){this.singleTap.touchmove(i,u,g)}touchend(i,u,g){const _=this.singleTap.touchend(i,u,g);if(_){const M=i.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(_)<30;if(M&&D||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Kc{constructor(i){this._tr=new ma(i),this._zoomIn=new rd({numTouches:1,numTaps:2}),this._zoomOut=new rd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,u,g){this._zoomIn.touchstart(i,u,g),this._zoomOut.touchstart(i,u,g)}touchmove(i,u,g){this._zoomIn.touchmove(i,u,g),this._zoomOut.touchmove(i,u,g)}touchend(i,u,g){const _=this._zoomIn.touchend(i,u,g),M=this._zoomOut.touchend(i,u,g),D=this._tr;return _?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:D.zoom+1,around:D.unproject(_)},{originalEvent:i})}):M?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:D.zoom-1,around:D.unproject(M)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jc{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const u=this._moveFunction(...i);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(i,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,u){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const _=Array.isArray(u)?u[0]:u;return!this._moved&&_.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(g,_))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&T.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ki=0,ys=2,gf={[Ki]:1,[ys]:2};class Vo{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const u=T.mouseButton(i);this._eventButton=u}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!function(u,g){const _=gf[g];return u.buttons===void 0||(u.buttons&_)!==_}(i,this._eventButton)}isValidEndEvent(i){return T.mouseButton(i)===this._eventButton}}class Uu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}class cc{constructor(i=new Vo({checkCorrectEvent:()=>!0}),u=new Uu){this.mouseMoveStateManager=i,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(i,u,g){return i instanceof MouseEvent?u(i):typeof TouchEvent<"u"&&i instanceof TouchEvent?g(i):void 0}startMove(i){this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.startMove(u),u=>this.oneFingerTouchMoveStateManager.startMove(u))}endMove(i){this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.endMove(u),u=>this.oneFingerTouchMoveStateManager.endMove(u))}isValidStartEvent(i){return this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.isValidStartEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u))}isValidMoveEvent(i){return this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.isValidMoveEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u))}isValidEndEvent(i){return this._executeRelevantHandler(i,u=>this.mouseMoveStateManager.isValidEndEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u))}}const pl=S=>{S.mousedown=S.dragStart,S.mousemoveWindow=S.dragMove,S.mouseup=S.dragEnd,S.contextmenu=i=>{i.preventDefault()}};class $u{constructor(i,u){this._clickTolerance=i.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(i){return i<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(i,u,g){return this._calculateTransform(i,u,g)}touchmove(i,u,g){if(this._active){if(!this._shouldBePrevented(g.length))return i.preventDefault(),this._calculateTransform(i,u,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",i)}}touchend(i,u,g){this._calculateTransform(i,u,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,u,g){g.length>0&&(this._active=!0);const _=Yc(g,u),M=new s.P(0,0),D=new s.P(0,0);let F=0;for(const Z in _){const K=_[Z],ie=this._touches[Z];ie&&(M._add(K),D._add(K.sub(ie)),F++,_[Z]=K)}if(this._touches=_,this._shouldBePrevented(F)||!D.mag())return;const U=D.div(F);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:M.div(F),panDelta:U}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(i,u,g){if(!this._firstTwoTouches)return;i.preventDefault();const[_,M]=this._firstTwoTouches,D=uc(g,u,_),F=uc(g,u,M);if(!D||!F)return;const U=this._aroundCenter?null:D.add(F).div(2);return this._move([D,F],U,i)}touchend(i,u,g){if(!this._firstTwoTouches)return;const[_,M]=this._firstTwoTouches,D=uc(g,u,_),F=uc(g,u,M);D&&F||(this._active&&T.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function uc(S,i,u){for(let g=0;g<S.length;g++)if(S[g].identifier===u)return i[g]}function Ao(S,i){return Math.log(S/i)/Math.LN2}class Hi extends Vu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,u){const g=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Ao(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ao(this._distance,g),pinchAround:u}}}function zn(S,i){return 180*S.angleWith(i)/Math.PI}class ga extends Vu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,u,g){const _=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zn(this._vector,_),pinchAround:u}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const u=25/(Math.PI*this._minDiameter)*360,g=zn(i,this._startVector);return Math.abs(g)<u}}function ks(S){return Math.abs(S.y)>Math.abs(S.x)}class ml extends Vu{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,u,g){super.touchstart(i,u,g),this._currentTouchCount=g.length}_start(i){this._lastPoints=i,ks(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,u,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=i[0].sub(this._lastPoints[0]),M=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,M,g.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(_.y+M.y)/2*-.5}):void 0}gestureBeginsVertically(i,u,g){if(this._valid!==void 0)return this._valid;const _=i.mag()>=2,M=u.mag()>=2;if(!_&&!M)return;if(!_||!M)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const D=i.y>0==u.y>0;return ks(i)&&ks(u)&&D}}const ju={panStep:100,bearingStep:15,pitchStep:10};class hc{constructor(i){this._tr=new ma(i);const u=ju;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let u=0,g=0,_=0,M=0,D=0;switch(i.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:i.shiftKey?g=-1:(i.preventDefault(),M=-1);break;case 39:i.shiftKey?g=1:(i.preventDefault(),M=1);break;case 38:i.shiftKey?_=1:(i.preventDefault(),D=-1);break;case 40:i.shiftKey?_=-1:(i.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(g=0,_=0),{cameraAnimation:F=>{const U=this._tr;F.easeTo({duration:300,easeId:"keyboardHandler",easing:id,zoom:u?Math.round(U.zoom)+u*(i.shiftKey?2:1):U.zoom,bearing:U.bearing+g*this._bearingStep,pitch:U.pitch+_*this._pitchStep,offset:[-M*this._panStep,-D*this._panStep],center:U.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function id(S){return S*(2-S)}const dr=4.000244140625,is=1/450;class Mi{constructor(i,u){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=i,this._tr=new ma(i),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=is}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(i){return!!this._map.cooperativeGestures.isEnabled()&&!(i.ctrlKey||this._map.cooperativeGestures.isBypassed(i))}wheel(i){if(!this.isEnabled())return;if(this._shouldBePrevented(i))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",i);let u=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const g=E.now(),_=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%dr==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(_*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),i.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=i,this._delta-=u,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=T.mousePos(this._map.getCanvas(),i),g=this._tr;this._aroundPoint=this._aroundCenter?g.transform.locationToScreenPoint(s.S.convert(g.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const F=i.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=F),typeof this._targetZoom=="number"&&(this._targetZoom+=F)}if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>dr?this._wheelZoomRate:this._defaultZoomRate;let U=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&U!==0&&(U=1/U);const Z=typeof this._targetZoom!="number"?i.scale:s.ae(this._targetZoom);this._targetZoom=i.getConstrained(i.getCameraLngLat(),s.aj(Z*U)).zoom,this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?i.zoom:this._targetZoom,g=this._startZoom,_=this._easing;let M,D=!1;if(this._type==="wheel"&&g&&_){const F=E.now()-this._lastWheelEventTime,U=Math.min((F+5)/200,1),Z=_(U);M=s.C.number(g,u,Z),U<1?this._frameId||(this._frameId=!0):D=!0}else M=u,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=M,{noInertia:!0,needsRenderFrame:!D,zoomDelta:M-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let u=s.cn;if(this._prevEase){const g=this._prevEase,_=(E.now()-g.start)/g.duration,M=g.easing(_+.01)-g.easing(_),D=.27/Math.sqrt(M*M+1e-4)*.01,F=Math.sqrt(.0729-D*D);u=s.cl(D,F,.25,1)}return this._prevEase={start:E.now(),duration:i,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class _s{constructor(i,u){this._clickZoom=i,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class mg{constructor(i){this._tr=new ma(i),this.reset()}reset(){this._active=!1}dblclick(i,u){return i.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gg{constructor(){this._tap=new rd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,u,g){if(!this._swipePoint)if(this._tapTime){const _=u[0],M=i.timeStamp-this._tapTime<500,D=this._tapPoint.dist(_)<30;M&&D?g.length>0&&(this._swipePoint=_,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(i,u,g)}touchmove(i,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const _=u[0],M=_.y-this._swipePoint.y;return this._swipePoint=_,i.preventDefault(),this._active=!0,{zoomDelta:M/128}}}else this._tap.touchmove(i,u,g)}touchend(i,u,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const _=this._tap.touchend(i,u,g);_&&(this._tapTime=i.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class od{constructor(i,u,g){this._el=i,this._mousePan=u,this._touchPan=g}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Hu{constructor(i,u,g,_){this._pitchWithRotate=i.pitchWithRotate,this._rollEnabled=i.rollEnabled,this._mouseRotate=u,this._mousePitch=g,this._mouseRoll=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class vf{constructor(i,u,g,_){this._el=i,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class sd{constructor(i,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=T.create("div","maplibregl-cooperative-gesture-screen",i);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=u,this._container.appendChild(_);const M=document.createElement("div");M.className="maplibregl-mobile-message",M.textContent=g,this._container.appendChild(M),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(T.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(i){return i[this._bypassKey]}notifyGestureBlocked(i,u){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:i,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Gu=S=>S.zoom||S.drag||S.roll||S.pitch||S.rotate;class Wu extends s.l{}function ad(S){return S.panDelta&&S.panDelta.mag()||S.zoomDelta||S.bearingDelta||S.pitchDelta||S.rollDelta}class dc{constructor(i,u){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,M)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const D=_.type==="renderFrame"?void 0:_,F={needsRenderFrame:!1},U={},Z={};for(const{handlerName:ne,handler:le,allowed:ge}of this._handlers){if(!le.isEnabled())continue;let Le;if(this._blockedByActive(Z,ge,ne))le.reset();else if(le[M||_.type]){if(s.co(_,M||_.type)){const ze=T.mousePos(this._map.getCanvas(),_);Le=le[M||_.type](_,ze)}else if(s.cp(_,M||_.type)){const ze=this._getMapTouches(_.touches),Ne=T.touchPos(this._map.getCanvas(),ze);Le=le[M||_.type](_,Ne,ze)}else s.cq(M||_.type)||(Le=le[M||_.type](_));this.mergeHandlerResult(F,U,Le,ne,D),Le&&Le.needsRenderFrame&&this._triggerRenderFrame()}(Le||le.isActive())&&(Z[ne]=le)}const K={};for(const ne in this._previousActiveHandlers)Z[ne]||(K[ne]=D);this._previousActiveHandlers=Z,(Object.keys(K).length||ad(F))&&(this._changes.push([F,U,K]),this._triggerRenderFrame()),(Object.keys(Z).length||ad(F))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ie}=F;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zc(i),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,M,D]of this._listeners)T.addEventListener(_,M,_===document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[i,u,g]of this._listeners)T.removeEventListener(i,u,i===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(i){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new rs(u,i));const _=u.boxZoom=new $o(u,i);this._add("boxZoom",_),i.interactive&&i.boxZoom&&_.enable();const M=u.cooperativeGestures=new sd(u,i.cooperativeGestures);this._add("cooperativeGestures",M),i.cooperativeGestures&&M.enable();const D=new Kc(u),F=new mg(u);u.doubleClickZoom=new _s(F,D),this._add("tapZoom",D),this._add("clickZoom",F),i.interactive&&i.doubleClickZoom&&u.doubleClickZoom.enable();const U=new gg;this._add("tapDragZoom",U);const Z=u.touchPitch=new ml(u);this._add("touchPitch",Z),i.interactive&&i.touchPitch&&u.touchPitch.enable(i.touchPitch);const K=()=>u.project(u.getCenter()),ie=function({enable:qe,clickTolerance:at,aroundCenter:ct=!0,minPixelCenterThreshold:Ze=100,rotateDegreesPerPixelMoved:pt=.8},Tt){const Mt=new Vo({checkCorrectEvent:Et=>T.mouseButton(Et)===0&&Et.ctrlKey||T.mouseButton(Et)===2&&!Et.ctrlKey});return new Jc({clickTolerance:at,move:(Et,Dt)=>{const Sn=Tt();if(ct&&Math.abs(Sn.y-Et.y)>Ze)return{bearingDelta:s.cm(new s.P(Et.x,Dt.y),Dt,Sn)};let wn=(Dt.x-Et.x)*pt;return ct&&Dt.y<Sn.y&&(wn=-wn),{bearingDelta:wn}},moveStateManager:Mt,enable:qe,assignEvents:pl})}(i,K),ne=function({enable:qe,clickTolerance:at,pitchDegreesPerPixelMoved:ct=-.5}){const Ze=new Vo({checkCorrectEvent:pt=>T.mouseButton(pt)===0&&pt.ctrlKey||T.mouseButton(pt)===2});return new Jc({clickTolerance:at,move:(pt,Tt)=>({pitchDelta:(Tt.y-pt.y)*ct}),moveStateManager:Ze,enable:qe,assignEvents:pl})}(i),le=function({enable:qe,clickTolerance:at,rollDegreesPerPixelMoved:ct=.3},Ze){const pt=new Vo({checkCorrectEvent:Tt=>T.mouseButton(Tt)===2&&Tt.ctrlKey});return new Jc({clickTolerance:at,move:(Tt,Mt)=>{const Et=Ze();let Dt=(Mt.x-Tt.x)*ct;return Mt.y<Et.y&&(Dt=-Dt),{rollDelta:Dt}},moveStateManager:pt,enable:qe,assignEvents:pl})}(i,K);u.dragRotate=new Hu(i,ie,ne,le),this._add("mouseRotate",ie,["mousePitch"]),this._add("mousePitch",ne,["mouseRotate","mouseRoll"]),this._add("mouseRoll",le,["mousePitch"]),i.interactive&&i.dragRotate&&u.dragRotate.enable();const ge=function({enable:qe,clickTolerance:at}){const ct=new Vo({checkCorrectEvent:Ze=>T.mouseButton(Ze)===0&&!Ze.ctrlKey});return new Jc({clickTolerance:at,move:(Ze,pt)=>({around:pt,panDelta:pt.sub(Ze)}),activateOnStart:!0,moveStateManager:ct,enable:qe,assignEvents:pl})}(i),Le=new $u(i,u);u.dragPan=new od(g,ge,Le),this._add("mousePan",ge),this._add("touchPan",Le,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&u.dragPan.enable(i.dragPan);const ze=new ga,Ne=new Hi;u.touchZoomRotate=new vf(g,Ne,ze,U),this._add("touchRotate",ze,["touchPan","touchZoom"]),this._add("touchZoom",Ne,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&u.touchZoomRotate.enable(i.touchZoomRotate);const Ge=u.scrollZoom=new Mi(u,()=>this._triggerRenderFrame());this._add("scrollZoom",Ge,["mousePan"]),i.interactive&&i.scrollZoom&&u.scrollZoom.enable(i.scrollZoom);const Je=u.keyboard=new hc(u);this._add("keyboard",Je),i.interactive&&i.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new lc(u))}_add(i,u,g){this._handlers.push({handlerName:i,handler:u,allowed:g}),this._handlersById[i]=u}stop(i){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Gu(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,u,g){for(const _ in i)if(_!==g&&(!u||u.indexOf(_)<0))return!0;return!1}_getMapTouches(i){const u=[];for(const g of i)this._el.contains(g.target)&&u.push(g);return u}mergeHandlerResult(i,u,g,_,M){if(!g)return;s.e(i,g);const D={handlerName:_,originalEvent:g.originalEvent||M};g.zoomDelta!==void 0&&(u.zoom=D),g.panDelta!==void 0&&(u.drag=D),g.rollDelta!==void 0&&(u.roll=D),g.pitchDelta!==void 0&&(u.pitch=D),g.bearingDelta!==void 0&&(u.rotate=D)}_applyChanges(){const i={},u={},g={};for(const[_,M,D]of this._changes)_.panDelta&&(i.panDelta=(i.panDelta||new s.P(0,0))._add(_.panDelta)),_.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+_.pitchDelta),_.rollDelta&&(i.rollDelta=(i.rollDelta||0)+_.rollDelta),_.around!==void 0&&(i.around=_.around),_.pinchAround!==void 0&&(i.pinchAround=_.pinchAround),_.noInertia&&(i.noInertia=_.noInertia),s.e(u,M),s.e(g,D);this._updateMapTransform(i,u,g),this._changes=[]}_updateMapTransform(i,u,g){const _=this._map,M=_._getTransformForUpdate(),D=_.terrain;if(!(ad(i)||D&&this._terrainMovement))return this._fireEvents(u,g,!0);_._stop(!0);let{panDelta:F,zoomDelta:U,bearingDelta:Z,pitchDelta:K,rollDelta:ie,around:ne,pinchAround:le}=i;le!==void 0&&(ne=le),ne=ne||_.transform.centerPoint,D&&!M.isPointOnMapSurface(ne)&&(ne=M.centerPoint);const ge={panDelta:F,zoomDelta:U,rollDelta:ie,pitchDelta:K,bearingDelta:Z,around:ne};this._map.cameraHelper.useGlobeControls&&!M.isPointOnMapSurface(ne)&&(ne=M.centerPoint);const Le=ne.distSqr(M.centerPoint)<.01?M.center:M.screenPointToLocation(F?ne.sub(F):ne);D?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ge,M),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?M.setCenter(M.screenPointToLocation(M.centerPoint.sub(F))):this._map.cameraHelper.handleMapControlsPan(ge,M,Le):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ge,M,Le))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ge,M),this._map.cameraHelper.handleMapControlsPan(ge,M,Le)),_._applyUpdatedTransform(M),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(u,g,!0)}_fireEvents(i,u,g){const _=Gu(this._eventsInProgress),M=Gu(i),D={};for(const ie in i){const{originalEvent:ne}=i[ie];this._eventsInProgress[ie]||(D[`${ie}start`]=ne),this._eventsInProgress[ie]=i[ie]}!_&&M&&this._fireEvent("movestart",M.originalEvent);for(const ie in D)this._fireEvent(ie,D[ie]);M&&this._fireEvent("move",M.originalEvent);for(const ie in i){const{originalEvent:ne}=i[ie];this._fireEvent(ie,ne)}const F={};let U;for(const ie in this._eventsInProgress){const{handlerName:ne,originalEvent:le}=this._eventsInProgress[ie];this._handlersById[ne].isActive()||(delete this._eventsInProgress[ie],U=u[ne]||le,F[`${ie}end`]=U)}for(const ie in F)this._fireEvent(ie,F[ie]);const Z=Gu(this._eventsInProgress),K=(_||M)&&!Z;if(K&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const ie=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&ie.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(ie)}if(g&&K){this._updatingCamera=!0;const ie=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ne=le=>le!==0&&-this._bearingSnap<le&&le<this._bearingSnap;!ie||!ie.essential&&E.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:U})),ne(this._map.getBearing())&&this._map.resetNorth()):(ne(ie.bearing||this._map.getBearing())&&(ie.bearing=0),ie.freezeElevation=!0,this._map.easeTo(ie,{originalEvent:U})),this._updatingCamera=!1}}_fireEvent(i,u){this._map.fire(new s.l(i,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new Wu("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class si extends s.E{constructor(i,u,g){super(),this._renderFrameCallback=()=>{const _=Math.min((E.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=g.bearingSnap,this.cameraHelper=u,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(i,u){i.apply(this.transform),this.transform=i,this.cameraHelper=u}getCenter(){return new s.S(this.transform.center.lng,this.transform.center.lat)}setCenter(i,u){return this.jumpTo({center:i},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(i,u){return this.jumpTo({elevation:i},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(i){this._centerClampedToGround=i}panBy(i,u,g){return i=s.P.convert(i).mult(-1),this.panTo(this.transform.center,s.e({offset:i},u),g)}panTo(i,u,g){return this.easeTo(s.e({center:i},u),g)}getZoom(){return this.transform.zoom}setZoom(i,u){return this.jumpTo({zoom:i},u),this}zoomTo(i,u,g){return this.easeTo(s.e({zoom:i},u),g)}zoomIn(i,u){return this.zoomTo(this.getZoom()+1,i,u),this}zoomOut(i,u){return this.zoomTo(this.getZoom()-1,i,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(i,u){return i!=this.transform.fov&&(this.transform.setFov(i),this.fire(new s.l("movestart",u)).fire(new s.l("move",u)).fire(new s.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(i,u){return this.jumpTo({bearing:i},u),this}getPadding(){return this.transform.padding}setPadding(i,u){return this.jumpTo({padding:i},u),this}rotateTo(i,u,g){return this.easeTo(s.e({bearing:i},u),g)}resetNorth(i,u){return this.rotateTo(0,s.e({duration:1e3},i),u),this}resetNorthPitch(i,u){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},i),u),this}snapToNorth(i,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,u):this}getPitch(){return this.transform.pitch}setPitch(i,u){return this.jumpTo({pitch:i},u),this}getRoll(){return this.transform.roll}setRoll(i,u){return this.jumpTo({roll:i},u),this}cameraForBounds(i,u){i=un.convert(i).adjustAntiMeridian();const g=u&&u.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),g,u)}_cameraForBoxAndBearing(i,u,g,_){const M={top:0,bottom:0,right:0,left:0};if(typeof(_=s.e({padding:M,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const Z=_.padding;_.padding={top:Z,bottom:Z,right:Z,left:Z}}const D=s.e(M,_.padding);_.padding=D;const F=this.transform,U=new un(i,u);return this.cameraHelper.cameraForBoxAndBearing(_,D,U,g,F)}fitBounds(i,u,g){return this._fitInternal(this.cameraForBounds(i,u),u,g)}fitScreenCoordinates(i,u,g,_,M){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(i)),this.transform.screenPointToLocation(s.P.convert(u)),g,_),_,M)}_fitInternal(i,u,g){return i?(delete(u=s.e(i,u)).padding,u.linear?this.easeTo(u,g):this.flyTo(u,g)):this}jumpTo(i,u){this.stop();const g=this._getTransformForUpdate();let _=!1,M=!1,D=!1;const F=g.zoom;this.cameraHelper.handleJumpToCenterZoom(g,i);const U=g.zoom!==F;return"elevation"in i&&g.elevation!==+i.elevation&&g.setElevation(+i.elevation),"bearing"in i&&g.bearing!==+i.bearing&&(_=!0,g.setBearing(+i.bearing)),"pitch"in i&&g.pitch!==+i.pitch&&(M=!0,g.setPitch(+i.pitch)),"roll"in i&&g.roll!==+i.roll&&(D=!0,g.setRoll(+i.roll)),i.padding==null||g.isPaddingEqual(i.padding)||g.setPadding(i.padding),this._applyUpdatedTransform(g),this.fire(new s.l("movestart",u)).fire(new s.l("move",u)),U&&this.fire(new s.l("zoomstart",u)).fire(new s.l("zoom",u)).fire(new s.l("zoomend",u)),_&&this.fire(new s.l("rotatestart",u)).fire(new s.l("rotate",u)).fire(new s.l("rotateend",u)),M&&this.fire(new s.l("pitchstart",u)).fire(new s.l("pitch",u)).fire(new s.l("pitchend",u)),D&&this.fire(new s.l("rollstart",u)).fire(new s.l("roll",u)).fire(new s.l("rollend",u)),this.fire(new s.l("moveend",u))}calculateCameraOptionsFromTo(i,u,g,_=0){const M=s.a0.fromLngLat(i,u),D=s.a0.fromLngLat(g,_),F=D.x-M.x,U=D.y-M.y,Z=D.z-M.z,K=Math.hypot(F,U,Z);if(K===0)throw new Error("Can't calculate camera options with same From and To");const ie=Math.hypot(F,U),ne=s.aj(this.transform.cameraToCenterDistance/K/this.transform.tileSize),le=180*Math.atan2(F,-U)/Math.PI;let ge=180*Math.acos(ie/K)/Math.PI;return ge=Z<0?90-ge:90+ge,{center:D.toLngLat(),elevation:_,zoom:ne,pitch:ge,bearing:le}}calculateCameraOptionsFromCameraLngLatAltRotation(i,u,g,_,M){const D=this.transform.calculateCenterFromCameraLngLatAlt(i,u,g,_);return{center:D.center,elevation:D.elevation,zoom:D.zoom,bearing:g,pitch:_,roll:M}}easeTo(i,u){this._stop(!1,i.easeId),((i=s.e({offset:[0,0],duration:500,easing:s.cn},i)).animate===!1||!i.essential&&E.prefersReducedMotion)&&(i.duration=0);const g=this._getTransformForUpdate(),_=this.getBearing(),M=g.pitch,D=g.roll,F="bearing"in i?this._normalizeBearing(i.bearing,_):_,U="pitch"in i?+i.pitch:M,Z="roll"in i?this._normalizeBearing(i.roll,D):D,K="padding"in i?i.padding:g.padding,ie=s.P.convert(i.offset);let ne,le;i.around&&(ne=s.S.convert(i.around),le=g.locationToScreenPoint(ne));const ge={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Le=this.cameraHelper.handleEaseTo(g,{bearing:F,pitch:U,roll:Z,padding:K,around:ne,aroundPoint:le,offsetAsPoint:ie,offset:i.offset,zoom:i.zoom,center:i.center});return this._rotating=this._rotating||_!==F,this._pitching=this._pitching||U!==M,this._rolling=this._rolling||Z!==D,this._padding=!g.isPaddingEqual(K),this._zooming=this._zooming||Le.isZooming,this._easeId=i.easeId,this._prepareEase(u,i.noMoveStart,ge),this.terrain&&this._prepareElevation(Le.elevationCenter),this._ease(ze=>{Le.easeFunc(ze),this.terrain&&!i.freezeElevation&&this._updateElevation(ze),this._applyUpdatedTransform(g),this._fireMoveEvents(u)},ze=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(u,ze)},i),this}_prepareEase(i,u,g={}){this._moving=!0,u||g.moving||this.fire(new s.l("movestart",i)),this._zooming&&!g.zooming&&this.fire(new s.l("zoomstart",i)),this._rotating&&!g.rotating&&this.fire(new s.l("rotatestart",i)),this._pitching&&!g.pitching&&this.fire(new s.l("pitchstart",i)),this._rolling&&!g.rolling&&this.fire(new s.l("rollstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&u!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(g-(u-(g*i+this._elevationStart))/(1-i)),this._elevationTarget=u}this.transform.setElevation(s.C.number(this._elevationStart,this._elevationTarget,i))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(i){if(!this.terrain&&i.elevation>=0&&i.pitch<=90)return{};const u=i.getCameraLngLat(),g=i.getCameraAltitude(),_=this.terrain?this.terrain.getElevationForLngLatZoom(u,i.zoom):0;if(g<_){const M=this.calculateCameraOptionsFromTo(u,_,i.center,i.elevation);return{pitch:M.pitch,zoom:M.zoom}}return{}}_applyUpdatedTransform(i){const u=[];if(u.push(_=>this._elevateCameraIfInsideTerrain(_)),this.transformCameraUpdate&&u.push(_=>this.transformCameraUpdate(_)),!u.length)return;const g=i.clone();for(const _ of u){const M=g.clone(),{center:D,zoom:F,roll:U,pitch:Z,bearing:K,elevation:ie}=_(M);D&&M.setCenter(D),ie!==void 0&&M.setElevation(ie),F!==void 0&&M.setZoom(F),U!==void 0&&M.setRoll(U),Z!==void 0&&M.setPitch(Z),K!==void 0&&M.setBearing(K),g.apply(M)}this.transform.apply(g)}_fireMoveEvents(i){this.fire(new s.l("move",i)),this._zooming&&this.fire(new s.l("zoom",i)),this._rotating&&this.fire(new s.l("rotate",i)),this._pitching&&this.fire(new s.l("pitch",i)),this._rolling&&this.fire(new s.l("roll",i))}_afterEase(i,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const g=this._zooming,_=this._rotating,M=this._pitching,D=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,g&&this.fire(new s.l("zoomend",i)),_&&this.fire(new s.l("rotateend",i)),M&&this.fire(new s.l("pitchend",i)),D&&this.fire(new s.l("rollend",i)),this.fire(new s.l("moveend",i))}flyTo(i,u){if(!i.essential&&E.prefersReducedMotion){const Dt=s.Q(i,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Dt,u)}this.stop(),i=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cn},i);const g=this._getTransformForUpdate(),_=g.bearing,M=g.pitch,D=g.roll,F=g.padding,U="bearing"in i?this._normalizeBearing(i.bearing,_):_,Z="pitch"in i?+i.pitch:M,K="roll"in i?this._normalizeBearing(i.roll,D):D,ie="padding"in i?i.padding:g.padding,ne=s.P.convert(i.offset);let le=g.centerPoint.add(ne);const ge=g.screenPointToLocation(le),Le=this.cameraHelper.handleFlyTo(g,{bearing:U,pitch:Z,roll:K,padding:ie,locationAtOffset:ge,offsetAsPoint:ne,center:i.center,minZoom:i.minZoom,zoom:i.zoom});let ze=i.curve;const Ne=Math.max(g.width,g.height),Ge=Ne/Le.scaleOfZoom,Je=Le.pixelPathLength;typeof Le.scaleOfMinZoom=="number"&&(ze=Math.sqrt(Ne/Le.scaleOfMinZoom/Je*2));const qe=ze*ze;function at(Dt){const Sn=(Ge*Ge-Ne*Ne+(Dt?-1:1)*qe*qe*Je*Je)/(2*(Dt?Ge:Ne)*qe*Je);return Math.log(Math.sqrt(Sn*Sn+1)-Sn)}function ct(Dt){return(Math.exp(Dt)-Math.exp(-Dt))/2}function Ze(Dt){return(Math.exp(Dt)+Math.exp(-Dt))/2}const pt=at(!1);let Tt=function(Dt){return Ze(pt)/Ze(pt+ze*Dt)},Mt=function(Dt){return Ne*((Ze(pt)*(ct(Sn=pt+ze*Dt)/Ze(Sn))-ct(pt))/qe)/Je;var Sn},Et=(at(!0)-pt)/ze;if(Math.abs(Je)<2e-6||!isFinite(Et)){if(Math.abs(Ne-Ge)<1e-6)return this.easeTo(i,u);const Dt=Ge<Ne?-1:1;Et=Math.abs(Math.log(Ge/Ne))/ze,Mt=()=>0,Tt=Sn=>Math.exp(Dt*ze*Sn)}return i.duration="duration"in i?+i.duration:1e3*Et/("screenSpeed"in i?+i.screenSpeed/ze:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=_!==U,this._pitching=Z!==M,this._rolling=K!==D,this._padding=!g.isPaddingEqual(ie),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(Le.targetCenter),this._ease(Dt=>{const Sn=Dt*Et,wn=1/Tt(Sn),nn=Mt(Sn);this._rotating&&g.setBearing(s.C.number(_,U,Dt)),this._pitching&&g.setPitch(s.C.number(M,Z,Dt)),this._rolling&&g.setRoll(s.C.number(D,K,Dt)),this._padding&&(g.interpolatePadding(F,ie,Dt),le=g.centerPoint.add(ne)),Le.easeFunc(Dt,wn,nn,le),this.terrain&&!i.freezeElevation&&this._updateElevation(Dt),this._applyUpdatedTransform(g),this._fireMoveEvents(u)},()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,u){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,u)}return i||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(i,u,g){g.animate===!1||g.duration===0?(i(1),u()):(this._easeStart=E.now(),this._easeOptions=g,this._onEaseFrame=i,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,u){i=s.aN(i,-180,180);const g=Math.abs(i-u);return Math.abs(i-360-u)<g&&(i-=360),Math.abs(i+360-u)<g&&(i+=360),i}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(s.S.convert(i),this.transform.tileZoom):null}}const fc={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ld{constructor(i=fc){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=T.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=T.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){T.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,u){const g=this._map._getUIString(`AttributionControl.${u}`);i.title=g,i.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const u=this._map.style.sourceCaches;for(const _ in u){const M=u[_];if(M.used||M.usedForTerrain){const D=M.getSource();D.attribution&&i.indexOf(D.attribution)<0&&i.push(D.attribution)}}i=i.filter(_=>String(_).trim()),i.sort((_,M)=>_.length-M.length),i=i.filter((_,M)=>{for(let D=M+1;D<i.length;D++)if(i[D].indexOf(_)>=0)return!1;return!0});const g=i.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,i.length?(this._innerContainer.innerHTML=T.sanitize(g),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class yf{constructor(i={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const g=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=T.create("div","maplibregl-ctrl");const u=T.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){T.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Qc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const u=++this._id;return this._queue.push({callback:i,id:u,cancelled:!1}),u}remove(i){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const _ of g)if(_.id===i)return void(_.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Zp=s.aI([{name:"a_pos3d",type:"Int16",components:3}]);class _f extends s.E{constructor(i){super(),this._lastTilesetChange=E.now(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=i._source.tileSize*2**this.deltaZoom,i.usedForTerrain=!0,i.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,u){this.sourceCache.update(i,u),this._renderableTilesKeys=[];const g={};for(const _ of $e(i,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))g[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.terrainRttPosMatrix32f=new Float64Array(16),s.bX(_.terrainRttPosMatrix32f,0,s.$,s.$,0,0,1),this._tiles[_.key]=new Gt(_,this.tileSize),this._lastTilesetChange=E.now());for(const _ in this._tiles)g[_]||delete this._tiles[_]}freeRtt(i){for(const u in this._tiles){const g=this._tiles[u];(!i||g.tileID.equals(i)||g.tileID.isChildOf(i)||i.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i,u){return u?this._getTerrainCoordsForTileRanges(i,u):this._getTerrainCoordsForRegularTile(i)}_getTerrainCoordsForRegularTile(i){const u={};for(const g of this._renderableTilesKeys){const _=this._tiles[g].tileID,M=i.clone(),D=s.b9();if(_.canonical.equals(i.canonical))s.bX(D,0,s.$,s.$,0,0,1);else if(_.canonical.isChildOf(i.canonical)){const F=_.canonical.z-i.canonical.z,U=_.canonical.x-(_.canonical.x>>F<<F),Z=_.canonical.y-(_.canonical.y>>F<<F),K=s.$>>F;s.bX(D,0,K,K,0,0,1),s.M(D,D,[-U*K,-Z*K,0])}else{if(!i.canonical.isChildOf(_.canonical))continue;{const F=i.canonical.z-_.canonical.z,U=i.canonical.x-(i.canonical.x>>F<<F),Z=i.canonical.y-(i.canonical.y>>F<<F),K=s.$>>F;s.bX(D,0,s.$,s.$,0,0,1),s.M(D,D,[U*K,Z*K,0]),s.N(D,D,[1/2**F,1/2**F,0])}}M.terrainRttPosMatrix32f=new Float32Array(D),u[g]=M}return u}_getTerrainCoordsForTileRanges(i,u){const g={};for(const _ of this._renderableTilesKeys){const M=this._tiles[_].tileID;if(!this._isWithinTileRanges(M,u))continue;const D=i.clone(),F=s.b9();if(M.canonical.z===i.canonical.z){const U=i.canonical.x-M.canonical.x,Z=i.canonical.y-M.canonical.y;s.bX(F,0,s.$,s.$,0,0,1),s.M(F,F,[U*s.$,Z*s.$,0])}else if(M.canonical.z>i.canonical.z){const U=M.canonical.z-i.canonical.z,Z=M.canonical.x-(M.canonical.x>>U<<U),K=M.canonical.y-(M.canonical.y>>U<<U),ie=i.canonical.x-(M.canonical.x>>U),ne=i.canonical.y-(M.canonical.y>>U),le=s.$>>U;s.bX(F,0,le,le,0,0,1),s.M(F,F,[-Z*le+ie*s.$,-K*le+ne*s.$,0])}else{const U=i.canonical.z-M.canonical.z,Z=i.canonical.x-(i.canonical.x>>U<<U),K=i.canonical.y-(i.canonical.y>>U<<U),ie=(i.canonical.x>>U)-M.canonical.x,ne=(i.canonical.y>>U)-M.canonical.y,le=s.$<<U;s.bX(F,0,le,le,0,0,1),s.M(F,F,[Z*s.$+ie*le,K*s.$+ne*le,0])}D.terrainRttPosMatrix32f=new Float32Array(F),g[_]=D}return g}getSourceTile(i,u){const g=this.sourceCache._source;let _=i.overscaledZ-this.deltaZoom;if(_>g.maxzoom&&(_=g.maxzoom),_<g.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(_).key);let M=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!M||!M.dem)&&u)for(;_>=g.minzoom&&(!M||!M.dem);)M=this.sourceCache.getTileByID(i.scaledTo(_--).key);return M}anyTilesAfterTime(i=Date.now()){return this._lastTilesetChange>=i}_isWithinTileRanges(i,u){return u[i.canonical.z]&&i.canonical.x>=u[i.canonical.z].minTileX&&i.canonical.x<=u[i.canonical.z].maxTileX&&i.canonical.y>=u[i.canonical.z].minTileY&&i.canonical.y<=u[i.canonical.z].maxTileY}}class zs{constructor(i,u,g){this._meshCache={},this.painter=i,this.sourceCache=new _f(u),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,u,g,_=s.$){var M;if(!(u>=0&&u<_&&g>=0&&g<_))return 0;const D=this.getTerrainData(i),F=(M=D.tile)===null||M===void 0?void 0:M.dem;if(!F)return 0;const U=s.cr([],[u/_*s.$,g/_*s.$],D.u_terrain_matrix),Z=[U[0]*F.dim,U[1]*F.dim],K=Math.floor(Z[0]),ie=Math.floor(Z[1]),ne=Z[0]-K,le=Z[1]-ie;return F.get(K,ie)*(1-ne)*(1-le)+F.get(K+1,ie)*ne*(1-le)+F.get(K,ie+1)*(1-ne)*le+F.get(K+1,ie+1)*ne*le}getElevationForLngLatZoom(i,u){if(!s.cs(u,i.wrap()))return 0;const{tileID:g,mercatorX:_,mercatorY:M}=this._getOverscaledTileIDFromLngLatZoom(i,u);return this.getElevation(g,_%s.$,M%s.$,s.$)}getElevation(i,u,g,_=s.$){return this.getDEMElevation(i,u,g,_)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const _=this.painter.context,M=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(_,M,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(_,new s.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.af([])}const u=this.sourceCache.getSourceTile(i,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const _=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new s.T(_,u.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),u.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const g=u&&u+u.tileID.key+i.key;if(g&&!this._demMatrixCache[g]){const _=this.sourceCache.sourceCache._source.maxzoom;let M=i.canonical.z-u.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=_?M=i.canonical.z-_:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const D=i.canonical.x-(i.canonical.x>>M<<M),F=i.canonical.y-(i.canonical.y>>M<<M),U=s.ct(new Float64Array(16),[1/(s.$<<M),1/(s.$<<M),0]);s.M(U,U,[D*s.$,F*s.$,0]),this._demMatrixCache[i.key]={matrix:U,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(i){const u=this.painter,g=u.width/devicePixelRatio,_=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(u.context,{width:g,height:_,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(u.context,{width:g,height:_,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(g,_,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,g,_))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let M=0,D=0;M<this._coordsTextureSize;M++)for(let F=0;F<this._coordsTextureSize;F++,D+=4)u[D+0]=255&F,u[D+1]=255&M,u[D+2]=F>>8<<4|M>>8,u[D+3]=0;const g=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),_=new s.T(i,g,i.gl.RGBA,{premultiply:!1});return _.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),g=this.painter.context,_=g.gl,M=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),D=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),F=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(M,F-D-1,1,1,_.RGBA,_.UNSIGNED_BYTE,u),g.bindFramebuffer.set(null);const U=u[0]+(u[2]>>4<<8),Z=u[1]+((15&u[2])<<8),K=this.coordsIndex[255-u[3]],ie=K&&this.sourceCache.getTileByID(K);if(!ie)return null;const ne=this._coordsTextureSize,le=(1<<ie.tileID.canonical.z)*ne;return new s.a0((ie.tileID.canonical.x*ne+U)/le+ie.tileID.wrap,(ie.tileID.canonical.y*ne+Z)/le,this.getElevation(ie.tileID,U,Z,ne))}depthAtPoint(i){const u=new Uint8Array(4),g=this.painter.context,_=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,u),g.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(i){var u;const g=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,_=g&&i.canonical.y===0,M=g&&i.canonical.y===(1<<i.canonical.z)-1,D=`m_${_?"n":""}_${M?"s":""}`;if(this._meshCache[D])return this._meshCache[D];const F=this.painter.context,U=new s.cu,Z=new s.aM,K=this.meshSize,ie=s.$/K,ne=K*K;for(let Ze=0;Ze<=K;Ze++)for(let pt=0;pt<=K;pt++)U.emplaceBack(pt*ie,Ze*ie,0);for(let Ze=0;Ze<ne;Ze+=K+1)for(let pt=0;pt<K;pt++)Z.emplaceBack(pt+Ze,K+pt+Ze+1,K+pt+Ze+2),Z.emplaceBack(pt+Ze,K+pt+Ze+2,pt+Ze+1);const le=U.length,ge=le+(K+1),Le=(K+1)*K,ze=_?s.bg:0,Ne=_?0:1,Ge=M?s.bh:s.$,Je=M?0:1;for(let Ze=0;Ze<=K;Ze++)U.emplaceBack(Ze*ie,ze,Ne);for(let Ze=0;Ze<=K;Ze++)U.emplaceBack(Ze*ie,Ge,Je);for(let Ze=0;Ze<K;Ze++)Z.emplaceBack(Le+Ze,ge+Ze,ge+Ze+1),Z.emplaceBack(Le+Ze,ge+Ze+1,Le+Ze+1),Z.emplaceBack(0+Ze,le+Ze+1,le+Ze),Z.emplaceBack(0+Ze,0+Ze+1,le+Ze+1);const qe=U.length,at=qe+2*(K+1);for(const Ze of[0,1])for(let pt=0;pt<=K;pt++)for(const Tt of[0,1])U.emplaceBack(Ze*s.$,pt*ie,Tt);for(let Ze=0;Ze<2*K;Ze+=2)Z.emplaceBack(qe+Ze,qe+Ze+1,qe+Ze+3),Z.emplaceBack(qe+Ze,qe+Ze+3,qe+Ze+2),Z.emplaceBack(at+Ze,at+Ze+3,at+Ze+1),Z.emplaceBack(at+Ze,at+Ze+2,at+Ze+3);const ct=new ua(F.createVertexBuffer(U,Zp.members),F.createIndexBuffer(Z),s.aL.simpleSegment(0,0,U.length,Z.length));return this._meshCache[D]=ct,ct}getMeshFrameDelta(i){return 2*Math.PI*s.bt/Math.pow(2,Math.max(i,0))/5}getMinTileElevationForLngLatZoom(i,u){var g;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(i,u);return(g=this.getMinMaxElevation(_).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(i){const u=this.getTerrainData(i).tile,g={minElevation:null,maxElevation:null};return u&&u.dem&&(g.minElevation=u.dem.min*this.exaggeration,g.maxElevation=u.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(i,u){const g=s.a0.fromLngLat(i.wrap()),_=(1<<u)*s.$,M=g.x*_,D=g.y*_,F=Math.floor(M/s.$),U=Math.floor(D/s.$);return{tileID:new s.Z(u,0,u,F,U),mercatorX:M,mercatorY:D}}}class gl{constructor(i,u,g){this._context=i,this._size=u,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(g.texture),{id:i,fbo:u,texture:g,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>i.id!==u),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(i=>!i.inUse)===!1}}const $n={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class ar{constructor(i,u){this.painter=i,this.terrain=u,this.pool=new gl(i.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter(g=>!i._layers[g].isHidden(u)),this._coordsAscending={};for(const g in i.sourceCaches){this._coordsAscending[g]={};const _=i.sourceCaches[g].getVisibleCoordinates(),M=i.sourceCaches[g].getSource(),D=M instanceof Nn?M.terrainTileRanges:null;for(const F of _){const U=this.terrain.sourceCache.getTerrainCoords(F,D);for(const Z in U)this._coordsAscending[g][Z]||(this._coordsAscending[g][Z]=[]),this._coordsAscending[g][Z].push(U[Z])}}this._coordsAscendingStr={};for(const g of i._order){const _=i._layers[g],M=_.source;if($n[_.type]&&!this._coordsAscendingStr[M]){this._coordsAscendingStr[M]={};for(const D in this._coordsAscending[M])this._coordsAscendingStr[M][D]=this._coordsAscending[M][D].map(F=>F.key).sort().join()}}for(const g of this._renderableTiles)for(const _ in this._coordsAscendingStr){const M=this._coordsAscendingStr[_][g.tileID.key];M&&M!==g.rttCoords[_]&&(g.rtt=[])}}renderLayer(i,u){if(i.isHidden(this.painter.transform.zoom))return!1;const g=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),_=i.type,M=this.painter,D=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if($n[_]&&(this._prevType&&$n[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(i.id),!D))return!0;if($n[this._prevType]||$n[_]&&D){this._prevType=_;const F=this._stacks.length-1,U=this._stacks[F]||[];for(const Z of this._renderableTiles){if(this.pool.isFull()&&(Yr(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(Z),Z.rtt[F]){const ie=this.pool.getObjectForId(Z.rtt[F].id);if(ie.stamp===Z.rtt[F].stamp){this.pool.useObject(ie);continue}}const K=this.pool.getOrCreateFreeObject();this.pool.useObject(K),this.pool.stampObject(K),Z.rtt[F]={id:K.id,stamp:K.stamp},M.context.bindFramebuffer.set(K.fbo.framebuffer),M.context.clear({color:s.be.transparent,stencil:0}),M.currentStencilSource=void 0;for(let ie=0;ie<U.length;ie++){const ne=M.style._layers[U[ie]],le=ne.source?this._coordsAscending[ne.source][Z.tileID.key]:[Z.tileID];M.context.viewport.set([0,0,K.fbo.width,K.fbo.height]),M._renderTileClippingMasks(ne,le,!0),M.renderLayer(M,M.style.sourceCaches[ne.source],ne,le,g),ne.source&&(Z.rttCoords[ne.source]=this._coordsAscendingStr[ne.source][Z.tileID.key])}}return Yr(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects(),$n[_]}return!1}}const qu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},cd=m,Ba={hash:!1,interactive:!0,bearingSnap:7,attributionControl:fc,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},gi={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class pc{constructor(i,u,g=!1){this.mousedown=M=>{this.startMove(M,T.mousePos(this.element,M)),T.addEventListener(window,"mousemove",this.mousemove),T.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=M=>{this.move(M,T.mousePos(this.element,M))},this.mouseup=M=>{this._rotatePitchHanlder.dragEnd(M),this.offTemp()},this.touchstart=M=>{M.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=T.touchPos(this.element,M.targetTouches)[0],this.startMove(M,this._startPos),T.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),T.addEventListener(window,"touchend",this.touchend))},this.touchmove=M=>{M.targetTouches.length!==1?this.reset():(this._lastPos=T.touchPos(this.element,M.targetTouches)[0],this.move(M,this._lastPos))},this.touchend=M=>{M.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const _=new cc;this._rotatePitchHanlder=new Jc({clickTolerance:3,move:(M,D)=>{const F=u.getBoundingClientRect(),U=new s.P((F.bottom-F.top)/2,(F.right-F.left)/2);return{bearingDelta:s.cm(new s.P(M.x,D.y),D,U),pitchDelta:g?-.5*(D.y-M.y):void 0}},moveStateManager:_,enable:!0,assignEvents:()=>{}}),this.map=i,T.addEventListener(u,"mousedown",this.mousedown),T.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),T.addEventListener(u,"touchcancel",this.reset)}startMove(i,u){this._rotatePitchHanlder.dragStart(i,u),T.disableDrag()}move(i,u){const g=this.map,{bearingDelta:_,pitchDelta:M}=this._rotatePitchHanlder.dragMove(i,u)||{};_&&g.setBearing(g.getBearing()+_),M&&g.setPitch(g.getPitch()+M)}off(){const i=this.element;T.removeEventListener(i,"mousedown",this.mousedown),T.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),T.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),T.removeEventListener(window,"touchend",this.touchend),T.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){T.enableDrag(),T.removeEventListener(window,"mousemove",this.mousemove),T.removeEventListener(window,"mouseup",this.mouseup),T.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),T.removeEventListener(window,"touchend",this.touchend)}}let oo;function Yp(S,i,u,g=!1){if(g||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return S?.wrap();const _=new s.S(S.lng,S.lat);if(S=new s.S(S.lng,S.lat),i){const M=new s.S(S.lng-360,S.lat),D=new s.S(S.lng+360,S.lat),F=u.locationToScreenPoint(S).distSqr(i);u.locationToScreenPoint(M).distSqr(i)<F?S=M:u.locationToScreenPoint(D).distSqr(i)<F&&(S=D)}for(;Math.abs(S.lng-u.center.lng)>180;){const M=u.locationToScreenPoint(S);if(M.x>=0&&M.y>=0&&M.x<=u.width&&M.y<=u.height)break;S.lng>u.center.lng?S.lng-=360:S.lng+=360}return S.lng!==_.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(S))?S:_}const os={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ei(S,i,u){const g=S.classList;for(const _ in os)g.remove(`maplibregl-${u}-anchor-${_}`);g.add(`maplibregl-${u}-anchor-${i}`)}class Ci extends s.E{constructor(i){if(super(),this._onKeyPress=u=>{const g=u.code,_=u.charCode||u.keyCode;g!=="Space"&&g!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=u=>{const g=u.originalEvent.target,_=this._element;this._popup&&(g===_||_.contains(g))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=Yp(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let M="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?M="rotateX(0deg)":this._pitchAlignment==="map"&&(M=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),T.setTransform(this._element,`${os[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${M} ${_}`),E.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._subpixelPositioning=i&&i.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(i?.opacity,i?.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=s.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=T.create("div");const u=T.createNS("http://www.w3.org/2000/svg","svg"),g=41,_=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${g}px`),u.setAttributeNS(null,"width",`${_}px`),u.setAttributeNS(null,"viewBox",`0 0 ${_} ${g}`);const M=T.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"stroke","none"),M.setAttributeNS(null,"stroke-width","1"),M.setAttributeNS(null,"fill","none"),M.setAttributeNS(null,"fill-rule","evenodd");const D=T.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"fill-rule","nonzero");const F=T.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(3.0, 29.0)"),F.setAttributeNS(null,"fill","#000000");const U=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ne of U){const Ge=T.createNS("http://www.w3.org/2000/svg","ellipse");Ge.setAttributeNS(null,"opacity","0.04"),Ge.setAttributeNS(null,"cx","10.5"),Ge.setAttributeNS(null,"cy","5.80029008"),Ge.setAttributeNS(null,"rx",Ne.rx),Ge.setAttributeNS(null,"ry",Ne.ry),F.appendChild(Ge)}const Z=T.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill",this._color);const K=T.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Z.appendChild(K);const ie=T.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"opacity","0.25"),ie.setAttributeNS(null,"fill","#000000");const ne=T.createNS("http://www.w3.org/2000/svg","path");ne.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ie.appendChild(ne);const le=T.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"transform","translate(6.0, 7.0)"),le.setAttributeNS(null,"fill","#FFFFFF");const ge=T.createNS("http://www.w3.org/2000/svg","g");ge.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Le=T.createNS("http://www.w3.org/2000/svg","circle");Le.setAttributeNS(null,"fill","#000000"),Le.setAttributeNS(null,"opacity","0.25"),Le.setAttributeNS(null,"cx","5.5"),Le.setAttributeNS(null,"cy","5.5"),Le.setAttributeNS(null,"r","5.4999962");const ze=T.createNS("http://www.w3.org/2000/svg","circle");ze.setAttributeNS(null,"fill","#FFFFFF"),ze.setAttributeNS(null,"cx","5.5"),ze.setAttributeNS(null,"cy","5.5"),ze.setAttributeNS(null,"r","5.4999962"),ge.appendChild(Le),ge.appendChild(ze),D.appendChild(F),D.appendChild(Z),D.appendChild(ie),D.appendChild(le),D.appendChild(ge),u.appendChild(D),u.setAttributeNS(null,"height",g*this._scale+"px"),u.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(u),this._offset=s.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),ei(this._element,this._anchor,"marker"),i&&i.className)for(const u of i.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),i.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),T.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=s.S.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const _=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(i){return this._subpixelPositioning=i,this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var u,g;const _=(u=this._map)===null||u===void 0?void 0:u.terrain,M=this._map.transform.isLocationOccluded(this._lngLat);if(!_||M){const le=M?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==le&&(this._element.style.opacity=le))}if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const D=this._map,F=D.terrain.depthAtPoint(this._pos),U=D.terrain.getElevationForLngLatZoom(this._lngLat,D.transform.tileZoom);if(D.transform.lngLatToCameraDepth(this._lngLat,U)-F<.006)return void(this._element.style.opacity=this._opacity);const Z=-this._offset.y/D.transform.pixelsPerMeter,K=Math.sin(D.getPitch()*Math.PI/180)*Z,ie=D.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),ne=D.transform.lngLatToCameraDepth(this._lngLat,U+K)-ie>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&ne&&this._popup.remove(),this._element.style.opacity=ne?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=s.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,u){return(this._opacity===void 0||i===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Kp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let jo=0,ss=!1;const Xu={maxWidth:100,unit:"metric"};function ud(S,i,u){const g=u&&u.maxWidth||100,_=S._container.clientHeight/2,M=S._container.clientWidth/2,D=S.unproject([M-g/2,_]),F=S.unproject([M+g/2,_]),U=Math.round(S.project(F).x-S.project(D).x),Z=Math.min(g,U,S._container.clientWidth),K=D.distanceTo(F);if(u&&u.unit==="imperial"){const ie=3.2808*K;ie>5280?Ua(i,Z,ie/5280,S._getUIString("ScaleControl.Miles")):Ua(i,Z,ie,S._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Ua(i,Z,K/1852,S._getUIString("ScaleControl.NauticalMiles")):K>=1e3?Ua(i,Z,K/1e3,S._getUIString("ScaleControl.Kilometers")):Ua(i,Z,K,S._getUIString("ScaleControl.Meters"))}function Ua(S,i,u,g){const _=function(M){const D=Math.pow(10,`${Math.floor(M)}`.length-1);let F=M/D;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(U){const Z=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*Z)/Z}(F),D*F}(u);S.style.width=i*(_/u)+"px",S.innerHTML=`${_}&nbsp;${g}`}const Zu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},eu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Os(S){if(S){if(typeof S=="number"){const i=Math.round(Math.abs(S)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,S),"top-left":new s.P(i,i),"top-right":new s.P(-i,i),bottom:new s.P(0,-S),"bottom-left":new s.P(i,-i),"bottom-right":new s.P(-i,-i),left:new s.P(S,0),right:new s.P(-S,0)}}if(S instanceof s.P||Array.isArray(S)){const i=s.P.convert(S);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:s.P.convert(S.center||[0,0]),top:s.P.convert(S.top||[0,0]),"top-left":s.P.convert(S["top-left"]||[0,0]),"top-right":s.P.convert(S["top-right"]||[0,0]),bottom:s.P.convert(S.bottom||[0,0]),"bottom-left":s.P.convert(S["bottom-left"]||[0,0]),"bottom-right":s.P.convert(S["bottom-right"]||[0,0]),left:s.P.convert(S.left||[0,0]),right:s.P.convert(S.right||[0,0])}}return Os(new s.P(0,0))}const tu=m;c.AJAXError=s.cy,c.Event=s.l,c.Evented=s.E,c.LngLat=s.S,c.MercatorCoordinate=s.a0,c.Point=s.P,c.addProtocol=s.cz,c.config=s.a,c.removeProtocol=s.cA,c.AttributionControl=ld,c.BoxZoomHandler=$o,c.CanvasSource=Ue,c.CooperativeGesturesHandler=sd,c.DoubleClickZoomHandler=_s,c.DragPanHandler=od,c.DragRotateHandler=Hu,c.EdgeInsets=Qo,c.FullscreenControl=class extends s.E{constructor(S={}){super(),this._onFullscreenChange=()=>{var i;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=u?.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,S&&S.container&&(S.container instanceof HTMLElement?this._container=S.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(S){return this._map=S,this._container||(this._container=this._map.getContainer()),this._controlContainer=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){T.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const S=this._fullscreenButton=T.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);T.create("span","maplibregl-ctrl-icon",S).setAttribute("aria-hidden","true"),S.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const S=this._getTitle();this._fullscreenButton.setAttribute("aria-label",S),this._fullscreenButton.title=S}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},c.GeoJSONSource=$t,c.GeolocateControl=class extends s.E{constructor(S){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",i)),this._finish()}},this._updateCamera=i=>{const u=new s.S(i.coords.longitude,i.coords.latitude),g=i.coords.accuracy,_=this._map.getBearing(),M=s.e({bearing:_},this.options.fitBoundsOptions),D=un.fromLngLat(u,g);this._map.fitBounds(D,M,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const u=new s.S(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=i=>{if(this._map){if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&ss)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=T.create("button","maplibregl-ctrl-geolocate",this._container),T.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=i=>{if(this._map){if(i===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ci({element:this._dotElement}),this._circleElement=T.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ci({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},Kp,S)}onAdd(S){return this._map=S,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(i=!1){if(oo!==void 0&&!i)return oo;if(window.navigator.permissions===void 0)return oo=!!window.navigator.geolocation,oo;try{oo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{oo=!!window.navigator.geolocation}return oo})}().then(i=>this._finishSetupUI(i)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),T.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,jo=0,ss=!1}_isOutOfMapMaxBounds(S){const i=this._map.getMaxBounds(),u=S.coords;return i&&(u.longitude<i.getWest()||u.longitude>i.getEast()||u.latitude<i.getSouth()||u.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const S=this._map.getBounds(),i=S.getSouthEast(),u=S.getNorthEast(),g=i.distanceTo(u),_=Math.ceil(this._accuracy/(g/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":jo--,ss=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let S;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),jo++,jo>1?(S={maximumAge:6e5,timeout:0},ss=!0):(S=this.options.positionOptions,ss=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,S)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},c.GlobeControl=class{constructor(){this._toggleProjection=()=>{var S;const i=(S=this._map.getProjection())===null||S===void 0?void 0:S.type;this._map.setProjection(i!=="mercator"&&i?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var S;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((S=this._map.getProjection())===null||S===void 0?void 0:S.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(S){return this._map=S,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=T.create("button","maplibregl-ctrl-globe",this._container),T.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){T.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},c.Hash=nd,c.ImageSource=Nn,c.KeyboardHandler=hc,c.LngLatBounds=un,c.LogoControl=yf,c.Map=class extends si{constructor(S){var i,u;s.cv.mark(s.cw.create);const g=Object.assign(Object.assign(Object.assign({},Ba),S),{canvasContextAttributes:Object.assign(Object.assign({},Ba.canvasContextAttributes),S.canvasContextAttributes)});if(g.minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const _=new Zi,M=new Oh;if(g.minZoom!==void 0&&_.setMinZoom(g.minZoom),g.maxZoom!==void 0&&_.setMaxZoom(g.maxZoom),g.minPitch!==void 0&&_.setMinPitch(g.minPitch),g.maxPitch!==void 0&&_.setMaxPitch(g.maxPitch),g.renderWorldCopies!==void 0&&_.setRenderWorldCopies(g.renderWorldCopies),super(_,M,{bearingSnap:g.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Qc,this._controls=[],this._mapId=s.a6(),this._contextLost=F=>{F.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.l("webglcontextlost",{originalEvent:F}))},this._contextRestored=F=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:F}))},this._onMapScroll=F=>{if(F.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._maxTileCacheZoomLevels=g.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},g.canvasContextAttributes),this._trackResize=g.trackResize===!0,this._bearingSnap=g.bearingSnap,this._centerClampedToGround=g.centerClampedToGround,this._refreshExpiredTiles=g.refreshExpiredTiles===!0,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions===!0,this._collectResourceTiming=g.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},qu),g.locale),this._clickTolerance=g.clickTolerance,this._overridePixelRatio=g.pixelRatio,this._maxCanvasSize=g.maxCanvasSize,this.transformCameraUpdate=g.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=g.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new X(g.transformRequest),typeof g.container=="string"){if(this._container=document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let F=!1;const U=Fu(Z=>{this._trackResize&&!this._removed&&(this.resize(Z),this.redraw())},50);this._resizeObserver=new ResizeObserver(Z=>{F?U(Z):F=!0}),this._resizeObserver.observe(this._container)}this.handlers=new dc(this,g),this._hash=g.hash&&new nd(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,elevation:g.elevation,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,roll:g.roll}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,s.e({},g.fitBoundsOptions,{duration:0}))));const D=typeof g.style=="string"||((u=(i=g.style)===null||i===void 0?void 0:i.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,D),this._localIdeographFontFamily=g.localIdeographFontFamily,this._validateStyle=g.validateStyle,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new ld(typeof g.attributionControl=="boolean"?void 0:g.attributionControl)),g.maplibreLogo&&this.addControl(new yf,g.logoPosition),this.on("style.load",()=>{if(D||this._resizeTransform(),this.transform.unmodified){const F=s.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(F)}}),this.on("data",F=>{this._update(F.dataType==="style"),this.fire(new s.l(`${F.dataType}data`,F))}),this.on("dataloading",F=>{this.fire(new s.l(`${F.dataType}dataloading`,F))}),this.on("dataabort",F=>{this.fire(new s.l("sourcedataabort",F))})}_getMapId(){return this._mapId}setGlobalStateProperty(S,i){return this.style.setGlobalStateProperty(S,i),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(S,i){if(i===void 0&&(i=S.getDefaultPosition?S.getDefaultPosition():"top-right"),!S||!S.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=S.onAdd(this);this._controls.push(S);const g=this._controlPositions[i];return i.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(S){if(!S||!S.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(S);return i>-1&&this._controls.splice(i,1),S.onRemove(this),this}hasControl(S){return this._controls.indexOf(S)>-1}calculateCameraOptionsFromTo(S,i,u,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(S,i,u,g)}resize(S,i=!0){const[u,g]=this._containerDimensions(),_=this._getClampedPixelRatio(u,g);if(this._resizeCanvas(u,g,_),this.painter.resize(u,g,_),this.painter.overLimit()){const D=this.painter.context.gl;this._maxCanvasSize=[D.drawingBufferWidth,D.drawingBufferHeight];const F=this._getClampedPixelRatio(u,g);this._resizeCanvas(u,g,F),this.painter.resize(u,g,F)}this._resizeTransform(i);const M=!this._moving;return M&&(this.stop(),this.fire(new s.l("movestart",S)).fire(new s.l("move",S))),this.fire(new s.l("resize",S)),M&&this.fire(new s.l("moveend",S)),this}_resizeTransform(S=!0){var i;const[u,g]=this._containerDimensions();this.transform.resize(u,g,S),(i=this._requestedCameraState)===null||i===void 0||i.resize(u,g,S)}_getClampedPixelRatio(S,i){const{0:u,1:g}=this._maxCanvasSize,_=this.getPixelRatio(),M=S*_,D=i*_;return Math.min(M>u?u/M:1,D>g?g/D:1)*_}getPixelRatio(){var S;return(S=this._overridePixelRatio)!==null&&S!==void 0?S:devicePixelRatio}setPixelRatio(S){this._overridePixelRatio=S,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(S){return this.transform.setMaxBounds(un.convert(S)),this._update()}setMinZoom(S){if((S=S??-2)>=-2&&S<=this.transform.maxZoom)return this.transform.setMinZoom(S),this._update(),this.getZoom()<S&&this.setZoom(S),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(S){if((S=S??22)>=this.transform.minZoom)return this.transform.setMaxZoom(S),this._update(),this.getZoom()>S&&this.setZoom(S),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(S){if((S=S??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(S>=0&&S<=this.transform.maxPitch)return this.transform.setMinPitch(S),this._update(),this.getPitch()<S&&this.setPitch(S),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(S){if((S=S??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(S>=this.transform.minPitch)return this.transform.setMaxPitch(S),this._update(),this.getPitch()>S&&this.setPitch(S),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(S){return this.transform.setRenderWorldCopies(S),this._update()}project(S){return this.transform.locationToScreenPoint(s.S.convert(S),this.style&&this.terrain)}unproject(S){return this.transform.screenPointToLocation(s.P.convert(S),this.terrain)}isMoving(){var S;return this._moving||((S=this.handlers)===null||S===void 0?void 0:S.isMoving())}isZooming(){var S;return this._zooming||((S=this.handlers)===null||S===void 0?void 0:S.isZooming())}isRotating(){var S;return this._rotating||((S=this.handlers)===null||S===void 0?void 0:S.isRotating())}_createDelegatedListener(S,i,u){if(S==="mouseenter"||S==="mouseover"){let g=!1;return{layers:i,listener:u,delegates:{mousemove:M=>{const D=i.filter(U=>this.getLayer(U)),F=D.length!==0?this.queryRenderedFeatures(M.point,{layers:D}):[];F.length?g||(g=!0,u.call(this,new Pr(S,this,M.originalEvent,{features:F}))):g=!1},mouseout:()=>{g=!1}}}}if(S==="mouseleave"||S==="mouseout"){let g=!1;return{layers:i,listener:u,delegates:{mousemove:D=>{const F=i.filter(U=>this.getLayer(U));(F.length!==0?this.queryRenderedFeatures(D.point,{layers:F}):[]).length?g=!0:g&&(g=!1,u.call(this,new Pr(S,this,D.originalEvent)))},mouseout:D=>{g&&(g=!1,u.call(this,new Pr(S,this,D.originalEvent)))}}}}{const g=_=>{const M=i.filter(F=>this.getLayer(F)),D=M.length!==0?this.queryRenderedFeatures(_.point,{layers:M}):[];D.length&&(_.features=D,u.call(this,_),delete _.features)};return{layers:i,listener:u,delegates:{[S]:g}}}}_saveDelegatedListener(S,i){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[S]=this._delegatedListeners[S]||[],this._delegatedListeners[S].push(i)}_removeDelegatedListener(S,i,u){if(!this._delegatedListeners||!this._delegatedListeners[S])return;const g=this._delegatedListeners[S];for(let _=0;_<g.length;_++){const M=g[_];if(M.listener===u&&M.layers.length===i.length&&M.layers.every(D=>i.includes(D))){for(const D in M.delegates)this.off(D,M.delegates[D]);return void g.splice(_,1)}}}on(S,i,u){if(u===void 0)return super.on(S,i);const g=typeof i=="string"?[i]:i,_=this._createDelegatedListener(S,g,u);this._saveDelegatedListener(S,_);for(const M in _.delegates)this.on(M,_.delegates[M]);return{unsubscribe:()=>{this._removeDelegatedListener(S,g,u)}}}once(S,i,u){if(u===void 0)return super.once(S,i);const g=typeof i=="string"?[i]:i,_=this._createDelegatedListener(S,g,u);for(const M in _.delegates){const D=_.delegates[M];_.delegates[M]=(...F)=>{this._removeDelegatedListener(S,g,u),D(...F)}}this._saveDelegatedListener(S,_);for(const M in _.delegates)this.once(M,_.delegates[M]);return this}off(S,i,u){return u===void 0?super.off(S,i):(this._removeDelegatedListener(S,typeof i=="string"?[i]:i,u),this)}queryRenderedFeatures(S,i){if(!this.style)return[];let u;const g=S instanceof s.P||Array.isArray(S),_=g?S:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(g?{}:S)||{},_ instanceof s.P||typeof _[0]=="number")u=[s.P.convert(_)];else{const M=s.P.convert(_[0]),D=s.P.convert(_[1]);u=[M,new s.P(D.x,M.y),D,new s.P(M.x,D.y),M]}return this.style.queryRenderedFeatures(u,i,this.transform)}querySourceFeatures(S,i){return this.style.querySourceFeatures(S,i)}setStyle(S,i){return(i=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&S?(this._diffStyle(S,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(S,i))}setTransformRequest(S){return this._requestManager.setTransformRequest(S),this}_getUIString(S){const i=this._locale[S];if(i==null)throw new Error(`Missing UI string '${S}'`);return i}_updateStyle(S,i){var u,g;if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(S,i));const _=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!S)),S?(this.style=new Pp(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof S=="string"?this.style.loadURL(S,i,_):this.style.loadJSON(S,i,_),this):((g=(u=this.style)===null||u===void 0?void 0:u.projection)===null||g===void 0||g.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Pp(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(S,i){if(typeof S=="string"){const u=this._requestManager.transformRequest(S,"Style");s.j(u,new AbortController).then(g=>{this._updateDiff(g.data,i)}).catch(g=>{g&&this.fire(new s.k(g))})}else typeof S=="object"&&this._updateDiff(S,i)}_updateDiff(S,i){try{this.style.setState(S,i)&&this._update(!0)}catch(u){s.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(S,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(S,i){return this._lazyInitEmptyStyle(),this.style.addSource(S,i),this._update(!0)}isSourceLoaded(S){const i=this.style&&this.style.sourceCaches[S];if(i!==void 0)return i.loaded();this.fire(new s.k(new Error(`There is no source with ID '${S}'`)))}setTerrain(S){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),S){const i=this.style.sourceCaches[S.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${S.source}`);this.terrain===null&&i.reload();for(const u in this.style._layers){const g=this.style._layers[u];g.type==="hillshade"&&g.source===S.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),g.type==="color-relief"&&g.source===S.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new zs(this.painter,i,S),this.painter.renderToTexture=new ar(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var g;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==S.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((g=u.source)===null||g===void 0?void 0:g.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:S})),this}getTerrain(){var S,i;return(i=(S=this.terrain)===null||S===void 0?void 0:S.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const S=this.style&&this.style.sourceCaches;for(const i in S){const u=S[i]._tiles;for(const g in u){const _=u[g];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(S){return this.style.removeSource(S),this._update(!0)}getSource(S){return this.style.getSource(S)}setSourceTileLodParams(S,i,u){if(u){const g=this.getSource(u);if(!g)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);g.calculateTileZoom=ye(Math.max(1,S),Math.max(1,i))}else for(const g in this.style.sourceCaches)this.style.sourceCaches[g].getSource().calculateTileZoom=ye(Math.max(1,S),Math.max(1,i));return this._update(!0),this}refreshTiles(S,i){const u=this.style.sourceCaches[S];if(!u)throw new Error(`There is no source cache with ID "${S}", cannot refresh tile`);i===void 0?u.reload(!0):u.refreshTiles(i.map(g=>new s.a3(g.z,g.x,g.y)))}addImage(S,i,u={}){const{pixelRatio:g=1,sdf:_=!1,stretchX:M,stretchY:D,content:F,textFitWidth:U,textFitHeight:Z}=u;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||s.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:K,height:ie,data:ne}=i,le=i;return this.style.addImage(S,{data:new s.R({width:K,height:ie},new Uint8Array(ne)),pixelRatio:g,stretchX:M,stretchY:D,content:F,textFitWidth:U,textFitHeight:Z,sdf:_,version:0,userImage:le}),le.onAdd&&le.onAdd(this,S),this}}{const{width:K,height:ie,data:ne}=E.getImageData(i);this.style.addImage(S,{data:new s.R({width:K,height:ie},ne),pixelRatio:g,stretchX:M,stretchY:D,content:F,textFitWidth:U,textFitHeight:Z,sdf:_,version:0})}}updateImage(S,i){const u=this.style.getImage(S);if(!u)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=i instanceof HTMLImageElement||s.b(i)?E.getImageData(i):i,{width:_,height:M,data:D}=g;if(_===void 0||M===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==u.data.width||M!==u.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const F=!(i instanceof HTMLImageElement||s.b(i));return u.data.replace(D,F),this.style.updateImage(S,u),this}getImage(S){return this.style.getImage(S)}hasImage(S){return S?!!this.style.getImage(S):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(S){this.style.removeImage(S)}loadImage(S){return W.getImage(this._requestManager.transformRequest(S,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(S,i){return this._lazyInitEmptyStyle(),this.style.addLayer(S,i),this._update(!0)}moveLayer(S,i){return this.style.moveLayer(S,i),this._update(!0)}removeLayer(S){return this.style.removeLayer(S),this._update(!0)}getLayer(S){return this.style.getLayer(S)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(S,i,u){return this.style.setLayerZoomRange(S,i,u),this._update(!0)}setFilter(S,i,u={}){return this.style.setFilter(S,i,u),this._update(!0)}getFilter(S){return this.style.getFilter(S)}setPaintProperty(S,i,u,g={}){return this.style.setPaintProperty(S,i,u,g),this._update(!0)}getPaintProperty(S,i){return this.style.getPaintProperty(S,i)}setLayoutProperty(S,i,u,g={}){return this.style.setLayoutProperty(S,i,u,g),this._update(!0)}getLayoutProperty(S,i){return this.style.getLayoutProperty(S,i)}setGlyphs(S,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(S,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(S,i,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(S,i,u,g=>{g||this._update(!0)}),this}removeSprite(S){return this._lazyInitEmptyStyle(),this.style.removeSprite(S),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(S,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(S,i,u=>{u||this._update(!0)}),this}setLight(S,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(S,i),this._update(!0)}getLight(){return this.style.getLight()}setSky(S,i={}){return this._lazyInitEmptyStyle(),this.style.setSky(S,i),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(S,i){return this.style.setFeatureState(S,i),this._update()}removeFeatureState(S,i){return this.style.removeFeatureState(S,i),this._update()}getFeatureState(S){return this.style.getFeatureState(S)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let S=0,i=0;return this._container&&(S=this._container.clientWidth||400,i=this._container.clientHeight||300),[S,i]}_setupContainer(){const S=this._container;S.classList.add("maplibregl-map");const i=this._canvasContainer=T.create("div","maplibregl-canvas-container",S);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=T.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),g=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],g);const _=this._controlContainer=T.create("div","maplibregl-control-container",S),M=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(D=>{M[D]=T.create("div",`maplibregl-ctrl-${D} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(S,i,u){this._canvas.width=Math.floor(u*S),this._canvas.height=Math.floor(u*i),this._canvas.style.width=`${S}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const S=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let i=null;this._canvas.addEventListener("webglcontextcreationerror",g=>{i={requestedAttributes:S},g&&(i.statusMessage=g.statusMessage,i.type=g.type)},{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,S):this._canvas.getContext("webgl2",S)||this._canvas.getContext("webgl",S),!u){const g="Failed to initialize WebGL";throw i?(i.message=g,new Error(JSON.stringify(i))):new Error(g)}this.painter=new Yi(u,this.transform),R.testSupport(u)}migrateProjection(S,i){super.migrateProjection(S,i),this.painter.transform=S,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(S){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||S,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(S){return this._update(),this._renderTaskQueue.add(S)}_cancelRenderFrame(S){this._renderTaskQueue.remove(S)}_render(S){var i,u,g,_,M;const D=this._idleTriggered?this._fadeDuration:0,F=((i=this.style.projection)===null||i===void 0?void 0:i.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(S),this._removed)return;let U=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const ie=this.transform.zoom,ne=E.now();this.style.zoomHistory.update(ie,ne);const le=new s.F(ie,{now:ne,fadeDuration:D,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),ge=le.crossFadingFactor();ge===1&&ge===this._crossFadingFactor||(U=!0,this._crossFadingFactor=ge),this.style.update(le)}const Z=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==F;(g=this.style.projection)===null||g===void 0||g.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((_=this.style.projection)===null||_===void 0?void 0:_.transitionState,(M=this.style.projection)===null||M===void 0?void 0:M.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||Z)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,D,this._crossSourceCollisions,Z),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:D,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cv.mark(s.cw.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||U)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const K=this._sourcesDirty||this._styleDirty||this._placementDirty;return K||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||K||(this._fullyLoaded=!0,s.cv.mark(s.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var S;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(S=this._resizeObserver)===null||S===void 0||S.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i?.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),T.remove(this._canvasContainer),T.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cv.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,E.frame(this._frameRequest,S=>{s.cv.frame(S),this._frameRequest=null;try{this._render(S)}catch(i){if(!s.cx(i)&&!function(u){return u.message===Up}(i))throw i}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(S){this._showTileBoundaries!==S&&(this._showTileBoundaries=S,this._update())}get showPadding(){return!!this._showPadding}set showPadding(S){this._showPadding!==S&&(this._showPadding=S,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(S){this._showCollisionBoxes!==S&&(this._showCollisionBoxes=S,S?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(S){this._showOverdrawInspector!==S&&(this._showOverdrawInspector=S,this._update())}get repaint(){return!!this._repaint}set repaint(S){this._repaint!==S&&(this._repaint=S,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(S){this._vertices=S,this._update()}get version(){return cd}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(S){return this._lazyInitEmptyStyle(),this.style.setProjection(S),this._update(!0)}},c.MapMouseEvent=Pr,c.MapTouchEvent=po,c.MapWheelEvent=mo,c.Marker=Ci,c.NavigationControl=class{constructor(S){this._updateZoomButtons=()=>{const i=this._map.getZoom(),u=i===this._map.getMaxZoom(),g=i===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(i,u)=>{const g=this._map._getUIString(`NavigationControl.${u}`);i.title=g,i.setAttribute("aria-label",g)},this.options=s.e({},gi,S),this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),T.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),T.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=T.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(S){return this._map=S,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){T.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(S,i){const u=T.create("button",S,this._container);return u.type="button",u.addEventListener("click",i),u}},c.Popup=class extends s.E{constructor(S){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&T.remove(this._content),this._container&&(T.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=T.create("div","maplibregl-popup",this._map.getContainer()),this._tip=T.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const D of this.options.className.split(" "))this._container.classList.add(D);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Yp(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!i)return;const u=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationToScreenPoint(this._lngLat));let g=this.options.anchor;const _=Os(this.options.offset);if(!g){const D=this._container.offsetWidth,F=this._container.offsetHeight;let U;U=u.y+_.bottom.y<F?["top"]:u.y>this._map.transform.height-F?["bottom"]:[],u.x<D/2?U.push("left"):u.x>this._map.transform.width-D/2&&U.push("right"),g=U.length===0?"bottom":U.join("-")}let M=u.add(_[g]);this.options.subpixelPositioning||(M=M.round()),T.setTransform(this._container,`${os[g]} translate(${M.x}px,${M.y}px)`),ei(this._container,g,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(Zu),S)}addTo(S){return this._map&&this.remove(),this._map=S,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(S){return this._lngLat=s.S.convert(S),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(S){return this.setDOMContent(document.createTextNode(S))}setHTML(S){const i=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=S;g=u.firstChild,g;)i.appendChild(g);return this.setDOMContent(i)}getMaxWidth(){var S;return(S=this._container)===null||S===void 0?void 0:S.style.maxWidth}setMaxWidth(S){return this.options.maxWidth=S,this._update(),this}setDOMContent(S){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=T.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(S),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(S){return this._container&&this._container.classList.add(S),this}removeClassName(S){return this._container&&this._container.classList.remove(S),this}setOffset(S){return this.options.offset=S,this._update(),this}toggleClassName(S){if(this._container)return this._container.classList.toggle(S)}setSubpixelPositioning(S){this.options.subpixelPositioning=S}_createCloseButton(){this.options.closeButton&&(this._closeButton=T.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const S=this._container.querySelector(eu);S&&S.focus()}},c.RasterDEMTileSource=fn,c.RasterTileSource=Jt,c.ScaleControl=class{constructor(S){this._onMove=()=>{ud(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,ud(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Xu),S)}getDefaultPosition(){return"bottom-left"}onAdd(S){return this._map=S,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-scale",S.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){T.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},c.ScrollZoomHandler=Mi,c.Style=Pp,c.TerrainControl=class{constructor(S){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=S}onAdd(S){return this._map=S,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=T.create("button","maplibregl-ctrl-terrain",this._container),T.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){T.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},c.TwoFingersTouchPitchHandler=ml,c.TwoFingersTouchRotateHandler=ga,c.TwoFingersTouchZoomHandler=Hi,c.TwoFingersTouchZoomRotateHandler=vf,c.VectorTileSource=Ln,c.VideoSource=vn,c.addSourceType=(S,i)=>s._(void 0,void 0,void 0,function*(){if(yt(S))throw new Error(`A source type called "${S}" already exists.`);((u,g)=>{we[u]=g})(S,i)}),c.clearPrewarmedResources=function(){const S=jt;S&&(S.isPreloaded()&&S.numActive()===1?(S.release(st),jt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},c.createTileMesh=Eu,c.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},c.getRTLTextPluginStatus=function(){return ln().getRTLTextPluginStatus()},c.getVersion=function(){return tu},c.getWorkerCount=function(){return Ee.workerCount},c.getWorkerUrl=function(){return s.a.WORKER_URL},c.importScriptInWorkers=function(S){return ht().broadcast("IS",S)},c.prewarm=function(){ft().acquire(st)},c.setMaxParallelImageRequests=function(S){s.a.MAX_PARALLEL_IMAGE_REQUESTS=S},c.setRTLTextPlugin=function(S,i){return ln().setRTLTextPlugin(S,i)},c.setWorkerCount=function(S){Ee.workerCount=S},c.setWorkerUrl=function(S){s.a.WORKER_URL=S}});var l=n;return l})}(Jb)),Jb.exports}var Hw=vte();const zF=JT(Hw),yte=n5({__proto__:null,default:zF},[Hw]);var Ov=Math.pow,Gs=(t,e,n)=>new Promise((r,o)=>{var l=m=>{try{s(n.next(m))}catch(y){o(y)}},c=m=>{try{s(n.throw(m))}catch(y){o(y)}},s=m=>m.done?r(m.value):Promise.resolve(m.value).then(l,c);s((n=n.apply(t,e)).next())}),Ul=Uint8Array,B0=Uint16Array,_te=Int32Array,OF=new Ul([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),FF=new Ul([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),xte=new Ul([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),NF=function(t,e){for(var n=new B0(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var o=new _te(n[30]),r=1;r<30;++r)for(var l=n[r];l<n[r+1];++l)o[l]=l-n[r]<<5|r;return{b:n,r:o}},BF=NF(OF,2),UF=BF.b,bte=BF.r;UF[28]=258,bte[258]=28;var wte=NF(FF,0),Ste=wte.b,$F=new B0(32768);for(pi=0;pi<32768;++pi)Ad=(pi&43690)>>1|(pi&21845)<<1,Ad=(Ad&52428)>>2|(Ad&13107)<<2,Ad=(Ad&61680)>>4|(Ad&3855)<<4,$F[pi]=((Ad&65280)>>8|(Ad&255)<<8)>>1;var Ad,pi,U0=function(t,e,n){for(var r=t.length,o=0,l=new B0(e);o<r;++o)t[o]&&++l[t[o]-1];var c=new B0(e);for(o=1;o<e;++o)c[o]=c[o-1]+l[o-1]<<1;var s;{s=new B0(1<<e);var m=15-e;for(o=0;o<r;++o)if(t[o])for(var y=o<<4|t[o],b=e-t[o],w=c[t[o]-1]++<<b,E=w|(1<<b)-1;w<=E;++w)s[$F[w]>>m]=y}return s},K_=new Ul(288);for(pi=0;pi<144;++pi)K_[pi]=8;var pi;for(pi=144;pi<256;++pi)K_[pi]=9;var pi;for(pi=256;pi<280;++pi)K_[pi]=7;var pi;for(pi=280;pi<288;++pi)K_[pi]=8;var pi,VF=new Ul(32);for(pi=0;pi<32;++pi)VF[pi]=5;var pi,Mte=U0(K_,9),Cte=U0(VF,5),lM=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},uu=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},cM=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},Ete=function(t){return(t+7)/8|0},Tte=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var r=new Ul(n-e);return r.set(t.subarray(e,n)),r},Pte=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Dl=function(t,e,n){var r=new Error(e||Pte[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,Dl),!n)throw r;return r},cA=function(t,e,n,r){var o=t.length,l=0;if(!o||e.f&&!e.l)return n||new Ul(0);var c=!n||e.i!=2,s=e.i;n||(n=new Ul(o*3));var m=function(St){var dn=n.length;if(St>dn){var En=new Ul(Math.max(dn*2,St));En.set(n),n=En}},y=e.f||0,b=e.p||0,w=e.b||0,E=e.l,T=e.d,R=e.m,z=e.n,I=o*8;do{if(!E){y=uu(t,b,1);var L=uu(t,b+1,3);if(b+=3,L)if(L==1)E=Mte,T=Cte,R=9,z=5;else if(L==2){var X=uu(t,b,31)+257,q=uu(t,b+10,15)+4,te=X+uu(t,b+5,31)+1;b+=14;for(var se=new Ul(te),re=new Ul(19),$=0;$<q;++$)re[xte[$]]=uu(t,b+$*3,7);b+=q*3;for(var ce=lM(re),Ce=(1<<ce)-1,Se=U0(re,ce),$=0;$<te;){var Xe=Se[uu(t,b,Ce)];b+=Xe&15;var V=Xe>>4;if(V<16)se[$++]=V;else{var Fe=0,Me=0;for(V==16?(Me=3+uu(t,b,3),b+=2,Fe=se[$-1]):V==17?(Me=3+uu(t,b,7),b+=3):V==18&&(Me=11+uu(t,b,127),b+=7);Me--;)se[$++]=Fe}}var Te=se.subarray(0,X),Ie=se.subarray(X);R=lM(Te),z=lM(Ie),E=U0(Te,R),T=U0(Ie,z)}else Dl(1);else{var V=Ete(b)+4,B=t[V-4]|t[V-3]<<8,W=V+B;if(W>o){s&&Dl(0);break}c&&m(w+B),n.set(t.subarray(V,W),w),e.b=w+=B,e.p=b=W*8,e.f=y;continue}if(b>I){s&&Dl(0);break}}c&&m(w+131072);for(var Ke=(1<<R)-1,st=(1<<z)-1,Ee=b;;Ee=b){var Fe=E[cM(t,b)&Ke],Qe=Fe>>4;if(b+=Fe&15,b>I){s&&Dl(0);break}if(Fe||Dl(2),Qe<256)n[w++]=Qe;else if(Qe==256){Ee=b,E=null;break}else{var jt=Qe-254;if(Qe>264){var $=Qe-257,je=OF[$];jt=uu(t,b,(1<<je)-1)+UF[$],b+=je}var ft=T[cM(t,b)&st],At=ft>>4;ft||Dl(3),b+=ft&15;var Ie=Ste[At];if(At>3){var je=FF[At];Ie+=cM(t,b)&(1<<je)-1,b+=je}if(b>I){s&&Dl(0);break}c&&m(w+131072);var ht=w+jt;if(w<Ie){var lt=l-Ie,bt=Math.min(Ie,ht);for(lt+w<0&&Dl(3);w<bt;++w)n[w]=r[lt+w]}for(;w<ht;w+=4)n[w]=n[w-Ie],n[w+1]=n[w+1-Ie],n[w+2]=n[w+2-Ie],n[w+3]=n[w+3-Ie];w=ht}}e.l=E,e.p=Ee,e.b=w,e.f=y,E&&(y=1,e.m=R,e.d=T,e.n=z)}while(!y);return w==n.length?n:Tte(n,0,w)},Ate=new Ul(0),Ite=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&Dl(6,"invalid gzip data");var e=t[3],n=10;e&4&&(n+=(t[10]|t[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(e&2)},Rte=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Lte=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Dl(6,"invalid zlib data"),(t[1]>>5&1)==1&&Dl(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Dte(t,e){return cA(t,{i:2},e,e)}function kte(t,e){var n=Ite(t);return n+8>t.length&&Dl(6,"invalid gzip data"),cA(t.subarray(n,-8),{i:2},new Ul(Rte(t)),e)}function zte(t,e){return cA(t.subarray(Lte(t),-4),{i:2},e,e)}function D2(t,e){return t[0]==31&&t[1]==139&&t[2]==8?kte(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?Dte(t,e):zte(t,e)}var Ote=typeof TextDecoder<"u"&&new TextDecoder,Fte=0;try{Ote.decode(Ate,{stream:!0}),Fte=1}catch{}var jF=(t,e)=>t*Ov(2,e),u0=(t,e)=>Math.floor(t/Ov(2,e)),A1=(t,e)=>jF(t.getUint16(e+1,!0),8)+t.getUint8(e),HF=(t,e)=>jF(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),Nte=(t,e,n,r,o)=>{if(t!==r.getUint8(o))return t-r.getUint8(o);const l=A1(r,o+1);if(e!==l)return e-l;const c=A1(r,o+4);return n!==c?n-c:0},Bte=(t,e,n,r)=>{const o=GF(t,e|128,n,r);return o?{z:e,x:n,y:r,offset:o[0],length:o[1],isDir:!0}:null},oL=(t,e,n,r)=>{const o=GF(t,e,n,r);return o?{z:e,x:n,y:r,offset:o[0],length:o[1],isDir:!1}:null},GF=(t,e,n,r)=>{let o=0,l=t.byteLength/17-1;for(;o<=l;){const c=l+o>>1,s=Nte(e,n,r,t,c*17);if(s>0)o=c+1;else if(s<0)l=c-1;else return[HF(t,c*17+7),t.getUint32(c*17+13,!0)]}return null},Ute=(t,e)=>t.isDir&&!e.isDir?1:!t.isDir&&e.isDir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,WF=(t,e)=>{const n=t.getUint8(e*17);return{z:n&127,x:A1(t,e*17+1),y:A1(t,e*17+4),offset:HF(t,e*17+7),length:t.getUint32(e*17+13,!0),isDir:n>>7===1}},sL=t=>{const e=[],n=new DataView(t);for(let r=0;r<n.byteLength/17;r++)e.push(WF(n,r));return $te(e)},$te=t=>{t.sort(Ute);const e=new ArrayBuffer(17*t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++){const o=t[r];let l=o.z;o.isDir&&(l=l|128),n[r*17]=l,n[r*17+1]=o.x&255,n[r*17+2]=o.x>>8&255,n[r*17+3]=o.x>>16&255,n[r*17+4]=o.y&255,n[r*17+5]=o.y>>8&255,n[r*17+6]=o.y>>16&255,n[r*17+7]=o.offset&255,n[r*17+8]=u0(o.offset,8)&255,n[r*17+9]=u0(o.offset,16)&255,n[r*17+10]=u0(o.offset,24)&255,n[r*17+11]=u0(o.offset,32)&255,n[r*17+12]=u0(o.offset,48)&255,n[r*17+13]=o.length&255,n[r*17+14]=o.length>>8&255,n[r*17+15]=o.length>>16&255,n[r*17+16]=o.length>>24&255}return e},Vte=(t,e)=>{if(t.byteLength<17)return null;const n=t.byteLength/17,r=WF(t,n-1);if(r.isDir){const o=r.z,l=e.z-o,c=Math.trunc(e.x/(1<<l)),s=Math.trunc(e.y/(1<<l));return{z:o,x:c,y:s}}return null};function jte(t){return Gs(this,null,function*(){const e=yield t.getBytes(0,512e3),n=new DataView(e.data),r=n.getUint32(4,!0),o=n.getUint16(8,!0),l=new TextDecoder("utf-8"),c=JSON.parse(l.decode(new DataView(e.data,10,r)));let s=0;c.compression==="gzip"&&(s=2);let m=0;"minzoom"in c&&(m=+c.minzoom);let y=0;"maxzoom"in c&&(y=+c.maxzoom);let b=0,w=0,E=0,T=-180,R=-85,z=180,I=85;if(c.bounds){const V=c.bounds.split(",");T=+V[0],R=+V[1],z=+V[2],I=+V[3]}if(c.center){const V=c.center.split(",");b=+V[0],w=+V[1],E=+V[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:o*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:s,tileType:1,minZoom:m,maxZoom:y,minLon:T,minLat:R,maxLon:z,maxLat:I,centerZoom:E,centerLon:b,centerLat:w,etag:e.etag}})}function Hte(t,e,n,r,o,l,c){return Gs(this,null,function*(){let s=yield n.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(s=sL(s));const m=oL(new DataView(s),r,o,l);if(m){let w=(yield e.getBytes(m.offset,m.length,c)).data;const E=new DataView(w);return E.getUint8(0)===31&&E.getUint8(1)===139&&(w=D2(new Uint8Array(w))),{data:w}}const y=Vte(new DataView(s),{z:r,x:o,y:l});if(y){const b=Bte(new DataView(s),y.z,y.x,y.y);if(b){let w=yield n.getArrayBuffer(e,b.offset,b.length,t);t.specVersion===1&&(w=sL(w));const E=oL(new DataView(w),r,o,l);if(E){let R=(yield e.getBytes(E.offset,E.length,c)).data;const z=new DataView(R);return z.getUint8(0)===31&&z.getUint8(1)===139&&(R=D2(new Uint8Array(R))),{data:R}}}}})}var qF={getHeader:jte,getZxy:Hte},Gte=t=>(e,n)=>{if(n instanceof AbortController)return t(e,n);const r=new AbortController;return t(e,r).then(o=>n(void 0,o.data,o.cacheControl||"",o.expires||""),o=>n(o)).catch(o=>n(o)),{cancel:()=>r.abort()}},Wte=class{constructor(t){this.tilev4=(e,n)=>Gs(this,null,function*(){if(e.type==="json"){const E=e.url.substr(10);let T=this.tiles.get(E);if(T||(T=new aL(E),this.tiles.set(E,T)),this.metadata)return{data:yield T.getTileJson(e.url)};const R=yield T.getHeader();return{data:{tiles:[`${e.url}/{z}/{x}/{y}`],minzoom:R.minZoom,maxzoom:R.maxZoom,bounds:[R.minLon,R.minLat,R.maxLon,R.maxLat]}}}const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),o=e.url.match(r);if(!o)throw new Error("Invalid PMTiles protocol URL");const l=o[1];let c=this.tiles.get(l);c||(c=new aL(l),this.tiles.set(l,c));const s=o[2],m=o[3],y=o[4],b=yield c.getHeader(),w=yield c?.getZxy(+s,+m,+y,n.signal);return w?{data:new Uint8Array(w.data),cacheControl:w.cacheControl,expires:w.expires}:b.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=Gte(this.tilev4),this.tiles=new Map,this.metadata=t?.metadata||!1}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function Yg(t,e){return(e>>>0)*4294967296+(t>>>0)}function qte(t,e){const n=e.buf;let r=n[e.pos++],o=(r&112)>>4;if(r<128||(r=n[e.pos++],o|=(r&127)<<3,r<128)||(r=n[e.pos++],o|=(r&127)<<10,r<128)||(r=n[e.pos++],o|=(r&127)<<17,r<128)||(r=n[e.pos++],o|=(r&127)<<24,r<128)||(r=n[e.pos++],o|=(r&1)<<31,r<128))return Yg(t,o);throw new Error("Expected varint not more than 10 bytes")}function h0(t){const e=t.buf;let n=e[t.pos++],r=n&127;return n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,qte(r,t))}function Xte(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const o=e[0];e[0]=e[1],e[1]=o}}var Zte=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Yte(t,e,n){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Ov(2,t)-1||n>Ov(2,t)-1)throw Error("tile x/y outside zoom level bounds");const r=Zte[t],o=Ov(2,t);let l=0,c=0,s=0;const m=[e,n];let y=o/2;for(;y>0;)l=(m[0]&y)>0?1:0,c=(m[1]&y)>0?1:0,s+=y*y*(3*l^c),Xte(y,m,l,c),y=y/2;return r+s}function XF(t,e){return Gs(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return D2(new Uint8Array(t));const n=new Response(t).body;if(!n)throw Error("Failed to read response stream");const r=n.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(r).arrayBuffer()}throw Error("Compression method not supported")})}function Kte(t){return t===1?".mvt":t===2?".png":t===3?".jpg":t===4?".webp":t===5?".avif":""}var Jte=127;function Qte(t,e){let n=0,r=t.length-1;for(;n<=r;){const o=r+n>>1,l=e-t[o].tileId;if(l>0)n=o+1;else if(l<0)r=o-1;else return t[o]}return r>=0&&(t[r].runLength===0||e-t[r].tileId<t[r].runLength)?t[r]:null}var ene=class{constructor(t,e=new Headers){this.url=t,this.customHeaders=e,this.mustReload=!1;let n="";"navigator"in globalThis&&(n=globalThis.navigator.userAgent||"");const r=n.indexOf("Windows")>-1,o=/Chrome|Chromium|Edg|OPR|Brave/.test(n);this.chromeWindowsNoCache=!1,r&&o&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(t){this.customHeaders=t}getBytes(t,e,n,r){return Gs(this,null,function*(){let o,l;n?l=n:(o=new AbortController,l=o.signal);const c=new Headers(this.customHeaders);c.set("range",`bytes=${t}-${t+e-1}`);let s;this.mustReload?s="reload":this.chromeWindowsNoCache&&(s="no-store");let m=yield fetch(this.url,{signal:l,cache:s,headers:c});if(t===0&&m.status===416){const E=m.headers.get("Content-Range");if(!E||!E.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const T=+E.substr(8);m=yield fetch(this.url,{signal:l,cache:"reload",headers:{range:`bytes=0-${T-1}`}})}let y=m.headers.get("Etag");if(y?.startsWith("W/")&&(y=null),m.status===416||r&&y&&y!==r)throw this.mustReload=!0,new k2(`Server returned non-matching ETag ${r} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(m.status>=300)throw Error(`Bad response code: ${m.status}`);const b=m.headers.get("Content-Length");if(m.status===200&&(!b||+b>e))throw o&&o.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield m.arrayBuffer(),etag:y||void 0,cacheControl:m.headers.get("Cache-Control")||void 0,expires:m.headers.get("Expires")||void 0}})}};function hu(t,e){const n=t.getUint32(e+4,!0),r=t.getUint32(e+0,!0);return n*Ov(2,32)+r}function tne(t,e){const n=new DataView(t),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:hu(n,8),rootDirectoryLength:hu(n,16),jsonMetadataOffset:hu(n,24),jsonMetadataLength:hu(n,32),leafDirectoryOffset:hu(n,40),leafDirectoryLength:hu(n,48),tileDataOffset:hu(n,56),tileDataLength:hu(n,64),numAddressedTiles:hu(n,72),numTileEntries:hu(n,80),numTileContents:hu(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function ZF(t){const e={buf:new Uint8Array(t),pos:0},n=h0(e),r=[];let o=0;for(let l=0;l<n;l++){const c=h0(e);r.push({tileId:o+c,offset:0,length:0,runLength:1}),o+=c}for(let l=0;l<n;l++)r[l].runLength=h0(e);for(let l=0;l<n;l++)r[l].length=h0(e);for(let l=0;l<n;l++){const c=h0(e);c===0&&l>0?r[l].offset=r[l-1].offset+r[l-1].length:r[l].offset=c-1}return r}function nne(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var k2=class extends Error{};function rne(t,e){return Gs(this,null,function*(){const n=yield t.getBytes(0,16384);if(new DataView(n.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(nne(n.data)<3)return[yield qF.getHeader(t)];const o=n.data.slice(0,Jte),l=tne(o,n.etag),c=n.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),s=`${t.getKey()}|${l.etag||""}|${l.rootDirectoryOffset}|${l.rootDirectoryLength}`,m=ZF(yield e(c,l.internalCompression));return[l,[s,m.length,m]]})}function ine(t,e,n,r,o){return Gs(this,null,function*(){const l=yield t.getBytes(n,r,void 0,o.etag),c=yield e(l.data,o.internalCompression),s=ZF(c);if(s.length===0)throw new Error("Empty directory is invalid");return s})}var one=class{constructor(t=100,e=!0,n=XF){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=t,this.counter=1,this.decompress=n}getHeader(t){return Gs(this,null,function*(){const e=t.getKey(),n=this.cache.get(e);if(n)return n.lastUsed=this.counter++,yield n.data;const r=new Promise((o,l)=>{rne(t,this.decompress).then(c=>{c[1]&&this.cache.set(c[1][0],{lastUsed:this.counter++,data:Promise.resolve(c[1][2])}),o(c[0]),this.prune()}).catch(c=>{l(c)})});return this.cache.set(e,{lastUsed:this.counter++,data:r}),r})}getDirectory(t,e,n,r){return Gs(this,null,function*(){const o=`${t.getKey()}|${r.etag||""}|${e}|${n}`,l=this.cache.get(o);if(l)return l.lastUsed=this.counter++,yield l.data;const c=new Promise((s,m)=>{ine(t,this.decompress,e,n,r).then(y=>{s(y),this.prune()}).catch(y=>{m(y)})});return this.cache.set(o,{lastUsed:this.counter++,data:c}),c})}getArrayBuffer(t,e,n,r){return Gs(this,null,function*(){const o=`${t.getKey()}|${r.etag||""}|${e}|${n}`,l=this.cache.get(o);if(l)return l.lastUsed=this.counter++,yield l.data;const c=new Promise((s,m)=>{t.getBytes(e,n,void 0,r.etag).then(y=>{s(y.data),this.cache.has(o),this.prune()}).catch(y=>{m(y)})});return this.cache.set(o,{lastUsed:this.counter++,data:c}),c})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((n,r)=>{n.lastUsed<t&&(t=n.lastUsed,e=r)}),e&&this.cache.delete(e)}}invalidate(t){return Gs(this,null,function*(){const e=t.getKey();if(this.invalidations.get(e))return yield this.invalidations.get(e);this.cache.delete(t.getKey());const n=new Promise((r,o)=>{this.getHeader(t).then(l=>{r(),this.invalidations.delete(e)}).catch(l=>{o(l)})});this.invalidations.set(e,n)})}},aL=class{constructor(t,e,n){typeof t=="string"?this.source=new ene(t):this.source=t,n?this.decompress=n:this.decompress=XF,e?this.cache=e:this.cache=new one}getHeader(){return Gs(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,n,r){return Gs(this,null,function*(){const o=Yte(t,e,n),l=yield this.cache.getHeader(this.source);if(l.specVersion<3)return qF.getZxy(l,this.source,this.cache,t,e,n,r);if(t<l.minZoom||t>l.maxZoom)return;let c=l.rootDirectoryOffset,s=l.rootDirectoryLength;for(let m=0;m<=3;m++){const y=yield this.cache.getDirectory(this.source,c,s,l),b=Qte(y,o);if(b){if(b.runLength>0){const w=yield this.source.getBytes(l.tileDataOffset+b.offset,b.length,r,l.etag);return{data:yield this.decompress(w.data,l.tileCompression),cacheControl:w.cacheControl,expires:w.expires}}c=l.leafDirectoryOffset+b.offset,s=b.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,n,r){return Gs(this,null,function*(){try{return yield this.getZxyAttempt(t,e,n,r)}catch(o){if(o instanceof k2)return this.cache.invalidate(this.source),yield this.getZxyAttempt(t,e,n,r);throw o}})}getMetadataAttempt(){return Gs(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength,void 0,t.etag),n=yield this.decompress(e.data,t.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(n))})}getMetadata(){return Gs(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof k2)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw t}})}getTileJson(t){return Gs(this,null,function*(){const e=yield this.getHeader(),n=yield this.getMetadata(),r=Kte(e.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${t}/{z}/{x}/{y}${r}`],vector_layers:n.vector_layers,attribution:n.attribution,description:n.description,name:n.name,version:n.version,bounds:[e.minLon,e.minLat,e.maxLon,e.maxLat],center:[e.centerLon,e.centerLat,e.centerZoom],minzoom:e.minZoom,maxzoom:e.maxZoom}})}};let lL=!1;function uA(){if(lL)return;const t=new Wte;zF.addProtocol("pmtiles",t.tile),lL=!0}const Gw=t=>{uA();const{mode:e="light",children:n,tileRootUrl:r}=t,o=lA[e];return oe.jsxs(oe.Fragment,{children:[oe.jsx(kr,{id:"background",type:"background",paint:{"background-color":o.land}}),oe.jsxs(sp,{id:"world",type:"vector",url:`pmtiles://${r}/world.pmtiles`,children:[oe.jsx(kr,{"source-layer":"water",type:"fill",paint:{"fill-color":o.water}}),n,oe.jsx(kr,{"source-layer":"states",type:"line",paint:{"line-color":o.stateBorder,"line-width":1,"line-opacity":1,"line-dasharray":[2,2]}}),oe.jsx(kr,{"source-layer":"countries",type:"line",filter:["!=",["get","name"],"Serbia-Kosovo"],paint:{"line-color":o.countryBorder,"line-width":2,"line-opacity":1}}),oe.jsx(kr,{"source-layer":"countries",type:"line",filter:["==",["get","name"],"Serbia-Kosovo"],paint:{"line-color":o.countryBorder,"line-width":2,"line-opacity":1,"line-dasharray":[3,2]}})]})]})},z2=t=>(uA(),oe.jsx(sp,{type:"vector",url:`pmtiles://${t.tileRootUrl}/${t.game}-contours.pmtiles`,children:oe.jsx(kr,{"source-layer":"contours",type:"fill",layout:{"fill-sort-key":["get","elevation"],visibility:t.showContours?"visible":"none"},paint:{"fill-color":["interpolate",["linear"],["get","elevation"],-200,"#77c571",0,"#77c571",100,"#afd35f",150,"#ece75b",200,"#decb4c",250,"#d2b446",300,"#bf9c4a",400,"#ba8839",500,"#ac792d"]}})}));class Su extends Error{constructor(e){super("unreachable value "+JSON.stringify(e))}}class Kv{static checkArgument(e,n){if(!e)throw new Error(n)}static checkState(e,n){if(!e)throw new Error(n)}static checkExists(e,n){return xr(e,n)}}var Co=(t=>(t[t.FuelStation=0]="FuelStation",t[t.Toll=1]="Toll",t[t.Parking=2]="Parking",t[t.RecruitmentAgency=3]="RecruitmentAgency",t[t.Service=4]="Service",t[t.TruckDealer=5]="TruckDealer",t[t.Port=6]="Port",t[t.Train=7]="Train",t[t.Viewpoint=8]="Viewpoint",t[t.PhotoSight=9]="PhotoSight",t[t.AgricultureCheck=10]="AgricultureCheck",t[t.BorderCheck=11]="BorderCheck",t[t.Garage=12]="Garage",t[t.WeighStation=13]="WeighStation",t[t.CityNames=14]="CityNames",t[t.Company=15]="Company",t[t.RoadNumber=16]="RoadNumber",t[t.Roadwork=17]="Roadwork",t[t.RailCrossing=18]="RailCrossing",t))(Co||{});const ap=new Set(Array.from({length:19},(t,e)=>e)),Jv=t=>{const{game:e,tileRootUrl:n,visibleIcons:r=ap,enableIconAutoHide:o=!0,mode:l="light"}=t,c=e==="ats"?hL(e,t.dlcs??$m):hL(e,t.dlcs??zee),s=lA[l];uA();const m=Y_();return H.useEffect(()=>{if(!m.current)return;const y=m.current;y.on("styleimagemissing",b=>{if(b.id!=="exit-sign"||y.hasImage("exit-sign"))return;const w=64,E=4,T=new Uint8Array(w*w*E);for(let z=0;z<w;z++)for(let I=0;I<w;I++){const L=(I*w+z)*E;I===0||I===w-1||z===0||z===w-1?(T[L+0]=136,T[L+1]=136,T[L+2]=136,T[L+3]=255):z===1||z===2||z===w-2||z===w-3||I===1||I===2||I===w-2||I===w-3?(T[L+0]=255,T[L+1]=255,T[L+2]=255,T[L+3]=255):(T[L+0]=82,T[L+1]=177,T[L+2]=129,T[L+3]=255)}const R=8;y.addImage("exit-sign",{width:w,height:w,data:T},{stretchX:[[R,w-R]],stretchY:[[R,w-R]],content:[R,R,w-R,w-R],pixelRatio:2})})},[m.current]),oe.jsxs(sp,{id:e,type:"vector",url:`pmtiles://${n}/${e}.pmtiles`,children:[oe.jsx(kr,{id:e+"mapAreas","source-layer":e,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"mapArea"],c],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":hM(l),"fill-outline-color":["case",["==",["get","color"],PF.Road],s.mapAreaOutline,hM(l)]}}),oe.jsx(kr,{id:e+"prefabs","source-layer":e,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"prefab"],c],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":hM(l)}}),oe.jsx(sne,{game:e,tileRootUrl:n,mode:l,color:s.footprint}),oe.jsx(kr,{id:e+"hidden-roads","source-layer":e,type:"line",minzoom:9,filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!0],c],paint:{"line-color":s.hiddenRoad,"line-width":1,"line-opacity":.7}}),oe.jsx(kr,{id:e+"visible-roads-case","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],c],layout:dL,paint:{"line-color":dne(l),"line-gap-width":fL,"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,14,2,16,3]}}),oe.jsx(kr,{id:e+"visible-roads","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],c],layout:dL,paint:{"line-color":hne(l),"line-width":fL}}),oe.jsx(kr,{id:e+"ferries","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],paint:{"line-color":s.ferryLine,"line-width":1,"line-opacity":.8,"line-dasharray":[2,2]}}),oe.jsx(kr,{id:e+"trains-a","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":s.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,-6]}}),oe.jsx(kr,{id:e+"trains-b","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":s.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,6]}}),oe.jsx(kr,{id:e+"train-hatch","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":s.trainLine,"line-width":10,"line-opacity":.8,"line-dasharray":[.1,1]}}),oe.jsx(kr,{id:e+"ferry-labels","source-layer":e,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],layout:{...mh,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":s.ferryHalo,"text-color":s.ferryLabel}}),oe.jsx(kr,{id:e+"train-labels","source-layer":e,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],layout:{...mh,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":s.trainHalo,"text-color":s.trainLabel}}),r.has(15)&&oe.jsx(kr,{id:e+"company-icons","source-layer":e,type:"symbol",minzoom:o?8:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"company"],c],layout:Id(o,1,1.25,3.5)}),e==="ets2"&&r.has(16)&&oe.jsx(kr,{id:"euro-road-overlays","source-layer":e,minzoom:o?4.5:0,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["!",["in",["get","sprite"],["literal",cL]]]],layout:Id(o,.4*1.25,.75*1.25,1.25*1.25)}),e==="ats"&&r.has(16)&&oe.jsx(kr,{id:e+"road-interstate-overlays","source-layer":e,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","is",["get","sprite"]],0],c],layout:Id(o,.4,.75,1.25)}),e==="ats"&&r.has(16)&&oe.jsx(kr,{id:e+"road-us-route-overlays","source-layer":e,type:"symbol",minzoom:o?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","us",["get","sprite"]],0],c],layout:Id(o,.4,.75,1.25)}),e==="ats"&&r.has(16)&&oe.jsx(kr,{id:e+"road-state-route-overlays","source-layer":e,type:"symbol",minzoom:o?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],c,["!",["any",["==",["index-of","is",["get","sprite"]],0],["==",["index-of","us",["get","sprite"]],0],["in",["get","sprite"],["literal",cL]]]]],layout:Id(o,.4,.75,1.25)}),r.has(16)&&oe.jsx(kr,{id:e+"exit-points","source-layer":e,type:"symbol",paint:{"text-color":"#fff"},minzoom:o?10:0,layout:{...Id(o,.4,.75,1.25),...mh,"text-field":"{name}","text-size":["interpolate",["linear"],["zoom"],4,4,10,10],"icon-text-fit":"both","icon-text-fit-padding":[0,2,0,2],"icon-image":"exit-sign"},filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"exit"],c]}),r.has(14)&&oe.jsx(kr,{id:e+"city-labels-small","source-layer":e,type:"symbol",minzoom:o?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],[">",["get","scaleRank"],6],c],layout:{...mh,"text-field":"{name}","text-allow-overlap":!o,"text-variable-anchor":mv,"text-size":12,"icon-image":uM,"icon-allow-overlap":!o,"icon-size":.6},paint:s.primaryTextPaint}),r.has(14)&&oe.jsx(kr,{id:e+"city-labels-medium","source-layer":e,type:"symbol",minzoom:o?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],6],[">",["get","scaleRank"],3],c],layout:{...mh,"text-field":"{name}","text-allow-overlap":!o,"text-variable-anchor":mv,"text-size":13,"icon-image":uM,"icon-allow-overlap":!o,"icon-size":.6},paint:s.primaryTextPaint}),r.has(14)&&oe.jsx(kr,{id:e+"city-labels-big","source-layer":e,type:"symbol",minzoom:o?4:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],3],c],layout:{...mh,"text-field":"{name}","text-allow-overlap":!o,"text-variable-anchor":mv,"text-size":14,"icon-image":uM,"icon-allow-overlap":!o,"icon-size":.8},paint:s.primaryTextPaint}),e==="ets2"&&r.has(14)&&oe.jsx(kr,{id:e+"country-labels","source-layer":e,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...mh,"text-font":["Klokantech Noto Sans Bold"],"text-field":"{name}","text-variable-anchor":mv,"text-size":14},paint:s.primaryTextPaint}),e==="ats"&&r.has(14)&&oe.jsx(kr,{id:e+"country-labels","source-layer":e,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...mh,"text-font":["Open Sans Light"],"text-field":"{name}","text-transform":"uppercase","text-variable-anchor":mv,"text-size":["step",["zoom"],10,5,13]},paint:s.secondaryTextPaint}),O2(r)&&oe.jsx(kr,{id:e+"poi-icons","source-layer":e,type:"symbol",minzoom:o?7:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],uL(r),c],layout:Id(o,.6,1.25,2.5,{vertical:2,horizontal:2})}),O2(r)&&(r.has(8)||r.has(9)||r.has(5))&&oe.jsx(kr,{id:e+"poi-icon-labels","source-layer":e,type:"symbol",minzoom:o?9.5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["any",["in",["get","poiType"],["literal",["viewpoint","landmark"]]],["all",["==",["get","poiType"],"facility"],["==",["get","sprite"],"dealer_ico"]]],uL(r),c],layout:{...Id(o,.6,1.25,2.5,{vertical:2,horizontal:2}),...mh,"text-field":"{poiName}","text-allow-overlap":!o,"text-variable-anchor":["left","right","top","bottom"],"text-radial-offset":1.5,"text-size":10},paint:s.primaryTextPaint}),(r.has(17)||r.has(18))&&oe.jsx(kr,{id:e+"traffic-icons","source-layer":e,type:"symbol",minzoom:o?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"traffic"],cne(r),c],layout:Id(o,.6*.5,1.25*.5,2.5*.5,{vertical:2,horizontal:2})})]})},sne=({game:t,tileRootUrl:e,color:n,mode:r})=>oe.jsxs(sp,{id:t+"footprints",type:"vector",url:`pmtiles://${e}/${t}-footprints.pmtiles`,children:[oe.jsx(kr,{id:t+"footprints","source-layer":"footprints",type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-color":n,"fill-opacity":["step",["zoom"],1,9,.8]}}),oe.jsx(kr,{id:t+"extrusions",minzoom:9,"source-layer":"footprints",type:"fill-extrusion",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-extrusion-color":n,"fill-extrusion-height":["interpolate",["exponential",1.5],["zoom"],9,["*",10,["get","height"]],13,["*",20,["get","height"]]],"fill-extrusion-opacity":r==="light"?.33:.67}})]});function Id(t,e,n,r,o={vertical:10,horizontal:30}){const l=["literal",[o.vertical,o.horizontal]];return{"icon-image":"{sprite}","icon-allow-overlap":!t,"icon-padding":l,"icon-size":["interpolate",["exponential",1.5],["zoom"],4,e,9,n,13,r]}}const uM=["step",["zoom"],["case",["==",["get","capital"],2],"dotdot","dot"],8,""],ane=[9,8,6,7,2,0,4,5,12,3,13,1,10,11],YF=[17,18],cL=["weigh_ico","toll_ico","agri_check","border_ico"];function O2(t){return ane.some(e=>t.has(e))}function lne(t){return YF.some(e=>t.has(e))}function cne(t){Kv.checkArgument(lne(t));const e=[];return t.has(17)&&e.push("roadwork"),t.has(18)&&e.push("railcrossing"),["any",e.length>0?["in",["get","sprite"],["literal",e]]:!1]}function uL(t){Kv.checkArgument(O2(t));const e=[];t.has(9)&&e.push("landmark"),t.has(8)&&e.push("viewpoint"),t.has(6)&&e.push("ferry"),t.has(7)&&e.push("train");const n=[];t.has(0)&&n.push("gas_ico"),t.has(4)&&n.push("service_ico"),t.has(13)&&n.push("weigh_station_ico"),t.has(5)&&n.push("dealer_ico"),t.has(12)&&n.push("garage_large_ico"),t.has(3)&&n.push("recruitment_ico"),t.has(2)&&n.push("parking_ico");const r=[];t.has(13)&&r.push("weigh_ico"),t.has(1)&&r.push("toll_ico"),t.has(10)&&r.push("agri_check"),t.has(11)&&r.push("border_ico");const o=e.length>0?["in",["get","poiType"],["literal",e]]:!1,l=n.length>0?["all",["==",["get","poiType"],"facility"],["in",["get","sprite"],["literal",n]]]:!1,c=r.length>0?["all",["==",["get","poiType"],"road"],["in",["get","sprite"],["literal",r]]]:!1;return["any",o,l,c]}function hL(t,e){let n;return t==="ats"?n=Z_(e):(n=Fee(e),n.add(null)),["in",["get","dlcGuard"],["literal",[...n]]]}const mv=["step",["zoom"],["literal",["top","bottom","right","left"]],7,["literal",["center"]]],mh={"text-radial-offset":.5,"text-justify":"auto","text-font":["Klokantech Noto Sans Regular"]},dL={"line-cap":"round","line-join":"bevel"},fL=["interpolate",["exponential",1.5],["zoom"],3,.8,14,30,16,150],KF={light:{freeway:["#fde293","#f8c248"],divided:["#ffffff","#dddddd"],no_vehicles:["#aaaaaa","#888888"],local:["#f1f3f4","#dddddd"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]},dark:{freeway:["#95813e","#372f21"],divided:["#3c4043","#4c5043"],no_vehicles:["#606166","#888888"],local:["#606166","#333"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]}},une={light:{0:"hsl(200, 8%, 92%)",1:"hsl(38, 59%, 76%)",2:"hsl(38, 64%, 58%)",3:"hsl(92, 31%, 70%)",4:"hsl(0, 100%, 30%)",5:"hsl(107, 51%, 43%)",6:"hsl(201, 53%, 39%)",7:"hsl(53, 84%, 53%)",8:"hsl(267,46% ,45%)"},dark:{0:"hsl(200, 2%, 36%)",1:"hsl(38, 25%, 35%)",2:"hsl(38, 25%, 25%)",3:"hsl(143, 20%, 25%)",4:"hsl(0, 100%, 25%)",5:"hsl(107, 51%, 25%)",6:"hsl(201, 53%, 25%)",7:"hsl(53, 84%, 25%)",8:"hsl(267, 46%, 25%)"}},hne=t=>["match",["get","roadType"],...Object.entries(KF[t]).flatMap(([e,[n]])=>[e,n]),"#f0f"],dne=t=>["match",["get","roadType"],...Object.entries(KF[t]).flatMap(([e,[,n]])=>[e,n]),"#b0b"],hM=t=>["match",["get","color"],...Object.entries(une[t]).flatMap(([e,n])=>[Number(e),n]),"#b0b"],fne="/extra-labels.geojson",pne="/ets2-villages.geojson";var fs=(t=>(t.AR="AR",t.AZ="AZ",t.CA="CA",t.CO="CO",t.IA="IA",t.ID="ID",t.KS="KS",t.MO="MO",t.MT="MT",t.NE="NE",t.NM="NM",t.NV="NV",t.OK="OK",t.OR="OR",t.TX="TX",t.UT="UT",t.WA="WA",t.WY="WY",t))(fs||{});const mne={AR:void 0,AZ:void 0,CA:void 0,CO:void 0,IA:void 0,ID:void 0,KS:void 0,MO:void 0,MT:void 0,NE:void 0,NM:void 0,NV:void 0,OK:void 0,OR:void 0,TX:void 0,UT:void 0,WA:void 0,WY:void 0},gne=new Set(Object.keys(mne)),F2=t=>{const{game:e,enableAutoHide:n=!0,mode:r="light"}=t,o=e==="ats"?fne:pne,l=e==="ats"?["all",["boolean",["get","show"],!0],["in",["slice",["get","country"],-2],["literal",[...t.enabledStates??gne]]]]:["boolean",!0],c=lA[r];return oe.jsx(sp,{id:`${e}-scenery-towns`,type:"geojson",data:o,children:oe.jsx(kr,{id:`${e}-scenery-towns`,type:"symbol",minzoom:n?7:0,filter:l,layout:{...mh,"text-field":e==="ats"?"{text}":"{name}","text-allow-overlap":!n,"text-variable-anchor":mv,"text-size":10.5},paint:c.primaryTextPaint})})},Ww=new Proxy({version:8,sprite:"/sprites",glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",sources:{},layers:[]},{get(t,e,n){return e==="sprite"&&typeof t.sprite=="string"&&/^\/\w/.exec(t.sprite.toString())?window.location.origin+t.sprite:Reflect.get(t,e,n)}}),vne=Rs(oe.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),yne=Rs(oe.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6"})),_ne=Rs(oe.jsx("path",{d:"M10.85 12.65h2.3L12 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM14.3 16l-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9z"})),xne=Rs(oe.jsx("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6m0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4"})),bne=Rs(oe.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6"})),pL=Rs(oe.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),wne=Rs(oe.jsx("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"})),Sne=Rs(oe.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),Mne=Rs(oe.jsx("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"})),Cne=Rs(oe.jsx("path",{d:"m16 5-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2"})),Ene=Rs(oe.jsx("path",{d:"M19 5v14H5V5zm1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9M11 7h6v2h-6zm0 4h6v2h-6zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"})),Tne=Rs(oe.jsx("path",{d:"M15 11V5l-3-3-3 3v2H3v14h18V11zm-8 8H5v-2h2zm0-4H5v-2h2zm0-4H5V9h2zm6 8h-2v-2h2zm0-4h-2v-2h2zm0-4h-2V9h2zm0-4h-2V5h2zm6 12h-2v-2h2zm0-4h-2v-2h2z"})),Pne=Rs(oe.jsx("path",{d:"M2 18v4h3v-2h5.5v2h3v-2H19v2h3v-4zM18 2H6c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1m-3 6H9V6h6z"})),Ane=Rs(oe.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),JF=Rs(oe.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),QF=Rs(oe.jsx("path",{d:"m21.58 16.09-1.09-7.66C20.21 6.46 18.52 5 16.53 5H7.47C5.48 5 3.79 6.46 3.51 8.43l-1.09 7.66C2.2 17.63 3.39 19 4.94 19c.68 0 1.32-.27 1.8-.75L9 16h6l2.25 2.25c.48.48 1.13.75 1.8.75 1.56 0 2.75-1.37 2.53-2.91M11 11H9v2H8v-2H6v-1h2V8h1v2h2zm4-1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m2 3c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),eN=Rs(oe.jsx("path",{d:"M20.69 4.05C18.66 4.73 15.86 5.5 12 5.5c-3.89 0-6.95-.84-8.69-1.43-.64-.22-1.31.26-1.31.95V19c0 .68.66 1.17 1.31.95C5.36 19.26 8.1 18.5 12 18.5c3.87 0 6.66.76 8.69 1.45.65.21 1.31-.27 1.31-.95V5c0-.68-.66-1.16-1.31-.95M12 15c-2.34 0-4.52.15-6.52.41l3.69-4.42 2 2.4L14 10l4.51 5.4c-1.99-.25-4.21-.4-6.51-.4"}));function tN(t,e){return iN(t,e,(n,r,o,l)=>Math.sqrt(Math.pow(o-n,2)+Math.pow(l-r,2)))}function Ine(t,e){return iN(t,e,(n,r,o,l)=>[(n+o)/2,(r+l)/2])}function mL([t,e,n,r]){return Ine([t,e],[n,r])}function nN(t){let e=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY;for(const l of t)Array.isArray(l)?(e=Math.min(e,l[0]),r=Math.max(r,l[0]),n=Math.min(n,l[1]),o=Math.max(o,l[1])):(e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),o=Math.max(o,l.y));return[e,n,r,o]}function ib(t,e){const[n,r,o,l]=t,[c,s]=Array.isArray(e)?e:[e.x,e.y];return n<=c&&c<=o&&r<=s&&s<=l}function rN(t){const e=Math.PI*2;let n=t%e;return n=(n+e)%e,n<=Math.PI?n:n-e}function gL(t){return rN(t*Math.PI/180)}function vL(t,e){let n,r;return Array.isArray(t)?(Kv.checkArgument(t.length>=2),n=t[0],r=t[1]):(n=t.x,r=t.y),e(n,r)}function iN(t,e,n){const[r,o]=vL(t,(s,m)=>[s,m]),[l,c]=vL(e,(s,m)=>[s,m]);return n(r,o,l,c)}function Rne(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var Vm=1,jm=2,Fv=3,Lne=4,N2=5,yL=6378137,Dne=6356752314e-3,_L=.0066943799901413165,$0=484813681109536e-20,Cn=Math.PI/2,kne=.16666666666666666,zne=.04722222222222222,One=.022156084656084655,Xn=1e-10,js=.017453292519943295,xh=57.29577951308232,yi=Math.PI/4,v_=Math.PI*2,Do=3.14159265359,sl={};sl.greenwich=0;sl.lisbon=-9.131906111111;sl.paris=2.337229166667;sl.bogota=-74.080916666667;sl.madrid=-3.687938888889;sl.rome=12.452333333333;sl.bern=7.439583333333;sl.jakarta=106.807719444444;sl.ferro=-17.666666666667;sl.brussels=4.367975;sl.stockholm=18.058277777778;sl.athens=23.7163375;sl.oslo=10.722916666667;const Fne={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var xL=/[\s_\-\/\(\)]/g;function lp(t,e){if(t[e])return t[e];for(var n=Object.keys(t),r=e.toLowerCase().replace(xL,""),o=-1,l,c;++o<n.length;)if(l=n[o],c=l.toLowerCase().replace(xL,""),c===r)return t[l]}function B2(t){var e={},n=t.split("+").map(function(s){return s.trim()}).filter(function(s){return s}).reduce(function(s,m){var y=m.split("=");return y.push(!0),s[y[0].toLowerCase()]=y[1],s},{}),r,o,l,c={proj:"projName",datum:"datumCode",rf:function(s){e.rf=parseFloat(s)},lat_0:function(s){e.lat0=s*js},lat_1:function(s){e.lat1=s*js},lat_2:function(s){e.lat2=s*js},lat_ts:function(s){e.lat_ts=s*js},lon_0:function(s){e.long0=s*js},lon_1:function(s){e.long1=s*js},lon_2:function(s){e.long2=s*js},alpha:function(s){e.alpha=parseFloat(s)*js},gamma:function(s){e.rectified_grid_angle=parseFloat(s)},lonc:function(s){e.longc=s*js},x_0:function(s){e.x0=parseFloat(s)},y_0:function(s){e.y0=parseFloat(s)},k_0:function(s){e.k0=parseFloat(s)},k:function(s){e.k0=parseFloat(s)},a:function(s){e.a=parseFloat(s)},b:function(s){e.b=parseFloat(s)},r:function(s){e.a=e.b=parseFloat(s)},r_a:function(){e.R_A=!0},zone:function(s){e.zone=parseInt(s,10)},south:function(){e.utmSouth=!0},towgs84:function(s){e.datum_params=s.split(",").map(function(m){return parseFloat(m)})},to_meter:function(s){e.to_meter=parseFloat(s)},units:function(s){e.units=s;var m=lp(Fne,s);m&&(e.to_meter=m.to_meter)},from_greenwich:function(s){e.from_greenwich=s*js},pm:function(s){var m=lp(sl,s);e.from_greenwich=(m||parseFloat(s))*js},nadgrids:function(s){s==="@null"?e.datumCode="none":e.nadgrids=s},axis:function(s){var m="ewnsud";s.length===3&&m.indexOf(s.substr(0,1))!==-1&&m.indexOf(s.substr(1,1))!==-1&&m.indexOf(s.substr(2,1))!==-1&&(e.axis=s)},approx:function(){e.approx=!0}};for(r in n)o=n[r],r in c?(l=c[r],typeof l=="function"?l(o):e[l]=o):e[r]=o;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var y_=1,oN=2,sN=3,I1=4,aN=5,hA=-1,Nne=/\s/,Bne=/[A-Za-z]/,Une=/[A-Za-z84_]/,qw=/[,\]]/,lN=/[\d\.E\-\+]/;function Qd(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=y_}Qd.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==I1)for(;Nne.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case y_:return this.neutral(t);case oN:return this.keyword(t);case I1:return this.quoted(t);case aN:return this.afterquote(t);case sN:return this.number(t);case hA:return}};Qd.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=I1;return}if(qw.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};Qd.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=y_;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=y_,this.currentObject=this.stack.pop(),this.currentObject||(this.state=hA);return}};Qd.prototype.number=function(t){if(lN.test(t)){this.word+=t;return}if(qw.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};Qd.prototype.quoted=function(t){if(t==='"'){this.state=aN;return}this.word+=t};Qd.prototype.keyword=function(t){if(Une.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=y_;return}if(qw.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};Qd.prototype.neutral=function(t){if(Bne.test(t)){this.word=t,this.state=oN;return}if(t==='"'){this.word="",this.state=I1;return}if(lN.test(t)){this.word=t,this.state=sN;return}if(qw.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};Qd.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===hA)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function $ne(t){var e=new Qd(t);return e.output()}function dM(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,o=n.reduce(function(l,c){return wv(c,l),l},r);e&&(t[e]=o)}function wv(t,e){if(!Array.isArray(t)){e[t]=!0;return}var n=t.shift();if(n==="PARAMETER"&&(n=t.shift()),t.length===1){if(Array.isArray(t[0])){e[n]={},wv(t[0],e[n]);return}e[n]=t[0];return}if(!t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(t);return}Array.isArray(n)||(e[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&wv(t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:t[0],a:t[1],rf:t[2]},t.length===4&&wv(t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":t[0]=["name",t[0]],dM(e,n,t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":t[0]=["name",t[0]],dM(e,n,t),e[n].type=n;return;default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return wv(t,e[n]);return dM(e,n,t)}}var Vne=.017453292519943295,jne=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Hne(t,e){var n=e[0],r=e[1];!(n in t)&&r in t&&(t[n]=t[r],e.length===3&&(t[n]=e[2](t[n])))}function dh(t){return t*Vne}function cN(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;++n){var o=e[n];jne.indexOf(o)!==-1&&Gne(t[o]),typeof t[o]=="object"&&cN(t[o])}}function Gne(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",r=0,o=t.AXIS.length;r<o;++r){var l=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];l[0].indexOf("north")!==-1||(l[0]==="y"||l[0]==="lat")&&l[1]==="north"?n+="n":l[0].indexOf("south")!==-1||(l[0]==="y"||l[0]==="lat")&&l[1]==="south"?n+="s":l[0].indexOf("east")!==-1||(l[0]==="x"||l[0]==="lon")&&l[1]==="east"?n+="e":(l[0].indexOf("west")!==-1||(l[0]==="x"||l[0]==="lon")&&l[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var c=t.GEOGCS;t.type==="GEOGCS"&&(c=t),c&&(c.DATUM?t.datumCode=c.DATUM.name.toLowerCase():t.datumCode=c.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),t.datumCode==="new_zealand_1949"&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode==="belge_1972"&&(t.datumCode="rnb72"),c.DATUM&&c.DATUM.SPHEROID&&(t.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=c.DATUM.SPHEROID.a,t.rf=parseFloat(c.DATUM.SPHEROID.rf,10)),c.DATUM&&c.DATUM.TOWGS84&&(t.datum_params=c.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a);function s(b){var w=t.to_meter||1;return b*w}var m=function(b){return Hne(t,b)},y=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",dh],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",dh],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",dh],["lat0","latitude_of_origin",dh],["lat0","standard_parallel_1",dh],["lat1","standard_parallel_1",dh],["lat2","standard_parallel_2",dh],["azimuth","Azimuth"],["alpha","azimuth",dh],["srsCode","name"]];y.forEach(m),!t.long0&&t.longc&&(t.projName==="Albers_Conic_Equal_Area"||t.projName==="Lambert_Azimuthal_Equal_Area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(t.projName==="Stereographic_South_Pole"||t.projName==="Polar Stereographic (variant B)")?(t.lat0=dh(t.lat1>0?90:-90),t.lat_ts=t.lat1):!t.lat_ts&&t.lat0&&t.projName==="Polar_Stereographic"&&(t.lat_ts=t.lat0,t.lat0=dh(t.lat0>0?90:-90))}function uN(t){var e=$ne(t),n=e[0],r={};return wv(e,r),cN(r),r[n]}function Ca(t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?Ca[t]=B2(arguments[1]):Ca[t]=uN(arguments[1]):Ca[t]=n}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(r){Array.isArray(r)?Ca.apply(e,r):Ca(r)});if(typeof t=="string"){if(t in Ca)return Ca[t]}else"EPSG"in t?Ca["EPSG:"+t.EPSG]=t:"ESRI"in t?Ca["ESRI:"+t.ESRI]=t:"IAU2000"in t?Ca["IAU2000:"+t.IAU2000]=t:console.log(t);return}}Rne(Ca);function Wne(t){return typeof t=="string"}function qne(t){return t in Ca}var Xne=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Zne(t){return Xne.some(function(e){return t.indexOf(e)>-1})}var Yne=["3857","900913","3785","102113"];function Kne(t){var e=lp(t,"authority");if(e){var n=lp(e,"epsg");return n&&Yne.indexOf(n)>-1}}function Jne(t){var e=lp(t,"extension");if(e)return lp(e,"proj4")}function Qne(t){return t[0]==="+"}function ere(t){if(Wne(t)){if(qne(t))return Ca[t];if(Zne(t)){var e=uN(t);if(Kne(e))return Ca["EPSG:3857"];var n=Jne(e);return n?B2(n):e}if(Qne(t))return B2(t)}else return t}function bL(t,e){t=t||{};var n,r;if(!e)return t;for(r in e)n=e[r],n!==void 0&&(t[r]=n);return t}function Ih(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)}function J_(t){return t<0?-1:1}function Kn(t){return Math.abs(t)<=Do?t:t-J_(t)*v_}function xu(t,e,n){var r=t*n,o=.5*t;return r=Math.pow((1-r)/(1+r),o),Math.tan(.5*(Cn-e))/r}function __(t,e){for(var n=.5*t,r,o,l=Cn-2*Math.atan(e),c=0;c<=15;c++)if(r=t*Math.sin(l),o=Cn-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-l,l+=o,Math.abs(o)<=1e-10)return l;return-9999}function tre(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Ih(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function nre(t){var e=t.x,n=t.y;if(n*xh>90&&n*xh<-90&&e*xh>180&&e*xh<-180)return null;var r,o;if(Math.abs(Math.abs(n)-Cn)<=Xn)return null;if(this.sphere)r=this.x0+this.a*this.k0*Kn(e-this.long0),o=this.y0+this.a*this.k0*Math.log(Math.tan(yi+.5*n));else{var l=Math.sin(n),c=xu(this.e,n,l);r=this.x0+this.a*this.k0*Kn(e-this.long0),o=this.y0-this.a*this.k0*Math.log(c)}return t.x=r,t.y=o,t}function rre(t){var e=t.x-this.x0,n=t.y-this.y0,r,o;if(this.sphere)o=Cn-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var l=Math.exp(-n/(this.a*this.k0));if(o=__(this.e,l),o===-9999)return null}return r=Kn(this.long0+e/(this.a*this.k0)),t.x=r,t.y=o,t}var ire=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const ore={init:tre,forward:nre,inverse:rre,names:ire};function sre(){}function wL(t){return t}var are=["longlat","identity"];const lre={init:sre,forward:wL,inverse:wL,names:are};var cre=[ore,lre],Qb={},R1=[];function hN(t,e){var n=R1.length;return t.names?(R1[n]=t,t.names.forEach(function(r){Qb[r.toLowerCase()]=n}),this):(console.log(e),!0)}function ure(t){if(!t)return!1;var e=t.toLowerCase();if(typeof Qb[e]<"u"&&R1[Qb[e]])return R1[Qb[e]]}function hre(){cre.forEach(hN)}const dre={start:hre,add:hN,get:ure};var Cr={};Cr.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Cr.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Cr.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Cr.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Cr.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};Cr.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Cr.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Cr.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};Cr.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Cr.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Cr.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Cr.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};Cr.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Cr.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};Cr.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};Cr.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};Cr.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};Cr.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Cr.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Cr.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};Cr.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};Cr.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};Cr.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};Cr.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};Cr.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Cr.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Cr.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Cr.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Cr.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Cr.hough={a:6378270,rf:297,ellipseName:"Hough"};Cr.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Cr.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Cr.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Cr.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Cr.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};Cr.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Cr.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Cr.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};Cr.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};Cr.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Cr.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Cr.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var fre=Cr.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Cr.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function pre(t,e,n,r){var o=t*t,l=e*e,c=(o-l)/o,s=0;r?(t*=1-c*(kne+c*(zne+c*One)),o=t*t,c=0):s=Math.sqrt(c);var m=(o-l)/l;return{es:c,e:s,ep2:m}}function mre(t,e,n,r,o){if(!t){var l=lp(Cr,r);l||(l=fre),t=l.a,e=l.b,n=l.rf}return n&&!e&&(e=(1-1/n)*t),(n===0||Math.abs(t-e)<Xn)&&(o=!0,e=t),{a:t,b:e,rf:n,sphere:o}}var e1={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var gre in e1){var SL=e1[gre];e1[SL.datumName]=SL}function vre(t,e,n,r,o,l,c){var s={};return t===void 0||t==="none"?s.datum_type=N2:s.datum_type=Lne,e&&(s.datum_params=e.map(parseFloat),(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0)&&(s.datum_type=Vm),s.datum_params.length>3&&(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0)&&(s.datum_type=jm,s.datum_params[3]*=$0,s.datum_params[4]*=$0,s.datum_params[5]*=$0,s.datum_params[6]=s.datum_params[6]/1e6+1)),c&&(s.datum_type=Fv,s.grids=c),s.a=n,s.b=r,s.es=o,s.ep2=l,s}var dN={};function yre(t,e){var n=new DataView(e),r=bre(n),o=wre(n,r),l=Sre(n,o,r),c={header:o,subgrids:l};return dN[t]=c,c}function _re(t){if(t===void 0)return null;var e=t.split(",");return e.map(xre)}function xre(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:dN[t]||null,isNull:!1}}function Sv(t){return t/3600*Math.PI/180}function bre(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function wre(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:U2(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function U2(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function Sre(t,e,n){for(var r=176,o=[],l=0;l<e.nSubgrids;l++){var c=Cre(t,r,n),s=Ere(t,r,c,n),m=Math.round(1+(c.upperLongitude-c.lowerLongitude)/c.longitudeInterval),y=Math.round(1+(c.upperLatitude-c.lowerLatitude)/c.latitudeInterval);o.push({ll:[Sv(c.lowerLongitude),Sv(c.lowerLatitude)],del:[Sv(c.longitudeInterval),Sv(c.latitudeInterval)],lim:[m,y],count:c.gridNodeCount,cvs:Mre(s)}),r+=176+c.gridNodeCount*16}return o}function Mre(t){return t.map(function(e){return[Sv(e.longitudeShift),Sv(e.latitudeShift)]})}function Cre(t,e,n){return{name:U2(t,e+8,e+16).trim(),parent:U2(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function Ere(t,e,n,r){for(var o=e+176,l=16,c=[],s=0;s<n.gridNodeCount;s++){var m={latitudeShift:t.getFloat32(o+s*l,r),longitudeShift:t.getFloat32(o+s*l+4,r),latitudeAccuracy:t.getFloat32(o+s*l+8,r),longitudeAccuracy:t.getFloat32(o+s*l+12,r)};c.push(m)}return c}function Eh(t,e){if(!(this instanceof Eh))return new Eh(t);e=e||function(y){if(y)throw y};var n=ere(t);if(typeof n!="object"){e("Could not parse to valid json: "+t);return}var r=Eh.projections.get(n.projName);if(!r){e("Could not get projection name from: "+t);return}if(n.datumCode&&n.datumCode!=="none"){var o=lp(e1,n.datumCode);o&&(n.datum_params=n.datum_params||(o.towgs84?o.towgs84.split(","):null),n.ellps=o.ellipse,n.datumName=o.datumName?o.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var l=mre(n.a,n.b,n.rf,n.ellps,n.sphere),c=pre(l.a,l.b,l.rf,n.R_A),s=_re(n.nadgrids),m=n.datum||vre(n.datumCode,n.datum_params,l.a,l.b,c.es,c.ep2,s);bL(this,n),bL(this,r),this.a=l.a,this.b=l.b,this.rf=l.rf,this.sphere=l.sphere,this.es=c.es,this.e=c.e,this.ep2=c.ep2,this.datum=m,this.init(),e(null,this)}Eh.projections=dre;Eh.projections.start();function Tre(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===Vm?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===jm?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function fN(t,e,n){var r=t.x,o=t.y,l=t.z?t.z:0,c,s,m,y;if(o<-Cn&&o>-1.001*Cn)o=-Cn;else if(o>Cn&&o<1.001*Cn)o=Cn;else{if(o<-Cn)return{x:-1/0,y:-1/0,z:t.z};if(o>Cn)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),s=Math.sin(o),y=Math.cos(o),m=s*s,c=n/Math.sqrt(1-e*m),{x:(c+l)*y*Math.cos(r),y:(c+l)*y*Math.sin(r),z:(c*(1-e)+l)*s}}function pN(t,e,n,r){var o=1e-12,l=o*o,c=30,s,m,y,b,w,E,T,R,z,I,L,V,B,W=t.x,X=t.y,q=t.z?t.z:0,te,se,re;if(s=Math.sqrt(W*W+X*X),m=Math.sqrt(W*W+X*X+q*q),s/n<o){if(te=0,m/n<o)return se=Cn,re=-r,{x:t.x,y:t.y,z:t.z}}else te=Math.atan2(X,W);y=q/m,b=s/m,w=1/Math.sqrt(1-e*(2-e)*b*b),R=b*(1-e)*w,z=y*w,B=0;do B++,T=n/Math.sqrt(1-e*z*z),re=s*R+q*z-T*(1-e*z*z),E=e*T/(T+re),w=1/Math.sqrt(1-E*(2-E)*b*b),I=b*(1-E)*w,L=y*w,V=L*R-I*z,R=I,z=L;while(V*V>l&&B<c);return se=Math.atan(L/Math.abs(I)),{x:te,y:se,z:re}}function Pre(t,e,n){if(e===Vm)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===jm){var r=n[0],o=n[1],l=n[2],c=n[3],s=n[4],m=n[5],y=n[6];return{x:y*(t.x-m*t.y+s*t.z)+r,y:y*(m*t.x+t.y-c*t.z)+o,z:y*(-s*t.x+c*t.y+t.z)+l}}}function Are(t,e,n){if(e===Vm)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===jm){var r=n[0],o=n[1],l=n[2],c=n[3],s=n[4],m=n[5],y=n[6],b=(t.x-r)/y,w=(t.y-o)/y,E=(t.z-l)/y;return{x:b+m*w-s*E,y:-m*b+w+c*E,z:s*b-c*w+E}}}function ob(t){return t===Vm||t===jm}function Ire(t,e,n){if(Tre(t,e)||t.datum_type===N2||e.datum_type===N2)return n;var r=t.a,o=t.es;if(t.datum_type===Fv){var l=ML(t,!1,n);if(l!==0)return;r=yL,o=_L}var c=e.a,s=e.b,m=e.es;if(e.datum_type===Fv&&(c=yL,s=Dne,m=_L),o===m&&r===c&&!ob(t.datum_type)&&!ob(e.datum_type))return n;if(n=fN(n,o,r),ob(t.datum_type)&&(n=Pre(n,t.datum_type,t.datum_params)),ob(e.datum_type)&&(n=Are(n,e.datum_type,e.datum_params)),n=pN(n,m,c,s),e.datum_type===Fv){var y=ML(e,!0,n);if(y!==0)return}return n}function ML(t,e,n){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},o={x:Number.NaN,y:Number.NaN},l=[];e:for(var c=0;c<t.grids.length;c++){var s=t.grids[c];if(l.push(s.name),s.isNull){o=r;break}if(s.mandatory,s.grid===null){if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1;continue}for(var m=s.grid.subgrids,y=0,b=m.length;y<b;y++){var w=m[y],E=(Math.abs(w.del[1])+Math.abs(w.del[0]))/1e4,T=w.ll[0]-E,R=w.ll[1]-E,z=w.ll[0]+(w.lim[0]-1)*w.del[0]+E,I=w.ll[1]+(w.lim[1]-1)*w.del[1]+E;if(!(R>r.y||T>r.x||I<r.y||z<r.x)&&(o=Rre(r,e,w),!isNaN(o.x)))break e}}return isNaN(o.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*xh+" "+r.y*xh+" tried: '"+l+"'"),-1):(n.x=-o.x,n.y=o.y,0)}function Rre(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var o={x:t.x,y:t.y};o.x-=n.ll[0],o.y-=n.ll[1],o.x=Kn(o.x-Math.PI)+Math.PI;var l=CL(o,n);if(e){if(isNaN(l.x))return r;l.x=o.x-l.x,l.y=o.y-l.y;var c=9,s=1e-12,m,y;do{if(y=CL(l,n),isNaN(y.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}m={x:o.x-(y.x+l.x),y:o.y-(y.y+l.y)},l.x+=m.x,l.y+=m.y}while(c--&&Math.abs(m.x)>s&&Math.abs(m.y)>s);if(c<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=Kn(l.x+n.ll[0]),r.y=l.y+n.ll[1]}else isNaN(l.x)||(r.x=t.x+l.x,r.y=t.y+l.y);return r}function CL(t,e){var n={x:t.x/e.del[0],y:t.y/e.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},o={x:n.x-1*r.x,y:n.y-1*r.y},l={x:Number.NaN,y:Number.NaN},c;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return l;c=r.y*e.lim[0]+r.x;var s={x:e.cvs[c][0],y:e.cvs[c][1]};c++;var m={x:e.cvs[c][0],y:e.cvs[c][1]};c+=e.lim[0];var y={x:e.cvs[c][0],y:e.cvs[c][1]};c--;var b={x:e.cvs[c][0],y:e.cvs[c][1]},w=o.x*o.y,E=o.x*(1-o.y),T=(1-o.x)*(1-o.y),R=(1-o.x)*o.y;return l.x=T*s.x+E*m.x+R*b.x+w*y.x,l.y=T*s.y+E*m.y+R*b.y+w*y.y,l}function EL(t,e,n){var r=n.x,o=n.y,l=n.z||0,c,s,m,y={};for(m=0;m<3;m++)if(!(e&&m===2&&n.z===void 0))switch(m===0?(c=r,"ew".indexOf(t.axis[m])!==-1?s="x":s="y"):m===1?(c=o,"ns".indexOf(t.axis[m])!==-1?s="y":s="x"):(c=l,s="z"),t.axis[m]){case"e":y[s]=c;break;case"w":y[s]=-c;break;case"n":y[s]=c;break;case"s":y[s]=-c;break;case"u":n[s]!==void 0&&(y.z=c);break;case"d":n[s]!==void 0&&(y.z=-c);break;default:return null}return y}function mN(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function Lre(t){TL(t.x),TL(t.y)}function TL(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Dre(t,e){return(t.datum.datum_type===Vm||t.datum.datum_type===jm||t.datum.datum_type===Fv)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Vm||e.datum.datum_type===jm||e.datum.datum_type===Fv)&&t.datumCode!=="WGS84"}function L1(t,e,n,r){var o;Array.isArray(n)?n=mN(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var l=n.z!==void 0;if(Lre(n),t.datum&&e.datum&&Dre(t,e)&&(o=new Eh("WGS84"),n=L1(t,o,n,r),t=o),r&&t.axis!=="enu"&&(n=EL(t,!1,n)),t.projName==="longlat")n={x:n.x*js,y:n.y*js,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),n=t.inverse(n),!n)return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=Ire(t.datum,e.datum,n),!!n)return e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*xh,y:n.y*xh,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),r&&e.axis!=="enu"?EL(e,!0,n):(n&&!l&&delete n.z,n)}var PL=Eh("WGS84");function fM(t,e,n,r){var o,l,c;return Array.isArray(n)?(o=L1(t,e,n,r)||{x:NaN,y:NaN},n.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof o.z=="number"?[o.x,o.y,o.z].concat(n.slice(3)):[o.x,o.y,n[2]].concat(n.slice(3)):[o.x,o.y].concat(n.slice(2)):[o.x,o.y]):(l=L1(t,e,n,r),c=Object.keys(n),c.length===2||c.forEach(function(s){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(s==="x"||s==="y"||s==="z")return}else if(s==="x"||s==="y")return;l[s]=n[s]}),l)}function AL(t){return t instanceof Eh?t:t.oProj?t.oProj:Eh(t)}function ol(t,e,n){t=AL(t);var r=!1,o;return typeof e>"u"?(e=t,t=PL,r=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,e=t,t=PL,r=!0),e=AL(e),n?fM(t,e,n):(o={forward:function(l,c){return fM(t,e,l,c)},inverse:function(l,c){return fM(e,t,l,c)}},r&&(o.oProj=e),o)}var IL=6,gN="AJSAJS",vN="AFAFAF",Mv=65,Xa=73,Sc=79,T0=86,P0=90;const kre={forward:yN,inverse:zre,toPoint:_N};function yN(t,e){return e=e||5,Nre(Ore({lat:t[1],lon:t[0]}),e)}function zre(t){var e=dA(bN(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function _N(t){var e=dA(bN(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function pM(t){return t*(Math.PI/180)}function RL(t){return 180*(t/Math.PI)}function Ore(t){var e=t.lat,n=t.lon,r=6378137,o=.00669438,l=.9996,c,s,m,y,b,w,E,T=pM(e),R=pM(n),z,I;I=Math.floor((n+180)/6)+1,n===180&&(I=60),e>=56&&e<64&&n>=3&&n<12&&(I=32),e>=72&&e<84&&(n>=0&&n<9?I=31:n>=9&&n<21?I=33:n>=21&&n<33?I=35:n>=33&&n<42&&(I=37)),c=(I-1)*6-180+3,z=pM(c),s=o/(1-o),m=r/Math.sqrt(1-o*Math.sin(T)*Math.sin(T)),y=Math.tan(T)*Math.tan(T),b=s*Math.cos(T)*Math.cos(T),w=Math.cos(T)*(R-z),E=r*((1-o/4-3*o*o/64-5*o*o*o/256)*T-(3*o/8+3*o*o/32+45*o*o*o/1024)*Math.sin(2*T)+(15*o*o/256+45*o*o*o/1024)*Math.sin(4*T)-35*o*o*o/3072*Math.sin(6*T));var L=l*m*(w+(1-y+b)*w*w*w/6+(5-18*y+y*y+72*b-58*s)*w*w*w*w*w/120)+5e5,V=l*(E+m*Math.tan(T)*(w*w/2+(5-y+9*b+4*b*b)*w*w*w*w/24+(61-58*y+y*y+600*b-330*s)*w*w*w*w*w*w/720));return e<0&&(V+=1e7),{northing:Math.round(V),easting:Math.round(L),zoneNumber:I,zoneLetter:Fre(e)}}function dA(t){var e=t.northing,n=t.easting,r=t.zoneLetter,o=t.zoneNumber;if(o<0||o>60)return null;var l=.9996,c=6378137,s=.00669438,m,y=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s)),b,w,E,T,R,z,I,L,V,B=n-5e5,W=e;r<"N"&&(W-=1e7),I=(o-1)*6-180+3,m=s/(1-s),z=W/l,L=z/(c*(1-s/4-3*s*s/64-5*s*s*s/256)),V=L+(3*y/2-27*y*y*y/32)*Math.sin(2*L)+(21*y*y/16-55*y*y*y*y/32)*Math.sin(4*L)+151*y*y*y/96*Math.sin(6*L),b=c/Math.sqrt(1-s*Math.sin(V)*Math.sin(V)),w=Math.tan(V)*Math.tan(V),E=m*Math.cos(V)*Math.cos(V),T=c*(1-s)/Math.pow(1-s*Math.sin(V)*Math.sin(V),1.5),R=B/(b*l);var X=V-b*Math.tan(V)/T*(R*R/2-(5+3*w+10*E-4*E*E-9*m)*R*R*R*R/24+(61+90*w+298*E+45*w*w-252*m-3*E*E)*R*R*R*R*R*R/720);X=RL(X);var q=(R-(1+2*w+E)*R*R*R/6+(5-2*E+28*w-3*E*E+8*m+24*w*w)*R*R*R*R*R/120)/Math.cos(V);q=I+RL(q);var te;if(t.accuracy){var se=dA({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});te={top:se.lat,right:se.lon,bottom:X,left:q}}else te={lat:X,lon:q};return te}function Fre(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Nre(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+Bre(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}function Bre(t,e,n){var r=xN(n),o=Math.floor(t/1e5),l=Math.floor(e/1e5)%20;return Ure(o,l,r)}function xN(t){var e=t%IL;return e===0&&(e=IL),e}function Ure(t,e,n){var r=n-1,o=gN.charCodeAt(r),l=vN.charCodeAt(r),c=o+t-1,s=l+e,m=!1;c>P0&&(c=c-P0+Mv-1,m=!0),(c===Xa||o<Xa&&c>Xa||(c>Xa||o<Xa)&&m)&&c++,(c===Sc||o<Sc&&c>Sc||(c>Sc||o<Sc)&&m)&&(c++,c===Xa&&c++),c>P0&&(c=c-P0+Mv-1),s>T0?(s=s-T0+Mv-1,m=!0):m=!1,(s===Xa||l<Xa&&s>Xa||(s>Xa||l<Xa)&&m)&&s++,(s===Sc||l<Sc&&s>Sc||(s>Sc||l<Sc)&&m)&&(s++,s===Xa&&s++),s>T0&&(s=s-T0+Mv-1);var y=String.fromCharCode(c)+String.fromCharCode(s);return y}function bN(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,n=null,r="",o,l=0;!/[A-Z]/.test(o=t.charAt(l));){if(l>=2)throw"MGRSPoint bad conversion from: "+t;r+=o,l++}var c=parseInt(r,10);if(l===0||l+3>e)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(l++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O")throw"MGRSPoint zone letter "+s+" not handled: "+t;n=t.substring(l,l+=2);for(var m=xN(c),y=$re(n.charAt(0),m),b=Vre(n.charAt(1),m);b<jre(s);)b+=2e6;var w=e-l;if(w%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var E=w/2,T=0,R=0,z,I,L,V,B;return E>0&&(z=1e5/Math.pow(10,E),I=t.substring(l,l+E),T=parseFloat(I)*z,L=t.substring(l+E),R=parseFloat(L)*z),V=T+y,B=R+b,{easting:V,northing:B,zoneLetter:s,zoneNumber:c,accuracy:z}}function $re(t,e){for(var n=gN.charCodeAt(e-1),r=1e5,o=!1;n!==t.charCodeAt(0);){if(n++,n===Xa&&n++,n===Sc&&n++,n>P0){if(o)throw"Bad character: "+t;n=Mv,o=!0}r+=1e5}return r}function Vre(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=vN.charCodeAt(e-1),r=0,o=!1;n!==t.charCodeAt(0);){if(n++,n===Xa&&n++,n===Sc&&n++,n>T0){if(o)throw"Bad character: "+t;n=Mv,o=!0}r+=1e5}return r}function jre(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function Qv(t,e,n){if(!(this instanceof Qv))return new Qv(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var r=t.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Qv.fromMGRS=function(t){return new Qv(_N(t))};Qv.prototype.toMGRS=function(t){return yN([this.x,this.y],t)};var Hre=1,Gre=.25,LL=.046875,DL=.01953125,kL=.01068115234375,Wre=.75,qre=.46875,Xre=.013020833333333334,Zre=.007120768229166667,Yre=.3645833333333333,Kre=.005696614583333333,Jre=.3076171875;function fA(t){var e=[];e[0]=Hre-t*(Gre+t*(LL+t*(DL+t*kL))),e[1]=t*(Wre-t*(LL+t*(DL+t*kL)));var n=t*t;return e[2]=n*(qre-t*(Xre+t*Zre)),n*=t,e[3]=n*(Yre-t*Kre),e[4]=n*t*Jre,e}function cy(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var Qre=20;function pA(t,e,n){for(var r=1/(1-e),o=t,l=Qre;l;--l){var c=Math.sin(o),s=1-e*c*c;if(s=(cy(o,c,Math.cos(o),n)-t)*(s*Math.sqrt(s))*r,o-=s,Math.abs(s)<Xn)return o}return o}function eie(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=fA(this.es),this.ml0=cy(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function tie(t){var e=t.x,n=t.y,r=Kn(e-this.long0),o,l,c,s=Math.sin(n),m=Math.cos(n);if(this.es){var b=m*r,w=Math.pow(b,2),E=this.ep2*Math.pow(m,2),T=Math.pow(E,2),R=Math.abs(m)>Xn?Math.tan(n):0,z=Math.pow(R,2),I=Math.pow(z,2);o=1-this.es*Math.pow(s,2),b=b/Math.sqrt(o);var L=cy(n,s,m,this.en);l=this.a*(this.k0*b*(1+w/6*(1-z+E+w/20*(5-18*z+I+14*E-58*z*E+w/42*(61+179*I-I*z-479*z)))))+this.x0,c=this.a*(this.k0*(L-this.ml0+s*r*b/2*(1+w/12*(5-z+9*E+4*T+w/30*(61+I-58*z+270*E-330*z*E+w/56*(1385+543*I-I*z-3111*z))))))+this.y0}else{var y=m*Math.sin(r);if(Math.abs(Math.abs(y)-1)<Xn)return 93;if(l=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,c=m*Math.cos(r)/Math.sqrt(1-Math.pow(y,2)),y=Math.abs(c),y>=1){if(y-1>Xn)return 93;c=0}else c=Math.acos(c);n<0&&(c=-c),c=this.a*this.k0*(c-this.lat0)+this.y0}return t.x=l,t.y=c,t}function nie(t){var e,n,r,o,l=(t.x-this.x0)*(1/this.a),c=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+c/this.k0,n=pA(e,this.es,this.en),Math.abs(n)<Cn){var w=Math.sin(n),E=Math.cos(n),T=Math.abs(E)>Xn?Math.tan(n):0,R=this.ep2*Math.pow(E,2),z=Math.pow(R,2),I=Math.pow(T,2),L=Math.pow(I,2);e=1-this.es*Math.pow(w,2);var V=l*Math.sqrt(e)/this.k0,B=Math.pow(V,2);e=e*T,r=n-e*B/(1-this.es)*.5*(1-B/12*(5+3*I-9*R*I+R-4*z-B/30*(61+90*I-252*R*I+45*L+46*R-B/56*(1385+3633*I+4095*L+1574*L*I)))),o=Kn(this.long0+V*(1-B/6*(1+2*I+R-B/20*(5+28*I+24*L+8*R*I+6*R-B/42*(61+662*I+1320*L+720*L*I))))/E)}else r=Cn*J_(c),o=0;else{var s=Math.exp(l/this.k0),m=.5*(s-1/s),y=this.lat0+c/this.k0,b=Math.cos(y);e=Math.sqrt((1-Math.pow(b,2))/(1+Math.pow(m,2))),r=Math.asin(e),c<0&&(r=-r),m===0&&b===0?o=0:o=Kn(Math.atan2(m,b)+this.long0)}return t.x=o,t.y=r,t}var rie=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const t1={init:eie,forward:tie,inverse:nie,names:rie};function wN(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function Ka(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function iie(t){var e=1+t,n=e-1;return n===0?t:t*Math.log(e)/n}function oie(t){var e=Math.abs(t);return e=iie(e*(1+e/(Ka(1,e)+1))),t<0?-e:e}function mA(t,e){for(var n=2*Math.cos(2*e),r=t.length-1,o=t[r],l=0,c;--r>=0;)c=-l+n*o+t[r],l=o,o=c;return e+c*Math.sin(2*e)}function sie(t,e){for(var n=2*Math.cos(e),r=t.length-1,o=t[r],l=0,c;--r>=0;)c=-l+n*o+t[r],l=o,o=c;return Math.sin(e)*c}function aie(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function SN(t,e,n){for(var r=Math.sin(e),o=Math.cos(e),l=wN(n),c=aie(n),s=2*o*c,m=-2*r*l,y=t.length-1,b=t[y],w=0,E=0,T=0,R,z;--y>=0;)R=E,z=w,E=b,w=T,b=-R+s*E-m*w+t[y],T=-z+m*E+s*w;return s=r*c,m=o*l,[s*b-m*T,s*T+m*b]}function lie(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(t1.init.apply(this),this.forward=t1.forward,this.inverse=t1.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=mA(this.cbg,this.lat0);this.Zb=-this.Qn*(r+sie(this.gtu,2*r))}function cie(t){var e=Kn(t.x-this.long0),n=t.y;n=mA(this.cbg,n);var r=Math.sin(n),o=Math.cos(n),l=Math.sin(e),c=Math.cos(e);n=Math.atan2(r,c*o),e=Math.atan2(l*o,Ka(r,o*c)),e=oie(Math.tan(e));var s=SN(this.gtu,2*n,2*e);n=n+s[0],e=e+s[1];var m,y;return Math.abs(e)<=2.623395162778?(m=this.a*(this.Qn*e)+this.x0,y=this.a*(this.Qn*n+this.Zb)+this.y0):(m=1/0,y=1/0),t.x=m,t.y=y,t}function uie(t){var e=(t.x-this.x0)*(1/this.a),n=(t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var r,o;if(Math.abs(e)<=2.623395162778){var l=SN(this.utg,2*n,2*e);n=n+l[0],e=e+l[1],e=Math.atan(wN(e));var c=Math.sin(n),s=Math.cos(n),m=Math.sin(e),y=Math.cos(e);n=Math.atan2(c*y,Ka(m,y*s)),e=Math.atan2(m,y*s),r=Kn(e+this.long0),o=mA(this.cgb,n)}else r=1/0,o=1/0;return t.x=r,t.y=o,t}var hie=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const n1={init:lie,forward:cie,inverse:uie,names:hie};function die(t,e){if(t===void 0){if(t=Math.floor((Kn(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var fie="etmerc";function pie(){var t=die(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*js,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,n1.init.apply(this),this.forward=n1.forward,this.inverse=n1.inverse}var mie=["Universal Transverse Mercator System","utm"];const gie={init:pie,names:mie,dependsOn:fie};function gA(t,e){return Math.pow((1-t)/(1+t),e)}var vie=20;function yie(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+yi)/(Math.pow(Math.tan(.5*this.lat0+yi),this.C)*gA(this.e*t,this.ratexp))}function _ie(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+yi),this.C)*gA(this.e*Math.sin(n),this.ratexp))-Cn,t.x=this.C*e,t}function xie(t){for(var e=1e-14,n=t.x/this.C,r=t.y,o=Math.pow(Math.tan(.5*r+yi)/this.K,1/this.C),l=vie;l>0&&(r=2*Math.atan(o*gA(this.e*Math.sin(t.y),-.5*this.e))-Cn,!(Math.abs(r-t.y)<e));--l)t.y=r;return l?(t.x=n,t.y=r,t):null}const vA={init:yie,forward:_ie,inverse:xie};function bie(){vA.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function wie(t){var e,n,r,o;return t.x=Kn(t.x-this.long0),vA.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),o=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=o*n*Math.sin(t.x),t.y=o*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Sie(t){var e,n,r,o,l;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,l=Ka(t.x,t.y)){var c=2*Math.atan2(l,this.R2);e=Math.sin(c),n=Math.cos(c),o=Math.asin(n*this.sinc0+t.y*e*this.cosc0/l),r=Math.atan2(t.x*e,l*this.cosc0*n-t.y*this.sinc0*e)}else o=this.phic0,r=0;return t.x=r,t.y=o,vA.inverse.apply(this,[t]),t.x=Kn(t.x+this.long0),t}var Mie=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Cie={init:bie,forward:wie,inverse:Sie,names:Mie};function Eie(t,e,n){return e*=n,Math.tan(.5*(Cn+t))*Math.pow((1-e)/(1+e),.5*n)}function Tie(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Xn&&(this.k0=.5*(1+J_(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Xn&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Xn&&Math.abs(Math.cos(this.lat_ts))>Xn&&(this.k0=.5*this.cons*Ih(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/xu(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Ih(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Cn,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Pie(t){var e=t.x,n=t.y,r=Math.sin(n),o=Math.cos(n),l,c,s,m,y,b,w=Kn(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=Xn&&Math.abs(n+this.lat0)<=Xn?(t.x=NaN,t.y=NaN,t):this.sphere?(l=2*this.k0/(1+this.sinlat0*r+this.coslat0*o*Math.cos(w)),t.x=this.a*l*o*Math.sin(w)+this.x0,t.y=this.a*l*(this.coslat0*r-this.sinlat0*o*Math.cos(w))+this.y0,t):(c=2*Math.atan(this.ssfn_(n,r,this.e))-Cn,m=Math.cos(c),s=Math.sin(c),Math.abs(this.coslat0)<=Xn?(y=xu(this.e,n*this.con,this.con*r),b=2*this.a*this.k0*y/this.cons,t.x=this.x0+b*Math.sin(e-this.long0),t.y=this.y0-this.con*b*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<Xn?(l=2*this.a*this.k0/(1+m*Math.cos(w)),t.y=l*s):(l=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*m*Math.cos(w))),t.y=l*(this.cosX0*s-this.sinX0*m*Math.cos(w))+this.y0),t.x=l*m*Math.sin(w)+this.x0,t))}function Aie(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,o,l,c=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(c/(2*this.a*this.k0));return e=this.long0,n=this.lat0,c<=Xn?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/c),Math.abs(this.coslat0)<Xn?this.lat0>0?e=Kn(this.long0+Math.atan2(t.x,-1*t.y)):e=Kn(this.long0+Math.atan2(t.x,t.y)):e=Kn(this.long0+Math.atan2(t.x*Math.sin(s),c*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s))),t.x=e,t.y=n,t)}else if(Math.abs(this.coslat0)<=Xn){if(c<=Xn)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=c*this.cons/(2*this.a*this.k0),n=this.con*__(this.e,r),e=this.con*Kn(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else o=2*Math.atan(c*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,c<=Xn?l=this.X0:(l=Math.asin(Math.cos(o)*this.sinX0+t.y*Math.sin(o)*this.cosX0/c),e=Kn(this.long0+Math.atan2(t.x*Math.sin(o),c*this.cosX0*Math.cos(o)-t.y*this.sinX0*Math.sin(o)))),n=-1*__(this.e,Math.tan(.5*(Cn+l)));return t.x=e,t.y=n,t}var Iie=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const Rie={init:Tie,forward:Pie,inverse:Aie,names:Iie,ssfn_:Eie};function Lie(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=this.rf,o=1/r,l=2*o-Math.pow(o,2),c=this.e=Math.sqrt(l);this.R=this.k0*n*Math.sqrt(1-l)/(1-l*Math.pow(e,2)),this.alpha=Math.sqrt(1+l/(1-l)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),m=Math.log(Math.tan(Math.PI/4+t/2)),y=Math.log((1+c*e)/(1-c*e));this.K=s-this.alpha*m+this.alpha*c/2*y}function Die(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,o=2*(Math.atan(Math.exp(r))-Math.PI/4),l=this.alpha*(t.x-this.lambda0),c=Math.atan(Math.sin(l)/(Math.sin(this.b0)*Math.tan(o)+Math.cos(this.b0)*Math.cos(l))),s=Math.asin(Math.cos(this.b0)*Math.sin(o)-Math.sin(this.b0)*Math.cos(o)*Math.cos(l));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*c+this.x0,t}function kie(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,o=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),l=Math.asin(Math.cos(this.b0)*Math.sin(o)+Math.sin(this.b0)*Math.cos(o)*Math.cos(r)),c=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(o))),s=this.lambda0+c/this.alpha,m=0,y=l,b=-1e3,w=0;Math.abs(y-b)>1e-7;){if(++w>20)return;m=1/this.alpha*(Math.log(Math.tan(Math.PI/4+l/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(y))/2)),b=y,y=2*Math.atan(Math.exp(m))-Math.PI/2}return t.x=s,t.y=y,t}var zie=["somerc"];const Oie={init:Lie,forward:Die,inverse:kie,names:zie};var gv=1e-7;function Fie(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof t.PROJECTION=="object"?Object.keys(t.PROJECTION)[0]:t.PROJECTION;return"no_uoff"in t||"no_off"in t||e.indexOf(n)!==-1}function Nie(){var t,e,n,r,o,l,c,s,m,y,b=0,w,E=0,T=0,R=0,z=0,I=0,L=0;this.no_off=Fie(this),this.no_rot="no_rot"in this;var V=!1;"alpha"in this&&(V=!0);var B=!1;if("rectified_grid_angle"in this&&(B=!0),V&&(L=this.alpha),B&&(b=this.rectified_grid_angle*js),V||B)E=this.longc;else if(T=this.long1,z=this.lat1,R=this.long2,I=this.lat2,Math.abs(z-I)<=gv||(t=Math.abs(z))<=gv||Math.abs(t-Cn)<=gv||Math.abs(Math.abs(this.lat0)-Cn)<=gv||Math.abs(Math.abs(I)-Cn)<=gv)throw new Error;var W=1-this.es;e=Math.sqrt(W),Math.abs(this.lat0)>Xn?(s=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*s*s,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/W),this.A=this.B*this.k0*e/t,r=this.B*e/(n*Math.sqrt(t)),o=r*r-1,o<=0?o=0:(o=Math.sqrt(o),this.lat0<0&&(o=-o)),this.E=o+=r,this.E*=Math.pow(xu(this.e,this.lat0,s),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=o=1),V||B?(V?(w=Math.asin(Math.sin(L)/r),B||(b=L)):(w=b,L=Math.asin(r*Math.sin(w))),this.lam0=E-Math.asin(.5*(o-1/o)*Math.tan(w))/this.B):(l=Math.pow(xu(this.e,z,Math.sin(z)),this.B),c=Math.pow(xu(this.e,I,Math.sin(I)),this.B),o=this.E/l,m=(c-l)/(c+l),y=this.E*this.E,y=(y-c*l)/(y+c*l),t=T-R,t<-Math.pi?R-=v_:t>Math.pi&&(R+=v_),this.lam0=Kn(.5*(T+R)-Math.atan(y*Math.tan(.5*this.B*(T-R))/m)/this.B),w=Math.atan(2*Math.sin(this.B*Kn(T-this.lam0))/(o-1/o)),b=L=Math.asin(r*Math.sin(w))),this.singam=Math.sin(w),this.cosgam=Math.cos(w),this.sinrot=Math.sin(b),this.cosrot=Math.cos(b),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(L))),this.lat0<0&&(this.u_0=-this.u_0)),o=.5*w,this.v_pole_n=this.ArB*Math.log(Math.tan(yi-o)),this.v_pole_s=this.ArB*Math.log(Math.tan(yi+o))}function Bie(t){var e={},n,r,o,l,c,s,m,y;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-Cn)>Xn){if(c=this.E/Math.pow(xu(this.e,t.y,Math.sin(t.y)),this.B),s=1/c,n=.5*(c-s),r=.5*(c+s),l=Math.sin(this.B*t.x),o=(n*this.singam-l*this.cosgam)/r,Math.abs(Math.abs(o)-1)<Xn)throw new Error;y=.5*this.ArB*Math.log((1-o)/(1+o)),s=Math.cos(this.B*t.x),Math.abs(s)<gv?m=this.A*t.x:m=this.ArB*Math.atan2(n*this.cosgam+l*this.singam,s)}else y=t.y>0?this.v_pole_n:this.v_pole_s,m=this.ArB*t.y;return this.no_rot?(e.x=m,e.y=y):(m-=this.u_0,e.x=y*this.cosrot+m*this.sinrot,e.y=m*this.cosrot-y*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Uie(t){var e,n,r,o,l,c,s,m={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),o=.5*(r-1/r),l=.5*(r+1/r),c=Math.sin(this.BrA*e),s=(c*this.cosgam+o*this.singam)/l,Math.abs(Math.abs(s)-1)<Xn)m.x=0,m.y=s<0?-Cn:Cn;else{if(m.y=this.E/Math.sqrt((1+s)/(1-s)),m.y=__(this.e,Math.pow(m.y,1/this.B)),m.y===1/0)throw new Error;m.x=-this.rB*Math.atan2(o*this.cosgam-c*this.singam,Math.cos(this.BrA*e))}return m.x+=this.lam0,m}var $ie=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Vie={init:Nie,forward:Bie,inverse:Uie,names:$ie};function jie(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Xn)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Ih(this.e,e,n),o=xu(this.e,this.lat1,e),l=Math.sin(this.lat2),c=Math.cos(this.lat2),s=Ih(this.e,l,c),m=xu(this.e,this.lat2,l),y=xu(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Xn?this.ns=Math.log(r/s)/Math.log(o/m):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(o,this.ns)),this.rh=this.a*this.f0*Math.pow(y,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Hie(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=Xn&&(n=J_(n)*(Cn-2*Xn));var r=Math.abs(Math.abs(n)-Cn),o,l;if(r>Xn)o=xu(this.e,n,Math.sin(n)),l=this.a*this.f0*Math.pow(o,this.ns);else{if(r=n*this.ns,r<=0)return null;l=0}var c=this.ns*Kn(e-this.long0);return t.x=this.k0*(l*Math.sin(c))+this.x0,t.y=this.k0*(this.rh-l*Math.cos(c))+this.y0,t}function Gie(t){var e,n,r,o,l,c=(t.x-this.x0)/this.k0,s=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(c*c+s*s),n=1):(e=-Math.sqrt(c*c+s*s),n=-1);var m=0;if(e!==0&&(m=Math.atan2(n*c,n*s)),e!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),o=__(this.e,r),o===-9999)return null}else o=-Cn;return l=Kn(m/this.ns+this.long0),t.x=l,t.y=o,t}var Wie=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const qie={init:jie,forward:Hie,inverse:Gie,names:Wie};function Xie(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Zie(t){var e,n,r,o,l,c,s,m=t.x,y=t.y,b=Kn(m-this.long0);return e=Math.pow((1+this.e*Math.sin(y))/(1-this.e*Math.sin(y)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(y/2+this.s45),this.alfa)/e)-this.s45),r=-b*this.alfa,o=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),l=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(o)),c=this.n*l,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(o/2+this.s45),this.n),t.y=s*Math.cos(c)/1,t.x=s*Math.sin(c)/1,this.czech||(t.y*=-1,t.x*=-1),t}function Yie(t){var e,n,r,o,l,c,s,m,y=t.x;t.x=t.y,t.y=y,this.czech||(t.y*=-1,t.x*=-1),c=Math.sqrt(t.x*t.x+t.y*t.y),l=Math.atan2(t.y,t.x),o=l/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/c,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(o)),n=Math.asin(Math.cos(r)*Math.sin(o)/Math.cos(e)),t.x=this.long0-n/this.alfa,s=e,m=0;var b=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(m=1),s=t.y,b+=1;while(m===0&&b<15);return b>=15?null:t}var Kie=["Krovak","krovak"];const Jie={init:Xie,forward:Zie,inverse:Yie,names:Kie};function Ta(t,e,n,r,o){return t*o-e*Math.sin(2*o)+n*Math.sin(4*o)-r*Math.sin(6*o)}function Q_(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function ex(t){return .375*t*(1+.25*t*(1+.46875*t))}function tx(t){return .05859375*t*t*(1+.75*t)}function nx(t){return t*t*t*(35/3072)}function ey(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)}function _p(t){return Math.abs(t)<Cn?t:t-J_(t)*Math.PI}function D1(t,e,n,r,o){var l,c;l=t/e;for(var s=0;s<15;s++)if(c=(t-(e*l-n*Math.sin(2*l)+r*Math.sin(4*l)-o*Math.sin(6*l)))/(e-2*n*Math.cos(2*l)+4*r*Math.cos(4*l)-6*o*Math.cos(6*l)),l+=c,Math.abs(c)<=1e-10)return l;return NaN}function Qie(){this.sphere||(this.e0=Q_(this.es),this.e1=ex(this.es),this.e2=tx(this.es),this.e3=nx(this.es),this.ml0=this.a*Ta(this.e0,this.e1,this.e2,this.e3,this.lat0))}function eoe(t){var e,n,r=t.x,o=t.y;if(r=Kn(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(o)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(o),Math.cos(r))-this.lat0);else{var l=Math.sin(o),c=Math.cos(o),s=ey(this.a,this.e,l),m=Math.tan(o)*Math.tan(o),y=r*Math.cos(o),b=y*y,w=this.es*c*c/(1-this.es),E=this.a*Ta(this.e0,this.e1,this.e2,this.e3,o);e=s*y*(1-b*m*(1/6-(8-m+8*w)*b/120)),n=E-this.ml0+s*l/c*b*(.5+(5-m+6*w)*b/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function toe(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,o;if(this.sphere){var l=n+this.lat0;r=Math.asin(Math.sin(l)*Math.cos(e)),o=Math.atan2(Math.tan(e),Math.cos(l))}else{var c=this.ml0/this.a+n,s=D1(c,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-Cn)<=Xn)return t.x=this.long0,t.y=Cn,n<0&&(t.y*=-1),t;var m=ey(this.a,this.e,Math.sin(s)),y=m*m*m/this.a/this.a*(1-this.es),b=Math.pow(Math.tan(s),2),w=e*this.a/m,E=w*w;r=s-m*Math.tan(s)/y*w*w*(.5-(1+3*b)*w*w/24),o=w*(1-E*(b/3+(1+3*b)*b*E/15))/Math.cos(s)}return t.x=Kn(o+this.long0),t.y=_p(r),t}var noe=["Cassini","Cassini_Soldner","cass"];const roe={init:Qie,forward:eoe,inverse:toe,names:noe};function Kf(t,e){var n;return t>1e-7?(n=t*e,(1-t*t)*(e/(1-n*n)-.5/t*Math.log((1-n)/(1+n)))):2*e}var ioe=1,ooe=2,soe=3,aoe=4;function loe(){var t=Math.abs(this.lat0);if(Math.abs(t-Cn)<Xn?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<Xn?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=Kf(this.e,1),this.mmf=.5/(1-this.es),this.apa=voe(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Kf(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function coe(t){var e,n,r,o,l,c,s,m,y,b,w=t.x,E=t.y;if(w=Kn(w-this.long0),this.sphere){if(l=Math.sin(E),b=Math.cos(E),r=Math.cos(w),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+b*r:1+this.sinph0*l+this.cosph0*b*r,n<=Xn)return null;n=Math.sqrt(2/n),e=n*b*Math.sin(w),n*=this.mode===this.EQUIT?l:this.cosph0*l-this.sinph0*b*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(E+this.lat0)<Xn)return null;n=yi-E*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(w),n*=r}}else{switch(s=0,m=0,y=0,r=Math.cos(w),o=Math.sin(w),l=Math.sin(E),c=Kf(this.e,l),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(s=c/this.qp,m=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:y=1+this.sinb1*s+this.cosb1*m*r;break;case this.EQUIT:y=1+m*r;break;case this.N_POLE:y=Cn+E,c=this.qp-c;break;case this.S_POLE:y=E-Cn,c=this.qp+c;break}if(Math.abs(y)<Xn)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:y=Math.sqrt(2/y),this.mode===this.OBLIQ?n=this.ymf*y*(this.cosb1*s-this.sinb1*m*r):n=(y=Math.sqrt(2/(1+m*r)))*s*this.ymf,e=this.xmf*y*m*o;break;case this.N_POLE:case this.S_POLE:c>=0?(e=(y=Math.sqrt(c))*o,n=r*(this.mode===this.S_POLE?y:-y)):e=n=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function uoe(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,o,l,c,s,m,y;if(this.sphere){var b=0,w,E=0;if(w=Math.sqrt(e*e+n*n),o=w*.5,o>1)return null;switch(o=2*Math.asin(o),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(E=Math.sin(o),b=Math.cos(o)),this.mode){case this.EQUIT:o=Math.abs(w)<=Xn?0:Math.asin(n*E/w),e*=E,n=b*w;break;case this.OBLIQ:o=Math.abs(w)<=Xn?this.lat0:Math.asin(b*this.sinph0+n*E*this.cosph0/w),e*=E*this.cosph0,n=(b-Math.sin(o)*this.sinph0)*w;break;case this.N_POLE:n=-n,o=Cn-o;break;case this.S_POLE:o-=Cn;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(y=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,m=Math.sqrt(e*e+n*n),m<Xn)return t.x=this.long0,t.y=this.lat0,t;c=2*Math.asin(.5*m/this.rq),l=Math.cos(c),e*=c=Math.sin(c),this.mode===this.OBLIQ?(y=l*this.sinb1+n*c*this.cosb1/m,s=this.qp*y,n=m*this.cosb1*l-n*this.sinb1*c):(y=n*c/m,s=this.qp*y,n=m*l)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),s=e*e+n*n,!s)return t.x=this.long0,t.y=this.lat0,t;y=1-s/this.qp,this.mode===this.S_POLE&&(y=-y)}r=Math.atan2(e,n),o=yoe(Math.asin(y),this.apa)}return t.x=Kn(this.long0+r),t.y=o,t}var hoe=.3333333333333333,doe=.17222222222222222,foe=.10257936507936508,poe=.06388888888888888,moe=.0664021164021164,goe=.016415012942191543;function voe(t){var e,n=[];return n[0]=t*hoe,e=t*t,n[0]+=e*doe,n[1]=e*poe,e*=t,n[0]+=e*foe,n[1]+=e*moe,n[2]=e*goe,n}function yoe(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var _oe=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const xoe={init:loe,forward:coe,inverse:uoe,names:_oe,S_POLE:ioe,N_POLE:ooe,EQUIT:soe,OBLIQ:aoe};function cp(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function boe(){Math.abs(this.lat1+this.lat2)<Xn||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Ih(this.e3,this.sin_po,this.cos_po),this.qs1=Kf(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Ih(this.e3,this.sin_po,this.cos_po),this.qs2=Kf(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Kf(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Xn?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function woe(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Kf(this.e3,this.sin_phi),o=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,l=this.ns0*Kn(e-this.long0),c=o*Math.sin(l)+this.x0,s=this.rh-o*Math.cos(l)+this.y0;return t.x=c,t.y=s,t}function Soe(t){var e,n,r,o,l,c;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),o=0,e!==0&&(o=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?c=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,c=this.phi1z(this.e3,n)),l=Kn(o/this.ns0+this.long0),t.x=l,t.y=c,t}function Moe(t,e){var n,r,o,l,c,s=cp(.5*e);if(t<Xn)return s;for(var m=t*t,y=1;y<=25;y++)if(n=Math.sin(s),r=Math.cos(s),o=t*n,l=1-o*o,c=.5*l*l/r*(e/(1-m)-n/l+.5/t*Math.log((1-o)/(1+o))),s=s+c,Math.abs(c)<=1e-7)return s;return null}var Coe=["Albers_Conic_Equal_Area","Albers","aea"];const Eoe={init:boe,forward:woe,inverse:Soe,names:Coe,phi1z:Moe};function Toe(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Poe(t){var e,n,r,o,l,c,s,m,y=t.x,b=t.y;return r=Kn(y-this.long0),e=Math.sin(b),n=Math.cos(b),o=Math.cos(r),c=this.sin_p14*e+this.cos_p14*n*o,l=1,c>0||Math.abs(c)<=Xn?(s=this.x0+this.a*l*n*Math.sin(r)/c,m=this.y0+this.a*l*(this.cos_p14*e-this.sin_p14*n*o)/c):(s=this.x0+this.infinity_dist*n*Math.sin(r),m=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*o)),t.x=s,t.y=m,t}function Aoe(t){var e,n,r,o,l,c;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(o=Math.atan2(e,this.rc),n=Math.sin(o),r=Math.cos(o),c=cp(r*this.sin_p14+t.y*n*this.cos_p14/e),l=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),l=Kn(this.long0+l)):(c=this.phic0,l=0),t.x=l,t.y=c,t}var Ioe=["gnom"];const Roe={init:Toe,forward:Poe,inverse:Aoe,names:Ioe};function Loe(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*Cn:Cn;for(var r=Math.asin(.5*e),o,l,c,s,m=0;m<30;m++)if(l=Math.sin(r),c=Math.cos(r),s=t*l,o=Math.pow(1-s*s,2)/(2*c)*(e/(1-t*t)-l/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),r+=o,Math.abs(o)<=1e-10)return r;return NaN}function Doe(){this.sphere||(this.k0=Ih(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function koe(t){var e=t.x,n=t.y,r,o,l=Kn(e-this.long0);if(this.sphere)r=this.x0+this.a*l*Math.cos(this.lat_ts),o=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var c=Kf(this.e,Math.sin(n));r=this.x0+this.a*this.k0*l,o=this.y0+this.a*c*.5/this.k0}return t.x=r,t.y=o,t}function zoe(t){t.x-=this.x0,t.y-=this.y0;var e,n;return this.sphere?(e=Kn(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=Loe(this.e,2*t.y*this.k0/this.a),e=Kn(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t}var Ooe=["cea"];const Foe={init:Doe,forward:koe,inverse:zoe,names:Ooe};function Noe(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Boe(t){var e=t.x,n=t.y,r=Kn(e-this.long0),o=_p(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*o,t}function Uoe(t){var e=t.x,n=t.y;return t.x=Kn(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=_p(this.lat0+(n-this.y0)/this.a),t}var $oe=["Equirectangular","Equidistant_Cylindrical","eqc"];const Voe={init:Noe,forward:Boe,inverse:Uoe,names:$oe};var zL=20;function joe(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Q_(this.es),this.e1=ex(this.es),this.e2=tx(this.es),this.e3=nx(this.es),this.ml0=this.a*Ta(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Hoe(t){var e=t.x,n=t.y,r,o,l,c=Kn(e-this.long0);if(l=c*Math.sin(n),this.sphere)Math.abs(n)<=Xn?(r=this.a*c,o=-1*this.a*this.lat0):(r=this.a*Math.sin(l)/Math.tan(n),o=this.a*(_p(n-this.lat0)+(1-Math.cos(l))/Math.tan(n)));else if(Math.abs(n)<=Xn)r=this.a*c,o=-1*this.ml0;else{var s=ey(this.a,this.e,Math.sin(n))/Math.tan(n);r=s*Math.sin(l),o=this.a*Ta(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+s*(1-Math.cos(l))}return t.x=r+this.x0,t.y=o+this.y0,t}function Goe(t){var e,n,r,o,l,c,s,m,y;if(r=t.x-this.x0,o=t.y-this.y0,this.sphere)if(Math.abs(o+this.a*this.lat0)<=Xn)e=Kn(r/this.a+this.long0),n=0;else{c=this.lat0+o/this.a,s=r*r/this.a/this.a+c*c,m=c;var b;for(l=zL;l;--l)if(b=Math.tan(m),y=-1*(c*(m*b+1)-m-.5*(m*m+s)*b)/((m-c)/b-1),m+=y,Math.abs(y)<=Xn){n=m;break}e=Kn(this.long0+Math.asin(r*Math.tan(m)/this.a)/Math.sin(n))}else if(Math.abs(o+this.ml0)<=Xn)n=0,e=Kn(this.long0+r/this.a);else{c=(this.ml0+o)/this.a,s=r*r/this.a/this.a+c*c,m=c;var w,E,T,R,z;for(l=zL;l;--l)if(z=this.e*Math.sin(m),w=Math.sqrt(1-z*z)*Math.tan(m),E=this.a*Ta(this.e0,this.e1,this.e2,this.e3,m),T=this.e0-2*this.e1*Math.cos(2*m)+4*this.e2*Math.cos(4*m)-6*this.e3*Math.cos(6*m),R=E/this.a,y=(c*(w*R+1)-R-.5*w*(R*R+s))/(this.es*Math.sin(2*m)*(R*R+s-2*c*R)/(4*w)+(c-R)*(w*T-2/Math.sin(2*m))-T),m-=y,Math.abs(y)<=Xn){n=m;break}w=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=Kn(this.long0+Math.asin(r*w/this.a)/Math.sin(n))}return t.x=e,t.y=n,t}var Woe=["Polyconic","poly"];const qoe={init:joe,forward:Hoe,inverse:Goe,names:Woe};function Xoe(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Zoe(t){var e,n=t.x,r=t.y,o=r-this.lat0,l=n-this.long0,c=o/$0*1e-5,s=l,m=1,y=0;for(e=1;e<=10;e++)m=m*c,y=y+this.A[e]*m;var b=y,w=s,E=1,T=0,R,z,I=0,L=0;for(e=1;e<=6;e++)R=E*b-T*w,z=T*b+E*w,E=R,T=z,I=I+this.B_re[e]*E-this.B_im[e]*T,L=L+this.B_im[e]*E+this.B_re[e]*T;return t.x=L*this.a+this.x0,t.y=I*this.a+this.y0,t}function Yoe(t){var e,n=t.x,r=t.y,o=n-this.x0,l=r-this.y0,c=l/this.a,s=o/this.a,m=1,y=0,b,w,E=0,T=0;for(e=1;e<=6;e++)b=m*c-y*s,w=y*c+m*s,m=b,y=w,E=E+this.C_re[e]*m-this.C_im[e]*y,T=T+this.C_im[e]*m+this.C_re[e]*y;for(var R=0;R<this.iterations;R++){var z=E,I=T,L,V,B=c,W=s;for(e=2;e<=6;e++)L=z*E-I*T,V=I*E+z*T,z=L,I=V,B=B+(e-1)*(this.B_re[e]*z-this.B_im[e]*I),W=W+(e-1)*(this.B_im[e]*z+this.B_re[e]*I);z=1,I=0;var X=this.B_re[1],q=this.B_im[1];for(e=2;e<=6;e++)L=z*E-I*T,V=I*E+z*T,z=L,I=V,X=X+e*(this.B_re[e]*z-this.B_im[e]*I),q=q+e*(this.B_im[e]*z+this.B_re[e]*I);var te=X*X+q*q;E=(B*X+W*q)/te,T=(W*X-B*q)/te}var se=E,re=T,$=1,ce=0;for(e=1;e<=9;e++)$=$*se,ce=ce+this.D[e]*$;var Ce=this.lat0+ce*$0*1e5,Se=this.long0+re;return t.x=Se,t.y=Ce,t}var Koe=["New_Zealand_Map_Grid","nzmg"];const Joe={init:Xoe,forward:Zoe,inverse:Yoe,names:Koe};function Qoe(){}function ese(t){var e=t.x,n=t.y,r=Kn(e-this.long0),o=this.x0+this.a*r,l=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=o,t.y=l,t}function tse(t){t.x-=this.x0,t.y-=this.y0;var e=Kn(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var nse=["Miller_Cylindrical","mill"];const rse={init:Qoe,forward:ese,inverse:tse,names:nse};var ise=20;function ose(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=fA(this.es)}function sse(t){var e,n,r=t.x,o=t.y;if(r=Kn(r-this.long0),this.sphere){if(!this.m)o=this.n!==1?Math.asin(this.n*Math.sin(o)):o;else for(var l=this.n*Math.sin(o),c=ise;c;--c){var s=(this.m*o+Math.sin(o)-l)/(this.m+Math.cos(o));if(o-=s,Math.abs(s)<Xn)break}e=this.a*this.C_x*r*(this.m+Math.cos(o)),n=this.a*this.C_y*o}else{var m=Math.sin(o),y=Math.cos(o);n=this.a*cy(o,m,y,this.en),e=this.a*r*y/Math.sqrt(1-this.es*m*m)}return t.x=e,t.y=n,t}function ase(t){var e,n,r,o;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=cp((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=cp(Math.sin(e)/this.n)),r=Kn(r+this.long0),e=_p(e)):(e=pA(t.y/this.a,this.es,this.en),o=Math.abs(e),o<Cn?(o=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*o*o)/(this.a*Math.cos(e)),r=Kn(n)):o-Xn<Cn&&(r=this.long0)),t.x=r,t.y=e,t}var lse=["Sinusoidal","sinu"];const cse={init:ose,forward:sse,inverse:ase,names:lse};function use(){}function hse(t){for(var e=t.x,n=t.y,r=Kn(e-this.long0),o=n,l=Math.PI*Math.sin(n);;){var c=-(o+Math.sin(o)-l)/(1+Math.cos(o));if(o+=c,Math.abs(c)<Xn)break}o/=2,Math.PI/2-Math.abs(n)<Xn&&(r=0);var s=.900316316158*this.a*r*Math.cos(o)+this.x0,m=1.4142135623731*this.a*Math.sin(o)+this.y0;return t.x=s,t.y=m,t}function dse(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=Kn(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var o=Math.asin(n);return t.x=r,t.y=o,t}var fse=["Mollweide","moll"];const pse={init:use,forward:hse,inverse:dse,names:fse};function mse(){Math.abs(this.lat1+this.lat2)<Xn||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Q_(this.es),this.e1=ex(this.es),this.e2=tx(this.es),this.e3=nx(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Ih(this.e,this.sinphi,this.cosphi),this.ml1=Ta(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Xn?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Ih(this.e,this.sinphi,this.cosphi),this.ml2=Ta(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ta(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function gse(t){var e=t.x,n=t.y,r;if(this.sphere)r=this.a*(this.g-n);else{var o=Ta(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-o)}var l=this.ns*Kn(e-this.long0),c=this.x0+r*Math.sin(l),s=this.y0+this.rh-r*Math.cos(l);return t.x=c,t.y=s,t}function vse(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,n,r,o;this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var l=0;if(n!==0&&(l=Math.atan2(e*t.x,e*t.y)),this.sphere)return o=Kn(this.long0+l/this.ns),r=_p(this.g-n/this.a),t.x=o,t.y=r,t;var c=this.g-n/this.a;return r=D1(c,this.e0,this.e1,this.e2,this.e3),o=Kn(this.long0+l/this.ns),t.x=o,t.y=r,t}var yse=["Equidistant_Conic","eqdc"];const _se={init:mse,forward:gse,inverse:vse,names:yse};function xse(){this.R=this.a}function bse(t){var e=t.x,n=t.y,r=Kn(e-this.long0),o,l;Math.abs(n)<=Xn&&(o=this.x0+this.R*r,l=this.y0);var c=cp(2*Math.abs(n/Math.PI));(Math.abs(r)<=Xn||Math.abs(Math.abs(n)-Cn)<=Xn)&&(o=this.x0,n>=0?l=this.y0+Math.PI*this.R*Math.tan(.5*c):l=this.y0+Math.PI*this.R*-Math.tan(.5*c));var s=.5*Math.abs(Math.PI/r-r/Math.PI),m=s*s,y=Math.sin(c),b=Math.cos(c),w=b/(y+b-1),E=w*w,T=w*(2/y-1),R=T*T,z=Math.PI*this.R*(s*(w-R)+Math.sqrt(m*(w-R)*(w-R)-(R+m)*(E-R)))/(R+m);r<0&&(z=-z),o=this.x0+z;var I=m+w;return z=Math.PI*this.R*(T*I-s*Math.sqrt((R+m)*(m+1)-I*I))/(R+m),n>=0?l=this.y0+z:l=this.y0-z,t.x=o,t.y=l,t}function wse(t){var e,n,r,o,l,c,s,m,y,b,w,E,T;return t.x-=this.x0,t.y-=this.y0,w=Math.PI*this.R,r=t.x/w,o=t.y/w,l=r*r+o*o,c=-Math.abs(o)*(1+l),s=c-2*o*o+r*r,m=-2*c+1+2*o*o+l*l,T=o*o/m+(2*s*s*s/m/m/m-9*c*s/m/m)/27,y=(c-s*s/3/m)/m,b=2*Math.sqrt(-y/3),w=3*T/y/b,Math.abs(w)>1&&(w>=0?w=1:w=-1),E=Math.acos(w)/3,t.y>=0?n=(-b*Math.cos(E+Math.PI/3)-s/3/m)*Math.PI:n=-(-b*Math.cos(E+Math.PI/3)-s/3/m)*Math.PI,Math.abs(r)<Xn?e=this.long0:e=Kn(this.long0+Math.PI*(l-1+Math.sqrt(1+2*(r*r-o*o)+l*l))/2/r),t.x=e,t.y=n,t}var Sse=["Van_der_Grinten_I","VanDerGrinten","vandg"];const Mse={init:xse,forward:bse,inverse:wse,names:Sse};function Cse(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function Ese(t){var e=t.x,n=t.y,r=Math.sin(t.y),o=Math.cos(t.y),l=Kn(e-this.long0),c,s,m,y,b,w,E,T,R,z,I,L,V,B,W,X,q,te,se,re,$,ce,Ce;return this.sphere?Math.abs(this.sin_p12-1)<=Xn?(t.x=this.x0+this.a*(Cn-n)*Math.sin(l),t.y=this.y0-this.a*(Cn-n)*Math.cos(l),t):Math.abs(this.sin_p12+1)<=Xn?(t.x=this.x0+this.a*(Cn+n)*Math.sin(l),t.y=this.y0+this.a*(Cn+n)*Math.cos(l),t):(te=this.sin_p12*r+this.cos_p12*o*Math.cos(l),X=Math.acos(te),q=X?X/Math.sin(X):1,t.x=this.x0+this.a*q*o*Math.sin(l),t.y=this.y0+this.a*q*(this.cos_p12*r-this.sin_p12*o*Math.cos(l)),t):(c=Q_(this.es),s=ex(this.es),m=tx(this.es),y=nx(this.es),Math.abs(this.sin_p12-1)<=Xn?(b=this.a*Ta(c,s,m,y,Cn),w=this.a*Ta(c,s,m,y,n),t.x=this.x0+(b-w)*Math.sin(l),t.y=this.y0-(b-w)*Math.cos(l),t):Math.abs(this.sin_p12+1)<=Xn?(b=this.a*Ta(c,s,m,y,Cn),w=this.a*Ta(c,s,m,y,n),t.x=this.x0+(b+w)*Math.sin(l),t.y=this.y0+(b+w)*Math.cos(l),t):(E=r/o,T=ey(this.a,this.e,this.sin_p12),R=ey(this.a,this.e,r),z=Math.atan((1-this.es)*E+this.es*T*this.sin_p12/(R*o)),I=Math.atan2(Math.sin(l),this.cos_p12*Math.tan(z)-this.sin_p12*Math.cos(l)),I===0?se=Math.asin(this.cos_p12*Math.sin(z)-this.sin_p12*Math.cos(z)):Math.abs(Math.abs(I)-Math.PI)<=Xn?se=-Math.asin(this.cos_p12*Math.sin(z)-this.sin_p12*Math.cos(z)):se=Math.asin(Math.sin(l)*Math.cos(z)/Math.sin(I)),L=this.e*this.sin_p12/Math.sqrt(1-this.es),V=this.e*this.cos_p12*Math.cos(I)/Math.sqrt(1-this.es),B=L*V,W=V*V,re=se*se,$=re*se,ce=$*se,Ce=ce*se,X=T*se*(1-re*W*(1-W)/6+$/8*B*(1-2*W)+ce/120*(W*(4-7*W)-3*L*L*(1-7*W))-Ce/48*B),t.x=this.x0+X*Math.sin(I),t.y=this.y0+X*Math.cos(I),t))}function Tse(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,o,l,c,s,m,y,b,w,E,T,R,z,I,L,V,B,W,X,q,te,se;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*Cn*this.a?void 0:(n=e/this.a,r=Math.sin(n),o=Math.cos(n),l=this.long0,Math.abs(e)<=Xn?c=this.lat0:(c=cp(o*this.sin_p12+t.y*r*this.cos_p12/e),s=Math.abs(this.lat0)-Cn,Math.abs(s)<=Xn?this.lat0>=0?l=Kn(this.long0+Math.atan2(t.x,-t.y)):l=Kn(this.long0-Math.atan2(-t.x,t.y)):l=Kn(this.long0+Math.atan2(t.x*r,e*this.cos_p12*o-t.y*this.sin_p12*r))),t.x=l,t.y=c,t)):(m=Q_(this.es),y=ex(this.es),b=tx(this.es),w=nx(this.es),Math.abs(this.sin_p12-1)<=Xn?(E=this.a*Ta(m,y,b,w,Cn),e=Math.sqrt(t.x*t.x+t.y*t.y),T=E-e,c=D1(T/this.a,m,y,b,w),l=Kn(this.long0+Math.atan2(t.x,-1*t.y)),t.x=l,t.y=c,t):Math.abs(this.sin_p12+1)<=Xn?(E=this.a*Ta(m,y,b,w,Cn),e=Math.sqrt(t.x*t.x+t.y*t.y),T=e-E,c=D1(T/this.a,m,y,b,w),l=Kn(this.long0+Math.atan2(t.x,t.y)),t.x=l,t.y=c,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),I=Math.atan2(t.x,t.y),R=ey(this.a,this.e,this.sin_p12),L=Math.cos(I),V=this.e*this.cos_p12*L,B=-V*V/(1-this.es),W=3*this.es*(1-B)*this.sin_p12*this.cos_p12*L/(1-this.es),X=e/R,q=X-B*(1+B)*Math.pow(X,3)/6-W*(1+3*B)*Math.pow(X,4)/24,te=1-B*q*q/2-X*q*q*q/6,z=Math.asin(this.sin_p12*Math.cos(q)+this.cos_p12*Math.sin(q)*L),l=Kn(this.long0+Math.asin(Math.sin(I)*Math.sin(q)/Math.cos(z))),se=Math.sin(z),c=Math.atan2((se-this.es*te*this.sin_p12)*Math.tan(z),se*(1-this.es)),t.x=l,t.y=c,t))}var Pse=["Azimuthal_Equidistant","aeqd"];const Ase={init:Cse,forward:Ese,inverse:Tse,names:Pse};function Ise(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Rse(t){var e,n,r,o,l,c,s,m,y=t.x,b=t.y;return r=Kn(y-this.long0),e=Math.sin(b),n=Math.cos(b),o=Math.cos(r),c=this.sin_p14*e+this.cos_p14*n*o,l=1,(c>0||Math.abs(c)<=Xn)&&(s=this.a*l*n*Math.sin(r),m=this.y0+this.a*l*(this.cos_p14*e-this.sin_p14*n*o)),t.x=s,t.y=m,t}function Lse(t){var e,n,r,o,l,c,s;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=cp(e/this.a),r=Math.sin(n),o=Math.cos(n),c=this.long0,Math.abs(e)<=Xn?(s=this.lat0,t.x=c,t.y=s,t):(s=cp(o*this.sin_p14+t.y*r*this.cos_p14/e),l=Math.abs(this.lat0)-Cn,Math.abs(l)<=Xn?(this.lat0>=0?c=Kn(this.long0+Math.atan2(t.x,-t.y)):c=Kn(this.long0-Math.atan2(-t.x,t.y)),t.x=c,t.y=s,t):(c=Kn(this.long0+Math.atan2(t.x*r,e*this.cos_p14*o-t.y*this.sin_p14*r)),t.x=c,t.y=s,t))}var Dse=["ortho"];const kse={init:Ise,forward:Rse,inverse:Lse,names:Dse};var lo={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},_i={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function zse(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Cn-yi/2?this.face=lo.TOP:this.lat0<=-(Cn-yi/2)?this.face=lo.BOTTOM:Math.abs(this.long0)<=yi?this.face=lo.FRONT:Math.abs(this.long0)<=Cn+yi?this.face=this.long0>0?lo.RIGHT:lo.LEFT:this.face=lo.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Ose(t){var e={x:0,y:0},n,r,o,l,c,s,m={value:0};if(t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):n=t.y,r=t.x,this.face===lo.TOP)l=Cn-n,r>=yi&&r<=Cn+yi?(m.value=_i.AREA_0,o=r-Cn):r>Cn+yi||r<=-(Cn+yi)?(m.value=_i.AREA_1,o=r>0?r-Do:r+Do):r>-(Cn+yi)&&r<=-yi?(m.value=_i.AREA_2,o=r+Cn):(m.value=_i.AREA_3,o=r);else if(this.face===lo.BOTTOM)l=Cn+n,r>=yi&&r<=Cn+yi?(m.value=_i.AREA_0,o=-r+Cn):r<yi&&r>=-yi?(m.value=_i.AREA_1,o=-r):r<-yi&&r>=-(Cn+yi)?(m.value=_i.AREA_2,o=-r-Cn):(m.value=_i.AREA_3,o=r>0?-r+Do:-r-Do);else{var y,b,w,E,T,R,z;this.face===lo.RIGHT?r=Nv(r,+Cn):this.face===lo.BACK?r=Nv(r,+Do):this.face===lo.LEFT&&(r=Nv(r,-Cn)),E=Math.sin(n),T=Math.cos(n),R=Math.sin(r),z=Math.cos(r),y=T*z,b=T*R,w=E,this.face===lo.FRONT?(l=Math.acos(y),o=sb(l,w,b,m)):this.face===lo.RIGHT?(l=Math.acos(b),o=sb(l,w,-y,m)):this.face===lo.BACK?(l=Math.acos(-y),o=sb(l,w,-b,m)):this.face===lo.LEFT?(l=Math.acos(-b),o=sb(l,w,y,m)):(l=o=0,m.value=_i.AREA_0)}return s=Math.atan(12/Do*(o+Math.acos(Math.sin(o)*Math.cos(yi))-Cn)),c=Math.sqrt((1-Math.cos(l))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(o))))),m.value===_i.AREA_1?s+=Cn:m.value===_i.AREA_2?s+=Do:m.value===_i.AREA_3&&(s+=1.5*Do),e.x=c*Math.cos(s),e.y=c*Math.sin(s),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function Fse(t){var e={lam:0,phi:0},n,r,o,l,c,s,m,y,b,w={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),n=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?w.value=_i.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(w.value=_i.AREA_1,n-=Cn):t.x<0&&-t.x>=Math.abs(t.y)?(w.value=_i.AREA_2,n=n<0?n+Do:n-Do):(w.value=_i.AREA_3,n+=Cn),b=Do/12*Math.tan(n),c=Math.sin(b)/(Math.cos(b)-1/Math.sqrt(2)),s=Math.atan(c),o=Math.cos(n),l=Math.tan(r),m=1-o*o*l*l*(1-Math.cos(Math.atan(1/Math.cos(s)))),m<-1?m=-1:m>1&&(m=1),this.face===lo.TOP)y=Math.acos(m),e.phi=Cn-y,w.value===_i.AREA_0?e.lam=s+Cn:w.value===_i.AREA_1?e.lam=s<0?s+Do:s-Do:w.value===_i.AREA_2?e.lam=s-Cn:e.lam=s;else if(this.face===lo.BOTTOM)y=Math.acos(m),e.phi=y-Cn,w.value===_i.AREA_0?e.lam=-s+Cn:w.value===_i.AREA_1?e.lam=-s:w.value===_i.AREA_2?e.lam=-s-Cn:e.lam=s<0?-s-Do:-s+Do;else{var E,T,R;E=m,b=E*E,b>=1?R=0:R=Math.sqrt(1-b)*Math.sin(s),b+=R*R,b>=1?T=0:T=Math.sqrt(1-b),w.value===_i.AREA_1?(b=T,T=-R,R=b):w.value===_i.AREA_2?(T=-T,R=-R):w.value===_i.AREA_3&&(b=T,T=R,R=-b),this.face===lo.RIGHT?(b=E,E=-T,T=b):this.face===lo.BACK?(E=-E,T=-T):this.face===lo.LEFT&&(b=E,E=T,T=-b),e.phi=Math.acos(-R)-Cn,e.lam=Math.atan2(T,E),this.face===lo.RIGHT?e.lam=Nv(e.lam,-Cn):this.face===lo.BACK?e.lam=Nv(e.lam,-Do):this.face===lo.LEFT&&(e.lam=Nv(e.lam,+Cn))}if(this.es!==0){var z,I,L;z=e.phi<0?1:0,I=Math.tan(e.phi),L=this.b/Math.sqrt(I*I+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-L*L)/(this.one_minus_f*L)),z&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function sb(t,e,n,r){var o;return t<Xn?(r.value=_i.AREA_0,o=0):(o=Math.atan2(e,n),Math.abs(o)<=yi?r.value=_i.AREA_0:o>yi&&o<=Cn+yi?(r.value=_i.AREA_1,o-=Cn):o>Cn+yi||o<=-(Cn+yi)?(r.value=_i.AREA_2,o=o>=0?o-Do:o+Do):(r.value=_i.AREA_3,o+=Cn)),o}function Nv(t,e){var n=t+e;return n<-Do?n+=v_:n>+Do&&(n-=v_),n}var Nse=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Bse={init:zse,forward:Ose,inverse:Fse,names:Nse};var $2=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],A0=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],MN=.8487,CN=1.3523,EN=xh/5,Use=1/EN,Cv=18,k1=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},$se=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function Vse(t,e,n,r){for(var o=e;r;--r){var l=t(o);if(o-=l,Math.abs(l)<n)break}return o}function jse(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Hse(t){var e=Kn(t.x-this.long0),n=Math.abs(t.y),r=Math.floor(n*EN);r<0?r=0:r>=Cv&&(r=Cv-1),n=xh*(n-Use*r);var o={x:k1($2[r],n)*e,y:k1(A0[r],n)};return t.y<0&&(o.y=-o.y),o.x=o.x*this.a*MN+this.x0,o.y=o.y*this.a*CN+this.y0,o}function Gse(t){var e={x:(t.x-this.x0)/(this.a*MN),y:Math.abs(t.y-this.y0)/(this.a*CN)};if(e.y>=1)e.x/=$2[Cv][0],e.y=t.y<0?-Cn:Cn;else{var n=Math.floor(e.y*Cv);for(n<0?n=0:n>=Cv&&(n=Cv-1);;)if(A0[n][0]>e.y)--n;else if(A0[n+1][0]<=e.y)++n;else break;var r=A0[n],o=5*(e.y-r[0])/(A0[n+1][0]-r[0]);o=Vse(function(l){return(k1(r,l)-e.y)/$se(r,l)},o,Xn,100),e.x/=k1($2[n],o),e.y=(5*n+o)*js,t.y<0&&(e.y=-e.y)}return e.x=Kn(e.x+this.long0),e}var Wse=["Robinson","robin"];const qse={init:jse,forward:Hse,inverse:Gse,names:Wse};function Xse(){this.name="geocent"}function Zse(t){var e=fN(t,this.es,this.a);return e}function Yse(t){var e=pN(t,this.es,this.a,this.b);return e}var Kse=["Geocentric","geocentric","geocent","Geocent"];const Jse={init:Xse,forward:Zse,inverse:Yse,names:Kse};var la={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},d0={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Qse(){if(Object.keys(d0).forEach((function(n){if(typeof this[n]>"u")this[n]=d0[n].def;else{if(d0[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);d0[n].num&&(this[n]=parseFloat(this[n]))}d0[n].degrees&&(this[n]=this[n]*js)}).bind(this)),Math.abs(Math.abs(this.lat0)-Cn)<Xn?this.mode=this.lat0<0?la.S_POLE:la.N_POLE:Math.abs(this.lat0)<Xn?this.mode=la.EQUIT:(this.mode=la.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function eae(t){t.x-=this.long0;var e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),o,l;switch(this.mode){case la.OBLIQ:l=this.sinph0*e+this.cosph0*n*r;break;case la.EQUIT:l=n*r;break;case la.S_POLE:l=-e;break;case la.N_POLE:l=e;break}switch(l=this.pn1/(this.p-l),o=l*n*Math.sin(t.x),this.mode){case la.OBLIQ:l*=this.cosph0*e-this.sinph0*n*r;break;case la.EQUIT:l*=e;break;case la.N_POLE:l*=-(n*r);break;case la.S_POLE:l*=n*r;break}var c,s;return c=l*this.cg+o*this.sg,s=1/(c*this.sw*this.h1+this.cw),o=(o*this.cg-l*this.sg)*this.cw*s,l=c*s,t.x=o*this.a,t.y=l*this.a,t}function tae(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},n,r,o;o=1/(this.pn1-t.y*this.sw),n=this.pn1*t.x*o,r=this.pn1*t.y*this.cw*o,t.x=n*this.cg+r*this.sg,t.y=r*this.cg-n*this.sg;var l=Ka(t.x,t.y);if(Math.abs(l)<Xn)e.x=0,e.y=t.y;else{var c,s;switch(s=1-l*l*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/l+l/this.pn1),c=Math.sqrt(1-s*s),this.mode){case la.OBLIQ:e.y=Math.asin(c*this.sinph0+t.y*s*this.cosph0/l),t.y=(c-this.sinph0*Math.sin(e.y))*l,t.x*=s*this.cosph0;break;case la.EQUIT:e.y=Math.asin(t.y*s/l),t.y=c*l,t.x*=s;break;case la.N_POLE:e.y=Math.asin(c),t.y=-t.y;break;case la.S_POLE:e.y=-Math.asin(c);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var nae=["Tilted_Perspective","tpers"];const rae={init:Qse,forward:eae,inverse:tae,names:nae};function iae(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function oae(t){var e=t.x,n=t.y,r,o,l,c;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var s=this.radius_p/Ka(this.radius_p*Math.cos(n),Math.sin(n));if(o=s*Math.cos(e)*Math.cos(n),l=s*Math.sin(e)*Math.cos(n),c=s*Math.sin(n),(this.radius_g-o)*o-l*l-c*c*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=this.radius_g-o,this.flip_axis?(t.x=this.radius_g_1*Math.atan(l/Ka(c,r)),t.y=this.radius_g_1*Math.atan(c/r)):(t.x=this.radius_g_1*Math.atan(l/r),t.y=this.radius_g_1*Math.atan(c/Ka(l,r)))}else this.shape==="sphere"&&(r=Math.cos(n),o=Math.cos(e)*r,l=Math.sin(e)*r,c=Math.sin(n),r=this.radius_g-o,this.flip_axis?(t.x=this.radius_g_1*Math.atan(l/Ka(c,r)),t.y=this.radius_g_1*Math.atan(c/r)):(t.x=this.radius_g_1*Math.atan(l/r),t.y=this.radius_g_1*Math.atan(c/Ka(l,r))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function sae(t){var e=-1,n=0,r=0,o,l,c,s;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Ka(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Ka(1,n));var m=r/this.radius_p;if(o=n*n+m*m+e*e,l=2*this.radius_g*e,c=l*l-4*o*this.C,c<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-l-Math.sqrt(c))/(2*o),e=this.radius_g+s*e,n*=s,r*=s,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),o=n*n+r*r+e*e,l=2*this.radius_g*e,c=l*l-4*o*this.C,c<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-l-Math.sqrt(c))/(2*o),e=this.radius_g+s*e,n*=s,r*=s,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var aae=["Geostationary Satellite View","Geostationary_Satellite","geos"];const lae={init:iae,forward:oae,inverse:sae,names:aae};var V0=1.340264,j0=-.081106,H0=893e-6,G0=.003796,z1=Math.sqrt(3)/2;function cae(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function uae(t){var e=Kn(t.x-this.long0),n=t.y,r=Math.asin(z1*Math.sin(n)),o=r*r,l=o*o*o;return t.x=e*Math.cos(r)/(z1*(V0+3*j0*o+l*(7*H0+9*G0*o))),t.y=r*(V0+j0*o+l*(H0+G0*o)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function hae(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e=1e-9,n=12,r=t.y,o,l,c,s,m,y;for(y=0;y<n&&(o=r*r,l=o*o*o,c=r*(V0+j0*o+l*(H0+G0*o))-t.y,s=V0+3*j0*o+l*(7*H0+9*G0*o),r-=m=c/s,!(Math.abs(m)<e));++y);return o=r*r,l=o*o*o,t.x=z1*t.x*(V0+3*j0*o+l*(7*H0+9*G0*o))/Math.cos(r),t.y=Math.asin(Math.sin(r)/z1),t.x=Kn(t.x+this.long0),t}var dae=["eqearth","Equal Earth","Equal_Earth"];const fae={init:cae,forward:uae,inverse:hae,names:dae};var x_=1e-10;function pae(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<x_)throw new Error;this.es?(this.en=fA(this.es),this.m1=cy(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=gae,this.forward=mae):(Math.abs(this.phi1)+x_>=Cn?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=yae,this.forward=vae)}function mae(t){var e=Kn(t.x-(this.long0||0)),n=t.y,r,o,l;return r=this.am1+this.m1-cy(n,o=Math.sin(n),l=Math.cos(n),this.en),o=l*e/(r*Math.sqrt(1-this.es*o*o)),t.x=r*Math.sin(o),t.y=this.am1-r*Math.cos(o),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function gae(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r,o;if(n=Ka(t.x,t.y=this.am1-t.y),o=pA(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(o))<Cn)e=Math.sin(o),r=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(o);else if(Math.abs(e-Cn)<=x_)r=0;else throw new Error;return t.x=Kn(r+(this.long0||0)),t.y=_p(o),t}function vae(t){var e=Kn(t.x-(this.long0||0)),n=t.y,r,o;return o=this.cphi1+this.phi1-n,Math.abs(o)>x_?(t.x=o*Math.sin(r=e*Math.cos(n)/o),t.y=this.cphi1-o*Math.cos(r)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function yae(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r=Ka(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>Cn)throw new Error;return Math.abs(Math.abs(n)-Cn)<=x_?e=0:e=r*Math.atan2(t.x,t.y)/Math.cos(n),t.x=Kn(e+(this.long0||0)),t.y=_p(n),t}var _ae=["bonne","Bonne (Werner lat_1=90)"];const xae={init:pae,names:_ae};function bae(t){t.Proj.projections.add(t1),t.Proj.projections.add(n1),t.Proj.projections.add(gie),t.Proj.projections.add(Cie),t.Proj.projections.add(Rie),t.Proj.projections.add(Oie),t.Proj.projections.add(Vie),t.Proj.projections.add(qie),t.Proj.projections.add(Jie),t.Proj.projections.add(roe),t.Proj.projections.add(xoe),t.Proj.projections.add(Eoe),t.Proj.projections.add(Roe),t.Proj.projections.add(Foe),t.Proj.projections.add(Voe),t.Proj.projections.add(qoe),t.Proj.projections.add(Joe),t.Proj.projections.add(rse),t.Proj.projections.add(cse),t.Proj.projections.add(pse),t.Proj.projections.add(_se),t.Proj.projections.add(Mse),t.Proj.projections.add(Ase),t.Proj.projections.add(kse),t.Proj.projections.add(Bse),t.Proj.projections.add(qse),t.Proj.projections.add(Jse),t.Proj.projections.add(rae),t.Proj.projections.add(lae),t.Proj.projections.add(fae),t.Proj.projections.add(xae)}ol.defaultDatum="WGS84";ol.Proj=Eh;ol.WGS84=new ol.Proj("WGS84");ol.Point=Qv;ol.toPoint=mN;ol.defs=Ca;ol.nadgrid=yre;ol.transform=L1;ol.mgrs=kre;ol.version="__VERSION__";bae(ol);const yA=6370997,O1=yA*Math.PI/180,Ev={standardParalel1:33,standardParalel2:45,mapOrigin:[39,-96],mapFactor:[-.00017706234,.000176689948]},wae=["+proj=lcc",`+R=${yA}`,`+lat_1=${Ev.standardParalel1}`,`+lat_2=${Ev.standardParalel2}`,`+lat_0=${Ev.mapOrigin[0]}`,`+lon_0=${Ev.mapOrigin[1]}`].join(" "),Sae=ol(wae),TN=([t,e])=>{const n=Sae.forward([t,e]);return[n[0]/Ev.mapFactor[1]/O1,n[1]/Ev.mapFactor[0]/O1].map(r=>Number(r.toFixed(10)))},Xf={standardParalel1:37,standardParalel2:65,mapOrigin:[50,15],mapOffset:[16660,4150],mapFactor:[-.000171570875,.0001729241463]},Mae=["+proj=lcc",`+R=${yA}`,`+lat_1=${Xf.standardParalel1}`,`+lat_2=${Xf.standardParalel2}`,`+lat_0=${Xf.mapOrigin[0]}`,`+lon_0=${Xf.mapOrigin[1]}`].join(" "),Cae=ol(Mae),PN=([t,e])=>{const n=Cae.forward([t,e]);let[r,o]=[n[0]/Xf.mapFactor[1]/O1,n[1]/Xf.mapFactor[0]/O1];const l=.75,c=[-31100,-5500],s=r/l-c[0]/2,m=o/l-c[1]/2;return s*l<c[0]&&s*l<c[1]&&(r=s,o=m),[r+Xf.mapOffset[0],o+Xf.mapOffset[1]].map(b=>Number(b.toFixed(10)))};var Al=63710088e-1,Eae={centimeters:Al*100,centimetres:Al*100,degrees:360/(2*Math.PI),feet:Al*3.28084,inches:Al*39.37,kilometers:Al/1e3,kilometres:Al/1e3,meters:Al,metres:Al,miles:Al/1609.344,millimeters:Al*1e3,millimetres:Al*1e3,nauticalmiles:Al/1852,radians:1,yards:Al*1.0936};function Tae(t,e="kilometers"){const n=Eae[e];if(!n)throw new Error(e+" units is invalid");return t*n}function ab(t){return t%360*Math.PI/180}function OL(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function V2(t,e,n={}){var r=OL(t),o=OL(e),l=ab(o[1]-r[1]),c=ab(o[0]-r[0]),s=ab(r[1]),m=ab(o[1]),y=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(c/2),2)*Math.cos(s)*Math.cos(m);return Tae(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)),n.units)}const zf={ats:[[-124.477162,25.767968].map(t=>Math.floor(t)),[-88.777474,49.1223839].map(t=>Math.ceil(t))].flat(),ets2:[[-10.025698,34.897275].map(t=>Math.floor(t)),[33.284941,61.881437].map(t=>Math.ceil(t))].flat()},Pae=()=>{const t=xr(Y_().current),[e,n]=H.useState(null),[r,o]=H.useState(!1),[l,c]=H.useState(!1),[s,m]=H.useState([]),y=H.useCallback(T=>{T!=="clickaway"&&o(!1)},[]),b=H.useCallback(()=>{c(!1),m([])},[]),w=T=>()=>{o(!0);const R=xr(e).position;switch(T){case"lngLat":navigator.clipboard.writeText(R.lngLat.map(z=>NL(z,4)).join(","));break;case"xz":navigator.clipboard.writeText(xr(R.xz).map(z=>NL(z,1)).join(","));break;default:throw new Su(T)}},E=H.useCallback(()=>{n(null),t.off("move",E)},[]);return H.useEffect(()=>{const T=L=>{const{x:V,y:B}=L.point,W=L.lngLat.toArray();let X;ib(zf.ats,W)?X=TN(W):ib(zf.ets2,W)&&(X=PN(W));const q=V2(W,mL(zf.ats)),te=V2(W,mL(zf.ets2)),se=q<=te?"ats":"ets2";n({position:{lngLat:W,xz:X},closestGame:se,anchorEl:{getBoundingClientRect:()=>({width:0,height:0,top:B,right:V,bottom:B,left:V})}}),t.once("move",E)};let R;const z=L=>{R=window.setTimeout(()=>{R=void 0,T(L)},1e3)},I=()=>clearTimeout(R);return t.on("contextmenu",T),t.on("touchstart",z),t.on("touchend",I),t.on("touchmove",I),()=>{t.off("contextmenu",T),t.off("touchstart",z),t.off("touchend",I),t.off("touchmove",I)}},[t]),H.useEffect(()=>{if(!l){t.getCanvas().style.cursor="";return}let T=0;const R=()=>T++,z={type:"Feature",geometry:{type:"LineString",coordinates:s},properties:{id:R()}},I={type:"FeatureCollection",features:[...s.map(B=>BL(B,R())),...s.length>1?[z]:[]]},L=B=>{const W=t.queryRenderedFeatures(B.point,{layers:["measure-points"]}),X=ib(l==="ats"?zf.ats:zf.ets2,B.lngLat.toArray());t.getCanvas().style.cursor=X?W.length?"pointer":"crosshair":"not-allowed"},V=B=>{if(!ib(l==="ats"?zf.ats:zf.ets2,B.lngLat.toArray()))return;const X=t.queryRenderedFeatures(B.point,{layers:["measure-points"]});if(I.features.length>1&&I.features.pop(),X.length){const q=X[0].properties.id;I.features=I.features.filter(te=>te.properties.id!==q)}else I.features.push(BL(B.lngLat.toArray(),R()));I.features.length>1&&(z.geometry.coordinates=I.features.map(q=>(EF(q.geometry.type==="Point",`unexpected non-Point geometry: ${q.geometry.type}`),q.geometry.coordinates)),I.features.push(z)),xr(t.getSource("measure")).setData(I),m(I.features.filter(q=>q.geometry.type==="Point").map(q=>q.geometry.coordinates))};return t.on("mousemove",L),t.on("click",V),xr(t.getSource("measure")).setData(I),()=>{t.off("mousemove",L),t.off("click",V),xr(t.getSource("measure")).setData({type:"FeatureCollection",features:[]})}},[t,s,l]),oe.jsxs(oe.Fragment,{children:[oe.jsx("div",{style:{display:e!=null?"block":"none",zIndex:10,position:"absolute",top:0,left:0,right:0,bottom:0},onMouseDown:T=>{T.currentTarget===T.target&&E()},children:oe.jsx(k4,{size:"sm",open:e!=null,anchorEl:e?.anchorEl,placement:"bottom-start",onClick:E,onContextMenu:T=>T.preventDefault(),children:e?oe.jsxs(oe.Fragment,{children:[oe.jsxs(Im,{sx:{justifyContent:"space-between"},onClick:w("lngLat"),children:[oe.jsx(JF,{}),oe.jsx(f_,{children:oe.jsx(FL,{coords:{lng:e.position.lngLat[0],lat:e.position.lngLat[1]},fractionDigits:4})}),oe.jsx(pL,{sx:{ml:1}})]}),e.position.xz?oe.jsxs(oe.Fragment,{children:[oe.jsxs(Im,{sx:{justifyContent:"space-between"},onClick:w("xz"),children:[oe.jsx(QF,{}),oe.jsx(f_,{children:oe.jsx(FL,{coords:{x:e.position.xz[0],z:e.position.xz[1]},fractionDigits:1})}),oe.jsx(pL,{sx:{ml:1}})]}),oe.jsx(w2,{}),l?oe.jsx(Im,{onClick:b,children:"Clear measurement"}):oe.jsx(Im,{onClick:()=>{c(xr(e).closestGame),m([xr(e).position.lngLat])},children:"Measure distance"})]}):oe.jsxs(oe.Fragment,{children:[oe.jsx(w2,{}),oe.jsx(gp,{children:oe.jsxs(Fi,{level:"body-xs",sx:{opacity:.75},children:["Right-click within the"," ",e.closestGame.toUpperCase()," game map for more options."]})})]})]}):null})}),oe.jsx(Aae,{measuring:l,close:b,measuringPoints:s}),oe.jsx(Iae,{open:r,close:y})]})},FL=t=>Object.entries(t.coords).map(([e,n],r)=>oe.jsxs(H.Fragment,{children:[r>0?oe.jsx("span",{children:"  "}):null,oe.jsx(d4,{size:"sm",variant:"plain",sx:{opacity:.4},children:e}),I0(n,t.fractionDigits)]},e)),Aae=H.memo(t=>t.measuring===!1?null:oe.jsx(N4,{open:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",sx:{alignItems:"baseline",mb:4},endDecorator:oe.jsx(Ah,{onClick:t.close,children:oe.jsx(sA,{})}),children:oe.jsxs(Ya,{gap:1,children:[oe.jsx(Fi,{level:"title-md",children:"Measure distance"}),t.measuringPoints.length<=1?oe.jsx(Fi,{level:"body-sm",children:"Click on the map to trace a path you want to measure."}):oe.jsxs(Ya,{gap:2,children:[oe.jsx(Fi,{level:"body-sm",children:"Click on the map to add to your path. Click on an existing point to remove it from the path."}),oe.jsxs(Ya,{direction:{xs:"column",md:"row"},gap:2,children:[oe.jsx(Fi,{level:"title-sm",children:"Total distance:"}),oe.jsxs(Ya,{direction:"row",gap:.5,children:[oe.jsx(Fi,{level:"body-xs",children:oe.jsx(JF,{})}),oe.jsx(Fi,{level:"title-sm",children:UL(t.measuringPoints,"irl",t.measuring)})]}),oe.jsxs(Ya,{direction:"row",gap:.5,children:[oe.jsx(Fi,{level:"body-xs",children:oe.jsx(QF,{})}),oe.jsx(Fi,{level:"title-sm",children:UL(t.measuringPoints,"game",t.measuring)})]})]})]})]})})),Iae=H.memo(t=>oe.jsx(N4,{open:t.open,onClose:(e,n)=>t.close(n),autoHideDuration:3e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",endDecorator:oe.jsx(Ah,{onClick:()=>t.close("escapeKeyDown"),children:oe.jsx(sA,{})}),children:"Copied to clipboard."}));function NL(t,e){return Number(t.toFixed(e))}function I0(t,e){return Number(t.toFixed(e)).toLocaleString(void 0,{maximumFractionDigits:e})}function BL(t,e){return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:{id:e}}}function UL(t,e,n){let r;if(e==="irl")r=t;else{const m=n==="ats"?TN:PN;r=t.map(m)}const o=e==="irl"?V2:(m,y)=>tN(m,y)/1e3;let l=r[0],c=0;for(const m of r.slice(1))c+=o(l,m),l=m;const s=c<1?`${I0(c*1e3,1)} meters`:`${I0(c,2)} km`;if(e==="irl"){const m=c*.6213712,y=m<1?`${I0(m*5280,0)} ft`:`${I0(m,2)} mi`;return`${n==="ats"?y:s} (${n==="ats"?s:y})`}else return s}const AN={[Co.FuelStation]:{iconName:"gas_ico",label:"Fuel station"},[Co.Toll]:{iconName:"toll_ico",label:"Toll gate"},[Co.Parking]:{iconName:"parking_ico",label:"Rest stop"},[Co.RecruitmentAgency]:{iconName:"recruitment_ico",label:"Recruitment agency"},[Co.Service]:{iconName:"service_ico",label:"Service"},[Co.TruckDealer]:{iconName:"dealer_ico",label:"Truck dealer"},[Co.Port]:{iconName:"port_overlay",label:"Port"},[Co.Train]:{iconName:"train_ico",label:"Train"},[Co.Viewpoint]:{iconName:"viewpoint",label:"Viewpoint"},[Co.PhotoSight]:{iconName:"photo_sight_captured",label:"Photo trophy"},[Co.AgricultureCheck]:{iconName:"agri_check",label:"Agricultural inspection"},[Co.BorderCheck]:{iconName:"border_ico",label:"Border inspection"},[Co.Garage]:{iconName:"garage_large_ico",label:"Garage"},[Co.WeighStation]:{iconName:"weigh_station_ico",label:"Weigh station"},[Co.CityNames]:{iconName:"city_names_ico",label:"City names"},[Co.Company]:{iconName:"companies_ico",label:"Companies"},[Co.RoadNumber]:{iconName:"road_numbers_ico",label:"Road numbers"},[Co.Roadwork]:{iconName:"roadwork",label:"Roadwork"},[Co.RailCrossing]:{iconName:"railcrossing",label:"Rail Crossing"}},$L=new Map(Object.entries(AN).map(([t,e])=>[Number(t),e.label])),VL=new Map(Object.entries(Dee).map(([t,e])=>[Number(t),e]));function F1(t,e,n){return{selectedItems:t,onSelectAllToggle:r=>e(new Set(r?n:[])),onItemToggle:(r,o)=>{e(l=>{const c=new Set(l);return o?c.add(r):c.delete(r),c})}}}const IN=t=>{const e=H.useRef(null),[n,r]=H.useState(!1),[o,l]=H.useState(0);return kc(()=>({onAdd:()=>xr(e.current),onRemove:()=>xr(e.current).remove()}),{position:"bottom-left"}),oe.jsxs("div",{ref:e,className:"maplibregl-ctrl maplibregl-ctrl-group",children:[oe.jsx(Ah,{title:"Map Options",sx:{minWidth:0,minHeight:0,borderRadius:0},onClick:()=>r(!0),children:oe.jsx(Ene,{})}),oe.jsx(D4,{open:n,onClose:()=>r(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",justifyContent:"end"}}},children:oe.jsxs(O4,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,height:"80%",overflow:"auto"},children:[oe.jsx(P4,{children:"Map Options"}),oe.jsx(z4,{}),oe.jsx(o3,{onChange:(c,s)=>l(Number(s)),children:oe.jsxs(XZ,{tabFlex:1,sx:{borderRadius:0},children:[oe.jsx(KS,{children:"Icons"}),oe.jsx(KS,{children:"ATS DLC"}),oe.jsx(KS,{children:"Advanced"})]})}),oe.jsx(T4,{sx:{overflowX:"hidden"},children:oe.jsxs(o3,{value:o,children:[oe.jsx(JS,{sx:{p:0},value:0,children:oe.jsx(jL,{items:$L,selectedItems:t.icons.selectedItems,onItemToggle:t.icons.onItemToggle,icon:c=>oe.jsx("img",{style:{marginLeft:-3},width:32,height:32,src:`map-icons/${AN[c].iconName}.png`})})}),oe.jsx(JS,{sx:{p:0},value:1,children:oe.jsx(jL,{items:VL,selectedItems:t.atsDlcs.selectedItems,onItemToggle:t.atsDlcs.onItemToggle})}),oe.jsx(JS,{sx:{p:0},value:2,children:oe.jsx(kae,{showContours:t.advanced.showContours,onContoursToggle:t.advanced.onContoursToggle,showPhotoSpheresUi:t.advanced.showPhotoSpheresUi,onPhotoSpheresToggleUi:t.advanced.onPhotoSpheresToggleUi})})]})}),oe.jsx(Rw,{}),o===0&&oe.jsx(Rae,{enableAutoHiding:t.icons.enableAutoHiding,enableSelectAll:t.icons.selectedItems.size===$L.size,onAutoHidingToggle:t.icons.onAutoHidingToggle,onSelectAllToggle:t.icons.onSelectAllToggle}),o===1&&oe.jsx(Dae,{enableSelectAll:t.atsDlcs.selectedItems.size===VL.size,onSelectAllToggle:t.atsDlcs.onSelectAllToggle})]})})]})},Rae=H.memo(t=>oe.jsxs(Ya,{direction:"row",justifyContent:"space-between",gap:1,mx:2,children:[oe.jsx(B4,{enterDelay:500,title:"Enable to hide icons based on zoom and nearby icons. Disable to always show icons.",children:oe.jsx(Bm,{label:"Enable icon hiding",checked:t.enableAutoHiding,onChange:e=>t.onAutoHidingToggle?.(e.target.checked)})}),oe.jsx(Bm,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:t.enableSelectAll,onChange:e=>t.onSelectAllToggle?.(e.target.checked)})]})),Lae=t=>oe.jsx(Ew,{size:"lg",sx:{p:0,[`& .${zm.root}`]:{flexGrow:1,alignItems:"center",flexDirection:"row-reverse"}},children:[...t.items.entries()].map(([e,n])=>oe.jsxs(gp,{children:[t.icon?.(e),oe.jsx(Bm,{overlay:!0,label:n,checked:t.selectedItems.has(e),onChange:r=>t.onItemToggle(e,r.target.checked)})]},String(e)))}),jL=H.memo(Lae),Dae=H.memo(t=>oe.jsx(Ya,{direction:"row",justifyContent:"end",gap:1,mx:2,children:oe.jsx(Bm,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:t.enableSelectAll,onChange:e=>t.onSelectAllToggle?.(e.target.checked)})})),kae=t=>oe.jsxs(Ya,{mx:2,children:[oe.jsx(Fi,{mb:2,level:"title-lg",children:"Experimental Features"}),oe.jsxs(Ya,{gap:2,children:[oe.jsxs(b2,{children:[oe.jsx(Bm,{sx:{flexDirection:"row-reverse"},label:"Show elevation data",checked:t.showContours,onChange:e=>t.onContoursToggle(e.target.checked)}),oe.jsx(Fi,{level:"body-xs",color:"warning",children:"Note: elevation data for points further away from roads is estimated and likely inaccurate."})]}),oe.jsxs(b2,{children:[oe.jsx(Bm,{sx:{flexDirection:"row-reverse"},label:"Show Photo Spheres button",checked:t.showPhotoSpheresUi,onChange:e=>t.onPhotoSpheresToggleUi(e.target.checked)}),oe.jsxs(Fi,{level:"body-xs",color:"neutral",children:["Shows a ",oe.jsx(eN,{style:{position:"relative",top:"0.25em"}})," ","button in the upper-right of the app."]}),oe.jsx(Fi,{level:"body-xs",color:"warning",children:"Note: the positions of Photo Spheres were determined with 💩 heuristics. The landmarks they're meant to capture aren't always in view."})]})]})]}),RN=()=>{const t=H.useRef(null),{mode:e="light",setMode:n}=MP();return kc(()=>({onAdd:()=>xr(t.current),onRemove:()=>xr(t.current).remove()})),oe.jsx("div",{ref:t,className:"maplibregl-ctrl maplibregl-ctrl-group",children:oe.jsxs(J9,{children:[oe.jsx(ZX,{slots:{root:Ah},sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Set map theme",children:oe.jsx(yne,{})}),oe.jsxs(k4,{placement:"left",children:[oe.jsx(gp,{sticky:!0,children:oe.jsx(Fi,{m:1,level:"body-xs",textTransform:"uppercase",fontWeight:"lg",children:"Map theme"})}),oe.jsxs(Im,{onClick:()=>n("light"),selected:e==="light",children:[oe.jsx(Lv,{children:oe.jsx(xne,{})})," ","Light"]}),oe.jsxs(Im,{onClick:()=>n("dark"),selected:e==="dark",children:[oe.jsx(Lv,{children:oe.jsx(bne,{})})," ","Dark"]}),oe.jsxs(Im,{onClick:()=>n("system"),selected:e==="system",children:[oe.jsx(Lv,{children:oe.jsx(_ne,{})})," ","Auto"]})]})]})})};function zae(t,e,n){let r=n.get(t);return r==null&&(r=e,n.set(t,r)),r}const HL=t=>{const{map:e,selectDecorator:n,onSelect:r}=t,[o,l]=H.useState([]);H.useEffect(()=>{const m=e==="usa"?"ats":"ets2";Promise.all([fetch(`${m}-achievements.json`).then(y=>y.json()),fetch(`${m}-achievements.geojson`).then(y=>y.json())]).then(([y,b])=>{const w=new Map;for(const T of b.features)zae(T.properties.name,[],w).push({coordinates:T.geometry.coordinates,dlcGuard:T.properties.dlcGuard});const E=new Set(b.features.map(T=>T.properties.name));l([...y.data.filter(T=>E.has(T.id)).map(T=>({...T,label:T.title,value:T.id,features:xr(w.get(T.id))})).sort((T,R)=>T.label.localeCompare(R.label))])},()=>console.error("could not load achievements json."))},[e]);const c=o.filter(m=>{if(e==="europe")return!0;const y=Z_(t.visibleStateDlcs);return m.features.some(b=>y.has(b.dlcGuard))}),s=r4({stringify:m=>[m.label,m.desc].join(" ")});return oe.jsx(w1,{onChange:(m,y)=>r(y),placeholder:"Search achievements...",options:c,filterOptions:s,blurOnSelect:!0,autoComplete:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,renderOption:(m,y)=>H.createElement(x4,{...m,key:y.value},oe.jsx(Lv,{sx:{border:"2px solid var(--joy-palette-neutral-outlinedBorder)",borderRadius:6,overflow:"hidden",minWidth:"fit-content",mr:.5},children:oe.jsx("img",{loading:"lazy",width:"48",height:"48",src:y.imgUrl,alt:""})}),oe.jsxs(f_,{children:[oe.jsx(Fi,{level:"title-md",children:y.label}),oe.jsx(Fi,{level:"body-xs",children:y.desc})]}))},e)};function qd(t){return Array.isArray?Array.isArray(t):kN(t)==="[object Array]"}function Oae(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Fae(t){return t==null?"":Oae(t)}function bh(t){return typeof t=="string"}function LN(t){return typeof t=="number"}function Nae(t){return t===!0||t===!1||Bae(t)&&kN(t)=="[object Boolean]"}function DN(t){return typeof t=="object"}function Bae(t){return DN(t)&&t!==null}function Ol(t){return t!=null}function mM(t){return!t.trim().length}function kN(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Uae="Incorrect 'index' type",$ae=t=>`Invalid value for key ${t}`,Vae=t=>`Pattern length exceeds max of ${t}.`,jae=t=>`Missing ${t} property in key`,Hae=t=>`Property 'weight' in key '${t}' must be a positive integer`,GL=Object.prototype.hasOwnProperty;class Gae{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(r=>{let o=zN(r);this._keys.push(o),this._keyMap[o.id]=o,n+=o.weight}),this._keys.forEach(r=>{r.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function zN(t){let e=null,n=null,r=null,o=1,l=null;if(bh(t)||qd(t))r=t,e=WL(t),n=j2(t);else{if(!GL.call(t,"name"))throw new Error(jae("name"));const c=t.name;if(r=c,GL.call(t,"weight")&&(o=t.weight,o<=0))throw new Error(Hae(c));e=WL(c),n=j2(c),l=t.getFn}return{path:e,id:n,weight:o,src:r,getFn:l}}function WL(t){return qd(t)?t:t.split(".")}function j2(t){return qd(t)?t.join("."):t}function Wae(t,e){let n=[],r=!1;const o=(l,c,s)=>{if(Ol(l))if(!c[s])n.push(l);else{let m=c[s];const y=l[m];if(!Ol(y))return;if(s===c.length-1&&(bh(y)||LN(y)||Nae(y)))n.push(Fae(y));else if(qd(y)){r=!0;for(let b=0,w=y.length;b<w;b+=1)o(y[b],c,s+1)}else c.length&&o(y,c,s+1)}};return o(t,bh(e)?e.split("."):e,0),r?n:n[0]}const qae={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Xae={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},Zae={location:0,threshold:.6,distance:100},Yae={useExtendedSearch:!1,getFn:Wae,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Mr={...Xae,...qae,...Zae,...Yae};const Kae=/[^ ]+/g;function Jae(t=1,e=3){const n=new Map,r=Math.pow(10,e);return{get(o){const l=o.match(Kae).length;if(n.has(l))return n.get(l);const c=1/Math.pow(l,.5*t),s=parseFloat(Math.round(c*r)/r);return n.set(l,s),s},clear(){n.clear()}}}class _A{constructor({getFn:e=Mr.getFn,fieldNormWeight:n=Mr.fieldNormWeight}={}){this.norm=Jae(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,bh(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){const n=this.size();bh(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!Ol(e)||mM(e))return;let r={v:e,i:n,n:this.norm.get(e)};this.records.push(r)}_addObject(e,n){let r={i:n,$:{}};this.keys.forEach((o,l)=>{let c=o.getFn?o.getFn(e):this.getFn(e,o.path);if(Ol(c)){if(qd(c)){let s=[];const m=[{nestedArrIndex:-1,value:c}];for(;m.length;){const{nestedArrIndex:y,value:b}=m.pop();if(Ol(b))if(bh(b)&&!mM(b)){let w={v:b,i:y,n:this.norm.get(b)};s.push(w)}else qd(b)&&b.forEach((w,E)=>{m.push({nestedArrIndex:E,value:w})})}r.$[l]=s}else if(bh(c)&&!mM(c)){let s={v:c,n:this.norm.get(c)};r.$[l]=s}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function ON(t,e,{getFn:n=Mr.getFn,fieldNormWeight:r=Mr.fieldNormWeight}={}){const o=new _A({getFn:n,fieldNormWeight:r});return o.setKeys(t.map(zN)),o.setSources(e),o.create(),o}function Qae(t,{getFn:e=Mr.getFn,fieldNormWeight:n=Mr.fieldNormWeight}={}){const{keys:r,records:o}=t,l=new _A({getFn:e,fieldNormWeight:n});return l.setKeys(r),l.setIndexRecords(o),l}function lb(t,{errors:e=0,currentLocation:n=0,expectedLocation:r=0,distance:o=Mr.distance,ignoreLocation:l=Mr.ignoreLocation}={}){const c=e/t.length;if(l)return c;const s=Math.abs(r-n);return o?c+s/o:s?1:c}function ele(t=[],e=Mr.minMatchCharLength){let n=[],r=-1,o=-1,l=0;for(let c=t.length;l<c;l+=1){let s=t[l];s&&r===-1?r=l:!s&&r!==-1&&(o=l-1,o-r+1>=e&&n.push([r,o]),r=-1)}return t[l-1]&&l-r>=e&&n.push([r,l-1]),n}const Tm=32;function tle(t,e,n,{location:r=Mr.location,distance:o=Mr.distance,threshold:l=Mr.threshold,findAllMatches:c=Mr.findAllMatches,minMatchCharLength:s=Mr.minMatchCharLength,includeMatches:m=Mr.includeMatches,ignoreLocation:y=Mr.ignoreLocation}={}){if(e.length>Tm)throw new Error(Vae(Tm));const b=e.length,w=t.length,E=Math.max(0,Math.min(r,w));let T=l,R=E;const z=s>1||m,I=z?Array(w):[];let L;for(;(L=t.indexOf(e,R))>-1;){let te=lb(e,{currentLocation:L,expectedLocation:E,distance:o,ignoreLocation:y});if(T=Math.min(te,T),R=L+b,z){let se=0;for(;se<b;)I[L+se]=1,se+=1}}R=-1;let V=[],B=1,W=b+w;const X=1<<b-1;for(let te=0;te<b;te+=1){let se=0,re=W;for(;se<re;)lb(e,{errors:te,currentLocation:E+re,expectedLocation:E,distance:o,ignoreLocation:y})<=T?se=re:W=re,re=Math.floor((W-se)/2+se);W=re;let $=Math.max(1,E-re+1),ce=c?w:Math.min(E+re,w)+b,Ce=Array(ce+2);Ce[ce+1]=(1<<te)-1;for(let Xe=ce;Xe>=$;Xe-=1){let Fe=Xe-1,Me=n[t.charAt(Fe)];if(z&&(I[Fe]=+!!Me),Ce[Xe]=(Ce[Xe+1]<<1|1)&Me,te&&(Ce[Xe]|=(V[Xe+1]|V[Xe])<<1|1|V[Xe+1]),Ce[Xe]&X&&(B=lb(e,{errors:te,currentLocation:Fe,expectedLocation:E,distance:o,ignoreLocation:y}),B<=T)){if(T=B,R=Fe,R<=E)break;$=Math.max(1,2*E-R)}}if(lb(e,{errors:te+1,currentLocation:E,expectedLocation:E,distance:o,ignoreLocation:y})>T)break;V=Ce}const q={isMatch:R>=0,score:Math.max(.001,B)};if(z){const te=ele(I,s);te.length?m&&(q.indices=te):q.isMatch=!1}return q}function nle(t){let e={};for(let n=0,r=t.length;n<r;n+=1){const o=t.charAt(n);e[o]=(e[o]||0)|1<<r-n-1}return e}const N1=String.prototype.normalize?t=>t.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):t=>t;class FN{constructor(e,{location:n=Mr.location,threshold:r=Mr.threshold,distance:o=Mr.distance,includeMatches:l=Mr.includeMatches,findAllMatches:c=Mr.findAllMatches,minMatchCharLength:s=Mr.minMatchCharLength,isCaseSensitive:m=Mr.isCaseSensitive,ignoreDiacritics:y=Mr.ignoreDiacritics,ignoreLocation:b=Mr.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:o,includeMatches:l,findAllMatches:c,minMatchCharLength:s,isCaseSensitive:m,ignoreDiacritics:y,ignoreLocation:b},e=m?e:e.toLowerCase(),e=y?N1(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const w=(T,R)=>{this.chunks.push({pattern:T,alphabet:nle(T),startIndex:R})},E=this.pattern.length;if(E>Tm){let T=0;const R=E%Tm,z=E-R;for(;T<z;)w(this.pattern.substr(T,Tm),T),T+=Tm;if(R){const I=E-Tm;w(this.pattern.substr(I),I)}}else w(this.pattern,0)}searchIn(e){const{isCaseSensitive:n,ignoreDiacritics:r,includeMatches:o}=this.options;if(e=n?e:e.toLowerCase(),e=r?N1(e):e,this.pattern===e){let z={isMatch:!0,score:0};return o&&(z.indices=[[0,e.length-1]]),z}const{location:l,distance:c,threshold:s,findAllMatches:m,minMatchCharLength:y,ignoreLocation:b}=this.options;let w=[],E=0,T=!1;this.chunks.forEach(({pattern:z,alphabet:I,startIndex:L})=>{const{isMatch:V,score:B,indices:W}=tle(e,z,I,{location:l+L,distance:c,threshold:s,findAllMatches:m,minMatchCharLength:y,includeMatches:o,ignoreLocation:b});V&&(T=!0),E+=B,V&&W&&(w=[...w,...W])});let R={isMatch:T,score:T?E/this.chunks.length:1};return T&&o&&(R.indices=w),R}}class xp{constructor(e){this.pattern=e}static isMultiMatch(e){return qL(e,this.multiRegex)}static isSingleMatch(e){return qL(e,this.singleRegex)}search(){}}function qL(t,e){const n=t.match(e);return n?n[1]:null}class rle extends xp{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const n=e===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class ile extends xp{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const r=e.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class ole extends xp{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const n=e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class sle extends xp{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const n=!e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class ale extends xp{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const n=e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class lle extends xp{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const n=!e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class NN extends xp{constructor(e,{location:n=Mr.location,threshold:r=Mr.threshold,distance:o=Mr.distance,includeMatches:l=Mr.includeMatches,findAllMatches:c=Mr.findAllMatches,minMatchCharLength:s=Mr.minMatchCharLength,isCaseSensitive:m=Mr.isCaseSensitive,ignoreDiacritics:y=Mr.ignoreDiacritics,ignoreLocation:b=Mr.ignoreLocation}={}){super(e),this._bitapSearch=new FN(e,{location:n,threshold:r,distance:o,includeMatches:l,findAllMatches:c,minMatchCharLength:s,isCaseSensitive:m,ignoreDiacritics:y,ignoreLocation:b})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class BN extends xp{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n=0,r;const o=[],l=this.pattern.length;for(;(r=e.indexOf(this.pattern,n))>-1;)n=r+l,o.push([r,n-1]);const c=!!o.length;return{isMatch:c,score:c?0:1,indices:o}}}const H2=[rle,BN,ole,sle,lle,ale,ile,NN],XL=H2.length,cle=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,ule="|";function hle(t,e={}){return t.split(ule).map(n=>{let r=n.trim().split(cle).filter(l=>l&&!!l.trim()),o=[];for(let l=0,c=r.length;l<c;l+=1){const s=r[l];let m=!1,y=-1;for(;!m&&++y<XL;){const b=H2[y];let w=b.isMultiMatch(s);w&&(o.push(new b(w,e)),m=!0)}if(!m)for(y=-1;++y<XL;){const b=H2[y];let w=b.isSingleMatch(s);if(w){o.push(new b(w,e));break}}}return o})}const dle=new Set([NN.type,BN.type]);class fle{constructor(e,{isCaseSensitive:n=Mr.isCaseSensitive,ignoreDiacritics:r=Mr.ignoreDiacritics,includeMatches:o=Mr.includeMatches,minMatchCharLength:l=Mr.minMatchCharLength,ignoreLocation:c=Mr.ignoreLocation,findAllMatches:s=Mr.findAllMatches,location:m=Mr.location,threshold:y=Mr.threshold,distance:b=Mr.distance}={}){this.query=null,this.options={isCaseSensitive:n,ignoreDiacritics:r,includeMatches:o,minMatchCharLength:l,findAllMatches:s,ignoreLocation:c,location:m,threshold:y,distance:b},e=n?e:e.toLowerCase(),e=r?N1(e):e,this.pattern=e,this.query=hle(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:o,ignoreDiacritics:l}=this.options;e=o?e:e.toLowerCase(),e=l?N1(e):e;let c=0,s=[],m=0;for(let y=0,b=n.length;y<b;y+=1){const w=n[y];s.length=0,c=0;for(let E=0,T=w.length;E<T;E+=1){const R=w[E],{isMatch:z,indices:I,score:L}=R.search(e);if(z){if(c+=1,m+=L,r){const V=R.constructor.type;dle.has(V)?s=[...s,...I]:s.push(I)}}else{m=0,c=0,s.length=0;break}}if(c){let E={isMatch:!0,score:m/c};return r&&(E.indices=s),E}}return{isMatch:!1,score:1}}}const G2=[];function ple(...t){G2.push(...t)}function W2(t,e){for(let n=0,r=G2.length;n<r;n+=1){let o=G2[n];if(o.condition(t,e))return new o(t,e)}return new FN(t,e)}const B1={AND:"$and",OR:"$or"},q2={PATH:"$path",PATTERN:"$val"},X2=t=>!!(t[B1.AND]||t[B1.OR]),mle=t=>!!t[q2.PATH],gle=t=>!qd(t)&&DN(t)&&!X2(t),ZL=t=>({[B1.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function UN(t,e,{auto:n=!0}={}){const r=o=>{let l=Object.keys(o);const c=mle(o);if(!c&&l.length>1&&!X2(o))return r(ZL(o));if(gle(o)){const m=c?o[q2.PATH]:l[0],y=c?o[q2.PATTERN]:o[m];if(!bh(y))throw new Error($ae(m));const b={keyId:j2(m),pattern:y};return n&&(b.searcher=W2(y,e)),b}let s={children:[],operator:l[0]};return l.forEach(m=>{const y=o[m];qd(y)&&y.forEach(b=>{s.children.push(r(b))})}),s};return X2(t)||(t=ZL(t)),r(t)}function vle(t,{ignoreFieldNorm:e=Mr.ignoreFieldNorm}){t.forEach(n=>{let r=1;n.matches.forEach(({key:o,norm:l,score:c})=>{const s=o?o.weight:null;r*=Math.pow(c===0&&s?Number.EPSILON:c,(s||1)*(e?1:l))}),n.score=r})}function yle(t,e){const n=t.matches;e.matches=[],Ol(n)&&n.forEach(r=>{if(!Ol(r.indices)||!r.indices.length)return;const{indices:o,value:l}=r;let c={indices:o,value:l};r.key&&(c.key=r.key.src),r.idx>-1&&(c.refIndex=r.idx),e.matches.push(c)})}function _le(t,e){e.score=t.score}function xle(t,e,{includeMatches:n=Mr.includeMatches,includeScore:r=Mr.includeScore}={}){const o=[];return n&&o.push(yle),r&&o.push(_le),t.map(l=>{const{idx:c}=l,s={item:e[c],refIndex:c};return o.length&&o.forEach(m=>{m(l,s)}),s})}class uy{constructor(e,n={},r){this.options={...Mr,...n},this.options.useExtendedSearch,this._keyStore=new Gae(this.options.keys),this.setCollection(e,r)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof _A))throw new Error(Uae);this._myIndex=n||ON(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Ol(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const n=[];for(let r=0,o=this._docs.length;r<o;r+=1){const l=this._docs[r];e(l,r)&&(this.removeAt(r),r-=1,o-=1,n.push(l))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){const{includeMatches:r,includeScore:o,shouldSort:l,sortFn:c,ignoreFieldNorm:s}=this.options;let m=bh(e)?bh(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return vle(m,{ignoreFieldNorm:s}),l&&m.sort(c),LN(n)&&n>-1&&(m=m.slice(0,n)),xle(m,this._docs,{includeMatches:r,includeScore:o})}_searchStringList(e){const n=W2(e,this.options),{records:r}=this._myIndex,o=[];return r.forEach(({v:l,i:c,n:s})=>{if(!Ol(l))return;const{isMatch:m,score:y,indices:b}=n.searchIn(l);m&&o.push({item:l,idx:c,matches:[{score:y,value:l,norm:s,indices:b}]})}),o}_searchLogical(e){const n=UN(e,this.options),r=(s,m,y)=>{if(!s.children){const{keyId:w,searcher:E}=s,T=this._findMatches({key:this._keyStore.get(w),value:this._myIndex.getValueForItemAtKeyId(m,w),searcher:E});return T&&T.length?[{idx:y,item:m,matches:T}]:[]}const b=[];for(let w=0,E=s.children.length;w<E;w+=1){const T=s.children[w],R=r(T,m,y);if(R.length)b.push(...R);else if(s.operator===B1.AND)return[]}return b},o=this._myIndex.records,l={},c=[];return o.forEach(({$:s,i:m})=>{if(Ol(s)){let y=r(n,s,m);y.length&&(l[m]||(l[m]={idx:m,item:s,matches:[]},c.push(l[m])),y.forEach(({matches:b})=>{l[m].matches.push(...b)}))}}),c}_searchObjectList(e){const n=W2(e,this.options),{keys:r,records:o}=this._myIndex,l=[];return o.forEach(({$:c,i:s})=>{if(!Ol(c))return;let m=[];r.forEach((y,b)=>{m.push(...this._findMatches({key:y,value:c[b],searcher:n}))}),m.length&&l.push({idx:s,item:c,matches:m})}),l}_findMatches({key:e,value:n,searcher:r}){if(!Ol(n))return[];let o=[];if(qd(n))n.forEach(({v:l,i:c,n:s})=>{if(!Ol(l))return;const{isMatch:m,score:y,indices:b}=r.searchIn(l);m&&o.push({score:y,key:e,value:l,idx:c,norm:s,indices:b})});else{const{v:l,n:c}=n,{isMatch:s,score:m,indices:y}=r.searchIn(l);s&&o.push({score:m,key:e,value:l,norm:c,indices:y})}return o}}uy.version="7.1.0";uy.createIndex=ON;uy.parseIndex=Qae;uy.config=Mr;uy.parseQuery=UN;ple(fle);const YL=100,ble=t=>t.match(/("[^"]*?"|[^"\s]+)+(?=\s*|\s*$)/g)??[],KL=t=>{const{map:e,selectDecorator:n,onSelect:r}=t,[o,l]=H.useState({}),[c,s]=H.useState(null),[m,y]=H.useState([]),[b,w]=H.useState(null),[E,T]=H.useState(0),R=I=>setTimeout(()=>T(I),0);H.useEffect(()=>{fetch("sprites@2x.json").then(I=>I.json()).then(I=>l(I),I=>console.error("could not load sprites json",I))},[]),H.useEffect(()=>{fetch(`${e==="usa"?"ats":"ets2"}-search.geojson`).then(L=>L.json()).then(L=>{let V;if(e==="usa"){const X=Z_(t.visibleStateDlcs);V=q=>X.has(q.properties.dlcGuard)}else V=()=>!0;const B=L.features.filter(V),W=new uy(B,{distance:0,threshold:.2,findAllMatches:!0,ignoreLocation:!0,sortFn:Ele,keys:[{name:"properties.label",weight:3},{name:"properties.city.name",weight:2},{name:"properties.stateName",weight:1.5},"properties.stateCode","properties.tags"]});s(W),y(B.map((X,q)=>({type:"poi",id:q.toString(),label:X.properties.label,poi:X})))},L=>console.error("could not load search json.",L))},[e,e==="usa"?t.visibleStateDlcs:null]);const z=(I,{inputValue:L})=>{if(Kv.checkState(c!=null),L.length<3)if(b!=null)typeof b=="string"?L=b:L=b.label;else return R(0),[];const V=ble(L);if(!V.length)return console.warn("empty tokens for search input:",L),R(0),[];const B=c.search({$and:V.map(W=>({$or:[{"properties.label":W},{"properties.city.name":W},{"properties.stateName":W},{"properties.stateCode":W},{"properties.tags":W}]}))});return R(B.length),B.slice(0,YL).map(W=>I[W.refIndex])};return oe.jsx(w1,{onChange:(I,L)=>{if(L==null)w(null),r(null);else if(typeof L=="string")w(L);else if(L&&L.type==="poi")T(1),w(L),r(L);else if(L)throw new Error("suggestions not yet supported")},onInputChange:(I,L,V)=>{V!=="reset"&&w(null)},placeholder:"Search cities, companies, points of interest...",options:m,filterOptions:z,getOptionLabel:Mle,blurOnSelect:!0,handleHomeEndKeys:!0,freeSolo:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,endDecorator:oe.jsx(wle,{maxResults:YL,numSearchResults:E}),renderOption:(I,L)=>H.createElement(x4,{...I,key:L.id},oe.jsx(Sle,{option:L,sprites:o}))},e)},wle=({numSearchResults:t,maxResults:e})=>t>e?oe.jsx(B4,{title:`Showing first ${e} of ${t} results, only. Try adding more terms to narrow your search.`,children:oe.jsx(Sne,{color:"warning",sx:{width:"0.8em"}})}):null,Sle=H.memo(({option:t,sprites:e})=>oe.jsxs(oe.Fragment,{children:[oe.jsx(Lv,{sx:{display:"flex",justifyContent:"center",mx:0},children:oe.jsx(JL,{option:t,sprites:e})}),oe.jsx(Cle,{option:t}),oe.jsx(Lv,{children:t.type==="poi"&&t.poi.properties.type==="company"?oe.jsx(JL,{option:t,sprites:e,position:"end"}):null})]})),JL=({option:t,sprites:e,position:n})=>{if(t.type==="suggestion")return null;if(t.poi.properties.type==="city")return oe.jsx(Tne,{});if(t.poi.properties.type==="scenery")return oe.jsx(Mne,{});let r;switch(t.poi.properties.type){case"company":if(!n)return oe.jsx(Pne,{});r=t.poi.properties.sprite;break;case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":r=t.poi.properties.sprite;break;default:throw new Su(t.poi.properties.type)}const o=xr(e[r]);return oe.jsx(b4,{sx:{width:o.width+"px",height:o.height+"px",background:`url(sprites.png) -${o.x}px -${o.y}px`,transform:"scale(0.70)"}})};function Mle(t){if(typeof t=="string")return t;if(t.type==="suggestion")return"suggestion";const e=t.poi.properties;switch(e.type){case"city":case"scenery":return`${t.label}, ${e.stateCode}`;case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":{const n=$N(e.label,e.city);switch(n){case 0:return`${t.label} in ${e.city.name}, ${e.stateCode}`;case 1:return`${t.label} near ${e.city.name}, ${e.stateCode}`;case 2:return`${t.label} in ${e.stateName}`;default:throw new Su(n)}}default:throw new Su(e)}}const Cle=({option:t})=>{if(t.type==="suggestion")return"suggestion";const e=t.poi.properties;switch(e.type){case"city":case"scenery":return oe.jsxs(f_,{children:[t.label,", ",e.stateCode]});case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":{let n;const r=$N(e.label,e.city);switch(r){case 0:n=`${e.city.name}, ${e.stateCode}`;break;case 1:n=`near ${e.city.name}, ${e.stateCode}`;break;case 2:n=`${e.stateName}`;break;default:throw new Su(r)}return oe.jsxs(f_,{children:[oe.jsx(Fi,{children:t.label}),oe.jsx(Fi,{level:"body-sm",children:n})]})}default:throw new Su(e)}};function $N(t,e){return e.distance<=250||t.startsWith(e.name)||t.endsWith(e.name)?0:e.distance<=1e3?1:2}const QL={company:0,city:1,scenery:1,landmark:2,viewpoint:3,dealer:4,ferry:5,train:6};function Ele(t,e){if(t.score!==e.score)return t.score-e.score;const n=t.item[1],r=e.item[1];if(n&&r)return n.v.localeCompare(r.v);if(n&&!r)return 1;if(!n&&r)return-1;const o=t.item[4],l=e.item[4];if(!Array.isArray(o)||!Array.isArray(l))throw new Error("unexpected non-arrays at key 5");const c=xr(o.find(b=>b.i===0)).v,s=xr(l.find(b=>b.i===0)).v;if(c!==s)return QL[c]-QL[s];const m=t.item[0],y=e.item[0];return m.v.localeCompare(y.v)}var gM,eD;function VN(){if(eD)return gM;eD=1;var t=Object.prototype.toString;return gM=function(n){var r=t.call(n),o=r==="[object Arguments]";return o||(o=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),o},gM}var vM,tD;function Tle(){if(tD)return vM;tD=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=VN(),o=Object.prototype.propertyIsEnumerable,l=!o.call({toString:null},"toString"),c=o.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],m=function(E){var T=E.constructor;return T&&T.prototype===E},y={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},b=function(){if(typeof window>"u")return!1;for(var E in window)try{if(!y["$"+E]&&e.call(window,E)&&window[E]!==null&&typeof window[E]=="object")try{m(window[E])}catch{return!0}}catch{return!0}return!1}(),w=function(E){if(typeof window>"u"||!b)return m(E);try{return m(E)}catch{return!1}};t=function(T){var R=T!==null&&typeof T=="object",z=n.call(T)==="[object Function]",I=r(T),L=R&&n.call(T)==="[object String]",V=[];if(!R&&!z&&!I)throw new TypeError("Object.keys called on a non-object");var B=c&&z;if(L&&T.length>0&&!e.call(T,0))for(var W=0;W<T.length;++W)V.push(String(W));if(I&&T.length>0)for(var X=0;X<T.length;++X)V.push(String(X));else for(var q in T)!(B&&q==="prototype")&&e.call(T,q)&&V.push(String(q));if(l)for(var te=w(T),se=0;se<s.length;++se)!(te&&s[se]==="constructor")&&e.call(T,s[se])&&V.push(s[se]);return V}}return vM=t,vM}var yM,nD;function Ple(){if(nD)return yM;nD=1;var t=Array.prototype.slice,e=VN(),n=Object.keys,r=n?function(c){return n(c)}:Tle(),o=Object.keys;return r.shim=function(){if(Object.keys){var c=function(){var s=Object.keys(arguments);return s&&s.length===arguments.length}(1,2);c||(Object.keys=function(m){return e(m)?o(t.call(m)):o(m)})}else Object.keys=r;return Object.keys||r},yM=r,yM}var _M,rD;function rx(){if(rD)return _M;rD=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return _M=t,_M}var xM,iD;function bp(){return iD||(iD=1,xM=SyntaxError),xM}var bM,oD;function Rr(){return oD||(oD=1,bM=TypeError),bM}var wM,sD;function Ale(){return sD||(sD=1,wM=Object.getOwnPropertyDescriptor),wM}var SM,aD;function hy(){if(aD)return SM;aD=1;var t=Ale();if(t)try{t([],"length")}catch{t=null}return SM=t,SM}var MM,lD;function jN(){if(lD)return MM;lD=1;var t=rx(),e=bp(),n=Rr(),r=hy();return MM=function(l,c,s){if(!l||typeof l!="object"&&typeof l!="function")throw new n("`obj` must be an object or a function`");if(typeof c!="string"&&typeof c!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var m=arguments.length>3?arguments[3]:null,y=arguments.length>4?arguments[4]:null,b=arguments.length>5?arguments[5]:null,w=arguments.length>6?arguments[6]:!1,E=!!r&&r(l,c);if(t)t(l,c,{configurable:b===null&&E?E.configurable:!b,enumerable:m===null&&E?E.enumerable:!m,value:s,writable:y===null&&E?E.writable:!y});else if(w||!m&&!y&&!b)l[c]=s;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},MM}var CM,cD;function xA(){if(cD)return CM;cD=1;var t=rx(),e=function(){return!!t};return e.hasArrayLengthDefineBug=function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},CM=e,CM}var EM,uD;function HN(){if(uD)return EM;uD=1;var t=Ple(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,o=jN(),l=function(y){return typeof y=="function"&&n.call(y)==="[object Function]"},c=xA()(),s=function(y,b,w,E){if(b in y){if(E===!0){if(y[b]===w)return}else if(!l(E)||!E())return}c?o(y,b,w,!0):o(y,b,w)},m=function(y,b){var w=arguments.length>2?arguments[2]:{},E=t(b);e&&(E=r.call(E,Object.getOwnPropertySymbols(b)));for(var T=0;T<E.length;T+=1)s(y,E[T],b[E[T]],w[E[T]])};return m.supportsDescriptors=!!c,EM=m,EM}var TM={exports:{}},PM,hD;function Ile(){return hD||(hD=1,PM=Object),PM}var AM,dD;function Rle(){return dD||(dD=1,AM=Error),AM}var IM,fD;function Lle(){return fD||(fD=1,IM=EvalError),IM}var RM,pD;function Dle(){return pD||(pD=1,RM=RangeError),RM}var LM,mD;function kle(){return mD||(mD=1,LM=ReferenceError),LM}var DM,gD;function zle(){return gD||(gD=1,DM=URIError),DM}var kM,vD;function GN(){return vD||(vD=1,kM=Math.abs),kM}var zM,yD;function WN(){return yD||(yD=1,zM=Math.floor),zM}var OM,_D;function Ole(){return _D||(_D=1,OM=Math.max),OM}var FM,xD;function Fle(){return xD||(xD=1,FM=Math.min),FM}var NM,bD;function Nle(){return bD||(bD=1,NM=Math.pow),NM}var BM,wD;function qN(){return wD||(wD=1,BM=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var o=42;e[n]=o;for(var l in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var c=Object.getOwnPropertySymbols(e);if(c.length!==1||c[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,n);if(s.value!==o||s.enumerable!==!0)return!1}return!0}),BM}var UM,SD;function Xw(){if(SD)return UM;SD=1;var t=typeof Symbol<"u"&&Symbol,e=qN();return UM=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},UM}var $M,MD;function Ble(){if(MD)return $M;MD=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,n=Math.max,r="[object Function]",o=function(m,y){for(var b=[],w=0;w<m.length;w+=1)b[w]=m[w];for(var E=0;E<y.length;E+=1)b[E+m.length]=y[E];return b},l=function(m,y){for(var b=[],w=y,E=0;w<m.length;w+=1,E+=1)b[E]=m[w];return b},c=function(s,m){for(var y="",b=0;b<s.length;b+=1)y+=s[b],b+1<s.length&&(y+=m);return y};return $M=function(m){var y=this;if(typeof y!="function"||e.apply(y)!==r)throw new TypeError(t+y);for(var b=l(arguments,1),w,E=function(){if(this instanceof w){var L=y.apply(this,o(b,arguments));return Object(L)===L?L:this}return y.apply(m,o(b,arguments))},T=n(0,y.length-b.length),R=[],z=0;z<T;z++)R[z]="$"+z;if(w=Function("binder","return function ("+c(R,",")+"){ return binder.apply(this,arguments); }")(E),y.prototype){var I=function(){};I.prototype=y.prototype,w.prototype=new I,I.prototype=null}return w},$M}var VM,CD;function ix(){if(CD)return VM;CD=1;var t=Ble();return VM=Function.prototype.bind||t,VM}var jM,ED;function bA(){return ED||(ED=1,jM=Function.prototype.call),jM}var HM,TD;function wA(){return TD||(TD=1,HM=Function.prototype.apply),HM}var GM,PD;function Ule(){return PD||(PD=1,GM=typeof Reflect<"u"&&Reflect&&Reflect.apply),GM}var WM,AD;function XN(){if(AD)return WM;AD=1;var t=ix(),e=wA(),n=bA(),r=Ule();return WM=r||t.call(n,e),WM}var qM,ID;function SA(){if(ID)return qM;ID=1;var t=ix(),e=Rr(),n=bA(),r=XN();return qM=function(l){if(l.length<1||typeof l[0]!="function")throw new e("a function is required");return r(t,n,l)},qM}var XM,RD;function $le(){if(RD)return XM;RD=1;var t=SA(),e=hy(),n;try{n=[].__proto__===Array.prototype}catch(c){if(!c||typeof c!="object"||!("code"in c)||c.code!=="ERR_PROTO_ACCESS")throw c}var r=!!n&&e&&e(Object.prototype,"__proto__"),o=Object,l=o.getPrototypeOf;return XM=r&&typeof r.get=="function"?t([r.get]):typeof l=="function"?function(s){return l(s==null?s:o(s))}:!1,XM}var ZM,LD;function ef(){if(LD)return ZM;LD=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,n=ix();return ZM=n.call(t,e),ZM}var YM,DD;function ca(){if(DD)return YM;DD=1;var t,e=Ile(),n=Rle(),r=Lle(),o=Dle(),l=kle(),c=bp(),s=Rr(),m=zle(),y=GN(),b=WN(),w=Ole(),E=Fle(),T=Nle(),R=Function,z=function(At){try{return R('"use strict"; return ('+At+").constructor;")()}catch{}},I=hy(),L=rx(),V=function(){throw new s},B=I?function(){try{return arguments.callee,V}catch{try{return I(arguments,"callee").get}catch{return V}}}():V,W=Xw()(),X=$le(),q=typeof Reflect=="function"&&Reflect.getPrototypeOf||e.getPrototypeOf||X,te=wA(),se=bA(),re={},$=typeof Uint8Array>"u"||!q?t:q(Uint8Array),ce={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":W&&q?q([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":re,"%AsyncGenerator%":re,"%AsyncGeneratorFunction%":re,"%AsyncIteratorPrototype%":re,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":r,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":R,"%GeneratorFunction%":re,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":W&&q?q(q([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!W||!q?t:q(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":I,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":o,"%ReferenceError%":l,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!W||!q?t:q(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":W&&q?q(""[Symbol.iterator]()):t,"%Symbol%":W?Symbol:t,"%SyntaxError%":c,"%ThrowTypeError%":B,"%TypedArray%":$,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":m,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet,"%Function.prototype.call%":se,"%Function.prototype.apply%":te,"%Object.defineProperty%":L,"%Math.abs%":y,"%Math.floor%":b,"%Math.max%":w,"%Math.min%":E,"%Math.pow%":T};if(q)try{null.error}catch(At){var Ce=q(q(At));ce["%Error.prototype%"]=Ce}var Se=function At(ht){var lt;if(ht==="%AsyncFunction%")lt=z("async function () {}");else if(ht==="%GeneratorFunction%")lt=z("function* () {}");else if(ht==="%AsyncGeneratorFunction%")lt=z("async function* () {}");else if(ht==="%AsyncGenerator%"){var bt=At("%AsyncGeneratorFunction%");bt&&(lt=bt.prototype)}else if(ht==="%AsyncIteratorPrototype%"){var St=At("%AsyncGenerator%");St&&q&&(lt=q(St.prototype))}return ce[ht]=lt,lt},Xe={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Fe=ix(),Me=ef(),Te=Fe.call(se,Array.prototype.concat),Ie=Fe.call(te,Array.prototype.splice),Ke=Fe.call(se,String.prototype.replace),st=Fe.call(se,String.prototype.slice),Ee=Fe.call(se,RegExp.prototype.exec),Qe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,jt=/\\(\\)?/g,je=function(ht){var lt=st(ht,0,1),bt=st(ht,-1);if(lt==="%"&&bt!=="%")throw new c("invalid intrinsic syntax, expected closing `%`");if(bt==="%"&&lt!=="%")throw new c("invalid intrinsic syntax, expected opening `%`");var St=[];return Ke(ht,Qe,function(dn,En,un,et){St[St.length]=un?Ke(et,jt,"$1"):En||dn}),St},ft=function(ht,lt){var bt=ht,St;if(Me(Xe,bt)&&(St=Xe[bt],bt="%"+St[0]+"%"),Me(ce,bt)){var dn=ce[bt];if(dn===re&&(dn=Se(bt)),typeof dn>"u"&&!lt)throw new s("intrinsic "+ht+" exists, but is not available. Please file an issue!");return{alias:St,name:bt,value:dn}}throw new c("intrinsic "+ht+" does not exist!")};return YM=function(ht,lt){if(typeof ht!="string"||ht.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof lt!="boolean")throw new s('"allowMissing" argument must be a boolean');if(Ee(/^%?[^%]*%?$/,ht)===null)throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var bt=je(ht),St=bt.length>0?bt[0]:"",dn=ft("%"+St+"%",lt),En=dn.name,un=dn.value,et=!1,Ln=dn.alias;Ln&&(St=Ln[0],Ie(bt,Te([0,1],Ln)));for(var Jt=1,fn=!0;Jt<bt.length;Jt+=1){var $t=bt[Jt],Nn=st($t,0,1),vn=st($t,-1);if((Nn==='"'||Nn==="'"||Nn==="`"||vn==='"'||vn==="'"||vn==="`")&&Nn!==vn)throw new c("property names with quotes must have matching quotes");if(($t==="constructor"||!fn)&&(et=!0),St+="."+$t,En="%"+St+"%",Me(ce,En))un=ce[En];else if(un!=null){if(!($t in un)){if(!lt)throw new s("base intrinsic for "+ht+" exists, but the property is not available.");return}if(I&&Jt+1>=bt.length){var Ue=I(un,$t);fn=!!Ue,fn&&"get"in Ue&&!("originalValue"in Ue.get)?un=Ue.get:un=un[$t]}else fn=Me(un,$t),un=un[$t];fn&&!et&&(ce[En]=un)}}return un},YM}var KM,kD;function Vle(){if(kD)return KM;kD=1;var t=ca(),e=jN(),n=xA()(),r=hy(),o=Rr(),l=t("%Math.floor%");return KM=function(s,m){if(typeof s!="function")throw new o("`fn` is not a function");if(typeof m!="number"||m<0||m>4294967295||l(m)!==m)throw new o("`length` must be a positive 32-bit integer");var y=arguments.length>2&&!!arguments[2],b=!0,w=!0;if("length"in s&&r){var E=r(s,"length");E&&!E.configurable&&(b=!1),E&&!E.writable&&(w=!1)}return(b||w||!y)&&(n?e(s,"length",m,!0,!0):e(s,"length",m)),s},KM}var JM,zD;function jle(){if(zD)return JM;zD=1;var t=ix(),e=wA(),n=XN();return JM=function(){return n(t,e,arguments)},JM}var OD;function ZN(){return OD||(OD=1,function(t){var e=Vle(),n=rx(),r=SA(),o=jle();t.exports=function(c){var s=r(arguments),m=c.length-(arguments.length-1);return e(s,1+(m>0?m:0),!0)},n?n(t.exports,"apply",{value:o}):t.exports.apply=o}(TM)),TM.exports}var QM,FD;function Km(){return FD||(FD=1,QM=function(e){return typeof e=="string"||typeof e=="symbol"}),QM}var eC,ND;function Jm(){if(ND)return eC;ND=1;var t=Rr(),e=ef(),n={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return eC=function(o){if(!o||typeof o!="object")return!1;for(var l in o)if(e(o,l)&&!n[l])return!1;var c=e(o,"[[Value]]")||e(o,"[[Writable]]"),s=e(o,"[[Get]]")||e(o,"[[Set]]");if(c&&s)throw new t("Property Descriptors may not be both accessor and data descriptors");return!0},eC}var tC,BD;function MA(){if(BD)return tC;BD=1;var t=Rr(),e=ef(),n=Jm();return tC=function(o){if(typeof o>"u")return!1;if(!n(o))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!(!e(o,"[[Get]]")&&!e(o,"[[Set]]"))},tC}var nC,UD;function Hle(){return UD||(UD=1,nC=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),nC}var rC,$D;function Gle(){if($D)return rC;$D=1;var t=ca(),e=t("%Object.preventExtensions%",!0),n=t("%Object.isExtensible%",!0),r=Hle();return rC=e?function(l){return!r(l)&&n(l)}:function(l){return!r(l)},rC}var iC,VD;function YN(){if(VD)return iC;VD=1;var t=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,n,r;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{n=Object.defineProperty({},"length",{get:function(){throw r}}),r={},e(function(){throw 42},null,n)}catch(V){V!==r&&(e=null)}else e=null;var o=/^\s*class\b/,l=function(B){try{var W=t.call(B);return o.test(W)}catch{return!1}},c=function(B){try{return l(B)?!1:(t.call(B),!0)}catch{return!1}},s=Object.prototype.toString,m="[object Object]",y="[object Function]",b="[object GeneratorFunction]",w="[object HTMLAllCollection]",E="[object HTML document.all class]",T="[object HTMLCollection]",R=typeof Symbol=="function"&&!!Symbol.toStringTag,z=!(0 in[,]),I=function(){return!1};if(typeof document=="object"){var L=document.all;s.call(L)===s.call(document.all)&&(I=function(B){if((z||!B)&&(typeof B>"u"||typeof B=="object"))try{var W=s.call(B);return(W===w||W===E||W===T||W===m)&&B("")==null}catch{}return!1})}return iC=e?function(B){if(I(B))return!0;if(!B||typeof B!="function"&&typeof B!="object")return!1;try{e(B,null,n)}catch(W){if(W!==r)return!1}return!l(B)&&c(B)}:function(B){if(I(B))return!0;if(!B||typeof B!="function"&&typeof B!="object")return!1;if(R)return c(B);if(l(B))return!1;var W=s.call(B);return W!==y&&W!==b&&!/^\[object HTML/.test(W)?!1:c(B)},iC}var oC,jD;function ox(){return jD||(jD=1,oC=YN()),oC}var sC,HD;function KN(){return HD||(HD=1,sC=function(e){return!!e}),sC}var aC,GD;function Aa(){return GD||(GD=1,aC=function(e){return!!e&&(typeof e=="function"||typeof e=="object")}),aC}var lC,WD;function Wle(){if(WD)return lC;WD=1;var t=ef(),e=Rr(),n=ox(),r=KN(),o=Aa();return lC=function(c){if(!o(c))throw new e("ToPropertyDescriptor requires an object");var s={};if(t(c,"enumerable")&&(s["[[Enumerable]]"]=r(c.enumerable)),t(c,"configurable")&&(s["[[Configurable]]"]=r(c.configurable)),t(c,"value")&&(s["[[Value]]"]=c.value),t(c,"writable")&&(s["[[Writable]]"]=r(c.writable)),t(c,"get")){var m=c.get;if(typeof m<"u"&&!n(m))throw new e("getter must be a function");s["[[Get]]"]=m}if(t(c,"set")){var y=c.set;if(typeof y<"u"&&!n(y))throw new e("setter must be a function");s["[[Set]]"]=y}if((t(s,"[[Get]]")||t(s,"[[Set]]"))&&(t(s,"[[Value]]")||t(s,"[[Writable]]")))throw new e("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return s},lC}var cC,qD;function CA(){return qD||(qD=1,cC=Number.isNaN||function(e){return e!==e}),cC}var uC,XD;function EA(){if(XD)return uC;XD=1;var t=CA();return uC=function(n,r){return n===r?n===0?1/n===1/r:!0:t(n)&&t(r)},uC}var hC,ZD;function al(){if(ZD)return hC;ZD=1;var t=ca(),e=SA(),n=e([t("%String.prototype.indexOf%")]);return hC=function(o,l){var c=t(o,!!l);return typeof c=="function"&&n(o,".prototype.")>-1?e([c]):c},hC}var dC,YD;function TA(){if(YD)return dC;YD=1;var t=ca(),e=t("%Array%"),n=!e.isArray&&al()("Object.prototype.toString");return dC=e.isArray||function(o){return n(o)==="[object Array]"},dC}var fC,KD;function qle(){if(KD)return fC;KD=1;var t=xA(),e=rx(),n=t.hasArrayLengthDefineBug(),r=n&&TA(),o=al(),l=o("Object.prototype.propertyIsEnumerable");return fC=function(s,m,y,b,w,E){if(!e){if(!s(E)||!E["[[Configurable]]"]||!E["[[Writable]]"]||w in b&&l(b,w)!==!!E["[[Enumerable]]"])return!1;var T=E["[[Value]]"];return b[w]=T,m(b[w],T)}return n&&w==="length"&&"[[Value]]"in E&&r(b)&&b.length!==E["[[Value]]"]?(b.length=E["[[Value]]"],b.length===E["[[Value]]"]):(e(b,w,y(E)),!0)},fC}var pC,JD;function Xle(){if(JD)return pC;JD=1;var t=Jm();return pC=function(n,r){return t(r)&&"[[Enumerable]]"in r&&"[[Configurable]]"in r&&(n.IsAccessorDescriptor(r)||n.IsDataDescriptor(r))},pC}var mC,QD;function Zle(){return QD||(QD=1,mC=function(e){if(typeof e>"u")return e;var n={};return"[[Value]]"in e&&(n.value=e["[[Value]]"]),"[[Writable]]"in e&&(n.writable=!!e["[[Writable]]"]),"[[Get]]"in e&&(n.get=e["[[Get]]"]),"[[Set]]"in e&&(n.set=e["[[Set]]"]),"[[Enumerable]]"in e&&(n.enumerable=!!e["[[Enumerable]]"]),"[[Configurable]]"in e&&(n.configurable=!!e["[[Configurable]]"]),n}),mC}var gC,ek;function Yle(){if(ek)return gC;ek=1;var t=Rr(),e=Jm(),n=Zle();return gC=function(o){if(typeof o<"u"&&!e(o))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return n(o)},gC}var vC,tk;function JN(){if(tk)return vC;tk=1;var t=Rr(),e=ef(),n=Jm();return vC=function(o){if(typeof o>"u")return!1;if(!n(o))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!(!e(o,"[[Value]]")&&!e(o,"[[Writable]]"))},vC}var yC,nk;function Kle(){if(nk)return yC;nk=1;var t=Rr(),e=MA(),n=JN(),r=Jm();return yC=function(l){if(typeof l>"u")return!1;if(!r(l))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!e(l)&&!n(l)},yC}var _C,rk;function Jle(){if(rk)return _C;rk=1;var t=Aa();return _C=function(n){if(n===null)return"Null";if(typeof n>"u")return"Undefined";if(t(n))return"Object";if(typeof n=="number")return"Number";if(typeof n=="boolean")return"Boolean";if(typeof n=="string")return"String"},_C}var xC,ik;function Qle(){if(ik)return xC;ik=1;var t=Jle();return xC=function(n){return typeof n=="symbol"?"Symbol":typeof n=="bigint"?"BigInt":t(n)},xC}var bC,ok;function ece(){if(ok)return bC;ok=1;var t=Rr(),e=qle(),n=Xle(),r=Jm(),o=Yle(),l=MA(),c=JN(),s=Kle(),m=Km(),y=EA(),b=Qle(),w=Aa();return bC=function(T,R,z,I,L){var V=b(T);if(typeof T<"u"&&!w(T))throw new t("Assertion failed: O must be undefined or an Object");if(!m(R))throw new t("Assertion failed: P must be a Property Key");if(typeof z!="boolean")throw new t("Assertion failed: extensible must be a Boolean");if(!r(I))throw new t("Assertion failed: Desc must be a Property Descriptor");if(typeof L<"u"&&!r(L))throw new t("Assertion failed: current must be a Property Descriptor, or undefined");if(typeof L>"u")return z?V==="Undefined"?!0:l(I)?e(c,y,o,T,R,I):e(c,y,o,T,R,{"[[Configurable]]":!!I["[[Configurable]]"],"[[Enumerable]]":!!I["[[Enumerable]]"],"[[Value]]":I["[[Value]]"],"[[Writable]]":!!I["[[Writable]]"]}):!1;if(!n({IsAccessorDescriptor:l,IsDataDescriptor:c},L))throw new t("`current`, when present, must be a fully populated and valid Property Descriptor");if(!L["[[Configurable]]"]){if("[[Configurable]]"in I&&I["[[Configurable]]"]||"[[Enumerable]]"in I&&!y(I["[[Enumerable]]"],L["[[Enumerable]]"])||!s(I)&&!y(l(I),l(L)))return!1;if(l(L)){if("[[Get]]"in I&&!y(I["[[Get]]"],L["[[Get]]"])||"[[Set]]"in I&&!y(I["[[Set]]"],L["[[Set]]"]))return!1}else if(!L["[[Writable]]"]&&("[[Writable]]"in I&&I["[[Writable]]"]||"[[Value]]"in I&&!y(I["[[Value]]"],L["[[Value]]"])))return!1}if(V!=="Undefined"){var B,W;return c(L)&&l(I)?(B=("[[Configurable]]"in I?I:L)["[[Configurable]]"],W=("[[Enumerable]]"in I?I:L)["[[Enumerable]]"],e(c,y,o,T,R,{"[[Configurable]]":!!B,"[[Enumerable]]":!!W,"[[Get]]":("[[Get]]"in I?I:L)["[[Get]]"],"[[Set]]":("[[Set]]"in I?I:L)["[[Set]]"]})):l(L)&&c(I)?(B=("[[Configurable]]"in I?I:L)["[[Configurable]]"],W=("[[Enumerable]]"in I?I:L)["[[Enumerable]]"],e(c,y,o,T,R,{"[[Configurable]]":!!B,"[[Enumerable]]":!!W,"[[Value]]":("[[Value]]"in I?I:L)["[[Value]]"],"[[Writable]]":!!("[[Writable]]"in I?I:L)["[[Writable]]"]})):e(c,y,o,T,R,I)}return!0},bC}var wC,sk;function tce(){if(sk)return wC;sk=1;var t=hy(),e=bp(),n=Rr(),r=Jm(),o=MA(),l=Gle(),c=Km(),s=Wle(),m=EA(),y=ece(),b=Aa();return wC=function(E,T,R){if(!b(E))throw new n("Assertion failed: O must be an Object");if(!c(T))throw new n("Assertion failed: P must be a Property Key");if(!r(R))throw new n("Assertion failed: Desc must be a Property Descriptor");if(!t){if(o(R))throw new e("This environment does not support accessor property descriptors.");var z=!(T in E)&&R["[[Writable]]"]&&R["[[Enumerable]]"]&&R["[[Configurable]]"]&&"[[Value]]"in R,I=T in E&&(!("[[Configurable]]"in R)||R["[[Configurable]]"])&&(!("[[Enumerable]]"in R)||R["[[Enumerable]]"])&&(!("[[Writable]]"in R)||R["[[Writable]]"])&&"[[Value]]"in R;if(z||I)return E[T]=R["[[Value]]"],m(E[T],R["[[Value]]"]);throw new e("This environment does not support defining non-writable, non-enumerable, or non-configurable properties")}var L=t(E,T),V=L&&s(L),B=l(E);return y(E,T,B,R,V)},wC}var SC,ak;function nce(){if(ak)return SC;ak=1;var t=Rr(),e=Km(),n=tce(),r=Aa();return SC=function(l,c,s){if(!r(l))throw new t("Assertion failed: Type(O) is not Object");if(!e(c))throw new t("Assertion failed: P is not a Property Key");var m={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Value]]":s,"[[Writable]]":!0};return n(l,c,m)},SC}var MC,lk;function rce(){if(lk)return MC;lk=1;var t=Rr(),e=nce(),n=Aa(),r=Km();return MC=function(l,c,s){if(!n(l))throw new t("Assertion failed: Type(O) is not Object");if(!r(c))throw new t("Assertion failed: P is not a Property Key");var m=e(l,c,s);if(!m)throw new t("unable to create data property")},MC}var CC,ck;function PA(){return ck||(ck=1,CC=TA()),CC}var EC,uk;function AA(){return uk||(uk=1,EC=function(e,n){for(var r=0;r<e.length;r+=1)n(e[r],r,e)}),EC}const ice={},oce=Object.freeze(Object.defineProperty({__proto__:null,default:ice},Symbol.toStringTag,{value:"Module"})),sce=E8(oce);var TC,hk;function wp(){if(hk)return TC;hk=1;var t=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,n=t&&e&&typeof e.get=="function"?e.get:null,r=t&&Map.prototype.forEach,o=typeof Set=="function"&&Set.prototype,l=Object.getOwnPropertyDescriptor&&o?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=o&&l&&typeof l.get=="function"?l.get:null,s=o&&Set.prototype.forEach,m=typeof WeakMap=="function"&&WeakMap.prototype,y=m?WeakMap.prototype.has:null,b=typeof WeakSet=="function"&&WeakSet.prototype,w=b?WeakSet.prototype.has:null,E=typeof WeakRef=="function"&&WeakRef.prototype,T=E?WeakRef.prototype.deref:null,R=Boolean.prototype.valueOf,z=Object.prototype.toString,I=Function.prototype.toString,L=String.prototype.match,V=String.prototype.slice,B=String.prototype.replace,W=String.prototype.toUpperCase,X=String.prototype.toLowerCase,q=RegExp.prototype.test,te=Array.prototype.concat,se=Array.prototype.join,re=Array.prototype.slice,$=Math.floor,ce=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ce=Object.getOwnPropertySymbols,Se=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Xe=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Fe=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Xe||!0)?Symbol.toStringTag:null,Me=Object.prototype.propertyIsEnumerable,Te=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(ee){return ee.__proto__}:null);function Ie(ee,fe){if(ee===1/0||ee===-1/0||ee!==ee||ee&&ee>-1e3&&ee<1e3||q.call(/e/,fe))return fe;var Oe=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof ee=="number"){var Ye=ee<0?-$(-ee):$(ee);if(Ye!==ee){var ye=String(Ye),Ae=V.call(fe,ye.length+1);return B.call(ye,Oe,"$&_")+"."+B.call(B.call(Ae,/([0-9]{3})/g,"$&_"),/_$/,"")}}return B.call(fe,Oe,"$&_")}var Ke=sce,st=Ke.custom,Ee=un(st)?st:null,Qe={__proto__:null,double:'"',single:"'"},jt={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};TC=function ee(fe,Oe,Ye,ye){var Ae=Oe||{};if(Jt(Ae,"quoteStyle")&&!Jt(Qe,Ae.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Jt(Ae,"maxStringLength")&&(typeof Ae.maxStringLength=="number"?Ae.maxStringLength<0&&Ae.maxStringLength!==1/0:Ae.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Be=Jt(Ae,"customInspect")?Ae.customInspect:!0;if(typeof Be!="boolean"&&Be!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Jt(Ae,"indent")&&Ae.indent!==null&&Ae.indent!=="	"&&!(parseInt(Ae.indent,10)===Ae.indent&&Ae.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Jt(Ae,"numericSeparator")&&typeof Ae.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var $e=Ae.numericSeparator;if(typeof fe>"u")return"undefined";if(fe===null)return"null";if(typeof fe=="boolean")return fe?"true":"false";if(typeof fe=="string")return Ot(fe,Ae);if(typeof fe=="number"){if(fe===0)return 1/0/fe>0?"0":"-0";var He=String(fe);return $e?Ie(fe,He):He}if(typeof fe=="bigint"){var ut=String(fe)+"n";return $e?Ie(fe,ut):ut}var We=typeof Ae.depth>"u"?5:Ae.depth;if(typeof Ye>"u"&&(Ye=0),Ye>=We&&We>0&&typeof fe=="object")return At(fe)?"[Array]":"[Object]";var Ut=Pe(Ae,Ye);if(typeof ye>"u")ye=[];else if(Nn(ye,fe)>=0)return"[Circular]";function Kt(cn,Rn,Ir){if(Rn&&(ye=re.call(ye),ye.push(Rn)),Ir){var _r={depth:Ae.depth};return Jt(Ae,"quoteStyle")&&(_r.quoteStyle=Ae.quoteStyle),ee(cn,_r,Ye+1,ye)}return ee(cn,Ae,Ye+1,ye)}if(typeof fe=="function"&&!lt(fe)){var Re=$t(fe),it=ue(fe,Kt);return"[Function"+(Re?": "+Re:" (anonymous)")+"]"+(it.length>0?" { "+se.call(it,", ")+" }":"")}if(un(fe)){var mt=Xe?B.call(String(fe),/^(Symbol\(.*\))_[^)]*$/,"$1"):Se.call(fe);return typeof fe=="object"&&!Xe?Gt(mt):mt}if(Ht(fe)){for(var Wt="<"+X.call(String(fe.nodeName)),tn=fe.attributes||[],pn=0;pn<tn.length;pn++)Wt+=" "+tn[pn].name+"="+je(ft(tn[pn].value),"double",Ae);return Wt+=">",fe.childNodes&&fe.childNodes.length&&(Wt+="..."),Wt+="</"+X.call(String(fe.nodeName))+">",Wt}if(At(fe)){if(fe.length===0)return"[]";var rn=ue(fe,Kt);return Ut&&!Yt(rn)?"["+ae(rn,Ut)+"]":"[ "+se.call(rn,", ")+" ]"}if(bt(fe)){var on=ue(fe,Kt);return!("cause"in Error.prototype)&&"cause"in fe&&!Me.call(fe,"cause")?"{ ["+String(fe)+"] "+se.call(te.call("[cause]: "+Kt(fe.cause),on),", ")+" }":on.length===0?"["+String(fe)+"]":"{ ["+String(fe)+"] "+se.call(on,", ")+" }"}if(typeof fe=="object"&&Be){if(Ee&&typeof fe[Ee]=="function"&&Ke)return Ke(fe,{depth:We-Ye});if(Be!=="symbol"&&typeof fe.inspect=="function")return fe.inspect()}if(vn(fe)){var kn=[];return r&&r.call(fe,function(cn,Rn){kn.push(Kt(Rn,fe,!0)+" => "+Kt(cn,fe))}),Fn("Map",n.call(fe),kn,Ut)}if(yt(fe)){var Ct=[];return s&&s.call(fe,function(cn){Ct.push(Kt(cn,fe))}),Fn("Set",c.call(fe),Ct,Ut)}if(Ue(fe))return Zt("WeakMap");if(Nt(fe))return Zt("WeakSet");if(we(fe))return Zt("WeakRef");if(dn(fe))return Gt(Kt(Number(fe)));if(et(fe))return Gt(Kt(ce.call(fe)));if(En(fe))return Gt(R.call(fe));if(St(fe))return Gt(Kt(String(fe)));if(typeof window<"u"&&fe===window)return"{ [object Window] }";if(typeof globalThis<"u"&&fe===globalThis||typeof qI<"u"&&fe===qI)return"{ [object globalThis] }";if(!ht(fe)&&!lt(fe)){var Gn=ue(fe,Kt),On=Te?Te(fe)===Object.prototype:fe instanceof Object||fe.constructor===Object,or=fe instanceof Object?"":"null prototype",It=!On&&Fe&&Object(fe)===fe&&Fe in fe?V.call(fn(fe),8,-1):or?"Object":"",nt=On||typeof fe.constructor!="function"?"":fe.constructor.name?fe.constructor.name+" ":"",qt=nt+(It||or?"["+se.call(te.call([],It||[],or||[]),": ")+"] ":"");return Gn.length===0?qt+"{}":Ut?qt+"{"+ae(Gn,Ut)+"}":qt+"{ "+se.call(Gn,", ")+" }"}return String(fe)};function je(ee,fe,Oe){var Ye=Oe.quoteStyle||fe,ye=Qe[Ye];return ye+ee+ye}function ft(ee){return B.call(String(ee),/"/g,"&quot;")}function At(ee){return fn(ee)==="[object Array]"&&(!Fe||!(typeof ee=="object"&&Fe in ee))}function ht(ee){return fn(ee)==="[object Date]"&&(!Fe||!(typeof ee=="object"&&Fe in ee))}function lt(ee){return fn(ee)==="[object RegExp]"&&(!Fe||!(typeof ee=="object"&&Fe in ee))}function bt(ee){return fn(ee)==="[object Error]"&&(!Fe||!(typeof ee=="object"&&Fe in ee))}function St(ee){return fn(ee)==="[object String]"&&(!Fe||!(typeof ee=="object"&&Fe in ee))}function dn(ee){return fn(ee)==="[object Number]"&&(!Fe||!(typeof ee=="object"&&Fe in ee))}function En(ee){return fn(ee)==="[object Boolean]"&&(!Fe||!(typeof ee=="object"&&Fe in ee))}function un(ee){if(Xe)return ee&&typeof ee=="object"&&ee instanceof Symbol;if(typeof ee=="symbol")return!0;if(!ee||typeof ee!="object"||!Se)return!1;try{return Se.call(ee),!0}catch{}return!1}function et(ee){if(!ee||typeof ee!="object"||!ce)return!1;try{return ce.call(ee),!0}catch{}return!1}var Ln=Object.prototype.hasOwnProperty||function(ee){return ee in this};function Jt(ee,fe){return Ln.call(ee,fe)}function fn(ee){return z.call(ee)}function $t(ee){if(ee.name)return ee.name;var fe=L.call(I.call(ee),/^function\s*([\w$]+)/);return fe?fe[1]:null}function Nn(ee,fe){if(ee.indexOf)return ee.indexOf(fe);for(var Oe=0,Ye=ee.length;Oe<Ye;Oe++)if(ee[Oe]===fe)return Oe;return-1}function vn(ee){if(!n||!ee||typeof ee!="object")return!1;try{n.call(ee);try{c.call(ee)}catch{return!0}return ee instanceof Map}catch{}return!1}function Ue(ee){if(!y||!ee||typeof ee!="object")return!1;try{y.call(ee,y);try{w.call(ee,w)}catch{return!0}return ee instanceof WeakMap}catch{}return!1}function we(ee){if(!T||!ee||typeof ee!="object")return!1;try{return T.call(ee),!0}catch{}return!1}function yt(ee){if(!c||!ee||typeof ee!="object")return!1;try{c.call(ee);try{n.call(ee)}catch{return!0}return ee instanceof Set}catch{}return!1}function Nt(ee){if(!w||!ee||typeof ee!="object")return!1;try{w.call(ee,w);try{y.call(ee,y)}catch{return!0}return ee instanceof WeakSet}catch{}return!1}function Ht(ee){return!ee||typeof ee!="object"?!1:typeof HTMLElement<"u"&&ee instanceof HTMLElement?!0:typeof ee.nodeName=="string"&&typeof ee.getAttribute=="function"}function Ot(ee,fe){if(ee.length>fe.maxStringLength){var Oe=ee.length-fe.maxStringLength,Ye="... "+Oe+" more character"+(Oe>1?"s":"");return Ot(V.call(ee,0,fe.maxStringLength),fe)+Ye}var ye=jt[fe.quoteStyle||"single"];ye.lastIndex=0;var Ae=B.call(B.call(ee,ye,"\\$1"),/[\x00-\x1f]/g,ln);return je(Ae,"single",fe)}function ln(ee){var fe=ee.charCodeAt(0),Oe={8:"b",9:"t",10:"n",12:"f",13:"r"}[fe];return Oe?"\\"+Oe:"\\x"+(fe<16?"0":"")+W.call(fe.toString(16))}function Gt(ee){return"Object("+ee+")"}function Zt(ee){return ee+" { ? }"}function Fn(ee,fe,Oe,Ye){var ye=Ye?ae(Oe,Ye):se.call(Oe,", ");return ee+" ("+fe+") {"+ye+"}"}function Yt(ee){for(var fe=0;fe<ee.length;fe++)if(Nn(ee[fe],`
`)>=0)return!1;return!0}function Pe(ee,fe){var Oe;if(ee.indent==="	")Oe="	";else if(typeof ee.indent=="number"&&ee.indent>0)Oe=se.call(Array(ee.indent+1)," ");else return null;return{base:Oe,prev:se.call(Array(fe+1),Oe)}}function ae(ee,fe){if(ee.length===0)return"";var Oe=`
`+fe.prev+fe.base;return Oe+se.call(ee,","+Oe)+`
`+fe.prev}function ue(ee,fe){var Oe=At(ee),Ye=[];if(Oe){Ye.length=ee.length;for(var ye=0;ye<ee.length;ye++)Ye[ye]=Jt(ee,ye)?fe(ee[ye],ee):""}var Ae=typeof Ce=="function"?Ce(ee):[],Be;if(Xe){Be={};for(var $e=0;$e<Ae.length;$e++)Be["$"+Ae[$e]]=Ae[$e]}for(var He in ee)Jt(ee,He)&&(Oe&&String(Number(He))===He&&He<ee.length||Xe&&Be["$"+He]instanceof Symbol||(q.call(/[^\w$]/,He)?Ye.push(fe(He,ee)+": "+fe(ee[He],ee)):Ye.push(He+": "+fe(ee[He],ee))));if(typeof Ce=="function")for(var ut=0;ut<Ae.length;ut++)Me.call(ee,Ae[ut])&&Ye.push("["+fe(Ae[ut])+"]: "+fe(ee[Ae[ut]],ee));return Ye}return TC}var PC,dk;function ace(){if(dk)return PC;dk=1;var t=wp(),e=Rr(),n=function(s,m,y){for(var b=s,w;(w=b.next)!=null;b=w)if(w.key===m)return b.next=w.next,y||(w.next=s.next,s.next=w),w},r=function(s,m){if(s){var y=n(s,m);return y&&y.value}},o=function(s,m,y){var b=n(s,m);b?b.value=y:s.next={key:m,next:s.next,value:y}},l=function(s,m){return s?!!n(s,m):!1},c=function(s,m){if(s)return n(s,m,!0)};return PC=function(){var m,y={assert:function(b){if(!y.has(b))throw new e("Side channel does not contain "+t(b))},delete:function(b){var w=m&&m.next,E=c(m,b);return E&&w&&w===E&&(m=void 0),!!E},get:function(b){return r(m,b)},has:function(b){return l(m,b)},set:function(b,w){m||(m={next:void 0}),o(m,b,w)}};return y},PC}var AC,fk;function QN(){if(fk)return AC;fk=1;var t=ca(),e=al(),n=wp(),r=Rr(),o=t("%Map%",!0),l=e("Map.prototype.get",!0),c=e("Map.prototype.set",!0),s=e("Map.prototype.has",!0),m=e("Map.prototype.delete",!0),y=e("Map.prototype.size",!0);return AC=!!o&&function(){var w,E={assert:function(T){if(!E.has(T))throw new r("Side channel does not contain "+n(T))},delete:function(T){if(w){var R=m(w,T);return y(w)===0&&(w=void 0),R}return!1},get:function(T){if(w)return l(w,T)},has:function(T){return w?s(w,T):!1},set:function(T,R){w||(w=new o),c(w,T,R)}};return E},AC}var IC,pk;function lce(){if(pk)return IC;pk=1;var t=ca(),e=al(),n=wp(),r=QN(),o=Rr(),l=t("%WeakMap%",!0),c=e("WeakMap.prototype.get",!0),s=e("WeakMap.prototype.set",!0),m=e("WeakMap.prototype.has",!0),y=e("WeakMap.prototype.delete",!0);return IC=l?function(){var w,E,T={assert:function(R){if(!T.has(R))throw new o("Side channel does not contain "+n(R))},delete:function(R){if(l&&R&&(typeof R=="object"||typeof R=="function")){if(w)return y(w,R)}else if(r&&E)return E.delete(R);return!1},get:function(R){return l&&R&&(typeof R=="object"||typeof R=="function")&&w?c(w,R):E&&E.get(R)},has:function(R){return l&&R&&(typeof R=="object"||typeof R=="function")&&w?m(w,R):!!E&&E.has(R)},set:function(R,z){l&&R&&(typeof R=="object"||typeof R=="function")?(w||(w=new l),s(w,R,z)):r&&(E||(E=r()),E.set(R,z))}};return T}:r,IC}var RC,mk;function cce(){if(mk)return RC;mk=1;var t=Rr(),e=wp(),n=ace(),r=QN(),o=lce(),l=o||r||n;return RC=function(){var s,m={assert:function(y){if(!m.has(y))throw new t("Side channel does not contain "+e(y))},delete:function(y){return!!s&&s.delete(y)},get:function(y){return s&&s.get(y)},has:function(y){return!!s&&s.has(y)},set:function(y,b){s||(s=l()),s.set(y,b)}};return m},RC}var LC,gk;function IA(){if(gk)return LC;gk=1;var t=ef(),e=cce()(),n=Rr(),r={assert:function(o,l){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");if(e.assert(o),!r.has(o,l))throw new n("`"+l+"` is not present on `O`")},get:function(o,l){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var c=e.get(o);return c&&c["$"+l]},has:function(o,l){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var c=e.get(o);return!!c&&t(c,"$"+l)},set:function(o,l,c){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var s=e.get(o);s||(s={},e.set(o,s)),s["$"+l]=c}};return Object.freeze&&Object.freeze(r),LC=r,LC}var DC,vk;function uce(){if(vk)return DC;vk=1;var t={__proto__:null,foo:{}},e={__proto__:t}.foo===t.foo&&!(t instanceof Object);return DC=function(){return e},DC}var kC,yk;function eB(){if(yk)return kC;yk=1;var t=ca(),e=t("%Object.create%",!0),n=Rr(),r=bp(),o=PA(),l=AA(),c=Aa(),s=IA(),m=uce()();return kC=function(b){if(b!==null&&!c(b))throw new n("Assertion failed: `proto` must be null or an object");var w=arguments.length<2?[]:arguments[1];if(!o(w))throw new n("Assertion failed: `additionalInternalSlotsList` must be an Array");var E;if(e)E=e(b);else if(m)E={__proto__:b};else{if(b===null)throw new r("native Object.create support is required to create null objects");var T=function(){};T.prototype=b,E=new T}return w.length>0&&l(w,function(R){s.set(E,R,void 0)}),E},kC}var zC,_k;function hce(){return _k||(_k=1,zC=function(e){return e===0&&1/e===-1/0}),zC}var OC,xk;function tB(){return xk||(xk=1,OC=Number.MAX_SAFE_INTEGER||9007199254740991),OC}var FC,bk;function dce(){return bk||(bk=1,FC=function(e,n){for(var r=0;r<e.length;r+=1)if(!n(e[r],r,e))return!1;return!0}),FC}var NC,wk;function fce(){if(wk)return NC;wk=1;var t=Rr(),e=al(),n=e("Array.prototype.push"),r=EA(),o=TA(),l=dce(),c=AA(),s=ef(),m=function(y){return s(y,"[[Key]]")&&s(y,"[[Elements]]")&&o(y["[[Elements]]"])};return NC=function(b,w,E){if(!o(b)||b.length>0&&!l(b,m))throw new t("Assertion failed: `groups` must be a List of Records with [[Key]] and [[Elements]]");var T=0;if(c(b,function(z){if(r(z["[[Key]]"],w)){if(T+=1,T>1)throw new t("Assertion failed: Exactly one element of groups meets this criterion");n(z["[[Elements]]"],E)}}),T===0){var R={"[[Key]]":w,"[[Elements]]":[E]};n(b,R)}},NC}var BC,Sk;function sx(){if(Sk)return BC;Sk=1;var t=ca(),e=al(),n=Rr(),r=PA(),o=t("%Reflect.apply%",!0)||e("Function.prototype.apply");return BC=function(c,s){var m=arguments.length>2?arguments[2]:[];if(!r(m))throw new n("Assertion failed: optional `argumentsList`, if provided, must be a List");return o(c,s,m)},BC}var UC,Mk;function nB(){return Mk||(Mk=1,UC=function(e){return typeof e=="number"&&e>=55296&&e<=56319}),UC}var $C,Ck;function rB(){return Ck||(Ck=1,$C=function(e){return typeof e=="number"&&e>=56320&&e<=57343}),$C}var VC,Ek;function pce(){if(Ek)return VC;Ek=1;var t=ca(),e=Rr(),n=t("%String.fromCharCode%"),r=nB(),o=rB();return VC=function(c,s){if(!r(c)||!o(s))throw new e("Assertion failed: `lead` must be a leading surrogate char code, and `trail` must be a trailing surrogate char code");return n(c)+n(s)},VC}var jC,Tk;function mce(){if(Tk)return jC;Tk=1;var t=Rr(),e=al(),n=nB(),r=rB(),o=pce(),l=e("String.prototype.charAt"),c=e("String.prototype.charCodeAt");return jC=function(m,y){if(typeof m!="string")throw new t("Assertion failed: `string` must be a String");var b=m.length;if(y<0||y>=b)throw new t("Assertion failed: `position` must be >= 0, and < the length of `string`");var w=c(m,y),E=l(m,y),T=n(w),R=r(w);if(!T&&!R)return{"[[CodePoint]]":E,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!1};if(R||y+1===b)return{"[[CodePoint]]":E,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0};var z=c(m,y+1);return r(z)?{"[[CodePoint]]":o(w,z),"[[CodeUnitCount]]":2,"[[IsUnpairedSurrogate]]":!1}:{"[[CodePoint]]":E,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0}},jC}var HC,Pk;function gce(){if(Pk)return HC;Pk=1;var t=CA();return HC=function(n){return(typeof n=="number"||typeof n=="bigint")&&!t(n)&&n!==1/0&&n!==-1/0},HC}var GC,Ak;function vce(){if(Ak)return GC;Ak=1;var t=GN(),e=WN(),n=CA(),r=gce();return GC=function(l){if(typeof l!="number"||n(l)||!r(l))return!1;var c=t(l);return e(c)===c},GC}var WC,Ik;function yce(){if(Ik)return WC;Ik=1;var t=mce(),e=Rr(),n=vce(),r=tB();return WC=function(l,c,s){if(typeof l!="string")throw new e("Assertion failed: `S` must be a String");if(!n(c)||c<0||c>r)throw new e("Assertion failed: `length` must be an integer >= 0 and <= 2**53");if(typeof s!="boolean")throw new e("Assertion failed: `unicode` must be a Boolean");if(!s)return c+1;var m=l.length;if(c+1>=m)return c+1;var y=t(l,c);return c+y["[[CodeUnitCount]]"]},WC}var qC,Rk;function iB(){if(Rk)return qC;Rk=1;var t=Rr();return qC=function(n,r){if(typeof r!="boolean")throw new t("Assertion failed: Type(done) is not Boolean");return{value:n,done:r}},qC}var XC,Lk;function Zw(){if(Lk)return XC;Lk=1;var t=Rr(),e=wp(),n=Aa(),r=Km();return XC=function(l,c){if(!n(l))throw new t("Assertion failed: Type(O) is not Object");if(!r(c))throw new t("Assertion failed: P is not a Property Key, got "+e(c));return l[c]},XC}var ZC,Dk;function oB(){if(Dk)return ZC;Dk=1;var t=Rr(),e=Zw(),n=KN(),r=Aa();return ZC=function(l){if(!r(l))throw new t("Assertion failed: Type(iterResult) is not Object");return n(e(l,"done"))},ZC}var YC,kk;function sB(){if(kk)return YC;kk=1;var t=Rr(),e=Zw(),n=Aa();return YC=function(o){if(!n(o))throw new t("Assertion failed: Type(iterResult) is not Object");return e(o,"value")},YC}var KC,zk;function _ce(){if(zk)return KC;zk=1;var t=ca(),e=ZN(),n=bp(),r=t("%Promise.resolve%",!0),o=r&&e(r);return KC=function(c,s){if(!o)throw new n("This environment does not support Promises.");return o(c,s)},KC}var JC,Ok;function xce(){if(Ok)return JC;Ok=1;var t=ca(),e=bp(),n=Rr(),r=t("%Promise%",!0),o=al(),l=iB(),c=oB(),s=sB(),m=_ce(),y=Aa(),b=o("Promise.prototype.then",!0);return JC=function(E){if(!y(E))throw new n("Assertion failed: Type(O) is not Object");if(arguments.length>1)throw new e("although AsyncFromSyncIteratorContinuation should take a second argument, it is not used in this implementation");if(!r)throw new e("This environment does not support Promises.");return new r(function(T){var R=c(E),z=s(E),I=m(r,z),L=function(V){return l(V,R)};T(b(I,L))})},JC}var QC,Fk;function bce(){if(Fk)return QC;Fk=1;var t=Rr(),e=wp(),n=Km();return QC=function(o,l){if(!n(l))throw new t("Assertion failed: P is not a Property Key, got "+e(l));return o[l]},QC}var eE,Nk;function RA(){if(Nk)return eE;Nk=1;var t=Rr(),e=bce(),n=ox(),r=Km(),o=wp();return eE=function(c,s){if(!r(s))throw new t("Assertion failed: P is not a Property Key");var m=e(c,s);if(m!=null){if(!n(m))throw new t(o(s)+" is not a function: "+o(m));return m}},eE}var tE,Bk;function Yw(){if(Bk)return tE;Bk=1;var t=ef();return tE=function(n){return!!n&&typeof n=="object"&&t(n,"[[Iterator]]")&&t(n,"[[NextMethod]]")&&t(n,"[[Done]]")&&typeof n["[[Done]]"]=="boolean"},tE}var nE,Uk;function aB(){if(Uk)return nE;Uk=1;var t=Rr(),e=sx(),n=Aa(),r=Yw();return nE=function(l){if(!r(l))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");var c;if(arguments.length<2?c=e(l["[[NextMethod]]"],l["[[Iterator]]"]):c=e(l["[[NextMethod]]"],l["[[Iterator]]"],[arguments[1]]),!n(c))throw new t("iterator next must return an object");return c},nE}var rE,$k;function wce(){if($k)return rE;$k=1;var t=ca(),e=bp(),n=Rr(),r=t("%Promise%",!0),o=xce(),l=sx(),c=iB(),s=Zw(),m=RA(),y=aB(),b=eB(),w=Aa(),E=Yw(),T=IA(),R=t("%AsyncFromSyncIteratorPrototype%",!0)||{next:function(I){if(!r)throw new e("This environment does not support Promises.");var L=this;T.assert(L,"[[SyncIteratorRecord]]");var V=arguments.length;return new r(function(B){var W=T.get(L,"[[SyncIteratorRecord]]"),X;V>0?X=y(W,I):X=y(W),B(o(X))})},return:function(){if(!r)throw new e("This environment does not support Promises.");var z=this;T.assert(z,"[[SyncIteratorRecord]]");var I=arguments.length>0,L=I?arguments[0]:void 0;return new r(function(V,B){var W=T.get(z,"[[SyncIteratorRecord]]")["[[Iterator]]"],X=m(W,"return");if(typeof X>"u"){var q=c(L,!0);l(V,void 0,[q]);return}var te;if(I?te=l(X,W,[L]):te=l(X,W),!w(te)){l(B,void 0,[new n("Iterator `return` method returned a non-object value.")]);return}V(o(te))})},throw:function(){if(!r)throw new e("This environment does not support Promises.");var z=this;T.assert(z,"[[SyncIteratorRecord]]");var I=arguments.length>0,L=I?arguments[0]:void 0;return new r(function(V,B){var W=T.get(z,"[[SyncIteratorRecord]]")["[[Iterator]]"],X=m(W,"throw");if(typeof X>"u"){l(B,void 0,[L]);return}var q;if(I?q=l(X,W,[L]):q=l(X,W),!w(q)){l(B,void 0,[new n("Iterator `throw` method returned a non-object value.")]);return}V(o(q))})}};return rE=function(I){if(!E(I))throw new n("Assertion failed: `syncIteratorRecord` must be an Iterator Record");var L=b(R);T.set(L,"[[SyncIteratorRecord]]",I);var V=s(L,"next");return{"[[Iterator]]":L,"[[NextMethod]]":V,"[[Done]]":!1}},rE}var iE,Vk;function Sce(){if(Vk)return iE;Vk=1;var t=Rr(),e=sx(),n=Zw(),r=ox(),o=Aa();return iE=function(c,s){if(!r(s))throw new t("method must be a function");var m=e(s,c);if(!o(m))throw new t("iterator must return an object");var y=n(m,"next");return{"[[Iterator]]":m,"[[NextMethod]]":y,"[[Done]]":!1}},iE}var oE,jk;function LA(){if(jk)return oE;jk=1;var t=qN();return oE=function(){return t()&&!!Symbol.toStringTag},oE}var sE,Hk;function Mce(){if(Hk)return sE;Hk=1;var t=al(),e=t("String.prototype.valueOf"),n=function(s){try{return e(s),!0}catch{return!1}},r=t("Object.prototype.toString"),o="[object String]",l=LA()();return sE=function(s){return typeof s=="string"?!0:!s||typeof s!="object"?!1:l?n(s):r(s)===o},sE}var aE,Gk;function Cce(){if(Gk)return aE;Gk=1;var t=Xw()(),e=ca(),n=al(),r=Mce(),o=e("%Symbol.iterator%",!0),l=n("String.prototype.slice"),c=e("%String%");return aE=function(m,y){var b;return t?b=m.GetMethod(y,o):m.IsArray(y)?b=function(){var w=-1,E=this;return{next:function(){return w+=1,{done:w>=E.length,value:E[w]}}}}:r(y)&&(b=function(){var w=0;return{next:function(){var E=m.AdvanceStringIndex(c(y),w,!0),T=l(y,w,E);return w=E,{done:E>y.length,value:T}}}}),b},aE}var lE,Wk;function Ece(){if(Wk)return lE;Wk=1;var t=ca(),e=Rr(),n=t("%Symbol.asyncIterator%",!0),r=wp(),o=Xw()(),l=yce(),c=wce(),s=Sce(),m=RA(),y=PA(),b={AdvanceStringIndex:l,GetMethod:m,IsArray:y},w=Cce();return lE=function(T,R){if(R!=="SYNC"&&R!=="ASYNC")throw new e("Assertion failed: `kind` must be one of 'sync' or 'async', got "+r(R));var z;if(R==="ASYNC"&&o&&n&&(z=m(T,n)),typeof z>"u"){var I=w(b,T);if(R==="ASYNC"){if(typeof I>"u")throw new e("iterator method is `undefined`");var L=s(T,I);return c(L)}z=I}if(typeof z>"u")throw new e("iterator method is `undefined`");return s(T,z)},lE}var cE,qk;function lB(){if(qk)return cE;qk=1;var t=bp(),e=IA(),n=function r(o,l){if(!(this instanceof r))return new r(o,l);if(o!=="normal"&&o!=="break"&&o!=="continue"&&o!=="return"&&o!=="throw")throw new t('Assertion failed: `type` must be one of "normal", "break", "continue", "return", or "throw"');e.set(this,"[[Type]]",o),e.set(this,"[[Value]]",l)};return n.prototype.type=function(){return e.get(this,"[[Type]]")},n.prototype.value=function(){return e.get(this,"[[Value]]")},n.prototype["?"]=function(){var o=e.get(this,"[[Type]]"),l=e.get(this,"[[Value]]");if(o==="throw")throw l;return l},n.prototype["!"]=function(){var o=e.get(this,"[[Type]]");if(o!=="normal")throw new t('Assertion failed: Completion Record is not of type "normal"');return e.get(this,"[[Value]]")},cE=n,cE}var uE,Xk;function Tce(){if(Xk)return uE;Xk=1;var t=Rr(),e=sx(),n=lB(),r=RA(),o=ox(),l=Aa(),c=Yw();return uE=function(m,y){if(!c(m))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");if(!l(m["[[Iterator]]"]))throw new t("Assertion failed: iteratorRecord.[[Iterator]] must be an Object");if(!o(y)&&!(y instanceof n))throw new t("Assertion failed: completion is not a thunk representing a Completion Record, nor a Completion Record instance");var b=y instanceof n?function(){return y["?"]()}:y,w=m["[[Iterator]]"],E;try{E=r(w,"return")}catch(z){throw b(),b=null,z}if(typeof E>"u")return b();var T;try{T=e(E,w,[])}catch(z){throw b(),b=null,z}var R=b();if(b=null,!l(T))throw new t("iterator .return must return an object");return R},uE}var hE,Zk;function Pce(){if(Zk)return hE;Zk=1;var t=Rr(),e=oB(),n=aB(),r=Yw();return hE=function(l){if(!r(l))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");var c=n(l),s=e(c);return s===!0?!1:c},hE}var dE,Yk;function Ace(){if(Yk)return dE;Yk=1;var t=Rr();return dE=function(n){if(n==null)throw new t(arguments.length>0&&arguments[1]||"Cannot call method on "+n);return n},dE}var fE,Kk;function Ice(){return Kk||(Kk=1,fE=Ace()),fE}var pE,Jk;function Rce(){if(Jk)return pE;Jk=1;var t=lB();return pE=function(n){return new t("throw",n)},pE}var mE,Qk;function Lce(){return Qk||(Qk=1,mE=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),mE}var gE,ez;function Dce(){if(ez)return gE;ez=1;var t=al(),e=t("Date.prototype.getDay"),n=function(s){try{return e(s),!0}catch{return!1}},r=t("Object.prototype.toString"),o="[object Date]",l=LA()();return gE=function(s){return typeof s!="object"||s===null?!1:l?n(s):r(s)===o},gE}var cb={exports:{}},vE,tz;function kce(){if(tz)return vE;tz=1;var t=al(),e=LA()(),n=ef(),r=hy(),o;if(e){var l=t("RegExp.prototype.exec"),c={},s=function(){throw c},m={toString:s,valueOf:s};typeof Symbol.toPrimitive=="symbol"&&(m[Symbol.toPrimitive]=s),o=function(E){if(!E||typeof E!="object")return!1;var T=r(E,"lastIndex"),R=T&&n(T,"value");if(!R)return!1;try{l(E,m)}catch(z){return z===c}}}else{var y=t("Object.prototype.toString"),b="[object RegExp]";o=function(E){return!E||typeof E!="object"&&typeof E!="function"?!1:y(E)===b}}return vE=o,vE}var yE,nz;function zce(){if(nz)return yE;nz=1;var t=al(),e=kce(),n=t("RegExp.prototype.exec"),r=Rr();return yE=function(l){if(!e(l))throw new r("`regex` must be a RegExp");return function(s){return n(l,s)!==null}},yE}var rz;function Oce(){if(rz)return cb.exports;rz=1;var t=al(),e=t("Object.prototype.toString"),n=Xw()(),r=zce();if(n){var o=t("Symbol.prototype.toString"),l=r(/^Symbol\(.*\)$/),c=function(m){return typeof m.valueOf()!="symbol"?!1:l(o(m))};cb.exports=function(m){if(typeof m=="symbol")return!0;if(!m||typeof m!="object"||e(m)!=="[object Symbol]")return!1;try{return c(m)}catch{return!1}}}else cb.exports=function(m){return!1};return cb.exports}var _E,iz;function Fce(){if(iz)return _E;iz=1;var t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",e=Lce(),n=YN(),r=Dce(),o=Oce(),l=function(m,y){if(typeof m>"u"||m===null)throw new TypeError("Cannot call method on "+m);if(typeof y!="string"||y!=="number"&&y!=="string")throw new TypeError('hint must be "string" or "number"');var b=y==="string"?["toString","valueOf"]:["valueOf","toString"],w,E,T;for(T=0;T<b.length;++T)if(w=m[b[T]],n(w)&&(E=w.call(m),e(E)))return E;throw new TypeError("No default value")},c=function(m,y){var b=m[y];if(b!==null&&typeof b<"u"){if(!n(b))throw new TypeError(b+" returned for property "+String(y)+" of object "+m+" is not a function");return b}};return _E=function(m){if(e(m))return m;var y="default";arguments.length>1&&(arguments[1]===String?y="string":arguments[1]===Number&&(y="number"));var b;if(t&&(Symbol.toPrimitive?b=c(m,Symbol.toPrimitive):o(m)&&(b=Symbol.prototype.valueOf)),typeof b<"u"){var w=b.call(m,y);if(e(w))return w;throw new TypeError("unable to convert exotic object to primitive")}return y==="default"&&(r(m)||o(m))&&(y="string"),l(m,y==="default"?"number":y)},_E}var xE,oz;function Nce(){if(oz)return xE;oz=1;var t=Fce();return xE=function(n){return arguments.length>1?t(n,arguments[1]):t(n)},xE}var bE,sz;function Bce(){if(sz)return bE;sz=1;var t=ca(),e=t("%String%"),n=Rr();return bE=function(o){if(typeof o=="symbol")throw new n("Cannot convert a Symbol value to a string");return e(o)},bE}var wE,az;function Uce(){if(az)return wE;az=1;var t=ca(),e=t("%String%"),n=Nce(),r=Bce();return wE=function(l){var c=n(l,e);return typeof c=="symbol"?c:r(c)},wE}var SE,lz;function $ce(){if(lz)return SE;lz=1;var t=Rr(),e=hce(),n=tB(),r=fce(),o=sx(),l=Ece(),c=ox(),s=Tce(),m=Pce(),y=sB(),b=Ice(),w=Rce(),E=Uce();return SE=function(R,z,I){if(I!=="PROPERTY"&&I!=="ZERO")throw new t('Assertion failed: `keyCoercion` must be `"PROPERTY"` or `"ZERO"`');if(b(R),!c(z))throw new t("callbackfn must be callable");for(var L=[],V=l(R,"SYNC"),B=0;;){if(B>=n){var W=w(new t("k must be less than 2 ** 53 - 1"));s(V,W);return}var X=m(V);if(!X)return L;var q=y(X),te;try{te=o(z,void 0,[q,B])}catch(se){s(V,w(se));return}if(I==="PROPERTY")try{te=E(te)}catch(se){s(V,w(se));return}else{if(I!=="ZERO")throw new t("keyCoercion must be ~PROPERTY~ or ~ZERO~");e(te)&&(te=0)}r(L,te,q),B+=1}},SE}var ME,cz;function cB(){if(cz)return ME;cz=1;var t=rce(),e=eB(),n=AA(),r=$ce();return ME=function(l,c){var s=r(l,c,"PROPERTY"),m=e(null);return n(s,function(y){t(m,y["[[Key]]"],y["[[Elements]]"])}),m},ME}var CE,uz;function uB(){if(uz)return CE;uz=1;var t=cB();return CE=function(){return Object.groupBy||t},CE}var EE,hz;function Vce(){if(hz)return EE;hz=1;var t=HN(),e=uB();return EE=function(){var r=e();return t(Object,{groupBy:r},{groupBy:function(){return Object.groupBy!==r}}),r},EE}var TE,dz;function jce(){if(dz)return TE;dz=1;var t=HN(),e=ZN(),n=cB(),r=uB(),o=r(),l=Vce(),c=e(o,Object);return t(c,{getPolyfill:r,implementation:n,shim:l}),TE=c,TE}var Hce=jce();const Gce=JT(Hce),U1=[{label:"ATS",value:{map:"usa",search:"places"}},{label:"ATS",value:{map:"usa",search:"achievements"}},{label:"ETS2",value:{map:"europe",search:"places"}},{label:"ETS2",value:{map:"europe",search:"achievements"}}],PE=(t,e)=>U1.find(r=>r.value.map===t&&r.value.search===e)??xr(U1.find(r=>r.value.map)),ub=({selected:t,onSelect:e})=>oe.jsx(CZ,{sx:{paddingBlock:0,minWidth:"fit-content"},variant:"plain",size:"sm",slotProps:{listbox:{placement:"bottom-start"}},value:t,onChange:(n,r)=>{n!=null&&e(xr(U1.find(o=>o.value===r)))},renderValue:n=>{if(n)return oe.jsxs(Ya,{direction:"row",gap:1,sx:{alignItems:"center"},children:[oe.jsx(Fi,{level:"body-xs",fontWeight:"lg",children:n.value.map==="usa"?"ATS":"ETS2"}),oe.jsx(fz,{search:n.value.search})]})},children:Object.entries(Gce(U1,({label:n})=>n)).map(([n,r])=>oe.jsxs(Ew,{children:[oe.jsx(gp,{children:oe.jsx(Fi,{level:"body-xs",fontWeight:"lg",children:n})}),r?.map(o=>oe.jsxs(dZ,{value:o.value,sx:{px:"1em",textTransform:"capitalize"},children:[oe.jsx(fz,{search:o.value.search}),o.value.search]},o.value.search))]},n))}),fz=({search:t})=>{switch(t){case"achievements":return oe.jsx(wne,{});case"places":return oe.jsx(Ane,{});default:throw new Su(t)}},r1={usa:{longitude:-108,latitude:39},europe:{longitude:12,latitude:51}},Wce=t=>{const e=H.useRef(null);kc(()=>({onAdd:()=>xr(e.current),onRemove:()=>xr(e.current).remove()}),{position:"top-left"});const{current:n}=Y_(),[r,o]=H.useState(PE(localStorage.getItem("tm-map")==="europe"?"europe":"usa",Xce(localStorage.getItem("tm-search")))),l=D0.useCallback(T=>{if(T==null||(o(T),localStorage.setItem("tm-map",T.value.map),localStorage.setItem("tm-search",T.value.search),!n||T.value.map===r.value.map))return;const{longitude:R,latitude:z}=r1[T.value.map];n.easeTo({zoom:4,center:[R,z]})},[n,r]);H.useEffect(()=>{if(!n)return;const T=()=>{const R=n.getCenter().lng,z=pz(R,r1.usa.longitude),I=pz(R,r1.europe.longitude);z<I&&r.value.map!=="usa"?(o(PE("usa",r.value.search)),localStorage.setItem("tm-map","usa")):I<z&&r.value.map!=="europe"&&(o(PE("europe",r.value.search)),localStorage.setItem("tm-map","europe"))};return n.on("moveend",T),()=>void n.off("moveend",T)},[n,r,o]);const c=D0.useCallback(T=>{n==null||T==null||(n.flyTo({curve:1,zoom:10.5,center:T.poi.geometry.coordinates}),n.once("moveend",R=>{const{lat:z,lng:I}=R.target.getCenter(),L=R.target.getZoom(),V=Number(R.target.getBearing().toFixed(1)),B=Math.round(R.target.getPitch());B?window.location.hash=`${L}/${z.toFixed(3)}/${I.toFixed(3)}/${V}/${B}`:V?window.location.hash=`${L}/${z.toFixed(3)}/${I.toFixed(3)}/${V}`:window.location.hash=`${L}/${z.toFixed(3)}/${I.toFixed(3)}`}))},[n]),[s,m]=H.useState([]),y=T=>D0.useCallback((R,z={enableFitBounds:!0})=>{if(s.forEach(V=>V.remove()),T(R),n==null||R==null)return;const I=Z_(t.visibleStateDlcs),L=R.features.filter(V=>I.has(V.dlcGuard)).map(({coordinates:V})=>new Hw.Marker().setLngLat(V).addTo(n.getMap()));if(m(L),L.length&&z.enableFitBounds){const V=nN(L.map(X=>X.getLngLat().toArray())),B=[V[0],V[1]],W=[V[2],V[3]];n.fitBounds([B,W],{curve:1,padding:100,maxZoom:9})}},[n,s,T,m,t.visibleStateDlcs]),[b,w]=H.useState(null),E=y(w);return H.useEffect(()=>{E(b,{enableFitBounds:!1})},[b,t.visibleStateDlcs]),oe.jsx("div",{ref:e,className:"maplibregl-ctrl",style:{width:"calc(100svw - 64px)"},children:oe.jsx(Ya,{direction:"row",gap:1,children:oe.jsx(qce,{selected:r.value,onMapSelect:l,onPlaceSelect:c,onAchievementSelect:E,visibleStates:t.visibleStates,visibleStateDlcs:t.visibleStateDlcs})})})},qce=({selected:t,onMapSelect:e,onPlaceSelect:n,onAchievementSelect:r,visibleStateDlcs:o})=>{switch(t.map){case"usa":switch(t.search){case"places":return oe.jsx(KL,{selectDecorator:oe.jsx(ub,{selected:t,onSelect:e}),map:t.map,onSelect:n,visibleStateDlcs:o});case"achievements":return oe.jsx(HL,{selectDecorator:oe.jsx(ub,{selected:t,onSelect:e}),map:t.map,onSelect:r,visibleStateDlcs:o});default:throw new Su(t.search)}case"europe":switch(t.search){case"places":return oe.jsx(KL,{selectDecorator:oe.jsx(ub,{selected:t,onSelect:e}),map:t.map,onSelect:n});case"achievements":return oe.jsx(HL,{selectDecorator:oe.jsx(ub,{selected:t,onSelect:e}),map:t.map,onSelect:r});default:throw new Su(t.search)}}};function Xce(t){return t==="achievements"?t:"places"}function pz(t,e){const n=gL(t)/2,r=gL(e)/2;return Math.abs(Math.sin(n)-Math.sin(r))}const Zce=t=>{const e=H.useRef(null),[n,r]=H.useState(!1);kc(()=>({onAdd:()=>xr(e.current),onRemove:()=>xr(e.current).remove()}));const o=H.useCallback(()=>{r(!n),t.onToggle(!n)},[n]);return oe.jsx("div",{ref:e,className:"maplibregl-ctrl maplibregl-ctrl-group",style:{display:t.visible?"":"none"},children:oe.jsx(Ah,{slots:{root:Ah},sx:{minWidth:0,minHeight:0,borderRadius:0,backgroundColor:n?"var(--joy-palette-primary-softHoverBg) !important":void 0},variant:n?"soft":"plain",title:"Browse Photo Spheres",onClick:o,children:oe.jsx(eN,{})})})},AE=(t,e)=>{const n=Math.pow(10,e);return Math.round(t*n)/n},Yce=()=>{const t=H.useRef(null),[e,n]=H.useState(!1),[r,o]=H.useState(!1),[l,c]=H.useState(window.location.origin),s=Y_();return kc(()=>({onAdd:()=>xr(t.current),onRemove:()=>xr(t.current).remove()})),H.useEffect(()=>{const m=s.current;if(!m||!e)return;const y=()=>{const E=m.getCenter(),T=m.getBearing(),R=m.getPitch(),z=T||R?[T,R]:[],I=m.getZoom(),L=b?"?"+new URLSearchParams({mlat:String(AE(b.getLngLat().lat,2)),mlon:String(AE(b.getLngLat().lng,2))}).toString():"",V="#"+[I,E.lat,E.lng,...z].map(B=>AE(B,2)).join("/");c(window.location.origin+L+V)};let b,w;if(r){b=new Hw.Marker,b.setLngLat(m.getCenter()).setDraggable(!0).addTo(m.getMap());let E=!0;w=()=>E&&b.setLngLat(m.getCenter()),b.on("dragend",()=>{E=!1,m.easeTo({center:b?.getLngLat()}),m.once("moveend",()=>E=!0)})}return y(),m.on("moveend",y),w&&m.on("move",w),()=>{m.off("moveend",y),w&&m.off("move",w),b?.remove()}},[s,e,r]),oe.jsxs("div",{ref:t,children:[oe.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:oe.jsx(Ah,{sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Share",onClick:()=>n(!e),children:oe.jsx(Cne,{})})}),oe.jsx(D4,{open:e,anchor:"right",onClose:()=>n(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",right:e?48:0}}},children:oe.jsxs(O4,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,overflow:"auto"},children:[oe.jsx(P4,{children:"Share"}),oe.jsx(z4,{}),oe.jsx(Rw,{}),oe.jsxs(T4,{sx:{gap:2,overflow:"hidden",flexGrow:1,justifyContent:"center"},children:[oe.jsx(Fi,{children:"Share a link to this map"}),oe.jsx(BW,{readOnly:!0,sx:{"--Input-decoratorChildHeight":"36px"},onFocus:m=>m.target.select(),value:l,endDecorator:oe.jsx(S4,{sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:()=>void navigator.clipboard.writeText(l).catch(()=>alert("Could not copy to clipboard 🙁")),children:"Copy"})}),oe.jsx(Bm,{label:"Include marker",checked:r,onChange:m=>o(m.target.checked)})]})]})})]})};function hB(t){return new Set([...t].map(Kce).concat(fs.CA))}function Kce(t){switch(t){case Ts.Arizona:return fs.AZ;case Ts.Arkansas:return fs.AR;case Ts.Colorado:return fs.CO;case Ts.Idaho:return fs.ID;case Ts.Iowa:return fs.IA;case Ts.Kansas:return fs.KS;case Ts.Missouri:return fs.MO;case Ts.Montana:return fs.MT;case Ts.Nebraska:return fs.NE;case Ts.Nevada:return fs.NV;case Ts.NewMexico:return fs.NM;case Ts.Oklahoma:return fs.OK;case Ts.Oregon:return fs.OR;case Ts.Texas:return fs.TX;case Ts.Utah:return fs.UT;case Ts.Washington:return fs.WA;case Ts.Wyoming:return fs.WY;default:throw new Su(t)}}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const DA="175",Jce=0,mz=1,Qce=2,dB=1,eue=2,Od=3,up=0,tl=1,Nd=2,Jf=0,Bv=1,gz=2,vz=3,yz=4,tue=5,Pm=100,nue=101,rue=102,iue=103,oue=104,sue=200,aue=201,lue=202,cue=203,Z2=204,Y2=205,uue=206,hue=207,due=208,fue=209,pue=210,mue=211,gue=212,vue=213,yue=214,K2=0,J2=1,Q2=2,ty=3,eT=4,tT=5,nT=6,rT=7,fB=0,_ue=1,xue=2,Qf=0,pB=1,bue=2,wue=3,Sue=4,Mue=5,Cue=6,Eue=7,mB=300,ny=301,ry=302,iT=303,oT=304,Kw=306,sT=1e3,Dm=1001,aT=1002,bu=1003,Tue=1004,hb=1005,$l=1006,IE=1007,Zf=1008,Xd=1009,gB=1010,vB=1011,b_=1012,kA=1013,Hm=1014,Bd=1015,ax=1016,zA=1017,OA=1018,w_=1020,yB=35902,_B=1021,xB=1022,_u=1023,bB=1024,wB=1025,S_=1026,M_=1027,SB=1028,FA=1029,MB=1030,NA=1031,BA=1033,i1=33776,o1=33777,s1=33778,a1=33779,lT=35840,cT=35841,uT=35842,hT=35843,dT=36196,fT=37492,pT=37496,mT=37808,gT=37809,vT=37810,yT=37811,_T=37812,xT=37813,bT=37814,wT=37815,ST=37816,MT=37817,CT=37818,ET=37819,TT=37820,PT=37821,l1=36492,AT=36494,IT=36495,CB=36283,RT=36284,LT=36285,DT=36286,Pue=3200,Aue=3201,Iue=0,Rue=1,qf="",Cc="srgb",Gm="srgb-linear",$1="linear",Ri="srgb",Kg=7680,_z=519,Lue=512,Due=513,kue=514,EB=515,zue=516,Oue=517,Fue=518,Nue=519,xz=35044,bz="300 es",Ud=2e3,V1=2001;class dy{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){const r=this._listeners;if(r===void 0)return;const o=r[e];if(o!==void 0){const l=o.indexOf(n);l!==-1&&o.splice(l,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const r=n[e.type];if(r!==void 0){e.target=this;const o=r.slice(0);for(let l=0,c=o.length;l<c;l++)o[l].call(this,e);e.target=null}}}const oa=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let wz=1234567;const W0=Math.PI/180,C_=180/Math.PI;function fy(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(oa[t&255]+oa[t>>8&255]+oa[t>>16&255]+oa[t>>24&255]+"-"+oa[e&255]+oa[e>>8&255]+"-"+oa[e>>16&15|64]+oa[e>>24&255]+"-"+oa[n&63|128]+oa[n>>8&255]+"-"+oa[n>>16&255]+oa[n>>24&255]+oa[r&255]+oa[r>>8&255]+oa[r>>16&255]+oa[r>>24&255]).toLowerCase()}function Qr(t,e,n){return Math.max(e,Math.min(n,t))}function UA(t,e){return(t%e+e)%e}function Bue(t,e,n,r,o){return r+(t-e)*(o-r)/(n-e)}function Uue(t,e,n){return t!==e?(n-t)/(e-t):0}function q0(t,e,n){return(1-n)*t+n*e}function $ue(t,e,n,r){return q0(t,e,1-Math.exp(-n*r))}function Vue(t,e=1){return e-Math.abs(UA(t,e*2)-e)}function jue(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function Hue(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function Gue(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Wue(t,e){return t+Math.random()*(e-t)}function que(t){return t*(.5-Math.random())}function Xue(t){t!==void 0&&(wz=t);let e=wz+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Zue(t){return t*W0}function Yue(t){return t*C_}function Kue(t){return(t&t-1)===0&&t!==0}function Jue(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Que(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function ehe(t,e,n,r,o){const l=Math.cos,c=Math.sin,s=l(n/2),m=c(n/2),y=l((e+r)/2),b=c((e+r)/2),w=l((e-r)/2),E=c((e-r)/2),T=l((r-e)/2),R=c((r-e)/2);switch(o){case"XYX":t.set(s*b,m*w,m*E,s*y);break;case"YZY":t.set(m*E,s*b,m*w,s*y);break;case"ZXZ":t.set(m*w,m*E,s*b,s*y);break;case"XZX":t.set(s*b,m*R,m*T,s*y);break;case"YXY":t.set(m*T,s*b,m*R,s*y);break;case"ZYZ":t.set(m*R,m*T,s*b,s*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}function vv(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Sa(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const Gr={DEG2RAD:W0,RAD2DEG:C_,generateUUID:fy,clamp:Qr,euclideanModulo:UA,mapLinear:Bue,inverseLerp:Uue,lerp:q0,damp:$ue,pingpong:Vue,smoothstep:jue,smootherstep:Hue,randInt:Gue,randFloat:Wue,randFloatSpread:que,seededRandom:Xue,degToRad:Zue,radToDeg:Yue,isPowerOfTwo:Kue,ceilPowerOfTwo:Jue,floorPowerOfTwo:Que,setQuaternionFromProperEuler:ehe,normalize:Sa,denormalize:vv};class mi{constructor(e=0,n=0){mi.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,o=e.elements;return this.x=o[0]*n+o[3]*r+o[6],this.y=o[1]*n+o[4]*r+o[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Qr(this.x,e.x,n.x),this.y=Qr(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Qr(this.x,e,n),this.y=Qr(this.y,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Qr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Qr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),o=Math.sin(n),l=this.x-e.x,c=this.y-e.y;return this.x=l*r-c*o+e.x,this.y=l*o+c*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class zr{constructor(e,n,r,o,l,c,s,m,y){zr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,o,l,c,s,m,y)}set(e,n,r,o,l,c,s,m,y){const b=this.elements;return b[0]=e,b[1]=o,b[2]=s,b[3]=n,b[4]=l,b[5]=m,b[6]=r,b[7]=c,b[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,o=n.elements,l=this.elements,c=r[0],s=r[3],m=r[6],y=r[1],b=r[4],w=r[7],E=r[2],T=r[5],R=r[8],z=o[0],I=o[3],L=o[6],V=o[1],B=o[4],W=o[7],X=o[2],q=o[5],te=o[8];return l[0]=c*z+s*V+m*X,l[3]=c*I+s*B+m*q,l[6]=c*L+s*W+m*te,l[1]=y*z+b*V+w*X,l[4]=y*I+b*B+w*q,l[7]=y*L+b*W+w*te,l[2]=E*z+T*V+R*X,l[5]=E*I+T*B+R*q,l[8]=E*L+T*W+R*te,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],o=e[2],l=e[3],c=e[4],s=e[5],m=e[6],y=e[7],b=e[8];return n*c*b-n*s*y-r*l*b+r*s*m+o*l*y-o*c*m}invert(){const e=this.elements,n=e[0],r=e[1],o=e[2],l=e[3],c=e[4],s=e[5],m=e[6],y=e[7],b=e[8],w=b*c-s*y,E=s*m-b*l,T=y*l-c*m,R=n*w+r*E+o*T;if(R===0)return this.set(0,0,0,0,0,0,0,0,0);const z=1/R;return e[0]=w*z,e[1]=(o*y-b*r)*z,e[2]=(s*r-o*c)*z,e[3]=E*z,e[4]=(b*n-o*m)*z,e[5]=(o*l-s*n)*z,e[6]=T*z,e[7]=(r*m-y*n)*z,e[8]=(c*n-r*l)*z,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,o,l,c,s){const m=Math.cos(l),y=Math.sin(l);return this.set(r*m,r*y,-r*(m*c+y*s)+c+e,-o*y,o*m,-o*(-y*c+m*s)+s+n,0,0,1),this}scale(e,n){return this.premultiply(RE.makeScale(e,n)),this}rotate(e){return this.premultiply(RE.makeRotation(-e)),this}translate(e,n){return this.premultiply(RE.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let o=0;o<9;o++)if(n[o]!==r[o])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const RE=new zr;function TB(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function j1(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function the(){const t=j1("canvas");return t.style.display="block",t}const Sz={};function c1(t){t in Sz||(Sz[t]=!0,console.warn(t))}function nhe(t,e,n){return new Promise(function(r,o){function l(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:o();break;case t.TIMEOUT_EXPIRED:setTimeout(l,n);break;default:r()}}setTimeout(l,n)})}function rhe(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function ihe(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const Mz=new zr().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Cz=new zr().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function ohe(){const t={enabled:!0,workingColorSpace:Gm,spaces:{},convert:function(o,l,c){return this.enabled===!1||l===c||!l||!c||(this.spaces[l].transfer===Ri&&(o.r=$d(o.r),o.g=$d(o.g),o.b=$d(o.b)),this.spaces[l].primaries!==this.spaces[c].primaries&&(o.applyMatrix3(this.spaces[l].toXYZ),o.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===Ri&&(o.r=Uv(o.r),o.g=Uv(o.g),o.b=Uv(o.b))),o},fromWorkingColorSpace:function(o,l){return this.convert(o,this.workingColorSpace,l)},toWorkingColorSpace:function(o,l){return this.convert(o,l,this.workingColorSpace)},getPrimaries:function(o){return this.spaces[o].primaries},getTransfer:function(o){return o===qf?$1:this.spaces[o].transfer},getLuminanceCoefficients:function(o,l=this.workingColorSpace){return o.fromArray(this.spaces[l].luminanceCoefficients)},define:function(o){Object.assign(this.spaces,o)},_getMatrix:function(o,l,c){return o.copy(this.spaces[l].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(o){return this.spaces[o].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(o=this.workingColorSpace){return this.spaces[o].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return t.define({[Gm]:{primaries:e,whitePoint:r,transfer:$1,toXYZ:Mz,fromXYZ:Cz,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Cc},outputColorSpaceConfig:{drawingBufferColorSpace:Cc}},[Cc]:{primaries:e,whitePoint:r,transfer:Ri,toXYZ:Mz,fromXYZ:Cz,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Cc}}}),t}const li=ohe();function $d(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Uv(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let Jg;class she{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{Jg===void 0&&(Jg=j1("canvas")),Jg.width=e.width,Jg.height=e.height;const o=Jg.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),r=Jg}return r.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=j1("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const o=r.getImageData(0,0,e.width,e.height),l=o.data;for(let c=0;c<l.length;c++)l[c]=$d(l[c]/255)*255;return r.putImageData(o,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor($d(n[r]/255)*255):n[r]=$d(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let ahe=0;class $A{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ahe++}),this.uuid=fy(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},o=this.data;if(o!==null){let l;if(Array.isArray(o)){l=[];for(let c=0,s=o.length;c<s;c++)o[c].isDataTexture?l.push(LE(o[c].image)):l.push(LE(o[c]))}else l=LE(o);r.url=l}return n||(e.images[this.uuid]=r),r}}function LE(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?she.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let lhe=0;class Xs extends dy{constructor(e=Xs.DEFAULT_IMAGE,n=Xs.DEFAULT_MAPPING,r=Dm,o=Dm,l=$l,c=Zf,s=_u,m=Xd,y=Xs.DEFAULT_ANISOTROPY,b=qf){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:lhe++}),this.uuid=fy(),this.name="",this.source=new $A(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=o,this.magFilter=l,this.minFilter=c,this.anisotropy=y,this.format=s,this.internalFormat=null,this.type=m,this.offset=new mi(0,0),this.repeat=new mi(1,1),this.center=new mi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=b,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==mB)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case sT:e.x=e.x-Math.floor(e.x);break;case Dm:e.x=e.x<0?0:1;break;case aT:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case sT:e.y=e.y-Math.floor(e.y);break;case Dm:e.y=e.y<0?0:1;break;case aT:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Xs.DEFAULT_IMAGE=null;Xs.DEFAULT_MAPPING=mB;Xs.DEFAULT_ANISOTROPY=1;class ko{constructor(e=0,n=0,r=0,o=1){ko.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=o}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,o){return this.x=e,this.y=n,this.z=r,this.w=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,o=this.z,l=this.w,c=e.elements;return this.x=c[0]*n+c[4]*r+c[8]*o+c[12]*l,this.y=c[1]*n+c[5]*r+c[9]*o+c[13]*l,this.z=c[2]*n+c[6]*r+c[10]*o+c[14]*l,this.w=c[3]*n+c[7]*r+c[11]*o+c[15]*l,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,o,l;const m=e.elements,y=m[0],b=m[4],w=m[8],E=m[1],T=m[5],R=m[9],z=m[2],I=m[6],L=m[10];if(Math.abs(b-E)<.01&&Math.abs(w-z)<.01&&Math.abs(R-I)<.01){if(Math.abs(b+E)<.1&&Math.abs(w+z)<.1&&Math.abs(R+I)<.1&&Math.abs(y+T+L-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const B=(y+1)/2,W=(T+1)/2,X=(L+1)/2,q=(b+E)/4,te=(w+z)/4,se=(R+I)/4;return B>W&&B>X?B<.01?(r=0,o=.707106781,l=.707106781):(r=Math.sqrt(B),o=q/r,l=te/r):W>X?W<.01?(r=.707106781,o=0,l=.707106781):(o=Math.sqrt(W),r=q/o,l=se/o):X<.01?(r=.707106781,o=.707106781,l=0):(l=Math.sqrt(X),r=te/l,o=se/l),this.set(r,o,l,n),this}let V=Math.sqrt((I-R)*(I-R)+(w-z)*(w-z)+(E-b)*(E-b));return Math.abs(V)<.001&&(V=1),this.x=(I-R)/V,this.y=(w-z)/V,this.z=(E-b)/V,this.w=Math.acos((y+T+L-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Qr(this.x,e.x,n.x),this.y=Qr(this.y,e.y,n.y),this.z=Qr(this.z,e.z,n.z),this.w=Qr(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Qr(this.x,e,n),this.y=Qr(this.y,e,n),this.z=Qr(this.z,e,n),this.w=Qr(this.w,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Qr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class che extends dy{constructor(e=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new ko(0,0,e,n),this.scissorTest=!1,this.viewport=new ko(0,0,e,n);const o={width:e,height:n,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:$l,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const l=new Xs(o,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);l.flipY=!1,l.generateMipmaps=r.generateMipmaps,l.internalFormat=r.internalFormat,this.textures=[];const c=r.count;for(let s=0;s<c;s++)this.textures[s]=l.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,r=1){if(this.width!==e||this.height!==n||this.depth!==r){this.width=e,this.height=n,this.depth=r;for(let o=0,l=this.textures.length;o<l;o++)this.textures[o].image.width=e,this.textures[o].image.height=n,this.textures[o].image.depth=r;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const o=Object.assign({},e.textures[n].image);this.textures[n].source=new $A(o)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class hp extends che{constructor(e=1,n=1,r={}){super(e,n,r),this.isWebGLRenderTarget=!0}}class PB extends Xs{constructor(e=null,n=1,r=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:o},this.magFilter=bu,this.minFilter=bu,this.wrapR=Dm,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class uhe extends Xs{constructor(e=null,n=1,r=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:o},this.magFilter=bu,this.minFilter=bu,this.wrapR=Dm,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Sp{constructor(e=0,n=0,r=0,o=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=o}static slerpFlat(e,n,r,o,l,c,s){let m=r[o+0],y=r[o+1],b=r[o+2],w=r[o+3];const E=l[c+0],T=l[c+1],R=l[c+2],z=l[c+3];if(s===0){e[n+0]=m,e[n+1]=y,e[n+2]=b,e[n+3]=w;return}if(s===1){e[n+0]=E,e[n+1]=T,e[n+2]=R,e[n+3]=z;return}if(w!==z||m!==E||y!==T||b!==R){let I=1-s;const L=m*E+y*T+b*R+w*z,V=L>=0?1:-1,B=1-L*L;if(B>Number.EPSILON){const X=Math.sqrt(B),q=Math.atan2(X,L*V);I=Math.sin(I*q)/X,s=Math.sin(s*q)/X}const W=s*V;if(m=m*I+E*W,y=y*I+T*W,b=b*I+R*W,w=w*I+z*W,I===1-s){const X=1/Math.sqrt(m*m+y*y+b*b+w*w);m*=X,y*=X,b*=X,w*=X}}e[n]=m,e[n+1]=y,e[n+2]=b,e[n+3]=w}static multiplyQuaternionsFlat(e,n,r,o,l,c){const s=r[o],m=r[o+1],y=r[o+2],b=r[o+3],w=l[c],E=l[c+1],T=l[c+2],R=l[c+3];return e[n]=s*R+b*w+m*T-y*E,e[n+1]=m*R+b*E+y*w-s*T,e[n+2]=y*R+b*T+s*E-m*w,e[n+3]=b*R-s*w-m*E-y*T,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,o){return this._x=e,this._y=n,this._z=r,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,o=e._y,l=e._z,c=e._order,s=Math.cos,m=Math.sin,y=s(r/2),b=s(o/2),w=s(l/2),E=m(r/2),T=m(o/2),R=m(l/2);switch(c){case"XYZ":this._x=E*b*w+y*T*R,this._y=y*T*w-E*b*R,this._z=y*b*R+E*T*w,this._w=y*b*w-E*T*R;break;case"YXZ":this._x=E*b*w+y*T*R,this._y=y*T*w-E*b*R,this._z=y*b*R-E*T*w,this._w=y*b*w+E*T*R;break;case"ZXY":this._x=E*b*w-y*T*R,this._y=y*T*w+E*b*R,this._z=y*b*R+E*T*w,this._w=y*b*w-E*T*R;break;case"ZYX":this._x=E*b*w-y*T*R,this._y=y*T*w+E*b*R,this._z=y*b*R-E*T*w,this._w=y*b*w+E*T*R;break;case"YZX":this._x=E*b*w+y*T*R,this._y=y*T*w+E*b*R,this._z=y*b*R-E*T*w,this._w=y*b*w-E*T*R;break;case"XZY":this._x=E*b*w-y*T*R,this._y=y*T*w-E*b*R,this._z=y*b*R+E*T*w,this._w=y*b*w+E*T*R;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,o=Math.sin(r);return this._x=e.x*o,this._y=e.y*o,this._z=e.z*o,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],o=n[4],l=n[8],c=n[1],s=n[5],m=n[9],y=n[2],b=n[6],w=n[10],E=r+s+w;if(E>0){const T=.5/Math.sqrt(E+1);this._w=.25/T,this._x=(b-m)*T,this._y=(l-y)*T,this._z=(c-o)*T}else if(r>s&&r>w){const T=2*Math.sqrt(1+r-s-w);this._w=(b-m)/T,this._x=.25*T,this._y=(o+c)/T,this._z=(l+y)/T}else if(s>w){const T=2*Math.sqrt(1+s-r-w);this._w=(l-y)/T,this._x=(o+c)/T,this._y=.25*T,this._z=(m+b)/T}else{const T=2*Math.sqrt(1+w-r-s);this._w=(c-o)/T,this._x=(l+y)/T,this._y=(m+b)/T,this._z=.25*T}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Qr(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const o=Math.min(1,n/r);return this.slerp(e,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,o=e._y,l=e._z,c=e._w,s=n._x,m=n._y,y=n._z,b=n._w;return this._x=r*b+c*s+o*y-l*m,this._y=o*b+c*m+l*s-r*y,this._z=l*b+c*y+r*m-o*s,this._w=c*b-r*s-o*m-l*y,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,o=this._y,l=this._z,c=this._w;let s=c*e._w+r*e._x+o*e._y+l*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=c,this._x=r,this._y=o,this._z=l,this;const m=1-s*s;if(m<=Number.EPSILON){const T=1-n;return this._w=T*c+n*this._w,this._x=T*r+n*this._x,this._y=T*o+n*this._y,this._z=T*l+n*this._z,this.normalize(),this}const y=Math.sqrt(m),b=Math.atan2(y,s),w=Math.sin((1-n)*b)/y,E=Math.sin(n*b)/y;return this._w=c*w+this._w*E,this._x=r*w+this._x*E,this._y=o*w+this._y*E,this._z=l*w+this._z*E,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),o=Math.sqrt(1-r),l=Math.sqrt(r);return this.set(o*Math.sin(e),o*Math.cos(e),l*Math.sin(n),l*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Pt{constructor(e=0,n=0,r=0){Pt.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(Ez.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(Ez.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,o=this.z,l=e.elements;return this.x=l[0]*n+l[3]*r+l[6]*o,this.y=l[1]*n+l[4]*r+l[7]*o,this.z=l[2]*n+l[5]*r+l[8]*o,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,o=this.z,l=e.elements,c=1/(l[3]*n+l[7]*r+l[11]*o+l[15]);return this.x=(l[0]*n+l[4]*r+l[8]*o+l[12])*c,this.y=(l[1]*n+l[5]*r+l[9]*o+l[13])*c,this.z=(l[2]*n+l[6]*r+l[10]*o+l[14])*c,this}applyQuaternion(e){const n=this.x,r=this.y,o=this.z,l=e.x,c=e.y,s=e.z,m=e.w,y=2*(c*o-s*r),b=2*(s*n-l*o),w=2*(l*r-c*n);return this.x=n+m*y+c*w-s*b,this.y=r+m*b+s*y-l*w,this.z=o+m*w+l*b-c*y,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,o=this.z,l=e.elements;return this.x=l[0]*n+l[4]*r+l[8]*o,this.y=l[1]*n+l[5]*r+l[9]*o,this.z=l[2]*n+l[6]*r+l[10]*o,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Qr(this.x,e.x,n.x),this.y=Qr(this.y,e.y,n.y),this.z=Qr(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Qr(this.x,e,n),this.y=Qr(this.y,e,n),this.z=Qr(this.z,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Qr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,o=e.y,l=e.z,c=n.x,s=n.y,m=n.z;return this.x=o*m-l*s,this.y=l*c-r*m,this.z=r*s-o*c,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return DE.copy(this).projectOnVector(e),this.sub(DE)}reflect(e){return this.sub(DE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Qr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,o=this.z-e.z;return n*n+r*r+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const o=Math.sin(n)*e;return this.x=o*Math.sin(r),this.y=Math.cos(n)*e,this.z=o*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),o=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=o,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(e),this.y=n,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const DE=new Pt,Ez=new Sp;class py{constructor(e=new Pt(1/0,1/0,1/0),n=new Pt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(du.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(du.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=du.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const l=r.getAttribute("position");if(n===!0&&l!==void 0&&e.isInstancedMesh!==!0)for(let c=0,s=l.count;c<s;c++)e.isMesh===!0?e.getVertexPosition(c,du):du.fromBufferAttribute(l,c),du.applyMatrix4(e.matrixWorld),this.expandByPoint(du);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),db.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),db.copy(r.boundingBox)),db.applyMatrix4(e.matrixWorld),this.union(db)}const o=e.children;for(let l=0,c=o.length;l<c;l++)this.expandByObject(o[l],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,du),du.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(f0),fb.subVectors(this.max,f0),Qg.subVectors(e.a,f0),ev.subVectors(e.b,f0),tv.subVectors(e.c,f0),Of.subVectors(ev,Qg),Ff.subVectors(tv,ev),gm.subVectors(Qg,tv);let n=[0,-Of.z,Of.y,0,-Ff.z,Ff.y,0,-gm.z,gm.y,Of.z,0,-Of.x,Ff.z,0,-Ff.x,gm.z,0,-gm.x,-Of.y,Of.x,0,-Ff.y,Ff.x,0,-gm.y,gm.x,0];return!kE(n,Qg,ev,tv,fb)||(n=[1,0,0,0,1,0,0,0,1],!kE(n,Qg,ev,tv,fb))?!1:(pb.crossVectors(Of,Ff),n=[pb.x,pb.y,pb.z],kE(n,Qg,ev,tv,fb))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,du).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(du).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Rd[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Rd[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Rd[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Rd[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Rd[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Rd[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Rd[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Rd[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Rd),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Rd=[new Pt,new Pt,new Pt,new Pt,new Pt,new Pt,new Pt,new Pt],du=new Pt,db=new py,Qg=new Pt,ev=new Pt,tv=new Pt,Of=new Pt,Ff=new Pt,gm=new Pt,f0=new Pt,fb=new Pt,pb=new Pt,vm=new Pt;function kE(t,e,n,r,o){for(let l=0,c=t.length-3;l<=c;l+=3){vm.fromArray(t,l);const s=o.x*Math.abs(vm.x)+o.y*Math.abs(vm.y)+o.z*Math.abs(vm.z),m=e.dot(vm),y=n.dot(vm),b=r.dot(vm);if(Math.max(-Math.max(m,y,b),Math.min(m,y,b))>s)return!1}return!0}const hhe=new py,p0=new Pt,zE=new Pt;class Jw{constructor(e=new Pt,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):hhe.setFromPoints(e).getCenter(r);let o=0;for(let l=0,c=e.length;l<c;l++)o=Math.max(o,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(o),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;p0.subVectors(e,this.center);const n=p0.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),o=(r-this.radius)*.5;this.center.addScaledVector(p0,o/r),this.radius+=o}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(zE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(p0.copy(e.center).add(zE)),this.expandByPoint(p0.copy(e.center).sub(zE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ld=new Pt,OE=new Pt,mb=new Pt,Nf=new Pt,FE=new Pt,gb=new Pt,NE=new Pt;class VA{constructor(e=new Pt,n=new Pt(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ld)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Ld.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Ld.copy(this.origin).addScaledVector(this.direction,n),Ld.distanceToSquared(e))}distanceSqToSegment(e,n,r,o){OE.copy(e).add(n).multiplyScalar(.5),mb.copy(n).sub(e).normalize(),Nf.copy(this.origin).sub(OE);const l=e.distanceTo(n)*.5,c=-this.direction.dot(mb),s=Nf.dot(this.direction),m=-Nf.dot(mb),y=Nf.lengthSq(),b=Math.abs(1-c*c);let w,E,T,R;if(b>0)if(w=c*m-s,E=c*s-m,R=l*b,w>=0)if(E>=-R)if(E<=R){const z=1/b;w*=z,E*=z,T=w*(w+c*E+2*s)+E*(c*w+E+2*m)+y}else E=l,w=Math.max(0,-(c*E+s)),T=-w*w+E*(E+2*m)+y;else E=-l,w=Math.max(0,-(c*E+s)),T=-w*w+E*(E+2*m)+y;else E<=-R?(w=Math.max(0,-(-c*l+s)),E=w>0?-l:Math.min(Math.max(-l,-m),l),T=-w*w+E*(E+2*m)+y):E<=R?(w=0,E=Math.min(Math.max(-l,-m),l),T=E*(E+2*m)+y):(w=Math.max(0,-(c*l+s)),E=w>0?l:Math.min(Math.max(-l,-m),l),T=-w*w+E*(E+2*m)+y);else E=c>0?-l:l,w=Math.max(0,-(c*E+s)),T=-w*w+E*(E+2*m)+y;return r&&r.copy(this.origin).addScaledVector(this.direction,w),o&&o.copy(OE).addScaledVector(mb,E),T}intersectSphere(e,n){Ld.subVectors(e.center,this.origin);const r=Ld.dot(this.direction),o=Ld.dot(Ld)-r*r,l=e.radius*e.radius;if(o>l)return null;const c=Math.sqrt(l-o),s=r-c,m=r+c;return m<0?null:s<0?this.at(m,n):this.at(s,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,o,l,c,s,m;const y=1/this.direction.x,b=1/this.direction.y,w=1/this.direction.z,E=this.origin;return y>=0?(r=(e.min.x-E.x)*y,o=(e.max.x-E.x)*y):(r=(e.max.x-E.x)*y,o=(e.min.x-E.x)*y),b>=0?(l=(e.min.y-E.y)*b,c=(e.max.y-E.y)*b):(l=(e.max.y-E.y)*b,c=(e.min.y-E.y)*b),r>c||l>o||((l>r||isNaN(r))&&(r=l),(c<o||isNaN(o))&&(o=c),w>=0?(s=(e.min.z-E.z)*w,m=(e.max.z-E.z)*w):(s=(e.max.z-E.z)*w,m=(e.min.z-E.z)*w),r>m||s>o)||((s>r||r!==r)&&(r=s),(m<o||o!==o)&&(o=m),o<0)?null:this.at(r>=0?r:o,n)}intersectsBox(e){return this.intersectBox(e,Ld)!==null}intersectTriangle(e,n,r,o,l){FE.subVectors(n,e),gb.subVectors(r,e),NE.crossVectors(FE,gb);let c=this.direction.dot(NE),s;if(c>0){if(o)return null;s=1}else if(c<0)s=-1,c=-c;else return null;Nf.subVectors(this.origin,e);const m=s*this.direction.dot(gb.crossVectors(Nf,gb));if(m<0)return null;const y=s*this.direction.dot(FE.cross(Nf));if(y<0||m+y>c)return null;const b=-s*Nf.dot(NE);return b<0?null:this.at(b/c,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ti{constructor(e,n,r,o,l,c,s,m,y,b,w,E,T,R,z,I){Ti.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,o,l,c,s,m,y,b,w,E,T,R,z,I)}set(e,n,r,o,l,c,s,m,y,b,w,E,T,R,z,I){const L=this.elements;return L[0]=e,L[4]=n,L[8]=r,L[12]=o,L[1]=l,L[5]=c,L[9]=s,L[13]=m,L[2]=y,L[6]=b,L[10]=w,L[14]=E,L[3]=T,L[7]=R,L[11]=z,L[15]=I,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ti().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,o=1/nv.setFromMatrixColumn(e,0).length(),l=1/nv.setFromMatrixColumn(e,1).length(),c=1/nv.setFromMatrixColumn(e,2).length();return n[0]=r[0]*o,n[1]=r[1]*o,n[2]=r[2]*o,n[3]=0,n[4]=r[4]*l,n[5]=r[5]*l,n[6]=r[6]*l,n[7]=0,n[8]=r[8]*c,n[9]=r[9]*c,n[10]=r[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,o=e.y,l=e.z,c=Math.cos(r),s=Math.sin(r),m=Math.cos(o),y=Math.sin(o),b=Math.cos(l),w=Math.sin(l);if(e.order==="XYZ"){const E=c*b,T=c*w,R=s*b,z=s*w;n[0]=m*b,n[4]=-m*w,n[8]=y,n[1]=T+R*y,n[5]=E-z*y,n[9]=-s*m,n[2]=z-E*y,n[6]=R+T*y,n[10]=c*m}else if(e.order==="YXZ"){const E=m*b,T=m*w,R=y*b,z=y*w;n[0]=E+z*s,n[4]=R*s-T,n[8]=c*y,n[1]=c*w,n[5]=c*b,n[9]=-s,n[2]=T*s-R,n[6]=z+E*s,n[10]=c*m}else if(e.order==="ZXY"){const E=m*b,T=m*w,R=y*b,z=y*w;n[0]=E-z*s,n[4]=-c*w,n[8]=R+T*s,n[1]=T+R*s,n[5]=c*b,n[9]=z-E*s,n[2]=-c*y,n[6]=s,n[10]=c*m}else if(e.order==="ZYX"){const E=c*b,T=c*w,R=s*b,z=s*w;n[0]=m*b,n[4]=R*y-T,n[8]=E*y+z,n[1]=m*w,n[5]=z*y+E,n[9]=T*y-R,n[2]=-y,n[6]=s*m,n[10]=c*m}else if(e.order==="YZX"){const E=c*m,T=c*y,R=s*m,z=s*y;n[0]=m*b,n[4]=z-E*w,n[8]=R*w+T,n[1]=w,n[5]=c*b,n[9]=-s*b,n[2]=-y*b,n[6]=T*w+R,n[10]=E-z*w}else if(e.order==="XZY"){const E=c*m,T=c*y,R=s*m,z=s*y;n[0]=m*b,n[4]=-w,n[8]=y*b,n[1]=E*w+z,n[5]=c*b,n[9]=T*w-R,n[2]=R*w-T,n[6]=s*b,n[10]=z*w+E}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(dhe,e,fhe)}lookAt(e,n,r){const o=this.elements;return Il.subVectors(e,n),Il.lengthSq()===0&&(Il.z=1),Il.normalize(),Bf.crossVectors(r,Il),Bf.lengthSq()===0&&(Math.abs(r.z)===1?Il.x+=1e-4:Il.z+=1e-4,Il.normalize(),Bf.crossVectors(r,Il)),Bf.normalize(),vb.crossVectors(Il,Bf),o[0]=Bf.x,o[4]=vb.x,o[8]=Il.x,o[1]=Bf.y,o[5]=vb.y,o[9]=Il.y,o[2]=Bf.z,o[6]=vb.z,o[10]=Il.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,o=n.elements,l=this.elements,c=r[0],s=r[4],m=r[8],y=r[12],b=r[1],w=r[5],E=r[9],T=r[13],R=r[2],z=r[6],I=r[10],L=r[14],V=r[3],B=r[7],W=r[11],X=r[15],q=o[0],te=o[4],se=o[8],re=o[12],$=o[1],ce=o[5],Ce=o[9],Se=o[13],Xe=o[2],Fe=o[6],Me=o[10],Te=o[14],Ie=o[3],Ke=o[7],st=o[11],Ee=o[15];return l[0]=c*q+s*$+m*Xe+y*Ie,l[4]=c*te+s*ce+m*Fe+y*Ke,l[8]=c*se+s*Ce+m*Me+y*st,l[12]=c*re+s*Se+m*Te+y*Ee,l[1]=b*q+w*$+E*Xe+T*Ie,l[5]=b*te+w*ce+E*Fe+T*Ke,l[9]=b*se+w*Ce+E*Me+T*st,l[13]=b*re+w*Se+E*Te+T*Ee,l[2]=R*q+z*$+I*Xe+L*Ie,l[6]=R*te+z*ce+I*Fe+L*Ke,l[10]=R*se+z*Ce+I*Me+L*st,l[14]=R*re+z*Se+I*Te+L*Ee,l[3]=V*q+B*$+W*Xe+X*Ie,l[7]=V*te+B*ce+W*Fe+X*Ke,l[11]=V*se+B*Ce+W*Me+X*st,l[15]=V*re+B*Se+W*Te+X*Ee,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],o=e[8],l=e[12],c=e[1],s=e[5],m=e[9],y=e[13],b=e[2],w=e[6],E=e[10],T=e[14],R=e[3],z=e[7],I=e[11],L=e[15];return R*(+l*m*w-o*y*w-l*s*E+r*y*E+o*s*T-r*m*T)+z*(+n*m*T-n*y*E+l*c*E-o*c*T+o*y*b-l*m*b)+I*(+n*y*w-n*s*T-l*c*w+r*c*T+l*s*b-r*y*b)+L*(-o*s*b-n*m*w+n*s*E+o*c*w-r*c*E+r*m*b)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const o=this.elements;return e.isVector3?(o[12]=e.x,o[13]=e.y,o[14]=e.z):(o[12]=e,o[13]=n,o[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],o=e[2],l=e[3],c=e[4],s=e[5],m=e[6],y=e[7],b=e[8],w=e[9],E=e[10],T=e[11],R=e[12],z=e[13],I=e[14],L=e[15],V=w*I*y-z*E*y+z*m*T-s*I*T-w*m*L+s*E*L,B=R*E*y-b*I*y-R*m*T+c*I*T+b*m*L-c*E*L,W=b*z*y-R*w*y+R*s*T-c*z*T-b*s*L+c*w*L,X=R*w*m-b*z*m-R*s*E+c*z*E+b*s*I-c*w*I,q=n*V+r*B+o*W+l*X;if(q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const te=1/q;return e[0]=V*te,e[1]=(z*E*l-w*I*l-z*o*T+r*I*T+w*o*L-r*E*L)*te,e[2]=(s*I*l-z*m*l+z*o*y-r*I*y-s*o*L+r*m*L)*te,e[3]=(w*m*l-s*E*l-w*o*y+r*E*y+s*o*T-r*m*T)*te,e[4]=B*te,e[5]=(b*I*l-R*E*l+R*o*T-n*I*T-b*o*L+n*E*L)*te,e[6]=(R*m*l-c*I*l-R*o*y+n*I*y+c*o*L-n*m*L)*te,e[7]=(c*E*l-b*m*l+b*o*y-n*E*y-c*o*T+n*m*T)*te,e[8]=W*te,e[9]=(R*w*l-b*z*l-R*r*T+n*z*T+b*r*L-n*w*L)*te,e[10]=(c*z*l-R*s*l+R*r*y-n*z*y-c*r*L+n*s*L)*te,e[11]=(b*s*l-c*w*l-b*r*y+n*w*y+c*r*T-n*s*T)*te,e[12]=X*te,e[13]=(b*z*o-R*w*o+R*r*E-n*z*E-b*r*I+n*w*I)*te,e[14]=(R*s*o-c*z*o-R*r*m+n*z*m+c*r*I-n*s*I)*te,e[15]=(c*w*o-b*s*o+b*r*m-n*w*m-c*r*E+n*s*E)*te,this}scale(e){const n=this.elements,r=e.x,o=e.y,l=e.z;return n[0]*=r,n[4]*=o,n[8]*=l,n[1]*=r,n[5]*=o,n[9]*=l,n[2]*=r,n[6]*=o,n[10]*=l,n[3]*=r,n[7]*=o,n[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],o=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,o))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),o=Math.sin(n),l=1-r,c=e.x,s=e.y,m=e.z,y=l*c,b=l*s;return this.set(y*c+r,y*s-o*m,y*m+o*s,0,y*s+o*m,b*s+r,b*m-o*c,0,y*m-o*s,b*m+o*c,l*m*m+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,o,l,c){return this.set(1,r,l,0,e,1,c,0,n,o,1,0,0,0,0,1),this}compose(e,n,r){const o=this.elements,l=n._x,c=n._y,s=n._z,m=n._w,y=l+l,b=c+c,w=s+s,E=l*y,T=l*b,R=l*w,z=c*b,I=c*w,L=s*w,V=m*y,B=m*b,W=m*w,X=r.x,q=r.y,te=r.z;return o[0]=(1-(z+L))*X,o[1]=(T+W)*X,o[2]=(R-B)*X,o[3]=0,o[4]=(T-W)*q,o[5]=(1-(E+L))*q,o[6]=(I+V)*q,o[7]=0,o[8]=(R+B)*te,o[9]=(I-V)*te,o[10]=(1-(E+z))*te,o[11]=0,o[12]=e.x,o[13]=e.y,o[14]=e.z,o[15]=1,this}decompose(e,n,r){const o=this.elements;let l=nv.set(o[0],o[1],o[2]).length();const c=nv.set(o[4],o[5],o[6]).length(),s=nv.set(o[8],o[9],o[10]).length();this.determinant()<0&&(l=-l),e.x=o[12],e.y=o[13],e.z=o[14],fu.copy(this);const y=1/l,b=1/c,w=1/s;return fu.elements[0]*=y,fu.elements[1]*=y,fu.elements[2]*=y,fu.elements[4]*=b,fu.elements[5]*=b,fu.elements[6]*=b,fu.elements[8]*=w,fu.elements[9]*=w,fu.elements[10]*=w,n.setFromRotationMatrix(fu),r.x=l,r.y=c,r.z=s,this}makePerspective(e,n,r,o,l,c,s=Ud){const m=this.elements,y=2*l/(n-e),b=2*l/(r-o),w=(n+e)/(n-e),E=(r+o)/(r-o);let T,R;if(s===Ud)T=-(c+l)/(c-l),R=-2*c*l/(c-l);else if(s===V1)T=-c/(c-l),R=-c*l/(c-l);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return m[0]=y,m[4]=0,m[8]=w,m[12]=0,m[1]=0,m[5]=b,m[9]=E,m[13]=0,m[2]=0,m[6]=0,m[10]=T,m[14]=R,m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this}makeOrthographic(e,n,r,o,l,c,s=Ud){const m=this.elements,y=1/(n-e),b=1/(r-o),w=1/(c-l),E=(n+e)*y,T=(r+o)*b;let R,z;if(s===Ud)R=(c+l)*w,z=-2*w;else if(s===V1)R=l*w,z=-1*w;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return m[0]=2*y,m[4]=0,m[8]=0,m[12]=-E,m[1]=0,m[5]=2*b,m[9]=0,m[13]=-T,m[2]=0,m[6]=0,m[10]=z,m[14]=-R,m[3]=0,m[7]=0,m[11]=0,m[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let o=0;o<16;o++)if(n[o]!==r[o])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const nv=new Pt,fu=new Ti,dhe=new Pt(0,0,0),fhe=new Pt(1,1,1),Bf=new Pt,vb=new Pt,Il=new Pt,Tz=new Ti,Pz=new Sp;class Rh{constructor(e=0,n=0,r=0,o=Rh.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,o=this._order){return this._x=e,this._y=n,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const o=e.elements,l=o[0],c=o[4],s=o[8],m=o[1],y=o[5],b=o[9],w=o[2],E=o[6],T=o[10];switch(n){case"XYZ":this._y=Math.asin(Qr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-b,T),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(E,y),this._z=0);break;case"YXZ":this._x=Math.asin(-Qr(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(s,T),this._z=Math.atan2(m,y)):(this._y=Math.atan2(-w,l),this._z=0);break;case"ZXY":this._x=Math.asin(Qr(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(-w,T),this._z=Math.atan2(-c,y)):(this._y=0,this._z=Math.atan2(m,l));break;case"ZYX":this._y=Math.asin(-Qr(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(E,T),this._z=Math.atan2(m,l)):(this._x=0,this._z=Math.atan2(-c,y));break;case"YZX":this._z=Math.asin(Qr(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-b,y),this._y=Math.atan2(-w,l)):(this._x=0,this._y=Math.atan2(s,T));break;case"XZY":this._z=Math.asin(-Qr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(E,y),this._y=Math.atan2(s,l)):(this._x=Math.atan2(-b,T),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return Tz.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Tz,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return Pz.setFromEuler(this),this.setFromQuaternion(Pz,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Rh.DEFAULT_ORDER="XYZ";class jA{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let phe=0;const Az=new Pt,rv=new Sp,Dd=new Ti,yb=new Pt,m0=new Pt,mhe=new Pt,ghe=new Sp,Iz=new Pt(1,0,0),Rz=new Pt(0,1,0),Lz=new Pt(0,0,1),Dz={type:"added"},vhe={type:"removed"},iv={type:"childadded",child:null},BE={type:"childremoved",child:null};class Zs extends dy{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:phe++}),this.uuid=fy(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zs.DEFAULT_UP.clone();const e=new Pt,n=new Rh,r=new Sp,o=new Pt(1,1,1);function l(){r.setFromEuler(n,!1)}function c(){n.setFromQuaternion(r,void 0,!1)}n._onChange(l),r._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Ti},normalMatrix:{value:new zr}}),this.matrix=new Ti,this.matrixWorld=new Ti,this.matrixAutoUpdate=Zs.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Zs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new jA,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return rv.setFromAxisAngle(e,n),this.quaternion.multiply(rv),this}rotateOnWorldAxis(e,n){return rv.setFromAxisAngle(e,n),this.quaternion.premultiply(rv),this}rotateX(e){return this.rotateOnAxis(Iz,e)}rotateY(e){return this.rotateOnAxis(Rz,e)}rotateZ(e){return this.rotateOnAxis(Lz,e)}translateOnAxis(e,n){return Az.copy(e).applyQuaternion(this.quaternion),this.position.add(Az.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(Iz,e)}translateY(e){return this.translateOnAxis(Rz,e)}translateZ(e){return this.translateOnAxis(Lz,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Dd.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?yb.copy(e):yb.set(e,n,r);const o=this.parent;this.updateWorldMatrix(!0,!1),m0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Dd.lookAt(m0,yb,this.up):Dd.lookAt(yb,m0,this.up),this.quaternion.setFromRotationMatrix(Dd),o&&(Dd.extractRotation(o.matrixWorld),rv.setFromRotationMatrix(Dd),this.quaternion.premultiply(rv.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Dz),iv.child=e,this.dispatchEvent(iv),iv.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(vhe),BE.child=e,this.dispatchEvent(BE),BE.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Dd.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Dd.multiply(e.parent.matrixWorld)),e.applyMatrix4(Dd),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Dz),iv.child=e,this.dispatchEvent(iv),iv.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,o=this.children.length;r<o;r++){const c=this.children[r].getObjectByProperty(e,n);if(c!==void 0)return c}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const o=this.children;for(let l=0,c=o.length;l<c;l++)o[l].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(m0,e,mhe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(m0,ghe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].updateMatrixWorld(e)}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const o=this.children;for(let l=0,c=o.length;l<c;l++)o[l].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.visibility=this._visibility,o.active=this._active,o.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),o.maxInstanceCount=this._maxInstanceCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.geometryCount=this._geometryCount,o.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(o.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(o.boundingSphere={center:o.boundingSphere.center.toArray(),radius:o.boundingSphere.radius}),this.boundingBox!==null&&(o.boundingBox={min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}));function l(s,m){return s[m.uuid]===void 0&&(s[m.uuid]=m.toJSON(e)),m.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=l(e.geometries,this.geometry);const s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){const m=s.shapes;if(Array.isArray(m))for(let y=0,b=m.length;y<b;y++){const w=m[y];l(e.shapes,w)}else l(e.shapes,m)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const s=[];for(let m=0,y=this.material.length;m<y;m++)s.push(l(e.materials,this.material[m]));o.material=s}else o.material=l(e.materials,this.material);if(this.children.length>0){o.children=[];for(let s=0;s<this.children.length;s++)o.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let s=0;s<this.animations.length;s++){const m=this.animations[s];o.animations.push(l(e.animations,m))}}if(n){const s=c(e.geometries),m=c(e.materials),y=c(e.textures),b=c(e.images),w=c(e.shapes),E=c(e.skeletons),T=c(e.animations),R=c(e.nodes);s.length>0&&(r.geometries=s),m.length>0&&(r.materials=m),y.length>0&&(r.textures=y),b.length>0&&(r.images=b),w.length>0&&(r.shapes=w),E.length>0&&(r.skeletons=E),T.length>0&&(r.animations=T),R.length>0&&(r.nodes=R)}return r.object=o,r;function c(s){const m=[];for(const y in s){const b=s[y];delete b.metadata,m.push(b)}return m}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const o=e.children[r];this.add(o.clone())}return this}}Zs.DEFAULT_UP=new Pt(0,1,0);Zs.DEFAULT_MATRIX_AUTO_UPDATE=!0;Zs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const pu=new Pt,kd=new Pt,UE=new Pt,zd=new Pt,ov=new Pt,sv=new Pt,kz=new Pt,$E=new Pt,VE=new Pt,jE=new Pt,HE=new ko,GE=new ko,WE=new ko;class vu{constructor(e=new Pt,n=new Pt,r=new Pt){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,o){o.subVectors(r,n),pu.subVectors(e,n),o.cross(pu);const l=o.lengthSq();return l>0?o.multiplyScalar(1/Math.sqrt(l)):o.set(0,0,0)}static getBarycoord(e,n,r,o,l){pu.subVectors(o,n),kd.subVectors(r,n),UE.subVectors(e,n);const c=pu.dot(pu),s=pu.dot(kd),m=pu.dot(UE),y=kd.dot(kd),b=kd.dot(UE),w=c*y-s*s;if(w===0)return l.set(0,0,0),null;const E=1/w,T=(y*m-s*b)*E,R=(c*b-s*m)*E;return l.set(1-T-R,R,T)}static containsPoint(e,n,r,o){return this.getBarycoord(e,n,r,o,zd)===null?!1:zd.x>=0&&zd.y>=0&&zd.x+zd.y<=1}static getInterpolation(e,n,r,o,l,c,s,m){return this.getBarycoord(e,n,r,o,zd)===null?(m.x=0,m.y=0,"z"in m&&(m.z=0),"w"in m&&(m.w=0),null):(m.setScalar(0),m.addScaledVector(l,zd.x),m.addScaledVector(c,zd.y),m.addScaledVector(s,zd.z),m)}static getInterpolatedAttribute(e,n,r,o,l,c){return HE.setScalar(0),GE.setScalar(0),WE.setScalar(0),HE.fromBufferAttribute(e,n),GE.fromBufferAttribute(e,r),WE.fromBufferAttribute(e,o),c.setScalar(0),c.addScaledVector(HE,l.x),c.addScaledVector(GE,l.y),c.addScaledVector(WE,l.z),c}static isFrontFacing(e,n,r,o){return pu.subVectors(r,n),kd.subVectors(e,n),pu.cross(kd).dot(o)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,o){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[o]),this}setFromAttributeAndIndices(e,n,r,o){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return pu.subVectors(this.c,this.b),kd.subVectors(this.a,this.b),pu.cross(kd).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return vu.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return vu.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,r,o,l){return vu.getInterpolation(e,this.a,this.b,this.c,n,r,o,l)}containsPoint(e){return vu.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return vu.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,o=this.b,l=this.c;let c,s;ov.subVectors(o,r),sv.subVectors(l,r),$E.subVectors(e,r);const m=ov.dot($E),y=sv.dot($E);if(m<=0&&y<=0)return n.copy(r);VE.subVectors(e,o);const b=ov.dot(VE),w=sv.dot(VE);if(b>=0&&w<=b)return n.copy(o);const E=m*w-b*y;if(E<=0&&m>=0&&b<=0)return c=m/(m-b),n.copy(r).addScaledVector(ov,c);jE.subVectors(e,l);const T=ov.dot(jE),R=sv.dot(jE);if(R>=0&&T<=R)return n.copy(l);const z=T*y-m*R;if(z<=0&&y>=0&&R<=0)return s=y/(y-R),n.copy(r).addScaledVector(sv,s);const I=b*R-T*w;if(I<=0&&w-b>=0&&T-R>=0)return kz.subVectors(l,o),s=(w-b)/(w-b+(T-R)),n.copy(o).addScaledVector(kz,s);const L=1/(I+z+E);return c=z*L,s=E*L,n.copy(r).addScaledVector(ov,c).addScaledVector(sv,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const AB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Uf={h:0,s:0,l:0},_b={h:0,s:0,l:0};function qE(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class xi{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const o=e;o&&o.isColor?this.copy(o):typeof o=="number"?this.setHex(o):typeof o=="string"&&this.setStyle(o)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Cc){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,li.toWorkingColorSpace(this,n),this}setRGB(e,n,r,o=li.workingColorSpace){return this.r=e,this.g=n,this.b=r,li.toWorkingColorSpace(this,o),this}setHSL(e,n,r,o=li.workingColorSpace){if(e=UA(e,1),n=Qr(n,0,1),r=Qr(r,0,1),n===0)this.r=this.g=this.b=r;else{const l=r<=.5?r*(1+n):r+n-r*n,c=2*r-l;this.r=qE(c,l,e+1/3),this.g=qE(c,l,e),this.b=qE(c,l,e-1/3)}return li.toWorkingColorSpace(this,o),this}setStyle(e,n=Cc){function r(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let o;if(o=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const c=o[1],s=o[2];switch(c){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,n);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,n);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=o[1],c=l.length;if(c===3)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,n);if(c===6)return this.setHex(parseInt(l,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Cc){const r=AB[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=$d(e.r),this.g=$d(e.g),this.b=$d(e.b),this}copyLinearToSRGB(e){return this.r=Uv(e.r),this.g=Uv(e.g),this.b=Uv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Cc){return li.fromWorkingColorSpace(sa.copy(this),e),Math.round(Qr(sa.r*255,0,255))*65536+Math.round(Qr(sa.g*255,0,255))*256+Math.round(Qr(sa.b*255,0,255))}getHexString(e=Cc){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=li.workingColorSpace){li.fromWorkingColorSpace(sa.copy(this),n);const r=sa.r,o=sa.g,l=sa.b,c=Math.max(r,o,l),s=Math.min(r,o,l);let m,y;const b=(s+c)/2;if(s===c)m=0,y=0;else{const w=c-s;switch(y=b<=.5?w/(c+s):w/(2-c-s),c){case r:m=(o-l)/w+(o<l?6:0);break;case o:m=(l-r)/w+2;break;case l:m=(r-o)/w+4;break}m/=6}return e.h=m,e.s=y,e.l=b,e}getRGB(e,n=li.workingColorSpace){return li.fromWorkingColorSpace(sa.copy(this),n),e.r=sa.r,e.g=sa.g,e.b=sa.b,e}getStyle(e=Cc){li.fromWorkingColorSpace(sa.copy(this),e);const n=sa.r,r=sa.g,o=sa.b;return e!==Cc?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${o.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(o*255)})`}offsetHSL(e,n,r){return this.getHSL(Uf),this.setHSL(Uf.h+e,Uf.s+n,Uf.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(Uf),e.getHSL(_b);const r=q0(Uf.h,_b.h,n),o=q0(Uf.s,_b.s,n),l=q0(Uf.l,_b.l,n);return this.setHSL(r,o,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,o=this.b,l=e.elements;return this.r=l[0]*n+l[3]*r+l[6]*o,this.g=l[1]*n+l[4]*r+l[7]*o,this.b=l[2]*n+l[5]*r+l[8]*o,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const sa=new xi;xi.NAMES=AB;let yhe=0;class lx extends dy{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:yhe++}),this.uuid=fy(),this.name="",this.type="Material",this.blending=Bv,this.side=up,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Z2,this.blendDst=Y2,this.blendEquation=Pm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new xi(0,0,0),this.blendAlpha=0,this.depthFunc=ty,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=_z,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Kg,this.stencilZFail=Kg,this.stencilZPass=Kg,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const o=this[n];if(o===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}o&&o.isColor?o.set(r):o&&o.isVector3&&r&&r.isVector3?o.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Bv&&(r.blending=this.blending),this.side!==up&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==Z2&&(r.blendSrc=this.blendSrc),this.blendDst!==Y2&&(r.blendDst=this.blendDst),this.blendEquation!==Pm&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==ty&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==_z&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Kg&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Kg&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Kg&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function o(l){const c=[];for(const s in l){const m=l[s];delete m.metadata,c.push(m)}return c}if(n){const l=o(e.textures),c=o(e.images);l.length>0&&(r.textures=l),c.length>0&&(r.images=c)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const o=n.length;r=new Array(o);for(let l=0;l!==o;++l)r[l]=n[l].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class dp extends lx{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Rh,this.combine=fB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Zo=new Pt,xb=new mi;let _he=0;class Th{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:_he++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=xz,this.updateRanges=[],this.gpuType=Bd,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let o=0,l=this.itemSize;o<l;o++)this.array[e+o]=n.array[r+o];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)xb.fromBufferAttribute(this,n),xb.applyMatrix3(e),this.setXY(n,xb.x,xb.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Zo.fromBufferAttribute(this,n),Zo.applyMatrix3(e),this.setXYZ(n,Zo.x,Zo.y,Zo.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)Zo.fromBufferAttribute(this,n),Zo.applyMatrix4(e),this.setXYZ(n,Zo.x,Zo.y,Zo.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Zo.fromBufferAttribute(this,n),Zo.applyNormalMatrix(e),this.setXYZ(n,Zo.x,Zo.y,Zo.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Zo.fromBufferAttribute(this,n),Zo.transformDirection(e),this.setXYZ(n,Zo.x,Zo.y,Zo.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=vv(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Sa(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=vv(n,this.array)),n}setX(e,n){return this.normalized&&(n=Sa(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=vv(n,this.array)),n}setY(e,n){return this.normalized&&(n=Sa(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=vv(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Sa(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=vv(n,this.array)),n}setW(e,n){return this.normalized&&(n=Sa(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Sa(n,this.array),r=Sa(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,o){return e*=this.itemSize,this.normalized&&(n=Sa(n,this.array),r=Sa(r,this.array),o=Sa(o,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=o,this}setXYZW(e,n,r,o,l){return e*=this.itemSize,this.normalized&&(n=Sa(n,this.array),r=Sa(r,this.array),o=Sa(o,this.array),l=Sa(l,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=o,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==xz&&(e.usage=this.usage),e}}class IB extends Th{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class RB extends Th{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class Wl extends Th{constructor(e,n,r){super(new Float32Array(e),n,r)}}let xhe=0;const bc=new Ti,XE=new Zs,av=new Pt,Rl=new py,g0=new py,Es=new Pt;class kh extends dy{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:xhe++}),this.uuid=fy(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(TB(e)?RB:IB)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const l=new zr().getNormalMatrix(e);r.applyNormalMatrix(l),r.needsUpdate=!0}const o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return bc.makeRotationFromQuaternion(e),this.applyMatrix4(bc),this}rotateX(e){return bc.makeRotationX(e),this.applyMatrix4(bc),this}rotateY(e){return bc.makeRotationY(e),this.applyMatrix4(bc),this}rotateZ(e){return bc.makeRotationZ(e),this.applyMatrix4(bc),this}translate(e,n,r){return bc.makeTranslation(e,n,r),this.applyMatrix4(bc),this}scale(e,n,r){return bc.makeScale(e,n,r),this.applyMatrix4(bc),this}lookAt(e){return XE.lookAt(e),XE.updateMatrix(),this.applyMatrix4(XE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(av).negate(),this.translate(av.x,av.y,av.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const r=[];for(let o=0,l=e.length;o<l;o++){const c=e[o];r.push(c.x,c.y,c.z||0)}this.setAttribute("position",new Wl(r,3))}else{const r=Math.min(e.length,n.count);for(let o=0;o<r;o++){const l=e[o];n.setXYZ(o,l.x,l.y,l.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new py);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Pt(-1/0,-1/0,-1/0),new Pt(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,o=n.length;r<o;r++){const l=n[r];Rl.setFromBufferAttribute(l),this.morphTargetsRelative?(Es.addVectors(this.boundingBox.min,Rl.min),this.boundingBox.expandByPoint(Es),Es.addVectors(this.boundingBox.max,Rl.max),this.boundingBox.expandByPoint(Es)):(this.boundingBox.expandByPoint(Rl.min),this.boundingBox.expandByPoint(Rl.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Jw);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Pt,1/0);return}if(e){const r=this.boundingSphere.center;if(Rl.setFromBufferAttribute(e),n)for(let l=0,c=n.length;l<c;l++){const s=n[l];g0.setFromBufferAttribute(s),this.morphTargetsRelative?(Es.addVectors(Rl.min,g0.min),Rl.expandByPoint(Es),Es.addVectors(Rl.max,g0.max),Rl.expandByPoint(Es)):(Rl.expandByPoint(g0.min),Rl.expandByPoint(g0.max))}Rl.getCenter(r);let o=0;for(let l=0,c=e.count;l<c;l++)Es.fromBufferAttribute(e,l),o=Math.max(o,r.distanceToSquared(Es));if(n)for(let l=0,c=n.length;l<c;l++){const s=n[l],m=this.morphTargetsRelative;for(let y=0,b=s.count;y<b;y++)Es.fromBufferAttribute(s,y),m&&(av.fromBufferAttribute(e,y),Es.add(av)),o=Math.max(o,r.distanceToSquared(Es))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,o=n.normal,l=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Th(new Float32Array(4*r.count),4));const c=this.getAttribute("tangent"),s=[],m=[];for(let se=0;se<r.count;se++)s[se]=new Pt,m[se]=new Pt;const y=new Pt,b=new Pt,w=new Pt,E=new mi,T=new mi,R=new mi,z=new Pt,I=new Pt;function L(se,re,$){y.fromBufferAttribute(r,se),b.fromBufferAttribute(r,re),w.fromBufferAttribute(r,$),E.fromBufferAttribute(l,se),T.fromBufferAttribute(l,re),R.fromBufferAttribute(l,$),b.sub(y),w.sub(y),T.sub(E),R.sub(E);const ce=1/(T.x*R.y-R.x*T.y);isFinite(ce)&&(z.copy(b).multiplyScalar(R.y).addScaledVector(w,-T.y).multiplyScalar(ce),I.copy(w).multiplyScalar(T.x).addScaledVector(b,-R.x).multiplyScalar(ce),s[se].add(z),s[re].add(z),s[$].add(z),m[se].add(I),m[re].add(I),m[$].add(I))}let V=this.groups;V.length===0&&(V=[{start:0,count:e.count}]);for(let se=0,re=V.length;se<re;++se){const $=V[se],ce=$.start,Ce=$.count;for(let Se=ce,Xe=ce+Ce;Se<Xe;Se+=3)L(e.getX(Se+0),e.getX(Se+1),e.getX(Se+2))}const B=new Pt,W=new Pt,X=new Pt,q=new Pt;function te(se){X.fromBufferAttribute(o,se),q.copy(X);const re=s[se];B.copy(re),B.sub(X.multiplyScalar(X.dot(re))).normalize(),W.crossVectors(q,re);const ce=W.dot(m[se])<0?-1:1;c.setXYZW(se,B.x,B.y,B.z,ce)}for(let se=0,re=V.length;se<re;++se){const $=V[se],ce=$.start,Ce=$.count;for(let Se=ce,Xe=ce+Ce;Se<Xe;Se+=3)te(e.getX(Se+0)),te(e.getX(Se+1)),te(e.getX(Se+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Th(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let E=0,T=r.count;E<T;E++)r.setXYZ(E,0,0,0);const o=new Pt,l=new Pt,c=new Pt,s=new Pt,m=new Pt,y=new Pt,b=new Pt,w=new Pt;if(e)for(let E=0,T=e.count;E<T;E+=3){const R=e.getX(E+0),z=e.getX(E+1),I=e.getX(E+2);o.fromBufferAttribute(n,R),l.fromBufferAttribute(n,z),c.fromBufferAttribute(n,I),b.subVectors(c,l),w.subVectors(o,l),b.cross(w),s.fromBufferAttribute(r,R),m.fromBufferAttribute(r,z),y.fromBufferAttribute(r,I),s.add(b),m.add(b),y.add(b),r.setXYZ(R,s.x,s.y,s.z),r.setXYZ(z,m.x,m.y,m.z),r.setXYZ(I,y.x,y.y,y.z)}else for(let E=0,T=n.count;E<T;E+=3)o.fromBufferAttribute(n,E+0),l.fromBufferAttribute(n,E+1),c.fromBufferAttribute(n,E+2),b.subVectors(c,l),w.subVectors(o,l),b.cross(w),r.setXYZ(E+0,b.x,b.y,b.z),r.setXYZ(E+1,b.x,b.y,b.z),r.setXYZ(E+2,b.x,b.y,b.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)Es.fromBufferAttribute(e,n),Es.normalize(),e.setXYZ(n,Es.x,Es.y,Es.z)}toNonIndexed(){function e(s,m){const y=s.array,b=s.itemSize,w=s.normalized,E=new y.constructor(m.length*b);let T=0,R=0;for(let z=0,I=m.length;z<I;z++){s.isInterleavedBufferAttribute?T=m[z]*s.data.stride+s.offset:T=m[z]*b;for(let L=0;L<b;L++)E[R++]=y[T++]}return new Th(E,b,w)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new kh,r=this.index.array,o=this.attributes;for(const s in o){const m=o[s],y=e(m,r);n.setAttribute(s,y)}const l=this.morphAttributes;for(const s in l){const m=[],y=l[s];for(let b=0,w=y.length;b<w;b++){const E=y[b],T=e(E,r);m.push(T)}n.morphAttributes[s]=m}n.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let s=0,m=c.length;s<m;s++){const y=c[s];n.addGroup(y.start,y.count,y.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const m=this.parameters;for(const y in m)m[y]!==void 0&&(e[y]=m[y]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const m in r){const y=r[m];e.data.attributes[m]=y.toJSON(e.data)}const o={};let l=!1;for(const m in this.morphAttributes){const y=this.morphAttributes[m],b=[];for(let w=0,E=y.length;w<E;w++){const T=y[w];b.push(T.toJSON(e.data))}b.length>0&&(o[m]=b,l=!0)}l&&(e.data.morphAttributes=o,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const o=e.attributes;for(const y in o){const b=o[y];this.setAttribute(y,b.clone(n))}const l=e.morphAttributes;for(const y in l){const b=[],w=l[y];for(let E=0,T=w.length;E<T;E++)b.push(w[E].clone(n));this.morphAttributes[y]=b}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let y=0,b=c.length;y<b;y++){const w=c[y];this.addGroup(w.start,w.count,w.materialIndex)}const s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());const m=e.boundingSphere;return m!==null&&(this.boundingSphere=m.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const zz=new Ti,ym=new VA,bb=new Jw,Oz=new Pt,wb=new Pt,Sb=new Pt,Mb=new Pt,ZE=new Pt,Cb=new Pt,Fz=new Pt,Eb=new Pt;class Ja extends Zs{constructor(e=new kh,n=new dp){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const o=n[r[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,c=o.length;l<c;l++){const s=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=l}}}}getVertexPosition(e,n){const r=this.geometry,o=r.attributes.position,l=r.morphAttributes.position,c=r.morphTargetsRelative;n.fromBufferAttribute(o,e);const s=this.morphTargetInfluences;if(l&&s){Cb.set(0,0,0);for(let m=0,y=l.length;m<y;m++){const b=s[m],w=l[m];b!==0&&(ZE.fromBufferAttribute(w,e),c?Cb.addScaledVector(ZE,b):Cb.addScaledVector(ZE.sub(n),b))}n.add(Cb)}return n}raycast(e,n){const r=this.geometry,o=this.material,l=this.matrixWorld;o!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),bb.copy(r.boundingSphere),bb.applyMatrix4(l),ym.copy(e.ray).recast(e.near),!(bb.containsPoint(ym.origin)===!1&&(ym.intersectSphere(bb,Oz)===null||ym.origin.distanceToSquared(Oz)>(e.far-e.near)**2))&&(zz.copy(l).invert(),ym.copy(e.ray).applyMatrix4(zz),!(r.boundingBox!==null&&ym.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,ym)))}_computeIntersections(e,n,r){let o;const l=this.geometry,c=this.material,s=l.index,m=l.attributes.position,y=l.attributes.uv,b=l.attributes.uv1,w=l.attributes.normal,E=l.groups,T=l.drawRange;if(s!==null)if(Array.isArray(c))for(let R=0,z=E.length;R<z;R++){const I=E[R],L=c[I.materialIndex],V=Math.max(I.start,T.start),B=Math.min(s.count,Math.min(I.start+I.count,T.start+T.count));for(let W=V,X=B;W<X;W+=3){const q=s.getX(W),te=s.getX(W+1),se=s.getX(W+2);o=Tb(this,L,e,r,y,b,w,q,te,se),o&&(o.faceIndex=Math.floor(W/3),o.face.materialIndex=I.materialIndex,n.push(o))}}else{const R=Math.max(0,T.start),z=Math.min(s.count,T.start+T.count);for(let I=R,L=z;I<L;I+=3){const V=s.getX(I),B=s.getX(I+1),W=s.getX(I+2);o=Tb(this,c,e,r,y,b,w,V,B,W),o&&(o.faceIndex=Math.floor(I/3),n.push(o))}}else if(m!==void 0)if(Array.isArray(c))for(let R=0,z=E.length;R<z;R++){const I=E[R],L=c[I.materialIndex],V=Math.max(I.start,T.start),B=Math.min(m.count,Math.min(I.start+I.count,T.start+T.count));for(let W=V,X=B;W<X;W+=3){const q=W,te=W+1,se=W+2;o=Tb(this,L,e,r,y,b,w,q,te,se),o&&(o.faceIndex=Math.floor(W/3),o.face.materialIndex=I.materialIndex,n.push(o))}}else{const R=Math.max(0,T.start),z=Math.min(m.count,T.start+T.count);for(let I=R,L=z;I<L;I+=3){const V=I,B=I+1,W=I+2;o=Tb(this,c,e,r,y,b,w,V,B,W),o&&(o.faceIndex=Math.floor(I/3),n.push(o))}}}}function bhe(t,e,n,r,o,l,c,s){let m;if(e.side===tl?m=r.intersectTriangle(c,l,o,!0,s):m=r.intersectTriangle(o,l,c,e.side===up,s),m===null)return null;Eb.copy(s),Eb.applyMatrix4(t.matrixWorld);const y=n.ray.origin.distanceTo(Eb);return y<n.near||y>n.far?null:{distance:y,point:Eb.clone(),object:t}}function Tb(t,e,n,r,o,l,c,s,m,y){t.getVertexPosition(s,wb),t.getVertexPosition(m,Sb),t.getVertexPosition(y,Mb);const b=bhe(t,e,n,r,wb,Sb,Mb,Fz);if(b){const w=new Pt;vu.getBarycoord(Fz,wb,Sb,Mb,w),o&&(b.uv=vu.getInterpolatedAttribute(o,s,m,y,w,new mi)),l&&(b.uv1=vu.getInterpolatedAttribute(l,s,m,y,w,new mi)),c&&(b.normal=vu.getInterpolatedAttribute(c,s,m,y,w,new Pt),b.normal.dot(r.direction)>0&&b.normal.multiplyScalar(-1));const E={a:s,b:m,c:y,normal:new Pt,materialIndex:0};vu.getNormal(wb,Sb,Mb,E.normal),b.face=E,b.barycoord=w}return b}class cx extends kh{constructor(e=1,n=1,r=1,o=1,l=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:o,heightSegments:l,depthSegments:c};const s=this;o=Math.floor(o),l=Math.floor(l),c=Math.floor(c);const m=[],y=[],b=[],w=[];let E=0,T=0;R("z","y","x",-1,-1,r,n,e,c,l,0),R("z","y","x",1,-1,r,n,-e,c,l,1),R("x","z","y",1,1,e,r,n,o,c,2),R("x","z","y",1,-1,e,r,-n,o,c,3),R("x","y","z",1,-1,e,n,r,o,l,4),R("x","y","z",-1,-1,e,n,-r,o,l,5),this.setIndex(m),this.setAttribute("position",new Wl(y,3)),this.setAttribute("normal",new Wl(b,3)),this.setAttribute("uv",new Wl(w,2));function R(z,I,L,V,B,W,X,q,te,se,re){const $=W/te,ce=X/se,Ce=W/2,Se=X/2,Xe=q/2,Fe=te+1,Me=se+1;let Te=0,Ie=0;const Ke=new Pt;for(let st=0;st<Me;st++){const Ee=st*ce-Se;for(let Qe=0;Qe<Fe;Qe++){const jt=Qe*$-Ce;Ke[z]=jt*V,Ke[I]=Ee*B,Ke[L]=Xe,y.push(Ke.x,Ke.y,Ke.z),Ke[z]=0,Ke[I]=0,Ke[L]=q>0?1:-1,b.push(Ke.x,Ke.y,Ke.z),w.push(Qe/te),w.push(1-st/se),Te+=1}}for(let st=0;st<se;st++)for(let Ee=0;Ee<te;Ee++){const Qe=E+Ee+Fe*st,jt=E+Ee+Fe*(st+1),je=E+(Ee+1)+Fe*(st+1),ft=E+(Ee+1)+Fe*st;m.push(Qe,jt,ft),m.push(jt,je,ft),Ie+=6}s.addGroup(T,Ie,re),T+=Ie,E+=Te}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cx(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function iy(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const o=t[n][r];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?o.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=o.clone():Array.isArray(o)?e[n][r]=o.slice():e[n][r]=o}}return e}function Ma(t){const e={};for(let n=0;n<t.length;n++){const r=iy(t[n]);for(const o in r)e[o]=r[o]}return e}function whe(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function LB(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:li.workingColorSpace}const She={clone:iy,merge:Ma};var Mhe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Che=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Zd extends lx{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Mhe,this.fragmentShader=Che,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=iy(e.uniforms),this.uniformsGroups=whe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const o in this.uniforms){const c=this.uniforms[o].value;c&&c.isTexture?n.uniforms[o]={type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?n.uniforms[o]={type:"c",value:c.getHex()}:c&&c.isVector2?n.uniforms[o]={type:"v2",value:c.toArray()}:c&&c.isVector3?n.uniforms[o]={type:"v3",value:c.toArray()}:c&&c.isVector4?n.uniforms[o]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?n.uniforms[o]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?n.uniforms[o]={type:"m4",value:c.toArray()}:n.uniforms[o]={value:c}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const o in this.extensions)this.extensions[o]===!0&&(r[o]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class DB extends Zs{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ti,this.projectionMatrix=new Ti,this.projectionMatrixInverse=new Ti,this.coordinateSystem=Ud}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const $f=new Pt,Nz=new mi,Bz=new mi;class Fl extends DB{constructor(e=50,n=1,r=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=o,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=C_*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(W0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return C_*2*Math.atan(Math.tan(W0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,r){$f.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set($f.x,$f.y).multiplyScalar(-e/$f.z),$f.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set($f.x,$f.y).multiplyScalar(-e/$f.z)}getViewSize(e,n){return this.getViewBounds(e,Nz,Bz),n.subVectors(Bz,Nz)}setViewOffset(e,n,r,o,l,c){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=o,this.view.width=l,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(W0*.5*this.fov)/this.zoom,r=2*n,o=this.aspect*r,l=-.5*o;const c=this.view;if(this.view!==null&&this.view.enabled){const m=c.fullWidth,y=c.fullHeight;l+=c.offsetX*o/m,n-=c.offsetY*r/y,o*=c.width/m,r*=c.height/y}const s=this.filmOffset;s!==0&&(l+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+o,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const lv=-90,cv=1;class Ehe extends Zs{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const o=new Fl(lv,cv,e,n);o.layers=this.layers,this.add(o);const l=new Fl(lv,cv,e,n);l.layers=this.layers,this.add(l);const c=new Fl(lv,cv,e,n);c.layers=this.layers,this.add(c);const s=new Fl(lv,cv,e,n);s.layers=this.layers,this.add(s);const m=new Fl(lv,cv,e,n);m.layers=this.layers,this.add(m);const y=new Fl(lv,cv,e,n);y.layers=this.layers,this.add(y)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,o,l,c,s,m]=n;for(const y of n)this.remove(y);if(e===Ud)r.up.set(0,1,0),r.lookAt(1,0,0),o.up.set(0,1,0),o.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),m.up.set(0,1,0),m.lookAt(0,0,-1);else if(e===V1)r.up.set(0,-1,0),r.lookAt(-1,0,0),o.up.set(0,-1,0),o.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),m.up.set(0,-1,0),m.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const y of n)this.add(y),y.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:o}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[l,c,s,m,y,b]=this.children,w=e.getRenderTarget(),E=e.getActiveCubeFace(),T=e.getActiveMipmapLevel(),R=e.xr.enabled;e.xr.enabled=!1;const z=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,o),e.render(n,l),e.setRenderTarget(r,1,o),e.render(n,c),e.setRenderTarget(r,2,o),e.render(n,s),e.setRenderTarget(r,3,o),e.render(n,m),e.setRenderTarget(r,4,o),e.render(n,y),r.texture.generateMipmaps=z,e.setRenderTarget(r,5,o),e.render(n,b),e.setRenderTarget(w,E,T),e.xr.enabled=R,r.texture.needsPMREMUpdate=!0}}class kB extends Xs{constructor(e=[],n=ny,r,o,l,c,s,m,y,b){super(e,n,r,o,l,c,s,m,y,b),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class The extends hp{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},o=[r,r,r,r,r,r];this.texture=new kB(o,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:$l}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},o=new cx(5,5,5),l=new Zd({name:"CubemapFromEquirect",uniforms:iy(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:tl,blending:Jf});l.uniforms.tEquirect.value=n;const c=new Ja(o,l),s=n.minFilter;return n.minFilter===Zf&&(n.minFilter=$l),new Ehe(1,10,this).update(e,c),n.minFilter=s,c.geometry.dispose(),c.material.dispose(),this}clear(e,n=!0,r=!0,o=!0){const l=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(n,r,o);e.setRenderTarget(l)}}class Yf extends Zs{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Phe={type:"move"};class YE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Yf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Yf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Pt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Pt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Yf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Pt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Pt),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let o=null,l=null,c=null;const s=this._targetRay,m=this._grip,y=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(y&&e.hand){c=!0;for(const z of e.hand.values()){const I=n.getJointPose(z,r),L=this._getHandJoint(y,z);I!==null&&(L.matrix.fromArray(I.transform.matrix),L.matrix.decompose(L.position,L.rotation,L.scale),L.matrixWorldNeedsUpdate=!0,L.jointRadius=I.radius),L.visible=I!==null}const b=y.joints["index-finger-tip"],w=y.joints["thumb-tip"],E=b.position.distanceTo(w.position),T=.02,R=.005;y.inputState.pinching&&E>T+R?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!y.inputState.pinching&&E<=T-R&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else m!==null&&e.gripSpace&&(l=n.getPose(e.gripSpace,r),l!==null&&(m.matrix.fromArray(l.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,l.linearVelocity?(m.hasLinearVelocity=!0,m.linearVelocity.copy(l.linearVelocity)):m.hasLinearVelocity=!1,l.angularVelocity?(m.hasAngularVelocity=!0,m.angularVelocity.copy(l.angularVelocity)):m.hasAngularVelocity=!1));s!==null&&(o=n.getPose(e.targetRaySpace,r),o===null&&l!==null&&(o=l),o!==null&&(s.matrix.fromArray(o.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,o.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(o.linearVelocity)):s.hasLinearVelocity=!1,o.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(o.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Phe)))}return s!==null&&(s.visible=o!==null),m!==null&&(m.visible=l!==null),y!==null&&(y.visible=c!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new Yf;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class H1 extends Zs{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Rh,this.environmentIntensity=1,this.environmentRotation=new Rh,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}const KE=new Pt,Ahe=new Pt,Ihe=new zr;class Sm{constructor(e=new Pt(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,o){return this.normal.set(e,n,r),this.constant=o,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const o=KE.subVectors(r,n).cross(Ahe.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(KE),o=this.normal.dot(r);if(o===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/o;return l<0||l>1?null:n.copy(e.start).addScaledVector(r,l)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||Ihe.getNormalMatrix(e),o=this.coplanarPoint(KE).applyMatrix4(e),l=this.normal.applyMatrix3(r).normalize();return this.constant=-o.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _m=new Jw,Pb=new Pt;class HA{constructor(e=new Sm,n=new Sm,r=new Sm,o=new Sm,l=new Sm,c=new Sm){this.planes=[e,n,r,o,l,c]}set(e,n,r,o,l,c){const s=this.planes;return s[0].copy(e),s[1].copy(n),s[2].copy(r),s[3].copy(o),s[4].copy(l),s[5].copy(c),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=Ud){const r=this.planes,o=e.elements,l=o[0],c=o[1],s=o[2],m=o[3],y=o[4],b=o[5],w=o[6],E=o[7],T=o[8],R=o[9],z=o[10],I=o[11],L=o[12],V=o[13],B=o[14],W=o[15];if(r[0].setComponents(m-l,E-y,I-T,W-L).normalize(),r[1].setComponents(m+l,E+y,I+T,W+L).normalize(),r[2].setComponents(m+c,E+b,I+R,W+V).normalize(),r[3].setComponents(m-c,E-b,I-R,W-V).normalize(),r[4].setComponents(m-s,E-w,I-z,W-B).normalize(),n===Ud)r[5].setComponents(m+s,E+w,I+z,W+B).normalize();else if(n===V1)r[5].setComponents(s,w,z,B).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),_m.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),_m.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(_m)}intersectsSprite(e){return _m.center.set(0,0,0),_m.radius=.7071067811865476,_m.applyMatrix4(e.matrixWorld),this.intersectsSphere(_m)}intersectsSphere(e){const n=this.planes,r=e.center,o=-e.radius;for(let l=0;l<6;l++)if(n[l].distanceToPoint(r)<o)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const o=n[r];if(Pb.x=o.normal.x>0?e.max.x:e.min.x,Pb.y=o.normal.y>0?e.max.y:e.min.y,Pb.z=o.normal.z>0?e.max.z:e.min.z,o.distanceToPoint(Pb)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class Rhe extends lx{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new xi(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const G1=new Pt,W1=new Pt,Uz=new Ti,v0=new VA,Ab=new Jw,JE=new Pt,$z=new Pt;class Lhe extends Zs{constructor(e=new kh,n=new Rhe){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let o=1,l=n.count;o<l;o++)G1.fromBufferAttribute(n,o-1),W1.fromBufferAttribute(n,o),r[o]=r[o-1],r[o]+=G1.distanceTo(W1);e.setAttribute("lineDistance",new Wl(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,o=this.matrixWorld,l=e.params.Line.threshold,c=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Ab.copy(r.boundingSphere),Ab.applyMatrix4(o),Ab.radius+=l,e.ray.intersectsSphere(Ab)===!1)return;Uz.copy(o).invert(),v0.copy(e.ray).applyMatrix4(Uz);const s=l/((this.scale.x+this.scale.y+this.scale.z)/3),m=s*s,y=this.isLineSegments?2:1,b=r.index,E=r.attributes.position;if(b!==null){const T=Math.max(0,c.start),R=Math.min(b.count,c.start+c.count);for(let z=T,I=R-1;z<I;z+=y){const L=b.getX(z),V=b.getX(z+1),B=Ib(this,e,v0,m,L,V,z);B&&n.push(B)}if(this.isLineLoop){const z=b.getX(R-1),I=b.getX(T),L=Ib(this,e,v0,m,z,I,R-1);L&&n.push(L)}}else{const T=Math.max(0,c.start),R=Math.min(E.count,c.start+c.count);for(let z=T,I=R-1;z<I;z+=y){const L=Ib(this,e,v0,m,z,z+1,z);L&&n.push(L)}if(this.isLineLoop){const z=Ib(this,e,v0,m,R-1,T,R-1);z&&n.push(z)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const o=n[r[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,c=o.length;l<c;l++){const s=o[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=l}}}}}function Ib(t,e,n,r,o,l,c){const s=t.geometry.attributes.position;if(G1.fromBufferAttribute(s,o),W1.fromBufferAttribute(s,l),n.distanceSqToSegment(G1,W1,JE,$z)>r)return;JE.applyMatrix4(t.matrixWorld);const y=e.ray.origin.distanceTo(JE);if(!(y<e.near||y>e.far))return{distance:y,point:$z.clone().applyMatrix4(t.matrixWorld),index:c,face:null,faceIndex:null,barycoord:null,object:t}}const Vz=new Pt,jz=new Pt;class Dhe extends Lhe{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[];for(let o=0,l=n.count;o<l;o+=2)Vz.fromBufferAttribute(n,o),jz.fromBufferAttribute(n,o+1),r[o]=o===0?0:r[o-1],r[o+1]=r[o]+Vz.distanceTo(jz);e.setAttribute("lineDistance",new Wl(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class khe extends Xs{constructor(e,n,r,o,l=$l,c=$l,s,m,y){super(e,n,r,o,l,c,s,m,y),this.isVideoTexture=!0,this.generateMipmaps=!1;const b=this;function w(){b.needsUpdate=!0,e.requestVideoFrameCallback(w)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(w)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class zB extends Xs{constructor(e,n,r=Hm,o,l,c,s=bu,m=bu,y,b=S_){if(b!==S_&&b!==M_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,o,l,c,s,m,b,r,y),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new $A(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class ux extends kh{constructor(e=1,n=1,r=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:o};const l=e/2,c=n/2,s=Math.floor(r),m=Math.floor(o),y=s+1,b=m+1,w=e/s,E=n/m,T=[],R=[],z=[],I=[];for(let L=0;L<b;L++){const V=L*E-c;for(let B=0;B<y;B++){const W=B*w-l;R.push(W,-V,0),z.push(0,0,1),I.push(B/s),I.push(1-L/m)}}for(let L=0;L<m;L++)for(let V=0;V<s;V++){const B=V+y*L,W=V+y*(L+1),X=V+1+y*(L+1),q=V+1+y*L;T.push(B,W,q),T.push(W,X,q)}this.setIndex(T),this.setAttribute("position",new Wl(R,3)),this.setAttribute("normal",new Wl(z,3)),this.setAttribute("uv",new Wl(I,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ux(e.width,e.height,e.widthSegments,e.heightSegments)}}class my extends kh{constructor(e=1,n=32,r=16,o=0,l=Math.PI*2,c=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:o,phiLength:l,thetaStart:c,thetaLength:s},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const m=Math.min(c+s,Math.PI);let y=0;const b=[],w=new Pt,E=new Pt,T=[],R=[],z=[],I=[];for(let L=0;L<=r;L++){const V=[],B=L/r;let W=0;L===0&&c===0?W=.5/n:L===r&&m===Math.PI&&(W=-.5/n);for(let X=0;X<=n;X++){const q=X/n;w.x=-e*Math.cos(o+q*l)*Math.sin(c+B*s),w.y=e*Math.cos(c+B*s),w.z=e*Math.sin(o+q*l)*Math.sin(c+B*s),R.push(w.x,w.y,w.z),E.copy(w).normalize(),z.push(E.x,E.y,E.z),I.push(q+W,1-B),V.push(y++)}b.push(V)}for(let L=0;L<r;L++)for(let V=0;V<n;V++){const B=b[L][V+1],W=b[L][V],X=b[L+1][V],q=b[L+1][V+1];(L!==0||c>0)&&T.push(B,W,q),(L!==r-1||m<Math.PI)&&T.push(W,X,q)}this.setIndex(T),this.setAttribute("position",new Wl(R,3)),this.setAttribute("normal",new Wl(z,3)),this.setAttribute("uv",new Wl(I,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new my(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class zhe extends kh{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],r=new Set,o=new Pt,l=new Pt;if(e.index!==null){const c=e.attributes.position,s=e.index;let m=e.groups;m.length===0&&(m=[{start:0,count:s.count,materialIndex:0}]);for(let y=0,b=m.length;y<b;++y){const w=m[y],E=w.start,T=w.count;for(let R=E,z=E+T;R<z;R+=3)for(let I=0;I<3;I++){const L=s.getX(R+I),V=s.getX(R+(I+1)%3);o.fromBufferAttribute(c,L),l.fromBufferAttribute(c,V),Hz(o,l,r)===!0&&(n.push(o.x,o.y,o.z),n.push(l.x,l.y,l.z))}}}else{const c=e.attributes.position;for(let s=0,m=c.count/3;s<m;s++)for(let y=0;y<3;y++){const b=3*s+y,w=3*s+(y+1)%3;o.fromBufferAttribute(c,b),l.fromBufferAttribute(c,w),Hz(o,l,r)===!0&&(n.push(o.x,o.y,o.z),n.push(l.x,l.y,l.z))}}this.setAttribute("position",new Wl(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Hz(t,e,n){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,o=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(r)===!0||n.has(o)===!0?!1:(n.add(r),n.add(o),!0)}class Ohe extends lx{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Pue,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Fhe extends lx{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const kT={enabled:!1};class Nhe{constructor(e,n,r){const o=this;let l=!1,c=0,s=0,m;const y=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=r,this.itemStart=function(b){s++,l===!1&&o.onStart!==void 0&&o.onStart(b,c,s),l=!0},this.itemEnd=function(b){c++,o.onProgress!==void 0&&o.onProgress(b,c,s),c===s&&(l=!1,o.onLoad!==void 0&&o.onLoad())},this.itemError=function(b){o.onError!==void 0&&o.onError(b)},this.resolveURL=function(b){return m?m(b):b},this.setURLModifier=function(b){return m=b,this},this.addHandler=function(b,w){return y.push(b,w),this},this.removeHandler=function(b){const w=y.indexOf(b);return w!==-1&&y.splice(w,2),this},this.getHandler=function(b){for(let w=0,E=y.length;w<E;w+=2){const T=y[w],R=y[w+1];if(T.global&&(T.lastIndex=0),T.test(b))return R}return null}}}const Bhe=new Nhe;let GA=class{constructor(e){this.manager=e!==void 0?e:Bhe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const r=this;return new Promise(function(o,l){r.load(e,o,n,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};GA.DEFAULT_MATERIAL_NAME="__DEFAULT";class Uhe extends DB{constructor(e=-1,n=1,r=1,o=-1,l=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=o,this.near=l,this.far=c,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,o,l,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=o,this.view.width=l,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let l=r-e,c=r+e,s=o+n,m=o-n;if(this.view!==null&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=y*this.view.offsetX,c=l+y*this.view.width,s-=b*this.view.offsetY,m=s-b*this.view.height}this.projectionMatrix.makeOrthographic(l,c,s,m,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class $he extends Fl{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}}const Gz=new Ti;class Vhe{constructor(e,n,r=0,o=1/0){this.ray=new VA(e,n),this.near=r,this.far=o,this.camera=null,this.layers=new jA,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return Gz.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Gz),this}intersectObject(e,n=!0,r=[]){return zT(e,this,r,n),r.sort(Wz),r}intersectObjects(e,n=!0,r=[]){for(let o=0,l=e.length;o<l;o++)zT(e[o],this,r,n);return r.sort(Wz),r}}function Wz(t,e){return t.distance-e.distance}function zT(t,e,n,r){let o=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(o=!1),o===!0&&r===!0){const l=t.children;for(let c=0,s=l.length;c<s;c++)zT(l[c],e,n,!0)}}function qz(t,e,n,r){const o=jhe(r);switch(n){case _B:return t*e;case bB:return t*e;case wB:return t*e*2;case SB:return t*e/o.components*o.byteLength;case FA:return t*e/o.components*o.byteLength;case MB:return t*e*2/o.components*o.byteLength;case NA:return t*e*2/o.components*o.byteLength;case xB:return t*e*3/o.components*o.byteLength;case _u:return t*e*4/o.components*o.byteLength;case BA:return t*e*4/o.components*o.byteLength;case i1:case o1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case s1:case a1:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case cT:case hT:return Math.max(t,16)*Math.max(e,8)/4;case lT:case uT:return Math.max(t,8)*Math.max(e,8)/2;case dT:case fT:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case pT:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case mT:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case gT:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case vT:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case yT:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case _T:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case xT:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case bT:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case wT:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case ST:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case MT:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case CT:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case ET:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case TT:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case PT:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case l1:case AT:case IT:return Math.ceil(t/4)*Math.ceil(e/4)*16;case CB:case RT:return Math.ceil(t/4)*Math.ceil(e/4)*8;case LT:case DT:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function jhe(t){switch(t){case Xd:case gB:return{byteLength:1,components:1};case b_:case vB:case ax:return{byteLength:2,components:1};case zA:case OA:return{byteLength:2,components:4};case Hm:case kA:case Bd:return{byteLength:4,components:1};case yB:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:DA}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=DA);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function OB(){let t=null,e=!1,n=null,r=null;function o(l,c){n(l,c),r=t.requestAnimationFrame(o)}return{start:function(){e!==!0&&n!==null&&(r=t.requestAnimationFrame(o),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(l){n=l},setContext:function(l){t=l}}}function Hhe(t){const e=new WeakMap;function n(s,m){const y=s.array,b=s.usage,w=y.byteLength,E=t.createBuffer();t.bindBuffer(m,E),t.bufferData(m,y,b),s.onUploadCallback();let T;if(y instanceof Float32Array)T=t.FLOAT;else if(y instanceof Uint16Array)s.isFloat16BufferAttribute?T=t.HALF_FLOAT:T=t.UNSIGNED_SHORT;else if(y instanceof Int16Array)T=t.SHORT;else if(y instanceof Uint32Array)T=t.UNSIGNED_INT;else if(y instanceof Int32Array)T=t.INT;else if(y instanceof Int8Array)T=t.BYTE;else if(y instanceof Uint8Array)T=t.UNSIGNED_BYTE;else if(y instanceof Uint8ClampedArray)T=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+y);return{buffer:E,type:T,bytesPerElement:y.BYTES_PER_ELEMENT,version:s.version,size:w}}function r(s,m,y){const b=m.array,w=m.updateRanges;if(t.bindBuffer(y,s),w.length===0)t.bufferSubData(y,0,b);else{w.sort((T,R)=>T.start-R.start);let E=0;for(let T=1;T<w.length;T++){const R=w[E],z=w[T];z.start<=R.start+R.count+1?R.count=Math.max(R.count,z.start+z.count-R.start):(++E,w[E]=z)}w.length=E+1;for(let T=0,R=w.length;T<R;T++){const z=w[T];t.bufferSubData(y,z.start*b.BYTES_PER_ELEMENT,b,z.start,z.count)}m.clearUpdateRanges()}m.onUploadCallback()}function o(s){return s.isInterleavedBufferAttribute&&(s=s.data),e.get(s)}function l(s){s.isInterleavedBufferAttribute&&(s=s.data);const m=e.get(s);m&&(t.deleteBuffer(m.buffer),e.delete(s))}function c(s,m){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){const b=e.get(s);(!b||b.version<s.version)&&e.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}const y=e.get(s);if(y===void 0)e.set(s,n(s,m));else if(y.version<s.version){if(y.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(y.buffer,s,m),y.version=s.version}}return{get:o,remove:l,update:c}}var Ghe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Whe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,qhe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Xhe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Zhe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Yhe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Khe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Jhe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Qhe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,ede=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,tde=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,nde=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,rde=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,ide=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,ode=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,sde=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,ade=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,lde=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,cde=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ude=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,hde=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,dde=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,fde=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,pde=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,mde=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,gde=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,vde=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,yde=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,_de=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,xde=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,bde="gl_FragColor = linearToOutputTexel( gl_FragColor );",wde=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Sde=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Mde=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Cde=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Ede=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Tde=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Pde=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Ade=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Ide=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Rde=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Lde=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Dde=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,kde=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,zde=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Ode=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Fde=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Nde=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Bde=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Ude=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,$de=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Vde=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,jde=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Hde=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Gde=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Wde=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,qde=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Xde=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Zde=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Yde=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Kde=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Jde=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Qde=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,efe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tfe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,nfe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,rfe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,ife=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,ofe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,sfe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,afe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,lfe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,cfe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,ufe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,hfe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,dfe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,ffe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,pfe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,mfe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,gfe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,vfe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,yfe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,_fe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,xfe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,bfe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,wfe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Sfe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Mfe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Cfe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Efe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Tfe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Pfe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Afe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Ife=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Rfe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Lfe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Dfe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,kfe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,zfe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Ofe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Ffe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Nfe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Bfe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Ufe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,$fe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Vfe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,jfe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Hfe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Gfe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Wfe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,qfe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Xfe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Zfe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Yfe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Kfe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,Jfe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Qfe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,epe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,tpe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,npe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,rpe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ipe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,ope=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,spe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ape=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lpe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,cpe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,upe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,hpe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,dpe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fpe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ppe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,mpe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gpe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vpe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ype=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,_pe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,xpe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bpe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,wpe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Spe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Br={alphahash_fragment:Ghe,alphahash_pars_fragment:Whe,alphamap_fragment:qhe,alphamap_pars_fragment:Xhe,alphatest_fragment:Zhe,alphatest_pars_fragment:Yhe,aomap_fragment:Khe,aomap_pars_fragment:Jhe,batching_pars_vertex:Qhe,batching_vertex:ede,begin_vertex:tde,beginnormal_vertex:nde,bsdfs:rde,iridescence_fragment:ide,bumpmap_pars_fragment:ode,clipping_planes_fragment:sde,clipping_planes_pars_fragment:ade,clipping_planes_pars_vertex:lde,clipping_planes_vertex:cde,color_fragment:ude,color_pars_fragment:hde,color_pars_vertex:dde,color_vertex:fde,common:pde,cube_uv_reflection_fragment:mde,defaultnormal_vertex:gde,displacementmap_pars_vertex:vde,displacementmap_vertex:yde,emissivemap_fragment:_de,emissivemap_pars_fragment:xde,colorspace_fragment:bde,colorspace_pars_fragment:wde,envmap_fragment:Sde,envmap_common_pars_fragment:Mde,envmap_pars_fragment:Cde,envmap_pars_vertex:Ede,envmap_physical_pars_fragment:Fde,envmap_vertex:Tde,fog_vertex:Pde,fog_pars_vertex:Ade,fog_fragment:Ide,fog_pars_fragment:Rde,gradientmap_pars_fragment:Lde,lightmap_pars_fragment:Dde,lights_lambert_fragment:kde,lights_lambert_pars_fragment:zde,lights_pars_begin:Ode,lights_toon_fragment:Nde,lights_toon_pars_fragment:Bde,lights_phong_fragment:Ude,lights_phong_pars_fragment:$de,lights_physical_fragment:Vde,lights_physical_pars_fragment:jde,lights_fragment_begin:Hde,lights_fragment_maps:Gde,lights_fragment_end:Wde,logdepthbuf_fragment:qde,logdepthbuf_pars_fragment:Xde,logdepthbuf_pars_vertex:Zde,logdepthbuf_vertex:Yde,map_fragment:Kde,map_pars_fragment:Jde,map_particle_fragment:Qde,map_particle_pars_fragment:efe,metalnessmap_fragment:tfe,metalnessmap_pars_fragment:nfe,morphinstance_vertex:rfe,morphcolor_vertex:ife,morphnormal_vertex:ofe,morphtarget_pars_vertex:sfe,morphtarget_vertex:afe,normal_fragment_begin:lfe,normal_fragment_maps:cfe,normal_pars_fragment:ufe,normal_pars_vertex:hfe,normal_vertex:dfe,normalmap_pars_fragment:ffe,clearcoat_normal_fragment_begin:pfe,clearcoat_normal_fragment_maps:mfe,clearcoat_pars_fragment:gfe,iridescence_pars_fragment:vfe,opaque_fragment:yfe,packing:_fe,premultiplied_alpha_fragment:xfe,project_vertex:bfe,dithering_fragment:wfe,dithering_pars_fragment:Sfe,roughnessmap_fragment:Mfe,roughnessmap_pars_fragment:Cfe,shadowmap_pars_fragment:Efe,shadowmap_pars_vertex:Tfe,shadowmap_vertex:Pfe,shadowmask_pars_fragment:Afe,skinbase_vertex:Ife,skinning_pars_vertex:Rfe,skinning_vertex:Lfe,skinnormal_vertex:Dfe,specularmap_fragment:kfe,specularmap_pars_fragment:zfe,tonemapping_fragment:Ofe,tonemapping_pars_fragment:Ffe,transmission_fragment:Nfe,transmission_pars_fragment:Bfe,uv_pars_fragment:Ufe,uv_pars_vertex:$fe,uv_vertex:Vfe,worldpos_vertex:jfe,background_vert:Hfe,background_frag:Gfe,backgroundCube_vert:Wfe,backgroundCube_frag:qfe,cube_vert:Xfe,cube_frag:Zfe,depth_vert:Yfe,depth_frag:Kfe,distanceRGBA_vert:Jfe,distanceRGBA_frag:Qfe,equirect_vert:epe,equirect_frag:tpe,linedashed_vert:npe,linedashed_frag:rpe,meshbasic_vert:ipe,meshbasic_frag:ope,meshlambert_vert:spe,meshlambert_frag:ape,meshmatcap_vert:lpe,meshmatcap_frag:cpe,meshnormal_vert:upe,meshnormal_frag:hpe,meshphong_vert:dpe,meshphong_frag:fpe,meshphysical_vert:ppe,meshphysical_frag:mpe,meshtoon_vert:gpe,meshtoon_frag:vpe,points_vert:ype,points_frag:_pe,shadow_vert:xpe,shadow_frag:bpe,sprite_vert:wpe,sprite_frag:Spe},qn={common:{diffuse:{value:new xi(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new zr},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new zr}},envmap:{envMap:{value:null},envMapRotation:{value:new zr},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new zr}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new zr}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new zr},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new zr},normalScale:{value:new mi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new zr},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new zr}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new zr}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new zr}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0},uvTransform:{value:new zr}},sprite:{diffuse:{value:new xi(16777215)},opacity:{value:1},center:{value:new mi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new zr},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0}}},_h={basic:{uniforms:Ma([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.fog]),vertexShader:Br.meshbasic_vert,fragmentShader:Br.meshbasic_frag},lambert:{uniforms:Ma([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.fog,qn.lights,{emissive:{value:new xi(0)}}]),vertexShader:Br.meshlambert_vert,fragmentShader:Br.meshlambert_frag},phong:{uniforms:Ma([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.fog,qn.lights,{emissive:{value:new xi(0)},specular:{value:new xi(1118481)},shininess:{value:30}}]),vertexShader:Br.meshphong_vert,fragmentShader:Br.meshphong_frag},standard:{uniforms:Ma([qn.common,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.roughnessmap,qn.metalnessmap,qn.fog,qn.lights,{emissive:{value:new xi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Br.meshphysical_vert,fragmentShader:Br.meshphysical_frag},toon:{uniforms:Ma([qn.common,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.gradientmap,qn.fog,qn.lights,{emissive:{value:new xi(0)}}]),vertexShader:Br.meshtoon_vert,fragmentShader:Br.meshtoon_frag},matcap:{uniforms:Ma([qn.common,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.fog,{matcap:{value:null}}]),vertexShader:Br.meshmatcap_vert,fragmentShader:Br.meshmatcap_frag},points:{uniforms:Ma([qn.points,qn.fog]),vertexShader:Br.points_vert,fragmentShader:Br.points_frag},dashed:{uniforms:Ma([qn.common,qn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Br.linedashed_vert,fragmentShader:Br.linedashed_frag},depth:{uniforms:Ma([qn.common,qn.displacementmap]),vertexShader:Br.depth_vert,fragmentShader:Br.depth_frag},normal:{uniforms:Ma([qn.common,qn.bumpmap,qn.normalmap,qn.displacementmap,{opacity:{value:1}}]),vertexShader:Br.meshnormal_vert,fragmentShader:Br.meshnormal_frag},sprite:{uniforms:Ma([qn.sprite,qn.fog]),vertexShader:Br.sprite_vert,fragmentShader:Br.sprite_frag},background:{uniforms:{uvTransform:{value:new zr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Br.background_vert,fragmentShader:Br.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new zr}},vertexShader:Br.backgroundCube_vert,fragmentShader:Br.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Br.cube_vert,fragmentShader:Br.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Br.equirect_vert,fragmentShader:Br.equirect_frag},distanceRGBA:{uniforms:Ma([qn.common,qn.displacementmap,{referencePosition:{value:new Pt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Br.distanceRGBA_vert,fragmentShader:Br.distanceRGBA_frag},shadow:{uniforms:Ma([qn.lights,qn.fog,{color:{value:new xi(0)},opacity:{value:1}}]),vertexShader:Br.shadow_vert,fragmentShader:Br.shadow_frag}};_h.physical={uniforms:Ma([_h.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new zr},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new zr},clearcoatNormalScale:{value:new mi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new zr},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new zr},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new zr},sheen:{value:0},sheenColor:{value:new xi(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new zr},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new zr},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new zr},transmissionSamplerSize:{value:new mi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new zr},attenuationDistance:{value:0},attenuationColor:{value:new xi(0)},specularColor:{value:new xi(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new zr},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new zr},anisotropyVector:{value:new mi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new zr}}]),vertexShader:Br.meshphysical_vert,fragmentShader:Br.meshphysical_frag};const Rb={r:0,b:0,g:0},xm=new Rh,Mpe=new Ti;function Cpe(t,e,n,r,o,l,c){const s=new xi(0);let m=l===!0?0:1,y,b,w=null,E=0,T=null;function R(B){let W=B.isScene===!0?B.background:null;return W&&W.isTexture&&(W=(B.backgroundBlurriness>0?n:e).get(W)),W}function z(B){let W=!1;const X=R(B);X===null?L(s,m):X&&X.isColor&&(L(X,1),W=!0);const q=t.xr.getEnvironmentBlendMode();q==="additive"?r.buffers.color.setClear(0,0,0,1,c):q==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,c),(t.autoClear||W)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function I(B,W){const X=R(W);X&&(X.isCubeTexture||X.mapping===Kw)?(b===void 0&&(b=new Ja(new cx(1,1,1),new Zd({name:"BackgroundCubeMaterial",uniforms:iy(_h.backgroundCube.uniforms),vertexShader:_h.backgroundCube.vertexShader,fragmentShader:_h.backgroundCube.fragmentShader,side:tl,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),b.geometry.deleteAttribute("normal"),b.geometry.deleteAttribute("uv"),b.onBeforeRender=function(q,te,se){this.matrixWorld.copyPosition(se.matrixWorld)},Object.defineProperty(b.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),o.update(b)),xm.copy(W.backgroundRotation),xm.x*=-1,xm.y*=-1,xm.z*=-1,X.isCubeTexture&&X.isRenderTargetTexture===!1&&(xm.y*=-1,xm.z*=-1),b.material.uniforms.envMap.value=X,b.material.uniforms.flipEnvMap.value=X.isCubeTexture&&X.isRenderTargetTexture===!1?-1:1,b.material.uniforms.backgroundBlurriness.value=W.backgroundBlurriness,b.material.uniforms.backgroundIntensity.value=W.backgroundIntensity,b.material.uniforms.backgroundRotation.value.setFromMatrix4(Mpe.makeRotationFromEuler(xm)),b.material.toneMapped=li.getTransfer(X.colorSpace)!==Ri,(w!==X||E!==X.version||T!==t.toneMapping)&&(b.material.needsUpdate=!0,w=X,E=X.version,T=t.toneMapping),b.layers.enableAll(),B.unshift(b,b.geometry,b.material,0,0,null)):X&&X.isTexture&&(y===void 0&&(y=new Ja(new ux(2,2),new Zd({name:"BackgroundMaterial",uniforms:iy(_h.background.uniforms),vertexShader:_h.background.vertexShader,fragmentShader:_h.background.fragmentShader,side:up,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),y.geometry.deleteAttribute("normal"),Object.defineProperty(y.material,"map",{get:function(){return this.uniforms.t2D.value}}),o.update(y)),y.material.uniforms.t2D.value=X,y.material.uniforms.backgroundIntensity.value=W.backgroundIntensity,y.material.toneMapped=li.getTransfer(X.colorSpace)!==Ri,X.matrixAutoUpdate===!0&&X.updateMatrix(),y.material.uniforms.uvTransform.value.copy(X.matrix),(w!==X||E!==X.version||T!==t.toneMapping)&&(y.material.needsUpdate=!0,w=X,E=X.version,T=t.toneMapping),y.layers.enableAll(),B.unshift(y,y.geometry,y.material,0,0,null))}function L(B,W){B.getRGB(Rb,LB(t)),r.buffers.color.setClear(Rb.r,Rb.g,Rb.b,W,c)}function V(){b!==void 0&&(b.geometry.dispose(),b.material.dispose(),b=void 0),y!==void 0&&(y.geometry.dispose(),y.material.dispose(),y=void 0)}return{getClearColor:function(){return s},setClearColor:function(B,W=1){s.set(B),m=W,L(s,m)},getClearAlpha:function(){return m},setClearAlpha:function(B){m=B,L(s,m)},render:z,addToRenderList:I,dispose:V}}function Epe(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r={},o=E(null);let l=o,c=!1;function s($,ce,Ce,Se,Xe){let Fe=!1;const Me=w(Se,Ce,ce);l!==Me&&(l=Me,y(l.object)),Fe=T($,Se,Ce,Xe),Fe&&R($,Se,Ce,Xe),Xe!==null&&e.update(Xe,t.ELEMENT_ARRAY_BUFFER),(Fe||c)&&(c=!1,W($,ce,Ce,Se),Xe!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(Xe).buffer))}function m(){return t.createVertexArray()}function y($){return t.bindVertexArray($)}function b($){return t.deleteVertexArray($)}function w($,ce,Ce){const Se=Ce.wireframe===!0;let Xe=r[$.id];Xe===void 0&&(Xe={},r[$.id]=Xe);let Fe=Xe[ce.id];Fe===void 0&&(Fe={},Xe[ce.id]=Fe);let Me=Fe[Se];return Me===void 0&&(Me=E(m()),Fe[Se]=Me),Me}function E($){const ce=[],Ce=[],Se=[];for(let Xe=0;Xe<n;Xe++)ce[Xe]=0,Ce[Xe]=0,Se[Xe]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ce,enabledAttributes:Ce,attributeDivisors:Se,object:$,attributes:{},index:null}}function T($,ce,Ce,Se){const Xe=l.attributes,Fe=ce.attributes;let Me=0;const Te=Ce.getAttributes();for(const Ie in Te)if(Te[Ie].location>=0){const st=Xe[Ie];let Ee=Fe[Ie];if(Ee===void 0&&(Ie==="instanceMatrix"&&$.instanceMatrix&&(Ee=$.instanceMatrix),Ie==="instanceColor"&&$.instanceColor&&(Ee=$.instanceColor)),st===void 0||st.attribute!==Ee||Ee&&st.data!==Ee.data)return!0;Me++}return l.attributesNum!==Me||l.index!==Se}function R($,ce,Ce,Se){const Xe={},Fe=ce.attributes;let Me=0;const Te=Ce.getAttributes();for(const Ie in Te)if(Te[Ie].location>=0){let st=Fe[Ie];st===void 0&&(Ie==="instanceMatrix"&&$.instanceMatrix&&(st=$.instanceMatrix),Ie==="instanceColor"&&$.instanceColor&&(st=$.instanceColor));const Ee={};Ee.attribute=st,st&&st.data&&(Ee.data=st.data),Xe[Ie]=Ee,Me++}l.attributes=Xe,l.attributesNum=Me,l.index=Se}function z(){const $=l.newAttributes;for(let ce=0,Ce=$.length;ce<Ce;ce++)$[ce]=0}function I($){L($,0)}function L($,ce){const Ce=l.newAttributes,Se=l.enabledAttributes,Xe=l.attributeDivisors;Ce[$]=1,Se[$]===0&&(t.enableVertexAttribArray($),Se[$]=1),Xe[$]!==ce&&(t.vertexAttribDivisor($,ce),Xe[$]=ce)}function V(){const $=l.newAttributes,ce=l.enabledAttributes;for(let Ce=0,Se=ce.length;Ce<Se;Ce++)ce[Ce]!==$[Ce]&&(t.disableVertexAttribArray(Ce),ce[Ce]=0)}function B($,ce,Ce,Se,Xe,Fe,Me){Me===!0?t.vertexAttribIPointer($,ce,Ce,Xe,Fe):t.vertexAttribPointer($,ce,Ce,Se,Xe,Fe)}function W($,ce,Ce,Se){z();const Xe=Se.attributes,Fe=Ce.getAttributes(),Me=ce.defaultAttributeValues;for(const Te in Fe){const Ie=Fe[Te];if(Ie.location>=0){let Ke=Xe[Te];if(Ke===void 0&&(Te==="instanceMatrix"&&$.instanceMatrix&&(Ke=$.instanceMatrix),Te==="instanceColor"&&$.instanceColor&&(Ke=$.instanceColor)),Ke!==void 0){const st=Ke.normalized,Ee=Ke.itemSize,Qe=e.get(Ke);if(Qe===void 0)continue;const jt=Qe.buffer,je=Qe.type,ft=Qe.bytesPerElement,At=je===t.INT||je===t.UNSIGNED_INT||Ke.gpuType===kA;if(Ke.isInterleavedBufferAttribute){const ht=Ke.data,lt=ht.stride,bt=Ke.offset;if(ht.isInstancedInterleavedBuffer){for(let St=0;St<Ie.locationSize;St++)L(Ie.location+St,ht.meshPerAttribute);$.isInstancedMesh!==!0&&Se._maxInstanceCount===void 0&&(Se._maxInstanceCount=ht.meshPerAttribute*ht.count)}else for(let St=0;St<Ie.locationSize;St++)I(Ie.location+St);t.bindBuffer(t.ARRAY_BUFFER,jt);for(let St=0;St<Ie.locationSize;St++)B(Ie.location+St,Ee/Ie.locationSize,je,st,lt*ft,(bt+Ee/Ie.locationSize*St)*ft,At)}else{if(Ke.isInstancedBufferAttribute){for(let ht=0;ht<Ie.locationSize;ht++)L(Ie.location+ht,Ke.meshPerAttribute);$.isInstancedMesh!==!0&&Se._maxInstanceCount===void 0&&(Se._maxInstanceCount=Ke.meshPerAttribute*Ke.count)}else for(let ht=0;ht<Ie.locationSize;ht++)I(Ie.location+ht);t.bindBuffer(t.ARRAY_BUFFER,jt);for(let ht=0;ht<Ie.locationSize;ht++)B(Ie.location+ht,Ee/Ie.locationSize,je,st,Ee*ft,Ee/Ie.locationSize*ht*ft,At)}}else if(Me!==void 0){const st=Me[Te];if(st!==void 0)switch(st.length){case 2:t.vertexAttrib2fv(Ie.location,st);break;case 3:t.vertexAttrib3fv(Ie.location,st);break;case 4:t.vertexAttrib4fv(Ie.location,st);break;default:t.vertexAttrib1fv(Ie.location,st)}}}}V()}function X(){se();for(const $ in r){const ce=r[$];for(const Ce in ce){const Se=ce[Ce];for(const Xe in Se)b(Se[Xe].object),delete Se[Xe];delete ce[Ce]}delete r[$]}}function q($){if(r[$.id]===void 0)return;const ce=r[$.id];for(const Ce in ce){const Se=ce[Ce];for(const Xe in Se)b(Se[Xe].object),delete Se[Xe];delete ce[Ce]}delete r[$.id]}function te($){for(const ce in r){const Ce=r[ce];if(Ce[$.id]===void 0)continue;const Se=Ce[$.id];for(const Xe in Se)b(Se[Xe].object),delete Se[Xe];delete Ce[$.id]}}function se(){re(),c=!0,l!==o&&(l=o,y(l.object))}function re(){o.geometry=null,o.program=null,o.wireframe=!1}return{setup:s,reset:se,resetDefaultState:re,dispose:X,releaseStatesOfGeometry:q,releaseStatesOfProgram:te,initAttributes:z,enableAttribute:I,disableUnusedAttributes:V}}function Tpe(t,e,n){let r;function o(y){r=y}function l(y,b){t.drawArrays(r,y,b),n.update(b,r,1)}function c(y,b,w){w!==0&&(t.drawArraysInstanced(r,y,b,w),n.update(b,r,w))}function s(y,b,w){if(w===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,y,0,b,0,w);let T=0;for(let R=0;R<w;R++)T+=b[R];n.update(T,r,1)}function m(y,b,w,E){if(w===0)return;const T=e.get("WEBGL_multi_draw");if(T===null)for(let R=0;R<y.length;R++)c(y[R],b[R],E[R]);else{T.multiDrawArraysInstancedWEBGL(r,y,0,b,0,E,0,w);let R=0;for(let z=0;z<w;z++)R+=b[z]*E[z];n.update(R,r,1)}}this.setMode=o,this.render=l,this.renderInstances=c,this.renderMultiDraw=s,this.renderMultiDrawInstances=m}function Ppe(t,e,n,r){let o;function l(){if(o!==void 0)return o;if(e.has("EXT_texture_filter_anisotropic")===!0){const te=e.get("EXT_texture_filter_anisotropic");o=t.getParameter(te.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o}function c(te){return!(te!==_u&&r.convert(te)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function s(te){const se=te===ax&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(te!==Xd&&r.convert(te)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&te!==Bd&&!se)}function m(te){if(te==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";te="mediump"}return te==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let y=n.precision!==void 0?n.precision:"highp";const b=m(y);b!==y&&(console.warn("THREE.WebGLRenderer:",y,"not supported, using",b,"instead."),y=b);const w=n.logarithmicDepthBuffer===!0,E=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),T=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),R=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),z=t.getParameter(t.MAX_TEXTURE_SIZE),I=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),L=t.getParameter(t.MAX_VERTEX_ATTRIBS),V=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),B=t.getParameter(t.MAX_VARYING_VECTORS),W=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),X=R>0,q=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:l,getMaxPrecision:m,textureFormatReadable:c,textureTypeReadable:s,precision:y,logarithmicDepthBuffer:w,reverseDepthBuffer:E,maxTextures:T,maxVertexTextures:R,maxTextureSize:z,maxCubemapSize:I,maxAttributes:L,maxVertexUniforms:V,maxVaryings:B,maxFragmentUniforms:W,vertexTextures:X,maxSamples:q}}function Ape(t){const e=this;let n=null,r=0,o=!1,l=!1;const c=new Sm,s=new zr,m={value:null,needsUpdate:!1};this.uniform=m,this.numPlanes=0,this.numIntersection=0,this.init=function(w,E){const T=w.length!==0||E||r!==0||o;return o=E,r=w.length,T},this.beginShadows=function(){l=!0,b(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(w,E){n=b(w,E,0)},this.setState=function(w,E,T){const R=w.clippingPlanes,z=w.clipIntersection,I=w.clipShadows,L=t.get(w);if(!o||R===null||R.length===0||l&&!I)l?b(null):y();else{const V=l?0:r,B=V*4;let W=L.clippingState||null;m.value=W,W=b(R,E,B,T);for(let X=0;X!==B;++X)W[X]=n[X];L.clippingState=W,this.numIntersection=z?this.numPlanes:0,this.numPlanes+=V}};function y(){m.value!==n&&(m.value=n,m.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function b(w,E,T,R){const z=w!==null?w.length:0;let I=null;if(z!==0){if(I=m.value,R!==!0||I===null){const L=T+z*4,V=E.matrixWorldInverse;s.getNormalMatrix(V),(I===null||I.length<L)&&(I=new Float32Array(L));for(let B=0,W=T;B!==z;++B,W+=4)c.copy(w[B]).applyMatrix4(V,s),c.normal.toArray(I,W),I[W+3]=c.constant}m.value=I,m.needsUpdate=!0}return e.numPlanes=z,e.numIntersection=0,I}}function Ipe(t){let e=new WeakMap;function n(c,s){return s===iT?c.mapping=ny:s===oT&&(c.mapping=ry),c}function r(c){if(c&&c.isTexture){const s=c.mapping;if(s===iT||s===oT)if(e.has(c)){const m=e.get(c).texture;return n(m,c.mapping)}else{const m=c.image;if(m&&m.height>0){const y=new The(m.height);return y.fromEquirectangularTexture(t,c),e.set(c,y),c.addEventListener("dispose",o),n(y.texture,c.mapping)}else return null}}return c}function o(c){const s=c.target;s.removeEventListener("dispose",o);const m=e.get(s);m!==void 0&&(e.delete(s),m.dispose())}function l(){e=new WeakMap}return{get:r,dispose:l}}const Tv=4,Xz=[.125,.215,.35,.446,.526,.582],Am=20,QE=new Uhe,Zz=new xi;let e2=null,t2=0,n2=0,r2=!1;const Mm=(1+Math.sqrt(5))/2,uv=1/Mm,Yz=[new Pt(-Mm,uv,0),new Pt(Mm,uv,0),new Pt(-uv,0,Mm),new Pt(uv,0,Mm),new Pt(0,Mm,-uv),new Pt(0,Mm,uv),new Pt(-1,1,-1),new Pt(1,1,-1),new Pt(-1,1,1),new Pt(1,1,1)],Rpe=new Pt;class Kz{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,o=100,l={}){const{size:c=256,position:s=Rpe}=l;e2=this._renderer.getRenderTarget(),t2=this._renderer.getActiveCubeFace(),n2=this._renderer.getActiveMipmapLevel(),r2=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(c);const m=this._allocateTargets();return m.depthBuffer=!0,this._sceneToCubeUV(e,r,o,m,s),n>0&&this._blur(m,0,0,n),this._applyPMREM(m),this._cleanup(m),m}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=eO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Qz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(e2,t2,n2),this._renderer.xr.enabled=r2,e.scissorTest=!1,Lb(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===ny||e.mapping===ry?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),e2=this._renderer.getRenderTarget(),t2=this._renderer.getActiveCubeFace(),n2=this._renderer.getActiveMipmapLevel(),r2=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:$l,minFilter:$l,generateMipmaps:!1,type:ax,format:_u,colorSpace:Gm,depthBuffer:!1},o=Jz(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Jz(e,n,r);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Lpe(l)),this._blurMaterial=Dpe(l,e,n)}return o}_compileMaterial(e){const n=new Ja(this._lodPlanes[0],e);this._renderer.compile(n,QE)}_sceneToCubeUV(e,n,r,o,l){const m=new Fl(90,1,n,r),y=[1,-1,1,1,1,1],b=[1,1,1,-1,-1,-1],w=this._renderer,E=w.autoClear,T=w.toneMapping;w.getClearColor(Zz),w.toneMapping=Qf,w.autoClear=!1;const R=new dp({name:"PMREM.Background",side:tl,depthWrite:!1,depthTest:!1}),z=new Ja(new cx,R);let I=!1;const L=e.background;L?L.isColor&&(R.color.copy(L),e.background=null,I=!0):(R.color.copy(Zz),I=!0);for(let V=0;V<6;V++){const B=V%3;B===0?(m.up.set(0,y[V],0),m.position.set(l.x,l.y,l.z),m.lookAt(l.x+b[V],l.y,l.z)):B===1?(m.up.set(0,0,y[V]),m.position.set(l.x,l.y,l.z),m.lookAt(l.x,l.y+b[V],l.z)):(m.up.set(0,y[V],0),m.position.set(l.x,l.y,l.z),m.lookAt(l.x,l.y,l.z+b[V]));const W=this._cubeSize;Lb(o,B*W,V>2?W:0,W,W),w.setRenderTarget(o),I&&w.render(z,m),w.render(e,m)}z.geometry.dispose(),z.material.dispose(),w.toneMapping=T,w.autoClear=E,e.background=L}_textureToCubeUV(e,n){const r=this._renderer,o=e.mapping===ny||e.mapping===ry;o?(this._cubemapMaterial===null&&(this._cubemapMaterial=eO()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Qz());const l=o?this._cubemapMaterial:this._equirectMaterial,c=new Ja(this._lodPlanes[0],l),s=l.uniforms;s.envMap.value=e;const m=this._cubeSize;Lb(n,0,0,3*m,2*m),r.setRenderTarget(n),r.render(c,QE)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const o=this._lodPlanes.length;for(let l=1;l<o;l++){const c=Math.sqrt(this._sigmas[l]*this._sigmas[l]-this._sigmas[l-1]*this._sigmas[l-1]),s=Yz[(o-l-1)%Yz.length];this._blur(e,l-1,l,c,s)}n.autoClear=r}_blur(e,n,r,o,l){const c=this._pingPongRenderTarget;this._halfBlur(e,c,n,r,o,"latitudinal",l),this._halfBlur(c,e,r,r,o,"longitudinal",l)}_halfBlur(e,n,r,o,l,c,s){const m=this._renderer,y=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const b=3,w=new Ja(this._lodPlanes[o],y),E=y.uniforms,T=this._sizeLods[r]-1,R=isFinite(l)?Math.PI/(2*T):2*Math.PI/(2*Am-1),z=l/R,I=isFinite(l)?1+Math.floor(b*z):Am;I>Am&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${I} samples when the maximum is set to ${Am}`);const L=[];let V=0;for(let te=0;te<Am;++te){const se=te/z,re=Math.exp(-se*se/2);L.push(re),te===0?V+=re:te<I&&(V+=2*re)}for(let te=0;te<L.length;te++)L[te]=L[te]/V;E.envMap.value=e.texture,E.samples.value=I,E.weights.value=L,E.latitudinal.value=c==="latitudinal",s&&(E.poleAxis.value=s);const{_lodMax:B}=this;E.dTheta.value=R,E.mipInt.value=B-r;const W=this._sizeLods[o],X=3*W*(o>B-Tv?o-B+Tv:0),q=4*(this._cubeSize-W);Lb(n,X,q,3*W,2*W),m.setRenderTarget(n),m.render(w,QE)}}function Lpe(t){const e=[],n=[],r=[];let o=t;const l=t-Tv+1+Xz.length;for(let c=0;c<l;c++){const s=Math.pow(2,o);n.push(s);let m=1/s;c>t-Tv?m=Xz[c-t+Tv-1]:c===0&&(m=0),r.push(m);const y=1/(s-2),b=-y,w=1+y,E=[b,b,w,b,w,w,b,b,w,w,b,w],T=6,R=6,z=3,I=2,L=1,V=new Float32Array(z*R*T),B=new Float32Array(I*R*T),W=new Float32Array(L*R*T);for(let q=0;q<T;q++){const te=q%3*2/3-1,se=q>2?0:-1,re=[te,se,0,te+2/3,se,0,te+2/3,se+1,0,te,se,0,te+2/3,se+1,0,te,se+1,0];V.set(re,z*R*q),B.set(E,I*R*q);const $=[q,q,q,q,q,q];W.set($,L*R*q)}const X=new kh;X.setAttribute("position",new Th(V,z)),X.setAttribute("uv",new Th(B,I)),X.setAttribute("faceIndex",new Th(W,L)),e.push(X),o>Tv&&o--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function Jz(t,e,n){const r=new hp(t,e,n);return r.texture.mapping=Kw,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Lb(t,e,n,r,o){t.viewport.set(e,n,r,o),t.scissor.set(e,n,r,o)}function Dpe(t,e,n){const r=new Float32Array(Am),o=new Pt(0,1,0);return new Zd({name:"SphericalGaussianBlur",defines:{n:Am,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:WA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Jf,depthTest:!1,depthWrite:!1})}function Qz(){return new Zd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:WA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Jf,depthTest:!1,depthWrite:!1})}function eO(){return new Zd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:WA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Jf,depthTest:!1,depthWrite:!1})}function WA(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function kpe(t){let e=new WeakMap,n=null;function r(s){if(s&&s.isTexture){const m=s.mapping,y=m===iT||m===oT,b=m===ny||m===ry;if(y||b){let w=e.get(s);const E=w!==void 0?w.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==E)return n===null&&(n=new Kz(t)),w=y?n.fromEquirectangular(s,w):n.fromCubemap(s,w),w.texture.pmremVersion=s.pmremVersion,e.set(s,w),w.texture;if(w!==void 0)return w.texture;{const T=s.image;return y&&T&&T.height>0||b&&T&&o(T)?(n===null&&(n=new Kz(t)),w=y?n.fromEquirectangular(s):n.fromCubemap(s),w.texture.pmremVersion=s.pmremVersion,e.set(s,w),s.addEventListener("dispose",l),w.texture):null}}}return s}function o(s){let m=0;const y=6;for(let b=0;b<y;b++)s[b]!==void 0&&m++;return m===y}function l(s){const m=s.target;m.removeEventListener("dispose",l);const y=e.get(m);y!==void 0&&(e.delete(m),y.dispose())}function c(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:c}}function zpe(t){const e={};function n(r){if(e[r]!==void 0)return e[r];let o;switch(r){case"WEBGL_depth_texture":o=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=t.getExtension(r)}return e[r]=o,o}return{has:function(r){return n(r)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(r){const o=n(r);return o===null&&c1("THREE.WebGLRenderer: "+r+" extension not supported."),o}}}function Ope(t,e,n,r){const o={},l=new WeakMap;function c(w){const E=w.target;E.index!==null&&e.remove(E.index);for(const R in E.attributes)e.remove(E.attributes[R]);E.removeEventListener("dispose",c),delete o[E.id];const T=l.get(E);T&&(e.remove(T),l.delete(E)),r.releaseStatesOfGeometry(E),E.isInstancedBufferGeometry===!0&&delete E._maxInstanceCount,n.memory.geometries--}function s(w,E){return o[E.id]===!0||(E.addEventListener("dispose",c),o[E.id]=!0,n.memory.geometries++),E}function m(w){const E=w.attributes;for(const T in E)e.update(E[T],t.ARRAY_BUFFER)}function y(w){const E=[],T=w.index,R=w.attributes.position;let z=0;if(T!==null){const V=T.array;z=T.version;for(let B=0,W=V.length;B<W;B+=3){const X=V[B+0],q=V[B+1],te=V[B+2];E.push(X,q,q,te,te,X)}}else if(R!==void 0){const V=R.array;z=R.version;for(let B=0,W=V.length/3-1;B<W;B+=3){const X=B+0,q=B+1,te=B+2;E.push(X,q,q,te,te,X)}}else return;const I=new(TB(E)?RB:IB)(E,1);I.version=z;const L=l.get(w);L&&e.remove(L),l.set(w,I)}function b(w){const E=l.get(w);if(E){const T=w.index;T!==null&&E.version<T.version&&y(w)}else y(w);return l.get(w)}return{get:s,update:m,getWireframeAttribute:b}}function Fpe(t,e,n){let r;function o(E){r=E}let l,c;function s(E){l=E.type,c=E.bytesPerElement}function m(E,T){t.drawElements(r,T,l,E*c),n.update(T,r,1)}function y(E,T,R){R!==0&&(t.drawElementsInstanced(r,T,l,E*c,R),n.update(T,r,R))}function b(E,T,R){if(R===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,T,0,l,E,0,R);let I=0;for(let L=0;L<R;L++)I+=T[L];n.update(I,r,1)}function w(E,T,R,z){if(R===0)return;const I=e.get("WEBGL_multi_draw");if(I===null)for(let L=0;L<E.length;L++)y(E[L]/c,T[L],z[L]);else{I.multiDrawElementsInstancedWEBGL(r,T,0,l,E,0,z,0,R);let L=0;for(let V=0;V<R;V++)L+=T[V]*z[V];n.update(L,r,1)}}this.setMode=o,this.setIndex=s,this.render=m,this.renderInstances=y,this.renderMultiDraw=b,this.renderMultiDrawInstances=w}function Npe(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(l,c,s){switch(n.calls++,c){case t.TRIANGLES:n.triangles+=s*(l/3);break;case t.LINES:n.lines+=s*(l/2);break;case t.LINE_STRIP:n.lines+=s*(l-1);break;case t.LINE_LOOP:n.lines+=s*l;break;case t.POINTS:n.points+=s*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function o(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:o,update:r}}function Bpe(t,e,n){const r=new WeakMap,o=new ko;function l(c,s,m){const y=c.morphTargetInfluences,b=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,w=b!==void 0?b.length:0;let E=r.get(s);if(E===void 0||E.count!==w){let $=function(){se.dispose(),r.delete(s),s.removeEventListener("dispose",$)};var T=$;E!==void 0&&E.texture.dispose();const R=s.morphAttributes.position!==void 0,z=s.morphAttributes.normal!==void 0,I=s.morphAttributes.color!==void 0,L=s.morphAttributes.position||[],V=s.morphAttributes.normal||[],B=s.morphAttributes.color||[];let W=0;R===!0&&(W=1),z===!0&&(W=2),I===!0&&(W=3);let X=s.attributes.position.count*W,q=1;X>e.maxTextureSize&&(q=Math.ceil(X/e.maxTextureSize),X=e.maxTextureSize);const te=new Float32Array(X*q*4*w),se=new PB(te,X,q,w);se.type=Bd,se.needsUpdate=!0;const re=W*4;for(let ce=0;ce<w;ce++){const Ce=L[ce],Se=V[ce],Xe=B[ce],Fe=X*q*4*ce;for(let Me=0;Me<Ce.count;Me++){const Te=Me*re;R===!0&&(o.fromBufferAttribute(Ce,Me),te[Fe+Te+0]=o.x,te[Fe+Te+1]=o.y,te[Fe+Te+2]=o.z,te[Fe+Te+3]=0),z===!0&&(o.fromBufferAttribute(Se,Me),te[Fe+Te+4]=o.x,te[Fe+Te+5]=o.y,te[Fe+Te+6]=o.z,te[Fe+Te+7]=0),I===!0&&(o.fromBufferAttribute(Xe,Me),te[Fe+Te+8]=o.x,te[Fe+Te+9]=o.y,te[Fe+Te+10]=o.z,te[Fe+Te+11]=Xe.itemSize===4?o.w:1)}}E={count:w,texture:se,size:new mi(X,q)},r.set(s,E),s.addEventListener("dispose",$)}if(c.isInstancedMesh===!0&&c.morphTexture!==null)m.getUniforms().setValue(t,"morphTexture",c.morphTexture,n);else{let R=0;for(let I=0;I<y.length;I++)R+=y[I];const z=s.morphTargetsRelative?1:1-R;m.getUniforms().setValue(t,"morphTargetBaseInfluence",z),m.getUniforms().setValue(t,"morphTargetInfluences",y)}m.getUniforms().setValue(t,"morphTargetsTexture",E.texture,n),m.getUniforms().setValue(t,"morphTargetsTextureSize",E.size)}return{update:l}}function Upe(t,e,n,r){let o=new WeakMap;function l(m){const y=r.render.frame,b=m.geometry,w=e.get(m,b);if(o.get(w)!==y&&(e.update(w),o.set(w,y)),m.isInstancedMesh&&(m.hasEventListener("dispose",s)===!1&&m.addEventListener("dispose",s),o.get(m)!==y&&(n.update(m.instanceMatrix,t.ARRAY_BUFFER),m.instanceColor!==null&&n.update(m.instanceColor,t.ARRAY_BUFFER),o.set(m,y))),m.isSkinnedMesh){const E=m.skeleton;o.get(E)!==y&&(E.update(),o.set(E,y))}return w}function c(){o=new WeakMap}function s(m){const y=m.target;y.removeEventListener("dispose",s),n.remove(y.instanceMatrix),y.instanceColor!==null&&n.remove(y.instanceColor)}return{update:l,dispose:c}}const FB=new Xs,tO=new zB(1,1),NB=new PB,BB=new uhe,UB=new kB,nO=[],rO=[],iO=new Float32Array(16),oO=new Float32Array(9),sO=new Float32Array(4);function gy(t,e,n){const r=t[0];if(r<=0||r>0)return t;const o=e*n;let l=nO[o];if(l===void 0&&(l=new Float32Array(o),nO[o]=l),e!==0){r.toArray(l,0);for(let c=1,s=0;c!==e;++c)s+=n,t[c].toArray(l,s)}return l}function ms(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function gs(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function Qw(t,e){let n=rO[e];n===void 0&&(n=new Int32Array(e),rO[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function $pe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Vpe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ms(n,e))return;t.uniform2fv(this.addr,e),gs(n,e)}}function jpe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(ms(n,e))return;t.uniform3fv(this.addr,e),gs(n,e)}}function Hpe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ms(n,e))return;t.uniform4fv(this.addr,e),gs(n,e)}}function Gpe(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(ms(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),gs(n,e)}else{if(ms(n,r))return;sO.set(r),t.uniformMatrix2fv(this.addr,!1,sO),gs(n,r)}}function Wpe(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(ms(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),gs(n,e)}else{if(ms(n,r))return;oO.set(r),t.uniformMatrix3fv(this.addr,!1,oO),gs(n,r)}}function qpe(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(ms(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),gs(n,e)}else{if(ms(n,r))return;iO.set(r),t.uniformMatrix4fv(this.addr,!1,iO),gs(n,r)}}function Xpe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Zpe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ms(n,e))return;t.uniform2iv(this.addr,e),gs(n,e)}}function Ype(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(ms(n,e))return;t.uniform3iv(this.addr,e),gs(n,e)}}function Kpe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ms(n,e))return;t.uniform4iv(this.addr,e),gs(n,e)}}function Jpe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Qpe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ms(n,e))return;t.uniform2uiv(this.addr,e),gs(n,e)}}function eme(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(ms(n,e))return;t.uniform3uiv(this.addr,e),gs(n,e)}}function tme(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ms(n,e))return;t.uniform4uiv(this.addr,e),gs(n,e)}}function nme(t,e,n){const r=this.cache,o=n.allocateTextureUnit();r[0]!==o&&(t.uniform1i(this.addr,o),r[0]=o);let l;this.type===t.SAMPLER_2D_SHADOW?(tO.compareFunction=EB,l=tO):l=FB,n.setTexture2D(e||l,o)}function rme(t,e,n){const r=this.cache,o=n.allocateTextureUnit();r[0]!==o&&(t.uniform1i(this.addr,o),r[0]=o),n.setTexture3D(e||BB,o)}function ime(t,e,n){const r=this.cache,o=n.allocateTextureUnit();r[0]!==o&&(t.uniform1i(this.addr,o),r[0]=o),n.setTextureCube(e||UB,o)}function ome(t,e,n){const r=this.cache,o=n.allocateTextureUnit();r[0]!==o&&(t.uniform1i(this.addr,o),r[0]=o),n.setTexture2DArray(e||NB,o)}function sme(t){switch(t){case 5126:return $pe;case 35664:return Vpe;case 35665:return jpe;case 35666:return Hpe;case 35674:return Gpe;case 35675:return Wpe;case 35676:return qpe;case 5124:case 35670:return Xpe;case 35667:case 35671:return Zpe;case 35668:case 35672:return Ype;case 35669:case 35673:return Kpe;case 5125:return Jpe;case 36294:return Qpe;case 36295:return eme;case 36296:return tme;case 35678:case 36198:case 36298:case 36306:case 35682:return nme;case 35679:case 36299:case 36307:return rme;case 35680:case 36300:case 36308:case 36293:return ime;case 36289:case 36303:case 36311:case 36292:return ome}}function ame(t,e){t.uniform1fv(this.addr,e)}function lme(t,e){const n=gy(e,this.size,2);t.uniform2fv(this.addr,n)}function cme(t,e){const n=gy(e,this.size,3);t.uniform3fv(this.addr,n)}function ume(t,e){const n=gy(e,this.size,4);t.uniform4fv(this.addr,n)}function hme(t,e){const n=gy(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function dme(t,e){const n=gy(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function fme(t,e){const n=gy(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function pme(t,e){t.uniform1iv(this.addr,e)}function mme(t,e){t.uniform2iv(this.addr,e)}function gme(t,e){t.uniform3iv(this.addr,e)}function vme(t,e){t.uniform4iv(this.addr,e)}function yme(t,e){t.uniform1uiv(this.addr,e)}function _me(t,e){t.uniform2uiv(this.addr,e)}function xme(t,e){t.uniform3uiv(this.addr,e)}function bme(t,e){t.uniform4uiv(this.addr,e)}function wme(t,e,n){const r=this.cache,o=e.length,l=Qw(n,o);ms(r,l)||(t.uniform1iv(this.addr,l),gs(r,l));for(let c=0;c!==o;++c)n.setTexture2D(e[c]||FB,l[c])}function Sme(t,e,n){const r=this.cache,o=e.length,l=Qw(n,o);ms(r,l)||(t.uniform1iv(this.addr,l),gs(r,l));for(let c=0;c!==o;++c)n.setTexture3D(e[c]||BB,l[c])}function Mme(t,e,n){const r=this.cache,o=e.length,l=Qw(n,o);ms(r,l)||(t.uniform1iv(this.addr,l),gs(r,l));for(let c=0;c!==o;++c)n.setTextureCube(e[c]||UB,l[c])}function Cme(t,e,n){const r=this.cache,o=e.length,l=Qw(n,o);ms(r,l)||(t.uniform1iv(this.addr,l),gs(r,l));for(let c=0;c!==o;++c)n.setTexture2DArray(e[c]||NB,l[c])}function Eme(t){switch(t){case 5126:return ame;case 35664:return lme;case 35665:return cme;case 35666:return ume;case 35674:return hme;case 35675:return dme;case 35676:return fme;case 5124:case 35670:return pme;case 35667:case 35671:return mme;case 35668:case 35672:return gme;case 35669:case 35673:return vme;case 5125:return yme;case 36294:return _me;case 36295:return xme;case 36296:return bme;case 35678:case 36198:case 36298:case 36306:case 35682:return wme;case 35679:case 36299:case 36307:return Sme;case 35680:case 36300:case 36308:case 36293:return Mme;case 36289:case 36303:case 36311:case 36292:return Cme}}class Tme{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.setValue=sme(n.type)}}class Pme{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=Eme(n.type)}}class Ame{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const o=this.seq;for(let l=0,c=o.length;l!==c;++l){const s=o[l];s.setValue(e,n[s.id],r)}}}const i2=/(\w+)(\])?(\[|\.)?/g;function aO(t,e){t.seq.push(e),t.map[e.id]=e}function Ime(t,e,n){const r=t.name,o=r.length;for(i2.lastIndex=0;;){const l=i2.exec(r),c=i2.lastIndex;let s=l[1];const m=l[2]==="]",y=l[3];if(m&&(s=s|0),y===void 0||y==="["&&c+2===o){aO(n,y===void 0?new Tme(s,t,e):new Pme(s,t,e));break}else{let w=n.map[s];w===void 0&&(w=new Ame(s),aO(n,w)),n=w}}}class u1{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let o=0;o<r;++o){const l=e.getActiveUniform(n,o),c=e.getUniformLocation(n,l.name);Ime(l,c,this)}}setValue(e,n,r,o){const l=this.map[n];l!==void 0&&l.setValue(e,r,o)}setOptional(e,n,r){const o=n[r];o!==void 0&&this.setValue(e,r,o)}static upload(e,n,r,o){for(let l=0,c=n.length;l!==c;++l){const s=n[l],m=r[s.id];m.needsUpdate!==!1&&s.setValue(e,m.value,o)}}static seqWithValue(e,n){const r=[];for(let o=0,l=e.length;o!==l;++o){const c=e[o];c.id in n&&r.push(c)}return r}}function lO(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}const Rme=37297;let Lme=0;function Dme(t,e){const n=t.split(`
`),r=[],o=Math.max(e-6,0),l=Math.min(e+6,n.length);for(let c=o;c<l;c++){const s=c+1;r.push(`${s===e?">":" "} ${s}: ${n[c]}`)}return r.join(`
`)}const cO=new zr;function kme(t){li._getMatrix(cO,li.workingColorSpace,t);const e=`mat3( ${cO.elements.map(n=>n.toFixed(4))} )`;switch(li.getTransfer(t)){case $1:return[e,"LinearTransferOETF"];case Ri:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function uO(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),o=t.getShaderInfoLog(e).trim();if(r&&o==="")return"";const l=/ERROR: 0:(\d+)/.exec(o);if(l){const c=parseInt(l[1]);return n.toUpperCase()+`

`+o+`

`+Dme(t.getShaderSource(e),c)}else return o}function zme(t,e){const n=kme(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function Ome(t,e){let n;switch(e){case pB:n="Linear";break;case bue:n="Reinhard";break;case wue:n="Cineon";break;case Sue:n="ACESFilmic";break;case Cue:n="AgX";break;case Eue:n="Neutral";break;case Mue:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Db=new Pt;function Fme(){li.getLuminanceCoefficients(Db);const t=Db.x.toFixed(4),e=Db.y.toFixed(4),n=Db.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Nme(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(R0).join(`
`)}function Bme(t){const e=[];for(const n in t){const r=t[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function Ume(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let o=0;o<r;o++){const l=t.getActiveAttrib(e,o),c=l.name;let s=1;l.type===t.FLOAT_MAT2&&(s=2),l.type===t.FLOAT_MAT3&&(s=3),l.type===t.FLOAT_MAT4&&(s=4),n[c]={type:l.type,location:t.getAttribLocation(e,c),locationSize:s}}return n}function R0(t){return t!==""}function hO(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function dO(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const $me=/^[ \t]*#include +<([\w\d./]+)>/gm;function OT(t){return t.replace($me,jme)}const Vme=new Map;function jme(t,e){let n=Br[e];if(n===void 0){const r=Vme.get(e);if(r!==void 0)n=Br[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return OT(n)}const Hme=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function fO(t){return t.replace(Hme,Gme)}function Gme(t,e,n,r){let o="";for(let l=parseInt(e);l<parseInt(n);l++)o+=r.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return o}function pO(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Wme(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===dB?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===eue?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Od&&(e="SHADOWMAP_TYPE_VSM"),e}function qme(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case ny:case ry:e="ENVMAP_TYPE_CUBE";break;case Kw:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Xme(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case ry:e="ENVMAP_MODE_REFRACTION";break}return e}function Zme(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case fB:e="ENVMAP_BLENDING_MULTIPLY";break;case _ue:e="ENVMAP_BLENDING_MIX";break;case xue:e="ENVMAP_BLENDING_ADD";break}return e}function Yme(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function Kme(t,e,n,r){const o=t.getContext(),l=n.defines;let c=n.vertexShader,s=n.fragmentShader;const m=Wme(n),y=qme(n),b=Xme(n),w=Zme(n),E=Yme(n),T=Nme(n),R=Bme(l),z=o.createProgram();let I,L,V=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(I=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,R].filter(R0).join(`
`),I.length>0&&(I+=`
`),L=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,R].filter(R0).join(`
`),L.length>0&&(L+=`
`)):(I=[pO(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,R,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+b:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+m:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(R0).join(`
`),L=[pO(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,R,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+y:"",n.envMap?"#define "+b:"",n.envMap?"#define "+w:"",E?"#define CUBEUV_TEXEL_WIDTH "+E.texelWidth:"",E?"#define CUBEUV_TEXEL_HEIGHT "+E.texelHeight:"",E?"#define CUBEUV_MAX_MIP "+E.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+m:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Qf?"#define TONE_MAPPING":"",n.toneMapping!==Qf?Br.tonemapping_pars_fragment:"",n.toneMapping!==Qf?Ome("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Br.colorspace_pars_fragment,zme("linearToOutputTexel",n.outputColorSpace),Fme(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(R0).join(`
`)),c=OT(c),c=hO(c,n),c=dO(c,n),s=OT(s),s=hO(s,n),s=dO(s,n),c=fO(c),s=fO(s),n.isRawShaderMaterial!==!0&&(V=`#version 300 es
`,I=[T,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+I,L=["#define varying in",n.glslVersion===bz?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===bz?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+L);const B=V+I+c,W=V+L+s,X=lO(o,o.VERTEX_SHADER,B),q=lO(o,o.FRAGMENT_SHADER,W);o.attachShader(z,X),o.attachShader(z,q),n.index0AttributeName!==void 0?o.bindAttribLocation(z,0,n.index0AttributeName):n.morphTargets===!0&&o.bindAttribLocation(z,0,"position"),o.linkProgram(z);function te(ce){if(t.debug.checkShaderErrors){const Ce=o.getProgramInfoLog(z).trim(),Se=o.getShaderInfoLog(X).trim(),Xe=o.getShaderInfoLog(q).trim();let Fe=!0,Me=!0;if(o.getProgramParameter(z,o.LINK_STATUS)===!1)if(Fe=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(o,z,X,q);else{const Te=uO(o,X,"vertex"),Ie=uO(o,q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(z,o.VALIDATE_STATUS)+`

Material Name: `+ce.name+`
Material Type: `+ce.type+`

Program Info Log: `+Ce+`
`+Te+`
`+Ie)}else Ce!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Ce):(Se===""||Xe==="")&&(Me=!1);Me&&(ce.diagnostics={runnable:Fe,programLog:Ce,vertexShader:{log:Se,prefix:I},fragmentShader:{log:Xe,prefix:L}})}o.deleteShader(X),o.deleteShader(q),se=new u1(o,z),re=Ume(o,z)}let se;this.getUniforms=function(){return se===void 0&&te(this),se};let re;this.getAttributes=function(){return re===void 0&&te(this),re};let $=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return $===!1&&($=o.getProgramParameter(z,Rme)),$},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(z),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Lme++,this.cacheKey=e,this.usedTimes=1,this.program=z,this.vertexShader=X,this.fragmentShader=q,this}let Jme=0;class Qme{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,o=this._getShaderStage(n),l=this._getShaderStage(r),c=this._getShaderCacheForMaterial(e);return c.has(o)===!1&&(c.add(o),o.usedTimes++),c.has(l)===!1&&(c.add(l),l.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new ege(e),n.set(e,r)),r}}class ege{constructor(e){this.id=Jme++,this.code=e,this.usedTimes=0}}function tge(t,e,n,r,o,l,c){const s=new jA,m=new Qme,y=new Set,b=[],w=o.logarithmicDepthBuffer,E=o.vertexTextures;let T=o.precision;const R={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function z(re){return y.add(re),re===0?"uv":`uv${re}`}function I(re,$,ce,Ce,Se){const Xe=Ce.fog,Fe=Se.geometry,Me=re.isMeshStandardMaterial?Ce.environment:null,Te=(re.isMeshStandardMaterial?n:e).get(re.envMap||Me),Ie=Te&&Te.mapping===Kw?Te.image.height:null,Ke=R[re.type];re.precision!==null&&(T=o.getMaxPrecision(re.precision),T!==re.precision&&console.warn("THREE.WebGLProgram.getParameters:",re.precision,"not supported, using",T,"instead."));const st=Fe.morphAttributes.position||Fe.morphAttributes.normal||Fe.morphAttributes.color,Ee=st!==void 0?st.length:0;let Qe=0;Fe.morphAttributes.position!==void 0&&(Qe=1),Fe.morphAttributes.normal!==void 0&&(Qe=2),Fe.morphAttributes.color!==void 0&&(Qe=3);let jt,je,ft,At;if(Ke){const Re=_h[Ke];jt=Re.vertexShader,je=Re.fragmentShader}else jt=re.vertexShader,je=re.fragmentShader,m.update(re),ft=m.getVertexShaderID(re),At=m.getFragmentShaderID(re);const ht=t.getRenderTarget(),lt=t.state.buffers.depth.getReversed(),bt=Se.isInstancedMesh===!0,St=Se.isBatchedMesh===!0,dn=!!re.map,En=!!re.matcap,un=!!Te,et=!!re.aoMap,Ln=!!re.lightMap,Jt=!!re.bumpMap,fn=!!re.normalMap,$t=!!re.displacementMap,Nn=!!re.emissiveMap,vn=!!re.metalnessMap,Ue=!!re.roughnessMap,we=re.anisotropy>0,yt=re.clearcoat>0,Nt=re.dispersion>0,Ht=re.iridescence>0,Ot=re.sheen>0,ln=re.transmission>0,Gt=we&&!!re.anisotropyMap,Zt=yt&&!!re.clearcoatMap,Fn=yt&&!!re.clearcoatNormalMap,Yt=yt&&!!re.clearcoatRoughnessMap,Pe=Ht&&!!re.iridescenceMap,ae=Ht&&!!re.iridescenceThicknessMap,ue=Ot&&!!re.sheenColorMap,ee=Ot&&!!re.sheenRoughnessMap,fe=!!re.specularMap,Oe=!!re.specularColorMap,Ye=!!re.specularIntensityMap,ye=ln&&!!re.transmissionMap,Ae=ln&&!!re.thicknessMap,Be=!!re.gradientMap,$e=!!re.alphaMap,He=re.alphaTest>0,ut=!!re.alphaHash,We=!!re.extensions;let Ut=Qf;re.toneMapped&&(ht===null||ht.isXRRenderTarget===!0)&&(Ut=t.toneMapping);const Kt={shaderID:Ke,shaderType:re.type,shaderName:re.name,vertexShader:jt,fragmentShader:je,defines:re.defines,customVertexShaderID:ft,customFragmentShaderID:At,isRawShaderMaterial:re.isRawShaderMaterial===!0,glslVersion:re.glslVersion,precision:T,batching:St,batchingColor:St&&Se._colorsTexture!==null,instancing:bt,instancingColor:bt&&Se.instanceColor!==null,instancingMorph:bt&&Se.morphTexture!==null,supportsVertexTextures:E,outputColorSpace:ht===null?t.outputColorSpace:ht.isXRRenderTarget===!0?ht.texture.colorSpace:Gm,alphaToCoverage:!!re.alphaToCoverage,map:dn,matcap:En,envMap:un,envMapMode:un&&Te.mapping,envMapCubeUVHeight:Ie,aoMap:et,lightMap:Ln,bumpMap:Jt,normalMap:fn,displacementMap:E&&$t,emissiveMap:Nn,normalMapObjectSpace:fn&&re.normalMapType===Rue,normalMapTangentSpace:fn&&re.normalMapType===Iue,metalnessMap:vn,roughnessMap:Ue,anisotropy:we,anisotropyMap:Gt,clearcoat:yt,clearcoatMap:Zt,clearcoatNormalMap:Fn,clearcoatRoughnessMap:Yt,dispersion:Nt,iridescence:Ht,iridescenceMap:Pe,iridescenceThicknessMap:ae,sheen:Ot,sheenColorMap:ue,sheenRoughnessMap:ee,specularMap:fe,specularColorMap:Oe,specularIntensityMap:Ye,transmission:ln,transmissionMap:ye,thicknessMap:Ae,gradientMap:Be,opaque:re.transparent===!1&&re.blending===Bv&&re.alphaToCoverage===!1,alphaMap:$e,alphaTest:He,alphaHash:ut,combine:re.combine,mapUv:dn&&z(re.map.channel),aoMapUv:et&&z(re.aoMap.channel),lightMapUv:Ln&&z(re.lightMap.channel),bumpMapUv:Jt&&z(re.bumpMap.channel),normalMapUv:fn&&z(re.normalMap.channel),displacementMapUv:$t&&z(re.displacementMap.channel),emissiveMapUv:Nn&&z(re.emissiveMap.channel),metalnessMapUv:vn&&z(re.metalnessMap.channel),roughnessMapUv:Ue&&z(re.roughnessMap.channel),anisotropyMapUv:Gt&&z(re.anisotropyMap.channel),clearcoatMapUv:Zt&&z(re.clearcoatMap.channel),clearcoatNormalMapUv:Fn&&z(re.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Yt&&z(re.clearcoatRoughnessMap.channel),iridescenceMapUv:Pe&&z(re.iridescenceMap.channel),iridescenceThicknessMapUv:ae&&z(re.iridescenceThicknessMap.channel),sheenColorMapUv:ue&&z(re.sheenColorMap.channel),sheenRoughnessMapUv:ee&&z(re.sheenRoughnessMap.channel),specularMapUv:fe&&z(re.specularMap.channel),specularColorMapUv:Oe&&z(re.specularColorMap.channel),specularIntensityMapUv:Ye&&z(re.specularIntensityMap.channel),transmissionMapUv:ye&&z(re.transmissionMap.channel),thicknessMapUv:Ae&&z(re.thicknessMap.channel),alphaMapUv:$e&&z(re.alphaMap.channel),vertexTangents:!!Fe.attributes.tangent&&(fn||we),vertexColors:re.vertexColors,vertexAlphas:re.vertexColors===!0&&!!Fe.attributes.color&&Fe.attributes.color.itemSize===4,pointsUvs:Se.isPoints===!0&&!!Fe.attributes.uv&&(dn||$e),fog:!!Xe,useFog:re.fog===!0,fogExp2:!!Xe&&Xe.isFogExp2,flatShading:re.flatShading===!0,sizeAttenuation:re.sizeAttenuation===!0,logarithmicDepthBuffer:w,reverseDepthBuffer:lt,skinning:Se.isSkinnedMesh===!0,morphTargets:Fe.morphAttributes.position!==void 0,morphNormals:Fe.morphAttributes.normal!==void 0,morphColors:Fe.morphAttributes.color!==void 0,morphTargetsCount:Ee,morphTextureStride:Qe,numDirLights:$.directional.length,numPointLights:$.point.length,numSpotLights:$.spot.length,numSpotLightMaps:$.spotLightMap.length,numRectAreaLights:$.rectArea.length,numHemiLights:$.hemi.length,numDirLightShadows:$.directionalShadowMap.length,numPointLightShadows:$.pointShadowMap.length,numSpotLightShadows:$.spotShadowMap.length,numSpotLightShadowsWithMaps:$.numSpotLightShadowsWithMaps,numLightProbes:$.numLightProbes,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:re.dithering,shadowMapEnabled:t.shadowMap.enabled&&ce.length>0,shadowMapType:t.shadowMap.type,toneMapping:Ut,decodeVideoTexture:dn&&re.map.isVideoTexture===!0&&li.getTransfer(re.map.colorSpace)===Ri,decodeVideoTextureEmissive:Nn&&re.emissiveMap.isVideoTexture===!0&&li.getTransfer(re.emissiveMap.colorSpace)===Ri,premultipliedAlpha:re.premultipliedAlpha,doubleSided:re.side===Nd,flipSided:re.side===tl,useDepthPacking:re.depthPacking>=0,depthPacking:re.depthPacking||0,index0AttributeName:re.index0AttributeName,extensionClipCullDistance:We&&re.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(We&&re.extensions.multiDraw===!0||St)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:re.customProgramCacheKey()};return Kt.vertexUv1s=y.has(1),Kt.vertexUv2s=y.has(2),Kt.vertexUv3s=y.has(3),y.clear(),Kt}function L(re){const $=[];if(re.shaderID?$.push(re.shaderID):($.push(re.customVertexShaderID),$.push(re.customFragmentShaderID)),re.defines!==void 0)for(const ce in re.defines)$.push(ce),$.push(re.defines[ce]);return re.isRawShaderMaterial===!1&&(V($,re),B($,re),$.push(t.outputColorSpace)),$.push(re.customProgramCacheKey),$.join()}function V(re,$){re.push($.precision),re.push($.outputColorSpace),re.push($.envMapMode),re.push($.envMapCubeUVHeight),re.push($.mapUv),re.push($.alphaMapUv),re.push($.lightMapUv),re.push($.aoMapUv),re.push($.bumpMapUv),re.push($.normalMapUv),re.push($.displacementMapUv),re.push($.emissiveMapUv),re.push($.metalnessMapUv),re.push($.roughnessMapUv),re.push($.anisotropyMapUv),re.push($.clearcoatMapUv),re.push($.clearcoatNormalMapUv),re.push($.clearcoatRoughnessMapUv),re.push($.iridescenceMapUv),re.push($.iridescenceThicknessMapUv),re.push($.sheenColorMapUv),re.push($.sheenRoughnessMapUv),re.push($.specularMapUv),re.push($.specularColorMapUv),re.push($.specularIntensityMapUv),re.push($.transmissionMapUv),re.push($.thicknessMapUv),re.push($.combine),re.push($.fogExp2),re.push($.sizeAttenuation),re.push($.morphTargetsCount),re.push($.morphAttributeCount),re.push($.numDirLights),re.push($.numPointLights),re.push($.numSpotLights),re.push($.numSpotLightMaps),re.push($.numHemiLights),re.push($.numRectAreaLights),re.push($.numDirLightShadows),re.push($.numPointLightShadows),re.push($.numSpotLightShadows),re.push($.numSpotLightShadowsWithMaps),re.push($.numLightProbes),re.push($.shadowMapType),re.push($.toneMapping),re.push($.numClippingPlanes),re.push($.numClipIntersection),re.push($.depthPacking)}function B(re,$){s.disableAll(),$.supportsVertexTextures&&s.enable(0),$.instancing&&s.enable(1),$.instancingColor&&s.enable(2),$.instancingMorph&&s.enable(3),$.matcap&&s.enable(4),$.envMap&&s.enable(5),$.normalMapObjectSpace&&s.enable(6),$.normalMapTangentSpace&&s.enable(7),$.clearcoat&&s.enable(8),$.iridescence&&s.enable(9),$.alphaTest&&s.enable(10),$.vertexColors&&s.enable(11),$.vertexAlphas&&s.enable(12),$.vertexUv1s&&s.enable(13),$.vertexUv2s&&s.enable(14),$.vertexUv3s&&s.enable(15),$.vertexTangents&&s.enable(16),$.anisotropy&&s.enable(17),$.alphaHash&&s.enable(18),$.batching&&s.enable(19),$.dispersion&&s.enable(20),$.batchingColor&&s.enable(21),re.push(s.mask),s.disableAll(),$.fog&&s.enable(0),$.useFog&&s.enable(1),$.flatShading&&s.enable(2),$.logarithmicDepthBuffer&&s.enable(3),$.reverseDepthBuffer&&s.enable(4),$.skinning&&s.enable(5),$.morphTargets&&s.enable(6),$.morphNormals&&s.enable(7),$.morphColors&&s.enable(8),$.premultipliedAlpha&&s.enable(9),$.shadowMapEnabled&&s.enable(10),$.doubleSided&&s.enable(11),$.flipSided&&s.enable(12),$.useDepthPacking&&s.enable(13),$.dithering&&s.enable(14),$.transmission&&s.enable(15),$.sheen&&s.enable(16),$.opaque&&s.enable(17),$.pointsUvs&&s.enable(18),$.decodeVideoTexture&&s.enable(19),$.decodeVideoTextureEmissive&&s.enable(20),$.alphaToCoverage&&s.enable(21),re.push(s.mask)}function W(re){const $=R[re.type];let ce;if($){const Ce=_h[$];ce=She.clone(Ce.uniforms)}else ce=re.uniforms;return ce}function X(re,$){let ce;for(let Ce=0,Se=b.length;Ce<Se;Ce++){const Xe=b[Ce];if(Xe.cacheKey===$){ce=Xe,++ce.usedTimes;break}}return ce===void 0&&(ce=new Kme(t,$,re,l),b.push(ce)),ce}function q(re){if(--re.usedTimes===0){const $=b.indexOf(re);b[$]=b[b.length-1],b.pop(),re.destroy()}}function te(re){m.remove(re)}function se(){m.dispose()}return{getParameters:I,getProgramCacheKey:L,getUniforms:W,acquireProgram:X,releaseProgram:q,releaseShaderCache:te,programs:b,dispose:se}}function nge(){let t=new WeakMap;function e(c){return t.has(c)}function n(c){let s=t.get(c);return s===void 0&&(s={},t.set(c,s)),s}function r(c){t.delete(c)}function o(c,s,m){t.get(c)[s]=m}function l(){t=new WeakMap}return{has:e,get:n,remove:r,update:o,dispose:l}}function rge(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function mO(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function gO(){const t=[];let e=0;const n=[],r=[],o=[];function l(){e=0,n.length=0,r.length=0,o.length=0}function c(w,E,T,R,z,I){let L=t[e];return L===void 0?(L={id:w.id,object:w,geometry:E,material:T,groupOrder:R,renderOrder:w.renderOrder,z,group:I},t[e]=L):(L.id=w.id,L.object=w,L.geometry=E,L.material=T,L.groupOrder=R,L.renderOrder=w.renderOrder,L.z=z,L.group=I),e++,L}function s(w,E,T,R,z,I){const L=c(w,E,T,R,z,I);T.transmission>0?r.push(L):T.transparent===!0?o.push(L):n.push(L)}function m(w,E,T,R,z,I){const L=c(w,E,T,R,z,I);T.transmission>0?r.unshift(L):T.transparent===!0?o.unshift(L):n.unshift(L)}function y(w,E){n.length>1&&n.sort(w||rge),r.length>1&&r.sort(E||mO),o.length>1&&o.sort(E||mO)}function b(){for(let w=e,E=t.length;w<E;w++){const T=t[w];if(T.id===null)break;T.id=null,T.object=null,T.geometry=null,T.material=null,T.group=null}}return{opaque:n,transmissive:r,transparent:o,init:l,push:s,unshift:m,finish:b,sort:y}}function ige(){let t=new WeakMap;function e(r,o){const l=t.get(r);let c;return l===void 0?(c=new gO,t.set(r,[c])):o>=l.length?(c=new gO,l.push(c)):c=l[o],c}function n(){t=new WeakMap}return{get:e,dispose:n}}function oge(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Pt,color:new xi};break;case"SpotLight":n={position:new Pt,direction:new Pt,color:new xi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Pt,color:new xi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Pt,skyColor:new xi,groundColor:new xi};break;case"RectAreaLight":n={color:new xi,position:new Pt,halfWidth:new Pt,halfHeight:new Pt};break}return t[e.id]=n,n}}}function sge(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mi};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mi};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new mi,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let age=0;function lge(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function cge(t){const e=new oge,n=sge(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let y=0;y<9;y++)r.probe.push(new Pt);const o=new Pt,l=new Ti,c=new Ti;function s(y){let b=0,w=0,E=0;for(let re=0;re<9;re++)r.probe[re].set(0,0,0);let T=0,R=0,z=0,I=0,L=0,V=0,B=0,W=0,X=0,q=0,te=0;y.sort(lge);for(let re=0,$=y.length;re<$;re++){const ce=y[re],Ce=ce.color,Se=ce.intensity,Xe=ce.distance,Fe=ce.shadow&&ce.shadow.map?ce.shadow.map.texture:null;if(ce.isAmbientLight)b+=Ce.r*Se,w+=Ce.g*Se,E+=Ce.b*Se;else if(ce.isLightProbe){for(let Me=0;Me<9;Me++)r.probe[Me].addScaledVector(ce.sh.coefficients[Me],Se);te++}else if(ce.isDirectionalLight){const Me=e.get(ce);if(Me.color.copy(ce.color).multiplyScalar(ce.intensity),ce.castShadow){const Te=ce.shadow,Ie=n.get(ce);Ie.shadowIntensity=Te.intensity,Ie.shadowBias=Te.bias,Ie.shadowNormalBias=Te.normalBias,Ie.shadowRadius=Te.radius,Ie.shadowMapSize=Te.mapSize,r.directionalShadow[T]=Ie,r.directionalShadowMap[T]=Fe,r.directionalShadowMatrix[T]=ce.shadow.matrix,V++}r.directional[T]=Me,T++}else if(ce.isSpotLight){const Me=e.get(ce);Me.position.setFromMatrixPosition(ce.matrixWorld),Me.color.copy(Ce).multiplyScalar(Se),Me.distance=Xe,Me.coneCos=Math.cos(ce.angle),Me.penumbraCos=Math.cos(ce.angle*(1-ce.penumbra)),Me.decay=ce.decay,r.spot[z]=Me;const Te=ce.shadow;if(ce.map&&(r.spotLightMap[X]=ce.map,X++,Te.updateMatrices(ce),ce.castShadow&&q++),r.spotLightMatrix[z]=Te.matrix,ce.castShadow){const Ie=n.get(ce);Ie.shadowIntensity=Te.intensity,Ie.shadowBias=Te.bias,Ie.shadowNormalBias=Te.normalBias,Ie.shadowRadius=Te.radius,Ie.shadowMapSize=Te.mapSize,r.spotShadow[z]=Ie,r.spotShadowMap[z]=Fe,W++}z++}else if(ce.isRectAreaLight){const Me=e.get(ce);Me.color.copy(Ce).multiplyScalar(Se),Me.halfWidth.set(ce.width*.5,0,0),Me.halfHeight.set(0,ce.height*.5,0),r.rectArea[I]=Me,I++}else if(ce.isPointLight){const Me=e.get(ce);if(Me.color.copy(ce.color).multiplyScalar(ce.intensity),Me.distance=ce.distance,Me.decay=ce.decay,ce.castShadow){const Te=ce.shadow,Ie=n.get(ce);Ie.shadowIntensity=Te.intensity,Ie.shadowBias=Te.bias,Ie.shadowNormalBias=Te.normalBias,Ie.shadowRadius=Te.radius,Ie.shadowMapSize=Te.mapSize,Ie.shadowCameraNear=Te.camera.near,Ie.shadowCameraFar=Te.camera.far,r.pointShadow[R]=Ie,r.pointShadowMap[R]=Fe,r.pointShadowMatrix[R]=ce.shadow.matrix,B++}r.point[R]=Me,R++}else if(ce.isHemisphereLight){const Me=e.get(ce);Me.skyColor.copy(ce.color).multiplyScalar(Se),Me.groundColor.copy(ce.groundColor).multiplyScalar(Se),r.hemi[L]=Me,L++}}I>0&&(t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=qn.LTC_FLOAT_1,r.rectAreaLTC2=qn.LTC_FLOAT_2):(r.rectAreaLTC1=qn.LTC_HALF_1,r.rectAreaLTC2=qn.LTC_HALF_2)),r.ambient[0]=b,r.ambient[1]=w,r.ambient[2]=E;const se=r.hash;(se.directionalLength!==T||se.pointLength!==R||se.spotLength!==z||se.rectAreaLength!==I||se.hemiLength!==L||se.numDirectionalShadows!==V||se.numPointShadows!==B||se.numSpotShadows!==W||se.numSpotMaps!==X||se.numLightProbes!==te)&&(r.directional.length=T,r.spot.length=z,r.rectArea.length=I,r.point.length=R,r.hemi.length=L,r.directionalShadow.length=V,r.directionalShadowMap.length=V,r.pointShadow.length=B,r.pointShadowMap.length=B,r.spotShadow.length=W,r.spotShadowMap.length=W,r.directionalShadowMatrix.length=V,r.pointShadowMatrix.length=B,r.spotLightMatrix.length=W+X-q,r.spotLightMap.length=X,r.numSpotLightShadowsWithMaps=q,r.numLightProbes=te,se.directionalLength=T,se.pointLength=R,se.spotLength=z,se.rectAreaLength=I,se.hemiLength=L,se.numDirectionalShadows=V,se.numPointShadows=B,se.numSpotShadows=W,se.numSpotMaps=X,se.numLightProbes=te,r.version=age++)}function m(y,b){let w=0,E=0,T=0,R=0,z=0;const I=b.matrixWorldInverse;for(let L=0,V=y.length;L<V;L++){const B=y[L];if(B.isDirectionalLight){const W=r.directional[w];W.direction.setFromMatrixPosition(B.matrixWorld),o.setFromMatrixPosition(B.target.matrixWorld),W.direction.sub(o),W.direction.transformDirection(I),w++}else if(B.isSpotLight){const W=r.spot[T];W.position.setFromMatrixPosition(B.matrixWorld),W.position.applyMatrix4(I),W.direction.setFromMatrixPosition(B.matrixWorld),o.setFromMatrixPosition(B.target.matrixWorld),W.direction.sub(o),W.direction.transformDirection(I),T++}else if(B.isRectAreaLight){const W=r.rectArea[R];W.position.setFromMatrixPosition(B.matrixWorld),W.position.applyMatrix4(I),c.identity(),l.copy(B.matrixWorld),l.premultiply(I),c.extractRotation(l),W.halfWidth.set(B.width*.5,0,0),W.halfHeight.set(0,B.height*.5,0),W.halfWidth.applyMatrix4(c),W.halfHeight.applyMatrix4(c),R++}else if(B.isPointLight){const W=r.point[E];W.position.setFromMatrixPosition(B.matrixWorld),W.position.applyMatrix4(I),E++}else if(B.isHemisphereLight){const W=r.hemi[z];W.direction.setFromMatrixPosition(B.matrixWorld),W.direction.transformDirection(I),z++}}}return{setup:s,setupView:m,state:r}}function vO(t){const e=new cge(t),n=[],r=[];function o(b){y.camera=b,n.length=0,r.length=0}function l(b){n.push(b)}function c(b){r.push(b)}function s(){e.setup(n)}function m(b){e.setupView(n,b)}const y={lightsArray:n,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:o,state:y,setupLights:s,setupLightsView:m,pushLight:l,pushShadow:c}}function uge(t){let e=new WeakMap;function n(o,l=0){const c=e.get(o);let s;return c===void 0?(s=new vO(t),e.set(o,[s])):l>=c.length?(s=new vO(t),c.push(s)):s=c[l],s}function r(){e=new WeakMap}return{get:n,dispose:r}}const hge=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,dge=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function fge(t,e,n){let r=new HA;const o=new mi,l=new mi,c=new ko,s=new Ohe({depthPacking:Aue}),m=new Fhe,y={},b=n.maxTextureSize,w={[up]:tl,[tl]:up,[Nd]:Nd},E=new Zd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new mi},radius:{value:4}},vertexShader:hge,fragmentShader:dge}),T=E.clone();T.defines.HORIZONTAL_PASS=1;const R=new kh;R.setAttribute("position",new Th(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const z=new Ja(R,E),I=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=dB;let L=this.type;this.render=function(q,te,se){if(I.enabled===!1||I.autoUpdate===!1&&I.needsUpdate===!1||q.length===0)return;const re=t.getRenderTarget(),$=t.getActiveCubeFace(),ce=t.getActiveMipmapLevel(),Ce=t.state;Ce.setBlending(Jf),Ce.buffers.color.setClear(1,1,1,1),Ce.buffers.depth.setTest(!0),Ce.setScissorTest(!1);const Se=L!==Od&&this.type===Od,Xe=L===Od&&this.type!==Od;for(let Fe=0,Me=q.length;Fe<Me;Fe++){const Te=q[Fe],Ie=Te.shadow;if(Ie===void 0){console.warn("THREE.WebGLShadowMap:",Te,"has no shadow.");continue}if(Ie.autoUpdate===!1&&Ie.needsUpdate===!1)continue;o.copy(Ie.mapSize);const Ke=Ie.getFrameExtents();if(o.multiply(Ke),l.copy(Ie.mapSize),(o.x>b||o.y>b)&&(o.x>b&&(l.x=Math.floor(b/Ke.x),o.x=l.x*Ke.x,Ie.mapSize.x=l.x),o.y>b&&(l.y=Math.floor(b/Ke.y),o.y=l.y*Ke.y,Ie.mapSize.y=l.y)),Ie.map===null||Se===!0||Xe===!0){const Ee=this.type!==Od?{minFilter:bu,magFilter:bu}:{};Ie.map!==null&&Ie.map.dispose(),Ie.map=new hp(o.x,o.y,Ee),Ie.map.texture.name=Te.name+".shadowMap",Ie.camera.updateProjectionMatrix()}t.setRenderTarget(Ie.map),t.clear();const st=Ie.getViewportCount();for(let Ee=0;Ee<st;Ee++){const Qe=Ie.getViewport(Ee);c.set(l.x*Qe.x,l.y*Qe.y,l.x*Qe.z,l.y*Qe.w),Ce.viewport(c),Ie.updateMatrices(Te,Ee),r=Ie.getFrustum(),W(te,se,Ie.camera,Te,this.type)}Ie.isPointLightShadow!==!0&&this.type===Od&&V(Ie,se),Ie.needsUpdate=!1}L=this.type,I.needsUpdate=!1,t.setRenderTarget(re,$,ce)};function V(q,te){const se=e.update(z);E.defines.VSM_SAMPLES!==q.blurSamples&&(E.defines.VSM_SAMPLES=q.blurSamples,T.defines.VSM_SAMPLES=q.blurSamples,E.needsUpdate=!0,T.needsUpdate=!0),q.mapPass===null&&(q.mapPass=new hp(o.x,o.y)),E.uniforms.shadow_pass.value=q.map.texture,E.uniforms.resolution.value=q.mapSize,E.uniforms.radius.value=q.radius,t.setRenderTarget(q.mapPass),t.clear(),t.renderBufferDirect(te,null,se,E,z,null),T.uniforms.shadow_pass.value=q.mapPass.texture,T.uniforms.resolution.value=q.mapSize,T.uniforms.radius.value=q.radius,t.setRenderTarget(q.map),t.clear(),t.renderBufferDirect(te,null,se,T,z,null)}function B(q,te,se,re){let $=null;const ce=se.isPointLight===!0?q.customDistanceMaterial:q.customDepthMaterial;if(ce!==void 0)$=ce;else if($=se.isPointLight===!0?m:s,t.localClippingEnabled&&te.clipShadows===!0&&Array.isArray(te.clippingPlanes)&&te.clippingPlanes.length!==0||te.displacementMap&&te.displacementScale!==0||te.alphaMap&&te.alphaTest>0||te.map&&te.alphaTest>0){const Ce=$.uuid,Se=te.uuid;let Xe=y[Ce];Xe===void 0&&(Xe={},y[Ce]=Xe);let Fe=Xe[Se];Fe===void 0&&(Fe=$.clone(),Xe[Se]=Fe,te.addEventListener("dispose",X)),$=Fe}if($.visible=te.visible,$.wireframe=te.wireframe,re===Od?$.side=te.shadowSide!==null?te.shadowSide:te.side:$.side=te.shadowSide!==null?te.shadowSide:w[te.side],$.alphaMap=te.alphaMap,$.alphaTest=te.alphaTest,$.map=te.map,$.clipShadows=te.clipShadows,$.clippingPlanes=te.clippingPlanes,$.clipIntersection=te.clipIntersection,$.displacementMap=te.displacementMap,$.displacementScale=te.displacementScale,$.displacementBias=te.displacementBias,$.wireframeLinewidth=te.wireframeLinewidth,$.linewidth=te.linewidth,se.isPointLight===!0&&$.isMeshDistanceMaterial===!0){const Ce=t.properties.get($);Ce.light=se}return $}function W(q,te,se,re,$){if(q.visible===!1)return;if(q.layers.test(te.layers)&&(q.isMesh||q.isLine||q.isPoints)&&(q.castShadow||q.receiveShadow&&$===Od)&&(!q.frustumCulled||r.intersectsObject(q))){q.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,q.matrixWorld);const Se=e.update(q),Xe=q.material;if(Array.isArray(Xe)){const Fe=Se.groups;for(let Me=0,Te=Fe.length;Me<Te;Me++){const Ie=Fe[Me],Ke=Xe[Ie.materialIndex];if(Ke&&Ke.visible){const st=B(q,Ke,re,$);q.onBeforeShadow(t,q,te,se,Se,st,Ie),t.renderBufferDirect(se,null,Se,st,q,Ie),q.onAfterShadow(t,q,te,se,Se,st,Ie)}}}else if(Xe.visible){const Fe=B(q,Xe,re,$);q.onBeforeShadow(t,q,te,se,Se,Fe,null),t.renderBufferDirect(se,null,Se,Fe,q,null),q.onAfterShadow(t,q,te,se,Se,Fe,null)}}const Ce=q.children;for(let Se=0,Xe=Ce.length;Se<Xe;Se++)W(Ce[Se],te,se,re,$)}function X(q){q.target.removeEventListener("dispose",X);for(const se in y){const re=y[se],$=q.target.uuid;$ in re&&(re[$].dispose(),delete re[$])}}}const pge={[K2]:J2,[Q2]:nT,[eT]:rT,[ty]:tT,[J2]:K2,[nT]:Q2,[rT]:eT,[tT]:ty};function mge(t,e){function n(){let ye=!1;const Ae=new ko;let Be=null;const $e=new ko(0,0,0,0);return{setMask:function(He){Be!==He&&!ye&&(t.colorMask(He,He,He,He),Be=He)},setLocked:function(He){ye=He},setClear:function(He,ut,We,Ut,Kt){Kt===!0&&(He*=Ut,ut*=Ut,We*=Ut),Ae.set(He,ut,We,Ut),$e.equals(Ae)===!1&&(t.clearColor(He,ut,We,Ut),$e.copy(Ae))},reset:function(){ye=!1,Be=null,$e.set(-1,0,0,0)}}}function r(){let ye=!1,Ae=!1,Be=null,$e=null,He=null;return{setReversed:function(ut){if(Ae!==ut){const We=e.get("EXT_clip_control");ut?We.clipControlEXT(We.LOWER_LEFT_EXT,We.ZERO_TO_ONE_EXT):We.clipControlEXT(We.LOWER_LEFT_EXT,We.NEGATIVE_ONE_TO_ONE_EXT),Ae=ut;const Ut=He;He=null,this.setClear(Ut)}},getReversed:function(){return Ae},setTest:function(ut){ut?ht(t.DEPTH_TEST):lt(t.DEPTH_TEST)},setMask:function(ut){Be!==ut&&!ye&&(t.depthMask(ut),Be=ut)},setFunc:function(ut){if(Ae&&(ut=pge[ut]),$e!==ut){switch(ut){case K2:t.depthFunc(t.NEVER);break;case J2:t.depthFunc(t.ALWAYS);break;case Q2:t.depthFunc(t.LESS);break;case ty:t.depthFunc(t.LEQUAL);break;case eT:t.depthFunc(t.EQUAL);break;case tT:t.depthFunc(t.GEQUAL);break;case nT:t.depthFunc(t.GREATER);break;case rT:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}$e=ut}},setLocked:function(ut){ye=ut},setClear:function(ut){He!==ut&&(Ae&&(ut=1-ut),t.clearDepth(ut),He=ut)},reset:function(){ye=!1,Be=null,$e=null,He=null,Ae=!1}}}function o(){let ye=!1,Ae=null,Be=null,$e=null,He=null,ut=null,We=null,Ut=null,Kt=null;return{setTest:function(Re){ye||(Re?ht(t.STENCIL_TEST):lt(t.STENCIL_TEST))},setMask:function(Re){Ae!==Re&&!ye&&(t.stencilMask(Re),Ae=Re)},setFunc:function(Re,it,mt){(Be!==Re||$e!==it||He!==mt)&&(t.stencilFunc(Re,it,mt),Be=Re,$e=it,He=mt)},setOp:function(Re,it,mt){(ut!==Re||We!==it||Ut!==mt)&&(t.stencilOp(Re,it,mt),ut=Re,We=it,Ut=mt)},setLocked:function(Re){ye=Re},setClear:function(Re){Kt!==Re&&(t.clearStencil(Re),Kt=Re)},reset:function(){ye=!1,Ae=null,Be=null,$e=null,He=null,ut=null,We=null,Ut=null,Kt=null}}}const l=new n,c=new r,s=new o,m=new WeakMap,y=new WeakMap;let b={},w={},E=new WeakMap,T=[],R=null,z=!1,I=null,L=null,V=null,B=null,W=null,X=null,q=null,te=new xi(0,0,0),se=0,re=!1,$=null,ce=null,Ce=null,Se=null,Xe=null;const Fe=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Me=!1,Te=0;const Ie=t.getParameter(t.VERSION);Ie.indexOf("WebGL")!==-1?(Te=parseFloat(/^WebGL (\d)/.exec(Ie)[1]),Me=Te>=1):Ie.indexOf("OpenGL ES")!==-1&&(Te=parseFloat(/^OpenGL ES (\d)/.exec(Ie)[1]),Me=Te>=2);let Ke=null,st={};const Ee=t.getParameter(t.SCISSOR_BOX),Qe=t.getParameter(t.VIEWPORT),jt=new ko().fromArray(Ee),je=new ko().fromArray(Qe);function ft(ye,Ae,Be,$e){const He=new Uint8Array(4),ut=t.createTexture();t.bindTexture(ye,ut),t.texParameteri(ye,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(ye,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let We=0;We<Be;We++)ye===t.TEXTURE_3D||ye===t.TEXTURE_2D_ARRAY?t.texImage3D(Ae,0,t.RGBA,1,1,$e,0,t.RGBA,t.UNSIGNED_BYTE,He):t.texImage2D(Ae+We,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,He);return ut}const At={};At[t.TEXTURE_2D]=ft(t.TEXTURE_2D,t.TEXTURE_2D,1),At[t.TEXTURE_CUBE_MAP]=ft(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),At[t.TEXTURE_2D_ARRAY]=ft(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),At[t.TEXTURE_3D]=ft(t.TEXTURE_3D,t.TEXTURE_3D,1,1),l.setClear(0,0,0,1),c.setClear(1),s.setClear(0),ht(t.DEPTH_TEST),c.setFunc(ty),Jt(!1),fn(mz),ht(t.CULL_FACE),et(Jf);function ht(ye){b[ye]!==!0&&(t.enable(ye),b[ye]=!0)}function lt(ye){b[ye]!==!1&&(t.disable(ye),b[ye]=!1)}function bt(ye,Ae){return w[ye]!==Ae?(t.bindFramebuffer(ye,Ae),w[ye]=Ae,ye===t.DRAW_FRAMEBUFFER&&(w[t.FRAMEBUFFER]=Ae),ye===t.FRAMEBUFFER&&(w[t.DRAW_FRAMEBUFFER]=Ae),!0):!1}function St(ye,Ae){let Be=T,$e=!1;if(ye){Be=E.get(Ae),Be===void 0&&(Be=[],E.set(Ae,Be));const He=ye.textures;if(Be.length!==He.length||Be[0]!==t.COLOR_ATTACHMENT0){for(let ut=0,We=He.length;ut<We;ut++)Be[ut]=t.COLOR_ATTACHMENT0+ut;Be.length=He.length,$e=!0}}else Be[0]!==t.BACK&&(Be[0]=t.BACK,$e=!0);$e&&t.drawBuffers(Be)}function dn(ye){return R!==ye?(t.useProgram(ye),R=ye,!0):!1}const En={[Pm]:t.FUNC_ADD,[nue]:t.FUNC_SUBTRACT,[rue]:t.FUNC_REVERSE_SUBTRACT};En[iue]=t.MIN,En[oue]=t.MAX;const un={[sue]:t.ZERO,[aue]:t.ONE,[lue]:t.SRC_COLOR,[Z2]:t.SRC_ALPHA,[pue]:t.SRC_ALPHA_SATURATE,[due]:t.DST_COLOR,[uue]:t.DST_ALPHA,[cue]:t.ONE_MINUS_SRC_COLOR,[Y2]:t.ONE_MINUS_SRC_ALPHA,[fue]:t.ONE_MINUS_DST_COLOR,[hue]:t.ONE_MINUS_DST_ALPHA,[mue]:t.CONSTANT_COLOR,[gue]:t.ONE_MINUS_CONSTANT_COLOR,[vue]:t.CONSTANT_ALPHA,[yue]:t.ONE_MINUS_CONSTANT_ALPHA};function et(ye,Ae,Be,$e,He,ut,We,Ut,Kt,Re){if(ye===Jf){z===!0&&(lt(t.BLEND),z=!1);return}if(z===!1&&(ht(t.BLEND),z=!0),ye!==tue){if(ye!==I||Re!==re){if((L!==Pm||W!==Pm)&&(t.blendEquation(t.FUNC_ADD),L=Pm,W=Pm),Re)switch(ye){case Bv:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case gz:t.blendFunc(t.ONE,t.ONE);break;case vz:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case yz:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}else switch(ye){case Bv:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case gz:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case vz:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case yz:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}V=null,B=null,X=null,q=null,te.set(0,0,0),se=0,I=ye,re=Re}return}He=He||Ae,ut=ut||Be,We=We||$e,(Ae!==L||He!==W)&&(t.blendEquationSeparate(En[Ae],En[He]),L=Ae,W=He),(Be!==V||$e!==B||ut!==X||We!==q)&&(t.blendFuncSeparate(un[Be],un[$e],un[ut],un[We]),V=Be,B=$e,X=ut,q=We),(Ut.equals(te)===!1||Kt!==se)&&(t.blendColor(Ut.r,Ut.g,Ut.b,Kt),te.copy(Ut),se=Kt),I=ye,re=!1}function Ln(ye,Ae){ye.side===Nd?lt(t.CULL_FACE):ht(t.CULL_FACE);let Be=ye.side===tl;Ae&&(Be=!Be),Jt(Be),ye.blending===Bv&&ye.transparent===!1?et(Jf):et(ye.blending,ye.blendEquation,ye.blendSrc,ye.blendDst,ye.blendEquationAlpha,ye.blendSrcAlpha,ye.blendDstAlpha,ye.blendColor,ye.blendAlpha,ye.premultipliedAlpha),c.setFunc(ye.depthFunc),c.setTest(ye.depthTest),c.setMask(ye.depthWrite),l.setMask(ye.colorWrite);const $e=ye.stencilWrite;s.setTest($e),$e&&(s.setMask(ye.stencilWriteMask),s.setFunc(ye.stencilFunc,ye.stencilRef,ye.stencilFuncMask),s.setOp(ye.stencilFail,ye.stencilZFail,ye.stencilZPass)),Nn(ye.polygonOffset,ye.polygonOffsetFactor,ye.polygonOffsetUnits),ye.alphaToCoverage===!0?ht(t.SAMPLE_ALPHA_TO_COVERAGE):lt(t.SAMPLE_ALPHA_TO_COVERAGE)}function Jt(ye){$!==ye&&(ye?t.frontFace(t.CW):t.frontFace(t.CCW),$=ye)}function fn(ye){ye!==Jce?(ht(t.CULL_FACE),ye!==ce&&(ye===mz?t.cullFace(t.BACK):ye===Qce?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):lt(t.CULL_FACE),ce=ye}function $t(ye){ye!==Ce&&(Me&&t.lineWidth(ye),Ce=ye)}function Nn(ye,Ae,Be){ye?(ht(t.POLYGON_OFFSET_FILL),(Se!==Ae||Xe!==Be)&&(t.polygonOffset(Ae,Be),Se=Ae,Xe=Be)):lt(t.POLYGON_OFFSET_FILL)}function vn(ye){ye?ht(t.SCISSOR_TEST):lt(t.SCISSOR_TEST)}function Ue(ye){ye===void 0&&(ye=t.TEXTURE0+Fe-1),Ke!==ye&&(t.activeTexture(ye),Ke=ye)}function we(ye,Ae,Be){Be===void 0&&(Ke===null?Be=t.TEXTURE0+Fe-1:Be=Ke);let $e=st[Be];$e===void 0&&($e={type:void 0,texture:void 0},st[Be]=$e),($e.type!==ye||$e.texture!==Ae)&&(Ke!==Be&&(t.activeTexture(Be),Ke=Be),t.bindTexture(ye,Ae||At[ye]),$e.type=ye,$e.texture=Ae)}function yt(){const ye=st[Ke];ye!==void 0&&ye.type!==void 0&&(t.bindTexture(ye.type,null),ye.type=void 0,ye.texture=void 0)}function Nt(){try{t.compressedTexImage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ht(){try{t.compressedTexImage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ot(){try{t.texSubImage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ln(){try{t.texSubImage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Gt(){try{t.compressedTexSubImage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Zt(){try{t.compressedTexSubImage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Fn(){try{t.texStorage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Yt(){try{t.texStorage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Pe(){try{t.texImage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ae(){try{t.texImage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ue(ye){jt.equals(ye)===!1&&(t.scissor(ye.x,ye.y,ye.z,ye.w),jt.copy(ye))}function ee(ye){je.equals(ye)===!1&&(t.viewport(ye.x,ye.y,ye.z,ye.w),je.copy(ye))}function fe(ye,Ae){let Be=y.get(Ae);Be===void 0&&(Be=new WeakMap,y.set(Ae,Be));let $e=Be.get(ye);$e===void 0&&($e=t.getUniformBlockIndex(Ae,ye.name),Be.set(ye,$e))}function Oe(ye,Ae){const $e=y.get(Ae).get(ye);m.get(Ae)!==$e&&(t.uniformBlockBinding(Ae,$e,ye.__bindingPointIndex),m.set(Ae,$e))}function Ye(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),c.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),b={},Ke=null,st={},w={},E=new WeakMap,T=[],R=null,z=!1,I=null,L=null,V=null,B=null,W=null,X=null,q=null,te=new xi(0,0,0),se=0,re=!1,$=null,ce=null,Ce=null,Se=null,Xe=null,jt.set(0,0,t.canvas.width,t.canvas.height),je.set(0,0,t.canvas.width,t.canvas.height),l.reset(),c.reset(),s.reset()}return{buffers:{color:l,depth:c,stencil:s},enable:ht,disable:lt,bindFramebuffer:bt,drawBuffers:St,useProgram:dn,setBlending:et,setMaterial:Ln,setFlipSided:Jt,setCullFace:fn,setLineWidth:$t,setPolygonOffset:Nn,setScissorTest:vn,activeTexture:Ue,bindTexture:we,unbindTexture:yt,compressedTexImage2D:Nt,compressedTexImage3D:Ht,texImage2D:Pe,texImage3D:ae,updateUBOMapping:fe,uniformBlockBinding:Oe,texStorage2D:Fn,texStorage3D:Yt,texSubImage2D:Ot,texSubImage3D:ln,compressedTexSubImage2D:Gt,compressedTexSubImage3D:Zt,scissor:ue,viewport:ee,reset:Ye}}function gge(t,e,n,r,o,l,c){const s=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),y=new mi,b=new WeakMap;let w;const E=new WeakMap;let T=!1;try{T=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function R(Ue,we){return T?new OffscreenCanvas(Ue,we):j1("canvas")}function z(Ue,we,yt){let Nt=1;const Ht=vn(Ue);if((Ht.width>yt||Ht.height>yt)&&(Nt=yt/Math.max(Ht.width,Ht.height)),Nt<1)if(typeof HTMLImageElement<"u"&&Ue instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ue instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ue instanceof ImageBitmap||typeof VideoFrame<"u"&&Ue instanceof VideoFrame){const Ot=Math.floor(Nt*Ht.width),ln=Math.floor(Nt*Ht.height);w===void 0&&(w=R(Ot,ln));const Gt=we?R(Ot,ln):w;return Gt.width=Ot,Gt.height=ln,Gt.getContext("2d").drawImage(Ue,0,0,Ot,ln),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ht.width+"x"+Ht.height+") to ("+Ot+"x"+ln+")."),Gt}else return"data"in Ue&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ht.width+"x"+Ht.height+")."),Ue;return Ue}function I(Ue){return Ue.generateMipmaps}function L(Ue){t.generateMipmap(Ue)}function V(Ue){return Ue.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:Ue.isWebGL3DRenderTarget?t.TEXTURE_3D:Ue.isWebGLArrayRenderTarget||Ue.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function B(Ue,we,yt,Nt,Ht=!1){if(Ue!==null){if(t[Ue]!==void 0)return t[Ue];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ue+"'")}let Ot=we;if(we===t.RED&&(yt===t.FLOAT&&(Ot=t.R32F),yt===t.HALF_FLOAT&&(Ot=t.R16F),yt===t.UNSIGNED_BYTE&&(Ot=t.R8)),we===t.RED_INTEGER&&(yt===t.UNSIGNED_BYTE&&(Ot=t.R8UI),yt===t.UNSIGNED_SHORT&&(Ot=t.R16UI),yt===t.UNSIGNED_INT&&(Ot=t.R32UI),yt===t.BYTE&&(Ot=t.R8I),yt===t.SHORT&&(Ot=t.R16I),yt===t.INT&&(Ot=t.R32I)),we===t.RG&&(yt===t.FLOAT&&(Ot=t.RG32F),yt===t.HALF_FLOAT&&(Ot=t.RG16F),yt===t.UNSIGNED_BYTE&&(Ot=t.RG8)),we===t.RG_INTEGER&&(yt===t.UNSIGNED_BYTE&&(Ot=t.RG8UI),yt===t.UNSIGNED_SHORT&&(Ot=t.RG16UI),yt===t.UNSIGNED_INT&&(Ot=t.RG32UI),yt===t.BYTE&&(Ot=t.RG8I),yt===t.SHORT&&(Ot=t.RG16I),yt===t.INT&&(Ot=t.RG32I)),we===t.RGB_INTEGER&&(yt===t.UNSIGNED_BYTE&&(Ot=t.RGB8UI),yt===t.UNSIGNED_SHORT&&(Ot=t.RGB16UI),yt===t.UNSIGNED_INT&&(Ot=t.RGB32UI),yt===t.BYTE&&(Ot=t.RGB8I),yt===t.SHORT&&(Ot=t.RGB16I),yt===t.INT&&(Ot=t.RGB32I)),we===t.RGBA_INTEGER&&(yt===t.UNSIGNED_BYTE&&(Ot=t.RGBA8UI),yt===t.UNSIGNED_SHORT&&(Ot=t.RGBA16UI),yt===t.UNSIGNED_INT&&(Ot=t.RGBA32UI),yt===t.BYTE&&(Ot=t.RGBA8I),yt===t.SHORT&&(Ot=t.RGBA16I),yt===t.INT&&(Ot=t.RGBA32I)),we===t.RGB&&yt===t.UNSIGNED_INT_5_9_9_9_REV&&(Ot=t.RGB9_E5),we===t.RGBA){const ln=Ht?$1:li.getTransfer(Nt);yt===t.FLOAT&&(Ot=t.RGBA32F),yt===t.HALF_FLOAT&&(Ot=t.RGBA16F),yt===t.UNSIGNED_BYTE&&(Ot=ln===Ri?t.SRGB8_ALPHA8:t.RGBA8),yt===t.UNSIGNED_SHORT_4_4_4_4&&(Ot=t.RGBA4),yt===t.UNSIGNED_SHORT_5_5_5_1&&(Ot=t.RGB5_A1)}return(Ot===t.R16F||Ot===t.R32F||Ot===t.RG16F||Ot===t.RG32F||Ot===t.RGBA16F||Ot===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ot}function W(Ue,we){let yt;return Ue?we===null||we===Hm||we===w_?yt=t.DEPTH24_STENCIL8:we===Bd?yt=t.DEPTH32F_STENCIL8:we===b_&&(yt=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):we===null||we===Hm||we===w_?yt=t.DEPTH_COMPONENT24:we===Bd?yt=t.DEPTH_COMPONENT32F:we===b_&&(yt=t.DEPTH_COMPONENT16),yt}function X(Ue,we){return I(Ue)===!0||Ue.isFramebufferTexture&&Ue.minFilter!==bu&&Ue.minFilter!==$l?Math.log2(Math.max(we.width,we.height))+1:Ue.mipmaps!==void 0&&Ue.mipmaps.length>0?Ue.mipmaps.length:Ue.isCompressedTexture&&Array.isArray(Ue.image)?we.mipmaps.length:1}function q(Ue){const we=Ue.target;we.removeEventListener("dispose",q),se(we),we.isVideoTexture&&b.delete(we)}function te(Ue){const we=Ue.target;we.removeEventListener("dispose",te),$(we)}function se(Ue){const we=r.get(Ue);if(we.__webglInit===void 0)return;const yt=Ue.source,Nt=E.get(yt);if(Nt){const Ht=Nt[we.__cacheKey];Ht.usedTimes--,Ht.usedTimes===0&&re(Ue),Object.keys(Nt).length===0&&E.delete(yt)}r.remove(Ue)}function re(Ue){const we=r.get(Ue);t.deleteTexture(we.__webglTexture);const yt=Ue.source,Nt=E.get(yt);delete Nt[we.__cacheKey],c.memory.textures--}function $(Ue){const we=r.get(Ue);if(Ue.depthTexture&&(Ue.depthTexture.dispose(),r.remove(Ue.depthTexture)),Ue.isWebGLCubeRenderTarget)for(let Nt=0;Nt<6;Nt++){if(Array.isArray(we.__webglFramebuffer[Nt]))for(let Ht=0;Ht<we.__webglFramebuffer[Nt].length;Ht++)t.deleteFramebuffer(we.__webglFramebuffer[Nt][Ht]);else t.deleteFramebuffer(we.__webglFramebuffer[Nt]);we.__webglDepthbuffer&&t.deleteRenderbuffer(we.__webglDepthbuffer[Nt])}else{if(Array.isArray(we.__webglFramebuffer))for(let Nt=0;Nt<we.__webglFramebuffer.length;Nt++)t.deleteFramebuffer(we.__webglFramebuffer[Nt]);else t.deleteFramebuffer(we.__webglFramebuffer);if(we.__webglDepthbuffer&&t.deleteRenderbuffer(we.__webglDepthbuffer),we.__webglMultisampledFramebuffer&&t.deleteFramebuffer(we.__webglMultisampledFramebuffer),we.__webglColorRenderbuffer)for(let Nt=0;Nt<we.__webglColorRenderbuffer.length;Nt++)we.__webglColorRenderbuffer[Nt]&&t.deleteRenderbuffer(we.__webglColorRenderbuffer[Nt]);we.__webglDepthRenderbuffer&&t.deleteRenderbuffer(we.__webglDepthRenderbuffer)}const yt=Ue.textures;for(let Nt=0,Ht=yt.length;Nt<Ht;Nt++){const Ot=r.get(yt[Nt]);Ot.__webglTexture&&(t.deleteTexture(Ot.__webglTexture),c.memory.textures--),r.remove(yt[Nt])}r.remove(Ue)}let ce=0;function Ce(){ce=0}function Se(){const Ue=ce;return Ue>=o.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Ue+" texture units while this GPU supports only "+o.maxTextures),ce+=1,Ue}function Xe(Ue){const we=[];return we.push(Ue.wrapS),we.push(Ue.wrapT),we.push(Ue.wrapR||0),we.push(Ue.magFilter),we.push(Ue.minFilter),we.push(Ue.anisotropy),we.push(Ue.internalFormat),we.push(Ue.format),we.push(Ue.type),we.push(Ue.generateMipmaps),we.push(Ue.premultiplyAlpha),we.push(Ue.flipY),we.push(Ue.unpackAlignment),we.push(Ue.colorSpace),we.join()}function Fe(Ue,we){const yt=r.get(Ue);if(Ue.isVideoTexture&&$t(Ue),Ue.isRenderTargetTexture===!1&&Ue.version>0&&yt.__version!==Ue.version){const Nt=Ue.image;if(Nt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Nt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{je(yt,Ue,we);return}}n.bindTexture(t.TEXTURE_2D,yt.__webglTexture,t.TEXTURE0+we)}function Me(Ue,we){const yt=r.get(Ue);if(Ue.version>0&&yt.__version!==Ue.version){je(yt,Ue,we);return}n.bindTexture(t.TEXTURE_2D_ARRAY,yt.__webglTexture,t.TEXTURE0+we)}function Te(Ue,we){const yt=r.get(Ue);if(Ue.version>0&&yt.__version!==Ue.version){je(yt,Ue,we);return}n.bindTexture(t.TEXTURE_3D,yt.__webglTexture,t.TEXTURE0+we)}function Ie(Ue,we){const yt=r.get(Ue);if(Ue.version>0&&yt.__version!==Ue.version){ft(yt,Ue,we);return}n.bindTexture(t.TEXTURE_CUBE_MAP,yt.__webglTexture,t.TEXTURE0+we)}const Ke={[sT]:t.REPEAT,[Dm]:t.CLAMP_TO_EDGE,[aT]:t.MIRRORED_REPEAT},st={[bu]:t.NEAREST,[Tue]:t.NEAREST_MIPMAP_NEAREST,[hb]:t.NEAREST_MIPMAP_LINEAR,[$l]:t.LINEAR,[IE]:t.LINEAR_MIPMAP_NEAREST,[Zf]:t.LINEAR_MIPMAP_LINEAR},Ee={[Lue]:t.NEVER,[Nue]:t.ALWAYS,[Due]:t.LESS,[EB]:t.LEQUAL,[kue]:t.EQUAL,[Fue]:t.GEQUAL,[zue]:t.GREATER,[Oue]:t.NOTEQUAL};function Qe(Ue,we){if(we.type===Bd&&e.has("OES_texture_float_linear")===!1&&(we.magFilter===$l||we.magFilter===IE||we.magFilter===hb||we.magFilter===Zf||we.minFilter===$l||we.minFilter===IE||we.minFilter===hb||we.minFilter===Zf)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(Ue,t.TEXTURE_WRAP_S,Ke[we.wrapS]),t.texParameteri(Ue,t.TEXTURE_WRAP_T,Ke[we.wrapT]),(Ue===t.TEXTURE_3D||Ue===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Ue,t.TEXTURE_WRAP_R,Ke[we.wrapR]),t.texParameteri(Ue,t.TEXTURE_MAG_FILTER,st[we.magFilter]),t.texParameteri(Ue,t.TEXTURE_MIN_FILTER,st[we.minFilter]),we.compareFunction&&(t.texParameteri(Ue,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Ue,t.TEXTURE_COMPARE_FUNC,Ee[we.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(we.magFilter===bu||we.minFilter!==hb&&we.minFilter!==Zf||we.type===Bd&&e.has("OES_texture_float_linear")===!1)return;if(we.anisotropy>1||r.get(we).__currentAnisotropy){const yt=e.get("EXT_texture_filter_anisotropic");t.texParameterf(Ue,yt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(we.anisotropy,o.getMaxAnisotropy())),r.get(we).__currentAnisotropy=we.anisotropy}}}function jt(Ue,we){let yt=!1;Ue.__webglInit===void 0&&(Ue.__webglInit=!0,we.addEventListener("dispose",q));const Nt=we.source;let Ht=E.get(Nt);Ht===void 0&&(Ht={},E.set(Nt,Ht));const Ot=Xe(we);if(Ot!==Ue.__cacheKey){Ht[Ot]===void 0&&(Ht[Ot]={texture:t.createTexture(),usedTimes:0},c.memory.textures++,yt=!0),Ht[Ot].usedTimes++;const ln=Ht[Ue.__cacheKey];ln!==void 0&&(Ht[Ue.__cacheKey].usedTimes--,ln.usedTimes===0&&re(we)),Ue.__cacheKey=Ot,Ue.__webglTexture=Ht[Ot].texture}return yt}function je(Ue,we,yt){let Nt=t.TEXTURE_2D;(we.isDataArrayTexture||we.isCompressedArrayTexture)&&(Nt=t.TEXTURE_2D_ARRAY),we.isData3DTexture&&(Nt=t.TEXTURE_3D);const Ht=jt(Ue,we),Ot=we.source;n.bindTexture(Nt,Ue.__webglTexture,t.TEXTURE0+yt);const ln=r.get(Ot);if(Ot.version!==ln.__version||Ht===!0){n.activeTexture(t.TEXTURE0+yt);const Gt=li.getPrimaries(li.workingColorSpace),Zt=we.colorSpace===qf?null:li.getPrimaries(we.colorSpace),Fn=we.colorSpace===qf||Gt===Zt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,we.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,we.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Fn);let Yt=z(we.image,!1,o.maxTextureSize);Yt=Nn(we,Yt);const Pe=l.convert(we.format,we.colorSpace),ae=l.convert(we.type);let ue=B(we.internalFormat,Pe,ae,we.colorSpace,we.isVideoTexture);Qe(Nt,we);let ee;const fe=we.mipmaps,Oe=we.isVideoTexture!==!0,Ye=ln.__version===void 0||Ht===!0,ye=Ot.dataReady,Ae=X(we,Yt);if(we.isDepthTexture)ue=W(we.format===M_,we.type),Ye&&(Oe?n.texStorage2D(t.TEXTURE_2D,1,ue,Yt.width,Yt.height):n.texImage2D(t.TEXTURE_2D,0,ue,Yt.width,Yt.height,0,Pe,ae,null));else if(we.isDataTexture)if(fe.length>0){Oe&&Ye&&n.texStorage2D(t.TEXTURE_2D,Ae,ue,fe[0].width,fe[0].height);for(let Be=0,$e=fe.length;Be<$e;Be++)ee=fe[Be],Oe?ye&&n.texSubImage2D(t.TEXTURE_2D,Be,0,0,ee.width,ee.height,Pe,ae,ee.data):n.texImage2D(t.TEXTURE_2D,Be,ue,ee.width,ee.height,0,Pe,ae,ee.data);we.generateMipmaps=!1}else Oe?(Ye&&n.texStorage2D(t.TEXTURE_2D,Ae,ue,Yt.width,Yt.height),ye&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Yt.width,Yt.height,Pe,ae,Yt.data)):n.texImage2D(t.TEXTURE_2D,0,ue,Yt.width,Yt.height,0,Pe,ae,Yt.data);else if(we.isCompressedTexture)if(we.isCompressedArrayTexture){Oe&&Ye&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Ae,ue,fe[0].width,fe[0].height,Yt.depth);for(let Be=0,$e=fe.length;Be<$e;Be++)if(ee=fe[Be],we.format!==_u)if(Pe!==null)if(Oe){if(ye)if(we.layerUpdates.size>0){const He=qz(ee.width,ee.height,we.format,we.type);for(const ut of we.layerUpdates){const We=ee.data.subarray(ut*He/ee.data.BYTES_PER_ELEMENT,(ut+1)*He/ee.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Be,0,0,ut,ee.width,ee.height,1,Pe,We)}we.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Be,0,0,0,ee.width,ee.height,Yt.depth,Pe,ee.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Be,ue,ee.width,ee.height,Yt.depth,0,ee.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Oe?ye&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,Be,0,0,0,ee.width,ee.height,Yt.depth,Pe,ae,ee.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Be,ue,ee.width,ee.height,Yt.depth,0,Pe,ae,ee.data)}else{Oe&&Ye&&n.texStorage2D(t.TEXTURE_2D,Ae,ue,fe[0].width,fe[0].height);for(let Be=0,$e=fe.length;Be<$e;Be++)ee=fe[Be],we.format!==_u?Pe!==null?Oe?ye&&n.compressedTexSubImage2D(t.TEXTURE_2D,Be,0,0,ee.width,ee.height,Pe,ee.data):n.compressedTexImage2D(t.TEXTURE_2D,Be,ue,ee.width,ee.height,0,ee.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Oe?ye&&n.texSubImage2D(t.TEXTURE_2D,Be,0,0,ee.width,ee.height,Pe,ae,ee.data):n.texImage2D(t.TEXTURE_2D,Be,ue,ee.width,ee.height,0,Pe,ae,ee.data)}else if(we.isDataArrayTexture)if(Oe){if(Ye&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Ae,ue,Yt.width,Yt.height,Yt.depth),ye)if(we.layerUpdates.size>0){const Be=qz(Yt.width,Yt.height,we.format,we.type);for(const $e of we.layerUpdates){const He=Yt.data.subarray($e*Be/Yt.data.BYTES_PER_ELEMENT,($e+1)*Be/Yt.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,$e,Yt.width,Yt.height,1,Pe,ae,He)}we.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Yt.width,Yt.height,Yt.depth,Pe,ae,Yt.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,ue,Yt.width,Yt.height,Yt.depth,0,Pe,ae,Yt.data);else if(we.isData3DTexture)Oe?(Ye&&n.texStorage3D(t.TEXTURE_3D,Ae,ue,Yt.width,Yt.height,Yt.depth),ye&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Yt.width,Yt.height,Yt.depth,Pe,ae,Yt.data)):n.texImage3D(t.TEXTURE_3D,0,ue,Yt.width,Yt.height,Yt.depth,0,Pe,ae,Yt.data);else if(we.isFramebufferTexture){if(Ye)if(Oe)n.texStorage2D(t.TEXTURE_2D,Ae,ue,Yt.width,Yt.height);else{let Be=Yt.width,$e=Yt.height;for(let He=0;He<Ae;He++)n.texImage2D(t.TEXTURE_2D,He,ue,Be,$e,0,Pe,ae,null),Be>>=1,$e>>=1}}else if(fe.length>0){if(Oe&&Ye){const Be=vn(fe[0]);n.texStorage2D(t.TEXTURE_2D,Ae,ue,Be.width,Be.height)}for(let Be=0,$e=fe.length;Be<$e;Be++)ee=fe[Be],Oe?ye&&n.texSubImage2D(t.TEXTURE_2D,Be,0,0,Pe,ae,ee):n.texImage2D(t.TEXTURE_2D,Be,ue,Pe,ae,ee);we.generateMipmaps=!1}else if(Oe){if(Ye){const Be=vn(Yt);n.texStorage2D(t.TEXTURE_2D,Ae,ue,Be.width,Be.height)}ye&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Pe,ae,Yt)}else n.texImage2D(t.TEXTURE_2D,0,ue,Pe,ae,Yt);I(we)&&L(Nt),ln.__version=Ot.version,we.onUpdate&&we.onUpdate(we)}Ue.__version=we.version}function ft(Ue,we,yt){if(we.image.length!==6)return;const Nt=jt(Ue,we),Ht=we.source;n.bindTexture(t.TEXTURE_CUBE_MAP,Ue.__webglTexture,t.TEXTURE0+yt);const Ot=r.get(Ht);if(Ht.version!==Ot.__version||Nt===!0){n.activeTexture(t.TEXTURE0+yt);const ln=li.getPrimaries(li.workingColorSpace),Gt=we.colorSpace===qf?null:li.getPrimaries(we.colorSpace),Zt=we.colorSpace===qf||ln===Gt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,we.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,we.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,we.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Zt);const Fn=we.isCompressedTexture||we.image[0].isCompressedTexture,Yt=we.image[0]&&we.image[0].isDataTexture,Pe=[];for(let $e=0;$e<6;$e++)!Fn&&!Yt?Pe[$e]=z(we.image[$e],!0,o.maxCubemapSize):Pe[$e]=Yt?we.image[$e].image:we.image[$e],Pe[$e]=Nn(we,Pe[$e]);const ae=Pe[0],ue=l.convert(we.format,we.colorSpace),ee=l.convert(we.type),fe=B(we.internalFormat,ue,ee,we.colorSpace),Oe=we.isVideoTexture!==!0,Ye=Ot.__version===void 0||Nt===!0,ye=Ht.dataReady;let Ae=X(we,ae);Qe(t.TEXTURE_CUBE_MAP,we);let Be;if(Fn){Oe&&Ye&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Ae,fe,ae.width,ae.height);for(let $e=0;$e<6;$e++){Be=Pe[$e].mipmaps;for(let He=0;He<Be.length;He++){const ut=Be[He];we.format!==_u?ue!==null?Oe?ye&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He,0,0,ut.width,ut.height,ue,ut.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He,fe,ut.width,ut.height,0,ut.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He,0,0,ut.width,ut.height,ue,ee,ut.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He,fe,ut.width,ut.height,0,ue,ee,ut.data)}}}else{if(Be=we.mipmaps,Oe&&Ye){Be.length>0&&Ae++;const $e=vn(Pe[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Ae,fe,$e.width,$e.height)}for(let $e=0;$e<6;$e++)if(Yt){Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,0,0,Pe[$e].width,Pe[$e].height,ue,ee,Pe[$e].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,fe,Pe[$e].width,Pe[$e].height,0,ue,ee,Pe[$e].data);for(let He=0;He<Be.length;He++){const We=Be[He].image[$e].image;Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He+1,0,0,We.width,We.height,ue,ee,We.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He+1,fe,We.width,We.height,0,ue,ee,We.data)}}else{Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,0,0,ue,ee,Pe[$e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,fe,ue,ee,Pe[$e]);for(let He=0;He<Be.length;He++){const ut=Be[He];Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He+1,0,0,ue,ee,ut.image[$e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He+1,fe,ue,ee,ut.image[$e])}}}I(we)&&L(t.TEXTURE_CUBE_MAP),Ot.__version=Ht.version,we.onUpdate&&we.onUpdate(we)}Ue.__version=we.version}function At(Ue,we,yt,Nt,Ht,Ot){const ln=l.convert(yt.format,yt.colorSpace),Gt=l.convert(yt.type),Zt=B(yt.internalFormat,ln,Gt,yt.colorSpace),Fn=r.get(we),Yt=r.get(yt);if(Yt.__renderTarget=we,!Fn.__hasExternalTextures){const Pe=Math.max(1,we.width>>Ot),ae=Math.max(1,we.height>>Ot);Ht===t.TEXTURE_3D||Ht===t.TEXTURE_2D_ARRAY?n.texImage3D(Ht,Ot,Zt,Pe,ae,we.depth,0,ln,Gt,null):n.texImage2D(Ht,Ot,Zt,Pe,ae,0,ln,Gt,null)}n.bindFramebuffer(t.FRAMEBUFFER,Ue),fn(we)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Nt,Ht,Yt.__webglTexture,0,Jt(we)):(Ht===t.TEXTURE_2D||Ht>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Ht<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Nt,Ht,Yt.__webglTexture,Ot),n.bindFramebuffer(t.FRAMEBUFFER,null)}function ht(Ue,we,yt){if(t.bindRenderbuffer(t.RENDERBUFFER,Ue),we.depthBuffer){const Nt=we.depthTexture,Ht=Nt&&Nt.isDepthTexture?Nt.type:null,Ot=W(we.stencilBuffer,Ht),ln=we.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Gt=Jt(we);fn(we)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Gt,Ot,we.width,we.height):yt?t.renderbufferStorageMultisample(t.RENDERBUFFER,Gt,Ot,we.width,we.height):t.renderbufferStorage(t.RENDERBUFFER,Ot,we.width,we.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,ln,t.RENDERBUFFER,Ue)}else{const Nt=we.textures;for(let Ht=0;Ht<Nt.length;Ht++){const Ot=Nt[Ht],ln=l.convert(Ot.format,Ot.colorSpace),Gt=l.convert(Ot.type),Zt=B(Ot.internalFormat,ln,Gt,Ot.colorSpace),Fn=Jt(we);yt&&fn(we)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Fn,Zt,we.width,we.height):fn(we)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Fn,Zt,we.width,we.height):t.renderbufferStorage(t.RENDERBUFFER,Zt,we.width,we.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function lt(Ue,we){if(we&&we.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,Ue),!(we.depthTexture&&we.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Nt=r.get(we.depthTexture);Nt.__renderTarget=we,(!Nt.__webglTexture||we.depthTexture.image.width!==we.width||we.depthTexture.image.height!==we.height)&&(we.depthTexture.image.width=we.width,we.depthTexture.image.height=we.height,we.depthTexture.needsUpdate=!0),Fe(we.depthTexture,0);const Ht=Nt.__webglTexture,Ot=Jt(we);if(we.depthTexture.format===S_)fn(we)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ht,0,Ot):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ht,0);else if(we.depthTexture.format===M_)fn(we)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ht,0,Ot):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ht,0);else throw new Error("Unknown depthTexture format")}function bt(Ue){const we=r.get(Ue),yt=Ue.isWebGLCubeRenderTarget===!0;if(we.__boundDepthTexture!==Ue.depthTexture){const Nt=Ue.depthTexture;if(we.__depthDisposeCallback&&we.__depthDisposeCallback(),Nt){const Ht=()=>{delete we.__boundDepthTexture,delete we.__depthDisposeCallback,Nt.removeEventListener("dispose",Ht)};Nt.addEventListener("dispose",Ht),we.__depthDisposeCallback=Ht}we.__boundDepthTexture=Nt}if(Ue.depthTexture&&!we.__autoAllocateDepthBuffer){if(yt)throw new Error("target.depthTexture not supported in Cube render targets");lt(we.__webglFramebuffer,Ue)}else if(yt){we.__webglDepthbuffer=[];for(let Nt=0;Nt<6;Nt++)if(n.bindFramebuffer(t.FRAMEBUFFER,we.__webglFramebuffer[Nt]),we.__webglDepthbuffer[Nt]===void 0)we.__webglDepthbuffer[Nt]=t.createRenderbuffer(),ht(we.__webglDepthbuffer[Nt],Ue,!1);else{const Ht=Ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ot=we.__webglDepthbuffer[Nt];t.bindRenderbuffer(t.RENDERBUFFER,Ot),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ht,t.RENDERBUFFER,Ot)}}else if(n.bindFramebuffer(t.FRAMEBUFFER,we.__webglFramebuffer),we.__webglDepthbuffer===void 0)we.__webglDepthbuffer=t.createRenderbuffer(),ht(we.__webglDepthbuffer,Ue,!1);else{const Nt=Ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ht=we.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Ht),t.framebufferRenderbuffer(t.FRAMEBUFFER,Nt,t.RENDERBUFFER,Ht)}n.bindFramebuffer(t.FRAMEBUFFER,null)}function St(Ue,we,yt){const Nt=r.get(Ue);we!==void 0&&At(Nt.__webglFramebuffer,Ue,Ue.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),yt!==void 0&&bt(Ue)}function dn(Ue){const we=Ue.texture,yt=r.get(Ue),Nt=r.get(we);Ue.addEventListener("dispose",te);const Ht=Ue.textures,Ot=Ue.isWebGLCubeRenderTarget===!0,ln=Ht.length>1;if(ln||(Nt.__webglTexture===void 0&&(Nt.__webglTexture=t.createTexture()),Nt.__version=we.version,c.memory.textures++),Ot){yt.__webglFramebuffer=[];for(let Gt=0;Gt<6;Gt++)if(we.mipmaps&&we.mipmaps.length>0){yt.__webglFramebuffer[Gt]=[];for(let Zt=0;Zt<we.mipmaps.length;Zt++)yt.__webglFramebuffer[Gt][Zt]=t.createFramebuffer()}else yt.__webglFramebuffer[Gt]=t.createFramebuffer()}else{if(we.mipmaps&&we.mipmaps.length>0){yt.__webglFramebuffer=[];for(let Gt=0;Gt<we.mipmaps.length;Gt++)yt.__webglFramebuffer[Gt]=t.createFramebuffer()}else yt.__webglFramebuffer=t.createFramebuffer();if(ln)for(let Gt=0,Zt=Ht.length;Gt<Zt;Gt++){const Fn=r.get(Ht[Gt]);Fn.__webglTexture===void 0&&(Fn.__webglTexture=t.createTexture(),c.memory.textures++)}if(Ue.samples>0&&fn(Ue)===!1){yt.__webglMultisampledFramebuffer=t.createFramebuffer(),yt.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,yt.__webglMultisampledFramebuffer);for(let Gt=0;Gt<Ht.length;Gt++){const Zt=Ht[Gt];yt.__webglColorRenderbuffer[Gt]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,yt.__webglColorRenderbuffer[Gt]);const Fn=l.convert(Zt.format,Zt.colorSpace),Yt=l.convert(Zt.type),Pe=B(Zt.internalFormat,Fn,Yt,Zt.colorSpace,Ue.isXRRenderTarget===!0),ae=Jt(Ue);t.renderbufferStorageMultisample(t.RENDERBUFFER,ae,Pe,Ue.width,Ue.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Gt,t.RENDERBUFFER,yt.__webglColorRenderbuffer[Gt])}t.bindRenderbuffer(t.RENDERBUFFER,null),Ue.depthBuffer&&(yt.__webglDepthRenderbuffer=t.createRenderbuffer(),ht(yt.__webglDepthRenderbuffer,Ue,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ot){n.bindTexture(t.TEXTURE_CUBE_MAP,Nt.__webglTexture),Qe(t.TEXTURE_CUBE_MAP,we);for(let Gt=0;Gt<6;Gt++)if(we.mipmaps&&we.mipmaps.length>0)for(let Zt=0;Zt<we.mipmaps.length;Zt++)At(yt.__webglFramebuffer[Gt][Zt],Ue,we,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Gt,Zt);else At(yt.__webglFramebuffer[Gt],Ue,we,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Gt,0);I(we)&&L(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(ln){for(let Gt=0,Zt=Ht.length;Gt<Zt;Gt++){const Fn=Ht[Gt],Yt=r.get(Fn);n.bindTexture(t.TEXTURE_2D,Yt.__webglTexture),Qe(t.TEXTURE_2D,Fn),At(yt.__webglFramebuffer,Ue,Fn,t.COLOR_ATTACHMENT0+Gt,t.TEXTURE_2D,0),I(Fn)&&L(t.TEXTURE_2D)}n.unbindTexture()}else{let Gt=t.TEXTURE_2D;if((Ue.isWebGL3DRenderTarget||Ue.isWebGLArrayRenderTarget)&&(Gt=Ue.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Gt,Nt.__webglTexture),Qe(Gt,we),we.mipmaps&&we.mipmaps.length>0)for(let Zt=0;Zt<we.mipmaps.length;Zt++)At(yt.__webglFramebuffer[Zt],Ue,we,t.COLOR_ATTACHMENT0,Gt,Zt);else At(yt.__webglFramebuffer,Ue,we,t.COLOR_ATTACHMENT0,Gt,0);I(we)&&L(Gt),n.unbindTexture()}Ue.depthBuffer&&bt(Ue)}function En(Ue){const we=Ue.textures;for(let yt=0,Nt=we.length;yt<Nt;yt++){const Ht=we[yt];if(I(Ht)){const Ot=V(Ue),ln=r.get(Ht).__webglTexture;n.bindTexture(Ot,ln),L(Ot),n.unbindTexture()}}}const un=[],et=[];function Ln(Ue){if(Ue.samples>0){if(fn(Ue)===!1){const we=Ue.textures,yt=Ue.width,Nt=Ue.height;let Ht=t.COLOR_BUFFER_BIT;const Ot=Ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,ln=r.get(Ue),Gt=we.length>1;if(Gt)for(let Zt=0;Zt<we.length;Zt++)n.bindFramebuffer(t.FRAMEBUFFER,ln.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,ln.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,ln.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ln.__webglFramebuffer);for(let Zt=0;Zt<we.length;Zt++){if(Ue.resolveDepthBuffer&&(Ue.depthBuffer&&(Ht|=t.DEPTH_BUFFER_BIT),Ue.stencilBuffer&&Ue.resolveStencilBuffer&&(Ht|=t.STENCIL_BUFFER_BIT)),Gt){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,ln.__webglColorRenderbuffer[Zt]);const Fn=r.get(we[Zt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Fn,0)}t.blitFramebuffer(0,0,yt,Nt,0,0,yt,Nt,Ht,t.NEAREST),m===!0&&(un.length=0,et.length=0,un.push(t.COLOR_ATTACHMENT0+Zt),Ue.depthBuffer&&Ue.resolveDepthBuffer===!1&&(un.push(Ot),et.push(Ot),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,et)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,un))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Gt)for(let Zt=0;Zt<we.length;Zt++){n.bindFramebuffer(t.FRAMEBUFFER,ln.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.RENDERBUFFER,ln.__webglColorRenderbuffer[Zt]);const Fn=r.get(we[Zt]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,ln.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.TEXTURE_2D,Fn,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,ln.__webglMultisampledFramebuffer)}else if(Ue.depthBuffer&&Ue.resolveDepthBuffer===!1&&m){const we=Ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[we])}}}function Jt(Ue){return Math.min(o.maxSamples,Ue.samples)}function fn(Ue){const we=r.get(Ue);return Ue.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&we.__useRenderToTexture!==!1}function $t(Ue){const we=c.render.frame;b.get(Ue)!==we&&(b.set(Ue,we),Ue.update())}function Nn(Ue,we){const yt=Ue.colorSpace,Nt=Ue.format,Ht=Ue.type;return Ue.isCompressedTexture===!0||Ue.isVideoTexture===!0||yt!==Gm&&yt!==qf&&(li.getTransfer(yt)===Ri?(Nt!==_u||Ht!==Xd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",yt)),we}function vn(Ue){return typeof HTMLImageElement<"u"&&Ue instanceof HTMLImageElement?(y.width=Ue.naturalWidth||Ue.width,y.height=Ue.naturalHeight||Ue.height):typeof VideoFrame<"u"&&Ue instanceof VideoFrame?(y.width=Ue.displayWidth,y.height=Ue.displayHeight):(y.width=Ue.width,y.height=Ue.height),y}this.allocateTextureUnit=Se,this.resetTextureUnits=Ce,this.setTexture2D=Fe,this.setTexture2DArray=Me,this.setTexture3D=Te,this.setTextureCube=Ie,this.rebindTextures=St,this.setupRenderTarget=dn,this.updateRenderTargetMipmap=En,this.updateMultisampleRenderTarget=Ln,this.setupDepthRenderbuffer=bt,this.setupFrameBufferTexture=At,this.useMultisampledRTT=fn}function vge(t,e){function n(r,o=qf){let l;const c=li.getTransfer(o);if(r===Xd)return t.UNSIGNED_BYTE;if(r===zA)return t.UNSIGNED_SHORT_4_4_4_4;if(r===OA)return t.UNSIGNED_SHORT_5_5_5_1;if(r===yB)return t.UNSIGNED_INT_5_9_9_9_REV;if(r===gB)return t.BYTE;if(r===vB)return t.SHORT;if(r===b_)return t.UNSIGNED_SHORT;if(r===kA)return t.INT;if(r===Hm)return t.UNSIGNED_INT;if(r===Bd)return t.FLOAT;if(r===ax)return t.HALF_FLOAT;if(r===_B)return t.ALPHA;if(r===xB)return t.RGB;if(r===_u)return t.RGBA;if(r===bB)return t.LUMINANCE;if(r===wB)return t.LUMINANCE_ALPHA;if(r===S_)return t.DEPTH_COMPONENT;if(r===M_)return t.DEPTH_STENCIL;if(r===SB)return t.RED;if(r===FA)return t.RED_INTEGER;if(r===MB)return t.RG;if(r===NA)return t.RG_INTEGER;if(r===BA)return t.RGBA_INTEGER;if(r===i1||r===o1||r===s1||r===a1)if(c===Ri)if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),l!==null){if(r===i1)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===o1)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===s1)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===a1)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(l=e.get("WEBGL_compressed_texture_s3tc"),l!==null){if(r===i1)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===o1)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===s1)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===a1)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===lT||r===cT||r===uT||r===hT)if(l=e.get("WEBGL_compressed_texture_pvrtc"),l!==null){if(r===lT)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===cT)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===uT)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===hT)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===dT||r===fT||r===pT)if(l=e.get("WEBGL_compressed_texture_etc"),l!==null){if(r===dT||r===fT)return c===Ri?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(r===pT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===mT||r===gT||r===vT||r===yT||r===_T||r===xT||r===bT||r===wT||r===ST||r===MT||r===CT||r===ET||r===TT||r===PT)if(l=e.get("WEBGL_compressed_texture_astc"),l!==null){if(r===mT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===gT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===vT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===yT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===_T)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===xT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===bT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===wT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===ST)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===MT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===CT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===ET)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===TT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===PT)return c===Ri?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===l1||r===AT||r===IT)if(l=e.get("EXT_texture_compression_bptc"),l!==null){if(r===l1)return c===Ri?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===AT)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===IT)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===CB||r===RT||r===LT||r===DT)if(l=e.get("EXT_texture_compression_rgtc"),l!==null){if(r===l1)return l.COMPRESSED_RED_RGTC1_EXT;if(r===RT)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===LT)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===DT)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===w_?t.UNSIGNED_INT_24_8:t[r]!==void 0?t[r]:null}return{convert:n}}const yge=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_ge=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class xge{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,r){if(this.texture===null){const o=new Xs,l=e.properties.get(o);l.__webglTexture=n.texture,(n.depthNear!==r.depthNear||n.depthFar!==r.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=o}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,r=new Zd({vertexShader:yge,fragmentShader:_ge,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Ja(new ux(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class bge extends dy{constructor(e,n){super();const r=this;let o=null,l=1,c=null,s="local-floor",m=1,y=null,b=null,w=null,E=null,T=null,R=null;const z=new xge,I=n.getContextAttributes();let L=null,V=null;const B=[],W=[],X=new mi;let q=null;const te=new Fl;te.viewport=new ko;const se=new Fl;se.viewport=new ko;const re=[te,se],$=new $he;let ce=null,Ce=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(je){let ft=B[je];return ft===void 0&&(ft=new YE,B[je]=ft),ft.getTargetRaySpace()},this.getControllerGrip=function(je){let ft=B[je];return ft===void 0&&(ft=new YE,B[je]=ft),ft.getGripSpace()},this.getHand=function(je){let ft=B[je];return ft===void 0&&(ft=new YE,B[je]=ft),ft.getHandSpace()};function Se(je){const ft=W.indexOf(je.inputSource);if(ft===-1)return;const At=B[ft];At!==void 0&&(At.update(je.inputSource,je.frame,y||c),At.dispatchEvent({type:je.type,data:je.inputSource}))}function Xe(){o.removeEventListener("select",Se),o.removeEventListener("selectstart",Se),o.removeEventListener("selectend",Se),o.removeEventListener("squeeze",Se),o.removeEventListener("squeezestart",Se),o.removeEventListener("squeezeend",Se),o.removeEventListener("end",Xe),o.removeEventListener("inputsourceschange",Fe);for(let je=0;je<B.length;je++){const ft=W[je];ft!==null&&(W[je]=null,B[je].disconnect(ft))}ce=null,Ce=null,z.reset(),e.setRenderTarget(L),T=null,E=null,w=null,o=null,V=null,jt.stop(),r.isPresenting=!1,e.setPixelRatio(q),e.setSize(X.width,X.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(je){l=je,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(je){s=je,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y||c},this.setReferenceSpace=function(je){y=je},this.getBaseLayer=function(){return E!==null?E:T},this.getBinding=function(){return w},this.getFrame=function(){return R},this.getSession=function(){return o},this.setSession=async function(je){if(o=je,o!==null){if(L=e.getRenderTarget(),o.addEventListener("select",Se),o.addEventListener("selectstart",Se),o.addEventListener("selectend",Se),o.addEventListener("squeeze",Se),o.addEventListener("squeezestart",Se),o.addEventListener("squeezeend",Se),o.addEventListener("end",Xe),o.addEventListener("inputsourceschange",Fe),I.xrCompatible!==!0&&await n.makeXRCompatible(),q=e.getPixelRatio(),e.getSize(X),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let At=null,ht=null,lt=null;I.depth&&(lt=I.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,At=I.stencil?M_:S_,ht=I.stencil?w_:Hm);const bt={colorFormat:n.RGBA8,depthFormat:lt,scaleFactor:l};w=new XRWebGLBinding(o,n),E=w.createProjectionLayer(bt),o.updateRenderState({layers:[E]}),e.setPixelRatio(1),e.setSize(E.textureWidth,E.textureHeight,!1),V=new hp(E.textureWidth,E.textureHeight,{format:_u,type:Xd,depthTexture:new zB(E.textureWidth,E.textureHeight,ht,void 0,void 0,void 0,void 0,void 0,void 0,At),stencilBuffer:I.stencil,colorSpace:e.outputColorSpace,samples:I.antialias?4:0,resolveDepthBuffer:E.ignoreDepthValues===!1,resolveStencilBuffer:E.ignoreDepthValues===!1})}else{const At={antialias:I.antialias,alpha:!0,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:l};T=new XRWebGLLayer(o,n,At),o.updateRenderState({baseLayer:T}),e.setPixelRatio(1),e.setSize(T.framebufferWidth,T.framebufferHeight,!1),V=new hp(T.framebufferWidth,T.framebufferHeight,{format:_u,type:Xd,colorSpace:e.outputColorSpace,stencilBuffer:I.stencil,resolveDepthBuffer:T.ignoreDepthValues===!1,resolveStencilBuffer:T.ignoreDepthValues===!1})}V.isXRRenderTarget=!0,this.setFoveation(m),y=null,c=await o.requestReferenceSpace(s),jt.setContext(o),jt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(o!==null)return o.environmentBlendMode},this.getDepthTexture=function(){return z.getDepthTexture()};function Fe(je){for(let ft=0;ft<je.removed.length;ft++){const At=je.removed[ft],ht=W.indexOf(At);ht>=0&&(W[ht]=null,B[ht].disconnect(At))}for(let ft=0;ft<je.added.length;ft++){const At=je.added[ft];let ht=W.indexOf(At);if(ht===-1){for(let bt=0;bt<B.length;bt++)if(bt>=W.length){W.push(At),ht=bt;break}else if(W[bt]===null){W[bt]=At,ht=bt;break}if(ht===-1)break}const lt=B[ht];lt&&lt.connect(At)}}const Me=new Pt,Te=new Pt;function Ie(je,ft,At){Me.setFromMatrixPosition(ft.matrixWorld),Te.setFromMatrixPosition(At.matrixWorld);const ht=Me.distanceTo(Te),lt=ft.projectionMatrix.elements,bt=At.projectionMatrix.elements,St=lt[14]/(lt[10]-1),dn=lt[14]/(lt[10]+1),En=(lt[9]+1)/lt[5],un=(lt[9]-1)/lt[5],et=(lt[8]-1)/lt[0],Ln=(bt[8]+1)/bt[0],Jt=St*et,fn=St*Ln,$t=ht/(-et+Ln),Nn=$t*-et;if(ft.matrixWorld.decompose(je.position,je.quaternion,je.scale),je.translateX(Nn),je.translateZ($t),je.matrixWorld.compose(je.position,je.quaternion,je.scale),je.matrixWorldInverse.copy(je.matrixWorld).invert(),lt[10]===-1)je.projectionMatrix.copy(ft.projectionMatrix),je.projectionMatrixInverse.copy(ft.projectionMatrixInverse);else{const vn=St+$t,Ue=dn+$t,we=Jt-Nn,yt=fn+(ht-Nn),Nt=En*dn/Ue*vn,Ht=un*dn/Ue*vn;je.projectionMatrix.makePerspective(we,yt,Nt,Ht,vn,Ue),je.projectionMatrixInverse.copy(je.projectionMatrix).invert()}}function Ke(je,ft){ft===null?je.matrixWorld.copy(je.matrix):je.matrixWorld.multiplyMatrices(ft.matrixWorld,je.matrix),je.matrixWorldInverse.copy(je.matrixWorld).invert()}this.updateCamera=function(je){if(o===null)return;let ft=je.near,At=je.far;z.texture!==null&&(z.depthNear>0&&(ft=z.depthNear),z.depthFar>0&&(At=z.depthFar)),$.near=se.near=te.near=ft,$.far=se.far=te.far=At,(ce!==$.near||Ce!==$.far)&&(o.updateRenderState({depthNear:$.near,depthFar:$.far}),ce=$.near,Ce=$.far),te.layers.mask=je.layers.mask|2,se.layers.mask=je.layers.mask|4,$.layers.mask=te.layers.mask|se.layers.mask;const ht=je.parent,lt=$.cameras;Ke($,ht);for(let bt=0;bt<lt.length;bt++)Ke(lt[bt],ht);lt.length===2?Ie($,te,se):$.projectionMatrix.copy(te.projectionMatrix),st(je,$,ht)};function st(je,ft,At){At===null?je.matrix.copy(ft.matrixWorld):(je.matrix.copy(At.matrixWorld),je.matrix.invert(),je.matrix.multiply(ft.matrixWorld)),je.matrix.decompose(je.position,je.quaternion,je.scale),je.updateMatrixWorld(!0),je.projectionMatrix.copy(ft.projectionMatrix),je.projectionMatrixInverse.copy(ft.projectionMatrixInverse),je.isPerspectiveCamera&&(je.fov=C_*2*Math.atan(1/je.projectionMatrix.elements[5]),je.zoom=1)}this.getCamera=function(){return $},this.getFoveation=function(){if(!(E===null&&T===null))return m},this.setFoveation=function(je){m=je,E!==null&&(E.fixedFoveation=je),T!==null&&T.fixedFoveation!==void 0&&(T.fixedFoveation=je)},this.hasDepthSensing=function(){return z.texture!==null},this.getDepthSensingMesh=function(){return z.getMesh($)};let Ee=null;function Qe(je,ft){if(b=ft.getViewerPose(y||c),R=ft,b!==null){const At=b.views;T!==null&&(e.setRenderTargetFramebuffer(V,T.framebuffer),e.setRenderTarget(V));let ht=!1;At.length!==$.cameras.length&&($.cameras.length=0,ht=!0);for(let St=0;St<At.length;St++){const dn=At[St];let En=null;if(T!==null)En=T.getViewport(dn);else{const et=w.getViewSubImage(E,dn);En=et.viewport,St===0&&(e.setRenderTargetTextures(V,et.colorTexture,et.depthStencilTexture),e.setRenderTarget(V))}let un=re[St];un===void 0&&(un=new Fl,un.layers.enable(St),un.viewport=new ko,re[St]=un),un.matrix.fromArray(dn.transform.matrix),un.matrix.decompose(un.position,un.quaternion,un.scale),un.projectionMatrix.fromArray(dn.projectionMatrix),un.projectionMatrixInverse.copy(un.projectionMatrix).invert(),un.viewport.set(En.x,En.y,En.width,En.height),St===0&&($.matrix.copy(un.matrix),$.matrix.decompose($.position,$.quaternion,$.scale)),ht===!0&&$.cameras.push(un)}const lt=o.enabledFeatures;if(lt&&lt.includes("depth-sensing")&&o.depthUsage=="gpu-optimized"&&w){const St=w.getDepthInformation(At[0]);St&&St.isValid&&St.texture&&z.init(e,St,o.renderState)}}for(let At=0;At<B.length;At++){const ht=W[At],lt=B[At];ht!==null&&lt!==void 0&&lt.update(ht,ft,y||c)}Ee&&Ee(je,ft),ft.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:ft}),R=null}const jt=new OB;jt.setAnimationLoop(Qe),this.setAnimationLoop=function(je){Ee=je},this.dispose=function(){}}}const bm=new Rh,wge=new Ti;function Sge(t,e){function n(I,L){I.matrixAutoUpdate===!0&&I.updateMatrix(),L.value.copy(I.matrix)}function r(I,L){L.color.getRGB(I.fogColor.value,LB(t)),L.isFog?(I.fogNear.value=L.near,I.fogFar.value=L.far):L.isFogExp2&&(I.fogDensity.value=L.density)}function o(I,L,V,B,W){L.isMeshBasicMaterial||L.isMeshLambertMaterial?l(I,L):L.isMeshToonMaterial?(l(I,L),w(I,L)):L.isMeshPhongMaterial?(l(I,L),b(I,L)):L.isMeshStandardMaterial?(l(I,L),E(I,L),L.isMeshPhysicalMaterial&&T(I,L,W)):L.isMeshMatcapMaterial?(l(I,L),R(I,L)):L.isMeshDepthMaterial?l(I,L):L.isMeshDistanceMaterial?(l(I,L),z(I,L)):L.isMeshNormalMaterial?l(I,L):L.isLineBasicMaterial?(c(I,L),L.isLineDashedMaterial&&s(I,L)):L.isPointsMaterial?m(I,L,V,B):L.isSpriteMaterial?y(I,L):L.isShadowMaterial?(I.color.value.copy(L.color),I.opacity.value=L.opacity):L.isShaderMaterial&&(L.uniformsNeedUpdate=!1)}function l(I,L){I.opacity.value=L.opacity,L.color&&I.diffuse.value.copy(L.color),L.emissive&&I.emissive.value.copy(L.emissive).multiplyScalar(L.emissiveIntensity),L.map&&(I.map.value=L.map,n(L.map,I.mapTransform)),L.alphaMap&&(I.alphaMap.value=L.alphaMap,n(L.alphaMap,I.alphaMapTransform)),L.bumpMap&&(I.bumpMap.value=L.bumpMap,n(L.bumpMap,I.bumpMapTransform),I.bumpScale.value=L.bumpScale,L.side===tl&&(I.bumpScale.value*=-1)),L.normalMap&&(I.normalMap.value=L.normalMap,n(L.normalMap,I.normalMapTransform),I.normalScale.value.copy(L.normalScale),L.side===tl&&I.normalScale.value.negate()),L.displacementMap&&(I.displacementMap.value=L.displacementMap,n(L.displacementMap,I.displacementMapTransform),I.displacementScale.value=L.displacementScale,I.displacementBias.value=L.displacementBias),L.emissiveMap&&(I.emissiveMap.value=L.emissiveMap,n(L.emissiveMap,I.emissiveMapTransform)),L.specularMap&&(I.specularMap.value=L.specularMap,n(L.specularMap,I.specularMapTransform)),L.alphaTest>0&&(I.alphaTest.value=L.alphaTest);const V=e.get(L),B=V.envMap,W=V.envMapRotation;B&&(I.envMap.value=B,bm.copy(W),bm.x*=-1,bm.y*=-1,bm.z*=-1,B.isCubeTexture&&B.isRenderTargetTexture===!1&&(bm.y*=-1,bm.z*=-1),I.envMapRotation.value.setFromMatrix4(wge.makeRotationFromEuler(bm)),I.flipEnvMap.value=B.isCubeTexture&&B.isRenderTargetTexture===!1?-1:1,I.reflectivity.value=L.reflectivity,I.ior.value=L.ior,I.refractionRatio.value=L.refractionRatio),L.lightMap&&(I.lightMap.value=L.lightMap,I.lightMapIntensity.value=L.lightMapIntensity,n(L.lightMap,I.lightMapTransform)),L.aoMap&&(I.aoMap.value=L.aoMap,I.aoMapIntensity.value=L.aoMapIntensity,n(L.aoMap,I.aoMapTransform))}function c(I,L){I.diffuse.value.copy(L.color),I.opacity.value=L.opacity,L.map&&(I.map.value=L.map,n(L.map,I.mapTransform))}function s(I,L){I.dashSize.value=L.dashSize,I.totalSize.value=L.dashSize+L.gapSize,I.scale.value=L.scale}function m(I,L,V,B){I.diffuse.value.copy(L.color),I.opacity.value=L.opacity,I.size.value=L.size*V,I.scale.value=B*.5,L.map&&(I.map.value=L.map,n(L.map,I.uvTransform)),L.alphaMap&&(I.alphaMap.value=L.alphaMap,n(L.alphaMap,I.alphaMapTransform)),L.alphaTest>0&&(I.alphaTest.value=L.alphaTest)}function y(I,L){I.diffuse.value.copy(L.color),I.opacity.value=L.opacity,I.rotation.value=L.rotation,L.map&&(I.map.value=L.map,n(L.map,I.mapTransform)),L.alphaMap&&(I.alphaMap.value=L.alphaMap,n(L.alphaMap,I.alphaMapTransform)),L.alphaTest>0&&(I.alphaTest.value=L.alphaTest)}function b(I,L){I.specular.value.copy(L.specular),I.shininess.value=Math.max(L.shininess,1e-4)}function w(I,L){L.gradientMap&&(I.gradientMap.value=L.gradientMap)}function E(I,L){I.metalness.value=L.metalness,L.metalnessMap&&(I.metalnessMap.value=L.metalnessMap,n(L.metalnessMap,I.metalnessMapTransform)),I.roughness.value=L.roughness,L.roughnessMap&&(I.roughnessMap.value=L.roughnessMap,n(L.roughnessMap,I.roughnessMapTransform)),L.envMap&&(I.envMapIntensity.value=L.envMapIntensity)}function T(I,L,V){I.ior.value=L.ior,L.sheen>0&&(I.sheenColor.value.copy(L.sheenColor).multiplyScalar(L.sheen),I.sheenRoughness.value=L.sheenRoughness,L.sheenColorMap&&(I.sheenColorMap.value=L.sheenColorMap,n(L.sheenColorMap,I.sheenColorMapTransform)),L.sheenRoughnessMap&&(I.sheenRoughnessMap.value=L.sheenRoughnessMap,n(L.sheenRoughnessMap,I.sheenRoughnessMapTransform))),L.clearcoat>0&&(I.clearcoat.value=L.clearcoat,I.clearcoatRoughness.value=L.clearcoatRoughness,L.clearcoatMap&&(I.clearcoatMap.value=L.clearcoatMap,n(L.clearcoatMap,I.clearcoatMapTransform)),L.clearcoatRoughnessMap&&(I.clearcoatRoughnessMap.value=L.clearcoatRoughnessMap,n(L.clearcoatRoughnessMap,I.clearcoatRoughnessMapTransform)),L.clearcoatNormalMap&&(I.clearcoatNormalMap.value=L.clearcoatNormalMap,n(L.clearcoatNormalMap,I.clearcoatNormalMapTransform),I.clearcoatNormalScale.value.copy(L.clearcoatNormalScale),L.side===tl&&I.clearcoatNormalScale.value.negate())),L.dispersion>0&&(I.dispersion.value=L.dispersion),L.iridescence>0&&(I.iridescence.value=L.iridescence,I.iridescenceIOR.value=L.iridescenceIOR,I.iridescenceThicknessMinimum.value=L.iridescenceThicknessRange[0],I.iridescenceThicknessMaximum.value=L.iridescenceThicknessRange[1],L.iridescenceMap&&(I.iridescenceMap.value=L.iridescenceMap,n(L.iridescenceMap,I.iridescenceMapTransform)),L.iridescenceThicknessMap&&(I.iridescenceThicknessMap.value=L.iridescenceThicknessMap,n(L.iridescenceThicknessMap,I.iridescenceThicknessMapTransform))),L.transmission>0&&(I.transmission.value=L.transmission,I.transmissionSamplerMap.value=V.texture,I.transmissionSamplerSize.value.set(V.width,V.height),L.transmissionMap&&(I.transmissionMap.value=L.transmissionMap,n(L.transmissionMap,I.transmissionMapTransform)),I.thickness.value=L.thickness,L.thicknessMap&&(I.thicknessMap.value=L.thicknessMap,n(L.thicknessMap,I.thicknessMapTransform)),I.attenuationDistance.value=L.attenuationDistance,I.attenuationColor.value.copy(L.attenuationColor)),L.anisotropy>0&&(I.anisotropyVector.value.set(L.anisotropy*Math.cos(L.anisotropyRotation),L.anisotropy*Math.sin(L.anisotropyRotation)),L.anisotropyMap&&(I.anisotropyMap.value=L.anisotropyMap,n(L.anisotropyMap,I.anisotropyMapTransform))),I.specularIntensity.value=L.specularIntensity,I.specularColor.value.copy(L.specularColor),L.specularColorMap&&(I.specularColorMap.value=L.specularColorMap,n(L.specularColorMap,I.specularColorMapTransform)),L.specularIntensityMap&&(I.specularIntensityMap.value=L.specularIntensityMap,n(L.specularIntensityMap,I.specularIntensityMapTransform))}function R(I,L){L.matcap&&(I.matcap.value=L.matcap)}function z(I,L){const V=e.get(L).light;I.referencePosition.value.setFromMatrixPosition(V.matrixWorld),I.nearDistance.value=V.shadow.camera.near,I.farDistance.value=V.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:o}}function Mge(t,e,n,r){let o={},l={},c=[];const s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function m(V,B){const W=B.program;r.uniformBlockBinding(V,W)}function y(V,B){let W=o[V.id];W===void 0&&(R(V),W=b(V),o[V.id]=W,V.addEventListener("dispose",I));const X=B.program;r.updateUBOMapping(V,X);const q=e.render.frame;l[V.id]!==q&&(E(V),l[V.id]=q)}function b(V){const B=w();V.__bindingPointIndex=B;const W=t.createBuffer(),X=V.__size,q=V.usage;return t.bindBuffer(t.UNIFORM_BUFFER,W),t.bufferData(t.UNIFORM_BUFFER,X,q),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,B,W),W}function w(){for(let V=0;V<s;V++)if(c.indexOf(V)===-1)return c.push(V),V;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function E(V){const B=o[V.id],W=V.uniforms,X=V.__cache;t.bindBuffer(t.UNIFORM_BUFFER,B);for(let q=0,te=W.length;q<te;q++){const se=Array.isArray(W[q])?W[q]:[W[q]];for(let re=0,$=se.length;re<$;re++){const ce=se[re];if(T(ce,q,re,X)===!0){const Ce=ce.__offset,Se=Array.isArray(ce.value)?ce.value:[ce.value];let Xe=0;for(let Fe=0;Fe<Se.length;Fe++){const Me=Se[Fe],Te=z(Me);typeof Me=="number"||typeof Me=="boolean"?(ce.__data[0]=Me,t.bufferSubData(t.UNIFORM_BUFFER,Ce+Xe,ce.__data)):Me.isMatrix3?(ce.__data[0]=Me.elements[0],ce.__data[1]=Me.elements[1],ce.__data[2]=Me.elements[2],ce.__data[3]=0,ce.__data[4]=Me.elements[3],ce.__data[5]=Me.elements[4],ce.__data[6]=Me.elements[5],ce.__data[7]=0,ce.__data[8]=Me.elements[6],ce.__data[9]=Me.elements[7],ce.__data[10]=Me.elements[8],ce.__data[11]=0):(Me.toArray(ce.__data,Xe),Xe+=Te.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,Ce,ce.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function T(V,B,W,X){const q=V.value,te=B+"_"+W;if(X[te]===void 0)return typeof q=="number"||typeof q=="boolean"?X[te]=q:X[te]=q.clone(),!0;{const se=X[te];if(typeof q=="number"||typeof q=="boolean"){if(se!==q)return X[te]=q,!0}else if(se.equals(q)===!1)return se.copy(q),!0}return!1}function R(V){const B=V.uniforms;let W=0;const X=16;for(let te=0,se=B.length;te<se;te++){const re=Array.isArray(B[te])?B[te]:[B[te]];for(let $=0,ce=re.length;$<ce;$++){const Ce=re[$],Se=Array.isArray(Ce.value)?Ce.value:[Ce.value];for(let Xe=0,Fe=Se.length;Xe<Fe;Xe++){const Me=Se[Xe],Te=z(Me),Ie=W%X,Ke=Ie%Te.boundary,st=Ie+Ke;W+=Ke,st!==0&&X-st<Te.storage&&(W+=X-st),Ce.__data=new Float32Array(Te.storage/Float32Array.BYTES_PER_ELEMENT),Ce.__offset=W,W+=Te.storage}}}const q=W%X;return q>0&&(W+=X-q),V.__size=W,V.__cache={},this}function z(V){const B={boundary:0,storage:0};return typeof V=="number"||typeof V=="boolean"?(B.boundary=4,B.storage=4):V.isVector2?(B.boundary=8,B.storage=8):V.isVector3||V.isColor?(B.boundary=16,B.storage=12):V.isVector4?(B.boundary=16,B.storage=16):V.isMatrix3?(B.boundary=48,B.storage=48):V.isMatrix4?(B.boundary=64,B.storage=64):V.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",V),B}function I(V){const B=V.target;B.removeEventListener("dispose",I);const W=c.indexOf(B.__bindingPointIndex);c.splice(W,1),t.deleteBuffer(o[B.id]),delete o[B.id],delete l[B.id]}function L(){for(const V in o)t.deleteBuffer(o[V]);c=[],o={},l={}}return{bind:m,update:y,dispose:L}}class Cge{constructor(e={}){const{canvas:n=the(),context:r=null,depth:o=!0,stencil:l=!1,alpha:c=!1,antialias:s=!1,premultipliedAlpha:m=!0,preserveDrawingBuffer:y=!1,powerPreference:b="default",failIfMajorPerformanceCaveat:w=!1,reverseDepthBuffer:E=!1}=e;this.isWebGLRenderer=!0;let T;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");T=r.getContextAttributes().alpha}else T=c;const R=new Uint32Array(4),z=new Int32Array(4);let I=null,L=null;const V=[],B=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Qf,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const W=this;let X=!1;this._outputColorSpace=Cc;let q=0,te=0,se=null,re=-1,$=null;const ce=new ko,Ce=new ko;let Se=null;const Xe=new xi(0);let Fe=0,Me=n.width,Te=n.height,Ie=1,Ke=null,st=null;const Ee=new ko(0,0,Me,Te),Qe=new ko(0,0,Me,Te);let jt=!1;const je=new HA;let ft=!1,At=!1;const ht=new Ti,lt=new Ti,bt=new Pt,St=new ko,dn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let En=!1;function un(){return se===null?Ie:1}let et=r;function Ln(xe,vt){return n.getContext(xe,vt)}try{const xe={alpha:!0,depth:o,stencil:l,antialias:s,premultipliedAlpha:m,preserveDrawingBuffer:y,powerPreference:b,failIfMajorPerformanceCaveat:w};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${DA}`),n.addEventListener("webglcontextlost",$e,!1),n.addEventListener("webglcontextrestored",He,!1),n.addEventListener("webglcontextcreationerror",ut,!1),et===null){const vt="webgl2";if(et=Ln(vt,xe),et===null)throw Ln(vt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(xe){throw console.error("THREE.WebGLRenderer: "+xe.message),xe}let Jt,fn,$t,Nn,vn,Ue,we,yt,Nt,Ht,Ot,ln,Gt,Zt,Fn,Yt,Pe,ae,ue,ee,fe,Oe,Ye,ye;function Ae(){Jt=new zpe(et),Jt.init(),Oe=new vge(et,Jt),fn=new Ppe(et,Jt,e,Oe),$t=new mge(et,Jt),fn.reverseDepthBuffer&&E&&$t.buffers.depth.setReversed(!0),Nn=new Npe(et),vn=new nge,Ue=new gge(et,Jt,$t,vn,fn,Oe,Nn),we=new Ipe(W),yt=new kpe(W),Nt=new Hhe(et),Ye=new Epe(et,Nt),Ht=new Ope(et,Nt,Nn,Ye),Ot=new Upe(et,Ht,Nt,Nn),ue=new Bpe(et,fn,Ue),Yt=new Ape(vn),ln=new tge(W,we,yt,Jt,fn,Ye,Yt),Gt=new Sge(W,vn),Zt=new ige,Fn=new uge(Jt),ae=new Cpe(W,we,yt,$t,Ot,T,m),Pe=new fge(W,Ot,fn),ye=new Mge(et,Nn,fn,$t),ee=new Tpe(et,Jt,Nn),fe=new Fpe(et,Jt,Nn),Nn.programs=ln.programs,W.capabilities=fn,W.extensions=Jt,W.properties=vn,W.renderLists=Zt,W.shadowMap=Pe,W.state=$t,W.info=Nn}Ae();const Be=new bge(W,et);this.xr=Be,this.getContext=function(){return et},this.getContextAttributes=function(){return et.getContextAttributes()},this.forceContextLoss=function(){const xe=Jt.get("WEBGL_lose_context");xe&&xe.loseContext()},this.forceContextRestore=function(){const xe=Jt.get("WEBGL_lose_context");xe&&xe.restoreContext()},this.getPixelRatio=function(){return Ie},this.setPixelRatio=function(xe){xe!==void 0&&(Ie=xe,this.setSize(Me,Te,!1))},this.getSize=function(xe){return xe.set(Me,Te)},this.setSize=function(xe,vt,kt=!0){if(Be.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Me=xe,Te=vt,n.width=Math.floor(xe*Ie),n.height=Math.floor(vt*Ie),kt===!0&&(n.style.width=xe+"px",n.style.height=vt+"px"),this.setViewport(0,0,xe,vt)},this.getDrawingBufferSize=function(xe){return xe.set(Me*Ie,Te*Ie).floor()},this.setDrawingBufferSize=function(xe,vt,kt){Me=xe,Te=vt,Ie=kt,n.width=Math.floor(xe*kt),n.height=Math.floor(vt*kt),this.setViewport(0,0,xe,vt)},this.getCurrentViewport=function(xe){return xe.copy(ce)},this.getViewport=function(xe){return xe.copy(Ee)},this.setViewport=function(xe,vt,kt,xt){xe.isVector4?Ee.set(xe.x,xe.y,xe.z,xe.w):Ee.set(xe,vt,kt,xt),$t.viewport(ce.copy(Ee).multiplyScalar(Ie).round())},this.getScissor=function(xe){return xe.copy(Qe)},this.setScissor=function(xe,vt,kt,xt){xe.isVector4?Qe.set(xe.x,xe.y,xe.z,xe.w):Qe.set(xe,vt,kt,xt),$t.scissor(Ce.copy(Qe).multiplyScalar(Ie).round())},this.getScissorTest=function(){return jt},this.setScissorTest=function(xe){$t.setScissorTest(jt=xe)},this.setOpaqueSort=function(xe){Ke=xe},this.setTransparentSort=function(xe){st=xe},this.getClearColor=function(xe){return xe.copy(ae.getClearColor())},this.setClearColor=function(){ae.setClearColor(...arguments)},this.getClearAlpha=function(){return ae.getClearAlpha()},this.setClearAlpha=function(){ae.setClearAlpha(...arguments)},this.clear=function(xe=!0,vt=!0,kt=!0){let xt=0;if(xe){let wt=!1;if(se!==null){const hn=se.texture.format;wt=hn===BA||hn===NA||hn===FA}if(wt){const hn=se.texture.type,Pn=hn===Xd||hn===Hm||hn===b_||hn===w_||hn===zA||hn===OA,mn=ae.getClearColor(),Tn=ae.getClearAlpha(),Qt=mn.r,Zn=mn.g,An=mn.b;Pn?(R[0]=Qt,R[1]=Zn,R[2]=An,R[3]=Tn,et.clearBufferuiv(et.COLOR,0,R)):(z[0]=Qt,z[1]=Zn,z[2]=An,z[3]=Tn,et.clearBufferiv(et.COLOR,0,z))}else xt|=et.COLOR_BUFFER_BIT}vt&&(xt|=et.DEPTH_BUFFER_BIT),kt&&(xt|=et.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),et.clear(xt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",$e,!1),n.removeEventListener("webglcontextrestored",He,!1),n.removeEventListener("webglcontextcreationerror",ut,!1),ae.dispose(),Zt.dispose(),Fn.dispose(),vn.dispose(),we.dispose(),yt.dispose(),Ot.dispose(),Ye.dispose(),ye.dispose(),ln.dispose(),Be.dispose(),Be.removeEventListener("sessionstart",Wt),Be.removeEventListener("sessionend",tn),pn.stop()};function $e(xe){xe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),X=!0}function He(){console.log("THREE.WebGLRenderer: Context Restored."),X=!1;const xe=Nn.autoReset,vt=Pe.enabled,kt=Pe.autoUpdate,xt=Pe.needsUpdate,wt=Pe.type;Ae(),Nn.autoReset=xe,Pe.enabled=vt,Pe.autoUpdate=kt,Pe.needsUpdate=xt,Pe.type=wt}function ut(xe){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",xe.statusMessage)}function We(xe){const vt=xe.target;vt.removeEventListener("dispose",We),Ut(vt)}function Ut(xe){Kt(xe),vn.remove(xe)}function Kt(xe){const vt=vn.get(xe).programs;vt!==void 0&&(vt.forEach(function(kt){ln.releaseProgram(kt)}),xe.isShaderMaterial&&ln.releaseShaderCache(xe))}this.renderBufferDirect=function(xe,vt,kt,xt,wt,hn){vt===null&&(vt=dn);const Pn=wt.isMesh&&wt.matrixWorld.determinant()<0,mn=nt(xe,vt,kt,xt,wt);$t.setMaterial(xt,Pn);let Tn=kt.index,Qt=1;if(xt.wireframe===!0){if(Tn=Ht.getWireframeAttribute(kt),Tn===void 0)return;Qt=2}const Zn=kt.drawRange,An=kt.attributes.position;let Wn=Zn.start*Qt,tr=(Zn.start+Zn.count)*Qt;hn!==null&&(Wn=Math.max(Wn,hn.start*Qt),tr=Math.min(tr,(hn.start+hn.count)*Qt)),Tn!==null?(Wn=Math.max(Wn,0),tr=Math.min(tr,Tn.count)):An!=null&&(Wn=Math.max(Wn,0),tr=Math.min(tr,An.count));const Or=tr-Wn;if(Or<0||Or===1/0)return;Ye.setup(wt,xt,mn,kt,Tn);let Fr,wr=ee;if(Tn!==null&&(Fr=Nt.get(Tn),wr=fe,wr.setIndex(Fr)),wt.isMesh)xt.wireframe===!0?($t.setLineWidth(xt.wireframeLinewidth*un()),wr.setMode(et.LINES)):wr.setMode(et.TRIANGLES);else if(wt.isLine){let ur=xt.linewidth;ur===void 0&&(ur=1),$t.setLineWidth(ur*un()),wt.isLineSegments?wr.setMode(et.LINES):wt.isLineLoop?wr.setMode(et.LINE_LOOP):wr.setMode(et.LINE_STRIP)}else wt.isPoints?wr.setMode(et.POINTS):wt.isSprite&&wr.setMode(et.TRIANGLES);if(wt.isBatchedMesh)if(wt._multiDrawInstances!==null)c1("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),wr.renderMultiDrawInstances(wt._multiDrawStarts,wt._multiDrawCounts,wt._multiDrawCount,wt._multiDrawInstances);else if(Jt.get("WEBGL_multi_draw"))wr.renderMultiDraw(wt._multiDrawStarts,wt._multiDrawCounts,wt._multiDrawCount);else{const ur=wt._multiDrawStarts,ui=wt._multiDrawCounts,Lr=wt._multiDrawCount,Eo=Tn?Nt.get(Tn).bytesPerElement:1,Ys=vn.get(xt).currentProgram.getUniforms();for(let Jo=0;Jo<Lr;Jo++)Ys.setValue(et,"_gl_DrawID",Jo),wr.render(ur[Jo]/Eo,ui[Jo])}else if(wt.isInstancedMesh)wr.renderInstances(Wn,Or,wt.count);else if(kt.isInstancedBufferGeometry){const ur=kt._maxInstanceCount!==void 0?kt._maxInstanceCount:1/0,ui=Math.min(kt.instanceCount,ur);wr.renderInstances(Wn,Or,ui)}else wr.render(Wn,Or)};function Re(xe,vt,kt){xe.transparent===!0&&xe.side===Nd&&xe.forceSinglePass===!1?(xe.side=tl,xe.needsUpdate=!0,On(xe,vt,kt),xe.side=up,xe.needsUpdate=!0,On(xe,vt,kt),xe.side=Nd):On(xe,vt,kt)}this.compile=function(xe,vt,kt=null){kt===null&&(kt=xe),L=Fn.get(kt),L.init(vt),B.push(L),kt.traverseVisible(function(wt){wt.isLight&&wt.layers.test(vt.layers)&&(L.pushLight(wt),wt.castShadow&&L.pushShadow(wt))}),xe!==kt&&xe.traverseVisible(function(wt){wt.isLight&&wt.layers.test(vt.layers)&&(L.pushLight(wt),wt.castShadow&&L.pushShadow(wt))}),L.setupLights();const xt=new Set;return xe.traverse(function(wt){if(!(wt.isMesh||wt.isPoints||wt.isLine||wt.isSprite))return;const hn=wt.material;if(hn)if(Array.isArray(hn))for(let Pn=0;Pn<hn.length;Pn++){const mn=hn[Pn];Re(mn,kt,wt),xt.add(mn)}else Re(hn,kt,wt),xt.add(hn)}),L=B.pop(),xt},this.compileAsync=function(xe,vt,kt=null){const xt=this.compile(xe,vt,kt);return new Promise(wt=>{function hn(){if(xt.forEach(function(Pn){vn.get(Pn).currentProgram.isReady()&&xt.delete(Pn)}),xt.size===0){wt(xe);return}setTimeout(hn,10)}Jt.get("KHR_parallel_shader_compile")!==null?hn():setTimeout(hn,10)})};let it=null;function mt(xe){it&&it(xe)}function Wt(){pn.stop()}function tn(){pn.start()}const pn=new OB;pn.setAnimationLoop(mt),typeof self<"u"&&pn.setContext(self),this.setAnimationLoop=function(xe){it=xe,Be.setAnimationLoop(xe),xe===null?pn.stop():pn.start()},Be.addEventListener("sessionstart",Wt),Be.addEventListener("sessionend",tn),this.render=function(xe,vt){if(vt!==void 0&&vt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(X===!0)return;if(xe.matrixWorldAutoUpdate===!0&&xe.updateMatrixWorld(),vt.parent===null&&vt.matrixWorldAutoUpdate===!0&&vt.updateMatrixWorld(),Be.enabled===!0&&Be.isPresenting===!0&&(Be.cameraAutoUpdate===!0&&Be.updateCamera(vt),vt=Be.getCamera()),xe.isScene===!0&&xe.onBeforeRender(W,xe,vt,se),L=Fn.get(xe,B.length),L.init(vt),B.push(L),lt.multiplyMatrices(vt.projectionMatrix,vt.matrixWorldInverse),je.setFromProjectionMatrix(lt),At=this.localClippingEnabled,ft=Yt.init(this.clippingPlanes,At),I=Zt.get(xe,V.length),I.init(),V.push(I),Be.enabled===!0&&Be.isPresenting===!0){const hn=W.xr.getDepthSensingMesh();hn!==null&&rn(hn,vt,-1/0,W.sortObjects)}rn(xe,vt,0,W.sortObjects),I.finish(),W.sortObjects===!0&&I.sort(Ke,st),En=Be.enabled===!1||Be.isPresenting===!1||Be.hasDepthSensing()===!1,En&&ae.addToRenderList(I,xe),this.info.render.frame++,ft===!0&&Yt.beginShadows();const kt=L.state.shadowsArray;Pe.render(kt,xe,vt),ft===!0&&Yt.endShadows(),this.info.autoReset===!0&&this.info.reset();const xt=I.opaque,wt=I.transmissive;if(L.setupLights(),vt.isArrayCamera){const hn=vt.cameras;if(wt.length>0)for(let Pn=0,mn=hn.length;Pn<mn;Pn++){const Tn=hn[Pn];kn(xt,wt,xe,Tn)}En&&ae.render(xe);for(let Pn=0,mn=hn.length;Pn<mn;Pn++){const Tn=hn[Pn];on(I,xe,Tn,Tn.viewport)}}else wt.length>0&&kn(xt,wt,xe,vt),En&&ae.render(xe),on(I,xe,vt);se!==null&&te===0&&(Ue.updateMultisampleRenderTarget(se),Ue.updateRenderTargetMipmap(se)),xe.isScene===!0&&xe.onAfterRender(W,xe,vt),Ye.resetDefaultState(),re=-1,$=null,B.pop(),B.length>0?(L=B[B.length-1],ft===!0&&Yt.setGlobalState(W.clippingPlanes,L.state.camera)):L=null,V.pop(),V.length>0?I=V[V.length-1]:I=null};function rn(xe,vt,kt,xt){if(xe.visible===!1)return;if(xe.layers.test(vt.layers)){if(xe.isGroup)kt=xe.renderOrder;else if(xe.isLOD)xe.autoUpdate===!0&&xe.update(vt);else if(xe.isLight)L.pushLight(xe),xe.castShadow&&L.pushShadow(xe);else if(xe.isSprite){if(!xe.frustumCulled||je.intersectsSprite(xe)){xt&&St.setFromMatrixPosition(xe.matrixWorld).applyMatrix4(lt);const Pn=Ot.update(xe),mn=xe.material;mn.visible&&I.push(xe,Pn,mn,kt,St.z,null)}}else if((xe.isMesh||xe.isLine||xe.isPoints)&&(!xe.frustumCulled||je.intersectsObject(xe))){const Pn=Ot.update(xe),mn=xe.material;if(xt&&(xe.boundingSphere!==void 0?(xe.boundingSphere===null&&xe.computeBoundingSphere(),St.copy(xe.boundingSphere.center)):(Pn.boundingSphere===null&&Pn.computeBoundingSphere(),St.copy(Pn.boundingSphere.center)),St.applyMatrix4(xe.matrixWorld).applyMatrix4(lt)),Array.isArray(mn)){const Tn=Pn.groups;for(let Qt=0,Zn=Tn.length;Qt<Zn;Qt++){const An=Tn[Qt],Wn=mn[An.materialIndex];Wn&&Wn.visible&&I.push(xe,Pn,Wn,kt,St.z,An)}}else mn.visible&&I.push(xe,Pn,mn,kt,St.z,null)}}const hn=xe.children;for(let Pn=0,mn=hn.length;Pn<mn;Pn++)rn(hn[Pn],vt,kt,xt)}function on(xe,vt,kt,xt){const wt=xe.opaque,hn=xe.transmissive,Pn=xe.transparent;L.setupLightsView(kt),ft===!0&&Yt.setGlobalState(W.clippingPlanes,kt),xt&&$t.viewport(ce.copy(xt)),wt.length>0&&Ct(wt,vt,kt),hn.length>0&&Ct(hn,vt,kt),Pn.length>0&&Ct(Pn,vt,kt),$t.buffers.depth.setTest(!0),$t.buffers.depth.setMask(!0),$t.buffers.color.setMask(!0),$t.setPolygonOffset(!1)}function kn(xe,vt,kt,xt){if((kt.isScene===!0?kt.overrideMaterial:null)!==null)return;L.state.transmissionRenderTarget[xt.id]===void 0&&(L.state.transmissionRenderTarget[xt.id]=new hp(1,1,{generateMipmaps:!0,type:Jt.has("EXT_color_buffer_half_float")||Jt.has("EXT_color_buffer_float")?ax:Xd,minFilter:Zf,samples:4,stencilBuffer:l,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:li.workingColorSpace}));const hn=L.state.transmissionRenderTarget[xt.id],Pn=xt.viewport||ce;hn.setSize(Pn.z*W.transmissionResolutionScale,Pn.w*W.transmissionResolutionScale);const mn=W.getRenderTarget();W.setRenderTarget(hn),W.getClearColor(Xe),Fe=W.getClearAlpha(),Fe<1&&W.setClearColor(16777215,.5),W.clear(),En&&ae.render(kt);const Tn=W.toneMapping;W.toneMapping=Qf;const Qt=xt.viewport;if(xt.viewport!==void 0&&(xt.viewport=void 0),L.setupLightsView(xt),ft===!0&&Yt.setGlobalState(W.clippingPlanes,xt),Ct(xe,kt,xt),Ue.updateMultisampleRenderTarget(hn),Ue.updateRenderTargetMipmap(hn),Jt.has("WEBGL_multisampled_render_to_texture")===!1){let Zn=!1;for(let An=0,Wn=vt.length;An<Wn;An++){const tr=vt[An],Or=tr.object,Fr=tr.geometry,wr=tr.material,ur=tr.group;if(wr.side===Nd&&Or.layers.test(xt.layers)){const ui=wr.side;wr.side=tl,wr.needsUpdate=!0,Gn(Or,kt,xt,Fr,wr,ur),wr.side=ui,wr.needsUpdate=!0,Zn=!0}}Zn===!0&&(Ue.updateMultisampleRenderTarget(hn),Ue.updateRenderTargetMipmap(hn))}W.setRenderTarget(mn),W.setClearColor(Xe,Fe),Qt!==void 0&&(xt.viewport=Qt),W.toneMapping=Tn}function Ct(xe,vt,kt){const xt=vt.isScene===!0?vt.overrideMaterial:null;for(let wt=0,hn=xe.length;wt<hn;wt++){const Pn=xe[wt],mn=Pn.object,Tn=Pn.geometry,Qt=Pn.group;let Zn=Pn.material;Zn.allowOverride===!0&&xt!==null&&(Zn=xt),mn.layers.test(kt.layers)&&Gn(mn,vt,kt,Tn,Zn,Qt)}}function Gn(xe,vt,kt,xt,wt,hn){xe.onBeforeRender(W,vt,kt,xt,wt,hn),xe.modelViewMatrix.multiplyMatrices(kt.matrixWorldInverse,xe.matrixWorld),xe.normalMatrix.getNormalMatrix(xe.modelViewMatrix),wt.onBeforeRender(W,vt,kt,xt,xe,hn),wt.transparent===!0&&wt.side===Nd&&wt.forceSinglePass===!1?(wt.side=tl,wt.needsUpdate=!0,W.renderBufferDirect(kt,vt,xt,wt,xe,hn),wt.side=up,wt.needsUpdate=!0,W.renderBufferDirect(kt,vt,xt,wt,xe,hn),wt.side=Nd):W.renderBufferDirect(kt,vt,xt,wt,xe,hn),xe.onAfterRender(W,vt,kt,xt,wt,hn)}function On(xe,vt,kt){vt.isScene!==!0&&(vt=dn);const xt=vn.get(xe),wt=L.state.lights,hn=L.state.shadowsArray,Pn=wt.state.version,mn=ln.getParameters(xe,wt.state,hn,vt,kt),Tn=ln.getProgramCacheKey(mn);let Qt=xt.programs;xt.environment=xe.isMeshStandardMaterial?vt.environment:null,xt.fog=vt.fog,xt.envMap=(xe.isMeshStandardMaterial?yt:we).get(xe.envMap||xt.environment),xt.envMapRotation=xt.environment!==null&&xe.envMap===null?vt.environmentRotation:xe.envMapRotation,Qt===void 0&&(xe.addEventListener("dispose",We),Qt=new Map,xt.programs=Qt);let Zn=Qt.get(Tn);if(Zn!==void 0){if(xt.currentProgram===Zn&&xt.lightsStateVersion===Pn)return It(xe,mn),Zn}else mn.uniforms=ln.getUniforms(xe),xe.onBeforeCompile(mn,W),Zn=ln.acquireProgram(mn,Tn),Qt.set(Tn,Zn),xt.uniforms=mn.uniforms;const An=xt.uniforms;return(!xe.isShaderMaterial&&!xe.isRawShaderMaterial||xe.clipping===!0)&&(An.clippingPlanes=Yt.uniform),It(xe,mn),xt.needsLights=cn(xe),xt.lightsStateVersion=Pn,xt.needsLights&&(An.ambientLightColor.value=wt.state.ambient,An.lightProbe.value=wt.state.probe,An.directionalLights.value=wt.state.directional,An.directionalLightShadows.value=wt.state.directionalShadow,An.spotLights.value=wt.state.spot,An.spotLightShadows.value=wt.state.spotShadow,An.rectAreaLights.value=wt.state.rectArea,An.ltc_1.value=wt.state.rectAreaLTC1,An.ltc_2.value=wt.state.rectAreaLTC2,An.pointLights.value=wt.state.point,An.pointLightShadows.value=wt.state.pointShadow,An.hemisphereLights.value=wt.state.hemi,An.directionalShadowMap.value=wt.state.directionalShadowMap,An.directionalShadowMatrix.value=wt.state.directionalShadowMatrix,An.spotShadowMap.value=wt.state.spotShadowMap,An.spotLightMatrix.value=wt.state.spotLightMatrix,An.spotLightMap.value=wt.state.spotLightMap,An.pointShadowMap.value=wt.state.pointShadowMap,An.pointShadowMatrix.value=wt.state.pointShadowMatrix),xt.currentProgram=Zn,xt.uniformsList=null,Zn}function or(xe){if(xe.uniformsList===null){const vt=xe.currentProgram.getUniforms();xe.uniformsList=u1.seqWithValue(vt.seq,xe.uniforms)}return xe.uniformsList}function It(xe,vt){const kt=vn.get(xe);kt.outputColorSpace=vt.outputColorSpace,kt.batching=vt.batching,kt.batchingColor=vt.batchingColor,kt.instancing=vt.instancing,kt.instancingColor=vt.instancingColor,kt.instancingMorph=vt.instancingMorph,kt.skinning=vt.skinning,kt.morphTargets=vt.morphTargets,kt.morphNormals=vt.morphNormals,kt.morphColors=vt.morphColors,kt.morphTargetsCount=vt.morphTargetsCount,kt.numClippingPlanes=vt.numClippingPlanes,kt.numIntersection=vt.numClipIntersection,kt.vertexAlphas=vt.vertexAlphas,kt.vertexTangents=vt.vertexTangents,kt.toneMapping=vt.toneMapping}function nt(xe,vt,kt,xt,wt){vt.isScene!==!0&&(vt=dn),Ue.resetTextureUnits();const hn=vt.fog,Pn=xt.isMeshStandardMaterial?vt.environment:null,mn=se===null?W.outputColorSpace:se.isXRRenderTarget===!0?se.texture.colorSpace:Gm,Tn=(xt.isMeshStandardMaterial?yt:we).get(xt.envMap||Pn),Qt=xt.vertexColors===!0&&!!kt.attributes.color&&kt.attributes.color.itemSize===4,Zn=!!kt.attributes.tangent&&(!!xt.normalMap||xt.anisotropy>0),An=!!kt.morphAttributes.position,Wn=!!kt.morphAttributes.normal,tr=!!kt.morphAttributes.color;let Or=Qf;xt.toneMapped&&(se===null||se.isXRRenderTarget===!0)&&(Or=W.toneMapping);const Fr=kt.morphAttributes.position||kt.morphAttributes.normal||kt.morphAttributes.color,wr=Fr!==void 0?Fr.length:0,ur=vn.get(xt),ui=L.state.lights;if(ft===!0&&(At===!0||xe!==$)){const ho=xe===$&&xt.id===re;Yt.setState(xt,xe,ho)}let Lr=!1;xt.version===ur.__version?(ur.needsLights&&ur.lightsStateVersion!==ui.state.version||ur.outputColorSpace!==mn||wt.isBatchedMesh&&ur.batching===!1||!wt.isBatchedMesh&&ur.batching===!0||wt.isBatchedMesh&&ur.batchingColor===!0&&wt.colorTexture===null||wt.isBatchedMesh&&ur.batchingColor===!1&&wt.colorTexture!==null||wt.isInstancedMesh&&ur.instancing===!1||!wt.isInstancedMesh&&ur.instancing===!0||wt.isSkinnedMesh&&ur.skinning===!1||!wt.isSkinnedMesh&&ur.skinning===!0||wt.isInstancedMesh&&ur.instancingColor===!0&&wt.instanceColor===null||wt.isInstancedMesh&&ur.instancingColor===!1&&wt.instanceColor!==null||wt.isInstancedMesh&&ur.instancingMorph===!0&&wt.morphTexture===null||wt.isInstancedMesh&&ur.instancingMorph===!1&&wt.morphTexture!==null||ur.envMap!==Tn||xt.fog===!0&&ur.fog!==hn||ur.numClippingPlanes!==void 0&&(ur.numClippingPlanes!==Yt.numPlanes||ur.numIntersection!==Yt.numIntersection)||ur.vertexAlphas!==Qt||ur.vertexTangents!==Zn||ur.morphTargets!==An||ur.morphNormals!==Wn||ur.morphColors!==tr||ur.toneMapping!==Or||ur.morphTargetsCount!==wr)&&(Lr=!0):(Lr=!0,ur.__version=xt.version);let Eo=ur.currentProgram;Lr===!0&&(Eo=On(xt,vt,wt));let Ys=!1,Jo=!1,Ia=!1;const Zr=Eo.getUniforms(),uo=ur.uniforms;if($t.useProgram(Eo.program)&&(Ys=!0,Jo=!0,Ia=!0),xt.id!==re&&(re=xt.id,Jo=!0),Ys||$!==xe){$t.buffers.depth.getReversed()?(ht.copy(xe.projectionMatrix),rhe(ht),ihe(ht),Zr.setValue(et,"projectionMatrix",ht)):Zr.setValue(et,"projectionMatrix",xe.projectionMatrix),Zr.setValue(et,"viewMatrix",xe.matrixWorldInverse);const Vi=Zr.map.cameraPosition;Vi!==void 0&&Vi.setValue(et,bt.setFromMatrixPosition(xe.matrixWorld)),fn.logarithmicDepthBuffer&&Zr.setValue(et,"logDepthBufFC",2/(Math.log(xe.far+1)/Math.LN2)),(xt.isMeshPhongMaterial||xt.isMeshToonMaterial||xt.isMeshLambertMaterial||xt.isMeshBasicMaterial||xt.isMeshStandardMaterial||xt.isShaderMaterial)&&Zr.setValue(et,"isOrthographic",xe.isOrthographicCamera===!0),$!==xe&&($=xe,Jo=!0,Ia=!0)}if(wt.isSkinnedMesh){Zr.setOptional(et,wt,"bindMatrix"),Zr.setOptional(et,wt,"bindMatrixInverse");const ho=wt.skeleton;ho&&(ho.boneTexture===null&&ho.computeBoneTexture(),Zr.setValue(et,"boneTexture",ho.boneTexture,Ue))}wt.isBatchedMesh&&(Zr.setOptional(et,wt,"batchingTexture"),Zr.setValue(et,"batchingTexture",wt._matricesTexture,Ue),Zr.setOptional(et,wt,"batchingIdTexture"),Zr.setValue(et,"batchingIdTexture",wt._indirectTexture,Ue),Zr.setOptional(et,wt,"batchingColorTexture"),wt._colorsTexture!==null&&Zr.setValue(et,"batchingColorTexture",wt._colorsTexture,Ue));const Xi=kt.morphAttributes;if((Xi.position!==void 0||Xi.normal!==void 0||Xi.color!==void 0)&&ue.update(wt,kt,Eo),(Jo||ur.receiveShadow!==wt.receiveShadow)&&(ur.receiveShadow=wt.receiveShadow,Zr.setValue(et,"receiveShadow",wt.receiveShadow)),xt.isMeshGouraudMaterial&&xt.envMap!==null&&(uo.envMap.value=Tn,uo.flipEnvMap.value=Tn.isCubeTexture&&Tn.isRenderTargetTexture===!1?-1:1),xt.isMeshStandardMaterial&&xt.envMap===null&&vt.environment!==null&&(uo.envMapIntensity.value=vt.environmentIntensity),Jo&&(Zr.setValue(et,"toneMappingExposure",W.toneMappingExposure),ur.needsLights&&qt(uo,Ia),hn&&xt.fog===!0&&Gt.refreshFogUniforms(uo,hn),Gt.refreshMaterialUniforms(uo,xt,Ie,Te,L.state.transmissionRenderTarget[xe.id]),u1.upload(et,or(ur),uo,Ue)),xt.isShaderMaterial&&xt.uniformsNeedUpdate===!0&&(u1.upload(et,or(ur),uo,Ue),xt.uniformsNeedUpdate=!1),xt.isSpriteMaterial&&Zr.setValue(et,"center",wt.center),Zr.setValue(et,"modelViewMatrix",wt.modelViewMatrix),Zr.setValue(et,"normalMatrix",wt.normalMatrix),Zr.setValue(et,"modelMatrix",wt.matrixWorld),xt.isShaderMaterial||xt.isRawShaderMaterial){const ho=xt.uniformsGroups;for(let Vi=0,Nr=ho.length;Vi<Nr;Vi++){const io=ho[Vi];ye.update(io,Eo),ye.bind(io,Eo)}}return Eo}function qt(xe,vt){xe.ambientLightColor.needsUpdate=vt,xe.lightProbe.needsUpdate=vt,xe.directionalLights.needsUpdate=vt,xe.directionalLightShadows.needsUpdate=vt,xe.pointLights.needsUpdate=vt,xe.pointLightShadows.needsUpdate=vt,xe.spotLights.needsUpdate=vt,xe.spotLightShadows.needsUpdate=vt,xe.rectAreaLights.needsUpdate=vt,xe.hemisphereLights.needsUpdate=vt}function cn(xe){return xe.isMeshLambertMaterial||xe.isMeshToonMaterial||xe.isMeshPhongMaterial||xe.isMeshStandardMaterial||xe.isShadowMaterial||xe.isShaderMaterial&&xe.lights===!0}this.getActiveCubeFace=function(){return q},this.getActiveMipmapLevel=function(){return te},this.getRenderTarget=function(){return se},this.setRenderTargetTextures=function(xe,vt,kt){const xt=vn.get(xe);xt.__autoAllocateDepthBuffer=xe.resolveDepthBuffer===!1,xt.__autoAllocateDepthBuffer===!1&&(xt.__useRenderToTexture=!1),vn.get(xe.texture).__webglTexture=vt,vn.get(xe.depthTexture).__webglTexture=xt.__autoAllocateDepthBuffer?void 0:kt,xt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(xe,vt){const kt=vn.get(xe);kt.__webglFramebuffer=vt,kt.__useDefaultFramebuffer=vt===void 0};const Rn=et.createFramebuffer();this.setRenderTarget=function(xe,vt=0,kt=0){se=xe,q=vt,te=kt;let xt=!0,wt=null,hn=!1,Pn=!1;if(xe){const Tn=vn.get(xe);if(Tn.__useDefaultFramebuffer!==void 0)$t.bindFramebuffer(et.FRAMEBUFFER,null),xt=!1;else if(Tn.__webglFramebuffer===void 0)Ue.setupRenderTarget(xe);else if(Tn.__hasExternalTextures)Ue.rebindTextures(xe,vn.get(xe.texture).__webglTexture,vn.get(xe.depthTexture).__webglTexture);else if(xe.depthBuffer){const An=xe.depthTexture;if(Tn.__boundDepthTexture!==An){if(An!==null&&vn.has(An)&&(xe.width!==An.image.width||xe.height!==An.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Ue.setupDepthRenderbuffer(xe)}}const Qt=xe.texture;(Qt.isData3DTexture||Qt.isDataArrayTexture||Qt.isCompressedArrayTexture)&&(Pn=!0);const Zn=vn.get(xe).__webglFramebuffer;xe.isWebGLCubeRenderTarget?(Array.isArray(Zn[vt])?wt=Zn[vt][kt]:wt=Zn[vt],hn=!0):xe.samples>0&&Ue.useMultisampledRTT(xe)===!1?wt=vn.get(xe).__webglMultisampledFramebuffer:Array.isArray(Zn)?wt=Zn[kt]:wt=Zn,ce.copy(xe.viewport),Ce.copy(xe.scissor),Se=xe.scissorTest}else ce.copy(Ee).multiplyScalar(Ie).floor(),Ce.copy(Qe).multiplyScalar(Ie).floor(),Se=jt;if(kt!==0&&(wt=Rn),$t.bindFramebuffer(et.FRAMEBUFFER,wt)&&xt&&$t.drawBuffers(xe,wt),$t.viewport(ce),$t.scissor(Ce),$t.setScissorTest(Se),hn){const Tn=vn.get(xe.texture);et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_CUBE_MAP_POSITIVE_X+vt,Tn.__webglTexture,kt)}else if(Pn){const Tn=vn.get(xe.texture),Qt=vt;et.framebufferTextureLayer(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,Tn.__webglTexture,kt,Qt)}else if(xe!==null&&kt!==0){const Tn=vn.get(xe.texture);et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,Tn.__webglTexture,kt)}re=-1},this.readRenderTargetPixels=function(xe,vt,kt,xt,wt,hn,Pn){if(!(xe&&xe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let mn=vn.get(xe).__webglFramebuffer;if(xe.isWebGLCubeRenderTarget&&Pn!==void 0&&(mn=mn[Pn]),mn){$t.bindFramebuffer(et.FRAMEBUFFER,mn);try{const Tn=xe.texture,Qt=Tn.format,Zn=Tn.type;if(!fn.textureFormatReadable(Qt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!fn.textureTypeReadable(Zn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}vt>=0&&vt<=xe.width-xt&&kt>=0&&kt<=xe.height-wt&&et.readPixels(vt,kt,xt,wt,Oe.convert(Qt),Oe.convert(Zn),hn)}finally{const Tn=se!==null?vn.get(se).__webglFramebuffer:null;$t.bindFramebuffer(et.FRAMEBUFFER,Tn)}}},this.readRenderTargetPixelsAsync=async function(xe,vt,kt,xt,wt,hn,Pn){if(!(xe&&xe.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let mn=vn.get(xe).__webglFramebuffer;if(xe.isWebGLCubeRenderTarget&&Pn!==void 0&&(mn=mn[Pn]),mn)if(vt>=0&&vt<=xe.width-xt&&kt>=0&&kt<=xe.height-wt){$t.bindFramebuffer(et.FRAMEBUFFER,mn);const Tn=xe.texture,Qt=Tn.format,Zn=Tn.type;if(!fn.textureFormatReadable(Qt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!fn.textureTypeReadable(Zn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const An=et.createBuffer();et.bindBuffer(et.PIXEL_PACK_BUFFER,An),et.bufferData(et.PIXEL_PACK_BUFFER,hn.byteLength,et.STREAM_READ),et.readPixels(vt,kt,xt,wt,Oe.convert(Qt),Oe.convert(Zn),0);const Wn=se!==null?vn.get(se).__webglFramebuffer:null;$t.bindFramebuffer(et.FRAMEBUFFER,Wn);const tr=et.fenceSync(et.SYNC_GPU_COMMANDS_COMPLETE,0);return et.flush(),await nhe(et,tr,4),et.bindBuffer(et.PIXEL_PACK_BUFFER,An),et.getBufferSubData(et.PIXEL_PACK_BUFFER,0,hn),et.deleteBuffer(An),et.deleteSync(tr),hn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(xe,vt=null,kt=0){const xt=Math.pow(2,-kt),wt=Math.floor(xe.image.width*xt),hn=Math.floor(xe.image.height*xt),Pn=vt!==null?vt.x:0,mn=vt!==null?vt.y:0;Ue.setTexture2D(xe,0),et.copyTexSubImage2D(et.TEXTURE_2D,kt,0,0,Pn,mn,wt,hn),$t.unbindTexture()};const Ir=et.createFramebuffer(),_r=et.createFramebuffer();this.copyTextureToTexture=function(xe,vt,kt=null,xt=null,wt=0,hn=null){hn===null&&(wt!==0?(c1("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),hn=wt,wt=0):hn=0);let Pn,mn,Tn,Qt,Zn,An,Wn,tr,Or;const Fr=xe.isCompressedTexture?xe.mipmaps[hn]:xe.image;if(kt!==null)Pn=kt.max.x-kt.min.x,mn=kt.max.y-kt.min.y,Tn=kt.isBox3?kt.max.z-kt.min.z:1,Qt=kt.min.x,Zn=kt.min.y,An=kt.isBox3?kt.min.z:0;else{const Xi=Math.pow(2,-wt);Pn=Math.floor(Fr.width*Xi),mn=Math.floor(Fr.height*Xi),xe.isDataArrayTexture?Tn=Fr.depth:xe.isData3DTexture?Tn=Math.floor(Fr.depth*Xi):Tn=1,Qt=0,Zn=0,An=0}xt!==null?(Wn=xt.x,tr=xt.y,Or=xt.z):(Wn=0,tr=0,Or=0);const wr=Oe.convert(vt.format),ur=Oe.convert(vt.type);let ui;vt.isData3DTexture?(Ue.setTexture3D(vt,0),ui=et.TEXTURE_3D):vt.isDataArrayTexture||vt.isCompressedArrayTexture?(Ue.setTexture2DArray(vt,0),ui=et.TEXTURE_2D_ARRAY):(Ue.setTexture2D(vt,0),ui=et.TEXTURE_2D),et.pixelStorei(et.UNPACK_FLIP_Y_WEBGL,vt.flipY),et.pixelStorei(et.UNPACK_PREMULTIPLY_ALPHA_WEBGL,vt.premultiplyAlpha),et.pixelStorei(et.UNPACK_ALIGNMENT,vt.unpackAlignment);const Lr=et.getParameter(et.UNPACK_ROW_LENGTH),Eo=et.getParameter(et.UNPACK_IMAGE_HEIGHT),Ys=et.getParameter(et.UNPACK_SKIP_PIXELS),Jo=et.getParameter(et.UNPACK_SKIP_ROWS),Ia=et.getParameter(et.UNPACK_SKIP_IMAGES);et.pixelStorei(et.UNPACK_ROW_LENGTH,Fr.width),et.pixelStorei(et.UNPACK_IMAGE_HEIGHT,Fr.height),et.pixelStorei(et.UNPACK_SKIP_PIXELS,Qt),et.pixelStorei(et.UNPACK_SKIP_ROWS,Zn),et.pixelStorei(et.UNPACK_SKIP_IMAGES,An);const Zr=xe.isDataArrayTexture||xe.isData3DTexture,uo=vt.isDataArrayTexture||vt.isData3DTexture;if(xe.isDepthTexture){const Xi=vn.get(xe),ho=vn.get(vt),Vi=vn.get(Xi.__renderTarget),Nr=vn.get(ho.__renderTarget);$t.bindFramebuffer(et.READ_FRAMEBUFFER,Vi.__webglFramebuffer),$t.bindFramebuffer(et.DRAW_FRAMEBUFFER,Nr.__webglFramebuffer);for(let io=0;io<Tn;io++)Zr&&(et.framebufferTextureLayer(et.READ_FRAMEBUFFER,et.COLOR_ATTACHMENT0,vn.get(xe).__webglTexture,wt,An+io),et.framebufferTextureLayer(et.DRAW_FRAMEBUFFER,et.COLOR_ATTACHMENT0,vn.get(vt).__webglTexture,hn,Or+io)),et.blitFramebuffer(Qt,Zn,Pn,mn,Wn,tr,Pn,mn,et.DEPTH_BUFFER_BIT,et.NEAREST);$t.bindFramebuffer(et.READ_FRAMEBUFFER,null),$t.bindFramebuffer(et.DRAW_FRAMEBUFFER,null)}else if(wt!==0||xe.isRenderTargetTexture||vn.has(xe)){const Xi=vn.get(xe),ho=vn.get(vt);$t.bindFramebuffer(et.READ_FRAMEBUFFER,Ir),$t.bindFramebuffer(et.DRAW_FRAMEBUFFER,_r);for(let Vi=0;Vi<Tn;Vi++)Zr?et.framebufferTextureLayer(et.READ_FRAMEBUFFER,et.COLOR_ATTACHMENT0,Xi.__webglTexture,wt,An+Vi):et.framebufferTexture2D(et.READ_FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,Xi.__webglTexture,wt),uo?et.framebufferTextureLayer(et.DRAW_FRAMEBUFFER,et.COLOR_ATTACHMENT0,ho.__webglTexture,hn,Or+Vi):et.framebufferTexture2D(et.DRAW_FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,ho.__webglTexture,hn),wt!==0?et.blitFramebuffer(Qt,Zn,Pn,mn,Wn,tr,Pn,mn,et.COLOR_BUFFER_BIT,et.NEAREST):uo?et.copyTexSubImage3D(ui,hn,Wn,tr,Or+Vi,Qt,Zn,Pn,mn):et.copyTexSubImage2D(ui,hn,Wn,tr,Qt,Zn,Pn,mn);$t.bindFramebuffer(et.READ_FRAMEBUFFER,null),$t.bindFramebuffer(et.DRAW_FRAMEBUFFER,null)}else uo?xe.isDataTexture||xe.isData3DTexture?et.texSubImage3D(ui,hn,Wn,tr,Or,Pn,mn,Tn,wr,ur,Fr.data):vt.isCompressedArrayTexture?et.compressedTexSubImage3D(ui,hn,Wn,tr,Or,Pn,mn,Tn,wr,Fr.data):et.texSubImage3D(ui,hn,Wn,tr,Or,Pn,mn,Tn,wr,ur,Fr):xe.isDataTexture?et.texSubImage2D(et.TEXTURE_2D,hn,Wn,tr,Pn,mn,wr,ur,Fr.data):xe.isCompressedTexture?et.compressedTexSubImage2D(et.TEXTURE_2D,hn,Wn,tr,Fr.width,Fr.height,wr,Fr.data):et.texSubImage2D(et.TEXTURE_2D,hn,Wn,tr,Pn,mn,wr,ur,Fr);et.pixelStorei(et.UNPACK_ROW_LENGTH,Lr),et.pixelStorei(et.UNPACK_IMAGE_HEIGHT,Eo),et.pixelStorei(et.UNPACK_SKIP_PIXELS,Ys),et.pixelStorei(et.UNPACK_SKIP_ROWS,Jo),et.pixelStorei(et.UNPACK_SKIP_IMAGES,Ia),hn===0&&vt.generateMipmaps&&et.generateMipmap(ui),$t.unbindTexture()},this.copyTextureToTexture3D=function(xe,vt,kt=null,xt=null,wt=0){return c1('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(xe,vt,kt,xt,wt)},this.initRenderTarget=function(xe){vn.get(xe).__webglFramebuffer===void 0&&Ue.setupRenderTarget(xe)},this.initTexture=function(xe){xe.isCubeTexture?Ue.setTextureCube(xe,0):xe.isData3DTexture?Ue.setTexture3D(xe,0):xe.isDataArrayTexture||xe.isCompressedArrayTexture?Ue.setTexture2DArray(xe,0):Ue.setTexture2D(xe,0),$t.unbindTexture()},this.resetState=function(){q=0,te=0,se=null,$t.reset(),Ye.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ud}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=li._getDrawingBufferColorSpace(e),n.unpackColorSpace=li._getUnpackColorSpace()}}/*!
 * Photo Sphere Viewer 5.13.4
 * @copyright 2014-2015 Jérémy Heleine
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var Ege=Object.defineProperty,qA=(t,e)=>{for(var n in e)Ege(t,n,{get:e[n],enumerable:!0})},oy={};qA(oy,{ACTIONS:()=>WB,ANIMATION_MIN_DURATION:()=>FT,CAPTURE_EVENTS_CLASS:()=>hx,CTRLZOOM_TIMEOUT:()=>GB,DBLCLICK_DELAY:()=>VB,EASINGS:()=>h1,ICONS:()=>Mu,IDS:()=>Ws,KEY_CODES:()=>As,LONGTOUCH_DELAY:()=>jB,MOVE_THRESHOLD:()=>$B,SPHERE_RADIUS:()=>Wm,TWOFINGERSOVERLAY_DELAY:()=>HB,VIEWER_DATA:()=>fp});var Tge=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>
`,Pge='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',Age=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>
`,Ige=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,Rge=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,Lge=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>
`,Dge=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kunák from the Noun Project--></svg>
`,kge=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,zge=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,FT=500,$B=4,VB=300,jB=500,HB=100,GB=2e3,Wm=10,fp="photoSphereViewer",hx="psv--capture-event",WB=(t=>(t.ROTATE_UP="ROTATE_UP",t.ROTATE_DOWN="ROTATE_DOWN",t.ROTATE_RIGHT="ROTATE_RIGHT",t.ROTATE_LEFT="ROTATE_LEFT",t.ZOOM_IN="ZOOM_IN",t.ZOOM_OUT="ZOOM_OUT",t))(WB||{}),Ws={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},As={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},Mu={arrow:Tge,close:Pge,download:Age,fullscreenIn:Ige,fullscreenOut:Rge,info:Lge,menu:Dge,zoomIn:kge,zoomOut:zge},h1={linear:t=>t,inQuad:t=>t*t,outQuad:t=>t*(2-t),inOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,inCubic:t=>t*t*t,outCubic:t=>--t*t*t+1,inOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,inQuart:t=>t*t*t*t,outQuart:t=>1- --t*t*t*t,inOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,inQuint:t=>t*t*t*t*t,outQuint:t=>1+--t*t*t*t*t,inOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,inSine:t=>1-Math.cos(t*(Math.PI/2)),outSine:t=>Math.sin(t*(Math.PI/2)),inOutSine:t=>.5-.5*Math.cos(Math.PI*t),inExpo:t=>Math.pow(2,10*(t-1)),outExpo:t=>1-Math.pow(2,-10*t),inOutExpo:t=>(t=t*2-1)<0?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t),inCirc:t=>1-Math.sqrt(1-t*t),outCirc:t=>Math.sqrt(1-(t-1)*(t-1)),inOutCirc:t=>(t*=2)<1?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)},Qn={};qA(Qn,{Animation:()=>K1,Dynamic:()=>L0,MultiDynamic:()=>m6,PressHandler:()=>iS,Slider:()=>v6,SliderDirection:()=>g6,addClasses:()=>XA,angle:()=>XB,applyEulerInverse:()=>VT,checkClosedShadowDom:()=>f6,checkStylesheet:()=>d6,checkVersion:()=>QA,cleanCssPosition:()=>u6,clone:()=>tS,createTexture:()=>$T,cssPositionIsOrdered:()=>JA,dasherize:()=>Uge,deepEqual:()=>a6,deepmerge:()=>o6,distance:()=>qB,exitFullscreen:()=>r6,firstNonNull:()=>jf,getAbortError:()=>BT,getAngle:()=>YB,getClosest:()=>JB,getConfigParser:()=>rS,getElement:()=>KB,getEventTarget:()=>q1,getMatchingTarget:()=>QB,getPosition:()=>e6,getShortestArc:()=>ZB,getStyleProperty:()=>wh,getTouchData:()=>NT,getXMPValue:()=>Ll,greatArcDistance:()=>Fge,hasParent:()=>Bge,invertResolvableBoolean:()=>nS,isAbortError:()=>c6,isEmpty:()=>s6,isExtendedPosition:()=>KA,isFullscreenEnabled:()=>t6,isNil:()=>Is,isPlainObject:()=>ZA,logWarn:()=>qs,mergePanoData:()=>p6,parseAngle:()=>gh,parsePoint:()=>$ge,parseSpeed:()=>h6,removeClasses:()=>Nge,requestFullscreen:()=>n6,resolveBoolean:()=>YA,speedToDuration:()=>UT,sum:()=>Oge,throttle:()=>i6,toggleClass:()=>eS,wrap:()=>X0});function X0(t,e){let n=t%e;return n<0&&(n+=e),n}function Oge(t){return t.reduce((e,n)=>e+n,0)}function qB(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function XB(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function ZB(t,e){return[0,Math.PI*2,-Math.PI*2].reduce((r,o)=>{const l=e-t+o;return Math.abs(l)<Math.abs(r)?l:r},1/0)}function YB(t,e){return Math.acos(Math.cos(t.pitch)*Math.cos(e.pitch)*Math.cos(t.yaw-e.yaw)+Math.sin(t.pitch)*Math.sin(e.pitch))}function Fge([t,e],[n,r]){t-n>Math.PI?t-=2*Math.PI:t-n<-Math.PI&&(t+=2*Math.PI);const o=(n-t)*Math.cos((e+r)/2),l=r-e;return Math.sqrt(o*o+l*l)}function KB(t){return typeof t=="string"?t.match(/^[a-z]/i)?document.getElementById(t):document.querySelector(t):t}function eS(t,e,n){n===void 0?t.classList.toggle(e):n?t.classList.add(e):n||t.classList.remove(e)}function XA(t,e){t.classList.add(...e.split(" ").filter(n=>!!n))}function Nge(t,e){t.classList.remove(...e.split(" ").filter(n=>!!n))}function Bge(t,e){let n=t;do{if(n===e)return!0;n=n.parentElement}while(n);return!1}function JB(t,e){if(!t?.matches)return null;let n=t;do{if(n.matches(e))return n;n=n.parentElement}while(n);return null}function q1(t){return t?.composedPath()[0]||null}function QB(t,e){return t?t.composedPath().find(n=>!(n instanceof HTMLElement)&&!(n instanceof SVGElement)?!1:n.matches(e)):null}function e6(t){let e=0,n=0,r=t;for(;r;)e+=r.offsetLeft-r.scrollLeft+r.clientLeft,n+=r.offsetTop-r.scrollTop+r.clientTop,r=r.offsetParent;return e-=window.scrollX,n-=window.scrollY,{x:e,y:n}}function wh(t,e){return window.getComputedStyle(t).getPropertyValue(e)}function NT(t){if(t.touches.length<2)return null;const e={x:t.touches[0].clientX,y:t.touches[0].clientY},n={x:t.touches[1].clientX,y:t.touches[1].clientY};return{distance:qB(e,n),angle:XB(e,n),center:{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}}var X1;function t6(t,e=!1){return e?t===X1:document.fullscreenElement===t}function n6(t,e=!1){e?(X1=t,t.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):t.requestFullscreen()}function r6(t=!1){t?(X1.classList.remove("psv-fullscreen-emulation"),X1=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function Uge(t){return t.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(e,n)=>(n>0?"-":"")+e.toLowerCase())}function i6(t,e){let n=!1;return function(...r){n||(n=!0,setTimeout(()=>{t.apply(this,r),n=!1},e))}}function ZA(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function o6(t,e){const n=e;return function r(o,l){return Array.isArray(l)?(!o||!Array.isArray(o)?o=[]:o.length=0,l.forEach((c,s)=>{o[s]=r(null,c)})):typeof l=="object"?((!o||Array.isArray(o))&&(o={}),Object.keys(l).forEach(c=>{c!=="__proto__"&&(typeof l[c]!="object"||!l[c]||!ZA(l[c])?o[c]=l[c]:l[c]!==n&&(o[c]?r(o[c],l[c]):o[c]=r(null,l[c])))})):o=l,o}(t,e)}function tS(t){return o6(null,t)}function s6(t){return!t||Object.keys(t).length===0&&t.constructor===Object}function Is(t){return t==null}function jf(...t){for(const e of t)if(!Is(e))return e;return null}function a6(t,e){if(t===e)return!0;if(yO(t)&&yO(e)){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n of Object.keys(t))if(!a6(t[n],e[n]))return!1;return!0}else return!1}function yO(t){return typeof t=="object"&&t!==null}var jn=class l6 extends Error{constructor(e,n){super(n&&n instanceof Error?`${e}: ${n.message}`:e),this.name="PSVError",Error.captureStackTrace?.(this,l6)}};function YA(t,e){ZA(t)?(e(t.initial,!0),t.promise.then(n=>e(n,!1))):e(t,!0)}function nS(t){return{initial:!t.initial,promise:t.promise.then(e=>!e)}}function BT(){const t=new Error("Loading was aborted.");return t.name="AbortError",t}function c6(t){return t?.name==="AbortError"}function qs(t){console.warn(`PhotoSphereViewer: ${t}`)}function KA(t){return!t||Array.isArray(t)?!1:[["textureX","textureY"],["yaw","pitch"]].some(([e,n])=>t[e]!==void 0&&t[n]!==void 0)}function Ll(t,e,n=!0){let r=t.match("<GPano:"+e+">(.*)</GPano:"+e+">");if(r!==null){const o=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(o)?null:o}if(r=t.match("GPano:"+e+'="(.*?)"'),r!==null){const o=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(o)?null:o}return null}var _O={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Z1=["left","center","right"],Y1=["top","center","bottom"],xO=[...Z1,...Y1],wc="center";function $ge(t){if(!t)return{x:.5,y:.5};if(typeof t=="object")return t;let e=t.toLocaleLowerCase().split(" ").slice(0,2);e.length===1&&(_O[e[0]]?e=[e[0],wc]:e=[e[0],e[0]]);const n=e[1]!=="left"&&e[1]!=="right"&&e[0]!=="top"&&e[0]!=="bottom";e=e.map(o=>_O[o]||o),n||e.reverse();const r=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return r?{x:parseFloat(r[1])/100,y:parseFloat(r[2])/100}:{x:.5,y:.5}}function u6(t,{allowCenter:e,cssOrder:n}={allowCenter:!0,cssOrder:!0}){return t?(typeof t=="string"&&(t=t.split(" ")),t.length===1&&(t[0]===wc?t=[wc,wc]:Z1.indexOf(t[0])!==-1?t=[wc,t[0]]:Y1.indexOf(t[0])!==-1&&(t=[t[0],wc])),t.length!==2||xO.indexOf(t[0])===-1||xO.indexOf(t[1])===-1?(qs(`Unparsable position ${t}`),null):!e&&t[0]===wc&&t[1]===wc?(qs("Invalid position center center"),null):(n&&!JA(t)&&(t=[t[1],t[0]]),t[1]===wc&&Z1.indexOf(t[0])!==-1&&(t=[wc,t[0]]),t[0]===wc&&Y1.indexOf(t[1])!==-1&&(t=[t[1],wc]),t)):null}function JA(t){return Y1.indexOf(t[0])!==-1&&Z1.indexOf(t[1])!==-1}function h6(t){let e;if(typeof t=="string"){const n=t.toString().trim();let r=parseFloat(n.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const o=n.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(o.match(/(pm|per minute)$/)&&(r/=60),o){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=Gr.degToRad(r);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":e=r;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=r*Math.PI*2;break;default:throw new jn(`Unknown speed unit "${o}"`)}}else e=t;return e}function UT(t,e){if(typeof t!="number"){const n=h6(t);return e/Math.abs(n)*1e3}else return Math.abs(t)}function gh(t,e=!1,n=e){let r;if(typeof t=="string"){const o=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!o)throw new jn(`Unknown angle "${t}"`);const l=parseFloat(o[1]),c=o[2];if(c)switch(c){case"deg":case"degs":r=Gr.degToRad(l);break;case"rad":case"rads":r=l;break;default:throw new jn(`Unknown angle unit "${c}"`)}else r=l}else if(typeof t=="number"&&!isNaN(t))r=t;else throw new jn(`Unknown angle "${t}"`);return r=X0(e?r+Math.PI:r,Math.PI*2),e?Gr.clamp(r-Math.PI,-Math.PI/(n?2:1),Math.PI/(n?2:1)):r}function $T(t,e=!1){const n=new Xs(t);return n.needsUpdate=!0,n.minFilter=e?Zf:$l,n.generateMipmaps=e,n.anisotropy=e?2:1,n}var bO=new Sp;function VT(t,e){bO.setFromEuler(e).invert(),t.applyQuaternion(bO)}function rS(t,e){const n=function(r){const o=tS({...t,...r}),l={};for(let[c,s]of Object.entries(o)){if(e&&c in e)s=e[c](s,{rawConfig:o,defValue:t[c]});else if(!(c in t)){qs(`Unknown option ${c}`);continue}l[c]=s}return l};return n.defaults=t,n.parsers=e||{},n}function d6(t,e){wh(t,`--psv-${e}-loaded`)!=="true"&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${e}/index.css" is not loaded`)}function QA(t,e,n){e&&e!==n&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${t} is in version ${e} but @photo-sphere-viewer/core is in version ${n}`)}function f6(t){do{if(t instanceof ShadowRoot&&t.mode==="closed"){console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");return}t=t.parentNode}while(t)}function p6(t,e,n,r){const o={isEquirectangular:!0,fullWidth:jf(n?.fullWidth,r?.fullWidth),fullHeight:jf(n?.fullHeight,r?.fullHeight),croppedWidth:t,croppedHeight:e,croppedX:jf(n?.croppedX,r?.croppedX),croppedY:jf(n?.croppedY,r?.croppedY),poseHeading:jf(n?.poseHeading,r?.poseHeading,0),posePitch:jf(n?.posePitch,r?.posePitch,0),poseRoll:jf(n?.poseRoll,r?.poseRoll,0),initialHeading:r?.initialHeading,initialPitch:r?.initialPitch,initialFov:r?.initialFov};return!o.fullWidth&&!o.fullHeight&&(o.fullWidth=Math.max(t,e*2),o.fullHeight=Math.round(o.fullWidth/2)),o.fullWidth||(o.fullWidth=o.fullHeight*2),o.fullHeight||(o.fullHeight=Math.round(o.fullWidth/2)),o.croppedX===null&&(o.croppedX=Math.round((o.fullWidth-t)/2)),o.croppedY===null&&(o.croppedY=Math.round((o.fullHeight-e)/2)),Math.abs(o.fullWidth-o.fullHeight*2)>1&&(qs("Invalid panoData, fullWidth should be twice fullHeight"),o.fullHeight=Math.round(o.fullWidth/2)),o.croppedX+o.croppedWidth>o.fullWidth&&(qs("Invalid panoData, croppedX + croppedWidth > fullWidth"),o.croppedX=o.fullWidth-o.croppedWidth),o.croppedY+o.croppedHeight>o.fullHeight&&(qs("Invalid panoData, croppedY + croppedHeight > fullHeight"),o.croppedY=o.fullHeight-o.croppedHeight),o.croppedX<0&&(qs("Invalid panoData, croppedX < 0"),o.croppedX=0),o.croppedY<0&&(qs("Invalid panoData, croppedY < 0"),o.croppedY=0),o}var K1=class{constructor(t){this.easing=h1.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=t,t?(t.easing&&(this.easing=typeof t.easing=="function"?t.easing:h1[t.easing]||h1.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(e=>this.__run(e))},t.delay||0)):this.resolved=!0}__run(t){if(this.cancelled)return;this.start||(this.start=t);const e=(t-this.start)/this.options.duration,n={};if(e<1){for(const[r,o]of Object.entries(this.options.properties))if(o){const l=o.start+(o.end-o.start)*this.easing(e);n[r]=l}this.options.onTick(n,e),this.animationFrame=window.requestAnimationFrame(r=>this.__run(r))}else{for(const[r,o]of Object.entries(this.options.properties))o&&(n[r]=o.end);this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(t){t?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(e=>e(t)),this.callbacks.length=0}then(t){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(t):new Promise(e=>{this.callbacks.push(e)}).then(t)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},L0=class{constructor(t,e){if(this.fn=t,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=e.min,this.max=e.max,this.wrap=e.wrap,this.current=e.defaultValue,this.wrap&&this.min!==0)throw new jn("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(t){this.__current=t}setSpeed(t){this.speed=t}goto(t,e=1){this.mode=2,this.target=this.wrap?X0(t,this.max):Gr.clamp(t,this.min,this.max),this.speedMult=e}step(t,e=1){e===0?this.setValue(this.current+t):(this.mode!==2&&(this.target=this.current),this.goto(this.target+t,e))}roll(t=!1,e=1){this.mode=1,this.target=t?-1/0:1/0,this.speedMult=e}stop(){this.mode=0}setValue(t){return this.target=this.wrap?X0(t,this.max):Gr.clamp(t,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current?(this.current=this.target,this.fn&&this.fn(this.current),!0):!1}update(t){if(this.mode===2){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const r=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=r&&(this.mode=0)}let e=this.mode===0?0:this.speed*this.speedMult;this.target<this.current&&(e=-e),this.currentSpeed<e?this.currentSpeed=Math.min(e,this.currentSpeed+t/1e3*this.speed*this.speedMult*2):this.currentSpeed>e&&(this.currentSpeed=Math.max(e,this.currentSpeed-t/1e3*this.speed*this.speedMult*2));let n=null;return this.current>this.target&&this.currentSpeed?n=Math.max(this.target,this.current+this.currentSpeed*t/1e3):this.current<this.target&&this.currentSpeed&&(n=Math.min(this.target,this.current+this.currentSpeed*t/1e3)),n!==null&&(n=this.wrap?X0(n,this.max):Gr.clamp(n,this.min,this.max),n!==this.current)?(this.current=n,this.fn&&this.fn(this.current),!0):!1}},m6=class{constructor(t,e){this.fn=t,this.dynamics=e,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((t,[e,n])=>(t[e]=n.current,t),{})}setSpeed(t){for(const e of Object.values(this.dynamics))e.setSpeed(t)}goto(t,e=1){for(const[n,r]of Object.entries(t))this.dynamics[n].goto(r,e)}step(t,e=1){if(e===0)this.setValue(Object.keys(t).reduce((n,r)=>(n[r]=t[r]+this.dynamics[r].current,n),{}));else for(const[n,r]of Object.entries(t))this.dynamics[n].step(r,e)}roll(t,e=1){for(const[n,r]of Object.entries(t))this.dynamics[n].roll(r,e)}stop(){for(const t of Object.values(this.dynamics))t.stop()}setValue(t){let e=!1;for(const[n,r]of Object.entries(t))e=this.dynamics[n].setValue(r)||e;return e&&this.fn&&this.fn(this.current),e}update(t){let e=!1;for(const n of Object.values(this.dynamics))e=n.update(t)||e;return e&&this.fn&&this.fn(this.current),e}},iS=class{constructor(t=200){this.delay=t,this.time=0,this.delay=t}get pending(){return this.time!==0}down(t){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime(),this.data=t}up(t){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{t(this.data),this.timeout=void 0,this.time=0,this.data=void 0},this.delay):(t(this.data),this.time=0,this.data=void 0)}},g6=(t=>(t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t))(g6||{}),v6=class{constructor(t,e,n){this.container=t,this.direction=e,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return this.direction==="VERTICAL"}get isHorizontal(){return this.direction==="HORIZONTAL"}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(t){switch(t.type){case"click":t.stopPropagation();break;case"mousedown":this.__onMouseDown(t);break;case"mouseenter":this.__onMouseEnter(t);break;case"mouseleave":this.__onMouseLeave(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break}}__onMouseDown(t){this.mousedown=!0,this.__update(t.clientX,t.clientY,!0)}__onMouseEnter(t){this.mouseover=!0,this.__update(t.clientX,t.clientY,!0)}__onTouchStart(t){this.mouseover=!0,this.mousedown=!0;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}__onMouseMove(t){(this.mousedown||this.mouseover)&&(t.stopPropagation(),this.__update(t.clientX,t.clientY,!0))}__onTouchMove(t){if(this.mousedown||this.mouseover){t.stopPropagation();const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}}__onMouseUp(t){this.mousedown&&(this.mousedown=!1,this.__update(t.clientX,t.clientY,!1))}__onMouseLeave(t){this.mouseover&&(this.mouseover=!1,this.__update(t.clientX,t.clientY,!0))}__onTouchEnd(t){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!1)}}__update(t,e,n){const r=this.container.getBoundingClientRect();let o;this.isVertical?o=Gr.clamp((r.bottom-e)/r.height,0,1):o=Gr.clamp((t-r.left)/r.width,0,1),this.listener({value:o,click:!n,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:t,clientY:e}})}},nr={};qA(nr,{BeforeAnimateEvent:()=>eI,BeforeRenderEvent:()=>Z0,BeforeRotateEvent:()=>C6,ClickEvent:()=>P6,ConfigChangedEvent:()=>nl,DoubleClickEvent:()=>D6,FullscreenEvent:()=>Y0,HideNotificationEvent:()=>K0,HideOverlayEvent:()=>U6,HidePanelEvent:()=>ep,HideTooltipEvent:()=>G6,KeypressEvent:()=>tp,LoadProgressEvent:()=>Y6,ObjectEnterEvent:()=>zU,ObjectEvent:()=>oS,ObjectHoverEvent:()=>UU,ObjectLeaveEvent:()=>jT,PanoramaErrorEvent:()=>iU,PanoramaLoadEvent:()=>Q6,PanoramaLoadedEvent:()=>$v,PositionUpdatedEvent:()=>J0,ReadyEvent:()=>e_,RenderEvent:()=>gU,RollUpdatedEvent:()=>Q0,ShowNotificationEvent:()=>t_,ShowOverlayEvent:()=>bU,ShowPanelEvent:()=>np,ShowTooltipEvent:()=>EU,SizeUpdatedEvent:()=>n_,StopAllEvent:()=>r_,TransitionDoneEvent:()=>aU,ViewerEvent:()=>wi,ZoomUpdatedEvent:()=>Vd});var dx=class extends Event{constructor(t,e=!1){super(t,{cancelable:e})}},y6=class extends EventTarget{dispatchEvent(t){return super.dispatchEvent(t)}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e,n){super.removeEventListener(t,e,n)}},wi=class extends dx{},_6=class x6 extends wi{constructor(e,n){super(x6.type,!0),this.position=e,this.zoomLevel=n}};_6.type="before-animate";var eI=_6,b6=class w6 extends wi{constructor(e,n){super(w6.type),this.timestamp=e,this.elapsed=n}};b6.type="before-render";var Z0=b6,S6=class M6 extends wi{constructor(e){super(M6.type,!0),this.position=e}};S6.type="before-rotate";var C6=S6,E6=class T6 extends wi{constructor(e){super(T6.type),this.data=e}};E6.type="click";var P6=E6,A6=class I6 extends wi{constructor(e){super(I6.type),this.options=e}containsOptions(...e){return e.some(n=>this.options.includes(n))}};A6.type="config-changed";var nl=A6,R6=class L6 extends wi{constructor(e){super(L6.type),this.data=e}};R6.type="dblclick";var D6=R6,k6=class z6 extends wi{constructor(e){super(z6.type),this.fullscreenEnabled=e}};k6.type="fullscreen";var Y0=k6,O6=class F6 extends wi{constructor(e){super(F6.type),this.notificationId=e}};O6.type="hide-notification";var K0=O6,N6=class B6 extends wi{constructor(e){super(B6.type),this.overlayId=e}};N6.type="hide-overlay";var U6=N6,$6=class V6 extends wi{constructor(e){super(V6.type),this.panelId=e}};$6.type="hide-panel";var ep=$6,j6=class H6 extends wi{constructor(e){super(H6.type),this.tooltipData=e}};j6.type="hide-tooltip";var G6=j6,W6=class q6 extends wi{constructor(e,n){super(q6.type,!0),this.key=e,this.originalEvent=n}};W6.type="key-press";var tp=W6,X6=class Z6 extends wi{constructor(e){super(Z6.type),this.progress=e}};X6.type="load-progress";var Y6=X6,K6=class J6 extends wi{constructor(e){super(J6.type),this.panorama=e}};K6.type="panorama-load";var Q6=K6,eU=class tU extends wi{constructor(e){super(tU.type),this.data=e}};eU.type="panorama-loaded";var $v=eU,nU=class rU extends wi{constructor(e,n){super(rU.type),this.panorama=e,this.error=n}};nU.type="panorama-error";var iU=nU,oU=class sU extends wi{constructor(e){super(sU.type),this.completed=e}};oU.type="transition-done";var aU=oU,lU=class cU extends wi{constructor(e){super(cU.type),this.position=e}};lU.type="position-updated";var J0=lU,uU=class hU extends wi{constructor(e){super(hU.type),this.roll=e}};uU.type="roll-updated";var Q0=uU,dU=class fU extends wi{constructor(){super(fU.type)}};dU.type="ready";var e_=dU,pU=class mU extends wi{constructor(){super(mU.type)}};pU.type="render";var gU=pU,vU=class yU extends wi{constructor(e){super(yU.type),this.notificationId=e}};vU.type="show-notification";var t_=vU,_U=class xU extends wi{constructor(e){super(xU.type),this.overlayId=e}};_U.type="show-overlay";var bU=_U,wU=class SU extends wi{constructor(e){super(SU.type),this.panelId=e}};wU.type="show-panel";var np=wU,MU=class CU extends wi{constructor(e,n){super(CU.type),this.tooltip=e,this.tooltipData=n}};MU.type="show-tooltip";var EU=MU,TU=class PU extends wi{constructor(e){super(PU.type),this.size=e}};TU.type="size-updated";var n_=TU,AU=class IU extends wi{constructor(){super(IU.type)}};AU.type="stop-all";var r_=AU,RU=class LU extends wi{constructor(e){super(LU.type),this.zoomLevel=e}};RU.type="zoom-updated";var Vd=RU,oS=class extends wi{constructor(t,e,n,r,o){super(t),this.originalEvent=e,this.object=n,this.viewerPoint=r,this.userDataKey=o}},DU=class kU extends oS{constructor(e,n,r,o){super(kU.type,e,n,r,o)}};DU.type="enter-object";var zU=DU,OU=class FU extends oS{constructor(e,n,r,o){super(FU.type,e,n,r,o)}};OU.type="leave-object";var jT=OU,NU=class BU extends oS{constructor(e,n,r,o){super(BU.type,e,n,r,o)}};NU.type="hover-object";var UU=NU,sS=class{constructor(t){this.viewer=t}init(){}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}textureCoordsToSphericalCoords(t,e){throw new jn("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(t,e){throw new jn("Current adapter does not support texture coordinates.")}};sS.supportsDownload=!1;function wO(t){if(t){for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof sS)return QA(e.id,e.VERSION,"5.13.4"),e}return null}var y0=`${fp}_touchSupport`,Ea={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return this.__maxCanvasWidth===null&&(this.__maxCanvasWidth=Hge(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const t=Vge();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!t,this.maxTextureWidth=t?t.getParameter(t.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=jge(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!Ea.isWebGLSupported)throw new jn("WebGL 2 is not supported.");if(Ea.maxTextureWidth===0)throw new jn("Unable to detect system capabilities")}};function Vge(){try{return document.createElement("canvas").getContext("webgl2")}catch{return null}}function jge(){let t="ontouchstart"in window||navigator.maxTouchPoints>0;y0 in localStorage&&(t=localStorage[y0]==="true");const e=new Promise(n=>{const r=()=>{window.removeEventListener("mousedown",o),window.removeEventListener("touchstart",l),clearTimeout(s)},o=()=>{r(),localStorage[y0]=!1,n(!1)},l=()=>{r(),localStorage[y0]=!0,n(!0)},c=()=>{r(),localStorage[y0]=t,n(t)};window.addEventListener("mousedown",o,!1),window.addEventListener("touchstart",l,!1);const s=setTimeout(c,1e4)});return{initial:t,promise:e}}function Hge(t){let e=t,n=!1;const r=document.createElement("canvas"),o=r.getContext("2d");for(r.width=1,r.height=1;e>1024&&!n;){const l=document.createElement("canvas"),c=l.getContext("2d");l.width=e,l.height=e/2;try{c.fillStyle="white",c.fillRect(e-1,e/2-1,1,1),o.drawImage(l,e-1,e/2-1,1,1,0,0,1,1),o.getImageData(0,0,1,1).data[0]>0&&(n=!0)}catch{}l.width=0,l.height=0,n||(e/=2)}if(n)return e;throw new jn("Unable to detect system capabilities")}var Gge=rS({resolution:64,useXmpData:!0,blur:!1},{resolution:t=>{if(!t||!Gr.isPowerOfTwo(t))throw new jn("EquirectangularAdapter resolution must be power of two.");return t}}),aS=class $U extends sS{static withConfig(e){return[$U,e]}constructor(e,n){super(e),this.config=Gge(n),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(e,n){if(Is(e.textureX)||Is(e.textureY))throw new jn("Texture position is missing 'textureX' or 'textureY'");const r=(e.textureX+n.croppedX)/n.fullWidth*Math.PI*2,o=(e.textureY+n.croppedY)/n.fullHeight*Math.PI;return{yaw:r>=Math.PI?r-Math.PI:r+Math.PI,pitch:Math.PI/2-o}}sphericalCoordsToTextureCoords(e,n){const r=e.yaw/Math.PI/2*n.fullWidth,o=e.pitch/Math.PI*n.fullHeight;let l=Math.round(e.yaw<Math.PI?r+n.fullWidth/2:r-n.fullWidth/2)-n.croppedX,c=Math.round(n.fullHeight/2-o)-n.croppedY;return(l<0||l>n.croppedWidth||c<0||c>n.croppedHeight)&&(l=c=void 0),{textureX:l,textureY:c}}async loadTexture(e,n=!0,r,o=this.config.useXmpData){if(typeof e!="string"&&(typeof e!="object"||!e.path))return Promise.reject(new jn("Invalid panorama url, are you using the right adapter?"));let l;typeof e=="string"?l={path:e,data:r}:l={data:r,...e};const c=await this.viewer.textureLoader.loadFile(l.path,n?w=>this.viewer.textureLoader.dispatchProgress(w):null,l.path),s=o?await this.loadXMP(c):null,m=await this.viewer.textureLoader.blobToImage(c);typeof l.data=="function"&&(l.data=l.data(m,s));const y=p6(m.width,m.height,l.data,s),b=this.createEquirectangularTexture(m);return{panorama:e,texture:b,panoData:y,cacheKey:l.path}}async loadXMP(e){const n=await this.loadBlobAsString(e),r=n.indexOf("<x:xmpmeta");if(r===-1)return null;const o=n.indexOf("</x:xmpmeta>",r);if(o===-1)return null;const l=n.substring(r,o);return l.includes("GPano:")?{fullWidth:Ll(l,"FullPanoWidthPixels"),fullHeight:Ll(l,"FullPanoHeightPixels"),croppedWidth:Ll(l,"CroppedAreaImageWidthPixels"),croppedHeight:Ll(l,"CroppedAreaImageHeightPixels"),croppedX:Ll(l,"CroppedAreaLeftPixels"),croppedY:Ll(l,"CroppedAreaTopPixels"),poseHeading:Ll(l,"PoseHeadingDegrees",!1),posePitch:Ll(l,"PosePitchDegrees",!1),poseRoll:Ll(l,"PoseRollDegrees",!1),initialHeading:Ll(l,"InitialViewHeadingDegrees",!1),initialPitch:Ll(l,"InitialViewPitchDegrees",!1),initialFov:Ll(l,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(e){return new Promise((n,r)=>{const o=new FileReader;o.onload=()=>n(o.result),o.onerror=r,o.readAsText(e)})}createEquirectangularTexture(e){if(this.config.blur||e.width>Ea.maxTextureWidth){const n=Math.min(1,Ea.maxCanvasWidth/e.width),r=new OffscreenCanvas(Math.floor(e.width*n),Math.floor(e.height*n)),o=r.getContext("2d");return this.config.blur&&(o.filter=`blur(${r.width/2048}px)`),o.drawImage(e,0,0,r.width,r.height),$T(r)}return $T(e)}createMesh(e){const n=e.croppedX/e.fullWidth*2*Math.PI,r=e.croppedWidth/e.fullWidth*2*Math.PI,o=e.croppedY/e.fullHeight*Math.PI,l=e.croppedHeight/e.fullHeight*Math.PI,c=new my(Wm,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*r),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*l),-Math.PI/2+n,r,o,l).scale(-1,1,1),s=new dp({depthTest:!1,depthWrite:!1});return new Ja(c,s)}setTexture(e,n){e.material.map=n.texture}setTextureOpacity(e,n){e.material.opacity=n,e.material.transparent=n<1}disposeTexture({texture:e}){e.dispose()}disposeMesh(e){e.geometry.dispose(),e.material.dispose()}};aS.id="equirectangular";aS.VERSION="5.13.4";aS.supportsDownload=!0;var tI=aS,VU=class jU extends tI{static withConfig(e){return[jU,e]}constructor(e,n){super(e,{resolution:n?.resolution??64,useXmpData:!1})}async loadTexture(e,n){const r=await super.loadTexture(e,n,null,!1);return r.panoData=null,r}createMesh(){const e=new my(Wm,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),n=e.getAttribute("uv"),r=e.getAttribute("normal");for(let l=0;l<n.count;l++)for(let c=0;c<3;c++){const s=l*3+c,m=r.getX(s),y=r.getY(s),b=r.getZ(s),w=.947;if(l<n.count/6){const E=m===0&&b===0?1:Math.acos(y)/Math.sqrt(m*m+b*b)*(2/Math.PI);n.setXY(s,m*(w/4)*E+1/4,b*(w/2)*E+1/2)}else{const E=m===0&&b===0?1:Math.acos(-y)/Math.sqrt(m*m+b*b)*(2/Math.PI);n.setXY(s,-m*(w/4)*E+3/4,b*(w/2)*E+1/2)}}e.rotateX(-Math.PI/2),e.rotateY(Math.PI);const o=new dp({depthTest:!1,depthWrite:!1});return new Ja(e,o)}};VU.id="dual-fisheye";VU.VERSION="5.13.4";var Mp=class HU{constructor(e,n){this.parent=e,this.children=[],this.state={visible:!0},this.viewer=e instanceof HU?e.viewer:e,this.container=document.createElement(n.tagName??"div"),this.container.className=n.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const e=this.parent.children.indexOf(this);e!==-1&&this.parent.children.splice(e,1),this.children.slice().forEach(n=>n.destroy()),this.children.length=0}toggle(e=!this.isVisible()){e?this.show():this.hide()}hide(e){this.container.style.display="none",this.state.visible=!1}show(e){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},Wge=rS({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),Pa=class extends Mp{constructor(t,e){super(t,{tagName:e.tagName,className:`psv-button ${e.hoverScale?"psv-button--hover-scale":""} ${e.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=Wge(e),e.id||(this.config.id=this.constructor.id),e.icon&&this.__setIcon(e.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.viewer.config.lang[this.config.title]??this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),e.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",n=>{this.state.enabled&&this.onClick(),n.stopPropagation()}),this.container.addEventListener("keydown",n=>{n.key===As.Enter&&this.state.enabled&&(this.onClick(),n.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(t=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),t&&this.viewer.navbar.autoSize())}hide(t=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",t&&this.viewer.navbar.autoSize())}checkSupported(){YA(this.isSupported(),(t,e)=>{this.state&&(this.state.supported=t,e?t||this.hide():this.toggle(t))})}autoSize(){}isSupported(){return!0}toggleActive(t=!this.state.active){t!==this.state.active&&(this.state.active=t,eS(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(t){this.container.innerHTML=t,XA(this.container.querySelector("svg"),"psv-button-svg")}},qge=class extends Pa{constructor(t,e){super(t,{id:e.id??`psvButton-${Math.random().toString(36).substring(2)}`,className:`psv-custom-button ${e.className||""}`,hoverScale:!1,collapsable:e.collapsable!==!1,tabbable:e.tabbable!==!1,title:e.title}),this.customOnClick=e.onClick,e.content&&(typeof e.content=="string"?this.container.innerHTML=e.content:(this.container.classList.add("psv-custom-button--no-padding"),e.content.style.height="100%",e.content.attachViewer?.(this.viewer),this.container.appendChild(e.content))),this.state.width=this.container.offsetWidth,e.disabled&&this.disable(),e.visible===!1&&this.hide()}onClick(){this.customOnClick?.(this.viewer)}},E_=class extends Pa{constructor(t){super(t,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Mu.info}),this.mode=0,this.viewer.addEventListener(K0.type,this),this.viewer.addEventListener(t_.type,this),this.viewer.addEventListener(ep.type,this),this.viewer.addEventListener(np.type,this),this.viewer.addEventListener(nl.type,this)}destroy(){this.viewer.removeEventListener(K0.type,this),this.viewer.removeEventListener(t_.type,this),this.viewer.removeEventListener(ep.type,this),this.viewer.removeEventListener(np.type,this),this.viewer.removeEventListener(nl.type,this),super.destroy()}handleEvent(t){if(t instanceof nl){t.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let e=!1;t instanceof K0?e=this.mode===1:t instanceof t_?e=this.mode===1&&t.notificationId!==Ws.DESCRIPTION:t instanceof ep?e=this.mode===2:t instanceof np&&(e=this.mode===2&&t.panelId!==Ws.DESCRIPTION),e&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(t){super.hide(t),this.mode&&this.__close()}autoSize(t=!1){if(t){const e=this.viewer.navbar.getButton("caption",!1),n=e&&!e.isVisible(),r=!!this.viewer.config.description;n||r?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(Ws.DESCRIPTION);break;case 2:this.viewer.panel.hide(Ws.DESCRIPTION);break}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:Ws.DESCRIPTION,content:`${this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:""}${this.viewer.config.description}`})):(this.mode=1,this.viewer.notification.show({id:Ws.DESCRIPTION,content:this.viewer.config.caption}))}};E_.id="description";var GU=class extends Pa{constructor(t){super(t,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:Mu.download}),this.viewer.addEventListener(nl.type,this),this.viewer.addEventListener($v.type,this)}destroy(){this.viewer.removeEventListener(nl.type,this),this.viewer.removeEventListener($v.type,this),super.destroy()}handleEvent(t){t instanceof nl?(t.containsOptions("downloadUrl")&&this.checkSupported(),t.containsOptions("downloadUrl","downloadName")&&this.__update()):t instanceof $v&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){const t=this.container;t.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,t.target="_blank",t.href.startsWith("data:")&&!this.viewer.config.downloadName?t.download="panorama."+t.href.substring(0,t.href.indexOf(";")).split("/").pop():t.download=this.viewer.config.downloadName||t.href.split("/").pop()}};GU.id="download";var WU=class extends Pa{constructor(t){super(t,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Mu.fullscreenIn,iconActive:Mu.fullscreenOut}),this.viewer.addEventListener(Y0.type,this)}destroy(){this.viewer.removeEventListener(Y0.type,this),super.destroy()}handleEvent(t){t instanceof Y0&&this.toggleActive(t.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};WU.id="fullscreen";var Xge="psvButton",Zge=(t,e)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${Mu.menu} ${e}</h1>
  <ul class="psv-panel-menu-list">
    ${t.map(n=>`
    <li data-psv-button="${n.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${n.content}</span>
      <span class="psv-panel-menu-item-label">${n.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`,d1=class extends Pa{constructor(t){super(t,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Mu.menu}),this.viewer.addEventListener(np.type,this),this.viewer.addEventListener(ep.type,this),super.hide()}destroy(){this.viewer.removeEventListener(np.type,this),this.viewer.removeEventListener(ep.type,this),super.destroy()}handleEvent(t){t instanceof np?this.toggleActive(t.panelId===Ws.MENU):t instanceof ep&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(t){super.hide(t),this.__hideMenu()}show(t){super.show(t),this.state.active&&this.__showMenu()}__showMenu(){this.viewer.panel.show({id:Ws.MENU,content:Zge(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:t=>{const e=t?JB(t,".psv-panel-menu-item"):void 0,n=e?e.dataset[Xge]:void 0;n&&(this.viewer.navbar.getButton(n).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(Ws.MENU)}};d1.id="menu";function Yge(t){let e=0;switch(t){case 0:e=90;break;case 1:e=-90;break;case 3:e=180;break;default:e=0;break}return Mu.arrow.replace("rotate(0",`rotate(${e}`)}var fx=class extends Pa{constructor(t,e){super(t,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Yge(e)}),this.direction=e,this.handler=new iS,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":t.key===As.Enter&&this.__onMouseDown();break;case"keyup":t.key===As.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return nS(Ea.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const t={};switch(this.direction){case 0:t.pitch=!1;break;case 1:t.pitch=!0;break;case 3:t.yaw=!1;break;default:t.yaw=!0;break}this.viewer.stopAll(),this.viewer.dynamics.position.roll(t),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};fx.groupId="move";var qU=class extends fx{constructor(t){super(t,1)}};qU.id="moveDown";var XU=class extends fx{constructor(t){super(t,2)}};XU.id="moveLeft";var ZU=class extends fx{constructor(t){super(t,3)}};ZU.id="moveRight";var YU=class extends fx{constructor(t){super(t,0)}};YU.id="moveUp";var nI=class extends Pa{constructor(t,e,n){super(t,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=n,this.handler=new iS,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":t.key===As.Enter&&this.__onMouseDown();break;case"keyup":t.key===As.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return nS(Ea.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(this.direction===1),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};nI.groupId="zoom";var KU=class extends nI{constructor(t){super(t,Mu.zoomIn,0)}};KU.id="zoomIn";var JU=class extends nI{constructor(t){super(t,Mu.zoomOut,1)}};JU.id="zoomOut";var rI=class extends Pa{constructor(t){super(t,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new v6(this.container,"HORIZONTAL",e=>this.__onSliderUpdate(e)),this.mediaMinWidth=parseInt(wh(this.container,"max-width"),10),this.viewer.addEventListener(Vd.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(e_.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(Vd.type,this),this.viewer.removeEventListener(e_.type,this),super.destroy()}handleEvent(t){t instanceof Vd?this.__moveZoomValue(t.zoomLevel):t instanceof e_&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return nS(Ea.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(t){this.zoomValue.style.left=t/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(t){t.mousedown&&this.viewer.zoom(t.value*100)}};rI.id="zoomRange";rI.groupId="zoom";var QU=class extends y6{constructor(t){super(),this.viewer=t}init(){}destroy(){}},iI=class extends QU{constructor(t,e){super(t),this.config=this.constructor.configParser(e)}setOption(t,e){this.setOptions({[t]:e})}setOptions(t){const e={...this.config,...t},n=this.constructor,r=n.configParser,o=n.readonlyOptions,l=n.id;for(let[c,s]of Object.entries(t)){if(!(c in r.defaults)){qs(`${l}: Unknown option "${c}"`);continue}if(o.includes(c)){qs(`${l}: Option "${c}" cannot be updated`);continue}c in r.parsers&&(s=r.parsers[c](s,{rawConfig:e,defValue:r.defaults[c]})),this.config[c]=s}}};iI.readonlyOptions=[];function HT(t){if(t){for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof QU)return QA(e.id,e.VERSION,"5.13.4"),e}return null}var Yd={panorama:null,container:null,adapter:[tI,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:()=>!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[As.ArrowUp]:"ROTATE_UP",[As.ArrowDown]:"ROTATE_DOWN",[As.ArrowRight]:"ROTATE_RIGHT",[As.ArrowLeft]:"ROTATE_LEFT",[As.PageUp]:"ZOOM_IN",[As.PageDown]:"ZOOM_OUT",[As.Plus]:"ZOOM_IN",[As.Minus]:"ZOOM_OUT"}},SO={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},GT={container:t=>{if(!t)throw new jn("No value given for container.");return t},adapter:(t,{defValue:e})=>{if(t?Array.isArray(t)?t=[wO(t[0]),t[1]]:t=[wO(t),null]:t=e,!t[0])throw new jn("An undefined value was given for adapter.");if(!t[0].id)throw new jn("Adapter has no id.");return t},defaultYaw:t=>gh(t),defaultPitch:t=>gh(t,!0),defaultZoomLvl:t=>Gr.clamp(t,0,100),minFov:(t,{rawConfig:e})=>(e.maxFov<t&&(qs("maxFov cannot be lower than minFov"),t=e.maxFov),Gr.clamp(t,1,179)),maxFov:(t,{rawConfig:e})=>(t<e.minFov&&(t=e.minFov),Gr.clamp(t,1,179)),moveInertia:(t,{defValue:e})=>t===!0?e:t===!1?0:t,lang:t=>({...Yd.lang,...t}),keyboardActions:(t,{rawConfig:e})=>e.keyboard&&typeof e.keyboard=="object"?e.keyboard:t,fisheye:t=>t===!0?1:t===!1?0:t,requestHeaders:t=>t&&typeof t=="object"?()=>t:typeof t=="function"?t:null,withCredentials:t=>typeof t=="boolean"?()=>t:typeof t=="function"?t:()=>!1,defaultTransition:(t,{defValue:e})=>t===null||t.speed===0?null:{...e,...t},rendererParameters:(t,{defValue:e})=>({...t,...e}),plugins:t=>t.map((e,n)=>{if(Array.isArray(e)?e=[HT(e[0]),e[1]]:e=[HT(e),null],!e[0])throw new jn(`An undefined value was given for plugin ${n}.`);if(!e[0].id)throw new jn(`Plugin ${n} has no id.`);return e}),navbar:t=>t===!1?null:t===!0?tS(Yd.navbar):typeof t=="string"?t.split(/[ ,]/):t},Kge=rS(Yd,GT),Pv=class extends Pa{constructor(t){super(t,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(t){this.show(),this.contentElt.innerHTML=t??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){this.viewer.navbar.getButton(E_.id,!1)?.autoSize(!0)}};Pv.id="caption";var WT={},J1={};function oI(t,e){if(!t.id)throw new jn("Button id is required");if(WT[t.id]=t,t.groupId&&(J1[t.groupId]=J1[t.groupId]||[]).push(t),e){const n=Yd.navbar;switch(e){case"start":n.unshift(t.id);break;case"end":n.push(t.id);break;default:{const[r,o]=e.split(":"),l=n.indexOf(r);if(!r||!o||l===-1)throw new jn(`Invalid defaultPosition ${e}`);n.splice(l+(o==="right"?1:0),0,t.id)}}}}[JU,rI,KU,E_,Pv,GU,WU,XU,ZU,YU,qU].forEach(t=>oI(t));var Jge=class extends Mp{constructor(t){super(t,{className:`psv-navbar ${hx}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(t){this.children.slice().forEach(e=>e.destroy()),this.children.length=0,t.indexOf(Pv.id)!==-1&&t.indexOf(E_.id)===-1&&t.splice(t.indexOf(Pv.id),0,E_.id),t.forEach(e=>{typeof e=="object"?new qge(this,e):WT[e]?new WT[e](this):J1[e]?J1[e].forEach(n=>{new n(this)}):qs(`Unknown button ${e}`)}),new d1(this),this.children.forEach(e=>{e instanceof Pa&&e.checkSupported()}),this.autoSize()}setCaption(t){this.children.some(e=>e instanceof Pv?(e.setCaption(t),!0):!1)}getButton(t,e=!0){const n=this.children.find(r=>r instanceof Pa&&r.id===t);return!n&&e&&qs(`button "${t}" not found in the navbar`),n}focusButton(t){this.isVisible()&&(this.getButton(t,!1)?.container||this.container.firstElementChild)?.focus()}autoSize(){this.children.forEach(r=>{r instanceof Pa&&r.autoSize()});const t=this.container.offsetWidth;let e=0;const n=[];this.children.forEach(r=>{r.isVisible()&&r instanceof Pa&&(e+=r.width,r.collapsable&&n.push(r))}),e!==0&&(t<e&&n.length>0?(n.forEach(r=>r.collapse()),this.collapsed=n,this.getButton(d1.id).show(!1)):t>=e&&this.collapsed.length>0&&(this.collapsed.forEach(r=>r.uncollapse()),this.collapsed=[],this.getButton(d1.id).hide(!1)),this.getButton(Pv.id,!1)?.autoSize())}};kT.enabled=!1;var yv={enabled:!0,maxItems:10,ttl:10*60,items:{},purgeInterval:null,init(){kT.enabled&&(qs("ThreeJS cache should be disabled"),kT.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),60*1e3))},add(t,e,n){this.enabled&&e&&(this.items[e]=this.items[e]??{files:{},lastAccess:null},this.items[e].files[t]=n,this.items[e].lastAccess=Date.now())},get(t,e){if(this.enabled&&e&&this.items[e])return this.items[e].lastAccess=Date.now(),this.items[e].files[t]},remove(t,e){this.enabled&&e&&this.items[e]&&(delete this.items[e].files[t],Object.keys(this.items[e].files).length===0&&delete this.items[e])},purge(){Object.entries(this.items).sort(([,t],[,e])=>e.lastAccess-t.lastAccess).forEach(([t,{lastAccess:e}],n)=>{n>0&&(Date.now()-e>=this.ttl*1e3||n>=this.maxItems)&&delete this.items[t]})}},Qge=class extends Mp{constructor(t){super(t,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=wh(this.loader,"color"),this.color=wh(this.canvas,"color"),this.border=parseInt(wh(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(wh(this.loader,"--psv-loader-tickness"),10);const e=this.size/2;this.canvas.innerHTML=`
            <circle cx="${e}" cy="${e}" r="${e}" fill="${this.color}"/>
            <path d="" fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>
        `,this.viewer.addEventListener(nl.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(nl.type,this),super.destroy()}handleEvent(t){t instanceof nl&&t.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(t){this.container.classList.remove("psv-loader--undefined");const e=Gr.clamp(t,0,99.999)/100*Math.PI*2,n=this.size/2,r=n,o=this.thickness/2+this.border,l=(this.size-this.thickness)/2-this.border,c=Math.sin(e)*l+n,s=-Math.cos(e)*l+n,m=t>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d",`M ${r} ${o} A ${l} ${l} 0 ${m} 1 ${c} ${s}`)}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){const t=this.loader.querySelector(".psv-loader-image, .psv-loader-text");t&&this.loader.removeChild(t);let e;if(this.viewer.config.loadingImg?(e=document.createElement("img"),e.className="psv-loader-image",e.src=this.viewer.config.loadingImg):this.viewer.config.loadingTxt!==null&&(e=document.createElement("div"),e.className="psv-loader-text",e.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),e){const n=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));e.style.maxWidth=n+"px",e.style.maxHeight=n+"px",this.loader.appendChild(e)}}},eve=class extends Mp{constructor(t){super(t,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new jn("Notification cannot be toggled")}show(t){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),typeof t=="string"&&(t={content:t}),this.state.contentId=t.id||null,this.content.innerHTML=t.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new t_(this.state.contentId)),t.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),t.timeout))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new K0(e))}}},tve=class extends Mp{constructor(t){super(t,{className:`psv-overlay ${hx}`}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(tp.type,this),super.hide()}destroy(){this.viewer.removeEventListener(tp.type,this),super.destroy()}handleEvent(t){t.type==="click"?this.isVisible()&&this.state.dismissible&&(this.hide(),t.stopPropagation()):t instanceof tp&&this.isVisible()&&this.state.dismissible&&t.key===As.Escape&&(this.hide(),t.preventDefault())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new jn("Overlay cannot be toggled")}show(t){typeof t=="string"&&(t={title:t}),this.state.contentId=t.id||null,this.state.dismissible=t.dismissible!==!1,this.image.innerHTML=t.image||"",this.title.innerHTML=t.title||"",this.text.innerHTML=t.text||"",super.show(),this.viewer.dispatchEvent(new bU(this.state.contentId))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new U6(e))}}},nve=200,o2="psv-panel-content--no-interaction",rve=class extends Mp{constructor(t){super(t,{className:`psv-panel ${hx}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const e=document.createElement("div");e.className="psv-panel-resizer",this.container.appendChild(e);const n=document.createElement("div");n.className="psv-panel-close-button",n.innerHTML=Mu.close,n.title=t.config.lang.close,this.container.appendChild(n),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),n.addEventListener("click",()=>this.hide()),e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(tp.type,this)}destroy(){this.viewer.removeEventListener(tp.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break;case tp.type:this.__onKeyPress(t);break}}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new jn("Panel cannot be toggled")}show(t){typeof t=="string"&&(t={content:t});const e=this.isVisible(t.id);this.state.contentId=t.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),t.id&&this.state.width[t.id]?this.container.style.width=this.state.width[t.id]:t.width?this.container.style.width=t.width:this.container.style.width=null,this.content.innerHTML=t.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),eS(this.content,"psv-panel-content--no-margin",t.noMargin===!0),t.clickHandler&&(this.state.clickHandler=n=>{t.clickHandler(q1(n))},this.state.keyHandler=n=>{n.key===As.Enter&&t.clickHandler(q1(n))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),e||setTimeout(()=>{this.content.querySelector("a,button,[tabindex]")?.focus()},300)),this.viewer.dispatchEvent(new np(this.state.contentId))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new ep(e))}}__onMouseDown(t){t.stopPropagation(),this.__startResize(t.clientX,t.clientY)}__onTouchStart(t){if(t.stopPropagation(),t.touches.length===1){const e=t.touches[0];this.__startResize(e.clientX,e.clientY)}}__onMouseUp(t){this.state.mousedown&&(t.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(o2))}__onTouchEnd(t){this.state.mousedown&&(t.stopPropagation(),t.touches.length===0&&(this.state.mousedown=!1,this.content.classList.remove(o2)))}__onMouseMove(t){this.state.mousedown&&(t.stopPropagation(),this.__resize(t.clientX,t.clientY))}__onTouchMove(t){if(this.state.mousedown){const e=t.touches[0];this.__resize(e.clientX,e.clientY)}}__onKeyPress(t){this.isVisible()&&t.key===As.Escape&&(this.hide(),t.preventDefault())}__startResize(t,e){this.state.mouseX=t,this.state.mouseY=e,this.state.mousedown=!0,this.content.classList.add(o2)}__resize(t,e){const n=t,r=e,o=Math.max(nve,this.container.offsetWidth-(n-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=o),this.container.style.width=o,this.state.mouseX=n,this.state.mouseY=r}},ive=class extends Mp{constructor(t,e){super(t,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",n=>n.stopPropagation()),this.container.addEventListener("mousedown",n=>n.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(e)}handleEvent(t){t.type==="transitionend"&&this.__onTransitionEnd(t)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new jn("Tooltip cannot be toggled")}show(t){if(this.state.state!==0)throw new jn("Initialized tooltip cannot be re-initialized");t.className&&XA(this.container,t.className),t.style&&Object.assign(this.container.style,t.style),this.state.state=3,this.update(t.content,t),this.state.data=t.data,this.state.state=1,this.viewer.dispatchEvent(new EU(this,this.state.data)),this.__waitImages()}update(t,e){this.content.innerHTML=t;const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.state.arrow=parseInt(wh(this.arrow,"border-top-width"),10),this.state.border=parseInt(wh(this.container,"border-top-left-radius"),10),this.move(e??this.state.config),this.__waitImages()}move(t){if(this.state.state!==1&&this.state.state!==3)throw new jn("Uninitialized tooltip cannot be moved");t.box=t.box??this.state.config?.box??{width:0,height:0},this.state.config=t;const e=this.container,n=this.arrow,r={posClass:u6(t.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(r,t);let o=null,l=null;if(r.top<0?o="bottom":r.top+r.height>this.viewer.state.size.height&&(o="top"),r.left<0?l="right":r.left+r.width>this.viewer.state.size.width&&(l="left"),l||o){const s=JA(r.posClass);o&&(r.posClass[s?0:1]=o),l&&(r.posClass[s?1:0]=l),this.__computeTooltipPosition(r,t)}e.style.top=r.top+"px",e.style.left=r.left+"px",n.style.top=r.arrowTop+"px",n.style.left=r.arrowLeft+"px";const c=r.posClass.join("-");c!==this.state.pos&&(e.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=c,e.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new G6(this.state.data));const t=parseFloat(wh(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},t*2)}__onTransitionEnd(t){if(t.propertyName==="transform")switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy();break}}__computeTooltipPosition(t,e){const n=this.state.arrow,r=e.top,o=t.height,l=e.left,c=t.width,s=n+this.state.border,m=e.box.width/2+n*2,y=e.box.height/2+n*2;switch(t.posClass.join("-")){case"top-left":t.top=r-y-o,t.left=l+s-c,t.arrowTop=o,t.arrowLeft=c-s-n;break;case"top-center":t.top=r-y-o,t.left=l-c/2,t.arrowTop=o,t.arrowLeft=c/2-n;break;case"top-right":t.top=r-y-o,t.left=l-s,t.arrowTop=o,t.arrowLeft=n;break;case"bottom-left":t.top=r+y,t.left=l+s-c,t.arrowTop=-n*2,t.arrowLeft=c-s-n;break;case"bottom-center":t.top=r+y,t.left=l-c/2,t.arrowTop=-n*2,t.arrowLeft=c/2-n;break;case"bottom-right":t.top=r+y,t.left=l-s,t.arrowTop=-n*2,t.arrowLeft=n;break;case"left-top":t.top=r+s-o,t.left=l-m-c,t.arrowTop=o-s-n,t.arrowLeft=c;break;case"center-left":t.top=r-o/2,t.left=l-m-c,t.arrowTop=o/2-n,t.arrowLeft=c;break;case"left-bottom":t.top=r-s,t.left=l-m-c,t.arrowTop=n,t.arrowLeft=c;break;case"right-top":t.top=r+s-o,t.left=l+m,t.arrowTop=o-s-n,t.arrowLeft=-n*2;break;case"center-right":t.top=r-o/2,t.left=l+m,t.arrowTop=o/2-n,t.arrowLeft=-n*2;break;case"right-bottom":t.top=r-s,t.left=l+m,t.arrowTop=n,t.arrowLeft=-n*2;break}}__waitImages(){const t=this.content.querySelectorAll("img");if(t.length>0){const e=[];t.forEach(n=>{n.complete||e.push(new Promise(r=>{n.onload=r,n.onerror=r}))}),e.length&&Promise.all(e).then(()=>{if(this.state.state===1||this.state.state===3){const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.move(this.state.config)}})}}},ove=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/><!--Created by Shastry from the Noun Project--></svg>
`,px=class{constructor(t){this.viewer=t,this.config=t.config,this.state=t.state}destroy(){}},mu=new Pt,kb=new Rh(0,0,0,"ZXY"),sve=class extends px{constructor(t){super(t)}fovToZoomLevel(t){const e=Math.round((t-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return Gr.clamp(e-2*(e-50),0,100)}zoomLevelToFov(t){return this.config.maxFov+t/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(t){return Gr.radToDeg(2*Math.atan(Math.tan(Gr.degToRad(t)/2)*this.state.aspect))}hFovToVFov(t){return Gr.radToDeg(2*Math.atan(Math.tan(Gr.degToRad(t)/2)/this.state.aspect))}getAnimationProperties(t,e,n){const r=!Is(e),o=!Is(n),l={};let c=null;if(r){const s=this.viewer.getPosition(),m=ZB(s.yaw,e.yaw);l.yaw={start:s.yaw,end:s.yaw+m},l.pitch={start:s.pitch,end:e.pitch},c=UT(t,YB(s,e))}if(o){const s=this.viewer.getZoomLevel(),m=Math.abs(n-s);l.zoom={start:s,end:n},c===null&&(c=UT(t,Math.PI/4*m/100))}return c===null?typeof t=="number"?c=t:c=FT:c=Math.max(FT,c),{duration:c,properties:l}}getTransitionOptions(t){let e;const n=this.config.defaultTransition??Yd.defaultTransition;return t.transition===!1||t.transition===null?e=null:t.transition===!0?e={...n}:typeof t.transition=="object"?e={...n,...t.transition}:e=this.config.defaultTransition,e}textureCoordsToSphericalCoords(t){if(!this.state.textureData?.panoData)throw new jn("Current adapter does not support texture coordinates or no texture has been loaded");const e=this.viewer.adapter.textureCoordsToSphericalCoords(t,this.state.textureData.panoData);return!kb.equals(this.viewer.renderer.panoramaPose)||!kb.equals(this.viewer.renderer.sphereCorrection)?(this.sphericalCoordsToVector3(e,mu),mu.applyEuler(this.viewer.renderer.panoramaPose),mu.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(mu)):e}sphericalCoordsToTextureCoords(t){if(!this.state.textureData?.panoData)throw new jn("Current adapter does not support texture coordinates or no texture has been loaded");return(!kb.equals(this.viewer.renderer.panoramaPose)||!kb.equals(this.viewer.renderer.sphereCorrection))&&(this.sphericalCoordsToVector3(t,mu),VT(mu,this.viewer.renderer.sphereCorrection),VT(mu,this.viewer.renderer.panoramaPose),t=this.vector3ToSphericalCoords(mu)),this.viewer.adapter.sphericalCoordsToTextureCoords(t,this.state.textureData.panoData)}sphericalCoordsToVector3(t,e,n=Wm){return e||(e=new Pt),e.x=n*-Math.cos(t.pitch)*Math.sin(t.yaw),e.y=n*Math.sin(t.pitch),e.z=n*Math.cos(t.pitch)*Math.cos(t.yaw),e}vector3ToSphericalCoords(t){const e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),n=Math.atan2(t.x,t.z);return{yaw:n<0?-n:Math.PI*2-n,pitch:Math.PI/2-e}}viewerCoordsToVector3(t){const e=this.viewer.renderer.getIntersections(t).filter(n=>n.object.userData[fp]);return e.length?e[0].point:null}viewerCoordsToSphericalCoords(t){const e=this.viewerCoordsToVector3(t);return e?this.vector3ToSphericalCoords(e):null}vector3ToViewerCoords(t){const e=t.clone();return e.project(this.viewer.renderer.camera),{x:Math.round((e.x+1)/2*this.state.size.width),y:Math.round((1-e.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(t){return this.sphericalCoordsToVector3(t,mu),this.vector3ToViewerCoords(mu)}isPointVisible(t){let e,n;if(t instanceof Pt)e=t,n=this.vector3ToViewerCoords(t);else if(KA(t))e=this.sphericalCoordsToVector3(t,mu),n=this.vector3ToViewerCoords(e);else return!1;return e.dot(this.viewer.state.direction)>0&&n.x>=0&&n.x<=this.viewer.state.size.width&&n.y>=0&&n.y<=this.viewer.state.size.height}cleanPosition(t){if("yaw"in t||"pitch"in t){if(!("yaw"in t)||!("pitch"in t))throw new jn("Position is missing 'yaw' or 'pitch'");return{yaw:gh(t.yaw),pitch:gh(t.pitch,!0)}}else return this.textureCoordsToSphericalCoords(t)}cleanSphereCorrection(t){return{pan:gh(t?.pan||0),tilt:gh(t?.tilt||0,!0),roll:gh(t?.roll||0,!0,!1)}}cleanPanoramaPose(t){return{pan:Gr.degToRad(t?.poseHeading||0),tilt:Gr.degToRad(t?.posePitch||0),roll:Gr.degToRad(t?.poseRoll||0)}}cleanPanoramaOptions(t,e){return e?.isEquirectangular&&(Is(t.zoom)&&!Is(e.initialFov)&&(t={...t,zoom:this.fovToZoomLevel(this.hFovToVFov(e.initialFov))}),Is(t.position)&&!Is(e.initialHeading)&&!Is(e.initialPitch)&&(t={...t,position:{yaw:gh(e.initialHeading),pitch:gh(e.initialPitch,!0)}})),t}},ave=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/><!--Created by AomAm from the Noun Project--></svg>
`,lve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/><!-- Created by Icon Island from the Noun Project --></svg>
`,lS=class e${constructor(){this.$=e$.IDLE}is(...e){return e.some(n=>this.$&n)}set(e){this.$=e}add(e){this.$|=e}remove(e){this.$&=~e}};lS.IDLE=0;lS.CLICK=1;lS.MOVING=2;var Yo=lS,cve=class extends px{constructor(t){super(t),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new Yo,this.keyHandler=new iS,this.resizeObserver=new ResizeObserver(i6(()=>this.viewer.autoSize(),50)),this.moveThreshold=$B*Ea.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(Z0.type,this),this.viewer.addEventListener(r_.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(Z0.type,this),this.viewer.removeEventListener(r_.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(t){switch(t.type){case"keydown":this.__onKeyDown(t);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchmove":this.__onTouchMove(t);break;case"touchend":this.__onTouchEnd(t);break;case"fullscreenchange":this.__onFullscreenChange();break;case Z0.type:this.__applyMoveDelta();break;case r_.type:this.__clearMoveDelta();break}if(!QB(t,"."+hx))switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"wheel":this.__onMouseWheel(t);break}}__onKeyDown(t){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=t.key===As.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(Ws.CTRL_ZOOM))),!this.viewer.dispatchEvent(new tp(t.key,t))||!this.state.keyboardEnabled)return;const e=this.config.keyboardActions?.[t.key];if(typeof e=="function"){e(this.viewer,t),t.preventDefault();return}if(!(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)&&e&&!this.keyHandler.pending){switch(e!=="ZOOM_IN"&&e!=="ZOOM_OUT"&&this.viewer.stopAll(),e){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0);break}this.keyHandler.down(e),t.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(t=>{t==="ZOOM_IN"||t==="ZOOM_OUT"?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())})}__onMouseDown(t){this.step.add(Yo.CLICK),this.data.startMouseX=t.clientX,this.data.startMouseY=t.clientY,this.config.mousemove&&t.preventDefault()}__onMouseUp(t){this.step.is(Yo.CLICK,Yo.MOVING)&&this.__stopMove(t.clientX,t.clientY,t,t.button===2)}__onMouseMove(t){this.config.mousemove&&this.step.is(Yo.CLICK,Yo.MOVING)&&(t.preventDefault(),this.__doMove(t.clientX,t.clientY)),this.__handleObjectsEvents(t)}__onTouchStart(t){t.touches.length===1?(this.step.add(Yo.CLICK),this.data.startMouseX=t.touches[0].clientX,this.data.startMouseY=t.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const e=t.touches[0];this.__stopMove(e.clientX,e.clientY,t,!0),this.data.longtouchTimeout=null},jB))):t.touches.length===2&&(this.step.set(Yo.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(t),t.preventDefault()))}__onTouchEnd(t){if(this.__cancelLongTouch(),this.step.is(Yo.CLICK,Yo.MOVING)){if(t.preventDefault(),this.__cancelTwoFingersOverlay(),t.touches.length===1)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(t.touches.length===0){const e=t.changedTouches[0];this.__stopMove(e.clientX,e.clientY,t)}}}__onTouchMove(t){if(this.__cancelLongTouch(),!!this.config.mousemove)if(t.touches.length===1){if(this.config.touchmoveTwoFingers)this.step.is(Yo.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:Ws.TWO_FINGERS,image:ave,title:this.config.lang.twoFingers})},HB));else if(this.step.is(Yo.CLICK,Yo.MOVING)){t.preventDefault();const e=t.touches[0];this.__doMove(e.clientX,e.clientY)}}else this.__doMoveZoom(t),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(Ws.TWO_FINGERS))}__onMouseWheel(t){if(!this.config.mousewheel||!t.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown){this.viewer.overlay.show({id:Ws.CTRL_ZOOM,image:lve,title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(Ws.CTRL_ZOOM),GB);return}t.preventDefault(),t.stopPropagation();const e=t.deltaY/Math.abs(t.deltaY)*5*this.config.zoomSpeed;e!==0&&this.viewer.dynamics.zoom.step(-e,5)}__onFullscreenChange(){const t=this.viewer.isFullscreenEnabled();this.config.keyboard==="fullscreen"&&(t?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new Y0(t))}__resetMove(){this.step.set(Yo.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(t){this.viewer.stopAll(),this.__resetMove();const e=NT(t);this.step.set(Yo.MOVING),this.data.accumulatorFactor=this.config.moveInertia,{distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=e}__stopMove(t,e,n,r=!1){this.step.is(Yo.CLICK)&&!this.__moveThresholdReached(t,e)&&this.__doClick(t,e,n,r),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(t,e,n,r=!1){const o=this.viewer.container.getBoundingClientRect(),l=t-o.left,c=e-o.top,s=this.viewer.renderer.getIntersections({x:l,y:c}),m=s.find(y=>y.object.userData[fp]);if(m){const y=this.viewer.dataHelper.vector3ToSphericalCoords(m.point),b={rightclick:r,originalEvent:n,target:q1(n),clientX:t,clientY:e,viewerX:l,viewerY:c,yaw:y.yaw,pitch:y.pitch,objects:s.map(w=>w.object).filter(w=>!w.userData[fp])};try{const w=this.viewer.dataHelper.sphericalCoordsToTextureCoords(b);Object.assign(b,w)}catch{}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-b.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-b.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new D6(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new P6(b)),this.data.dblclickData=tS(b),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},VB))}}__handleObjectsEvents(t){if(!s6(this.state.objectsObservers)&&t.composedPath().includes(this.viewer.container)){const e=e6(this.viewer.container),n={x:t.clientX-e.x,y:t.clientY-e.y},r=this.viewer.renderer.getIntersections(n),o=(l,c,s)=>{this.viewer.dispatchEvent(new s(t,l,n,c))};for(const[l,c]of Object.entries(this.state.objectsObservers)){const s=r.find(m=>m.object.userData[l]);s?(c&&s.object!==c&&(o(c,l,jT),this.state.objectsObservers[l]=null),c?o(s.object,l,UU):(this.state.objectsObservers[l]=s.object,o(s.object,l,zU))):c&&(o(c,l,jT),this.state.objectsObservers[l]=null)}}}__doMove(t,e){if(this.step.is(Yo.CLICK)&&this.__moveThresholdReached(t,e))this.viewer.stopAll(),this.__resetMove(),this.step.set(Yo.MOVING),this.data.mouseX=t,this.data.mouseY=e,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(Yo.MOVING)){const n=(t-this.data.mouseX)*Math.cos(this.state.roll)-(e-this.data.mouseY)*Math.sin(this.state.roll),r=(e-this.data.mouseY)*Math.cos(this.state.roll)+(t-this.data.mouseX)*Math.sin(this.state.roll),o={yaw:this.config.moveSpeed*(n/this.state.size.width)*Gr.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(r/this.state.size.height)*Gr.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=o.yaw,this.data.moveDelta.pitch+=o.pitch,this.data.mouseX=t,this.data.mouseY=e}}__moveThresholdReached(t,e){return Math.abs(t-this.data.startMouseX)>=this.moveThreshold||Math.abs(e-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(t){if(this.step.is(Yo.MOVING)){t.preventDefault();const e=NT(t);this.__doMove(e.center.x,e.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((e.distance-this.data.pinchDist)/Ea.pixelRatio),this.data.pinchDist=e.distance}}__applyMoveDelta(){if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){const e=this.viewer.getPosition();this.viewer.rotate({yaw:e.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:e.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,Math.abs(this.data.moveDelta.yaw)<=.001&&(this.data.moveDelta.yaw=0),Math.abs(this.data.moveDelta.pitch)<=.001&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){const e=this.viewer.getZoomLevel();this.viewer.zoom(e+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,Math.abs(this.data.moveDelta.zoom)<=.001&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};li.enabled=!1;var zb=new mi,MO=new Ti,CO=new py,uve=class extends px{constructor(t){super(t),this.frustumNeedsUpdate=!0,this.renderer=new Cge(this.config.rendererParameters),this.renderer.setPixelRatio(Ea.pixelRatio),this.renderer.outputColorSpace=Gm,this.renderer.toneMapping=pB,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new H1,this.camera=new Fl(50,16/9,.1,2*Wm),this.camera.matrixAutoUpdate=!1;const e=new Ja(new my(Wm).scale(-1,1,1),new dp({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));e.userData={[fp]:!0},this.scene.add(e),this.raycaster=new Vhe,this.frustum=new HA,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",n=>n.preventDefault()),this.viewer.addEventListener(n_.type,this),this.viewer.addEventListener(Vd.type,this),this.viewer.addEventListener(J0.type,this),this.viewer.addEventListener(Q0.type,this),this.viewer.addEventListener(nl.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(t=>this.__renderLoop(t))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(n_.type,this),this.viewer.removeEventListener(Vd.type,this),this.viewer.removeEventListener(J0.type,this),this.viewer.removeEventListener(Q0.type,this),this.viewer.removeEventListener(nl.type,this),super.destroy()}handleEvent(t){switch(t.type){case n_.type:this.__onSizeUpdated();break;case Vd.type:this.__onZoomUpdated();break;case J0.type:this.__onPositionUpdated();break;case Q0.type:this.__onPositionUpdated();break;case nl.type:t.containsOptions("fisheye")&&this.__onPositionUpdated(),t.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground);break}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(t){t?this.customRenderer=t(this.renderer):this.customRenderer=null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(t){const e=this.timestamp?t-this.timestamp:0;this.timestamp=t,this.viewer.dispatchEvent(new Z0(t,e)),this.viewer.dynamics.update(e),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new gU))}setTexture(t){this.meshContainer||(this.meshContainer=new Yf,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(t.panoData),this.viewer.adapter.setTexture(this.mesh,t,!1),this.meshContainer.add(this.mesh),this.state.textureData=t,this.viewer.needsUpdate()}setPanoramaPose(t,e=this.mesh){const n=this.viewer.dataHelper.cleanPanoramaPose(t);e.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}setSphereCorrection(t,e=this.meshContainer){const n=this.viewer.dataHelper.cleanSphereCorrection(t);e.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}transition(t,e,n){const r=n.effect==="fade"||n.rotation,o=!Is(e.position),l=!Is(e.zoom),c=new eI(o?this.viewer.dataHelper.cleanPosition(e.position):void 0,e.zoom);this.viewer.dispatchEvent(c);const s=new Yf,m=this.viewer.adapter.createMesh(t.panoData);if(this.viewer.adapter.setTexture(m,t,!0),this.viewer.adapter.setTextureOpacity(m,0),this.setPanoramaPose(t.panoData,m),this.setSphereCorrection(e.sphereCorrection,s),o&&!n.rotation){const E=this.viewer.getPosition(),T=new Pt(0,1,0);s.rotateOnWorldAxis(T,c.position.yaw-E.yaw);const R=new Pt(0,1,0).cross(this.camera.getWorldDirection(new Pt)).normalize();s.rotateOnWorldAxis(R,c.position.pitch-E.pitch)}s.add(m),this.scene.add(s),this.renderer.setRenderTarget(new hp),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:y,properties:b}=this.viewer.dataHelper.getAnimationProperties(n.speed,n.rotation?c.position:null,r?c.zoomLevel:null),w=new K1({properties:{...b,opacity:{start:0,end:1}},duration:y,easing:"inOutCubic",onTick:E=>{switch(n.effect){case"fade":this.viewer.adapter.setTextureOpacity(m,E.opacity);break;case"black":case"white":E.opacity<.5?this.renderer.toneMappingExposure=n.effect==="black"?Gr.mapLinear(E.opacity,0,.5,1,0):Gr.mapLinear(E.opacity,0,.5,1,4):(this.renderer.toneMappingExposure=n.effect==="black"?Gr.mapLinear(E.opacity,.5,1,0,1):Gr.mapLinear(E.opacity,.5,1,4,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(m,1),l&&!r&&this.viewer.dynamics.zoom.setValue(c.zoomLevel));break}o&&n.rotation&&this.viewer.dynamics.position.setValue({yaw:E.yaw,pitch:E.pitch}),l&&r&&this.viewer.dynamics.zoom.setValue(E.zoom),this.viewer.needsUpdate()}});return w.then(E=>{s.remove(m),this.scene.remove(s),E?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=m,this.meshContainer.add(m),this.state.textureData=t,this.setPanoramaPose(t.panoData),this.setSphereCorrection(e.sphereCorrection),o&&!n.rotation&&this.viewer.rotate(e.position)):(this.viewer.adapter.disposeTexture(t),this.viewer.adapter.disposeMesh(m))}),w}getIntersections(t){zb.x=2*t.x/this.state.size.width-1,zb.y=-2*t.y/this.state.size.height+1,this.raycaster.setFromCamera(zb,this.camera);const e=this.raycaster.intersectObjects(this.scene.children,!0).filter(n=>n.object.visible).filter(n=>n.object.isMesh&&!!n.object.userData);return this.customRenderer?.getIntersections&&e.push(...this.customRenderer.getIntersections(this.raycaster,zb)),e}isObjectVisible(t){if(!t)return!1;if(this.frustumNeedsUpdate&&(MO.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(MO),this.frustumNeedsUpdate=!1),t.isVector3)return this.frustum.containsPoint(t);if(t.isMesh&&t.geometry){const e=t;return e.geometry.boundingBox||e.geometry.computeBoundingBox(),CO.copy(e.geometry.boundingBox).applyMatrix4(e.matrixWorld),this.frustum.intersectsBox(CO)}else return t.isObject3D?this.frustum.intersectsObject(t):!1}addObject(t){this.scene.add(t)}removeObject(t){this.scene.remove(t)}cleanScene(t){const e=n=>{n.map?.dispose(),n.uniforms&&Object.values(n.uniforms).forEach(r=>{r.value?.dispose?.()}),n.dispose()};t.traverse(n=>{n.geometry?.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(r=>{e(r)}):e(n.material)),n instanceof H1||n.dispose?.(),n!==t&&this.cleanScene(n)})}},hve=class extends GA{load(t,e,n,r,o){const l=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(l,{signal:o}).then(c=>{if(c.status===200||c.status===0){const s=c.body.getReader(),m=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),y=m?parseInt(m):0,b=y!==0;let w=0;const E=new ReadableStream({start(T){R();function R(){s.read().then(({done:z,value:I})=>{if(z)T.close();else{w+=I.byteLength;const L=new ProgressEvent("progress",{lengthComputable:b,loaded:w,total:y});n(L),T.enqueue(I),R()}}).catch(z=>{r(z)})}}});return new Response(E)}else throw new Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>c.blob()).then(c=>{e(c)}).catch(c=>{r(c)})}},dve=class extends GA{load(t,e,n,r){const o=document.createElement("img");function l(){m(),e(this)}function c(y){if(m(),r?.aborted){const b=new Error;b.name="AbortError",b.message="The operation was aborted.",n(b)}else n(y)}function s(){o.src=""}function m(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1),r?.removeEventListener("abort",s,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),r?.addEventListener("abort",s,!1),t.startsWith("data:")||(o.crossOrigin=this.withCredentials?"use-credentials":"anonymous"),o.src=t,o}},fve=class extends px{constructor(t){super(t),this.abortCtrl={},this.fileLoader=new hve,this.imageLoader=new dve}destroy(){this.abortLoading(),super.destroy()}abortLoading(){Object.values(this.abortCtrl).forEach(t=>t.abort()),this.abortCtrl={}}loadFile(t,e,n){const r=yv.get(t,n);if(r){if(r instanceof Blob)return e?.(100),Promise.resolve(r);yv.remove(t,n)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(t)),this.fileLoader.setWithCredentials(this.config.withCredentials(t)),new Promise((o,l)=>{let c=0;e?.(c),this.fileLoader.load(t,s=>{c=100,e?.(c),yv.add(t,n,s),o(s)},s=>{if(s.lengthComputable){const m=s.loaded/s.total*100;m>c&&(c=m,e?.(c))}},s=>{l(s)},this.__getAbortSignal(n))})}loadImage(t,e,n){const r=yv.get(t,n);return r?(e?.(100),r instanceof Blob?this.blobToImage(r):Promise.resolve(r)):!e&&!this.config.requestHeaders?(this.imageLoader.setWithCredentials(this.config.withCredentials(t)),new Promise((o,l)=>{this.imageLoader.load(t,c=>{yv.add(t,n,c),o(c)},c=>{l(c)},this.__getAbortSignal(n))})):this.loadFile(t,e,n).then(o=>this.blobToImage(o))}blobToImage(t){return new Promise((e,n)=>{const r=document.createElement("img");r.onload=()=>{URL.revokeObjectURL(r.src),e(r)},r.onerror=n,r.src=URL.createObjectURL(t)})}preloadPanorama(t){return this.viewer.adapter.supportsPreload(t)?this.viewer.adapter.loadTexture(t,!1):Promise.reject(new jn("Current adapter does not support preload"))}dispatchProgress(t){this.viewer.loader.setProgress(t),this.viewer.dispatchEvent(new Y6(Math.round(t)))}__getAbortSignal(t){return t?(this.abortCtrl[t]?.signal.aborted&&delete this.abortCtrl[t],this.abortCtrl[t]||(this.abortCtrl[t]=new AbortController),this.abortCtrl[t].signal):null}},pve=class extends px{constructor(t){super(t),this.zoom=new L0(e=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(e),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new Vd(e))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new m6(e=>{this.viewer.dataHelper.sphericalCoordsToVector3(e,this.viewer.state.direction),this.viewer.dispatchEvent(new J0(e))},{yaw:new L0(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new L0(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new L0(e=>{this.viewer.state.roll=e,this.viewer.dispatchEvent(new Q0(e))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(this.config.zoomSpeed*50),this.position.setSpeed(Gr.degToRad(this.config.moveSpeed*50)),this.roll.setSpeed(Gr.degToRad(this.config.moveSpeed*50))}update(t){this.zoom.update(t),this.position.update(t),this.roll.update(t)}},mve=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new Pt(0,0,Wm),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},gve=class extends y6{constructor(t){if(super(),this.plugins={},this.children=[],this.parent=KB(t.container),!this.parent)throw new jn('"container" element not found.');this.parent[fp]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),f6(this.parent),d6(this.container,"core"),this.state=new mve,this.config=Kge(t),this.__setSize(this.config.size),this.overlay=new tve(this);try{Ea.load()}catch(e){console.error(e),this.showError(this.config.lang.webglError);return}yv.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new uve(this),this.textureLoader=new fve(this),this.eventsHandler=new cve(this),this.dataHelper=new sve(this),this.dynamics=new pve(this),this.adapter.init?.(),this.loader=new Qge(this),this.navbar=new Jge(this),this.panel=new rve(this),this.notification=new eve(this),this.autoSize(),this.setCursor(null),YA(Ea.isTouchEnabled,e=>{eS(this.container,"psv--is-touch",e)}),this.config.plugins.forEach(([e,n])=>{this.plugins[e.id]=new e(this,n)});for(const e of Object.values(this.plugins))e.init?.();this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[t,e]of Object.entries(this.plugins))e.destroy(),delete this.plugins[t];this.children.slice().forEach(t=>t.destroy()),this.children.length=0,this.eventsHandler?.destroy(),this.renderer?.destroy(),this.textureLoader?.destroy(),this.dataHelper?.destroy(),this.adapter?.destroy(),this.dynamics?.destroy(),this.parent.removeChild(this.container),delete this.parent[fp]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),this.config.keyboard==="always"&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new e_)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(t){if(typeof t=="string")return this.plugins[t];{const e=HT(t);return e?this.plugins[e.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return t6(this.parent,Ea.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(t){t?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){(this.container.clientWidth!==this.state.size.width||this.container.clientHeight!==this.state.size.height)&&(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new n_(this.getSize())),this.navbar.autoSize())}setPanorama(t,e={}){this.textureLoader.abortLoading(),this.state.transitionAnimation?.cancel();const n=this.dataHelper.getTransitionOptions(e);e.showLoader===void 0&&(e.showLoader=!0),e.caption===void 0&&(e.caption=this.config.caption),e.description===void 0&&(e.description=this.config.description),!e.panoData&&typeof this.config.panoData=="function"&&(e.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=t,this.config.caption=e.caption,this.config.description=e.description,this.config.sphereCorrection=e.sphereCorrection;const r=l=>{if(c6(l))return!1;if(this.loader.hide(),this.state.loadingPromise=null,l)throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(l),this.dispatchEvent(new iU(t,l)),l;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),(e.showLoader||!this.state.ready)&&this.loader.show(),this.dispatchEvent(new Q6(t));const o=this.adapter.loadTexture(this.config.panorama,!0,e.panoData).then(l=>{if(l.panorama!==this.config.panorama)throw this.adapter.disposeTexture(l),BT();const c=this.dataHelper.cleanPanoramaOptions(e,l.panoData);return(!Is(c.zoom)||!Is(c.position))&&this.stopAll(),{textureData:l,cleanOptions:c}});return!n||!this.state.ready||!this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=o.then(({textureData:l,cleanOptions:c})=>{this.renderer.show(),this.renderer.setTexture(l),this.renderer.setPanoramaPose(l.panoData),this.renderer.setSphereCorrection(e.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new $v(l)),Is(c.zoom)||this.zoom(c.zoom),Is(c.position)||this.rotate(c.position)}).then(()=>r(),l=>r(l)):this.state.loadingPromise=o.then(({textureData:l,cleanOptions:c})=>(this.loader.hide(),this.dispatchEvent(new $v(l)),this.state.transitionAnimation=this.renderer.transition(l,c,n),this.state.transitionAnimation)).then(l=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new aU(l)),!l)throw BT()}).then(()=>r(),l=>r(l)),this.state.loadingPromise}setOptions(t){const e={...this.config,...t};for(let[n,r]of Object.entries(t)){if(!(n in Yd)){qs(`Unknown option ${n}`);continue}if(n in SO){qs(SO[n]);continue}switch(n in GT&&(r=GT[n](r,{rawConfig:e,defValue:Yd[n]})),this.config[n]=r,n){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new Vd(this.getZoomLevel()));break;case"keyboard":this.config.keyboard==="always"?this.startKeyboardControl():this.stopKeyboardControl();break}}this.needsUpdate(),this.dispatchEvent(new nl(Object.keys(t)))}setOption(t,e){this.setOptions({[t]:e})}showError(t){this.overlay.show({id:Ws.ERROR,image:ove,title:t,dismissible:!1})}hideError(){this.overlay.hide(Ws.ERROR)}rotate(t){const e=new C6(this.dataHelper.cleanPosition(t));this.dispatchEvent(e),!e.defaultPrevented&&this.dynamics.position.setValue(e.position)}zoom(t){this.dynamics.zoom.setValue(t)}zoomIn(t=1){this.dynamics.zoom.step(t)}zoomOut(t=1){this.dynamics.zoom.step(-t)}animate(t){const e=KA(t),n=!Is(t.zoom),r=new eI(e?this.dataHelper.cleanPosition(t):void 0,t.zoom);if(this.dispatchEvent(r),r.defaultPrevented)return;this.stopAll();const{duration:o,properties:l}=this.dataHelper.getAnimationProperties(t.speed,r.position,r.zoomLevel);return o?(this.state.animation=new K1({properties:l,duration:o,easing:t.easing||"inOutSine",onTick:c=>{e&&this.dynamics.position.setValue({yaw:c.yaw,pitch:c.pitch}),n&&this.dynamics.zoom.setValue(c.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(e&&this.rotate(r.position),n&&this.zoom(r.zoomLevel),new K1(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(t){this.__setSize(t),this.autoSize()}__setSize(t){["width","height"].forEach(e=>{t?.[e]&&(/^[0-9.]+$/.test(t[e])&&(t[e]+="px"),this.parent.style[e]=t[e])})}enterFullscreen(){this.isFullscreenEnabled()||n6(this.parent,Ea.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&r6(Ea.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(t){return new ive(this,t)}setCursor(t){this.state.cursorOverride=t,t?this.container.style.cursor=t:this.container.style.cursor=this.config.mousemove?"move":"default"}observeObjects(t){this.state.objectsObservers[t]||(this.state.objectsObservers[t]=null)}unobserveObjects(t){delete this.state.objectsObservers[t]}stopAll(){return this.dispatchEvent(new r_),this.disableIdleTimer(),this.stopAnimation()}};/*!
 * Photo Sphere Viewer / Equirectangular Tiles Adapter 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var vve=class{constructor(t,e,n){this.id=t,this.priority=e,this.fn=n,this.status=1}start(){return this.status=2,this.fn(this).then(()=>{this.status=4},()=>{this.status=5})}cancel(){this.status=3}isCancelled(){return this.status===3}},yve=class{constructor(e=8){this.concurency=e,this.runningTasks={},this.tasks={}}enqueue(e){this.tasks[e.id]=e}clear(){Object.values(this.tasks).forEach(e=>e.cancel()),this.tasks={},this.runningTasks={}}setPriority(e,n){const r=this.tasks[e];r&&(r.priority=n,r.status===0&&(r.status=1))}disableAllTasks(){Object.values(this.tasks).forEach(e=>{e.status=0})}start(){if(Object.keys(this.runningTasks).length>=this.concurency)return;const e=Object.values(this.tasks).filter(n=>n.status===1).sort((n,r)=>r.priority-n.priority).pop();e&&(this.runningTasks[e.id]=!0,e.start().then(()=>{e.isCancelled()||(delete this.tasks[e.id],delete this.runningTasks[e.id],this.start())}),this.start())}};function _ve(t){let e=0;t.forEach((n,r)=>{if(!n.zoomRange||n.zoomRange.length!==2)throw new jn(`Tiles level ${r} is missing "zoomRange" property`);if(n.zoomRange[0]>=n.zoomRange[1]||n.zoomRange[0]!==e||r===0&&n.zoomRange[0]!==0||r===t.length-1&&n.zoomRange[1]!==100)throw new jn(`Tiles levels' "zoomRange" are not orderer or are not covering the whole 0-100 range`);e=n.zoomRange[1]})}function xve(t,e){return t.findIndex(n=>e>=n.zoomRange[0]&&e<=n.zoomRange[1])}function bve(){const t=new OffscreenCanvas(512,512),e=t.getContext("2d");return e.fillStyle="#333",e.fillRect(0,0,t.width,t.height),e.font=`${t.width/5}px serif`,e.fillStyle="#a22",e.textAlign="center",e.textBaseline="middle",e.fillText("⚠",t.width/2,t.height/2),new dp({map:Qn.createTexture(t)})}function wve(t){const e=new zhe(t),n=new Dhe(e);return n.material.depthTest=!1,n.material.depthWrite=!1,n.material.opacity=.25,n.material.transparent=!0,n}var EO=["dodgerblue","limegreen","indianred"];function Sve(t,e,n){const r=document.createElement("canvas");r.width=t.width,r.height=t.height;const o=r.getContext("2d");o.fillStyle=EO[e%EO.length],o.fillRect(0,0,r.width,r.height),o.globalCompositeOperation="multiply",o.drawImage(t,0,0);const l=t.width/7;return o.globalCompositeOperation="source-over",o.fillStyle="white",o.font=`${l}px monospace`,o.textAlign="center",n.split(`
`).forEach((c,s)=>{o.fillText(c,t.width/2,t.height/2+l*(.3+s))}),r}function sI(t){return!!t.levels}function t$(t,e,n){return{...t,level:e,colSize:t.width/t.cols,rowSize:t.width/2/t.rows,facesByCol:n.SPHERE_SEGMENTS/t.cols,facesByRow:n.SPHERE_HORIZONTAL_SEGMENTS/t.rows}}function TO(t,e,n){let r,o;return sI(t)?(o=xve(t.levels,e),r=t.levels[o]):(o=0,r={...t,zoomRange:[0,100]}),t$(r,o,n)}function Mve(t,e,n){return!sI(t)||!t.levels[e]?null:t$(t.levels[e],e,n)}function Cve(t,e){if(typeof t!="object"||!t.tileUrl)throw new jn("Invalid panorama configuration, are you using the right adapter?");sI(t)?(t.levels.forEach(n=>PO(n,e)),_ve(t.levels)):PO(t,e)}function PO(t,e){if(!t.width||!t.cols||!t.rows)throw new jn("Invalid panorama configuration, are you using the right adapter?");if(t.cols>e.SPHERE_SEGMENTS)throw new jn(`Panorama cols must not be greater than ${e.SPHERE_SEGMENTS}.`);if(t.rows>e.SPHERE_HORIZONTAL_SEGMENTS)throw new jn(`Panorama rows must not be greater than ${e.SPHERE_HORIZONTAL_SEGMENTS}.`);if(!Gr.isPowerOfTwo(t.cols)||!Gr.isPowerOfTwo(t.rows))throw new jn("Panorama cols and rows must be powers of 2.")}function Eve(t,e){for(let n=0;n<e.cols;n++){const r=t.tileUrl(n,e.rows/2,e.level);if(r)return r}return t.tileUrl.toString()}var _0=6,Wa=3,Tve="uv",Pve="position",AO=-1;function s2(t){return`${t.col}x${t.row}/${t.config.level}`}function Ob(t){return t.children}var Ave=Qn.getConfigParser({resolution:64,showErrorTile:!0,baseBlur:!0,antialias:!0,debug:!1,useXmpData:!1}),Fb=new Pt,cS=class n$ extends sS{constructor(e,n){super(e),this.state={tileConfig:null,tiles:{},faces:{},geom:null,materials:[],errorMaterial:null,inTransition:!1},this.queue=new yve,this.config=Ave(n),this.adapter=new tI(this.viewer,{resolution:this.config.resolution,blur:this.config.baseBlur}),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2,this.NB_VERTICES=2*this.SPHERE_SEGMENTS*Wa+(this.SPHERE_HORIZONTAL_SEGMENTS-2)*this.SPHERE_SEGMENTS*_0,this.NB_GROUPS=this.SPHERE_SEGMENTS*this.SPHERE_HORIZONTAL_SEGMENTS,this.viewer.config.requestHeaders&&Qn.logWarn('EquirectangularTilesAdapter fallbacks to file loader because "requestHeaders" where provided. Consider removing "requestHeaders" if you experience performances issues.')}static withConfig(e){return[n$,e]}init(){super.init(),this.viewer.addEventListener(nr.TransitionDoneEvent.type,this),this.viewer.addEventListener(nr.PositionUpdatedEvent.type,this),this.viewer.addEventListener(nr.ZoomUpdatedEvent.type,this)}destroy(){this.viewer.removeEventListener(nr.TransitionDoneEvent.type,this),this.viewer.removeEventListener(nr.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(nr.ZoomUpdatedEvent.type,this),this.__cleanup(),this.state.errorMaterial?.map?.dispose(),this.state.errorMaterial?.dispose(),this.adapter.destroy(),delete this.adapter,delete this.state.geom,delete this.state.errorMaterial,super.destroy()}handleEvent(e){switch(e.type){case nr.PositionUpdatedEvent.type:case nr.ZoomUpdatedEvent.type:this.__refresh();break;case nr.TransitionDoneEvent.type:this.state.inTransition=!1,e.completed&&this.__switchMesh(this.viewer.renderer.mesh);break}}supportsTransition(e){return!!e.baseUrl}supportsPreload(e){return!!e.baseUrl}textureCoordsToSphericalCoords(e,n){return this.adapter.textureCoordsToSphericalCoords(e,n)}sphericalCoordsToTextureCoords(e,n){return this.adapter.sphericalCoordsToTextureCoords(e,n)}async loadTexture(e,n=!0){Cve(e,this);const r=TO(e,0,this),o={isEquirectangular:!0,fullWidth:r.width,fullHeight:r.width/2,croppedWidth:r.width,croppedHeight:r.width/2,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0};if(e.baseUrl){const l=await this.adapter.loadTexture(e.baseUrl,n,e.basePanoData,!0);return{panorama:e,panoData:{...o,baseData:l.panoData},cacheKey:l.cacheKey,texture:l.texture}}else return{panorama:e,panoData:{...o,baseData:null},cacheKey:Eve(e,r),texture:null}}createMesh(e){const n=this.adapter.createMesh(e.baseData??e),r=new my(oy.SPHERE_RADIUS,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1).toNonIndexed();r.clearGroups();let o=0,l=0;for(;o<this.SPHERE_SEGMENTS*Wa;o+=Wa)r.addGroup(o,Wa,l++);for(;o<this.NB_VERTICES-this.SPHERE_SEGMENTS*Wa;o+=_0)r.addGroup(o,_0,l++);for(;o<this.NB_VERTICES;o+=Wa)r.addGroup(o,Wa,l++);const c=[],s=new dp({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1});for(let b=0;b<this.NB_GROUPS;b++)c.push(s);const m=new Ja(r,c);m.renderOrder=1;const y=new Yf;return y.add(n),y.add(m),y}setTexture(e,n,r){const[o]=Ob(e);n.texture?this.adapter.setTexture(o,{panorama:n.panorama.baseUrl,texture:n.texture,panoData:n.panoData.baseData}):o.visible=!1,r?this.state.inTransition=!0:this.__switchMesh(e)}setTextureOpacity(e,n){const[r]=Ob(e);this.adapter.setTextureOpacity(r,n)}disposeTexture({texture:e}){e?.dispose()}disposeMesh(e){const[n,r]=Ob(e);n.geometry.dispose(),n.material.dispose(),r.geometry.dispose(),r.material.forEach(o=>{o.map?.dispose(),o.dispose()})}__refresh(){if(!this.state.geom||this.state.inTransition)return;const e=this.viewer.config.panorama,n=this.viewer.getZoomLevel(),r=TO(e,n,this),o=this.state.geom.getAttribute(Pve),l={};for(let c=0;c<this.NB_VERTICES;c+=1)if(Fb.fromBufferAttribute(o,c),Fb.applyEuler(this.viewer.renderer.sphereCorrection),this.viewer.renderer.isObjectVisible(Fb)){let s;c<this.SPHERE_SEGMENTS*Wa?s=Math.floor(c/3):c<this.NB_VERTICES-this.SPHERE_SEGMENTS*Wa?s=Math.floor((c/3-this.SPHERE_SEGMENTS)/2)+this.SPHERE_SEGMENTS:s=Math.floor((c-this.NB_VERTICES-this.SPHERE_SEGMENTS*Wa)/3)+this.SPHERE_HORIZONTAL_SEGMENTS*(this.SPHERE_SEGMENTS-1);const m=Math.floor(s/this.SPHERE_SEGMENTS),y=s-m*this.SPHERE_SEGMENTS;let b=r;for(;b;){const w=Math.floor(m/b.facesByRow),E=Math.floor(y/b.facesByCol);let T=Fb.angleTo(this.viewer.state.direction);(w===0||w===b.rows-1)&&(T*=2);const R={row:w,col:E,angle:T,config:b,url:null},z=s2(R);if(l[z]){l[z].angle=Math.min(l[z].angle,T);break}else if(R.url=e.tileUrl(E,w,b.level),R.url){l[z]=R;break}else b=Mve(e,b.level-1,this)}}this.state.tileConfig=r,this.__loadTiles(Object.values(l))}__loadTiles(e){this.queue.disableAllTasks(),e.forEach(n=>{const r=s2(n);this.state.tiles[r]?this.queue.setPriority(r,n.angle):(this.state.tiles[r]=!0,this.queue.enqueue(new vve(r,n.angle,o=>this.__loadTile(n,o))))}),this.queue.start()}__loadTile(e,n){return this.viewer.textureLoader.loadImage(e.url,null,this.viewer.state.textureData.cacheKey).then(r=>{if(!n.isCancelled()){this.config.debug&&(r=Sve(r,e.config.level,s2(e)));const o=this.config.antialias&&e.config.level>0,l=new dp({map:Qn.createTexture(r,o)});this.__swapMaterial(e,l,!1),this.viewer.needsUpdate()}}).catch(r=>{!Qn.isAbortError(r)&&!n.isCancelled()&&this.config.showErrorTile&&(this.state.errorMaterial||(this.state.errorMaterial=bve()),this.__swapMaterial(e,this.state.errorMaterial,!0),this.viewer.needsUpdate())})}__swapMaterial(e,n,r){const o=this.state.geom.getAttribute(Tve);for(let l=0;l<e.config.facesByCol;l++)for(let c=0;c<e.config.facesByRow;c++){const s=e.col*e.config.facesByCol+l,m=e.row*e.config.facesByRow+c,y=m===0,b=m===this.SPHERE_HORIZONTAL_SEGMENTS-1;let w;if(y?w=s*Wa:b?w=this.NB_VERTICES-this.SPHERE_SEGMENTS*Wa+s*Wa:w=this.SPHERE_SEGMENTS*Wa+(m-1)*this.SPHERE_SEGMENTS*_0+s*_0,r&&this.state.faces[w]>AO||this.state.faces[w]>e.config.level)continue;this.state.faces[w]=r?AO:e.config.level;const E=this.state.geom.groups.find(L=>L.start===w).materialIndex;this.state.materials[E]=n;const T=1-c/e.config.facesByRow,R=1-(c+1)/e.config.facesByRow,z=l/e.config.facesByCol,I=(l+1)/e.config.facesByCol;y?(o.setXY(w,(z+I)/2,T),o.setXY(w+1,z,R),o.setXY(w+2,I,R)):b?(o.setXY(w,I,T),o.setXY(w+1,z,T),o.setXY(w+2,(z+I)/2,R)):(o.setXY(w,I,T),o.setXY(w+1,z,T),o.setXY(w+2,I,R),o.setXY(w+3,z,T),o.setXY(w+4,z,R),o.setXY(w+5,I,R))}o.needsUpdate=!0}__switchMesh(e){const[,n]=Ob(e);if(this.__cleanup(),this.state.materials=n.material,this.state.geom=n.geometry,this.config.debug){const r=wve(this.state.geom);this.viewer.renderer.addObject(r),this.viewer.renderer.setSphereCorrection(this.viewer.config.sphereCorrection,r)}setTimeout(()=>this.__refresh())}__cleanup(){this.queue.clear(),this.state.tiles={},this.state.faces={},this.state.materials=[],this.state.inTransition=!1}};cS.id="equirectangular-tiles";cS.VERSION="5.13.4";cS.supportsDownload=!1;var r$=cS;/*!
 * Photo Sphere Viewer / Virtual Tour Plugin 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var Ive=Object.defineProperty,Rve=(t,e)=>{for(var n in e)Ive(t,n,{get:e[n],enumerable:!0})},Lve={};Rve(Lve,{EnterArrowEvent:()=>c$,LeaveArrowEvent:()=>d$,NodeChangedEvent:()=>s$});var i$=class o$ extends dx{constructor(e,n){super(o$.type),this.node=e,this.data=n}};i$.type="node-changed";var s$=i$,a$=class l$ extends dx{constructor(e,n){super(l$.type),this.link=e,this.node=n}};a$.type="enter-arrow";var c$=a$,u$=class h$ extends dx{constructor(e,n){super(h$.type),this.link=e,this.node=n}};u$.type="leave-arrow";var d$=u$,Dve=class extends Zs{constructor(t=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new mi(.5,.5),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&e.element.parentNode!==null&&e.element.remove()})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this.center=t.center,this}},hv=new Pt,IO=new Ti,RO=new Ti,LO=new Pt,DO=new Pt,kve=class{constructor(t={}){const e=this;let n,r,o,l;const c={objects:new WeakMap},s=t.element!==void 0?t.element:document.createElement("div");s.style.overflow="hidden",this.domElement=s,this.getSize=function(){return{width:n,height:r}},this.render=function(T,R){T.matrixWorldAutoUpdate===!0&&T.updateMatrixWorld(),R.parent===null&&R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld(),IO.copy(R.matrixWorldInverse),RO.multiplyMatrices(R.projectionMatrix,IO),y(T,T,R),E(T)},this.setSize=function(T,R){n=T,r=R,o=n/2,l=r/2,s.style.width=T+"px",s.style.height=R+"px"};function m(T){T.isCSS2DObject&&(T.element.style.display="none");for(let R=0,z=T.children.length;R<z;R++)m(T.children[R])}function y(T,R,z){if(T.visible===!1){m(T);return}if(T.isCSS2DObject){hv.setFromMatrixPosition(T.matrixWorld),hv.applyMatrix4(RO);const I=hv.z>=-1&&hv.z<=1&&T.layers.test(z.layers)===!0,L=T.element;L.style.display=I===!0?"":"none",I===!0&&(T.onBeforeRender(e,R,z),L.style.transform="translate("+-100*T.center.x+"%,"+-100*T.center.y+"%)translate("+(hv.x*o+o)+"px,"+(-hv.y*l+l)+"px)",L.parentNode!==s&&s.appendChild(L),T.onAfterRender(e,R,z));const V={distanceToCameraSquared:b(z,T)};c.objects.set(T,V)}for(let I=0,L=T.children.length;I<L;I++)y(T.children[I],R,z)}function b(T,R){return LO.setFromMatrixPosition(T.matrixWorld),DO.setFromMatrixPosition(R.matrixWorld),LO.distanceToSquared(DO)}function w(T){const R=[];return T.traverseVisible(function(z){z.isCSS2DObject&&R.push(z)}),R}function E(T){const R=w(T).sort(function(I,L){if(I.renderOrder!==L.renderOrder)return L.renderOrder-I.renderOrder;const V=c.objects.get(I).distanceToCameraSquared,B=c.objects.get(L).distanceToCameraSquared;return V-B}),z=R.length;for(let I=0,L=R.length;I<L;I++)R[I].element.style.zIndex=z-I}}},kO=new Pt,zve=new Sp,zO=new Pt,Ove=class extends Zs{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof n.element.ownerDocument.defaultView.Element&&n.element.parentNode!==null&&n.element.remove()})})}copy(e,n){return super.copy(e,n),this.element=e.element.cloneNode(!0),this}},fh=new Ti,Fve=new Ti,Nve=class{constructor(e={}){const n=this;let r,o,l,c;const s={camera:{style:""},objects:new WeakMap},m=e.element!==void 0?e.element:document.createElement("div");m.style.overflow="hidden",this.domElement=m;const y=document.createElement("div");y.style.transformOrigin="0 0",y.style.pointerEvents="none",m.appendChild(y);const b=document.createElement("div");b.style.transformStyle="preserve-3d",y.appendChild(b),this.getSize=function(){return{width:r,height:o}},this.render=function(I,L){const V=L.projectionMatrix.elements[5]*c;L.view&&L.view.enabled?(y.style.transform=`translate( ${-L.view.offsetX*(r/L.view.width)}px, ${-L.view.offsetY*(o/L.view.height)}px )`,y.style.transform+=`scale( ${L.view.fullWidth/L.view.width}, ${L.view.fullHeight/L.view.height} )`):y.style.transform="",I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld(),L.parent===null&&L.matrixWorldAutoUpdate===!0&&L.updateMatrixWorld();let B,W;L.isOrthographicCamera&&(B=-(L.right+L.left)/2,W=(L.top+L.bottom)/2);const X=L.view&&L.view.enabled?L.view.height/L.view.fullHeight:1,q=L.isOrthographicCamera?`scale( ${X} )scale(`+V+")translate("+w(B)+"px,"+w(W)+"px)"+E(L.matrixWorldInverse):`scale( ${X} )translateZ(`+V+"px)"+E(L.matrixWorldInverse),se=(L.isPerspectiveCamera?"perspective("+V+"px) ":"")+q+"translate("+l+"px,"+c+"px)";s.camera.style!==se&&(b.style.transform=se,s.camera.style=se),z(I,I,L)},this.setSize=function(I,L){r=I,o=L,l=r/2,c=o/2,m.style.width=I+"px",m.style.height=L+"px",y.style.width=I+"px",y.style.height=L+"px",b.style.width=I+"px",b.style.height=L+"px"};function w(I){return Math.abs(I)<1e-10?0:I}function E(I){const L=I.elements;return"matrix3d("+w(L[0])+","+w(-L[1])+","+w(L[2])+","+w(L[3])+","+w(L[4])+","+w(-L[5])+","+w(L[6])+","+w(L[7])+","+w(L[8])+","+w(-L[9])+","+w(L[10])+","+w(L[11])+","+w(L[12])+","+w(-L[13])+","+w(L[14])+","+w(L[15])+")"}function T(I){const L=I.elements;return"translate(-50%,-50%)"+("matrix3d("+w(L[0])+","+w(L[1])+","+w(L[2])+","+w(L[3])+","+w(-L[4])+","+w(-L[5])+","+w(-L[6])+","+w(-L[7])+","+w(L[8])+","+w(L[9])+","+w(L[10])+","+w(L[11])+","+w(L[12])+","+w(L[13])+","+w(L[14])+","+w(L[15])+")")}function R(I){I.isCSS3DObject&&(I.element.style.display="none");for(let L=0,V=I.children.length;L<V;L++)R(I.children[L])}function z(I,L,V,B){if(I.visible===!1){R(I);return}if(I.isCSS3DObject){const W=I.layers.test(V.layers)===!0,X=I.element;if(X.style.display=W===!0?"":"none",W===!0){I.onBeforeRender(n,L,V);let q;I.isCSS3DSprite?(fh.copy(V.matrixWorldInverse),fh.transpose(),I.rotation2D!==0&&fh.multiply(Fve.makeRotationZ(I.rotation2D)),I.matrixWorld.decompose(kO,zve,zO),fh.setPosition(kO),fh.scale(zO),fh.elements[3]=0,fh.elements[7]=0,fh.elements[11]=0,fh.elements[15]=1,q=T(fh)):q=T(I.matrixWorld);const te=s.objects.get(I);if(te===void 0||te.style!==q){X.style.transform=q;const se={style:q};s.objects.set(I,se)}X.parentNode!==b&&b.appendChild(X),I.onAfterRender(n,L,V)}}for(let W=0,X=I.children.length;W<X;W++)z(I.children[W],L,V)}}},Bve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
    <path fill-rule="even-odd" fill="currentColor" d="
        M50,50 m45,0
        a45,45 0 1,0 -90,0
        a45,45 0 1,0  90,0

        M50,50 m38,0
        a38,38 0 0,1 -76,0
        a38,38 0 0,1  76,0

        M50,50 m30,0
        a30,30 0 1,0 -60,0
        a30,30 0 1,0  60,0
        
        M50,40 m2.5,-2.5
        l17.5,17.5
        a 2.5,2.5 0 0 1 -5,5
        l-15,-15
        l-15,15
        a 2.5,2.5 0 0 1 -5,-5
        l17.5,-17.5
        a 3.5,3.5 0 0 1 5,0
    "/>
</svg>`,Q1="tourLink",dv="__tour-link__",Uve={className:"psv-virtual-tour-tooltip",content:'<div class="psv-virtual-tour-loader"><div></div><div></div><div></div></div>'},$ve={element:()=>{const t=document.createElement("button");return t.className="psv-virtual-tour-arrow",t.innerHTML=Bve,t},size:{width:80,height:80}},a2="arrow",Vve=class extends Mp{constructor(t,e){super(t,{className:"psv-virtual-tour-arrows"}),this.plugin=e,this.renderer=this.is3D?new Nve({element:this.container}):new kve({element:this.container}),this.camera=this.is3D?new Fl(30,1):null,this.scene=new H1,this.viewer.addEventListener(nr.ReadyEvent.type,this,{once:!0}),this.viewer.addEventListener(nr.PositionUpdatedEvent.type,this),this.viewer.addEventListener(nr.SizeUpdatedEvent.type,this),this.viewer.addEventListener(nr.RenderEvent.type,this),this.viewer.addEventListener(nr.ClickEvent.type,this),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("contextmenu",n=>n.preventDefault())}get is3D(){return this.plugin.is3D}get arrowsPosition(){return this.plugin.config.arrowsPosition}get arrowStyle(){return this.plugin.config.arrowStyle}init(){this.is3D&&(this.gallery=this.viewer.getPlugin("gallery"),this.gallery?.addEventListener("show-gallery",this),this.gallery?.addEventListener("hide-gallery",this))}destroy(){this.viewer.removeEventListener(nr.ReadyEvent.type,this),this.viewer.removeEventListener(nr.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(nr.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(nr.RenderEvent.type,this),this.viewer.removeEventListener(nr.ClickEvent.type,this),this.gallery?.removeEventListener("show-gallery",this),this.gallery?.removeEventListener("hide-gallery",this),super.destroy()}handleEvent(t){switch(t.type){case nr.ReadyEvent.type:case nr.SizeUpdatedEvent.type:case nr.PositionUpdatedEvent.type:this.__updateCamera();break;case nr.RenderEvent.type:this.render();break;case nr.ClickEvent.type:{if(t.data.rightclick)break;const e=this.__getTargetLink(t.data.target,!0);e&&this.plugin.setCurrentNode(e.nodeId,null,e);break}case"mouseenter":{const e=this.__getTargetLink(Qn.getEventTarget(t));e&&this.plugin.__onEnterArrow(e,t);break}case"mouseleave":{const e=this.__getTargetLink(Qn.getEventTarget(t));e&&this.plugin.__onLeaveArrow(e);break}case"mousemove":{this.__getTargetLink(Qn.getEventTarget(t),!0)&&this.plugin.__onHoverArrow(t);break}case"hide-gallery":this.__onToggleGallery(!1);break;case"show-gallery":t.fullscreen||this.__onToggleGallery(!0);break}}__updateCamera(){const t=this.viewer.getSize();if(this.renderer.setSize(t.width,t.height),this.is3D){const e=this.viewer.getPosition();e.pitch=Gr.clamp(e.pitch,-this.arrowsPosition.maxPitch,-this.arrowsPosition.minPitch),this.viewer.dataHelper.sphericalCoordsToVector3(e,this.camera.position,t.height*2).negate(),this.camera.lookAt(0,0,0),this.camera.translateY(t.height/3),this.camera.updateProjectionMatrix()}}render(){if(this.is3D){const t=this.viewer.getPosition(),e=[];let n=Number.MAX_SAFE_INTEGER;this.scene.children.forEach(r=>{const o=r.userData[a2];if(o.conflict){const l=Math.abs(Qn.getShortestArc(t.yaw,o.yaw));n=Math.min(n,l),e.push([r,l])}}),e.forEach(([r,o])=>{const l=o!==n;r.element.style.opacity=l?"0.5":null,r.element.style.zIndex=l?"-1":null}),this.renderer.render(this.scene,this.camera)}else this.renderer.render(this.scene,this.viewer.renderer.camera)}clear(){this.scene.clear()}__buildArrowElement(t,e){if(e?.image){const n=document.createElement("img");return n.src=e.image,n}else if(e?.element)return typeof e.element=="function"?e.element(t):e.element}addLinkArrow(t,e,n=1){let r=this.__buildArrowElement(t,t.arrowStyle);r||(r=this.__buildArrowElement(t,this.arrowStyle)),r[Q1]=t;const o={...this.arrowStyle,...t.arrowStyle};if(r.classList.add("psv-virtual-tour-link"),o.className&&Qn.addClasses(r,o.className),o.style&&Object.assign(r.style,o.style),this.is3D){r.style.width=o.size.width*1.5+"px",r.style.height=o.size.height*1.5+"px";let l=!1;this.scene.children.forEach(s=>{const m=s.userData[a2];Math.abs(Qn.getShortestArc(m.yaw,e.yaw))<this.arrowsPosition.linkOverlapAngle&&(m.conflict=!0,l=!0)});const c=new Ove(r);c.userData[a2]={yaw:e.yaw,conflict:l},c.rotation.set(-Math.PI/2,0,Math.PI-e.yaw),this.viewer.dataHelper.sphericalCoordsToVector3({yaw:e.yaw,pitch:0},c.position,n*100),this.scene.add(c)}else{r.style.width=o.size.width+"px",r.style.height=o.size.height+"px",r.style.pointerEvents="auto";const l=new Dve(r);this.viewer.dataHelper.sphericalCoordsToVector3(e,l.position),this.scene.add(l)}}__getTargetLink(t,e=!1){const n=e?Qn.getClosest(t,".psv-virtual-tour-link"):t;return n?n[Q1]:void 0}__onToggleGallery(t){t?this.container.style.marginBottom=this.viewer.container.querySelector(".psv-gallery").offsetHeight+"px":this.container.style.marginBottom=""}},f$=class{constructor(t,e){this.plugin=t,this.viewer=e,this.nodes={}}destroy(){}checkNode(t){if(!t.id)throw new jn("No id given for node");if(!t.panorama)throw new jn(`No panorama provided for node ${t.id}`);if(this.plugin.isGps&&!(t.gps?.length>=2))throw new jn(`No GPS position provided for node ${t.id}`);if(!this.plugin.isGps&&t.markers?.some(e=>e.gps&&!e.position))throw new jn("Cannot use GPS positioning for markers in manual mode");t.links||(Qn.logWarn(`Node ${t.id} has no links`),t.links=[])}checkLink(t,e){if(!e.nodeId)throw new jn(`Link of node ${t.id} has no target id`);if(e.nodeId===t.id)throw new jn(`Node ${t.id} links to itself`);if(!this.plugin.isGps&&!Qn.isExtendedPosition(e.position))throw new jn(`No position provided for link ${e.nodeId} of node ${t.id}`);if(this.plugin.isGps&&!e.gps)throw new jn(`No GPS position provided for link ${e.nodeId} of node ${t.id}`)}},jve=class extends f${async loadNode(t){if(this.nodes[t])return this.nodes[t];throw new jn(`Node ${t} not found`)}setNodes(t){if(!t?.length)throw new jn("No nodes provided");const e={},n={};t.forEach(r=>{if(this.checkNode(r),e[r.id])throw new jn(`Duplicate node ${r.id}`);e[r.id]=r}),t.forEach(r=>{this.__checkLinks(r,e),r.links.forEach(o=>{n[o.nodeId]=!0})}),t.forEach(r=>{n[r.id]||Qn.logWarn(`Node ${r.id} is never linked to`)}),this.nodes=e}updateNode(t){if(!t.id)throw new jn("No id given for node");const e=this.nodes[t.id];if(!e)throw new jn(`Node ${t.id} does not exist`);return Object.assign(e,t),this.checkNode(e),this.__checkLinks(e,this.nodes),e}__checkLinks(t,e){t.links.forEach(n=>{if(!e[n.nodeId])throw new jn(`Target node ${n.nodeId} of node ${t.id} does not exists`);n.gps=n.gps||e[n.nodeId].gps,this.checkLink(t,n)})}},Hve=class extends f${constructor(t,e){if(super(t,e),!t.config.getNode)throw new jn("Missing getNode() option.");this.nodeResolver=t.config.getNode}async loadNode(t){if(this.nodes[t])return this.nodes[t];{const e=await this.nodeResolver(t);return this.checkNode(e),e.links.forEach(n=>{this.checkLink(e,n)}),this.nodes[t]=e,e}}clearCache(){this.nodes={}}};function OO(t,e){const n=FO(t),r=FO(e),o=t[2]??0,l=e[2]??0;let c=0;return o!==l&&(c=Math.atan((l-o)/Gve(n,r))),{yaw:Wve(n,r),pitch:c}}function FO(t){return[Gr.degToRad(t[0]),Gr.degToRad(t[1])]}function Gve(t,e){return Qn.greatArcDistance(t,e)*6371e3}function Wve(t,e){const[n,r]=t,[o,l]=e,c=Math.sin(o-n)*Math.cos(l),s=Math.cos(r)*Math.sin(l)-Math.sin(r)*Math.cos(l)*Math.cos(o-n);return Math.atan2(c,s)}var aI=Qn.getConfigParser({dataMode:"client",positionMode:"manual",renderMode:"3d",nodes:null,getNode:null,startNodeId:null,preload:!1,transitionOptions:{showLoader:!0,speed:"20rpm",effect:"fade",rotation:!0},linksOnCompass:!0,showLinkTooltip:!0,getLinkTooltip:null,arrowStyle:$ve,arrowsPosition:{minPitch:.3,maxPitch:Math.PI/2,linkOverlapAngle:Math.PI/4,linkPitchOffset:-.1},map:null},{dataMode(t){if(t!=="client"&&t!=="server")throw new jn("VirtualTourPlugin: invalid dataMode");return t},positionMode(t){if(t!=="gps"&&t!=="manual")throw new jn("VirtualTourPlugin: invalid positionMode");return t},renderMode(t){if(t!=="3d"&&t!=="2d")throw new jn("VirtualTourPlugin: invalid renderMode");return t},arrowsPosition(t,{defValue:e}){return{...e,...t}},arrowStyle(t,{defValue:e}){return{...e,...t}},map(t,{rawConfig:e}){if(t){if(e.dataMode==="server")return Qn.logWarn("VirtualTourPlugin: The map cannot be used in server side mode"),null;if(!t.imageUrl)return Qn.logWarn('VirtualTourPlugin: configuring the map requires at least "imageUrl"'),null}return t}}),mx=class p$ extends iI{constructor(e,n){super(e,n),this.state={currentNode:null,currentTooltip:null,loadingNode:null,preload:{}},this.arrowsRenderer=new Vve(this.viewer,this)}get is3D(){return this.config.renderMode==="3d"}get isServerSide(){return this.config.dataMode==="server"}get isGps(){return this.config.positionMode==="gps"}static withConfig(e){return[p$,e]}init(){super.init(),this.arrowsRenderer.init(),Qn.checkStylesheet(this.viewer.container,"virtual-tour-plugin"),this.markers=this.viewer.getPlugin("markers"),this.compass=this.viewer.getPlugin("compass"),this.markers?.config.markers&&(Qn.logWarn("No default markers can be configured on the MarkersPlugin when using the VirtualTourPlugin. Consider defining `markers` on each tour node."),delete this.markers.config.markers),this.isGps&&(this.plan=this.viewer.getPlugin("plan")),this.isServerSide||(this.gallery=this.viewer.getPlugin("gallery"),this.map=this.viewer.getPlugin("map"),this.config.map&&!this.map&&Qn.logWarn("The map is configured on the VirtualTourPlugin but the MapPlugin is not loaded.")),this.datasource=this.isServerSide?new Hve(this,this.viewer):new jve(this,this.viewer),this.map&&(this.map.addEventListener("select-hotspot",this),this.map.setImage(this.config.map.imageUrl)),this.plan?.addEventListener("select-hotspot",this),this.isServerSide?this.config.startNodeId&&this.setCurrentNode(this.config.startNodeId):this.config.nodes&&(this.setNodes(this.config.nodes,this.config.startNodeId),delete this.config.nodes)}destroy(){this.map?.removeEventListener("select-hotspot",this),this.plan?.removeEventListener("select-hotspot",this),this.datasource.destroy(),this.arrowsRenderer.destroy(),delete this.datasource,delete this.markers,delete this.compass,delete this.gallery,delete this.arrowsRenderer,super.destroy()}handleEvent(e){if(e instanceof nr.ClickEvent){const n=e.data.objects.find(r=>r.userData[Q1])?.userData[Q1];n&&this.setCurrentNode(n.nodeId,null,n)}else if(e.type==="select-hotspot"){const n=e.hotspotId;n.startsWith(dv)&&this.setCurrentNode(n.substring(dv.length))}}getCurrentNode(){return this.state.currentNode}setNodes(e,n){if(this.isServerSide)throw new jn("Cannot set nodes in server side mode");this.__hideTooltip(),this.state.currentNode=null,this.datasource.setNodes(e),n?this.datasource.nodes[n]||(n=e[0].id,Qn.logWarn(`startNodeId not found is provided nodes, resetted to ${n}`)):n=e[0].id,this.setCurrentNode(n),this.__setGalleryItems(),this.__setMapHotspots(),this.__setPlanHotspots()}setCurrentNode(e,n,r){if(e===this.state.currentNode?.id&&!n?.forceUpdate)return Promise.resolve(!0);n?.forceUpdate&&this.isServerSide&&this.datasource.clearCache(),this.viewer.hideError(),this.state.loadingNode=e;const o=this.state.currentNode,l=o&&r?this.__getLinkPosition(o,r):null;return Promise.resolve(this.state.preload[e]).then(()=>{if(this.state.loadingNode!==e)throw Qn.getAbortError();return this.datasource.loadNode(e)}).then(c=>{if(this.state.loadingNode!==e)throw Qn.getAbortError();const s={...aI.defaults.transitionOptions,rotateTo:l,zoomTo:l?this.viewer.getZoomLevel():null,...typeof this.config.transitionOptions=="function"?this.config.transitionOptions(c,o,r):this.config.transitionOptions,...n};return s.effect||(s.effect="none"),this.viewer.panel.hide("description"),this.__hideTooltip(),this.arrowsRenderer.clear(),this.gallery?.config.hideOnClick&&this.gallery.hide(),this.map?.config.minimizeOnHotspotClick&&this.map.minimize(),this.plan?.config.minimizeOnHotspotClick&&this.plan.minimize(),s.rotation&&s.effect==="none"?this.viewer.animate({...s.rotateTo,zoom:s.zoomTo,speed:s.speed}).then(()=>[c,s]):Promise.resolve([c,s])}).then(([c,s])=>{if(this.state.loadingNode!==e)throw Qn.getAbortError();return this.markers?.clearMarkers(),this.config.linksOnCompass&&this.compass?.clearHotspots(),this.viewer.setPanorama(c.panorama,{caption:c.caption,description:c.description,panoData:c.panoData,sphereCorrection:c.sphereCorrection,showLoader:s.showLoader,position:s.rotateTo,zoom:s.zoomTo,transition:s.effect==="none"?!1:{effect:s.effect,rotation:s.rotation,speed:s.speed}}).then(m=>{if(!m)throw Qn.getAbortError();return c})}).then(c=>{if(this.state.loadingNode!==e)throw Qn.getAbortError();return this.state.currentNode=c,this.map&&this.map.setCenter(this.__getNodeMapPosition(c)??this.map.config.center),this.plan?.setCoordinates(c.gps),this.__addNodeMarkers(c),this.__renderLinks(c),this.__preload(c),this.state.loadingNode=null,this.dispatchEvent(new s$(c,{fromNode:o,fromLink:r,fromLinkPosition:l})),this.viewer.resetIdleTimer(),!0}).catch(c=>{if(Qn.isAbortError(c))return!1;throw this.viewer.showError(this.viewer.config.lang.loadError),this.viewer.loader.hide(),this.viewer.navbar.setCaption(""),this.state.loadingNode=null,c})}async gotoLink(e,n="8rpm"){const r=this.getLinkPosition(e);n?await this.viewer.animate({...r,speed:n}):this.viewer.rotate(r)}getLinkPosition(e){const n=this.state.currentNode?.links.find(r=>r.nodeId===e);if(!n)throw new jn(`Cannot find link "${e}"`);return this.__getLinkPosition(this.state.currentNode,n)}updateNode(e){if(this.isServerSide)throw new jn("Cannot update node in server side mode");const n=this.datasource.updateNode(e);if((e.name||e.thumbnail||e.panorama)&&this.__setGalleryItems(),(e.name||e.gps||e.map)&&this.__setMapHotspots(),(e.name||e.gps||e.plan)&&this.__setPlanHotspots(),this.state.currentNode?.id===n.id){if(this.__hideTooltip(),e.panorama||e.panoData||e.sphereCorrection){this.setCurrentNode(n.id,{forceUpdate:!0});return}e.caption&&this.viewer.setOption("caption",n.caption),e.description&&this.viewer.setOption("description",n.description),(e.links||e.gps)&&this.__renderLinks(n),e.gps&&this.plan?.setCoordinates(n.gps),(e.map||e.gps)&&this.map?.setCenter(this.__getNodeMapPosition(n)),(e.markers||e.gps)&&this.__addNodeMarkers(n)}}__setGalleryItems(){this.gallery&&this.gallery.setItems(Object.values(this.datasource.nodes).filter(e=>e.showInGallery!==!1).map(e=>({id:e.id,panorama:e.panorama,name:e.name,thumbnail:e.thumbnail})),e=>{this.setCurrentNode(e)})}__setMapHotspots(){this.map&&this.map.setHotspots(Object.values(this.datasource.nodes).filter(e=>e.map!==!1).map(e=>({tooltip:e.name,...e.map||{},...this.__getNodeMapPosition(e),id:dv+e.id})))}__setPlanHotspots(){this.plan&&this.plan.setHotspots(Object.values(this.datasource.nodes).filter(e=>e.plan!==!1).map(e=>({tooltip:e.name,...e.plan||{},coordinates:e.gps,id:dv+e.id})))}__renderLinks(e){this.arrowsRenderer.clear();const n=[];e.links.forEach(r=>{const o=this.__getLinkPosition(e,r);o.yaw+=r.linkOffset?.yaw??0,o.pitch+=r.linkOffset?.pitch??0,this.isGps&&!this.is3D&&(o.pitch+=this.config.arrowsPosition.linkPitchOffset),n.push(o),this.arrowsRenderer.addLinkArrow(r,o,r.linkOffset?.depth)}),this.arrowsRenderer.render(),this.config.linksOnCompass&&this.compass?.setHotspots(n)}__getLinkPosition(e,n){return this.isGps?OO(e.gps,n.gps):this.viewer.dataHelper.cleanPosition(n.position)}async __getTooltipContent(e){const n=await this.datasource.loadNode(e.nodeId),r=[];(n.name||n.thumbnail||n.caption)&&(n.name&&r.push(`<h3>${n.name}</h3>`),n.thumbnail&&r.push(`<img src="${n.thumbnail}">`),n.caption&&r.push(`<p>${n.caption}</p>`));let o=r.join("");return this.config.getLinkTooltip&&(o=this.config.getLinkTooltip(o,e,n)),o}__onEnterArrow(e,n){const r=Qn.getPosition(this.viewer.container),o={x:n.clientX-r.x,y:n.clientY-r.y};this.config.showLinkTooltip&&(this.state.currentTooltip=this.viewer.createTooltip({...Uve,left:o.x,top:o.y,box:{width:20,height:20}}),this.__getTooltipContent(e).then(l=>{l?this.state.currentTooltip.update(l):this.__hideTooltip()})),this.map?.setActiveHotspot(dv+e.nodeId),this.plan?.setActiveHotspot(dv+e.nodeId),this.dispatchEvent(new c$(e,this.state.currentNode))}__onHoverArrow(e){const n=Qn.getPosition(this.viewer.container),r={x:e.clientX-n.x,y:e.clientY-n.y};this.state.currentTooltip?.move({left:r.x,top:r.y})}__onLeaveArrow(e){this.__hideTooltip(),this.map?.setActiveHotspot(null),this.plan?.setActiveHotspot(null),this.dispatchEvent(new d$(e,this.state.currentNode))}__hideTooltip(){this.state.currentTooltip?.hide(),this.state.currentTooltip=null}__preload(e){this.config.preload&&(this.state.preload[e.id]=!0,this.state.currentNode.links.filter(n=>!this.state.preload[n.nodeId]).filter(n=>typeof this.config.preload=="function"?this.config.preload(this.state.currentNode,n):!0).forEach(n=>{this.state.preload[n.nodeId]=this.datasource.loadNode(n.nodeId).then(r=>this.viewer.textureLoader.preloadPanorama(r.panorama)).then(()=>{this.state.preload[n.nodeId]=!0}).catch(()=>{delete this.state.preload[n.nodeId]})}))}__addNodeMarkers(e){e.markers&&(this.markers?this.markers.setMarkers(e.markers.map(n=>(n.gps&&this.isGps&&(n.position=OO(e.gps,n.gps),n.data?.map&&Object.assign(n.data.map,this.__getGpsMapPosition(n.gps)),n.data?.plan&&(n.data.plan.coordinates=n.gps)),n))):Qn.logWarn(`Node ${e.id} markers ignored because the plugin is not loaded.`))}__getNodeMapPosition(e){const n=this.__getGpsMapPosition(e.gps);return n||(e.map?{x:e.map.x,y:e.map.y}:null)}__getGpsMapPosition(e){const n=this.config.map;return this.isGps&&n&&n.extent&&n.size?{x:Gr.mapLinear(e[0],n.extent[0],n.extent[2],0,n.size.width),y:Gr.mapLinear(e[1],n.extent[1],n.extent[3],0,n.size.height)}:null}};mx.id="virtual-tour";mx.VERSION="5.13.4";mx.configParser=aI;mx.readonlyOptions=Object.keys(aI.defaults);var ew=mx;function NO(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function qve(t){if(Array.isArray(t))return t}function Xve(t,e,n){return(e=Jve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zve(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,o,l,c,s=[],m=!0,y=!1;try{if(l=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;m=!1}else for(;!(m=(r=l.call(n)).done)&&(s.push(r.value),s.length!==e);m=!0);}catch(b){y=!0,o=b}finally{try{if(!m&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(y)throw o}}return s}}function Yve(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function qT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?BO(Object(n),!0).forEach(function(r){Xve(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BO(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _v(t,e){return qve(t)||Zve(t,e)||Qve(t,e)||Yve()}function Kve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jve(t){var e=Kve(t,"string");return typeof e=="symbol"?e:e+""}function tw(t){"@babel/helpers - typeof";return tw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tw(t)}function Qve(t,e){if(t){if(typeof t=="string")return NO(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?NO(t,e):void 0}}function eye(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var m$={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function o(m,y,b){this.fn=m,this.context=y,this.once=b||!1}function l(m,y,b,w,E){if(typeof b!="function")throw new TypeError("The listener must be a function");var T=new o(b,w||m,E),R=n?n+y:y;return m._events[R]?m._events[R].fn?m._events[R]=[m._events[R],T]:m._events[R].push(T):(m._events[R]=T,m._eventsCount++),m}function c(m,y){--m._eventsCount===0?m._events=new r:delete m._events[y]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var y=[],b,w;if(this._eventsCount===0)return y;for(w in b=this._events)e.call(b,w)&&y.push(n?w.slice(1):w);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(b)):y},s.prototype.listeners=function(y){var b=n?n+y:y,w=this._events[b];if(!w)return[];if(w.fn)return[w.fn];for(var E=0,T=w.length,R=new Array(T);E<T;E++)R[E]=w[E].fn;return R},s.prototype.listenerCount=function(y){var b=n?n+y:y,w=this._events[b];return w?w.fn?1:w.length:0},s.prototype.emit=function(y,b,w,E,T,R){var z=n?n+y:y;if(!this._events[z])return!1;var I=this._events[z],L=arguments.length,V,B;if(I.fn){switch(I.once&&this.removeListener(y,I.fn,void 0,!0),L){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,b),!0;case 3:return I.fn.call(I.context,b,w),!0;case 4:return I.fn.call(I.context,b,w,E),!0;case 5:return I.fn.call(I.context,b,w,E,T),!0;case 6:return I.fn.call(I.context,b,w,E,T,R),!0}for(B=1,V=new Array(L-1);B<L;B++)V[B-1]=arguments[B];I.fn.apply(I.context,V)}else{var W=I.length,X;for(B=0;B<W;B++)switch(I[B].once&&this.removeListener(y,I[B].fn,void 0,!0),L){case 1:I[B].fn.call(I[B].context);break;case 2:I[B].fn.call(I[B].context,b);break;case 3:I[B].fn.call(I[B].context,b,w);break;case 4:I[B].fn.call(I[B].context,b,w,E);break;default:if(!V)for(X=1,V=new Array(L-1);X<L;X++)V[X-1]=arguments[X];I[B].fn.apply(I[B].context,V)}}return!0},s.prototype.on=function(y,b,w){return l(this,y,b,w,!1)},s.prototype.once=function(y,b,w){return l(this,y,b,w,!0)},s.prototype.removeListener=function(y,b,w,E){var T=n?n+y:y;if(!this._events[T])return this;if(!b)return c(this,T),this;var R=this._events[T];if(R.fn)R.fn===b&&(!E||R.once)&&(!w||R.context===w)&&c(this,T);else{for(var z=0,I=[],L=R.length;z<L;z++)(R[z].fn!==b||E&&!R[z].once||w&&R[z].context!==w)&&I.push(R[z]);I.length?this._events[T]=I.length===1?I[0]:I:c(this,T)}return this},s.prototype.removeAllListeners=function(y){var b;return y?(b=n?n+y:y,this._events[b]&&c(this,b)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s})(m$);var tye=m$.exports,nye=eye(tye),Nb=new nye,qa={on:function(e,n){return Nb.on(e,n)},once:function(e,n){return Nb.once(e,n)},off:function(e,n){return Nb.off(e,n)},emit:function(e,n){return Nb.emit(e,n)}};Object.freeze(qa);var rye=["src","height","width","hideNavbarButton","containerClass","littlePlanet","onPositionChange","onZoomChange","onClick","onDblclick","onReady"],XT=["zoom","fullscreen"];function iye(t){var e=qT({},t);for(var n in e)rye.includes(n)&&delete e[n];return e}function oye(t,e,n,r,o){return(t-e)*(o-r)/(n-e)+r}function UO(t){return t==null?XT:Array.isArray(t)?t:typeof t=="string"?t===""?!1:[t]:t?XT:!1}function sye(){var t=H.useState(),e=_v(t,2),n=e[0],r=e[1],o=H.useCallback(function(l){l&&l!==n&&r(l)},[n]);return[n,o]}var lI=H.forwardRef(function(t,e){var n=sye(),r=_v(n,2),o=r[0],l=r[1],c=H.useMemo(function(){return t},[t.panorama,t.src,t.size,t.canvasBackground,t.navbar,t.height,t.width,t.containerClass,t.hideNavbarButton||!0,t.littlePlanet,t.fishEye,t.lang,t.onPositionChange,t.onZoomChange,t.onClick,t.onDblclick,t.onReady,t.moveSpeed,t.zoomSpeed,t.moveInertia,t.mousewheel,t.mousemove,t.mousewheelCtrlKey,t.touchmoveTwoFingers,t.panoData,t.requestHeaders,t.withCredentials,t.keyboard,t.keyboardActions,t.plugins,t.adapter,t.sphereCorrection,t.minFov,t.maxFov,t.defaultZoomLvl,t.defaultYaw,t.defaultPitch,t.caption,t.description,t.downloadUrl,t.downloadName,t.loadingImg,t.loadingTxt,t.rendererParameters,t.defaultTransition]),s=H.useRef(null),m=130,y=H.useState(-90),b=_v(y,1),w=b[0],E=H.useState(2),T=_v(E,1),R=T[0],z=H.useState(0),I=_v(z,1),L=I[0],V=H.useState(XT),B=_v(V,2),W=B[0],X=B[1],q=H.useRef(!0);H.useEffect(function(){function se(){var re=window.innerWidth/window.innerHeight;m=Math.floor(oye(re,.5,1.8,140,115))}return window.addEventListener("resize",se),se(),function(){return window.removeEventListener("resize",se)}},[]),H.useEffect(function(){if(o&&!s.current){var se,re,$,ce,Ce,Se,Xe,Fe,Me,Te=new gve(qT(qT({},iye(c)),{},{container:o,panorama:c.panorama||c.src,size:{height:c.height,width:c.width||"100px"},fisheye:c.littlePlanet?R:c.fisheye||!1,minFov:(se=c.minFov)!==null&&se!==void 0?se:30,maxFov:c.littlePlanet?m:(re=c.maxFov)!==null&&re!==void 0?re:90,defaultZoomLvl:c.littlePlanet?L:($=c.defaultZoomLvl)!==null&&$!==void 0?$:50,defaultYaw:(ce=c.defaultYaw)!==null&&ce!==void 0?ce:0,defaultPitch:c.littlePlanet?w:(Ce=c.defaultPitch)!==null&&Ce!==void 0?Ce:0,sphereCorrection:c.sphereCorrection||{pan:0,tilt:0,roll:0},moveSpeed:c.moveSpeed||1,zoomSpeed:c.zoomSpeed||1,moveInertia:(Se=c.moveInertia)!==null&&Se!==void 0?Se:!0,mousewheel:c.littlePlanet?!1:(Xe=c.mousewheel)!==null&&Xe!==void 0?Xe:!0,mousemove:(Fe=c.mousemove)!==null&&Fe!==void 0?Fe:!0,mousewheelCtrlKey:c.mousewheelCtrlKey||!1,touchmoveTwoFingers:c.touchmoveTwoFingers||!1,panoData:c.panoData||void 0,requestHeaders:c.requestHeaders||void 0,withCredentials:c.withCredentials||!1,navbar:UO(c.navbar),lang:c.lang||{},keyboard:c.keyboard||"fullscreen",plugins:(Me=c.plugins)!==null&&Me!==void 0?Me:[]}));Te.addEventListener("ready",function(){c.onReady&&c.onReady(Te)},{once:!0}),Te.addEventListener("click",function(je){c.onClick&&c.onClick(je,Te),c.littlePlanet&&q.current&&(q.current=!1,Te.animate({yaw:0,pitch:w,zoom:75,speed:"3rpm"}).then(function(){Te.animate({yaw:0,pitch:0,zoom:90,speed:"10rpm"}).then(function(){var ft;Te.setOption("maxFov",c.maxFov||70),Te.setOption("mousewheel",(ft=c.mousewheel)!==null&&ft!==void 0?ft:!0)})}))}),Te.addEventListener("dblclick",function(je){c.onDblclick&&c.onDblclick(je,Te)}),Te.addEventListener("zoom-updated",function(je){c.onZoomChange&&c.onZoomChange(je,Te)}),Te.addEventListener("position-updated",function(je){c.onPositionChange&&c.onPositionChange(je.position.pitch,je.position.yaw,Te)});var Ie=UO(c.navbar);if(c.littlePlanet){var Ke,st,Ee=`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 20C16.4183 20 20 16.4183 20 12C20 11.8805 19.9974 11.7615 19.9922 11.6433C20.2479 11.4141 20.4882 11.1864 20.7118 10.9611C21.0037 10.6672 21.002 10.1923 20.708 9.90049C20.4336 9.628 20.0014 9.61143 19.7077 9.84972C19.4023 8.75248 18.8688 7.75024 18.1616 6.89725C18.4607 6.84611 18.7436 6.8084 19.0087 6.784C19.4212 6.74604 19.7247 6.38089 19.6868 5.96842C19.6488 5.55595 19.2837 5.25235 18.8712 5.29032C18.4474 5.32932 17.9972 5.39638 17.5262 5.48921C17.3267 5.52851 17.1614 5.64353 17.0543 5.79852C15.6765 4.67424 13.917 4 12 4C7.58172 4 4 7.58172 4 12C4 12.2776 4.01414 12.552 4.04175 12.8223C3.78987 12.7532 3.50899 12.8177 3.31137 13.0159C2.97651 13.3517 2.67596 13.6846 2.415 14.0113C2.15647 14.3349 2.20924 14.8069 2.53287 15.0654C2.8565 15.3239 3.32843 15.2711 3.58696 14.9475C3.78866 14.695 4.02466 14.4302 4.2938 14.1557C4.60754 15.2796 5.16056 16.3037 5.8945 17.1697C5.66824 17.3368 5.54578 17.6248 5.60398 17.919C5.68437 18.3253 6.07894 18.5896 6.48528 18.5092C6.7024 18.4662 6.92455 18.4177 7.15125 18.3637C8.49656 19.3903 10.1771 20 12 20ZM7.15125 18.3637C6.69042 18.012 6.26891 17.6114 5.8945 17.1697C5.98073 17.106 6.08204 17.0599 6.19417 17.0377C7.19089 16.8405 8.33112 16.5084 9.55581 16.0486C9.94359 15.903 10.376 16.0994 10.5216 16.4872C10.6671 16.8749 10.4708 17.3073 10.083 17.4529C9.05325 17.8395 8.0653 18.1459 7.15125 18.3637ZM19.7077 9.84972C19.6869 9.86663 19.6667 9.88483 19.6474 9.90431C18.9609 10.5957 18.0797 11.3337 17.0388 12.0753C16.7014 12.3157 16.6228 12.784 16.8631 13.1213C17.1035 13.4587 17.5718 13.5373 17.9091 13.297C18.6809 12.7471 19.3806 12.1912 19.9922 11.6433C19.965 11.0246 19.8676 10.4241 19.7077 9.84972ZM20.9366 5.37924C20.5336 5.28378 20.1294 5.53313 20.034 5.93619C19.9385 6.33925 20.1879 6.74339 20.5909 6.83886C20.985 6.93219 21.1368 7.07125 21.1932 7.16142C21.2565 7.26269 21.3262 7.52732 21.0363 8.10938C20.8516 8.48014 21.0025 8.93042 21.3732 9.1151C21.744 9.29979 22.1943 9.14894 22.379 8.77818C22.7566 8.02003 22.9422 7.12886 22.4648 6.36582C22.1206 5.81574 21.5416 5.52252 20.9366 5.37924ZM2.81481 16.2501C2.94057 15.8555 2.72259 15.4336 2.32793 15.3078C1.93327 15.1821 1.51138 15.4 1.38562 15.7947C1.19392 16.3963 1.17354 17.0573 1.53488 17.6349C1.98775 18.3587 2.84153 18.6413 3.68907 18.7224C4.1014 18.7619 4.46765 18.4596 4.50712 18.0473C4.54658 17.635 4.24432 17.2687 3.83199 17.2293C3.13763 17.1628 2.88355 16.9624 2.80651 16.8393C2.75679 16.7598 2.70479 16.5954 2.81481 16.2501ZM15.7504 14.704C16.106 14.4915 16.2218 14.0309 16.0093 13.6754C15.7967 13.3199 15.3362 13.204 14.9807 13.4166C14.4991 13.7045 13.9974 13.9881 13.4781 14.2648C12.9445 14.5491 12.4132 14.8149 11.8883 15.0615C11.5134 15.2376 11.3522 15.6843 11.5283 16.0592C11.7044 16.4341 12.1511 16.5953 12.526 16.4192C13.0739 16.1618 13.6277 15.8847 14.1834 15.5887C14.7242 15.3005 15.2474 15.0048 15.7504 14.704Z" fill="rgba(255,255,255,.7)"/>
                </svg>`,Qe={id:"resetLittlePlanetButton",content:((Ke=t.lang)===null||Ke===void 0?void 0:Ke.littlePlanetIcon)||Ee,title:((st=t.lang)===null||st===void 0?void 0:st.littlePlanetButton)||"Reset Little Planet",className:"resetLittlePlanetButton",onClick:function(){q.current=!0,Te.setOption("maxFov",m),Te.setOption("mousewheel",!1),Te.animate({yaw:0,pitch:w,zoom:L,speed:"10rpm"})}};Ie!==!1&&!Ie.find(function(je){return tw(je)==="object"&&je?.id==="resetLittlePlanetButton"})&&Ie.splice(1,0,Qe)}if(c.hideNavbarButton){var jt={id:"hideNavbarButton",content:`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                            <g clip-path="url(#clip0_429_11083)">
                            <path d="M7 7.00006L17 17.0001M7 17.0001L17 7.00006" stroke="rgba(255,255,255,.7)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                            <clipPath id="clip0_429_11083">
                            <rect width="24" height="24" fill="white"/>
                            </clipPath>
                            </defs>
                            </svg>`,title:"Hide Navbar",className:"hideNavbarButton",onClick:function(){Te.navbar.hide();var ft=document.createElement("a");ft.className="showNavbarButton",ft.innerHTML=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 26 26" style="enable-background:new 0 0 26 26;" xml:space="preserve" class="icon icon-back-to-top">
                                        <g>
                                        <path d="M13.8,1.3L21.6,9c0.1,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.1,0.3,0.1,0.4s0,0.3-0.1,0.4c-0.1,0.1-0.1,0.3-0.3,0.4
                                            c-0.1,0.1-0.2,0.2-0.4,0.3c-0.2,0.1-0.3,0.1-0.4,0.1c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.3-0.2-0.4-0.3L14.2,5l0,19.1
                                            c0,0.2-0.1,0.3-0.1,0.5c0,0.1-0.1,0.3-0.3,0.4c-0.1,0.1-0.2,0.2-0.4,0.3c-0.1,0.1-0.3,0.1-0.5,0.1c-0.1,0-0.3,0-0.4-0.1
                                            c-0.1-0.1-0.3-0.1-0.4-0.3c-0.1-0.1-0.2-0.2-0.3-0.4c-0.1-0.1-0.1-0.3-0.1-0.5l0-19.1l-5.7,5.7C6,10.8,5.8,10.9,5.7,11
                                            c-0.1,0.1-0.3,0.1-0.4,0.1c-0.2,0-0.3,0-0.4-0.1c-0.1-0.1-0.3-0.2-0.4-0.3c-0.1-0.1-0.1-0.2-0.2-0.4C4.1,10.2,4,10.1,4.1,9.9
                                            c0-0.1,0-0.3,0.1-0.4c0-0.1,0.1-0.3,0.3-0.4l7.7-7.8c0.1,0,0.2-0.1,0.2-0.1c0,0,0.1-0.1,0.2-0.1c0.1,0,0.2,0,0.2-0.1
                                            c0.1,0,0.1,0,0.2,0c0,0,0.1,0,0.2,0c0.1,0,0.2,0,0.2,0.1c0.1,0,0.1,0.1,0.2,0.1C13.7,1.2,13.8,1.2,13.8,1.3z"></path>
                                        </g>
                                        </svg>`,ft.title="Show Navbar",ft.onclick=function(At){At.preventDefault(),Te.navbar.show(),ft.remove()},document.body.appendChild(ft)}};Ie!==!1&&!Ie.find(function(je){return tw(je)==="object"&&je?.id==="hideNavbarButton"})&&Ie.push(jt)}Ie!==!1?(Te.setOption("navbar",Ie),X(Ie)):Te.navbar.hide(),qa.on("animate",function(je){Te.animate(je)}).on("stop-animation",function(){Te.stopAnimation()}).on("destroy",function(){Te.destroy()}).on("rotate",function(je){Te.rotate(je)}).on("setOption",function(je){var ft=je.option,At=je.value;Te.setOption(ft,At)}).on("setOptions",function(je){Te.setOptions(je)}).on("zoom",function(je){Te.zoom(je)}).on("zoomIn",function(je){Te.zoomIn(je)}).on("zoomOut",function(je){Te.zoomOut(je)}).on("resize",function(je){Te.resize(je)}).on("enterFullscreen",function(){Te.enterFullscreen()}).on("exitFullscreen",function(){Te.exitFullscreen()}).on("toggleFullscreen",function(){Te.toggleFullscreen()}).on("needsContinuousUpdate",function(je){Te.needsContinuousUpdate(je)}).on("observeObjects",function(je){Te.observeObjects(je)}).on("unobserveObjects",function(je){Te.unobserveObjects(je)}).on("setCursor",function(je){Te.setCursor(je)}).on("setPanorama",function(je){Te.setPanorama(je.path,je.options)}).on("showError",function(je){Te.showError(je)}).on("hideError",function(){Te.hideError()}).on("startKeyboardControl",function(){Te.startKeyboardControl()}).on("stopKeyboardControl",function(){Te.stopKeyboardControl()}),s.current=Te}},[o,c]),H.useEffect(function(){var se=s.current;if(se&&se.container&&se.container.parentNode&&se&&se.container&&se.container.parentNode){var re,$,ce,Ce;(re=se.renderer)===null||re===void 0||($=re.renderer)===null||$===void 0||$.dispose(),(ce=se.renderer)===null||ce===void 0||(Ce=ce.renderer)===null||Ce===void 0||Ce.forceContextLoss(),se.destroy()}},[s]),H.useEffect(function(){var se,re=(se=c.panorama)!==null&&se!==void 0?se:c.src;s.current&&re&&s.current.setPanorama(re,{})},[c.src,c.panorama]);var te=function(){return{animate:function($){qa.emit("animate",$)},destroy:function(){qa.emit("destroy",{})},createTooltip:function($){var ce;return(ce=s.current)===null||ce===void 0?void 0:ce.createTooltip($)},needsContinuousUpdate:function($){qa.emit("needsContinuousUpdate",$)},observeObjects:function($){qa.emit("observeObjects",$)},unobserveObjects:function($){qa.emit("unobserveObjects",$)},setCursor:function($){qa.emit("setCursor",$)},stopAnimation:function(){qa.emit("stop-animation",{})},rotate:function($){qa.emit("rotate",$)},setOption:function($,ce){qa.emit("setOption",{option:$,value:ce})},setOptions:function($){var ce;return(ce=s.current)===null||ce===void 0?void 0:ce.setOptions($)},getCurrentNavbar:function(){return W},zoom:function($){qa.emit("zoom",$)},zoomIn:function($){qa.emit("zoomIn",{step:$})},zoomOut:function($){qa.emit("zoomOut",{step:$})},resize:function($){var ce;return(ce=s.current)===null||ce===void 0?void 0:ce.resize($)},enterFullscreen:function(){var $;return($=s.current)===null||$===void 0?void 0:$.enterFullscreen()},exitFullscreen:function(){var $;return($=s.current)===null||$===void 0?void 0:$.exitFullscreen()},toggleFullscreen:function(){var $;return($=s.current)===null||$===void 0?void 0:$.toggleFullscreen()},isFullscreenEnabled:function(){var $;return($=s.current)===null||$===void 0?void 0:$.isFullscreenEnabled()},getPlugin:function($){var ce;return(ce=s.current)===null||ce===void 0?void 0:ce.getPlugin($)},getPosition:function(){var $;return($=s.current)===null||$===void 0?void 0:$.getPosition()},getZoomLevel:function(){var $;return($=s.current)===null||$===void 0?void 0:$.getZoomLevel()},getSize:function(){var $;return($=s.current)===null||$===void 0?void 0:$.getSize()},needsUpdate:function(){var $;return($=s.current)===null||$===void 0?void 0:$.needsUpdate()},autoSize:function(){var $;return($=s.current)===null||$===void 0?void 0:$.autoSize()},setPanorama:function($,ce){var Ce;return(Ce=s.current)===null||Ce===void 0?void 0:Ce.setPanorama($,ce)},showError:function($){var ce;return(ce=s.current)===null||ce===void 0?void 0:ce.showError($)},hideError:function(){var $;return($=s.current)===null||$===void 0?void 0:$.hideError()},startKeyboardControl:function(){var $;return($=s.current)===null||$===void 0?void 0:$.startKeyboardControl()},stopKeyboardControl:function(){var $;return($=s.current)===null||$===void 0?void 0:$.stopKeyboardControl()}}};return H.useImperativeHandle(e,te,[s.current,o,c,e]),D0.createElement("div",{className:c.containerClass||"view-container",ref:l})});lI.displayName="ReactPhotoSphereViewer";const aye=(t,e)=>({width:8192,cols:16,rows:8,baseUrl:`${t}/${e}_thumb.jpg`,tileUrl:(n,r)=>`${t}/${e}_${n}_${r}.jpg`}),lye=t=>e=>({baseUrl:`${t}/${e}/thumb.jpg`,tileUrl:function(n,r,o=0){return`${t}/${e}/${o}/${n}_${r}.jpg`},width:15520,cols:32,rows:16,levels:[{width:15520/2,cols:32/2,rows:16/2,zoomRange:[0,60]},{width:15520,cols:32,rows:16,zoomRange:[60,100]}]}),cye=t=>{const{panorama:e,tileRootUrl:n,pixelRootUrl:r,mode:o="light"}=t,l=H.useRef(null),c=H.useRef(null),s=H.useRef(null),m=(z,I)=>s.current?.setRotation(I/Math.PI*180),y=({node:z})=>{const[I,L]=xr(z.gps),V=[I,L];xr(l.current).panTo(V),xr(s.current).setLngLat(V)},b=()=>{const z=xr(c.current);xr(z.getPlugin(ew)).addEventListener("node-changed",y)},w=e[0],E=lye(r),T={positionMode:"gps",nodes:e.map((z,I)=>({id:z.id,panorama:e.length===1?aye(r,z.id):E(z.id),gps:z.point,links:[{nodeId:e[I-1]?.id},{nodeId:e[I+1]?.id}].filter(L=>L.nodeId!=null)}))},R=T.nodes.at(0).panorama;return oe.jsxs(oe.Fragment,{children:[oe.jsx(lI,{ref:c,adapter:r$,minFov:15,plugins:[ew.withConfig(T)],src:R,height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:m,defaultYaw:w.yaw??0,onReady:b}),oe.jsx(b2,{sx:{position:"absolute",m:2.5,top:0,left:0,background:"#000a"},color:"neutral",invertedColors:!0,variant:"solid",children:oe.jsxs(Ya,{direction:"row",gap:2,alignItems:"flex-start",children:[oe.jsx(Ah,{onClick:t.onClose,children:oe.jsx(vne,{htmlColor:"#fff8"})}),oe.jsxs(b4,{sx:{display:"flex",flexDirection:"column",gap:1},children:[oe.jsxs(Fi,{level:"title-lg",sx:{lineHeight:1},children:[w.label,oe.jsxs(Fi,{level:"body-xs",sx:{opacity:.8},children:[oe.jsx("br",{}),w.location]})]}),oe.jsxs(Ya,{direction:"row",alignItems:"center",gap:1,sx:{transformOrigin:"left",transform:"scale(0.8)",mt:-.5},children:[oe.jsx(Tq,{src:e.length===1?"https://avatars.githubusercontent.com/u/121829201?v=4":"https://avatars.githubusercontent.com/u/3860505?v=4",size:"sm"}),oe.jsx(Fi,{level:"title-sm",children:e.length===1?"Trucker Mudgeon":"San_Sany4"})]}),oe.jsx(Rw,{}),oe.jsx(Ya,{direction:"row",gap:2,children:oe.jsx(Fi,{level:"body-xs",children:e.length===1?"August 2025":"September 2025"})})]})]})}),oe.jsx("div",{className:"credits",children:"Game data and images © SCS Software."}),oe.jsxs(jw,{ref:l,style:{position:"absolute",left:20,bottom:20,width:"200px",height:"200px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:9,maxZoom:14,maxBounds:[w.point.map(z=>z-1),w.point.map(z=>z+1)],mapStyle:Ww,attributionControl:!1,initialViewState:{longitude:w.point[0],latitude:w.point[1],zoom:10},children:[oe.jsx(aA,{ref:s,longitude:w.point[0],latitude:w.point[1],rotation:(w.yaw??0)/Math.PI*180,rotationAlignment:"map",children:oe.jsx("div",{className:"street-view-marker"})}),oe.jsx(Gw,{tileRootUrl:n,mode:o}),oe.jsx(Jv,{tileRootUrl:n,game:"ats",mode:o,enableIconAutoHide:!0,visibleIcons:ap,dlcs:$m}),oe.jsx(Jv,{tileRootUrl:n,game:"ets2",mode:o,enableIconAutoHide:!0,visibleIcons:ap})]})]})},g$=8192,xv=512,uye=g$/360,$O=g$/xv,fv=100,hye=t=>{const{pixelRootUrl:e,panorama:n}=t,r=rN(n.yaw??0)*180/Math.PI+180,o=Math.floor(uye*r);let l,c;return o%xv<xv/2?(c=Math.floor(o/xv),l=c===0?$O-1:c-1):(l=Math.floor(o/xv),c=l===$O-1?0:l+1),oe.jsx("div",{style:{overflow:"hidden",width:fv},children:oe.jsxs("div",{style:{display:"flex",position:"relative",left:-r*fv/xv},children:[oe.jsx("img",{width:fv,height:fv,src:`${e}/${n.id}_${l}_3.jpg`}),oe.jsx("img",{width:fv,height:fv,src:`${e}/${n.id}_${c}_3.jpg`})]})})},VO=(t,[e,n])=>!isNaN(t)&&e<=t&&t<=n,dye=t=>{const{tileRootUrl:e,pixelRootUrl:n}=t,{mode:r,systemMode:o}=MP(),l=r==="system"?o:r,{longitude:c,latitude:s}=r1[fye(localStorage.getItem("tm-map"))],[m]=hJ(),y=Number(m.get("mlat")??void 0),b=Number(m.get("mlon")??void 0),w=VO(y,[-90,90])&&VO(b,[-180,180])?{lat:y,lon:b}:void 0,E=new Set([...ap].filter(Ee=>!YF.includes(Ee))),[T,R]=H.useState(!0),[z,I]=H.useState(E),[L,V]=H.useState(new Set($m)),B=hB(L),W=F1(z,I,ap),X=F1(L,V,$m),[q,te]=H.useState(!1),[se,re]=H.useState(!1),$=H.useRef(null),[ce,Ce]=H.useState(!1),[Se,Xe]=H.useState(null),[Fe,Me]=H.useState(null),Te=H.useCallback(()=>Xe(null),[]),[Ie,Ke]=H.useState(null);H.useEffect(()=>{fetch("/street-view.geojson").then(Ee=>Ee.json()).then(Ee=>Ke(Ee)).catch(Ee=>console.error(Ee))},[]),H.useEffect(()=>{if(!$.current||!ce||!se||!Ie)return;const Ee=$.current,Qe=ft=>{const At=Ee.queryRenderedFeatures(ft.point,{layers:["photo-spheres"]})[0],ht=Ee.queryRenderedFeatures(ft.point,{layers:["sv-streets"]})[0];if(Ee.getCanvas().style.cursor=At||ht?"pointer":"",At){if(Fe?.id!==At.properties.id){const lt=At;Me({id:lt.properties.id,location:lt.properties.location,point:lt.geometry.coordinates,yaw:lt.properties.yaw,label:lt.properties.label})}}else Fe&&Me(null)},jt=ft=>{const At=Ee.queryRenderedFeatures(ft.point,{layers:["photo-spheres"]})[0];if(At&&At.properties.cluster!==!0){Me(null),Xe(Fe==null?null:[Fe]);return}const ht=Ee.queryRenderedFeatures(ft.point,{layers:["sv-streets"]})[0];if(ht){Me(null);const lt=ht.properties.id;console.log("lineId",lt);const bt=xr(Ie.features.find(St=>St.properties.id===lt));Xe(bt.properties.panos.map((St,dn)=>({id:St.id,point:bt.geometry.coordinates[dn],label:St.label,location:bt.properties.location})).filter(St=>St.point))}},je=ft=>{Se!=null&&ft.key==="Escape"&&Xe(null)};return Se&&document.addEventListener("keydown",je),Ee.on("mousemove",Qe),Ee.on("click",jt),()=>{Ee.off("mousemove",Qe),Ee.off("click",jt),document.removeEventListener("keydown",je)}},[$.current,ce,Se,Fe,se,Ie]);const st=oe.jsxs(jw,{ref:$,style:{width:"100svw",height:"100svh",display:Se?"none":void 0},hash:!0,minZoom:4,maxZoom:15,mapStyle:Ww,attributionControl:!1,initialViewState:{longitude:c,latitude:s,zoom:4},children:[w&&oe.jsx(aA,{longitude:w.lon,latitude:w.lat}),oe.jsxs(Gw,{tileRootUrl:e,mode:l,children:[oe.jsx(z2,{tileRootUrl:e,game:"ats",showContours:q}),oe.jsx(z2,{tileRootUrl:e,game:"ets2",showContours:q})]}),oe.jsx(Jv,{tileRootUrl:e,game:"ats",mode:l,enableIconAutoHide:T,visibleIcons:z,dlcs:L}),oe.jsx(Jv,{tileRootUrl:e,game:"ets2",mode:l,enableIconAutoHide:T,visibleIcons:z}),z.has(Co.CityNames)&&oe.jsx(F2,{game:"ats",mode:l,enableAutoHide:T,enabledStates:B}),z.has(Co.CityNames)&&oe.jsx(F2,{game:"ets2",mode:l,enableAutoHide:T}),se&&ce&&oe.jsxs(sp,{id:"street-view",type:"geojson",data:"/street-view.geojson",cluster:!1,clusterMaxZoom:7,clusterRadius:10,children:[oe.jsx(kr,{id:"photo-spheres-halo",type:"circle",paint:{"circle-radius":10,"circle-color":l==="light"?"#fff8":"#8884","circle-blur":.75},filter:["in","$type","Point"]}),oe.jsx(kr,{id:"photo-spheres",type:"circle",paint:{"circle-radius":5,"circle-color":"#48f2","circle-stroke-width":2,"circle-stroke-color":"#48f"},filter:["in","$type","Point"]}),oe.jsx(kr,{id:"sv-streets-case",type:"line",paint:{"line-color":"#aef","line-width":2,"line-gap-width":4},filter:["in","$type","LineString"]}),oe.jsx(kr,{id:"sv-streets",type:"line",paint:{"line-color":"#2ab","line-width":4},filter:["in","$type","LineString"]})]}),oe.jsxs(sp,{id:"measure",type:"geojson",data:{type:"FeatureCollection",features:[]},children:[oe.jsx(kr,{id:"measure-lines",type:"line",paint:{"line-color":"#f00","line-width":3,"line-opacity":1},filter:["in","$type","LineString"]}),oe.jsx(kr,{id:"measure-points",type:"circle",paint:{"circle-radius":5,"circle-color":"#fff","circle-stroke-width":3,"circle-stroke-color":"#f00"},filter:["in","$type","Point"]})]}),oe.jsx(DF,{visualizePitch:!0}),oe.jsx(Zce,{visible:se,onToggle:Ce}),oe.jsx(LF,{containerId:"fsElem"}),oe.jsx(Yce,{}),oe.jsx(RN,{}),oe.jsx(RF,{compact:!0,style:{marginLeft:54},customAttribution:"© Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a> and <a href='https://forum.scssoft.com/viewtopic.php?p=1946956#p1946956'>krmarci</a>."}),oe.jsx(Wce,{visibleStates:B,visibleStateDlcs:L}),oe.jsx(IN,{icons:{...W,enableAutoHiding:T,onAutoHidingToggle:R},advanced:{showContours:q,onContoursToggle:te,showPhotoSpheresUi:se,onPhotoSpheresToggleUi:re},atsDlcs:X}),Fe&&oe.jsx(Jee,{className:"pano-preview-popup",closeButton:!1,closeOnClick:!1,closeOnMove:!0,longitude:Fe.point[0],latitude:Fe.point[1],children:oe.jsx(hye,{panorama:Fe,pixelRootUrl:n})}),oe.jsx(Pae,{})]});return oe.jsxs(oe.Fragment,{children:[st,Se&&oe.jsxs(oe.Fragment,{children:[oe.jsx(cye,{tileRootUrl:e,pixelRootUrl:n,panorama:Se,mode:l,onClose:Te}),oe.jsx(Ah,{sx:{background:"#000a",position:"absolute",borderRadius:"50%",m:2.5,top:0,right:0},size:"lg",variant:"solid",onClick:Te,children:oe.jsx(sA,{})})]})]})};function fye(t){return t==="europe"?t:"usa"}var pye=Object.defineProperty,mye=(t,e,n)=>e in t?pye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gye=(t,e,n)=>(mye(t,e+"",n),n);class vye{constructor(e){gye(this,"_kind"),this._kind=e}}function yye(t,e){const n=t.toString(),r=e.toString();return n>r?1:n<r?-1:0}const _ye=yye;var xye=Object.defineProperty,bye=(t,e,n)=>e in t?xye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jO=(t,e,n)=>(bye(t,typeof e!="symbol"?e+"":e,n),n);function wye(t,e,n){const r=e*2,o=e*2+1;let l=e;return r<t.length&&n(t[l],t[r])<0&&(l=r),o<t.length&&n(t[l],t[o])<0&&(l=o),l}function cI(t,e,n){const r=wye(t,e,n);if(r!==e){const o=t[e];t[e]=t[r],t[r]=o,cI(t,r,n)}}function HO(t){for(let e=Math.floor(t.collection.length/2)-1;e>=0;--e)cI(t.collection,e,t.comparator)}class nw extends vye{constructor({comparator:e=_ye}={}){super("BinaryHeap"),jO(this,"comparator"),jO(this,"collection",[]),this.comparator=e}static from(e,n={}){const r=new nw(n);return r.collection=Array.from(e),HO(r),r}clear(){this.collection.length=0}toArray(){return[...this.collection].sort(this.comparator)}get length(){return this.collection.length}top(){if(this.length===0)throw new Error("invalid operation: top() called for empty BinaryHeap");return this.collection[0]}pop(){if(this.length===0)throw new Error("invalid operation: pop() called for empty BinaryHeap");const e=this.collection[0];return this.collection.length>1?(this.collection[0]=this.collection.pop(),cI(this.collection,0,this.comparator)):this.collection.pop(),e}push(e){this.collection.push(e);const n=this.collection;for(let r=n.length-1,o=Math.floor(r/2);r>0&&this.comparator(n[o],n[r])<0;r=o,o=Math.floor(o/2)){const l=n[r];n[r]=n[o],n[o]=l}}merge(e){e instanceof nw?this.collection=this.collection.concat(e.collection):this.collection=this.collection.concat(e.toArray()),HO(this),e.clear()}isEmpty(){return!this.collection.length}}function Sye(t,e,n,r,o){const l=`${t}-${e}-${n}-${r}`,{nodeLUT:c,graph:s}=o,m=xr(c.get(t)),y=xr(c.get(e)),b=new Cye({comparator:(V,B)=>{const W=I.get(V)??1/0;return(I.get(B)??1/0)-W}}),w={nodeUid:t,distance:0,direction:n,dlcGuard:-1};b.push(w);const E=new Map,T=new Map;T.set(w,0);const R=V=>tN(V,y),z=(V,B)=>{switch(r){case"shortest":return B.distance;case"smallRoads":return B.isOneLaneRoad?B.distance:B.distance*10;default:throw new Su(r)}},I=new Map;I.set(w,R(m));let L=0;for(;!b.isEmpty();){L++;const V=b.pop();if(V.nodeUid===e)return{success:!0,key:l,mode:r,...Mye(E,V)};const B=s.get(V.nodeUid);if(!B)continue;const W=V.direction==="forward"?B.forward:B.backward;for(const X of W){if(!o.enabledDlcGuards.has(X.dlcGuard))continue;const q=(T.get(V)??1/0)+z(V,X);q<(T.get(X)??1/0)&&(E.set(X,V),T.set(X,q),I.set(X,q+R(xr(c.get(X.nodeUid)))),b.has(X)||b.push(X))}}return{success:!1,key:l,mode:r,numIters:L}}function Mye(t,e){let n=0;const r=[e];for(;t.has(e);)e=t.get(e),r.unshift(e),n+=e.distance;return r.length===1&&r.push(r[0]),{route:r,distance:n}}class Cye extends nw{items=new Set;constructor(e){super(e)}has(e){return this.items.has(e)}push(e){Kv.checkState(!this.items.has(e)),super.push(e),this.items.add(e)}pop(){const e=super.pop();return Kv.checkState(this.items.has(e)),this.items.delete(e),e}clear(){super.clear(),this.items.clear()}merge(e){super.merge(e);for(const n of this.collection)this.items.add(n)}}const Eye=t=>{const{tileRootUrl:e}=t,{mode:n,systemMode:r}=MP(),o=n==="system"?r:n,[l,c]=H.useState(!0),[s,m]=H.useState(new Set(ap)),[y,b]=H.useState(new Set($m)),w=hB(y),E=F1(s,m,ap),T=F1(y,b,$m),[R,z]=H.useState(!1);return oe.jsxs(jw,{style:{width:"100vw",height:"100vh"},minZoom:4,maxZoom:15,maxBounds:[[-135,21],[-84,54]],mapStyle:Ww,attributionControl:!1,initialViewState:{longitude:-115,latitude:36,zoom:9},children:[oe.jsx(Gw,{tileRootUrl:e,mode:o,children:oe.jsx(z2,{tileRootUrl:e,game:"ats",showContours:R})}),oe.jsx(Jv,{tileRootUrl:e,game:"ats",mode:o,enableIconAutoHide:l,visibleIcons:s,dlcs:y}),oe.jsx(F2,{game:"ats",mode:o,enableAutoHide:l,enabledStates:w}),oe.jsx(sp,{id:"route1",type:"geojson",data:{type:"FeatureCollection",features:[]},children:oe.jsx(kr,{type:"line",paint:{"line-color":["match",["get","mode"],"shortest","#f00","smallRoads","#0f0","#f0f"],"line-width":3,"line-opacity":.7}})}),oe.jsx(DF,{visualizePitch:!0}),oe.jsx(LF,{}),oe.jsx(RN,{}),oe.jsx(RF,{compact:!0,customAttribution:"© Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a>."}),oe.jsx(Tye,{dlcs:y}),oe.jsx(IN,{icons:{...E,enableAutoHiding:l,onAutoHidingToggle:c},advanced:{showContours:R,onContoursToggle:z,showPhotoSpheresUi:!1,onPhotoSpheresToggleUi:()=>{}},atsDlcs:T})]})},Tye=t=>{const{current:e}=Y_(),n=Z_(t.dlcs),[r,o]=H.useState(void 0),[l,c]=H.useState(void 0),[s,m]=H.useState([]),[y,b]=H.useState([]);H.useEffect(()=>{fetch("usa-graph-demo.json").then(te=>te.json()).then(te=>{m(te.demoCompanies.map(qO)),c(Pye(te)),o(te)},()=>console.error("could not load usa-graph-demo.json"))},[]);const[w,E]=H.useState(void 0),[T,R]=H.useState(void 0),z=H.useCallback(te=>{te=xr(te),E(te.value);let se;if(r!=null){se=xr(r.demoCompanies.find(ce=>ce.n===te.value));const re=xr(r.demoCompanyDefs.find(ce=>ce.t===se.t)),$=new Set(re.d);b(r.demoCompanies.filter(ce=>$.has(ce.t)).map(qO))}if(!(e==null||l==null)&&(T!=null&&(xr(e.getSource("route1")).setData({type:"FeatureCollection",features:[]}),R(void 0)),se)){const re=xr(l.nodeLUT.get(BigInt(parseInt(se.n,36))));e.flyTo({curve:1,zoom:9,center:[re.x,re.y]})}},[e,T,l,r]),I=H.useCallback(te=>{te=xr(te),R(te.value),!(e==null||l==null)&&L(xr(w),te.value,e,{...l,enabledDlcGuards:n})},[e,w,l,t.dlcs]),L=(te,se,re,$)=>{Promise.all([XO(te,se,"shortest",$),XO(te,se,"smallRoads",$)]).then(ce=>{const Ce=xr(re.getSource("route1"));if(ce.some(Xe=>Xe==null)){alert("Cannot calculate a route 🙁"),Ce.setData({type:"FeatureCollection",features:[]});return}const Se=ce;Ce.setData({type:"FeatureCollection",features:Se}),re.fitBounds(nN(Se.flatMap(Xe=>Xe.geometry.coordinates)),{padding:150,curve:1,duration:2500})},ce=>{console.error("error finding route",ce)})},V=new Map;if(r)for(const[,te]of r.demoGraph)for(const se of[...te.b??[],...te.f??[]]){const re=V.get(se.n)??0;V.set(se.n,re||se.g)}const B=te=>{if(l==null)return!0;const se=xr(V.get(te.value));return n.has(se)},W=(te,se)=>te.city!==se.city?te.city.localeCompare(se.city):te.label.localeCompare(se.label),X=s.filter(B).sort(W),q=y.filter(B).sort(W);return oe.jsxs("div",{style:{width:300,margin:20,display:"grid",position:"relative",gridTemplateColumns:"100px auto",alignItems:"center"},children:[oe.jsx("h2",{children:"Start"}),oe.jsx(w1,{options:X,onChange:(te,se)=>se&&z(se),groupBy:te=>te.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,renderGroup:GO}),oe.jsx("h2",{children:"End"}),oe.jsx(w1,{options:q,onChange:(te,se)=>se&&I(se),groupBy:te=>te.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,disabled:w==null,renderGroup:GO},w)]})};function GO(t){return oe.jsxs(oe.Fragment,{children:[oe.jsx(Fi,{m:1,level:"body-xs",textTransform:"uppercase",children:t.group}),oe.jsx(Ew,{children:t.children}),oe.jsx(w2,{})]})}function Pye(t){const e=new Map,n=new Map;for(const[r,o]of t.demoGraph)e.set(BigInt(parseInt(r,36)),{forward:(o.f??[]).map(WO),backward:(o.b??[]).map(WO)});for(const[r,o]of t.demoNodes)n.set(BigInt(parseInt(r,36)),{x:o[0],y:o[1]});return{graph:e,nodeLUT:n}}function WO(t){return{nodeUid:BigInt(parseInt(t.n,36)),distance:t.l,isOneLaneRoad:t.o,direction:t.d==="f"?"forward":"backward",dlcGuard:t.g}}function qO(t){return{label:t.t,city:t.c,value:t.n}}function XO(t,e,n,r){return new Promise(o=>{const l=Sye(BigInt(parseInt(t,36)),BigInt(parseInt(e,36)),"forward",n,r);if(!l.success){o(void 0);return}o({type:"Feature",geometry:{type:"LineString",coordinates:l.route.map(c=>{const s=xr(r.nodeLUT.get(c.nodeUid));return[s.x,s.y]})},properties:{distance:l.distance,mode:n}})})}/*!
 * Photo Sphere Viewer / Markers Plugin 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var Aye=Object.defineProperty,Iye=(t,e)=>{for(var n in e)Aye(t,n,{get:e[n],enumerable:!0})},Rye={};Iye(Rye,{EnterMarkerEvent:()=>T$,GotoMarkerDoneEvent:()=>ZT,HideMarkersEvent:()=>i_,LeaveMarkerEvent:()=>M$,MarkerVisibilityEvent:()=>_$,MarkersPluginEvent:()=>zc,RenderMarkersListEvent:()=>W$,SelectMarkerEvent:()=>I$,SelectMarkerListEvent:()=>D$,SetMarkersEvent:()=>$$,ShowMarkersEvent:()=>o_,UnselectMarkerEvent:()=>O$});var zc=class extends dx{},v$=class y$ extends zc{constructor(e,n){super(y$.type),this.marker=e,this.visible=n}};v$.type="marker-visibility";var _$=v$,x$=class b$ extends zc{constructor(e){super(b$.type),this.marker=e}};x$.type="goto-marker-done";var ZT=x$,w$=class S$ extends zc{constructor(e){super(S$.type),this.marker=e}};w$.type="leave-marker";var M$=w$,C$=class E$ extends zc{constructor(e){super(E$.type),this.marker=e}};C$.type="enter-marker";var T$=C$,P$=class A$ extends zc{constructor(e,n,r){super(A$.type),this.marker=e,this.doubleClick=n,this.rightClick=r}};P$.type="select-marker";var I$=P$,R$=class L$ extends zc{constructor(e){super(L$.type),this.marker=e}};R$.type="select-marker-list";var D$=R$,k$=class z$ extends zc{constructor(e){super(z$.type),this.marker=e}};k$.type="unselect-marker";var O$=k$,F$=class N$ extends zc{constructor(){super(N$.type)}};F$.type="hide-markers";var i_=F$,B$=class U$ extends zc{constructor(e){super(U$.type),this.markers=e}};B$.type="set-markers";var $$=B$,V$=class j$ extends zc{constructor(){super(j$.type)}};V$.type="show-markers";var o_=V$,H$=class G$ extends zc{constructor(e){super(G$.type),this.markers=e}};H$.type="render-markers-list";var W$=H$,Lye=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,T_=class extends Pa{constructor(t){super(t,{className:"psv-markers-button",icon:Lye,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(o_.type,this),this.plugin.addEventListener(i_.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(o_.type,this),this.plugin.removeEventListener(i_.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof o_?this.toggleActive(!0):t instanceof i_&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};T_.id="markers";var q$=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,rw="http://www.w3.org/2000/svg",ro="psvMarker",Dye=Qn.dasherize(ro),x0="marker",bv="markersList",YT={amount:2,duration:100,easing:"linear"},kye=(t,e)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
    <h1 class="psv-panel-menu-title">${q$} ${e}</h1>
    <ul class="psv-panel-menu-list">
    ${t.map(n=>`
        <li data-${Dye}="${n.id}" class="psv-panel-menu-item" tabindex="0">
          ${n.type==="image"?`<span class="psv-panel-menu-item-icon"><img src="${n.definition}"/></span>`:""}
          <span class="psv-panel-menu-item-label">${n.getListContent()}</span>
        </li>
    `).join("")}
    </ul>
</div>
`,uS=class extends Pa{constructor(t){super(t,{className:" psv-markers-list-button",icon:q$,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(nr.ShowPanelEvent.type,this),this.viewer.addEventListener(nr.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(nr.ShowPanelEvent.type,this),this.viewer.removeEventListener(nr.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof nr.ShowPanelEvent?this.toggleActive(t.panelId===bv):t instanceof nr.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};uS.id="markersList";var ZO=new Pt,zye=new Sp,YO=new Pt,Oye=class extends Zs{constructor(t=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&e.element.parentNode!==null&&e.element.remove()})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this}},ph=new Ti,Fye=new Ti,Nye=class{constructor(t={}){const e=this;let n,r,o,l;const c={camera:{style:""},objects:new WeakMap},s=t.element!==void 0?t.element:document.createElement("div");s.style.overflow="hidden",this.domElement=s;const m=document.createElement("div");m.style.transformOrigin="0 0",m.style.pointerEvents="none",s.appendChild(m);const y=document.createElement("div");y.style.transformStyle="preserve-3d",m.appendChild(y),this.getSize=function(){return{width:n,height:r}},this.render=function(z,I){const L=I.projectionMatrix.elements[5]*l;I.view&&I.view.enabled?(m.style.transform=`translate( ${-I.view.offsetX*(n/I.view.width)}px, ${-I.view.offsetY*(r/I.view.height)}px )`,m.style.transform+=`scale( ${I.view.fullWidth/I.view.width}, ${I.view.fullHeight/I.view.height} )`):m.style.transform="",z.matrixWorldAutoUpdate===!0&&z.updateMatrixWorld(),I.parent===null&&I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld();let V,B;I.isOrthographicCamera&&(V=-(I.right+I.left)/2,B=(I.top+I.bottom)/2);const W=I.view&&I.view.enabled?I.view.height/I.view.fullHeight:1,X=I.isOrthographicCamera?`scale( ${W} )scale(`+L+")translate("+b(V)+"px,"+b(B)+"px)"+w(I.matrixWorldInverse):`scale( ${W} )translateZ(`+L+"px)"+w(I.matrixWorldInverse),te=(I.isPerspectiveCamera?"perspective("+L+"px) ":"")+X+"translate("+o+"px,"+l+"px)";c.camera.style!==te&&(y.style.transform=te,c.camera.style=te),R(z,z,I)},this.setSize=function(z,I){n=z,r=I,o=n/2,l=r/2,s.style.width=z+"px",s.style.height=I+"px",m.style.width=z+"px",m.style.height=I+"px",y.style.width=z+"px",y.style.height=I+"px"};function b(z){return Math.abs(z)<1e-10?0:z}function w(z){const I=z.elements;return"matrix3d("+b(I[0])+","+b(-I[1])+","+b(I[2])+","+b(I[3])+","+b(I[4])+","+b(-I[5])+","+b(I[6])+","+b(I[7])+","+b(I[8])+","+b(-I[9])+","+b(I[10])+","+b(I[11])+","+b(I[12])+","+b(-I[13])+","+b(I[14])+","+b(I[15])+")"}function E(z){const I=z.elements;return"translate(-50%,-50%)"+("matrix3d("+b(I[0])+","+b(I[1])+","+b(I[2])+","+b(I[3])+","+b(-I[4])+","+b(-I[5])+","+b(-I[6])+","+b(-I[7])+","+b(I[8])+","+b(I[9])+","+b(I[10])+","+b(I[11])+","+b(I[12])+","+b(I[13])+","+b(I[14])+","+b(I[15])+")")}function T(z){z.isCSS3DObject&&(z.element.style.display="none");for(let I=0,L=z.children.length;I<L;I++)T(z.children[I])}function R(z,I,L,V){if(z.visible===!1){T(z);return}if(z.isCSS3DObject){const B=z.layers.test(L.layers)===!0,W=z.element;if(W.style.display=B===!0?"":"none",B===!0){z.onBeforeRender(e,I,L);let X;z.isCSS3DSprite?(ph.copy(L.matrixWorldInverse),ph.transpose(),z.rotation2D!==0&&ph.multiply(Fye.makeRotationZ(z.rotation2D)),z.matrixWorld.decompose(ZO,zye,YO),ph.setPosition(ZO),ph.scale(YO),ph.elements[3]=0,ph.elements[7]=0,ph.elements[11]=0,ph.elements[15]=1,X=E(ph)):X=E(z.matrixWorld);const q=c.objects.get(z);if(q===void 0||q.style!==X){W.style.transform=X;const te={style:X};c.objects.set(z,te)}W.parentNode!==y&&y.appendChild(W),z.onAfterRender(e,I,L)}}for(let B=0,W=z.children.length;B<W;B++)R(z.children[B],I,L)}}},Bye=class{constructor(t){this.viewer=t,this.element=document.createElement("div"),this.element.className="psv-markers-css3d-container",this.renderer=new Nye({element:this.element}),this.scene=new H1,this.intersectionObserver=new IntersectionObserver(e=>{e.forEach(n=>{const r=n.target[ro];r.config.visible&&(r.viewportIntersection=n.isIntersecting)})},{root:this.element}),t.addEventListener(nr.ReadyEvent.type,this,{once:!0}),t.addEventListener(nr.SizeUpdatedEvent.type,this),t.addEventListener(nr.RenderEvent.type,this)}handleEvent(t){switch(t.type){case nr.ReadyEvent.type:case nr.SizeUpdatedEvent.type:this.updateSize();break;case nr.RenderEvent.type:this.render();break}}destroy(){this.viewer.removeEventListener(nr.ReadyEvent.type,this),this.viewer.removeEventListener(nr.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(nr.RenderEvent.type,this),this.intersectionObserver.disconnect()}updateSize(){const t=this.viewer.getSize();this.renderer.setSize(t.width,t.height)}render(){this.renderer.render(this.scene,this.viewer.renderer.camera)}addObject(t){this.scene.add(t.threeElement),this.intersectionObserver.observe(t.domElement)}removeObject(t){this.scene.remove(t.threeElement),this.intersectionObserver.unobserve(t.domElement)}},f1=(t=>(t.image="image",t.html="html",t.element="element",t.imageLayer="imageLayer",t.videoLayer="videoLayer",t.elementLayer="elementLayer",t.polygon="polygon",t.polygonPixels="polygonPixels",t.polyline="polyline",t.polylinePixels="polylinePixels",t.square="square",t.rect="rect",t.circle="circle",t.ellipse="ellipse",t.path="path",t))(f1||{});function KT(t,e=!1){const n=[];if(Object.keys(f1).forEach(r=>{t[r]&&n.push(r)}),n.length===0&&!e)throw new jn(`missing marker content, either ${Object.keys(f1).join(", ")}`);if(n.length>1)throw new jn(`multiple marker content, either ${Object.keys(f1).join(", ")}`);return n[0]}var X$=class{constructor(t,e,n){if(this.viewer=t,this.plugin=e,this.state={anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!n.id)throw new jn("missing marker id");this.type=KT(n),this.createElement(),this.update(n)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return null}get threeElement(){return null}get video(){return null}destroy(){delete this.viewer,delete this.plugin,delete this.element,this.hideTooltip()}is3d(){return!1}isNormal(){return!1}isPoly(){return!1}isSvg(){return!1}isCss3d(){return!1}update(t){const e=KT(t,!0);if(e!==void 0&&e!==this.type)throw new jn(`cannot change marker ${t.id} type`);if(this.config=Qn.deepmerge(this.config,t),typeof this.config.tooltip=="string"&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),Qn.isNil(this.config.visible)&&(this.config.visible=!0),Qn.isNil(this.config.zIndex)&&(this.config.zIndex=1),Qn.isNil(this.config.opacity)&&(this.config.opacity=1),this.config.rotation){const n=this.config.rotation;typeof n=="object"?this.config.rotation={yaw:n.yaw?Qn.parseAngle(n.yaw,!0,!1):0,pitch:n.pitch?Qn.parseAngle(n.pitch,!0,!1):0,roll:n.roll?Qn.parseAngle(n.roll,!0,!1):0}:this.config.rotation={yaw:0,pitch:0,roll:Qn.parseAngle(n,!0,!1)}}else this.config.rotation={yaw:0,pitch:0,roll:0};this.state.anchor=Qn.parsePoint(this.config.anchor)}getListContent(){return this.config.listContent?this.config.listContent:this.config.tooltip?.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(t,e,n=!1){if(this.state.visible&&this.config.tooltip?.content&&this.state.position2D){const r={...this.config.tooltip,style:{pointerEvents:this.state.staticTooltip?"auto":"none"},data:this,top:0,left:0};if(this.isPoly()||this.is3d()||this.isCss3d())if(t||e){const o=Qn.getPosition(this.viewer.container);r.top=e-o.y+10,r.left=t-o.x,r.box={width:20,height:20}}else r.top=this.state.position2D.y,r.left=this.state.position2D.x;else{const o=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);let l=this.state.size.width,c=this.state.size.height;this.config.hoverScale&&!this.state.staticTooltip&&(l*=this.config.hoverScale.amount,c*=this.config.hoverScale.amount),r.top=o.y-c*this.state.anchor.y+c/2,r.left=o.x-l*this.state.anchor.x+l/2,r.box={width:l,height:c}}this.tooltip?n?this.tooltip.update(this.config.tooltip.content,r):this.tooltip.move(r):this.tooltip=this.viewer.createTooltip(r)}}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}},uI=class extends X${get domElement(){return this.element}constructor(t,e,n){super(t,e,n)}afterCreateElement(){this.element[ro]=this}destroy(){delete this.element[ro],super.destroy()}update(t){super.update(t);const e=this.domElement;e.id=`psv-marker-${this.config.id}`,e.setAttribute("class","psv-marker"),this.state.visible&&e.classList.add("psv-marker--visible"),this.config.tooltip&&e.classList.add("psv-marker--has-tooltip"),this.config.content&&e.classList.add("psv-marker--has-content"),this.config.className&&Qn.addClasses(e,this.config.className),e.style.opacity=`${this.config.opacity}`,e.style.zIndex=`${30+this.config.zIndex}`,this.config.style&&Object.assign(e.style,this.config.style)}},iw=class extends uI{constructor(t,e,n){super(t,e,n)}afterCreateElement(){super.afterCreateElement(),this.domElement.addEventListener("transitionend",()=>{this.domElement.style.transition=""})}render({viewerPosition:t,zoomLevel:e,hoveringMarker:n}){this.__updateSize();const r=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);return r.x-=this.state.size.width*this.state.anchor.x,r.y-=this.state.size.height*this.state.anchor.y,this.state.positions3D[0].dot(this.viewer.state.direction)>0&&r.x+this.state.size.width>=0&&r.x-this.state.size.width<=this.viewer.state.size.width&&r.y+this.state.size.height>=0&&r.y-this.state.size.height<=this.viewer.state.size.height?(this.domElement.style.translate=`${r.x}px ${r.y}px 0px`,this.applyScale({zoomLevel:e,viewerPosition:t,mouseover:this===n}),r):null}update(t){if(super.update(t),!Qn.isExtendedPosition(this.config.position))throw new jn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(n){throw new jn(`invalid marker ${this.id} position`,n)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.domElement;e.classList.add("psv-marker--normal"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),typeof this.config.hoverScale=="boolean"?this.config.hoverScale=this.config.hoverScale?this.plugin.config.defaultHoverScale||YT:null:typeof this.config.hoverScale=="number"?this.config.hoverScale={amount:this.config.hoverScale}:this.config.hoverScale||(this.config.hoverScale=this.plugin.config.defaultHoverScale),this.config.hoverScale&&(this.config.hoverScale={...this.plugin.config.defaultHoverScale,...this.config.hoverScale}),e.style.rotate=this.config.rotation.roll!==0?Gr.radToDeg(this.config.rotation.roll)+"deg":null,e.style.transformOrigin=`${this.state.anchor.x*100}% ${this.state.anchor.y*100}%`}__updateSize(){if(!this.needsUpdateSize)return;const t=this.domElement,e=!this.state.visible||!this.state.size;if(e&&t.classList.add("psv-marker--transparent"),this.isSvg()){const n=t.firstElementChild.getBoundingClientRect();this.state.size={width:n.width,height:n.height}}else this.state.size={width:t.offsetWidth,height:t.offsetHeight};e&&t.classList.remove("psv-marker--transparent"),this.isSvg()&&(t.style.width=this.state.size.width+"px",t.style.height=this.state.size.height+"px"),this.type!=="element"&&(this.needsUpdateSize=!1)}applyScale({zoomLevel:t,viewerPosition:e,mouseover:n}){n!==null&&this.config.hoverScale&&(this.domElement.style.transition=`scale ${this.config.hoverScale.duration}ms ${this.config.hoverScale.easing}`);let r=1;if(typeof this.config.scale=="function")r=this.config.scale(t,e);else if(this.config.scale){if(Array.isArray(this.config.scale.zoom)){const[o,l]=this.config.scale.zoom;r*=o+(l-o)*oy.EASINGS.inQuad(t/100)}if(Array.isArray(this.config.scale.yaw)){const[o,l]=this.config.scale.yaw,c=Gr.degToRad(this.viewer.state.hFov)/2,s=Math.abs(Qn.getShortestArc(this.state.position.yaw,e.yaw));r*=l+(o-l)*oy.EASINGS.outQuad(Math.max(0,(c-s)/c))}}n&&this.config.hoverScale&&(r*=this.config.hoverScale.amount),this.domElement.style.scale=`${r}`}},Uye=`// https://www.8thwall.com/playground/chromakey-threejs

uniform sampler2D map;
uniform float alpha;
uniform bool keying;
uniform vec3 color;
uniform float similarity;
uniform float smoothness;
uniform float spill;

varying vec2 vUv;

vec2 RGBtoUV(vec3 rgb) {
    return vec2(
        rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,
        rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5
    );
}

void main(void) {
    gl_FragColor = texture2D(map, vUv);

    if (keying) {
        float chromaDist = distance(RGBtoUV(gl_FragColor.rgb), RGBtoUV(color));

        float baseMask = chromaDist - similarity;
        float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);
        gl_FragColor.a *= fullMask * alpha;

        float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);
        float desat = clamp(gl_FragColor.r * 0.2126 + gl_FragColor.g * 0.7152 + gl_FragColor.b * 0.0722, 0., 1.);
        gl_FragColor.rgb = mix(vec3(desat, desat, desat), gl_FragColor.rgb, spillVal);
    } else {
        gl_FragColor.a *= alpha;
    }
}
`,$ye=`varying vec2 vUv;
uniform vec2 repeat;
uniform vec2 offset;

void main() {
    vUv = uv * repeat + offset;
    gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );
}
`,Vye=class extends Zd{get map(){return this.uniforms.map.value}set map(t){this.uniforms.map.value=t}set alpha(t){this.uniforms.alpha.value=t}get offset(){return this.uniforms.offset.value}get repeat(){return this.uniforms.repeat.value}set chromaKey(t){this.uniforms.keying.value=t?.enabled===!0,t?.enabled&&(typeof t.color=="object"&&"r"in t.color?this.uniforms.color.value.set(t.color.r/255,t.color.g/255,t.color.b/255):this.uniforms.color.value.set(t.color??65280),this.uniforms.similarity.value=t.similarity??.2,this.uniforms.smoothness.value=t.smoothness??.2)}constructor(t){super({transparent:!0,depthTest:!1,depthWrite:!1,uniforms:{map:{value:t?.map},repeat:{value:new mi(1,1)},offset:{value:new mi(0,0)},alpha:{value:t?.alpha??1},keying:{value:!1},color:{value:new xi(65280)},similarity:{value:.2},smoothness:{value:.2},spill:{value:.1}},vertexShader:$ye,fragmentShader:Uye}),this.chromaKey=t?.chromaKey}};function jye({src:t,withCredentials:e,muted:n,autoplay:r}){const o=document.createElement("video");return o.crossOrigin=e?"use-credentials":"anonymous",o.loop=!0,o.playsInline=!0,o.autoplay=r,o.muted=n,o.preload="metadata",t instanceof MediaStream?o.srcObject=t:o.src=t,o}function Hye(t,e,n){const[r,o]=t,[l,c]=e,s=Qn.greatArcDistance(t,e),m=Math.sin((1-n)*s)/Math.sin(s),y=Math.sin(n*s)/Math.sin(s),b=m*Math.cos(o)*Math.cos(r)+y*Math.cos(c)*Math.cos(l),w=m*Math.cos(o)*Math.sin(r)+y*Math.cos(c)*Math.sin(l),E=m*Math.sin(o)+y*Math.sin(c);return[Math.atan2(w,b),Math.atan2(E,Math.sqrt(b*b+w*w))]}function Gye(t){const e=[t[0]];let n=0;for(let r=1;r<t.length;r++){const o=t[r-1][0]-t[r][0];o>Math.PI?n+=1:o<-Math.PI&&(n-=1),e.push([t[r][0]+n*2*Math.PI,t[r][1]])}return e}function Z$(t){return t.reduce((e,n)=>e.add(n),new Pt).normalize()}function Wye(t){const e=Gye(t);let n=0;const r=[];for(let l=0;l<e.length-1;l++){const c=Qn.greatArcDistance(e[l],e[l+1])*oy.SPHERE_RADIUS;r.push(c),n+=c}let o=0;for(let l=0;l<e.length-1;l++){if(o+r[l]>n/2){const c=(n/2-o)/r[l];return Hye(e[l],e[l+1],c)}o+=r[l]}return e[Math.round(e.length/2)]}var Bb=new Pt,KO=new Pt,l2=new Pt,JO=new Pt,QO=new Pt,e5=new Pt;function qye(t,e,n){Bb.copy(n).normalize(),KO.crossVectors(t,e).normalize(),l2.crossVectors(KO,t).normalize(),JO.copy(t).multiplyScalar(-Bb.dot(l2)),QO.copy(l2).multiplyScalar(Bb.dot(t));const r=new Pt().addVectors(JO,QO).normalize();return e5.crossVectors(r,Bb),r.applyAxisAngle(e5,.01).multiplyScalar(oy.SPHERE_RADIUS)}var Xye=class extends X${get threeElement(){return this.element}get threeMesh(){return this.threeElement.children[0]}get video(){return this.type==="videoLayer"?this.threeMesh.material.map.image:null}constructor(t,e,n){super(t,e,n)}is3d(){return!0}createElement(){const t=new Vye({alpha:0}),e=new ux(1,1),n=new Ja(e,t);n.userData={[ro]:this},Object.defineProperty(n,"visible",{enumerable:!0,get:function(){return this.userData[ro].config.visible},set:function(r){this.userData[ro].config.visible=r}}),this.element=new Yf().add(n),this.type==="videoLayer"&&this.viewer.needsContinuousUpdate(!0)}destroy(){delete this.threeMesh.userData[ro],this.type==="videoLayer"&&(this.video.pause(),this.viewer.needsContinuousUpdate(!1)),super.destroy()}render(){return this.viewer.renderer.isObjectVisible(this.threeMesh)?this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position):null}update(t){super.update(t);const e=this.threeMesh,n=e.parent,r=e.material;if(Qn.isExtendedPosition(this.config.position)){try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(l){throw new jn(`invalid marker ${this.id} position`,l)}if(!this.config.size)throw new jn(`missing marker ${this.id} size`);this.state.size=this.config.size,e.scale.set(this.config.size.width/100,this.config.size.height/100,1),e.position.set(e.scale.x*(.5-this.state.anchor.x),e.scale.y*(this.state.anchor.y-.5),0),e.rotation.set(0,0,0),this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position,n.position),n.lookAt(0,n.position.y,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll);const o=e.geometry.getAttribute("position");this.state.positions3D=[0,1,3,2].map(l=>{const c=new Pt;return c.fromBufferAttribute(o,l),e.localToWorld(c)})}else{if(this.config.position?.length!==4)throw new jn(`missing marker ${this.id} position`);let o;try{o=this.config.position.map(m=>this.viewer.dataHelper.cleanPosition(m))}catch(m){throw new jn(`invalid marker ${this.id} position`,m)}const l=o.map(m=>this.viewer.dataHelper.sphericalCoordsToVector3(m)),c=Z$(l);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(c),this.state.positions3D=l;const s=e.geometry.getAttribute("position");[l[0],l[1],l[3],l[2]].forEach((m,y)=>{s.setX(y,m.x),s.setY(y,m.y),s.setZ(y,m.z)}),s.needsUpdate=!0,this.__setTextureWrap(r)}switch(this.type){case"videoLayer":if(this.definition!==this.config.videoLayer){r.map?.dispose();const o=jye({src:this.config.videoLayer,withCredentials:this.viewer.config.withCredentials(this.config.videoLayer),muted:!0,autoplay:this.config.autoplay??!0}),l=new khe(o);r.map=l,r.alpha=0,o.addEventListener("loadedmetadata",()=>{this.viewer&&(r.alpha=this.config.opacity,Qn.isExtendedPosition(this.config.position)||(e.material.userData[ro]={width:o.videoWidth,height:o.videoHeight},this.__setTextureWrap(r)))},{once:!0}),o.autoplay&&o.play(),this.definition=this.config.videoLayer}else r.alpha=this.config.opacity;break;case"imageLayer":if(this.definition!==this.config.imageLayer){r.map?.dispose();const o=new Xs;r.map=o,r.alpha=0,this.viewer.textureLoader.loadImage(this.config.imageLayer).then(l=>{this.viewer&&(Qn.isExtendedPosition(this.config.position)||(e.material.userData[ro]={width:l.width,height:l.height},this.__setTextureWrap(r)),o.image=l,o.anisotropy=4,o.needsUpdate=!0,r.alpha=this.config.opacity,this.viewer.needsUpdate())}),this.definition=this.config.imageLayer}else r.alpha=this.config.opacity;break}r.chromaKey=this.config.chromaKey,e.renderOrder=1e3+this.config.zIndex,e.geometry.boundingBox=null}__setTextureWrap(t){const e=t.userData[ro];if(!e||!e.height||!e.width){t.repeat.set(1,1),t.offset.set(0,0);return}const n=this.config.position.map(w=>this.viewer.dataHelper.cleanPosition(w)),r=Qn.greatArcDistance([n[0].yaw,n[0].pitch],[n[1].yaw,n[1].pitch]),o=Qn.greatArcDistance([n[3].yaw,n[3].pitch],[n[2].yaw,n[2].pitch]),l=Qn.greatArcDistance([n[1].yaw,n[1].pitch],[n[2].yaw,n[2].pitch]),c=Qn.greatArcDistance([n[0].yaw,n[0].pitch],[n[3].yaw,n[3].pitch]),s=(r+o)/(l+c),m=e.width/e.height;let y=0,b=0;s<m?y=m-s:b=1/m-1/s,t.repeat.set(1-y,1-b),t.offset.set(y/2,b/2)}},Zye=class extends uI{constructor(t,e,n){super(t,e,n),this.viewportIntersection=!1}get threeElement(){return this.object}isCss3d(){return!0}createElement(){this.element=document.createElement("div"),this.object=new Oye(this.element),this.object.userData={[ro]:this},Object.defineProperty(this.object,"visible",{enumerable:!0,get:function(){return this.userData[ro].config.visible},set:function(t){this.userData[ro].config.visible=t}}),this.afterCreateElement()}destroy(){delete this.object.userData[ro],delete this.object,super.destroy()}render({viewerPosition:t,zoomLevel:e}){const n=this.domElement;if(this.state.size={width:n.offsetWidth,height:n.offsetHeight},this.state.positions3D[0].dot(this.viewer.state.direction)>0&&this.viewportIntersection){const o=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position);return this.config.elementLayer.updateMarker?.({marker:this,position:o,viewerPosition:t,zoomLevel:e,viewerSize:this.viewer.state.size}),o}else return null}update(t){if(super.update(t),!Qn.isExtendedPosition(this.config.position))throw new jn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(r){throw new jn(`invalid marker ${this.id} position`,r)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.threeElement,n=this.domElement;n.classList.add("psv-marker--css3d"),n.childNodes.forEach(r=>r.remove()),n.appendChild(this.config.elementLayer),this.config.elementLayer.style.display="block",e.position.copy(this.state.positions3D[0]).multiplyScalar(100),e.lookAt(0,this.state.positions3D[0].y*100,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll)}},Yye=class extends iw{constructor(t,e,n){super(t,e,n)}isNormal(){return!0}createElement(){this.element=document.createElement("div"),this.afterCreateElement()}render(t){const e=super.render(t);return e&&this.type==="element"&&this.config.element.updateMarker?.({marker:this,position:e,viewerPosition:t.viewerPosition,zoomLevel:t.zoomLevel,viewerSize:this.viewer.state.size}),e}update(t){super.update(t);const e=this.domElement;if(this.config.image&&!this.config.size)throw new jn(`missing marker ${this.id} size`);switch(this.config.size?(this.needsUpdateSize=!1,this.state.size=this.config.size,e.style.width=this.config.size.width+"px",e.style.height=this.config.size.height+"px"):this.needsUpdateSize=!0,this.type){case"image":this.definition=this.config.image,e.style.backgroundImage=`url("${this.config.image}")`;break;case"html":this.definition=this.config.html,e.innerHTML=this.config.html;break;case"element":this.definition!==this.config.element&&(this.definition=this.config.element,e.childNodes.forEach(n=>n.remove()),e.appendChild(this.config.element),this.config.element.style.display="block");break}}},Kye=class extends uI{constructor(t,e,n){super(t,e,n)}createElement(){this.element=document.createElementNS(rw,"path"),this.element[ro]=this}isPoly(){return!0}get isPixels(){return this.type==="polygonPixels"||this.type==="polylinePixels"}get isPolygon(){return this.type==="polygon"||this.type==="polygonPixels"}get isPolyline(){return this.type==="polyline"||this.type==="polylinePixels"}get coords(){return this.definition}render(){const t=this.__getAllPolyPositions();if(t[0].length>(this.isPolygon?2:1)){const n=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position),r=t.filter(o=>o.length>0).map(o=>{let l="M";return l+=o.map(c=>`${c.x-n.x},${c.y-n.y}`).join("L"),this.isPolygon&&(l+="Z"),l}).join(" ");return this.domElement.setAttributeNS(null,"d",r),this.domElement.setAttributeNS(null,"transform",`translate(${n.x} ${n.y})`),n}else return null}update(t){super.update(t);const e=this.domElement;e.classList.add("psv-marker--poly"),this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach(([n,r])=>{e.setAttributeNS(null,Qn.dasherize(n),r)}),this.isPolyline&&!this.config.svgStyle.fill&&e.setAttributeNS(null,"fill","none")):this.isPolygon?e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline&&(e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke","rgb(0,0,0)"));try{let n=this.config[this.type];if(!Array.isArray(n[0])&&typeof n[0]!="object")for(let r=0;r<n.length;r++)n.splice(r,2,[n[r],n[r+1]]);if(!Array.isArray(n[0][0])&&typeof n[0][0]!="object"&&(n=[n]),this.isPolyline&&n.length>1)throw new jn("polylines cannot have holes");this.isPixels?this.definition=n.map(r=>r.map(o=>{let l;return Qn.isExtendedPosition(o)?l=this.viewer.dataHelper.cleanPosition(o):l=this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:o[0],textureY:o[1]}),[l.yaw,l.pitch]})):this.definition=n.map(r=>r.map(o=>{let l;return Qn.isExtendedPosition(o)?l=this.viewer.dataHelper.cleanPosition(o):l=this.viewer.dataHelper.cleanPosition({yaw:o[0],pitch:o[1]}),[l.yaw,l.pitch]}))}catch(n){throw new jn(`invalid marker ${this.id} position`,n)}if(this.positions3D=this.coords.map(n=>n.map(r=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:r[0],pitch:r[1]}))),this.isPolygon){const n=Z$(this.positions3D[0]);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(n)}else{const n=Wye(this.coords[0]);this.state.position={yaw:n[0],pitch:n[1]}}this.state.positions3D=this.positions3D[0]}__getAllPolyPositions(){return this.positions3D.map(t=>this.__getPolyPositions(t))}__getPolyPositions(t){const e=t.length,n=t.map(o=>({vector:o,visible:o.dot(this.viewer.state.direction)>0})),r=[];return n.forEach((o,l)=>{o.visible||[l===0?n[e-1]:n[l-1],l===e-1?n[0]:n[l+1]].forEach(s=>{s.visible&&r.push({visible:s.vector,invisible:o.vector,index:l})})}),r.reverse().forEach(o=>{n.splice(o.index,0,{vector:qye(o.visible,o.invisible,this.viewer.state.direction),visible:!0})}),n.filter(o=>o.visible).map(o=>this.viewer.dataHelper.vector3ToViewerCoords(o.vector))}},Jye=class extends iw{get svgElement(){return this.domElement.firstElementChild}constructor(t,e,n){super(t,e,n)}isSvg(){return!0}createElement(){const t=this.type==="square"?"rect":this.type,e=document.createElementNS(rw,t);this.element=document.createElementNS(rw,"svg"),this.element.appendChild(e),this.afterCreateElement()}update(t){super.update(t);const e=this.svgElement;switch(this.needsUpdateSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path};break}Object.entries(this.definition).forEach(([n,r])=>{e.setAttributeNS(null,n,r)}),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach(([n,r])=>{e.setAttributeNS(null,Qn.dasherize(n),r)}):e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)")}},Qye=Qn.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null,defaultHoverScale:null},{defaultHoverScale(t){return t?(t===!0&&(t=YT),typeof t=="number"&&(t={amount:t}),{...YT,...t}):null}});function e0e(t){switch(KT(t,!1)){case"image":case"html":case"element":return Yye;case"imageLayer":case"videoLayer":return Xye;case"elementLayer":return Zye;case"polygon":case"polyline":case"polygonPixels":case"polylinePixels":return Kye;case"square":case"rect":case"circle":case"ellipse":case"path":return Jye;default:throw new jn("invalid marker type")}}var gx=class Y$ extends iI{constructor(e,n){super(e,n),this.markers={},this.state={allVisible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null,needsReRender:!1,lastClientX:null,lastClientY:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",r=>r.preventDefault()),this.svgContainer=document.createElementNS(rw,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.css3DContainer=new Bye(e),this.container.appendChild(this.css3DContainer.element),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0)}static withConfig(e){return[Y$,e]}init(){super.init(),Qn.checkStylesheet(this.viewer.container,"markers-plugin"),this.viewer.addEventListener(nr.ClickEvent.type,this),this.viewer.addEventListener(nr.DoubleClickEvent.type,this),this.viewer.addEventListener(nr.RenderEvent.type,this),this.viewer.addEventListener(nr.ConfigChangedEvent.type,this),this.viewer.addEventListener(nr.ObjectEnterEvent.type,this),this.viewer.addEventListener(nr.ObjectHoverEvent.type,this),this.viewer.addEventListener(nr.ObjectLeaveEvent.type,this),this.viewer.addEventListener(nr.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(ro),this.viewer.removeEventListener(nr.ClickEvent.type,this),this.viewer.removeEventListener(nr.DoubleClickEvent.type,this),this.viewer.removeEventListener(nr.RenderEvent.type,this),this.viewer.removeEventListener(nr.ObjectEnterEvent.type,this),this.viewer.removeEventListener(nr.ObjectHoverEvent.type,this),this.viewer.removeEventListener(nr.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(nr.ReadyEvent.type,this),this.css3DContainer.destroy(),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(e){switch(e.type){case nr.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case nr.RenderEvent.type:this.renderMarkers();break;case nr.ClickEvent.type:this.__onClick(e,!1);break;case nr.DoubleClickEvent.type:this.__onClick(e,!0);break;case nr.ObjectEnterEvent.type:case nr.ObjectLeaveEvent.type:case nr.ObjectHoverEvent.type:if(e.userDataKey===ro){const n=e.originalEvent,r=e.object.userData[ro];switch(e.type){case nr.ObjectEnterEvent.type:r.config.style?.cursor?this.viewer.setCursor(r.config.style.cursor):(r.config.tooltip||r.config.content)&&this.viewer.setCursor("pointer"),this.__onEnterMarker(n,r);break;case nr.ObjectLeaveEvent.type:this.viewer.setCursor(null),this.__onLeaveMarker(r);break;case nr.ObjectHoverEvent.type:this.__onHoverMarker(n,r);break}}break;case"mouseenter":{const n=this.__getTargetMarker(Qn.getEventTarget(e));this.__onEnterMarker(e,n);break}case"mouseleave":{const n=this.__getTargetMarker(Qn.getEventTarget(e));this.__onLeaveMarker(n);break}case"mousemove":{const n=this.__getTargetMarker(Qn.getEventTarget(e),!0);this.__onHoverMarker(e,n);break}}}toggleAllMarkers(){this.state.allVisible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.allVisible=!0,Object.values(this.markers).forEach(e=>{e.config.visible=!0}),this.renderMarkers(),this.dispatchEvent(new o_)}hideAllMarkers(){this.state.allVisible=!1,Object.values(this.markers).forEach(e=>{e.config.visible=!1}),this.renderMarkers(),this.dispatchEvent(new i_)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach(e=>{e.state.staticTooltip=!0,e.showTooltip()})}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach(e=>{e.state.staticTooltip=!1,e.hideTooltip()})}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(e,n=!0){if(this.markers[e.id])throw new jn(`marker "${e.id}" already exists`);const r=new(e0e(e))(this.viewer,this,e);r.isPoly()?this.svgContainer.appendChild(r.domElement):r.isCss3d()?this.css3DContainer.addObject(r):r.is3d()?this.viewer.renderer.addObject(r.threeElement):this.container.appendChild(r.domElement),this.markers[r.id]=r,this.state.showAllTooltips&&(r.state.staticTooltip=!0),n&&this.__afterChangeMarkers()}getMarker(e){const n=typeof e=="object"?e.id:e;if(!this.markers[n])throw new jn(`cannot find marker "${n}"`);return this.markers[n]}getCurrentMarker(){return this.state.currentMarker}updateMarker(e,n=!0){const r=this.getMarker(e.id);r.update(e),n&&(this.__afterChangeMarkers(),(r===this.state.hoveringMarker&&r.config.tooltip?.trigger==="hover"||r.state.staticTooltip)&&r.showTooltip(this.state.lastClientX,this.state.lastClientY,!0))}removeMarker(e,n=!0){const r=this.getMarker(e);r.isPoly()?this.svgContainer.removeChild(r.domElement):r.isCss3d()?this.css3DContainer.removeObject(r):r.is3d()?this.viewer.renderer.removeObject(r.threeElement):this.container.removeChild(r.domElement),this.state.hoveringMarker===r&&(this.state.hoveringMarker=null),this.state.currentMarker===r&&(this.state.currentMarker=null),r.destroy(),delete this.markers[r.id],n&&this.__afterChangeMarkers()}removeMarkers(e,n=!0){e.forEach(r=>this.removeMarker(r,!1)),n&&this.__afterChangeMarkers()}setMarkers(e,n=!0){this.clearMarkers(!1),e?.forEach(r=>{this.addMarker(r,!1)}),n&&this.__afterChangeMarkers()}clearMarkers(e=!0){Object.keys(this.markers).forEach(n=>{this.removeMarker(n,!1)}),e&&this.__afterChangeMarkers()}gotoMarker(e,n=this.config.gotoMarkerSpeed){const r=this.getMarker(e);return n?this.viewer.animate({...r.state.position,zoom:r.config.zoomLvl,speed:n}).then(()=>{this.dispatchEvent(new ZT(r))}):(this.viewer.rotate(r.state.position),Qn.isNil(r.config.zoomLvl)||this.viewer.zoom(r.config.zoomLvl),this.dispatchEvent(new ZT(r)),Promise.resolve())}hideMarker(e){this.toggleMarker(e,!1)}showMarker(e){this.toggleMarker(e,!0)}showMarkerTooltip(e){const n=this.getMarker(e);n.state.staticTooltip=!0,n.showTooltip()}hideMarkerTooltip(e){const n=this.getMarker(e);n.state.staticTooltip=!1,n.hideTooltip()}toggleMarker(e,n){const r=this.getMarker(e);r.config.visible=Qn.isNil(n)?!r.config.visible:n,this.renderMarkers()}showMarkerPanel(e){const n=this.getMarker(e);n.config.content?this.viewer.panel.show({id:x0,content:n.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(x0)}toggleMarkersList(){this.viewer.panel.isVisible(bv)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let e=[];Object.values(this.markers).forEach(r=>{r.config.visible&&!r.config.hideList&&e.push(r)});const n=new W$(e);this.dispatchEvent(n),e=n.markers,this.viewer.panel.show({id:bv,content:kye(e,this.viewer.config.lang[T_.id]),noMargin:!0,clickHandler:r=>{const o=Qn.getClosest(r,".psv-panel-menu-item"),l=o?o.dataset[ro]:void 0;if(l){const c=this.getMarker(l);this.dispatchEvent(new D$(c)),this.gotoMarker(c.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(bv)}renderMarkers(){if(this.state.needsReRender){this.state.needsReRender=!1;return}const e=this.viewer.getZoomLevel(),n=this.viewer.getPosition(),r=this.state.hoveringMarker;Object.values(this.markers).forEach(o=>{let l=o.config.visible,c=!1,s=null;l&&(s=o.render({viewerPosition:n,zoomLevel:e,hoveringMarker:r}),l=!!s),c=o.state.visible!==l,o.state.visible=l,o.state.position2D=s,o.domElement&&Qn.toggleClass(o.domElement,"psv-marker--visible",l),l?o.state.staticTooltip?o.showTooltip():o!==this.state.hoveringMarker&&o.hideTooltip():o.hideTooltip(),c&&(this.dispatchEvent(new _$(o,l)),(o.is3d()||o.isCss3d())&&(this.state.needsReRender=!0))}),this.state.needsReRender&&this.viewer.needsUpdate()}__getTargetMarker(e,n=!1){if(e instanceof Node){const r=n?Qn.getClosest(e,".psv-marker"):e;return r?r[ro]:void 0}else return Array.isArray(e)?e.map(r=>r.userData[ro]).filter(r=>!!r).sort((r,o)=>o.config.zIndex-r.config.zIndex)[0]:null}__onEnterMarker(e,n){n&&(this.state.hoveringMarker=n,this.state.lastClientX=e.clientX,this.state.lastClientY=e.clientY,this.dispatchEvent(new T$(n)),n instanceof iw&&n.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!0}),!n.state.staticTooltip&&n.config.tooltip?.trigger==="hover"&&n.showTooltip(e.clientX,e.clientY))}__onLeaveMarker(e){e&&(this.dispatchEvent(new M$(e)),e instanceof iw&&e.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!1}),this.state.hoveringMarker=null,!e.state.staticTooltip&&e.config.tooltip?.trigger==="hover"?e.hideTooltip():e.state.staticTooltip&&e.showTooltip())}__onHoverMarker(e,n){n&&(this.state.lastClientX=e.clientX,this.state.lastClientY=e.clientY,(n.isPoly()||n.is3d()||n.isCss3d())&&n.config.tooltip?.trigger==="hover"&&n.showTooltip(e.clientX,e.clientY))}__onClick(e,n){const r=this.__getTargetMarker(e.data.objects),l=this.__getTargetMarker(e.data.target,!0)||r;this.state.currentMarker&&this.state.currentMarker!==l&&(this.dispatchEvent(new O$(this.state.currentMarker)),this.viewer.panel.hide(x0),!this.state.showAllTooltips&&this.state.currentMarker.config.tooltip?.trigger==="click"&&this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null),l&&(this.state.currentMarker=l,this.dispatchEvent(new I$(l,n,e.data.rightclick)),this.config.clickEventOnMarker?e.data.marker=l:e.stopImmediatePropagation(),this.markers[l.id]&&!e.data.rightclick&&(l.config.tooltip?.trigger==="click"?l.tooltip?this.hideMarkerTooltip(l.id):this.showMarkerTooltip(l.id):this.showMarkerPanel(l.id)))}__afterChangeMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new $$(this.getMarkers()))}__refreshUi(){const e=Object.values(this.markers).filter(n=>!n.config.hideList).length;e===0?(this.viewer.panel.hide(x0),this.viewer.panel.hide(bv)):this.viewer.panel.isVisible(bv)?this.showMarkersList():this.viewer.panel.isVisible(x0)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),this.viewer.navbar.getButton(T_.id,!1)?.toggle(e>0),this.viewer.navbar.getButton(uS.id,!1)?.toggle(e>0)}__checkObjectsObserver(){Object.values(this.markers).some(n=>n.is3d())?this.viewer.observeObjects(ro):this.viewer.unobserveObjects(ro)}};gx.id="markers";gx.VERSION="5.13.4";gx.configParser=Qye;gx.readonlyOptions=["markers"];var t0e=gx;Yd.lang[T_.id]="Markers";Yd.lang[uS.id]="Markers list";oI(T_,"caption:left");oI(uS,"caption:left");const Cm=[{id:"0",point:[-92.12572989672026,38.53421432713342]},{id:"1",point:[-92.12304341293509,38.53672723512331]},{id:"2",point:[-92.11945284530871,38.54133496582979]},{id:"3",point:[-92.11576785749503,38.54478606247235]},{id:"4",point:[-92.10778464530942,38.544770729312454]},{id:"5",point:[-92.10258732764407,38.541357585467786]},{id:"6",point:[-92.09670854574377,38.53854148846571]},{id:"7",point:[-92.09328790813723,38.53629576427041]},{id:"8",point:[-92.11176575050796,38.5479069429093]}],n0e={id:"marker-viewpoint",image:"map-icons/viewpoint.png",gps:[-92.102043,38.54042],size:{width:32,height:32}},r0e={id:"marker-photo-trophy",image:"map-icons/photo_sight_captured.png",gps:[-92.157874,38.578638],size:{width:32,height:32}},b0=[n0e,r0e],i0e=t=>e=>({width:8192,cols:16,rows:8,baseUrl:`${t}/${e}_thumb.jpg`,tileUrl:(n,r)=>`${t}/${e}_${n}_${r}.jpg`}),o0e=t=>{const e=o=>({id:`node-${o}`,panorama:t(o),gps:Cm[o].point}),n=(...o)=>o.map(l=>({nodeId:`node-${l}`}));return{positionMode:"gps",nodes:[{...e(0),links:n(1)},{...e(1),links:n(0,2)},{...e(2),links:n(1,3)},{...e(3),links:n(2,8)},{...e(4),links:n(8,5),markers:b0},{...e(5),links:n(4,6),markers:b0},{...e(6),links:n(5,7),markers:b0},{...e(7),links:n(6),markers:b0},{...e(8),links:n(3,4),markers:b0}]}},s0e=t=>{const e=H.useRef(null),n=H.useRef(null),r=H.useRef(null),o=i0e(t.pixelRootUrl),l=o0e(o),c=(y,b)=>xr(r.current).setRotation(b/Math.PI*180),s=({node:y})=>{const[b,w]=xr(y.gps),E=[b,w];xr(e.current).panTo(E),xr(r.current).setLngLat(E)},m=()=>{const y=xr(n.current);xr(y.getPlugin(ew)).addEventListener("node-changed",s)};return H.useEffect(()=>{document.title="ATS Street View Proof of Concept"}),oe.jsxs(oe.Fragment,{children:[oe.jsx(lI,{ref:n,adapter:r$,plugins:[ew.withConfig(l),t0e],src:o(0),height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:c,onReady:m}),oe.jsx("div",{className:"credits",children:"Game data and images © SCS Software. Images captured by Trucker Mudgeon."}),oe.jsxs(jw,{ref:e,style:{position:"absolute",left:20,bottom:20,width:"250px",height:"125px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:4,maxZoom:15,maxBounds:[Cm[0].point.map(y=>y-1),Cm[0].point.map(y=>y+1)],mapStyle:Ww,attributionControl:!1,initialViewState:{longitude:Cm[0].point[0],latitude:Cm[0].point[1],zoom:12},children:[oe.jsx(aA,{ref:r,longitude:Cm[0].point[0],latitude:Cm[0].point[1],rotationAlignment:"map",children:oe.jsx("div",{className:"street-view-marker"})}),oe.jsx(Gw,{tileRootUrl:t.tileRootUrl,mode:"light"}),oe.jsx(Jv,{tileRootUrl:t.tileRootUrl,game:"ats",mode:"light",enableIconAutoHide:!0,visibleIcons:ap,dlcs:$m})]})]})},c2="https://maps.truckermudgeon.com",t5="https://pixels.truckermudgeon.com",a0e=iJ(DK([oe.jsx(Xb,{path:"/",element:oe.jsx(dye,{tileRootUrl:c2,pixelRootUrl:t5})}),oe.jsx(Xb,{path:"routes",element:oe.jsx(Eye,{tileRootUrl:c2})}),oe.jsx(Xb,{path:"street-view",element:oe.jsx(s0e,{tileRootUrl:c2,pixelRootUrl:t5})})])),l0e=$5({components:{JoyIconButton:{styleOverrides:{root:{backgroundColor:"var(--joy-palette-background-surface)"}}}}}),c0e=document.getElementById("root"),u0e=cY.createRoot(c0e);u0e.render(oe.jsx(H.StrictMode,{children:oe.jsxs(F9,{defaultMode:"system",modeStorageKey:"tm-mode",theme:l0e,children:[oe.jsx(cX,{}),oe.jsx(vJ,{router:a0e})]})}))});export default h0e();
