var qq=Object.defineProperty;var Xq=(e,t,n)=>t in e?qq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Zq=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ND=(e,t,n)=>Xq(e,typeof t!="symbol"?t+"":t,n);var IAe=Zq(Xn=>{function UB(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(r,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();var lP=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $I(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Yq(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return e[r]}})}),n}var $B={exports:{}},RS={},VB={exports:{}},gr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g_=Symbol.for("react.element"),Kq=Symbol.for("react.portal"),Jq=Symbol.for("react.fragment"),Qq=Symbol.for("react.strict_mode"),eX=Symbol.for("react.profiler"),tX=Symbol.for("react.provider"),nX=Symbol.for("react.context"),rX=Symbol.for("react.forward_ref"),iX=Symbol.for("react.suspense"),oX=Symbol.for("react.memo"),sX=Symbol.for("react.lazy"),BD=Symbol.iterator;function aX(e){return e===null||typeof e!="object"?null:(e=BD&&e[BD]||e["@@iterator"],typeof e=="function"?e:null)}var jB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HB=Object.assign,GB={};function Ig(e,t,n){this.props=e,this.context=t,this.refs=GB,this.updater=n||jB}Ig.prototype.isReactComponent={};Ig.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ig.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function WB(){}WB.prototype=Ig.prototype;function VI(e,t,n){this.props=e,this.context=t,this.refs=GB,this.updater=n||jB}var jI=VI.prototype=new WB;jI.constructor=VI;HB(jI,Ig.prototype);jI.isPureReactComponent=!0;var UD=Array.isArray,qB=Object.prototype.hasOwnProperty,HI={current:null},XB={key:!0,ref:!0,__self:!0,__source:!0};function ZB(e,t,n){var r,i={},a=null,c=null;if(t!=null)for(r in t.ref!==void 0&&(c=t.ref),t.key!==void 0&&(a=""+t.key),t)qB.call(t,r)&&!XB.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var f=Array(s),g=0;g<s;g++)f[g]=arguments[g+2];i.children=f}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:g_,type:e,key:a,ref:c,props:i,_owner:HI.current}}function lX(e,t){return{$$typeof:g_,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function GI(e){return typeof e=="object"&&e!==null&&e.$$typeof===g_}function cX(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var $D=/\/+/g;function k2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?cX(""+e.key):t.toString(36)}function Tb(e,t,n,r,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var c=!1;if(e===null)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case g_:case Kq:c=!0}}if(c)return c=e,i=i(c),e=r===""?"."+k2(c,0):r,UD(i)?(n="",e!=null&&(n=e.replace($D,"$&/")+"/"),Tb(i,t,n,"",function(g){return g})):i!=null&&(GI(i)&&(i=lX(i,n+(!i.key||c&&c.key===i.key?"":(""+i.key).replace($D,"$&/")+"/")+e)),t.push(i)),1;if(c=0,r=r===""?".":r+":",UD(e))for(var s=0;s<e.length;s++){a=e[s];var f=r+k2(a,s);c+=Tb(a,t,n,f,i)}else if(f=aX(e),typeof f=="function")for(e=f.call(e),s=0;!(a=e.next()).done;)a=a.value,f=r+k2(a,s++),c+=Tb(a,t,n,f,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function y1(e,t,n){if(e==null)return e;var r=[],i=0;return Tb(e,r,"","",function(a){return t.call(n,a,i++)}),r}function uX(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var bs={current:null},Pb={transition:null},hX={ReactCurrentDispatcher:bs,ReactCurrentBatchConfig:Pb,ReactCurrentOwner:HI};function YB(){throw Error("act(...) is not supported in production builds of React.")}gr.Children={map:y1,forEach:function(e,t,n){y1(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return y1(e,function(){t++}),t},toArray:function(e){return y1(e,function(t){return t})||[]},only:function(e){if(!GI(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};gr.Component=Ig;gr.Fragment=Jq;gr.Profiler=eX;gr.PureComponent=VI;gr.StrictMode=Qq;gr.Suspense=iX;gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hX;gr.act=YB;gr.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=HB({},e.props),i=e.key,a=e.ref,c=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,c=HI.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(f in t)qB.call(t,f)&&!XB.hasOwnProperty(f)&&(r[f]=t[f]===void 0&&s!==void 0?s[f]:t[f])}var f=arguments.length-2;if(f===1)r.children=n;else if(1<f){s=Array(f);for(var g=0;g<f;g++)s[g]=arguments[g+2];r.children=s}return{$$typeof:g_,type:e.type,key:i,ref:a,props:r,_owner:c}};gr.createContext=function(e){return e={$$typeof:nX,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:tX,_context:e},e.Consumer=e};gr.createElement=ZB;gr.createFactory=function(e){var t=ZB.bind(null,e);return t.type=e,t};gr.createRef=function(){return{current:null}};gr.forwardRef=function(e){return{$$typeof:rX,render:e}};gr.isValidElement=GI;gr.lazy=function(e){return{$$typeof:sX,_payload:{_status:-1,_result:e},_init:uX}};gr.memo=function(e,t){return{$$typeof:oX,type:e,compare:t===void 0?null:t}};gr.startTransition=function(e){var t=Pb.transition;Pb.transition={};try{e()}finally{Pb.transition=t}};gr.unstable_act=YB;gr.useCallback=function(e,t){return bs.current.useCallback(e,t)};gr.useContext=function(e){return bs.current.useContext(e)};gr.useDebugValue=function(){};gr.useDeferredValue=function(e){return bs.current.useDeferredValue(e)};gr.useEffect=function(e,t){return bs.current.useEffect(e,t)};gr.useId=function(){return bs.current.useId()};gr.useImperativeHandle=function(e,t,n){return bs.current.useImperativeHandle(e,t,n)};gr.useInsertionEffect=function(e,t){return bs.current.useInsertionEffect(e,t)};gr.useLayoutEffect=function(e,t){return bs.current.useLayoutEffect(e,t)};gr.useMemo=function(e,t){return bs.current.useMemo(e,t)};gr.useReducer=function(e,t,n){return bs.current.useReducer(e,t,n)};gr.useRef=function(e){return bs.current.useRef(e)};gr.useState=function(e){return bs.current.useState(e)};gr.useSyncExternalStore=function(e,t,n){return bs.current.useSyncExternalStore(e,t,n)};gr.useTransition=function(){return bs.current.useTransition()};gr.version="18.3.1";VB.exports=gr;var $=VB.exports;const W0=$I($),cP=UB({__proto__:null,default:W0},[$]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dX=$,fX=Symbol.for("react.element"),pX=Symbol.for("react.fragment"),mX=Object.prototype.hasOwnProperty,gX=dX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vX={key:!0,ref:!0,__self:!0,__source:!0};function KB(e,t,n){var r,i={},a=null,c=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(c=t.ref);for(r in t)mX.call(t,r)&&!vX.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:fX,type:e,key:a,ref:c,props:i,_owner:gX.current}}RS.Fragment=pX;RS.jsx=KB;RS.jsxs=KB;$B.exports=RS;var te=$B.exports;const Qv={grey:{50:"#FBFCFE",100:"#F0F4F8",200:"#DDE7EE",300:"#CDD7E1",400:"#9FA6AD",500:"#636B74",600:"#555E68",700:"#32383E",800:"#171A1C",900:"#0B0D0E"},blue:{50:"#EDF5FD",100:"#E3EFFB",200:"#C7DFF7",300:"#97C3F0",400:"#4393E4",500:"#0B6BCB",600:"#185EA5",700:"#12467B",800:"#0A2744",900:"#051423"},yellow:{50:"#FEFAF6",100:"#FDF0E1",200:"#FCE1C2",300:"#F3C896",400:"#EA9A3E",500:"#9A5B13",600:"#72430D",700:"#492B08",800:"#2E1B05",900:"#1D1002"},red:{50:"#FEF6F6",100:"#FCE4E4",200:"#F7C5C5",300:"#F09898",400:"#E47474",500:"#C41C1C",600:"#A51818",700:"#7D1212",800:"#430A0A",900:"#240505"},green:{50:"#F6FEF6",100:"#E3FBE3",200:"#C7F7C7",300:"#A1E8A1",400:"#51BC51",500:"#1F7A1F",600:"#136C13",700:"#0A470A",800:"#042F04",900:"#021D02"}},v_="$$joy";function Ay(e){let t="https://mui.com/production-error/?code="+e;for(let n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ue.apply(null,arguments)}var yX=!1;function _X(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function xX(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var bX=function(){function e(n){var r=this;this._insertTag=function(i){var a;r.tags.length===0?r.insertionPoint?a=r.insertionPoint.nextSibling:r.prepend?a=r.container.firstChild:a=r.before:a=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,a),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!yX:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(r){r.forEach(this._insertTag)},t.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(xX(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var a=_X(i);try{a.insertRule(r,a.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},t.flush=function(){this.tags.forEach(function(r){var i;return(i=r.parentNode)==null?void 0:i.removeChild(r)}),this.tags=[],this.ctr=0},e}(),is="-ms-",vw="-moz-",Ir="-webkit-",JB="comm",WI="rule",qI="decl",wX="@import",QB="@keyframes",SX="@layer",MX=Math.abs,LS=String.fromCharCode,CX=Object.assign;function EX(e,t){return No(e,0)^45?(((t<<2^No(e,0))<<2^No(e,1))<<2^No(e,2))<<2^No(e,3):0}function e6(e){return e.trim()}function TX(e,t){return(e=t.exec(e))?e[0]:e}function Rr(e,t,n){return e.replace(t,n)}function uP(e,t){return e.indexOf(t)}function No(e,t){return e.charCodeAt(t)|0}function Iy(e,t,n){return e.slice(t,n)}function rc(e){return e.length}function XI(e){return e.length}function _1(e,t){return t.push(e),e}function PX(e,t){return e.map(t).join("")}var kS=1,og=1,t6=0,Hs=0,Ji=0,Rg="";function DS(e,t,n,r,i,a,c){return{value:e,root:t,parent:n,type:r,props:i,children:a,line:kS,column:og,length:c,return:""}}function e0(e,t){return CX(DS("",null,null,"",null,null,0),e,{length:-e.length},t)}function AX(){return Ji}function IX(){return Ji=Hs>0?No(Rg,--Hs):0,og--,Ji===10&&(og=1,kS--),Ji}function ya(){return Ji=Hs<t6?No(Rg,Hs++):0,og++,Ji===10&&(og=1,kS++),Ji}function cc(){return No(Rg,Hs)}function Ab(){return Hs}function y_(e,t){return Iy(Rg,e,t)}function Ry(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function n6(e){return kS=og=1,t6=rc(Rg=e),Hs=0,[]}function r6(e){return Rg="",e}function Ib(e){return e6(y_(Hs-1,hP(e===91?e+2:e===40?e+1:e)))}function RX(e){for(;(Ji=cc())&&Ji<33;)ya();return Ry(e)>2||Ry(Ji)>3?"":" "}function LX(e,t){for(;--t&&ya()&&!(Ji<48||Ji>102||Ji>57&&Ji<65||Ji>70&&Ji<97););return y_(e,Ab()+(t<6&&cc()==32&&ya()==32))}function hP(e){for(;ya();)switch(Ji){case e:return Hs;case 34:case 39:e!==34&&e!==39&&hP(Ji);break;case 40:e===41&&hP(e);break;case 92:ya();break}return Hs}function kX(e,t){for(;ya()&&e+Ji!==57;)if(e+Ji===84&&cc()===47)break;return"/*"+y_(t,Hs-1)+"*"+LS(e===47?e:ya())}function DX(e){for(;!Ry(cc());)ya();return y_(e,Hs)}function zX(e){return r6(Rb("",null,null,null,[""],e=n6(e),0,[0],e))}function Rb(e,t,n,r,i,a,c,s,f){for(var g=0,_=0,x=c,C=0,E=0,A=0,L=1,I=1,T=1,O=0,D="",U=i,H=a,V=r,q=D;I;)switch(A=O,O=ya()){case 40:if(A!=108&&No(q,x-1)==58){uP(q+=Rr(Ib(O),"&","&\f"),"&\f")!=-1&&(T=-1);break}case 34:case 39:case 91:q+=Ib(O);break;case 9:case 10:case 13:case 32:q+=RX(A);break;case 92:q+=LX(Ab()-1,7);continue;case 47:switch(cc()){case 42:case 47:_1(OX(kX(ya(),Ab()),t,n),f);break;default:q+="/"}break;case 123*L:s[g++]=rc(q)*T;case 125*L:case 59:case 0:switch(O){case 0:case 125:I=0;case 59+_:T==-1&&(q=Rr(q,/\f/g,"")),E>0&&rc(q)-x&&_1(E>32?jD(q+";",r,n,x-1):jD(Rr(q," ","")+";",r,n,x-2),f);break;case 59:q+=";";default:if(_1(V=VD(q,t,n,g,_,i,s,D,U=[],H=[],x),a),O===123)if(_===0)Rb(q,t,V,V,U,a,x,s,H);else switch(C===99&&No(q,3)===110?100:C){case 100:case 108:case 109:case 115:Rb(e,V,V,r&&_1(VD(e,V,V,0,0,i,s,D,i,U=[],x),H),i,H,x,s,r?U:H);break;default:Rb(q,V,V,V,[""],H,0,s,H)}}g=_=E=0,L=T=1,D=q="",x=c;break;case 58:x=1+rc(q),E=A;default:if(L<1){if(O==123)--L;else if(O==125&&L++==0&&IX()==125)continue}switch(q+=LS(O),O*L){case 38:T=_>0?1:(q+="\f",-1);break;case 44:s[g++]=(rc(q)-1)*T,T=1;break;case 64:cc()===45&&(q+=Ib(ya())),C=cc(),_=x=rc(D=q+=DX(Ab())),O++;break;case 45:A===45&&rc(q)==2&&(L=0)}}return a}function VD(e,t,n,r,i,a,c,s,f,g,_){for(var x=i-1,C=i===0?a:[""],E=XI(C),A=0,L=0,I=0;A<r;++A)for(var T=0,O=Iy(e,x+1,x=MX(L=c[A])),D=e;T<E;++T)(D=e6(L>0?C[T]+" "+O:Rr(O,/&\f/g,C[T])))&&(f[I++]=D);return DS(e,t,n,i===0?WI:s,f,g,_)}function OX(e,t,n){return DS(e,t,n,JB,LS(AX()),Iy(e,2,-2),0)}function jD(e,t,n,r){return DS(e,t,n,qI,Iy(e,0,r),Iy(e,r+1,-1),r)}function Um(e,t){for(var n="",r=XI(e),i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function FX(e,t,n,r){switch(e.type){case SX:if(e.children.length)break;case wX:case qI:return e.return=e.return||e.value;case JB:return"";case QB:return e.return=e.value+"{"+Um(e.children,r)+"}";case WI:e.value=e.props.join(",")}return rc(n=Um(e.children,r))?e.return=e.value+"{"+n+"}":""}function NX(e){var t=XI(e);return function(n,r,i,a){for(var c="",s=0;s<t;s++)c+=e[s](n,r,i,a)||"";return c}}function BX(e){return function(t){t.root||(t=t.return)&&e(t)}}function i6(e){var t=Object.create(null);return function(n){return t[n]===void 0&&(t[n]=e(n)),t[n]}}var UX=function(t,n,r){for(var i=0,a=0;i=a,a=cc(),i===38&&a===12&&(n[r]=1),!Ry(a);)ya();return y_(t,Hs)},$X=function(t,n){var r=-1,i=44;do switch(Ry(i)){case 0:i===38&&cc()===12&&(n[r]=1),t[r]+=UX(Hs-1,n,r);break;case 2:t[r]+=Ib(i);break;case 4:if(i===44){t[++r]=cc()===58?"&\f":"",n[r]=t[r].length;break}default:t[r]+=LS(i)}while(i=ya());return t},VX=function(t,n){return r6($X(n6(t),n))},HD=new WeakMap,jX=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var n=t.value,r=t.parent,i=t.column===r.column&&t.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(t.props.length===1&&n.charCodeAt(0)!==58&&!HD.get(r))&&!i){HD.set(t,!0);for(var a=[],c=VX(n,a),s=r.props,f=0,g=0;f<c.length;f++)for(var _=0;_<s.length;_++,g++)t.props[g]=a[f]?c[f].replace(/&\f/g,s[_]):s[_]+" "+c[f]}}},HX=function(t){if(t.type==="decl"){var n=t.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(t.return="",t.value="")}};function o6(e,t){switch(EX(e,t)){case 5103:return Ir+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ir+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Ir+e+vw+e+is+e+e;case 6828:case 4268:return Ir+e+is+e+e;case 6165:return Ir+e+is+"flex-"+e+e;case 5187:return Ir+e+Rr(e,/(\w+).+(:[^]+)/,Ir+"box-$1$2"+is+"flex-$1$2")+e;case 5443:return Ir+e+is+"flex-item-"+Rr(e,/flex-|-self/,"")+e;case 4675:return Ir+e+is+"flex-line-pack"+Rr(e,/align-content|flex-|-self/,"")+e;case 5548:return Ir+e+is+Rr(e,"shrink","negative")+e;case 5292:return Ir+e+is+Rr(e,"basis","preferred-size")+e;case 6060:return Ir+"box-"+Rr(e,"-grow","")+Ir+e+is+Rr(e,"grow","positive")+e;case 4554:return Ir+Rr(e,/([^-])(transform)/g,"$1"+Ir+"$2")+e;case 6187:return Rr(Rr(Rr(e,/(zoom-|grab)/,Ir+"$1"),/(image-set)/,Ir+"$1"),e,"")+e;case 5495:case 3959:return Rr(e,/(image-set\([^]*)/,Ir+"$1$`$1");case 4968:return Rr(Rr(e,/(.+:)(flex-)?(.*)/,Ir+"box-pack:$3"+is+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ir+e+e;case 4095:case 3583:case 4068:case 2532:return Rr(e,/(.+)-inline(.+)/,Ir+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(rc(e)-1-t>6)switch(No(e,t+1)){case 109:if(No(e,t+4)!==45)break;case 102:return Rr(e,/(.+:)(.+)-([^]+)/,"$1"+Ir+"$2-$3$1"+vw+(No(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~uP(e,"stretch")?o6(Rr(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(No(e,t+1)!==115)break;case 6444:switch(No(e,rc(e)-3-(~uP(e,"!important")&&10))){case 107:return Rr(e,":",":"+Ir)+e;case 101:return Rr(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ir+(No(e,14)===45?"inline-":"")+"box$3$1"+Ir+"$2$3$1"+is+"$2box$3")+e}break;case 5936:switch(No(e,t+11)){case 114:return Ir+e+is+Rr(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Ir+e+is+Rr(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Ir+e+is+Rr(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Ir+e+is+e+e}return e}var GX=function(t,n,r,i){if(t.length>-1&&!t.return)switch(t.type){case qI:t.return=o6(t.value,t.length);break;case QB:return Um([e0(t,{value:Rr(t.value,"@","@"+Ir)})],i);case WI:if(t.length)return PX(t.props,function(a){switch(TX(a,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Um([e0(t,{props:[Rr(a,/:(read-\w+)/,":"+vw+"$1")]})],i);case"::placeholder":return Um([e0(t,{props:[Rr(a,/:(plac\w+)/,":"+Ir+"input-$1")]}),e0(t,{props:[Rr(a,/:(plac\w+)/,":"+vw+"$1")]}),e0(t,{props:[Rr(a,/:(plac\w+)/,is+"input-$1")]})],i)}return""})}},WX=[GX],qX=function(t){var n=t.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(L){var I=L.getAttribute("data-emotion");I.indexOf(" ")!==-1&&(document.head.appendChild(L),L.setAttribute("data-s",""))})}var i=t.stylisPlugins||WX,a={},c,s=[];c=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(L){for(var I=L.getAttribute("data-emotion").split(" "),T=1;T<I.length;T++)a[I[T]]=!0;s.push(L)});var f,g=[jX,HX];{var _,x=[FX,BX(function(L){_.insert(L)})],C=NX(g.concat(i,x)),E=function(I){return Um(zX(I),C)};f=function(I,T,O,D){_=O,E(I?I+"{"+T.styles+"}":T.styles),D&&(A.inserted[T.name]=!0)}}var A={key:n,sheet:new bX({key:n,container:c,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:a,registered:{},insert:f};return A.sheet.hydrate(s),A},s6={exports:{}},jr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Po=typeof Symbol=="function"&&Symbol.for,ZI=Po?Symbol.for("react.element"):60103,YI=Po?Symbol.for("react.portal"):60106,zS=Po?Symbol.for("react.fragment"):60107,OS=Po?Symbol.for("react.strict_mode"):60108,FS=Po?Symbol.for("react.profiler"):60114,NS=Po?Symbol.for("react.provider"):60109,BS=Po?Symbol.for("react.context"):60110,KI=Po?Symbol.for("react.async_mode"):60111,US=Po?Symbol.for("react.concurrent_mode"):60111,$S=Po?Symbol.for("react.forward_ref"):60112,VS=Po?Symbol.for("react.suspense"):60113,XX=Po?Symbol.for("react.suspense_list"):60120,jS=Po?Symbol.for("react.memo"):60115,HS=Po?Symbol.for("react.lazy"):60116,ZX=Po?Symbol.for("react.block"):60121,YX=Po?Symbol.for("react.fundamental"):60117,KX=Po?Symbol.for("react.responder"):60118,JX=Po?Symbol.for("react.scope"):60119;function Ea(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case ZI:switch(e=e.type,e){case KI:case US:case zS:case FS:case OS:case VS:return e;default:switch(e=e&&e.$$typeof,e){case BS:case $S:case HS:case jS:case NS:return e;default:return t}}case YI:return t}}}function a6(e){return Ea(e)===US}jr.AsyncMode=KI;jr.ConcurrentMode=US;jr.ContextConsumer=BS;jr.ContextProvider=NS;jr.Element=ZI;jr.ForwardRef=$S;jr.Fragment=zS;jr.Lazy=HS;jr.Memo=jS;jr.Portal=YI;jr.Profiler=FS;jr.StrictMode=OS;jr.Suspense=VS;jr.isAsyncMode=function(e){return a6(e)||Ea(e)===KI};jr.isConcurrentMode=a6;jr.isContextConsumer=function(e){return Ea(e)===BS};jr.isContextProvider=function(e){return Ea(e)===NS};jr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===ZI};jr.isForwardRef=function(e){return Ea(e)===$S};jr.isFragment=function(e){return Ea(e)===zS};jr.isLazy=function(e){return Ea(e)===HS};jr.isMemo=function(e){return Ea(e)===jS};jr.isPortal=function(e){return Ea(e)===YI};jr.isProfiler=function(e){return Ea(e)===FS};jr.isStrictMode=function(e){return Ea(e)===OS};jr.isSuspense=function(e){return Ea(e)===VS};jr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===zS||e===US||e===FS||e===OS||e===VS||e===XX||typeof e=="object"&&e!==null&&(e.$$typeof===HS||e.$$typeof===jS||e.$$typeof===NS||e.$$typeof===BS||e.$$typeof===$S||e.$$typeof===YX||e.$$typeof===KX||e.$$typeof===JX||e.$$typeof===ZX)};jr.typeOf=Ea;s6.exports=jr;var QX=s6.exports,l6=QX,eZ={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},tZ={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},c6={};c6[l6.ForwardRef]=eZ;c6[l6.Memo]=tZ;var nZ=!0;function u6(e,t,n){var r="";return n.split(" ").forEach(function(i){e[i]!==void 0?t.push(e[i]+";"):i&&(r+=i+" ")}),r}var JI=function(t,n,r){var i=t.key+"-"+n.name;(r===!1||nZ===!1)&&t.registered[i]===void 0&&(t.registered[i]=n.styles)},QI=function(t,n,r){JI(t,n,r);var i=t.key+"-"+n.name;if(t.inserted[n.name]===void 0){var a=n;do t.insert(n===a?"."+i:"",a,t.sheet,!0),a=a.next;while(a!==void 0)}};function rZ(e){for(var t=0,n,r=0,i=e.length;i>=4;++r,i-=4)n=e.charCodeAt(r)&255|(e.charCodeAt(++r)&255)<<8|(e.charCodeAt(++r)&255)<<16|(e.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,t=(n&65535)*1540483477+((n>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(i){case 3:t^=(e.charCodeAt(r+2)&255)<<16;case 2:t^=(e.charCodeAt(r+1)&255)<<8;case 1:t^=e.charCodeAt(r)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var iZ={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},oZ=/[A-Z]|^ms/g,sZ=/_EMO_([^_]+?)_([^]*?)_EMO_/g,h6=function(t){return t.charCodeAt(1)===45},GD=function(t){return t!=null&&typeof t!="boolean"},D2=i6(function(e){return h6(e)?e:e.replace(oZ,"-$&").toLowerCase()}),WD=function(t,n){switch(t){case"animation":case"animationName":if(typeof n=="string")return n.replace(sZ,function(r,i,a){return ic={name:i,styles:a,next:ic},i})}return iZ[t]!==1&&!h6(t)&&typeof n=="number"&&n!==0?n+"px":n};function Ly(e,t,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var i=n;if(i.anim===1)return ic={name:i.name,styles:i.styles,next:ic},i.name;var a=n;if(a.styles!==void 0){var c=a.next;if(c!==void 0)for(;c!==void 0;)ic={name:c.name,styles:c.styles,next:ic},c=c.next;var s=a.styles+";";return s}return aZ(e,t,n)}case"function":{if(e!==void 0){var f=ic,g=n(e);return ic=f,Ly(e,t,g)}break}}var _=n;if(t==null)return _;var x=t[_];return x!==void 0?x:_}function aZ(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=Ly(e,t,n[i])+";";else for(var a in n){var c=n[a];if(typeof c!="object"){var s=c;t!=null&&t[s]!==void 0?r+=a+"{"+t[s]+"}":GD(s)&&(r+=D2(a)+":"+WD(a,s)+";")}else if(Array.isArray(c)&&typeof c[0]=="string"&&(t==null||t[c[0]]===void 0))for(var f=0;f<c.length;f++)GD(c[f])&&(r+=D2(a)+":"+WD(a,c[f])+";");else{var g=Ly(e,t,c);switch(a){case"animation":case"animationName":{r+=D2(a)+":"+g+";";break}default:r+=a+"{"+g+"}"}}}return r}var qD=/label:\s*([^\s;{]+)\s*(;|$)/g,ic;function __(e,t,n){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var r=!0,i="";ic=void 0;var a=e[0];if(a==null||a.raw===void 0)r=!1,i+=Ly(n,t,a);else{var c=a;i+=c[0]}for(var s=1;s<e.length;s++)if(i+=Ly(n,t,e[s]),r){var f=a;i+=f[s]}qD.lastIndex=0;for(var g="",_;(_=qD.exec(i))!==null;)g+="-"+_[1];var x=rZ(i)+g;return{name:x,styles:i,next:ic}}var lZ=function(t){return t()},d6=cP.useInsertionEffect?cP.useInsertionEffect:!1,f6=d6||lZ,XD=d6||$.useLayoutEffect,cZ=!1,p6=$.createContext(typeof HTMLElement<"u"?qX({key:"css"}):null);p6.Provider;var eR=function(t){return $.forwardRef(function(n,r){var i=$.useContext(p6);return t(n,i,r)})},x_=$.createContext({}),tR={}.hasOwnProperty,dP="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",uZ=function(t,n){var r={};for(var i in n)tR.call(n,i)&&(r[i]=n[i]);return r[dP]=t,r},hZ=function(t){var n=t.cache,r=t.serialized,i=t.isStringTag;return JI(n,r,i),f6(function(){return QI(n,r,i)}),null},dZ=eR(function(e,t,n){var r=e.css;typeof r=="string"&&t.registered[r]!==void 0&&(r=t.registered[r]);var i=e[dP],a=[r],c="";typeof e.className=="string"?c=u6(t.registered,a,e.className):e.className!=null&&(c=e.className+" ");var s=__(a,void 0,$.useContext(x_));c+=t.key+"-"+s.name;var f={};for(var g in e)tR.call(e,g)&&g!=="css"&&g!==dP&&!cZ&&(f[g]=e[g]);return f.className=c,n&&(f.ref=n),$.createElement($.Fragment,null,$.createElement(hZ,{cache:t,serialized:s,isStringTag:typeof i=="string"}),$.createElement(i,f))}),fZ=dZ,pZ=function(t,n){var r=arguments;if(n==null||!tR.call(n,"css"))return $.createElement.apply(void 0,r);var i=r.length,a=new Array(i);a[0]=fZ,a[1]=uZ(t,n);for(var c=2;c<i;c++)a[c]=r[c];return $.createElement.apply(null,a)};(function(e){var t;t||(t=e.JSX||(e.JSX={}))})(pZ);var mZ=eR(function(e,t){var n=e.styles,r=__([n],void 0,$.useContext(x_)),i=$.useRef();return XD(function(){var a=t.key+"-global",c=new t.sheet.constructor({key:a,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),s=!1,f=document.querySelector('style[data-emotion="'+a+" "+r.name+'"]');return t.sheet.tags.length&&(c.before=t.sheet.tags[0]),f!==null&&(s=!0,f.setAttribute("data-emotion",a),c.hydrate([f])),i.current=[c,s],function(){c.flush()}},[t]),XD(function(){var a=i.current,c=a[0],s=a[1];if(s){a[1]=!1;return}if(r.next!==void 0&&QI(t,r.next,!0),c.tags.length){var f=c.tags[c.tags.length-1].nextElementSibling;c.before=f,c.flush()}t.insert("",r,c,!1)},[t,r.name]),null});function m6(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return __(t)}function nR(){var e=m6.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var gZ=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,vZ=i6(function(e){return gZ.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),yZ=vZ,_Z=function(t){return t!=="theme"},ZD=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?yZ:_Z},YD=function(t,n,r){var i;if(n){var a=n.shouldForwardProp;i=t.__emotion_forwardProp&&a?function(c){return t.__emotion_forwardProp(c)&&a(c)}:a}return typeof i!="function"&&r&&(i=t.__emotion_forwardProp),i},xZ=function(t){var n=t.cache,r=t.serialized,i=t.isStringTag;return JI(n,r,i),f6(function(){return QI(n,r,i)}),null},bZ=function e(t,n){var r=t.__emotion_real===t,i=r&&t.__emotion_base||t,a,c;n!==void 0&&(a=n.label,c=n.target);var s=YD(t,n,r),f=s||ZD(i),g=!f("as");return function(){var _=arguments,x=r&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(a!==void 0&&x.push("label:"+a+";"),_[0]==null||_[0].raw===void 0)x.push.apply(x,_);else{var C=_[0];x.push(C[0]);for(var E=_.length,A=1;A<E;A++)x.push(_[A],C[A])}var L=eR(function(I,T,O){var D=g&&I.as||i,U="",H=[],V=I;if(I.theme==null){V={};for(var q in I)V[q]=I[q];V.theme=$.useContext(x_)}typeof I.className=="string"?U=u6(T.registered,H,I.className):I.className!=null&&(U=I.className+" ");var Q=__(x.concat(H),T.registered,V);U+=T.key+"-"+Q.name,c!==void 0&&(U+=" "+c);var K=g&&s===void 0?ZD(D):f,N={};for(var re in I)g&&re==="as"||K(re)&&(N[re]=I[re]);return N.className=U,O&&(N.ref=O),$.createElement($.Fragment,null,$.createElement(xZ,{cache:T,serialized:Q,isStringTag:typeof D=="string"}),$.createElement(D,N))});return L.displayName=a!==void 0?a:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",L.defaultProps=t.defaultProps,L.__emotion_real=L,L.__emotion_base=i,L.__emotion_styles=x,L.__emotion_forwardProp=s,Object.defineProperty(L,"toString",{value:function(){return"."+c}}),L.withComponent=function(I,T){var O=e(I,ue({},n,T,{shouldForwardProp:YD(L,T,!0)}));return O.apply(void 0,x)},L}},wZ=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],yw=bZ.bind(null);wZ.forEach(function(e){yw[e]=yw(e)});function SZ(e){return e==null||Object.keys(e).length===0}function Lb(e){const{styles:t,defaultTheme:n={}}=e,r=typeof t=="function"?i=>t(SZ(i)?n:i):t;return te.jsx(mZ,{styles:r})}function g6(e,t){return yw(e,t)}const MZ=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))};function Un(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function lh(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function v6(e){if($.isValidElement(e)||!lh(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=v6(e[n])}),t}function _a(e,t,n={clone:!0}){const r=n.clone?ue({},e):e;return lh(e)&&lh(t)&&Object.keys(t).forEach(i=>{$.isValidElement(t[i])?r[i]=t[i]:lh(t[i])&&Object.prototype.hasOwnProperty.call(e,i)&&lh(e[i])?r[i]=_a(e[i],t[i],n):n.clone?r[i]=lh(t[i])?v6(t[i]):t[i]:r[i]=t[i]}),r}const CZ=["values","unit","step"],EZ=e=>{const t=Object.keys(e).map(n=>({key:n,val:e[n]}))||[];return t.sort((n,r)=>n.val-r.val),t.reduce((n,r)=>ue({},n,{[r.key]:r.val}),{})};function y6(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=e,i=Un(e,CZ),a=EZ(t),c=Object.keys(a);function s(C){return`@media (min-width:${typeof t[C]=="number"?t[C]:C}${n})`}function f(C){return`@media (max-width:${(typeof t[C]=="number"?t[C]:C)-r/100}${n})`}function g(C,E){const A=c.indexOf(E);return`@media (min-width:${typeof t[C]=="number"?t[C]:C}${n}) and (max-width:${(A!==-1&&typeof t[c[A]]=="number"?t[c[A]]:E)-r/100}${n})`}function _(C){return c.indexOf(C)+1<c.length?g(C,c[c.indexOf(C)+1]):s(C)}function x(C){const E=c.indexOf(C);return E===0?s(c[1]):E===c.length-1?f(c[E]):g(C,c[c.indexOf(C)+1]).replace("@media","@media not all and")}return ue({keys:c,values:a,up:s,down:f,between:g,only:_,not:x,unit:n},i)}const TZ={borderRadius:4};function q0(e,t){return t?_a(e,t,{clone:!1}):e}const rR={xs:0,sm:600,md:900,lg:1200,xl:1536},KD={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${rR[e]}px)`};function Rl(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const a=r.breakpoints||KD;return t.reduce((c,s,f)=>(c[a.up(a.keys[f])]=n(t[f]),c),{})}if(typeof t=="object"){const a=r.breakpoints||KD;return Object.keys(t).reduce((c,s)=>{if(Object.keys(a.values||rR).indexOf(s)!==-1){const f=a.up(s);c[f]=n(t[s],s)}else{const f=s;c[f]=t[f]}return c},{})}return n(t)}function _6(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((r,i)=>{const a=e.up(i);return r[a]={},r},{}))||{}}function x6(e,t){return e.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},t)}function PZ(e,...t){const n=_6(e),r=[n,...t].reduce((i,a)=>_a(i,a),{});return x6(Object.keys(n),r)}function AZ(e,t){if(typeof e!="object")return{};const n={},r=Object.keys(t);return Array.isArray(e)?r.forEach((i,a)=>{a<e.length&&(n[i]=!0)}):r.forEach(i=>{e[i]!=null&&(n[i]=!0)}),n}function z2({values:e,breakpoints:t,base:n}){const r=n||AZ(e,t),i=Object.keys(r);if(i.length===0)return e;let a;return i.reduce((c,s,f)=>(Array.isArray(e)?(c[s]=e[f]!=null?e[f]:e[a],a=f):typeof e=="object"?(c[s]=e[s]!=null?e[s]:e[a],a=s):c[s]=e,c),{})}function mn(e){if(typeof e!="string")throw new Error(Ay(7));return e.charAt(0).toUpperCase()+e.slice(1)}function kh(e,t,n=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&n){const r=`vars.${t}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,e);if(r!=null)return r}return t.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,e)}function _w(e,t,n,r=n){let i;return typeof e=="function"?i=e(n):Array.isArray(e)?i=e[n]||r:i=kh(e,n)||r,t&&(i=t(i,r,e)),i}function Ni(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:i}=e,a=c=>{if(c[t]==null)return null;const s=c[t],f=c.theme,g=kh(f,r)||{};return Rl(c,s,x=>{let C=_w(g,i,x);return x===C&&typeof x=="string"&&(C=_w(g,i,`${t}${x==="default"?"":mn(x)}`,x)),n===!1?C:{[n]:C}})};return a.propTypes={},a.filterProps=[t],a}function IZ(e){const t={};return n=>(t[n]===void 0&&(t[n]=e(n)),t[n])}const RZ={m:"margin",p:"padding"},LZ={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},JD={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},kZ=IZ(e=>{if(e.length>2)if(JD[e])e=JD[e];else return[e];const[t,n]=e.split(""),r=RZ[t],i=LZ[n]||"";return Array.isArray(i)?i.map(a=>r+a):[r+i]}),iR=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],oR=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...iR,...oR];function b_(e,t,n,r){var i;const a=(i=kh(e,t,!1))!=null?i:n;return typeof a=="number"?c=>typeof c=="string"?c:a*c:Array.isArray(a)?c=>typeof c=="string"?c:a[c]:typeof a=="function"?a:()=>{}}function sR(e){return b_(e,"spacing",8)}function wf(e,t){if(typeof t=="string"||t==null)return t;const n=Math.abs(t),r=e(n);return t>=0?r:typeof r=="number"?-r:`-${r}`}function DZ(e,t){return n=>e.reduce((r,i)=>(r[i]=wf(t,n),r),{})}function zZ(e,t,n,r){if(t.indexOf(n)===-1)return null;const i=kZ(n),a=DZ(i,r),c=e[n];return Rl(e,c,a)}function b6(e,t){const n=sR(e.theme);return Object.keys(e).map(r=>zZ(e,t,r,n)).reduce(q0,{})}function Mi(e){return b6(e,iR)}Mi.propTypes={};Mi.filterProps=iR;function Ci(e){return b6(e,oR)}Ci.propTypes={};Ci.filterProps=oR;function w6(e=8){if(e.mui)return e;const t=sR({spacing:e}),n=(...r)=>(r.length===0?[1]:r).map(a=>{const c=t(a);return typeof c=="number"?`${c}px`:c}).join(" ");return n.mui=!0,n}function GS(...e){const t=e.reduce((r,i)=>(i.filterProps.forEach(a=>{r[a]=i}),r),{}),n=r=>Object.keys(r).reduce((i,a)=>t[a]?q0(i,t[a](r)):i,{});return n.propTypes={},n.filterProps=e.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Ba(e){return typeof e!="number"?e:`${e}px solid`}function Ja(e,t){return Ni({prop:e,themeKey:"borders",transform:t})}const OZ=Ja("border",Ba),FZ=Ja("borderTop",Ba),NZ=Ja("borderRight",Ba),BZ=Ja("borderBottom",Ba),UZ=Ja("borderLeft",Ba),$Z=Ja("borderColor"),VZ=Ja("borderTopColor"),jZ=Ja("borderRightColor"),HZ=Ja("borderBottomColor"),GZ=Ja("borderLeftColor"),WZ=Ja("outline",Ba),qZ=Ja("outlineColor"),WS=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=b_(e.theme,"shape.borderRadius",4),n=r=>({borderRadius:wf(t,r)});return Rl(e,e.borderRadius,n)}return null};WS.propTypes={};WS.filterProps=["borderRadius"];GS(OZ,FZ,NZ,BZ,UZ,$Z,VZ,jZ,HZ,GZ,WS,WZ,qZ);const qS=e=>{if(e.gap!==void 0&&e.gap!==null){const t=b_(e.theme,"spacing",8),n=r=>({gap:wf(t,r)});return Rl(e,e.gap,n)}return null};qS.propTypes={};qS.filterProps=["gap"];const XS=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=b_(e.theme,"spacing",8),n=r=>({columnGap:wf(t,r)});return Rl(e,e.columnGap,n)}return null};XS.propTypes={};XS.filterProps=["columnGap"];const ZS=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=b_(e.theme,"spacing",8),n=r=>({rowGap:wf(t,r)});return Rl(e,e.rowGap,n)}return null};ZS.propTypes={};ZS.filterProps=["rowGap"];const XZ=Ni({prop:"gridColumn"}),ZZ=Ni({prop:"gridRow"}),YZ=Ni({prop:"gridAutoFlow"}),KZ=Ni({prop:"gridAutoColumns"}),JZ=Ni({prop:"gridAutoRows"}),QZ=Ni({prop:"gridTemplateColumns"}),eY=Ni({prop:"gridTemplateRows"}),tY=Ni({prop:"gridTemplateAreas"}),nY=Ni({prop:"gridArea"});GS(qS,XS,ZS,XZ,ZZ,YZ,KZ,JZ,QZ,eY,tY,nY);function $m(e,t){return t==="grey"?t:e}const rY=Ni({prop:"color",themeKey:"palette",transform:$m}),iY=Ni({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:$m}),oY=Ni({prop:"backgroundColor",themeKey:"palette",transform:$m});GS(rY,iY,oY);function fa(e){return e<=1&&e!==0?`${e*100}%`:e}const sY=Ni({prop:"width",transform:fa}),aR=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=n=>{var r,i;const a=((r=e.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||rR[n];return a?((i=e.theme)==null||(i=i.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${a}${e.theme.breakpoints.unit}`}:{maxWidth:a}:{maxWidth:fa(n)}};return Rl(e,e.maxWidth,t)}return null};aR.filterProps=["maxWidth"];const aY=Ni({prop:"minWidth",transform:fa}),lY=Ni({prop:"height",transform:fa}),cY=Ni({prop:"maxHeight",transform:fa}),uY=Ni({prop:"minHeight",transform:fa});Ni({prop:"size",cssProperty:"width",transform:fa});Ni({prop:"size",cssProperty:"height",transform:fa});const hY=Ni({prop:"boxSizing"});GS(sY,aR,aY,lY,cY,uY,hY);const YS={border:{themeKey:"borders",transform:Ba},borderTop:{themeKey:"borders",transform:Ba},borderRight:{themeKey:"borders",transform:Ba},borderBottom:{themeKey:"borders",transform:Ba},borderLeft:{themeKey:"borders",transform:Ba},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Ba},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:WS},color:{themeKey:"palette",transform:$m},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:$m},backgroundColor:{themeKey:"palette",transform:$m},p:{style:Ci},pt:{style:Ci},pr:{style:Ci},pb:{style:Ci},pl:{style:Ci},px:{style:Ci},py:{style:Ci},padding:{style:Ci},paddingTop:{style:Ci},paddingRight:{style:Ci},paddingBottom:{style:Ci},paddingLeft:{style:Ci},paddingX:{style:Ci},paddingY:{style:Ci},paddingInline:{style:Ci},paddingInlineStart:{style:Ci},paddingInlineEnd:{style:Ci},paddingBlock:{style:Ci},paddingBlockStart:{style:Ci},paddingBlockEnd:{style:Ci},m:{style:Mi},mt:{style:Mi},mr:{style:Mi},mb:{style:Mi},ml:{style:Mi},mx:{style:Mi},my:{style:Mi},margin:{style:Mi},marginTop:{style:Mi},marginRight:{style:Mi},marginBottom:{style:Mi},marginLeft:{style:Mi},marginX:{style:Mi},marginY:{style:Mi},marginInline:{style:Mi},marginInlineStart:{style:Mi},marginInlineEnd:{style:Mi},marginBlock:{style:Mi},marginBlockStart:{style:Mi},marginBlockEnd:{style:Mi},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:qS},rowGap:{style:ZS},columnGap:{style:XS},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:fa},maxWidth:{style:aR},minWidth:{transform:fa},height:{transform:fa},maxHeight:{transform:fa},minHeight:{transform:fa},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function dY(...e){const t=e.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(t);return e.every(r=>n.size===Object.keys(r).length)}function fY(e,t){return typeof e=="function"?e(t):e}function pY(){function e(n,r,i,a){const c={[n]:r,theme:i},s=a[n];if(!s)return{[n]:r};const{cssProperty:f=n,themeKey:g,transform:_,style:x}=s;if(r==null)return null;if(g==="typography"&&r==="inherit")return{[n]:r};const C=kh(i,g)||{};return x?x(c):Rl(c,r,A=>{let L=_w(C,_,A);return A===L&&typeof A=="string"&&(L=_w(C,_,`${n}${A==="default"?"":mn(A)}`,A)),f===!1?L:{[f]:L}})}function t(n){var r;const{sx:i,theme:a={}}=n||{};if(!i)return null;const c=(r=a.unstable_sxConfig)!=null?r:YS;function s(f){let g=f;if(typeof f=="function")g=f(a);else if(typeof f!="object")return f;if(!g)return null;const _=_6(a.breakpoints),x=Object.keys(_);let C=_;return Object.keys(g).forEach(E=>{const A=fY(g[E],a);if(A!=null)if(typeof A=="object")if(c[E])C=q0(C,e(E,A,a,c));else{const L=Rl({theme:a},A,I=>({[E]:I}));dY(L,A)?C[E]=t({sx:A,theme:a}):C=q0(C,L)}else C=q0(C,e(E,A,a,c))}),x6(x,C)}return Array.isArray(i)?i.map(s):s(i)}return t}const w_=pY();w_.filterProps=["sx"];function S6(e,t){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}:n.palette.mode===e?t:{}}const mY=["breakpoints","palette","spacing","shape"];function lR(e={},...t){const{breakpoints:n={},palette:r={},spacing:i,shape:a={}}=e,c=Un(e,mY),s=y6(n),f=w6(i);let g=_a({breakpoints:s,direction:"ltr",components:{},palette:ue({mode:"light"},r),spacing:f,shape:ue({},TZ,a)},c);return g.applyStyles=S6,g=t.reduce((_,x)=>_a(_,x),g),g.unstable_sxConfig=ue({},YS,c==null?void 0:c.unstable_sxConfig),g.unstable_sx=function(x){return w_({sx:x,theme:this})},g}function gY(e){return Object.keys(e).length===0}function M6(e=null){const t=$.useContext(x_);return!t||gY(t)?e:t}const vY=lR();function cR(e=vY){return M6(e)}function yY({styles:e,themeId:t,defaultTheme:n={}}){const r=cR(n),i=typeof e=="function"?e(t&&r[t]||r):e;return te.jsx(Lb,{styles:i})}const _Y=["sx"],xY=e=>{var t,n;const r={systemProps:{},otherProps:{}},i=(t=e==null||(n=e.theme)==null?void 0:n.unstable_sxConfig)!=null?t:YS;return Object.keys(e).forEach(a=>{i[a]?r.systemProps[a]=e[a]:r.otherProps[a]=e[a]}),r};function uR(e){const{sx:t}=e,n=Un(e,_Y),{systemProps:r,otherProps:i}=xY(n);let a;return Array.isArray(t)?a=[r,...t]:typeof t=="function"?a=(...c)=>{const s=t(...c);return lh(s)?ue({},r,s):r}:a=ue({},r,t),ue({},i,{sx:a})}const QD=e=>e,bY=()=>{let e=QD;return{configure(t){e=t},generate(t){return e(t)},reset(){e=QD}}},C6=bY();function E6(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=E6(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function _i(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=E6(e))&&(r&&(r+=" "),r+=t);return r}const wY=["className","component"];function SY(e={}){const{themeId:t,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=e,a=g6("div",{shouldForwardProp:s=>s!=="theme"&&s!=="sx"&&s!=="as"})(w_);return $.forwardRef(function(f,g){const _=cR(n),x=uR(f),{className:C,component:E="div"}=x,A=Un(x,wY);return te.jsx(a,ue({as:E,ref:g,className:_i(C,i?i(r):r),theme:t&&_[t]||_},A))})}const T6={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function hR(e,t,n="Mui"){const r=T6[t];return r?`${n}-${r}`:`${C6.generate(e)}-${t}`}function P6(e,t,n="Mui"){const r={};return t.forEach(i=>{r[i]=hR(e,i,n)}),r}const MY=["ownerState"],CY=["variants"],EY=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function TY(e){return Object.keys(e).length===0}function PY(e){return typeof e=="string"&&e.charCodeAt(0)>96}function O2(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const AY=lR(),IY=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function x1({defaultTheme:e,theme:t,themeId:n}){return TY(t)?e:t[n]||t}function RY(e){return e?(t,n)=>n[e]:null}function kb(e,t){let{ownerState:n}=t,r=Un(t,MY);const i=typeof e=="function"?e(ue({ownerState:n},r)):e;if(Array.isArray(i))return i.flatMap(a=>kb(a,ue({ownerState:n},r)));if(i&&typeof i=="object"&&Array.isArray(i.variants)){const{variants:a=[]}=i;let s=Un(i,CY);return a.forEach(f=>{let g=!0;typeof f.props=="function"?g=f.props(ue({ownerState:n},r,n)):Object.keys(f.props).forEach(_=>{(n==null?void 0:n[_])!==f.props[_]&&r[_]!==f.props[_]&&(g=!1)}),g&&(Array.isArray(s)||(s=[s]),s.push(typeof f.style=="function"?f.style(ue({ownerState:n},r,n)):f.style))}),s}return i}function A6(e={}){const{themeId:t,defaultTheme:n=AY,rootShouldForwardProp:r=O2,slotShouldForwardProp:i=O2}=e,a=c=>w_(ue({},c,{theme:x1(ue({},c,{defaultTheme:n,themeId:t}))}));return a.__mui_systemSx=!0,(c,s={})=>{MZ(c,H=>H.filter(V=>!(V!=null&&V.__mui_systemSx)));const{name:f,slot:g,skipVariantsResolver:_,skipSx:x,overridesResolver:C=RY(IY(g))}=s,E=Un(s,EY),A=_!==void 0?_:g&&g!=="Root"&&g!=="root"||!1,L=x||!1;let I,T=O2;g==="Root"||g==="root"?T=r:g?T=i:PY(c)&&(T=void 0);const O=g6(c,ue({shouldForwardProp:T,label:I},E)),D=H=>typeof H=="function"&&H.__emotion_real!==H||lh(H)?V=>kb(H,ue({},V,{theme:x1({theme:V.theme,defaultTheme:n,themeId:t})})):H,U=(H,...V)=>{let q=D(H);const Q=V?V.map(D):[];f&&C&&Q.push(re=>{const ye=x1(ue({},re,{defaultTheme:n,themeId:t}));if(!ye.components||!ye.components[f]||!ye.components[f].styleOverrides)return null;const ge=ye.components[f].styleOverrides,Ve={};return Object.entries(ge).forEach(([Ie,ve])=>{Ve[Ie]=kb(ve,ue({},re,{theme:ye}))}),C(re,Ve)}),f&&!A&&Q.push(re=>{var ye;const ge=x1(ue({},re,{defaultTheme:n,themeId:t})),Ve=ge==null||(ye=ge.components)==null||(ye=ye[f])==null?void 0:ye.variants;return kb({variants:Ve},ue({},re,{theme:ge}))}),L||Q.push(a);const K=Q.length-V.length;if(Array.isArray(H)&&K>0){const re=new Array(K).fill("");q=[...H,...re],q.raw=[...H.raw,...re]}const N=O(q,...Q);return c.muiName&&(N.muiName=c.muiName),N};return O.withConfig&&(U.withConfig=O.withConfig),U}}const LY=A6();function I6(e,t){const n=ue({},t);return Object.keys(e).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=ue({},e[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=e[r]||{},a=t[r];n[r]={},!a||!Object.keys(a)?n[r]=i:!i||!Object.keys(i)?n[r]=a:(n[r]=ue({},a),Object.keys(i).forEach(c=>{n[r][c]=I6(i[c],a[c])}))}else n[r]===void 0&&(n[r]=e[r])}),n}function kY(e){const{theme:t,name:n,props:r}=e;return!t||!t.components||!t.components[n]||!t.components[n].defaultProps?r:I6(t.components[n].defaultProps,r)}function R6({props:e,name:t,defaultTheme:n,themeId:r}){let i=cR(n);return r&&(i=i[r]||i),kY({theme:i,name:t,props:e})}const tu=typeof window<"u"?$.useLayoutEffect:$.useEffect;function DY(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function L6(e){if(e.type)return e;if(e.charAt(0)==="#")return L6(DY(e));const t=e.indexOf("("),n=e.substring(0,t);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(Ay(9,e));let r=e.substring(t+1,e.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(Ay(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}const Gd=e=>{const t=L6(e);return t.values.slice(0,3).map((n,r)=>t.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};function ez(...e){return e.reduce((t,n)=>n==null?t:function(...i){t.apply(this,i),n.apply(this,i)},()=>{})}function dR(e,t){var n,r;return $.isValidElement(e)&&t.indexOf((n=e.type.muiName)!=null?n:(r=e.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function xa(e){return e&&e.ownerDocument||document}function fR(e){return xa(e).defaultView||window}function xw(e,t){typeof e=="function"?e(t):e&&(e.current=t)}let tz=0;function zY(e){const[t,n]=$.useState(e),r=e||t;return $.useEffect(()=>{t==null&&(tz+=1,n(`mui-${tz}`))},[t]),r}const nz=cP.useId;function Gs(e){if(nz!==void 0){const t=nz();return e??t}return zY(e)}function Vm({controlled:e,default:t,name:n,state:r="value"}){const{current:i}=$.useRef(e!==void 0),[a,c]=$.useState(t),s=i?e:a,f=$.useCallback(g=>{i||c(g)},[]);return[s,f]}function Cl(e){const t=$.useRef(e);return tu(()=>{t.current=e}),$.useRef((...n)=>(0,t.current)(...n)).current}function Br(...e){return $.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(n=>{xw(n,t)})},e)}const rz={};function OY(e,t){const n=$.useRef(rz);return n.current===rz&&(n.current=e(t)),n}const FY=[];function NY(e){$.useEffect(e,FY)}class S_{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new S_}start(t,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},t)}}function R0(){const e=OY(S_.create).current;return NY(e.disposeEffect),e}let KS=!0,fP=!1;const BY=new S_,UY={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function $Y(e){const{type:t,tagName:n}=e;return!!(n==="INPUT"&&UY[t]&&!e.readOnly||n==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function VY(e){e.metaKey||e.altKey||e.ctrlKey||(KS=!0)}function F2(){KS=!1}function jY(){this.visibilityState==="hidden"&&fP&&(KS=!0)}function HY(e){e.addEventListener("keydown",VY,!0),e.addEventListener("mousedown",F2,!0),e.addEventListener("pointerdown",F2,!0),e.addEventListener("touchstart",F2,!0),e.addEventListener("visibilitychange",jY,!0)}function GY(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch{}return KS||$Y(t)}function pR(){const e=$.useCallback(i=>{i!=null&&HY(i.ownerDocument)},[]),t=$.useRef(!1);function n(){return t.current?(fP=!0,BY.start(100,()=>{fP=!1}),t.current=!1,!0):!1}function r(i){return GY(i)?(t.current=!0,!0):!1}return{isFocusVisibleRef:t,onFocus:r,onBlur:n,ref:e}}function WY(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}const qY=e=>{const t=$.useRef({});return $.useEffect(()=>{t.current=e}),t.current},XY={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function vr(e,t,n=void 0){const r={};return Object.keys(e).forEach(i=>{r[i]=e[i].reduce((a,c)=>{if(c){const s=t(c);s!==""&&a.push(s),n&&n[c]&&a.push(n[c])}return a},[]).join(" ")}),r}function ZY(e){return typeof e=="string"}function k6(e,t,n){return e===void 0||ZY(e)?t:ue({},t,{ownerState:ue({},t.ownerState,n)})}function uo(e,t=[]){if(e===void 0)return{};const n={};return Object.keys(e).filter(r=>r.match(/^on[A-Z]/)&&typeof e[r]=="function"&&!t.includes(r)).forEach(r=>{n[r]=e[r]}),n}function iz(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(n=>!(n.match(/^on[A-Z]/)&&typeof e[n]=="function")).forEach(n=>{t[n]=e[n]}),t}function D6(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:a}=e;if(!t){const E=_i(n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),A=ue({},n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),L=ue({},n,i,r);return E.length>0&&(L.className=E),Object.keys(A).length>0&&(L.style=A),{props:L,internalRef:void 0}}const c=uo(ue({},i,r)),s=iz(r),f=iz(i),g=t(c),_=_i(g==null?void 0:g.className,n==null?void 0:n.className,a,i==null?void 0:i.className,r==null?void 0:r.className),x=ue({},g==null?void 0:g.style,n==null?void 0:n.style,i==null?void 0:i.style,r==null?void 0:r.style),C=ue({},g,n,f,s);return _.length>0&&(C.className=_),Object.keys(x).length>0&&(C.style=x),{props:C,internalRef:g.ref}}function z6(e,t,n){return typeof e=="function"?e(t,n):e}const YY=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function O6(e){var t;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:a=!1}=e,c=Un(e,YY),s=a?{}:z6(r,i),{props:f,internalRef:g}=D6(ue({},c,{externalSlotProps:s})),_=Br(g,s==null?void 0:s.ref,(t=e.additionalProps)==null?void 0:t.ref);return k6(n,ue({},f,{ref:_}),i)}function JS(e){if(parseInt($.version,10)>=19){var t;return(e==null||(t=e.props)==null?void 0:t.ref)||null}return(e==null?void 0:e.ref)||null}const F6=$.createContext(null);function mR(){return $.useContext(F6)}const KY=typeof Symbol=="function"&&Symbol.for,JY=KY?Symbol.for("mui.nested"):"__THEME_NESTED__";function QY(e,t){return typeof t=="function"?t(e):ue({},e,t)}function eK(e){const{children:t,theme:n}=e,r=mR(),i=$.useMemo(()=>{const a=r===null?n:QY(r,n);return a!=null&&(a[JY]=r!==null),a},[n,r]);return te.jsx(F6.Provider,{value:i,children:t})}const tK=["value"],nK=$.createContext();function rK(e){let{value:t}=e,n=Un(e,tK);return te.jsx(nK.Provider,ue({value:t??!0},n))}const iK=$.createContext(void 0);function oK({value:e,children:t}){return te.jsx(iK.Provider,{value:e,children:t})}const oz={};function sz(e,t,n,r=!1){return $.useMemo(()=>{const i=e&&t[e]||t;if(typeof n=="function"){const a=n(i),c=e?ue({},t,{[e]:a}):a;return r?()=>c:c}return e?ue({},t,{[e]:n}):ue({},t,n)},[e,t,n,r])}function sK(e){const{children:t,theme:n,themeId:r}=e,i=M6(oz),a=mR()||oz,c=sz(r,i,n),s=sz(r,a,n,!0),f=c.direction==="rtl";return te.jsx(eK,{theme:s,children:te.jsx(x_.Provider,{value:c,children:te.jsx(rK,{value:f,children:te.jsx(oK,{value:c==null?void 0:c.components,children:t})})})})}const gR="mode",vR="color-scheme",N6="data-color-scheme";function aK(e){const{defaultMode:t="light",defaultLightColorScheme:n="light",defaultDarkColorScheme:r="dark",modeStorageKey:i=gR,colorSchemeStorageKey:a=vR,attribute:c=N6,colorSchemeNode:s="document.documentElement",nonce:f}=e||{};return te.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?f:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  var mode = localStorage.getItem('${i}') || '${t}';
  var colorScheme = '';
  if (mode === 'system') {
    // handle system mode
    var mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = localStorage.getItem('${a}-dark') || '${r}';
    } else {
      colorScheme = localStorage.getItem('${a}-light') || '${n}';
    }
  }
  if (mode === 'light') {
    colorScheme = localStorage.getItem('${a}-light') || '${n}';
  }
  if (mode === 'dark') {
    colorScheme = localStorage.getItem('${a}-dark') || '${r}';
  }
  if (colorScheme) {
    ${s}.setAttribute('${c}', colorScheme);
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function az(e){if(typeof window<"u"&&e==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function B6(e,t){if(e.mode==="light"||e.mode==="system"&&e.systemMode==="light")return t("light");if(e.mode==="dark"||e.mode==="system"&&e.systemMode==="dark")return t("dark")}function lK(e){return B6(e,t=>{if(t==="light")return e.lightColorScheme;if(t==="dark")return e.darkColorScheme})}function N2(e,t){if(typeof window>"u")return;let n;try{n=localStorage.getItem(e)||void 0,n||localStorage.setItem(e,t)}catch{}return n||t}function cK(e){const{defaultMode:t="light",defaultLightColorScheme:n,defaultDarkColorScheme:r,supportedColorSchemes:i=[],modeStorageKey:a=gR,colorSchemeStorageKey:c=vR,storageWindow:s=typeof window>"u"?void 0:window}=e,f=i.join(","),[g,_]=$.useState(()=>{const I=N2(a,t),T=N2(`${c}-light`,n),O=N2(`${c}-dark`,r);return{mode:I,systemMode:az(I),lightColorScheme:T,darkColorScheme:O}}),x=lK(g),C=$.useCallback(I=>{_(T=>{if(I===T.mode)return T;const O=I??t;try{localStorage.setItem(a,O)}catch{}return ue({},T,{mode:O,systemMode:az(O)})})},[a,t]),E=$.useCallback(I=>{I?typeof I=="string"?I&&!f.includes(I)?console.error(`\`${I}\` does not exist in \`theme.colorSchemes\`.`):_(T=>{const O=ue({},T);return B6(T,D=>{try{localStorage.setItem(`${c}-${D}`,I)}catch{}D==="light"&&(O.lightColorScheme=I),D==="dark"&&(O.darkColorScheme=I)}),O}):_(T=>{const O=ue({},T),D=I.light===null?n:I.light,U=I.dark===null?r:I.dark;if(D)if(!f.includes(D))console.error(`\`${D}\` does not exist in \`theme.colorSchemes\`.`);else{O.lightColorScheme=D;try{localStorage.setItem(`${c}-light`,D)}catch{}}if(U)if(!f.includes(U))console.error(`\`${U}\` does not exist in \`theme.colorSchemes\`.`);else{O.darkColorScheme=U;try{localStorage.setItem(`${c}-dark`,U)}catch{}}return O}):_(T=>{try{localStorage.setItem(`${c}-light`,n),localStorage.setItem(`${c}-dark`,r)}catch{}return ue({},T,{lightColorScheme:n,darkColorScheme:r})})},[f,c,n,r]),A=$.useCallback(I=>{g.mode==="system"&&_(T=>{const O=I!=null&&I.matches?"dark":"light";return T.systemMode===O?T:ue({},T,{systemMode:O})})},[g.mode]),L=$.useRef(A);return L.current=A,$.useEffect(()=>{const I=(...O)=>L.current(...O),T=window.matchMedia("(prefers-color-scheme: dark)");return T.addListener(I),I(T),()=>{T.removeListener(I)}},[]),$.useEffect(()=>{if(s){const I=T=>{const O=T.newValue;typeof T.key=="string"&&T.key.startsWith(c)&&(!O||f.match(O))&&(T.key.endsWith("light")&&E({light:O}),T.key.endsWith("dark")&&E({dark:O})),T.key===a&&(!O||["light","dark","system"].includes(O))&&C(O||t)};return s.addEventListener("storage",I),()=>{s.removeEventListener("storage",I)}}},[E,C,a,c,f,t,s]),ue({},g,{colorScheme:x,setMode:C,setColorScheme:E})}const uK=["colorSchemes","components","generateCssVars","cssVarPrefix"],hK="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function dK(e){const{themeId:t,theme:n={},attribute:r=N6,modeStorageKey:i=gR,colorSchemeStorageKey:a=vR,defaultMode:c="light",defaultColorScheme:s,disableTransitionOnChange:f=!1,resolveTheme:g,excludeVariablesFromRoot:_}=e;(!n.colorSchemes||typeof s=="string"&&!n.colorSchemes[s]||typeof s=="object"&&!n.colorSchemes[s==null?void 0:s.light]||typeof s=="object"&&!n.colorSchemes[s==null?void 0:s.dark])&&console.error(`MUI: \`${s}\` does not exist in \`theme.colorSchemes\`.`);const x=$.createContext(void 0),C=()=>{const T=$.useContext(x);if(!T)throw new Error(Ay(19));return T};function E(T){const{children:O,theme:D=n,modeStorageKey:U=i,colorSchemeStorageKey:H=a,attribute:V=r,defaultMode:q=c,defaultColorScheme:Q=s,disableTransitionOnChange:K=f,storageWindow:N=typeof window>"u"?void 0:window,documentNode:re=typeof document>"u"?void 0:document,colorSchemeNode:ye=typeof document>"u"?void 0:document.documentElement,colorSchemeSelector:ge=":root",disableNestedContext:Ve=!1,disableStyleSheetGeneration:Ie=!1}=T,ve=$.useRef(!1),Se=mR(),Me=$.useContext(x),Be=!!Me&&!Ve,Qe=D[t],st=Qe||D,{colorSchemes:ct={},components:Xt={},generateCssVars:je=()=>({vars:{},css:{}}),cssVarPrefix:lt}=st,Ot=Un(st,uK),ut=Object.keys(ct),ot=typeof Q=="string"?Q:Q.light,Tt=typeof Q=="string"?Q:Q.dark,{mode:Ct,setMode:un,systemMode:gn,lightColorScheme:hn,darkColorScheme:We,colorScheme:vn,setColorScheme:Ut}=cK({supportedColorSchemes:ut,defaultLightColorScheme:ot,defaultDarkColorScheme:Tt,modeStorageKey:U,colorSchemeStorageKey:H,defaultMode:q,storageWindow:N});let tn=Ct,Dt=vn;Be&&(tn=Me.mode,Dt=Me.colorScheme);const An=tn||(q==="system"?c:q),an=Dt||(An==="dark"?Tt:ot),{css:Le,vars:me}=je(),it=ue({},Ot,{components:Xt,colorSchemes:ct,cssVarPrefix:lt,vars:me,getColorSchemeSelector:kt=>`[${V}="${kt}"] &`}),St={},It={};Object.entries(ct).forEach(([kt,bn])=>{const{css:zt,vars:_e}=je(kt);it.vars=_a(it.vars,_e),kt===an&&(Object.keys(bn).forEach(ne=>{bn[ne]&&typeof bn[ne]=="object"?it[ne]=ue({},it[ne],bn[ne]):it[ne]=bn[ne]}),it.palette&&(it.palette.colorScheme=kt));const ee=typeof Q=="string"?Q:q==="dark"?Q.dark:Q.light;if(kt===ee){if(_){const ne={};_(lt).forEach(Z=>{ne[Z]=zt[Z],delete zt[Z]}),St[`[${V}="${kt}"]`]=ne}St[`${ge}, [${V}="${kt}"]`]=zt}else It[`${ge===":root"?"":ge}[${V}="${kt}"]`]=zt}),it.vars=_a(it.vars,me),$.useEffect(()=>{Dt&&ye&&ye.setAttribute(V,Dt)},[Dt,V,ye]),$.useEffect(()=>{let kt;if(K&&ve.current&&re){const bn=re.createElement("style");bn.appendChild(re.createTextNode(hK)),re.head.appendChild(bn),window.getComputedStyle(re.body),kt=setTimeout(()=>{re.head.removeChild(bn)},1)}return()=>{clearTimeout(kt)}},[Dt,K,re]),$.useEffect(()=>(ve.current=!0,()=>{ve.current=!1}),[]);const wt=$.useMemo(()=>({allColorSchemes:ut,colorScheme:Dt,darkColorScheme:We,lightColorScheme:hn,mode:tn,setColorScheme:Ut,setMode:un,systemMode:gn}),[ut,Dt,We,hn,tn,Ut,un,gn]);let Zt=!0;(Ie||Be&&(Se==null?void 0:Se.cssVarPrefix)===lt)&&(Zt=!1);const Lt=te.jsxs($.Fragment,{children:[Zt&&te.jsxs($.Fragment,{children:[te.jsx(Lb,{styles:{[ge]:Le}}),te.jsx(Lb,{styles:St}),te.jsx(Lb,{styles:It})]}),te.jsx(sK,{themeId:Qe?t:void 0,theme:g?g(it):it,children:O})]});return Be?Lt:te.jsx(x.Provider,{value:wt,children:Lt})}const A=typeof s=="string"?s:s.light,L=typeof s=="string"?s:s.dark;return{CssVarsProvider:E,useColorScheme:C,getInitColorSchemeScript:T=>aK(ue({attribute:r,colorSchemeStorageKey:a,defaultMode:c,defaultLightColorScheme:A,defaultDarkColorScheme:L,modeStorageKey:i},T))}}function yR(e=""){function t(...r){if(!r.length)return"";const i=r[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${i}${t(...r.slice(1))})`:`, ${i}`}return(r,...i)=>`var(--${e?`${e}-`:""}${r}${t(...i)})`}const lz=(e,t,n,r=[])=>{let i=e;t.forEach((a,c)=>{c===t.length-1?Array.isArray(i)?i[Number(a)]=n:i&&typeof i=="object"&&(i[a]=n):i&&typeof i=="object"&&(i[a]||(i[a]=r.includes(a)?[]:{}),i=i[a])})},fK=(e,t,n)=>{function r(i,a=[],c=[]){Object.entries(i).forEach(([s,f])=>{(!n||!n([...a,s]))&&f!=null&&(typeof f=="object"&&Object.keys(f).length>0?r(f,[...a,s],Array.isArray(f)?[...c,s]:c):t([...a,s],f,c))})}r(e)},pK=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>e.includes(r))||e[e.length-1].toLowerCase().indexOf("opacity")>=0?t:`${t}px`:t;function B2(e,t){const{prefix:n,shouldSkipGeneratingVar:r}=t,i={},a={},c={};return fK(e,(s,f,g)=>{if((typeof f=="string"||typeof f=="number")&&(!r||!r(s,f))){const _=`--${n?`${n}-`:""}${s.join("-")}`;Object.assign(i,{[_]:pK(s,f)}),lz(a,s,`var(${_})`,g),lz(c,s,`var(${_}, ${f})`,g)}},s=>s[0]==="vars"),{css:i,vars:a,varsWithDefaults:c}}function ky(e){"@babel/helpers - typeof";return ky=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ky(e)}function mK(e,t){if(ky(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ky(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function gK(e){var t=mK(e,"string");return ky(t)=="symbol"?t:t+""}const vK=["colorSchemes","components","defaultColorScheme"];function yK(e,t){const{colorSchemes:n={},defaultColorScheme:r="light"}=e,i=Un(e,vK),{vars:a,css:c,varsWithDefaults:s}=B2(i,t);let f=s;const g={},{[r]:_}=n,x=Un(n,[r].map(gK));if(Object.entries(x||{}).forEach(([E,A])=>{const{vars:L,css:I,varsWithDefaults:T}=B2(A,t);f=_a(f,T),g[E]={css:I,vars:L}}),_){const{css:E,vars:A,varsWithDefaults:L}=B2(_,t);f=_a(f,L),g[r]={css:E,vars:A}}return{vars:f,generateCssVars:E=>{var A;if(!E){var L;const T=ue({},c);return{css:T,vars:a,selector:(t==null||(L=t.getSelector)==null?void 0:L.call(t,E,T))||":root"}}const I=ue({},g[E].css);return{css:I,vars:g[E].vars,selector:(t==null||(A=t.getSelector)==null?void 0:A.call(t,E,I))||":root"}}}}const _K=["component","direction","spacing","divider","children","className","useFlexGap"],xK=lR(),bK=LY("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>t.root});function wK(e){return R6({props:e,name:"MuiStack",defaultTheme:xK})}function SK(e,t){const n=$.Children.toArray(e).filter(Boolean);return n.reduce((r,i,a)=>(r.push(i),a<n.length-1&&r.push($.cloneElement(t,{key:`separator-${a}`})),r),[])}const MK=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],CK=({ownerState:e,theme:t})=>{let n=ue({display:"flex",flexDirection:"column"},Rl({theme:t},z2({values:e.direction,breakpoints:t.breakpoints.values}),r=>({flexDirection:r})));if(e.spacing){const r=sR(t),i=Object.keys(t.breakpoints.values).reduce((f,g)=>((typeof e.spacing=="object"&&e.spacing[g]!=null||typeof e.direction=="object"&&e.direction[g]!=null)&&(f[g]=!0),f),{}),a=z2({values:e.direction,base:i}),c=z2({values:e.spacing,base:i});typeof a=="object"&&Object.keys(a).forEach((f,g,_)=>{if(!a[f]){const C=g>0?a[_[g-1]]:"column";a[f]=C}}),n=_a(n,Rl({theme:t},c,(f,g)=>e.useFlexGap?{gap:wf(r,f)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${MK(g?a[g]:e.direction)}`]:wf(r,f)}}))}return n=PZ(t.breakpoints,n),n};function EK(e={}){const{createStyledComponent:t=bK,useThemeProps:n=wK,componentName:r="MuiStack"}=e,i=()=>vr({root:["root"]},f=>hR(r,f),{}),a=t(CK);return $.forwardRef(function(f,g){const _=n(f),x=uR(_),{component:C="div",direction:E="column",spacing:A=0,divider:L,children:I,className:T,useFlexGap:O=!1}=x,D=Un(x,_K),U={direction:E,spacing:A,useFlexGap:O},H=i();return te.jsx(a,ue({as:C,ownerState:U,ref:g,className:_i(H.root,T)},D,{children:L?SK(I,L):I}))})}const TK=ue({},YS,{borderRadius:{themeKey:"radius"},boxShadow:{themeKey:"shadow"},fontFamily:{themeKey:"fontFamily"},fontSize:{themeKey:"fontSize"},fontWeight:{themeKey:"fontWeight"},letterSpacing:{themeKey:"letterSpacing"},lineHeight:{themeKey:"lineHeight"}});function PK(e){var t;return!!e[0].match(/^(typography|variants|breakpoints)$/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/^(mode)$/))||e[0]==="focus"&&e[1]!=="thickness"}const xr=(e,t)=>hR(e,t,"Mui"),mr=(e,t)=>P6(e,t,"Mui"),AK=e=>e&&typeof e=="object"&&Object.keys(e).some(t=>{var n;return(n=t.match)==null?void 0:n.call(t,/^(plain(Hover|Active|Disabled)?(Color|Bg)|outlined(Hover|Active|Disabled)?(Color|Border|Bg)|soft(Hover|Active|Disabled)?(Color|Bg)|solid(Hover|Active|Disabled)?(Color|Bg))$/)}),cz=(e,t,n)=>{t.includes("Color")&&(e.color=n),t.includes("Bg")&&(e.backgroundColor=n),t.includes("Border")&&(e.borderColor=n)},uz=(e,t,n)=>{const r={};return Object.entries(t||{}).forEach(([i,a])=>{if(i.match(new RegExp(`${e}(color|bg|border)`,"i"))&&a){const c=n?n(i):a;i.includes("Disabled")&&(r.pointerEvents="none",r.cursor="default",r["--Icon-color"]="currentColor"),i.match(/(Hover|Active|Disabled)/)||(r["--variant-borderWidth"]||(r["--variant-borderWidth"]="0px"),i.includes("Border")&&(r["--variant-borderWidth"]="1px",r.border="var(--variant-borderWidth) solid")),cz(r,i,c)}}),r},Qo=(e,t)=>{let n={};{const{getCssVar:r,palette:i}=t;Object.entries(i).forEach(a=>{const[c,s]=a;AK(s)&&typeof s=="object"&&(n=ue({},n,{[c]:uz(e,s,f=>`var(--variant-${f}, ${r(`palette-${c}-${f}`,i[c][f])})`)}))})}return n.context=uz(e,{plainColor:"var(--variant-plainColor)",plainHoverColor:"var(--variant-plainHoverColor)",plainHoverBg:"var(--variant-plainHoverBg)",plainActiveBg:"var(--variant-plainActiveBg)",plainDisabledColor:"var(--variant-plainDisabledColor)",outlinedColor:"var(--variant-outlinedColor)",outlinedBorder:"var(--variant-outlinedBorder)",outlinedHoverColor:"var(--variant-outlinedHoverColor)",outlinedHoverBorder:"var(--variant-outlinedHoverBorder)",outlinedHoverBg:"var(--variant-outlinedHoverBg)",outlinedActiveBg:"var(--variant-outlinedActiveBg)",outlinedDisabledColor:"var(--variant-outlinedDisabledColor)",outlinedDisabledBorder:"var(--variant-outlinedDisabledBorder)",softColor:"var(--variant-softColor)",softBg:"var(--variant-softBg)",softHoverColor:"var(--variant-softHoverColor)",softHoverBg:"var(--variant-softHoverBg)",softActiveBg:"var(--variant-softActiveBg)",softDisabledColor:"var(--variant-softDisabledColor)",softDisabledBg:"var(--variant-softDisabledBg)",solidColor:"var(--variant-solidColor)",solidBg:"var(--variant-solidBg)",solidHoverBg:"var(--variant-solidHoverBg)",solidActiveBg:"var(--variant-solidActiveBg)",solidDisabledColor:"var(--variant-solidDisabledColor)",solidDisabledBg:"var(--variant-solidDisabledBg)"}),n},IK=["cssVarPrefix","breakpoints","spacing","components","variants","shouldSkipGeneratingVar"],RK=["colorSchemes"],LK=(e="joy")=>yR(e);function U6(e){var t,n,r,i,a,c,s,f,g,_;const x=e||{},{cssVarPrefix:C="joy",breakpoints:E,spacing:A,components:L,variants:I,shouldSkipGeneratingVar:T=PK}=x,O=Un(x,IK),D=LK(C),U={primary:Qv.blue,neutral:Qv.grey,danger:Qv.red,success:Qv.green,warning:Qv.yellow,common:{white:"#FFF",black:"#000"}},H=ot=>{var Tt;const Ct=ot.split("-"),un=Ct[1],gn=Ct[2];return D(ot,(Tt=U[un])==null?void 0:Tt[gn])},V=ot=>({plainColor:H(`palette-${ot}-500`),plainHoverBg:H(`palette-${ot}-100`),plainActiveBg:H(`palette-${ot}-200`),plainDisabledColor:H("palette-neutral-400"),outlinedColor:H(`palette-${ot}-500`),outlinedBorder:H(`palette-${ot}-300`),outlinedHoverBg:H(`palette-${ot}-100`),outlinedActiveBg:H(`palette-${ot}-200`),outlinedDisabledColor:H("palette-neutral-400"),outlinedDisabledBorder:H("palette-neutral-200"),softColor:H(`palette-${ot}-700`),softBg:H(`palette-${ot}-100`),softHoverBg:H(`palette-${ot}-200`),softActiveColor:H(`palette-${ot}-800`),softActiveBg:H(`palette-${ot}-300`),softDisabledColor:H("palette-neutral-400"),softDisabledBg:H("palette-neutral-50"),solidColor:H("palette-common-white"),solidBg:H(`palette-${ot}-500`),solidHoverBg:H(`palette-${ot}-600`),solidActiveBg:H(`palette-${ot}-700`),solidDisabledColor:H("palette-neutral-400"),solidDisabledBg:H("palette-neutral-100")}),q=ot=>({plainColor:H(`palette-${ot}-300`),plainHoverBg:H(`palette-${ot}-800`),plainActiveBg:H(`palette-${ot}-700`),plainDisabledColor:H("palette-neutral-500"),outlinedColor:H(`palette-${ot}-200`),outlinedBorder:H(`palette-${ot}-700`),outlinedHoverBg:H(`palette-${ot}-800`),outlinedActiveBg:H(`palette-${ot}-700`),outlinedDisabledColor:H("palette-neutral-500"),outlinedDisabledBorder:H("palette-neutral-800"),softColor:H(`palette-${ot}-200`),softBg:H(`palette-${ot}-800`),softHoverBg:H(`palette-${ot}-700`),softActiveColor:H(`palette-${ot}-100`),softActiveBg:H(`palette-${ot}-600`),softDisabledColor:H("palette-neutral-500"),softDisabledBg:H("palette-neutral-800"),solidColor:H("palette-common-white"),solidBg:H(`palette-${ot}-500`),solidHoverBg:H(`palette-${ot}-600`),solidActiveBg:H(`palette-${ot}-700`),solidDisabledColor:H("palette-neutral-500"),solidDisabledBg:H("palette-neutral-800")}),Q={palette:{mode:"light",primary:ue({},U.primary,V("primary")),neutral:ue({},U.neutral,V("neutral"),{plainColor:H("palette-neutral-700"),plainHoverColor:H("palette-neutral-900"),outlinedColor:H("palette-neutral-700")}),danger:ue({},U.danger,V("danger")),success:ue({},U.success,V("success")),warning:ue({},U.warning,V("warning")),common:{white:"#FFF",black:"#000"},text:{primary:H("palette-neutral-800"),secondary:H("palette-neutral-700"),tertiary:H("palette-neutral-600"),icon:H("palette-neutral-500")},background:{body:H("palette-common-white"),surface:H("palette-neutral-50"),popup:H("palette-common-white"),level1:H("palette-neutral-100"),level2:H("palette-neutral-200"),level3:H("palette-neutral-300"),tooltip:H("palette-neutral-500"),backdrop:`rgba(${D("palette-neutral-darkChannel",Gd(U.neutral[900]))} / 0.25)`},divider:`rgba(${D("palette-neutral-mainChannel",Gd(U.neutral[500]))} / 0.2)`,focusVisible:H("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"21 21 21",shadowOpacity:"0.08"},K={palette:{mode:"dark",primary:ue({},U.primary,q("primary")),neutral:ue({},U.neutral,q("neutral"),{plainColor:H("palette-neutral-300"),plainHoverColor:H("palette-neutral-300")}),danger:ue({},U.danger,q("danger")),success:ue({},U.success,q("success")),warning:ue({},U.warning,q("warning")),common:{white:"#FFF",black:"#000"},text:{primary:H("palette-neutral-100"),secondary:H("palette-neutral-300"),tertiary:H("palette-neutral-400"),icon:H("palette-neutral-400")},background:{body:H("palette-common-black"),surface:H("palette-neutral-900"),popup:H("palette-common-black"),level1:H("palette-neutral-800"),level2:H("palette-neutral-700"),level3:H("palette-neutral-600"),tooltip:H("palette-neutral-600"),backdrop:`rgba(${D("palette-neutral-darkChannel",Gd(U.neutral[50]))} / 0.25)`},divider:`rgba(${D("palette-neutral-mainChannel",Gd(U.neutral[500]))} / 0.16)`,focusVisible:H("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"0 0 0",shadowOpacity:"0.6"},N='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',re=ue({body:`"Inter", ${D(`fontFamily-fallback, ${N}`)}`,display:`"Inter", ${D(`fontFamily-fallback, ${N}`)}`,code:"Source Code Pro,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace",fallback:N},O.fontFamily),ye=ue({sm:300,md:500,lg:600,xl:700},O.fontWeight),ge=ue({xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem",xl2:"1.5rem",xl3:"1.875rem",xl4:"2.25rem"},O.fontSize),Ve=ue({xs:"1.33334",sm:"1.42858",md:"1.5",lg:"1.55556",xl:"1.66667"},O.lineHeight),Ie=(t=(n=O.colorSchemes)==null||(n=n.light)==null?void 0:n.shadowRing)!=null?t:Q.shadowRing,ve=(r=(i=O.colorSchemes)==null||(i=i.light)==null?void 0:i.shadowChannel)!=null?r:Q.shadowChannel,Se=(a=(c=O.colorSchemes)==null||(c=c.light)==null?void 0:c.shadowOpacity)!=null?a:Q.shadowOpacity,Me={colorSchemes:{light:Q,dark:K},fontSize:ge,fontFamily:re,fontWeight:ye,focus:{thickness:"2px",selector:`&.${xr("","focusVisible")}, &:focus-visible`,default:{outlineOffset:`var(--focus-outline-offset, ${D("focus-thickness",(s=(f=O.focus)==null?void 0:f.thickness)!=null?s:"2px")})`,outline:`${D("focus-thickness",(g=(_=O.focus)==null?void 0:_.thickness)!=null?g:"2px")} solid ${D("palette-focusVisible",U.primary[500])}`}},lineHeight:Ve,radius:{xs:"2px",sm:"6px",md:"8px",lg:"12px",xl:"16px"},shadow:{xs:`${D("shadowRing",Ie)}, 0px 1px 2px 0px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)})`,sm:`${D("shadowRing",Ie)}, 0px 1px 2px 0px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)}), 0px 2px 4px 0px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)})`,md:`${D("shadowRing",Ie)}, 0px 2px 8px -2px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)}), 0px 6px 12px -2px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)})`,lg:`${D("shadowRing",Ie)}, 0px 2px 8px -2px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)}), 0px 12px 16px -4px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)})`,xl:`${D("shadowRing",Ie)}, 0px 2px 8px -2px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)}), 0px 20px 24px -4px rgba(${D("shadowChannel",ve)} / ${D("shadowOpacity",Se)})`},zIndex:{badge:1,table:10,popup:1e3,modal:1300,snackbar:1400,tooltip:1500},typography:{h1:{fontFamily:D(`fontFamily-display, ${re.display}`),fontWeight:D(`fontWeight-xl, ${ye.xl}`),fontSize:D(`fontSize-xl4, ${ge.xl4}`),lineHeight:D(`lineHeight-xs, ${Ve.xs}`),letterSpacing:"-0.025em",color:D(`palette-text-primary, ${Q.palette.text.primary}`)},h2:{fontFamily:D(`fontFamily-display, ${re.display}`),fontWeight:D(`fontWeight-xl, ${ye.xl}`),fontSize:D(`fontSize-xl3, ${ge.xl3}`),lineHeight:D(`lineHeight-xs, ${Ve.xs}`),letterSpacing:"-0.025em",color:D(`palette-text-primary, ${Q.palette.text.primary}`)},h3:{fontFamily:D(`fontFamily-display, ${re.display}`),fontWeight:D(`fontWeight-lg, ${ye.lg}`),fontSize:D(`fontSize-xl2, ${ge.xl2}`),lineHeight:D(`lineHeight-xs, ${Ve.xs}`),letterSpacing:"-0.025em",color:D(`palette-text-primary, ${Q.palette.text.primary}`)},h4:{fontFamily:D(`fontFamily-display, ${re.display}`),fontWeight:D(`fontWeight-lg, ${ye.lg}`),fontSize:D(`fontSize-xl, ${ge.xl}`),lineHeight:D(`lineHeight-md, ${Ve.md}`),letterSpacing:"-0.025em",color:D(`palette-text-primary, ${Q.palette.text.primary}`)},"title-lg":{fontFamily:D(`fontFamily-body, ${re.body}`),fontWeight:D(`fontWeight-lg, ${ye.lg}`),fontSize:D(`fontSize-lg, ${ge.lg}`),lineHeight:D(`lineHeight-xs, ${Ve.xs}`),color:D(`palette-text-primary, ${Q.palette.text.primary}`)},"title-md":{fontFamily:D(`fontFamily-body, ${re.body}`),fontWeight:D(`fontWeight-md, ${ye.md}`),fontSize:D(`fontSize-md, ${ge.md}`),lineHeight:D(`lineHeight-md, ${Ve.md}`),color:D(`palette-text-primary, ${Q.palette.text.primary}`)},"title-sm":{fontFamily:D(`fontFamily-body, ${re.body}`),fontWeight:D(`fontWeight-md, ${ye.md}`),fontSize:D(`fontSize-sm, ${ge.sm}`),lineHeight:D(`lineHeight-sm, ${Ve.sm}`),color:D(`palette-text-primary, ${Q.palette.text.primary}`)},"body-lg":{fontFamily:D(`fontFamily-body, ${re.body}`),fontSize:D(`fontSize-lg, ${ge.lg}`),lineHeight:D(`lineHeight-md, ${Ve.md}`),color:D(`palette-text-secondary, ${Q.palette.text.secondary}`)},"body-md":{fontFamily:D(`fontFamily-body, ${re.body}`),fontSize:D(`fontSize-md, ${ge.md}`),lineHeight:D(`lineHeight-md, ${Ve.md}`),color:D(`palette-text-secondary, ${Q.palette.text.secondary}`)},"body-sm":{fontFamily:D(`fontFamily-body, ${re.body}`),fontSize:D(`fontSize-sm, ${ge.sm}`),lineHeight:D(`lineHeight-md, ${Ve.md}`),color:D(`palette-text-tertiary, ${Q.palette.text.tertiary}`)},"body-xs":{fontFamily:D(`fontFamily-body, ${re.body}`),fontWeight:D(`fontWeight-md, ${ye.md}`),fontSize:D(`fontSize-xs, ${ge.xs}`),lineHeight:D(`lineHeight-md, ${Ve.md}`),color:D(`palette-text-tertiary, ${Q.palette.text.tertiary}`)}}},Be=O?_a(Me,O):Me,{colorSchemes:Qe}=Be,st=Un(Be,RK),ct=ue({colorSchemes:Qe},st,{breakpoints:y6(E??{}),components:_a({MuiSvgIcon:{defaultProps:{fontSize:"xl2"},styleOverrides:{root:({ownerState:ot,theme:Tt})=>{var Ct;const un=ot.instanceFontSize;return ue({margin:"var(--Icon-margin)"},ot.fontSize&&ot.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${Tt.vars.fontSize[ot.fontSize]})`},!ot.htmlColor&&ue({color:`var(--Icon-color, ${ct.vars.palette.text.icon})`},ot.color&&ot.color!=="inherit"&&Tt.vars.palette[ot.color]&&{color:`rgba(${(Ct=Tt.vars.palette[ot.color])==null?void 0:Ct.mainChannel} / 1)`}),un&&un!=="inherit"&&{"--Icon-fontSize":Tt.vars.fontSize[un]})}}}},L),cssVarPrefix:C,getCssVar:D,spacing:w6(A)});function Xt(ot,Tt){Object.keys(Tt).forEach(Ct=>{const un={main:"500",light:"200",dark:"700"};ot==="dark"&&(un.main=400),!Tt[Ct].mainChannel&&Tt[Ct][un.main]&&(Tt[Ct].mainChannel=Gd(Tt[Ct][un.main])),!Tt[Ct].lightChannel&&Tt[Ct][un.light]&&(Tt[Ct].lightChannel=Gd(Tt[Ct][un.light])),!Tt[Ct].darkChannel&&Tt[Ct][un.dark]&&(Tt[Ct].darkChannel=Gd(Tt[Ct][un.dark]))})}Object.entries(ct.colorSchemes).forEach(([ot,Tt])=>{Xt(ot,Tt.palette)});const je={prefix:C,shouldSkipGeneratingVar:T},{vars:lt,generateCssVars:Ot}=yK(ue({colorSchemes:Qe},st),je);ct.vars=lt,ct.generateCssVars=Ot,ct.unstable_sxConfig=ue({},TK,e==null?void 0:e.unstable_sxConfig),ct.unstable_sx=function(Tt){return w_({sx:Tt,theme:this})},ct.getColorSchemeSelector=ot=>ot==="light"?"&":`&[data-joy-color-scheme="${ot}"], [data-joy-color-scheme="${ot}"] &`;const ut={getCssVar:D,palette:ct.colorSchemes.light.palette};return ct.variants=_a({plain:Qo("plain",ut),plainHover:Qo("plainHover",ut),plainActive:Qo("plainActive",ut),plainDisabled:Qo("plainDisabled",ut),outlined:Qo("outlined",ut),outlinedHover:Qo("outlinedHover",ut),outlinedActive:Qo("outlinedActive",ut),outlinedDisabled:Qo("outlinedDisabled",ut),soft:Qo("soft",ut),softHover:Qo("softHover",ut),softActive:Qo("softActive",ut),softDisabled:Qo("softDisabled",ut),solid:Qo("solid",ut),solidHover:Qo("solidHover",ut),solidActive:Qo("solidActive",ut),solidDisabled:Qo("solidDisabled",ut)},I),ct.palette=ue({},ct.colorSchemes.light.palette,{colorScheme:"light"}),ct.shouldSkipGeneratingVar=T,ct.applyStyles=S6,ct}const Lg=U6(),t0={attribute:"data-joy-color-scheme",colorSchemeStorageKey:"joy-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"joy-mode"},{CssVarsProvider:kK,useColorScheme:_R,getInitColorSchemeScript:LAe}=dK({themeId:v_,theme:Lg,attribute:t0.attribute,modeStorageKey:t0.modeStorageKey,colorSchemeStorageKey:t0.colorSchemeStorageKey,defaultColorScheme:{light:t0.defaultLightColorScheme,dark:t0.defaultDarkColorScheme}}),nn=A6({defaultTheme:Lg,themeId:v_});function br({props:e,name:t}){return R6({props:e,name:t,defaultTheme:ue({},Lg,{components:{}}),themeId:v_})}function DK(e){return te.jsx(yY,ue({},e,{defaultTheme:Lg,themeId:v_}))}function hz(e,t,n=(r,i)=>r===i){return e.length===t.length&&e.every((r,i)=>n(r,t[i]))}const zK={disableDefaultClasses:!1},OK=$.createContext(zK);function FK(e){const{disableDefaultClasses:t}=$.useContext(OK);return n=>t?"":e(n)}function NK(e){const{rootElementName:t="",componentName:n}=e,[r,i]=$.useState(t.toUpperCase()),a=$.useCallback(c=>{var s;i((s=c==null?void 0:c.tagName)!=null?s:"")},[]);return[r,a]}const $6="base";function BK(e){return`${$6}--${e}`}function UK(e,t){return`${$6}-${e}-${t}`}function V6(e,t){const n=T6[t];return n?BK(n):UK(e,t)}function $K(e,t){const n={};return t.forEach(r=>{n[r]=V6(e,r)}),n}function _c(e={}){const{disabled:t=!1,focusableWhenDisabled:n,href:r,rootRef:i,tabIndex:a,to:c,type:s,rootElementName:f}=e,g=$.useRef(null),[_,x]=$.useState(!1),{isFocusVisibleRef:C,onFocus:E,onBlur:A,ref:L}=pR(),[I,T]=$.useState(!1);t&&!n&&I&&T(!1),$.useEffect(()=>{C.current=I},[I,C]);const[O,D]=NK({rootElementName:f??(r||c?"a":void 0),componentName:"Button"}),U=Ie=>ve=>{var Se;I&&ve.preventDefault(),(Se=Ie.onMouseLeave)==null||Se.call(Ie,ve)},H=Ie=>ve=>{var Se;A(ve),C.current===!1&&T(!1),(Se=Ie.onBlur)==null||Se.call(Ie,ve)},V=Ie=>ve=>{var Se;if(g.current||(g.current=ve.currentTarget),E(ve),C.current===!0){var Me;T(!0),(Me=Ie.onFocusVisible)==null||Me.call(Ie,ve)}(Se=Ie.onFocus)==null||Se.call(Ie,ve)},q=()=>{const Ie=g.current;return O==="BUTTON"||O==="INPUT"&&["button","submit","reset"].includes(Ie==null?void 0:Ie.type)||O==="A"&&(Ie==null?void 0:Ie.href)},Q=Ie=>ve=>{if(!t){var Se;(Se=Ie.onClick)==null||Se.call(Ie,ve)}},K=Ie=>ve=>{var Se;t||(x(!0),document.addEventListener("mouseup",()=>{x(!1)},{once:!0})),(Se=Ie.onMouseDown)==null||Se.call(Ie,ve)},N=Ie=>ve=>{var Se;if((Se=Ie.onKeyDown)==null||Se.call(Ie,ve),!ve.defaultMuiPrevented&&(ve.target===ve.currentTarget&&!q()&&ve.key===" "&&ve.preventDefault(),ve.target===ve.currentTarget&&ve.key===" "&&!t&&x(!0),ve.target===ve.currentTarget&&!q()&&ve.key==="Enter"&&!t)){var Me;(Me=Ie.onClick)==null||Me.call(Ie,ve),ve.preventDefault()}},re=Ie=>ve=>{var Se;if(ve.target===ve.currentTarget&&x(!1),(Se=Ie.onKeyUp)==null||Se.call(Ie,ve),ve.target===ve.currentTarget&&!q()&&!t&&ve.key===" "&&!ve.defaultMuiPrevented){var Me;(Me=Ie.onClick)==null||Me.call(Ie,ve)}},ye=Br(D,i,L,g),ge={};return a!==void 0&&(ge.tabIndex=a),O==="BUTTON"?(ge.type=s??"button",n?ge["aria-disabled"]=t:ge.disabled=t):O==="INPUT"?s&&["button","submit","reset"].includes(s)&&(n?ge["aria-disabled"]=t:ge.disabled=t):O!==""&&(!r&&!c&&(ge.role="button",ge.tabIndex=a??0),t&&(ge["aria-disabled"]=t,ge.tabIndex=n?a??0:-1)),{getRootProps:(Ie={})=>{const ve=ue({},uo(e),uo(Ie)),Se=ue({type:s},ve,ge,Ie,{onBlur:H(ve),onClick:Q(ve),onFocus:V(ve),onKeyDown:N(ve),onKeyUp:re(ve),onMouseDown:K(ve),onMouseLeave:U(ve),ref:ye});return delete Se.onFocusVisible,Se},focusVisible:I,setFocusVisible:T,active:_,rootRef:ye}}function dz(e){return e.substring(2).toLowerCase()}function VK(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function jK(e){const{children:t,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:i,touchEvent:a="onTouchEnd"}=e,c=$.useRef(!1),s=$.useRef(null),f=$.useRef(!1),g=$.useRef(!1);$.useEffect(()=>(setTimeout(()=>{f.current=!0},0),()=>{f.current=!1}),[]);const _=Br(JS(t),s),x=Cl(A=>{const L=g.current;g.current=!1;const I=xa(s.current);if(!f.current||!s.current||"clientX"in A&&VK(A,I))return;if(c.current){c.current=!1;return}let T;A.composedPath?T=A.composedPath().indexOf(s.current)>-1:T=!I.documentElement.contains(A.target)||s.current.contains(A.target),!T&&(n||!L)&&i(A)}),C=A=>L=>{g.current=!0;const I=t.props[A];I&&I(L)},E={ref:_};return a!==!1&&(E[a]=C(a)),$.useEffect(()=>{if(a!==!1){const A=dz(a),L=xa(s.current),I=()=>{c.current=!0};return L.addEventListener(A,x),L.addEventListener("touchmove",I),()=>{L.removeEventListener(A,x),L.removeEventListener("touchmove",I)}}},[x,a]),r!==!1&&(E[r]=C(r)),$.useEffect(()=>{if(r!==!1){const A=dz(r),L=xa(s.current);return L.addEventListener(A,x),()=>{L.removeEventListener(A,x)}}},[x,r]),te.jsx($.Fragment,{children:$.cloneElement(t,E)})}const QS=$.createContext(null);function HK(e,t){return e===t}const U2={},fz=()=>{};function pP(e,t){const n=ue({},e);return Object.keys(t).forEach(r=>{t[r]!==void 0&&(n[r]=t[r])}),n}function GK(e){const{nextState:t,initialState:n,stateComparers:r,onStateChange:i,controlledProps:a,lastActionRef:c}=e,s=$.useRef(n);$.useEffect(()=>{if(c.current===null)return;const f=pP(s.current,a);Object.keys(t).forEach(g=>{var _;const x=(_=r[g])!=null?_:HK,C=t[g],E=f[g];if(E==null&&C!=null||E!=null&&C==null||E!=null&&C!=null&&!x(C,E)){var A,L;i==null||i((A=c.current.event)!=null?A:null,g,C,(L=c.current.type)!=null?L:"",t)}}),s.current=t,c.current=null},[s,t,c,i,r,a])}function j6(e){const t=$.useRef(null),{reducer:n,initialState:r,controlledProps:i=U2,stateComparers:a=U2,onStateChange:c=fz,actionContext:s,componentName:f=""}=e;$.useRef(i);const g=$.useCallback((E,A)=>{t.current=A;const L=pP(E,i);return n(L,A)},[i,n]),[_,x]=$.useReducer(g,r),C=$.useCallback(E=>{x(ue({},E,{context:s}))},[s]);return GK({nextState:_,initialState:r,stateComparers:a??U2,onStateChange:c??fz,controlledProps:i,lastActionRef:t}),[pP(_,i),C]}const Sl={blur:"dropdown:blur",escapeKeyDown:"dropdown:escapeKeyDown",toggle:"dropdown:toggle",open:"dropdown:open",close:"dropdown:close"};function WK(e,t){switch(t.type){case Sl.blur:return{open:!1,changeReason:t.event};case Sl.escapeKeyDown:return{open:!1,changeReason:t.event};case Sl.toggle:return{open:!e.open,changeReason:t.event};case Sl.open:return{open:!0,changeReason:t.event};case Sl.close:return{open:!1,changeReason:t.event};default:throw new Error("Unhandled action")}}function qK(e={}){const{defaultOpen:t,onOpenChange:n,open:r,componentName:i="useDropdown"}=e,[a,c]=$.useState(""),[s,f]=$.useState(null),g=$.useRef(null),_=$.useCallback((L,I,T,O)=>{I==="open"&&(n==null||n(L,T)),g.current=O},[n]),x=$.useMemo(()=>r!==void 0?{open:r}:{},[r]),[C,E]=j6({controlledProps:x,initialState:t?{open:!0,changeReason:null}:{open:!1,changeReason:null},onStateChange:_,reducer:WK,componentName:i});return $.useEffect(()=>{!C.open&&g.current!==null&&g.current!==Sl.blur&&(s==null||s.focus())},[C.open,s]),{contextValue:{state:C,dispatch:E,popupId:a,registerPopup:c,registerTrigger:f,triggerElement:s},open:C.open}}function XK(e){const{children:t,open:n,defaultOpen:r,onOpenChange:i}=e,{contextValue:a}=qK({defaultOpen:r,onOpenChange:i,open:n});return te.jsx(QS.Provider,{value:a,children:t})}const ZK=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function YK(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:t}function KK(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const t=r=>e.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=t(`[name="${e.name}"]:checked`);return n||(n=t(`[name="${e.name}"]`)),n!==e}function JK(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||KK(e))}function QK(e){const t=[],n=[];return Array.from(e.querySelectorAll(ZK)).forEach((r,i)=>{const a=YK(r);a===-1||!JK(r)||(a===0?t.push(r):n.push({documentOrder:i,tabIndex:a,node:r}))}),n.sort((r,i)=>r.tabIndex===i.tabIndex?r.documentOrder-i.documentOrder:r.tabIndex-i.tabIndex).map(r=>r.node).concat(t)}function eJ(){return!0}function tJ(e){const{children:t,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:a=QK,isEnabled:c=eJ,open:s}=e,f=$.useRef(!1),g=$.useRef(null),_=$.useRef(null),x=$.useRef(null),C=$.useRef(null),E=$.useRef(!1),A=$.useRef(null),L=Br(JS(t),A),I=$.useRef(null);$.useEffect(()=>{!s||!A.current||(E.current=!n)},[n,s]),$.useEffect(()=>{if(!s||!A.current)return;const D=xa(A.current);return A.current.contains(D.activeElement)||(A.current.hasAttribute("tabIndex")||A.current.setAttribute("tabIndex","-1"),E.current&&A.current.focus()),()=>{i||(x.current&&x.current.focus&&(f.current=!0,x.current.focus()),x.current=null)}},[s]),$.useEffect(()=>{if(!s||!A.current)return;const D=xa(A.current),U=q=>{I.current=q,!(r||!c()||q.key!=="Tab")&&D.activeElement===A.current&&q.shiftKey&&(f.current=!0,_.current&&_.current.focus())},H=()=>{const q=A.current;if(q===null)return;if(!D.hasFocus()||!c()||f.current){f.current=!1;return}if(q.contains(D.activeElement)||r&&D.activeElement!==g.current&&D.activeElement!==_.current)return;if(D.activeElement!==C.current)C.current=null;else if(C.current!==null)return;if(!E.current)return;let Q=[];if((D.activeElement===g.current||D.activeElement===_.current)&&(Q=a(A.current)),Q.length>0){var K,N;const re=!!((K=I.current)!=null&&K.shiftKey&&((N=I.current)==null?void 0:N.key)==="Tab"),ye=Q[0],ge=Q[Q.length-1];typeof ye!="string"&&typeof ge!="string"&&(re?ge.focus():ye.focus())}else q.focus()};D.addEventListener("focusin",H),D.addEventListener("keydown",U,!0);const V=setInterval(()=>{D.activeElement&&D.activeElement.tagName==="BODY"&&H()},50);return()=>{clearInterval(V),D.removeEventListener("focusin",H),D.removeEventListener("keydown",U,!0)}},[n,r,i,c,s,a]);const T=D=>{x.current===null&&(x.current=D.relatedTarget),E.current=!0,C.current=D.target;const U=t.props.onFocus;U&&U(D)},O=D=>{x.current===null&&(x.current=D.relatedTarget),E.current=!0};return te.jsxs($.Fragment,{children:[te.jsx("div",{tabIndex:s?0:-1,onFocus:O,ref:g,"data-testid":"sentinelStart"}),$.cloneElement(t,{ref:L,onFocus:T}),te.jsx("div",{tabIndex:s?0:-1,onFocus:O,ref:_,"data-testid":"sentinelEnd"})]})}const nJ=$.createContext(void 0);function rJ(){return $.useContext(nJ)}function iJ(e={}){const{defaultValue:t,disabled:n=!1,error:r=!1,onBlur:i,onChange:a,onFocus:c,required:s=!1,value:f,inputRef:g}=e,_=rJ();let x,C,E,A,L;if(_){var I,T,O;x=void 0,C=(I=_.disabled)!=null?I:!1,E=(T=_.error)!=null?T:!1,A=(O=_.required)!=null?O:!1,L=_.value}else x=t,C=n,E=r,A=s,L=f;const{current:D}=$.useRef(L!=null),U=$.useCallback(Ie=>{},[]),H=$.useRef(null),V=Br(H,g,U),[q,Q]=$.useState(!1);$.useEffect(()=>{!_&&C&&q&&(Q(!1),i==null||i())},[_,C,q,i]);const K=Ie=>ve=>{var Se;if(_!=null&&_.disabled){ve.stopPropagation();return}if((Se=Ie.onFocus)==null||Se.call(Ie,ve),_&&_.onFocus){var Me;_==null||(Me=_.onFocus)==null||Me.call(_)}else Q(!0)},N=Ie=>ve=>{var Se;(Se=Ie.onBlur)==null||Se.call(Ie,ve),_&&_.onBlur?_.onBlur():Q(!1)},re=Ie=>(ve,...Se)=>{var Me,Be;if(!D&&(ve.target||H.current)==null)throw new Error(Ay(17));_==null||(Me=_.onChange)==null||Me.call(_,ve),(Be=Ie.onChange)==null||Be.call(Ie,ve,...Se)},ye=Ie=>ve=>{var Se;H.current&&ve.currentTarget===ve.target&&H.current.focus(),(Se=Ie.onClick)==null||Se.call(Ie,ve)};return{disabled:C,error:E,focused:q,formControlContext:_,getInputProps:(Ie={})=>{const Se=ue({},{onBlur:i,onChange:a,onFocus:c},uo(Ie)),Me=ue({},Se,{onBlur:N(Se),onChange:re(Se),onFocus:K(Se)});return ue({},Me,{"aria-invalid":E||void 0,defaultValue:x,value:L,required:A,disabled:C},Ie,{ref:V},Me)},getRootProps:(Ie={})=>{const ve=uo(e,["onBlur","onChange","onFocus"]),Se=ue({},ve,uo(Ie));return ue({},Ie,Se,{onClick:ye(Se)})},inputRef:V,required:A,value:L}}const qr={blur:"list:blur",focus:"list:focus",itemClick:"list:itemClick",itemHover:"list:itemHover",itemsChange:"list:itemsChange",keyDown:"list:keyDown",resetHighlight:"list:resetHighlight",highlightLast:"list:highlightLast",textNavigation:"list:textNavigation",clearSelection:"list:clearSelection"};function oJ(e,t,n,r,i,a){if(n.length===0||!r&&n.every((s,f)=>i(s,f)))return-1;let c=e;for(;;){if(!a&&t==="next"&&c===n.length||!a&&t==="previous"&&c===-1)return-1;if(r?!1:i(n[c],c))c+=t==="next"?1:-1,a&&(c=(c+n.length)%n.length);else return c}}function So(e,t,n){var r;const{items:i,isItemDisabled:a,disableListWrap:c,disabledItemsFocusable:s,itemComparer:f,focusManagement:g}=n,_=g==="DOM"?0:-1,x=i.length-1,C=e==null?-1:i.findIndex(T=>f(T,e));let E,A,L=!c;switch(t){case"reset":if(_===-1)return null;E=0,A="next",L=!1;break;case"start":E=0,A="next",L=!1;break;case"end":E=x,A="previous",L=!1;break;default:{const T=C+t;T<0?!L&&C!==-1||Math.abs(t)>1?(E=0,A="next"):(E=x,A="previous"):T>x?!L||Math.abs(t)>1?(E=x,A="previous"):(E=0,A="next"):(E=T,A=t>=0?"next":"previous")}}const I=oJ(E,A,i,s,a,L);return I===-1&&e!==null&&!a(e,C)?e:(r=i[I])!=null?r:null}function sJ(e,t,n,r){return n==="none"?[]:n==="single"?r(t[0],e)?t:[e]:t.some(i=>r(i,e))?t.filter(i=>!r(i,e)):[...t,e]}function xR(e,t,n){const{itemComparer:r,isItemDisabled:i,selectionMode:a,items:c}=n,{selectedValues:s}=t,f=c.findIndex(_=>r(e,_));if(i(e,f))return t;const g=sJ(e,s,a,r);return ue({},t,{selectedValues:g,highlightedValue:e})}function aJ(e,t,n){const r=t.highlightedValue,{orientation:i,pageSize:a}=n;switch(e){case"Home":return ue({},t,{highlightedValue:So(r,"start",n)});case"End":return ue({},t,{highlightedValue:So(r,"end",n)});case"PageUp":return ue({},t,{highlightedValue:So(r,-a,n)});case"PageDown":return ue({},t,{highlightedValue:So(r,a,n)});case"ArrowUp":if(i!=="vertical")break;return ue({},t,{highlightedValue:So(r,-1,n)});case"ArrowDown":if(i!=="vertical")break;return ue({},t,{highlightedValue:So(r,1,n)});case"ArrowLeft":{if(i==="vertical")break;return ue({},t,{highlightedValue:So(r,i==="horizontal-ltr"?-1:1,n)})}case"ArrowRight":{if(i==="vertical")break;return ue({},t,{highlightedValue:So(r,i==="horizontal-ltr"?1:-1,n)})}case"Enter":case" ":return t.highlightedValue===null?t:xR(t.highlightedValue,t,n)}return t}function lJ(e,t){return t.focusManagement==="DOM"?e:ue({},e,{highlightedValue:null})}function cJ(e,t,n){var r;const i=(r=n(e))==null?void 0:r.trim().toLowerCase();return!i||i.length===0?!1:i.indexOf(t)===0}function uJ(e,t,n){const{items:r,isItemDisabled:i,disabledItemsFocusable:a,getItemAsString:c}=n,s=t.length>1;let f=s?e.highlightedValue:So(e.highlightedValue,1,n);for(let g=0;g<r.length;g+=1){if(!f||!s&&e.highlightedValue===f)return e;if(cJ(f,t,c)&&(!i(f,r.indexOf(f))||a))return ue({},e,{highlightedValue:f});f=So(f,1,n)}return e}function hJ(e,t,n,r){var i;const{itemComparer:a,focusManagement:c}=r;let s=null;if(n.highlightedValue!=null){var f;s=(f=e.find(x=>a(x,n.highlightedValue)))!=null?f:null}else c==="DOM"&&t.length===0&&(s=So(null,"reset",r));const _=((i=n.selectedValues)!=null?i:[]).filter(x=>e.some(C=>a(C,x)));return ue({},n,{highlightedValue:s,selectedValues:_})}function dJ(e,t){return ue({},e,{highlightedValue:So(null,"reset",t)})}function fJ(e,t){return ue({},e,{highlightedValue:So(null,"end",t)})}function pJ(e,t){return ue({},e,{selectedValues:[],highlightedValue:So(null,"reset",t)})}function eM(e,t){const{type:n,context:r}=t;switch(n){case qr.keyDown:return aJ(t.key,e,r);case qr.itemClick:return xR(t.item,e,r);case qr.blur:return lJ(e,r);case qr.textNavigation:return uJ(e,t.searchString,r);case qr.itemsChange:return hJ(t.items,t.previousItems,e,r);case qr.resetHighlight:return dJ(e,r);case qr.highlightLast:return fJ(e,r);case qr.clearSelection:return pJ(e,r);default:return e}}const mJ=500;function gJ(e){const t=$.useRef({searchString:"",lastTime:null});return $.useCallback(n=>{if(n.key.length===1&&n.key!==" "){const r=t.current,i=n.key.toLowerCase(),a=performance.now();r.searchString.length>0&&r.lastTime&&a-r.lastTime>mJ?r.searchString=i:(r.searchString.length!==1||i!==r.searchString)&&(r.searchString+=i),r.lastTime=a,e(r.searchString,n)}},[e])}const pz={},vJ=()=>{},yJ=(e,t)=>e===t,_J=()=>!1,xJ=e=>typeof e=="string"?e:String(e),bJ=()=>({highlightedValue:null,selectedValues:[]});function bR(e){const{controlledProps:t=pz,disabledItemsFocusable:n=!1,disableListWrap:r=!1,focusManagement:i="activeDescendant",getInitialState:a=bJ,getItemDomElement:c,getItemId:s,isItemDisabled:f=_J,rootRef:g,onStateChange:_=vJ,items:x,itemComparer:C=yJ,getItemAsString:E=xJ,onChange:A,onHighlightChange:L,onItemsChange:I,orientation:T="vertical",pageSize:O=5,reducerActionContext:D=pz,selectionMode:U="single",stateReducer:H,componentName:V="useList"}=e,q=$.useRef(null),Q=Br(g,q),K=$.useCallback((ut,ot,Tt)=>{if(L==null||L(ut,ot,Tt),i==="DOM"&&ot!=null&&(Tt===qr.itemClick||Tt===qr.keyDown||Tt===qr.textNavigation)){var Ct;c==null||(Ct=c(ot))==null||Ct.focus()}},[c,L,i]),N=$.useMemo(()=>({highlightedValue:C,selectedValues:(ut,ot)=>hz(ut,ot,C)}),[C]),re=$.useCallback((ut,ot,Tt,Ct,un)=>{switch(_==null||_(ut,ot,Tt,Ct,un),ot){case"highlightedValue":K(ut,Tt,Ct);break;case"selectedValues":A==null||A(ut,Tt,Ct);break}},[K,A,_]),ye=$.useMemo(()=>({disabledItemsFocusable:n,disableListWrap:r,focusManagement:i,isItemDisabled:f,itemComparer:C,items:x,getItemAsString:E,onHighlightChange:K,orientation:T,pageSize:O,selectionMode:U,stateComparers:N}),[n,r,i,f,C,x,E,K,T,O,U,N]),ge=a(),Ve=H??eM,Ie=$.useMemo(()=>ue({},D,ye),[D,ye]),[ve,Se]=j6({reducer:Ve,actionContext:Ie,initialState:ge,controlledProps:t,stateComparers:N,onStateChange:re,componentName:V}),{highlightedValue:Me,selectedValues:Be}=ve,Qe=gJ((ut,ot)=>Se({type:qr.textNavigation,event:ot,searchString:ut})),st=$.useRef([]);$.useEffect(()=>{hz(st.current,x,C)||(Se({type:qr.itemsChange,event:null,items:x,previousItems:st.current}),st.current=x,I==null||I(x))},[x,C,Se,I]);const ct=ut=>ot=>{var Tt;if((Tt=ut.onKeyDown)==null||Tt.call(ut,ot),ot.defaultMuiPrevented)return;const Ct=["Home","End","PageUp","PageDown"];T==="vertical"?Ct.push("ArrowUp","ArrowDown"):Ct.push("ArrowLeft","ArrowRight"),i==="activeDescendant"&&Ct.push(" ","Enter"),Ct.includes(ot.key)&&ot.preventDefault(),Se({type:qr.keyDown,key:ot.key,event:ot}),Qe(ot)},Xt=ut=>ot=>{var Tt,Ct;(Tt=ut.onBlur)==null||Tt.call(ut,ot),!ot.defaultMuiPrevented&&((Ct=q.current)!=null&&Ct.contains(ot.relatedTarget)||Se({type:qr.blur,event:ot}))},je=(ut={})=>{const ot=uo(ut);return ue({},ut,{"aria-activedescendant":i==="activeDescendant"&&Me!=null?s(Me):void 0,tabIndex:i==="DOM"?-1:0,ref:Q},ot,{onBlur:Xt(ot),onKeyDown:ct(ot)})},lt=$.useCallback(ut=>{const ot=(Be??[]).some(un=>un!=null&&C(ut,un)),Tt=Me!=null&&C(ut,Me);return{focusable:i==="DOM",highlighted:Tt,selected:ot}},[C,Be,Me,i]),Ot=$.useMemo(()=>({dispatch:Se,getItemState:lt}),[Se,lt]);return $.useDebugValue({state:ve}),{contextValue:Ot,dispatch:Se,getRootProps:je,rootRef:Q,state:ve}}const qh=$.createContext(null);function wR(e){const{handlePointerOverEvents:t=!1,item:n}=e,r=$.useContext(qh);if(!r)throw new Error("useListItem must be used within a ListProvider");const{dispatch:i,getItemState:a}=r,{highlighted:c,selected:s,focusable:f}=a(n),g=$.useCallback(E=>A=>{var L;(L=E.onClick)==null||L.call(E,A),!A.defaultPrevented&&i({type:qr.itemClick,item:n,event:A})},[i,n]),_=$.useCallback(E=>A=>{var L;(L=E.onMouseOver)==null||L.call(E,A),!A.defaultPrevented&&i({type:qr.itemHover,item:n,event:A})},[i,n]);let x;return f&&(x=c?0:-1),{getRootProps:(E={})=>{const A=uo(E);return ue({},E,{onClick:g(A),onPointerOver:t?_(A):void 0,tabIndex:x})},highlighted:c,selected:s}}function wJ(e,t){if(t.type===qr.itemHover)return ue({},e,{highlightedValue:t.item});const n=eM(e,t);if(n.highlightedValue===null&&t.context.items.length>0)return ue({},n,{highlightedValue:t.context.items[0]});if(t.type===qr.keyDown&&t.event.key==="Escape")return ue({},n,{open:!1});if(t.type===qr.blur){var r;if(!((r=t.context.listboxRef.current)!=null&&r.contains(t.event.relatedTarget))){var i,a;const c=(i=t.context.listboxRef.current)==null?void 0:i.getAttribute("id"),s=(a=t.event.relatedTarget)==null?void 0:a.getAttribute("aria-controls");return c&&s&&c===s?n:ue({},n,{open:!1,highlightedValue:t.context.items[0]})}}return n}const M_=$.createContext(null);function SJ(e){const t=Array.from(e.keys()).map(n=>{const r=e.get(n);return{key:n,subitem:r}});return t.sort((n,r)=>{const i=n.subitem.ref.current,a=r.subitem.ref.current;return i===null||a===null||i===a?0:i.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_PRECEDING?1:-1}),new Map(t.map(n=>[n.key,n.subitem]))}function tM(){const[e,t]=$.useState(new Map),n=$.useRef(new Set),r=$.useCallback(function(g){n.current.delete(g),t(_=>{const x=new Map(_);return x.delete(g),x})},[]),i=$.useCallback(function(g,_){let x;return typeof g=="function"?x=g(n.current):x=g,n.current.add(x),t(C=>{const E=new Map(C);return E.set(x,_),E}),{id:x,deregister:()=>r(x)}},[r]),a=$.useMemo(()=>SJ(e),[e]),c=$.useCallback(function(g){return Array.from(a.keys()).indexOf(g)},[a]);return{contextValue:$.useMemo(()=>({getItemIndex:c,registerItem:i,totalSubitemCount:e.size}),[c,i,e.size]),subitems:a}}function nM(e,t){const n=$.useContext(M_);if(n===null)throw new Error("useCompoundItem must be used within a useCompoundParent");const{registerItem:r}=n,[i,a]=$.useState(typeof e=="function"?void 0:e);return tu(()=>{const{id:c,deregister:s}=r(e,t);return a(c),s},[r,t,e]),{id:i,index:i!==void 0?n.getItemIndex(i):-1,totalItemCount:n.totalSubitemCount}}function nu(e,t){return function(r={}){const i=ue({},r,e(r));return ue({},i,t(i))}}const MJ={dispatch:()=>{},popupId:"",registerPopup:()=>{},registerTrigger:()=>{},state:{open:!0,changeReason:null},triggerElement:null};function CJ(e={}){var t,n;const{listboxRef:r,onItemsChange:i,id:a,disabledItemsFocusable:c=!0,disableListWrap:s=!1,autoFocus:f=!0,componentName:g="useMenu"}=e,_=$.useRef(null),x=Br(_,r),C=(t=Gs(a))!=null?t:"",{state:{open:E,changeReason:A},dispatch:L,triggerElement:I,registerPopup:T}=(n=$.useContext(QS))!=null?n:MJ,O=$.useRef(E),{subitems:D,contextValue:U}=tM(),H=$.useMemo(()=>Array.from(D.keys()),[D]),V=$.useCallback(Be=>{var Qe,st;return Be==null?null:(Qe=(st=D.get(Be))==null?void 0:st.ref.current)!=null?Qe:null},[D]),q=$.useCallback(Be=>{var Qe;return(D==null||(Qe=D.get(Be))==null?void 0:Qe.disabled)||!1},[D]),Q=$.useCallback(Be=>{var Qe,st;return((Qe=D.get(Be))==null?void 0:Qe.label)||((st=D.get(Be))==null||(st=st.ref.current)==null?void 0:st.innerText)},[D]),K=$.useMemo(()=>({listboxRef:_}),[_]),{dispatch:N,getRootProps:re,contextValue:ye,state:{highlightedValue:ge},rootRef:Ve}=bR({disabledItemsFocusable:c,disableListWrap:s,focusManagement:"DOM",getItemDomElement:V,getInitialState:()=>({selectedValues:[],highlightedValue:null}),isItemDisabled:q,items:H,getItemAsString:Q,rootRef:x,onItemsChange:i,reducerActionContext:K,selectionMode:"none",stateReducer:wJ,componentName:g});tu(()=>{T(C)},[C,T]),tu(()=>{E&&(A==null?void 0:A.type)==="keydown"&&A.key==="ArrowUp"&&N({type:qr.highlightLast,event:A})},[E,A,N]),$.useEffect(()=>{if(E&&f&&ge&&!O.current){var Be;(Be=D.get(ge))==null||(Be=Be.ref)==null||(Be=Be.current)==null||Be.focus()}},[E,f,ge,D,H]),$.useEffect(()=>{var Be;if((Be=_.current)!=null&&Be.contains(document.activeElement)&&ge!==null){var Qe;D==null||(Qe=D.get(ge))==null||(Qe=Qe.ref.current)==null||Qe.focus()}},[ge,D]);const Ie=Be=>Qe=>{var st,ct;(st=Be.onBlur)==null||st.call(Be,Qe),!Qe.defaultMuiPrevented&&((ct=_.current)!=null&&ct.contains(Qe.relatedTarget)||Qe.relatedTarget===I||L({type:Sl.blur,event:Qe}))},ve=Be=>Qe=>{var st;(st=Be.onKeyDown)==null||st.call(Be,Qe),!Qe.defaultMuiPrevented&&Qe.key==="Escape"&&L({type:Sl.escapeKeyDown,event:Qe})},Se=(Be={})=>({onBlur:Ie(Be),onKeyDown:ve(Be)}),Me=(Be={})=>{const Qe=nu(Se,re),st=uo(Be);return ue({},Be,st,Qe(st),{id:C,role:"menu"})};return $.useDebugValue({subitems:D,highlightedValue:ge}),{contextValue:ue({},U,ye),dispatch:N,getListboxProps:Me,highlightedValue:ge,listboxRef:Ve,menuItems:D,open:E,triggerElement:I}}function EJ(e){const{value:t,children:n}=e,{dispatch:r,getItemIndex:i,getItemState:a,registerItem:c,totalSubitemCount:s}=t,f=$.useMemo(()=>({dispatch:r,getItemState:a,getItemIndex:i}),[r,i,a]),g=$.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:s}),[c,i,s]);return te.jsx(M_.Provider,{value:g,children:te.jsx(qh.Provider,{value:f,children:n})})}var H6={exports:{}},Ta={},G6={exports:{}},W6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Me,Be){var Qe=Me.length;Me.push(Be);e:for(;0<Qe;){var st=Qe-1>>>1,ct=Me[st];if(0<i(ct,Be))Me[st]=Be,Me[Qe]=ct,Qe=st;else break e}}function n(Me){return Me.length===0?null:Me[0]}function r(Me){if(Me.length===0)return null;var Be=Me[0],Qe=Me.pop();if(Qe!==Be){Me[0]=Qe;e:for(var st=0,ct=Me.length,Xt=ct>>>1;st<Xt;){var je=2*(st+1)-1,lt=Me[je],Ot=je+1,ut=Me[Ot];if(0>i(lt,Qe))Ot<ct&&0>i(ut,lt)?(Me[st]=ut,Me[Ot]=Qe,st=Ot):(Me[st]=lt,Me[je]=Qe,st=je);else if(Ot<ct&&0>i(ut,Qe))Me[st]=ut,Me[Ot]=Qe,st=Ot;else break e}}return Be}function i(Me,Be){var Qe=Me.sortIndex-Be.sortIndex;return Qe!==0?Qe:Me.id-Be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var c=Date,s=c.now();e.unstable_now=function(){return c.now()-s}}var f=[],g=[],_=1,x=null,C=3,E=!1,A=!1,L=!1,I=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(Me){for(var Be=n(g);Be!==null;){if(Be.callback===null)r(g);else if(Be.startTime<=Me)r(g),Be.sortIndex=Be.expirationTime,t(f,Be);else break;Be=n(g)}}function U(Me){if(L=!1,D(Me),!A)if(n(f)!==null)A=!0,ve(H);else{var Be=n(g);Be!==null&&Se(U,Be.startTime-Me)}}function H(Me,Be){A=!1,L&&(L=!1,T(Q),Q=-1),E=!0;var Qe=C;try{for(D(Be),x=n(f);x!==null&&(!(x.expirationTime>Be)||Me&&!re());){var st=x.callback;if(typeof st=="function"){x.callback=null,C=x.priorityLevel;var ct=st(x.expirationTime<=Be);Be=e.unstable_now(),typeof ct=="function"?x.callback=ct:x===n(f)&&r(f),D(Be)}else r(f);x=n(f)}if(x!==null)var Xt=!0;else{var je=n(g);je!==null&&Se(U,je.startTime-Be),Xt=!1}return Xt}finally{x=null,C=Qe,E=!1}}var V=!1,q=null,Q=-1,K=5,N=-1;function re(){return!(e.unstable_now()-N<K)}function ye(){if(q!==null){var Me=e.unstable_now();N=Me;var Be=!0;try{Be=q(!0,Me)}finally{Be?ge():(V=!1,q=null)}}else V=!1}var ge;if(typeof O=="function")ge=function(){O(ye)};else if(typeof MessageChannel<"u"){var Ve=new MessageChannel,Ie=Ve.port2;Ve.port1.onmessage=ye,ge=function(){Ie.postMessage(null)}}else ge=function(){I(ye,0)};function ve(Me){q=Me,V||(V=!0,ge())}function Se(Me,Be){Q=I(function(){Me(e.unstable_now())},Be)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Me){Me.callback=null},e.unstable_continueExecution=function(){A||E||(A=!0,ve(H))},e.unstable_forceFrameRate=function(Me){0>Me||125<Me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<Me?Math.floor(1e3/Me):5},e.unstable_getCurrentPriorityLevel=function(){return C},e.unstable_getFirstCallbackNode=function(){return n(f)},e.unstable_next=function(Me){switch(C){case 1:case 2:case 3:var Be=3;break;default:Be=C}var Qe=C;C=Be;try{return Me()}finally{C=Qe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Me,Be){switch(Me){case 1:case 2:case 3:case 4:case 5:break;default:Me=3}var Qe=C;C=Me;try{return Be()}finally{C=Qe}},e.unstable_scheduleCallback=function(Me,Be,Qe){var st=e.unstable_now();switch(typeof Qe=="object"&&Qe!==null?(Qe=Qe.delay,Qe=typeof Qe=="number"&&0<Qe?st+Qe:st):Qe=st,Me){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=Qe+ct,Me={id:_++,callback:Be,priorityLevel:Me,startTime:Qe,expirationTime:ct,sortIndex:-1},Qe>st?(Me.sortIndex=Qe,t(g,Me),n(f)===null&&Me===n(g)&&(L?(T(Q),Q=-1):L=!0,Se(U,Qe-st))):(Me.sortIndex=ct,t(f,Me),A||E||(A=!0,ve(H))),Me},e.unstable_shouldYield=re,e.unstable_wrapCallback=function(Me){var Be=C;return function(){var Qe=C;C=Be;try{return Me.apply(this,arguments)}finally{C=Qe}}}})(W6);G6.exports=W6;var TJ=G6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PJ=$,Ma=TJ;function dn(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var q6=new Set,Dy={};function Nf(e,t){sg(e,t),sg(e+"Capture",t)}function sg(e,t){for(Dy[e]=t,e=0;e<t.length;e++)q6.add(t[e])}var ru=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mP=Object.prototype.hasOwnProperty,AJ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mz={},gz={};function IJ(e){return mP.call(gz,e)?!0:mP.call(mz,e)?!1:AJ.test(e)?gz[e]=!0:(mz[e]=!0,!1)}function RJ(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function LJ(e,t,n,r){if(t===null||typeof t>"u"||RJ(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ws(e,t,n,r,i,a,c){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=c}var Go={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Go[e]=new ws(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Go[t]=new ws(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Go[e]=new ws(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Go[e]=new ws(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Go[e]=new ws(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Go[e]=new ws(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Go[e]=new ws(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Go[e]=new ws(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Go[e]=new ws(e,5,!1,e.toLowerCase(),null,!1,!1)});var SR=/[\-:]([a-z])/g;function MR(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(SR,MR);Go[t]=new ws(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(SR,MR);Go[t]=new ws(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(SR,MR);Go[t]=new ws(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Go[e]=new ws(e,1,!1,e.toLowerCase(),null,!1,!1)});Go.xlinkHref=new ws("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Go[e]=new ws(e,1,!1,e.toLowerCase(),null,!0,!0)});function CR(e,t,n,r){var i=Go.hasOwnProperty(t)?Go[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(LJ(t,n,i,r)&&(n=null),r||i===null?IJ(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var fu=PJ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b1=Symbol.for("react.element"),xm=Symbol.for("react.portal"),bm=Symbol.for("react.fragment"),ER=Symbol.for("react.strict_mode"),gP=Symbol.for("react.profiler"),X6=Symbol.for("react.provider"),Z6=Symbol.for("react.context"),TR=Symbol.for("react.forward_ref"),vP=Symbol.for("react.suspense"),yP=Symbol.for("react.suspense_list"),PR=Symbol.for("react.memo"),sh=Symbol.for("react.lazy"),Y6=Symbol.for("react.offscreen"),vz=Symbol.iterator;function n0(e){return e===null||typeof e!="object"?null:(e=vz&&e[vz]||e["@@iterator"],typeof e=="function"?e:null)}var xi=Object.assign,$2;function L0(e){if($2===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);$2=t&&t[1]||""}return`
`+$2+e}var V2=!1;function j2(e,t){if(!e||V2)return"";V2=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(g){var r=g}Reflect.construct(e,[],t)}else{try{t.call()}catch(g){r=g}e.call(t.prototype)}else{try{throw Error()}catch(g){r=g}e()}}catch(g){if(g&&r&&typeof g.stack=="string"){for(var i=g.stack.split(`
`),a=r.stack.split(`
`),c=i.length-1,s=a.length-1;1<=c&&0<=s&&i[c]!==a[s];)s--;for(;1<=c&&0<=s;c--,s--)if(i[c]!==a[s]){if(c!==1||s!==1)do if(c--,s--,0>s||i[c]!==a[s]){var f=`
`+i[c].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),f}while(1<=c&&0<=s);break}}}finally{V2=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L0(e):""}function kJ(e){switch(e.tag){case 5:return L0(e.type);case 16:return L0("Lazy");case 13:return L0("Suspense");case 19:return L0("SuspenseList");case 0:case 2:case 15:return e=j2(e.type,!1),e;case 11:return e=j2(e.type.render,!1),e;case 1:return e=j2(e.type,!0),e;default:return""}}function _P(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case bm:return"Fragment";case xm:return"Portal";case gP:return"Profiler";case ER:return"StrictMode";case vP:return"Suspense";case yP:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Z6:return(e.displayName||"Context")+".Consumer";case X6:return(e._context.displayName||"Context")+".Provider";case TR:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case PR:return t=e.displayName||null,t!==null?t:_P(e.type)||"Memo";case sh:t=e._payload,e=e._init;try{return _P(e(t))}catch{}}return null}function DJ(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _P(t);case 8:return t===ER?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Dh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function K6(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function zJ(e){var t=K6(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(c){r=""+c,a.call(this,c)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(c){r=""+c},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function w1(e){e._valueTracker||(e._valueTracker=zJ(e))}function J6(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K6(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function bw(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function xP(e,t){var n=t.checked;return xi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function yz(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Dh(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Q6(e,t){t=t.checked,t!=null&&CR(e,"checked",t,!1)}function bP(e,t){Q6(e,t);var n=Dh(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wP(e,t.type,n):t.hasOwnProperty("defaultValue")&&wP(e,t.type,Dh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function _z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function wP(e,t,n){(t!=="number"||bw(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var k0=Array.isArray;function jm(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Dh(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function SP(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(dn(91));return xi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function xz(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(dn(92));if(k0(n)){if(1<n.length)throw Error(dn(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Dh(n)}}function eU(e,t){var n=Dh(t.value),r=Dh(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function bz(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function tU(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function MP(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?tU(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var S1,nU=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(S1=S1||document.createElement("div"),S1.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=S1.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function zy(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var X0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},OJ=["Webkit","ms","Moz","O"];Object.keys(X0).forEach(function(e){OJ.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),X0[t]=X0[e]})});function rU(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||X0.hasOwnProperty(e)&&X0[e]?(""+t).trim():t+"px"}function iU(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=rU(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var FJ=xi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function CP(e,t){if(t){if(FJ[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(dn(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(dn(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(dn(61))}if(t.style!=null&&typeof t.style!="object")throw Error(dn(62))}}function EP(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var TP=null;function AR(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var PP=null,Hm=null,Gm=null;function wz(e){if(e=T_(e)){if(typeof PP!="function")throw Error(dn(280));var t=e.stateNode;t&&(t=aM(t),PP(e.stateNode,e.type,t))}}function oU(e){Hm?Gm?Gm.push(e):Gm=[e]:Hm=e}function sU(){if(Hm){var e=Hm,t=Gm;if(Gm=Hm=null,wz(e),t)for(e=0;e<t.length;e++)wz(t[e])}}function aU(e,t){return e(t)}function lU(){}var H2=!1;function cU(e,t,n){if(H2)return e(t,n);H2=!0;try{return aU(e,t,n)}finally{H2=!1,(Hm!==null||Gm!==null)&&(lU(),sU())}}function Oy(e,t){var n=e.stateNode;if(n===null)return null;var r=aM(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(dn(231,t,typeof n));return n}var AP=!1;if(ru)try{var r0={};Object.defineProperty(r0,"passive",{get:function(){AP=!0}}),window.addEventListener("test",r0,r0),window.removeEventListener("test",r0,r0)}catch{AP=!1}function NJ(e,t,n,r,i,a,c,s,f){var g=Array.prototype.slice.call(arguments,3);try{t.apply(n,g)}catch(_){this.onError(_)}}var Z0=!1,ww=null,Sw=!1,IP=null,BJ={onError:function(e){Z0=!0,ww=e}};function UJ(e,t,n,r,i,a,c,s,f){Z0=!1,ww=null,NJ.apply(BJ,arguments)}function $J(e,t,n,r,i,a,c,s,f){if(UJ.apply(this,arguments),Z0){if(Z0){var g=ww;Z0=!1,ww=null}else throw Error(dn(198));Sw||(Sw=!0,IP=g)}}function Bf(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function uU(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Sz(e){if(Bf(e)!==e)throw Error(dn(188))}function VJ(e){var t=e.alternate;if(!t){if(t=Bf(e),t===null)throw Error(dn(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var a=i.alternate;if(a===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return Sz(i),e;if(a===r)return Sz(i),t;a=a.sibling}throw Error(dn(188))}if(n.return!==r.return)n=i,r=a;else{for(var c=!1,s=i.child;s;){if(s===n){c=!0,n=i,r=a;break}if(s===r){c=!0,r=i,n=a;break}s=s.sibling}if(!c){for(s=a.child;s;){if(s===n){c=!0,n=a,r=i;break}if(s===r){c=!0,r=a,n=i;break}s=s.sibling}if(!c)throw Error(dn(189))}}if(n.alternate!==r)throw Error(dn(190))}if(n.tag!==3)throw Error(dn(188));return n.stateNode.current===n?e:t}function hU(e){return e=VJ(e),e!==null?dU(e):null}function dU(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=dU(e);if(t!==null)return t;e=e.sibling}return null}var fU=Ma.unstable_scheduleCallback,Mz=Ma.unstable_cancelCallback,jJ=Ma.unstable_shouldYield,HJ=Ma.unstable_requestPaint,zi=Ma.unstable_now,GJ=Ma.unstable_getCurrentPriorityLevel,IR=Ma.unstable_ImmediatePriority,pU=Ma.unstable_UserBlockingPriority,Mw=Ma.unstable_NormalPriority,WJ=Ma.unstable_LowPriority,mU=Ma.unstable_IdlePriority,rM=null,uc=null;function qJ(e){if(uc&&typeof uc.onCommitFiberRoot=="function")try{uc.onCommitFiberRoot(rM,e,void 0,(e.current.flags&128)===128)}catch{}}var Tl=Math.clz32?Math.clz32:YJ,XJ=Math.log,ZJ=Math.LN2;function YJ(e){return e>>>=0,e===0?32:31-(XJ(e)/ZJ|0)|0}var M1=64,C1=4194304;function D0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Cw(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,c=n&268435455;if(c!==0){var s=c&~i;s!==0?r=D0(s):(a&=c,a!==0&&(r=D0(a)))}else c=n&~i,c!==0?r=D0(c):a!==0&&(r=D0(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Tl(t),i=1<<n,r|=e[n],t&=~i;return r}function KJ(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JJ(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var c=31-Tl(a),s=1<<c,f=i[c];f===-1?(!(s&n)||s&r)&&(i[c]=KJ(s,t)):f<=t&&(e.expiredLanes|=s),a&=~s}}function RP(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function gU(){var e=M1;return M1<<=1,!(M1&4194240)&&(M1=64),e}function G2(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function C_(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Tl(t),e[t]=n}function QJ(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Tl(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}function RR(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Tl(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var $r=0;function vU(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var yU,LR,_U,xU,bU,LP=!1,E1=[],_h=null,xh=null,bh=null,Fy=new Map,Ny=new Map,ch=[],eQ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cz(e,t){switch(e){case"focusin":case"focusout":_h=null;break;case"dragenter":case"dragleave":xh=null;break;case"mouseover":case"mouseout":bh=null;break;case"pointerover":case"pointerout":Fy.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ny.delete(t.pointerId)}}function i0(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=T_(t),t!==null&&LR(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function tQ(e,t,n,r,i){switch(t){case"focusin":return _h=i0(_h,e,t,n,r,i),!0;case"dragenter":return xh=i0(xh,e,t,n,r,i),!0;case"mouseover":return bh=i0(bh,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Fy.set(a,i0(Fy.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Ny.set(a,i0(Ny.get(a)||null,e,t,n,r,i)),!0}return!1}function wU(e){var t=cf(e.target);if(t!==null){var n=Bf(t);if(n!==null){if(t=n.tag,t===13){if(t=uU(n),t!==null){e.blockedOn=t,bU(e.priority,function(){_U(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Db(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=kP(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);TP=r,n.target.dispatchEvent(r),TP=null}else return t=T_(n),t!==null&&LR(t),e.blockedOn=n,!1;t.shift()}return!0}function Ez(e,t,n){Db(e)&&n.delete(t)}function nQ(){LP=!1,_h!==null&&Db(_h)&&(_h=null),xh!==null&&Db(xh)&&(xh=null),bh!==null&&Db(bh)&&(bh=null),Fy.forEach(Ez),Ny.forEach(Ez)}function o0(e,t){e.blockedOn===t&&(e.blockedOn=null,LP||(LP=!0,Ma.unstable_scheduleCallback(Ma.unstable_NormalPriority,nQ)))}function By(e){function t(i){return o0(i,e)}if(0<E1.length){o0(E1[0],e);for(var n=1;n<E1.length;n++){var r=E1[n];r.blockedOn===e&&(r.blockedOn=null)}}for(_h!==null&&o0(_h,e),xh!==null&&o0(xh,e),bh!==null&&o0(bh,e),Fy.forEach(t),Ny.forEach(t),n=0;n<ch.length;n++)r=ch[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<ch.length&&(n=ch[0],n.blockedOn===null);)wU(n),n.blockedOn===null&&ch.shift()}var Wm=fu.ReactCurrentBatchConfig,Ew=!0;function rQ(e,t,n,r){var i=$r,a=Wm.transition;Wm.transition=null;try{$r=1,kR(e,t,n,r)}finally{$r=i,Wm.transition=a}}function iQ(e,t,n,r){var i=$r,a=Wm.transition;Wm.transition=null;try{$r=4,kR(e,t,n,r)}finally{$r=i,Wm.transition=a}}function kR(e,t,n,r){if(Ew){var i=kP(e,t,n,r);if(i===null)tE(e,t,r,Tw,n),Cz(e,r);else if(tQ(i,e,t,n,r))r.stopPropagation();else if(Cz(e,r),t&4&&-1<eQ.indexOf(e)){for(;i!==null;){var a=T_(i);if(a!==null&&yU(a),a=kP(e,t,n,r),a===null&&tE(e,t,r,Tw,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else tE(e,t,r,null,n)}}var Tw=null;function kP(e,t,n,r){if(Tw=null,e=AR(r),e=cf(e),e!==null)if(t=Bf(e),t===null)e=null;else if(n=t.tag,n===13){if(e=uU(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Tw=e,null}function SU(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(GJ()){case IR:return 1;case pU:return 4;case Mw:case WJ:return 16;case mU:return 536870912;default:return 16}default:return 16}}var ph=null,DR=null,zb=null;function MU(){if(zb)return zb;var e,t=DR,n=t.length,r,i="value"in ph?ph.value:ph.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var c=n-e;for(r=1;r<=c&&t[n-r]===i[a-r];r++);return zb=i.slice(e,1<r?1-r:void 0)}function Ob(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function T1(){return!0}function Tz(){return!1}function Pa(e){function t(n,r,i,a,c){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=a,this.target=c,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?T1:Tz,this.isPropagationStopped=Tz,this}return xi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=T1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=T1)},persist:function(){},isPersistent:T1}),t}var kg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zR=Pa(kg),E_=xi({},kg,{view:0,detail:0}),oQ=Pa(E_),W2,q2,s0,iM=xi({},E_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:OR,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==s0&&(s0&&e.type==="mousemove"?(W2=e.screenX-s0.screenX,q2=e.screenY-s0.screenY):q2=W2=0,s0=e),W2)},movementY:function(e){return"movementY"in e?e.movementY:q2}}),Pz=Pa(iM),sQ=xi({},iM,{dataTransfer:0}),aQ=Pa(sQ),lQ=xi({},E_,{relatedTarget:0}),X2=Pa(lQ),cQ=xi({},kg,{animationName:0,elapsedTime:0,pseudoElement:0}),uQ=Pa(cQ),hQ=xi({},kg,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dQ=Pa(hQ),fQ=xi({},kg,{data:0}),Az=Pa(fQ),pQ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mQ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gQ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vQ(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=gQ[e])?!!t[e]:!1}function OR(){return vQ}var yQ=xi({},E_,{key:function(e){if(e.key){var t=pQ[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ob(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?mQ[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:OR,charCode:function(e){return e.type==="keypress"?Ob(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ob(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),_Q=Pa(yQ),xQ=xi({},iM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Iz=Pa(xQ),bQ=xi({},E_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:OR}),wQ=Pa(bQ),SQ=xi({},kg,{propertyName:0,elapsedTime:0,pseudoElement:0}),MQ=Pa(SQ),CQ=xi({},iM,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),EQ=Pa(CQ),TQ=[9,13,27,32],FR=ru&&"CompositionEvent"in window,Y0=null;ru&&"documentMode"in document&&(Y0=document.documentMode);var PQ=ru&&"TextEvent"in window&&!Y0,CU=ru&&(!FR||Y0&&8<Y0&&11>=Y0),Rz=" ",Lz=!1;function EU(e,t){switch(e){case"keyup":return TQ.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function TU(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var wm=!1;function AQ(e,t){switch(e){case"compositionend":return TU(t);case"keypress":return t.which!==32?null:(Lz=!0,Rz);case"textInput":return e=t.data,e===Rz&&Lz?null:e;default:return null}}function IQ(e,t){if(wm)return e==="compositionend"||!FR&&EU(e,t)?(e=MU(),zb=DR=ph=null,wm=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return CU&&t.locale!=="ko"?null:t.data;default:return null}}var RQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kz(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!RQ[e.type]:t==="textarea"}function PU(e,t,n,r){oU(r),t=Pw(t,"onChange"),0<t.length&&(n=new zR("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var K0=null,Uy=null;function LQ(e){BU(e,0)}function oM(e){var t=Cm(e);if(J6(t))return e}function kQ(e,t){if(e==="change")return t}var AU=!1;if(ru){var Z2;if(ru){var Y2="oninput"in document;if(!Y2){var Dz=document.createElement("div");Dz.setAttribute("oninput","return;"),Y2=typeof Dz.oninput=="function"}Z2=Y2}else Z2=!1;AU=Z2&&(!document.documentMode||9<document.documentMode)}function zz(){K0&&(K0.detachEvent("onpropertychange",IU),Uy=K0=null)}function IU(e){if(e.propertyName==="value"&&oM(Uy)){var t=[];PU(t,Uy,e,AR(e)),cU(LQ,t)}}function DQ(e,t,n){e==="focusin"?(zz(),K0=t,Uy=n,K0.attachEvent("onpropertychange",IU)):e==="focusout"&&zz()}function zQ(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return oM(Uy)}function OQ(e,t){if(e==="click")return oM(t)}function FQ(e,t){if(e==="input"||e==="change")return oM(t)}function NQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ll=typeof Object.is=="function"?Object.is:NQ;function $y(e,t){if(Ll(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!mP.call(t,i)||!Ll(e[i],t[i]))return!1}return!0}function Oz(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Fz(e,t){var n=Oz(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Oz(n)}}function RU(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?RU(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function LU(){for(var e=window,t=bw();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=bw(e.document)}return t}function NR(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function BQ(e){var t=LU(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&RU(n.ownerDocument.documentElement,n)){if(r!==null&&NR(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=r.end===void 0?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=Fz(n,a);var c=Fz(n,r);i&&c&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==c.node||e.focusOffset!==c.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(c.node,c.offset)):(t.setEnd(c.node,c.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var UQ=ru&&"documentMode"in document&&11>=document.documentMode,Sm=null,DP=null,J0=null,zP=!1;function Nz(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;zP||Sm==null||Sm!==bw(r)||(r=Sm,"selectionStart"in r&&NR(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),J0&&$y(J0,r)||(J0=r,r=Pw(DP,"onSelect"),0<r.length&&(t=new zR("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Sm)))}function P1(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Mm={animationend:P1("Animation","AnimationEnd"),animationiteration:P1("Animation","AnimationIteration"),animationstart:P1("Animation","AnimationStart"),transitionend:P1("Transition","TransitionEnd")},K2={},kU={};ru&&(kU=document.createElement("div").style,"AnimationEvent"in window||(delete Mm.animationend.animation,delete Mm.animationiteration.animation,delete Mm.animationstart.animation),"TransitionEvent"in window||delete Mm.transitionend.transition);function sM(e){if(K2[e])return K2[e];if(!Mm[e])return e;var t=Mm[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in kU)return K2[e]=t[n];return e}var DU=sM("animationend"),zU=sM("animationiteration"),OU=sM("animationstart"),FU=sM("transitionend"),NU=new Map,Bz="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xh(e,t){NU.set(e,t),Nf(t,[e])}for(var J2=0;J2<Bz.length;J2++){var Q2=Bz[J2],$Q=Q2.toLowerCase(),VQ=Q2[0].toUpperCase()+Q2.slice(1);Xh($Q,"on"+VQ)}Xh(DU,"onAnimationEnd");Xh(zU,"onAnimationIteration");Xh(OU,"onAnimationStart");Xh("dblclick","onDoubleClick");Xh("focusin","onFocus");Xh("focusout","onBlur");Xh(FU,"onTransitionEnd");sg("onMouseEnter",["mouseout","mouseover"]);sg("onMouseLeave",["mouseout","mouseover"]);sg("onPointerEnter",["pointerout","pointerover"]);sg("onPointerLeave",["pointerout","pointerover"]);Nf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Nf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Nf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Nf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Nf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Nf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var z0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(z0));function Uz(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,$J(r,t,void 0,e),e.currentTarget=null}function BU(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var c=r.length-1;0<=c;c--){var s=r[c],f=s.instance,g=s.currentTarget;if(s=s.listener,f!==a&&i.isPropagationStopped())break e;Uz(i,s,g),a=f}else for(c=0;c<r.length;c++){if(s=r[c],f=s.instance,g=s.currentTarget,s=s.listener,f!==a&&i.isPropagationStopped())break e;Uz(i,s,g),a=f}}}if(Sw)throw e=IP,Sw=!1,IP=null,e}function li(e,t){var n=t[UP];n===void 0&&(n=t[UP]=new Set);var r=e+"__bubble";n.has(r)||(UU(t,e,2,!1),n.add(r))}function eE(e,t,n){var r=0;t&&(r|=4),UU(n,e,r,t)}var A1="_reactListening"+Math.random().toString(36).slice(2);function Vy(e){if(!e[A1]){e[A1]=!0,q6.forEach(function(n){n!=="selectionchange"&&(jQ.has(n)||eE(n,!1,e),eE(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[A1]||(t[A1]=!0,eE("selectionchange",!1,t))}}function UU(e,t,n,r){switch(SU(t)){case 1:var i=rQ;break;case 4:i=iQ;break;default:i=kR}n=i.bind(null,t,n,e),i=void 0,!AP||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function tE(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var c=r.tag;if(c===3||c===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(c===4)for(c=r.return;c!==null;){var f=c.tag;if((f===3||f===4)&&(f=c.stateNode.containerInfo,f===i||f.nodeType===8&&f.parentNode===i))return;c=c.return}for(;s!==null;){if(c=cf(s),c===null)return;if(f=c.tag,f===5||f===6){r=a=c;continue e}s=s.parentNode}}r=r.return}cU(function(){var g=a,_=AR(n),x=[];e:{var C=NU.get(e);if(C!==void 0){var E=zR,A=e;switch(e){case"keypress":if(Ob(n)===0)break e;case"keydown":case"keyup":E=_Q;break;case"focusin":A="focus",E=X2;break;case"focusout":A="blur",E=X2;break;case"beforeblur":case"afterblur":E=X2;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=Pz;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=aQ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=wQ;break;case DU:case zU:case OU:E=uQ;break;case FU:E=MQ;break;case"scroll":E=oQ;break;case"wheel":E=EQ;break;case"copy":case"cut":case"paste":E=dQ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=Iz}var L=(t&4)!==0,I=!L&&e==="scroll",T=L?C!==null?C+"Capture":null:C;L=[];for(var O=g,D;O!==null;){D=O;var U=D.stateNode;if(D.tag===5&&U!==null&&(D=U,T!==null&&(U=Oy(O,T),U!=null&&L.push(jy(O,U,D)))),I)break;O=O.return}0<L.length&&(C=new E(C,A,null,n,_),x.push({event:C,listeners:L}))}}if(!(t&7)){e:{if(C=e==="mouseover"||e==="pointerover",E=e==="mouseout"||e==="pointerout",C&&n!==TP&&(A=n.relatedTarget||n.fromElement)&&(cf(A)||A[iu]))break e;if((E||C)&&(C=_.window===_?_:(C=_.ownerDocument)?C.defaultView||C.parentWindow:window,E?(A=n.relatedTarget||n.toElement,E=g,A=A?cf(A):null,A!==null&&(I=Bf(A),A!==I||A.tag!==5&&A.tag!==6)&&(A=null)):(E=null,A=g),E!==A)){if(L=Pz,U="onMouseLeave",T="onMouseEnter",O="mouse",(e==="pointerout"||e==="pointerover")&&(L=Iz,U="onPointerLeave",T="onPointerEnter",O="pointer"),I=E==null?C:Cm(E),D=A==null?C:Cm(A),C=new L(U,O+"leave",E,n,_),C.target=I,C.relatedTarget=D,U=null,cf(_)===g&&(L=new L(T,O+"enter",A,n,_),L.target=D,L.relatedTarget=I,U=L),I=U,E&&A)t:{for(L=E,T=A,O=0,D=L;D;D=Fp(D))O++;for(D=0,U=T;U;U=Fp(U))D++;for(;0<O-D;)L=Fp(L),O--;for(;0<D-O;)T=Fp(T),D--;for(;O--;){if(L===T||T!==null&&L===T.alternate)break t;L=Fp(L),T=Fp(T)}L=null}else L=null;E!==null&&$z(x,C,E,L,!1),A!==null&&I!==null&&$z(x,I,A,L,!0)}}e:{if(C=g?Cm(g):window,E=C.nodeName&&C.nodeName.toLowerCase(),E==="select"||E==="input"&&C.type==="file")var H=kQ;else if(kz(C))if(AU)H=FQ;else{H=zQ;var V=DQ}else(E=C.nodeName)&&E.toLowerCase()==="input"&&(C.type==="checkbox"||C.type==="radio")&&(H=OQ);if(H&&(H=H(e,g))){PU(x,H,n,_);break e}V&&V(e,C,g),e==="focusout"&&(V=C._wrapperState)&&V.controlled&&C.type==="number"&&wP(C,"number",C.value)}switch(V=g?Cm(g):window,e){case"focusin":(kz(V)||V.contentEditable==="true")&&(Sm=V,DP=g,J0=null);break;case"focusout":J0=DP=Sm=null;break;case"mousedown":zP=!0;break;case"contextmenu":case"mouseup":case"dragend":zP=!1,Nz(x,n,_);break;case"selectionchange":if(UQ)break;case"keydown":case"keyup":Nz(x,n,_)}var q;if(FR)e:{switch(e){case"compositionstart":var Q="onCompositionStart";break e;case"compositionend":Q="onCompositionEnd";break e;case"compositionupdate":Q="onCompositionUpdate";break e}Q=void 0}else wm?EU(e,n)&&(Q="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(Q="onCompositionStart");Q&&(CU&&n.locale!=="ko"&&(wm||Q!=="onCompositionStart"?Q==="onCompositionEnd"&&wm&&(q=MU()):(ph=_,DR="value"in ph?ph.value:ph.textContent,wm=!0)),V=Pw(g,Q),0<V.length&&(Q=new Az(Q,e,null,n,_),x.push({event:Q,listeners:V}),q?Q.data=q:(q=TU(n),q!==null&&(Q.data=q)))),(q=PQ?AQ(e,n):IQ(e,n))&&(g=Pw(g,"onBeforeInput"),0<g.length&&(_=new Az("onBeforeInput","beforeinput",null,n,_),x.push({event:_,listeners:g}),_.data=q))}BU(x,t)})}function jy(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Pw(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Oy(e,n),a!=null&&r.unshift(jy(e,a,i)),a=Oy(e,t),a!=null&&r.push(jy(e,a,i))),e=e.return}return r}function Fp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function $z(e,t,n,r,i){for(var a=t._reactName,c=[];n!==null&&n!==r;){var s=n,f=s.alternate,g=s.stateNode;if(f!==null&&f===r)break;s.tag===5&&g!==null&&(s=g,i?(f=Oy(n,a),f!=null&&c.unshift(jy(n,f,s))):i||(f=Oy(n,a),f!=null&&c.push(jy(n,f,s)))),n=n.return}c.length!==0&&e.push({event:t,listeners:c})}var HQ=/\r\n?/g,GQ=/\u0000|\uFFFD/g;function Vz(e){return(typeof e=="string"?e:""+e).replace(HQ,`
`).replace(GQ,"")}function I1(e,t,n){if(t=Vz(t),Vz(e)!==t&&n)throw Error(dn(425))}function Aw(){}var OP=null,FP=null;function NP(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var BP=typeof setTimeout=="function"?setTimeout:void 0,WQ=typeof clearTimeout=="function"?clearTimeout:void 0,jz=typeof Promise=="function"?Promise:void 0,qQ=typeof queueMicrotask=="function"?queueMicrotask:typeof jz<"u"?function(e){return jz.resolve(null).then(e).catch(XQ)}:BP;function XQ(e){setTimeout(function(){throw e})}function nE(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),By(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);By(t)}function wh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Hz(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Dg=Math.random().toString(36).slice(2),sc="__reactFiber$"+Dg,Hy="__reactProps$"+Dg,iu="__reactContainer$"+Dg,UP="__reactEvents$"+Dg,ZQ="__reactListeners$"+Dg,YQ="__reactHandles$"+Dg;function cf(e){var t=e[sc];if(t)return t;for(var n=e.parentNode;n;){if(t=n[iu]||n[sc]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Hz(e);e!==null;){if(n=e[sc])return n;e=Hz(e)}return t}e=n,n=e.parentNode}return null}function T_(e){return e=e[sc]||e[iu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Cm(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(dn(33))}function aM(e){return e[Hy]||null}var $P=[],Em=-1;function Zh(e){return{current:e}}function ui(e){0>Em||(e.current=$P[Em],$P[Em]=null,Em--)}function ii(e,t){Em++,$P[Em]=e.current,e.current=t}var zh={},as=Zh(zh),Fs=Zh(!1),Sf=zh;function ag(e,t){var n=e.type.contextTypes;if(!n)return zh;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in n)i[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ns(e){return e=e.childContextTypes,e!=null}function Iw(){ui(Fs),ui(as)}function Gz(e,t,n){if(as.current!==zh)throw Error(dn(168));ii(as,t),ii(Fs,n)}function $U(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(dn(108,DJ(e)||"Unknown",i));return xi({},n,r)}function Rw(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||zh,Sf=as.current,ii(as,e),ii(Fs,Fs.current),!0}function Wz(e,t,n){var r=e.stateNode;if(!r)throw Error(dn(169));n?(e=$U(e,t,Sf),r.__reactInternalMemoizedMergedChildContext=e,ui(Fs),ui(as),ii(as,e)):ui(Fs),ii(Fs,n)}var Gc=null,lM=!1,rE=!1;function VU(e){Gc===null?Gc=[e]:Gc.push(e)}function KQ(e){lM=!0,VU(e)}function Yh(){if(!rE&&Gc!==null){rE=!0;var e=0,t=$r;try{var n=Gc;for($r=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Gc=null,lM=!1}catch(i){throw Gc!==null&&(Gc=Gc.slice(e+1)),fU(IR,Yh),i}finally{$r=t,rE=!1}}return null}var Tm=[],Pm=0,Lw=null,kw=0,Ua=[],$a=0,Mf=null,Xc=1,Zc="";function Qd(e,t){Tm[Pm++]=kw,Tm[Pm++]=Lw,Lw=e,kw=t}function jU(e,t,n){Ua[$a++]=Xc,Ua[$a++]=Zc,Ua[$a++]=Mf,Mf=e;var r=Xc;e=Zc;var i=32-Tl(r)-1;r&=~(1<<i),n+=1;var a=32-Tl(t)+i;if(30<a){var c=i-i%5;a=(r&(1<<c)-1).toString(32),r>>=c,i-=c,Xc=1<<32-Tl(t)+i|n<<i|r,Zc=a+e}else Xc=1<<a|n<<i|r,Zc=e}function BR(e){e.return!==null&&(Qd(e,1),jU(e,1,0))}function UR(e){for(;e===Lw;)Lw=Tm[--Pm],Tm[Pm]=null,kw=Tm[--Pm],Tm[Pm]=null;for(;e===Mf;)Mf=Ua[--$a],Ua[$a]=null,Zc=Ua[--$a],Ua[$a]=null,Xc=Ua[--$a],Ua[$a]=null}var ba=null,ga=null,pi=!1,wl=null;function HU(e,t){var n=Ha(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function qz(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ba=e,ga=wh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ba=e,ga=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Mf!==null?{id:Xc,overflow:Zc}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ha(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,ba=e,ga=null,!0):!1;default:return!1}}function VP(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jP(e){if(pi){var t=ga;if(t){var n=t;if(!qz(e,t)){if(VP(e))throw Error(dn(418));t=wh(n.nextSibling);var r=ba;t&&qz(e,t)?HU(r,n):(e.flags=e.flags&-4097|2,pi=!1,ba=e)}}else{if(VP(e))throw Error(dn(418));e.flags=e.flags&-4097|2,pi=!1,ba=e}}}function Xz(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ba=e}function R1(e){if(e!==ba)return!1;if(!pi)return Xz(e),pi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!NP(e.type,e.memoizedProps)),t&&(t=ga)){if(VP(e))throw GU(),Error(dn(418));for(;t;)HU(e,t),t=wh(t.nextSibling)}if(Xz(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(dn(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){ga=wh(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}ga=null}}else ga=ba?wh(e.stateNode.nextSibling):null;return!0}function GU(){for(var e=ga;e;)e=wh(e.nextSibling)}function lg(){ga=ba=null,pi=!1}function $R(e){wl===null?wl=[e]:wl.push(e)}var JQ=fu.ReactCurrentBatchConfig;function a0(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(dn(309));var r=n.stateNode}if(!r)throw Error(dn(147,e));var i=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(c){var s=i.refs;c===null?delete s[a]:s[a]=c},t._stringRef=a,t)}if(typeof e!="string")throw Error(dn(284));if(!n._owner)throw Error(dn(290,e))}return e}function L1(e,t){throw e=Object.prototype.toString.call(t),Error(dn(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Zz(e){var t=e._init;return t(e._payload)}function WU(e){function t(T,O){if(e){var D=T.deletions;D===null?(T.deletions=[O],T.flags|=16):D.push(O)}}function n(T,O){if(!e)return null;for(;O!==null;)t(T,O),O=O.sibling;return null}function r(T,O){for(T=new Map;O!==null;)O.key!==null?T.set(O.key,O):T.set(O.index,O),O=O.sibling;return T}function i(T,O){return T=Eh(T,O),T.index=0,T.sibling=null,T}function a(T,O,D){return T.index=D,e?(D=T.alternate,D!==null?(D=D.index,D<O?(T.flags|=2,O):D):(T.flags|=2,O)):(T.flags|=1048576,O)}function c(T){return e&&T.alternate===null&&(T.flags|=2),T}function s(T,O,D,U){return O===null||O.tag!==6?(O=uE(D,T.mode,U),O.return=T,O):(O=i(O,D),O.return=T,O)}function f(T,O,D,U){var H=D.type;return H===bm?_(T,O,D.props.children,U,D.key):O!==null&&(O.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===sh&&Zz(H)===O.type)?(U=i(O,D.props),U.ref=a0(T,O,D),U.return=T,U):(U=jb(D.type,D.key,D.props,null,T.mode,U),U.ref=a0(T,O,D),U.return=T,U)}function g(T,O,D,U){return O===null||O.tag!==4||O.stateNode.containerInfo!==D.containerInfo||O.stateNode.implementation!==D.implementation?(O=hE(D,T.mode,U),O.return=T,O):(O=i(O,D.children||[]),O.return=T,O)}function _(T,O,D,U,H){return O===null||O.tag!==7?(O=vf(D,T.mode,U,H),O.return=T,O):(O=i(O,D),O.return=T,O)}function x(T,O,D){if(typeof O=="string"&&O!==""||typeof O=="number")return O=uE(""+O,T.mode,D),O.return=T,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case b1:return D=jb(O.type,O.key,O.props,null,T.mode,D),D.ref=a0(T,null,O),D.return=T,D;case xm:return O=hE(O,T.mode,D),O.return=T,O;case sh:var U=O._init;return x(T,U(O._payload),D)}if(k0(O)||n0(O))return O=vf(O,T.mode,D,null),O.return=T,O;L1(T,O)}return null}function C(T,O,D,U){var H=O!==null?O.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return H!==null?null:s(T,O,""+D,U);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case b1:return D.key===H?f(T,O,D,U):null;case xm:return D.key===H?g(T,O,D,U):null;case sh:return H=D._init,C(T,O,H(D._payload),U)}if(k0(D)||n0(D))return H!==null?null:_(T,O,D,U,null);L1(T,D)}return null}function E(T,O,D,U,H){if(typeof U=="string"&&U!==""||typeof U=="number")return T=T.get(D)||null,s(O,T,""+U,H);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case b1:return T=T.get(U.key===null?D:U.key)||null,f(O,T,U,H);case xm:return T=T.get(U.key===null?D:U.key)||null,g(O,T,U,H);case sh:var V=U._init;return E(T,O,D,V(U._payload),H)}if(k0(U)||n0(U))return T=T.get(D)||null,_(O,T,U,H,null);L1(O,U)}return null}function A(T,O,D,U){for(var H=null,V=null,q=O,Q=O=0,K=null;q!==null&&Q<D.length;Q++){q.index>Q?(K=q,q=null):K=q.sibling;var N=C(T,q,D[Q],U);if(N===null){q===null&&(q=K);break}e&&q&&N.alternate===null&&t(T,q),O=a(N,O,Q),V===null?H=N:V.sibling=N,V=N,q=K}if(Q===D.length)return n(T,q),pi&&Qd(T,Q),H;if(q===null){for(;Q<D.length;Q++)q=x(T,D[Q],U),q!==null&&(O=a(q,O,Q),V===null?H=q:V.sibling=q,V=q);return pi&&Qd(T,Q),H}for(q=r(T,q);Q<D.length;Q++)K=E(q,T,Q,D[Q],U),K!==null&&(e&&K.alternate!==null&&q.delete(K.key===null?Q:K.key),O=a(K,O,Q),V===null?H=K:V.sibling=K,V=K);return e&&q.forEach(function(re){return t(T,re)}),pi&&Qd(T,Q),H}function L(T,O,D,U){var H=n0(D);if(typeof H!="function")throw Error(dn(150));if(D=H.call(D),D==null)throw Error(dn(151));for(var V=H=null,q=O,Q=O=0,K=null,N=D.next();q!==null&&!N.done;Q++,N=D.next()){q.index>Q?(K=q,q=null):K=q.sibling;var re=C(T,q,N.value,U);if(re===null){q===null&&(q=K);break}e&&q&&re.alternate===null&&t(T,q),O=a(re,O,Q),V===null?H=re:V.sibling=re,V=re,q=K}if(N.done)return n(T,q),pi&&Qd(T,Q),H;if(q===null){for(;!N.done;Q++,N=D.next())N=x(T,N.value,U),N!==null&&(O=a(N,O,Q),V===null?H=N:V.sibling=N,V=N);return pi&&Qd(T,Q),H}for(q=r(T,q);!N.done;Q++,N=D.next())N=E(q,T,Q,N.value,U),N!==null&&(e&&N.alternate!==null&&q.delete(N.key===null?Q:N.key),O=a(N,O,Q),V===null?H=N:V.sibling=N,V=N);return e&&q.forEach(function(ye){return t(T,ye)}),pi&&Qd(T,Q),H}function I(T,O,D,U){if(typeof D=="object"&&D!==null&&D.type===bm&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case b1:e:{for(var H=D.key,V=O;V!==null;){if(V.key===H){if(H=D.type,H===bm){if(V.tag===7){n(T,V.sibling),O=i(V,D.props.children),O.return=T,T=O;break e}}else if(V.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===sh&&Zz(H)===V.type){n(T,V.sibling),O=i(V,D.props),O.ref=a0(T,V,D),O.return=T,T=O;break e}n(T,V);break}else t(T,V);V=V.sibling}D.type===bm?(O=vf(D.props.children,T.mode,U,D.key),O.return=T,T=O):(U=jb(D.type,D.key,D.props,null,T.mode,U),U.ref=a0(T,O,D),U.return=T,T=U)}return c(T);case xm:e:{for(V=D.key;O!==null;){if(O.key===V)if(O.tag===4&&O.stateNode.containerInfo===D.containerInfo&&O.stateNode.implementation===D.implementation){n(T,O.sibling),O=i(O,D.children||[]),O.return=T,T=O;break e}else{n(T,O);break}else t(T,O);O=O.sibling}O=hE(D,T.mode,U),O.return=T,T=O}return c(T);case sh:return V=D._init,I(T,O,V(D._payload),U)}if(k0(D))return A(T,O,D,U);if(n0(D))return L(T,O,D,U);L1(T,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,O!==null&&O.tag===6?(n(T,O.sibling),O=i(O,D),O.return=T,T=O):(n(T,O),O=uE(D,T.mode,U),O.return=T,T=O),c(T)):n(T,O)}return I}var cg=WU(!0),qU=WU(!1),Dw=Zh(null),zw=null,Am=null,VR=null;function jR(){VR=Am=zw=null}function HR(e){var t=Dw.current;ui(Dw),e._currentValue=t}function HP(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function qm(e,t){zw=e,VR=Am=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(zs=!0),e.firstContext=null)}function qa(e){var t=e._currentValue;if(VR!==e)if(e={context:e,memoizedValue:t,next:null},Am===null){if(zw===null)throw Error(dn(308));Am=e,zw.dependencies={lanes:0,firstContext:e}}else Am=Am.next=e;return t}var uf=null;function GR(e){uf===null?uf=[e]:uf.push(e)}function XU(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,GR(t)):(n.next=i.next,i.next=n),t.interleaved=n,ou(e,r)}function ou(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ah=!1;function WR(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ZU(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Jc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Sh(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Tr&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,ou(e,n)}return i=r.interleaved,i===null?(t.next=t,GR(r)):(t.next=i.next,i.next=t),r.interleaved=t,ou(e,n)}function Fb(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,RR(e,n)}}function Yz(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var c={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?i=a=c:a=a.next=c,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ow(e,t,n,r){var i=e.updateQueue;ah=!1;var a=i.firstBaseUpdate,c=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var f=s,g=f.next;f.next=null,c===null?a=g:c.next=g,c=f;var _=e.alternate;_!==null&&(_=_.updateQueue,s=_.lastBaseUpdate,s!==c&&(s===null?_.firstBaseUpdate=g:s.next=g,_.lastBaseUpdate=f))}if(a!==null){var x=i.baseState;c=0,_=g=f=null,s=a;do{var C=s.lane,E=s.eventTime;if((r&C)===C){_!==null&&(_=_.next={eventTime:E,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var A=e,L=s;switch(C=t,E=n,L.tag){case 1:if(A=L.payload,typeof A=="function"){x=A.call(E,x,C);break e}x=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=L.payload,C=typeof A=="function"?A.call(E,x,C):A,C==null)break e;x=xi({},x,C);break e;case 2:ah=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,C=i.effects,C===null?i.effects=[s]:C.push(s))}else E={eventTime:E,lane:C,tag:s.tag,payload:s.payload,callback:s.callback,next:null},_===null?(g=_=E,f=x):_=_.next=E,c|=C;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;C=s,s=C.next,C.next=null,i.lastBaseUpdate=C,i.shared.pending=null}}while(!0);if(_===null&&(f=x),i.baseState=f,i.firstBaseUpdate=g,i.lastBaseUpdate=_,t=i.shared.interleaved,t!==null){i=t;do c|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Ef|=c,e.lanes=c,e.memoizedState=x}}function Kz(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(dn(191,i));i.call(r)}}}var P_={},hc=Zh(P_),Gy=Zh(P_),Wy=Zh(P_);function hf(e){if(e===P_)throw Error(dn(174));return e}function qR(e,t){switch(ii(Wy,t),ii(Gy,e),ii(hc,P_),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:MP(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=MP(t,e)}ui(hc),ii(hc,t)}function ug(){ui(hc),ui(Gy),ui(Wy)}function YU(e){hf(Wy.current);var t=hf(hc.current),n=MP(t,e.type);t!==n&&(ii(Gy,e),ii(hc,n))}function XR(e){Gy.current===e&&(ui(hc),ui(Gy))}var vi=Zh(0);function Fw(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var iE=[];function ZR(){for(var e=0;e<iE.length;e++)iE[e]._workInProgressVersionPrimary=null;iE.length=0}var Nb=fu.ReactCurrentDispatcher,oE=fu.ReactCurrentBatchConfig,Cf=0,yi=null,lo=null,Mo=null,Nw=!1,Q0=!1,qy=0,QQ=0;function es(){throw Error(dn(321))}function YR(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ll(e[n],t[n]))return!1;return!0}function KR(e,t,n,r,i,a){if(Cf=a,yi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Nb.current=e===null||e.memoizedState===null?ree:iee,e=n(r,i),Q0){a=0;do{if(Q0=!1,qy=0,25<=a)throw Error(dn(301));a+=1,Mo=lo=null,t.updateQueue=null,Nb.current=oee,e=n(r,i)}while(Q0)}if(Nb.current=Bw,t=lo!==null&&lo.next!==null,Cf=0,Mo=lo=yi=null,Nw=!1,t)throw Error(dn(300));return e}function JR(){var e=qy!==0;return qy=0,e}function tc(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mo===null?yi.memoizedState=Mo=e:Mo=Mo.next=e,Mo}function Xa(){if(lo===null){var e=yi.alternate;e=e!==null?e.memoizedState:null}else e=lo.next;var t=Mo===null?yi.memoizedState:Mo.next;if(t!==null)Mo=t,lo=e;else{if(e===null)throw Error(dn(310));lo=e,e={memoizedState:lo.memoizedState,baseState:lo.baseState,baseQueue:lo.baseQueue,queue:lo.queue,next:null},Mo===null?yi.memoizedState=Mo=e:Mo=Mo.next=e}return Mo}function Xy(e,t){return typeof t=="function"?t(e):t}function sE(e){var t=Xa(),n=t.queue;if(n===null)throw Error(dn(311));n.lastRenderedReducer=e;var r=lo,i=r.baseQueue,a=n.pending;if(a!==null){if(i!==null){var c=i.next;i.next=a.next,a.next=c}r.baseQueue=i=a,n.pending=null}if(i!==null){a=i.next,r=r.baseState;var s=c=null,f=null,g=a;do{var _=g.lane;if((Cf&_)===_)f!==null&&(f=f.next={lane:0,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null}),r=g.hasEagerState?g.eagerState:e(r,g.action);else{var x={lane:_,action:g.action,hasEagerState:g.hasEagerState,eagerState:g.eagerState,next:null};f===null?(s=f=x,c=r):f=f.next=x,yi.lanes|=_,Ef|=_}g=g.next}while(g!==null&&g!==a);f===null?c=r:f.next=s,Ll(r,t.memoizedState)||(zs=!0),t.memoizedState=r,t.baseState=c,t.baseQueue=f,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do a=i.lane,yi.lanes|=a,Ef|=a,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function aE(e){var t=Xa(),n=t.queue;if(n===null)throw Error(dn(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(i!==null){n.pending=null;var c=i=i.next;do a=e(a,c.action),c=c.next;while(c!==i);Ll(a,t.memoizedState)||(zs=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function KU(){}function JU(e,t){var n=yi,r=Xa(),i=t(),a=!Ll(r.memoizedState,i);if(a&&(r.memoizedState=i,zs=!0),r=r.queue,QR(t$.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||Mo!==null&&Mo.memoizedState.tag&1){if(n.flags|=2048,Zy(9,e$.bind(null,n,r,i,t),void 0,null),To===null)throw Error(dn(349));Cf&30||QU(n,t,i)}return i}function QU(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=yi.updateQueue,t===null?(t={lastEffect:null,stores:null},yi.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function e$(e,t,n,r){t.value=n,t.getSnapshot=r,n$(t)&&r$(e)}function t$(e,t,n){return n(function(){n$(t)&&r$(e)})}function n$(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ll(e,n)}catch{return!0}}function r$(e){var t=ou(e,1);t!==null&&Pl(t,e,1,-1)}function Jz(e){var t=tc();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xy,lastRenderedState:e},t.queue=e,e=e.dispatch=nee.bind(null,yi,e),[t.memoizedState,e]}function Zy(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=yi.updateQueue,t===null?(t={lastEffect:null,stores:null},yi.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function i$(){return Xa().memoizedState}function Bb(e,t,n,r){var i=tc();yi.flags|=e,i.memoizedState=Zy(1|t,n,void 0,r===void 0?null:r)}function cM(e,t,n,r){var i=Xa();r=r===void 0?null:r;var a=void 0;if(lo!==null){var c=lo.memoizedState;if(a=c.destroy,r!==null&&YR(r,c.deps)){i.memoizedState=Zy(t,n,a,r);return}}yi.flags|=e,i.memoizedState=Zy(1|t,n,a,r)}function Qz(e,t){return Bb(8390656,8,e,t)}function QR(e,t){return cM(2048,8,e,t)}function o$(e,t){return cM(4,2,e,t)}function s$(e,t){return cM(4,4,e,t)}function a$(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function l$(e,t,n){return n=n!=null?n.concat([e]):null,cM(4,4,a$.bind(null,t,e),n)}function e3(){}function c$(e,t){var n=Xa();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&YR(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function u$(e,t){var n=Xa();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&YR(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function h$(e,t,n){return Cf&21?(Ll(n,t)||(n=gU(),yi.lanes|=n,Ef|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,zs=!0),e.memoizedState=n)}function eee(e,t){var n=$r;$r=n!==0&&4>n?n:4,e(!0);var r=oE.transition;oE.transition={};try{e(!1),t()}finally{$r=n,oE.transition=r}}function d$(){return Xa().memoizedState}function tee(e,t,n){var r=Ch(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},f$(e))p$(t,n);else if(n=XU(e,t,n,r),n!==null){var i=xs();Pl(n,e,r,i),m$(n,t,r)}}function nee(e,t,n){var r=Ch(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(f$(e))p$(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var c=t.lastRenderedState,s=a(c,n);if(i.hasEagerState=!0,i.eagerState=s,Ll(s,c)){var f=t.interleaved;f===null?(i.next=i,GR(t)):(i.next=f.next,f.next=i),t.interleaved=i;return}}catch{}finally{}n=XU(e,t,i,r),n!==null&&(i=xs(),Pl(n,e,r,i),m$(n,t,r))}}function f$(e){var t=e.alternate;return e===yi||t!==null&&t===yi}function p$(e,t){Q0=Nw=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function m$(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,RR(e,n)}}var Bw={readContext:qa,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},ree={readContext:qa,useCallback:function(e,t){return tc().memoizedState=[e,t===void 0?null:t],e},useContext:qa,useEffect:Qz,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Bb(4194308,4,a$.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Bb(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bb(4,2,e,t)},useMemo:function(e,t){var n=tc();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=tc();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tee.bind(null,yi,e),[r.memoizedState,e]},useRef:function(e){var t=tc();return e={current:e},t.memoizedState=e},useState:Jz,useDebugValue:e3,useDeferredValue:function(e){return tc().memoizedState=e},useTransition:function(){var e=Jz(!1),t=e[0];return e=eee.bind(null,e[1]),tc().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=yi,i=tc();if(pi){if(n===void 0)throw Error(dn(407));n=n()}else{if(n=t(),To===null)throw Error(dn(349));Cf&30||QU(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Qz(t$.bind(null,r,a,e),[e]),r.flags|=2048,Zy(9,e$.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=tc(),t=To.identifierPrefix;if(pi){var n=Zc,r=Xc;n=(r&~(1<<32-Tl(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=qy++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=QQ++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},iee={readContext:qa,useCallback:c$,useContext:qa,useEffect:QR,useImperativeHandle:l$,useInsertionEffect:o$,useLayoutEffect:s$,useMemo:u$,useReducer:sE,useRef:i$,useState:function(){return sE(Xy)},useDebugValue:e3,useDeferredValue:function(e){var t=Xa();return h$(t,lo.memoizedState,e)},useTransition:function(){var e=sE(Xy)[0],t=Xa().memoizedState;return[e,t]},useMutableSource:KU,useSyncExternalStore:JU,useId:d$,unstable_isNewReconciler:!1},oee={readContext:qa,useCallback:c$,useContext:qa,useEffect:QR,useImperativeHandle:l$,useInsertionEffect:o$,useLayoutEffect:s$,useMemo:u$,useReducer:aE,useRef:i$,useState:function(){return aE(Xy)},useDebugValue:e3,useDeferredValue:function(e){var t=Xa();return lo===null?t.memoizedState=e:h$(t,lo.memoizedState,e)},useTransition:function(){var e=aE(Xy)[0],t=Xa().memoizedState;return[e,t]},useMutableSource:KU,useSyncExternalStore:JU,useId:d$,unstable_isNewReconciler:!1};function xl(e,t){if(e&&e.defaultProps){t=xi({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function GP(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:xi({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var uM={isMounted:function(e){return(e=e._reactInternals)?Bf(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=xs(),i=Ch(e),a=Jc(r,i);a.payload=t,n!=null&&(a.callback=n),t=Sh(e,a,i),t!==null&&(Pl(t,e,i,r),Fb(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=xs(),i=Ch(e),a=Jc(r,i);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Sh(e,a,i),t!==null&&(Pl(t,e,i,r),Fb(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=xs(),r=Ch(e),i=Jc(n,r);i.tag=2,t!=null&&(i.callback=t),t=Sh(e,i,r),t!==null&&(Pl(t,e,r,n),Fb(t,e,r))}};function eO(e,t,n,r,i,a,c){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,c):t.prototype&&t.prototype.isPureReactComponent?!$y(n,r)||!$y(i,a):!0}function g$(e,t,n){var r=!1,i=zh,a=t.contextType;return typeof a=="object"&&a!==null?a=qa(a):(i=Ns(t)?Sf:as.current,r=t.contextTypes,a=(r=r!=null)?ag(e,i):zh),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=uM,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function tO(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&uM.enqueueReplaceState(t,t.state,null)}function WP(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},WR(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=qa(a):(a=Ns(t)?Sf:as.current,i.context=ag(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(GP(e,t,a,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&uM.enqueueReplaceState(i,i.state,null),Ow(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function hg(e,t){try{var n="",r=t;do n+=kJ(r),r=r.return;while(r);var i=n}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function lE(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function qP(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var see=typeof WeakMap=="function"?WeakMap:Map;function v$(e,t,n){n=Jc(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){$w||($w=!0,rA=r),qP(e,t)},n}function y$(e,t,n){n=Jc(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){qP(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){qP(e,t),typeof r!="function"&&(Mh===null?Mh=new Set([this]):Mh.add(this));var c=t.stack;this.componentDidCatch(t.value,{componentStack:c!==null?c:""})}),n}function nO(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new see;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=xee.bind(null,e,t,n),t.then(e,e))}function rO(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function iO(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Jc(-1,1),t.tag=2,Sh(n,t,1))),n.lanes|=1),e)}var aee=fu.ReactCurrentOwner,zs=!1;function gs(e,t,n,r){t.child=e===null?qU(t,null,n,r):cg(t,e.child,n,r)}function oO(e,t,n,r,i){n=n.render;var a=t.ref;return qm(t,i),r=KR(e,t,n,r,a,i),n=JR(),e!==null&&!zs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,su(e,t,i)):(pi&&n&&BR(t),t.flags|=1,gs(e,t,r,i),t.child)}function sO(e,t,n,r,i){if(e===null){var a=n.type;return typeof a=="function"&&!l3(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,_$(e,t,a,r,i)):(e=jb(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var c=a.memoizedProps;if(n=n.compare,n=n!==null?n:$y,n(c,r)&&e.ref===t.ref)return su(e,t,i)}return t.flags|=1,e=Eh(a,r),e.ref=t.ref,e.return=t,t.child=e}function _$(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if($y(a,r)&&e.ref===t.ref)if(zs=!1,t.pendingProps=r=a,(e.lanes&i)!==0)e.flags&131072&&(zs=!0);else return t.lanes=e.lanes,su(e,t,i)}return XP(e,t,n,r,i)}function x$(e,t,n){var r=t.pendingProps,i=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ii(Rm,la),la|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ii(Rm,la),la|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,ii(Rm,la),la|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,ii(Rm,la),la|=r;return gs(e,t,i,n),t.child}function b$(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function XP(e,t,n,r,i){var a=Ns(n)?Sf:as.current;return a=ag(t,a),qm(t,i),n=KR(e,t,n,r,a,i),r=JR(),e!==null&&!zs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,su(e,t,i)):(pi&&r&&BR(t),t.flags|=1,gs(e,t,n,i),t.child)}function aO(e,t,n,r,i){if(Ns(n)){var a=!0;Rw(t)}else a=!1;if(qm(t,i),t.stateNode===null)Ub(e,t),g$(t,n,r),WP(t,n,r,i),r=!0;else if(e===null){var c=t.stateNode,s=t.memoizedProps;c.props=s;var f=c.context,g=n.contextType;typeof g=="object"&&g!==null?g=qa(g):(g=Ns(n)?Sf:as.current,g=ag(t,g));var _=n.getDerivedStateFromProps,x=typeof _=="function"||typeof c.getSnapshotBeforeUpdate=="function";x||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(s!==r||f!==g)&&tO(t,c,r,g),ah=!1;var C=t.memoizedState;c.state=C,Ow(t,r,c,i),f=t.memoizedState,s!==r||C!==f||Fs.current||ah?(typeof _=="function"&&(GP(t,n,_,r),f=t.memoizedState),(s=ah||eO(t,n,s,r,C,f,g))?(x||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=f),c.props=r,c.state=f,c.context=g,r=s):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{c=t.stateNode,ZU(e,t),s=t.memoizedProps,g=t.type===t.elementType?s:xl(t.type,s),c.props=g,x=t.pendingProps,C=c.context,f=n.contextType,typeof f=="object"&&f!==null?f=qa(f):(f=Ns(n)?Sf:as.current,f=ag(t,f));var E=n.getDerivedStateFromProps;(_=typeof E=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(s!==x||C!==f)&&tO(t,c,r,f),ah=!1,C=t.memoizedState,c.state=C,Ow(t,r,c,i);var A=t.memoizedState;s!==x||C!==A||Fs.current||ah?(typeof E=="function"&&(GP(t,n,E,r),A=t.memoizedState),(g=ah||eO(t,n,g,r,C,A,f)||!1)?(_||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(r,A,f),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(r,A,f)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||s===e.memoizedProps&&C===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&C===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=A),c.props=r,c.state=A,c.context=f,r=g):(typeof c.componentDidUpdate!="function"||s===e.memoizedProps&&C===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&C===e.memoizedState||(t.flags|=1024),r=!1)}return ZP(e,t,n,r,a,i)}function ZP(e,t,n,r,i,a){b$(e,t);var c=(t.flags&128)!==0;if(!r&&!c)return i&&Wz(t,n,!1),su(e,t,a);r=t.stateNode,aee.current=t;var s=c&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&c?(t.child=cg(t,e.child,null,a),t.child=cg(t,null,s,a)):gs(e,t,s,a),t.memoizedState=r.state,i&&Wz(t,n,!0),t.child}function w$(e){var t=e.stateNode;t.pendingContext?Gz(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Gz(e,t.context,!1),qR(e,t.containerInfo)}function lO(e,t,n,r,i){return lg(),$R(i),t.flags|=256,gs(e,t,n,r),t.child}var YP={dehydrated:null,treeContext:null,retryLane:0};function KP(e){return{baseLanes:e,cachePool:null,transitions:null}}function S$(e,t,n){var r=t.pendingProps,i=vi.current,a=!1,c=(t.flags&128)!==0,s;if((s=c)||(s=e!==null&&e.memoizedState===null?!1:(i&2)!==0),s?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),ii(vi,i&1),e===null)return jP(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(c=r.children,e=r.fallback,a?(r=t.mode,a=t.child,c={mode:"hidden",children:c},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=c):a=fM(c,r,0,null),e=vf(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=KP(n),t.memoizedState=YP,e):t3(t,c));if(i=e.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return lee(e,t,c,r,s,i,n);if(a){a=r.fallback,c=t.mode,i=e.child,s=i.sibling;var f={mode:"hidden",children:r.children};return!(c&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=f,t.deletions=null):(r=Eh(i,f),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?a=Eh(s,a):(a=vf(a,c,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,c=e.child.memoizedState,c=c===null?KP(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=YP,r}return a=e.child,e=a.sibling,r=Eh(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function t3(e,t){return t=fM({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function k1(e,t,n,r){return r!==null&&$R(r),cg(t,e.child,null,n),e=t3(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function lee(e,t,n,r,i,a,c){if(n)return t.flags&256?(t.flags&=-257,r=lE(Error(dn(422))),k1(e,t,c,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=fM({mode:"visible",children:r.children},i,0,null),a=vf(a,i,c,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&cg(t,e.child,null,c),t.child.memoizedState=KP(c),t.memoizedState=YP,a);if(!(t.mode&1))return k1(e,t,c,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,a=Error(dn(419)),r=lE(a,r,void 0),k1(e,t,c,r)}if(s=(c&e.childLanes)!==0,zs||s){if(r=To,r!==null){switch(c&-c){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|c)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,ou(e,i),Pl(r,e,i,-1))}return a3(),r=lE(Error(dn(421))),k1(e,t,c,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=bee.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,ga=wh(i.nextSibling),ba=t,pi=!0,wl=null,e!==null&&(Ua[$a++]=Xc,Ua[$a++]=Zc,Ua[$a++]=Mf,Xc=e.id,Zc=e.overflow,Mf=t),t=t3(t,r.children),t.flags|=4096,t)}function cO(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),HP(e.return,t,n)}function cE(e,t,n,r,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function M$(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(gs(e,t,r.children,n),r=vi.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&cO(e,n,t);else if(e.tag===19)cO(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ii(vi,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Fw(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),cE(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Fw(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}cE(t,!0,n,null,a);break;case"together":cE(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ub(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function su(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ef|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(dn(153));if(t.child!==null){for(e=t.child,n=Eh(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Eh(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function cee(e,t,n){switch(t.tag){case 3:w$(t),lg();break;case 5:YU(t);break;case 1:Ns(t.type)&&Rw(t);break;case 4:qR(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;ii(Dw,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ii(vi,vi.current&1),t.flags|=128,null):n&t.child.childLanes?S$(e,t,n):(ii(vi,vi.current&1),e=su(e,t,n),e!==null?e.sibling:null);ii(vi,vi.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return M$(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ii(vi,vi.current),r)break;return null;case 22:case 23:return t.lanes=0,x$(e,t,n)}return su(e,t,n)}var C$,JP,E$,T$;C$=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};JP=function(){};E$=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,hf(hc.current);var a=null;switch(n){case"input":i=xP(e,i),r=xP(e,r),a=[];break;case"select":i=xi({},i,{value:void 0}),r=xi({},r,{value:void 0}),a=[];break;case"textarea":i=SP(e,i),r=SP(e,r),a=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Aw)}CP(n,r);var c;n=null;for(g in i)if(!r.hasOwnProperty(g)&&i.hasOwnProperty(g)&&i[g]!=null)if(g==="style"){var s=i[g];for(c in s)s.hasOwnProperty(c)&&(n||(n={}),n[c]="")}else g!=="dangerouslySetInnerHTML"&&g!=="children"&&g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Dy.hasOwnProperty(g)?a||(a=[]):(a=a||[]).push(g,null));for(g in r){var f=r[g];if(s=i!=null?i[g]:void 0,r.hasOwnProperty(g)&&f!==s&&(f!=null||s!=null))if(g==="style")if(s){for(c in s)!s.hasOwnProperty(c)||f&&f.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in f)f.hasOwnProperty(c)&&s[c]!==f[c]&&(n||(n={}),n[c]=f[c])}else n||(a||(a=[]),a.push(g,n)),n=f;else g==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,s=s?s.__html:void 0,f!=null&&s!==f&&(a=a||[]).push(g,f)):g==="children"?typeof f!="string"&&typeof f!="number"||(a=a||[]).push(g,""+f):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&(Dy.hasOwnProperty(g)?(f!=null&&g==="onScroll"&&li("scroll",e),a||s===f||(a=[])):(a=a||[]).push(g,f))}n&&(a=a||[]).push("style",n);var g=a;(t.updateQueue=g)&&(t.flags|=4)}};T$=function(e,t,n,r){n!==r&&(t.flags|=4)};function l0(e,t){if(!pi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ts(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function uee(e,t,n){var r=t.pendingProps;switch(UR(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(t),null;case 1:return Ns(t.type)&&Iw(),ts(t),null;case 3:return r=t.stateNode,ug(),ui(Fs),ui(as),ZR(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(R1(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,wl!==null&&(sA(wl),wl=null))),JP(e,t),ts(t),null;case 5:XR(t);var i=hf(Wy.current);if(n=t.type,e!==null&&t.stateNode!=null)E$(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(dn(166));return ts(t),null}if(e=hf(hc.current),R1(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[sc]=t,r[Hy]=a,e=(t.mode&1)!==0,n){case"dialog":li("cancel",r),li("close",r);break;case"iframe":case"object":case"embed":li("load",r);break;case"video":case"audio":for(i=0;i<z0.length;i++)li(z0[i],r);break;case"source":li("error",r);break;case"img":case"image":case"link":li("error",r),li("load",r);break;case"details":li("toggle",r);break;case"input":yz(r,a),li("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},li("invalid",r);break;case"textarea":xz(r,a),li("invalid",r)}CP(n,a),i=null;for(var c in a)if(a.hasOwnProperty(c)){var s=a[c];c==="children"?typeof s=="string"?r.textContent!==s&&(a.suppressHydrationWarning!==!0&&I1(r.textContent,s,e),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&I1(r.textContent,s,e),i=["children",""+s]):Dy.hasOwnProperty(c)&&s!=null&&c==="onScroll"&&li("scroll",r)}switch(n){case"input":w1(r),_z(r,a,!0);break;case"textarea":w1(r),bz(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=Aw)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{c=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=tU(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=c.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),n==="select"&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[sc]=t,e[Hy]=r,C$(e,t,!1,!1),t.stateNode=e;e:{switch(c=EP(n,r),n){case"dialog":li("cancel",e),li("close",e),i=r;break;case"iframe":case"object":case"embed":li("load",e),i=r;break;case"video":case"audio":for(i=0;i<z0.length;i++)li(z0[i],e);i=r;break;case"source":li("error",e),i=r;break;case"img":case"image":case"link":li("error",e),li("load",e),i=r;break;case"details":li("toggle",e),i=r;break;case"input":yz(e,r),i=xP(e,r),li("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=xi({},r,{value:void 0}),li("invalid",e);break;case"textarea":xz(e,r),i=SP(e,r),li("invalid",e);break;default:i=r}CP(n,i),s=i;for(a in s)if(s.hasOwnProperty(a)){var f=s[a];a==="style"?iU(e,f):a==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&nU(e,f)):a==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&zy(e,f):typeof f=="number"&&zy(e,""+f):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Dy.hasOwnProperty(a)?f!=null&&a==="onScroll"&&li("scroll",e):f!=null&&CR(e,a,f,c))}switch(n){case"input":w1(e),_z(e,r,!1);break;case"textarea":w1(e),bz(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Dh(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?jm(e,!!r.multiple,a,!1):r.defaultValue!=null&&jm(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Aw)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ts(t),null;case 6:if(e&&t.stateNode!=null)T$(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(dn(166));if(n=hf(Wy.current),hf(hc.current),R1(t)){if(r=t.stateNode,n=t.memoizedProps,r[sc]=t,(a=r.nodeValue!==n)&&(e=ba,e!==null))switch(e.tag){case 3:I1(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&I1(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[sc]=t,t.stateNode=r}return ts(t),null;case 13:if(ui(vi),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pi&&ga!==null&&t.mode&1&&!(t.flags&128))GU(),lg(),t.flags|=98560,a=!1;else if(a=R1(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(dn(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(dn(317));a[sc]=t}else lg(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ts(t),a=!1}else wl!==null&&(sA(wl),wl=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||vi.current&1?co===0&&(co=3):a3())),t.updateQueue!==null&&(t.flags|=4),ts(t),null);case 4:return ug(),JP(e,t),e===null&&Vy(t.stateNode.containerInfo),ts(t),null;case 10:return HR(t.type._context),ts(t),null;case 17:return Ns(t.type)&&Iw(),ts(t),null;case 19:if(ui(vi),a=t.memoizedState,a===null)return ts(t),null;if(r=(t.flags&128)!==0,c=a.rendering,c===null)if(r)l0(a,!1);else{if(co!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(c=Fw(e),c!==null){for(t.flags|=128,l0(a,!1),r=c.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,c=a.alternate,c===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,e=c.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ii(vi,vi.current&1|2),t.child}e=e.sibling}a.tail!==null&&zi()>dg&&(t.flags|=128,r=!0,l0(a,!1),t.lanes=4194304)}else{if(!r)if(e=Fw(c),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),l0(a,!0),a.tail===null&&a.tailMode==="hidden"&&!c.alternate&&!pi)return ts(t),null}else 2*zi()-a.renderingStartTime>dg&&n!==1073741824&&(t.flags|=128,r=!0,l0(a,!1),t.lanes=4194304);a.isBackwards?(c.sibling=t.child,t.child=c):(n=a.last,n!==null?n.sibling=c:t.child=c,a.last=c)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=zi(),t.sibling=null,n=vi.current,ii(vi,r?n&1|2:n&1),t):(ts(t),null);case 22:case 23:return s3(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?la&1073741824&&(ts(t),t.subtreeFlags&6&&(t.flags|=8192)):ts(t),null;case 24:return null;case 25:return null}throw Error(dn(156,t.tag))}function hee(e,t){switch(UR(t),t.tag){case 1:return Ns(t.type)&&Iw(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ug(),ui(Fs),ui(as),ZR(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return XR(t),null;case 13:if(ui(vi),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(dn(340));lg()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ui(vi),null;case 4:return ug(),null;case 10:return HR(t.type._context),null;case 22:case 23:return s3(),null;case 24:return null;default:return null}}var D1=!1,ss=!1,dee=typeof WeakSet=="function"?WeakSet:Set,On=null;function Im(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ai(e,t,r)}else n.current=null}function QP(e,t,n){try{n()}catch(r){Ai(e,t,r)}}var uO=!1;function fee(e,t){if(OP=Ew,e=LU(),NR(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var c=0,s=-1,f=-1,g=0,_=0,x=e,C=null;t:for(;;){for(var E;x!==n||i!==0&&x.nodeType!==3||(s=c+i),x!==a||r!==0&&x.nodeType!==3||(f=c+r),x.nodeType===3&&(c+=x.nodeValue.length),(E=x.firstChild)!==null;)C=x,x=E;for(;;){if(x===e)break t;if(C===n&&++g===i&&(s=c),C===a&&++_===r&&(f=c),(E=x.nextSibling)!==null)break;x=C,C=x.parentNode}x=E}n=s===-1||f===-1?null:{start:s,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(FP={focusedElem:e,selectionRange:n},Ew=!1,On=t;On!==null;)if(t=On,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,On=e;else for(;On!==null;){t=On;try{var A=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var L=A.memoizedProps,I=A.memoizedState,T=t.stateNode,O=T.getSnapshotBeforeUpdate(t.elementType===t.type?L:xl(t.type,L),I);T.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var D=t.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(dn(163))}}catch(U){Ai(t,t.return,U)}if(e=t.sibling,e!==null){e.return=t.return,On=e;break}On=t.return}return A=uO,uO=!1,A}function ey(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&QP(t,n,a)}i=i.next}while(i!==r)}}function hM(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function eA(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function P$(e){var t=e.alternate;t!==null&&(e.alternate=null,P$(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[sc],delete t[Hy],delete t[UP],delete t[ZQ],delete t[YQ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function A$(e){return e.tag===5||e.tag===3||e.tag===4}function hO(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||A$(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function tA(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Aw));else if(r!==4&&(e=e.child,e!==null))for(tA(e,t,n),e=e.sibling;e!==null;)tA(e,t,n),e=e.sibling}function nA(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(nA(e,t,n),e=e.sibling;e!==null;)nA(e,t,n),e=e.sibling}var Oo=null,bl=!1;function Xu(e,t,n){for(n=n.child;n!==null;)I$(e,t,n),n=n.sibling}function I$(e,t,n){if(uc&&typeof uc.onCommitFiberUnmount=="function")try{uc.onCommitFiberUnmount(rM,n)}catch{}switch(n.tag){case 5:ss||Im(n,t);case 6:var r=Oo,i=bl;Oo=null,Xu(e,t,n),Oo=r,bl=i,Oo!==null&&(bl?(e=Oo,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Oo.removeChild(n.stateNode));break;case 18:Oo!==null&&(bl?(e=Oo,n=n.stateNode,e.nodeType===8?nE(e.parentNode,n):e.nodeType===1&&nE(e,n),By(e)):nE(Oo,n.stateNode));break;case 4:r=Oo,i=bl,Oo=n.stateNode.containerInfo,bl=!0,Xu(e,t,n),Oo=r,bl=i;break;case 0:case 11:case 14:case 15:if(!ss&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var a=i,c=a.destroy;a=a.tag,c!==void 0&&(a&2||a&4)&&QP(n,t,c),i=i.next}while(i!==r)}Xu(e,t,n);break;case 1:if(!ss&&(Im(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Ai(n,t,s)}Xu(e,t,n);break;case 21:Xu(e,t,n);break;case 22:n.mode&1?(ss=(r=ss)||n.memoizedState!==null,Xu(e,t,n),ss=r):Xu(e,t,n);break;default:Xu(e,t,n)}}function dO(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new dee),t.forEach(function(r){var i=wee.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function fl(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,c=t,s=c;e:for(;s!==null;){switch(s.tag){case 5:Oo=s.stateNode,bl=!1;break e;case 3:Oo=s.stateNode.containerInfo,bl=!0;break e;case 4:Oo=s.stateNode.containerInfo,bl=!0;break e}s=s.return}if(Oo===null)throw Error(dn(160));I$(a,c,i),Oo=null,bl=!1;var f=i.alternate;f!==null&&(f.return=null),i.return=null}catch(g){Ai(i,t,g)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)R$(t,e),t=t.sibling}function R$(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fl(t,e),Xl(e),r&4){try{ey(3,e,e.return),hM(3,e)}catch(L){Ai(e,e.return,L)}try{ey(5,e,e.return)}catch(L){Ai(e,e.return,L)}}break;case 1:fl(t,e),Xl(e),r&512&&n!==null&&Im(n,n.return);break;case 5:if(fl(t,e),Xl(e),r&512&&n!==null&&Im(n,n.return),e.flags&32){var i=e.stateNode;try{zy(i,"")}catch(L){Ai(e,e.return,L)}}if(r&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,c=n!==null?n.memoizedProps:a,s=e.type,f=e.updateQueue;if(e.updateQueue=null,f!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&Q6(i,a),EP(s,c);var g=EP(s,a);for(c=0;c<f.length;c+=2){var _=f[c],x=f[c+1];_==="style"?iU(i,x):_==="dangerouslySetInnerHTML"?nU(i,x):_==="children"?zy(i,x):CR(i,_,x,g)}switch(s){case"input":bP(i,a);break;case"textarea":eU(i,a);break;case"select":var C=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var E=a.value;E!=null?jm(i,!!a.multiple,E,!1):C!==!!a.multiple&&(a.defaultValue!=null?jm(i,!!a.multiple,a.defaultValue,!0):jm(i,!!a.multiple,a.multiple?[]:"",!1))}i[Hy]=a}catch(L){Ai(e,e.return,L)}}break;case 6:if(fl(t,e),Xl(e),r&4){if(e.stateNode===null)throw Error(dn(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(L){Ai(e,e.return,L)}}break;case 3:if(fl(t,e),Xl(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{By(t.containerInfo)}catch(L){Ai(e,e.return,L)}break;case 4:fl(t,e),Xl(e);break;case 13:fl(t,e),Xl(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(i3=zi())),r&4&&dO(e);break;case 22:if(_=n!==null&&n.memoizedState!==null,e.mode&1?(ss=(g=ss)||_,fl(t,e),ss=g):fl(t,e),Xl(e),r&8192){if(g=e.memoizedState!==null,(e.stateNode.isHidden=g)&&!_&&e.mode&1)for(On=e,_=e.child;_!==null;){for(x=On=_;On!==null;){switch(C=On,E=C.child,C.tag){case 0:case 11:case 14:case 15:ey(4,C,C.return);break;case 1:Im(C,C.return);var A=C.stateNode;if(typeof A.componentWillUnmount=="function"){r=C,n=C.return;try{t=r,A.props=t.memoizedProps,A.state=t.memoizedState,A.componentWillUnmount()}catch(L){Ai(r,n,L)}}break;case 5:Im(C,C.return);break;case 22:if(C.memoizedState!==null){pO(x);continue}}E!==null?(E.return=C,On=E):pO(x)}_=_.sibling}e:for(_=null,x=e;;){if(x.tag===5){if(_===null){_=x;try{i=x.stateNode,g?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=x.stateNode,f=x.memoizedProps.style,c=f!=null&&f.hasOwnProperty("display")?f.display:null,s.style.display=rU("display",c))}catch(L){Ai(e,e.return,L)}}}else if(x.tag===6){if(_===null)try{x.stateNode.nodeValue=g?"":x.memoizedProps}catch(L){Ai(e,e.return,L)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===e)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===e)break e;for(;x.sibling===null;){if(x.return===null||x.return===e)break e;_===x&&(_=null),x=x.return}_===x&&(_=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:fl(t,e),Xl(e),r&4&&dO(e);break;case 21:break;default:fl(t,e),Xl(e)}}function Xl(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(A$(n)){var r=n;break e}n=n.return}throw Error(dn(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(zy(i,""),r.flags&=-33);var a=hO(e);nA(e,a,i);break;case 3:case 4:var c=r.stateNode.containerInfo,s=hO(e);tA(e,s,c);break;default:throw Error(dn(161))}}catch(f){Ai(e,e.return,f)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pee(e,t,n){On=e,L$(e)}function L$(e,t,n){for(var r=(e.mode&1)!==0;On!==null;){var i=On,a=i.child;if(i.tag===22&&r){var c=i.memoizedState!==null||D1;if(!c){var s=i.alternate,f=s!==null&&s.memoizedState!==null||ss;s=D1;var g=ss;if(D1=c,(ss=f)&&!g)for(On=i;On!==null;)c=On,f=c.child,c.tag===22&&c.memoizedState!==null?mO(i):f!==null?(f.return=c,On=f):mO(i);for(;a!==null;)On=a,L$(a),a=a.sibling;On=i,D1=s,ss=g}fO(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,On=a):fO(e)}}function fO(e){for(;On!==null;){var t=On;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ss||hM(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!ss)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:xl(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Kz(t,a,r);break;case 3:var c=t.updateQueue;if(c!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Kz(t,c,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var f=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var g=t.alternate;if(g!==null){var _=g.memoizedState;if(_!==null){var x=_.dehydrated;x!==null&&By(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(dn(163))}ss||t.flags&512&&eA(t)}catch(C){Ai(t,t.return,C)}}if(t===e){On=null;break}if(n=t.sibling,n!==null){n.return=t.return,On=n;break}On=t.return}}function pO(e){for(;On!==null;){var t=On;if(t===e){On=null;break}var n=t.sibling;if(n!==null){n.return=t.return,On=n;break}On=t.return}}function mO(e){for(;On!==null;){var t=On;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{hM(4,t)}catch(f){Ai(t,n,f)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(f){Ai(t,i,f)}}var a=t.return;try{eA(t)}catch(f){Ai(t,a,f)}break;case 5:var c=t.return;try{eA(t)}catch(f){Ai(t,c,f)}}}catch(f){Ai(t,t.return,f)}if(t===e){On=null;break}var s=t.sibling;if(s!==null){s.return=t.return,On=s;break}On=t.return}}var mee=Math.ceil,Uw=fu.ReactCurrentDispatcher,n3=fu.ReactCurrentOwner,Ga=fu.ReactCurrentBatchConfig,Tr=0,To=null,Qi=null,Vo=0,la=0,Rm=Zh(0),co=0,Yy=null,Ef=0,dM=0,r3=0,ty=null,Ls=null,i3=0,dg=1/0,Hc=null,$w=!1,rA=null,Mh=null,z1=!1,mh=null,Vw=0,ny=0,iA=null,$b=-1,Vb=0;function xs(){return Tr&6?zi():$b!==-1?$b:$b=zi()}function Ch(e){return e.mode&1?Tr&2&&Vo!==0?Vo&-Vo:JQ.transition!==null?(Vb===0&&(Vb=gU()),Vb):(e=$r,e!==0||(e=window.event,e=e===void 0?16:SU(e.type)),e):1}function Pl(e,t,n,r){if(50<ny)throw ny=0,iA=null,Error(dn(185));C_(e,n,r),(!(Tr&2)||e!==To)&&(e===To&&(!(Tr&2)&&(dM|=n),co===4&&uh(e,Vo)),Bs(e,r),n===1&&Tr===0&&!(t.mode&1)&&(dg=zi()+500,lM&&Yh()))}function Bs(e,t){var n=e.callbackNode;JJ(e,t);var r=Cw(e,e===To?Vo:0);if(r===0)n!==null&&Mz(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Mz(n),t===1)e.tag===0?KQ(gO.bind(null,e)):VU(gO.bind(null,e)),qQ(function(){!(Tr&6)&&Yh()}),n=null;else{switch(vU(r)){case 1:n=IR;break;case 4:n=pU;break;case 16:n=Mw;break;case 536870912:n=mU;break;default:n=Mw}n=U$(n,k$.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function k$(e,t){if($b=-1,Vb=0,Tr&6)throw Error(dn(327));var n=e.callbackNode;if(Xm()&&e.callbackNode!==n)return null;var r=Cw(e,e===To?Vo:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=jw(e,r);else{t=r;var i=Tr;Tr|=2;var a=z$();(To!==e||Vo!==t)&&(Hc=null,dg=zi()+500,gf(e,t));do try{yee();break}catch(s){D$(e,s)}while(!0);jR(),Uw.current=a,Tr=i,Qi!==null?t=0:(To=null,Vo=0,t=co)}if(t!==0){if(t===2&&(i=RP(e),i!==0&&(r=i,t=oA(e,i))),t===1)throw n=Yy,gf(e,0),uh(e,r),Bs(e,zi()),n;if(t===6)uh(e,r);else{if(i=e.current.alternate,!(r&30)&&!gee(i)&&(t=jw(e,r),t===2&&(a=RP(e),a!==0&&(r=a,t=oA(e,a))),t===1))throw n=Yy,gf(e,0),uh(e,r),Bs(e,zi()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(dn(345));case 2:ef(e,Ls,Hc);break;case 3:if(uh(e,r),(r&130023424)===r&&(t=i3+500-zi(),10<t)){if(Cw(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){xs(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=BP(ef.bind(null,e,Ls,Hc),t);break}ef(e,Ls,Hc);break;case 4:if(uh(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var c=31-Tl(r);a=1<<c,c=t[c],c>i&&(i=c),r&=~a}if(r=i,r=zi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*mee(r/1960))-r,10<r){e.timeoutHandle=BP(ef.bind(null,e,Ls,Hc),r);break}ef(e,Ls,Hc);break;case 5:ef(e,Ls,Hc);break;default:throw Error(dn(329))}}}return Bs(e,zi()),e.callbackNode===n?k$.bind(null,e):null}function oA(e,t){var n=ty;return e.current.memoizedState.isDehydrated&&(gf(e,t).flags|=256),e=jw(e,t),e!==2&&(t=Ls,Ls=n,t!==null&&sA(t)),e}function sA(e){Ls===null?Ls=e:Ls.push.apply(Ls,e)}function gee(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Ll(a(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function uh(e,t){for(t&=~r3,t&=~dM,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Tl(t),r=1<<n;e[n]=-1,t&=~r}}function gO(e){if(Tr&6)throw Error(dn(327));Xm();var t=Cw(e,0);if(!(t&1))return Bs(e,zi()),null;var n=jw(e,t);if(e.tag!==0&&n===2){var r=RP(e);r!==0&&(t=r,n=oA(e,r))}if(n===1)throw n=Yy,gf(e,0),uh(e,t),Bs(e,zi()),n;if(n===6)throw Error(dn(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ef(e,Ls,Hc),Bs(e,zi()),null}function o3(e,t){var n=Tr;Tr|=1;try{return e(t)}finally{Tr=n,Tr===0&&(dg=zi()+500,lM&&Yh())}}function Tf(e){mh!==null&&mh.tag===0&&!(Tr&6)&&Xm();var t=Tr;Tr|=1;var n=Ga.transition,r=$r;try{if(Ga.transition=null,$r=1,e)return e()}finally{$r=r,Ga.transition=n,Tr=t,!(Tr&6)&&Yh()}}function s3(){la=Rm.current,ui(Rm)}function gf(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,WQ(n)),Qi!==null)for(n=Qi.return;n!==null;){var r=n;switch(UR(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Iw();break;case 3:ug(),ui(Fs),ui(as),ZR();break;case 5:XR(r);break;case 4:ug();break;case 13:ui(vi);break;case 19:ui(vi);break;case 10:HR(r.type._context);break;case 22:case 23:s3()}n=n.return}if(To=e,Qi=e=Eh(e.current,null),Vo=la=t,co=0,Yy=null,r3=dM=Ef=0,Ls=ty=null,uf!==null){for(t=0;t<uf.length;t++)if(n=uf[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,a=n.pending;if(a!==null){var c=a.next;a.next=i,r.next=c}n.pending=r}uf=null}return e}function D$(e,t){do{var n=Qi;try{if(jR(),Nb.current=Bw,Nw){for(var r=yi.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Nw=!1}if(Cf=0,Mo=lo=yi=null,Q0=!1,qy=0,n3.current=null,n===null||n.return===null){co=1,Yy=t,Qi=null;break}e:{var a=e,c=n.return,s=n,f=t;if(t=Vo,s.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var g=f,_=s,x=_.tag;if(!(_.mode&1)&&(x===0||x===11||x===15)){var C=_.alternate;C?(_.updateQueue=C.updateQueue,_.memoizedState=C.memoizedState,_.lanes=C.lanes):(_.updateQueue=null,_.memoizedState=null)}var E=rO(c);if(E!==null){E.flags&=-257,iO(E,c,s,a,t),E.mode&1&&nO(a,g,t),t=E,f=g;var A=t.updateQueue;if(A===null){var L=new Set;L.add(f),t.updateQueue=L}else A.add(f);break e}else{if(!(t&1)){nO(a,g,t),a3();break e}f=Error(dn(426))}}else if(pi&&s.mode&1){var I=rO(c);if(I!==null){!(I.flags&65536)&&(I.flags|=256),iO(I,c,s,a,t),$R(hg(f,s));break e}}a=f=hg(f,s),co!==4&&(co=2),ty===null?ty=[a]:ty.push(a),a=c;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var T=v$(a,f,t);Yz(a,T);break e;case 1:s=f;var O=a.type,D=a.stateNode;if(!(a.flags&128)&&(typeof O.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Mh===null||!Mh.has(D)))){a.flags|=65536,t&=-t,a.lanes|=t;var U=y$(a,s,t);Yz(a,U);break e}}a=a.return}while(a!==null)}F$(n)}catch(H){t=H,Qi===n&&n!==null&&(Qi=n=n.return);continue}break}while(!0)}function z$(){var e=Uw.current;return Uw.current=Bw,e===null?Bw:e}function a3(){(co===0||co===3||co===2)&&(co=4),To===null||!(Ef&268435455)&&!(dM&268435455)||uh(To,Vo)}function jw(e,t){var n=Tr;Tr|=2;var r=z$();(To!==e||Vo!==t)&&(Hc=null,gf(e,t));do try{vee();break}catch(i){D$(e,i)}while(!0);if(jR(),Tr=n,Uw.current=r,Qi!==null)throw Error(dn(261));return To=null,Vo=0,co}function vee(){for(;Qi!==null;)O$(Qi)}function yee(){for(;Qi!==null&&!jJ();)O$(Qi)}function O$(e){var t=B$(e.alternate,e,la);e.memoizedProps=e.pendingProps,t===null?F$(e):Qi=t,n3.current=null}function F$(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=hee(n,t),n!==null){n.flags&=32767,Qi=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{co=6,Qi=null;return}}else if(n=uee(n,t,la),n!==null){Qi=n;return}if(t=t.sibling,t!==null){Qi=t;return}Qi=t=e}while(t!==null);co===0&&(co=5)}function ef(e,t,n){var r=$r,i=Ga.transition;try{Ga.transition=null,$r=1,_ee(e,t,n,r)}finally{Ga.transition=i,$r=r}return null}function _ee(e,t,n,r){do Xm();while(mh!==null);if(Tr&6)throw Error(dn(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(dn(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(QJ(e,a),e===To&&(Qi=To=null,Vo=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||z1||(z1=!0,U$(Mw,function(){return Xm(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Ga.transition,Ga.transition=null;var c=$r;$r=1;var s=Tr;Tr|=4,n3.current=null,fee(e,n),R$(n,e),BQ(FP),Ew=!!OP,FP=OP=null,e.current=n,pee(n),HJ(),Tr=s,$r=c,Ga.transition=a}else e.current=n;if(z1&&(z1=!1,mh=e,Vw=i),a=e.pendingLanes,a===0&&(Mh=null),qJ(n.stateNode),Bs(e,zi()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if($w)throw $w=!1,e=rA,rA=null,e;return Vw&1&&e.tag!==0&&Xm(),a=e.pendingLanes,a&1?e===iA?ny++:(ny=0,iA=e):ny=0,Yh(),null}function Xm(){if(mh!==null){var e=vU(Vw),t=Ga.transition,n=$r;try{if(Ga.transition=null,$r=16>e?16:e,mh===null)var r=!1;else{if(e=mh,mh=null,Vw=0,Tr&6)throw Error(dn(331));var i=Tr;for(Tr|=4,On=e.current;On!==null;){var a=On,c=a.child;if(On.flags&16){var s=a.deletions;if(s!==null){for(var f=0;f<s.length;f++){var g=s[f];for(On=g;On!==null;){var _=On;switch(_.tag){case 0:case 11:case 15:ey(8,_,a)}var x=_.child;if(x!==null)x.return=_,On=x;else for(;On!==null;){_=On;var C=_.sibling,E=_.return;if(P$(_),_===g){On=null;break}if(C!==null){C.return=E,On=C;break}On=E}}}var A=a.alternate;if(A!==null){var L=A.child;if(L!==null){A.child=null;do{var I=L.sibling;L.sibling=null,L=I}while(L!==null)}}On=a}}if(a.subtreeFlags&2064&&c!==null)c.return=a,On=c;else e:for(;On!==null;){if(a=On,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ey(9,a,a.return)}var T=a.sibling;if(T!==null){T.return=a.return,On=T;break e}On=a.return}}var O=e.current;for(On=O;On!==null;){c=On;var D=c.child;if(c.subtreeFlags&2064&&D!==null)D.return=c,On=D;else e:for(c=O;On!==null;){if(s=On,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:hM(9,s)}}catch(H){Ai(s,s.return,H)}if(s===c){On=null;break e}var U=s.sibling;if(U!==null){U.return=s.return,On=U;break e}On=s.return}}if(Tr=i,Yh(),uc&&typeof uc.onPostCommitFiberRoot=="function")try{uc.onPostCommitFiberRoot(rM,e)}catch{}r=!0}return r}finally{$r=n,Ga.transition=t}}return!1}function vO(e,t,n){t=hg(n,t),t=v$(e,t,1),e=Sh(e,t,1),t=xs(),e!==null&&(C_(e,1,t),Bs(e,t))}function Ai(e,t,n){if(e.tag===3)vO(e,e,n);else for(;t!==null;){if(t.tag===3){vO(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Mh===null||!Mh.has(r))){e=hg(n,e),e=y$(t,e,1),t=Sh(t,e,1),e=xs(),t!==null&&(C_(t,1,e),Bs(t,e));break}}t=t.return}}function xee(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=xs(),e.pingedLanes|=e.suspendedLanes&n,To===e&&(Vo&n)===n&&(co===4||co===3&&(Vo&130023424)===Vo&&500>zi()-i3?gf(e,0):r3|=n),Bs(e,t)}function N$(e,t){t===0&&(e.mode&1?(t=C1,C1<<=1,!(C1&130023424)&&(C1=4194304)):t=1);var n=xs();e=ou(e,t),e!==null&&(C_(e,t,n),Bs(e,n))}function bee(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),N$(e,n)}function wee(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(dn(314))}r!==null&&r.delete(t),N$(e,n)}var B$;B$=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Fs.current)zs=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return zs=!1,cee(e,t,n);zs=!!(e.flags&131072)}else zs=!1,pi&&t.flags&1048576&&jU(t,kw,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ub(e,t),e=t.pendingProps;var i=ag(t,as.current);qm(t,n),i=KR(null,t,r,e,i,n);var a=JR();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ns(r)?(a=!0,Rw(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,WR(t),i.updater=uM,t.stateNode=i,i._reactInternals=t,WP(t,r,e,n),t=ZP(null,t,r,!0,a,n)):(t.tag=0,pi&&a&&BR(t),gs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ub(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Mee(r),e=xl(r,e),i){case 0:t=XP(null,t,r,e,n);break e;case 1:t=aO(null,t,r,e,n);break e;case 11:t=oO(null,t,r,e,n);break e;case 14:t=sO(null,t,r,xl(r.type,e),n);break e}throw Error(dn(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xl(r,i),XP(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xl(r,i),aO(e,t,r,i,n);case 3:e:{if(w$(t),e===null)throw Error(dn(387));r=t.pendingProps,a=t.memoizedState,i=a.element,ZU(e,t),Ow(t,r,null,n);var c=t.memoizedState;if(r=c.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=hg(Error(dn(423)),t),t=lO(e,t,r,n,i);break e}else if(r!==i){i=hg(Error(dn(424)),t),t=lO(e,t,r,n,i);break e}else for(ga=wh(t.stateNode.containerInfo.firstChild),ba=t,pi=!0,wl=null,n=qU(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lg(),r===i){t=su(e,t,n);break e}gs(e,t,r,n)}t=t.child}return t;case 5:return YU(t),e===null&&jP(t),r=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,c=i.children,NP(r,i)?c=null:a!==null&&NP(r,a)&&(t.flags|=32),b$(e,t),gs(e,t,c,n),t.child;case 6:return e===null&&jP(t),null;case 13:return S$(e,t,n);case 4:return qR(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=cg(t,null,r,n):gs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xl(r,i),oO(e,t,r,i,n);case 7:return gs(e,t,t.pendingProps,n),t.child;case 8:return gs(e,t,t.pendingProps.children,n),t.child;case 12:return gs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,c=i.value,ii(Dw,r._currentValue),r._currentValue=c,a!==null)if(Ll(a.value,c)){if(a.children===i.children&&!Fs.current){t=su(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var s=a.dependencies;if(s!==null){c=a.child;for(var f=s.firstContext;f!==null;){if(f.context===r){if(a.tag===1){f=Jc(-1,n&-n),f.tag=2;var g=a.updateQueue;if(g!==null){g=g.shared;var _=g.pending;_===null?f.next=f:(f.next=_.next,_.next=f),g.pending=f}}a.lanes|=n,f=a.alternate,f!==null&&(f.lanes|=n),HP(a.return,n,t),s.lanes|=n;break}f=f.next}}else if(a.tag===10)c=a.type===t.type?null:a.child;else if(a.tag===18){if(c=a.return,c===null)throw Error(dn(341));c.lanes|=n,s=c.alternate,s!==null&&(s.lanes|=n),HP(c,n,t),c=a.sibling}else c=a.child;if(c!==null)c.return=a;else for(c=a;c!==null;){if(c===t){c=null;break}if(a=c.sibling,a!==null){a.return=c.return,c=a;break}c=c.return}a=c}gs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,qm(t,n),i=qa(i),r=r(i),t.flags|=1,gs(e,t,r,n),t.child;case 14:return r=t.type,i=xl(r,t.pendingProps),i=xl(r.type,i),sO(e,t,r,i,n);case 15:return _$(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:xl(r,i),Ub(e,t),t.tag=1,Ns(r)?(e=!0,Rw(t)):e=!1,qm(t,n),g$(t,r,i),WP(t,r,i,n),ZP(null,t,r,!0,e,n);case 19:return M$(e,t,n);case 22:return x$(e,t,n)}throw Error(dn(156,t.tag))};function U$(e,t){return fU(e,t)}function See(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ha(e,t,n,r){return new See(e,t,n,r)}function l3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Mee(e){if(typeof e=="function")return l3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===TR)return 11;if(e===PR)return 14}return 2}function Eh(e,t){var n=e.alternate;return n===null?(n=Ha(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function jb(e,t,n,r,i,a){var c=2;if(r=e,typeof e=="function")l3(e)&&(c=1);else if(typeof e=="string")c=5;else e:switch(e){case bm:return vf(n.children,i,a,t);case ER:c=8,i|=8;break;case gP:return e=Ha(12,n,t,i|2),e.elementType=gP,e.lanes=a,e;case vP:return e=Ha(13,n,t,i),e.elementType=vP,e.lanes=a,e;case yP:return e=Ha(19,n,t,i),e.elementType=yP,e.lanes=a,e;case Y6:return fM(n,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case X6:c=10;break e;case Z6:c=9;break e;case TR:c=11;break e;case PR:c=14;break e;case sh:c=16,r=null;break e}throw Error(dn(130,e==null?e:typeof e,""))}return t=Ha(c,n,t,i),t.elementType=e,t.type=r,t.lanes=a,t}function vf(e,t,n,r){return e=Ha(7,e,r,t),e.lanes=n,e}function fM(e,t,n,r){return e=Ha(22,e,r,t),e.elementType=Y6,e.lanes=n,e.stateNode={isHidden:!1},e}function uE(e,t,n){return e=Ha(6,e,null,t),e.lanes=n,e}function hE(e,t,n){return t=Ha(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Cee(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=G2(0),this.expirationTimes=G2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=G2(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function c3(e,t,n,r,i,a,c,s,f){return e=new Cee(e,t,n,s,f),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ha(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},WR(a),e}function Eee(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:xm,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function $$(e){if(!e)return zh;e=e._reactInternals;e:{if(Bf(e)!==e||e.tag!==1)throw Error(dn(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ns(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(dn(171))}if(e.tag===1){var n=e.type;if(Ns(n))return $U(e,n,t)}return t}function V$(e,t,n,r,i,a,c,s,f){return e=c3(n,r,!0,e,i,a,c,s,f),e.context=$$(null),n=e.current,r=xs(),i=Ch(n),a=Jc(r,i),a.callback=t??null,Sh(n,a,i),e.current.lanes=i,C_(e,i,r),Bs(e,r),e}function pM(e,t,n,r){var i=t.current,a=xs(),c=Ch(i);return n=$$(n),t.context===null?t.context=n:t.pendingContext=n,t=Jc(a,c),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Sh(i,t,c),e!==null&&(Pl(e,i,c,a),Fb(e,i,c)),c}function Hw(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yO(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function u3(e,t){yO(e,t),(e=e.alternate)&&yO(e,t)}var j$=typeof reportError=="function"?reportError:function(e){console.error(e)};function h3(e){this._internalRoot=e}mM.prototype.render=h3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(dn(409));pM(e,t,null,null)};mM.prototype.unmount=h3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Tf(function(){pM(null,e,null,null)}),t[iu]=null}};function mM(e){this._internalRoot=e}mM.prototype.unstable_scheduleHydration=function(e){if(e){var t=xU();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ch.length&&t!==0&&t<ch[n].priority;n++);ch.splice(n,0,e),n===0&&wU(e)}};function d3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function gM(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _O(){}function Tee(e,t,n,r,i){if(i){if(typeof r=="function"){var a=r;r=function(){var g=Hw(c);a.call(g)}}var c=V$(t,r,e,0,null,!1,!1,"",_O);return e._reactRootContainer=c,e[iu]=c.current,Vy(e.nodeType===8?e.parentNode:e),Tf(),c}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var g=Hw(f);s.call(g)}}var f=c3(e,0,!1,null,null,!1,!1,"",_O);return e._reactRootContainer=f,e[iu]=f.current,Vy(e.nodeType===8?e.parentNode:e),Tf(function(){pM(t,f,n,r)}),f}function vM(e,t,n,r,i){var a=n._reactRootContainer;if(a){var c=a;if(typeof i=="function"){var s=i;i=function(){var f=Hw(c);s.call(f)}}pM(t,c,e,i)}else c=Tee(n,t,e,i,r);return Hw(c)}yU=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=D0(t.pendingLanes);n!==0&&(RR(t,n|1),Bs(t,zi()),!(Tr&6)&&(dg=zi()+500,Yh()))}break;case 13:Tf(function(){var r=ou(e,1);if(r!==null){var i=xs();Pl(r,e,1,i)}}),u3(e,1)}};LR=function(e){if(e.tag===13){var t=ou(e,134217728);if(t!==null){var n=xs();Pl(t,e,134217728,n)}u3(e,134217728)}};_U=function(e){if(e.tag===13){var t=Ch(e),n=ou(e,t);if(n!==null){var r=xs();Pl(n,e,t,r)}u3(e,t)}};xU=function(){return $r};bU=function(e,t){var n=$r;try{return $r=e,t()}finally{$r=n}};PP=function(e,t,n){switch(t){case"input":if(bP(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=aM(r);if(!i)throw Error(dn(90));J6(r),bP(r,i)}}}break;case"textarea":eU(e,n);break;case"select":t=n.value,t!=null&&jm(e,!!n.multiple,t,!1)}};aU=o3;lU=Tf;var Pee={usingClientEntryPoint:!1,Events:[T_,Cm,aM,oU,sU,o3]},c0={findFiberByHostInstance:cf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Aee={bundleType:c0.bundleType,version:c0.version,rendererPackageName:c0.rendererPackageName,rendererConfig:c0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=hU(e),e===null?null:e.stateNode},findFiberByHostInstance:c0.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var O1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!O1.isDisabled&&O1.supportsFiber)try{rM=O1.inject(Aee),uc=O1}catch{}}Ta.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pee;Ta.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d3(t))throw Error(dn(200));return Eee(e,t,null,n)};Ta.createRoot=function(e,t){if(!d3(e))throw Error(dn(299));var n=!1,r="",i=j$;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=c3(e,1,!1,null,null,n,!1,r,i),e[iu]=t.current,Vy(e.nodeType===8?e.parentNode:e),new h3(t)};Ta.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(dn(188)):(e=Object.keys(e).join(","),Error(dn(268,e)));return e=hU(t),e=e===null?null:e.stateNode,e};Ta.flushSync=function(e){return Tf(e)};Ta.hydrate=function(e,t,n){if(!gM(t))throw Error(dn(200));return vM(null,e,t,!0,n)};Ta.hydrateRoot=function(e,t,n){if(!d3(e))throw Error(dn(405));var r=n!=null&&n.hydratedSources||null,i=!1,a="",c=j$;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),t=V$(t,null,e,1,n??null,i,!1,a,c),e[iu]=t.current,Vy(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new mM(t)};Ta.render=function(e,t,n){if(!gM(t))throw Error(dn(200));return vM(null,e,t,!1,n)};Ta.unmountComponentAtNode=function(e){if(!gM(e))throw Error(dn(40));return e._reactRootContainer?(Tf(function(){vM(null,null,e,!1,function(){e._reactRootContainer=null,e[iu]=null})}),!0):!1};Ta.unstable_batchedUpdates=o3;Ta.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!gM(n))throw Error(dn(200));if(e==null||e._reactInternals===void 0)throw Error(dn(38));return vM(e,t,n,!1,r)};Ta.version="18.3.1-next-f1338f8080-20240426";function H$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H$)}catch(e){console.error(e)}}H$(),H6.exports=Ta;var A_=H6.exports;function Iee(e){return typeof e=="function"?e():e}const G$=$.forwardRef(function(t,n){const{children:r,container:i,disablePortal:a=!1}=t,[c,s]=$.useState(null),f=Br($.isValidElement(r)?JS(r):null,n);if(tu(()=>{a||s(Iee(i)||document.body)},[i,a]),tu(()=>{if(c&&!a)return xw(n,c),()=>{xw(n,null)}},[n,c,a]),a){if($.isValidElement(r)){const g={ref:f};return $.cloneElement(r,g)}return te.jsx($.Fragment,{children:r})}return te.jsx($.Fragment,{children:c&&A_.createPortal(r,c)})});function Ree(e={}){const{disabled:t=!1,focusableWhenDisabled:n,rootRef:r}=e,i=$.useContext(QS);if(i===null)throw new Error("useMenuButton: no menu context available.");const{state:a,dispatch:c,registerTrigger:s,popupId:f}=i,{getRootProps:g,rootRef:_,active:x}=_c({disabled:t,focusableWhenDisabled:n,rootRef:r}),C=Br(_,s),E=T=>O=>{var D;(D=T.onClick)==null||D.call(T,O),!O.defaultMuiPrevented&&c({type:Sl.toggle,event:O})},A=T=>O=>{var D;(D=T.onKeyDown)==null||D.call(T,O),!O.defaultMuiPrevented&&(O.key==="ArrowDown"||O.key==="ArrowUp")&&(O.preventDefault(),c({type:Sl.open,event:O}))},L=(T={})=>({onClick:E(T),onKeyDown:A(T)});return{active:x,getRootProps:(T={})=>{const O=uo(T),D=nu(L,g);return ue({"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":f},T,O,D(O),{tabIndex:0,ref:C})},open:a.open,rootRef:C}}function Lee(e){return`menu-item-${e.size}`}const kee={dispatch:()=>{},popupId:"",registerPopup:()=>{},registerTrigger:()=>{},state:{open:!0,changeReason:null},triggerElement:null};function Dee(e){var t;const{disabled:n=!1,id:r,rootRef:i,label:a,disableFocusOnHover:c=!1}=e,s=Gs(r),f=$.useRef(null),g=$.useMemo(()=>({disabled:n,id:s??"",label:a,ref:f}),[n,s,a]),{dispatch:_}=(t=$.useContext(QS))!=null?t:kee,{getRootProps:x,highlighted:C}=wR({item:s,handlePointerOverEvents:!c}),{index:E,totalItemCount:A}=nM(s??Lee,g),{getRootProps:L,focusVisible:I,rootRef:T}=_c({disabled:n,focusableWhenDisabled:!0}),O=Br(T,i,f);$.useDebugValue({id:s,highlighted:C,disabled:n,label:a});const D=V=>q=>{var Q;(Q=V.onClick)==null||Q.call(V,q),!q.defaultMuiPrevented&&_({type:Sl.close,event:q})},U=(V={})=>ue({},V,{onClick:D(V)});function H(V={}){const q=uo(V),Q=nu(U,nu(L,x));return ue({},V,q,Q(q),{id:s,ref:O,role:"menuitem"})}return s===void 0?{getRootProps:H,disabled:!1,focusVisible:I,highlighted:!1,index:-1,totalItemCount:0,rootRef:O}:{getRootProps:H,disabled:n,focusVisible:I,highlighted:C,index:E,totalItemCount:A,rootRef:O}}function zee(e){const t=$.useContext(qh);if(!t)throw new Error("MenuItem: ListContext was not found.");const n=Gs(e),{getItemState:r,dispatch:i}=t;let a;n!=null?a=r(n):a={focusable:!0,highlighted:!1,selected:!1};const{highlighted:c,selected:s,focusable:f}=a,g=$.useCallback(x=>{if(x!==n)throw new Error(["Base UI MenuItem: Tried to access the state of another MenuItem.",`itemValue: ${x} | id: ${n}`,"This is unsupported when the MenuItem uses the MenuItemContextStabilizer as a performance optimization."].join("/n"));return{highlighted:c,selected:s,focusable:f}},[c,s,f,n]);return{contextValue:$.useMemo(()=>({dispatch:i,getItemState:g}),[i,g]),id:n}}function Oee(e){const t=xa(e);return t.body===e?fR(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function ry(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function xO(e){return parseInt(fR(e).getComputedStyle(e).paddingRight,10)||0}function Fee(e){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName)!==-1,r=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return n||r}function bO(e,t,n,r,i){const a=[t,n,...r];[].forEach.call(e.children,c=>{const s=a.indexOf(c)===-1,f=!Fee(c);s&&f&&ry(c,i)})}function dE(e,t){let n=-1;return e.some((r,i)=>t(r)?(n=i,!0):!1),n}function Nee(e,t){const n=[],r=e.container;if(!t.disableScrollLock){if(Oee(r)){const c=WY(xa(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${xO(r)+c}px`;const s=xa(r).querySelectorAll(".mui-fixed");[].forEach.call(s,f=>{n.push({value:f.style.paddingRight,property:"padding-right",el:f}),f.style.paddingRight=`${xO(f)+c}px`})}let a;if(r.parentNode instanceof DocumentFragment)a=xa(r).body;else{const c=r.parentElement,s=fR(r);a=(c==null?void 0:c.nodeName)==="HTML"&&s.getComputedStyle(c).overflowY==="scroll"?c:r}n.push({value:a.style.overflow,property:"overflow",el:a},{value:a.style.overflowX,property:"overflow-x",el:a},{value:a.style.overflowY,property:"overflow-y",el:a}),a.style.overflow="hidden"}return()=>{n.forEach(({value:a,el:c,property:s})=>{a?c.style.setProperty(s,a):c.style.removeProperty(s)})}}function Bee(e){const t=[];return[].forEach.call(e.children,n=>{n.getAttribute("aria-hidden")==="true"&&t.push(n)}),t}class Uee{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(t,n){let r=this.modals.indexOf(t);if(r!==-1)return r;r=this.modals.length,this.modals.push(t),t.modalRef&&ry(t.modalRef,!1);const i=Bee(n);bO(n,t.mount,t.modalRef,i,!0);const a=dE(this.containers,c=>c.container===n);return a!==-1?(this.containers[a].modals.push(t),r):(this.containers.push({modals:[t],container:n,restore:null,hiddenSiblings:i}),r)}mount(t,n){const r=dE(this.containers,a=>a.modals.indexOf(t)!==-1),i=this.containers[r];i.restore||(i.restore=Nee(i,n))}remove(t,n=!0){const r=this.modals.indexOf(t);if(r===-1)return r;const i=dE(this.containers,c=>c.modals.indexOf(t)!==-1),a=this.containers[i];if(a.modals.splice(a.modals.indexOf(t),1),this.modals.splice(r,1),a.modals.length===0)a.restore&&a.restore(),t.modalRef&&ry(t.modalRef,n),bO(a.container,t.mount,t.modalRef,a.hiddenSiblings,!1),this.containers.splice(i,1);else{const c=a.modals[a.modals.length-1];c.modalRef&&ry(c.modalRef,!1)}return r}isTopModal(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}function $ee(e){return typeof e=="function"?e():e}function Vee(e){return e?e.props.hasOwnProperty("in"):!1}const jee=new Uee;function Hee(e){const{container:t,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:i=jee,closeAfterTransition:a=!1,onTransitionEnter:c,onTransitionExited:s,children:f,onClose:g,open:_,rootRef:x}=e,C=$.useRef({}),E=$.useRef(null),A=$.useRef(null),L=Br(A,x),[I,T]=$.useState(!_),O=Vee(f);let D=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(D=!1);const U=()=>xa(E.current),H=()=>(C.current.modalRef=A.current,C.current.mount=E.current,C.current),V=()=>{i.mount(H(),{disableScrollLock:r}),A.current&&(A.current.scrollTop=0)},q=Cl(()=>{const ve=$ee(t)||U().body;i.add(H(),ve),A.current&&V()}),Q=$.useCallback(()=>i.isTopModal(H()),[i]),K=Cl(ve=>{E.current=ve,ve&&(_&&Q()?V():A.current&&ry(A.current,D))}),N=$.useCallback(()=>{i.remove(H(),D)},[D,i]);$.useEffect(()=>()=>{N()},[N]),$.useEffect(()=>{_?q():(!O||!a)&&N()},[_,N,O,a,q]);const re=ve=>Se=>{var Me;(Me=ve.onKeyDown)==null||Me.call(ve,Se),!(Se.key!=="Escape"||Se.which===229||!Q())&&(n||(Se.stopPropagation(),g&&g(Se,"escapeKeyDown")))},ye=ve=>Se=>{var Me;(Me=ve.onClick)==null||Me.call(ve,Se),Se.target===Se.currentTarget&&g&&g(Se,"backdropClick")};return{getRootProps:(ve={})=>{const Se=uo(e);delete Se.onTransitionEnter,delete Se.onTransitionExited;const Me=ue({},Se,ve);return ue({role:"presentation"},Me,{onKeyDown:re(Me),ref:L})},getBackdropProps:(ve={})=>{const Se=ve;return ue({"aria-hidden":!0},Se,{onClick:ye(Se),open:_})},getTransitionProps:()=>{const ve=()=>{T(!1),c&&c()},Se=()=>{T(!0),s&&s(),a&&N()};return{onEnter:ez(ve,f==null?void 0:f.props.onEnter),onExited:ez(Se,f==null?void 0:f.props.onExited)}},rootRef:L,portalRef:K,isTopModal:Q,exited:I,hasTransition:O}}function Gee(e){const{value:t,label:n,disabled:r,rootRef:i,id:a}=e,{getRootProps:c,highlighted:s,selected:f}=wR({item:t}),{getRootProps:g,rootRef:_}=_c({disabled:r,focusableWhenDisabled:!0}),x=Gs(a),C=$.useRef(null),E=$.useMemo(()=>({disabled:r,label:n,value:t,ref:C,id:x}),[r,n,t,x]),{index:A}=nM(t,E),L=Br(i,C,_),I=O=>D=>{var U;(U=O.onKeyDown)==null||U.call(O,D),!D.defaultMuiPrevented&&[" ","Enter"].includes(D.key)&&(D.defaultMuiPrevented=!0)},T=(O={})=>({onKeyDown:I(O)});return{getRootProps:(O={})=>{const D=uo(O),U=nu(c,nu(g,T));return ue({},O,D,U(D),{id:x,ref:L,role:"option","aria-selected":f})},highlighted:s,index:A,selected:f,rootRef:L}}function Wee(e){const t=$.useContext(qh);if(!t)throw new Error("Option: ListContext was not found.");const{getItemState:n,dispatch:r}=t,{highlighted:i,selected:a,focusable:c}=n(e),s=$.useCallback(g=>{if(g!==e)throw new Error(["Base UI Option: Tried to access the state of another Option.","This is unsupported when the Option uses the OptionContextStabilizer as a performance optimization."].join("/n"));return{highlighted:i,selected:a,focusable:c}},[i,a,c,e]);return{contextValue:$.useMemo(()=>({dispatch:r,getItemState:s}),[r,s])}}var Us="top",Za="bottom",Ya="right",$s="left",f3="auto",I_=[Us,Za,Ya,$s],fg="start",Ky="end",qee="clippingParents",W$="viewport",u0="popper",Xee="reference",wO=I_.reduce(function(e,t){return e.concat([t+"-"+fg,t+"-"+Ky])},[]),q$=[].concat(I_,[f3]).reduce(function(e,t){return e.concat([t,t+"-"+fg,t+"-"+Ky])},[]),Zee="beforeRead",Yee="read",Kee="afterRead",Jee="beforeMain",Qee="main",ete="afterMain",tte="beforeWrite",nte="write",rte="afterWrite",ite=[Zee,Yee,Kee,Jee,Qee,ete,tte,nte,rte];function gc(e){return e?(e.nodeName||"").toLowerCase():null}function Ca(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Pf(e){var t=Ca(e).Element;return e instanceof t||e instanceof Element}function Wa(e){var t=Ca(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function p3(e){if(typeof ShadowRoot>"u")return!1;var t=Ca(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function ote(e){var t=e.state;Object.keys(t.elements).forEach(function(n){var r=t.styles[n]||{},i=t.attributes[n]||{},a=t.elements[n];!Wa(a)||!gc(a)||(Object.assign(a.style,r),Object.keys(i).forEach(function(c){var s=i[c];s===!1?a.removeAttribute(c):a.setAttribute(c,s===!0?"":s)}))})}function ste(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(r){var i=t.elements[r],a=t.attributes[r]||{},c=Object.keys(t.styles.hasOwnProperty(r)?t.styles[r]:n[r]),s=c.reduce(function(f,g){return f[g]="",f},{});!Wa(i)||!gc(i)||(Object.assign(i.style,s),Object.keys(a).forEach(function(f){i.removeAttribute(f)}))})}}const ate={name:"applyStyles",enabled:!0,phase:"write",fn:ote,effect:ste,requires:["computeStyles"]};function dc(e){return e.split("-")[0]}var yf=Math.max,Gw=Math.min,pg=Math.round;function aA(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function X$(){return!/^((?!chrome|android).)*safari/i.test(aA())}function mg(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var r=e.getBoundingClientRect(),i=1,a=1;t&&Wa(e)&&(i=e.offsetWidth>0&&pg(r.width)/e.offsetWidth||1,a=e.offsetHeight>0&&pg(r.height)/e.offsetHeight||1);var c=Pf(e)?Ca(e):window,s=c.visualViewport,f=!X$()&&n,g=(r.left+(f&&s?s.offsetLeft:0))/i,_=(r.top+(f&&s?s.offsetTop:0))/a,x=r.width/i,C=r.height/a;return{width:x,height:C,top:_,right:g+x,bottom:_+C,left:g,x:g,y:_}}function m3(e){var t=mg(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Z$(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&p3(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function au(e){return Ca(e).getComputedStyle(e)}function lte(e){return["table","td","th"].indexOf(gc(e))>=0}function Kh(e){return((Pf(e)?e.ownerDocument:e.document)||window.document).documentElement}function yM(e){return gc(e)==="html"?e:e.assignedSlot||e.parentNode||(p3(e)?e.host:null)||Kh(e)}function SO(e){return!Wa(e)||au(e).position==="fixed"?null:e.offsetParent}function cte(e){var t=/firefox/i.test(aA()),n=/Trident/i.test(aA());if(n&&Wa(e)){var r=au(e);if(r.position==="fixed")return null}var i=yM(e);for(p3(i)&&(i=i.host);Wa(i)&&["html","body"].indexOf(gc(i))<0;){var a=au(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||t&&a.willChange==="filter"||t&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function R_(e){for(var t=Ca(e),n=SO(e);n&&lte(n)&&au(n).position==="static";)n=SO(n);return n&&(gc(n)==="html"||gc(n)==="body"&&au(n).position==="static")?t:n||cte(e)||t}function g3(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function iy(e,t,n){return yf(e,Gw(t,n))}function ute(e,t,n){var r=iy(e,t,n);return r>n?n:r}function Y$(){return{top:0,right:0,bottom:0,left:0}}function K$(e){return Object.assign({},Y$(),e)}function J$(e,t){return t.reduce(function(n,r){return n[r]=e,n},{})}var hte=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,K$(typeof t!="number"?t:J$(t,I_))};function dte(e){var t,n=e.state,r=e.name,i=e.options,a=n.elements.arrow,c=n.modifiersData.popperOffsets,s=dc(n.placement),f=g3(s),g=[$s,Ya].indexOf(s)>=0,_=g?"height":"width";if(!(!a||!c)){var x=hte(i.padding,n),C=m3(a),E=f==="y"?Us:$s,A=f==="y"?Za:Ya,L=n.rects.reference[_]+n.rects.reference[f]-c[f]-n.rects.popper[_],I=c[f]-n.rects.reference[f],T=R_(a),O=T?f==="y"?T.clientHeight||0:T.clientWidth||0:0,D=L/2-I/2,U=x[E],H=O-C[_]-x[A],V=O/2-C[_]/2+D,q=iy(U,V,H),Q=f;n.modifiersData[r]=(t={},t[Q]=q,t.centerOffset=q-V,t)}}function fte(e){var t=e.state,n=e.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=t.elements.popper.querySelector(i),!i)||Z$(t.elements.popper,i)&&(t.elements.arrow=i))}const pte={name:"arrow",enabled:!0,phase:"main",fn:dte,effect:fte,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function gg(e){return e.split("-")[1]}var mte={top:"auto",right:"auto",bottom:"auto",left:"auto"};function gte(e,t){var n=e.x,r=e.y,i=t.devicePixelRatio||1;return{x:pg(n*i)/i||0,y:pg(r*i)/i||0}}function MO(e){var t,n=e.popper,r=e.popperRect,i=e.placement,a=e.variation,c=e.offsets,s=e.position,f=e.gpuAcceleration,g=e.adaptive,_=e.roundOffsets,x=e.isFixed,C=c.x,E=C===void 0?0:C,A=c.y,L=A===void 0?0:A,I=typeof _=="function"?_({x:E,y:L}):{x:E,y:L};E=I.x,L=I.y;var T=c.hasOwnProperty("x"),O=c.hasOwnProperty("y"),D=$s,U=Us,H=window;if(g){var V=R_(n),q="clientHeight",Q="clientWidth";if(V===Ca(n)&&(V=Kh(n),au(V).position!=="static"&&s==="absolute"&&(q="scrollHeight",Q="scrollWidth")),V=V,i===Us||(i===$s||i===Ya)&&a===Ky){U=Za;var K=x&&V===H&&H.visualViewport?H.visualViewport.height:V[q];L-=K-r.height,L*=f?1:-1}if(i===$s||(i===Us||i===Za)&&a===Ky){D=Ya;var N=x&&V===H&&H.visualViewport?H.visualViewport.width:V[Q];E-=N-r.width,E*=f?1:-1}}var re=Object.assign({position:s},g&&mte),ye=_===!0?gte({x:E,y:L},Ca(n)):{x:E,y:L};if(E=ye.x,L=ye.y,f){var ge;return Object.assign({},re,(ge={},ge[U]=O?"0":"",ge[D]=T?"0":"",ge.transform=(H.devicePixelRatio||1)<=1?"translate("+E+"px, "+L+"px)":"translate3d("+E+"px, "+L+"px, 0)",ge))}return Object.assign({},re,(t={},t[U]=O?L+"px":"",t[D]=T?E+"px":"",t.transform="",t))}function vte(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=r===void 0?!0:r,a=n.adaptive,c=a===void 0?!0:a,s=n.roundOffsets,f=s===void 0?!0:s,g={placement:dc(t.placement),variation:gg(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,MO(Object.assign({},g,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:c,roundOffsets:f})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,MO(Object.assign({},g,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const yte={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:vte,data:{}};var F1={passive:!0};function _te(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,a=i===void 0?!0:i,c=r.resize,s=c===void 0?!0:c,f=Ca(t.elements.popper),g=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&g.forEach(function(_){_.addEventListener("scroll",n.update,F1)}),s&&f.addEventListener("resize",n.update,F1),function(){a&&g.forEach(function(_){_.removeEventListener("scroll",n.update,F1)}),s&&f.removeEventListener("resize",n.update,F1)}}const xte={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:_te,data:{}};var bte={left:"right",right:"left",bottom:"top",top:"bottom"};function Hb(e){return e.replace(/left|right|bottom|top/g,function(t){return bte[t]})}var wte={start:"end",end:"start"};function CO(e){return e.replace(/start|end/g,function(t){return wte[t]})}function v3(e){var t=Ca(e),n=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:n,scrollTop:r}}function y3(e){return mg(Kh(e)).left+v3(e).scrollLeft}function Ste(e,t){var n=Ca(e),r=Kh(e),i=n.visualViewport,a=r.clientWidth,c=r.clientHeight,s=0,f=0;if(i){a=i.width,c=i.height;var g=X$();(g||!g&&t==="fixed")&&(s=i.offsetLeft,f=i.offsetTop)}return{width:a,height:c,x:s+y3(e),y:f}}function Mte(e){var t,n=Kh(e),r=v3(e),i=(t=e.ownerDocument)==null?void 0:t.body,a=yf(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=yf(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-r.scrollLeft+y3(e),f=-r.scrollTop;return au(i||n).direction==="rtl"&&(s+=yf(n.clientWidth,i?i.clientWidth:0)-a),{width:a,height:c,x:s,y:f}}function _3(e){var t=au(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function Q$(e){return["html","body","#document"].indexOf(gc(e))>=0?e.ownerDocument.body:Wa(e)&&_3(e)?e:Q$(yM(e))}function oy(e,t){var n;t===void 0&&(t=[]);var r=Q$(e),i=r===((n=e.ownerDocument)==null?void 0:n.body),a=Ca(r),c=i?[a].concat(a.visualViewport||[],_3(r)?r:[]):r,s=t.concat(c);return i?s:s.concat(oy(yM(c)))}function lA(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function Cte(e,t){var n=mg(e,!1,t==="fixed");return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function EO(e,t,n){return t===W$?lA(Ste(e,n)):Pf(t)?Cte(t,n):lA(Mte(Kh(e)))}function Ete(e){var t=oy(yM(e)),n=["absolute","fixed"].indexOf(au(e).position)>=0,r=n&&Wa(e)?R_(e):e;return Pf(r)?t.filter(function(i){return Pf(i)&&Z$(i,r)&&gc(i)!=="body"}):[]}function Tte(e,t,n,r){var i=t==="clippingParents"?Ete(e):[].concat(t),a=[].concat(i,[n]),c=a[0],s=a.reduce(function(f,g){var _=EO(e,g,r);return f.top=yf(_.top,f.top),f.right=Gw(_.right,f.right),f.bottom=Gw(_.bottom,f.bottom),f.left=yf(_.left,f.left),f},EO(e,c,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function e8(e){var t=e.reference,n=e.element,r=e.placement,i=r?dc(r):null,a=r?gg(r):null,c=t.x+t.width/2-n.width/2,s=t.y+t.height/2-n.height/2,f;switch(i){case Us:f={x:c,y:t.y-n.height};break;case Za:f={x:c,y:t.y+t.height};break;case Ya:f={x:t.x+t.width,y:s};break;case $s:f={x:t.x-n.width,y:s};break;default:f={x:t.x,y:t.y}}var g=i?g3(i):null;if(g!=null){var _=g==="y"?"height":"width";switch(a){case fg:f[g]=f[g]-(t[_]/2-n[_]/2);break;case Ky:f[g]=f[g]+(t[_]/2-n[_]/2);break}}return f}function Jy(e,t){t===void 0&&(t={});var n=t,r=n.placement,i=r===void 0?e.placement:r,a=n.strategy,c=a===void 0?e.strategy:a,s=n.boundary,f=s===void 0?qee:s,g=n.rootBoundary,_=g===void 0?W$:g,x=n.elementContext,C=x===void 0?u0:x,E=n.altBoundary,A=E===void 0?!1:E,L=n.padding,I=L===void 0?0:L,T=K$(typeof I!="number"?I:J$(I,I_)),O=C===u0?Xee:u0,D=e.rects.popper,U=e.elements[A?O:C],H=Tte(Pf(U)?U:U.contextElement||Kh(e.elements.popper),f,_,c),V=mg(e.elements.reference),q=e8({reference:V,element:D,strategy:"absolute",placement:i}),Q=lA(Object.assign({},D,q)),K=C===u0?Q:V,N={top:H.top-K.top+T.top,bottom:K.bottom-H.bottom+T.bottom,left:H.left-K.left+T.left,right:K.right-H.right+T.right},re=e.modifiersData.offset;if(C===u0&&re){var ye=re[i];Object.keys(N).forEach(function(ge){var Ve=[Ya,Za].indexOf(ge)>=0?1:-1,Ie=[Us,Za].indexOf(ge)>=0?"y":"x";N[ge]+=ye[Ie]*Ve})}return N}function Pte(e,t){t===void 0&&(t={});var n=t,r=n.placement,i=n.boundary,a=n.rootBoundary,c=n.padding,s=n.flipVariations,f=n.allowedAutoPlacements,g=f===void 0?q$:f,_=gg(r),x=_?s?wO:wO.filter(function(A){return gg(A)===_}):I_,C=x.filter(function(A){return g.indexOf(A)>=0});C.length===0&&(C=x);var E=C.reduce(function(A,L){return A[L]=Jy(e,{placement:L,boundary:i,rootBoundary:a,padding:c})[dc(L)],A},{});return Object.keys(E).sort(function(A,L){return E[A]-E[L]})}function Ate(e){if(dc(e)===f3)return[];var t=Hb(e);return[CO(e),t,CO(t)]}function Ite(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,a=i===void 0?!0:i,c=n.altAxis,s=c===void 0?!0:c,f=n.fallbackPlacements,g=n.padding,_=n.boundary,x=n.rootBoundary,C=n.altBoundary,E=n.flipVariations,A=E===void 0?!0:E,L=n.allowedAutoPlacements,I=t.options.placement,T=dc(I),O=T===I,D=f||(O||!A?[Hb(I)]:Ate(I)),U=[I].concat(D).reduce(function(je,lt){return je.concat(dc(lt)===f3?Pte(t,{placement:lt,boundary:_,rootBoundary:x,padding:g,flipVariations:A,allowedAutoPlacements:L}):lt)},[]),H=t.rects.reference,V=t.rects.popper,q=new Map,Q=!0,K=U[0],N=0;N<U.length;N++){var re=U[N],ye=dc(re),ge=gg(re)===fg,Ve=[Us,Za].indexOf(ye)>=0,Ie=Ve?"width":"height",ve=Jy(t,{placement:re,boundary:_,rootBoundary:x,altBoundary:C,padding:g}),Se=Ve?ge?Ya:$s:ge?Za:Us;H[Ie]>V[Ie]&&(Se=Hb(Se));var Me=Hb(Se),Be=[];if(a&&Be.push(ve[ye]<=0),s&&Be.push(ve[Se]<=0,ve[Me]<=0),Be.every(function(je){return je})){K=re,Q=!1;break}q.set(re,Be)}if(Q)for(var Qe=A?3:1,st=function(lt){var Ot=U.find(function(ut){var ot=q.get(ut);if(ot)return ot.slice(0,lt).every(function(Tt){return Tt})});if(Ot)return K=Ot,"break"},ct=Qe;ct>0;ct--){var Xt=st(ct);if(Xt==="break")break}t.placement!==K&&(t.modifiersData[r]._skip=!0,t.placement=K,t.reset=!0)}}const Rte={name:"flip",enabled:!0,phase:"main",fn:Ite,requiresIfExists:["offset"],data:{_skip:!1}};function TO(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function PO(e){return[Us,Ya,Za,$s].some(function(t){return e[t]>=0})}function Lte(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,a=t.modifiersData.preventOverflow,c=Jy(t,{elementContext:"reference"}),s=Jy(t,{altBoundary:!0}),f=TO(c,r),g=TO(s,i,a),_=PO(f),x=PO(g);t.modifiersData[n]={referenceClippingOffsets:f,popperEscapeOffsets:g,isReferenceHidden:_,hasPopperEscaped:x},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":_,"data-popper-escaped":x})}const kte={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Lte};function Dte(e,t,n){var r=dc(e),i=[$s,Us].indexOf(r)>=0?-1:1,a=typeof n=="function"?n(Object.assign({},t,{placement:e})):n,c=a[0],s=a[1];return c=c||0,s=(s||0)*i,[$s,Ya].indexOf(r)>=0?{x:s,y:c}:{x:c,y:s}}function zte(e){var t=e.state,n=e.options,r=e.name,i=n.offset,a=i===void 0?[0,0]:i,c=q$.reduce(function(_,x){return _[x]=Dte(x,t.rects,a),_},{}),s=c[t.placement],f=s.x,g=s.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=f,t.modifiersData.popperOffsets.y+=g),t.modifiersData[r]=c}const Ote={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:zte};function Fte(e){var t=e.state,n=e.name;t.modifiersData[n]=e8({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}const Nte={name:"popperOffsets",enabled:!0,phase:"read",fn:Fte,data:{}};function Bte(e){return e==="x"?"y":"x"}function Ute(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,a=i===void 0?!0:i,c=n.altAxis,s=c===void 0?!1:c,f=n.boundary,g=n.rootBoundary,_=n.altBoundary,x=n.padding,C=n.tether,E=C===void 0?!0:C,A=n.tetherOffset,L=A===void 0?0:A,I=Jy(t,{boundary:f,rootBoundary:g,padding:x,altBoundary:_}),T=dc(t.placement),O=gg(t.placement),D=!O,U=g3(T),H=Bte(U),V=t.modifiersData.popperOffsets,q=t.rects.reference,Q=t.rects.popper,K=typeof L=="function"?L(Object.assign({},t.rects,{placement:t.placement})):L,N=typeof K=="number"?{mainAxis:K,altAxis:K}:Object.assign({mainAxis:0,altAxis:0},K),re=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,ye={x:0,y:0};if(V){if(a){var ge,Ve=U==="y"?Us:$s,Ie=U==="y"?Za:Ya,ve=U==="y"?"height":"width",Se=V[U],Me=Se+I[Ve],Be=Se-I[Ie],Qe=E?-Q[ve]/2:0,st=O===fg?q[ve]:Q[ve],ct=O===fg?-Q[ve]:-q[ve],Xt=t.elements.arrow,je=E&&Xt?m3(Xt):{width:0,height:0},lt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Y$(),Ot=lt[Ve],ut=lt[Ie],ot=iy(0,q[ve],je[ve]),Tt=D?q[ve]/2-Qe-ot-Ot-N.mainAxis:st-ot-Ot-N.mainAxis,Ct=D?-q[ve]/2+Qe+ot+ut+N.mainAxis:ct+ot+ut+N.mainAxis,un=t.elements.arrow&&R_(t.elements.arrow),gn=un?U==="y"?un.clientTop||0:un.clientLeft||0:0,hn=(ge=re==null?void 0:re[U])!=null?ge:0,We=Se+Tt-hn-gn,vn=Se+Ct-hn,Ut=iy(E?Gw(Me,We):Me,Se,E?yf(Be,vn):Be);V[U]=Ut,ye[U]=Ut-Se}if(s){var tn,Dt=U==="x"?Us:$s,An=U==="x"?Za:Ya,an=V[H],Le=H==="y"?"height":"width",me=an+I[Dt],it=an-I[An],St=[Us,$s].indexOf(T)!==-1,It=(tn=re==null?void 0:re[H])!=null?tn:0,wt=St?me:an-q[Le]-Q[Le]-It+N.altAxis,Zt=St?an+q[Le]+Q[Le]-It-N.altAxis:it,Lt=E&&St?ute(wt,an,Zt):iy(E?wt:me,an,E?Zt:it);V[H]=Lt,ye[H]=Lt-an}t.modifiersData[r]=ye}}const $te={name:"preventOverflow",enabled:!0,phase:"main",fn:Ute,requiresIfExists:["offset"]};function Vte(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function jte(e){return e===Ca(e)||!Wa(e)?v3(e):Vte(e)}function Hte(e){var t=e.getBoundingClientRect(),n=pg(t.width)/e.offsetWidth||1,r=pg(t.height)/e.offsetHeight||1;return n!==1||r!==1}function Gte(e,t,n){n===void 0&&(n=!1);var r=Wa(t),i=Wa(t)&&Hte(t),a=Kh(t),c=mg(e,i,n),s={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(r||!r&&!n)&&((gc(t)!=="body"||_3(a))&&(s=jte(t)),Wa(t)?(f=mg(t,!0),f.x+=t.clientLeft,f.y+=t.clientTop):a&&(f.x=y3(a))),{x:c.left+s.scrollLeft-f.x,y:c.top+s.scrollTop-f.y,width:c.width,height:c.height}}function Wte(e){var t=new Map,n=new Set,r=[];e.forEach(function(a){t.set(a.name,a)});function i(a){n.add(a.name);var c=[].concat(a.requires||[],a.requiresIfExists||[]);c.forEach(function(s){if(!n.has(s)){var f=t.get(s);f&&i(f)}}),r.push(a)}return e.forEach(function(a){n.has(a.name)||i(a)}),r}function qte(e){var t=Wte(e);return ite.reduce(function(n,r){return n.concat(t.filter(function(i){return i.phase===r}))},[])}function Xte(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}function Zte(e){var t=e.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(t).map(function(n){return t[n]})}var AO={placement:"bottom",modifiers:[],strategy:"absolute"};function IO(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Yte(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,r=n===void 0?[]:n,i=t.defaultOptions,a=i===void 0?AO:i;return function(s,f,g){g===void 0&&(g=a);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},AO,a),modifiersData:{},elements:{reference:s,popper:f},attributes:{},styles:{}},x=[],C=!1,E={state:_,setOptions:function(T){var O=typeof T=="function"?T(_.options):T;L(),_.options=Object.assign({},a,_.options,O),_.scrollParents={reference:Pf(s)?oy(s):s.contextElement?oy(s.contextElement):[],popper:oy(f)};var D=qte(Zte([].concat(r,_.options.modifiers)));return _.orderedModifiers=D.filter(function(U){return U.enabled}),A(),E.update()},forceUpdate:function(){if(!C){var T=_.elements,O=T.reference,D=T.popper;if(IO(O,D)){_.rects={reference:Gte(O,R_(D),_.options.strategy==="fixed"),popper:m3(D)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(N){return _.modifiersData[N.name]=Object.assign({},N.data)});for(var U=0;U<_.orderedModifiers.length;U++){if(_.reset===!0){_.reset=!1,U=-1;continue}var H=_.orderedModifiers[U],V=H.fn,q=H.options,Q=q===void 0?{}:q,K=H.name;typeof V=="function"&&(_=V({state:_,options:Q,name:K,instance:E})||_)}}}},update:Xte(function(){return new Promise(function(I){E.forceUpdate(),I(_)})}),destroy:function(){L(),C=!0}};if(!IO(s,f))return E;E.setOptions(g).then(function(I){!C&&g.onFirstUpdate&&g.onFirstUpdate(I)});function A(){_.orderedModifiers.forEach(function(I){var T=I.name,O=I.options,D=O===void 0?{}:O,U=I.effect;if(typeof U=="function"){var H=U({state:_,name:T,instance:E,options:D}),V=function(){};x.push(H||V)}})}function L(){x.forEach(function(I){return I()}),x=[]}return E}}var Kte=[xte,Nte,yte,ate,Ote,Rte,$te,pte,kte],Jte=Yte({defaultModifiers:Kte});const t8="Popper";function Qte(e){return V6(t8,e)}$K(t8,["root"]);const ene=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],tne=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function nne(e,t){if(t==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function cA(e){return typeof e=="function"?e():e}function rne(e){return e.nodeType!==void 0}const ine=()=>vr({root:["root"]},FK(Qte)),one={},sne=$.forwardRef(function(t,n){var r;const{anchorEl:i,children:a,direction:c,disablePortal:s,modifiers:f,open:g,placement:_,popperOptions:x,popperRef:C,slotProps:E={},slots:A={},TransitionProps:L}=t,I=Un(t,ene),T=$.useRef(null),O=Br(T,n),D=$.useRef(null),U=Br(D,C),H=$.useRef(U);tu(()=>{H.current=U},[U]),$.useImperativeHandle(C,()=>D.current,[]);const V=nne(_,c),[q,Q]=$.useState(V),[K,N]=$.useState(cA(i));$.useEffect(()=>{D.current&&D.current.forceUpdate()}),$.useEffect(()=>{i&&N(cA(i))},[i]),tu(()=>{if(!K||!g)return;const Ie=Me=>{Q(Me.placement)};let ve=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Me})=>{Ie(Me)}}];f!=null&&(ve=ve.concat(f)),x&&x.modifiers!=null&&(ve=ve.concat(x.modifiers));const Se=Jte(K,T.current,ue({placement:V},x,{modifiers:ve}));return H.current(Se),()=>{Se.destroy(),H.current(null)}},[K,s,f,g,x,V]);const re={placement:q};L!==null&&(re.TransitionProps=L);const ye=ine(),ge=(r=A.root)!=null?r:"div",Ve=O6({elementType:ge,externalSlotProps:E.root,externalForwardedProps:I,additionalProps:{role:"tooltip",ref:O},ownerState:t,className:ye.root});return te.jsx(ge,ue({},Ve,{children:typeof a=="function"?a(re):a}))}),_M=$.forwardRef(function(t,n){const{anchorEl:r,children:i,container:a,direction:c="ltr",disablePortal:s=!1,keepMounted:f=!1,modifiers:g,open:_,placement:x="bottom",popperOptions:C=one,popperRef:E,style:A,transition:L=!1,slotProps:I={},slots:T={}}=t,O=Un(t,tne),[D,U]=$.useState(!0),H=()=>{U(!1)},V=()=>{U(!0)};if(!f&&!_&&(!L||D))return null;let q;if(a)q=a;else if(r){const N=cA(r);q=N&&rne(N)?xa(N).body:xa(null).body}const Q=!_&&f&&(!L||D)?"none":void 0,K=L?{in:_,onEnter:H,onExited:V}:void 0;return te.jsx(G$,{disablePortal:s,container:q,children:te.jsx(sne,ue({anchorEl:r,direction:c,disablePortal:s,modifiers:g,ref:n,open:L?!D:_,placement:x,popperOptions:C,popperRef:E,slotProps:I,slots:T},O,{style:ue({position:"fixed",top:0,left:0,display:Q},A),TransitionProps:K,children:i}))})}),Ww={buttonClick:"buttonClick",browserAutoFill:"browserAutoFill"},ane=e=>{const{label:t,value:n}=e;return typeof t=="string"?t:typeof n=="string"?n:String(e)};function lne(e,t){const{open:n}=e,{context:{selectionMode:r}}=t;if(t.type===Ww.buttonClick){var i;const f=(i=e.selectedValues[0])!=null?i:So(null,"start",t.context);return ue({},e,{open:!n,highlightedValue:n?null:f})}if(t.type===Ww.browserAutoFill)return xR(t.item,e,t.context);const a=eM(e,t);switch(t.type){case qr.keyDown:if(e.open){if(t.event.key==="Escape")return ue({},a,{open:!1})}else{if(t.event.key==="ArrowDown"){var c;return ue({},e,{open:!0,highlightedValue:(c=e.selectedValues[0])!=null?c:So(null,"start",t.context)})}if(t.event.key==="ArrowUp"){var s;return ue({},e,{open:!0,highlightedValue:(s=e.selectedValues[0])!=null?s:So(null,"end",t.context)})}}break;case qr.itemClick:if(r==="single")return ue({},a,{open:!1});break;case qr.blur:return ue({},a,{open:!1});default:return a}return a}function cne(e){return Array.isArray(e)?e.length===0?"":JSON.stringify(e.map(t=>t.value)):(e==null?void 0:e.value)==null?"":typeof e.value=="string"||typeof e.value=="number"?e.value:JSON.stringify(e.value)}function une(e){const{areOptionsEqual:t,buttonRef:n,defaultOpen:r=!1,defaultValue:i,disabled:a=!1,listboxId:c,listboxRef:s,multiple:f=!1,name:g,required:_,onChange:x,onHighlightChange:C,onOpenChange:E,open:A,options:L,getOptionAsString:I=ane,getSerializedValue:T=cne,value:O,componentName:D="useSelect"}=e,U=$.useRef(null),H=Br(n,U),V=$.useRef(null),q=Gs(c);let Q;O===void 0&&i===void 0?Q=[]:i!==void 0&&(f?Q=i:Q=i==null?[]:[i]);const K=$.useMemo(()=>{if(O!==void 0)return f?O:O==null?[]:[O]},[O,f]),{subitems:N,contextValue:re}=tM(),ye=$.useMemo(()=>L!=null?new Map(L.map((_e,ee)=>[_e.value,{value:_e.value,label:_e.label,disabled:_e.disabled,ref:$.createRef(),id:`${q}_${ee}`}])):N,[L,N,q]),ge=Br(s,V),{getRootProps:Ve,active:Ie,focusVisible:ve,rootRef:Se}=_c({disabled:a,rootRef:H}),Me=$.useMemo(()=>Array.from(ye.keys()),[ye]),Be=$.useCallback(_e=>{if(t!==void 0){const ee=Me.find(ne=>t(ne,_e));return ye.get(ee)}return ye.get(_e)},[ye,t,Me]),Qe=$.useCallback(_e=>{var ee;const ne=Be(_e);return(ee=ne==null?void 0:ne.disabled)!=null?ee:!1},[Be]),st=$.useCallback(_e=>{const ee=Be(_e);return ee?I(ee):""},[Be,I]),ct=$.useMemo(()=>({selectedValues:K,open:A}),[K,A]),Xt=$.useCallback(_e=>{var ee;return(ee=ye.get(_e))==null?void 0:ee.id},[ye]),je=$.useCallback((_e,ee)=>{if(f)x==null||x(_e,ee);else{var ne;x==null||x(_e,(ne=ee[0])!=null?ne:null)}},[f,x]),lt=$.useCallback((_e,ee)=>{C==null||C(_e,ee??null)},[C]),Ot=$.useCallback((_e,ee,ne)=>{if(ee==="open"&&(E==null||E(ne),ne===!1&&(_e==null?void 0:_e.type)!=="blur")){var Z;(Z=U.current)==null||Z.focus()}},[E]),ut=$.useCallback(_e=>{var ee,ne;return _e==null?null:(ee=(ne=N.get(_e))==null?void 0:ne.ref.current)!=null?ee:null},[N]),ot={getInitialState:()=>{var _e;return{highlightedValue:null,selectedValues:(_e=Q)!=null?_e:[],open:r}},getItemId:Xt,controlledProps:ct,focusManagement:"DOM",getItemDomElement:ut,itemComparer:t,isItemDisabled:Qe,rootRef:ge,onChange:je,onHighlightChange:lt,onStateChange:Ot,reducerActionContext:$.useMemo(()=>({multiple:f}),[f]),items:Me,getItemAsString:st,selectionMode:f?"multiple":"single",stateReducer:lne,componentName:D},{dispatch:Tt,getRootProps:Ct,contextValue:un,state:{open:gn,highlightedValue:hn,selectedValues:We},rootRef:vn}=bR(ot),Ut=$.useRef(gn);tu(()=>{if(gn&&hn!==null){var _e;const ee=(_e=Be(hn))==null?void 0:_e.ref;if(!V.current||!(ee!=null&&ee.current))return;Ut.current||ee.current.focus({preventScroll:!0});const ne=V.current.getBoundingClientRect(),Z=ee.current.getBoundingClientRect();Z.top<ne.top?V.current.scrollTop-=ne.top-Z.top:Z.bottom>ne.bottom&&(V.current.scrollTop+=Z.bottom-ne.bottom)}},[gn,hn,Be]);const tn=$.useCallback(_e=>Be(_e),[Be]),Dt=_e=>ee=>{var ne;if(_e==null||(ne=_e.onClick)==null||ne.call(_e,ee),!ee.defaultMuiPrevented){const Z={type:Ww.buttonClick,event:ee};Tt(Z)}},An=_e=>ee=>{var ne;(ne=_e.onKeyDown)==null||ne.call(_e,ee),!ee.defaultMuiPrevented&&(ee.key==="ArrowDown"||ee.key==="ArrowUp")&&(ee.preventDefault(),Tt({type:qr.keyDown,key:ee.key,event:ee}))},an=(_e={})=>({onClick:Dt(_e),onKeyDown:An(_e)}),Le=(_e={})=>ue({},_e,an(_e),{role:"combobox","aria-expanded":gn,"aria-controls":q}),me=(_e={})=>{const ee=uo(_e),ne=nu(Le,Ve);return ue({},_e,ne(ee))},it=_e=>ee=>{var ne,Z;(ne=_e.onBlur)==null||ne.call(_e,ee),!ee.defaultMuiPrevented&&((Z=V.current)!=null&&Z.contains(ee.relatedTarget)||ee.relatedTarget===U.current)&&(ee.defaultMuiPrevented=!0)},St=(_e={})=>({onBlur:it(_e)}),It=(_e={})=>{const ee=uo(_e),ne=nu(St,Ct);return ue({id:q,role:"listbox","aria-multiselectable":f?"true":void 0},_e,ne(ee))};$.useDebugValue({selectedOptions:We,highlightedOption:hn,open:gn});const wt=$.useMemo(()=>ue({},un,re),[un,re]);let Zt;e.multiple?Zt=We:Zt=We.length>0?We[0]:null;let Lt;if(f)Lt=Zt.map(_e=>tn(_e)).filter(_e=>_e!==void 0);else{var kt;Lt=(kt=tn(Zt))!=null?kt:null}const bn=_e=>ee=>{var ne;if(_e==null||(ne=_e.onChange)==null||ne.call(_e,ee),ee.defaultMuiPrevented)return;const Z=ye.get(ee.target.value);ee.target.value===""?Tt({type:qr.clearSelection}):Z!==void 0&&Tt({type:Ww.browserAutoFill,item:Z.value,event:ee})};return{buttonActive:Ie,buttonFocusVisible:ve,buttonRef:Se,contextValue:wt,disabled:a,dispatch:Tt,getButtonProps:me,getHiddenInputProps:(_e={})=>{const ee=uo(_e);return ue({name:g,tabIndex:-1,"aria-hidden":!0,required:_?!0:void 0,value:T(Lt),style:XY},_e,{onChange:bn(ee)})},getListboxProps:It,getOptionMetadata:tn,listboxRef:vn,open:gn,options:Me,value:Zt,highlightedOption:hn}}function hne(e){const{value:t,children:n}=e,{dispatch:r,getItemIndex:i,getItemState:a,registerItem:c,totalSubitemCount:s}=t,f=$.useMemo(()=>({dispatch:r,getItemState:a,getItemIndex:i}),[r,i,a]),g=$.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:s}),[c,i,s]);return te.jsx(M_.Provider,{value:g,children:te.jsx(qh.Provider,{value:f,children:n})})}function dne(e={}){const{autoHideDuration:t=null,disableWindowBlurListener:n=!1,onClose:r,open:i,resumeHideDuration:a}=e,c=R0();$.useEffect(()=>{if(!i)return;function T(O){O.defaultPrevented||(O.key==="Escape"||O.key==="Esc")&&(r==null||r(O,"escapeKeyDown"))}return document.addEventListener("keydown",T),()=>{document.removeEventListener("keydown",T)}},[i,r]);const s=Cl((T,O)=>{r==null||r(T,O)}),f=Cl(T=>{!r||T==null||c.start(T,()=>{s(null,"timeout")})});$.useEffect(()=>(i&&f(t),c.clear),[i,t,f,c]);const g=T=>{r==null||r(T,"clickaway")},_=c.clear,x=$.useCallback(()=>{t!=null&&f(a??t*.5)},[t,a,f]),C=T=>O=>{const D=T.onBlur;D==null||D(O),x()},E=T=>O=>{const D=T.onFocus;D==null||D(O),_()},A=T=>O=>{const D=T.onMouseEnter;D==null||D(O),_()},L=T=>O=>{const D=T.onMouseLeave;D==null||D(O),x()};return $.useEffect(()=>{if(!n&&i)return window.addEventListener("focus",x),window.addEventListener("blur",_),()=>{window.removeEventListener("focus",x),window.removeEventListener("blur",_)}},[n,i,x,_]),{getRootProps:(T={})=>{const O=ue({},uo(e),uo(T));return ue({role:"presentation"},T,O,{onBlur:C(O),onFocus:E(O),onMouseEnter:A(O),onMouseLeave:L(O)})},onClickAway:g}}function fne(e){const{checked:t,defaultChecked:n,disabled:r,onBlur:i,onChange:a,onFocus:c,onFocusVisible:s,readOnly:f,required:g}=e,[_,x]=Vm({controlled:t,default:!!n,name:"Switch",state:"checked"}),C=Q=>K=>{var N;K.nativeEvent.defaultPrevented||(x(K.target.checked),a==null||a(K),(N=Q.onChange)==null||N.call(Q,K))},{isFocusVisibleRef:E,onBlur:A,onFocus:L,ref:I}=pR(),[T,O]=$.useState(!1);r&&T&&O(!1),$.useEffect(()=>{E.current=T},[T,E]);const D=$.useRef(null),U=Q=>K=>{var N;D.current||(D.current=K.currentTarget),L(K),E.current===!0&&(O(!0),s==null||s(K)),c==null||c(K),(N=Q.onFocus)==null||N.call(Q,K)},H=Q=>K=>{var N;A(K),E.current===!1&&O(!1),i==null||i(K),(N=Q.onBlur)==null||N.call(Q,K)},V=Br(I,D);return{checked:_,disabled:!!r,focusVisible:T,getInputProps:(Q={})=>ue({checked:t,defaultChecked:n,disabled:r,readOnly:f,ref:V,required:g,type:"checkbox",role:"switch","aria-checked":t},Q,{onChange:C(Q),onFocus:U(Q),onBlur:H(Q)}),inputRef:V,readOnly:!!f}}function pne(e){const{value:t,defaultValue:n,onChange:r,orientation:i="horizontal",direction:a="ltr",selectionFollowsFocus:c=!1}=e,[s,f]=Vm({controlled:t,default:n,name:"Tabs",state:"value"}),g=$.useCallback((I,T)=>{f(T),r==null||r(I,T)},[r,f]),{subitems:_,contextValue:x}=tM(),C=$.useRef(()=>{}),E=$.useCallback(I=>{var T;return(T=_.get(I))==null?void 0:T.id},[_]),A=$.useCallback(I=>C.current(I),[]),L=$.useCallback(I=>{C.current=I},[]);return{contextValue:ue({direction:a,getTabId:A,getTabPanelId:E,onSelected:g,orientation:i,registerTabIdLookup:L,selectionFollowsFocus:c,value:s},x)}}const n8=$.createContext(null);function xM(){const e=$.useContext(n8);if(e==null)throw new Error("No TabsContext provided");return e}function mne(e){const{value:t,children:n}=e,{direction:r,getItemIndex:i,onSelected:a,orientation:c,registerItem:s,registerTabIdLookup:f,selectionFollowsFocus:g,totalSubitemCount:_,value:x,getTabId:C,getTabPanelId:E}=t,A=$.useMemo(()=>({getItemIndex:i,registerItem:s,totalSubitemCount:_}),[s,i,_]),L=$.useMemo(()=>({direction:r,getTabId:C,getTabPanelId:E,onSelected:a,orientation:c,registerTabIdLookup:f,selectionFollowsFocus:g,value:x}),[r,C,E,a,c,f,g,x]);return te.jsx(M_.Provider,{value:A,children:te.jsx(n8.Provider,{value:L,children:n})})}function gne(e){return e.size}function vne(e){const{value:t,id:n,rootRef:r}=e,i=xM();if(i===null)throw new Error("No TabContext provided");const{value:a,getTabId:c}=i,s=Gs(n),f=$.useRef(null),g=Br(f,r),_=$.useMemo(()=>({id:s,ref:f}),[s]),{id:x}=nM(t??gne,_),C=x!==a,E=x!==void 0?c(x):void 0;return{hidden:C,getRootProps:(L={})=>ue({"aria-labelledby":E??void 0,hidden:C,id:s??void 0},L,{ref:g}),rootRef:g}}const r8={valueChange:"valueChange"};function yne(e,t){if(t.type===r8.valueChange)return ue({},e,{highlightedValue:t.value});const n=eM(e,t),{context:{selectionFollowsFocus:r}}=t;if(t.type===qr.itemsChange){if(n.selectedValues.length>0)return ue({},n,{highlightedValue:n.selectedValues[0]});So(null,"reset",t.context)}return r&&n.highlightedValue!=null?ue({},n,{selectedValues:[n.highlightedValue]}):n}function _ne(e){var t;const{rootRef:n}=e,{direction:r="ltr",onSelected:i,orientation:a="horizontal",value:c,registerTabIdLookup:s,selectionFollowsFocus:f}=xM(),{subitems:g,contextValue:_}=tM(),x=$.useCallback(re=>{var ye;return(ye=g.get(re))==null?void 0:ye.id},[g]);s(x);const C=$.useMemo(()=>Array.from(g.keys()),[g]),E=$.useCallback(re=>{var ye,ge;return re==null?null:(ye=(ge=g.get(re))==null?void 0:ge.ref.current)!=null?ye:null},[g]),A=r==="rtl";let L;a==="vertical"?L="vertical":L=A?"horizontal-rtl":"horizontal-ltr";const I=$.useCallback((re,ye)=>{var ge;i(re,(ge=ye[0])!=null?ge:null)},[i]),T=$.useMemo(()=>c===void 0?{}:c!=null?{selectedValues:[c]}:{selectedValues:[]},[c]),O=$.useCallback(re=>{var ye,ge;return(ye=(ge=g.get(re))==null?void 0:ge.disabled)!=null?ye:!1},[g]),{contextValue:D,dispatch:U,getRootProps:H,state:{highlightedValue:V,selectedValues:q},rootRef:Q}=bR({controlledProps:T,disabledItemsFocusable:!f,focusManagement:"DOM",getItemDomElement:E,isItemDisabled:O,items:C,rootRef:n,onChange:I,orientation:L,reducerActionContext:$.useMemo(()=>({selectionFollowsFocus:f||!1}),[f]),selectionMode:"single",stateReducer:yne});$.useEffect(()=>{c!==void 0&&c!=null&&U({type:r8.valueChange,value:c})},[U,c]);const K=(re={})=>ue({},re,H(re),{"aria-orientation":a==="vertical"?"vertical":void 0,role:"tablist"});return{contextValue:$.useMemo(()=>ue({},_,D),[_,D]),dispatch:U,getRootProps:K,highlightedValue:V,isRtl:A,orientation:a,rootRef:Q,selectedValue:(t=q[0])!=null?t:null}}function xne(e){const{value:t,children:n}=e,{dispatch:r,getItemIndex:i,getItemState:a,registerItem:c,totalSubitemCount:s}=t,f=$.useMemo(()=>({dispatch:r,getItemState:a,getItemIndex:i}),[r,i,a]),g=$.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:s}),[c,i,s]);return te.jsx(M_.Provider,{value:g,children:te.jsx(qh.Provider,{value:f,children:n})})}function bne(e){return e.size}function wne(e){const{value:t,rootRef:n,disabled:r=!1,id:i}=e,a=$.useRef(null),c=Gs(i),{value:s,selectionFollowsFocus:f,getTabPanelId:g}=xM(),_=$.useMemo(()=>({disabled:r,ref:a,id:c}),[r,a,c]),{id:x,index:C,totalItemCount:E}=nM(t??bne,_),{getRootProps:A,highlighted:L,selected:I}=wR({item:x}),{getRootProps:T,rootRef:O,active:D,focusVisible:U,setFocusVisible:H}=_c({disabled:r,focusableWhenDisabled:!f,type:"button"}),V=Br(a,n,O),q=x!==void 0?g(x):void 0;return{getRootProps:(K={})=>{const N=uo(K),re=nu(A,T);return ue({},K,re(N),{role:"tab","aria-controls":q,"aria-selected":I,id:c,ref:V})},active:D,focusVisible:U,highlighted:L,index:C,rootRef:V,selected:I||x===s,setFocusVisible:H,totalTabsCount:E}}function RO(e){return typeof e.normalize<"u"?e.normalize("NFD").replace(/[\u0300-\u036f]/g,""):e}function bM(e={}){const{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:i="any",stringify:a,trim:c=!1}=e;return(s,{inputValue:f,getOptionLabel:g})=>{let _=c?f.trim():f;n&&(_=_.toLowerCase()),t&&(_=RO(_));const x=_?s.filter(C=>{let E=(a||g)(C);return n&&(E=E.toLowerCase()),t&&(E=RO(E)),i==="start"?E.indexOf(_)===0:E.indexOf(_)>-1}):s;return typeof r=="number"?x.slice(0,r):x}}function N1(e,t){for(let n=0;n<e.length;n+=1)if(t(e[n]))return n;return-1}const Sne=bM(),LO=5,Mne=e=>{var t;return e.current!==null&&((t=e.current.parentElement)==null?void 0:t.contains(document.activeElement))},Cne=[];function Ene(e){const{unstable_isActiveElementInListbox:t=Mne,unstable_classNamePrefix:n="Mui",autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:c=!1,clearOnBlur:s=!e.freeSolo,clearOnEscape:f=!1,componentName:g="useAutocomplete",defaultValue:_=e.multiple?Cne:null,disableClearable:x=!1,disableCloseOnSelect:C=!1,disabled:E,disabledItemsFocusable:A=!1,disableListWrap:L=!1,filterOptions:I=Sne,filterSelectedOptions:T=!1,freeSolo:O=!1,getOptionDisabled:D,getOptionKey:U,getOptionLabel:H=xt=>{var Ze;return(Ze=xt.label)!=null?Ze:xt},groupBy:V,handleHomeEndKeys:q=!e.freeSolo,id:Q,includeInputInList:K=!1,inputValue:N,isOptionEqualToValue:re=(xt,Ze)=>xt===Ze,multiple:ye=!1,onChange:ge,onClose:Ve,onHighlightChange:Ie,onInputChange:ve,onOpen:Se,open:Me,openOnFocus:Be=!1,options:Qe,readOnly:st=!1,selectOnFocus:ct=!e.freeSolo,value:Xt}=e,je=Gs(Q);let lt=H;lt=xt=>{const Ze=H(xt);return typeof Ze!="string"?String(Ze):Ze};const Ot=$.useRef(!1),ut=$.useRef(!0),ot=$.useRef(null),Tt=$.useRef(null),[Ct,un]=$.useState(null),[gn,hn]=$.useState(-1),We=i?0:-1,vn=$.useRef(We),[Ut,tn]=Vm({controlled:Xt,default:_,name:g}),[Dt,An]=Vm({controlled:N,default:"",name:g,state:"inputValue"}),[an,Le]=$.useState(!1),me=$.useCallback((xt,Ze)=>{if(!(ye?Ut.length<Ze.length:Ze!==null)&&!s)return;let Wt;if(ye)Wt="";else if(Ze==null)Wt="";else{const pn=lt(Ze);Wt=typeof pn=="string"?pn:""}Dt!==Wt&&(An(Wt),ve&&ve(xt,Wt,"reset"))},[lt,Dt,ye,ve,An,s,Ut]),[it,St]=Vm({controlled:Me,default:!1,name:g,state:"open"}),[It,wt]=$.useState(!0),Zt=!ye&&Ut!=null&&Dt===lt(Ut),Lt=it&&!st,kt=Lt?I(Qe.filter(xt=>!(T&&(ye?Ut:[Ut]).some(Ze=>Ze!==null&&re(xt,Ze)))),{inputValue:Zt&&It?"":Dt,getOptionLabel:lt}):[],bn=qY({filteredOptions:kt,value:Ut,inputValue:Dt});$.useEffect(()=>{const xt=Ut!==bn.value;an&&!xt||O&&!xt||me(null,Ut)},[Ut,me,an,bn.value,O]);const zt=it&&kt.length>0&&!st,_e=Cl(xt=>{xt===-1?ot.current.focus():Ct.querySelector(`[data-tag-index="${xt}"]`).focus()});$.useEffect(()=>{ye&&gn>Ut.length-1&&(hn(-1),_e(-1))},[Ut,ye,gn,_e]);function ee(xt,Ze){if(!Tt.current||xt<0||xt>=kt.length)return-1;let Rt=xt;for(;;){const Wt=Tt.current.querySelector(`[data-option-index="${Rt}"]`),pn=A?!1:!Wt||Wt.disabled||Wt.getAttribute("aria-disabled")==="true";if(Wt&&Wt.hasAttribute("tabindex")&&!pn)return Rt;if(Ze==="next"?Rt=(Rt+1)%kt.length:Rt=(Rt-1+kt.length)%kt.length,Rt===xt)return-1}}const ne=Cl(({event:xt,index:Ze,reason:Rt="auto"})=>{if(vn.current=Ze,Ze===-1?ot.current.removeAttribute("aria-activedescendant"):ot.current.setAttribute("aria-activedescendant",`${je}-option-${Ze}`),Ie&&Ie(xt,Ze===-1?null:kt[Ze],Rt),!Tt.current)return;const Wt=Tt.current.querySelector(`[role="option"].${n}-focused`);Wt&&(Wt.classList.remove(`${n}-focused`),Wt.classList.remove(`${n}-focusVisible`));let pn=Tt.current;if(Tt.current.getAttribute("role")!=="listbox"&&(pn=Tt.current.parentElement.querySelector('[role="listbox"]')),!pn)return;if(Ze===-1){pn.scrollTop=0;return}const cr=Tt.current.querySelector(`[data-option-index="${Ze}"]`);if(cr&&(cr.classList.add(`${n}-focused`),Rt==="keyboard"&&cr.classList.add(`${n}-focusVisible`),pn.scrollHeight>pn.clientHeight&&Rt!=="mouse"&&Rt!=="touch")){const qn=cr,pe=pn.clientHeight+pn.scrollTop,nt=qn.offsetTop+qn.offsetHeight;nt>pe?pn.scrollTop=nt-pn.clientHeight:qn.offsetTop-qn.offsetHeight*(V?1.3:0)<pn.scrollTop&&(pn.scrollTop=qn.offsetTop-qn.offsetHeight*(V?1.3:0))}}),Z=Cl(({event:xt,diff:Ze,direction:Rt="next",reason:Wt="auto"})=>{if(!Lt)return;const cr=ee((()=>{const qn=kt.length-1;if(Ze==="reset")return We;if(Ze==="start")return 0;if(Ze==="end")return qn;const pe=vn.current+Ze;return pe<0?pe===-1&&K?-1:L&&vn.current!==-1||Math.abs(Ze)>1?0:qn:pe>qn?pe===qn+1&&K?-1:L||Math.abs(Ze)>1?qn:0:pe})(),Rt);if(ne({index:cr,reason:Wt,event:xt}),r&&Ze!=="reset")if(cr===-1)ot.current.value=Dt;else{const qn=lt(kt[cr]);ot.current.value=qn,qn.toLowerCase().indexOf(Dt.toLowerCase())===0&&Dt.length>0&&ot.current.setSelectionRange(Dt.length,qn.length)}}),le=()=>{const xt=(Ze,Rt)=>{const Wt=Ze?lt(Ze):"",pn=Rt?lt(Rt):"";return Wt===pn};if(vn.current!==-1&&bn.filteredOptions&&bn.filteredOptions.length!==kt.length&&bn.inputValue===Dt&&(ye?Ut.length===bn.value.length&&bn.value.every((Ze,Rt)=>lt(Ut[Rt])===lt(Ze)):xt(bn.value,Ut))){const Ze=bn.filteredOptions[vn.current];if(Ze)return N1(kt,Rt=>lt(Rt)===lt(Ze))}return-1},Te=$.useCallback(()=>{if(!Lt)return;const xt=le();if(xt!==-1){vn.current=xt;return}const Ze=ye?Ut[0]:Ut;if(kt.length===0||Ze==null){Z({diff:"reset"});return}if(Tt.current){if(Ze!=null){const Rt=kt[vn.current];if(ye&&Rt&&N1(Ut,pn=>re(Rt,pn))!==-1)return;const Wt=N1(kt,pn=>re(pn,Ze));Wt===-1?Z({diff:"reset"}):ne({index:Wt});return}if(vn.current>=kt.length-1){ne({index:kt.length-1});return}ne({index:vn.current})}},[kt.length,ye?!1:Ut,T,Z,ne,Lt,Dt,ye]),$e=Cl(xt=>{xw(Tt,xt),xt&&Te()});$.useEffect(()=>{Te()},[Te]);const fe=xt=>{it||(St(!0),wt(!0),Se&&Se(xt))},xe=(xt,Ze)=>{it&&(St(!1),Ve&&Ve(xt,Ze))},Re=(xt,Ze,Rt,Wt)=>{if(ye){if(Ut.length===Ze.length&&Ut.every((pn,cr)=>pn===Ze[cr]))return}else if(Ut===Ze)return;ge&&ge(xt,Ze,Rt,Wt),tn(Ze)},De=$.useRef(!1),ze=(xt,Ze,Rt="selectOption",Wt="options")=>{let pn=Rt,cr=Ze;if(ye){cr=Array.isArray(Ut)?Ut.slice():[];const qn=N1(cr,pe=>re(Ze,pe));qn===-1?cr.push(Ze):Wt!=="freeSolo"&&(cr.splice(qn,1),pn="removeOption")}me(xt,cr),Re(xt,cr,pn,{option:Ze}),!C&&(!xt||!xt.ctrlKey&&!xt.metaKey)&&xe(xt,pn),(c===!0||c==="touch"&&De.current||c==="mouse"&&!De.current)&&ot.current.blur()};function Je(xt,Ze){if(xt===-1)return-1;let Rt=xt;for(;;){if(Ze==="next"&&Rt===Ut.length||Ze==="previous"&&Rt===-1)return-1;const Wt=Ct.querySelector(`[data-tag-index="${Rt}"]`);if(!Wt||!Wt.hasAttribute("tabindex")||Wt.disabled||Wt.getAttribute("aria-disabled")==="true")Rt+=Ze==="next"?1:-1;else return Rt}}const Oe=(xt,Ze)=>{if(!ye)return;Dt===""&&xe(xt,"toggleInput");let Rt=gn;gn===-1?Dt===""&&Ze==="previous"&&(Rt=Ut.length-1):(Rt+=Ze==="next"?1:-1,Rt<0&&(Rt=0),Rt===Ut.length&&(Rt=-1)),Rt=Je(Rt,Ze),hn(Rt),_e(Rt)},Et=xt=>{Ot.current=!0,An(""),ve&&ve(xt,"","clear"),Re(xt,ye?[]:null,"clear")},Ft=xt=>Ze=>{if(xt.onKeyDown&&xt.onKeyDown(Ze),!Ze.defaultMuiPrevented&&(gn!==-1&&["ArrowLeft","ArrowRight"].indexOf(Ze.key)===-1&&(hn(-1),_e(-1)),Ze.which!==229))switch(Ze.key){case"Home":Lt&&q&&(Ze.preventDefault(),Z({diff:"start",direction:"next",reason:"keyboard",event:Ze}));break;case"End":Lt&&q&&(Ze.preventDefault(),Z({diff:"end",direction:"previous",reason:"keyboard",event:Ze}));break;case"PageUp":Ze.preventDefault(),Z({diff:-LO,direction:"previous",reason:"keyboard",event:Ze}),fe(Ze);break;case"PageDown":Ze.preventDefault(),Z({diff:LO,direction:"next",reason:"keyboard",event:Ze}),fe(Ze);break;case"ArrowDown":Ze.preventDefault(),Z({diff:1,direction:"next",reason:"keyboard",event:Ze}),fe(Ze);break;case"ArrowUp":Ze.preventDefault(),Z({diff:-1,direction:"previous",reason:"keyboard",event:Ze}),fe(Ze);break;case"ArrowLeft":Oe(Ze,"previous");break;case"ArrowRight":Oe(Ze,"next");break;case"Enter":if(vn.current!==-1&&Lt){const Rt=kt[vn.current],Wt=D?D(Rt):!1;if(Ze.preventDefault(),Wt)return;ze(Ze,Rt,"selectOption"),r&&ot.current.setSelectionRange(ot.current.value.length,ot.current.value.length)}else O&&Dt!==""&&Zt===!1&&(ye&&Ze.preventDefault(),ze(Ze,Dt,"createOption","freeSolo"));break;case"Escape":Lt?(Ze.preventDefault(),Ze.stopPropagation(),xe(Ze,"escape")):f&&(Dt!==""||ye&&Ut.length>0)&&(Ze.preventDefault(),Ze.stopPropagation(),Et(Ze));break;case"Backspace":if(ye&&!st&&Dt===""&&Ut.length>0){const Rt=gn===-1?Ut.length-1:gn,Wt=Ut.slice();Wt.splice(Rt,1),Re(Ze,Wt,"removeOption",{option:Ut[Rt]})}break;case"Delete":if(ye&&!st&&Dt===""&&Ut.length>0&&gn!==-1){const Rt=gn,Wt=Ut.slice();Wt.splice(Rt,1),Re(Ze,Wt,"removeOption",{option:Ut[Rt]})}break}},be=xt=>{Le(!0),Be&&!Ot.current&&fe(xt)},qe=xt=>{if(t(Tt)){ot.current.focus();return}Le(!1),ut.current=!0,Ot.current=!1,a&&vn.current!==-1&&Lt?ze(xt,kt[vn.current],"blur"):a&&O&&Dt!==""?ze(xt,Dt,"blur","freeSolo"):s&&me(xt,Ut),xe(xt,"blur")},tt=xt=>{const Ze=xt.target.value;Dt!==Ze&&(An(Ze),wt(!1),ve&&ve(xt,Ze,"input")),Ze===""?!x&&!ye&&Re(xt,null,"clear"):fe(xt)},At=xt=>{const Ze=Number(xt.currentTarget.getAttribute("data-option-index"));vn.current!==Ze&&ne({event:xt,index:Ze,reason:"mouse"})},Ht=xt=>{ne({event:xt,index:Number(xt.currentTarget.getAttribute("data-option-index")),reason:"touch"}),De.current=!0},Yt=xt=>{const Ze=Number(xt.currentTarget.getAttribute("data-option-index"));ze(xt,kt[Ze],"selectOption"),De.current=!1},qt=xt=>Ze=>{const Rt=Ut.slice();Rt.splice(xt,1),Re(Ze,Rt,"removeOption",{option:Ut[xt]})},Gt=xt=>{it?xe(xt,"toggleInput"):fe(xt)},yn=xt=>{xt.currentTarget.contains(xt.target)&&xt.target.getAttribute("id")!==je&&xt.preventDefault()},gt=xt=>{xt.currentTarget.contains(xt.target)&&(ot.current.focus(),ct&&ut.current&&ot.current.selectionEnd-ot.current.selectionStart===0&&ot.current.select(),ut.current=!1)},In=xt=>{!E&&(Dt===""||!it)&&Gt(xt)};let cn=O&&Dt.length>0;cn=cn||(ye?Ut.length>0:Ut!==null);let Nn=kt;return V&&(Nn=kt.reduce((xt,Ze,Rt)=>{const Wt=V(Ze);return xt.length>0&&xt[xt.length-1].group===Wt?xt[xt.length-1].options.push(Ze):xt.push({key:Rt,index:Rt,group:Wt,options:[Ze]}),xt},[])),E&&an&&qe(),{getRootProps:(xt={})=>ue({"aria-owns":zt?`${je}-listbox`:null},xt,{onKeyDown:Ft(xt),onMouseDown:yn,onClick:gt}),getInputLabelProps:()=>({id:`${je}-label`,htmlFor:je}),getInputProps:()=>({id:je,value:Dt,onBlur:qe,onFocus:be,onChange:tt,onMouseDown:In,"aria-activedescendant":Lt?"":null,"aria-autocomplete":r?"both":"list","aria-controls":zt?`${je}-listbox`:void 0,"aria-expanded":zt,autoComplete:"off",ref:ot,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:E}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:Et}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:Gt}),getTagProps:({index:xt})=>ue({key:xt,"data-tag-index":xt,tabIndex:-1},!st&&{onDelete:qt(xt)}),getListboxProps:()=>({role:"listbox",id:`${je}-listbox`,"aria-labelledby":`${je}-label`,ref:$e,onMouseDown:xt=>{xt.preventDefault()}}),getOptionProps:({index:xt,option:Ze})=>{var Rt;const Wt=(ye?Ut:[Ut]).some(cr=>cr!=null&&re(Ze,cr)),pn=D?D(Ze):!1;return{key:(Rt=U==null?void 0:U(Ze))!=null?Rt:lt(Ze),tabIndex:-1,role:"option",id:`${je}-option-${xt}`,onMouseMove:At,onClick:Yt,onTouchStart:Ht,"data-option-index":xt,"aria-disabled":pn,"aria-selected":Wt}},id:je,inputValue:Dt,value:Ut,dirty:cn,expanded:Lt&&Ct,popupOpen:Lt,focused:an||gn!==-1,anchorEl:Ct,setAnchorEl:un,focusedTag:gn,groupedOptions:Nn}}const Tne=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],Pne=["component","slots","slotProps"],Ane=["component"];function wn(e,t){const{className:n,elementType:r,ownerState:i,externalForwardedProps:a,getSlotOwnerState:c,internalForwardedProps:s}=t,f=Un(t,Tne),{component:g,slots:_={[e]:void 0},slotProps:x={[e]:void 0}}=a,C=Un(a,Pne),E=_[e]||r,A=z6(x[e],i),L=D6(ue({className:n},f,{externalForwardedProps:e==="root"?C:void 0,externalSlotProps:A})),{props:{component:I},internalRef:T}=L,O=Un(L.props,Ane),D=Br(T,A==null?void 0:A.ref,t.ref),U=c?c(O):{},H=ue({},i,U),V=e==="root"?I||g:I,q=k6(E,ue({},e==="root"&&!g&&!_[e]&&s,e!=="root"&&!_[e]&&s,O,V&&{as:V},{ref:D}),H);return Object.keys(U).forEach(Q=>{delete q[Q]}),[E,q]}function Ine(e){return xr("MuiListItem",e)}const qw=mr("MuiListItem",["root","startAction","endAction","nested","nesting","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]),Xw=$.createContext(!1),zg=$.createContext(!1),i8=$.createContext(!1),x3=$.createContext(void 0),o8=$.createContext(void 0),wM=$.createContext(void 0),Rne=["component","className","children","nested","sticky","variant","color","startAction","endAction","role","slots","slotProps"],Lne=e=>{const{sticky:t,nested:n,nesting:r,variant:i,color:a}=e,c={root:["root",n&&"nested",r&&"nesting",t&&"sticky",a&&`color${mn(a)}`,i&&`variant${mn(i)}`],startAction:["startAction"],endAction:["endAction"]};return vr(c,Ine,{})},kne=nn("li")(({theme:e,ownerState:t})=>{var n;return[!t.nested&&{"--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItemButton-marginBlock":"calc(-1 * var(--ListItem-paddingY))",alignItems:"center",gap:"var(--ListItem-gap)",marginInline:"var(--ListItem-marginInline)"},t.nested&&{"--NestedList-marginRight":"calc(-1 * var(--ListItem-paddingRight))","--NestedList-marginLeft":"calc(-1 * var(--ListItem-paddingLeft))","--NestedListItem-paddingLeft":"calc(var(--ListItem-paddingLeft) + var(--List-nestedInsetStart))","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItem-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))",flexDirection:"column"},ue({"--unstable_actionRadius":"calc(var(--ListItem-radius) - var(--variant-borderWidth, 0px))"},t.startAction&&{"--unstable_startActionWidth":"2rem"},t.endAction&&{"--unstable_endActionWidth":"2.5rem"},{boxSizing:"border-box",borderRadius:"var(--ListItem-radius)",display:"var(--_ListItem-display)","&:not([hidden])":{"--_ListItem-display":"var(--_List-markerDisplay, flex)"},flex:"none",listStyleType:"var(--_List-markerType, disc)",position:"relative",paddingBlockStart:t.nested?0:"var(--ListItem-paddingY)",paddingBlockEnd:t.nested?0:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)"},t["data-first-child"]===void 0&&ue({},t.row?{marginInlineStart:"var(--List-gap)"}:{marginBlockStart:"var(--List-gap)"}),t.row&&t.wrap&&{marginInlineStart:"var(--List-gap)",marginBlockStart:"var(--List-gap)"},{minBlockSize:"var(--ListItem-minHeight)"},t.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:`var(--ListItem-stickyBackground, ${e.vars.palette.background.body})`},{[`.${qw.nested} > &`]:{"--_ListItem-display":"flex"}}),(n=e.variants[t.variant])==null?void 0:n[t.color]]}),Dne=nn(kne,{name:"JoyListItem",slot:"Root",overridesResolver:(e,t)=>t.root})({}),zne=nn("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(e,t)=>t.startAction})(({ownerState:e})=>({display:"inherit",position:"absolute",top:e.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",left:0,transform:"translate(var(--ListItem-startActionTranslateX), -50%)",zIndex:1})),One=nn("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(e,t)=>t.startAction})(({ownerState:e})=>({display:"inherit",position:"absolute",top:e.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",right:0,transform:"translate(var(--ListItem-endActionTranslateX), -50%)"})),Jh=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyListItem"}),i=$.useContext(wM),a=$.useContext(x3),c=$.useContext(zg),s=$.useContext(i8),f=$.useContext(Xw),{component:g,className:_,children:x,nested:C=!1,sticky:E=!1,variant:A="plain",color:L="neutral",startAction:I,endAction:T,role:O,slots:D={},slotProps:U={}}=r,H=Un(r,Rne),[V,q]=$.useState(""),[Q,K]=(a==null?void 0:a.split(":"))||["",""],N=g||(Q&&!Q.match(/^(ul|ol|menu)$/)?"div":void 0);let re=i==="menu"?"none":void 0;a&&(re={menu:"none",menubar:"none",group:"presentation"}[K]),O&&(re=O);const ye=ue({},r,{sticky:E,startAction:I,endAction:T,row:c,wrap:s,variant:A,color:L,nesting:f,nested:C,component:N,role:re}),ge=Lne(ye),Ve=ue({},H,{component:N,slots:D,slotProps:U}),[Ie,ve]=wn("root",{additionalProps:{role:re},ref:n,className:_i(ge.root,_),elementType:Dne,externalForwardedProps:Ve,ownerState:ye}),[Se,Me]=wn("startAction",{className:ge.startAction,elementType:zne,externalForwardedProps:Ve,ownerState:ye}),[Be,Qe]=wn("endAction",{className:ge.endAction,elementType:One,externalForwardedProps:Ve,ownerState:ye});return te.jsx(o8.Provider,{value:q,children:te.jsx(Xw.Provider,{value:C?V||!0:!1,children:te.jsxs(Ie,ue({},ve,{children:[I&&te.jsx(Se,ue({},Me,{children:I})),$.Children.map(x,(st,ct)=>{var Xt;return $.isValidElement(st)?$.cloneElement(st,ue({},ct===0&&{"data-first-child":""},dR(st,["ListItem"])&&{component:((Xt=st.props)==null?void 0:Xt.component)||"div"})):st}),T&&te.jsx(Be,ue({},Qe,{children:T}))]}))})})});Jh.muiName="ListItem";const SM={"--NestedList-marginRight":"0px","--NestedList-marginLeft":"0px","--NestedListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px"};function L_(e){const{children:t,nested:n,row:r=!1,wrap:i=!1}=e,a=te.jsx(zg.Provider,{value:r,children:te.jsx(i8.Provider,{value:i,children:$.Children.map(t,(c,s)=>$.isValidElement(c)?$.cloneElement(c,ue({},s===0&&{"data-first-child":""},s===$.Children.count(t)-1&&{"data-last-child":""})):c)})});return n===void 0?a:te.jsx(Xw.Provider,{value:n,children:a})}const Uf=({theme:e,ownerState:t},n)=>{let r={};function i(a){if(typeof a=="function"){const c=a(e);i(c)}else Array.isArray(a)?a.forEach(c=>{typeof c!="boolean"&&i(c)}):typeof a=="object"&&(r=ue({},r,a))}return t.sx&&(i(t.sx),n.forEach(a=>{const c=r[a];if(typeof c=="string"||typeof c=="number")if(a==="borderRadius")if(typeof c=="number")r[a]=`${c}px`;else{var s;r[a]=((s=e.vars)==null?void 0:s.radius[c])||c}else["p","padding","m","margin"].indexOf(a)!==-1&&typeof c=="number"?r[a]=e.spacing(c):r[a]=c;else typeof c=="function"?r[a]=c(e):r[a]=void 0})),r};function Fne(e){return xr("MuiList",e)}const Nne=mr("MuiList",["root","nesting","scoped","sizeSm","sizeMd","sizeLg","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","horizontal","vertical"]),Bne=$.createContext(void 0),Une=["component","className","children","size","orientation","wrap","variant","color","role","slots","slotProps"],$ne=e=>{const{variant:t,color:n,size:r,nesting:i,orientation:a,instanceSize:c}=e,s={root:["root",a,t&&`variant${mn(t)}`,n&&`color${mn(n)}`,!c&&!i&&r&&`size${mn(r)}`,c&&`size${mn(c)}`,i&&"nesting"]};return vr(s,Fne,{})},k_=nn("ul")(({theme:e,ownerState:t})=>{var n;const{p:r,padding:i,borderRadius:a}=Uf({theme:e,ownerState:t},["p","padding","borderRadius"]);function c(s){return s==="sm"?{"--ListDivider-gap":"0.25rem","--ListItem-minHeight":"2rem","--ListItem-paddingY":"3px","--ListItem-paddingX":t.marker?"3px":"0.5rem","--ListItem-gap":"0.5rem","--ListItemDecorator-size":t.orientation==="horizontal"?"1.5rem":"2rem","--Icon-fontSize":e.vars.fontSize.lg}:s==="md"?{"--ListDivider-gap":"0.375rem","--ListItem-minHeight":"2.25rem","--ListItem-paddingY":"0.25rem","--ListItem-paddingX":t.marker?"0.25rem":"0.75rem","--ListItem-gap":"0.625rem","--ListItemDecorator-size":t.orientation==="horizontal"?"1.75rem":"2.5rem","--Icon-fontSize":e.vars.fontSize.xl}:s==="lg"?{"--ListDivider-gap":"0.5rem","--ListItem-minHeight":"2.75rem","--ListItem-paddingY":"0.375rem","--ListItem-paddingX":t.marker?"0.5rem":"1rem","--ListItem-gap":"0.75rem","--ListItemDecorator-size":t.orientation==="horizontal"?"2.25rem":"3rem","--Icon-fontSize":e.vars.fontSize.xl2}:{}}return[t.nesting&&ue({},c(t.instanceSize),{"--ListItem-paddingRight":"var(--ListItem-paddingX)","--ListItem-paddingLeft":"var(--NestedListItem-paddingLeft)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px",padding:0},t.marker&&{paddingInlineStart:"calc(3ch - var(--_List-markerDeduct, 0px))"},{marginInlineStart:"var(--NestedList-marginLeft)",marginInlineEnd:"var(--NestedList-marginRight)",marginBlockStart:"var(--List-gap)",marginBlockEnd:"initial"}),!t.nesting&&ue({},c(t.size),{"--List-gap":"0px","--List-nestedInsetStart":"0px","--ListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItem-paddingRight":"var(--ListItem-paddingX)"},t.marker&&{"--_List-markerDeduct":"1ch"},{"--unstable_List-childRadius":"calc(max(var(--List-radius) - var(--List-padding), min(var(--List-padding) / 2, var(--List-radius) / 2)) - var(--variant-borderWidth, 0px))","--ListItem-radius":"var(--unstable_List-childRadius)","--ListItem-startActionTranslateX":"calc(0.5 * var(--ListItem-paddingLeft))","--ListItem-endActionTranslateX":"calc(-0.5 * var(--ListItem-paddingRight))",margin:"initial"},e.typography[`body-${t.size}`],t.orientation==="horizontal"?ue({},t.wrap?{padding:"var(--List-padding)",marginInlineStart:"calc(-1 * var(--List-gap))",marginBlockStart:"calc(-1 * var(--List-gap))"}:{paddingInline:"var(--List-padding, var(--ListDivider-gap))",paddingBlock:"var(--List-padding)"}):{paddingBlock:"var(--List-padding, var(--ListDivider-gap))",paddingInline:"var(--List-padding)"},t.marker&&{paddingInlineStart:"3ch"}),ue({boxSizing:"border-box",borderRadius:"var(--List-radius)",listStyle:"none",display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column"},t.wrap&&{flexWrap:"wrap"},t.marker&&{"--_List-markerDisplay":"list-item","--_List-markerType":t.marker,lineHeight:"calc(var(--ListItem-minHeight) - 2 * var(--ListItem-paddingY))"},{flexGrow:1,position:"relative"},(n=e.variants[t.variant])==null?void 0:n[t.color],{"--unstable_List-borderWidth":"var(--variant-borderWidth, 0px)"},a!==void 0&&{"--List-radius":a},r!==void 0&&{"--List-padding":r},i!==void 0&&{"--List-padding":i})]}),Vne=nn(k_,{name:"JoyList",slot:"Root",overridesResolver:(e,t)=>t.root})({}),D_=$.forwardRef(function(t,n){var r;const i=$.useContext(Xw),a=$.useContext(wM),c=$.useContext(Bne),s=br({props:t,name:"JoyList"}),{component:f,className:g,children:_,size:x,orientation:C="vertical",wrap:E=!1,variant:A="plain",color:L="neutral",role:I,slots:T={},slotProps:O={}}=s,D=Un(s,Une),U=x||((r=t.size)!=null?r:"md");let H;a&&(H="group"),c&&(H="presentation"),I&&(H=I);const V=ue({},s,{instanceSize:t.size,size:U,nesting:i,orientation:C,wrap:E,variant:A,color:L,role:H}),q=$ne(V),Q=ue({},D,{component:f,slots:T,slotProps:O}),[K,N]=wn("root",{ref:n,className:_i(q.root,g),elementType:Vne,externalForwardedProps:Q,ownerState:V,additionalProps:{as:f,role:H,"aria-labelledby":typeof i=="string"?i:void 0}});return te.jsx(K,ue({},N,{children:te.jsx(x3.Provider,{value:`${typeof f=="string"?f:""}:${H||""}`,children:te.jsx(L_,{row:C==="horizontal",wrap:E,children:_})})}))}),Gb=mr("MuiListItemButton",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","variantPlain","variantSoft","variantOutlined","variantSolid"]),b3=$.createContext("horizontal"),z_=nn("div")(({theme:e,ownerState:t})=>{var n,r,i,a,c,s;return ue({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,WebkitTapHighlightColor:"transparent",boxSizing:"border-box",position:"relative",font:"inherit",display:"flex",flexDirection:"row",alignItems:"center",alignSelf:"stretch",gap:"var(--ListItem-gap)"},t.orientation==="vertical"&&{flexDirection:"column",justifyContent:"center"},{textAlign:"initial",textDecoration:"initial",backgroundColor:"initial",cursor:"pointer",marginInline:"var(--ListItemButton-marginInline)",marginBlock:"var(--ListItemButton-marginBlock)"},t["data-first-child"]===void 0&&{marginInlineStart:t.row?"var(--List-gap)":void 0,marginBlockStart:t.row?void 0:"var(--List-gap)"},{paddingBlock:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px))",paddingInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItem-startActionWidth, var(--unstable_startActionWidth, 0px)))",paddingInlineEnd:"calc(var(--ListItem-paddingRight) + var(--ListItem-endActionWidth, var(--unstable_endActionWidth, 0px)))",minBlockSize:"var(--ListItem-minHeight)",border:"1px solid transparent",borderRadius:"var(--ListItem-radius)",flex:"var(--unstable_ListItem-flex, none)",fontSize:"inherit",lineHeight:"inherit",minInlineSize:0,[e.focus.selector]:ue({},e.focus.default,{zIndex:1})},(n=e.variants[t.variant])==null?void 0:n[t.color],{"&:active":(r=e.variants[`${t.variant}Active`])==null?void 0:r[t.color],[`.${qw.root} > &`]:{"--unstable_ListItem-flex":"1 0 0%"},[`&.${Gb.selected}`]:ue({},(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color],{"--Icon-color":"currentColor"}),[`&:not(.${Gb.selected}, [aria-selected="true"])`]:{"&:hover":(a=e.variants[`${t.variant}Hover`])==null?void 0:a[t.color],"&:active":(c=e.variants[`${t.variant}Active`])==null?void 0:c[t.color]},[`&.${Gb.disabled}`]:ue({},(s=e.variants[`${t.variant}Disabled`])==null?void 0:s[t.color])})});nn(z_,{name:"JoyListItemButton",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>ue({},!e.row&&{[`&.${Gb.selected}`]:{fontWeight:t.vars.fontWeight.md}}));function jne(e){return xr("MuiSvgIcon",e)}mr("MuiSvgIcon",["root","colorInherit","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","fontSizeInherit","fontSizeXs","fontSizeSm","fontSizeMd","fontSizeLg","fontSizeXl","fontSizeXl2","fontSizeXl3","fontSizeXl4","sizeSm","sizeMd","sizeLg"]);const Hne=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox","size","slots","slotProps"],Gne=e=>{const{color:t,size:n,fontSize:r}=e,i={root:["root",t&&t!=="inherit"&&`color${mn(t)}`,n&&`size${mn(n)}`,r&&`fontSize${mn(r)}`]};return vr(i,jne,{})},kO={sm:"xl",md:"xl2",lg:"xl3"},Wne=nn("svg",{name:"JoySvgIcon",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n;return ue({},t.instanceSize&&{"--Icon-fontSize":e.vars.fontSize[kO[t.instanceSize]]},t.instanceFontSize&&t.instanceFontSize!=="inherit"&&{"--Icon-fontSize":e.vars.fontSize[t.instanceFontSize]},{userSelect:"none",margin:"var(--Icon-margin)",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,fontSize:`var(--Icon-fontSize, ${e.vars.fontSize[kO[t.size]]||"unset"})`},t.fontSize&&t.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${e.fontSize[t.fontSize]})`},!t.htmlColor&&ue({color:`var(--Icon-color, ${e.vars.palette.text.icon})`},t.color==="inherit"&&{color:"inherit"},t.color!=="inherit"&&e.vars.palette[t.color]&&{color:`rgba(${(n=e.vars.palette[t.color])==null?void 0:n.mainChannel} / 1)`}))}),DO=$.forwardRef(function(t,n){const r=br({props:t,name:"JoySvgIcon"}),{children:i,className:a,color:c,component:s="svg",fontSize:f,htmlColor:g,inheritViewBox:_=!1,titleAccess:x,viewBox:C="0 0 24 24",size:E="md",slots:A={},slotProps:L={}}=r,I=Un(r,Hne),T=$.isValidElement(i)&&i.type==="svg",O=ue({},r,{color:c,component:s,size:E,instanceSize:t.size,fontSize:f,instanceFontSize:t.fontSize,inheritViewBox:_,viewBox:C,hasSvgAsChild:T}),D=Gne(O),U=ue({},I,{component:s,slots:A,slotProps:L}),[H,V]=wn("root",{ref:n,className:_i(D.root,a),elementType:Wne,externalForwardedProps:U,ownerState:O,additionalProps:ue({color:g,focusable:!1},x&&{role:"img"},!x&&{"aria-hidden":!0},!_&&{viewBox:C},T&&i.props)});return te.jsxs(H,ue({},V,{children:[T?i.props.children:i,x?te.jsx("title",{children:x}):null]}))});function Og(e,t){function n(r,i){return te.jsx(DO,ue({"data-testid":`${t}Icon`,ref:i},r,{children:e}))}return n.muiName=DO.muiName,$.memo($.forwardRef(n))}const w3=e=>t=>`--${e?`${e}-`:""}${t.replace(/^--/,"")}`,vg="data-skip-inverted-colors",s8=`& :not([${vg}], [${vg}] *)`,a8=e=>{var t,n,r,i,a,c,s,f,g,_,x,C,E,A,L,I,T,O,D,U,H,V;const q=w3(e.cssVarPrefix);return{"--variant-plainColor":"var(--variant-plainColor) !important","--variant-plainHoverColor":"var(--variant-plainHoverColor) !important","--variant-plainHoverBg":"var(--variant-plainHoverBg) !important","--variant-plainActiveBg":"var(--variant-plainActiveBg) !important","--variant-plainDisabledColor":"var(--variant-plainDisabledColor) !important","--variant-outlinedColor":"var(--variant-outlinedColor) !important","--variant-outlinedBorder":"var(--variant-outlinedBorder) !important","--variant-outlinedHoverColor":"var(--variant-outlinedHoverColor) !important","--variant-outlinedHoverBorder":"var(--variant-outlinedHoverBorder) !important","--variant-outlinedHoverBg":"var(--variant-outlinedHoverBg) !important","--variant-outlinedActiveBg":"var(--variant-outlinedActiveBg) !important","--variant-outlinedDisabledColor":"var(--variant-outlinedDisabledColor) !important","--variant-outlinedDisabledBorder":"var(--variant-outlinedDisabledBorder) !important","--variant-softColor":"var(--variant-softColor) !important","--variant-softHoverColor":"var(--variant-softHoverColor) !important","--variant-softBg":"var(--variant-softBg) !important","--variant-softHoverBg":"var(--variant-softHoverBg) !important","--variant-softActiveBg":"var(--variant-softActiveBg) !important","--variant-softActiveColor":"var(--variant-softActiveColor) !important","--variant-softDisabledColor":"var(--variant-softDisabledColor) !important","--variant-softDisabledBg":"var(--variant-softDisabledBg) !important","--variant-solidColor":"var(--variant-solidColor) !important","--variant-solidBg":"var(--variant-solidBg) !important","--variant-solidHoverBg":"var(--variant-solidHoverBg) !important","--variant-solidActiveBg":"var(--variant-solidActiveBg) !important","--variant-solidDisabledColor":"var(--variant-solidDisabledColor) !important","--variant-solidDisabledBg":"var(--variant-solidDisabledBg) !important","--Badge-ringColor":"var(--Badge-ringColor) !important",colorScheme:"unset",[e.getColorSchemeSelector("light")]:{[q("--palette-focusVisible")]:`${(t=e.colorSchemes.light)==null?void 0:t.palette.focusVisible} !important`,[q("--palette-background-body")]:`${(n=e.colorSchemes.light)==null?void 0:n.palette.background.body} !important`,[q("--palette-background-surface")]:`${(r=e.colorSchemes.light)==null?void 0:r.palette.background.surface} !important`,[q("--palette-background-popup")]:`${(i=e.colorSchemes.light)==null?void 0:i.palette.background.popup} !important`,[q("--palette-background-level1")]:`${(a=e.colorSchemes.light)==null?void 0:a.palette.background.level1} !important`,[q("--palette-background-level2")]:`${(c=e.colorSchemes.light)==null?void 0:c.palette.background.level2} !important`,[q("--palette-background-level3")]:`${(s=e.colorSchemes.light)==null?void 0:s.palette.background.level3} !important`,[q("--palette-text-primary")]:`${(f=e.colorSchemes.light)==null?void 0:f.palette.text.primary} !important`,[q("--palette-text-secondary")]:`${(g=e.colorSchemes.light)==null?void 0:g.palette.text.secondary} !important`,[q("--palette-text-tertiary")]:`${(_=e.colorSchemes.light)==null?void 0:_.palette.text.tertiary} !important`,[q("--palette-divider")]:`${(x=e.colorSchemes.light)==null?void 0:x.palette.divider} !important`},[e.getColorSchemeSelector("dark")]:{[q("--palette-focusVisible")]:`${(C=e.colorSchemes.dark)==null?void 0:C.palette.focusVisible} !important`,[q("--palette-background-body")]:`${(E=e.colorSchemes.dark)==null?void 0:E.palette.background.body} !important`,[q("--palette-background-surface")]:`${(A=e.colorSchemes.dark)==null?void 0:A.palette.background.surface} !important`,[q("--palette-background-popup")]:`${(L=e.colorSchemes.dark)==null?void 0:L.palette.background.popup} !important`,[q("--palette-background-level1")]:`${(I=e.colorSchemes.dark)==null?void 0:I.palette.background.level1} !important`,[q("--palette-background-level2")]:`${(T=e.colorSchemes.dark)==null?void 0:T.palette.background.level2} !important`,[q("--palette-background-level3")]:`${(O=e.colorSchemes.dark)==null?void 0:O.palette.background.level3} !important`,[q("--palette-text-primary")]:`${(D=e.colorSchemes.dark)==null?void 0:D.palette.text.primary} !important`,[q("--palette-text-secondary")]:`${(U=e.colorSchemes.dark)==null?void 0:U.palette.text.secondary} !important`,[q("--palette-text-tertiary")]:`${(H=e.colorSchemes.dark)==null?void 0:H.palette.text.tertiary} !important`,[q("--palette-divider")]:`${(V=e.colorSchemes.dark)==null?void 0:V.palette.divider} !important`}}};function qne(e){return e.theme!==void 0}const O_=e=>t=>{const n=qne(t)?t.theme:t,r=yR(n.cssVarPrefix),i=w3(n.cssVarPrefix),a=c=>{const s=c.split("-");return r(c,n.palette[s[1]][s[2]])};return{[s8]:{"--Badge-ringColor":a(`palette-${e}-solidBg`),"--Icon-color":"currentColor",[`${n.getColorSchemeSelector("light")}, ${n.getColorSchemeSelector("dark")}`]:{colorScheme:"dark",[i("--palette-focusVisible")]:a(`palette-${e}-200`),[i("--palette-background-body")]:"rgba(0 0 0 / 0.1)",[i("--palette-background-surface")]:"rgba(0 0 0 / 0.06)",[i("--palette-background-popup")]:a(`palette-${e}-700`),[i("--palette-background-level1")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.36)`,[i("--palette-background-level3")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.6)`,[i("--palette-text-primary")]:a("palette-common-white"),[i("--palette-text-secondary")]:a(`palette-${e}-200`),[i("--palette-text-tertiary")]:a(`palette-${e}-300`),[i("--palette-text-icon")]:a(`palette-${e}-200`),[i("--palette-divider")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-plainColor":a(`palette-${e}-50`),"--variant-plainHoverColor":"#fff","--variant-plainHoverBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-outlinedColor":a(`palette-${e}-50`),"--variant-outlinedBorder":`rgba(${a(`palette-${e}-lightChannel`)} / 0.5)`,"--variant-outlinedHoverColor":"#fff","--variant-outlinedHoverBorder":a(`palette-${e}-300`),"--variant-outlinedHoverBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":"rgba(255 255 255 / 0.2)","--variant-softColor":a("palette-common-white"),"--variant-softHoverColor":a("palette-common-white"),"--variant-softBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.24)`,"--variant-softHoverBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.36)`,"--variant-softActiveBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.16)`,"--variant-softActiveColor":"#fff","--variant-softDisabledColor":`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.1)`,"--variant-solidColor":a(`palette-${e}-${e==="neutral"?"600":"500"}`),"--variant-solidBg":a("palette-common-white"),"--variant-solidHoverBg":a("palette-common-white"),"--variant-solidActiveBg":a(`palette-${e}-100`),"--variant-solidDisabledColor":`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.1)`}},[`&, & [${vg}]`]:a8(n)}},F_=e=>t=>{const{theme:n=t}=t,r=yR(n.cssVarPrefix),i=w3(n.cssVarPrefix),a=c=>{const s=c.split("-");return r(c,n.palette[s[1]][s[2]])};return{[s8]:{"--Badge-ringColor":a(`palette-${e}-softBg`),"--Icon-color":"currentColor",[n.getColorSchemeSelector("dark")]:{[i("--palette-focusVisible")]:a(`palette-${e}-300`),[i("--palette-background-body")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.1)`,[i("--palette-background-surface")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.08)`,[i("--palette-background-level1")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.4)`,[i("--palette-background-level3")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,[i("--palette-text-primary")]:a(`palette-${e}-100`),[i("--palette-text-secondary")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.72)`,[i("--palette-text-tertiary")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.6)`,[i("--palette-text-icon")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.6)`,[i("--palette-divider")]:`rgba(${a(`palette-${e}-lightChannel`)} / 0.2)`,"--variant-plainColor":`rgba(${a(`palette-${e}-lightChannel`)} / 1)`,"--variant-plainHoverColor":a(`palette-${e}-50`),"--variant-plainHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.16)`,"--variant-plainActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-outlinedColor":`rgba(${a(`palette-${e}-lightChannel`)} / 1)`,"--variant-outlinedHoverColor":a(`palette-${e}-50`),"--variant-outlinedBg":"initial","--variant-outlinedBorder":`rgba(${a(`palette-${e}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverBorder":a(`palette-${e}-600`),"--variant-outlinedHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.16)`,"--variant-outlinedActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":`rgba(${a(`palette-${e}-mainChannel`)} / 0.2)`,"--variant-softColor":a(`palette-${e}-200`),"--variant-softBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-softHoverColor":"#fff","--variant-softHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-softActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.48)`,"--variant-softDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-solidColor":"#fff","--variant-solidBg":a(`palette-${e}-500`),"--variant-solidHoverColor":"#fff","--variant-solidHoverBg":a(`palette-${e}-600`),"--variant-solidActiveBg":a(`palette-${e}-600`),"--variant-solidDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`},[n.getColorSchemeSelector("light")]:{[i("--palette-focusVisible")]:a(`palette-${e}-500`),[i("--palette-background-body")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.1)`,[i("--palette-background-surface")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.08)`,[i("--palette-background-level1")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,[i("--palette-background-level3")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.48)`,[i("--palette-text-primary")]:a(`palette-${e}-700`),[i("--palette-text-secondary")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.8)`,[i("--palette-text-tertiary")]:`rgba(${a(`palette-${e}-darkChannel`)} / 0.68)`,[i("--palette-text-icon")]:a(`palette-${e}-500`),[i("--palette-divider")]:`rgba(${a(`palette-${e}-mainChannel`)} / 0.32)`,"--variant-plainColor":`rgba(${a(`palette-${e}-darkChannel`)} / 0.8)`,"--variant-plainHoverColor":`rgba(${a(`palette-${e}-darkChannel`)} / 1)`,"--variant-plainHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-plainDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-outlinedColor":`rgba(${a(`palette-${e}-mainChannel`)} / 1)`,"--variant-outlinedBorder":`rgba(${a(`palette-${e}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverColor":a(`palette-${e}-600`),"--variant-outlinedHoverBorder":a(`palette-${e}-300`),"--variant-outlinedHoverBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.24)`,"--variant-outlinedDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-outlinedDisabledBorder":`rgba(${a(`palette-${e}-mainChannel`)} / 0.12)`,"--variant-softColor":a(`palette-${e}-600`),"--variant-softBg":`rgba(${a(`palette-${e}-lightChannel`)} / 0.8)`,"--variant-softHoverColor":a(`palette-${e}-700`),"--variant-softHoverBg":a(`palette-${e}-200`),"--variant-softActiveBg":a(`palette-${e}-300`),"--variant-softDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-softDisabledBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.08)`,"--variant-solidColor":a("palette-common-white"),"--variant-solidBg":a(`palette-${e}-${e==="neutral"?"700":"500"}`),"--variant-solidHoverColor":a("palette-common-white"),"--variant-solidHoverBg":a(`palette-${e}-600`),"--variant-solidActiveBg":a(`palette-${e}-600`),"--variant-solidDisabledColor":`rgba(${a(`palette-${e}-mainChannel`)} / 0.6)`,"--variant-solidDisabledBg":`rgba(${a(`palette-${e}-mainChannel`)} / 0.08)`}},[`&, & [${vg}]`]:a8(n)}},l8=Og(te.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Xne=Og(te.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),c8=$.createContext(void 0);function tf(e,t){let n=t,r=e;return e==="outlined"&&(n="neutral",r="plain"),e==="plain"&&(n="neutral"),{variant:r,color:n}}function MM(e,t,n=!1){const r=$.useContext(c8),[i,a]=typeof r=="string"?r.split(":"):[],c=tf(i||void 0,a||void 0);return c.variant=e||c.variant,c.color=t||(n?a:c.color),c}function CM({children:e,color:t,variant:n}){return te.jsx(c8.Provider,{value:`${n||""}:${t||""}`,children:e})}function Zne(e){return xr("MuiIconButton",e)}mr("MuiIconButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","loading","loadingIndicator"]);const S3=$.createContext({}),u8=$.createContext(void 0);function Yne(e){return xr("MuiCircularProgress",e)}mr("MuiCircularProgress",["root","determinate","svg","track","progress","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);let Kne=e=>e,zO;const Jne=["color","backgroundColor"],Qne=["children","className","color","size","variant","thickness","determinate","value","component","slots","slotProps"],ere=nR({"0%":{transform:"rotate(-90deg)"},"100%":{transform:"rotate(270deg)"}}),tre=e=>{const{determinate:t,color:n,variant:r,size:i}=e,a={root:["root",t&&"determinate",n&&`color${mn(n)}`,r&&`variant${mn(r)}`,i&&`size${mn(i)}`],svg:["svg"],track:["track"],progress:["progress"]};return vr(a,Yne,{})};function Np(e,t){return`var(--CircularProgress-${e}Thickness, var(--CircularProgress-thickness, ${t}))`}const nre=nn("span",{name:"JoyCircularProgress",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n,r,i,a;const c=((n=t.variants[e.variant])==null?void 0:n[e.color])||{},{color:s,backgroundColor:f}=c,g=Un(c,Jne);return ue({"--Icon-fontSize":"calc(0.4 * var(--_root-size))","--CircularProgress-trackColor":f,"--CircularProgress-progressColor":s,"--CircularProgress-percent":e.value,"--CircularProgress-linecap":"round"},e.size==="sm"&&{"--_root-size":"var(--CircularProgress-size, 24px)","--_track-thickness":Np("track","3px"),"--_progress-thickness":Np("progress","3px")},e.instanceSize==="sm"&&{"--CircularProgress-size":"24px"},e.size==="md"&&{"--_track-thickness":Np("track","6px"),"--_progress-thickness":Np("progress","6px"),"--_root-size":"var(--CircularProgress-size, 40px)"},e.instanceSize==="md"&&{"--CircularProgress-size":"40px"},e.size==="lg"&&{"--_track-thickness":Np("track","8px"),"--_progress-thickness":Np("progress","8px"),"--_root-size":"var(--CircularProgress-size, 64px)"},e.instanceSize==="lg"&&{"--CircularProgress-size":"64px"},e.thickness&&{"--_track-thickness":`${e.thickness}px`,"--_progress-thickness":`${e.thickness}px`},{"--_thickness-diff":"calc(var(--_track-thickness) - var(--_progress-thickness))","--_inner-size":"calc(var(--_root-size) - 2 * var(--variant-borderWidth, 0px))","--_outlined-inset":"max(var(--_track-thickness), var(--_progress-thickness))",width:"var(--_root-size)",height:"var(--_root-size)",borderRadius:"var(--_root-size)",margin:"var(--CircularProgress-margin)",boxSizing:"border-box",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0,position:"relative",color:s},e.children&&{fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.md,fontSize:"calc(0.2 * var(--_root-size))"},g,e.variant==="outlined"&&{"&::before":ue({content:'""',display:"block",position:"absolute",borderRadius:"inherit",top:"var(--_outlined-inset)",left:"var(--_outlined-inset)",right:"var(--_outlined-inset)",bottom:"var(--_outlined-inset)"},g)},e.variant==="soft"&&{"--CircularProgress-trackColor":t.variants.soft.neutral.backgroundColor,"--CircularProgress-progressColor":(r=t.variants.solid)==null?void 0:r[e.color].backgroundColor},e.variant==="solid"&&{"--CircularProgress-trackColor":(i=t.variants.softHover)==null?void 0:i[e.color].backgroundColor,"--CircularProgress-progressColor":(a=t.variants.solid)==null?void 0:a[e.color].backgroundColor})}),rre=nn("svg",{name:"JoyCircularProgress",slot:"Svg",overridesResolver:(e,t)=>t.svg})({width:"inherit",height:"inherit",display:"inherit",boxSizing:"inherit",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))"}),ire=nn("circle",{name:"JoyCircularProgress",slot:"track",overridesResolver:(e,t)=>t.track})({cx:"50%",cy:"50%",r:"calc(var(--_inner-size) / 2 - var(--_track-thickness) / 2 + min(0px, var(--_thickness-diff) / 2))",fill:"transparent",strokeWidth:"var(--_track-thickness)",stroke:"var(--CircularProgress-trackColor)"}),ore=nn("circle",{name:"JoyCircularProgress",slot:"progress",overridesResolver:(e,t)=>t.progress})({"--_progress-radius":"calc(var(--_inner-size) / 2 - var(--_progress-thickness) / 2 - max(0px, var(--_thickness-diff) / 2))","--_progress-length":"calc(2 * 3.1415926535 * var(--_progress-radius))",cx:"50%",cy:"50%",r:"var(--_progress-radius)",fill:"transparent",strokeWidth:"var(--_progress-thickness)",stroke:"var(--CircularProgress-progressColor)",strokeLinecap:"var(--CircularProgress-linecap, round)",strokeDasharray:"var(--_progress-length)",strokeDashoffset:"calc(var(--_progress-length) - var(--CircularProgress-percent) * var(--_progress-length) / 100)",transformOrigin:"center",transform:"rotate(-90deg)"},({ownerState:e})=>!e.determinate&&m6(zO||(zO=Kne`
      animation: var(--CircularProgress-circulation, 0.8s linear 0s infinite normal none running)
        ${0};
    `),ere)),M3=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyCircularProgress"}),{children:i,className:a,color:c="primary",size:s="md",variant:f="soft",thickness:g,determinate:_=!1,value:x=_?0:25,component:C,slots:E={},slotProps:A={}}=r,L=Un(r,Qne),I=ue({},r,{color:c,size:s,variant:f,thickness:g,value:x,determinate:_,instanceSize:t.size}),T=tre(I),O=ue({},L,{component:C,slots:E,slotProps:A}),[D,U]=wn("root",{ref:n,className:_i(T.root,a),elementType:nre,externalForwardedProps:O,ownerState:I,additionalProps:ue({role:"progressbar",style:{"--CircularProgress-percent":x}},x&&_&&{"aria-valuenow":Math.round(typeof x=="number"?x:Number(x||0))})}),[H,V]=wn("svg",{className:T.svg,elementType:rre,externalForwardedProps:O,ownerState:I}),[q,Q]=wn("track",{className:T.track,elementType:ire,externalForwardedProps:O,ownerState:I}),[K,N]=wn("progress",{className:T.progress,elementType:ore,externalForwardedProps:O,ownerState:I});return te.jsxs(D,ue({},U,{children:[te.jsxs(H,ue({},V,{children:[te.jsx(q,ue({},Q)),te.jsx(K,ue({},N))]})),i]}))}),sre=["children","action","component","color","disabled","variant","loading","loadingIndicator","size","slots","slotProps"],are=e=>{const{color:t,disabled:n,focusVisible:r,focusVisibleClassName:i,size:a,variant:c,loading:s}=e,f={root:["root",n&&"disabled",r&&"focusVisible",c&&`variant${mn(c)}`,t&&`color${mn(t)}`,a&&`size${mn(a)}`,s&&"loading"],loadingIndicator:["loadingIndicator"]},g=vr(f,Zne,{});return r&&i&&(g.root+=` ${i}`),g},N_=nn("button")(({theme:e,ownerState:t})=>{var n,r,i,a;return[ue({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon},t.instanceSize&&{"--IconButton-size":{sm:"2rem",md:"2.25rem",lg:"2.75rem"}[t.instanceSize]},t.size==="sm"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.6)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:e.vars.fontSize.sm,paddingInline:"2px"},t.size==="md"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.25rem) / 1.5)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2.25rem)",minHeight:"var(--IconButton-size, 2.25rem)",fontSize:e.vars.fontSize.md,paddingInline:"0.25rem"},t.size==="lg"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.75rem) / 1.571)","--CircularProgress-size":"28px","--CircularProgress-thickness":"4px",minWidth:"var(--IconButton-size, 2.75rem)",minHeight:"var(--IconButton-size, 2.75rem)",fontSize:e.vars.fontSize.lg,paddingInline:"0.375rem"},{WebkitTapHighlightColor:"transparent",paddingBlock:0,fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.md,margin:"var(--IconButton-margin)",borderRadius:`var(--IconButton-radius, ${e.vars.radius.sm})`,border:"none",boxSizing:"border-box",backgroundColor:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",[e.focus.selector]:ue({"--Icon-color":"currentColor"},e.focus.default)}),ue({},(n=e.variants[t.variant])==null?void 0:n[t.color],{"&:hover":{"@media (hover: hover)":ue({"--Icon-color":"currentColor"},(r=e.variants[`${t.variant}Hover`])==null?void 0:r[t.color])},'&:active, &[aria-pressed="true"]':ue({"--Icon-color":"currentColor"},(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color]),"&:disabled":(a=e.variants[`${t.variant}Disabled`])==null?void 0:a[t.color]})]}),lre=nn(N_,{name:"JoyIconButton",slot:"Root",overridesResolver:(e,t)=>t.root})({}),cre=nn("span",{name:"JoyIconButton",slot:"LoadingIndicator",overridesResolver:(e,t)=>t.loadingIndicator})(({theme:e,ownerState:t})=>{var n,r;return ue({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=e.variants[t.variant])==null||(n=n[t.color])==null?void 0:n.color},t.disabled&&{color:(r=e.variants[`${t.variant}Disabled`])==null||(r=r[t.color])==null?void 0:r.color})}),lu=$.forwardRef(function(t,n){var r;const i=br({props:t,name:"JoyIconButton"}),{children:a,action:c,component:s="button",color:f="neutral",disabled:g,variant:_="plain",loading:x=!1,loadingIndicator:C,size:E="md",slots:A={},slotProps:L={}}=i,I=Un(i,sre),T=$.useContext(S3),O=$.useContext(u8),D=t.variant||T.variant||_,U=t.size||T.size||E,H=t.color||T.color||f,V=(r=t.loading||t.disabled)!=null?r:T.disabled||x||g,q=$.useRef(null),Q=Br(q,n),{focusVisible:K,setFocusVisible:N,getRootProps:re}=_c(ue({},i,{disabled:V,rootRef:Q})),ye=C??te.jsx(M3,{color:H,thickness:{sm:2,md:3,lg:4}[U]||3});$.useImperativeHandle(c,()=>({focusVisible:()=>{var ct;N(!0),(ct=q.current)==null||ct.focus()}}),[N]);const ge=ue({},i,{component:s,color:H,disabled:V,variant:D,loading:x,size:U,focusVisible:K,instanceSize:t.size}),Ve=are(ge),Ie=ct=>{var Xt;let je=i.onClick;if(typeof L.root=="function"?je=L.root(ge).onClick:L.root&&(je=L.root.onClick),(Xt=je)==null||Xt(ct),O){var lt;(lt=O.onClick)==null||lt.call(O,ct,i.value)}};let ve=i["aria-pressed"];typeof L.root=="function"?ve=L.root(ge)["aria-pressed"]:L.root&&(ve=L.root["aria-pressed"]),O!=null&&O.value&&(Array.isArray(O.value)?ve=O.value.indexOf(i.value)!==-1:ve=O.value===i.value);const Se=ue({},I,{component:s,slots:A,slotProps:L}),[Me,Be]=wn("root",{ref:n,className:Ve.root,elementType:lre,getSlotProps:re,externalForwardedProps:Se,ownerState:ge,additionalProps:{onClick:Ie,"aria-pressed":ve}}),[Qe,st]=wn("loadingIndicator",{className:Ve.loadingIndicator,elementType:cre,externalForwardedProps:Se,ownerState:ge});return te.jsx(Me,ue({},Be,{children:x?te.jsx(Qe,ue({},st,{children:ye})):a}))});lu.muiName="IconButton";function ure(e){return xr("MuiChip",e)}const uA=mr("MuiChip",["root","clickable","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","disabled","endDecorator","focusVisible","label","labelSm","labelMd","labelLg","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantSolid","variantSoft","variantOutlined"]),h8=$.createContext({disabled:void 0,variant:void 0,color:void 0}),hre=["children","className","color","onClick","disabled","size","variant","startDecorator","endDecorator","component","slots","slotProps"],dre=e=>{const{disabled:t,size:n,color:r,clickable:i,variant:a,focusVisible:c}=e,s={root:["root",t&&"disabled",r&&`color${mn(r)}`,n&&`size${mn(n)}`,a&&`variant${mn(a)}`,i&&"clickable"],action:["action",t&&"disabled",c&&"focusVisible"],label:["label",n&&`label${mn(n)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return vr(s,ure,{})},fre=nn("div",{name:"JoyChip",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r,i;const a=(n=e.variants[t.variant])==null?void 0:n[t.color],{borderRadius:c}=Uf({theme:e,ownerState:t},["borderRadius"]);return[ue({"--Chip-decoratorChildOffset":"min(calc(var(--Chip-paddingInline) - (var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2), var(--Chip-paddingInline))","--Chip-decoratorChildRadius":"max(var(--_Chip-radius) - var(--variant-borderWidth, 0px) - var(--_Chip-paddingBlock), min(var(--_Chip-paddingBlock) + var(--variant-borderWidth, 0px), var(--_Chip-radius) / 2))","--Chip-deleteRadius":"var(--Chip-decoratorChildRadius)","--Chip-deleteSize":"var(--Chip-decoratorChildHeight)","--Avatar-radius":"var(--Chip-decoratorChildRadius)","--Avatar-size":"var(--Chip-decoratorChildHeight)","--Icon-margin":"initial","--Icon-color":"currentColor","--unstable_actionRadius":"var(--_Chip-radius)"},t.size==="sm"&&{"--Chip-paddingInline":"0.375rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.sm,"--_Chip-minHeight":"var(--Chip-minHeight, 1.25rem)",gap:"3px"},t.size==="md"&&{"--Chip-paddingInline":"0.5rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.25rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.md,"--_Chip-minHeight":"var(--Chip-minHeight, 1.5rem)",gap:"0.25rem"},t.size==="lg"&&{"--Chip-paddingInline":"0.75rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.375rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":e.vars.fontSize.lg,"--_Chip-minHeight":"var(--Chip-minHeight, 1.75rem)",gap:"0.375rem"},{"--_Chip-radius":"var(--Chip-radius, 1.5rem)","--_Chip-paddingBlock":"max((var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2, 0px)",minHeight:"var(--_Chip-minHeight)",maxWidth:"max-content",paddingInline:"var(--Chip-paddingInline)",borderRadius:"var(--_Chip-radius)",position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",textDecoration:"none",verticalAlign:"middle",boxSizing:"border-box"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],{fontWeight:e.vars.fontWeight.md,[`&.${uA.disabled}`]:{color:(r=e.variants[`${t.variant}Disabled`])==null||(r=r[t.color])==null?void 0:r.color}}),...t.clickable?[{"--variant-borderWidth":"0px",color:a==null?void 0:a.color}]:[ue({backgroundColor:e.vars.palette.background.surface},a,{[`&.${uA.disabled}`]:(i=e.variants[`${t.variant}Disabled`])==null?void 0:i[t.color]})],c!==void 0&&{"--_Chip-radius":c}]}),pre=nn("span",{name:"JoyChip",slot:"Label",overridesResolver:(e,t)=>t.label})(({ownerState:e})=>ue({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",order:1,minInlineSize:0,flexGrow:1},e.clickable&&{zIndex:1,pointerEvents:"none"})),mre=nn("button",{name:"JoyChip",slot:"Action",overridesResolver:(e,t)=>t.action})(({theme:e,ownerState:t})=>{var n,r,i,a;return[{"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,position:"absolute",zIndex:0,top:0,left:0,bottom:0,right:0,width:"100%",border:"none",cursor:"pointer",padding:"initial",margin:"initial",backgroundColor:"initial",textDecoration:"none",borderRadius:"inherit",[e.focus.selector]:e.focus.default},ue({backgroundColor:e.vars.palette.background.surface},(n=e.variants[t.variant])==null?void 0:n[t.color]),{"&:hover":{"@media (hover: hover)":(r=e.variants[`${t.variant}Hover`])==null?void 0:r[t.color]}},{"&:active":(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color]},{[`&.${uA.disabled}`]:(a=e.variants[`${t.variant}Disabled`])==null?void 0:a[t.color]}]}),gre=nn("span",{name:"JoyChip",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Avatar-marginInlineStart":"calc(var(--Chip-decoratorChildOffset) * -1)","--IconButton-margin":"0 calc(-1 * var(--Chip-paddingInline) / 3) 0 calc(var(--Chip-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Chip-paddingInline) / -4)",display:"inherit",order:0,zIndex:1,pointerEvents:"none"}),vre=nn("span",{name:"JoyChip",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--IconButton-margin":"0 calc(var(--Chip-decoratorChildOffset) * -1) 0 calc(-1 * var(--Chip-paddingInline) / 3)","--Icon-margin":"0 calc(var(--Chip-paddingInline) / -4) 0 0",display:"inherit",order:2,zIndex:1,pointerEvents:"none"}),d8=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyChip"}),{children:i,className:a,color:c="neutral",onClick:s,disabled:f=!1,size:g="md",variant:_="soft",startDecorator:x,endDecorator:C,component:E,slots:A={},slotProps:L={}}=r,I=Un(r,hre),T=!!s||!!L.action,O=ue({},r,{disabled:f,size:g,color:c,variant:_,clickable:T,focusVisible:!1}),D=typeof L.action=="function"?L.action(O):L.action,U=$.useRef(null),{focusVisible:H,getRootProps:V}=_c(ue({},D,{disabled:f,rootRef:U}));O.focusVisible=H;const q=dre(O),Q=ue({},I,{component:E,slots:A,slotProps:L}),[K,N]=wn("root",{ref:n,className:_i(q.root,a),elementType:fre,externalForwardedProps:Q,ownerState:O}),[re,ye]=wn("label",{className:q.label,elementType:pre,externalForwardedProps:Q,ownerState:O}),ge=Gs(ye.id),[Ve,Ie]=wn("action",{className:q.action,elementType:mre,externalForwardedProps:Q,ownerState:O,getSlotProps:V,additionalProps:{"aria-labelledby":ge,as:D==null?void 0:D.component,onClick:s}}),[ve,Se]=wn("startDecorator",{className:q.startDecorator,elementType:gre,externalForwardedProps:Q,ownerState:O}),[Me,Be]=wn("endDecorator",{className:q.endDecorator,elementType:vre,externalForwardedProps:Q,ownerState:O}),Qe=$.useMemo(()=>({disabled:f}),[f]);return te.jsx(h8.Provider,{value:Qe,children:te.jsx(CM,{variant:_,color:c,children:te.jsxs(K,ue({},N,{children:[T&&te.jsx(Ve,ue({},Ie)),te.jsx(re,ue({},ye,{id:ge,children:i})),x&&te.jsx(ve,ue({},Se,{children:x})),C&&te.jsx(Me,ue({},Be,{children:C}))]}))})})}),yre=Og(te.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Cancel");function _re(e){return xr("MuiChipDelete",e)}mr("MuiChipDelete",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSolid","variantSoft","variantOutlined"]);var OO;const xre=["children","variant","color","disabled","onKeyDown","onDelete","onClick","component","slots","slotProps"],bre=["onDelete"],wre=e=>{const{focusVisible:t,variant:n,color:r,disabled:i}=e,a={root:["root",i&&"disabled",t&&"focusVisible",n&&`variant${mn(n)}`,r&&`color${mn(r)}`]};return vr(a,_re,{})},Sre=nn(N_,{name:"JoyChipDelete",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({"--IconButton-size":"var(--Chip-deleteSize, 2rem)","--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.3)",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:e.vars.fontSize.sm,paddingInline:"2px",pointerEvents:"visible",borderRadius:"var(--Chip-deleteRadius, 50%)",zIndex:1,padding:0})),Mre=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyChipDelete"}),{children:i,variant:a="plain",color:c="neutral",disabled:s,onKeyDown:f,onDelete:g,onClick:_,component:x,slots:C={},slotProps:E={}}=r,A=Un(r,xre),L=$.useContext(h8),{variant:I=a,color:T=c}=MM(t.variant,t.color,!0),O=t.color||T,D=s??L.disabled,U=$.useRef(null),H=Br(U,n),{focusVisible:V,getRootProps:q}=_c(ue({},r,{disabled:D,rootRef:H})),Q=ue({},r,{disabled:D,variant:I,color:O,focusVisible:V}),K=wre(Q),N=ue({},A,{component:x,slots:C,slotProps:E}),re=ve=>{!D&&g&&g(ve),_&&_(ve)},ye=ve=>{["Backspace","Enter","Delete"].includes(ve.key)&&(ve.preventDefault(),!D&&g&&g(ve)),f&&f(ve)},[ge,Ve]=wn("root",{ref:n,elementType:Sre,getSlotProps:q,externalForwardedProps:N,ownerState:Q,additionalProps:{as:x,onKeyDown:ye,onClick:re},className:K.root}),Ie=Un(Ve,bre);return te.jsx(ge,ue({},Ie,{children:i??(OO||(OO=te.jsx(yre,{})))}))});function Cre(e){return xr("MuiInput",e)}const f8=mr("MuiInput",["root","input","formControl","focused","disabled","error","adornedStart","adornedEnd","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid","fullWidth","startDecorator","endDecorator"]),EM=$.createContext(void 0),Ere=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoFocus","className","defaultValue","disabled","disabledInProp","error","id","name","onClick","onChange","onKeyDown","onKeyUp","onFocus","onBlur","placeholder","readOnly","required","type","value"];function Tre(e,t){var n;const r=$.useContext(EM),{"aria-describedby":i,"aria-label":a,"aria-labelledby":c,autoComplete:s,autoFocus:f,className:g,defaultValue:_,disabled:x,disabledInProp:C,error:E,id:A,name:L,onClick:I,onChange:T,onKeyDown:O,onKeyUp:D,onFocus:U,onBlur:H,placeholder:V,readOnly:q,required:Q,type:K,value:N}=e,re=Un(e,Ere),{getRootProps:ye,getInputProps:ge,focused:Ve,error:Ie,disabled:ve}=iJ({disabled:(n=C??(r==null?void 0:r.disabled))!=null?n:x,defaultValue:_,error:E,onBlur:H,onClick:I,onChange:T,onFocus:U,required:Q??(r==null?void 0:r.required),value:N}),Se={[t.disabled]:ve,[t.error]:Ie,[t.focused]:Ve,[t.formControl]:!!r,[g]:g},Me={[t.disabled]:ve};return ue({formControl:r,propsToForward:{"aria-describedby":i,"aria-label":a,"aria-labelledby":c,autoComplete:s,autoFocus:f,disabled:ve,id:A,onKeyDown:O,onKeyUp:D,name:L,placeholder:V,readOnly:q,type:K},rootStateClasses:Se,inputStateClasses:Me,getRootProps:ye,getInputProps:ge,focused:Ve,error:Ie,disabled:ve},re)}const Pre=["propsToForward","rootStateClasses","inputStateClasses","getRootProps","getInputProps","formControl","focused","error","disabled","fullWidth","size","color","variant","startDecorator","endDecorator","component","slots","slotProps"],Are=e=>{const{disabled:t,fullWidth:n,variant:r,color:i,size:a}=e,c={root:["root",t&&"disabled",n&&"fullWidth",r&&`variant${mn(r)}`,i&&`color${mn(i)}`,a&&`size${mn(a)}`],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return vr(c,Cre,{})},p8=nn("div")(({theme:e,ownerState:t})=>{var n,r,i,a,c,s;const f=(n=e.variants[`${t.variant}`])==null?void 0:n[t.color];return[ue({"--Input-radius":e.vars.radius.sm,"--Input-gap":"0.5rem","--Input-placeholderColor":"inherit","--Input-placeholderOpacity":.64,"--Input-decoratorColor":e.vars.palette.text.icon,"--Input-focused":"0","--Input-focusedThickness":e.vars.focus.thickness,"--Input-focusedHighlight":(r=e.vars.palette[t.color==="neutral"?"primary":t.color])==null?void 0:r[500],[`&:not([${vg}])`]:ue({},t.instanceColor&&{"--_Input-focusedHighlight":(i=e.vars.palette[t.instanceColor==="neutral"?"primary":t.instanceColor])==null?void 0:i[500]},{"--Input-focusedHighlight":`var(--_Input-focusedHighlight, ${e.vars.palette.focusVisible})`})},t.size==="sm"&&{"--Input-minHeight":"2rem","--Input-paddingInline":"0.5rem","--Input-decoratorChildHeight":"min(1.5rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl},t.size==="md"&&{"--Input-minHeight":"2.25rem","--Input-paddingInline":"0.75rem","--Input-decoratorChildHeight":"min(1.75rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},t.size==="lg"&&{"--Input-minHeight":"2.75rem","--Input-paddingInline":"1rem","--Input-gap":"0.75rem","--Input-decoratorChildHeight":"min(2.25rem, var(--Input-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},{"--Input-decoratorChildOffset":"min(calc(var(--Input-paddingInline) - (var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2), var(--Input-paddingInline))","--_Input-paddingBlock":"max((var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2, 0px)","--Input-decoratorChildRadius":"max(var(--Input-radius) - var(--variant-borderWidth, 0px) - var(--_Input-paddingBlock), min(var(--_Input-paddingBlock) + var(--variant-borderWidth, 0px), var(--Input-radius) / 2))","--Button-minHeight":"var(--Input-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Input-decoratorChildHeight)","--Button-radius":"var(--Input-decoratorChildRadius)","--IconButton-radius":"var(--Input-decoratorChildRadius)",boxSizing:"border-box"},t.variant!=="plain"&&{boxShadow:e.shadow.xs},{minWidth:0,minHeight:"var(--Input-minHeight)"},t.fullWidth&&{width:"100%"},{cursor:"text",position:"relative",display:"flex",paddingInline:"var(--Input-paddingInline)",borderRadius:"var(--Input-radius)"},e.typography[`body-${t.size}`],f,{backgroundColor:(a=f==null?void 0:f.backgroundColor)!=null?a:e.vars.palette.background.surface,"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)",boxShadow:"var(--Input-focusedInset, inset) 0 0 0 calc(var(--Input-focused) * var(--Input-focusedThickness)) var(--Input-focusedHighlight)"}}),{"&:hover":ue({},(c=e.variants[`${t.variant}Hover`])==null?void 0:c[t.color],{backgroundColor:null}),[`&.${f8.disabled}`]:(s=e.variants[`${t.variant}Disabled`])==null?void 0:s[t.color],"&:focus-within::before":{"--Input-focused":"1"}}]}),m8=nn("input")(({ownerState:e})=>({border:"none",minWidth:0,outline:0,padding:0,flex:1,color:"inherit",backgroundColor:"transparent",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"inherit",textOverflow:"ellipsis","&:-webkit-autofill":ue({paddingInline:"var(--Input-paddingInline)"},!e.startDecorator&&{marginInlineStart:"calc(-1 * var(--Input-paddingInline))",paddingInlineStart:"var(--Input-paddingInline)",borderTopLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"},!e.endDecorator&&{marginInlineEnd:"calc(-1 * var(--Input-paddingInline))",paddingInlineEnd:"var(--Input-paddingInline)",borderTopRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"}),"&::-webkit-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-moz-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&:-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"}})),g8=nn("div")({"--Button-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Input-paddingInline) / -4)",display:"inherit",alignItems:"center",paddingBlock:"var(--unstable_InputPaddingBlock)",flexWrap:"wrap",marginInlineEnd:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),v8=nn("div")({"--Button-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Input-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",marginInlineStart:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),Ire=nn(p8,{name:"JoyInput",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Rre=nn(m8,{name:"JoyInput",slot:"Input",overridesResolver:(e,t)=>t.input})({}),Lre=nn(g8,{name:"JoyInput",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({}),kre=nn(v8,{name:"JoyInput",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({}),Dre=$.forwardRef(function(t,n){var r,i,a,c,s,f;const g=br({props:t,name:"JoyInput"}),_=Tre(ue({},g,{disabledInProp:t.disabled}),f8),{propsToForward:x,rootStateClasses:C,inputStateClasses:E,getRootProps:A,getInputProps:L,formControl:I,focused:T,error:O=!1,disabled:D,fullWidth:U=!1,size:H="md",color:V="neutral",variant:q="outlined",startDecorator:Q,endDecorator:K,component:N,slots:re={},slotProps:ye={}}=_,ge=Un(_,Pre),Ve=(r=(i=t.error)!=null?i:I==null?void 0:I.error)!=null?r:O,Ie=(a=(c=t.size)!=null?c:I==null?void 0:I.size)!=null?a:H,ve=(s=t.color)!=null?s:Ve?"danger":(f=I==null?void 0:I.color)!=null?f:V,Se=ue({instanceColor:Ve?"danger":t.color},g,{fullWidth:U,color:ve,disabled:D,error:Ve,focused:T,size:Ie,variant:q}),Me=Are(Se),Be=ue({},ge,{component:N,slots:re,slotProps:ye}),[Qe,st]=wn("root",{ref:n,className:[Me.root,C],elementType:Ire,getSlotProps:A,externalForwardedProps:Be,ownerState:Se}),[ct,Xt]=wn("input",ue({},I&&{additionalProps:{id:I.htmlFor,"aria-describedby":I["aria-describedby"]}},{className:[Me.input,E],elementType:Rre,getSlotProps:L,internalForwardedProps:x,externalForwardedProps:Be,ownerState:Se})),[je,lt]=wn("startDecorator",{className:Me.startDecorator,elementType:Lre,externalForwardedProps:Be,ownerState:Se}),[Ot,ut]=wn("endDecorator",{className:Me.endDecorator,elementType:kre,externalForwardedProps:Be,ownerState:Se});return te.jsxs(Qe,ue({},st,{children:[Q&&te.jsx(je,ue({},lt,{children:Q})),te.jsx(ct,ue({},Xt)),K&&te.jsx(Ot,ue({},ut,{children:K}))]}))});function zre(e){return xr("MuiListSubheader",e)}mr("MuiListSubheader",["root","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const Ore=["component","className","children","id","sticky","variant","color","slots","slotProps"],Fre=e=>{const{variant:t,color:n,sticky:r}=e,i={root:["root",r&&"sticky",n&&`color${mn(n)}`,t&&`variant${mn(t)}`]};return vr(i,zre,{})},Nre=nn("div",{name:"JoyListSubheader",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r;return ue({boxSizing:"border-box",display:"flex",alignItems:"center",marginInline:"var(--ListItem-marginInline)",paddingBlock:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)",minBlockSize:"var(--ListItem-minHeight)"},e.typography["body-xs"],{fontSize:"max(0.75em, 0.625rem)",textTransform:"uppercase",letterSpacing:"0.1em"},t.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:"var(--ListItem-stickyBackground)"},{color:t.color?`var(--_Link-color, rgba(${(n=e.vars.palette[t.color])==null?void 0:n.mainChannel} / 1))`:e.vars.palette.text.tertiary},t.instanceColor&&{[`&:not([${vg}])`]:{"--_Link-color":e.vars.palette.text.secondary}},(r=e.variants[t.variant])==null?void 0:r[t.color])}),Bre=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyListSubheader"}),{component:i,className:a,children:c,id:s,sticky:f=!1,variant:g,color:_,slots:x={},slotProps:C={}}=r,E=Un(r,Ore),A=Gs(s),L=$.useContext(o8);$.useEffect(()=>{L&&L(A||"")},[L,A]);const I=ue({instanceColor:t.color},r,{id:A,sticky:f,variant:g,color:g?_??"neutral":_}),T=Fre(I),O=ue({},E,{component:i,slots:x,slotProps:C}),[D,U]=wn("root",{ref:n,className:_i(T.root,a),elementType:Nre,externalForwardedProps:O,ownerState:I,additionalProps:{as:i,id:A}});return te.jsx(D,ue({},U,{children:c}))});function Ure(e){return xr("MuiAutocomplete",e)}const hh=mr("MuiAutocomplete",["root","wrapper","input","startDecorator","endDecorator","formControl","focused","disabled","error","multiple","limitTag","hasPopupIcon","hasClearIcon","clearIndicator","popupIndicator","popupIndicatorOpen","listbox","option","loading","noOptions","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]),y8=nn(k_)(({theme:e,ownerState:t})=>{var n;const r=(n=e.variants[t.variant])==null?void 0:n[t.color];return ue({"--focus-outline-offset":`calc(${e.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":(r==null?void 0:r.backgroundColor)||(r==null?void 0:r.background)||e.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},SM,{boxShadow:e.shadow.md,borderRadius:`var(--List-radius, ${e.vars.radius.sm})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:e.vars.palette.background.popup},{zIndex:e.vars.zIndex.popup,overflow:"auto",maxHeight:"40vh",position:"relative","&:empty":{visibility:"hidden"},[`& .${qw.nested}, & .${qw.nested} .${Nne.root}`]:{position:"initial"}})});nn(y8,{name:"JoyAutocompleteListbox",slot:"Root",overridesResolver:(e,t)=>t.root})({});function $re(e){return xr("MuiAutocompleteOption",e)}mr("MuiAutocompleteOption",["root","focused","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const Vre=["children","component","color","variant","className","slots","slotProps"],jre=e=>{const{color:t,variant:n}=e,r={root:["root",t&&`color${mn(t)}`,n&&`variant${mn(n)}`]};return vr(r,$re,{})},_8=nn(z_)(({theme:e,ownerState:t})=>{var n,r;return{'&[aria-disabled="true"]':(n=e.variants[`${t.variant}Disabled`])==null?void 0:n[t.color],'&[aria-selected="true"]':ue({},(r=e.variants[`${t.variant}Active`])==null?void 0:r[t.color],{fontWeight:e.vars.fontWeight.md})}}),Hre=nn(_8,{name:"JoyAutocompleteOption",slot:"Root",overridesResolver:(e,t)=>t.root})({}),x8=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyAutocompleteOption"}),{children:i,component:a="li",color:c="neutral",variant:s="plain",className:f,slots:g={},slotProps:_={}}=r,x=Un(r,Vre),{variant:C=s,color:E=c}=MM(t.variant,t.color),A=ue({},r,{component:a,color:E,variant:C}),L=jre(A),I=ue({},x,{component:a,slots:g,slotProps:_}),[T,O]=wn("root",{ref:n,className:_i(L.root,f),elementType:Hre,externalForwardedProps:I,ownerState:A,additionalProps:{as:a,role:"option"}});return te.jsx(T,ue({},O,{children:i}))});var FO,NO;const Gre=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoHighlight","autoSelect","autoFocus","blurOnSelect","clearIcon","clearOnBlur","clearOnEscape","clearText","closeText","defaultValue","disableCloseOnSelect","disabledItemsFocusable","disableListWrap","disableClearable","disabled","endDecorator","error","filterOptions","filterSelectedOptions","forcePopupIcon","freeSolo","getLimitTagsText","getOptionDisabled","getOptionKey","getOptionLabel","handleHomeEndKeys","includeInputInList","isOptionEqualToValue","groupBy","id","inputValue","limitTags","loading","loadingText","multiple","name","noOptionsText","onChange","onClose","onHighlightChange","onInputChange","onOpen","open","openOnFocus","openText","options","placeholder","popupIcon","readOnly","renderGroup","renderOption","renderTags","required","type","startDecorator","size","color","variant","value","component","selectOnFocus","slots","slotProps"],Wre=["onDelete"],qre=["key"],Xre=["onBlur","onFocus","onMouseDown"],Zre=["key"],Yre=e=>e.current!==null&&e.current.contains(document.activeElement),Kre=e=>{var t;return(t=e.label)!=null?t:e},Jre=e=>`+${e}`,Qre=e=>te.jsxs(Jh,{nested:!0,children:[te.jsx(Bre,{sticky:!0,children:e.group}),te.jsx(D_,{children:e.children})]},e.key),eie=e=>{const{disabled:t,focused:n,hasClearIcon:r,hasPopupIcon:i,popupOpen:a,variant:c,color:s,size:f,multiple:g}=e,_={root:["root",n&&"focused",r&&"hasClearIcon",i&&"hasPopupIcon",c&&`variant${mn(c)}`,s&&`color${mn(s)}`,f&&`size${mn(f)}`],wrapper:["wrapper",g&&"multiple"],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",a&&"popupIndicatorOpen",t&&"disabled"],listbox:["listbox"],option:["option"],loading:["loading"],noOptions:["noOptions"],limitTag:["limitTag"]};return vr(_,Ure,{})},tie=nn(p8,{name:"JoyAutocomplete",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>ue({},e.size==="sm"&&{"--Autocomplete-wrapperGap":"3px"},e.size==="md"&&{"--Autocomplete-wrapperGap":"3px"},e.size==="lg"&&{"--Autocomplete-wrapperGap":"4px"},{"@media (pointer: fine)":{[`&:hover .${hh.clearIndicator}`]:{visibility:"visible"}}},e.multiple&&!e.startDecorator&&{paddingInlineStart:0})),nie=nn("div",{name:"JoyAutocomplete",slot:"Wrapper",overridesResolver:(e,t)=>t.wrapper})(({ownerState:e})=>({flex:1,minWidth:0,display:"flex",alignItems:"center",flexWrap:"wrap",gap:"var(--Autocomplete-wrapperGap)",[`&.${hh.multiple}`]:ue({paddingBlock:"var(--Autocomplete-wrapperGap)"},!e.startDecorator&&{paddingInlineStart:"var(--Autocomplete-wrapperGap)"},!e.endDecorator&&{paddingInlineEnd:"var(--Autocomplete-wrapperGap)"})})),rie=nn(m8,{name:"JoyAutocomplete",slot:"Input",overridesResolver:(e,t)=>t.input})(({ownerState:e})=>ue({minWidth:30,minHeight:"var(--Chip-minHeight)"},e.multiple&&{marginInlineStart:"calc(var(--Autocomplete-wrapperGap) * 2.5)"})),iie=nn(g8,{name:"JoyAutocomplete",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({}),oie=nn(v8,{name:"JoyAutocomplete",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})(({ownerState:e})=>ue({},(e.hasClearIcon||e.hasPopupIcon)&&{"--Button-margin":"0px","--IconButton-margin":"0px","--Icon-margin":"0px"})),sie=nn(N_,{name:"JoyAutocomplete",slot:"ClearIndicator",overridesResolver:(e,t)=>t.clearIndicator})(({ownerState:e})=>ue({alignSelf:"center"},!e.hasPopupIcon&&{marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)"},{marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",visibility:e.focused?"visible":"hidden"})),aie=nn(N_,{name:"JoyAutocomplete",slot:"PopupIndicator",overridesResolver:(e,t)=>t.popupIndicator})({alignSelf:"center",marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)",[`&.${hh.popupIndicatorOpen}`]:{transform:"rotate(180deg)","--Icon-color":"currentColor"}}),lie=nn(y8,{name:"JoyAutocomplete",slot:"Listbox",overridesResolver:(e,t)=>t.listbox})(({theme:e})=>({zIndex:`var(--unstable_popup-zIndex, ${e.vars.zIndex.popup})`})),cie=nn(_8,{name:"JoyAutocomplete",slot:"Option",overridesResolver:(e,t)=>t.option})({}),uie=nn(Jh,{name:"JoyAutocomplete",slot:"Loading",overridesResolver:(e,t)=>t.loading})(({theme:e})=>({color:(e.vars||e).palette.text.secondary})),hie=nn(Jh,{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(e,t)=>t.noOptions})(({theme:e})=>({color:(e.vars||e).palette.text.secondary})),die=nn("div",{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(e,t)=>t.noOptions})({marginInlineStart:"calc(var(--Input-paddingInline) / 2)",marginBlockStart:"var(--_Input-paddingBlock)"}),Qy=$.forwardRef(function(t,n){var r,i,a,c,s,f,g;const _=br({props:t,name:"JoyAutocomplete"}),{"aria-describedby":x,"aria-label":C,"aria-labelledby":E,autoFocus:A,clearIcon:L=FO||(FO=te.jsx(l8,{fontSize:"md"})),clearText:I="Clear",closeText:T="Close",disableClearable:O=!1,disabled:D,endDecorator:U,error:H=!1,forcePopupIcon:V="auto",freeSolo:q=!1,getLimitTagsText:Q=Jre,getOptionLabel:K=Kre,groupBy:N,id:re,limitTags:ye=-1,loading:ge=!1,loadingText:Ve="Loading…",multiple:Ie=!1,name:ve,noOptionsText:Se="No options",openText:Me="Open",placeholder:Be,popupIcon:Qe=NO||(NO=te.jsx(Xne,{})),readOnly:st=!1,renderGroup:ct=Qre,renderOption:Xt,renderTags:je,required:lt,type:Ot,startDecorator:ut,size:ot="md",color:Tt="neutral",variant:Ct="outlined",component:un,slots:gn={},slotProps:hn={}}=_,We=Un(_,Gre),vn=$.useContext(EM),Ut=(r=(i=t.error)!=null?i:vn==null?void 0:vn.error)!=null?r:H,tn=(a=(c=t.size)!=null?c:vn==null?void 0:vn.size)!=null?a:ot,Dt=(s=t.color)!=null?s:Ut?"danger":(f=vn==null?void 0:vn.color)!=null?f:Tt,An=(g=D??(vn==null?void 0:vn.disabled))!=null?g:!1,{getRootProps:an,getInputProps:Le,getPopupIndicatorProps:me,getClearProps:it,getTagProps:St,getListboxProps:It,getOptionProps:wt,value:Zt,dirty:Lt,popupOpen:kt,focused:bn,focusedTag:zt,anchorEl:_e,setAnchorEl:ee,inputValue:ne,groupedOptions:Z}=Ene(ue({},_,{id:re??(vn==null?void 0:vn.htmlFor),componentName:"Autocomplete",unstable_classNamePrefix:"Mui",unstable_isActiveElementInListbox:Yre})),{onMouseDown:le}=Le(),{onClick:Te}=an(),$e=!O&&!An&&Lt&&!st,fe=(!q||V===!0)&&V!==!1,xe=ue({instanceColor:t.color},_,{value:Zt,disabled:An,focused:bn,getOptionLabel:K,hasOptions:!!Z.length,hasClearIcon:$e,hasPopupIcon:fe,inputFocused:zt===-1,popupOpen:kt,size:tn,color:Dt,variant:Ct}),Re=eie(xe),De=ue({},We,{component:un,slots:gn,slotProps:hn});let ze;if(Ie&&Zt.length>0){const Nt=zn=>{const _n=St(zn),{onDelete:Rn}=_n,jn=Un(_n,Wre);return ue({disabled:An,size:tn,onClick:Rn},jn)};je?ze=je(Zt,Nt,xe):ze=Zt.map((zn,_n)=>{const Rn=Nt({index:_n}),{key:jn}=Rn,hr=Un(Rn,qre);return te.jsx(d8,{size:tn,variant:"soft",color:"neutral",endDecorator:te.jsx(Mre,ue({},hr),jn),sx:{minWidth:0},children:K(zn)},_n)})}const Je=Br(n,ee),Oe={[hh.disabled]:An,[hh.error]:Ut,[hh.focused]:bn,[hh.formControl]:!!vn},[Et,Ft]=wn("root",{ref:Je,className:[Re.root,Oe],elementType:tie,externalForwardedProps:De,ownerState:xe,getSlotProps:an,additionalProps:{onClick:Nt=>{Te&&Te(Nt),Nt.currentTarget===Nt.target&&le&&le(Nt)}}}),[be,qe]=wn("wrapper",{className:Re.wrapper,elementType:nie,externalForwardedProps:De,ownerState:xe}),tt={[hh.disabled]:An},[At,Ht]=wn("input",{className:[Re.input,tt],elementType:rie,getSlotProps:Nt=>{const zn=Le(),{onBlur:_n,onFocus:Rn,onMouseDown:jn}=zn,hr=Un(zn,Xre);return ue({},hr,{onBlur:dr=>{var Zn;_n==null||_n(dr),(Zn=Nt.onBlur)==null||Zn.call(Nt,dr)},onFocus:dr=>{var Zn;Rn==null||Rn(dr),(Zn=Nt.onFocus)==null||Zn.call(Nt,dr)},onMouseDown:dr=>{var Zn;jn==null||jn(dr),(Zn=Nt.onMouseDown)==null||Zn.call(Nt,dr)}})},externalForwardedProps:De,ownerState:xe,additionalProps:{autoFocus:A,placeholder:Be,name:ve,readOnly:st,disabled:An,required:lt??(vn==null?void 0:vn.required),type:Ot,"aria-invalid":Ut||void 0,"aria-label":C,"aria-labelledby":E,"aria-describedby":x??(vn==null?void 0:vn["aria-describedby"])}}),[Yt,qt]=wn("startDecorator",{className:Re.startDecorator,elementType:iie,externalForwardedProps:De,ownerState:xe}),[Gt,yn]=wn("endDecorator",{className:Re.endDecorator,elementType:oie,externalForwardedProps:De,ownerState:xe}),[gt,In]=wn("clearIndicator",{className:Re.clearIndicator,elementType:sie,getSlotProps:it,externalForwardedProps:De,ownerState:xe,getSlotOwnerState:Nt=>({size:Nt.size||tn,variant:Nt.variant||tf(Ct,Dt).variant||"plain",color:Nt.color||tf(Ct,Dt).color||"neutral",disableColorInversion:!!t.color}),additionalProps:{"aria-label":I,title:I}}),[cn,Nn]=wn("popupIndicator",{className:Re.popupIndicator,elementType:aie,getSlotProps:me,externalForwardedProps:De,ownerState:xe,getSlotOwnerState:Nt=>({size:Nt.size||tn,variant:Nt.variant||tf(Ct,Dt).variant||"plain",color:Nt.color||tf(Ct,Dt).color||"neutral",disableColorInversion:!!t.color}),additionalProps:{disabled:An,"aria-label":kt?T:Me,title:kt?T:Me,type:"button"}}),[xt,Ze]=wn("listbox",{className:Re.listbox,elementType:lie,getSlotProps:It,externalForwardedProps:De,ownerState:xe,getSlotOwnerState:Nt=>({size:Nt.size||tn,variant:Nt.variant||Ct,color:Nt.color||Dt,disableColorInversion:!Nt.disablePortal}),additionalProps:{anchorEl:_e,open:kt,style:_e?{width:_e.clientWidth}:{}}}),[Rt,Wt]=wn("loading",{className:Re.loading,elementType:uie,externalForwardedProps:De,ownerState:xe}),[pn,cr]=wn("noOptions",{className:Re.noOptions,elementType:hie,externalForwardedProps:De,ownerState:xe,additionalProps:{role:"presentation",onMouseDown:Nt=>{Nt.preventDefault()}}}),[qn,pe]=wn("limitTag",{className:Re.limitTag,elementType:die,externalForwardedProps:De,ownerState:xe});if(ye>-1&&Array.isArray(ze)){const Nt=ze.length-ye;!bn&&Nt>0&&(ze=ze.splice(0,ye),ze.push(te.jsx(qn,ue({},pe,{children:Q(Nt)}),ze.length)))}const[nt,vt]=wn("option",{className:Re.option,elementType:cie,externalForwardedProps:De,ownerState:xe,getSlotOwnerState:Nt=>({variant:Nt.variant||tf(Ct,Dt).variant||"plain",color:Nt.color||tf(Ct,Dt).color||"neutral",disableColorInversion:!Ze.disablePortal}),additionalProps:{as:"li"}}),at=Xt||((Nt,zn)=>{const{key:_n}=Nt,Rn=Un(Nt,Zre);return te.jsx(nt,ue({},Rn,{children:K(zn)}),_n)}),Kt=(Nt,zn)=>{const _n=wt({option:Nt,index:zn});return at(ue({},vt,_n),Nt,{selected:!!_n["aria-selected"],inputValue:ne,ownerState:xe})},fn=$.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...Ze.modifiers||[]],[Ze.modifiers]);let Qt=null;if(_e){var ln;Qt=te.jsx(CM,{variant:Ct,color:Dt,children:te.jsx(L_,{nested:!0,children:te.jsxs(xt,ue({},Ze,{className:_i(Ze.className),modifiers:fn},!((ln=_.slots)!=null&&ln.listbox)&&{as:_M,slots:{root:Ze.as||"ul"}},{children:[Z.map((Nt,zn)=>{if(N){const _n=Nt;return ct({key:String(_n.key),group:_n.group,children:_n.options.map((Rn,jn)=>Kt(Rn,_n.index+jn))})}return Kt(Nt,zn)}),ge&&Z.length===0?te.jsx(Rt,ue({},Wt,{children:Ve})):null,Z.length===0&&!q&&!ge?te.jsx(pn,ue({},cr,{children:Se})):null]}))})})}return te.jsxs($.Fragment,{children:[te.jsxs(Et,ue({},Ft,{children:[ut&&te.jsx(Yt,ue({},qt,{children:ut})),te.jsxs(be,ue({},qe,{children:[ze,te.jsx(At,ue({},Ht))]})),U&&te.jsx(Gt,ue({},yn,{children:U})),$e?te.jsx(gt,ue({},In,{children:L})):null,fe?te.jsx(cn,ue({},Nn,{children:Qe})):null]})),Qt]})}),fie=P6("MuiBox",["root"]),pie=SY({themeId:v_,defaultTheme:Lg,defaultClassName:fie.root,generateClassName:C6.generate});function mie(e){return xr("MuiTypography",e)}mr("MuiTypography",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","noWrap","gutterBottom","startDecorator","endDecorator","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const gie=["color","textColor"],vie=["component","gutterBottom","noWrap","level","levelMapping","children","endDecorator","startDecorator","variant","slots","slotProps"],hA=$.createContext(!1),yie=$.createContext(!1),_ie=e=>{const{gutterBottom:t,noWrap:n,level:r,color:i,variant:a}=e,c={root:["root",r,t&&"gutterBottom",n&&"noWrap",i&&`color${mn(i)}`,a&&`variant${mn(a)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return vr(c,mie,{})},xie=nn("span",{name:"JoyTypography",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),bie=nn("span",{name:"JoyTypography",slot:"endDecorator",overridesResolver:(e,t)=>t.endDecorator})({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),wie=nn("span",{name:"JoyTypography",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r,i,a,c;const s=t.level!=="inherit"?(n=e.typography[t.level])==null?void 0:n.lineHeight:"1";return ue({"--Icon-fontSize":`calc(1em * ${s})`},t.color&&{"--Icon-color":"currentColor"},{margin:"var(--Typography-margin, 0px)"},t.nesting?{display:"inline"}:ue({display:"block"},t.unstable_hasSkeleton&&{position:"relative"}),(t.startDecorator||t.endDecorator)&&ue({display:"flex",alignItems:"center"},t.nesting&&ue({display:"inline-flex"},t.startDecorator&&{verticalAlign:"bottom"})),t.level&&t.level!=="inherit"&&e.typography[t.level],{fontSize:`var(--Typography-fontSize, ${t.level&&t.level!=="inherit"&&(r=(i=e.typography[t.level])==null?void 0:i.fontSize)!=null?r:"inherit"})`},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.color&&{color:`var(--variant-plainColor, rgba(${(a=e.vars.palette[t.color])==null?void 0:a.mainChannel} / 1))`},t.variant&&ue({borderRadius:e.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!t.nesting&&{marginInline:"-0.25em"},(c=e.variants[t.variant])==null?void 0:c[t.color]))}),BO={h1:"h1",h2:"h2",h3:"h3",h4:"h4","title-lg":"p","title-md":"p","title-sm":"p","body-lg":"p","body-md":"p","body-sm":"p","body-xs":"span",inherit:"p"},ci=$.forwardRef(function(t,n){var r;const i=br({props:t,name:"JoyTypography"}),{color:a,textColor:c}=i,s=Un(i,gie),f=$.useContext(hA),g=$.useContext(yie),_=uR(ue({},s,{color:c})),{component:x,gutterBottom:C=!1,noWrap:E=!1,level:A="body-md",levelMapping:L=BO,children:I,endDecorator:T,startDecorator:O,variant:D,slots:U={},slotProps:H={}}=_,V=Un(_,vie),q=(r=t.color)!=null?r:D?a??"neutral":a,Q=f||g?t.level||"inherit":A,K=dR(I,["Skeleton"]),N=x||(f?"span":L[Q]||BO[Q]||"span"),re=ue({},_,{level:Q,component:N,color:q,gutterBottom:C,noWrap:E,nesting:f,variant:D,unstable_hasSkeleton:K}),ye=_ie(re),ge=ue({},V,{component:N,slots:U,slotProps:H}),[Ve,Ie]=wn("root",{ref:n,className:ye.root,elementType:wie,externalForwardedProps:ge,ownerState:re}),[ve,Se]=wn("startDecorator",{className:ye.startDecorator,elementType:xie,externalForwardedProps:ge,ownerState:re}),[Me,Be]=wn("endDecorator",{className:ye.endDecorator,elementType:bie,externalForwardedProps:ge,ownerState:re});return te.jsx(hA.Provider,{value:!0,children:te.jsxs(Ve,ue({},Ie,{children:[O&&te.jsx(ve,ue({},Se,{children:O})),K?$.cloneElement(I,{variant:I.props.variant||"inline"}):I,T&&te.jsx(Me,ue({},Be,{children:T}))]}))})});ci.muiName="Typography";function Sie(e){return xr("MuiButton",e)}const UO=mr("MuiButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]),Mie=["children","action","color","variant","size","fullWidth","startDecorator","endDecorator","loading","loadingPosition","loadingIndicator","disabled","component","slots","slotProps"],Cie=e=>{const{color:t,disabled:n,focusVisible:r,focusVisibleClassName:i,fullWidth:a,size:c,variant:s,loading:f}=e,g={root:["root",n&&"disabled",r&&"focusVisible",a&&"fullWidth",s&&`variant${mn(s)}`,t&&`color${mn(t)}`,c&&`size${mn(c)}`,f&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]},_=vr(g,Sie,{});return r&&i&&(_.root+=` ${i}`),_},Eie=nn("span",{name:"JoyButton",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),Tie=nn("span",{name:"JoyButton",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),Pie=nn("span",{name:"JoyButton",slot:"LoadingCenter",overridesResolver:(e,t)=>t.loadingIndicatorCenter})(({theme:e,ownerState:t})=>{var n,r;return ue({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=e.variants[t.variant])==null||(n=n[t.color])==null?void 0:n.color},t.disabled&&{color:(r=e.variants[`${t.variant}Disabled`])==null||(r=r[t.color])==null?void 0:r.color})}),b8=({theme:e,ownerState:t})=>{var n,r,i,a;return[ue({"--Icon-margin":"initial","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.lg,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.375rem",minHeight:"var(--Button-minHeight, 2rem)",fontSize:e.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.25rem)",paddingInline:"0.75rem"},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.xl,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.5rem",minHeight:"var(--Button-minHeight, 2.25rem)",fontSize:e.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.375rem)",paddingInline:"1rem"},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl2,"--CircularProgress-size":"28px","--CircularProgress-thickness":"4px","--Button-gap":"0.75rem",minHeight:"var(--Button-minHeight, 2.75rem)",fontSize:e.vars.fontSize.md,paddingBlock:"var(--Button-paddingBlock, 0.5rem)",paddingInline:"1.5rem"},{WebkitTapHighlightColor:"transparent",boxSizing:"border-box",borderRadius:`var(--Button-radius, ${e.vars.radius.sm})`,margin:"var(--Button-margin)",border:"none",backgroundColor:"transparent",cursor:"pointer",userSelect:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",textDecoration:"none",fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.lg,lineHeight:e.vars.lineHeight.md},t.fullWidth&&{width:"100%"},{[e.focus.selector]:e.focus.default}),ue({},(n=e.variants[t.variant])==null?void 0:n[t.color],{"&:hover":{"@media (hover: hover)":(r=e.variants[`${t.variant}Hover`])==null?void 0:r[t.color]},'&:active, &[aria-pressed="true"]':(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color],[`&.${UO.disabled}`]:(a=e.variants[`${t.variant}Disabled`])==null?void 0:a[t.color]},t.loadingPosition==="center"&&{[`&.${UO.loading}`]:{color:"transparent"}})]},Aie=nn("button",{name:"JoyButton",slot:"Root",overridesResolver:(e,t)=>t.root})(b8),w8=$.forwardRef(function(t,n){var r;const i=br({props:t,name:"JoyButton"}),{children:a,action:c,color:s="primary",variant:f="solid",size:g="md",fullWidth:_=!1,startDecorator:x,endDecorator:C,loading:E=!1,loadingPosition:A="center",loadingIndicator:L,disabled:I,component:T,slots:O={},slotProps:D={}}=i,U=Un(i,Mie),H=$.useContext(S3),V=$.useContext(u8),q=t.variant||H.variant||f,Q=t.size||H.size||g,K=t.color||H.color||s,N=(r=t.loading||t.disabled)!=null?r:H.disabled||E||I,re=$.useRef(null),ye=Br(re,n),{focusVisible:ge,setFocusVisible:Ve,getRootProps:Ie}=_c(ue({},i,{disabled:N,rootRef:ye})),ve=L??te.jsx(M3,{color:K,thickness:{sm:2,md:3,lg:4}[Q]||3});$.useImperativeHandle(c,()=>({focusVisible:()=>{var Ct;Ve(!0),(Ct=re.current)==null||Ct.focus()}}),[Ve]);const Se=ue({},i,{color:K,fullWidth:_,variant:q,size:Q,focusVisible:ge,loading:E,loadingPosition:A,disabled:N}),Me=Cie(Se),Be=Ct=>{var un;let gn=i.onClick;if(typeof D.root=="function"?gn=D.root(Se).onClick:D.root&&(gn=D.root.onClick),(un=gn)==null||un(Ct),V){var hn;(hn=V.onClick)==null||hn.call(V,Ct,i.value)}};let Qe=i["aria-pressed"];typeof D.root=="function"?Qe=D.root(Se)["aria-pressed"]:D.root&&(Qe=D.root["aria-pressed"]),V!=null&&V.value&&(Array.isArray(V.value)?Qe=V.value.indexOf(i.value)!==-1:Qe=V.value===i.value);const st=ue({},U,{component:T,slots:O,slotProps:D}),[ct,Xt]=wn("root",{ref:n,className:Me.root,elementType:Aie,externalForwardedProps:st,getSlotProps:Ie,ownerState:Se,additionalProps:{onClick:Be,"aria-pressed":Qe}}),[je,lt]=wn("startDecorator",{className:Me.startDecorator,elementType:Eie,externalForwardedProps:st,ownerState:Se}),[Ot,ut]=wn("endDecorator",{className:Me.endDecorator,elementType:Tie,externalForwardedProps:st,ownerState:Se}),[ot,Tt]=wn("loadingIndicatorCenter",{className:Me.loadingIndicatorCenter,elementType:Pie,externalForwardedProps:st,ownerState:Se});return te.jsxs(ct,ue({},Xt,{children:[(x||E&&A==="start")&&te.jsx(je,ue({},lt,{children:E&&A==="start"?ve:x})),a,E&&A==="center"&&te.jsx(ot,ue({},Tt,{children:ve})),(C||E&&A==="end")&&te.jsx(Ot,ue({},ut,{children:E&&A==="end"?ve:C}))]}))});w8.muiName="Button";function Iie(e){return xr("MuiCard",e)}mr("MuiCard",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","horizontal","vertical"]);const Rie=["className","color","component","invertedColors","size","variant","children","orientation","slots","slotProps"],Lie=e=>{const{size:t,variant:n,color:r,orientation:i}=e,a={root:["root",i,n&&`variant${mn(n)}`,r&&`color${mn(r)}`,t&&`size${mn(t)}`]};return vr(a,Iie,{})},kie=nn("div")(({theme:e,ownerState:t})=>{var n;const{p:r,padding:i,borderRadius:a}=Uf({theme:e,ownerState:t},["p","padding","borderRadius"]);return[ue({"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--Card-childRadius":"max((var(--Card-radius) - var(--variant-borderWidth, 0px)) - var(--Card-padding), min(var(--Card-padding) / 2, (var(--Card-radius) - var(--variant-borderWidth, 0px)) / 2))","--AspectRatio-radius":"var(--Card-childRadius)","--unstable_actionMargin":"calc(-1 * var(--variant-borderWidth, 0px))","--unstable_actionRadius":"var(--Card-radius)","--CardCover-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--CardOverflow-offset":"calc(-1 * var(--Card-padding))","--CardOverflow-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--Divider-inset":"calc(-1 * var(--Card-padding))"},t.size==="sm"&&{"--Card-radius":e.vars.radius.sm,"--Card-padding":"0.625rem",gap:"0.5rem"},t.size==="md"&&{"--Card-radius":e.vars.radius.md,"--Card-padding":"1rem",gap:"0.75rem 1rem"},t.size==="lg"&&{"--Card-radius":e.vars.radius.lg,"--Card-padding":"1.5rem",gap:"1rem 1.5rem"},{padding:"var(--Card-padding)",borderRadius:"var(--Card-radius)",backgroundColor:e.vars.palette.background.surface,position:"relative",display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column"},e.typography[`body-${t.size}`],t.variant==="solid"&&t.color&&t.invertedColors&&O_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&F_(t.color)(e),(n=e.variants[t.variant])==null?void 0:n[t.color]),r!==void 0&&{"--Card-padding":r},i!==void 0&&{"--Card-padding":i},a!==void 0&&{"--Card-radius":a}]}),Die=nn(kie,{name:"JoyCard",slot:"Root",overridesResolver:(e,t)=>t.root})({}),dA=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyCard"}),{className:i,color:a="neutral",component:c="div",invertedColors:s=!1,size:f="md",variant:g="outlined",children:_,orientation:x="vertical",slots:C={},slotProps:E={}}=r,A=Un(r,Rie),L=ue({},r,{color:a,component:c,orientation:x,size:f,variant:g,invertedColors:s}),I=Lie(L),T=ue({},A,{component:c,slots:C,slotProps:E}),[O,D]=wn("root",{ref:n,className:_i(I.root,i),elementType:Die,externalForwardedProps:T,ownerState:L});return te.jsx(O,ue({},D,{children:$.Children.map(_,(U,H)=>{if(!$.isValidElement(U))return U;const V={};if(dR(U,["Divider"])){var q,Q;const K=U.props;V.inset=(q=K==null?void 0:K.inset)!=null?q:"context";const N=x==="vertical"?"horizontal":"vertical";V.orientation=(Q=K==null?void 0:K.orientation)!=null?Q:N}return H===0&&(V["data-first-child"]=""),H===$.Children.count(_)-1&&(V["data-last-child"]=""),$.cloneElement(U,V)})}))}),S8=mr("MuiCardOverflow",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);function zie(e){return xr("MuiDivider",e)}mr("MuiDivider",["root","horizontal","vertical","insetContext","insetNone"]);const M8=nn("div")(({ownerState:e})=>({display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column",flex:9999,zIndex:1,columnGap:"var(--Card-padding)",rowGap:"max(2px, calc(0.1875 * var(--Card-padding)))",padding:"var(--unstable_padding)",[`.${S8.root} > &`]:{"--unstable_padding":"calc(var(--Card-padding) * 0.75) 0px"}}));nn(M8,{name:"JoyCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})({});const Oie=mr("MuiModalDialog",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","layoutCenter","layoutFullscreen"]);function Fie(e){return xr("MuiCheckbox",e)}const _f=mr("MuiCheckbox",["root","checkbox","action","input","label","checked","disabled","focusVisible","indeterminate","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantOutlined","variantSoft","variantSolid"]),Nie=Og(te.jsx("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"}),"Check"),Bie=Og(te.jsx("path",{d:"M19 13H5c-.55 0-1-.45-1-1s.45-1 1-1h14c.55 0 1 .45 1 1s-.45 1-1 1z"}),"HorizontalRule"),Uie=["checked","uncheckedIcon","checkedIcon","label","defaultChecked","disabled","disableIcon","overlay","id","indeterminate","indeterminateIcon","name","onBlur","onChange","onFocus","onFocusVisible","readOnly","required","value","color","variant","size","component","slots","slotProps"],$ie=e=>{const{checked:t,disabled:n,disableIcon:r,focusVisible:i,color:a,variant:c,size:s,indeterminate:f}=e,g={root:["root",t&&"checked",n&&"disabled",i&&"focusVisible",c&&`variant${mn(c)}`,a&&`color${mn(a)}`,s&&`size${mn(s)}`],checkbox:["checkbox",t&&"checked",f&&"indeterminate",n&&"disabled"],action:["action",t&&"checked",r&&n&&"disabled",i&&"focusVisible"],input:["input"],label:["label"]};return vr(g,Fie,{})},Vie=nn("span",{name:"JoyCheckbox",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n,r,i;return ue({"--Icon-fontSize":"var(--Checkbox-size)"},e.size==="sm"&&{"--Checkbox-size":"1rem","& ~ *":{"--FormHelperText-margin":"0 0 0 1.5rem"},fontSize:t.vars.fontSize.sm,gap:"var(--Checkbox-gap, 0.5rem)"},e.size==="md"&&{"--Checkbox-size":"1.25rem","& ~ *":{"--FormHelperText-margin":"0.25rem 0 0 1.875rem"},fontSize:t.vars.fontSize.md,gap:"var(--Checkbox-gap, 0.625rem)"},e.size==="lg"&&{"--Checkbox-size":"1.5rem","& ~ *":{"--FormHelperText-margin":"0.375rem 0 0 2.25rem"},fontSize:t.vars.fontSize.lg,gap:"var(--Checkbox-gap, 0.75rem)"},{position:e.overlay?"initial":"relative",display:"inline-flex",fontFamily:t.vars.fontFamily.body,lineHeight:"var(--Checkbox-size)",color:t.vars.palette.text.primary,[`&.${_f.disabled}`]:{color:(n=t.variants.plainDisabled)==null||(n=n[e.color])==null?void 0:n.color}},e.disableIcon&&{color:(r=t.variants[e.variant])==null||(r=r[e.color])==null?void 0:r.color,[`&.${_f.disabled}`]:{color:(i=t.variants[`${e.variant}Disabled`])==null||(i=i[e.color])==null?void 0:i.color}})}),jie=nn("span",{name:"JoyCheckbox",slot:"Checkbox",overridesResolver:(e,t)=>t.checkbox})(({theme:e,ownerState:t})=>{var n,r,i,a,c;const s=(n=e.variants[`${t.variant}`])==null?void 0:n[t.color];return[ue({"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,boxSizing:"border-box",borderRadius:`min(${e.vars.radius.sm}, 0.25rem)`,width:"var(--Checkbox-size)",height:"var(--Checkbox-size)",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},t.disableIcon&&{display:"contents"},{[`&.${_f.checked}, &.${_f.indeterminate}`]:{"--Icon-color":"currentColor"}}),...t.disableIcon?[]:[ue({},s,{backgroundColor:(r=s==null?void 0:s.backgroundColor)!=null?r:e.vars.palette.background.surface}),{"&:hover":{"@media (hover: hover)":(i=e.variants[`${t.variant}Hover`])==null?void 0:i[t.color]}},{"&:active":(a=e.variants[`${t.variant}Active`])==null?void 0:a[t.color]},{[`&.${_f.disabled}`]:(c=e.variants[`${t.variant}Disabled`])==null?void 0:c[t.color]}]]}),Hie=nn("span",{name:"JoyCheckbox",slot:"Action",overridesResolver:(e,t)=>t.action})(({theme:e,ownerState:t})=>{var n,r,i,a;return[{borderRadius:`var(--Checkbox-actionRadius, ${t.overlay?"var(--unstable_actionRadius, inherit)":"inherit"})`,textAlign:"left",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",zIndex:1,[e.focus.selector]:e.focus.default},...t.disableIcon?[(n=e.variants[t.variant])==null?void 0:n[t.color],{"&:hover":(r=e.variants[`${t.variant}Hover`])==null?void 0:r[t.color]},{"&:active":(i=e.variants[`${t.variant}Active`])==null?void 0:i[t.color]},{[`&.${_f.disabled}`]:(a=e.variants[`${t.variant}Disabled`])==null?void 0:a[t.color]}]:[]]}),Gie=nn("input",{name:"JoyCheckbox",slot:"Input",overridesResolver:(e,t)=>t.input})(()=>({margin:0,opacity:0,position:"absolute",width:"100%",height:"100%",cursor:"pointer"})),Wie=nn("label",{name:"JoyCheckbox",slot:"Label",overridesResolver:(e,t)=>t.label})(({ownerState:e})=>ue({flex:1,minWidth:0},e.disableIcon&&{zIndex:1,pointerEvents:"none"})),qie=te.jsx(Nie,{}),Xie=te.jsx(Bie,{}),Af=$.forwardRef(function(t,n){var r,i,a,c,s;const f=br({props:t,name:"JoyCheckbox"}),{checked:g,uncheckedIcon:_,checkedIcon:x=qie,label:C,defaultChecked:E,disabled:A,disableIcon:L=!1,overlay:I,id:T,indeterminate:O=!1,indeterminateIcon:D=Xie,name:U,onBlur:H,onChange:V,onFocus:q,onFocusVisible:Q,readOnly:K,required:N,value:re,color:ye,variant:ge,size:Ve="md",component:Ie,slots:ve={},slotProps:Se={}}=f,Me=Un(f,Uie),Be=$.useContext(EM),Qe=(r=(i=t.disabled)!=null?i:Be==null?void 0:Be.disabled)!=null?r:A,st=(a=(c=t.size)!=null?c:Be==null?void 0:Be.size)!=null?a:Ve,ct=Gs(T??(Be==null?void 0:Be.htmlFor)),Xt={checked:g,defaultChecked:E,disabled:Qe,onBlur:H,onChange:V,onFocus:q,onFocusVisible:Q},{getInputProps:je,checked:lt,disabled:Ot,focusVisible:ut}=fne(Xt),ot=lt||O,un=ot?ge||"solid":ge||"outlined",gn=t.color||(Be!=null&&Be.error?"danger":(s=Be==null?void 0:Be.color)!=null?s:ye),vn=ue({},f,{checked:lt,disabled:Ot,disableIcon:L,overlay:I,focusVisible:ut,color:ot?gn||"primary":gn||"neutral",variant:un,size:st}),Ut=$ie(vn),tn=ue({},Me,{component:Ie,slots:ve,slotProps:Se}),[Dt,An]=wn("root",{ref:n,className:Ut.root,elementType:Vie,externalForwardedProps:tn,ownerState:vn}),[an,Le]=wn("checkbox",{className:Ut.checkbox,elementType:jie,externalForwardedProps:tn,ownerState:vn}),[me,it]=wn("action",{className:Ut.action,elementType:Hie,externalForwardedProps:tn,ownerState:vn}),[St,It]=wn("input",{additionalProps:ue({id:ct,name:U,value:re,readOnly:K,role:void 0,required:N??(Be==null?void 0:Be.required),"aria-describedby":Be==null?void 0:Be["aria-describedby"]},O&&{"aria-checked":"mixed"}),className:Ut.input,elementType:Gie,externalForwardedProps:tn,getSlotProps:je,ownerState:vn}),[wt,Zt]=wn("label",{additionalProps:{htmlFor:ct},className:Ut.label,elementType:Wie,externalForwardedProps:tn,ownerState:vn});let Lt=_;return L?Lt=null:O?Lt=D:lt&&(Lt=x),te.jsxs(Dt,ue({},An,{children:[te.jsxs(an,ue({},Le,{children:[te.jsx(me,ue({},it,{children:te.jsx(St,ue({},It))})),Lt]})),C&&te.jsx(hA.Provider,{value:!0,children:te.jsx(wt,ue({},Zt,{children:C}))})]}))});function Zie(e){const{children:t,disableColorScheme:n=!1}=e;return te.jsxs($.Fragment,{children:[te.jsx(DK,{styles:r=>{var i,a;const c={};n||Object.entries(r.colorSchemes).forEach(([f,g])=>{var _;c[r.getColorSchemeSelector(f).replace(/\s*&/,"")]={colorScheme:(_=g.palette)==null?void 0:_.mode}});const s=(i=(a=r.components)==null||(a=a.JoyTypography)==null||(a=a.defaultProps)==null?void 0:a.level)!=null?i:"body-md";return ue({html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:r.vars.fontWeight.lg},body:ue({margin:0,color:r.vars.palette.text.primary,fontFamily:r.vars.fontFamily.body},r.typography[s],{backgroundColor:r.vars.palette.background.body,"@media print":{backgroundColor:r.vars.palette.common.white},"&::backdrop":{backgroundColor:r.vars.palette.background.backdrop}})},c)},defaultTheme:Lg}),t]})}function Yie(e){return xr("MuiDialogContent",e)}mr("MuiDialogContent",["root"]);const TM=$.createContext(void 0);function Kie(e){return xr("MuiDialogTitle",e)}const C8=mr("MuiDialogTitle",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),Jie=["component","children","orientation","slots","slotProps"],Qie=()=>vr({root:["root"]},Yie,{}),eoe=nn(M8,{name:"JoyDialogContent",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({color:`var(--DialogContent-color, ${e.vars.palette.text.tertiary})`,overflow:"auto",margin:"var(--unstable_DialogContent-margin)",[`.${Oie.root} > .${C8.root} + &`]:{"--unstable_DialogContent-margin":"-0.375em 0 0 0"}})),E8=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyDialogContent"}),i=$.useContext(TM),{component:a="div",children:c,orientation:s="vertical",slots:f={},slotProps:g={}}=r,_=Un(r,Jie),x=ue({},_,{component:a,slots:f,slotProps:g}),C=ue({},r,{component:a,orientation:s}),E=Qie(),[A,L]=wn("root",{ref:n,className:E.root,elementType:eoe,externalForwardedProps:x,ownerState:C,additionalProps:{id:i==null?void 0:i.describedBy}});return te.jsx(A,ue({},L,{children:c}))}),C3=$.createContext(void 0),toe=["component","children","variant","color","level","slots","slotProps"],noe=e=>{const{level:t,color:n,variant:r}=e,i={root:["root",t,n&&`color${mn(n)}`,r&&`variant${mn(r)}`]};return vr(i,Kie,{})},roe=nn("h2",{name:"JoyDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r;const i=t.level!=="inherit"?(n=e.typography[t.level])==null?void 0:n.lineHeight:"1";return ue({"--Icon-fontSize":`calc(1em * ${i})`},t.color&&{"--Icon-color":"currentColor"},{display:"flex",gap:"clamp(4px, 0.375em, 0.75rem)",margin:"var(--unstable_DialogTitle-margin, 0px)"},t.level&&t.level!=="inherit"&&e.typography[t.level],{color:"inherit"},t.variant&&ue({borderRadius:e.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},(r=e.variants[t.variant])==null?void 0:r[t.color]),{[`.${S8.root} > &`]:{"--unstable_DialogTitle-margin":"var(--Card-padding) 0"}})}),ioe={sm:"title-md",md:"title-lg",lg:"h4"},T8=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyDialogTitle"}),i=$.useContext(C3),a=$.useContext(TM),{component:c="h2",children:s,variant:f,color:g,level:_=ioe[i||"md"],slots:x={},slotProps:C={}}=r,E=Un(r,toe),A=t.color||(f?g??"neutral":g),L=ue({},E,{component:c,slots:x,slotProps:C}),I=ue({},r,{component:c,color:A,variant:f,level:_}),T=noe(I),[O,D]=wn("root",{ref:n,className:T.root,elementType:roe,externalForwardedProps:L,ownerState:I,additionalProps:{id:a==null?void 0:a.labelledBy}});return te.jsx(O,ue({},D,{children:s}))}),ooe=["className","children","component","inset","orientation","role","slots","slotProps"],soe=e=>{const{orientation:t,inset:n}=e,r={root:["root",t,n&&`inset${mn(n)}`]};return vr(r,zie,{})},P8=nn("hr",{name:"JoyDivider",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>ue({"--Divider-thickness":"1px","--Divider-lineColor":e.vars.palette.divider},t.inset==="none"&&{"--_Divider-inset":"0px"},t.inset==="context"&&{"--_Divider-inset":"var(--Divider-inset, 0px)"},{margin:"initial",marginInline:t.orientation==="vertical"?"initial":"var(--_Divider-inset)",marginBlock:t.orientation==="vertical"?"var(--_Divider-inset)":"initial",position:"relative",alignSelf:"stretch",flexShrink:0},t.children?ue({"--Divider-gap":e.spacing(1),"--Divider-childPosition":"50%",display:"flex",flexDirection:t.orientation==="vertical"?"column":"row",alignItems:"center",whiteSpace:"nowrap",textAlign:"center",border:0},e.typography["body-sm"],{"&::before, &::after":{position:"relative",inlineSize:t.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:t.orientation==="vertical"?"initial":"var(--Divider-thickness)",backgroundColor:"var(--Divider-lineColor)",content:'""'},"&::before":{marginInlineEnd:t.orientation==="vertical"?"initial":"min(var(--Divider-childPosition) * 999, var(--Divider-gap))",marginBlockEnd:t.orientation==="vertical"?"min(var(--Divider-childPosition) * 999, var(--Divider-gap))":"initial",flexBasis:"var(--Divider-childPosition)"},"&::after":{marginInlineStart:t.orientation==="vertical"?"initial":"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))",marginBlockStart:t.orientation==="vertical"?"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))":"initial",flexBasis:"calc(100% - var(--Divider-childPosition))"}}):{border:"none",listStyle:"none",backgroundColor:"var(--Divider-lineColor)",inlineSize:t.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:t.orientation==="vertical"?"initial":"var(--Divider-thickness)"})),e_=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyDivider"}),{className:i,children:a,component:c=a!=null?"div":"hr",inset:s,orientation:f="horizontal",role:g=c!=="hr"?"separator":void 0,slots:_={},slotProps:x={}}=r,C=Un(r,ooe),E=ue({},r,{inset:s,role:g,orientation:f,component:c}),A=soe(E),L=ue({},C,{component:c,slots:_,slotProps:x}),[I,T]=wn("root",{ref:n,className:_i(A.root,i),elementType:P8,externalForwardedProps:L,ownerState:E,additionalProps:ue({as:c,role:g},g==="separator"&&f==="vertical"&&{"aria-orientation":"vertical"})});return te.jsx(I,ue({},T,{children:a}))});e_.muiName="Divider";const A8=$.createContext(void 0),I8=nn("div")(({ownerState:e,theme:t})=>ue({"--unstable_popup-zIndex":`calc(${t.vars.zIndex.modal} + 1)`,'& ~ [role="listbox"]':{"--unstable_popup-zIndex":`calc(${t.vars.zIndex.modal} + 1)`},position:"fixed",zIndex:t.vars.zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&{visibility:"hidden"}));nn(I8,{name:"JoyModal",slot:"Root",overridesResolver:(e,t)=>t.root})({});const R8=nn("div")(({theme:e})=>({zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:e.vars.palette.background.backdrop,WebkitTapHighlightColor:"transparent",backdropFilter:"blur(8px)"}));nn(R8,{name:"JoyModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({});function aoe(e){return xr("MuiDrawer",e)}mr("MuiDrawer",["root","hidden","backdrop","content","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const loe=["children","anchor","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","color","variant","invertedColors","size","onClose","onKeyDown","open","component","slots","slotProps"],coe=e=>{const{open:t,variant:n,color:r,size:i}=e,a={root:["root",!t&&"hidden",n&&`variant${mn(n)}`,r&&`color${mn(r)}`,i&&`size${mn(i)}`],backdrop:["backdrop"],content:["content"]};return vr(a,aoe,{})},uoe=nn(I8,{name:"JoyDrawer",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>ue({"--Drawer-transitionDuration":"0.3s","--Drawer-transitionFunction":"ease","--ModalClose-radius":"max((var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) - var(--ModalClose-inset), min(var(--ModalClose-inset) / 2, (var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) / 2))"},e.size==="sm"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(350px, 30%, 100%)","--Drawer-horizontalSize":"clamp(256px, 20%, 100%)","--Drawer-titleMargin":"0.625rem 0.75rem calc(0.625rem / 2)"},e.size==="md"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(400px, 45%, 100%)","--Drawer-horizontalSize":"clamp(300px, 30%, 100%)","--Drawer-titleMargin":"0.75rem 0.75rem calc(0.75rem / 2)"},e.size==="lg"&&{"--ModalClose-inset":"0.75rem","--Drawer-verticalSize":"clamp(500px, 60%, 100%)","--Drawer-horizontalSize":"clamp(440px, 60%, 100%)","--Drawer-titleMargin":"1rem 1rem calc(1rem / 2)"},{transitionProperty:"visibility",transitionDelay:e.open?"0s":"var(--Drawer-transitionDuration)"},!e.open&&{visibility:"hidden"})),hoe=nn(R8,{name:"JoyDrawer",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})(({ownerState:e})=>({opacity:e.open?1:0,transition:"opacity var(--Drawer-transitionDuration) ease-in-out"})),doe=nn("div",{name:"JoyDrawer",slot:"Content",overridesResolver:(e,t)=>t.content})(({theme:e,ownerState:t})=>{var n;return ue({},e.typography[`body-${t.size}`],{boxShadow:e.shadow.md,backgroundColor:e.vars.palette.background.surface,outline:0,display:"flex",flexDirection:"column",position:"fixed",boxSizing:"border-box",overflow:"auto"},t.anchor==="left"&&{top:0,left:0,transform:t.open?"translateX(0)":"translateX(-100%)"},t.anchor==="right"&&{top:0,right:0,transform:t.open?"translateX(0)":"translateX(100%)"},t.anchor==="top"&&{top:0,transform:t.open?"translateY(0)":"translateY(-100%)"},t.anchor==="bottom"&&{bottom:0,transform:t.open?"translateY(0)":"translateY(100%)"},{height:t.anchor.match(/(left|right)/)?"100%":"min(100vh, var(--Drawer-verticalSize))",width:t.anchor.match(/(top|bottom)/)?"100vw":"min(100vw, var(--Drawer-horizontalSize))",transition:"transform var(--Drawer-transitionDuration) var(--Drawer-transitionFunction)"},t.variant==="solid"&&t.color&&t.invertedColors&&O_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&F_(t.color)(e),(n=e.variants[t.variant])==null?void 0:n[t.color],{[`& > .${C8.root}`]:{"--unstable_DialogTitle-margin":"var(--Drawer-titleMargin)"}})}),L8=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyDrawer"}),{children:i,anchor:a="left",container:c,disableAutoFocus:s=!1,disableEnforceFocus:f=!1,disableEscapeKeyDown:g=!1,disablePortal:_=!1,disableRestoreFocus:x=!1,disableScrollLock:C=!1,hideBackdrop:E=!1,color:A="neutral",variant:L="plain",invertedColors:I=!1,size:T="md",onClose:O,open:D,component:U,slots:H={},slotProps:V={}}=r,q=Un(r,loe),Q=ue({},r,{anchor:a,disableAutoFocus:s,disableEnforceFocus:f,disableEscapeKeyDown:g,disablePortal:_,disableRestoreFocus:x,disableScrollLock:C,hideBackdrop:E,invertedColors:I,color:A,variant:L,size:T}),{getRootProps:K,getBackdropProps:N,rootRef:re,portalRef:ye,isTopModal:ge}=Hee(ue({},Q,{rootRef:n,children:null})),Ve=coe(Q),Ie=ue({},q,{component:U,slots:H,slotProps:V}),ve=Gs(),Se=Gs(),Me=$.useMemo(()=>({variant:L,color:A,labelledBy:ve,describedBy:Se}),[A,L,ve,Se]),[Be,Qe]=wn("root",{ref:re,className:Ve.root,elementType:uoe,externalForwardedProps:Ie,getSlotProps:K,ownerState:Q}),[st,ct]=wn("backdrop",{className:Ve.backdrop,elementType:hoe,externalForwardedProps:Ie,getSlotProps:N,ownerState:Q}),[Xt,je]=wn("content",{className:Ve.content,elementType:doe,additionalProps:{tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":ve,"aria-describedby":Se},externalForwardedProps:Ie,ownerState:Q});return te.jsx(A8.Provider,{value:O,children:te.jsx(C3.Provider,{value:T,children:te.jsx(TM.Provider,{value:Me,children:te.jsx(G$,{ref:ye,container:c,disablePortal:_,children:te.jsxs(Be,ue({},Qe,{children:[E?null:te.jsx(st,ue({},ct)),te.jsx(tJ,{disableEnforceFocus:f,disableAutoFocus:s,disableRestoreFocus:x,isEnabled:ge,open:D,children:te.jsx(Xt,ue({},je,{children:i}))})]}))})})})})});function foe(e){return xr("MuiListDivider",e)}mr("MuiListDivider",["root","insetGutter","insetStartDecorator","insetStartContent","horizontal","vertical"]);const poe=["component","role","className","children","inset","orientation","slots","slotProps"],moe=e=>{const{orientation:t,inset:n}=e,r={root:["root",t,n&&n!=="context"&&`inset${mn(n)}`]};return vr(r,foe,{})},goe=nn(P8,{name:"JoyListDivider",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>ue({},e.inset==="context"&&{"--Divider-inset":"calc(-1 * var(--List-padding))"},e.row&&ue({marginInline:"var(--ListDivider-gap)"},e.inset==="gutter"&&{marginBlock:"var(--ListItem-paddingY)"},e["data-first-child"]===void 0&&{marginInlineStart:"calc(var(--List-gap) + var(--ListDivider-gap))"}),!e.row&&ue({},e["data-first-child"]===void 0&&{marginBlockStart:"calc(var(--List-gap) + var(--ListDivider-gap))"},{marginBlockEnd:"var(--ListDivider-gap)"},e.inset==="gutter"&&{marginInlineStart:"var(--ListItem-paddingLeft)",marginInlineEnd:"var(--ListItem-paddingRight)"},e.inset==="startDecorator"&&{marginInlineStart:"var(--ListItem-paddingLeft)"},e.inset==="startContent"&&{marginInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItemDecorator-size))"}))),Zw=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyListDivider"}),i=$.useContext(zg),a=$.useContext(x3),{component:c,role:s,className:f,children:g,inset:_="context",orientation:x,slots:C={},slotProps:E={}}=r,A=Un(r,poe),[L]=(a==null?void 0:a.split(":"))||["",""],I=c||(L&&!L.match(/^(ul|ol|menu)$/)?"div":"li"),T=s||(I==="li"?"separator":void 0),O=x||(i?"vertical":"horizontal"),D=ue({},r,{inset:_,row:i,orientation:O,component:I,role:T}),U=moe(D),H=ue({},A,{component:I,slots:C,slotProps:E}),[V,q]=wn("root",{ref:n,className:_i(U.root,f),elementType:goe,externalForwardedProps:H,ownerState:D,additionalProps:ue({as:I,role:T},T==="separator"&&O==="vertical"&&{"aria-orientation":"vertical"})});return te.jsx(V,ue({},q,{children:g}))});function voe(e){return xr("MuiListItemContent",e)}mr("MuiListItemContent",["root"]);const yoe=["component","className","children","slots","slotProps"],_oe=()=>vr({root:["root"]},voe,{}),xoe=nn("div",{name:"JoyListItemContent",slot:"Root",overridesResolver:(e,t)=>t.root})({flex:"1 1 auto",minWidth:0}),Yw=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyListItemContent"}),{component:i,className:a,children:c,slots:s={},slotProps:f={}}=r,g=Un(r,yoe),_=ue({},r),x=_oe(),C=ue({},g,{component:i,slots:s,slotProps:f}),[E,A]=wn("root",{ref:n,className:_i(x.root,a),elementType:xoe,externalForwardedProps:C,ownerState:_});return te.jsx(E,ue({},A,{children:c}))});function boe(e){return xr("MuiListItemDecorator",e)}mr("MuiListItemDecorator",["root"]);const woe=["component","className","children","slots","slotProps"],Soe=()=>vr({root:["root"]},boe,{}),Moe=nn("span",{name:"JoyListItemDecorator",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>ue({boxSizing:"border-box",display:"inline-flex",alignItems:`var(--unstable_ListItemDecorator-alignItems, ${e.parentOrientation==="horizontal"?"center":"initial"})`},e.parentOrientation==="horizontal"?{minInlineSize:"var(--ListItemDecorator-size)",marginInlineEnd:"calc(-1 * var(--ListItem-gap))"}:{minBlockSize:"var(--ListItemDecorator-size)",justifyContent:"center",marginBlockEnd:"calc(-1 * var(--ListItem-gap))"})),sy=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyListItemDecorator"}),{component:i,className:a,children:c,slots:s={},slotProps:f={}}=r,g=Un(r,woe),_=$.useContext(b3),x=ue({parentOrientation:_},r),C=Soe(),E=ue({},g,{component:i,slots:s,slotProps:f}),[A,L]=wn("root",{ref:n,className:_i(C.root,a),elementType:Moe,externalForwardedProps:E,ownerState:x});return te.jsx(A,ue({},L,{children:c}))});function Coe(e){return xr("MuiMenu",e)}mr("MuiMenu",["root","listbox","expanded","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const Eoe=["actions","children","color","component","disablePortal","keepMounted","id","invertedColors","onItemsChange","modifiers","variant","size","slots","slotProps"],Toe=e=>{const{open:t,variant:n,color:r,size:i}=e,a={root:["root",t&&"expanded",n&&`variant${mn(n)}`,r&&`color${mn(r)}`,i&&`size${mn(i)}`],listbox:["listbox"]};return vr(a,Coe,{})},$O=nn(k_,{name:"JoyMenu",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r;const i=(n=e.variants[t.variant])==null?void 0:n[t.color];return[ue({"--focus-outline-offset":`calc(${e.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":(i==null?void 0:i.backgroundColor)||(i==null?void 0:i.background)||e.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},SM,{borderRadius:`var(--List-radius, ${e.vars.radius.sm})`,boxShadow:e.shadow.md,overflow:"auto",zIndex:`var(--unstable_popup-zIndex, ${e.vars.zIndex.popup})`},!(i!=null&&i.backgroundColor)&&{backgroundColor:e.vars.palette.background.popup},t.variant==="solid"&&t.color&&t.invertedColors&&O_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&F_(t.color)(e),(r=e.variants[t.variant])==null?void 0:r[t.color])]}),k8=$.forwardRef(function(t,n){var r;const i=br({props:t,name:"JoyMenu"}),{actions:a,children:c,color:s="neutral",component:f,disablePortal:g=!1,keepMounted:_=!1,id:x,invertedColors:C=!1,onItemsChange:E,modifiers:A,variant:L="outlined",size:I="md",slots:T={},slotProps:O={}}=i,D=Un(i,Eoe),{contextValue:U,getListboxProps:H,dispatch:V,open:q,triggerElement:Q}=CJ({onItemsChange:E,id:x,listboxRef:n});$.useImperativeHandle(a,()=>({dispatch:V,resetHighlight:()=>V({type:qr.resetHighlight,event:null})}),[V]);const K=ue({},i,{disablePortal:g,invertedColors:C,color:s,variant:L,size:I,open:q,nesting:!1,row:!1}),N=Toe(K),re=ue({},D,{component:f,slots:T,slotProps:O}),ye=$.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...A||[]],[A]),ge=O6({elementType:$O,getSlotProps:H,externalForwardedProps:re,externalSlotProps:{},ownerState:K,additionalProps:{anchorEl:Q,open:q&&Q!==null,disablePortal:g,keepMounted:_,modifiers:ye},className:N.root});return te.jsx($O,ue({},ge,!((r=i.slots)!=null&&r.root)&&{as:_M,slots:{root:f||"ul"}},{children:te.jsx(EJ,{value:U,children:te.jsx(CM,{variant:C?void 0:L,color:s,children:te.jsx(wM.Provider,{value:"menu",children:te.jsx(L_,{nested:!0,children:c})})})})}))});function Poe(e){return xr("MuiMenuButton",e)}mr("MuiMenuButton",["root","colorPrimary","colorNeutral","colorDanger","colorInfo","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]);const Aoe=["children","color","component","disabled","endDecorator","loading","loadingPosition","loadingIndicator","size","slotProps","slots","startDecorator","variant"],Ioe=e=>{const{color:t,disabled:n,fullWidth:r,size:i,variant:a,loading:c}=e,s={root:["root",n&&"disabled",r&&"fullWidth",a&&`variant${mn(a)}`,t&&`color${mn(t)}`,i&&`size${mn(i)}`,c&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]};return vr(s,Poe,{})},Roe=nn("button",{name:"JoyMenuButton",slot:"Root",overridesResolver:(e,t)=>t.root})(b8),Loe=nn("span",{name:"JoyMenuButton",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),koe=nn("span",{name:"JoyMenuButton",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),Doe=nn("span",{name:"JoyMenuButton",slot:"LoadingCenter",overridesResolver:(e,t)=>t.loadingIndicatorCenter})(({theme:e,ownerState:t})=>{var n,r;return ue({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=e.variants[t.variant])==null||(n=n[t.color])==null?void 0:n.color},t.disabled&&{color:(r=e.variants[`${t.variant}Disabled`])==null||(r=r[t.color])==null?void 0:r.color})}),zoe=$.forwardRef(function(t,n){var r;const i=br({props:t,name:"JoyMenuButton"}),{children:a,color:c="neutral",component:s,disabled:f=!1,endDecorator:g,loading:_=!1,loadingPosition:x="center",loadingIndicator:C,size:E="md",slotProps:A={},slots:L={},startDecorator:I,variant:T="outlined"}=i,O=Un(i,Aoe),D=$.useContext(S3),U=t.variant||D.variant||T,H=t.size||D.size||E,V=(r=t.disabled)!=null?r:D.disabled||f||_,{getRootProps:q,open:Q,active:K}=Ree({rootRef:n,disabled:V}),N=C??te.jsx(M3,{color:c,thickness:{sm:2,md:3,lg:4}[H]||3}),re=ue({},i,{active:K,color:c,disabled:V,open:Q,size:H,variant:U}),ye=Ioe(re),ge=ue({},O,{component:s,slots:L,slotProps:A}),[Ve,Ie]=wn("root",{elementType:Roe,getSlotProps:q,externalForwardedProps:ge,ref:n,ownerState:re,className:ye.root}),[ve,Se]=wn("startDecorator",{className:ye.startDecorator,elementType:Loe,externalForwardedProps:ge,ownerState:re}),[Me,Be]=wn("endDecorator",{className:ye.endDecorator,elementType:koe,externalForwardedProps:ge,ownerState:re}),[Qe,st]=wn("loadingIndicatorCenter",{className:ye.loadingIndicatorCenter,elementType:Doe,externalForwardedProps:ge,ownerState:re});return te.jsxs(Ve,ue({},Ie,{children:[(I||_&&x==="start")&&te.jsx(ve,ue({},Se,{children:_&&x==="start"?N:I})),a,_&&x==="center"&&te.jsx(Qe,ue({},st,{children:N})),(g||_&&x==="end")&&te.jsx(Me,ue({},Be,{children:_&&x==="end"?N:g}))]}))});function Ooe(e){return xr("MuiMenuItem",e)}mr("MuiMenuItem",["root","focusVisible","disabled","selected","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const Foe=["children","disabled","component","selected","color","orientation","variant","slots","slotProps","id"],Noe=e=>{const{focusVisible:t,disabled:n,selected:r,color:i,variant:a}=e,c={root:["root",t&&"focusVisible",n&&"disabled",r&&"selected",i&&`color${mn(i)}`,a&&`variant${mn(a)}`]};return vr(c,Ooe,{})},Boe=nn(z_,{name:"JoyMenuItem",slot:"Root",overridesResolver:(e,t)=>t.root})({}),Uoe=$.memo($.forwardRef(function(t,n){const r=br({props:t,name:"JoyMenuItem"}),i=$.useContext(zg),{children:a,disabled:c=!1,component:s="li",selected:f=!1,color:g="neutral",orientation:_="horizontal",variant:x="plain",slots:C={},slotProps:E={},id:A}=r,L=Un(r,Foe),{variant:I=x,color:T=g}=MM(t.variant,t.color),{getRootProps:O,disabled:D,focusVisible:U}=Dee({id:A,disabled:c,rootRef:n}),H=ue({},r,{component:s,color:T,disabled:D,focusVisible:U,orientation:_,selected:f,row:i,variant:I}),V=Noe(H),q=ue({},L,{component:s,slots:C,slotProps:E}),[Q,K]=wn("root",{ref:n,elementType:Boe,getSlotProps:O,externalForwardedProps:q,className:V.root,ownerState:H});return te.jsx(b3.Provider,{value:_,children:te.jsx(Q,ue({},K,{children:a}))})})),df=$.forwardRef(function(t,n){const{contextValue:r,id:i}=zee(t.id);return te.jsx(qh.Provider,{value:r,children:te.jsx(Uoe,ue({},t,{id:i,ref:n}))})});function $oe(e){return xr("MuiModalClose",e)}mr("MuiModalClose",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);var VO;const Voe=["component","color","variant","size","onClick","slots","slotProps"],joe=e=>{const{variant:t,color:n,disabled:r,focusVisible:i,size:a}=e,c={root:["root",r&&"disabled",i&&"focusVisible",t&&`variant${mn(t)}`,n&&`color${mn(n)}`,a&&`size${mn(a)}`]};return vr(c,$oe,{})},Hoe=nn(N_,{name:"JoyModalClose",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n;return ue({},e.size==="sm"&&{"--IconButton-size":"1.75rem"},e.size==="md"&&{"--IconButton-size":"2rem"},e.size==="lg"&&{"--IconButton-size":"2.25rem"},{position:"absolute",zIndex:1,top:"var(--ModalClose-inset, 0.625rem)",right:"var(--ModalClose-inset, 0.625rem)",borderRadius:`var(--ModalClose-radius, ${t.vars.radius.sm})`},!((n=t.variants[e.variant])!=null&&(n=n[e.color])!=null&&n.backgroundColor)&&{color:t.vars.palette.text.secondary})}),Goe={plain:"plain",outlined:"plain",soft:"soft",solid:"solid"},D8=$.forwardRef(function(t,n){var r,i,a,c,s,f;const g=br({props:t,name:"JoyModalClose"}),{component:_="button",color:x="neutral",variant:C="plain",size:E="md",onClick:A,slots:L={},slotProps:I={}}=g,T=Un(g,Voe),O=$.useContext(A8),D=$.useContext(TM),U=(r=(i=t.variant)!=null?i:Goe[D==null?void 0:D.variant])!=null?r:C,H=(a=(c=t.color)!=null?c:D==null?void 0:D.color)!=null?a:x,V=$.useContext(C3),q=(s=(f=t.size)!=null?f:V)!=null?s:E,{focusVisible:Q,getRootProps:K}=_c(ue({},g,{rootRef:n})),N=ue({},g,{color:H,component:_,variant:U,size:q,focusVisible:Q}),re=joe(N),[ye,ge]=wn("root",{ref:n,elementType:Hoe,getSlotProps:K,externalForwardedProps:ue({onClick:Ve=>{O==null||O(Ve,"closeClick"),A==null||A(Ve)}},T,{component:_,slots:L,slotProps:I}),className:re.root,ownerState:N});return te.jsx(ye,ue({},ge,{children:VO||(VO=te.jsx(l8,{}))}))});function Woe(e){return xr("MuiOption",e)}const qoe=mr("MuiOption",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","highlighted","variantPlain","variantSoft","variantOutlined","variantSolid"]),Xoe=["component","children","disabled","value","label","variant","color","slots","slotProps"],Zoe=e=>{const{disabled:t,highlighted:n,selected:r}=e;return vr({root:["root",t&&"disabled",n&&"highlighted",r&&"selected"]},Woe,{})},Yoe=nn(z_,{name:"JoyOption",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n;const r=(n=e.variants[`${t.variant}Hover`])==null?void 0:n[t.color];return{[`&.${qoe.highlighted}:not([aria-selected="true"])`]:{backgroundColor:r==null?void 0:r.backgroundColor}}}),Koe=$.memo($.forwardRef(function(t,n){var r;const i=br({props:t,name:"JoyOption"}),{component:a="li",children:c,disabled:s=!1,value:f,label:g,variant:_="plain",color:x="neutral",slots:C={},slotProps:E={}}=i,A=Un(i,Xoe),L=$.useContext(zg),{variant:I=_,color:T=x}=MM(t.variant,t.color),O=$.useRef(null),D=Br(O,n),U=g??(typeof c=="string"?c:(r=O.current)==null?void 0:r.innerText),{getRootProps:H,selected:V,highlighted:q,index:Q}=Gee({disabled:s,label:U,value:f,rootRef:D}),K=ue({},i,{disabled:s,selected:V,highlighted:q,index:Q,component:a,variant:I,color:T,row:L}),N=Zoe(K),re=ue({},A,{component:a,slots:C,slotProps:E}),[ye,ge]=wn("root",{ref:n,getSlotProps:H,elementType:Yoe,externalForwardedProps:re,className:N.root,ownerState:K});return te.jsx(ye,ue({},ge,{children:c}))})),Joe=$.forwardRef(function(t,n){const{contextValue:r}=Wee(t.value);return te.jsx(qh.Provider,{value:r,children:te.jsx(Koe,ue({},t,{ref:n}))})}),Qoe=Og(te.jsx("path",{d:"m12 5.83 2.46 2.46c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 3.7a.9959.9959 0 0 0-1.41 0L8.12 6.88c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 5.83zm0 12.34-2.46-2.46a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l3.17 3.18c.39.39 1.02.39 1.41 0l3.17-3.17c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L12 18.17z"}),"Unfold");function ese(e){return xr("MuiSelect",e)}const Zm=mr("MuiSelect",["root","button","indicator","startDecorator","endDecorator","popper","listbox","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","focusVisible","disabled","expanded","multiple"]);var jO;const tse=["action","autoFocus","children","defaultValue","defaultListboxOpen","disabled","getSerializedValue","placeholder","listboxId","listboxOpen","onChange","onListboxOpenChange","onClose","renderValue","required","value","size","variant","color","startDecorator","endDecorator","indicator","aria-describedby","aria-label","aria-labelledby","id","name","multiple","slots","slotProps"];function nse(e){var t;return Array.isArray(e)?te.jsx($.Fragment,{children:e.map(n=>n.label).join(", ")}):(t=e==null?void 0:e.label)!=null?t:""}const rse=[{name:"offset",options:{offset:[0,4]}},{name:"equalWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:e})=>{e.styles.popper.width=`${e.rects.reference.width}px`}}],ise=e=>{const{color:t,disabled:n,focusVisible:r,size:i,variant:a,open:c,multiple:s}=e,f={root:["root",n&&"disabled",r&&"focusVisible",c&&"expanded",a&&`variant${mn(a)}`,t&&`color${mn(t)}`,i&&`size${mn(i)}`,s&&"multiple"],button:["button"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],indicator:["indicator",c&&"expanded"],listbox:["listbox",c&&"expanded",n&&"disabled"]};return vr(f,ese,{})},ose=nn("div",{name:"JoySelect",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r,i,a,c;const s=(n=e.variants[`${t.variant}`])==null?void 0:n[t.color],{borderRadius:f}=Uf({theme:e,ownerState:t},["borderRadius"]);return[ue({"--Select-radius":e.vars.radius.sm,"--Select-gap":"0.5rem","--Select-placeholderOpacity":.64,"--Select-decoratorColor":e.vars.palette.text.icon,"--Select-focusedThickness":e.vars.focus.thickness,"--Select-focusedHighlight":(r=e.vars.palette[t.color==="neutral"?"primary":t.color])==null?void 0:r[500],'&:not([data-inverted-colors="false"])':ue({},t.instanceColor&&{"--_Select-focusedHighlight":(i=e.vars.palette[t.instanceColor==="neutral"?"primary":t.instanceColor])==null?void 0:i[500]},{"--Select-focusedHighlight":e.vars.palette.focusVisible}),"--Select-indicatorColor":s!=null&&s.backgroundColor?s==null?void 0:s.color:e.vars.palette.text.tertiary},t.size==="sm"&&{"--Select-minHeight":"2rem","--Select-paddingInline":"0.5rem","--Select-decoratorChildHeight":"min(1.5rem, var(--Select-minHeight))","--Icon-fontSize":e.vars.fontSize.xl},t.size==="md"&&{"--Select-minHeight":"2.25rem","--Select-paddingInline":"0.75rem","--Select-decoratorChildHeight":"min(1.75rem, var(--Select-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},t.size==="lg"&&{"--Select-minHeight":"2.75rem","--Select-paddingInline":"1rem","--Select-decoratorChildHeight":"min(2.375rem, var(--Select-minHeight))","--Icon-fontSize":e.vars.fontSize.xl2},{"--Select-decoratorChildOffset":"min(calc(var(--Select-paddingInline) - (var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2), var(--Select-paddingInline))","--_Select-paddingBlock":"max((var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2, 0px)","--Select-decoratorChildRadius":"max(var(--Select-radius) - var(--variant-borderWidth, 0px) - var(--_Select-paddingBlock), min(var(--_Select-paddingBlock) + var(--variant-borderWidth, 0px), var(--Select-radius) / 2))","--Button-minHeight":"var(--Select-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Select-decoratorChildHeight)","--Button-radius":"var(--Select-decoratorChildRadius)","--IconButton-radius":"var(--Select-decoratorChildRadius)",boxSizing:"border-box"},t.variant!=="plain"&&{boxShadow:e.shadow.xs},{minWidth:0,minHeight:"var(--Select-minHeight)",position:"relative",display:"flex",alignItems:"center",borderRadius:"var(--Select-radius)",cursor:"pointer"},!(s!=null&&s.backgroundColor)&&{backgroundColor:e.vars.palette.background.surface},t.size&&{paddingBlock:{sm:2,md:3,lg:4}[t.size]},{paddingInline:"var(--Select-paddingInline)"},e.typography[`body-${t.size}`],s,{"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)"},[`&.${Zm.focusVisible}`]:{"--Select-indicatorColor":s==null?void 0:s.color,"&::before":{boxShadow:"inset 0 0 0 var(--Select-focusedThickness) var(--Select-focusedHighlight)"}},[`&.${Zm.disabled}`]:{"--Select-indicatorColor":"inherit"}}),{"&:hover":(a=e.variants[`${t.variant}Hover`])==null?void 0:a[t.color],[`&.${Zm.disabled}`]:(c=e.variants[`${t.variant}Disabled`])==null?void 0:c[t.color]},f!==void 0&&{"--Select-radius":f}]}),sse=nn("button",{name:"JoySelect",slot:"Button",overridesResolver:(e,t)=>t.button})(({ownerState:e})=>ue({border:0,outline:0,background:"none",padding:0,fontSize:"inherit",color:"inherit",alignSelf:"stretch",display:"flex",alignItems:"center",flex:1,fontFamily:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden"},(e.value===null||e.value===void 0)&&{opacity:"var(--Select-placeholderOpacity)"},{"&::before":{content:'""',display:"block",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",borderRadius:"var(--Select-radius)"}})),ase=nn(k_,{name:"JoySelect",slot:"Listbox",overridesResolver:(e,t)=>t.listbox})(({theme:e,ownerState:t})=>{var n;const r=(n=e.variants[t.variant])==null?void 0:n[t.color];return ue({"--focus-outline-offset":`calc(${e.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":(r==null?void 0:r.backgroundColor)||(r==null?void 0:r.background)||e.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},SM,{minWidth:"max-content",maxHeight:"44vh",overflow:"auto",outline:0,boxShadow:e.shadow.md,borderRadius:`var(--List-radius, ${e.vars.radius.sm})`,zIndex:`var(--unstable_popup-zIndex, ${e.vars.zIndex.popup})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:e.vars.palette.background.popup})}),lse=nn("span",{name:"JoySelect",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({"--Button-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Select-paddingInline) / -4)",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineEnd:"var(--Select-gap)"}),cse=nn("span",{name:"JoySelect",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({"--Button-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Select-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineStart:"var(--Select-gap)"}),use=nn("span",{name:"JoySelect",slot:"Indicator"})(({ownerState:e,theme:t})=>ue({},e.size==="sm"&&{"--Icon-fontSize":t.vars.fontSize.lg},e.size==="md"&&{"--Icon-fontSize":t.vars.fontSize.xl},e.size==="lg"&&{"--Icon-fontSize":t.vars.fontSize.xl2},{"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,display:"inherit",alignItems:"center",marginInlineStart:"var(--Select-gap)",marginInlineEnd:"calc(var(--Select-paddingInline) / -4)",[`.${Zm.endDecorator} + &`]:{marginInlineStart:"calc(var(--Select-gap) / 2)"},[`&.${Zm.expanded}, .${Zm.disabled} > &`]:{"--Icon-color":"currentColor"}})),hse=$.forwardRef(function(t,n){var r,i,a,c,s,f,g;const _=br({props:t,name:"JoySelect"}),x=_,{action:C,autoFocus:E,children:A,defaultValue:L,defaultListboxOpen:I=!1,disabled:T,getSerializedValue:O,placeholder:D,listboxId:U,listboxOpen:H,onChange:V,onListboxOpenChange:q,onClose:Q,renderValue:K,required:N=!1,value:re,size:ye="md",variant:ge="outlined",color:Ve="neutral",startDecorator:Ie,endDecorator:ve,indicator:Se=jO||(jO=te.jsx(Qoe,{})),"aria-describedby":Me,"aria-label":Be,"aria-labelledby":Qe,id:st,name:ct,multiple:Xt=!1,slots:je={},slotProps:lt={}}=x,Ot=Un(x,tse),ut=$.useContext(EM),ot=(r=(i=t.disabled)!=null?i:ut==null?void 0:ut.disabled)!=null?r:T,Tt=(a=(c=t.size)!=null?c:ut==null?void 0:ut.size)!=null?a:ye,Ct=(s=t.color)!=null?s:ut!=null&&ut.error?"danger":(f=ut==null?void 0:ut.color)!=null?f:Ve,un=K??nse,[gn,hn]=$.useState(null),We=$.useRef(null),vn=$.useRef(null),Ut=Br(n,We);$.useImperativeHandle(C,()=>({focusVisible:()=>{var Et;(Et=vn.current)==null||Et.focus()}}),[]),$.useEffect(()=>{hn(We.current)},[]),$.useEffect(()=>{E&&vn.current.focus()},[E]);const tn=$.useCallback(Et=>{q==null||q(Et),Et||Q==null||Q()},[Q,q]),{buttonActive:Dt,buttonFocusVisible:An,contextValue:an,disabled:Le,getButtonProps:me,getListboxProps:it,getHiddenInputProps:St,getOptionMetadata:It,open:wt,value:Zt}=une({buttonRef:vn,defaultOpen:I,defaultValue:L,disabled:ot,getSerializedValue:O,listboxId:U,multiple:Xt,name:ct,required:N,onChange:V,onOpenChange:tn,open:H,value:re}),Lt=ue({},_,{active:Dt,defaultListboxOpen:I,disabled:Le,focusVisible:An,open:wt,renderValue:un,value:Zt,size:Tt,variant:ge,color:Ct}),kt=ise(Lt),bn=ue({},Ot,{slots:je,slotProps:lt}),zt=$.useMemo(()=>{let Et;if(Xt)Et=Zt.map(be=>It(be)).filter(be=>be!==void 0);else{var Ft;Et=(Ft=It(Zt))!=null?Ft:null}return Et},[It,Zt,Xt]),[_e,ee]=wn("root",{ref:Ut,className:kt.root,elementType:ose,externalForwardedProps:bn,ownerState:Lt}),[ne,Z]=wn("button",{additionalProps:{"aria-describedby":Me??(ut==null?void 0:ut["aria-describedby"]),"aria-label":Be,"aria-labelledby":Qe??(ut==null?void 0:ut.labelId),"aria-required":N?"true":void 0,id:st??(ut==null?void 0:ut.htmlFor),name:ct},className:kt.button,elementType:sse,externalForwardedProps:bn,getSlotProps:me,ownerState:Lt}),[le,Te]=wn("listbox",{additionalProps:{anchorEl:gn,open:wt,placement:"bottom",keepMounted:!0},className:kt.listbox,elementType:ase,externalForwardedProps:bn,getSlotProps:it,ownerState:ue({},Lt,{nesting:!1,row:!1,wrap:!1}),getSlotOwnerState:Et=>({size:Et.size||Tt,variant:Et.variant||ge,color:Et.color||(Et.disablePortal?Ct:Ve),disableColorInversion:!Et.disablePortal})}),[$e,fe]=wn("startDecorator",{className:kt.startDecorator,elementType:lse,externalForwardedProps:bn,ownerState:Lt}),[xe,Re]=wn("endDecorator",{className:kt.endDecorator,elementType:cse,externalForwardedProps:bn,ownerState:Lt}),[De,ze]=wn("indicator",{className:kt.indicator,elementType:use,externalForwardedProps:bn,ownerState:Lt}),Je=$.useMemo(()=>[...rse,...Te.modifiers||[]],[Te.modifiers]);let Oe=D;return(Array.isArray(zt)&&zt.length>0||!Array.isArray(zt)&&zt)&&(Oe=un(zt)),te.jsxs($.Fragment,{children:[te.jsxs(_e,ue({},ee,{children:[Ie&&te.jsx($e,ue({},fe,{children:Ie})),te.jsx(ne,ue({},Z,{children:Oe})),ve&&te.jsx(xe,ue({},Re,{children:ve})),Se&&te.jsx(De,ue({},ze,{children:Se})),te.jsx("input",ue({},St()))]})),gn&&te.jsx(le,ue({},Te,{className:_i(Te.className),modifiers:Je},!((g=_.slots)!=null&&g.listbox)&&{as:_M,slots:{root:Te.as||"ul"}},{children:te.jsx(hne,{value:an,children:te.jsx(CM,{variant:ge,color:Ve,children:te.jsx(wM.Provider,{value:"select",children:te.jsx(L_,{nested:!0,children:A})})})})}))]})});function dse(e){return xr("MuiSheet",e)}mr("MuiSheet",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const fse=["className","color","component","variant","invertedColors","slots","slotProps"],pse=e=>{const{variant:t,color:n}=e,r={root:["root",t&&`variant${mn(t)}`,n&&`color${mn(n)}`]};return vr(r,dse,{})},mse=nn("div",{name:"JoySheet",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r;const i=(n=e.variants[t.variant])==null?void 0:n[t.color],{borderRadius:a,bgcolor:c,backgroundColor:s,background:f}=Uf({theme:e,ownerState:t},["borderRadius","bgcolor","backgroundColor","background"]),g=kh(e,`palette.${c}`)||c||kh(e,`palette.${s}`)||s||f||(i==null?void 0:i.backgroundColor)||(i==null?void 0:i.background)||e.vars.palette.background.surface;return[ue({"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--ListItem-stickyBackground":g==="transparent"?"initial":g,"--Sheet-background":g==="transparent"?"initial":g},a!==void 0&&{"--List-radius":`calc(${a} - var(--variant-borderWidth, 0px))`,"--unstable_actionRadius":`calc(${a} - var(--variant-borderWidth, 0px))`},{backgroundColor:e.vars.palette.background.surface,position:"relative"}),ue({},e.typography["body-md"],t.variant==="solid"&&t.color&&t.invertedColors&&O_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&F_(t.color)(e),(r=e.variants[t.variant])==null?void 0:r[t.color],i)]}),z8=$.forwardRef(function(t,n){const r=br({props:t,name:"JoySheet"}),{className:i,color:a="neutral",component:c="div",variant:s="plain",invertedColors:f=!1,slots:g={},slotProps:_={}}=r,x=Un(r,fse),C=ue({},r,{color:a,component:c,invertedColors:f,variant:s}),E=pse(C),A=ue({},x,{component:c,slots:g,slotProps:_}),[L,I]=wn("root",{ref:n,className:_i(E.root,i),elementType:mse,externalForwardedProps:A,ownerState:C});return te.jsx(L,ue({},I))});function gse(e){return xr("MuiSnackbar",e)}mr("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","endDecorator","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantOutlined","variantSoft","variantSolid"]);const vse=["anchorOrigin","animationDuration","autoHideDuration","color","children","className","component","disableWindowBlurListener","endDecorator","invertedColors","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","onUnmount","open","resumeHideDuration","size","slots","slotProps","startDecorator","variant"];let O8=e=>e,HO,GO;const yse=e=>{const{variant:t,color:n,size:r,anchorOrigin:i}=e,a={root:["root",r&&`size${mn(r)}`,n&&`color${mn(n)}`,t&&`variant${mn(t)}`,`anchorOrigin${mn(i.vertical)}${mn(i.horizontal)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return vr(a,gse,{})},_se=nR(HO||(HO=O8`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
  }
`)),xse=nR(GO||(GO=O8`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
`)),bse=nn("div",{name:"JoySnackbar",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n,r,i,a,c,s,f;const{p:g,padding:_,borderRadius:x}=Uf({theme:e,ownerState:t},["p","padding","borderRadius"]);return[ue({"--Snackbar-radius":e.vars.radius.sm,"--Snackbar-decoratorChildRadius":"max((var(--Snackbar-radius) - var(--variant-borderWidth, 0px)) - var(--Snackbar-padding), min(var(--Snackbar-padding) + var(--variant-borderWidth, 0px), var(--Snackbar-radius) / 2))","--Button-minHeight":"var(--Snackbar-decoratorChildHeight)","--IconButton-size":"var(--Snackbar-decoratorChildHeight)","--Button-radius":"var(--Snackbar-decoratorChildRadius)","--IconButton-radius":"var(--Snackbar-decoratorChildRadius)","--Icon-color":"currentColor"},t.size==="sm"&&{"--Snackbar-padding":"0.75rem","--Snackbar-inset":"0.5rem","--Snackbar-decoratorChildHeight":"1.5rem","--Icon-fontSize":e.vars.fontSize.xl,gap:"0.5rem"},t.size==="md"&&{"--Snackbar-padding":"1rem","--Snackbar-inset":"0.75rem","--Snackbar-decoratorChildHeight":"2rem","--Icon-fontSize":e.vars.fontSize.xl,gap:"0.625rem"},t.size==="lg"&&{"--Snackbar-padding":"1.25rem","--Snackbar-inset":"1rem","--Snackbar-decoratorChildHeight":"2.375rem","--Icon-fontSize":e.vars.fontSize.xl2,gap:"0.875rem"},{zIndex:e.vars.zIndex.snackbar,position:"fixed",display:"flex",alignItems:"center",minWidth:300,top:((n=t.anchorOrigin)==null?void 0:n.vertical)==="top"?"var(--Snackbar-inset)":void 0,left:((r=t.anchorOrigin)==null?void 0:r.horizontal)==="left"?"var(--Snackbar-inset)":void 0,bottom:((i=t.anchorOrigin)==null?void 0:i.vertical)==="bottom"?"var(--Snackbar-inset)":void 0,right:((a=t.anchorOrigin)==null?void 0:a.horizontal)==="right"?"var(--Snackbar-inset)":void 0},((c=t.anchorOrigin)==null?void 0:c.horizontal)==="center"&&{"--Snackbar-translateX":"-50%",left:"50%",transform:"translateX(var(--Snackbar-translateX))"},((s=t.anchorOrigin)==null?void 0:s.vertical)==="top"&&{"--_Snackbar-anchorBottom":"-1"},{animation:`${_se} ${t.animationDuration}ms forwards`},!t.open&&{animationName:xse},{boxShadow:e.vars.shadow.lg,backgroundColor:e.vars.palette.background.surface,padding:"var(--Snackbar-padding)",borderRadius:"var(--Snackbar-radius)"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],t.variant==="solid"&&t.color&&t.invertedColors&&O_(t.color)(e),t.variant==="soft"&&t.color&&t.invertedColors&&F_(t.color)(e),(f=e.variants[t.variant])==null?void 0:f[t.color]),g!==void 0&&{"--Snackbar-padding":g},_!==void 0&&{"--Snackbar-padding":_},x!==void 0&&{"--Snackbar-radius":x}]}),wse=nn("span",{name:"JoySnackbar",slot:"StartDecorator",overridesResolver:(e,t)=>t.startDecorator})({display:"inherit",flex:"none"}),Sse=nn("span",{name:"JoySnackbar",slot:"EndDecorator",overridesResolver:(e,t)=>t.endDecorator})({display:"inherit",flex:"none",marginLeft:"auto"}),Mse={vertical:"bottom",horizontal:"right"},F8=$.forwardRef(function(t,n){const r=br({props:t,name:"JoySnackbar"}),{anchorOrigin:i=Mse,animationDuration:a=300,autoHideDuration:c=null,color:s="neutral",children:f,className:g,component:_,disableWindowBlurListener:x=!1,endDecorator:C,invertedColors:E=!1,onUnmount:A,open:L,size:I="md",slots:T={},slotProps:O,startDecorator:D,variant:U="outlined"}=r,H=Un(r,vse),[V,q]=$.useState(!0),[Q,K]=$.useState(!1),N=$.useRef(A);N.current=A,$.useEffect(()=>{if(L)K(!1),q(!1);else{K(!0);const je=setTimeout(()=>{var lt;q(!0),K(!1),(lt=N.current)==null||lt.call(N)},a);return()=>{clearTimeout(je)}}},[L,a]);const re=ue({},r,{anchorOrigin:i,autoHideDuration:c,color:s,animationDuration:a,disableWindowBlurListener:x,invertedColors:E,size:I,variant:U});delete re.onUnmount;const ye=yse(re),{getRootProps:ge,onClickAway:Ve}=dne(re),Ie=je=>{Q||Ve(je)},ve=ue({},H,{component:_,slots:T,slotProps:O}),[Se,Me]=wn("root",{ref:n,className:_i(ye.root,g),elementType:bse,externalForwardedProps:ve,getSlotProps:ge,ownerState:re}),[Be,Qe]=wn("startDecorator",{className:ye.startDecorator,elementType:wse,externalForwardedProps:ve,ownerState:re}),[st,ct]=wn("endDecorator",{className:ye.endDecorator,elementType:Sse,externalForwardedProps:ve,ownerState:re}),Xt=T.clickAway||jK;return!L&&V?null:te.jsx(Xt,ue({onClickAway:Ie},typeof(O==null?void 0:O.clickAway)=="function"?O.clickAway(re):O==null?void 0:O.clickAway,{children:te.jsxs(Se,ue({},Me,{children:[D&&te.jsx(Be,ue({},Qe,{children:D})),f,C&&te.jsx(st,ue({},ct,{children:C}))]}))}))}),ja=EK({createStyledComponent:nn("div",{name:"JoyStack",slot:"Root",overridesResolver:(e,t)=>t.root}),useThemeProps:e=>br({props:e,name:"JoyStack"})});function Cse(e){return xr("MuiTab",e)}const Ese=mr("MuiTab",["root","disabled","focusVisible","selected","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),Tse=["action","children","value","disabled","onChange","onClick","onFocus","component","orientation","variant","color","disableIndicator","indicatorPlacement","indicatorInset","slots","slotProps"],Pse=e=>{const{selected:t,disabled:n,focusVisible:r,variant:i,color:a,orientation:c}=e,s={root:["root",c,n&&"disabled",r&&"focusVisible",t&&"selected",i&&`variant${mn(i)}`,a&&`color${mn(a)}`]};return vr(s,Cse,{})},Ase=nn(z_,{name:"JoyTab",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e})=>[{flex:"initial",justifyContent:e.row?"center":"initial","--unstable_ListItemDecorator-alignItems":"center","--unstable_offset":"min(calc(-1 * var(--variant-borderWidth, 0px)), -1px)"},!e.disableIndicator&&{'&[aria-selected="true"]':{"--Tab-indicatorColor":"currentColor",zIndex:1},"&::after":{content:'""',display:"block",position:"absolute",margin:"auto",background:"var(--Tab-indicatorColor)",borderRadius:"var(--Tab-indicatorRadius)"}},!e.disableIndicator&&e.indicatorPlacement==="bottom"&&{paddingBottom:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:e.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:e.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",bottom:"calc(-1px - var(--unstable_TabList-underlineBottom, 0px))"}},!e.disableIndicator&&e.indicatorPlacement==="top"&&{paddingTop:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:e.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:e.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",top:"calc(-1px - var(--unstable_TabList-underlineTop, 0px))"}},!e.disableIndicator&&e.indicatorPlacement==="right"&&{paddingRight:"calc(var(--ListItem-paddingRight) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:e.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:e.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",right:"calc(-1px - var(--unstable_TabList-underlineRight, 0px))"}},!e.disableIndicator&&e.indicatorPlacement==="left"&&{paddingLeft:"calc(var(--ListItem-paddingLeft) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:e.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:e.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",left:"calc(-1px - var(--unstable_TabList-underlineLeft, 0px))"}}]),fE=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyTab"}),i=$.useContext(zg),{action:a,children:c,disabled:s=!1,component:f="button",orientation:g="horizontal",variant:_="plain",color:x="neutral",disableIndicator:C=!1,indicatorPlacement:E=i?"bottom":"right",indicatorInset:A=!1,slots:L={},slotProps:I={}}=r,T=Un(r,Tse),O=$.useRef(null),D=Br(O,n),{active:U,focusVisible:H,setFocusVisible:V,selected:q,getRootProps:Q}=wne(ue({},r,{rootRef:D}));$.useImperativeHandle(a,()=>({focusVisible:()=>{V(!0),O.current.focus()}}),[V]);const K=ue({},r,{disableIndicator:C,indicatorPlacement:E,indicatorInset:A,orientation:g,row:i,active:U,focusVisible:H,disabled:s,selected:q,variant:_,color:x}),N=Pse(K),re=ue({},T,{component:f,slots:L,slotProps:I}),[ye,ge]=wn("root",{ref:n,elementType:Ase,getSlotProps:Q,externalForwardedProps:re,ownerState:K,className:N.root});return te.jsx(b3.Provider,{value:g,children:te.jsx(ye,ue({},ge,{children:c}))})}),E3=$.createContext("md");function Ise(e){return xr("MuiTabList",e)}mr("MuiTabList",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const Rse=["component","children","variant","color","size","disableUnderline","underlinePlacement","tabFlex","sticky","slots","slotProps"],Lse=e=>{const{orientation:t,size:n,variant:r,color:i}=e,a={root:["root",t,r&&`variant${mn(r)}`,i&&`color${mn(i)}`,n&&`size${mn(n)}`]};return vr(a,Ise,{})},kse=nn(k_,{name:"JoyTabList",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n;const r=(n=e.variants[t.variant])==null?void 0:n[t.color];return ue({"--List-gap":"0px","--ListDivider-gap":"0px","--ListItem-paddingX":"var(--Tabs-spacing)","--ListItem-gap":"0.375rem","--unstable_TabList-hasUnderline":t.disableUnderline?"var(--unknown,)":"initial"},SM,{flexGrow:"initial",flexDirection:t.orientation==="vertical"?"column":"row",borderRadius:"var(--List-radius, 0px)",padding:"var(--List-padding, 0px)",zIndex:1},t.sticky&&{position:"sticky",top:t.sticky==="top"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",bottom:t.sticky==="bottom"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",backgroundColor:(r==null?void 0:r.backgroundColor)||`var(--TabList-stickyBackground, ${e.vars.palette.background.body})`},!t.disableUnderline&&ue({},t.underlinePlacement==="bottom"&&{"--unstable_TabList-underlineBottom":"1px",paddingBottom:1,boxShadow:`inset 0 -1px ${e.vars.palette.divider}`},t.underlinePlacement==="top"&&{"--unstable_TabList-underlineTop":"1px",paddingTop:1,boxShadow:`inset 0 1px ${e.vars.palette.divider}`},t.underlinePlacement==="right"&&{"--unstable_TabList-underlineRight":"1px",paddingRight:1,boxShadow:`inset -1px 0 ${e.vars.palette.divider}`},t.underlinePlacement==="left"&&{"--unstable_TabList-underlineLeft":"1px",paddingLeft:1,boxShadow:`inset 1px 0 ${e.vars.palette.divider}`}),t.tabFlex&&{[`& .${Ese.root}`]:{flex:t.tabFlex}})}),Dse=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyTabList"}),i=$.useContext(E3),{isRtl:a,orientation:c,getRootProps:s,contextValue:f}=_ne({rootRef:n}),{component:g="div",children:_,variant:x="plain",color:C="neutral",size:E,disableUnderline:A=!1,underlinePlacement:L=c==="horizontal"?"bottom":"right",tabFlex:I,sticky:T,slots:O={},slotProps:D={}}=r,U=Un(r,Rse),V=ue({},r,{isRtl:a,orientation:c,variant:x,color:C,size:E??i,sticky:T,tabFlex:I,nesting:!1,disableUnderline:A,underlinePlacement:L}),q=Lse(V),Q=ue({},U,{component:g,slots:O,slotProps:D}),[K,N]=wn("root",{ref:n,elementType:kse,getSlotProps:s,externalForwardedProps:Q,ownerState:V,className:q.root});return te.jsx(K,ue({},N,{children:te.jsx(xne,{value:f,children:te.jsx(L_,{row:c==="horizontal",nested:!0,children:_})})}))});function zse(e){return xr("MuiTabPanel",e)}mr("MuiTabPanel",["root","hidden","sizeSm","sizeMd","sizeLg","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const Ose=["children","value","component","color","variant","size","slots","slotProps","keepMounted"],Fse=e=>{const{hidden:t,size:n,variant:r,color:i,orientation:a}=e,c={root:["root",t&&"hidden",n&&`size${mn(n)}`,a,r&&`variant${mn(r)}`,i&&`color${mn(i)}`,n&&`size${mn(n)}`]};return vr(c,zse,{})},Nse=nn("div",{name:"JoyTabPanel",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e,ownerState:t})=>{var n;return ue({display:t.hidden?"none":"block",padding:"var(--Tabs-spacing)",flexGrow:1,fontFamily:e.vars.fontFamily.body},e.typography[`body-${t.size}`],(n=e.variants[t.variant])==null?void 0:n[t.color])}),pE=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyTabPanel"}),{orientation:i}=xM()||{orientation:"horizontal"},a=$.useContext(E3),{children:c,value:s=0,component:f,color:g="neutral",variant:_="plain",size:x,slots:C={},slotProps:E={},keepMounted:A=!1}=r,L=Un(r,Ose),{hidden:I,getRootProps:T}=vne(ue({},r,{value:s})),D=ue({},r,{orientation:i,hidden:I,size:x??a,color:g,variant:_}),U=Fse(D),H=ue({},L,{component:f,slots:C,slotProps:E}),[V,q]=wn("root",{ref:n,elementType:Nse,getSlotProps:T,externalForwardedProps:H,additionalProps:{role:"tabpanel",ref:n,as:f},ownerState:D,className:U.root});return A?te.jsx(V,ue({},q,{children:c})):te.jsx(V,ue({},q,{children:!I&&c}))});function Bse(e){return xr("MuiTabs",e)}mr("MuiTabs",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const Use=["children","value","defaultValue","orientation","direction","component","onChange","selectionFollowsFocus","variant","color","size","slots","slotProps"],$se=e=>{const{orientation:t,variant:n,color:r,size:i}=e,a={root:["root",t,n&&`variant${mn(n)}`,r&&`color${mn(r)}`,i&&`size${mn(i)}`]};return vr(a,Bse,{})},Vse=nn("div",{name:"JoyTabs",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n,r;const i=(n=t.variants[e.variant])==null?void 0:n[e.color],{bgcolor:a,backgroundColor:c,background:s,p:f,padding:g}=Uf({theme:t,ownerState:e},["bgcolor","backgroundColor","background","p","padding"]),_=kh(t,`palette.${a}`)||a||kh(t,`palette.${c}`)||c||s||(i==null?void 0:i.backgroundColor)||(i==null?void 0:i.background)||t.vars.palette.background.surface;return ue({},e.size==="sm"&&{"--Tabs-spacing":"0.75rem"},e.size==="md"&&{"--Tabs-spacing":"1rem"},e.size==="lg"&&{"--Tabs-spacing":"1.25rem"},{"--Tab-indicatorThickness":"2px","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,"--TabList-stickyBackground":_==="transparent"?"initial":_,display:"flex",flexDirection:"column"},e.orientation==="vertical"&&{flexDirection:"row"},{backgroundColor:t.vars.palette.background.surface,position:"relative"},t.typography[`body-${e.size}`],(r=t.variants[e.variant])==null?void 0:r[e.color],f!==void 0&&{"--Tabs-padding":f},g!==void 0&&{"--Tabs-padding":g})}),WO=$.forwardRef(function(t,n){const r=br({props:t,name:"JoyTabs"}),{children:i,value:a,defaultValue:c,orientation:s="horizontal",direction:f="ltr",component:g,variant:_="plain",color:x="neutral",size:C="md",slots:E={},slotProps:A={}}=r,L=Un(r,Use),I=c||(a===void 0?0:void 0),{contextValue:T}=pne(ue({},r,{orientation:s,defaultValue:I})),O=ue({},r,{orientation:s,direction:f,variant:_,color:x,size:C}),D=$se(O),U=ue({},L,{component:g,slots:E,slotProps:A}),[H,V]=wn("root",{ref:n,elementType:Vse,externalForwardedProps:U,additionalProps:{ref:n,as:g},ownerState:O,className:D.root});return te.jsx(H,ue({},V,{children:te.jsx(mne,{value:T,children:te.jsx(E3.Provider,{value:C,children:i})})}))});function jse(e){return xr("MuiTooltip",e)}mr("MuiTooltip",["root","tooltipArrow","arrow","touch","placementLeft","placementRight","placementTop","placementBottom","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);const Hse=["children","className","component","arrow","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","disablePortal","direction","keepMounted","modifiers","placement","title","color","variant","size","slots","slotProps"],Gse=e=>{const{arrow:t,variant:n,color:r,size:i,placement:a,touch:c}=e,s={root:["root",t&&"tooltipArrow",c&&"touch",i&&`size${mn(i)}`,r&&`color${mn(r)}`,n&&`variant${mn(n)}`,`tooltipPlacement${mn(a.split("-")[0])}`],arrow:["arrow"]};return vr(s,jse,{})},Wse=nn("div",{name:"JoyTooltip",slot:"Root",overridesResolver:(e,t)=>t.root})(({ownerState:e,theme:t})=>{var n,r,i;const a=(n=t.variants[e.variant])==null?void 0:n[e.color];return ue({},e.size==="sm"&&{"--Icon-fontSize":t.vars.fontSize.md,"--Tooltip-arrowSize":"8px",padding:t.spacing(.25,.625)},e.size==="md"&&{"--Icon-fontSize":t.vars.fontSize.lg,"--Tooltip-arrowSize":"10px",padding:t.spacing(.5,.75)},e.size==="lg"&&{"--Icon-fontSize":t.vars.fontSize.xl,"--Tooltip-arrowSize":"12px",padding:t.spacing(.75,1)},{zIndex:t.vars.zIndex.tooltip,borderRadius:t.vars.radius.sm,boxShadow:t.shadow.sm,wordWrap:"break-word",position:"relative"},e.disableInteractive&&{pointerEvents:"none"},t.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],a,!a.backgroundColor&&{backgroundColor:t.vars.palette.background.surface},{"&::before":{content:'""',display:"block",position:"absolute",width:(r=e.placement)!=null&&r.match(/(top|bottom)/)?"100%":"calc(10px + var(--variant-borderWidth, 0px))",height:(i=e.placement)!=null&&i.match(/(top|bottom)/)?"calc(10px + var(--variant-borderWidth, 0px))":"100%"},'&[data-popper-placement*="bottom"]::before':{top:0,left:0,transform:"translateY(-100%)"},'&[data-popper-placement*="left"]::before':{top:0,right:0,transform:"translateX(100%)"},'&[data-popper-placement*="right"]::before':{top:0,left:0,transform:"translateX(-100%)"},'&[data-popper-placement*="top"]::before':{bottom:0,left:0,transform:"translateY(100%)"}})}),qse=nn("span",{name:"JoyTooltip",slot:"Arrow",overridesResolver:(e,t)=>t.arrow})(({theme:e,ownerState:t})=>{var n,r,i;const a=(n=e.variants[t.variant])==null?void 0:n[t.color];return{"--unstable_Tooltip-arrowRotation":0,width:"var(--Tooltip-arrowSize)",height:"var(--Tooltip-arrowSize)",boxSizing:"border-box","&::before":{content:'""',display:"block",position:"absolute",width:0,height:0,border:"calc(var(--Tooltip-arrowSize) / 2) solid",borderLeftColor:"transparent",borderBottomColor:"transparent",borderTopColor:(r=a==null?void 0:a.backgroundColor)!=null?r:e.vars.palette.background.surface,borderRightColor:(i=a==null?void 0:a.backgroundColor)!=null?i:e.vars.palette.background.surface,borderRadius:"0px 2px 0px 0px",boxShadow:`var(--variant-borderWidth, 0px) calc(-1 * var(--variant-borderWidth, 0px)) 0px 0px ${a.borderColor}`,transformOrigin:"center center",transform:"rotate(calc(-45deg + 90deg * var(--unstable_Tooltip-arrowRotation)))"},'[data-popper-placement*="bottom"] &':{top:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="top"] &':{"--unstable_Tooltip-arrowRotation":2,bottom:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="left"] &':{"--unstable_Tooltip-arrowRotation":1,right:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="right"] &':{"--unstable_Tooltip-arrowRotation":3,left:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"}}});let B1=!1;const qO=new S_;let h0={x:0,y:0};function XO(e,t){return n=>{t&&t(n),e(n)}}function ZO(e,t){return(n,...r)=>{t&&t(n,...r),e(n,...r)}}const Xse=$.forwardRef(function(t,n){var r;const i=br({props:t,name:"JoyTooltip"}),{children:a,className:c,component:s,arrow:f=!1,describeChild:g=!1,disableFocusListener:_=!1,disableHoverListener:x=!1,disableInteractive:C=!1,disableTouchListener:E=!1,enterDelay:A=100,enterNextDelay:L=0,enterTouchDelay:I=700,followCursor:T=!1,id:O,leaveDelay:D=0,leaveTouchDelay:U=1500,onClose:H,onOpen:V,open:q,disablePortal:Q,direction:K,keepMounted:N,modifiers:re,placement:ye="bottom",title:ge,color:Ve="neutral",variant:Ie="solid",size:ve="md",slots:Se={},slotProps:Me={}}=i,Be=Un(i,Hse),[Qe,st]=$.useState(),[ct,Xt]=$.useState(null),je=$.useRef(!1),lt=C||T,Ot=R0(),ut=R0(),ot=R0(),Tt=R0(),[Ct,un]=Vm({controlled:q,default:!1,name:"Tooltip",state:"open"});let gn=Ct;const hn=Gs(O),We=$.useRef(void 0),vn=Cl(()=>{We.current!==void 0&&(document.body.style.WebkitUserSelect=We.current,We.current=void 0),Tt.clear()});$.useEffect(()=>vn,[vn]);const Ut=Ft=>{qO.clear(),B1=!0,un(!0),V&&!gn&&V(Ft)},tn=Cl(Ft=>{qO.start(800+D,()=>{B1=!1}),un(!1),H&&gn&&H(Ft),Ot.start(150,()=>{je.current=!1})}),Dt=Ft=>{je.current&&Ft.type!=="touchstart"||(Qe&&Qe.removeAttribute("title"),ut.clear(),ot.clear(),A||B1&&L?ut.start(B1?L:A,()=>{Ut(Ft)}):Ut(Ft))},An=Ft=>{ut.clear(),ot.start(D,()=>{tn(Ft)})},{isFocusVisibleRef:an,onBlur:Le,onFocus:me,ref:it}=pR(),[,St]=$.useState(!1),It=Ft=>{Le(Ft),an.current===!1&&(St(!1),An(Ft))},wt=Ft=>{Qe||st(Ft.currentTarget),me(Ft),an.current===!0&&(St(!0),Dt(Ft))},Zt=Ft=>{je.current=!0;const be=a.props;be.onTouchStart&&be.onTouchStart(Ft)},Lt=Ft=>{Zt(Ft),ot.clear(),Ot.clear(),vn(),We.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Tt.start(I,()=>{document.body.style.WebkitUserSelect=We.current,Dt(Ft)})},kt=Ft=>{a.props.onTouchEnd&&a.props.onTouchEnd(Ft),vn(),ot.start(U,()=>{tn(Ft)})};$.useEffect(()=>{if(!gn)return;function Ft(be){(be.key==="Escape"||be.key==="Esc")&&tn(be)}return document.addEventListener("keydown",Ft),()=>{document.removeEventListener("keydown",Ft)}},[tn,gn]);const bn=Br(st,n),zt=Br(it,bn),_e=Br(JS(a),zt);typeof ge!="number"&&!ge&&(gn=!1);const ee=$.useRef(null),ne=Ft=>{const be=a.props;be.onMouseMove&&be.onMouseMove(Ft),h0={x:Ft.clientX,y:Ft.clientY},ee.current&&ee.current.update()},Z={},le=typeof ge=="string";g?(Z.title=!gn&&le&&!x?ge:null,Z["aria-describedby"]=gn?hn:null):(Z["aria-label"]=le?ge:null,Z["aria-labelledby"]=gn&&!le?hn:null);const Te=ue({},Z,Be,{component:s},a.props,{className:_i(c,a.props.className),onTouchStart:Zt,ref:_e},T?{onMouseMove:ne}:{}),$e={};E||(Te.onTouchStart=Lt,Te.onTouchEnd=kt),x||(Te.onMouseOver=XO(Dt,Te.onMouseOver),Te.onMouseLeave=XO(An,Te.onMouseLeave),lt||($e.onMouseOver=Dt,$e.onMouseLeave=An)),_||(Te.onFocus=ZO(wt,Te.onFocus),Te.onBlur=ZO(It,Te.onBlur),lt||($e.onFocus=wt,$e.onBlur=It));const fe=ue({},i,{arrow:f,disableInteractive:lt,placement:ye,touch:je.current,color:Ve,variant:Ie,size:ve}),xe=Gse(fe),Re=ue({},Be,{component:s,slots:Se,slotProps:Me}),De=$.useMemo(()=>[{name:"arrow",enabled:!!ct,options:{element:ct,padding:6}},{name:"offset",options:{offset:[0,10]}},...re||[]],[ct,re]),[ze,Je]=wn("root",{additionalProps:ue({id:hn,popperRef:ee,placement:ye,anchorEl:T?{getBoundingClientRect:()=>({top:h0.y,left:h0.x,right:h0.x,bottom:h0.y,width:0,height:0})}:Qe,open:Qe?gn:!1,disablePortal:Q,keepMounted:N,direction:K,modifiers:De},$e),ref:null,className:xe.root,elementType:Wse,externalForwardedProps:Re,ownerState:fe}),[Oe,Et]=wn("arrow",{ref:Xt,className:xe.arrow,elementType:qse,externalForwardedProps:Re,ownerState:fe});return te.jsxs($.Fragment,{children:[$.isValidElement(a)&&$.cloneElement(a,Te),te.jsxs(ze,ue({},Je,!((r=i.slots)!=null&&r.root)&&{as:_M,slots:{root:s||"div"}},{children:[ge,f?te.jsx(Oe,ue({},Et)):null]}))]})});var N8,YO=A_;N8=YO.createRoot,YO.hydrateRoot;var T3={};Object.defineProperty(T3,"__esModule",{value:!0});T3.parse=tae;T3.serialize=nae;const Zse=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Yse=/^[\u0021-\u003A\u003C-\u007E]*$/,Kse=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,Jse=/^[\u0020-\u003A\u003D-\u007E]*$/,Qse=Object.prototype.toString,eae=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function tae(e,t){const n=new eae,r=e.length;if(r<2)return n;const i=(t==null?void 0:t.decode)||rae;let a=0;do{const c=e.indexOf("=",a);if(c===-1)break;const s=e.indexOf(";",a),f=s===-1?r:s;if(c>f){a=e.lastIndexOf(";",c-1)+1;continue}const g=KO(e,a,c),_=JO(e,c,g),x=e.slice(g,_);if(n[x]===void 0){let C=KO(e,c+1,f),E=JO(e,f,C);const A=i(e.slice(C,E));n[x]=A}a=f+1}while(a<r);return n}function KO(e,t,n){do{const r=e.charCodeAt(t);if(r!==32&&r!==9)return t}while(++t<n);return n}function JO(e,t,n){for(;t>n;){const r=e.charCodeAt(--t);if(r!==32&&r!==9)return t+1}return n}function nae(e,t,n){const r=(n==null?void 0:n.encode)||encodeURIComponent;if(!Zse.test(e))throw new TypeError(`argument name is invalid: ${e}`);const i=r(t);if(!Yse.test(i))throw new TypeError(`argument val is invalid: ${t}`);let a=e+"="+i;if(!n)return a;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);a+="; Max-Age="+n.maxAge}if(n.domain){if(!Kse.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);a+="; Domain="+n.domain}if(n.path){if(!Jse.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);a+="; Path="+n.path}if(n.expires){if(!iae(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);a+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(a+="; HttpOnly"),n.secure&&(a+="; Secure"),n.partitioned&&(a+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"none":a+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return a}function rae(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function iae(e){return Qse.call(e)==="[object Date]"}/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var B8=e=>{throw TypeError(e)},oae=(e,t,n)=>t.has(e)||B8("Cannot "+n),mE=(e,t,n)=>(oae(e,t,"read from private field"),n?n.call(e):t.get(e)),sae=(e,t,n)=>t.has(e)?B8("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),QO="popstate";function aae(e={}){function t(r,i){let{pathname:a,search:c,hash:s}=r.location;return t_("",{pathname:a,search:c,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Oh(i)}return cae(t,n,null,e)}function lr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Fi(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function lae(){return Math.random().toString(36).substring(2,10)}function e5(e,t){return{usr:e.state,key:e.key,idx:t}}function t_(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Qh(t):t,state:n,key:t&&t.key||r||lae()}}function Oh({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Qh(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function cae(e,t,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,c=i.history,s="POP",f=null,g=_();g==null&&(g=0,c.replaceState({...c.state,idx:g},""));function _(){return(c.state||{idx:null}).idx}function x(){s="POP";let I=_(),T=I==null?null:I-g;g=I,f&&f({action:s,location:L.location,delta:T})}function C(I,T){s="PUSH";let O=t_(L.location,I,T);g=_()+1;let D=e5(O,g),U=L.createHref(O);try{c.pushState(D,"",U)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;i.location.assign(U)}a&&f&&f({action:s,location:L.location,delta:1})}function E(I,T){s="REPLACE";let O=t_(L.location,I,T);g=_();let D=e5(O,g),U=L.createHref(O);c.replaceState(D,"",U),a&&f&&f({action:s,location:L.location,delta:0})}function A(I){return U8(I)}let L={get action(){return s},get location(){return e(i,c)},listen(I){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(QO,x),f=I,()=>{i.removeEventListener(QO,x),f=null}},createHref(I){return t(i,I)},createURL:A,encodeLocation(I){let T=A(I);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:C,replace:E,go(I){return c.go(I)}};return L}function U8(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),lr(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Oh(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}var O0,t5=class{constructor(e){if(sae(this,O0,new Map),e)for(let[t,n]of e)this.set(t,n)}get(e){if(mE(this,O0).has(e))return mE(this,O0).get(e);if(e.defaultValue!==void 0)return e.defaultValue;throw new Error("No value found for context")}set(e,t){mE(this,O0).set(e,t)}};O0=new WeakMap;var uae=new Set(["lazy","caseSensitive","path","id","index","children"]);function hae(e){return uae.has(e)}var dae=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function fae(e){return dae.has(e)}function pae(e){return e.index===!0}function Kw(e,t,n=[],r={}){return e.map((i,a)=>{let c=[...n,String(a)],s=typeof i.id=="string"?i.id:c.join("-");if(lr(i.index!==!0||!i.children,"Cannot specify children on an index route"),lr(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),pae(i)){let f={...i,...t(i),id:s};return r[s]=f,f}else{let f={...i,...t(i),id:s,children:void 0};return r[s]=f,i.children&&(f.children=Kw(i.children,t,c,r)),f}})}function dh(e,t,n="/"){return Wb(e,t,n,!1)}function Wb(e,t,n,r){let i=typeof t=="string"?Qh(t):t,a=Ka(i.pathname||"/",n);if(a==null)return null;let c=$8(e);gae(c);let s=null;for(let f=0;s==null&&f<c.length;++f){let g=Tae(a);s=Cae(c[f],g,r)}return s}function mae(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],handle:n.handle}}function $8(e,t=[],n=[],r=""){let i=(a,c,s)=>{let f={relativePath:s===void 0?a.path||"":s,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};f.relativePath.startsWith("/")&&(lr(f.relativePath.startsWith(r),`Absolute route path "${f.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(r.length));let g=fc([r,f.relativePath]),_=n.concat(f);a.children&&a.children.length>0&&(lr(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),$8(a.children,t,_,g)),!(a.path==null&&!a.index)&&t.push({path:g,score:Sae(g,a.index),routesMeta:_})};return e.forEach((a,c)=>{var s;if(a.path===""||!((s=a.path)!=null&&s.includes("?")))i(a,c);else for(let f of V8(a.path))i(a,c,f)}),t}function V8(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return i?[a,""]:[a];let c=V8(r.join("/")),s=[];return s.push(...c.map(f=>f===""?a:[a,f].join("/"))),i&&s.push(...c),s.map(f=>e.startsWith("/")&&f===""?"/":f)}function gae(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Mae(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var vae=/^:[\w-]+$/,yae=3,_ae=2,xae=1,bae=10,wae=-2,n5=e=>e==="*";function Sae(e,t){let n=e.split("/"),r=n.length;return n.some(n5)&&(r+=wae),t&&(r+=_ae),n.filter(i=>!n5(i)).reduce((i,a)=>i+(vae.test(a)?yae:a===""?xae:bae),r)}function Mae(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function Cae(e,t,n=!1){let{routesMeta:r}=e,i={},a="/",c=[];for(let s=0;s<r.length;++s){let f=r[s],g=s===r.length-1,_=a==="/"?t:t.slice(a.length)||"/",x=Jw({path:f.relativePath,caseSensitive:f.caseSensitive,end:g},_),C=f.route;if(!x&&g&&n&&!r[r.length-1].route.index&&(x=Jw({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},_)),!x)return null;Object.assign(i,x.params),c.push({params:i,pathname:fc([a,x.pathname]),pathnameBase:Iae(fc([a,x.pathnameBase])),route:C}),x.pathnameBase!=="/"&&(a=fc([a,x.pathnameBase]))}return c}function Jw(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Eae(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],c=a.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((g,{paramName:_,isOptional:x},C)=>{if(_==="*"){let A=s[C]||"";c=a.slice(0,a.length-A.length).replace(/(.)\/+$/,"$1")}const E=s[C];return x&&!E?g[_]=void 0:g[_]=(E||"").replace(/%2F/g,"/"),g},{}),pathname:a,pathnameBase:c,pattern:e}}function Eae(e,t=!1,n=!0){Fi(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,s,f)=>(r.push({paramName:s,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function Tae(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Fi(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Ka(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Pae(e,t="/"){let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?Qh(e):e;return{pathname:n?n.startsWith("/")?n:Aae(n,t):t,search:Rae(r),hash:Lae(i)}}function Aae(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function gE(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function j8(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function P3(e){let t=j8(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function A3(e,t,n,r=!1){let i;typeof e=="string"?i=Qh(e):(i={...e},lr(!i.pathname||!i.pathname.includes("?"),gE("?","pathname","search",i)),lr(!i.pathname||!i.pathname.includes("#"),gE("#","pathname","hash",i)),lr(!i.search||!i.search.includes("#"),gE("#","search","hash",i)));let a=e===""||i.pathname==="",c=a?"/":i.pathname,s;if(c==null)s=n;else{let x=t.length-1;if(!r&&c.startsWith("..")){let C=c.split("/");for(;C[0]==="..";)C.shift(),x-=1;i.pathname=C.join("/")}s=x>=0?t[x]:"/"}let f=Pae(i,s),g=c&&c!=="/"&&c.endsWith("/"),_=(a||c===".")&&n.endsWith("/");return!f.pathname.endsWith("/")&&(g||_)&&(f.pathname+="/"),f}var fc=e=>e.join("/").replace(/\/\/+/g,"/"),Iae=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Rae=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Lae=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,Qw=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function n_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var H8=["POST","PUT","PATCH","DELETE"],kae=new Set(H8),Dae=["GET",...H8],zae=new Set(Dae),Oae=new Set([301,302,303,307,308]),Fae=new Set([307,308]),vE={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Nae={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},d0={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},I3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bae=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),G8="remix-router-transitions",W8=Symbol("ResetLoaderData");function Uae(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";lr(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.hydrationRouteProperties||[],i=e.mapRouteProperties||Bae,a={},c=Kw(e.routes,i,void 0,a),s,f=e.basename||"/",g=e.dataStrategy||Gae,_={unstable_middleware:!1,...e.future},x=null,C=new Set,E=null,A=null,L=null,I=e.hydrationData!=null,T=dh(c,e.history.location,f),O=!1,D=null,U;if(T==null&&!e.patchRoutesOnNavigation){let be=Fa(404,{pathname:e.history.location.pathname}),{matches:qe,route:tt}=p5(c);U=!0,T=qe,D={[tt.id]:be}}else if(T&&!e.hydrationData&&Je(T,c,e.history.location.pathname).active&&(T=null),T)if(T.some(be=>be.route.lazy))U=!1;else if(!T.some(be=>be.route.loader))U=!0;else{let be=e.hydrationData?e.hydrationData.loaderData:null,qe=e.hydrationData?e.hydrationData.errors:null;if(qe){let tt=T.findIndex(At=>qe[At.route.id]!==void 0);U=T.slice(0,tt+1).every(At=>!pA(At.route,be,qe))}else U=T.every(tt=>!pA(tt.route,be,qe))}else{U=!1,T=[];let be=Je(null,c,e.history.location.pathname);be.active&&be.matches&&(O=!0,T=be.matches)}let H,V={historyAction:e.history.action,location:e.history.location,matches:T,initialized:U,navigation:vE,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||D,fetchers:new Map,blockers:new Map},q="POP",Q=!1,K,N=!1,re=new Map,ye=null,ge=!1,Ve=!1,Ie=new Set,ve=new Map,Se=0,Me=-1,Be=new Map,Qe=new Set,st=new Map,ct=new Map,Xt=new Set,je=new Map,lt,Ot=null;function ut(){if(x=e.history.listen(({action:be,location:qe,delta:tt})=>{if(lt){lt(),lt=void 0;return}Fi(je.size===0||tt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let At=$e({currentLocation:V.location,nextLocation:qe,historyAction:be});if(At&&tt!=null){let Ht=new Promise(Yt=>{lt=Yt});e.history.go(tt*-1),Te(At,{state:"blocked",location:qe,proceed(){Te(At,{state:"proceeding",proceed:void 0,reset:void 0,location:qe}),Ht.then(()=>e.history.go(tt))},reset(){let Yt=new Map(V.blockers);Yt.set(At,d0),Ct({blockers:Yt})}});return}return We(be,qe)}),n){nle(t,re);let be=()=>rle(t,re);t.addEventListener("pagehide",be),ye=()=>t.removeEventListener("pagehide",be)}return V.initialized||We("POP",V.location,{initialHydration:!0}),H}function ot(){x&&x(),ye&&ye(),C.clear(),K&&K.abort(),V.fetchers.forEach((be,qe)=>kt(qe)),V.blockers.forEach((be,qe)=>le(qe))}function Tt(be){return C.add(be),()=>C.delete(be)}function Ct(be,qe={}){V={...V,...be};let tt=[],At=[];V.fetchers.forEach((Ht,Yt)=>{Ht.state==="idle"&&(Xt.has(Yt)?tt.push(Yt):At.push(Yt))}),Xt.forEach(Ht=>{!V.fetchers.has(Ht)&&!ve.has(Ht)&&tt.push(Ht)}),[...C].forEach(Ht=>Ht(V,{deletedFetchers:tt,viewTransitionOpts:qe.viewTransitionOpts,flushSync:qe.flushSync===!0})),tt.forEach(Ht=>kt(Ht)),At.forEach(Ht=>V.fetchers.delete(Ht))}function un(be,qe,{flushSync:tt}={}){var gt,In;let At=V.actionData!=null&&V.navigation.formMethod!=null&&ha(V.navigation.formMethod)&&V.navigation.state==="loading"&&((gt=be.state)==null?void 0:gt._isRedirect)!==!0,Ht;qe.actionData?Object.keys(qe.actionData).length>0?Ht=qe.actionData:Ht=null:At?Ht=V.actionData:Ht=null;let Yt=qe.loaderData?d5(V.loaderData,qe.loaderData,qe.matches||[],qe.errors):V.loaderData,qt=V.blockers;qt.size>0&&(qt=new Map(qt),qt.forEach((cn,Nn)=>qt.set(Nn,d0)));let Gt=Q===!0||V.navigation.formMethod!=null&&ha(V.navigation.formMethod)&&((In=be.state)==null?void 0:In._isRedirect)!==!0;s&&(c=s,s=void 0),ge||q==="POP"||(q==="PUSH"?e.history.push(be,be.state):q==="REPLACE"&&e.history.replace(be,be.state));let yn;if(q==="POP"){let cn=re.get(V.location.pathname);cn&&cn.has(be.pathname)?yn={currentLocation:V.location,nextLocation:be}:re.has(be.pathname)&&(yn={currentLocation:be,nextLocation:V.location})}else if(N){let cn=re.get(V.location.pathname);cn?cn.add(be.pathname):(cn=new Set([be.pathname]),re.set(V.location.pathname,cn)),yn={currentLocation:V.location,nextLocation:be}}Ct({...qe,actionData:Ht,loaderData:Yt,historyAction:q,location:be,initialized:!0,navigation:vE,revalidation:"idle",restoreScrollPosition:ze(be,qe.matches||V.matches),preventScrollReset:Gt,blockers:qt},{viewTransitionOpts:yn,flushSync:tt===!0}),q="POP",Q=!1,N=!1,ge=!1,Ve=!1,Ot==null||Ot.resolve(),Ot=null}async function gn(be,qe){if(typeof be=="number"){e.history.go(be);return}let tt=fA(V.location,V.matches,f,be,qe==null?void 0:qe.fromRouteId,qe==null?void 0:qe.relative),{path:At,submission:Ht,error:Yt}=r5(!1,tt,qe),qt=V.location,Gt=t_(V.location,At,qe&&qe.state);Gt={...Gt,...e.history.encodeLocation(Gt)};let yn=qe&&qe.replace!=null?qe.replace:void 0,gt="PUSH";yn===!0?gt="REPLACE":yn===!1||Ht!=null&&ha(Ht.formMethod)&&Ht.formAction===V.location.pathname+V.location.search&&(gt="REPLACE");let In=qe&&"preventScrollReset"in qe?qe.preventScrollReset===!0:void 0,cn=(qe&&qe.flushSync)===!0,Nn=$e({currentLocation:qt,nextLocation:Gt,historyAction:gt});if(Nn){Te(Nn,{state:"blocked",location:Gt,proceed(){Te(Nn,{state:"proceeding",proceed:void 0,reset:void 0,location:Gt}),gn(be,qe)},reset(){let xt=new Map(V.blockers);xt.set(Nn,d0),Ct({blockers:xt})}});return}await We(gt,Gt,{submission:Ht,pendingError:Yt,preventScrollReset:In,replace:qe&&qe.replace,enableViewTransition:qe&&qe.viewTransition,flushSync:cn})}function hn(){Ot||(Ot=ile()),It(),Ct({revalidation:"loading"});let be=Ot.promise;return V.navigation.state==="submitting"?be:V.navigation.state==="idle"?(We(V.historyAction,V.location,{startUninterruptedRevalidation:!0}),be):(We(q||V.historyAction,V.navigation.location,{overrideNavigation:V.navigation,enableViewTransition:N===!0}),be)}async function We(be,qe,tt){K&&K.abort(),K=null,q=be,ge=(tt&&tt.startUninterruptedRevalidation)===!0,De(V.location,V.matches),Q=(tt&&tt.preventScrollReset)===!0,N=(tt&&tt.enableViewTransition)===!0;let At=s||c,Ht=tt&&tt.overrideNavigation,Yt=tt!=null&&tt.initialHydration&&V.matches&&V.matches.length>0&&!O?V.matches:dh(At,qe,f),qt=(tt&&tt.flushSync)===!0;if(Yt&&V.initialized&&!Ve&&Kae(V.location,qe)&&!(tt&&tt.submission&&ha(tt.submission.formMethod))){un(qe,{matches:Yt},{flushSync:qt});return}let Gt=Je(Yt,At,qe.pathname);if(Gt.active&&Gt.matches&&(Yt=Gt.matches),!Yt){let{error:Rt,notFoundMatches:Wt,route:pn}=fe(qe.pathname);un(qe,{matches:Wt,loaderData:{},errors:{[pn.id]:Rt}},{flushSync:qt});return}K=new AbortController;let yn=hm(e.history,qe,K.signal,tt&&tt.submission),gt=new t5(e.unstable_getContext?await e.unstable_getContext():void 0),In;if(tt&&tt.pendingError)In=[sf(Yt).route.id,{type:"error",error:tt.pendingError}];else if(tt&&tt.submission&&ha(tt.submission.formMethod)){let Rt=await vn(yn,qe,tt.submission,Yt,gt,Gt.active,tt&&tt.initialHydration===!0,{replace:tt.replace,flushSync:qt});if(Rt.shortCircuited)return;if(Rt.pendingActionResult){let[Wt,pn]=Rt.pendingActionResult;if(ua(pn)&&n_(pn.error)&&pn.error.status===404){K=null,un(qe,{matches:Rt.matches,loaderData:{},errors:{[Wt]:pn.error}});return}}Yt=Rt.matches||Yt,In=Rt.pendingActionResult,Ht=yE(qe,tt.submission),qt=!1,Gt.active=!1,yn=hm(e.history,yn.url,yn.signal)}let{shortCircuited:cn,matches:Nn,loaderData:xt,errors:Ze}=await Ut(yn,qe,Yt,gt,Gt.active,Ht,tt&&tt.submission,tt&&tt.fetcherSubmission,tt&&tt.replace,tt&&tt.initialHydration===!0,qt,In);cn||(K=null,un(qe,{matches:Nn||Yt,...f5(In),loaderData:xt,errors:Ze}))}async function vn(be,qe,tt,At,Ht,Yt,qt,Gt={}){It();let yn=ele(qe,tt);if(Ct({navigation:yn},{flushSync:Gt.flushSync===!0}),Yt){let cn=await Oe(At,qe.pathname,be.signal);if(cn.type==="aborted")return{shortCircuited:!0};if(cn.type==="error"){let Nn=sf(cn.partialMatches).route.id;return{matches:cn.partialMatches,pendingActionResult:[Nn,{type:"error",error:cn.error}]}}else if(cn.matches)At=cn.matches;else{let{notFoundMatches:Nn,error:xt,route:Ze}=fe(qe.pathname);return{matches:Nn,pendingActionResult:[Ze.id,{type:"error",error:xt}]}}}let gt,In=F0(At,qe);if(!In.route.action&&!In.route.lazy)gt={type:"error",error:Fa(405,{method:be.method,pathname:qe.pathname,routeId:In.route.id})};else{let cn=Ym(i,a,be,At,In,qt?[]:r,Ht),Nn=await it(be,cn,Ht,null);if(gt=Nn[In.route.id],!gt){for(let xt of At)if(Nn[xt.route.id]){gt=Nn[xt.route.id];break}}if(be.signal.aborted)return{shortCircuited:!0}}if(ff(gt)){let cn;return Gt&&Gt.replace!=null?cn=Gt.replace:cn=c5(gt.response.headers.get("Location"),new URL(be.url),f)===V.location.pathname+V.location.search,await me(be,gt,!0,{submission:tt,replace:cn}),{shortCircuited:!0}}if(ua(gt)){let cn=sf(At,In.route.id);return(Gt&&Gt.replace)!==!0&&(q="PUSH"),{matches:At,pendingActionResult:[cn.route.id,gt,In.route.id]}}return{matches:At,pendingActionResult:[In.route.id,gt]}}async function Ut(be,qe,tt,At,Ht,Yt,qt,Gt,yn,gt,In,cn){let Nn=Yt||yE(qe,qt),xt=qt||Gt||g5(Nn),Ze=!ge&&!gt;if(Ht){if(Ze){let ln=tn(cn);Ct({navigation:Nn,...ln!==void 0?{actionData:ln}:{}},{flushSync:In})}let Qt=await Oe(tt,qe.pathname,be.signal);if(Qt.type==="aborted")return{shortCircuited:!0};if(Qt.type==="error"){let ln=sf(Qt.partialMatches).route.id;return{matches:Qt.partialMatches,loaderData:{},errors:{[ln]:Qt.error}}}else if(Qt.matches)tt=Qt.matches;else{let{error:ln,notFoundMatches:Nt,route:zn}=fe(qe.pathname);return{matches:Nt,loaderData:{},errors:{[zn.id]:ln}}}}let Rt=s||c,{dsMatches:Wt,revalidatingFetchers:pn}=i5(be,At,i,a,e.history,V,tt,xt,qe,gt?[]:r,gt===!0,Ve,Ie,Xt,st,Qe,Rt,f,e.patchRoutesOnNavigation!=null,cn);if(Me=++Se,!e.dataStrategy&&!Wt.some(Qt=>Qt.shouldLoad)&&pn.length===0){let Qt=ee();return un(qe,{matches:tt,loaderData:{},errors:cn&&ua(cn[1])?{[cn[0]]:cn[1].error}:null,...f5(cn),...Qt?{fetchers:new Map(V.fetchers)}:{}},{flushSync:In}),{shortCircuited:!0}}if(Ze){let Qt={};if(!Ht){Qt.navigation=Nn;let ln=tn(cn);ln!==void 0&&(Qt.actionData=ln)}pn.length>0&&(Qt.fetchers=Dt(pn)),Ct(Qt,{flushSync:In})}pn.forEach(Qt=>{zt(Qt.key),Qt.controller&&ve.set(Qt.key,Qt.controller)});let cr=()=>pn.forEach(Qt=>zt(Qt.key));K&&K.signal.addEventListener("abort",cr);let{loaderResults:qn,fetcherResults:pe}=await St(Wt,pn,be,At);if(be.signal.aborted)return{shortCircuited:!0};K&&K.signal.removeEventListener("abort",cr),pn.forEach(Qt=>ve.delete(Qt.key));let nt=U1(qn);if(nt)return await me(be,nt.result,!0,{replace:yn}),{shortCircuited:!0};if(nt=U1(pe),nt)return Qe.add(nt.key),await me(be,nt.result,!0,{replace:yn}),{shortCircuited:!0};let{loaderData:vt,errors:ft}=h5(V,tt,qn,cn,pn,pe);gt&&V.errors&&(ft={...V.errors,...ft});let at=ee(),Kt=ne(Me),fn=at||Kt||pn.length>0;return{matches:tt,loaderData:vt,errors:ft,...fn?{fetchers:new Map(V.fetchers)}:{}}}function tn(be){if(be&&!ua(be[1]))return{[be[0]]:be[1].data};if(V.actionData)return Object.keys(V.actionData).length===0?null:V.actionData}function Dt(be){return be.forEach(qe=>{let tt=V.fetchers.get(qe.key),At=f0(void 0,tt?tt.data:void 0);V.fetchers.set(qe.key,At)}),new Map(V.fetchers)}async function An(be,qe,tt,At){zt(be);let Ht=(At&&At.flushSync)===!0,Yt=s||c,qt=fA(V.location,V.matches,f,tt,qe,At==null?void 0:At.relative),Gt=dh(Yt,qt,f),yn=Je(Gt,Yt,qt);if(yn.active&&yn.matches&&(Gt=yn.matches),!Gt){Zt(be,qe,Fa(404,{pathname:qt}),{flushSync:Ht});return}let{path:gt,submission:In,error:cn}=r5(!0,qt,At);if(cn){Zt(be,qe,cn,{flushSync:Ht});return}let Nn=F0(Gt,gt),xt=new t5(e.unstable_getContext?await e.unstable_getContext():void 0),Ze=(At&&At.preventScrollReset)===!0;if(In&&ha(In.formMethod)){await an(be,qe,gt,Nn,Gt,xt,yn.active,Ht,Ze,In);return}st.set(be,{routeId:qe,path:gt}),await Le(be,qe,gt,Nn,Gt,xt,yn.active,Ht,Ze,In)}async function an(be,qe,tt,At,Ht,Yt,qt,Gt,yn,gt){It(),st.delete(be);function In(Rn){if(!Rn.route.action&&!Rn.route.lazy){let jn=Fa(405,{method:gt.formMethod,pathname:tt,routeId:qe});return Zt(be,qe,jn,{flushSync:Gt}),!0}return!1}if(!qt&&In(At))return;let cn=V.fetchers.get(be);wt(be,tle(gt,cn),{flushSync:Gt});let Nn=new AbortController,xt=hm(e.history,tt,Nn.signal,gt);if(qt){let Rn=await Oe(Ht,tt,xt.signal,be);if(Rn.type==="aborted")return;if(Rn.type==="error"){Zt(be,qe,Rn.error,{flushSync:Gt});return}else if(Rn.matches){if(Ht=Rn.matches,At=F0(Ht,tt),In(At))return}else{Zt(be,qe,Fa(404,{pathname:tt}),{flushSync:Gt});return}}ve.set(be,Nn);let Ze=Se,Rt=Ym(i,a,xt,Ht,At,r,Yt),pn=(await it(xt,Rt,Yt,be))[At.route.id];if(xt.signal.aborted){ve.get(be)===Nn&&ve.delete(be);return}if(Xt.has(be)){if(ff(pn)||ua(pn)){wt(be,ih(void 0));return}}else{if(ff(pn))if(ve.delete(be),Me>Ze){wt(be,ih(void 0));return}else return Qe.add(be),wt(be,f0(gt)),me(xt,pn,!1,{fetcherSubmission:gt,preventScrollReset:yn});if(ua(pn)){Zt(be,qe,pn.error);return}}let cr=V.navigation.location||V.location,qn=hm(e.history,cr,Nn.signal),pe=s||c,nt=V.navigation.state!=="idle"?dh(pe,V.navigation.location,f):V.matches;lr(nt,"Didn't find any matches after fetcher action");let vt=++Se;Be.set(be,vt);let ft=f0(gt,pn.data);V.fetchers.set(be,ft);let{dsMatches:at,revalidatingFetchers:Kt}=i5(qn,Yt,i,a,e.history,V,nt,gt,cr,r,!1,Ve,Ie,Xt,st,Qe,pe,f,e.patchRoutesOnNavigation!=null,[At.route.id,pn]);Kt.filter(Rn=>Rn.key!==be).forEach(Rn=>{let jn=Rn.key,hr=V.fetchers.get(jn),dr=f0(void 0,hr?hr.data:void 0);V.fetchers.set(jn,dr),zt(jn),Rn.controller&&ve.set(jn,Rn.controller)}),Ct({fetchers:new Map(V.fetchers)});let fn=()=>Kt.forEach(Rn=>zt(Rn.key));Nn.signal.addEventListener("abort",fn);let{loaderResults:Qt,fetcherResults:ln}=await St(at,Kt,qn,Yt);if(Nn.signal.aborted)return;if(Nn.signal.removeEventListener("abort",fn),Be.delete(be),ve.delete(be),Kt.forEach(Rn=>ve.delete(Rn.key)),V.fetchers.has(be)){let Rn=ih(pn.data);V.fetchers.set(be,Rn)}let Nt=U1(Qt);if(Nt)return me(qn,Nt.result,!1,{preventScrollReset:yn});if(Nt=U1(ln),Nt)return Qe.add(Nt.key),me(qn,Nt.result,!1,{preventScrollReset:yn});let{loaderData:zn,errors:_n}=h5(V,nt,Qt,void 0,Kt,ln);ne(vt),V.navigation.state==="loading"&&vt>Me?(lr(q,"Expected pending action"),K&&K.abort(),un(V.navigation.location,{matches:nt,loaderData:zn,errors:_n,fetchers:new Map(V.fetchers)})):(Ct({errors:_n,loaderData:d5(V.loaderData,zn,nt,_n),fetchers:new Map(V.fetchers)}),Ve=!1)}async function Le(be,qe,tt,At,Ht,Yt,qt,Gt,yn,gt){let In=V.fetchers.get(be);wt(be,f0(gt,In?In.data:void 0),{flushSync:Gt});let cn=new AbortController,Nn=hm(e.history,tt,cn.signal);if(qt){let pn=await Oe(Ht,tt,Nn.signal,be);if(pn.type==="aborted")return;if(pn.type==="error"){Zt(be,qe,pn.error,{flushSync:Gt});return}else if(pn.matches)Ht=pn.matches,At=F0(Ht,tt);else{Zt(be,qe,Fa(404,{pathname:tt}),{flushSync:Gt});return}}ve.set(be,cn);let xt=Se,Ze=Ym(i,a,Nn,Ht,At,r,Yt),Wt=(await it(Nn,Ze,Yt,be))[At.route.id];if(ve.get(be)===cn&&ve.delete(be),!Nn.signal.aborted){if(Xt.has(be)){wt(be,ih(void 0));return}if(ff(Wt))if(Me>xt){wt(be,ih(void 0));return}else{Qe.add(be),await me(Nn,Wt,!1,{preventScrollReset:yn});return}if(ua(Wt)){Zt(be,qe,Wt.error);return}wt(be,ih(Wt.data))}}async function me(be,qe,tt,{submission:At,fetcherSubmission:Ht,preventScrollReset:Yt,replace:qt}={}){qe.response.headers.has("X-Remix-Revalidate")&&(Ve=!0);let Gt=qe.response.headers.get("Location");lr(Gt,"Expected a Location header on the redirect Response"),Gt=c5(Gt,new URL(be.url),f);let yn=t_(V.location,Gt,{_isRedirect:!0});if(n){let Ze=!1;if(qe.response.headers.has("X-Remix-Reload-Document"))Ze=!0;else if(I3.test(Gt)){const Rt=U8(Gt,!0);Ze=Rt.origin!==t.location.origin||Ka(Rt.pathname,f)==null}if(Ze){qt?t.location.replace(Gt):t.location.assign(Gt);return}}K=null;let gt=qt===!0||qe.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:In,formAction:cn,formEncType:Nn}=V.navigation;!At&&!Ht&&In&&cn&&Nn&&(At=g5(V.navigation));let xt=At||Ht;if(Fae.has(qe.response.status)&&xt&&ha(xt.formMethod))await We(gt,yn,{submission:{...xt,formAction:Gt},preventScrollReset:Yt||Q,enableViewTransition:tt?N:void 0});else{let Ze=yE(yn,At);await We(gt,yn,{overrideNavigation:Ze,fetcherSubmission:Ht,preventScrollReset:Yt||Q,enableViewTransition:tt?N:void 0})}}async function it(be,qe,tt,At){let Ht,Yt={};try{Ht=await Wae(g,be,qe,At,tt,!1)}catch(qt){return qe.filter(Gt=>Gt.shouldLoad).forEach(Gt=>{Yt[Gt.route.id]={type:"error",error:qt}}),Yt}if(be.signal.aborted)return Yt;for(let[qt,Gt]of Object.entries(Ht))if(Jae(Gt)){let yn=Gt.result;Yt[qt]={type:"redirect",response:Zae(yn,be,qt,qe,f)}}else Yt[qt]=await Xae(Gt);return Yt}async function St(be,qe,tt,At){let Ht=it(tt,be,At,null),Yt=Promise.all(qe.map(async yn=>{if(yn.matches&&yn.match&&yn.request&&yn.controller){let In=(await it(yn.request,yn.matches,At,yn.key))[yn.match.route.id];return{[yn.key]:In}}else return Promise.resolve({[yn.key]:{type:"error",error:Fa(404,{pathname:yn.path})}})})),qt=await Ht,Gt=(await Yt).reduce((yn,gt)=>Object.assign(yn,gt),{});return{loaderResults:qt,fetcherResults:Gt}}function It(){Ve=!0,st.forEach((be,qe)=>{ve.has(qe)&&Ie.add(qe),zt(qe)})}function wt(be,qe,tt={}){V.fetchers.set(be,qe),Ct({fetchers:new Map(V.fetchers)},{flushSync:(tt&&tt.flushSync)===!0})}function Zt(be,qe,tt,At={}){let Ht=sf(V.matches,qe);kt(be),Ct({errors:{[Ht.route.id]:tt},fetchers:new Map(V.fetchers)},{flushSync:(At&&At.flushSync)===!0})}function Lt(be){return ct.set(be,(ct.get(be)||0)+1),Xt.has(be)&&Xt.delete(be),V.fetchers.get(be)||Nae}function kt(be){let qe=V.fetchers.get(be);ve.has(be)&&!(qe&&qe.state==="loading"&&Be.has(be))&&zt(be),st.delete(be),Be.delete(be),Qe.delete(be),Xt.delete(be),Ie.delete(be),V.fetchers.delete(be)}function bn(be){let qe=(ct.get(be)||0)-1;qe<=0?(ct.delete(be),Xt.add(be)):ct.set(be,qe),Ct({fetchers:new Map(V.fetchers)})}function zt(be){let qe=ve.get(be);qe&&(qe.abort(),ve.delete(be))}function _e(be){for(let qe of be){let tt=Lt(qe),At=ih(tt.data);V.fetchers.set(qe,At)}}function ee(){let be=[],qe=!1;for(let tt of Qe){let At=V.fetchers.get(tt);lr(At,`Expected fetcher: ${tt}`),At.state==="loading"&&(Qe.delete(tt),be.push(tt),qe=!0)}return _e(be),qe}function ne(be){let qe=[];for(let[tt,At]of Be)if(At<be){let Ht=V.fetchers.get(tt);lr(Ht,`Expected fetcher: ${tt}`),Ht.state==="loading"&&(zt(tt),Be.delete(tt),qe.push(tt))}return _e(qe),qe.length>0}function Z(be,qe){let tt=V.blockers.get(be)||d0;return je.get(be)!==qe&&je.set(be,qe),tt}function le(be){V.blockers.delete(be),je.delete(be)}function Te(be,qe){let tt=V.blockers.get(be)||d0;lr(tt.state==="unblocked"&&qe.state==="blocked"||tt.state==="blocked"&&qe.state==="blocked"||tt.state==="blocked"&&qe.state==="proceeding"||tt.state==="blocked"&&qe.state==="unblocked"||tt.state==="proceeding"&&qe.state==="unblocked",`Invalid blocker state transition: ${tt.state} -> ${qe.state}`);let At=new Map(V.blockers);At.set(be,qe),Ct({blockers:At})}function $e({currentLocation:be,nextLocation:qe,historyAction:tt}){if(je.size===0)return;je.size>1&&Fi(!1,"A router only supports one blocker at a time");let At=Array.from(je.entries()),[Ht,Yt]=At[At.length-1],qt=V.blockers.get(Ht);if(!(qt&&qt.state==="proceeding")&&Yt({currentLocation:be,nextLocation:qe,historyAction:tt}))return Ht}function fe(be){let qe=Fa(404,{pathname:be}),tt=s||c,{matches:At,route:Ht}=p5(tt);return{notFoundMatches:At,route:Ht,error:qe}}function xe(be,qe,tt){if(E=be,L=qe,A=tt||null,!I&&V.navigation===vE){I=!0;let At=ze(V.location,V.matches);At!=null&&Ct({restoreScrollPosition:At})}return()=>{E=null,L=null,A=null}}function Re(be,qe){return A&&A(be,qe.map(At=>mae(At,V.loaderData)))||be.key}function De(be,qe){if(E&&L){let tt=Re(be,qe);E[tt]=L()}}function ze(be,qe){if(E){let tt=Re(be,qe),At=E[tt];if(typeof At=="number")return At}return null}function Je(be,qe,tt){if(e.patchRoutesOnNavigation)if(be){if(Object.keys(be[0].params).length>0)return{active:!0,matches:Wb(qe,tt,f,!0)}}else return{active:!0,matches:Wb(qe,tt,f,!0)||[]};return{active:!1,matches:null}}async function Oe(be,qe,tt,At){if(!e.patchRoutesOnNavigation)return{type:"success",matches:be};let Ht=be;for(;;){let Yt=s==null,qt=s||c,Gt=a;try{await e.patchRoutesOnNavigation({signal:tt,path:qe,matches:Ht,fetcherKey:At,patch:(In,cn)=>{tt.aborted||o5(In,cn,qt,Gt,i)}})}catch(In){return{type:"error",error:In,partialMatches:Ht}}finally{Yt&&!tt.aborted&&(c=[...c])}if(tt.aborted)return{type:"aborted"};let yn=dh(qt,qe,f);if(yn)return{type:"success",matches:yn};let gt=Wb(qt,qe,f,!0);if(!gt||Ht.length===gt.length&&Ht.every((In,cn)=>In.route.id===gt[cn].route.id))return{type:"success",matches:null};Ht=gt}}function Et(be){a={},s=Kw(be,i,void 0,a)}function Ft(be,qe){let tt=s==null;o5(be,qe,s||c,a,i),tt&&(c=[...c],Ct({}))}return H={get basename(){return f},get future(){return _},get state(){return V},get routes(){return c},get window(){return t},initialize:ut,subscribe:Tt,enableScrollRestoration:xe,navigate:gn,fetch:An,revalidate:hn,createHref:be=>e.history.createHref(be),encodeLocation:be=>e.history.encodeLocation(be),getFetcher:Lt,deleteFetcher:bn,dispose:ot,getBlocker:Z,deleteBlocker:le,patchRoutes:Ft,_internalFetchControllers:ve,_internalSetRoutes:Et},H}function $ae(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function fA(e,t,n,r,i,a){let c,s;if(i){c=[];for(let g of t)if(c.push(g),g.route.id===i){s=g;break}}else c=t,s=t[t.length-1];let f=A3(r||".",P3(c),Ka(e.pathname,n)||e.pathname,a==="path");if(r==null&&(f.search=e.search,f.hash=e.hash),(r==null||r===""||r===".")&&s){let g=R3(f.search);if(s.route.index&&!g)f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&g){let _=new URLSearchParams(f.search),x=_.getAll("index");_.delete("index"),x.filter(E=>E).forEach(E=>_.append("index",E));let C=_.toString();f.search=C?`?${C}`:""}}return n!=="/"&&(f.pathname=f.pathname==="/"?n:fc([n,f.pathname])),Oh(f)}function r5(e,t,n){if(!n||!$ae(n))return{path:t};if(n.formMethod&&!Qae(n.formMethod))return{path:t,error:Fa(405,{method:n.formMethod})};let r=()=>({path:t,error:Fa(400,{type:"invalid-body"})}),a=(n.formMethod||"get").toUpperCase(),c=J8(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!ha(a))return r();let x=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((C,[E,A])=>`${C}${E}=${A}
`,""):String(n.body);return{path:t,submission:{formMethod:a,formAction:c,formEncType:n.formEncType,formData:void 0,json:void 0,text:x}}}else if(n.formEncType==="application/json"){if(!ha(a))return r();try{let x=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:a,formAction:c,formEncType:n.formEncType,formData:void 0,json:x,text:void 0}}}catch{return r()}}}lr(typeof FormData=="function","FormData is not available in this environment");let s,f;if(n.formData)s=gA(n.formData),f=n.formData;else if(n.body instanceof FormData)s=gA(n.body),f=n.body;else if(n.body instanceof URLSearchParams)s=n.body,f=u5(s);else if(n.body==null)s=new URLSearchParams,f=new FormData;else try{s=new URLSearchParams(n.body),f=u5(s)}catch{return r()}let g={formMethod:a,formAction:c,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:f,json:void 0,text:void 0};if(ha(g.formMethod))return{path:t,submission:g};let _=Qh(t);return e&&_.search&&R3(_.search)&&s.append("index",""),_.search=`?${s}`,{path:Oh(_),submission:g}}function i5(e,t,n,r,i,a,c,s,f,g,_,x,C,E,A,L,I,T,O,D){var ge;let U=D?ua(D[1])?D[1].error:D[1].data:void 0,H=i.createURL(a.location),V=i.createURL(f),q;if(_&&a.errors){let Ve=Object.keys(a.errors)[0];q=c.findIndex(Ie=>Ie.route.id===Ve)}else if(D&&ua(D[1])){let Ve=D[0];q=c.findIndex(Ie=>Ie.route.id===Ve)-1}let Q=D?D[1].statusCode:void 0,K=Q&&Q>=400,N={currentUrl:H,currentParams:((ge=a.matches[0])==null?void 0:ge.params)||{},nextUrl:V,nextParams:c[0].params,...s,actionResult:U,actionStatus:Q},re=c.map((Ve,Ie)=>{let{route:ve}=Ve,Se=null;if(q!=null&&Ie>q?Se=!1:ve.lazy?Se=!0:ve.loader==null?Se=!1:_?Se=pA(ve,a.loaderData,a.errors):Vae(a.loaderData,a.matches[Ie],Ve)&&(Se=!0),Se!==null)return mA(n,r,e,Ve,g,t,Se);let Me=K?!1:x||H.pathname+H.search===V.pathname+V.search||H.search!==V.search||jae(a.matches[Ie],Ve),Be={...N,defaultShouldRevalidate:Me},Qe=eS(Ve,Be);return mA(n,r,e,Ve,g,t,Qe,Be)}),ye=[];return A.forEach((Ve,Ie)=>{if(_||!c.some(Xt=>Xt.route.id===Ve.routeId)||E.has(Ie))return;let ve=a.fetchers.get(Ie),Se=ve&&ve.state!=="idle"&&ve.data===void 0,Me=dh(I,Ve.path,T);if(!Me){if(O&&Se)return;ye.push({key:Ie,routeId:Ve.routeId,path:Ve.path,matches:null,match:null,request:null,controller:null});return}if(L.has(Ie))return;let Be=F0(Me,Ve.path),Qe=new AbortController,st=hm(i,Ve.path,Qe.signal),ct=null;if(C.has(Ie))C.delete(Ie),ct=Ym(n,r,st,Me,Be,g,t);else if(Se)x&&(ct=Ym(n,r,st,Me,Be,g,t));else{let Xt={...N,defaultShouldRevalidate:K?!1:x};eS(Be,Xt)&&(ct=Ym(n,r,st,Me,Be,g,t,Xt))}ct&&ye.push({key:Ie,routeId:Ve.routeId,path:Ve.path,matches:ct,match:Be,request:st,controller:Qe})}),{dsMatches:re,revalidatingFetchers:ye}}function pA(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&e.id in t,i=n!=null&&n[e.id]!==void 0;return!r&&i?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!i}function Vae(e,t,n){let r=!t||n.route.id!==t.route.id,i=!e.hasOwnProperty(n.route.id);return r||i}function jae(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function eS(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function o5(e,t,n,r,i){let a;if(e){let f=r[e];lr(f,`No route found to patch children into: routeId = ${e}`),f.children||(f.children=[]),a=f.children}else a=n;let c=t.filter(f=>!a.some(g=>q8(f,g))),s=Kw(c,i,[e||"_","patch",String((a==null?void 0:a.length)||"0")],r);a.push(...s)}function q8(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var i;return(i=t.children)==null?void 0:i.some(a=>q8(n,a))}):!1}var s5=new WeakMap,X8=({key:e,route:t,manifest:n,mapRouteProperties:r})=>{let i=n[t.id];if(lr(i,"No route found in manifest"),!i.lazy||typeof i.lazy!="object")return;let a=i.lazy[e];if(!a)return;let c=s5.get(i);c||(c={},s5.set(i,c));let s=c[e];if(s)return s;let f=(async()=>{let g=hae(e),x=i[e]!==void 0&&e!=="hasErrorBoundary";if(g)Fi(!g,"Route property "+e+" is not a supported lazy route property. This property will be ignored."),c[e]=Promise.resolve();else if(x)Fi(!1,`Route "${i.id}" has a static property "${e}" defined. The lazy property will be ignored.`);else{let C=await a();C!=null&&(Object.assign(i,{[e]:C}),Object.assign(i,r(i)))}typeof i.lazy=="object"&&(i.lazy[e]=void 0,Object.values(i.lazy).every(C=>C===void 0)&&(i.lazy=void 0))})();return c[e]=f,f},a5=new WeakMap;function Hae(e,t,n,r,i){let a=n[e.id];if(lr(a,"No route found in manifest"),!e.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof e.lazy=="function"){let _=a5.get(a);if(_)return{lazyRoutePromise:_,lazyHandlerPromise:_};let x=(async()=>{lr(typeof e.lazy=="function","No lazy route function found");let C=await e.lazy(),E={};for(let A in C){let L=C[A];if(L===void 0)continue;let I=fae(A),O=a[A]!==void 0&&A!=="hasErrorBoundary";I?Fi(!I,"Route property "+A+" is not a supported property to be returned from a lazy route function. This property will be ignored."):O?Fi(!O,`Route "${a.id}" has a static property "${A}" defined but its lazy function is also returning a value for this property. The lazy route property "${A}" will be ignored.`):E[A]=L}Object.assign(a,E),Object.assign(a,{...r(a),lazy:void 0})})();return a5.set(a,x),x.catch(()=>{}),{lazyRoutePromise:x,lazyHandlerPromise:x}}let c=Object.keys(e.lazy),s=[],f;for(let _ of c){if(i&&i.includes(_))continue;let x=X8({key:_,route:e,manifest:n,mapRouteProperties:r});x&&(s.push(x),_===t&&(f=x))}let g=s.length>0?Promise.all(s).then(()=>{}):void 0;return g==null||g.catch(()=>{}),f==null||f.catch(()=>{}),{lazyRoutePromise:g,lazyHandlerPromise:f}}async function l5(e){let t=e.matches.filter(i=>i.shouldLoad),n={};return(await Promise.all(t.map(i=>i.resolve()))).forEach((i,a)=>{n[t[a].route.id]=i}),n}async function Gae(e){return e.matches.some(t=>t.route.unstable_middleware)?Z8(e,!1,()=>l5(e),(t,n)=>({[n]:{type:"error",result:t}})):l5(e)}async function Z8(e,t,n,r){let{matches:i,request:a,params:c,context:s}=e,f={handlerResult:void 0};try{let g=i.flatMap(x=>x.route.unstable_middleware?x.route.unstable_middleware.map(C=>[x.route.id,C]):[]),_=await Y8({request:a,params:c,context:s},g,t,f,n);return t?_:f.handlerResult}catch(g){if(!f.middlewareError)throw g;let _=await r(f.middlewareError.error,f.middlewareError.routeId);return f.handlerResult?Object.assign(f.handlerResult,_):_}}async function Y8(e,t,n,r,i,a=0){let{request:c}=e;if(c.signal.aborted)throw c.signal.reason?c.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${c.method} ${c.url}`);let s=t[a];if(!s)return r.handlerResult=await i(),r.handlerResult;let[f,g]=s,_=!1,x,C=async()=>{if(_)throw new Error("You may only call `next()` once per middleware");_=!0,await Y8(e,t,n,r,i,a+1)};try{let E=await g({request:e.request,params:e.params,context:e.context},C);return _?E===void 0?x:E:C()}catch(E){throw r.middlewareError?r.middlewareError.error!==E&&(r.middlewareError={routeId:f,error:E}):r.middlewareError={routeId:f,error:E},E}}function K8(e,t,n,r,i){let a=X8({key:"unstable_middleware",route:r.route,manifest:t,mapRouteProperties:e}),c=Hae(r.route,ha(n.method)?"action":"loader",t,e,i);return{middleware:a,route:c.lazyRoutePromise,handler:c.lazyHandlerPromise}}function mA(e,t,n,r,i,a,c,s=null){let f=!1,g=K8(e,t,n,r,i);return{...r,_lazyPromises:g,shouldLoad:c,unstable_shouldRevalidateArgs:s,unstable_shouldCallHandler(_){return f=!0,s?typeof _=="boolean"?eS(r,{...s,defaultShouldRevalidate:_}):eS(r,s):c},resolve(_){return f||c||_&&n.method==="GET"&&(r.route.lazy||r.route.loader)?qae({request:n,match:r,lazyHandlerPromise:g==null?void 0:g.handler,lazyRoutePromise:g==null?void 0:g.route,handlerOverride:_,scopedContext:a}):Promise.resolve({type:"data",result:void 0})}}}function Ym(e,t,n,r,i,a,c,s=null){return r.map(f=>f.route.id!==i.route.id?{...f,shouldLoad:!1,unstable_shouldRevalidateArgs:s,unstable_shouldCallHandler:()=>!1,_lazyPromises:K8(e,t,n,f,a),resolve:()=>Promise.resolve({type:"data",result:void 0})}:mA(e,t,n,f,a,c,!0,s))}async function Wae(e,t,n,r,i,a){n.some(g=>{var _;return(_=g._lazyPromises)==null?void 0:_.middleware})&&await Promise.all(n.map(g=>{var _;return(_=g._lazyPromises)==null?void 0:_.middleware}));let c={request:t,params:n[0].params,context:i,matches:n},f=await e({...c,fetcherKey:r,unstable_runClientMiddleware:g=>{let _=c;return Z8(_,!1,()=>g({..._,fetcherKey:r,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}}),(x,C)=>({[C]:{type:"error",result:x}}))}});try{await Promise.all(n.flatMap(g=>{var _,x;return[(_=g._lazyPromises)==null?void 0:_.handler,(x=g._lazyPromises)==null?void 0:x.route]}))}catch{}return f}async function qae({request:e,match:t,lazyHandlerPromise:n,lazyRoutePromise:r,handlerOverride:i,scopedContext:a}){let c,s,f=ha(e.method),g=f?"action":"loader",_=x=>{let C,E=new Promise((I,T)=>C=T);s=()=>C(),e.signal.addEventListener("abort",s);let A=I=>typeof x!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${g}" [routeId: ${t.route.id}]`)):x({request:e,params:t.params,context:a},...I!==void 0?[I]:[]),L=(async()=>{try{return{type:"data",result:await(i?i(T=>A(T)):A())}}catch(I){return{type:"error",result:I}}})();return Promise.race([L,E])};try{let x=f?t.route.action:t.route.loader;if(n||r)if(x){let C,[E]=await Promise.all([_(x).catch(A=>{C=A}),n,r]);if(C!==void 0)throw C;c=E}else{await n;let C=f?t.route.action:t.route.loader;if(C)[c]=await Promise.all([_(C),r]);else if(g==="action"){let E=new URL(e.url),A=E.pathname+E.search;throw Fa(405,{method:e.method,pathname:A,routeId:t.route.id})}else return{type:"data",result:void 0}}else if(x)c=await _(x);else{let C=new URL(e.url),E=C.pathname+C.search;throw Fa(404,{pathname:E})}}catch(x){return{type:"error",result:x}}finally{s&&e.signal.removeEventListener("abort",s)}return c}async function Xae(e){var r,i,a,c,s,f;let{result:t,type:n}=e;if(Q8(t)){let g;try{let _=t.headers.get("Content-Type");_&&/\bapplication\/json\b/.test(_)?t.body==null?g=null:g=await t.json():g=await t.text()}catch(_){return{type:"error",error:_}}return n==="error"?{type:"error",error:new Qw(t.status,t.statusText,g),statusCode:t.status,headers:t.headers}:{type:"data",data:g,statusCode:t.status,headers:t.headers}}return n==="error"?m5(t)?t.data instanceof Error?{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"error",error:new Qw(((a=t.init)==null?void 0:a.status)||500,void 0,t.data),statusCode:n_(t)?t.status:void 0,headers:(c=t.init)!=null&&c.headers?new Headers(t.init.headers):void 0}:{type:"error",error:t,statusCode:n_(t)?t.status:void 0}:m5(t)?{type:"data",data:t.data,statusCode:(s=t.init)==null?void 0:s.status,headers:(f=t.init)!=null&&f.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function Zae(e,t,n,r,i){let a=e.headers.get("Location");if(lr(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!I3.test(a)){let c=r.slice(0,r.findIndex(s=>s.route.id===n)+1);a=fA(new URL(t.url),c,i,a),e.headers.set("Location",a)}return e}function c5(e,t,n){if(I3.test(e)){let r=e,i=r.startsWith("//")?new URL(t.protocol+r):new URL(r),a=Ka(i.pathname,n)!=null;if(i.origin===t.origin&&a)return i.pathname+i.search+i.hash}return e}function hm(e,t,n,r){let i=e.createURL(J8(t)).toString(),a={signal:n};if(r&&ha(r.formMethod)){let{formMethod:c,formEncType:s}=r;a.method=c.toUpperCase(),s==="application/json"?(a.headers=new Headers({"Content-Type":s}),a.body=JSON.stringify(r.json)):s==="text/plain"?a.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?a.body=gA(r.formData):a.body=r.formData}return new Request(i,a)}function gA(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function u5(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function Yae(e,t,n,r=!1,i=!1){let a={},c=null,s,f=!1,g={},_=n&&ua(n[1])?n[1].error:void 0;return e.forEach(x=>{if(!(x.route.id in t))return;let C=x.route.id,E=t[C];if(lr(!ff(E),"Cannot handle redirect results in processLoaderData"),ua(E)){let A=E.error;if(_!==void 0&&(A=_,_=void 0),c=c||{},i)c[C]=A;else{let L=sf(e,C);c[L.route.id]==null&&(c[L.route.id]=A)}r||(a[C]=W8),f||(f=!0,s=n_(E.error)?E.error.status:500),E.headers&&(g[C]=E.headers)}else a[C]=E.data,E.statusCode&&E.statusCode!==200&&!f&&(s=E.statusCode),E.headers&&(g[C]=E.headers)}),_!==void 0&&n&&(c={[n[0]]:_},n[2]&&(a[n[2]]=void 0)),{loaderData:a,errors:c,statusCode:s||200,loaderHeaders:g}}function h5(e,t,n,r,i,a){let{loaderData:c,errors:s}=Yae(t,n,r);return i.filter(f=>!f.matches||f.matches.some(g=>g.shouldLoad)).forEach(f=>{let{key:g,match:_,controller:x}=f,C=a[g];if(lr(C,"Did not find corresponding fetcher result"),!(x&&x.signal.aborted))if(ua(C)){let E=sf(e.matches,_==null?void 0:_.route.id);s&&s[E.route.id]||(s={...s,[E.route.id]:C.error}),e.fetchers.delete(g)}else if(ff(C))lr(!1,"Unhandled fetcher revalidation redirect");else{let E=ih(C.data);e.fetchers.set(g,E)}}),{loaderData:c,errors:s}}function d5(e,t,n,r){let i=Object.entries(t).filter(([,a])=>a!==W8).reduce((a,[c,s])=>(a[c]=s,a),{});for(let a of n){let c=a.route.id;if(!t.hasOwnProperty(c)&&e.hasOwnProperty(c)&&a.route.loader&&(i[c]=e[c]),r&&r.hasOwnProperty(c))break}return i}function f5(e){return e?ua(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function sf(e,t){return(t?e.slice(0,e.findIndex(r=>r.route.id===t)+1):[...e]).reverse().find(r=>r.route.hasErrorBoundary===!0)||e[0]}function p5(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function Fa(e,{pathname:t,routeId:n,method:r,type:i,message:a}={}){let c="Unknown Server Error",s="Unknown @remix-run/router error";return e===400?(c="Bad Request",r&&t&&n?s=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:i==="invalid-body"&&(s="Unable to encode submission body")):e===403?(c="Forbidden",s=`Route "${n}" does not match URL "${t}"`):e===404?(c="Not Found",s=`No route matches URL "${t}"`):e===405&&(c="Method Not Allowed",r&&t&&n?s=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new Qw(e||500,c,new Error(s),!0)}function U1(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,i]=t[n];if(ff(i))return{key:r,result:i}}}function J8(e){let t=typeof e=="string"?Qh(e):e;return Oh({...t,hash:""})}function Kae(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function Jae(e){return Q8(e.result)&&Oae.has(e.result.status)}function ua(e){return e.type==="error"}function ff(e){return(e&&e.type)==="redirect"}function m5(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function Q8(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function Qae(e){return zae.has(e.toUpperCase())}function ha(e){return kae.has(e.toUpperCase())}function R3(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function F0(e,t){let n=typeof t=="string"?Qh(t).search:t.search;if(e[e.length-1].route.index&&R3(n||""))return e[e.length-1];let r=j8(e);return r[r.length-1]}function g5(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:a,json:c}=e;if(!(!t||!n||!r)){if(i!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(a!=null)return{formMethod:t,formAction:n,formEncType:r,formData:a,json:void 0,text:void 0};if(c!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:c,text:void 0}}}function yE(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function ele(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function f0(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function tle(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ih(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function nle(e,t){try{let n=e.sessionStorage.getItem(G8);if(n){let r=JSON.parse(n);for(let[i,a]of Object.entries(r||{}))a&&Array.isArray(a)&&t.set(i,new Set(a||[]))}}catch{}}function rle(e,t){if(t.size>0){let n={};for(let[r,i]of t)n[r]=[...i];try{e.sessionStorage.setItem(G8,JSON.stringify(n))}catch(r){Fi(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function ile(){let e,t,n=new Promise((r,i)=>{e=async a=>{r(a);try{await n}catch{}},t=async a=>{i(a);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var $f=$.createContext(null);$f.displayName="DataRouter";var B_=$.createContext(null);B_.displayName="DataRouterState";var L3=$.createContext({isTransitioning:!1});L3.displayName="ViewTransition";var eV=$.createContext(new Map);eV.displayName="Fetchers";var ole=$.createContext(null);ole.displayName="Await";var xc=$.createContext(null);xc.displayName="Navigation";var PM=$.createContext(null);PM.displayName="Location";var pu=$.createContext({outlet:null,matches:[],isDataRoute:!1});pu.displayName="Route";var k3=$.createContext(null);k3.displayName="RouteError";function sle(e,{relative:t}={}){lr(U_(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=$.useContext(xc),{hash:i,pathname:a,search:c}=$_(e,{relative:t}),s=a;return n!=="/"&&(s=a==="/"?n:fc([n,a])),r.createHref({pathname:s,search:c,hash:i})}function U_(){return $.useContext(PM)!=null}function ed(){return lr(U_(),"useLocation() may be used only in the context of a <Router> component."),$.useContext(PM).location}var tV="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function nV(e){$.useContext(xc).static||$.useLayoutEffect(e)}function rV(){let{isDataRoute:e}=$.useContext(pu);return e?_le():ale()}function ale(){lr(U_(),"useNavigate() may be used only in the context of a <Router> component.");let e=$.useContext($f),{basename:t,navigator:n}=$.useContext(xc),{matches:r}=$.useContext(pu),{pathname:i}=ed(),a=JSON.stringify(P3(r)),c=$.useRef(!1);return nV(()=>{c.current=!0}),$.useCallback((f,g={})=>{if(Fi(c.current,tV),!c.current)return;if(typeof f=="number"){n.go(f);return}let _=A3(f,JSON.parse(a),i,g.relative==="path");e==null&&t!=="/"&&(_.pathname=_.pathname==="/"?t:fc([t,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[t,n,a,i,e])}$.createContext(null);function $_(e,{relative:t}={}){let{matches:n}=$.useContext(pu),{pathname:r}=ed(),i=JSON.stringify(P3(n));return $.useMemo(()=>A3(e,JSON.parse(i),r,t==="path"),[e,i,r,t])}function lle(e,t,n,r){lr(U_(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=$.useContext(xc),{matches:a}=$.useContext(pu),c=a[a.length-1],s=c?c.params:{},f=c?c.pathname:"/",g=c?c.pathnameBase:"/",_=c&&c.route;{let T=_&&_.path||"";iV(f,!_||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let x=ed(),C;C=x;let E=C.pathname||"/",A=E;if(g!=="/"){let T=g.replace(/^\//,"").split("/");A="/"+E.replace(/^\//,"").split("/").slice(T.length).join("/")}let L=dh(e,{pathname:A});return Fi(_||L!=null,`No routes matched location "${C.pathname}${C.search}${C.hash}" `),Fi(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${C.pathname}${C.search}${C.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),fle(L&&L.map(T=>Object.assign({},T,{params:Object.assign({},s,T.params),pathname:fc([g,i.encodeLocation?i.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?g:fc([g,i.encodeLocation?i.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),a,n,r)}function cle(){let e=yle(),t=n_(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",e),c=$.createElement($.Fragment,null,$.createElement("p",null,"💿 Hey developer 👋"),$.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",$.createElement("code",{style:a},"ErrorBoundary")," or"," ",$.createElement("code",{style:a},"errorElement")," prop on your route.")),$.createElement($.Fragment,null,$.createElement("h2",null,"Unexpected Application Error!"),$.createElement("h3",{style:{fontStyle:"italic"}},t),n?$.createElement("pre",{style:i},n):null,c)}var ule=$.createElement(cle,null),hle=class extends $.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?$.createElement(pu.Provider,{value:this.props.routeContext},$.createElement(k3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function dle({routeContext:e,match:t,children:n}){let r=$.useContext($f);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),$.createElement(pu.Provider,{value:e},n)}function fle(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,a=n==null?void 0:n.errors;if(a!=null){let f=i.findIndex(g=>g.route.id&&(a==null?void 0:a[g.route.id])!==void 0);lr(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),i=i.slice(0,Math.min(i.length,f+1))}let c=!1,s=-1;if(n)for(let f=0;f<i.length;f++){let g=i[f];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(s=f),g.route.id){let{loaderData:_,errors:x}=n,C=g.route.loader&&!_.hasOwnProperty(g.route.id)&&(!x||x[g.route.id]===void 0);if(g.route.lazy||C){c=!0,s>=0?i=i.slice(0,s+1):i=[i[0]];break}}}return i.reduceRight((f,g,_)=>{let x,C=!1,E=null,A=null;n&&(x=a&&g.route.id?a[g.route.id]:void 0,E=g.route.errorElement||ule,c&&(s<0&&_===0?(iV("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,A=null):s===_&&(C=!0,A=g.route.hydrateFallbackElement||null)));let L=t.concat(i.slice(0,_+1)),I=()=>{let T;return x?T=E:C?T=A:g.route.Component?T=$.createElement(g.route.Component,null):g.route.element?T=g.route.element:T=f,$.createElement(dle,{match:g,routeContext:{outlet:f,matches:L,isDataRoute:n!=null},children:T})};return n&&(g.route.ErrorBoundary||g.route.errorElement||_===0)?$.createElement(hle,{location:n.location,revalidation:n.revalidation,component:E,error:x,children:I(),routeContext:{outlet:null,matches:L,isDataRoute:!0}}):I()},null)}function D3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ple(e){let t=$.useContext($f);return lr(t,D3(e)),t}function mle(e){let t=$.useContext(B_);return lr(t,D3(e)),t}function gle(e){let t=$.useContext(pu);return lr(t,D3(e)),t}function z3(e){let t=gle(e),n=t.matches[t.matches.length-1];return lr(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function vle(){return z3("useRouteId")}function yle(){var r;let e=$.useContext(k3),t=mle("useRouteError"),n=z3("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function _le(){let{router:e}=ple("useNavigate"),t=z3("useNavigate"),n=$.useRef(!1);return nV(()=>{n.current=!0}),$.useCallback(async(i,a={})=>{Fi(n.current,tV),n.current&&(typeof i=="number"?e.navigate(i):await e.navigate(i,{fromRouteId:t,...a}))},[e,t])}var v5={};function iV(e,t,n){!t&&!v5[e]&&(v5[e]=!0,Fi(!1,n))}var y5={};function _5(e,t){!e&&!y5[t]&&(y5[t]=!0,console.warn(t))}function xle(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&Fi(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:$.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&Fi(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:$.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&Fi(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:$.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var ble=["HydrateFallback","hydrateFallbackElement"],wle=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function Sle({router:e,flushSync:t}){let[n,r]=$.useState(e.state),[i,a]=$.useState(),[c,s]=$.useState({isTransitioning:!1}),[f,g]=$.useState(),[_,x]=$.useState(),[C,E]=$.useState(),A=$.useRef(new Map),L=$.useCallback((D,{deletedFetchers:U,flushSync:H,viewTransitionOpts:V})=>{D.fetchers.forEach((Q,K)=>{Q.data!==void 0&&A.current.set(K,Q.data)}),U.forEach(Q=>A.current.delete(Q)),_5(H===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let q=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(_5(V==null||q,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!V||!q){t&&H?t(()=>r(D)):$.startTransition(()=>r(D));return}if(t&&H){t(()=>{_&&(f&&f.resolve(),_.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:V.currentLocation,nextLocation:V.nextLocation})});let Q=e.window.document.startViewTransition(()=>{t(()=>r(D))});Q.finished.finally(()=>{t(()=>{g(void 0),x(void 0),a(void 0),s({isTransitioning:!1})})}),t(()=>x(Q));return}_?(f&&f.resolve(),_.skipTransition(),E({state:D,currentLocation:V.currentLocation,nextLocation:V.nextLocation})):(a(D),s({isTransitioning:!0,flushSync:!1,currentLocation:V.currentLocation,nextLocation:V.nextLocation}))},[e.window,t,_,f]);$.useLayoutEffect(()=>e.subscribe(L),[e,L]),$.useEffect(()=>{c.isTransitioning&&!c.flushSync&&g(new wle)},[c]),$.useEffect(()=>{if(f&&i&&e.window){let D=i,U=f.promise,H=e.window.document.startViewTransition(async()=>{$.startTransition(()=>r(D)),await U});H.finished.finally(()=>{g(void 0),x(void 0),a(void 0),s({isTransitioning:!1})}),x(H)}},[i,f,e.window]),$.useEffect(()=>{f&&i&&n.location.key===i.location.key&&f.resolve()},[f,_,n.location,i]),$.useEffect(()=>{!c.isTransitioning&&C&&(a(C.state),s({isTransitioning:!0,flushSync:!1,currentLocation:C.currentLocation,nextLocation:C.nextLocation}),E(void 0))},[c.isTransitioning,C]);let I=$.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:D=>e.navigate(D),push:(D,U,H)=>e.navigate(D,{state:U,preventScrollReset:H==null?void 0:H.preventScrollReset}),replace:(D,U,H)=>e.navigate(D,{replace:!0,state:U,preventScrollReset:H==null?void 0:H.preventScrollReset})}),[e]),T=e.basename||"/",O=$.useMemo(()=>({router:e,navigator:I,static:!1,basename:T}),[e,I,T]);return $.createElement($.Fragment,null,$.createElement($f.Provider,{value:O},$.createElement(B_.Provider,{value:n},$.createElement(eV.Provider,{value:A.current},$.createElement(L3.Provider,{value:c},$.createElement(Ele,{basename:T,location:n.location,navigationType:n.historyAction,navigator:I},$.createElement(Mle,{routes:e.routes,future:e.future,state:n})))))),null)}var Mle=$.memo(Cle);function Cle({routes:e,future:t,state:n}){return lle(e,void 0,n,t)}function qb(e){lr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ele({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:i,static:a=!1}){lr(!U_(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),s=$.useMemo(()=>({basename:c,navigator:i,static:a,future:{}}),[c,i,a]);typeof n=="string"&&(n=Qh(n));let{pathname:f="/",search:g="",hash:_="",state:x=null,key:C="default"}=n,E=$.useMemo(()=>{let A=Ka(f,c);return A==null?null:{location:{pathname:A,search:g,hash:_,state:x,key:C},navigationType:r}},[c,f,g,_,x,C,r]);return Fi(E!=null,`<Router basename="${c}"> is not able to match the URL "${f}${g}${_}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:$.createElement(xc.Provider,{value:s},$.createElement(PM.Provider,{children:t,value:E}))}function vA(e,t=[]){let n=[];return $.Children.forEach(e,(r,i)=>{if(!$.isValidElement(r))return;let a=[...t,i];if(r.type===$.Fragment){n.push.apply(n,vA(r.props.children,a));return}lr(r.type===qb,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),lr(!r.props.index||!r.props.children,"An index route cannot have child routes.");let c={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=vA(r.props.children,a)),n.push(c)}),n}var Tle=vA,Xb="get",Zb="application/x-www-form-urlencoded";function AM(e){return e!=null&&typeof e.tagName=="string"}function Ple(e){return AM(e)&&e.tagName.toLowerCase()==="button"}function Ale(e){return AM(e)&&e.tagName.toLowerCase()==="form"}function Ile(e){return AM(e)&&e.tagName.toLowerCase()==="input"}function Rle(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Lle(e,t){return e.button===0&&(!t||t==="_self")&&!Rle(e)}function yA(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function kle(e,t){let n=yA(e);return t&&t.forEach((r,i)=>{n.has(i)||t.getAll(i).forEach(a=>{n.append(i,a)})}),n}var $1=null;function Dle(){if($1===null)try{new FormData(document.createElement("form"),0),$1=!1}catch{$1=!0}return $1}var zle=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function _E(e){return e!=null&&!zle.has(e)?(Fi(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Zb}"`),null):e}function Ole(e,t){let n,r,i,a,c;if(Ale(e)){let s=e.getAttribute("action");r=s?Ka(s,t):null,n=e.getAttribute("method")||Xb,i=_E(e.getAttribute("enctype"))||Zb,a=new FormData(e)}else if(Ple(e)||Ile(e)&&(e.type==="submit"||e.type==="image")){let s=e.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=e.getAttribute("formaction")||s.getAttribute("action");if(r=f?Ka(f,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||Xb,i=_E(e.getAttribute("formenctype"))||_E(s.getAttribute("enctype"))||Zb,a=new FormData(s,e),!Dle()){let{name:g,type:_,value:x}=e;if(_==="image"){let C=g?`${g}.`:"";a.append(`${C}x`,"0"),a.append(`${C}y`,"0")}else g&&a.append(g,x)}}else{if(AM(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Xb,r=null,i=Zb,c=e}return a&&i==="text/plain"&&(c=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:c}}function O3(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function Fle(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Nle(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Ble(e,t,n){let r=await Promise.all(e.map(async i=>{let a=t.routes[i.route.id];if(a){let c=await Fle(a,n);return c.links?c.links():[]}return[]}));return jle(r.flat(1).filter(Nle).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function x5(e,t,n,r,i,a){let c=(f,g)=>n[g]?f.route.id!==n[g].route.id:!0,s=(f,g)=>{var _;return n[g].pathname!==f.pathname||((_=n[g].route.path)==null?void 0:_.endsWith("*"))&&n[g].params["*"]!==f.params["*"]};return a==="assets"?t.filter((f,g)=>c(f,g)||s(f,g)):a==="data"?t.filter((f,g)=>{var x;let _=r.routes[f.route.id];if(!_||!_.hasLoader)return!1;if(c(f,g)||s(f,g))return!0;if(f.route.shouldRevalidate){let C=f.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((x=n[0])==null?void 0:x.params)||{},nextUrl:new URL(e,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof C=="boolean")return C}return!0}):[]}function Ule(e,t,{includeHydrateFallback:n}={}){return $le(e.map(r=>{let i=t.routes[r.route.id];if(!i)return[];let a=[i.module];return i.clientActionModule&&(a=a.concat(i.clientActionModule)),i.clientLoaderModule&&(a=a.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(a=a.concat(i.hydrateFallbackModule)),i.imports&&(a=a.concat(i.imports)),a}).flat(1))}function $le(e){return[...new Set(e)]}function Vle(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function jle(e,t){let n=new Set;return new Set(t),e.reduce((r,i)=>{let a=JSON.stringify(Vle(i));return n.has(a)||(n.add(a),r.push({key:a,link:i})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Hle=new Set([100,101,204,205]);function Gle(e,t){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname="_root.data":t&&Ka(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function oV(){let e=$.useContext($f);return O3(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Wle(){let e=$.useContext(B_);return O3(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var F3=$.createContext(void 0);F3.displayName="FrameworkContext";function sV(){let e=$.useContext(F3);return O3(e,"You must render this element inside a <HydratedRouter> element"),e}function qle(e,t){let n=$.useContext(F3),[r,i]=$.useState(!1),[a,c]=$.useState(!1),{onFocus:s,onBlur:f,onMouseEnter:g,onMouseLeave:_,onTouchStart:x}=t,C=$.useRef(null);$.useEffect(()=>{if(e==="render"&&c(!0),e==="viewport"){let L=T=>{T.forEach(O=>{c(O.isIntersecting)})},I=new IntersectionObserver(L,{threshold:.5});return C.current&&I.observe(C.current),()=>{I.disconnect()}}},[e]),$.useEffect(()=>{if(r){let L=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(L)}}},[r]);let E=()=>{i(!0)},A=()=>{i(!1),c(!1)};return n?e!=="intent"?[a,C,{}]:[a,C,{onFocus:p0(s,E),onBlur:p0(f,A),onMouseEnter:p0(g,E),onMouseLeave:p0(_,A),onTouchStart:p0(x,E)}]:[!1,C,{}]}function p0(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Xle({page:e,...t}){let{router:n}=oV(),r=$.useMemo(()=>dh(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?$.createElement(Yle,{page:e,matches:r,...t}):null}function Zle(e){let{manifest:t,routeModules:n}=sV(),[r,i]=$.useState([]);return $.useEffect(()=>{let a=!1;return Ble(e,t,n).then(c=>{a||i(c)}),()=>{a=!0}},[e,t,n]),r}function Yle({page:e,matches:t,...n}){let r=ed(),{manifest:i,routeModules:a}=sV(),{basename:c}=oV(),{loaderData:s,matches:f}=Wle(),g=$.useMemo(()=>x5(e,t,f,i,r,"data"),[e,t,f,i,r]),_=$.useMemo(()=>x5(e,t,f,i,r,"assets"),[e,t,f,i,r]),x=$.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let A=new Set,L=!1;if(t.forEach(T=>{var D;let O=i.routes[T.route.id];!O||!O.hasLoader||(!g.some(U=>U.route.id===T.route.id)&&T.route.id in s&&((D=a[T.route.id])!=null&&D.shouldRevalidate)||O.hasClientLoader?L=!0:A.add(T.route.id))}),A.size===0)return[];let I=Gle(e,c);return L&&A.size>0&&I.searchParams.set("_routes",t.filter(T=>A.has(T.route.id)).map(T=>T.route.id).join(",")),[I.pathname+I.search]},[c,s,r,i,g,t,e,a]),C=$.useMemo(()=>Ule(_,i),[_,i]),E=Zle(_);return $.createElement($.Fragment,null,x.map(A=>$.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...n})),C.map(A=>$.createElement("link",{key:A,rel:"modulepreload",href:A,...n})),E.map(({key:A,link:L})=>$.createElement("link",{key:A,...L})))}function Kle(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var aV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{aV&&(window.__reactRouterVersion="7.6.3")}catch{}function Jle(e,t){return Uae({basename:t==null?void 0:t.basename,unstable_getContext:t==null?void 0:t.unstable_getContext,future:t==null?void 0:t.future,history:aae({window:t==null?void 0:t.window}),hydrationData:Qle(),routes:e,mapRouteProperties:xle,hydrationRouteProperties:ble,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function Qle(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:ece(e.errors)}),e}function ece(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,i]of t)if(i&&i.__type==="RouteErrorResponse")n[r]=new Qw(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let a=window[i.__subType];if(typeof a=="function")try{let c=new a(i.message);c.stack="",n[r]=c}catch{}}if(n[r]==null){let a=new Error(i.message);a.stack="",n[r]=a}}else n[r]=i;return n}var lV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cV=$.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:i,reloadDocument:a,replace:c,state:s,target:f,to:g,preventScrollReset:_,viewTransition:x,...C},E){let{basename:A}=$.useContext(xc),L=typeof g=="string"&&lV.test(g),I,T=!1;if(typeof g=="string"&&L&&(I=g,aV))try{let K=new URL(window.location.href),N=g.startsWith("//")?new URL(K.protocol+g):new URL(g),re=Ka(N.pathname,A);N.origin===K.origin&&re!=null?g=re+N.search+N.hash:T=!0}catch{Fi(!1,`<Link to="${g}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let O=sle(g,{relative:i}),[D,U,H]=qle(r,C),V=ice(g,{replace:c,state:s,target:f,preventScrollReset:_,relative:i,viewTransition:x});function q(K){t&&t(K),K.defaultPrevented||V(K)}let Q=$.createElement("a",{...C,...H,href:I||O,onClick:T||a?t:q,ref:Kle(E,U),target:f,"data-discover":!L&&n==="render"?"true":void 0});return D&&!L?$.createElement($.Fragment,null,Q,$.createElement(Xle,{page:O})):Q});cV.displayName="Link";var tce=$.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:i=!1,style:a,to:c,viewTransition:s,children:f,...g},_){let x=$_(c,{relative:g.relative}),C=ed(),E=$.useContext(B_),{navigator:A,basename:L}=$.useContext(xc),I=E!=null&&uce(x)&&s===!0,T=A.encodeLocation?A.encodeLocation(x).pathname:x.pathname,O=C.pathname,D=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;n||(O=O.toLowerCase(),D=D?D.toLowerCase():null,T=T.toLowerCase()),D&&L&&(D=Ka(D,L)||D);const U=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let H=O===T||!i&&O.startsWith(T)&&O.charAt(U)==="/",V=D!=null&&(D===T||!i&&D.startsWith(T)&&D.charAt(T.length)==="/"),q={isActive:H,isPending:V,isTransitioning:I},Q=H?t:void 0,K;typeof r=="function"?K=r(q):K=[r,H?"active":null,V?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let N=typeof a=="function"?a(q):a;return $.createElement(cV,{...g,"aria-current":Q,className:K,ref:_,style:N,to:c,viewTransition:s},typeof f=="function"?f(q):f)});tce.displayName="NavLink";var nce=$.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:i,state:a,method:c=Xb,action:s,onSubmit:f,relative:g,preventScrollReset:_,viewTransition:x,...C},E)=>{let A=lce(),L=cce(s,{relative:g}),I=c.toLowerCase()==="get"?"get":"post",T=typeof s=="string"&&lV.test(s),O=D=>{if(f&&f(D),D.defaultPrevented)return;D.preventDefault();let U=D.nativeEvent.submitter,H=(U==null?void 0:U.getAttribute("formmethod"))||c;A(U||D.currentTarget,{fetcherKey:t,method:H,navigate:n,replace:i,state:a,relative:g,preventScrollReset:_,viewTransition:x})};return $.createElement("form",{ref:E,method:I,action:L,onSubmit:r?f:O,...C,"data-discover":!T&&e==="render"?"true":void 0})});nce.displayName="Form";function rce(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uV(e){let t=$.useContext($f);return lr(t,rce(e)),t}function ice(e,{target:t,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:c}={}){let s=rV(),f=ed(),g=$_(e,{relative:a});return $.useCallback(_=>{if(Lle(_,t)){_.preventDefault();let x=n!==void 0?n:Oh(f)===Oh(g);s(e,{replace:x,state:r,preventScrollReset:i,relative:a,viewTransition:c})}},[f,s,g,n,r,t,e,i,a,c])}function oce(e){Fi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=$.useRef(yA(e)),n=$.useRef(!1),r=ed(),i=$.useMemo(()=>kle(r.search,n.current?null:t.current),[r.search]),a=rV(),c=$.useCallback((s,f)=>{const g=yA(typeof s=="function"?s(i):s);n.current=!0,a("?"+g,f)},[a,i]);return[i,c]}var sce=0,ace=()=>`__${String(++sce)}__`;function lce(){let{router:e}=uV("useSubmit"),{basename:t}=$.useContext(xc),n=vle();return $.useCallback(async(r,i={})=>{let{action:a,method:c,encType:s,formData:f,body:g}=Ole(r,t);if(i.navigate===!1){let _=i.fetcherKey||ace();await e.fetch(_,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:f,body:g,formMethod:i.method||c,formEncType:i.encType||s,flushSync:i.flushSync})}else await e.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:f,body:g,formMethod:i.method||c,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}function cce(e,{relative:t}={}){let{basename:n}=$.useContext(xc),r=$.useContext(pu);lr(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),a={...$_(e||".",{relative:t})},c=ed();if(e==null){a.search=c.search;let s=new URLSearchParams(a.search),f=s.getAll("index");if(f.some(_=>_==="")){s.delete("index"),f.filter(x=>x).forEach(x=>s.append("index",x));let _=s.toString();a.search=_?`?${_}`:""}}return(!e||e===".")&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:fc([n,a.pathname])),Oh(a)}function uce(e,t={}){let n=$.useContext(L3);lr(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=uV("useViewTransitionState"),i=$_(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=Ka(n.currentLocation.pathname,r)||n.currentLocation.pathname,c=Ka(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Jw(i.pathname,c)!=null||Jw(i.pathname,a)!=null}[...Hle];/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hce(e){return $.createElement(Sle,{flushSync:A_.flushSync,...e})}const b5=e=>e,dce=()=>{let e=b5;return{configure(t){e=t},generate(t){return e(t)},reset(){e=b5}}},fce=dce();function If(e,...t){const n=new URL(`https://mui.com/production-error/?code=${e}`);return t.forEach(r=>n.searchParams.append("args[]",r)),`Minified MUI error #${e}; visit ${n} for the full message.`}function yg(e){if(typeof e!="string")throw new Error(If(7));return e.charAt(0).toUpperCase()+e.slice(1)}function pce(e,t,n=void 0){const r={};for(const i in e){const a=e[i];let c="",s=!0;for(let f=0;f<a.length;f+=1){const g=a[f];g&&(c+=(s===!0?"":" ")+t(g),s=!1,n&&n[g]&&(c+=" "+n[g]))}r[i]=c}return r}var hV={exports:{}},Kr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N3=Symbol.for("react.transitional.element"),B3=Symbol.for("react.portal"),IM=Symbol.for("react.fragment"),RM=Symbol.for("react.strict_mode"),LM=Symbol.for("react.profiler"),kM=Symbol.for("react.consumer"),DM=Symbol.for("react.context"),zM=Symbol.for("react.forward_ref"),OM=Symbol.for("react.suspense"),FM=Symbol.for("react.suspense_list"),NM=Symbol.for("react.memo"),BM=Symbol.for("react.lazy"),mce=Symbol.for("react.view_transition"),gce=Symbol.for("react.client.reference");function Qa(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case N3:switch(e=e.type,e){case IM:case LM:case RM:case OM:case FM:case mce:return e;default:switch(e=e&&e.$$typeof,e){case DM:case zM:case BM:case NM:return e;case kM:return e;default:return t}}case B3:return t}}}Kr.ContextConsumer=kM;Kr.ContextProvider=DM;Kr.Element=N3;Kr.ForwardRef=zM;Kr.Fragment=IM;Kr.Lazy=BM;Kr.Memo=NM;Kr.Portal=B3;Kr.Profiler=LM;Kr.StrictMode=RM;Kr.Suspense=OM;Kr.SuspenseList=FM;Kr.isContextConsumer=function(e){return Qa(e)===kM};Kr.isContextProvider=function(e){return Qa(e)===DM};Kr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===N3};Kr.isForwardRef=function(e){return Qa(e)===zM};Kr.isFragment=function(e){return Qa(e)===IM};Kr.isLazy=function(e){return Qa(e)===BM};Kr.isMemo=function(e){return Qa(e)===NM};Kr.isPortal=function(e){return Qa(e)===B3};Kr.isProfiler=function(e){return Qa(e)===LM};Kr.isStrictMode=function(e){return Qa(e)===RM};Kr.isSuspense=function(e){return Qa(e)===OM};Kr.isSuspenseList=function(e){return Qa(e)===FM};Kr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===IM||e===LM||e===RM||e===OM||e===FM||typeof e=="object"&&e!==null&&(e.$$typeof===BM||e.$$typeof===NM||e.$$typeof===DM||e.$$typeof===kM||e.$$typeof===zM||e.$$typeof===gce||e.getModuleId!==void 0)};Kr.typeOf=Qa;hV.exports=Kr;var dV=hV.exports;function Wc(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function fV(e){if($.isValidElement(e)||dV.isValidElementType(e)||!Wc(e))return e;const t={};return Object.keys(e).forEach(n=>{t[n]=fV(e[n])}),t}function wa(e,t,n={clone:!0}){const r=n.clone?{...e}:e;return Wc(e)&&Wc(t)&&Object.keys(t).forEach(i=>{$.isValidElement(t[i])||dV.isValidElementType(t[i])?r[i]=t[i]:Wc(t[i])&&Object.prototype.hasOwnProperty.call(e,i)&&Wc(e[i])?r[i]=wa(e[i],t[i],n):n.clone?r[i]=Wc(t[i])?fV(t[i]):t[i]:r[i]=t[i]}),r}function ay(e,t){return t?wa(e,t,{clone:!1}):e}function w5(e,t){if(!e.containerQueries)return t;const n=Object.keys(t).filter(r=>r.startsWith("@container")).sort((r,i)=>{var c,s;const a=/min-width:\s*([0-9.]+)/;return+(((c=r.match(a))==null?void 0:c[1])||0)-+(((s=i.match(a))==null?void 0:s[1])||0)});return n.length?n.reduce((r,i)=>{const a=t[i];return delete r[i],r[i]=a,r},{...t}):t}function vce(e,t){return t==="@"||t.startsWith("@")&&(e.some(n=>t.startsWith(`@${n}`))||!!t.match(/^@\d/))}function yce(e,t){const n=t.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,i]=n,a=Number.isNaN(+r)?r||0:+r;return e.containerQueries(i).up(a)}function _ce(e){const t=(a,c)=>a.replace("@media",c?`@container ${c}`:"@container");function n(a,c){a.up=(...s)=>t(e.breakpoints.up(...s),c),a.down=(...s)=>t(e.breakpoints.down(...s),c),a.between=(...s)=>t(e.breakpoints.between(...s),c),a.only=(...s)=>t(e.breakpoints.only(...s),c),a.not=(...s)=>{const f=t(e.breakpoints.not(...s),c);return f.includes("not all and")?f.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):f}}const r={},i=a=>(n(r,a),r);return n(i),{...e,containerQueries:i}}const UM={xs:0,sm:600,md:900,lg:1200,xl:1536},S5={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${UM[e]}px)`},xce={containerQueries:e=>({up:t=>{let n=typeof t=="number"?t:UM[t]||t;return typeof n=="number"&&(n=`${n}px`),e?`@container ${e} (min-width:${n})`:`@container (min-width:${n})`}})};function cu(e,t,n){const r=e.theme||{};if(Array.isArray(t)){const a=r.breakpoints||S5;return t.reduce((c,s,f)=>(c[a.up(a.keys[f])]=n(t[f]),c),{})}if(typeof t=="object"){const a=r.breakpoints||S5;return Object.keys(t).reduce((c,s)=>{if(vce(a.keys,s)){const f=yce(r.containerQueries?r:xce,s);f&&(c[f]=n(t[s],s))}else if(Object.keys(a.values||UM).includes(s)){const f=a.up(s);c[f]=n(t[s],s)}else{const f=s;c[f]=t[f]}return c},{})}return n(t)}function bce(e={}){var n;return((n=e.keys)==null?void 0:n.reduce((r,i)=>{const a=e.up(i);return r[a]={},r},{}))||{}}function M5(e,t){return e.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},t)}function $M(e,t,n=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&n){const r=`vars.${t}`.split(".").reduce((i,a)=>i&&i[a]?i[a]:null,e);if(r!=null)return r}return t.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,e)}function tS(e,t,n,r=n){let i;return typeof e=="function"?i=e(n):Array.isArray(e)?i=e[n]||r:i=$M(e,n)||r,t&&(i=t(i,r,e)),i}function Bi(e){const{prop:t,cssProperty:n=e.prop,themeKey:r,transform:i}=e,a=c=>{if(c[t]==null)return null;const s=c[t],f=c.theme,g=$M(f,r)||{};return cu(c,s,x=>{let C=tS(g,i,x);return x===C&&typeof x=="string"&&(C=tS(g,i,`${t}${x==="default"?"":yg(x)}`,x)),n===!1?C:{[n]:C}})};return a.propTypes={},a.filterProps=[t],a}function wce(e){const t={};return n=>(t[n]===void 0&&(t[n]=e(n)),t[n])}const Sce={m:"margin",p:"padding"},Mce={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},C5={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Cce=wce(e=>{if(e.length>2)if(C5[e])e=C5[e];else return[e];const[t,n]=e.split(""),r=Sce[t],i=Mce[n]||"";return Array.isArray(i)?i.map(a=>r+a):[r+i]}),U3=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],$3=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...U3,...$3];function V_(e,t,n,r){const i=$M(e,t,!0)??n;return typeof i=="number"||typeof i=="string"?a=>typeof a=="string"?a:typeof i=="string"?i.startsWith("var(")&&a===0?0:i.startsWith("var(")&&a===1?i:`calc(${a} * ${i})`:i*a:Array.isArray(i)?a=>{if(typeof a=="string")return a;const c=Math.abs(a),s=i[c];return a>=0?s:typeof s=="number"?-s:typeof s=="string"&&s.startsWith("var(")?`calc(-1 * ${s})`:`-${s}`}:typeof i=="function"?i:()=>{}}function V3(e){return V_(e,"spacing",8)}function j_(e,t){return typeof t=="string"||t==null?t:e(t)}function Ece(e,t){return n=>e.reduce((r,i)=>(r[i]=j_(t,n),r),{})}function Tce(e,t,n,r){if(!t.includes(n))return null;const i=Cce(n),a=Ece(i,r),c=e[n];return cu(e,c,a)}function pV(e,t){const n=V3(e.theme);return Object.keys(e).map(r=>Tce(e,t,r,n)).reduce(ay,{})}function Ei(e){return pV(e,U3)}Ei.propTypes={};Ei.filterProps=U3;function Ti(e){return pV(e,$3)}Ti.propTypes={};Ti.filterProps=$3;function VM(...e){const t=e.reduce((r,i)=>(i.filterProps.forEach(a=>{r[a]=i}),r),{}),n=r=>Object.keys(r).reduce((i,a)=>t[a]?ay(i,t[a](r)):i,{});return n.propTypes={},n.filterProps=e.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Va(e){return typeof e!="number"?e:`${e}px solid`}function el(e,t){return Bi({prop:e,themeKey:"borders",transform:t})}const Pce=el("border",Va),Ace=el("borderTop",Va),Ice=el("borderRight",Va),Rce=el("borderBottom",Va),Lce=el("borderLeft",Va),kce=el("borderColor"),Dce=el("borderTopColor"),zce=el("borderRightColor"),Oce=el("borderBottomColor"),Fce=el("borderLeftColor"),Nce=el("outline",Va),Bce=el("outlineColor"),jM=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=V_(e.theme,"shape.borderRadius",4),n=r=>({borderRadius:j_(t,r)});return cu(e,e.borderRadius,n)}return null};jM.propTypes={};jM.filterProps=["borderRadius"];VM(Pce,Ace,Ice,Rce,Lce,kce,Dce,zce,Oce,Fce,jM,Nce,Bce);const HM=e=>{if(e.gap!==void 0&&e.gap!==null){const t=V_(e.theme,"spacing",8),n=r=>({gap:j_(t,r)});return cu(e,e.gap,n)}return null};HM.propTypes={};HM.filterProps=["gap"];const GM=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=V_(e.theme,"spacing",8),n=r=>({columnGap:j_(t,r)});return cu(e,e.columnGap,n)}return null};GM.propTypes={};GM.filterProps=["columnGap"];const WM=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=V_(e.theme,"spacing",8),n=r=>({rowGap:j_(t,r)});return cu(e,e.rowGap,n)}return null};WM.propTypes={};WM.filterProps=["rowGap"];const Uce=Bi({prop:"gridColumn"}),$ce=Bi({prop:"gridRow"}),Vce=Bi({prop:"gridAutoFlow"}),jce=Bi({prop:"gridAutoColumns"}),Hce=Bi({prop:"gridAutoRows"}),Gce=Bi({prop:"gridTemplateColumns"}),Wce=Bi({prop:"gridTemplateRows"}),qce=Bi({prop:"gridTemplateAreas"}),Xce=Bi({prop:"gridArea"});VM(HM,GM,WM,Uce,$ce,Vce,jce,Hce,Gce,Wce,qce,Xce);function Km(e,t){return t==="grey"?t:e}const Zce=Bi({prop:"color",themeKey:"palette",transform:Km}),Yce=Bi({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Km}),Kce=Bi({prop:"backgroundColor",themeKey:"palette",transform:Km});VM(Zce,Yce,Kce);function pa(e){return e<=1&&e!==0?`${e*100}%`:e}const Jce=Bi({prop:"width",transform:pa}),j3=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=n=>{var i,a,c,s,f;const r=((c=(a=(i=e.theme)==null?void 0:i.breakpoints)==null?void 0:a.values)==null?void 0:c[n])||UM[n];return r?((f=(s=e.theme)==null?void 0:s.breakpoints)==null?void 0:f.unit)!=="px"?{maxWidth:`${r}${e.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:pa(n)}};return cu(e,e.maxWidth,t)}return null};j3.filterProps=["maxWidth"];const Qce=Bi({prop:"minWidth",transform:pa}),eue=Bi({prop:"height",transform:pa}),tue=Bi({prop:"maxHeight",transform:pa}),nue=Bi({prop:"minHeight",transform:pa});Bi({prop:"size",cssProperty:"width",transform:pa});Bi({prop:"size",cssProperty:"height",transform:pa});const rue=Bi({prop:"boxSizing"});VM(Jce,j3,Qce,eue,tue,nue,rue);const qM={border:{themeKey:"borders",transform:Va},borderTop:{themeKey:"borders",transform:Va},borderRight:{themeKey:"borders",transform:Va},borderBottom:{themeKey:"borders",transform:Va},borderLeft:{themeKey:"borders",transform:Va},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Va},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:jM},color:{themeKey:"palette",transform:Km},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Km},backgroundColor:{themeKey:"palette",transform:Km},p:{style:Ti},pt:{style:Ti},pr:{style:Ti},pb:{style:Ti},pl:{style:Ti},px:{style:Ti},py:{style:Ti},padding:{style:Ti},paddingTop:{style:Ti},paddingRight:{style:Ti},paddingBottom:{style:Ti},paddingLeft:{style:Ti},paddingX:{style:Ti},paddingY:{style:Ti},paddingInline:{style:Ti},paddingInlineStart:{style:Ti},paddingInlineEnd:{style:Ti},paddingBlock:{style:Ti},paddingBlockStart:{style:Ti},paddingBlockEnd:{style:Ti},m:{style:Ei},mt:{style:Ei},mr:{style:Ei},mb:{style:Ei},ml:{style:Ei},mx:{style:Ei},my:{style:Ei},margin:{style:Ei},marginTop:{style:Ei},marginRight:{style:Ei},marginBottom:{style:Ei},marginLeft:{style:Ei},marginX:{style:Ei},marginY:{style:Ei},marginInline:{style:Ei},marginInlineStart:{style:Ei},marginInlineEnd:{style:Ei},marginBlock:{style:Ei},marginBlockStart:{style:Ei},marginBlockEnd:{style:Ei},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:HM},rowGap:{style:WM},columnGap:{style:GM},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:pa},maxWidth:{style:j3},minWidth:{transform:pa},height:{transform:pa},maxHeight:{transform:pa},minHeight:{transform:pa},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function iue(...e){const t=e.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(t);return e.every(r=>n.size===Object.keys(r).length)}function oue(e,t){return typeof e=="function"?e(t):e}function sue(){function e(n,r,i,a){const c={[n]:r,theme:i},s=a[n];if(!s)return{[n]:r};const{cssProperty:f=n,themeKey:g,transform:_,style:x}=s;if(r==null)return null;if(g==="typography"&&r==="inherit")return{[n]:r};const C=$M(i,g)||{};return x?x(c):cu(c,r,A=>{let L=tS(C,_,A);return A===L&&typeof A=="string"&&(L=tS(C,_,`${n}${A==="default"?"":yg(A)}`,A)),f===!1?L:{[f]:L}})}function t(n){const{sx:r,theme:i={},nested:a}=n||{};if(!r)return null;const c=i.unstable_sxConfig??qM;function s(f){let g=f;if(typeof f=="function")g=f(i);else if(typeof f!="object")return f;if(!g)return null;const _=bce(i.breakpoints),x=Object.keys(_);let C=_;return Object.keys(g).forEach(E=>{const A=oue(g[E],i);if(A!=null)if(typeof A=="object")if(c[E])C=ay(C,e(E,A,i,c));else{const L=cu({theme:i},A,I=>({[E]:I}));iue(L,A)?C[E]=t({sx:A,theme:i,nested:!0}):C=ay(C,L)}else C=ay(C,e(E,A,i,c))}),!a&&i.modularCssLayers?{"@layer sx":w5(i,M5(x,C))}:w5(i,M5(x,C))}return Array.isArray(r)?r.map(s):s(r)}return t}const _g=sue();_g.filterProps=["sx"];function aue(e,t){return yw(e,t)}function lue(e,t){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))}const E5=[];function xf(e){return E5[0]=e,__(E5)}const cue=e=>{const t=Object.keys(e).map(n=>({key:n,val:e[n]}))||[];return t.sort((n,r)=>n.val-r.val),t.reduce((n,r)=>({...n,[r.key]:r.val}),{})};function uue(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...i}=e,a=cue(t),c=Object.keys(a);function s(C){return`@media (min-width:${typeof t[C]=="number"?t[C]:C}${n})`}function f(C){return`@media (max-width:${(typeof t[C]=="number"?t[C]:C)-r/100}${n})`}function g(C,E){const A=c.indexOf(E);return`@media (min-width:${typeof t[C]=="number"?t[C]:C}${n}) and (max-width:${(A!==-1&&typeof t[c[A]]=="number"?t[c[A]]:E)-r/100}${n})`}function _(C){return c.indexOf(C)+1<c.length?g(C,c[c.indexOf(C)+1]):s(C)}function x(C){const E=c.indexOf(C);return E===0?s(c[1]):E===c.length-1?f(c[E]):g(C,c[c.indexOf(C)+1]).replace("@media","@media not all and")}return{keys:c,values:a,up:s,down:f,between:g,only:_,not:x,unit:n,...i}}const hue={borderRadius:4};function mV(e=8,t=V3({spacing:e})){if(e.mui)return e;const n=(...r)=>(r.length===0?[1]:r).map(a=>{const c=t(a);return typeof c=="number"?`${c}px`:c}).join(" ");return n.mui=!0,n}function due(e,t){var r;const n=this;if(n.vars){if(!((r=n.colorSchemes)!=null&&r[e])||typeof n.getColorSchemeSelector!="function")return{};let i=n.getColorSchemeSelector(e);return i==="&"?t:((i.includes("data-")||i.includes("."))&&(i=`*:where(${i.replace(/\s*&$/,"")}) &`),{[i]:t})}return n.palette.mode===e?t:{}}function gV(e={},...t){const{breakpoints:n={},palette:r={},spacing:i,shape:a={},...c}=e,s=uue(n),f=mV(i);let g=wa({breakpoints:s,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:f,shape:{...hue,...a}},c);return g=_ce(g),g.applyStyles=due,g=t.reduce((_,x)=>wa(_,x),g),g.unstable_sxConfig={...qM,...c==null?void 0:c.unstable_sxConfig},g.unstable_sx=function(x){return _g({sx:x,theme:this})},g}const fue={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function vV(e,t,n="Mui"){const r=fue[t];return r?`${n}-${r}`:`${fce.generate(e)}-${t}`}function pue(e,t,n="Mui"){const r={};return t.forEach(i=>{r[i]=vV(e,i,n)}),r}function yV(e){const{variants:t,...n}=e,r={variants:t,style:xf(n),isProcessed:!0};return r.style===n||t&&t.forEach(i=>{typeof i.style!="function"&&(i.style=xf(i.style))}),r}const mue=gV();function xE(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function pf(e,t){return t&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}function gue(e){return e?(t,n)=>n[e]:null}function vue(e,t,n){e.theme=xue(e.theme)?n:e.theme[t]||e.theme}function Yb(e,t,n){const r=typeof t=="function"?t(e):t;if(Array.isArray(r))return r.flatMap(i=>Yb(e,i,n));if(Array.isArray(r==null?void 0:r.variants)){let i;if(r.isProcessed)i=n?pf(r.style,n):r.style;else{const{variants:a,...c}=r;i=n?pf(xf(c),n):c}return _V(e,r.variants,[i],n)}return r!=null&&r.isProcessed?n?pf(xf(r.style),n):r.style:n?pf(xf(r),n):r}function _V(e,t,n=[],r=void 0){var a;let i;e:for(let c=0;c<t.length;c+=1){const s=t[c];if(typeof s.props=="function"){if(i??(i={...e,...e.ownerState,ownerState:e.ownerState}),!s.props(i))continue}else for(const f in s.props)if(e[f]!==s.props[f]&&((a=e.ownerState)==null?void 0:a[f])!==s.props[f])continue e;typeof s.style=="function"?(i??(i={...e,...e.ownerState,ownerState:e.ownerState}),n.push(r?pf(xf(s.style(i)),r):s.style(i))):n.push(r?pf(xf(s.style),r):s.style)}return n}function yue(e={}){const{themeId:t,defaultTheme:n=mue,rootShouldForwardProp:r=xE,slotShouldForwardProp:i=xE}=e;function a(s){vue(s,t,n)}return(s,f={})=>{lue(s,V=>V.filter(q=>q!==_g));const{name:g,slot:_,skipVariantsResolver:x,skipSx:C,overridesResolver:E=gue(wue(_)),...A}=f,L=g&&g.startsWith("Mui")||_?"components":"custom",I=x!==void 0?x:_&&_!=="Root"&&_!=="root"||!1,T=C||!1;let O=xE;_==="Root"||_==="root"?O=r:_?O=i:bue(s)&&(O=void 0);const D=aue(s,{shouldForwardProp:O,label:_ue(),...A}),U=V=>{if(V.__emotion_real===V)return V;if(typeof V=="function")return function(Q){return Yb(Q,V,Q.theme.modularCssLayers?L:void 0)};if(Wc(V)){const q=yV(V);return function(K){return q.variants?Yb(K,q,K.theme.modularCssLayers?L:void 0):K.theme.modularCssLayers?pf(q.style,L):q.style}}return V},H=(...V)=>{const q=[],Q=V.map(U),K=[];if(q.push(a),g&&E&&K.push(function(ge){var Se,Me;const Ie=(Me=(Se=ge.theme.components)==null?void 0:Se[g])==null?void 0:Me.styleOverrides;if(!Ie)return null;const ve={};for(const Be in Ie)ve[Be]=Yb(ge,Ie[Be],ge.theme.modularCssLayers?"theme":void 0);return E(ge,ve)}),g&&!I&&K.push(function(ge){var ve,Se;const Ve=ge.theme,Ie=(Se=(ve=Ve==null?void 0:Ve.components)==null?void 0:ve[g])==null?void 0:Se.variants;return Ie?_V(ge,Ie,[],ge.theme.modularCssLayers?"theme":void 0):null}),T||K.push(_g),Array.isArray(Q[0])){const ye=Q.shift(),ge=new Array(q.length).fill(""),Ve=new Array(K.length).fill("");let Ie;Ie=[...ge,...ye,...Ve],Ie.raw=[...ge,...ye.raw,...Ve],q.unshift(Ie)}const N=[...q,...Q,...K],re=D(...N);return s.muiName&&(re.muiName=s.muiName),re};return D.withConfig&&(H.withConfig=D.withConfig),H}}function _ue(e,t){return void 0}function xue(e){for(const t in e)return!1;return!0}function bue(e){return typeof e=="string"&&e.charCodeAt(0)>96}function wue(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}function _A(e,t,n=!1){const r={...t};for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const a=i;if(a==="components"||a==="slots")r[a]={...e[a],...r[a]};else if(a==="componentsProps"||a==="slotProps"){const c=e[a],s=t[a];if(!s)r[a]=c||{};else if(!c)r[a]=s;else{r[a]={...s};for(const f in c)if(Object.prototype.hasOwnProperty.call(c,f)){const g=f;r[a][g]=_A(c[g],s[g],n)}}}else a==="className"&&n&&t.className?r.className=_i(e==null?void 0:e.className,t==null?void 0:t.className):a==="style"&&n&&t.style?r.style={...e==null?void 0:e.style,...t==null?void 0:t.style}:r[a]===void 0&&(r[a]=e[a])}return r}function Sue(e,t=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,n))}function H3(e,t=0,n=1){return Sue(e,t,n)}function Mue(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let n=e.match(t);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Fh(e){if(e.type)return e;if(e.charAt(0)==="#")return Fh(Mue(e));const t=e.indexOf("("),n=e.substring(0,t);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(If(9,e));let r=e.substring(t+1,e.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(If(10,i))}else r=r.split(",");return r=r.map(a=>parseFloat(a)),{type:n,values:r,colorSpace:i}}const Cue=e=>{const t=Fh(e);return t.values.slice(0,3).map((n,r)=>t.type.includes("hsl")&&r!==0?`${n}%`:n).join(" ")},N0=(e,t)=>{try{return Cue(e)}catch{return e}};function XM(e){const{type:t,colorSpace:n}=e;let{values:r}=e;return t.includes("rgb")?r=r.map((i,a)=>a<3?parseInt(i,10):i):t.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),t.includes("color")?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${t}(${r})`}function xV(e){e=Fh(e);const{values:t}=e,n=t[0],r=t[1]/100,i=t[2]/100,a=r*Math.min(i,1-i),c=(g,_=(g+n/30)%12)=>i-a*Math.max(Math.min(_-3,9-_,1),-1);let s="rgb";const f=[Math.round(c(0)*255),Math.round(c(8)*255),Math.round(c(4)*255)];return e.type==="hsla"&&(s+="a",f.push(t[3])),XM({type:s,values:f})}function xA(e){e=Fh(e);let t=e.type==="hsl"||e.type==="hsla"?Fh(xV(e)).values:e.values;return t=t.map(n=>(e.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Eue(e,t){const n=xA(e),r=xA(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Tue(e,t){return e=Fh(e),t=H3(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,XM(e)}function V1(e,t,n){try{return Tue(e,t)}catch{return e}}function G3(e,t){if(e=Fh(e),t=H3(t),e.type.includes("hsl"))e.values[2]*=1-t;else if(e.type.includes("rgb")||e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]*=1-t;return XM(e)}function Zr(e,t,n){try{return G3(e,t)}catch{return e}}function W3(e,t){if(e=Fh(e),t=H3(t),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*t;else if(e.type.includes("rgb"))for(let n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(e.type.includes("color"))for(let n=0;n<3;n+=1)e.values[n]+=(1-e.values[n])*t;return XM(e)}function Yr(e,t,n){try{return W3(e,t)}catch{return e}}function Pue(e,t=.15){return xA(e)>.5?G3(e,t):W3(e,t)}function j1(e,t,n){try{return Pue(e,t)}catch{return e}}const Aue=$.createContext(void 0);function Iue(e){const{theme:t,name:n,props:r}=e;if(!t||!t.components||!t.components[n])return r;const i=t.components[n];return i.defaultProps?_A(i.defaultProps,r,t.components.mergeClassNameAndStyle):!i.styleOverrides&&!i.variants?_A(i,r,t.components.mergeClassNameAndStyle):r}function Rue({props:e,name:t}){const n=$.useContext(Aue);return Iue({props:e,name:t,theme:{components:n}})}const T5={theme:void 0};function Lue(e){let t,n;return function(i){let a=t;return(a===void 0||i.theme!==n)&&(T5.theme=i.theme,a=yV(e(T5)),t=a,n=i.theme),a}}function kue(e=""){function t(...r){if(!r.length)return"";const i=r[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${i}${t(...r.slice(1))})`:`, ${i}`}return(r,...i)=>`var(--${e?`${e}-`:""}${r}${t(...i)})`}const P5=(e,t,n,r=[])=>{let i=e;t.forEach((a,c)=>{c===t.length-1?Array.isArray(i)?i[Number(a)]=n:i&&typeof i=="object"&&(i[a]=n):i&&typeof i=="object"&&(i[a]||(i[a]=r.includes(a)?[]:{}),i=i[a])})},Due=(e,t,n)=>{function r(i,a=[],c=[]){Object.entries(i).forEach(([s,f])=>{(!n||!n([...a,s]))&&f!=null&&(typeof f=="object"&&Object.keys(f).length>0?r(f,[...a,s],Array.isArray(f)?[...c,s]:c):t([...a,s],f,c))})}r(e)},zue=(e,t)=>typeof t=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>e.includes(r))||e[e.length-1].toLowerCase().includes("opacity")?t:`${t}px`:t;function bE(e,t){const{prefix:n,shouldSkipGeneratingVar:r}=t||{},i={},a={},c={};return Due(e,(s,f,g)=>{if((typeof f=="string"||typeof f=="number")&&(!r||!r(s,f))){const _=`--${n?`${n}-`:""}${s.join("-")}`,x=zue(s,f);Object.assign(i,{[_]:x}),P5(a,s,`var(${_})`,g),P5(c,s,`var(${_}, ${x})`,g)}},s=>s[0]==="vars"),{css:i,vars:a,varsWithDefaults:c}}function Oue(e,t={}){const{getSelector:n=I,disableCssColorScheme:r,colorSchemeSelector:i}=t,{colorSchemes:a={},components:c,defaultColorScheme:s="light",...f}=e,{vars:g,css:_,varsWithDefaults:x}=bE(f,t);let C=x;const E={},{[s]:A,...L}=a;if(Object.entries(L||{}).forEach(([D,U])=>{const{vars:H,css:V,varsWithDefaults:q}=bE(U,t);C=wa(C,q),E[D]={css:V,vars:H}}),A){const{css:D,vars:U,varsWithDefaults:H}=bE(A,t);C=wa(C,H),E[s]={css:D,vars:U}}function I(D,U){var V,q;let H=i;if(i==="class"&&(H=".%s"),i==="data"&&(H="[data-%s]"),i!=null&&i.startsWith("data-")&&!i.includes("%s")&&(H=`[${i}="%s"]`),D){if(H==="media")return e.defaultColorScheme===D?":root":{[`@media (prefers-color-scheme: ${((q=(V=a[D])==null?void 0:V.palette)==null?void 0:q.mode)||D})`]:{":root":U}};if(H)return e.defaultColorScheme===D?`:root, ${H.replace("%s",String(D))}`:H.replace("%s",String(D))}return":root"}return{vars:C,generateThemeVars:()=>{let D={...g};return Object.entries(E).forEach(([,{vars:U}])=>{D=wa(D,U)}),D},generateStyleSheets:()=>{var Q,K;const D=[],U=e.defaultColorScheme||"light";function H(N,re){Object.keys(re).length&&D.push(typeof N=="string"?{[N]:{...re}}:N)}H(n(void 0,{..._}),_);const{[U]:V,...q}=E;if(V){const{css:N}=V,re=(K=(Q=a[U])==null?void 0:Q.palette)==null?void 0:K.mode,ye=!r&&re?{colorScheme:re,...N}:{...N};H(n(U,{...ye}),ye)}return Object.entries(q).forEach(([N,{css:re}])=>{var Ve,Ie;const ye=(Ie=(Ve=a[N])==null?void 0:Ve.palette)==null?void 0:Ie.mode,ge=!r&&ye?{colorScheme:ye,...re}:{...re};H(n(N,{...ge}),ge)}),D}}}function Fue(e){return function(n){return e==="media"?`@media (prefers-color-scheme: ${n})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${n}"] &`:e==="class"?`.${n} &`:e==="data"?`[data-${n}] &`:`${e.replace("%s",n)} &`:"&"}}const r_={black:"#000",white:"#fff"},Nue={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Bp={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Up={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},m0={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},$p={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Vp={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},jp={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};function bV(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:r_.white,default:r_.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const Bue=bV();function wV(){return{text:{primary:r_.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:r_.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const A5=wV();function I5(e,t,n,r){const i=r.light||r,a=r.dark||r*1.5;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:t==="light"?e.light=W3(e.main,i):t==="dark"&&(e.dark=G3(e.main,a)))}function Uue(e="light"){return e==="dark"?{main:$p[200],light:$p[50],dark:$p[400]}:{main:$p[700],light:$p[400],dark:$p[800]}}function $ue(e="light"){return e==="dark"?{main:Bp[200],light:Bp[50],dark:Bp[400]}:{main:Bp[500],light:Bp[300],dark:Bp[700]}}function Vue(e="light"){return e==="dark"?{main:Up[500],light:Up[300],dark:Up[700]}:{main:Up[700],light:Up[400],dark:Up[800]}}function jue(e="light"){return e==="dark"?{main:Vp[400],light:Vp[300],dark:Vp[700]}:{main:Vp[700],light:Vp[500],dark:Vp[900]}}function Hue(e="light"){return e==="dark"?{main:jp[400],light:jp[300],dark:jp[700]}:{main:jp[800],light:jp[500],dark:jp[900]}}function Gue(e="light"){return e==="dark"?{main:m0[400],light:m0[300],dark:m0[700]}:{main:"#ed6c02",light:m0[500],dark:m0[900]}}function q3(e){const{mode:t="light",contrastThreshold:n=3,tonalOffset:r=.2,...i}=e,a=e.primary||Uue(t),c=e.secondary||$ue(t),s=e.error||Vue(t),f=e.info||jue(t),g=e.success||Hue(t),_=e.warning||Gue(t);function x(L){return Eue(L,A5.text.primary)>=n?A5.text.primary:Bue.text.primary}const C=({color:L,name:I,mainShade:T=500,lightShade:O=300,darkShade:D=700})=>{if(L={...L},!L.main&&L[T]&&(L.main=L[T]),!L.hasOwnProperty("main"))throw new Error(If(11,I?` (${I})`:"",T));if(typeof L.main!="string")throw new Error(If(12,I?` (${I})`:"",JSON.stringify(L.main)));return I5(L,"light",O,r),I5(L,"dark",D,r),L.contrastText||(L.contrastText=x(L.main)),L};let E;return t==="light"?E=bV():t==="dark"&&(E=wV()),wa({common:{...r_},mode:t,primary:C({color:a,name:"primary"}),secondary:C({color:c,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:C({color:s,name:"error"}),warning:C({color:_,name:"warning"}),info:C({color:f,name:"info"}),success:C({color:g,name:"success"}),grey:Nue,contrastThreshold:n,getContrastText:x,augmentColor:C,tonalOffset:r,...E},i)}function Wue(e){const t={};return Object.entries(e).forEach(r=>{const[i,a]=r;typeof a=="object"&&(t[i]=`${a.fontStyle?`${a.fontStyle} `:""}${a.fontVariant?`${a.fontVariant} `:""}${a.fontWeight?`${a.fontWeight} `:""}${a.fontStretch?`${a.fontStretch} `:""}${a.fontSize||""}${a.lineHeight?`/${a.lineHeight} `:""}${a.fontFamily||""}`)}),t}function que(e,t){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...t}}function Xue(e){return Math.round(e*1e5)/1e5}const R5={textTransform:"uppercase"},L5='"Roboto", "Helvetica", "Arial", sans-serif';function Zue(e,t){const{fontFamily:n=L5,fontSize:r=14,fontWeightLight:i=300,fontWeightRegular:a=400,fontWeightMedium:c=500,fontWeightBold:s=700,htmlFontSize:f=16,allVariants:g,pxToRem:_,...x}=typeof t=="function"?t(e):t,C=r/14,E=_||(I=>`${I/f*C}rem`),A=(I,T,O,D,U)=>({fontFamily:n,fontWeight:I,fontSize:E(T),lineHeight:O,...n===L5?{letterSpacing:`${Xue(D/T)}em`}:{},...U,...g}),L={h1:A(i,96,1.167,-1.5),h2:A(i,60,1.2,-.5),h3:A(a,48,1.167,0),h4:A(a,34,1.235,.25),h5:A(a,24,1.334,0),h6:A(c,20,1.6,.15),subtitle1:A(a,16,1.75,.15),subtitle2:A(c,14,1.57,.1),body1:A(a,16,1.5,.15),body2:A(a,14,1.43,.15),button:A(c,14,1.75,.4,R5),caption:A(a,12,1.66,.4),overline:A(a,12,2.66,1,R5),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return wa({htmlFontSize:f,pxToRem:E,fontFamily:n,fontSize:r,fontWeightLight:i,fontWeightRegular:a,fontWeightMedium:c,fontWeightBold:s,...L},x,{clone:!1})}const Yue=.2,Kue=.14,Jue=.12;function di(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${Yue})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${Kue})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${Jue})`].join(",")}const Que=["none",di(0,2,1,-1,0,1,1,0,0,1,3,0),di(0,3,1,-2,0,2,2,0,0,1,5,0),di(0,3,3,-2,0,3,4,0,0,1,8,0),di(0,2,4,-1,0,4,5,0,0,1,10,0),di(0,3,5,-1,0,5,8,0,0,1,14,0),di(0,3,5,-1,0,6,10,0,0,1,18,0),di(0,4,5,-2,0,7,10,1,0,2,16,1),di(0,5,5,-3,0,8,10,1,0,3,14,2),di(0,5,6,-3,0,9,12,1,0,3,16,2),di(0,6,6,-3,0,10,14,1,0,4,18,3),di(0,6,7,-4,0,11,15,1,0,4,20,3),di(0,7,8,-4,0,12,17,2,0,5,22,4),di(0,7,8,-4,0,13,19,2,0,5,24,4),di(0,7,9,-4,0,14,21,2,0,5,26,4),di(0,8,9,-5,0,15,22,2,0,6,28,5),di(0,8,10,-5,0,16,24,2,0,6,30,5),di(0,8,11,-5,0,17,26,2,0,6,32,5),di(0,9,11,-5,0,18,28,2,0,7,34,6),di(0,9,12,-6,0,19,29,2,0,7,36,6),di(0,10,13,-6,0,20,31,3,0,8,38,7),di(0,10,13,-6,0,21,33,3,0,8,40,7),di(0,10,14,-6,0,22,35,3,0,8,42,7),di(0,11,14,-7,0,23,36,3,0,9,44,8),di(0,11,15,-7,0,24,38,3,0,9,46,8)],ehe={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},the={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function k5(e){return`${Math.round(e)}ms`}function nhe(e){if(!e)return 0;const t=e/36;return Math.min(Math.round((4+15*t**.25+t/5)*10),3e3)}function rhe(e){const t={...ehe,...e.easing},n={...the,...e.duration};return{getAutoHeightDuration:nhe,create:(i=["all"],a={})=>{const{duration:c=n.standard,easing:s=t.easeInOut,delay:f=0,...g}=a;return(Array.isArray(i)?i:[i]).map(_=>`${_} ${typeof c=="string"?c:k5(c)} ${s} ${typeof f=="string"?f:k5(f)}`).join(",")},...e,easing:t,duration:n}}const ihe={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function ohe(e){return Wc(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function SV(e={}){const t={...e};function n(r){const i=Object.entries(r);for(let a=0;a<i.length;a++){const[c,s]=i[a];!ohe(s)||c.startsWith("unstable_")?delete r[c]:Wc(s)&&(r[c]={...s},n(r[c]))}}return n(t),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(t,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function bA(e={},...t){const{breakpoints:n,mixins:r={},spacing:i,palette:a={},transitions:c={},typography:s={},shape:f,...g}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(If(20));const _=q3(a),x=gV(e);let C=wa(x,{mixins:que(x.breakpoints,r),palette:_,shadows:Que.slice(),typography:Zue(_,s),transitions:rhe(c),zIndex:{...ihe}});return C=wa(C,g),C=t.reduce((E,A)=>wa(E,A),C),C.unstable_sxConfig={...qM,...g==null?void 0:g.unstable_sxConfig},C.unstable_sx=function(A){return _g({sx:A,theme:this})},C.toRuntimeSource=SV,C}function she(e){let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,Math.round(t*10)/1e3}const ahe=[...Array(25)].map((e,t)=>{if(t===0)return"none";const n=she(t);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function MV(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function CV(e){return e==="dark"?ahe:[]}function lhe(e){const{palette:t={mode:"light"},opacity:n,overlays:r,...i}=e,a=q3(t);return{palette:a,opacity:{...MV(a.mode),...n},overlays:r||CV(a.mode),...i}}function che(e){var t;return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!((t=e[1])!=null&&t.match(/(mode|contrastThreshold|tonalOffset)/))}const uhe=e=>[...[...Array(25)].map((t,n)=>`--${e?`${e}-`:""}overlays-${n}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],hhe=e=>(t,n)=>{const r=e.rootSelector||":root",i=e.colorSchemeSelector;let a=i;if(i==="class"&&(a=".%s"),i==="data"&&(a="[data-%s]"),i!=null&&i.startsWith("data-")&&!i.includes("%s")&&(a=`[${i}="%s"]`),e.defaultColorScheme===t){if(t==="dark"){const c={};return uhe(e.cssVarPrefix).forEach(s=>{c[s]=n[s],delete n[s]}),a==="media"?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:c}}:a?{[a.replace("%s",t)]:c,[`${r}, ${a.replace("%s",t)}`]:n}:{[r]:{...n,...c}}}if(a&&a!=="media")return`${r}, ${a.replace("%s",String(t))}`}else if(t){if(a==="media")return{[`@media (prefers-color-scheme: ${String(t)})`]:{[r]:n}};if(a)return a.replace("%s",String(t))}return r};function dhe(e,t){t.forEach(n=>{e[n]||(e[n]={})})}function Bt(e,t,n){!e[t]&&n&&(e[t]=n)}function B0(e){return typeof e!="string"||!e.startsWith("hsl")?e:xV(e)}function zc(e,t){`${t}Channel`in e||(e[`${t}Channel`]=N0(B0(e[t])))}function fhe(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const Zl=e=>{try{return e()}catch{}},phe=(e="mui")=>kue(e);function wE(e,t,n,r){if(!t)return;t=t===!0?{}:t;const i=r==="dark"?"dark":"light";if(!n){e[r]=lhe({...t,palette:{mode:i,...t==null?void 0:t.palette}});return}const{palette:a,...c}=bA({...n,palette:{mode:i,...t==null?void 0:t.palette}});return e[r]={...t,palette:a,opacity:{...MV(i),...t==null?void 0:t.opacity},overlays:(t==null?void 0:t.overlays)||CV(i)},c}function mhe(e={},...t){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:i=!1,cssVarPrefix:a="mui",shouldSkipGeneratingVar:c=che,colorSchemeSelector:s=n.light&&n.dark?"media":void 0,rootSelector:f=":root",...g}=e,_=Object.keys(n)[0],x=r||(n.light&&_!=="light"?"light":_),C=phe(a),{[x]:E,light:A,dark:L,...I}=n,T={...I};let O=E;if((x==="dark"&&!("dark"in n)||x==="light"&&!("light"in n))&&(O=!0),!O)throw new Error(If(21,x));const D=wE(T,O,g,x);A&&!T.light&&wE(T,A,void 0,"light"),L&&!T.dark&&wE(T,L,void 0,"dark");let U={defaultColorScheme:x,...D,cssVarPrefix:a,colorSchemeSelector:s,rootSelector:f,getCssVar:C,colorSchemes:T,font:{...Wue(D.typography),...D.font},spacing:fhe(g.spacing)};Object.keys(U.colorSchemes).forEach(K=>{const N=U.colorSchemes[K].palette,re=ye=>{const ge=ye.split("-"),Ve=ge[1],Ie=ge[2];return C(ye,N[Ve][Ie])};if(N.mode==="light"&&(Bt(N.common,"background","#fff"),Bt(N.common,"onBackground","#000")),N.mode==="dark"&&(Bt(N.common,"background","#000"),Bt(N.common,"onBackground","#fff")),dhe(N,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),N.mode==="light"){Bt(N.Alert,"errorColor",Zr(N.error.light,.6)),Bt(N.Alert,"infoColor",Zr(N.info.light,.6)),Bt(N.Alert,"successColor",Zr(N.success.light,.6)),Bt(N.Alert,"warningColor",Zr(N.warning.light,.6)),Bt(N.Alert,"errorFilledBg",re("palette-error-main")),Bt(N.Alert,"infoFilledBg",re("palette-info-main")),Bt(N.Alert,"successFilledBg",re("palette-success-main")),Bt(N.Alert,"warningFilledBg",re("palette-warning-main")),Bt(N.Alert,"errorFilledColor",Zl(()=>N.getContrastText(N.error.main))),Bt(N.Alert,"infoFilledColor",Zl(()=>N.getContrastText(N.info.main))),Bt(N.Alert,"successFilledColor",Zl(()=>N.getContrastText(N.success.main))),Bt(N.Alert,"warningFilledColor",Zl(()=>N.getContrastText(N.warning.main))),Bt(N.Alert,"errorStandardBg",Yr(N.error.light,.9)),Bt(N.Alert,"infoStandardBg",Yr(N.info.light,.9)),Bt(N.Alert,"successStandardBg",Yr(N.success.light,.9)),Bt(N.Alert,"warningStandardBg",Yr(N.warning.light,.9)),Bt(N.Alert,"errorIconColor",re("palette-error-main")),Bt(N.Alert,"infoIconColor",re("palette-info-main")),Bt(N.Alert,"successIconColor",re("palette-success-main")),Bt(N.Alert,"warningIconColor",re("palette-warning-main")),Bt(N.AppBar,"defaultBg",re("palette-grey-100")),Bt(N.Avatar,"defaultBg",re("palette-grey-400")),Bt(N.Button,"inheritContainedBg",re("palette-grey-300")),Bt(N.Button,"inheritContainedHoverBg",re("palette-grey-A100")),Bt(N.Chip,"defaultBorder",re("palette-grey-400")),Bt(N.Chip,"defaultAvatarColor",re("palette-grey-700")),Bt(N.Chip,"defaultIconColor",re("palette-grey-700")),Bt(N.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Bt(N.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Bt(N.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Bt(N.LinearProgress,"primaryBg",Yr(N.primary.main,.62)),Bt(N.LinearProgress,"secondaryBg",Yr(N.secondary.main,.62)),Bt(N.LinearProgress,"errorBg",Yr(N.error.main,.62)),Bt(N.LinearProgress,"infoBg",Yr(N.info.main,.62)),Bt(N.LinearProgress,"successBg",Yr(N.success.main,.62)),Bt(N.LinearProgress,"warningBg",Yr(N.warning.main,.62)),Bt(N.Skeleton,"bg",`rgba(${re("palette-text-primaryChannel")} / 0.11)`),Bt(N.Slider,"primaryTrack",Yr(N.primary.main,.62)),Bt(N.Slider,"secondaryTrack",Yr(N.secondary.main,.62)),Bt(N.Slider,"errorTrack",Yr(N.error.main,.62)),Bt(N.Slider,"infoTrack",Yr(N.info.main,.62)),Bt(N.Slider,"successTrack",Yr(N.success.main,.62)),Bt(N.Slider,"warningTrack",Yr(N.warning.main,.62));const ye=j1(N.background.default,.8);Bt(N.SnackbarContent,"bg",ye),Bt(N.SnackbarContent,"color",Zl(()=>N.getContrastText(ye))),Bt(N.SpeedDialAction,"fabHoverBg",j1(N.background.paper,.15)),Bt(N.StepConnector,"border",re("palette-grey-400")),Bt(N.StepContent,"border",re("palette-grey-400")),Bt(N.Switch,"defaultColor",re("palette-common-white")),Bt(N.Switch,"defaultDisabledColor",re("palette-grey-100")),Bt(N.Switch,"primaryDisabledColor",Yr(N.primary.main,.62)),Bt(N.Switch,"secondaryDisabledColor",Yr(N.secondary.main,.62)),Bt(N.Switch,"errorDisabledColor",Yr(N.error.main,.62)),Bt(N.Switch,"infoDisabledColor",Yr(N.info.main,.62)),Bt(N.Switch,"successDisabledColor",Yr(N.success.main,.62)),Bt(N.Switch,"warningDisabledColor",Yr(N.warning.main,.62)),Bt(N.TableCell,"border",Yr(V1(N.divider,1),.88)),Bt(N.Tooltip,"bg",V1(N.grey[700],.92))}if(N.mode==="dark"){Bt(N.Alert,"errorColor",Yr(N.error.light,.6)),Bt(N.Alert,"infoColor",Yr(N.info.light,.6)),Bt(N.Alert,"successColor",Yr(N.success.light,.6)),Bt(N.Alert,"warningColor",Yr(N.warning.light,.6)),Bt(N.Alert,"errorFilledBg",re("palette-error-dark")),Bt(N.Alert,"infoFilledBg",re("palette-info-dark")),Bt(N.Alert,"successFilledBg",re("palette-success-dark")),Bt(N.Alert,"warningFilledBg",re("palette-warning-dark")),Bt(N.Alert,"errorFilledColor",Zl(()=>N.getContrastText(N.error.dark))),Bt(N.Alert,"infoFilledColor",Zl(()=>N.getContrastText(N.info.dark))),Bt(N.Alert,"successFilledColor",Zl(()=>N.getContrastText(N.success.dark))),Bt(N.Alert,"warningFilledColor",Zl(()=>N.getContrastText(N.warning.dark))),Bt(N.Alert,"errorStandardBg",Zr(N.error.light,.9)),Bt(N.Alert,"infoStandardBg",Zr(N.info.light,.9)),Bt(N.Alert,"successStandardBg",Zr(N.success.light,.9)),Bt(N.Alert,"warningStandardBg",Zr(N.warning.light,.9)),Bt(N.Alert,"errorIconColor",re("palette-error-main")),Bt(N.Alert,"infoIconColor",re("palette-info-main")),Bt(N.Alert,"successIconColor",re("palette-success-main")),Bt(N.Alert,"warningIconColor",re("palette-warning-main")),Bt(N.AppBar,"defaultBg",re("palette-grey-900")),Bt(N.AppBar,"darkBg",re("palette-background-paper")),Bt(N.AppBar,"darkColor",re("palette-text-primary")),Bt(N.Avatar,"defaultBg",re("palette-grey-600")),Bt(N.Button,"inheritContainedBg",re("palette-grey-800")),Bt(N.Button,"inheritContainedHoverBg",re("palette-grey-700")),Bt(N.Chip,"defaultBorder",re("palette-grey-700")),Bt(N.Chip,"defaultAvatarColor",re("palette-grey-300")),Bt(N.Chip,"defaultIconColor",re("palette-grey-300")),Bt(N.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Bt(N.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Bt(N.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Bt(N.LinearProgress,"primaryBg",Zr(N.primary.main,.5)),Bt(N.LinearProgress,"secondaryBg",Zr(N.secondary.main,.5)),Bt(N.LinearProgress,"errorBg",Zr(N.error.main,.5)),Bt(N.LinearProgress,"infoBg",Zr(N.info.main,.5)),Bt(N.LinearProgress,"successBg",Zr(N.success.main,.5)),Bt(N.LinearProgress,"warningBg",Zr(N.warning.main,.5)),Bt(N.Skeleton,"bg",`rgba(${re("palette-text-primaryChannel")} / 0.13)`),Bt(N.Slider,"primaryTrack",Zr(N.primary.main,.5)),Bt(N.Slider,"secondaryTrack",Zr(N.secondary.main,.5)),Bt(N.Slider,"errorTrack",Zr(N.error.main,.5)),Bt(N.Slider,"infoTrack",Zr(N.info.main,.5)),Bt(N.Slider,"successTrack",Zr(N.success.main,.5)),Bt(N.Slider,"warningTrack",Zr(N.warning.main,.5));const ye=j1(N.background.default,.98);Bt(N.SnackbarContent,"bg",ye),Bt(N.SnackbarContent,"color",Zl(()=>N.getContrastText(ye))),Bt(N.SpeedDialAction,"fabHoverBg",j1(N.background.paper,.15)),Bt(N.StepConnector,"border",re("palette-grey-600")),Bt(N.StepContent,"border",re("palette-grey-600")),Bt(N.Switch,"defaultColor",re("palette-grey-300")),Bt(N.Switch,"defaultDisabledColor",re("palette-grey-600")),Bt(N.Switch,"primaryDisabledColor",Zr(N.primary.main,.55)),Bt(N.Switch,"secondaryDisabledColor",Zr(N.secondary.main,.55)),Bt(N.Switch,"errorDisabledColor",Zr(N.error.main,.55)),Bt(N.Switch,"infoDisabledColor",Zr(N.info.main,.55)),Bt(N.Switch,"successDisabledColor",Zr(N.success.main,.55)),Bt(N.Switch,"warningDisabledColor",Zr(N.warning.main,.55)),Bt(N.TableCell,"border",Zr(V1(N.divider,1),.68)),Bt(N.Tooltip,"bg",V1(N.grey[700],.92))}zc(N.background,"default"),zc(N.background,"paper"),zc(N.common,"background"),zc(N.common,"onBackground"),zc(N,"divider"),Object.keys(N).forEach(ye=>{const ge=N[ye];ye!=="tonalOffset"&&ge&&typeof ge=="object"&&(ge.main&&Bt(N[ye],"mainChannel",N0(B0(ge.main))),ge.light&&Bt(N[ye],"lightChannel",N0(B0(ge.light))),ge.dark&&Bt(N[ye],"darkChannel",N0(B0(ge.dark))),ge.contrastText&&Bt(N[ye],"contrastTextChannel",N0(B0(ge.contrastText))),ye==="text"&&(zc(N[ye],"primary"),zc(N[ye],"secondary")),ye==="action"&&(ge.active&&zc(N[ye],"active"),ge.selected&&zc(N[ye],"selected")))})}),U=t.reduce((K,N)=>wa(K,N),U);const H={prefix:a,disableCssColorScheme:i,shouldSkipGeneratingVar:c,getSelector:hhe(U)},{vars:V,generateThemeVars:q,generateStyleSheets:Q}=Oue(U,H);return U.vars=V,Object.entries(U.colorSchemes[U.defaultColorScheme]).forEach(([K,N])=>{U[K]=N}),U.generateThemeVars=q,U.generateStyleSheets=Q,U.generateSpacing=function(){return mV(g.spacing,V3(this))},U.getColorSchemeSelector=Fue(s),U.spacing=U.generateSpacing(),U.shouldSkipGeneratingVar=c,U.unstable_sxConfig={...qM,...g==null?void 0:g.unstable_sxConfig},U.unstable_sx=function(N){return _g({sx:N,theme:this})},U.toRuntimeSource=SV,U}function D5(e,t,n){e.colorSchemes&&n&&(e.colorSchemes[t]={...n!==!0&&n,palette:q3({...n===!0?{}:n.palette,mode:t})})}function ghe(e={},...t){const{palette:n,cssVariables:r=!1,colorSchemes:i=n?void 0:{light:!0},defaultColorScheme:a=n==null?void 0:n.mode,...c}=e,s=a||"light",f=i==null?void 0:i[s],g={...i,...n?{[s]:{...typeof f!="boolean"&&f,palette:n}}:void 0};if(r===!1){if(!("colorSchemes"in e))return bA(e,...t);let _=n;"palette"in e||g[s]&&(g[s]!==!0?_=g[s].palette:s==="dark"&&(_={mode:"dark"}));const x=bA({...e,palette:_},...t);return x.defaultColorScheme=s,x.colorSchemes=g,x.palette.mode==="light"&&(x.colorSchemes.light={...g.light!==!0&&g.light,palette:x.palette},D5(x,"dark",g.dark)),x.palette.mode==="dark"&&(x.colorSchemes.dark={...g.dark!==!0&&g.dark,palette:x.palette},D5(x,"light",g.light)),x}return!n&&!("light"in g)&&s==="light"&&(g.light=!0),mhe({...c,colorSchemes:g,defaultColorScheme:s,...typeof r!="boolean"&&r},...t)}const vhe=ghe(),yhe="$$material";function _he(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const xhe=e=>_he(e)&&e!=="classes",bhe=yue({themeId:yhe,defaultTheme:vhe,rootShouldForwardProp:xhe}),whe=Lue;function She(e){return Rue(e)}function Mhe(e){return vV("MuiSvgIcon",e)}pue("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Che=e=>{const{color:t,fontSize:n,classes:r}=e,i={root:["root",t!=="inherit"&&`color${yg(t)}`,`fontSize${yg(n)}`]};return pce(i,Mhe,r)},Ehe=bhe("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.color!=="inherit"&&t[`color${yg(n.color)}`],t[`fontSize${yg(n.fontSize)}`]]}})(whe(({theme:e})=>{var t,n,r,i,a,c,s,f,g,_,x,C,E,A;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(i=(t=e.transitions)==null?void 0:t.create)==null?void 0:i.call(t,"fill",{duration:(r=(n=(e.vars??e).transitions)==null?void 0:n.duration)==null?void 0:r.shorter}),variants:[{props:L=>!L.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((c=(a=e.typography)==null?void 0:a.pxToRem)==null?void 0:c.call(a,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((f=(s=e.typography)==null?void 0:s.pxToRem)==null?void 0:f.call(s,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((_=(g=e.typography)==null?void 0:g.pxToRem)==null?void 0:_.call(g,35))||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,L])=>L&&L.main).map(([L])=>{var I,T;return{props:{color:L},style:{color:(T=(I=(e.vars??e).palette)==null?void 0:I[L])==null?void 0:T.main}}}),{props:{color:"action"},style:{color:(C=(x=(e.vars??e).palette)==null?void 0:x.action)==null?void 0:C.active}},{props:{color:"disabled"},style:{color:(A=(E=(e.vars??e).palette)==null?void 0:E.action)==null?void 0:A.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),wA=$.forwardRef(function(t,n){const r=She({props:t,name:"MuiSvgIcon"}),{children:i,className:a,color:c="inherit",component:s="svg",fontSize:f="medium",htmlColor:g,inheritViewBox:_=!1,titleAccess:x,viewBox:C="0 0 24 24",...E}=r,A=$.isValidElement(i)&&i.type==="svg",L={...r,color:c,component:s,fontSize:f,instanceFontSize:t.fontSize,inheritViewBox:_,viewBox:C,hasSvgAsChild:A},I={};_||(I.viewBox=C);const T=Che(L);return te.jsxs(Ehe,{as:s,className:_i(T.root,a),focusable:"false",color:g,"aria-hidden":x?void 0:!0,role:x?"img":void 0,ref:n,...I,...E,...A&&i.props,ownerState:L,children:[A?i.props.children:i,x?te.jsx("title",{children:x}):null]})});wA.muiName="SvgIcon";function qs(e,t){function n(r,i){return te.jsx(wA,{"data-testid":void 0,ref:i,...r,children:e})}return n.muiName=wA.muiName,$.memo($.forwardRef(n))}const X3=qs(te.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}));function nr(e,t){if(e==null)throw new Error(t);return e}function EV(e,t){if(!e)throw new Error(`assertion failed: ${t}`);return e}var bo=(e=>(e[e.Arizona=0]="Arizona",e[e.Arkansas=1]="Arkansas",e[e.Colorado=2]="Colorado",e[e.Idaho=3]="Idaho",e[e.Iowa=4]="Iowa",e[e.Kansas=5]="Kansas",e[e.Missouri=6]="Missouri",e[e.Montana=7]="Montana",e[e.Nebraska=8]="Nebraska",e[e.Nevada=9]="Nevada",e[e.NewMexico=10]="NewMexico",e[e.Oklahoma=11]="Oklahoma",e[e.Oregon=12]="Oregon",e[e.Texas=13]="Texas",e[e.Utah=14]="Utah",e[e.Washington=15]="Washington",e[e.Wyoming=16]="Wyoming",e))(bo||{});const Rf=new Set([9,0,10,12,15,14,3,2,16,7,13,11,5,8,1,6,4]),The={9:"Nevada",0:"Arizona",10:"New Mexico",12:"Oregon",15:"Washington",14:"Utah",3:"Idaho",2:"Colorado",16:"Wyoming",7:"Montana",13:"Texas",11:"Oklahoma",5:"Kansas",8:"Nebraska",1:"Arkansas",6:"Missouri",4:"Iowa"},TV={0:new Set,1:new Set([9]),2:new Set([0]),3:new Set([10]),4:new Set([12]),5:new Set([15]),6:new Set([15,12]),7:new Set([14]),8:new Set([14,10]),9:new Set([3]),10:new Set([3,12]),11:new Set([3,14]),12:new Set([3,15]),13:new Set([2]),14:new Set([2,10]),15:new Set([2,14]),16:new Set([16]),17:new Set([16,2]),18:new Set([16,3]),19:new Set([16,14]),20:new Set([13]),21:new Set([13,10]),22:new Set([7]),23:new Set([7,3]),24:new Set([7,16]),25:new Set([11]),26:new Set([11,2]),27:new Set([11,10]),28:new Set([11,13]),29:new Set([5]),30:new Set([5,2]),31:new Set([5,11]),32:new Set([8]),33:new Set([8,2]),34:new Set([8,5]),35:new Set([8,16]),36:new Set([1]),37:new Set([1,11]),38:new Set([1,13]),39:new Set([6]),40:new Set([6,1]),41:new Set([6,5]),42:new Set([6,8]),43:new Set([6,11]),44:new Set([4]),45:new Set([4,6]),46:new Set([4,8])},Phe={1:0,2:1,3:2,7:13,13:9,31:3,37:4,43:20,44:7,47:5,17:29,27:22,36:25,50:16,18:32,19:36,26:39,21:44};for(const e of Object.values(Phe))e!==0&&EV(TV[e].size===1);function H_(e){const t=new Set;for(const[n,r]of Object.entries(TV))[...r].every(i=>e.has(i))&&t.add(Number(n));return t}const Ahe=new Set([0,1,2,3,4,5,6,7,11]),Ihe={0:new Set,1:new Set([0]),2:new Set([1]),3:new Set([2]),4:new Set([3]),5:new Set([3,2]),6:new Set([4]),7:new Set([4,0]),8:new Set([4,1]),9:new Set([5]),10:new Set([5,0]),11:new Set([6]),12:new Set([6,2]),16:new Set([7]),17:new Set([7,0]),18:new Set([7,4]),20:new Set([11]),21:new Set([11,0]),22:new Set([11,7])};function Rhe(e){const t=new Set;for(const[n,r]of Object.entries(Ihe))[...r].every(i=>e.has(i))&&t.add(Number(n));return t}var PV=(e=>(e[e.Road=0]="Road",e[e.Light=1]="Light",e[e.Dark=2]="Dark",e[e.Green=3]="Green",e[e.NavRed=4]="NavRed",e[e.NavGreen=5]="NavGreen",e[e.NavBlue=6]="NavBlue",e[e.NavYellow=7]="NavYellow",e[e.NavPurple=8]="NavPurple",e))(PV||{});const Lhe="modulepreload",khe=function(e){return"/"+e},z5={},Dhe=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),s=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(n.map(f=>{if(f=khe(f),f in z5)return;z5[f]=!0;const g=f.endsWith(".css"),_=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${_}`))return;const x=document.createElement("link");if(x.rel=g?"stylesheet":Lhe,g||(x.as="script"),x.crossOrigin="",x.href=f,s&&x.setAttribute("nonce",s),document.head.appendChild(x),g)return new Promise((C,E)=>{x.addEventListener("load",C),x.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(c){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=c,window.dispatchEvent(s),!s.defaultPrevented)throw c}return i.then(c=>{for(const s of c||[])s.status==="rejected"&&a(s.reason);return t().catch(a)})},AV=$.createContext(null);function ZM(){var r;const e=(r=$.useContext(AV))==null?void 0:r.maps,t=$.useContext(Vf);return $.useMemo(()=>({...e,current:t==null?void 0:t.map}),[e,t])}function zhe(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,r=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(t)?t[0]:t?t.x:0,a=Array.isArray(t)?t[1]:t?t.y:0;return n===i&&r===a}function ks(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!ks(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n)if(!t.hasOwnProperty(i)||!ks(e[i],t[i]))return!1;return!0}return!1}function O5(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function F5(e,t){const n=t.viewState||t,r={};if("longitude"in n&&"latitude"in n&&(n.longitude!==e.center.lng||n.latitude!==e.center.lat)){const i=e.center.constructor;r.center=new i(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==e.zoom&&(r.zoom=n.zoom),"bearing"in n&&n.bearing!==e.bearing&&(r.bearing=n.bearing),"pitch"in n&&n.pitch!==e.pitch&&(r.pitch=n.pitch),n.padding&&e.padding&&!ks(n.padding,e.padding)&&(r.padding=n.padding),r}const Ohe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function N5(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const r of e.layers)t[r.id]=r;const n=e.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const a=t[r.ref];if(a){i=i||Object.assign({},r),delete i.ref;for(const c of Ohe)c in a&&(i[c]=a[c])}return i||r});return{...e,layers:n}}const B5={version:8,sources:{},layers:[]},U5={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},$5={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},V5={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Fhe=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Nhe=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class xg{constructor(t,n,r){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=i=>{const a=this.props[V5[i.type]];a?a(i):i.type==="error"&&console.error(i.error)},this._onCameraEvent=i=>{if(this._internalUpdate)return;i.viewState=this._propsedCameraUpdate||O5(this._map.transform);const a=this.props[$5[i.type]];a&&a(i)},this._onCameraUpdate=i=>this._internalUpdate?i:(this._propsedCameraUpdate=O5(i),F5(i,this.props)),this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const a=this.props[U5[i.type]];a&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),a(i),delete i.features)},this._MapClass=t,this.props=n,this._initialize(r)}get map(){return this._map}setProps(t){const n=this.props;this.props=t;const r=this._updateSettings(t,n),i=this._updateSize(t),a=this._updateViewState(t);this._updateStyle(t,n),this._updateStyleComponents(t),this._updateHandlers(t,n),(r||i||a&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const r=xg.savedMaps.pop();if(!r)return null;const i=r.map,a=i.getContainer();for(n.className=a.className;a.childNodes.length>0;)n.appendChild(a.childNodes[0]);i._container=n;const c=i._resizeObserver;c&&(c.disconnect(),c.observe(n)),r.setProps({...t,styleDiffing:!1}),i.resize();const{initialViewState:s}=t;return s&&(s.bounds?i.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):r._updateViewState(s)),i.isStyleLoaded()?i.fire("load"):i.once("style.load",()=>i.fire("load")),i._update(),r}_initialize(t){const{props:n}=this,{mapStyle:r=B5}=n,i={...n,...n.initialViewState,container:t,style:N5(r)},a=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),n.gl){const s=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=s,n.gl)}const c=new this._MapClass(i);a.padding&&c.setPadding(a.padding),n.cursor&&(c.getCanvas().style.cursor=n.cursor),c.transformCameraUpdate=this._onCameraUpdate,c.on("style.load",()=>{var s;this._styleComponents={light:c.getLight(),sky:c.getSky(),projection:(s=c.getProjection)==null?void 0:s.call(c),terrain:c.getTerrain()},this._updateStyleComponents(this.props)}),c.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const s in U5)c.on(s,this._onPointerEvent);for(const s in $5)c.on(s,this._onCameraEvent);for(const s in V5)c.on(s,this._onEvent);this._map=c}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),xg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_updateSize(t){const{viewState:n}=t;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(t){const n=this._map,r=n.transform;if(!n.isMoving()){const a=F5(r,t);if(Object.keys(a).length>0)return this._internalUpdate=!0,n.jumpTo(a),this._internalUpdate=!1,!0}return!1}_updateSettings(t,n){const r=this._map;let i=!1;for(const a of Fhe)if(a in t&&!ks(t[a],n[a])){i=!0;const c=r[`set${a[0].toUpperCase()}${a.slice(1)}`];c==null||c.call(r,t[a])}return i}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor||""),t.mapStyle!==n.mapStyle){const{mapStyle:r=B5,styleDiffing:i=!0}=t,a={diff:i};"localIdeographFontFamily"in t&&(a.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(N5(r),a)}}_updateStyleComponents({light:t,projection:n,sky:r,terrain:i}){var s,f;const a=this._map,c=this._styleComponents;a.style._loaded&&(t&&!ks(t,c.light)&&(c.light=t,a.setLight(t)),n&&!ks(n,c.projection)&&n!==((s=c.projection)==null?void 0:s.type)&&(c.projection=typeof n=="string"?{type:n}:n,(f=a.setProjection)==null||f.call(a,c.projection)),r&&!ks(r,c.sky)&&(c.sky=r,a.setSky(r)),i!==void 0&&!ks(i,c.terrain)&&(!i||a.getSource(i.source))&&(c.terrain=i,a.setTerrain(i)))}_updateHandlers(t,n){const r=this._map;for(const i of Nhe){const a=t[i]??!0,c=n[i]??!0;ks(a,c)||(a?r[i].enable(a):r[i].disable())}}_queryRenderedFeatures(t){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(t,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(t){var i;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const a=t.type,c=((i=this._hoveredFeatures)==null?void 0:i.length)>0,s=this._queryRenderedFeatures(t.point),f=s.length>0;!f&&c&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=s,f&&!c&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=a}else this._hoveredFeatures=null}}xg.savedMaps=[];const Bhe=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Uhe(e){if(!e)return null;const t=e.map,n={getMap:()=>t};for(const r of $he(t))!(r in n)&&!Bhe.includes(r)&&(n[r]=t[r].bind(t));return n}function $he(e){const t=new Set;let n=e;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof e[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&t.add(r);n=Object.getPrototypeOf(n)}return Array.from(t)}const Vhe=typeof document<"u"?$.useLayoutEffect:$.useEffect;function jhe(e,t){const{RTLTextPlugin:n,maxParallelImageRequests:r,workerCount:i,workerUrl:a}=t;if(n&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:c,lazy:s=!0}=typeof n=="string"?{pluginUrl:n}:n;e.setRTLTextPlugin(c,f=>{f&&console.error(f)},s)}r!==void 0&&e.setMaxParallelImageRequests(r),i!==void 0&&e.setWorkerCount(i),a!==void 0&&e.setWorkerUrl(a)}const Vf=$.createContext(null);function Hhe(e,t){const n=$.useContext(AV),[r,i]=$.useState(null),a=$.useRef(),{current:c}=$.useRef({mapLib:null,map:null});$.useEffect(()=>{const g=e.mapLib;let _=!0,x;return Promise.resolve(g||Dhe(()=>Promise.resolve().then(()=>ude),[])).then(C=>{if(!_)return;if(!C)throw new Error("Invalid mapLib");const E="Map"in C?C:C.default;if(!E.Map)throw new Error("Invalid mapLib");jhe(E,e),e.reuseMaps&&(x=xg.reuse(e,a.current)),x||(x=new xg(E.Map,e,a.current)),c.map=Uhe(x),c.mapLib=E,i(x),n==null||n.onMapMount(c.map,e.id)}).catch(C=>{const{onError:E}=e;E?E({type:"error",target:null,originalEvent:null,error:C}):console.error(C)}),()=>{_=!1,x&&(n==null||n.onMapUnmount(e.id),e.reuseMaps?x.recycle():x.destroy())}},[]),Vhe(()=>{r&&r.setProps(e)}),$.useImperativeHandle(t,()=>c.map,[r]);const s=$.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]),f={height:"100%"};return $.createElement("div",{id:e.id,ref:a,style:s},r&&$.createElement(Vf.Provider,{value:c},$.createElement("div",{"mapboxgl-children":"",style:f},e.children)))}const YM=$.forwardRef(Hhe),Ghe=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function mu(e,t){if(!e||!t)return;const n=e.style;for(const r in t){const i=t[r];Number.isFinite(i)&&!Ghe.test(r)?n[r]=`${i}px`:n[r]=i}}function IV(e,t){if(e===t)return null;const n=j5(e),r=j5(t),i=[];for(const a of r)n.has(a)||i.push(a);for(const a of n)r.has(a)||i.push(a);return i.length===0?null:i}function j5(e){return new Set(e?e.trim().split(/\s+/):[])}const Z3=$.memo($.forwardRef((e,t)=>{const{map:n,mapLib:r}=$.useContext(Vf),i=$.useRef({props:e}),a=$.useMemo(()=>{let T=!1;$.Children.forEach(e.children,U=>{U&&(T=!0)});const O={...e,element:T?document.createElement("div"):void 0},D=new r.Marker(O);return D.setLngLat([e.longitude,e.latitude]),D.getElement().addEventListener("click",U=>{var H,V;(V=(H=i.current.props).onClick)==null||V.call(H,{type:"click",target:D,originalEvent:U})}),D.on("dragstart",U=>{var V,q;const H=U;H.lngLat=a.getLngLat(),(q=(V=i.current.props).onDragStart)==null||q.call(V,H)}),D.on("drag",U=>{var V,q;const H=U;H.lngLat=a.getLngLat(),(q=(V=i.current.props).onDrag)==null||q.call(V,H)}),D.on("dragend",U=>{var V,q;const H=U;H.lngLat=a.getLngLat(),(q=(V=i.current.props).onDragEnd)==null||q.call(V,H)}),D},[]);$.useEffect(()=>(a.addTo(n.getMap()),()=>{a.remove()}),[]);const{longitude:c,latitude:s,offset:f,style:g,draggable:_=!1,popup:x=null,rotation:C=0,rotationAlignment:E="auto",pitchAlignment:A="auto"}=e;$.useEffect(()=>{mu(a.getElement(),g)},[g]),$.useImperativeHandle(t,()=>a,[]);const L=i.current.props;(a.getLngLat().lng!==c||a.getLngLat().lat!==s)&&a.setLngLat([c,s]),f&&!zhe(a.getOffset(),f)&&a.setOffset(f),a.isDraggable()!==_&&a.setDraggable(_),a.getRotation()!==C&&a.setRotation(C),a.getRotationAlignment()!==E&&a.setRotationAlignment(E),a.getPitchAlignment()!==A&&a.setPitchAlignment(A),a.getPopup()!==x&&a.setPopup(x);const I=IV(L.className,e.className);if(I)for(const T of I)a.toggleClassName(T);return i.current.props=e,A_.createPortal(e.children,a.getElement())})),Whe=$.memo($.forwardRef((e,t)=>{const{map:n,mapLib:r}=$.useContext(Vf),i=$.useMemo(()=>document.createElement("div"),[]),a=$.useRef({props:e}),c=$.useMemo(()=>{const s={...e},f=new r.Popup(s);return f.setLngLat([e.longitude,e.latitude]),f.once("open",g=>{var _,x;(x=(_=a.current.props).onOpen)==null||x.call(_,g)}),f},[]);if($.useEffect(()=>{const s=f=>{var g,_;(_=(g=a.current.props).onClose)==null||_.call(g,f)};return c.on("close",s),c.setDOMContent(i).addTo(n.getMap()),()=>{c.off("close",s),c.isOpen()&&c.remove()}},[]),$.useEffect(()=>{mu(c.getElement(),e.style)},[e.style]),$.useImperativeHandle(t,()=>c,[]),c.isOpen()){const s=a.current.props;(c.getLngLat().lng!==e.longitude||c.getLngLat().lat!==e.latitude)&&c.setLngLat([e.longitude,e.latitude]),e.offset&&!ks(s.offset,e.offset)&&c.setOffset(e.offset),(s.anchor!==e.anchor||s.maxWidth!==e.maxWidth)&&(c.options.anchor=e.anchor,c.setMaxWidth(e.maxWidth));const f=IV(s.className,e.className);if(f)for(const g of f)c.toggleClassName(g);a.current.props=e}return A_.createPortal(e.children,i)}));function tl(e,t,n,r){const i=$.useContext(Vf),a=$.useMemo(()=>e(i),[]);return $.useEffect(()=>{const c=t,s=typeof t=="function"?t:null,{map:f}=i;return f.hasControl(a)||f.addControl(a,c==null?void 0:c.position),()=>{s&&s(i),f.hasControl(a)&&f.removeControl(a)}},[]),a}function qhe(e){const t=tl(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return $.useEffect(()=>{mu(t._container,e.style)},[e.style]),null}const RV=$.memo(qhe);function Xhe(e){const t=tl(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return $.useEffect(()=>{mu(t._controlContainer,e.style)},[e.style]),null}const LV=$.memo(Xhe);function Zhe(e,t){const n=$.useRef({props:e}),r=tl(({mapLib:i})=>{const a=new i.GeolocateControl(e),c=a._setupUI;return a._setupUI=()=>{a._container.hasChildNodes()||c()},a.on("geolocate",s=>{var f,g;(g=(f=n.current.props).onGeolocate)==null||g.call(f,s)}),a.on("error",s=>{var f,g;(g=(f=n.current.props).onError)==null||g.call(f,s)}),a.on("outofmaxbounds",s=>{var f,g;(g=(f=n.current.props).onOutOfMaxBounds)==null||g.call(f,s)}),a.on("trackuserlocationstart",s=>{var f,g;(g=(f=n.current.props).onTrackUserLocationStart)==null||g.call(f,s)}),a.on("trackuserlocationend",s=>{var f,g;(g=(f=n.current.props).onTrackUserLocationEnd)==null||g.call(f,s)}),a},{position:e.position});return n.current.props=e,$.useImperativeHandle(t,()=>r,[]),$.useEffect(()=>{mu(r._container,e.style)},[e.style]),null}$.memo($.forwardRef(Zhe));function Yhe(e){const t=tl(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return $.useEffect(()=>{mu(t._container,e.style)},[e.style]),null}const kV=$.memo(Yhe);function Khe(e){const t=tl(({mapLib:a})=>new a.ScaleControl(e),{position:e.position}),n=$.useRef(e),r=n.current;n.current=e;const{style:i}=e;return e.maxWidth!==void 0&&e.maxWidth!==r.maxWidth&&(t.options.maxWidth=e.maxWidth),e.unit!==void 0&&e.unit!==r.unit&&t.setUnit(e.unit),$.useEffect(()=>{mu(t._container,i)},[i]),null}$.memo(Khe);function Jhe(e){const t=tl(({mapLib:n})=>new n.TerrainControl(e),{position:e.position});return $.useEffect(()=>{mu(t._container,e.style)},[e.style]),null}$.memo(Jhe);function Qhe(e){const t=tl(({mapLib:n})=>new n.LogoControl(e),{position:e.position});return $.useEffect(()=>{mu(t._container,e.style)},[e.style]),null}$.memo(Qhe);function nS(e,t){if(!e)throw new Error(t)}let ede=0;function tde(e,t,n){if(e.style&&e.style._loaded){const r={...n};return delete r.id,delete r.children,e.addSource(t,r),e.getSource(t)}return null}function nde(e,t,n){var c,s,f;nS(t.id===n.id,"source id changed"),nS(t.type===n.type,"source type changed");let r="",i=0;for(const g in t)g!=="children"&&g!=="id"&&!ks(n[g],t[g])&&(r=g,i++);if(!i)return;const a=t.type;if(a==="geojson")e.setData(t.data);else if(a==="image")e.updateImage({url:t.url,coordinates:t.coordinates});else switch(r){case"coordinates":(c=e.setCoordinates)==null||c.call(e,t.coordinates);break;case"url":(s=e.setUrl)==null||s.call(e,t.url);break;case"tiles":(f=e.setTiles)==null||f.call(e,t.tiles);break;default:console.warn(`Unable to update <Source> prop: ${r}`)}}function Nh(e){const t=$.useContext(Vf).map.getMap(),n=$.useRef(e),[,r]=$.useState(0),i=$.useMemo(()=>e.id||`jsx-source-${ede++}`,[]);$.useEffect(()=>{if(t){const c=()=>setTimeout(()=>r(s=>s+1),0);return t.on("styledata",c),c(),()=>{var s;if(t.off("styledata",c),t.style&&t.style._loaded&&t.getSource(i)){const f=(s=t.getStyle())==null?void 0:s.layers;if(f)for(const g of f)g.source===i&&t.removeLayer(g.id);t.removeSource(i)}}}},[t]);let a=t&&t.style&&t.getSource(i);return a?nde(a,e,n.current):a=tde(t,i,e),n.current=e,a&&$.Children.map(e.children,c=>c&&$.cloneElement(c,{source:i}))||null}function rde(e,t,n,r){if(nS(n.id===r.id,"layer id changed"),nS(n.type===r.type,"layer type changed"),n.type==="custom"||r.type==="custom")return;const{layout:i={},paint:a={},filter:c,minzoom:s,maxzoom:f,beforeId:g}=n;if(g!==r.beforeId&&e.moveLayer(t,g),i!==r.layout){const _=r.layout||{};for(const x in i)ks(i[x],_[x])||e.setLayoutProperty(t,x,i[x]);for(const x in _)i.hasOwnProperty(x)||e.setLayoutProperty(t,x,void 0)}if(a!==r.paint){const _=r.paint||{};for(const x in a)ks(a[x],_[x])||e.setPaintProperty(t,x,a[x]);for(const x in _)a.hasOwnProperty(x)||e.setPaintProperty(t,x,void 0)}ks(c,r.filter)||e.setFilter(t,c),(s!==r.minzoom||f!==r.maxzoom)&&e.setLayerZoomRange(t,s,f)}function ide(e,t,n){if(e.style&&e.style._loaded&&(!("source"in n)||e.getSource(n.source))){const r={...n,id:t};delete r.beforeId,e.addLayer(r,n.beforeId)}}let ode=0;function fr(e){const t=$.useContext(Vf).map.getMap(),n=$.useRef(e),[,r]=$.useState(0),i=$.useMemo(()=>e.id||`jsx-layer-${ode++}`,[]);if($.useEffect(()=>{if(t){const c=()=>r(s=>s+1);return t.on("styledata",c),c(),()=>{t.off("styledata",c),t.style&&t.style._loaded&&t.getLayer(i)&&t.removeLayer(i)}}},[t]),t&&t.style&&t.getLayer(i))try{rde(t,i,e,n.current)}catch(c){console.warn(c)}else ide(t,i,e);return n.current=e,null}const sde={"text-color":"hsl(42, 10%, 14%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},ade={"text-color":"hsl(42, 10%, 24%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},lde={"text-color":"hsl(42, 10%, 86%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},cde={"text-color":"hsl(42, 10%, 76%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},Y3={light:{water:"#b2cdfb",land:"#f8f8f8",stateBorder:"#aaa",countryBorder:"#ccc",primaryTextPaint:sde,secondaryTextPaint:ade,hiddenRoad:"#e9e9e8",footprint:"#e9e9e8",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#eeeeffcc",trainLine:"#aaa",trainLabel:"#555c",trainHalo:"#eefc",mapAreaOutline:"#999a"},dark:{water:"#36415d",land:"#1a1a1a",stateBorder:"#555",countryBorder:"#333",primaryTextPaint:lde,secondaryTextPaint:cde,hiddenRoad:"#404038",footprint:"#30302f88",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#303028cc",trainLine:"#888",trainLabel:"#eeec",trainHalo:"#303028cc",mapAreaOutline:"#777a"}};var DV={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.1/LICENSE.txt
 */(function(e,t){(function(n,r){e.exports=r()})(lP,function(){var n={},r={};function i(c,s,f){if(r[c]=f,c==="index"){var g="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",_={};return r.shared(_),r.index(n,_),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([g],{type:"text/javascript"}))),n}}i("shared",["exports"],function(c){function s(d,l,h,p){return new(h||(h=Promise))(function(y,S){function M(B){try{z(p.next(B))}catch(G){S(G)}}function R(B){try{z(p.throw(B))}catch(G){S(G)}}function z(B){var G;B.done?y(B.value):(G=B.value,G instanceof h?G:new h(function(X){X(G)})).then(M,R)}z((p=p.apply(d,l||[])).next())})}function f(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var g,_;function x(){if(_)return g;function d(l,h){this.x=l,this.y=h}return _=1,g=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(l){return this.clone()._add(l)},sub:function(l){return this.clone()._sub(l)},multByPoint:function(l){return this.clone()._multByPoint(l)},divByPoint:function(l){return this.clone()._divByPoint(l)},mult:function(l){return this.clone()._mult(l)},div:function(l){return this.clone()._div(l)},rotate:function(l){return this.clone()._rotate(l)},rotateAround:function(l,h){return this.clone()._rotateAround(l,h)},matMult:function(l){return this.clone()._matMult(l)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(l){return this.x===l.x&&this.y===l.y},dist:function(l){return Math.sqrt(this.distSqr(l))},distSqr:function(l){var h=l.x-this.x,p=l.y-this.y;return h*h+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(l){return Math.atan2(this.y-l.y,this.x-l.x)},angleWith:function(l){return this.angleWithSep(l.x,l.y)},angleWithSep:function(l,h){return Math.atan2(this.x*h-this.y*l,this.x*l+this.y*h)},_matMult:function(l){var h=l[2]*this.x+l[3]*this.y;return this.x=l[0]*this.x+l[1]*this.y,this.y=h,this},_add:function(l){return this.x+=l.x,this.y+=l.y,this},_sub:function(l){return this.x-=l.x,this.y-=l.y,this},_mult:function(l){return this.x*=l,this.y*=l,this},_div:function(l){return this.x/=l,this.y/=l,this},_multByPoint:function(l){return this.x*=l.x,this.y*=l.y,this},_divByPoint:function(l){return this.x/=l.x,this.y/=l.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var l=this.y;return this.y=this.x,this.x=-l,this},_rotate:function(l){var h=Math.cos(l),p=Math.sin(l),y=p*this.x+h*this.y;return this.x=h*this.x-p*this.y,this.y=y,this},_rotateAround:function(l,h){var p=Math.cos(l),y=Math.sin(l),S=h.y+y*(this.x-h.x)+p*(this.y-h.y);return this.x=h.x+p*(this.x-h.x)-y*(this.y-h.y),this.y=S,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(l){return l instanceof d?l:Array.isArray(l)?new d(l[0],l[1]):l},g}typeof SuppressedError=="function"&&SuppressedError;var C,E,A=f(x()),L=function(){if(E)return C;function d(l,h,p,y){this.cx=3*l,this.bx=3*(p-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(y-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=p,this.p2y=y}return E=1,C=d,d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var p=l,y=0;y<8;y++){var S=this.sampleCurveX(p)-l;if(Math.abs(S)<h)return p;var M=this.sampleCurveDerivativeX(p);if(Math.abs(M)<1e-6)break;p-=S/M}var R=0,z=1;for(p=l,y=0;y<20&&(S=this.sampleCurveX(p),!(Math.abs(S-l)<h));y++)l>S?R=p:z=p,p=.5*(z-R)+R;return p},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},C}(),I=f(L);let T,O;function D(){return T==null&&(T=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),T}function U(){if(O==null&&(O=!1,D())){const l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let p=0;p<5*5;p++){const y=4*p;l.fillStyle=`rgb(${y},${y+1},${y+2})`,l.fillRect(p%5,Math.floor(p/5),1,1)}const h=l.getImageData(0,0,5,5).data;for(let p=0;p<5*5*4;p++)if(p%4!=3&&h[p]!==p){O=!0;break}}}return O||!1}var H=1e-6,V=typeof Float32Array<"u"?Float32Array:Array;function q(){var d=new V(9);return V!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d}function Q(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}function K(){var d=new V(3);return V!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d}function N(d){return Math.hypot(d[0],d[1],d[2])}function re(d,l,h){var p=new V(3);return p[0]=d,p[1]=l,p[2]=h,p}function ye(d,l,h){return d[0]=l[0]+h[0],d[1]=l[1]+h[1],d[2]=l[2]+h[2],d}function ge(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d[2]=l[2]*h,d}function Ve(d,l,h){var p=l[0],y=l[1],S=l[2],M=h[0],R=h[1],z=h[2];return d[0]=y*z-S*R,d[1]=S*M-p*z,d[2]=p*R-y*M,d}Math.hypot||(Math.hypot=function(){for(var d=0,l=arguments.length;l--;)d+=arguments[l]*arguments[l];return Math.sqrt(d)});var Ie,ve=N;function Se(d,l,h){var p=l[0],y=l[1],S=l[2],M=l[3];return d[0]=h[0]*p+h[4]*y+h[8]*S+h[12]*M,d[1]=h[1]*p+h[5]*y+h[9]*S+h[13]*M,d[2]=h[2]*p+h[6]*y+h[10]*S+h[14]*M,d[3]=h[3]*p+h[7]*y+h[11]*S+h[15]*M,d}function Me(){var d=new V(4);return V!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d[3]=1,d}function Be(d,l,h,p){var y=.5*Math.PI/180;l*=y,h*=y,p*=y;var S=Math.sin(l),M=Math.cos(l),R=Math.sin(h),z=Math.cos(h),B=Math.sin(p),G=Math.cos(p);return d[0]=S*z*G-M*R*B,d[1]=M*R*G+S*z*B,d[2]=M*z*B-S*R*G,d[3]=M*z*G+S*R*B,d}function Qe(){var d=new V(2);return V!=Float32Array&&(d[0]=0,d[1]=0),d}function st(d,l){var h=new V(2);return h[0]=d,h[1]=l,h}K(),Ie=new V(4),V!=Float32Array&&(Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie[3]=0),K(),re(1,0,0),re(0,1,0),Me(),Me(),q(),Qe();const ct=8192;function Xt(d,l,h){return l*(ct/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}function je(d,l){return(d%l+l)%l}function lt(d,l,h){return d*(1-h)+l*h}function Ot(d){if(d<=0)return 0;if(d>=1)return 1;const l=d*d,h=l*d;return 4*(d<.5?h:3*(d-l)+h-.75)}function ut(d,l,h,p){const y=new I(d,l,h,p);return S=>y.solve(S)}const ot=ut(.25,.1,.25,1);function Tt(d,l,h){return Math.min(h,Math.max(l,d))}function Ct(d,l,h){const p=h-l,y=((d-l)%p+p)%p+l;return y===l?h:y}function un(d,...l){for(const h of l)for(const p in h)d[p]=h[p];return d}let gn=1;function hn(d,l,h){const p={};for(const y in d)p[y]=l.call(this,d[y],y,d);return p}function We(d,l,h){const p={};for(const y in d)l.call(this,d[y],y,d)&&(p[y]=d[y]);return p}function vn(d){return Array.isArray(d)?d.map(vn):typeof d=="object"&&d?hn(d,vn):d}const Ut={};function tn(d){Ut[d]||(typeof console<"u"&&console.warn(d),Ut[d]=!0)}function Dt(d,l,h){return(h.y-d.y)*(l.x-d.x)>(l.y-d.y)*(h.x-d.x)}function An(d){return typeof WorkerGlobalScope<"u"&&d!==void 0&&d instanceof WorkerGlobalScope}let an=null;function Le(d){return typeof ImageBitmap<"u"&&d instanceof ImageBitmap}const me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function it(d,l,h,p,y){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const S=new VideoFrame(d,{timestamp:0});try{const M=S==null?void 0:S.format;if(!M||!M.startsWith("BGR")&&!M.startsWith("RGB"))throw new Error(`Unrecognized format ${M}`);const R=M.startsWith("BGR"),z=new Uint8ClampedArray(p*y*4);if(yield S.copyTo(z,function(B,G,X,ie,ae){const ce=4*Math.max(-G,0),de=(Math.max(0,X)-X)*ie*4+ce,Ce=4*ie,ke=Math.max(0,G),et=Math.max(0,X);return{rect:{x:ke,y:et,width:Math.min(B.width,G+ie)-ke,height:Math.min(B.height,X+ae)-et},layout:[{offset:de,stride:Ce}]}}(d,l,h,p,y)),R)for(let B=0;B<z.length;B+=4){const G=z[B];z[B]=z[B+2],z[B+2]=G}return z}finally{S.close()}})}let St,It;function wt(d,l,h,p){return d.addEventListener(l,h,p),{unsubscribe:()=>{d.removeEventListener(l,h,p)}}}function Zt(d){return d*Math.PI/180}function Lt(d){return d/Math.PI*180}const kt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},bn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},zt="AbortError";function _e(){return new Error(zt)}const ee={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ne(d){return ee.REGISTERED_PROTOCOLS[d.substring(0,d.indexOf("://"))]}const Z="global-dispatcher";class le extends Error{constructor(l,h,p,y){super(`AJAXError: ${h} (${l}): ${p}`),this.status=l,this.statusText=h,this.url=p,this.body=y}}const Te=()=>An(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,$e=function(d,l){if(/:\/\//.test(d.url)&&!/^https?:|^file:/.test(d.url)){const p=ne(d.url);if(p)return p(d,l);if(An(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,targetMapId:Z},l)}if(!(/^file:/.test(h=d.url)||/^file:/.test(Te())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(p,y){return s(this,void 0,void 0,function*(){const S=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,cache:p.cache,referrer:Te(),signal:y.signal});let M,R;p.type!=="json"||S.headers.has("Accept")||S.headers.set("Accept","application/json");try{M=yield fetch(S)}catch(B){throw new le(0,B.message,p.url,new Blob)}if(!M.ok){const B=yield M.blob();throw new le(M.status,M.statusText,p.url,B)}R=p.type==="arrayBuffer"||p.type==="image"?M.arrayBuffer():p.type==="json"?M.json():M.text();const z=yield R;if(y.signal.aborted)throw _e();return{data:z,cacheControl:M.headers.get("Cache-Control"),expires:M.headers.get("Expires")}})}(d,l);if(An(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,mustQueue:!0,targetMapId:Z},l)}var h;return function(p,y){return new Promise((S,M)=>{var R;const z=new XMLHttpRequest;z.open(p.method||"GET",p.url,!0),p.type!=="arrayBuffer"&&p.type!=="image"||(z.responseType="arraybuffer");for(const B in p.headers)z.setRequestHeader(B,p.headers[B]);p.type==="json"&&(z.responseType="text",!((R=p.headers)===null||R===void 0)&&R.Accept||z.setRequestHeader("Accept","application/json")),z.withCredentials=p.credentials==="include",z.onerror=()=>{M(new Error(z.statusText))},z.onload=()=>{if(!y.signal.aborted)if((z.status>=200&&z.status<300||z.status===0)&&z.response!==null){let B=z.response;if(p.type==="json")try{B=JSON.parse(z.response)}catch(G){return void M(G)}S({data:B,cacheControl:z.getResponseHeader("Cache-Control"),expires:z.getResponseHeader("Expires")})}else{const B=new Blob([z.response],{type:z.getResponseHeader("Content-Type")});M(new le(z.status,z.statusText,p.url,B))}},y.signal.addEventListener("abort",()=>{z.abort(),M(_e())}),z.send(p.body)})}(d,l)};function fe(d){if(!d||d.indexOf("://")<=0||d.indexOf("data:image/")===0||d.indexOf("blob:")===0)return!0;const l=new URL(d),h=window.location;return l.protocol===h.protocol&&l.host===h.host}function xe(d,l,h){h[d]&&h[d].indexOf(l)!==-1||(h[d]=h[d]||[],h[d].push(l))}function Re(d,l,h){if(h&&h[d]){const p=h[d].indexOf(l);p!==-1&&h[d].splice(p,1)}}class De{constructor(l,h={}){un(this,h),this.type=l}}class ze extends De{constructor(l,h={}){super("error",un({error:l},h))}}class Je{on(l,h){return this._listeners=this._listeners||{},xe(l,h,this._listeners),{unsubscribe:()=>{this.off(l,h)}}}off(l,h){return Re(l,h,this._listeners),Re(l,h,this._oneTimeListeners),this}once(l,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},xe(l,h,this._oneTimeListeners),this):new Promise(p=>this.once(l,p))}fire(l,h){typeof l=="string"&&(l=new De(l,h||{}));const p=l.type;if(this.listens(p)){l.target=this;const y=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const R of y)R.call(this,l);const S=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const R of S)Re(p,R,this._oneTimeListeners),R.call(this,l);const M=this._eventedParent;M&&(un(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),M.fire(l))}else l instanceof ze&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,h){return this._eventedParent=l,this._eventedParentData=h,this}}var Oe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Et=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ft(d,l){const h={};for(const p in d)p!=="ref"&&(h[p]=d[p]);return Et.forEach(p=>{p in l&&(h[p]=l[p])}),h}function be(d,l){if(Array.isArray(d)){if(!Array.isArray(l)||d.length!==l.length)return!1;for(let h=0;h<d.length;h++)if(!be(d[h],l[h]))return!1;return!0}if(typeof d=="object"&&d!==null&&l!==null){if(typeof l!="object"||Object.keys(d).length!==Object.keys(l).length)return!1;for(const h in d)if(!be(d[h],l[h]))return!1;return!0}return d===l}function qe(d,l){d.push(l)}function tt(d,l,h){qe(h,{command:"addSource",args:[d,l[d]]})}function At(d,l,h){qe(l,{command:"removeSource",args:[d]}),h[d]=!0}function Ht(d,l,h,p){At(d,h,p),tt(d,l,h)}function Yt(d,l,h){let p;for(p in d[h])if(Object.prototype.hasOwnProperty.call(d[h],p)&&p!=="data"&&!be(d[h][p],l[h][p]))return!1;for(p in l[h])if(Object.prototype.hasOwnProperty.call(l[h],p)&&p!=="data"&&!be(d[h][p],l[h][p]))return!1;return!0}function qt(d,l,h,p,y,S){d=d||{},l=l||{};for(const M in d)Object.prototype.hasOwnProperty.call(d,M)&&(be(d[M],l[M])||h.push({command:S,args:[p,M,l[M],y]}));for(const M in l)Object.prototype.hasOwnProperty.call(l,M)&&!Object.prototype.hasOwnProperty.call(d,M)&&(be(d[M],l[M])||h.push({command:S,args:[p,M,l[M],y]}))}function Gt(d){return d.id}function yn(d,l){return d[l.id]=l,d}class gt{constructor(l,h,p,y){this.message=(l?`${l}: `:"")+p,y&&(this.identifier=y),h!=null&&h.__line__&&(this.line=h.__line__)}}function In(d,...l){for(const h of l)for(const p in h)d[p]=h[p];return d}class cn extends Error{constructor(l,h){super(h),this.message=h,this.key=l}}class Nn{constructor(l,h=[]){this.parent=l,this.bindings={};for(const[p,y]of h)this.bindings[p]=y}concat(l){return new Nn(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}const xt={kind:"null"},Ze={kind:"number"},Rt={kind:"string"},Wt={kind:"boolean"},pn={kind:"color"},cr={kind:"projectionDefinition"},qn={kind:"object"},pe={kind:"value"},nt={kind:"collator"},vt={kind:"formatted"},ft={kind:"padding"},at={kind:"colorArray"},Kt={kind:"numberArray"},fn={kind:"resolvedImage"},Qt={kind:"variableAnchorOffsetCollection"};function ln(d,l){return{kind:"array",itemType:d,N:l}}function Nt(d){if(d.kind==="array"){const l=Nt(d.itemType);return typeof d.N=="number"?`array<${l}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${l}>`}return d.kind}const zn=[xt,Ze,Rt,Wt,pn,cr,vt,qn,ln(pe),ft,Kt,at,fn,Qt];function _n(d,l){if(l.kind==="error")return null;if(d.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!_n(d.itemType,l.itemType))&&(typeof d.N!="number"||d.N===l.N))return null}else{if(d.kind===l.kind)return null;if(d.kind==="value"){for(const h of zn)if(!_n(h,l))return null}}return`Expected ${Nt(d)} but found ${Nt(l)} instead.`}function Rn(d,l){return l.some(h=>h.kind===d.kind)}function jn(d,l){return l.some(h=>h==="null"?d===null:h==="array"?Array.isArray(d):h==="object"?d&&!Array.isArray(d)&&typeof d=="object":h===typeof d)}function hr(d,l){return d.kind==="array"&&l.kind==="array"?d.itemType.kind===l.itemType.kind&&typeof d.N=="number":d.kind===l.kind}const dr=.96422,Zn=.82521,Hn=4/29,Jr=6/29,wr=3*Jr*Jr,Wo=Jr*Jr*Jr,Ms=Math.PI/180,Ao=180/Math.PI;function Dl(d){return(d%=360)<0&&(d+=360),d}function Cr([d,l,h,p]){let y,S;const M=mo((.2225045*(d=po(d))+.7168786*(l=po(l))+.0606169*(h=po(h)))/1);d===l&&l===h?y=S=M:(y=mo((.4360747*d+.3850649*l+.1430804*h)/dr),S=mo((.0139322*d+.0971045*l+.7141733*h)/Zn));const R=116*M-16;return[R<0?0:R,500*(y-M),200*(M-S),p]}function po(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function mo(d){return d>Wo?Math.pow(d,1/3):d/wr+Hn}function Ui([d,l,h,p]){let y=(d+16)/116,S=isNaN(l)?y:y+l/500,M=isNaN(h)?y:y-h/200;return y=1*zl(y),S=dr*zl(S),M=Zn*zl(M),[Ii(3.1338561*S-1.6168667*y-.4906146*M),Ii(-.9787684*S+1.9161415*y+.033454*M),Ii(.0719453*S-.2289914*y+1.4052427*M),p]}function Ii(d){return(d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055)<0?0:d>1?1:d}function zl(d){return d>Jr?d*d*d:wr*(d-Hn)}const $i=Object.hasOwn||function(d,l){return Object.prototype.hasOwnProperty.call(d,l)};function Jn(d,l){return $i(d,l)?d[l]:void 0}function rl(d){return parseInt(d.padEnd(2,d),16)/255}function il(d,l){return wc(l?d/100:d,0,1)}function wc(d,l,h){return Math.min(Math.max(l,d),h)}function Hg(d){return!d.some(Number.isNaN)}const Gg={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Cs(d,l,h){return d+h*(l-d)}function ol(d,l,h){return d.map((p,y)=>Cs(p,l[y],h))}class Qn{constructor(l,h,p,y=1,S=!0){this.r=l,this.g=h,this.b=p,this.a=y,S||(this.r*=y,this.g*=y,this.b*=y,y||this.overwriteGetter("rgb",[l,h,p,y]))}static parse(l){if(l instanceof Qn)return l;if(typeof l!="string")return;const h=function(p){if((p=p.toLowerCase().trim())==="transparent")return[0,0,0,0];const y=Jn(Gg,p);if(y){const[M,R,z]=y;return[M/255,R/255,z/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const M=p.length<6?1:2;let R=1;return[rl(p.slice(R,R+=M)),rl(p.slice(R,R+=M)),rl(p.slice(R,R+=M)),rl(p.slice(R,R+M)||"ff")]}if(p.startsWith("rgb")){const M=p.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(M){const[R,z,B,G,X,ie,ae,ce,de,Ce,ke,et]=M,Ge=[G||" ",ae||" ",Ce].join("");if(Ge==="  "||Ge==="  /"||Ge===",,"||Ge===",,,"){const se=[B,ie,de].join(""),we=se==="%%%"?100:se===""?255:0;if(we){const Xe=[wc(+z/we,0,1),wc(+X/we,0,1),wc(+ce/we,0,1),ke?il(+ke,et):1];if(Hg(Xe))return Xe}}return}}const S=p.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[M,R,z,B,G,X,ie,ae,ce]=S,de=[z||" ",G||" ",ie].join("");if(de==="  "||de==="  /"||de===",,"||de===",,,"){const Ce=[+R,wc(+B,0,100),wc(+X,0,100),ae?il(+ae,ce):1];if(Hg(Ce))return function([ke,et,Ge,se]){function we(Xe){const mt=(Xe+ke/30)%12,$t=et*Math.min(Ge,1-Ge);return Ge-$t*Math.max(-1,Math.min(mt-3,9-mt,1))}return ke=Dl(ke),et/=100,Ge/=100,[we(0),we(8),we(4),se]}(Ce)}}}(l);return h?new Qn(...h,!1):void 0}get rgb(){const{r:l,g:h,b:p,a:y}=this,S=y||1/0;return this.overwriteGetter("rgb",[l/S,h/S,p/S,y])}get hcl(){return this.overwriteGetter("hcl",function(l){const[h,p,y,S]=Cr(l),M=Math.sqrt(p*p+y*y);return[Math.round(1e4*M)?Dl(Math.atan2(y,p)*Ao):NaN,M,h,S]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Cr(this.rgb))}overwriteGetter(l,h){return Object.defineProperty(this,l,{value:h}),h}toString(){const[l,h,p,y]=this.rgb;return`rgba(${[l,h,p].map(S=>Math.round(255*S)).join(",")},${y})`}static interpolate(l,h,p,y="rgb"){switch(y){case"rgb":{const[S,M,R,z]=ol(l.rgb,h.rgb,p);return new Qn(S,M,R,z,!1)}case"hcl":{const[S,M,R,z]=l.hcl,[B,G,X,ie]=h.hcl;let ae,ce;if(isNaN(S)||isNaN(B))isNaN(S)?isNaN(B)?ae=NaN:(ae=B,R!==1&&R!==0||(ce=G)):(ae=S,X!==1&&X!==0||(ce=M));else{let Ge=B-S;B>S&&Ge>180?Ge-=360:B<S&&S-B>180&&(Ge+=360),ae=S+p*Ge}const[de,Ce,ke,et]=function([Ge,se,we,Xe]){return Ge=isNaN(Ge)?0:Ge*Ms,Ui([we,Math.cos(Ge)*se,Math.sin(Ge)*se,Xe])}([ae,ce??Cs(M,G,p),Cs(R,X,p),Cs(z,ie,p)]);return new Qn(de,Ce,ke,et,!1)}case"lab":{const[S,M,R,z]=Ui(ol(l.lab,h.lab,p));return new Qn(S,M,R,z,!1)}}}}Qn.black=new Qn(0,0,0,1),Qn.white=new Qn(1,1,1,1),Qn.transparent=new Qn(0,0,0,0),Qn.red=new Qn(1,0,0,1);class sd{constructor(l,h,p){this.sensitivity=l?h?"variant":"case":h?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,h){return this.collator.compare(l,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Gf=["bottom","center","top"];class Wg{constructor(l,h,p,y,S,M){this.text=l,this.image=h,this.scale=p,this.fontStack=y,this.textColor=S,this.verticalAlign=M}}class go{constructor(l){this.sections=l}static fromString(l){return new go([new Wg(l,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof go?l:go.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class bi{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof bi)return l;if(typeof l=="number")return new bi([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const h of l)if(typeof h!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new bi(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,p){return new bi(ol(l.values,h.values,p))}}class vo{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof vo)return l;if(typeof l=="number")return new vo([l]);if(Array.isArray(l)){for(const h of l)if(typeof h!="number")return;return new vo(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,p){return new vo(ol(l.values,h.values,p))}}class Vi{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Vi)return l;if(typeof l=="string"){const p=Qn.parse(l);return p?new Vi([p]):void 0}if(!Array.isArray(l))return;const h=[];for(const p of l){if(typeof p!="string")return;const y=Qn.parse(p);if(!y)return;h.push(y)}return new Vi(h)}toString(){return JSON.stringify(this.values)}static interpolate(l,h,p,y="rgb"){const S=[];if(l.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${l.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let M=0;M<l.values.length;M++)S.push(Qn.interpolate(l.values[M],h.values[M],p,y));return new Vi(S)}}class Qr extends Error{constructor(l){super(l),this.name="RuntimeError"}toJSON(){return this.message}}const Wf=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class sr{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof sr)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let h=0;h<l.length;h+=2){const p=l[h],y=l[h+1];if(typeof p!="string"||!Wf.has(p)||!Array.isArray(y)||y.length!==2||typeof y[0]!="number"||typeof y[1]!="number")return}return new sr(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,h,p){const y=l.values,S=h.values;if(y.length!==S.length)throw new Qr(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${h.toString()}`);const M=[];for(let R=0;R<y.length;R+=2){if(y[R]!==S[R])throw new Qr(`Cannot interpolate values containing mismatched anchors. from[${R}]: ${y[R]}, to[${R}]: ${S[R]}`);M.push(y[R]);const[z,B]=y[R+1],[G,X]=S[R+1];M.push([Cs(z,G,p),Cs(B,X,p)])}return new sr(M)}}class qo{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new qo({name:l,available:!1}):null}}class Wn{constructor(l,h,p){this.from=l,this.to=h,this.transition=p}static interpolate(l,h,p){return new Wn(l,h,p)}static parse(l){return l instanceof Wn?l:Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number"?new Wn(l[0],l[1],l[2]):typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number"?new Wn(l.from,l.to,l.transition):typeof l=="string"?new Wn(l,l,1):void 0}}function Yn(d,l,h,p){return typeof d=="number"&&d>=0&&d<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof h=="number"&&h>=0&&h<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[d,l,h,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[d,l,h,p]:[d,l,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Sc(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Wn||d instanceof Qn||d instanceof sd||d instanceof go||d instanceof bi||d instanceof vo||d instanceof Vi||d instanceof sr||d instanceof qo)return!0;if(Array.isArray(d)){for(const l of d)if(!Sc(l))return!1;return!0}if(typeof d=="object"){for(const l in d)if(!Sc(d[l]))return!1;return!0}return!1}function Gn(d){if(d===null)return xt;if(typeof d=="string")return Rt;if(typeof d=="boolean")return Wt;if(typeof d=="number")return Ze;if(d instanceof Qn)return pn;if(d instanceof Wn)return cr;if(d instanceof sd)return nt;if(d instanceof go)return vt;if(d instanceof bi)return ft;if(d instanceof vo)return Kt;if(d instanceof Vi)return at;if(d instanceof sr)return Qt;if(d instanceof qo)return fn;if(Array.isArray(d)){const l=d.length;let h;for(const p of d){const y=Gn(p);if(h){if(h===y)continue;h=pe;break}h=y}return ln(h||pe,l)}return qn}function Mc(d){const l=typeof d;return d===null?"":l==="string"||l==="number"||l==="boolean"?String(d):d instanceof Qn||d instanceof Wn||d instanceof go||d instanceof bi||d instanceof vo||d instanceof Vi||d instanceof sr||d instanceof qo?d.toString():JSON.stringify(d)}class Io{constructor(l,h){this.type=l,this.value=h}static parse(l,h){if(l.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Sc(l[1]))return h.error("invalid value");const p=l[1];let y=Gn(p);const S=h.expectedType;return y.kind!=="array"||y.N!==0||!S||S.kind!=="array"||typeof S.N=="number"&&S.N!==0||(y=S),new Io(y,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const yu={string:Rt,number:Ze,boolean:Wt,object:qn};class Xo{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let p,y=1;const S=l[0];if(S==="array"){let R,z;if(l.length>2){const B=l[1];if(typeof B!="string"||!(B in yu)||B==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);R=yu[B],y++}else R=pe;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return h.error('The length argument to "array" must be a positive integer literal',2);z=l[2],y++}p=ln(R,z)}else{if(!yu[S])throw new Error(`Types doesn't contain name = ${S}`);p=yu[S]}const M=[];for(;y<l.length;y++){const R=h.parse(l[y],y,pe);if(!R)return null;M.push(R)}return new Xo(p,M)}evaluate(l){for(let h=0;h<this.args.length;h++){const p=this.args[h].evaluate(l);if(!_n(this.type,Gn(p)))return p;if(h===this.args.length-1)throw new Qr(`Expected value to be of type ${Nt(this.type)}, but found ${Nt(Gn(p))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const qg={"to-boolean":Wt,"to-color":pn,"to-number":Ze,"to-string":Rt};class Aa{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const p=l[0];if(!qg[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&l.length!==2)return h.error("Expected one argument.");const y=qg[p],S=[];for(let M=1;M<l.length;M++){const R=h.parse(l[M],M,pe);if(!R)return null;S.push(R)}return new Aa(y,S)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let h,p;for(const y of this.args){if(h=y.evaluate(l),p=null,h instanceof Qn)return h;if(typeof h=="string"){const S=l.parseColor(h);if(S)return S}else if(Array.isArray(h)&&(p=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:Yn(h[0],h[1],h[2],h[3]),!p))return new Qn(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Qr(p||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const p of this.args){h=p.evaluate(l);const y=bi.parse(h);if(y)return y}throw new Qr(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const p of this.args){h=p.evaluate(l);const y=vo.parse(h);if(y)return y}throw new Qr(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const p of this.args){h=p.evaluate(l);const y=Vi.parse(h);if(y)return y}throw new Qr(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const p of this.args){h=p.evaluate(l);const y=sr.parse(h);if(y)return y}throw new Qr(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const p of this.args){if(h=p.evaluate(l),h===null)return 0;const y=Number(h);if(!isNaN(y))return y}throw new Qr(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return go.fromString(Mc(this.args[0].evaluate(l)));case"resolvedImage":return qo.fromString(Mc(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return Mc(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const mx=["Unknown","Point","LineString","Polygon"];class gx{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?mx[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let h=this._parseColorCache.get(l);return h||(h=Qn.parse(l),this._parseColorCache.set(l,h)),h}}class ad{constructor(l,h,p=[],y,S=new Nn,M=[]){this.registry=l,this.path=p,this.key=p.map(R=>`[${R}]`).join(""),this.scope=S,this.errors=M,this.expectedType=y,this._isConstant=h}parse(l,h,p,y,S={}){return h?this.concat(h,p,y)._parse(l,S):this._parse(l,S)}_parse(l,h){function p(y,S,M){return M==="assert"?new Xo(S,[y]):M==="coerce"?new Aa(S,[y]):y}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const y=l[0];if(typeof y!="string")return this.error(`Expression name must be a string, but found ${typeof y} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const S=this.registry[y];if(S){let M=S.parse(l,this);if(!M)return null;if(this.expectedType){const R=this.expectedType,z=M.type;if(R.kind!=="string"&&R.kind!=="number"&&R.kind!=="boolean"&&R.kind!=="object"&&R.kind!=="array"||z.kind!=="value"){if(R.kind==="projectionDefinition"&&["string","array"].includes(z.kind)||["color","formatted","resolvedImage"].includes(R.kind)&&["value","string"].includes(z.kind)||["padding","numberArray"].includes(R.kind)&&["value","number","array"].includes(z.kind)||R.kind==="colorArray"&&["value","string","array"].includes(z.kind)||R.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(z.kind))M=p(M,R,h.typeAnnotation||"coerce");else if(this.checkSubtype(R,z))return null}else M=p(M,R,h.typeAnnotation||"assert")}if(!(M instanceof Io)&&M.type.kind!=="resolvedImage"&&this._isConstant(M)){const R=new gx;try{M=new Io(M.type,M.evaluate(R))}catch(z){return this.error(z.message),null}}return M}return this.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,h,p){const y=typeof l=="number"?this.path.concat(l):this.path,S=p?this.scope.concat(p):this.scope;return new ad(this.registry,this._isConstant,y,h||null,S,this.errors)}error(l,...h){const p=`${this.key}${h.map(y=>`[${y}]`).join("")}`;this.errors.push(new cn(p,l))}checkSubtype(l,h){const p=_n(l,h);return p&&this.error(p),p}}class ld{constructor(l,h){this.type=h.type,this.bindings=[].concat(l),this.result=h}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const h of this.bindings)l(h[1]);l(this.result)}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const p=[];for(let S=1;S<l.length-1;S+=2){const M=l[S];if(typeof M!="string")return h.error(`Expected string, but found ${typeof M} instead.`,S);if(/[^a-zA-Z0-9_]/.test(M))return h.error("Variable names must contain only alphanumeric characters or '_'.",S);const R=h.parse(l[S+1],S+1);if(!R)return null;p.push([M,R])}const y=h.parse(l[l.length-1],l.length-1,h.expectedType,p);return y?new ld(p,y):null}outputDefined(){return this.result.outputDefined()}}class Ys{constructor(l,h){this.type=h.type,this.name=l,this.boundExpression=h}static parse(l,h){if(l.length!==2||typeof l[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const p=l[1];return h.scope.has(p)?new Ys(p,h.scope.get(p)):h.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class ji{constructor(l,h,p){this.type=l,this.index=h,this.input=p}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const p=h.parse(l[1],1,Ze),y=h.parse(l[2],2,ln(h.expectedType||pe));return p&&y?new ji(y.type.itemType,p,y):null}evaluate(l){const h=this.index.evaluate(l),p=this.input.evaluate(l);if(h<0)throw new Qr(`Array index out of bounds: ${h} < 0.`);if(h>=p.length)throw new Qr(`Array index out of bounds: ${h} > ${p.length-1}.`);if(h!==Math.floor(h))throw new Qr(`Array index must be an integer, but found ${h} instead.`);return p[h]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class _u{constructor(l,h){this.type=Wt,this.needle=l,this.haystack=h}static parse(l,h){if(l.length!==3)return h.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const p=h.parse(l[1],1,pe),y=h.parse(l[2],2,pe);return p&&y?Rn(p.type,[Wt,Rt,Ze,xt,pe])?new _u(p,y):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(p.type)} instead`):null}evaluate(l){const h=this.needle.evaluate(l),p=this.haystack.evaluate(l);if(!p)return!1;if(!jn(h,["boolean","string","number","null"]))throw new Qr(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(Gn(h))} instead.`);if(!jn(p,["string","array"]))throw new Qr(`Expected second argument to be of type array or string, but found ${Nt(Gn(p))} instead.`);return p.indexOf(h)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class cd{constructor(l,h,p){this.type=Ze,this.needle=l,this.haystack=h,this.fromIndex=p}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const p=h.parse(l[1],1,pe),y=h.parse(l[2],2,pe);if(!p||!y)return null;if(!Rn(p.type,[Wt,Rt,Ze,xt,pe]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(p.type)} instead`);if(l.length===4){const S=h.parse(l[3],3,Ze);return S?new cd(p,y,S):null}return new cd(p,y)}evaluate(l){const h=this.needle.evaluate(l),p=this.haystack.evaluate(l);if(!jn(h,["boolean","string","number","null"]))throw new Qr(`Expected first argument to be of type boolean, string, number or null, but found ${Nt(Gn(h))} instead.`);let y;if(this.fromIndex&&(y=this.fromIndex.evaluate(l)),jn(p,["string"])){const S=p.indexOf(h,y);return S===-1?-1:[...p.slice(0,S)].length}if(jn(p,["array"]))return p.indexOf(h,y);throw new Qr(`Expected second argument to be of type array or string, but found ${Nt(Gn(p))} instead.`)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class xu{constructor(l,h,p,y,S,M){this.inputType=l,this.type=h,this.input=p,this.cases=y,this.outputs=S,this.otherwise=M}static parse(l,h){if(l.length<5)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return h.error("Expected an even number of arguments.");let p,y;h.expectedType&&h.expectedType.kind!=="value"&&(y=h.expectedType);const S={},M=[];for(let B=2;B<l.length-1;B+=2){let G=l[B];const X=l[B+1];Array.isArray(G)||(G=[G]);const ie=h.concat(B);if(G.length===0)return ie.error("Expected at least one branch label.");for(const ce of G){if(typeof ce!="number"&&typeof ce!="string")return ie.error("Branch labels must be numbers or strings.");if(typeof ce=="number"&&Math.abs(ce)>Number.MAX_SAFE_INTEGER)return ie.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ce=="number"&&Math.floor(ce)!==ce)return ie.error("Numeric branch labels must be integer values.");if(p){if(ie.checkSubtype(p,Gn(ce)))return null}else p=Gn(ce);if(S[String(ce)]!==void 0)return ie.error("Branch labels must be unique.");S[String(ce)]=M.length}const ae=h.parse(X,B,y);if(!ae)return null;y=y||ae.type,M.push(ae)}const R=h.parse(l[1],1,pe);if(!R)return null;const z=h.parse(l[l.length-1],l.length-1,y);return z?R.type.kind!=="value"&&h.concat(1).checkSubtype(p,R.type)?null:new xu(p,y,R,S,M,z):null}evaluate(l){const h=this.input.evaluate(l);return(Gn(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class wi{constructor(l,h,p){this.type=l,this.branches=h,this.otherwise=p}static parse(l,h){if(l.length<4)return h.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return h.error("Expected an odd number of arguments.");let p;h.expectedType&&h.expectedType.kind!=="value"&&(p=h.expectedType);const y=[];for(let M=1;M<l.length-1;M+=2){const R=h.parse(l[M],M,Wt);if(!R)return null;const z=h.parse(l[M+1],M+1,p);if(!z)return null;y.push([R,z]),p=p||z.type}const S=h.parse(l[l.length-1],l.length-1,p);if(!S)return null;if(!p)throw new Error("Can't infer output type");return new wi(p,y,S)}evaluate(l){for(const[h,p]of this.branches)if(h.evaluate(l))return p.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[h,p]of this.branches)l(h),l(p);l(this.otherwise)}outputDefined(){return this.branches.every(([l,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class ud{constructor(l,h,p,y){this.type=l,this.input=h,this.beginIndex=p,this.endIndex=y}static parse(l,h){if(l.length<=2||l.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const p=h.parse(l[1],1,pe),y=h.parse(l[2],2,Ze);if(!p||!y)return null;if(!Rn(p.type,[ln(pe),Rt,pe]))return h.error(`Expected first argument to be of type array or string, but found ${Nt(p.type)} instead`);if(l.length===4){const S=h.parse(l[3],3,Ze);return S?new ud(p.type,p,y,S):null}return new ud(p.type,p,y)}evaluate(l){const h=this.input.evaluate(l),p=this.beginIndex.evaluate(l);let y;if(this.endIndex&&(y=this.endIndex.evaluate(l)),jn(h,["string"]))return[...h].slice(p,y).join("");if(jn(h,["array"]))return h.slice(p,y);throw new Qr(`Expected first argument to be of type array or string, but found ${Nt(Gn(h))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function bu(d,l){const h=d.length-1;let p,y,S=0,M=h,R=0;for(;S<=M;)if(R=Math.floor((S+M)/2),p=d[R],y=d[R+1],p<=l){if(R===h||l<y)return R;S=R+1}else{if(!(p>l))throw new Qr("Input is not a number.");M=R-1}return 0}class wu{constructor(l,h,p){this.type=l,this.input=h,this.labels=[],this.outputs=[];for(const[y,S]of p)this.labels.push(y),this.outputs.push(S)}static parse(l,h){if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");const p=h.parse(l[1],1,Ze);if(!p)return null;const y=[];let S=null;h.expectedType&&h.expectedType.kind!=="value"&&(S=h.expectedType);for(let M=1;M<l.length;M+=2){const R=M===1?-1/0:l[M],z=l[M+1],B=M,G=M+1;if(typeof R!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(y.length&&y[y.length-1][0]>=R)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',B);const X=h.parse(z,G,S);if(!X)return null;S=S||X.type,y.push([R,X])}return new wu(S,p,y)}evaluate(l){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(l);const y=this.input.evaluate(l);if(y<=h[0])return p[0].evaluate(l);const S=h.length;return y>=h[S-1]?p[S-1].evaluate(l):p[bu(h,y)].evaluate(l)}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function yC(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Ol,hd,Xg=function(){if(hd)return Ol;function d(l,h,p,y){this.cx=3*l,this.bx=3*(p-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(y-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=h,this.p2x=p,this.p2y=y}return hd=1,Ol=d,d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,h){if(h===void 0&&(h=1e-6),l<0)return 0;if(l>1)return 1;for(var p=l,y=0;y<8;y++){var S=this.sampleCurveX(p)-l;if(Math.abs(S)<h)return p;var M=this.sampleCurveDerivativeX(p);if(Math.abs(M)<1e-6)break;p-=S/M}var R=0,z=1;for(p=l,y=0;y<20&&(S=this.sampleCurveX(p),!(Math.abs(S-l)<h));y++)l>S?R=p:z=p,p=.5*(z-R)+R;return p},solve:function(l,h){return this.sampleCurveY(this.solveCurveX(l,h))}},Ol}(),_C=yC(Xg);class Ro{constructor(l,h,p,y,S){this.type=l,this.operator=h,this.interpolation=p,this.input=y,this.labels=[],this.outputs=[];for(const[M,R]of S)this.labels.push(M),this.outputs.push(R)}static interpolationFactor(l,h,p,y){let S=0;if(l.name==="exponential")S=Su(h,l.base,p,y);else if(l.name==="linear")S=Su(h,1,p,y);else if(l.name==="cubic-bezier"){const M=l.controlPoints;S=new _C(M[0],M[1],M[2],M[3]).solve(Su(h,1,p,y))}return S}static parse(l,h){let[p,y,S,...M]=l;if(!Array.isArray(y)||y.length===0)return h.error("Expected an interpolation type expression.",1);if(y[0]==="linear")y={name:"linear"};else if(y[0]==="exponential"){const B=y[1];if(typeof B!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);y={name:"exponential",base:B}}else{if(y[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(y[0])}`,1,0);{const B=y.slice(1);if(B.length!==4||B.some(G=>typeof G!="number"||G<0||G>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);y={name:"cubic-bezier",controlPoints:B}}}if(l.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(S=h.parse(S,2,Ze),!S)return null;const R=[];let z=null;p!=="interpolate-hcl"&&p!=="interpolate-lab"||h.expectedType==at?h.expectedType&&h.expectedType.kind!=="value"&&(z=h.expectedType):z=pn;for(let B=0;B<M.length;B+=2){const G=M[B],X=M[B+1],ie=B+3,ae=B+4;if(typeof G!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ie);if(R.length&&R[R.length-1][0]>=G)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ie);const ce=h.parse(X,ae,z);if(!ce)return null;z=z||ce.type,R.push([G,ce])}return hr(z,Ze)||hr(z,cr)||hr(z,pn)||hr(z,ft)||hr(z,Kt)||hr(z,at)||hr(z,Qt)||hr(z,ln(Ze))?new Ro(z,p,y,S,R):h.error(`Type ${Nt(z)} is not interpolatable.`)}evaluate(l){const h=this.labels,p=this.outputs;if(h.length===1)return p[0].evaluate(l);const y=this.input.evaluate(l);if(y<=h[0])return p[0].evaluate(l);const S=h.length;if(y>=h[S-1])return p[S-1].evaluate(l);const M=bu(h,y),R=Ro.interpolationFactor(this.interpolation,y,h[M],h[M+1]),z=p[M].evaluate(l),B=p[M+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Cs(z,B,R);case"color":return Qn.interpolate(z,B,R);case"padding":return bi.interpolate(z,B,R);case"colorArray":return Vi.interpolate(z,B,R);case"numberArray":return vo.interpolate(z,B,R);case"variableAnchorOffsetCollection":return sr.interpolate(z,B,R);case"array":return ol(z,B,R);case"projectionDefinition":return Wn.interpolate(z,B,R)}case"interpolate-hcl":switch(this.type.kind){case"color":return Qn.interpolate(z,B,R,"hcl");case"colorArray":return Vi.interpolate(z,B,R,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Qn.interpolate(z,B,R,"lab");case"colorArray":return Vi.interpolate(z,B,R,"lab")}}}eachChild(l){l(this.input);for(const h of this.outputs)l(h)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function Su(d,l,h,p){const y=p-h,S=d-h;return y===0?0:l===1?S/y:(Math.pow(l,S)-1)/(Math.pow(l,y)-1)}const cs={color:Qn.interpolate,number:Cs,padding:bi.interpolate,numberArray:vo.interpolate,colorArray:Vi.interpolate,variableAnchorOffsetCollection:sr.interpolate,array:ol};class Zo{constructor(l,h){this.type=l,this.args=h}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");let p=null;const y=h.expectedType;y&&y.kind!=="value"&&(p=y);const S=[];for(const R of l.slice(1)){const z=h.parse(R,1+S.length,p,void 0,{typeAnnotation:"omit"});if(!z)return null;p=p||z.type,S.push(z)}if(!p)throw new Error("No output type");const M=y&&S.some(R=>_n(y,R.type));return new Zo(M?pe:p,S)}evaluate(l){let h,p=null,y=0;for(const S of this.args)if(y++,p=S.evaluate(l),p&&p instanceof qo&&!p.available&&(h||(h=p.name),p=null,y===this.args.length&&(p=h)),p!==null)break;return p}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function Zg(d,l){return d==="=="||d==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function dd(d,l,h,p){return p.compare(l,h)===0}function Mu(d,l,h){const p=d!=="=="&&d!=="!=";return class zV{constructor(S,M,R){this.type=Wt,this.lhs=S,this.rhs=M,this.collator=R,this.hasUntypedArgument=S.type.kind==="value"||M.type.kind==="value"}static parse(S,M){if(S.length!==3&&S.length!==4)return M.error("Expected two or three arguments.");const R=S[0];let z=M.parse(S[1],1,pe);if(!z)return null;if(!Zg(R,z.type))return M.concat(1).error(`"${R}" comparisons are not supported for type '${Nt(z.type)}'.`);let B=M.parse(S[2],2,pe);if(!B)return null;if(!Zg(R,B.type))return M.concat(2).error(`"${R}" comparisons are not supported for type '${Nt(B.type)}'.`);if(z.type.kind!==B.type.kind&&z.type.kind!=="value"&&B.type.kind!=="value")return M.error(`Cannot compare types '${Nt(z.type)}' and '${Nt(B.type)}'.`);p&&(z.type.kind==="value"&&B.type.kind!=="value"?z=new Xo(B.type,[z]):z.type.kind!=="value"&&B.type.kind==="value"&&(B=new Xo(z.type,[B])));let G=null;if(S.length===4){if(z.type.kind!=="string"&&B.type.kind!=="string"&&z.type.kind!=="value"&&B.type.kind!=="value")return M.error("Cannot use collator to compare non-string types.");if(G=M.parse(S[3],3,nt),!G)return null}return new zV(z,B,G)}evaluate(S){const M=this.lhs.evaluate(S),R=this.rhs.evaluate(S);if(p&&this.hasUntypedArgument){const z=Gn(M),B=Gn(R);if(z.kind!==B.kind||z.kind!=="string"&&z.kind!=="number")throw new Qr(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${z.kind}, ${B.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const z=Gn(M),B=Gn(R);if(z.kind!=="string"||B.kind!=="string")return l(S,M,R)}return this.collator?h(S,M,R,this.collator.evaluate(S)):l(S,M,R)}eachChild(S){S(this.lhs),S(this.rhs),this.collator&&S(this.collator)}outputDefined(){return!0}}}const Yg=Mu("==",function(d,l,h){return l===h},dd),xC=Mu("!=",function(d,l,h){return l!==h},function(d,l,h,p){return!dd(0,l,h,p)}),bC=Mu("<",function(d,l,h){return l<h},function(d,l,h,p){return p.compare(l,h)<0}),wC=Mu(">",function(d,l,h){return l>h},function(d,l,h,p){return p.compare(l,h)>0}),SC=Mu("<=",function(d,l,h){return l<=h},function(d,l,h,p){return p.compare(l,h)<=0}),qf=Mu(">=",function(d,l,h){return l>=h},function(d,l,h,p){return p.compare(l,h)>=0});class Xf{constructor(l,h,p){this.type=nt,this.locale=p,this.caseSensitive=l,this.diacriticSensitive=h}static parse(l,h){if(l.length!==2)return h.error("Expected one argument.");const p=l[1];if(typeof p!="object"||Array.isArray(p))return h.error("Collator options argument must be an object.");const y=h.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Wt);if(!y)return null;const S=h.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Wt);if(!S)return null;let M=null;return p.locale&&(M=h.parse(p.locale,1,Rt),!M)?null:new Xf(y,S,M)}evaluate(l){return new sd(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class Zf{constructor(l,h,p,y,S){this.type=Rt,this.number=l,this.locale=h,this.currency=p,this.minFractionDigits=y,this.maxFractionDigits=S}static parse(l,h){if(l.length!==3)return h.error("Expected two arguments.");const p=h.parse(l[1],1,Ze);if(!p)return null;const y=l[2];if(typeof y!="object"||Array.isArray(y))return h.error("NumberFormat options argument must be an object.");let S=null;if(y.locale&&(S=h.parse(y.locale,1,Rt),!S))return null;let M=null;if(y.currency&&(M=h.parse(y.currency,1,Rt),!M))return null;let R=null;if(y["min-fraction-digits"]&&(R=h.parse(y["min-fraction-digits"],1,Ze),!R))return null;let z=null;return y["max-fraction-digits"]&&(z=h.parse(y["max-fraction-digits"],1,Ze),!z)?null:new Zf(p,S,M,R,z)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class fd{constructor(l){this.type=vt,this.sections=l}static parse(l,h){if(l.length<2)return h.error("Expected at least one argument.");const p=l[1];if(!Array.isArray(p)&&typeof p=="object")return h.error("First argument must be an image or text section.");const y=[];let S=!1;for(let M=1;M<=l.length-1;++M){const R=l[M];if(S&&typeof R=="object"&&!Array.isArray(R)){S=!1;let z=null;if(R["font-scale"]&&(z=h.parse(R["font-scale"],1,Ze),!z))return null;let B=null;if(R["text-font"]&&(B=h.parse(R["text-font"],1,ln(Rt)),!B))return null;let G=null;if(R["text-color"]&&(G=h.parse(R["text-color"],1,pn),!G))return null;let X=null;if(R["vertical-align"]){if(typeof R["vertical-align"]=="string"&&!Gf.includes(R["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${R["vertical-align"]}' instead.`);if(X=h.parse(R["vertical-align"],1,Rt),!X)return null}const ie=y[y.length-1];ie.scale=z,ie.font=B,ie.textColor=G,ie.verticalAlign=X}else{const z=h.parse(l[M],1,pe);if(!z)return null;const B=z.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");S=!0,y.push({content:z,scale:null,font:null,textColor:null,verticalAlign:null})}}return new fd(y)}evaluate(l){return new go(this.sections.map(h=>{const p=h.content.evaluate(l);return Gn(p)===fn?new Wg("",p,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(l):null):new Wg(Mc(p),null,h.scale?h.scale.evaluate(l):null,h.font?h.font.evaluate(l).join(","):null,h.textColor?h.textColor.evaluate(l):null,h.verticalAlign?h.verticalAlign.evaluate(l):null)}))}eachChild(l){for(const h of this.sections)l(h.content),h.scale&&l(h.scale),h.font&&l(h.font),h.textColor&&l(h.textColor),h.verticalAlign&&l(h.verticalAlign)}outputDefined(){return!1}}class Kg{constructor(l){this.type=fn,this.input=l}static parse(l,h){if(l.length!==2)return h.error("Expected two arguments.");const p=h.parse(l[1],1,Rt);return p?new Kg(p):h.error("No image name provided.")}evaluate(l){const h=this.input.evaluate(l),p=qo.fromString(h);return p&&l.availableImages&&(p.available=l.availableImages.indexOf(h)>-1),p}eachChild(l){l(this.input)}outputDefined(){return!1}}class Yf{constructor(l){this.type=Ze,this.input=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const p=h.parse(l[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Nt(p.type)} instead.`):new Yf(p):null}evaluate(l){const h=this.input.evaluate(l);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new Qr(`Expected value to be of type string or array, but found ${Nt(Gn(h))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Ia=8192;function MC(d,l){const h=(180+d[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,y=Math.pow(2,l.z);return[Math.round(h*y*Ia),Math.round(p*y*Ia)]}function Jg(d,l){const h=Math.pow(2,l.z);return[(y=(d[0]/Ia+l.x)/h,360*y-180),(p=(d[1]/Ia+l.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*p)*Math.PI/180))-90)];var p,y}function pd(d,l){d[0]=Math.min(d[0],l[0]),d[1]=Math.min(d[1],l[1]),d[2]=Math.max(d[2],l[0]),d[3]=Math.max(d[3],l[1])}function md(d,l){return!(d[0]<=l[0]||d[2]>=l[2]||d[1]<=l[1]||d[3]>=l[3])}function vx(d,l,h){const p=d[0]-l[0],y=d[1]-l[1],S=d[0]-h[0],M=d[1]-h[1];return p*M-S*y==0&&p*S<=0&&y*M<=0}function gd(d,l,h,p){return(y=[p[0]-h[0],p[1]-h[1]])[0]*(S=[l[0]-d[0],l[1]-d[1]])[1]-y[1]*S[0]!=0&&!(!Kf(d,l,h,p)||!Kf(h,p,d,l));var y,S}function yx(d,l,h){for(const p of h)for(let y=0;y<p.length-1;++y)if(gd(d,l,p[y],p[y+1]))return!0;return!1}function Cu(d,l,h=!1){let p=!1;for(const R of l)for(let z=0;z<R.length-1;z++){if(vx(d,R[z],R[z+1]))return h;(S=R[z])[1]>(y=d)[1]!=(M=R[z+1])[1]>y[1]&&y[0]<(M[0]-S[0])*(y[1]-S[1])/(M[1]-S[1])+S[0]&&(p=!p)}var y,S,M;return p}function CC(d,l){for(const h of l)if(Cu(d,h))return!0;return!1}function _x(d,l){for(const h of d)if(!Cu(h,l))return!1;for(let h=0;h<d.length-1;++h)if(yx(d[h],d[h+1],l))return!1;return!0}function EC(d,l){for(const h of l)if(_x(d,h))return!0;return!1}function Kf(d,l,h,p){const y=p[0]-h[0],S=p[1]-h[1],M=(d[0]-h[0])*S-y*(d[1]-h[1]),R=(l[0]-h[0])*S-y*(l[1]-h[1]);return M>0&&R<0||M<0&&R>0}function Qg(d,l,h){const p=[];for(let y=0;y<d.length;y++){const S=[];for(let M=0;M<d[y].length;M++){const R=MC(d[y][M],h);pd(l,R),S.push(R)}p.push(S)}return p}function xx(d,l,h){const p=[];for(let y=0;y<d.length;y++){const S=Qg(d[y],l,h);p.push(S)}return p}function bx(d,l,h,p){if(d[0]<h[0]||d[0]>h[2]){const y=.5*p;let S=d[0]-h[0]>y?-p:h[0]-d[0]>y?p:0;S===0&&(S=d[0]-h[2]>y?-p:h[2]-d[0]>y?p:0),d[0]+=S}pd(l,d)}function ev(d,l,h,p){const y=Math.pow(2,p.z)*Ia,S=[p.x*Ia,p.y*Ia],M=[];for(const R of d)for(const z of R){const B=[z.x+S[0],z.y+S[1]];bx(B,l,h,y),M.push(B)}return M}function tv(d,l,h,p){const y=Math.pow(2,p.z)*Ia,S=[p.x*Ia,p.y*Ia],M=[];for(const z of d){const B=[];for(const G of z){const X=[G.x+S[0],G.y+S[1]];pd(l,X),B.push(X)}M.push(B)}if(l[2]-l[0]<=y/2){(R=l)[0]=R[1]=1/0,R[2]=R[3]=-1/0;for(const z of M)for(const B of z)bx(B,l,h,y)}var R;return M}class Cc{constructor(l,h){this.type=Wt,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Sc(l[1])){const p=l[1];if(p.type==="FeatureCollection"){const y=[];for(const S of p.features){const{type:M,coordinates:R}=S.geometry;M==="Polygon"&&y.push(R),M==="MultiPolygon"&&y.push(...R)}if(y.length)return new Cc(p,{type:"MultiPolygon",coordinates:y})}else if(p.type==="Feature"){const y=p.geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Cc(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Cc(p,p)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(h,p){const y=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],M=h.canonicalID();if(p.type==="Polygon"){const R=Qg(p.coordinates,S,M),z=ev(h.geometry(),y,S,M);if(!md(y,S))return!1;for(const B of z)if(!Cu(B,R))return!1}if(p.type==="MultiPolygon"){const R=xx(p.coordinates,S,M),z=ev(h.geometry(),y,S,M);if(!md(y,S))return!1;for(const B of z)if(!CC(B,R))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(h,p){const y=[1/0,1/0,-1/0,-1/0],S=[1/0,1/0,-1/0,-1/0],M=h.canonicalID();if(p.type==="Polygon"){const R=Qg(p.coordinates,S,M),z=tv(h.geometry(),y,S,M);if(!md(y,S))return!1;for(const B of z)if(!_x(B,R))return!1}if(p.type==="MultiPolygon"){const R=xx(p.coordinates,S,M),z=tv(h.geometry(),y,S,M);if(!md(y,S))return!1;for(const B of z)if(!EC(B,R))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let wx=class{constructor(d=[],l=(h,p)=>h<p?-1:h>p?1:0){if(this.data=d,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(d){this.data.push(d),this._up(this.length++)}pop(){if(this.length===0)return;const d=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),d}peek(){return this.data[0]}_up(d){const{data:l,compare:h}=this,p=l[d];for(;d>0;){const y=d-1>>1,S=l[y];if(h(p,S)>=0)break;l[d]=S,d=y}l[d]=p}_down(d){const{data:l,compare:h}=this,p=this.length>>1,y=l[d];for(;d<p;){let S=1+(d<<1);const M=S+1;if(M<this.length&&h(l[M],l[S])<0&&(S=M),h(l[S],y)>=0)break;l[d]=l[S],d=S}l[d]=y}};function nv(d,l,h=0,p=d.length-1,y=TC){for(;p>h;){if(p-h>600){const z=p-h+1,B=l-h+1,G=Math.log(z),X=.5*Math.exp(2*G/3),ie=.5*Math.sqrt(G*X*(z-X)/z)*(B-z/2<0?-1:1);nv(d,l,Math.max(h,Math.floor(l-B*X/z+ie)),Math.min(p,Math.floor(l+(z-B)*X/z+ie)),y)}const S=d[l];let M=h,R=p;for(Eu(d,h,l),y(d[p],S)>0&&Eu(d,h,p);M<R;){for(Eu(d,M,R),M++,R--;y(d[M],S)<0;)M++;for(;y(d[R],S)>0;)R--}y(d[h],S)===0?Eu(d,h,R):(R++,Eu(d,R,p)),R<=l&&(h=R+1),l<=R&&(p=R-1)}}function Eu(d,l,h){const p=d[l];d[l]=d[h],d[h]=p}function TC(d,l){return d<l?-1:d>l?1:0}function Jf(d,l){if(d.length<=1)return[d];const h=[];let p,y;for(const S of d){const M=Sx(S);M!==0&&(S.area=Math.abs(M),y===void 0&&(y=M<0),y===M<0?(p&&h.push(p),p=[S]):p.push(S))}if(p&&h.push(p),l>1)for(let S=0;S<h.length;S++)h[S].length<=l||(nv(h[S],l,1,h[S].length-1,PC),h[S]=h[S].slice(0,l));return h}function PC(d,l){return l.area-d.area}function Sx(d){let l=0;for(let h,p,y=0,S=d.length,M=S-1;y<S;M=y++)h=d[y],p=d[M],l+=(p.x-h.x)*(h.y+p.y);return l}const Mx=1/298.257223563,Cx=Mx*(2-Mx),Ex=Math.PI/180;class rv{constructor(l){const h=6378.137*Ex*1e3,p=Math.cos(l*Ex),y=1/(1-Cx*(1-p*p)),S=Math.sqrt(y);this.kx=h*S*p,this.ky=h*S*y*(1-Cx)}distance(l,h){const p=this.wrap(l[0]-h[0])*this.kx,y=(l[1]-h[1])*this.ky;return Math.sqrt(p*p+y*y)}pointOnLine(l,h){let p,y,S,M,R=1/0;for(let z=0;z<l.length-1;z++){let B=l[z][0],G=l[z][1],X=this.wrap(l[z+1][0]-B)*this.kx,ie=(l[z+1][1]-G)*this.ky,ae=0;X===0&&ie===0||(ae=(this.wrap(h[0]-B)*this.kx*X+(h[1]-G)*this.ky*ie)/(X*X+ie*ie),ae>1?(B=l[z+1][0],G=l[z+1][1]):ae>0&&(B+=X/this.kx*ae,G+=ie/this.ky*ae)),X=this.wrap(h[0]-B)*this.kx,ie=(h[1]-G)*this.ky;const ce=X*X+ie*ie;ce<R&&(R=ce,p=B,y=G,S=z,M=ae)}return{point:[p,y],index:S,t:Math.max(0,Math.min(1,M))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}function Sr(d,l){return l[0]-d[0]}function Qf(d){return d[1]-d[0]+1}function sl(d,l){return d[1]>=d[0]&&d[1]<l}function iv(d,l){if(d[0]>d[1])return[null,null];const h=Qf(d);if(l){if(h===2)return[d,null];const y=Math.floor(h/2);return[[d[0],d[0]+y],[d[0]+y,d[1]]]}if(h===1)return[d,null];const p=Math.floor(h/2)-1;return[[d[0],d[0]+p],[d[0]+p+1,d[1]]]}function ov(d,l){if(!sl(l,d.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let p=l[0];p<=l[1];++p)pd(h,d[p]);return h}function sv(d){const l=[1/0,1/0,-1/0,-1/0];for(const h of d)for(const p of h)pd(l,p);return l}function Tx(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function av(d,l,h){if(!Tx(d)||!Tx(l))return NaN;let p=0,y=0;return d[2]<l[0]&&(p=l[0]-d[2]),d[0]>l[2]&&(p=d[0]-l[2]),d[1]>l[3]&&(y=d[1]-l[3]),d[3]<l[1]&&(y=l[1]-d[3]),h.distance([0,0],[p,y])}function Ec(d,l,h){const p=h.pointOnLine(l,d);return h.distance(d,p.point)}function lv(d,l,h,p,y){const S=Math.min(Ec(d,[h,p],y),Ec(l,[h,p],y)),M=Math.min(Ec(h,[d,l],y),Ec(p,[d,l],y));return Math.min(S,M)}function AC(d,l,h,p,y){if(!sl(l,d.length)||!sl(p,h.length))return 1/0;let S=1/0;for(let M=l[0];M<l[1];++M){const R=d[M],z=d[M+1];for(let B=p[0];B<p[1];++B){const G=h[B],X=h[B+1];if(gd(R,z,G,X))return 0;S=Math.min(S,lv(R,z,G,X,y))}}return S}function IC(d,l,h,p,y){if(!sl(l,d.length)||!sl(p,h.length))return NaN;let S=1/0;for(let M=l[0];M<=l[1];++M)for(let R=p[0];R<=p[1];++R)if(S=Math.min(S,y.distance(d[M],h[R])),S===0)return S;return S}function RC(d,l,h){if(Cu(d,l,!0))return 0;let p=1/0;for(const y of l){const S=y[0],M=y[y.length-1];if(S!==M&&(p=Math.min(p,Ec(d,[M,S],h)),p===0))return p;const R=h.pointOnLine(y,d);if(p=Math.min(p,h.distance(d,R.point)),p===0)return p}return p}function LC(d,l,h,p){if(!sl(l,d.length))return NaN;for(let S=l[0];S<=l[1];++S)if(Cu(d[S],h,!0))return 0;let y=1/0;for(let S=l[0];S<l[1];++S){const M=d[S],R=d[S+1];for(const z of h)for(let B=0,G=z.length,X=G-1;B<G;X=B++){const ie=z[X],ae=z[B];if(gd(M,R,ie,ae))return 0;y=Math.min(y,lv(M,R,ie,ae,p))}}return y}function Px(d,l){for(const h of d)for(const p of h)if(Cu(p,l,!0))return!0;return!1}function kC(d,l,h,p=1/0){const y=sv(d),S=sv(l);if(p!==1/0&&av(y,S,h)>=p)return p;if(md(y,S)){if(Px(d,l))return 0}else if(Px(l,d))return 0;let M=1/0;for(const R of d)for(let z=0,B=R.length,G=B-1;z<B;G=z++){const X=R[G],ie=R[z];for(const ae of l)for(let ce=0,de=ae.length,Ce=de-1;ce<de;Ce=ce++){const ke=ae[Ce],et=ae[ce];if(gd(X,ie,ke,et))return 0;M=Math.min(M,lv(X,ie,ke,et,h))}}return M}function Ax(d,l,h,p,y,S){if(!S)return;const M=av(ov(p,S),y,h);M<l&&d.push([M,S,[0,0]])}function ep(d,l,h,p,y,S,M){if(!S||!M)return;const R=av(ov(p,S),ov(y,M),h);R<l&&d.push([R,S,M])}function tp(d,l,h,p,y=1/0){let S=Math.min(p.distance(d[0],h[0][0]),y);if(S===0)return S;const M=new wx([[0,[0,d.length-1],[0,0]]],Sr),R=sv(h);for(;M.length>0;){const z=M.pop();if(z[0]>=S)continue;const B=z[1],G=l?50:100;if(Qf(B)<=G){if(!sl(B,d.length))return NaN;if(l){const X=LC(d,B,h,p);if(isNaN(X)||X===0)return X;S=Math.min(S,X)}else for(let X=B[0];X<=B[1];++X){const ie=RC(d[X],h,p);if(S=Math.min(S,ie),S===0)return 0}}else{const X=iv(B,l);Ax(M,S,p,d,R,X[0]),Ax(M,S,p,d,R,X[1])}}return S}function np(d,l,h,p,y,S=1/0){let M=Math.min(S,y.distance(d[0],h[0]));if(M===0)return M;const R=new wx([[0,[0,d.length-1],[0,h.length-1]]],Sr);for(;R.length>0;){const z=R.pop();if(z[0]>=M)continue;const B=z[1],G=z[2],X=l?50:100,ie=p?50:100;if(Qf(B)<=X&&Qf(G)<=ie){if(!sl(B,d.length)&&sl(G,h.length))return NaN;let ae;if(l&&p)ae=AC(d,B,h,G,y),M=Math.min(M,ae);else if(l&&!p){const ce=d.slice(B[0],B[1]+1);for(let de=G[0];de<=G[1];++de)if(ae=Ec(h[de],ce,y),M=Math.min(M,ae),M===0)return M}else if(!l&&p){const ce=h.slice(G[0],G[1]+1);for(let de=B[0];de<=B[1];++de)if(ae=Ec(d[de],ce,y),M=Math.min(M,ae),M===0)return M}else ae=IC(d,B,h,G,y),M=Math.min(M,ae)}else{const ae=iv(B,l),ce=iv(G,p);ep(R,M,y,d,h,ae[0],ce[0]),ep(R,M,y,d,h,ae[0],ce[1]),ep(R,M,y,d,h,ae[1],ce[0]),ep(R,M,y,d,h,ae[1],ce[1])}}return M}function cv(d){return d.type==="MultiPolygon"?d.coordinates.map(l=>({type:"Polygon",coordinates:l})):d.type==="MultiLineString"?d.coordinates.map(l=>({type:"LineString",coordinates:l})):d.type==="MultiPoint"?d.coordinates.map(l=>({type:"Point",coordinates:l})):[d]}class Tc{constructor(l,h){this.type=Ze,this.geojson=l,this.geometries=h}static parse(l,h){if(l.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Sc(l[1])){const p=l[1];if(p.type==="FeatureCollection")return new Tc(p,p.features.map(y=>cv(y.geometry)).flat());if(p.type==="Feature")return new Tc(p,cv(p.geometry));if("type"in p&&"coordinates"in p)return new Tc(p,cv(p))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(h,p){const y=h.geometry(),S=y.flat().map(z=>Jg([z.x,z.y],h.canonical));if(y.length===0)return NaN;const M=new rv(S[0][1]);let R=1/0;for(const z of p){switch(z.type){case"Point":R=Math.min(R,np(S,!1,[z.coordinates],!1,M,R));break;case"LineString":R=Math.min(R,np(S,!1,z.coordinates,!0,M,R));break;case"Polygon":R=Math.min(R,tp(S,!1,z.coordinates,M,R))}if(R===0)return R}return R}(l,this.geometries);if(l.geometryType()==="LineString")return function(h,p){const y=h.geometry(),S=y.flat().map(z=>Jg([z.x,z.y],h.canonical));if(y.length===0)return NaN;const M=new rv(S[0][1]);let R=1/0;for(const z of p){switch(z.type){case"Point":R=Math.min(R,np(S,!0,[z.coordinates],!1,M,R));break;case"LineString":R=Math.min(R,np(S,!0,z.coordinates,!0,M,R));break;case"Polygon":R=Math.min(R,tp(S,!0,z.coordinates,M,R))}if(R===0)return R}return R}(l,this.geometries);if(l.geometryType()==="Polygon")return function(h,p){const y=h.geometry();if(y.length===0||y[0].length===0)return NaN;const S=Jf(y,0).map(z=>z.map(B=>B.map(G=>Jg([G.x,G.y],h.canonical)))),M=new rv(S[0][0][0][1]);let R=1/0;for(const z of p)for(const B of S){switch(z.type){case"Point":R=Math.min(R,tp([z.coordinates],!1,B,M,R));break;case"LineString":R=Math.min(R,tp(z.coordinates,!0,B,M,R));break;case"Polygon":R=Math.min(R,kC(B,z.coordinates,M,R))}if(R===0)return R}return R}(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class vd{constructor(l){this.type=pe,this.key=l}static parse(l,h){if(l.length!==2)return h.error(`Expected 1 argument, but found ${l.length-1} instead.`);const p=l[1];return p==null?h.error("Global state property must be defined."):typeof p!="string"?h.error(`Global state property must be string, but found ${typeof l[1]} instead.`):new vd(p)}evaluate(l){var h;const p=(h=l.globals)===null||h===void 0?void 0:h.globalState;return p&&Object.keys(p).length!==0?Jn(p,this.key):null}eachChild(){}outputDefined(){return!1}}const Tu={"==":Yg,"!=":xC,">":wC,"<":bC,">=":qf,"<=":SC,array:Xo,at:ji,boolean:Xo,case:wi,coalesce:Zo,collator:Xf,format:fd,image:Kg,in:_u,"index-of":cd,interpolate:Ro,"interpolate-hcl":Ro,"interpolate-lab":Ro,length:Yf,let:ld,literal:Io,match:xu,number:Xo,"number-format":Zf,object:Xo,slice:ud,step:wu,string:Xo,"to-boolean":Aa,"to-color":Aa,"to-number":Aa,"to-string":Aa,var:Ys,within:Cc,distance:Tc,"global-state":vd};class Es{constructor(l,h,p,y){this.name=l,this.type=h,this._evaluate=p,this.args=y}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,h){const p=l[0],y=Es.definitions[p];if(!y)return h.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const S=Array.isArray(y)?y[0]:y.type,M=Array.isArray(y)?[[y[1],y[2]]]:y.overloads,R=M.filter(([B])=>!Array.isArray(B)||B.length===l.length-1);let z=null;for(const[B,G]of R){z=new ad(h.registry,rp,h.path,null,h.scope);const X=[];let ie=!1;for(let ae=1;ae<l.length;ae++){const ce=l[ae],de=Array.isArray(B)?B[ae-1]:B.type,Ce=z.parse(ce,1+X.length,de);if(!Ce){ie=!0;break}X.push(Ce)}if(!ie)if(Array.isArray(B)&&B.length!==X.length)z.error(`Expected ${B.length} arguments, but found ${X.length} instead.`);else{for(let ae=0;ae<X.length;ae++){const ce=Array.isArray(B)?B[ae]:B.type,de=X[ae];z.concat(ae+1).checkSubtype(ce,de.type)}if(z.errors.length===0)return new Es(p,S,G,X)}}if(R.length===1)h.errors.push(...z.errors);else{const B=(R.length?R:M).map(([X])=>{return ie=X,Array.isArray(ie)?`(${ie.map(Nt).join(", ")})`:`(${Nt(ie.type)}...)`;var ie}).join(" | "),G=[];for(let X=1;X<l.length;X++){const ie=h.parse(l[X],1+G.length);if(!ie)return null;G.push(Nt(ie.type))}h.error(`Expected arguments of type ${B}, but found (${G.join(", ")}) instead.`)}return null}static register(l,h){Es.definitions=h;for(const p in h)l[p]=Es}}function Ix(d,[l,h,p,y]){l=l.evaluate(d),h=h.evaluate(d),p=p.evaluate(d);const S=y?y.evaluate(d):1,M=Yn(l,h,p,S);if(M)throw new Qr(M);return new Qn(l/255,h/255,p/255,S,!1)}function Rx(d,l){return d in l}function uv(d,l){const h=l[d];return h===void 0?null:h}function Pc(d){return{type:d}}function rp(d){if(d instanceof Ys)return rp(d.boundExpression);if(d instanceof Es&&d.name==="error"||d instanceof Xf||d instanceof Cc||d instanceof Tc||d instanceof vd)return!1;const l=d instanceof Aa||d instanceof Xo;let h=!0;return d.eachChild(p=>{h=l?h&&rp(p):h&&p instanceof Io}),!!h&&ip(d)&&Pu(d,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function ip(d){if(d instanceof Es&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Cc||d instanceof Tc)return!1;let l=!0;return d.eachChild(h=>{l&&!ip(h)&&(l=!1)}),l}function yd(d){if(d instanceof Es&&d.name==="feature-state")return!1;let l=!0;return d.eachChild(h=>{l&&!yd(h)&&(l=!1)}),l}function Pu(d,l){if(d instanceof Es&&l.indexOf(d.name)>=0)return!1;let h=!0;return d.eachChild(p=>{h&&!Pu(p,l)&&(h=!1)}),h}function Lx(d){return{result:"success",value:d}}function Au(d){return{result:"error",value:d}}function Iu(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function hv(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function dv(d){return!!d.expression&&d.expression.interpolated}function er(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function Ac(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)&&Gn(d)===qn}function kx(d){return d}function Dx(d,l){const h=d.stops&&typeof d.stops[0][0]=="object",p=h||!(h||d.property!==void 0),y=d.type||(dv(l)?"exponential":"interval"),S=function(G){switch(G.type){case"color":return Qn.parse;case"padding":return bi.parse;case"numberArray":return vo.parse;case"colorArray":return Vi.parse;default:return null}}(l);if(S&&((d=In({},d)).stops&&(d.stops=d.stops.map(G=>[G[0],S(G[1])])),d.default=S(d.default?d.default:l.default)),d.colorSpace&&(M=d.colorSpace)!=="rgb"&&M!=="hcl"&&M!=="lab")throw new Error(`Unknown color space: "${d.colorSpace}"`);var M;const R=function(G){switch(G){case"exponential":return zx;case"interval":return zC;case"categorical":return DC;case"identity":return Ox;default:throw new Error(`Unknown function type "${G}"`)}}(y);let z,B;if(y==="categorical"){z=Object.create(null);for(const G of d.stops)z[G[0]]=G[1];B=typeof d.stops[0][0]}if(h){const G={},X=[];for(let ce=0;ce<d.stops.length;ce++){const de=d.stops[ce],Ce=de[0].zoom;G[Ce]===void 0&&(G[Ce]={zoom:Ce,type:d.type,property:d.property,default:d.default,stops:[]},X.push(Ce)),G[Ce].stops.push([de[0].value,de[1]])}const ie=[];for(const ce of X)ie.push([G[ce].zoom,Dx(G[ce],l)]);const ae={name:"linear"};return{kind:"composite",interpolationType:ae,interpolationFactor:Ro.interpolationFactor.bind(void 0,ae),zoomStops:ie.map(ce=>ce[0]),evaluate:({zoom:ce},de)=>zx({stops:ie,base:d.base},l,ce).evaluate(ce,de)}}if(p){const G=y==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:G,interpolationFactor:Ro.interpolationFactor.bind(void 0,G),zoomStops:d.stops.map(X=>X[0]),evaluate:({zoom:X})=>R(d,l,X,z,B)}}return{kind:"source",evaluate(G,X){const ie=X&&X.properties?X.properties[d.property]:void 0;return ie===void 0?_d(d.default,l.default):R(d,l,ie,z,B)}}}function _d(d,l,h){return d!==void 0?d:l!==void 0?l:h!==void 0?h:void 0}function DC(d,l,h,p,y){return _d(typeof h===y?p[h]:void 0,d.default,l.default)}function zC(d,l,h){if(er(h)!=="number")return _d(d.default,l.default);const p=d.stops.length;if(p===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[p-1][0])return d.stops[p-1][1];const y=bu(d.stops.map(S=>S[0]),h);return d.stops[y][1]}function zx(d,l,h){const p=d.base!==void 0?d.base:1;if(er(h)!=="number")return _d(d.default,l.default);const y=d.stops.length;if(y===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[y-1][0])return d.stops[y-1][1];const S=bu(d.stops.map(G=>G[0]),h),M=function(G,X,ie,ae){const ce=ae-ie,de=G-ie;return ce===0?0:X===1?de/ce:(Math.pow(X,de)-1)/(Math.pow(X,ce)-1)}(h,p,d.stops[S][0],d.stops[S+1][0]),R=d.stops[S][1],z=d.stops[S+1][1],B=cs[l.type]||kx;return typeof R.evaluate=="function"?{evaluate(...G){const X=R.evaluate.apply(void 0,G),ie=z.evaluate.apply(void 0,G);if(X!==void 0&&ie!==void 0)return B(X,ie,M,d.colorSpace)}}:B(R,z,M,d.colorSpace)}function Ox(d,l,h){switch(l.type){case"color":h=Qn.parse(h);break;case"formatted":h=go.fromString(h.toString());break;case"resolvedImage":h=qo.fromString(h.toString());break;case"padding":h=bi.parse(h);break;case"colorArray":h=Vi.parse(h);break;case"numberArray":h=vo.parse(h);break;default:er(h)===l.type||l.type==="enum"&&l.values[h]||(h=void 0)}return _d(h,d.default,l.default)}Es.register(Tu,{error:[{kind:"error"},[Rt],(d,[l])=>{throw new Qr(l.evaluate(d))}],typeof:[Rt,[pe],(d,[l])=>Nt(Gn(l.evaluate(d)))],"to-rgba":[ln(Ze,4),[pn],(d,[l])=>{const[h,p,y,S]=l.evaluate(d).rgb;return[255*h,255*p,255*y,S]}],rgb:[pn,[Ze,Ze,Ze],Ix],rgba:[pn,[Ze,Ze,Ze,Ze],Ix],has:{type:Wt,overloads:[[[Rt],(d,[l])=>Rx(l.evaluate(d),d.properties())],[[Rt,qn],(d,[l,h])=>Rx(l.evaluate(d),h.evaluate(d))]]},get:{type:pe,overloads:[[[Rt],(d,[l])=>uv(l.evaluate(d),d.properties())],[[Rt,qn],(d,[l,h])=>uv(l.evaluate(d),h.evaluate(d))]]},"feature-state":[pe,[Rt],(d,[l])=>uv(l.evaluate(d),d.featureState||{})],properties:[qn,[],d=>d.properties()],"geometry-type":[Rt,[],d=>d.geometryType()],id:[pe,[],d=>d.id()],zoom:[Ze,[],d=>d.globals.zoom],"heatmap-density":[Ze,[],d=>d.globals.heatmapDensity||0],elevation:[Ze,[],d=>d.globals.elevation||0],"line-progress":[Ze,[],d=>d.globals.lineProgress||0],accumulated:[pe,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[Ze,Pc(Ze),(d,l)=>{let h=0;for(const p of l)h+=p.evaluate(d);return h}],"*":[Ze,Pc(Ze),(d,l)=>{let h=1;for(const p of l)h*=p.evaluate(d);return h}],"-":{type:Ze,overloads:[[[Ze,Ze],(d,[l,h])=>l.evaluate(d)-h.evaluate(d)],[[Ze],(d,[l])=>-l.evaluate(d)]]},"/":[Ze,[Ze,Ze],(d,[l,h])=>l.evaluate(d)/h.evaluate(d)],"%":[Ze,[Ze,Ze],(d,[l,h])=>l.evaluate(d)%h.evaluate(d)],ln2:[Ze,[],()=>Math.LN2],pi:[Ze,[],()=>Math.PI],e:[Ze,[],()=>Math.E],"^":[Ze,[Ze,Ze],(d,[l,h])=>Math.pow(l.evaluate(d),h.evaluate(d))],sqrt:[Ze,[Ze],(d,[l])=>Math.sqrt(l.evaluate(d))],log10:[Ze,[Ze],(d,[l])=>Math.log(l.evaluate(d))/Math.LN10],ln:[Ze,[Ze],(d,[l])=>Math.log(l.evaluate(d))],log2:[Ze,[Ze],(d,[l])=>Math.log(l.evaluate(d))/Math.LN2],sin:[Ze,[Ze],(d,[l])=>Math.sin(l.evaluate(d))],cos:[Ze,[Ze],(d,[l])=>Math.cos(l.evaluate(d))],tan:[Ze,[Ze],(d,[l])=>Math.tan(l.evaluate(d))],asin:[Ze,[Ze],(d,[l])=>Math.asin(l.evaluate(d))],acos:[Ze,[Ze],(d,[l])=>Math.acos(l.evaluate(d))],atan:[Ze,[Ze],(d,[l])=>Math.atan(l.evaluate(d))],min:[Ze,Pc(Ze),(d,l)=>Math.min(...l.map(h=>h.evaluate(d)))],max:[Ze,Pc(Ze),(d,l)=>Math.max(...l.map(h=>h.evaluate(d)))],abs:[Ze,[Ze],(d,[l])=>Math.abs(l.evaluate(d))],round:[Ze,[Ze],(d,[l])=>{const h=l.evaluate(d);return h<0?-Math.round(-h):Math.round(h)}],floor:[Ze,[Ze],(d,[l])=>Math.floor(l.evaluate(d))],ceil:[Ze,[Ze],(d,[l])=>Math.ceil(l.evaluate(d))],"filter-==":[Wt,[Rt,pe],(d,[l,h])=>d.properties()[l.value]===h.value],"filter-id-==":[Wt,[pe],(d,[l])=>d.id()===l.value],"filter-type-==":[Wt,[Rt],(d,[l])=>d.geometryType()===l.value],"filter-<":[Wt,[Rt,pe],(d,[l,h])=>{const p=d.properties()[l.value],y=h.value;return typeof p==typeof y&&p<y}],"filter-id-<":[Wt,[pe],(d,[l])=>{const h=d.id(),p=l.value;return typeof h==typeof p&&h<p}],"filter->":[Wt,[Rt,pe],(d,[l,h])=>{const p=d.properties()[l.value],y=h.value;return typeof p==typeof y&&p>y}],"filter-id->":[Wt,[pe],(d,[l])=>{const h=d.id(),p=l.value;return typeof h==typeof p&&h>p}],"filter-<=":[Wt,[Rt,pe],(d,[l,h])=>{const p=d.properties()[l.value],y=h.value;return typeof p==typeof y&&p<=y}],"filter-id-<=":[Wt,[pe],(d,[l])=>{const h=d.id(),p=l.value;return typeof h==typeof p&&h<=p}],"filter->=":[Wt,[Rt,pe],(d,[l,h])=>{const p=d.properties()[l.value],y=h.value;return typeof p==typeof y&&p>=y}],"filter-id->=":[Wt,[pe],(d,[l])=>{const h=d.id(),p=l.value;return typeof h==typeof p&&h>=p}],"filter-has":[Wt,[pe],(d,[l])=>l.value in d.properties()],"filter-has-id":[Wt,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[Wt,[ln(Rt)],(d,[l])=>l.value.indexOf(d.geometryType())>=0],"filter-id-in":[Wt,[ln(pe)],(d,[l])=>l.value.indexOf(d.id())>=0],"filter-in-small":[Wt,[Rt,ln(pe)],(d,[l,h])=>h.value.indexOf(d.properties()[l.value])>=0],"filter-in-large":[Wt,[Rt,ln(pe)],(d,[l,h])=>function(p,y,S,M){for(;S<=M;){const R=S+M>>1;if(y[R]===p)return!0;y[R]>p?M=R-1:S=R+1}return!1}(d.properties()[l.value],h.value,0,h.value.length-1)],all:{type:Wt,overloads:[[[Wt,Wt],(d,[l,h])=>l.evaluate(d)&&h.evaluate(d)],[Pc(Wt),(d,l)=>{for(const h of l)if(!h.evaluate(d))return!1;return!0}]]},any:{type:Wt,overloads:[[[Wt,Wt],(d,[l,h])=>l.evaluate(d)||h.evaluate(d)],[Pc(Wt),(d,l)=>{for(const h of l)if(h.evaluate(d))return!0;return!1}]]},"!":[Wt,[Wt],(d,[l])=>!l.evaluate(d)],"is-supported-script":[Wt,[Rt],(d,[l])=>{const h=d.globals&&d.globals.isSupportedScript;return!h||h(l.evaluate(d))}],upcase:[Rt,[Rt],(d,[l])=>l.evaluate(d).toUpperCase()],downcase:[Rt,[Rt],(d,[l])=>l.evaluate(d).toLowerCase()],concat:[Rt,Pc(pe),(d,l)=>l.map(h=>Mc(h.evaluate(d))).join("")],"resolved-locale":[Rt,[nt],(d,[l])=>l.evaluate(d).resolvedLocale()]});class op{constructor(l,h){this.expression=l,this._warningHistory={},this._evaluator=new gx,this._defaultValue=h?function(p){if(p.type==="color"&&Ac(p.default))return new Qn(0,0,0,0);switch(p.type){case"color":return Qn.parse(p.default)||null;case"padding":return bi.parse(p.default)||null;case"numberArray":return vo.parse(p.default)||null;case"colorArray":return Vi.parse(p.default)||null;case"variableAnchorOffsetCollection":return sr.parse(p.default)||null;case"projectionDefinition":return Wn.parse(p.default)||null;default:return p.default===void 0?null:p.default}}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(l,h,p,y,S,M){return this._evaluator.globals=l,this._evaluator.feature=h,this._evaluator.featureState=p,this._evaluator.canonical=y,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=M,this.expression.evaluate(this._evaluator)}evaluate(l,h,p,y,S,M){this._evaluator.globals=l,this._evaluator.feature=h||null,this._evaluator.featureState=p||null,this._evaluator.canonical=y,this._evaluator.availableImages=S||null,this._evaluator.formattedSection=M||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new Qr(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(R.message)),this._defaultValue}}}function sp(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in Tu}function ap(d,l){const h=new ad(Tu,rp,[],l?function(y){const S={color:pn,string:Rt,number:Ze,enum:Rt,boolean:Wt,formatted:vt,padding:ft,numberArray:Kt,colorArray:at,projectionDefinition:cr,resolvedImage:fn,variableAnchorOffsetCollection:Qt};return y.type==="array"?ln(S[y.value]||pe,y.length):S[y.type]}(l):void 0),p=h.parse(d,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Lx(new op(p,l)):Au(h.errors)}class xd{constructor(l,h){this.kind=l,this._styleExpression=h,this.isStateDependent=l!=="constant"&&!yd(h.expression),this.globalStateRefs=Lu(h.expression)}evaluateWithoutErrorHandling(l,h,p,y,S,M){return this._styleExpression.evaluateWithoutErrorHandling(l,h,p,y,S,M)}evaluate(l,h,p,y,S,M){return this._styleExpression.evaluate(l,h,p,y,S,M)}}class lp{constructor(l,h,p,y){this.kind=l,this.zoomStops=p,this._styleExpression=h,this.isStateDependent=l!=="camera"&&!yd(h.expression),this.globalStateRefs=Lu(h.expression),this.interpolationType=y}evaluateWithoutErrorHandling(l,h,p,y,S,M){return this._styleExpression.evaluateWithoutErrorHandling(l,h,p,y,S,M)}evaluate(l,h,p,y,S,M){return this._styleExpression.evaluate(l,h,p,y,S,M)}interpolationFactor(l,h,p){return this.interpolationType?Ro.interpolationFactor(this.interpolationType,l,h,p):0}}function fv(d,l){const h=ap(d,l);if(h.result==="error")return h;const p=h.value.expression,y=ip(p);if(!y&&!Iu(l))return Au([new cn("","data expressions not supported")]);const S=Pu(p,["zoom"]);if(!S&&!hv(l))return Au([new cn("","zoom expressions not supported")]);const M=Ru(p);return M||S?M instanceof cn?Au([M]):M instanceof Ro&&!dv(l)?Au([new cn("",'"interpolate" expressions cannot be used with this property')]):Lx(M?new lp(y?"camera":"composite",h.value,M.labels,M instanceof Ro?M.interpolation:void 0):new xd(y?"constant":"source",h.value)):Au([new cn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class bd{constructor(l,h){this._parameters=l,this._specification=h,In(this,Dx(this._parameters,this._specification))}static deserialize(l){return new bd(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Ru(d){let l=null;if(d instanceof ld)l=Ru(d.result);else if(d instanceof Zo){for(const h of d.args)if(l=Ru(h),l)break}else(d instanceof wu||d instanceof Ro)&&d.input instanceof Es&&d.input.name==="zoom"&&(l=d);return l instanceof cn||d.eachChild(h=>{const p=Ru(h);p instanceof cn?l=p:!l&&p?l=new cn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&p&&l!==p&&(l=new cn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function Lu(d,l=new Set){return d instanceof vd&&l.add(d.key),d.eachChild(h=>{Lu(h,l)}),l}function wd(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const l of d.slice(1))if(!wd(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}const pv={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fl(d){if(d==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};wd(d)||(d=cp(d));const l=ap(d,pv);if(l.result==="error")throw new Error(l.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,p,y)=>l.value.evaluate(h,p,{},y),needGeometry:Fx(d),getGlobalStateRefs:()=>Lu(l.value.expression)}}function OC(d,l){return d<l?-1:d>l?1:0}function Fx(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let l=1;l<d.length;l++)if(Fx(d[l]))return!0;return!1}function cp(d){if(!d)return!0;const l=d[0];return d.length<=1?l!=="any":l==="=="?mv(d[1],d[2],"=="):l==="!="?Sd(mv(d[1],d[2],"==")):l==="<"||l===">"||l==="<="||l===">="?mv(d[1],d[2],l):l==="any"?(h=d.slice(1),["any"].concat(h.map(cp))):l==="all"?["all"].concat(d.slice(1).map(cp)):l==="none"?["all"].concat(d.slice(1).map(cp).map(Sd)):l==="in"?Nx(d[1],d.slice(2)):l==="!in"?Sd(Nx(d[1],d.slice(2))):l==="has"?Bx(d[1]):l!=="!has"||Sd(Bx(d[1]));var h}function mv(d,l,h){switch(d){case"$type":return[`filter-type-${h}`,l];case"$id":return[`filter-id-${h}`,l];default:return[`filter-${h}`,d,l]}}function Nx(d,l){if(l.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(h=>typeof h!=typeof l[0])?["filter-in-large",d,["literal",l.sort(OC)]]:["filter-in-small",d,["literal",l]]}}function Bx(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function Sd(d){return["!",d]}function up(d){const l=typeof d;if(l==="number"||l==="boolean"||l==="string"||d==null)return JSON.stringify(d);if(Array.isArray(d)){let y="[";for(const S of d)y+=`${up(S)},`;return`${y}]`}const h=Object.keys(d).sort();let p="{";for(let y=0;y<h.length;y++)p+=`${JSON.stringify(h[y])}:${up(d[h[y]])},`;return`${p}}`}function hp(d){let l="";for(const h of Et)l+=`/${up(d[h])}`;return l}function Ux(d){const l=d.value;return l?[new gt(d.key,l,"constants have been deprecated as of v8")]:[]}function oi(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Nl(d){if(Array.isArray(d))return d.map(Nl);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const l={};for(const h in d)l[h]=Nl(d[h]);return l}return oi(d)}function Ts(d){const l=d.key,h=d.value,p=d.valueSpec||{},y=d.objectElementValidators||{},S=d.style,M=d.styleSpec,R=d.validateSpec;let z=[];const B=er(h);if(B!=="object")return[new gt(l,h,`object expected, ${B} found`)];for(const G in h){const X=G.split(".")[0],ie=Jn(p,X)||p["*"];let ae;if(Jn(y,X))ae=y[X];else if(Jn(p,X))ae=R;else if(y["*"])ae=y["*"];else{if(!p["*"]){z.push(new gt(l,h[G],`unknown property "${G}"`));continue}ae=R}z=z.concat(ae({key:(l&&`${l}.`)+G,value:h[G],valueSpec:ie,style:S,styleSpec:M,object:h,objectKey:G,validateSpec:R},h))}for(const G in p)y[G]||p[G].required&&p[G].default===void 0&&h[G]===void 0&&z.push(new gt(l,h,`missing required property "${G}"`));return z}function dp(d){const l=d.value,h=d.valueSpec,p=d.style,y=d.styleSpec,S=d.key,M=d.arrayElementValidator||d.validateSpec;if(er(l)!=="array")return[new gt(S,l,`array expected, ${er(l)} found`)];if(h.length&&l.length!==h.length)return[new gt(S,l,`array length ${h.length} expected, length ${l.length} found`)];if(h["min-length"]&&l.length<h["min-length"])return[new gt(S,l,`array length at least ${h["min-length"]} expected, length ${l.length} found`)];let R={type:h.value,values:h.values};y.$version<7&&(R.function=h.function),er(h.value)==="object"&&(R=h.value);let z=[];for(let B=0;B<l.length;B++)z=z.concat(M({array:l,arrayIndex:B,value:l[B],valueSpec:R,validateSpec:d.validateSpec,style:p,styleSpec:y,key:`${S}[${B}]`}));return z}function Md(d){const l=d.key,h=d.value,p=d.valueSpec;let y=er(h);return y==="number"&&h!=h&&(y="NaN"),y!=="number"?[new gt(l,h,`number expected, ${y} found`)]:"minimum"in p&&h<p.minimum?[new gt(l,h,`${h} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&h>p.maximum?[new gt(l,h,`${h} is greater than the maximum value ${p.maximum}`)]:[]}function ku(d){const l=d.valueSpec,h=oi(d.value.type);let p,y,S,M={};const R=h!=="categorical"&&d.value.property===void 0,z=!R,B=er(d.value.stops)==="array"&&er(d.value.stops[0])==="array"&&er(d.value.stops[0][0])==="object",G=Ts({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(ae){if(h==="identity")return[new gt(ae.key,ae.value,'identity function may not have a "stops" property')];let ce=[];const de=ae.value;return ce=ce.concat(dp({key:ae.key,value:de,valueSpec:ae.valueSpec,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,arrayElementValidator:X})),er(de)==="array"&&de.length===0&&ce.push(new gt(ae.key,de,"array must have at least one stop")),ce},default:function(ae){return ae.validateSpec({key:ae.key,value:ae.value,valueSpec:l,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec})}}});return h==="identity"&&R&&G.push(new gt(d.key,d.value,'missing required property "property"')),h==="identity"||d.value.stops||G.push(new gt(d.key,d.value,'missing required property "stops"')),h==="exponential"&&d.valueSpec.expression&&!dv(d.valueSpec)&&G.push(new gt(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(z&&!Iu(d.valueSpec)?G.push(new gt(d.key,d.value,"property functions not supported")):R&&!hv(d.valueSpec)&&G.push(new gt(d.key,d.value,"zoom functions not supported"))),h!=="categorical"&&!B||d.value.property!==void 0||G.push(new gt(d.key,d.value,'"property" property is required')),G;function X(ae){let ce=[];const de=ae.value,Ce=ae.key;if(er(de)!=="array")return[new gt(Ce,de,`array expected, ${er(de)} found`)];if(de.length!==2)return[new gt(Ce,de,`array length 2 expected, length ${de.length} found`)];if(B){if(er(de[0])!=="object")return[new gt(Ce,de,`object expected, ${er(de[0])} found`)];if(de[0].zoom===void 0)return[new gt(Ce,de,"object stop key must have zoom")];if(de[0].value===void 0)return[new gt(Ce,de,"object stop key must have value")];if(S&&S>oi(de[0].zoom))return[new gt(Ce,de[0].zoom,"stop zoom values must appear in ascending order")];oi(de[0].zoom)!==S&&(S=oi(de[0].zoom),y=void 0,M={}),ce=ce.concat(Ts({key:`${Ce}[0]`,value:de[0],valueSpec:{zoom:{}},validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec,objectElementValidators:{zoom:Md,value:ie}}))}else ce=ce.concat(ie({key:`${Ce}[0]`,value:de[0],validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec},de));return sp(Nl(de[1]))?ce.concat([new gt(`${Ce}[1]`,de[1],"expressions are not allowed in function stops.")]):ce.concat(ae.validateSpec({key:`${Ce}[1]`,value:de[1],valueSpec:l,validateSpec:ae.validateSpec,style:ae.style,styleSpec:ae.styleSpec}))}function ie(ae,ce){const de=er(ae.value),Ce=oi(ae.value),ke=ae.value!==null?ae.value:ce;if(p){if(de!==p)return[new gt(ae.key,ke,`${de} stop domain type must match previous stop domain type ${p}`)]}else p=de;if(de!=="number"&&de!=="string"&&de!=="boolean")return[new gt(ae.key,ke,"stop domain value must be a number, string, or boolean")];if(de!=="number"&&h!=="categorical"){let et=`number expected, ${de} found`;return Iu(l)&&h===void 0&&(et+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new gt(ae.key,ke,et)]}return h!=="categorical"||de!=="number"||isFinite(Ce)&&Math.floor(Ce)===Ce?h!=="categorical"&&de==="number"&&y!==void 0&&Ce<y?[new gt(ae.key,ke,"stop domain values must appear in ascending order")]:(y=Ce,h==="categorical"&&Ce in M?[new gt(ae.key,ke,"stop domain values must be unique")]:(M[Ce]=!0,[])):[new gt(ae.key,ke,`integer expected, found ${Ce}`)]}}function Du(d){const l=(d.expressionContext==="property"?fv:ap)(Nl(d.value),d.valueSpec);if(l.result==="error")return l.value.map(p=>new gt(`${d.key}${p.key}`,d.value,p.message));const h=l.value.expression||l.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!h.outputDefined())return[new gt(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!yd(h))return[new gt(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!yd(h))return[new gt(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!Pu(h,["zoom","feature-state"]))return[new gt(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!ip(h))return[new gt(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gv(d){const l=d.key,h=d.value,p=er(h);return p!=="string"?[new gt(l,h,`color expected, ${p} found`)]:Qn.parse(String(h))?[]:[new gt(l,h,`color expected, "${h}" found`)]}function Cd(d){const l=d.key,h=d.value,p=d.valueSpec,y=[];return Array.isArray(p.values)?p.values.indexOf(oi(h))===-1&&y.push(new gt(l,h,`expected one of [${p.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(p.values).indexOf(oi(h))===-1&&y.push(new gt(l,h,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(h)} found`)),y}function vv(d){return wd(Nl(d.value))?Du(In({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):$x(d)}function $x(d){const l=d.value,h=d.key;if(er(l)!=="array")return[new gt(h,l,`array expected, ${er(l)} found`)];const p=d.styleSpec;let y,S=[];if(l.length<1)return[new gt(h,l,"filter array must have at least 1 element")];switch(S=S.concat(Cd({key:`${h}[0]`,value:l[0],valueSpec:p.filter_operator,style:d.style,styleSpec:d.styleSpec})),oi(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&oi(l[1])==="$type"&&S.push(new gt(h,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&S.push(new gt(h,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(y=er(l[1]),y!=="string"&&S.push(new gt(`${h}[1]`,l[1],`string expected, ${y} found`)));for(let M=2;M<l.length;M++)y=er(l[M]),oi(l[1])==="$type"?S=S.concat(Cd({key:`${h}[${M}]`,value:l[M],valueSpec:p.geometry_type,style:d.style,styleSpec:d.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&S.push(new gt(`${h}[${M}]`,l[M],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let M=1;M<l.length;M++)S=S.concat($x({key:`${h}[${M}]`,value:l[M],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":y=er(l[1]),l.length!==2?S.push(new gt(h,l,`filter array for "${l[0]}" operator must have 2 elements`)):y!=="string"&&S.push(new gt(`${h}[1]`,l[1],`string expected, ${y} found`))}return S}function Vx(d,l){const h=d.key,p=d.validateSpec,y=d.style,S=d.styleSpec,M=d.value,R=d.objectKey,z=S[`${l}_${d.layerType}`];if(!z)return[];const B=R.match(/^(.*)-transition$/);if(l==="paint"&&B&&z[B[1]]&&z[B[1]].transition)return p({key:h,value:M,valueSpec:S.transition,style:y,styleSpec:S});const G=d.valueSpec||z[R];if(!G)return[new gt(h,M,`unknown property "${R}"`)];let X;if(er(M)==="string"&&Iu(G)&&!G.tokens&&(X=/^{([^}]+)}$/.exec(M)))return[new gt(h,M,`"${R}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(X[1])} }\`.`)];const ie=[];return d.layerType==="symbol"&&(R==="text-field"&&y&&!y.glyphs&&ie.push(new gt(h,M,'use of "text-field" requires a style "glyphs" property')),R==="text-font"&&Ac(Nl(M))&&oi(M.type)==="identity"&&ie.push(new gt(h,M,'"text-font" does not support identity functions'))),ie.concat(p({key:d.key,value:M,valueSpec:G,style:y,styleSpec:S,expressionContext:"property",propertyType:l,propertyKey:R}))}function zu(d){return Vx(d,"paint")}function Ou(d){return Vx(d,"layout")}function Yo(d){let l=[];const h=d.value,p=d.key,y=d.style,S=d.styleSpec;if(er(h)!=="object")return[new gt(p,h,`object expected, ${er(h)} found`)];h.type||h.ref||l.push(new gt(p,h,'either "type" or "ref" is required'));let M=oi(h.type);const R=oi(h.ref);if(h.id){const z=oi(h.id);for(let B=0;B<d.arrayIndex;B++){const G=y.layers[B];oi(G.id)===z&&l.push(new gt(p,h.id,`duplicate layer id "${h.id}", previously used at line ${G.id.__line__}`))}}if("ref"in h){let z;["type","source","source-layer","filter","layout"].forEach(B=>{B in h&&l.push(new gt(p,h[B],`"${B}" is prohibited for ref layers`))}),y.layers.forEach(B=>{oi(B.id)===R&&(z=B)}),z?z.ref?l.push(new gt(p,h.ref,"ref cannot reference another ref layer")):M=oi(z.type):l.push(new gt(p,h.ref,`ref layer "${R}" not found`))}else if(M!=="background")if(h.source){const z=y.sources&&y.sources[h.source],B=z&&oi(z.type);z?B==="vector"&&M==="raster"?l.push(new gt(p,h.source,`layer "${h.id}" requires a raster source`)):B!=="raster-dem"&&M==="hillshade"||B!=="raster-dem"&&M==="color-relief"?l.push(new gt(p,h.source,`layer "${h.id}" requires a raster-dem source`)):B==="raster"&&M!=="raster"?l.push(new gt(p,h.source,`layer "${h.id}" requires a vector source`)):B!=="vector"||h["source-layer"]?B==="raster-dem"&&M!=="hillshade"&&M!=="color-relief"?l.push(new gt(p,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):M!=="line"||!h.paint||!h.paint["line-gradient"]||B==="geojson"&&z.lineMetrics||l.push(new gt(p,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new gt(p,h,`layer "${h.id}" must specify a "source-layer"`)):l.push(new gt(p,h.source,`source "${h.source}" not found`))}else l.push(new gt(p,h,'missing required property "source"'));return l=l.concat(Ts({key:p,value:h,valueSpec:S.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*":()=>[],type:()=>d.validateSpec({key:`${p}.type`,value:h.type,valueSpec:S.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:h,objectKey:"type"}),filter:vv,layout:z=>Ts({layer:h,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":B=>Ou(In({layerType:M},B))}}),paint:z=>Ts({layer:h,key:z.key,value:z.value,style:z.style,styleSpec:z.styleSpec,validateSpec:z.validateSpec,objectElementValidators:{"*":B=>zu(In({layerType:M},B))}})}})),l}function Ks(d){const l=d.value,h=d.key,p=er(l);return p!=="string"?[new gt(h,l,`string expected, ${p} found`)]:[]}const yv={promoteId:function({key:d,value:l}){if(er(l)==="string")return Ks({key:d,value:l});{const h=[];for(const p in l)h.push(...Ks({key:`${d}.${p}`,value:l[p]}));return h}}};function jx(d){const l=d.value,h=d.key,p=d.styleSpec,y=d.style,S=d.validateSpec;if(!l.type)return[new gt(h,l,'"type" is required')];const M=oi(l.type);let R;switch(M){case"vector":case"raster":return R=Ts({key:h,value:l,valueSpec:p[`source_${M.replace("-","_")}`],style:d.style,styleSpec:p,objectElementValidators:yv,validateSpec:S}),R;case"raster-dem":return R=function(z){var B;const G=(B=z.sourceName)!==null&&B!==void 0?B:"",X=z.value,ie=z.styleSpec,ae=ie.source_raster_dem,ce=z.style;let de=[];const Ce=er(X);if(X===void 0)return de;if(Ce!=="object")return de.push(new gt("source_raster_dem",X,`object expected, ${Ce} found`)),de;const ke=oi(X.encoding)==="custom",et=["redFactor","greenFactor","blueFactor","baseShift"],Ge=z.value.encoding?`"${z.value.encoding}"`:"Default";for(const se in X)!ke&&et.includes(se)?de.push(new gt(se,X[se],`In "${G}": "${se}" is only valid when "encoding" is set to "custom". ${Ge} encoding found`)):ae[se]?de=de.concat(z.validateSpec({key:se,value:X[se],valueSpec:ae[se],validateSpec:z.validateSpec,style:ce,styleSpec:ie})):de.push(new gt(se,X[se],`unknown property "${se}"`));return de}({sourceName:h,value:l,style:d.style,styleSpec:p,validateSpec:S}),R;case"geojson":if(R=Ts({key:h,value:l,valueSpec:p.source_geojson,style:y,styleSpec:p,validateSpec:S,objectElementValidators:yv}),l.cluster)for(const z in l.clusterProperties){const[B,G]=l.clusterProperties[z],X=typeof B=="string"?[B,["accumulated"],["get",z]]:B;R.push(...Du({key:`${h}.${z}.map`,value:G,expressionContext:"cluster-map"})),R.push(...Du({key:`${h}.${z}.reduce`,value:X,expressionContext:"cluster-reduce"}))}return R;case"video":return Ts({key:h,value:l,valueSpec:p.source_video,style:y,validateSpec:S,styleSpec:p});case"image":return Ts({key:h,value:l,valueSpec:p.source_image,style:y,validateSpec:S,styleSpec:p});case"canvas":return[new gt(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Cd({key:`${h}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Hx(d){const l=d.value,h=d.styleSpec,p=h.light,y=d.style;let S=[];const M=er(l);if(l===void 0)return S;if(M!=="object")return S=S.concat([new gt("light",l,`object expected, ${M} found`)]),S;for(const R in l){const z=R.match(/^(.*)-transition$/);S=S.concat(z&&p[z[1]]&&p[z[1]].transition?d.validateSpec({key:R,value:l[R],valueSpec:h.transition,validateSpec:d.validateSpec,style:y,styleSpec:h}):p[R]?d.validateSpec({key:R,value:l[R],valueSpec:p[R],validateSpec:d.validateSpec,style:y,styleSpec:h}):[new gt(R,l[R],`unknown property "${R}"`)])}return S}function Fu(d){const l=d.value,h=d.styleSpec,p=h.sky,y=d.style,S=er(l);if(l===void 0)return[];if(S!=="object")return[new gt("sky",l,`object expected, ${S} found`)];let M=[];for(const R in l)M=M.concat(p[R]?d.validateSpec({key:R,value:l[R],valueSpec:p[R],style:y,styleSpec:h}):[new gt(R,l[R],`unknown property "${R}"`)]);return M}function _v(d){const l=d.value,h=d.styleSpec,p=h.terrain,y=d.style;let S=[];const M=er(l);if(l===void 0)return S;if(M!=="object")return S=S.concat([new gt("terrain",l,`object expected, ${M} found`)]),S;for(const R in l)S=S.concat(p[R]?d.validateSpec({key:R,value:l[R],valueSpec:p[R],validateSpec:d.validateSpec,style:y,styleSpec:h}):[new gt(R,l[R],`unknown property "${R}"`)]);return S}function fp(d){let l=[];const h=d.value,p=d.key;if(Array.isArray(h)){const y=[],S=[];for(const M in h)h[M].id&&y.includes(h[M].id)&&l.push(new gt(p,h,`all the sprites' ids must be unique, but ${h[M].id} is duplicated`)),y.push(h[M].id),h[M].url&&S.includes(h[M].url)&&l.push(new gt(p,h,`all the sprites' URLs must be unique, but ${h[M].url} is duplicated`)),S.push(h[M].url),l=l.concat(Ts({key:`${p}[${M}]`,value:h[M],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:d.validateSpec}));return l}return Ks({key:p,value:h})}function Gx(d){return l=d.value,l&&l.constructor===Object?[]:[new gt(d.key,d.value,`object expected, ${er(d.value)} found`)];var l}const pp={"*":()=>[],array:dp,boolean:function(d){const l=d.value,h=d.key,p=er(l);return p!=="boolean"?[new gt(h,l,`boolean expected, ${p} found`)]:[]},number:Md,color:gv,constants:Ux,enum:Cd,filter:vv,function:ku,layer:Yo,object:Ts,source:jx,light:Hx,sky:Fu,terrain:_v,projection:function(d){const l=d.value,h=d.styleSpec,p=h.projection,y=d.style,S=er(l);if(l===void 0)return[];if(S!=="object")return[new gt("projection",l,`object expected, ${S} found`)];let M=[];for(const R in l)M=M.concat(p[R]?d.validateSpec({key:R,value:l[R],valueSpec:p[R],style:y,styleSpec:h}):[new gt(R,l[R],`unknown property "${R}"`)]);return M},projectionDefinition:function(d){const l=d.key;let h=d.value;h=h instanceof String?h.valueOf():h;const p=er(h);return p!=="array"||function(y){return Array.isArray(y)&&y.length===3&&typeof y[0]=="string"&&typeof y[1]=="string"&&typeof y[2]=="number"}(h)||function(y){return!!["interpolate","step","literal"].includes(y[0])}(h)?["array","string"].includes(p)?[]:[new gt(l,h,`projection expected, invalid type "${p}" found`)]:[new gt(l,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:Ks,formatted:function(d){return Ks(d).length===0?[]:Du(d)},resolvedImage:function(d){return Ks(d).length===0?[]:Du(d)},padding:function(d){const l=d.key,h=d.value;if(er(h)==="array"){if(h.length<1||h.length>4)return[new gt(l,h,`padding requires 1 to 4 values; ${h.length} values found`)];const p={type:"number"};let y=[];for(let S=0;S<h.length;S++)y=y.concat(d.validateSpec({key:`${l}[${S}]`,value:h[S],validateSpec:d.validateSpec,valueSpec:p}));return y}return Md({key:l,value:h,valueSpec:{}})},numberArray:function(d){const l=d.key,h=d.value;if(er(h)==="array"){const p={type:"number"};if(h.length<1)return[new gt(l,h,"array length at least 1 expected, length 0 found")];let y=[];for(let S=0;S<h.length;S++)y=y.concat(d.validateSpec({key:`${l}[${S}]`,value:h[S],validateSpec:d.validateSpec,valueSpec:p}));return y}return Md({key:l,value:h,valueSpec:{}})},colorArray:function(d){const l=d.key,h=d.value;if(er(h)==="array"){if(h.length<1)return[new gt(l,h,"array length at least 1 expected, length 0 found")];let p=[];for(let y=0;y<h.length;y++)p=p.concat(gv({key:`${l}[${y}]`,value:h[y]}));return p}return gv({key:l,value:h})},variableAnchorOffsetCollection:function(d){const l=d.key,h=d.value,p=er(h),y=d.styleSpec;if(p!=="array"||h.length<1||h.length%2!=0)return[new gt(l,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let S=[];for(let M=0;M<h.length;M+=2)S=S.concat(Cd({key:`${l}[${M}]`,value:h[M],valueSpec:y.layout_symbol["text-anchor"]})),S=S.concat(dp({key:`${l}[${M+1}]`,value:h[M+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:y}));return S},sprite:fp,state:Gx};function mp(d){const l=d.value,h=d.valueSpec,p=d.styleSpec;return d.validateSpec=mp,h.expression&&Ac(oi(l))?ku(d):h.expression&&sp(Nl(l))?Du(d):h.type&&pp[h.type]?pp[h.type](d):Ts(In({},d,{valueSpec:h.type?p[h.type]:h}))}function Nu(d){const l=d.value,h=d.key,p=Ks(d);return p.length||(l.indexOf("{fontstack}")===-1&&p.push(new gt(h,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&p.push(new gt(h,l,'"glyphs" url must include a "{range}" token'))),p}function Ps(d,l=Oe){let h=[];return h=h.concat(mp({key:"",value:d,valueSpec:l.$root,styleSpec:l,style:d,validateSpec:mp,objectElementValidators:{glyphs:Nu,"*":()=>[]}})),d.constants&&(h=h.concat(Ux({key:"constants",value:d.constants}))),Wx(h)}function Js(d){return function(l){return d({...l,validateSpec:mp})}}function Wx(d){return[].concat(d).sort((l,h)=>l.line-h.line)}function Lo(d){return function(...l){return Wx(d.apply(this,l))}}Ps.source=Lo(Js(jx)),Ps.sprite=Lo(Js(fp)),Ps.glyphs=Lo(Js(Nu)),Ps.light=Lo(Js(Hx)),Ps.sky=Lo(Js(Fu)),Ps.terrain=Lo(Js(_v)),Ps.state=Lo(Js(Gx)),Ps.layer=Lo(Js(Yo)),Ps.filter=Lo(Js(vv)),Ps.paintProperty=Lo(Js(zu)),Ps.layoutProperty=Lo(Js(Ou));const Bu=Ps,FC=Bu.light,gp=Bu.sky,NC=Bu.paintProperty,xv=Bu.layoutProperty;function Ed(d,l){let h=!1;if(l&&l.length)for(const p of l)d.fire(new ze(new Error(p.message))),h=!0;return h}class Uu{constructor(l,h,p){const y=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;const M=new Int32Array(this.arrayBuffer);l=M[0],this.d=(h=M[1])+2*(p=M[2]);for(let z=0;z<this.d*this.d;z++){const B=M[3+z],G=M[3+z+1];y.push(B===G?null:M.subarray(B,G))}const R=M[3+y.length+1];this.keys=M.subarray(M[3+y.length],R),this.bboxes=M.subarray(R),this.insert=this._insertReadonly}else{this.d=h+2*p;for(let M=0;M<this.d*this.d;M++)y.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=l,this.padding=p,this.scale=h/l,this.uid=0;const S=p/h*l;this.min=-S,this.max=l+S}insert(l,h,p,y,S){this._forEachCell(h,p,y,S,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(h),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(S)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,h,p,y,S,M){this.cells[S].push(M)}query(l,h,p,y,S){const M=this.min,R=this.max;if(l<=M&&h<=M&&R<=p&&R<=y&&!S)return Array.prototype.slice.call(this.keys);{const z=[];return this._forEachCell(l,h,p,y,this._queryCell,z,{},S),z}}_queryCell(l,h,p,y,S,M,R,z){const B=this.cells[S];if(B!==null){const G=this.keys,X=this.bboxes;for(let ie=0;ie<B.length;ie++){const ae=B[ie];if(R[ae]===void 0){const ce=4*ae;(z?z(X[ce+0],X[ce+1],X[ce+2],X[ce+3]):l<=X[ce+2]&&h<=X[ce+3]&&p>=X[ce+0]&&y>=X[ce+1])?(R[ae]=!0,M.push(G[ae])):R[ae]=!1}}}}_forEachCell(l,h,p,y,S,M,R,z){const B=this._convertToCellCoord(l),G=this._convertToCellCoord(h),X=this._convertToCellCoord(p),ie=this._convertToCellCoord(y);for(let ae=B;ae<=X;ae++)for(let ce=G;ce<=ie;ce++){const de=this.d*ce+ae;if((!z||z(this._convertFromCellCoord(ae),this._convertFromCellCoord(ce),this._convertFromCellCoord(ae+1),this._convertFromCellCoord(ce+1)))&&S.call(this,l,h,p,y,de,M,R,z))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const l=this.cells,h=3+this.cells.length+1+1;let p=0;for(let M=0;M<this.cells.length;M++)p+=this.cells[M].length;const y=new Int32Array(h+p+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;let S=h;for(let M=0;M<l.length;M++){const R=l[M];y[3+M]=S,y.set(R,S),S+=R.length}return y[3+l.length]=S,y.set(this.keys,S),S+=this.keys.length,y[3+l.length+1]=S,y.set(this.bboxes,S),S+=this.bboxes.length,y.buffer}static serialize(l,h){const p=l.toArrayBuffer();return h&&h.push(p),{buffer:p}}static deserialize(l){return new Uu(l.buffer)}}const Ra={};function xn(d,l,h={}){if(Ra[d])throw new Error(`${d} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:d,writeable:!1}),Ra[d]={klass:l,omit:h.omit||[],shallow:h.shallow||[]}}xn("Object",Object),xn("Set",Set),xn("TransferableGridIndex",Uu),xn("Color",Qn),xn("Error",Error),xn("AJAXError",le),xn("ResolvedImage",qo),xn("StylePropertyFunction",bd),xn("StyleExpression",op,{omit:["_evaluator"]}),xn("ZoomDependentExpression",lp),xn("ZoomConstantExpression",xd),xn("CompoundExpression",Es,{omit:["_evaluate"]});for(const d in Tu)Tu[d]._classRegistryKey||xn(`Expression_${d}`,Tu[d]);function bv(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function Td(d){return d.$name||d.constructor._classRegistryKey}function wv(d){return!function(l){if(l===null||typeof l!="object")return!1;const h=Td(l);return!(!h||h==="Object")}(d)&&(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||d instanceof Blob||d instanceof Error||bv(d)||Le(d)||ArrayBuffer.isView(d)||d instanceof ImageData)}function Pd(d,l){if(wv(d))return(bv(d)||Le(d))&&l&&l.push(d),ArrayBuffer.isView(d)&&l&&l.push(d.buffer),d instanceof ImageData&&l&&l.push(d.data.buffer),d;if(Array.isArray(d)){const S=[];for(const M of d)S.push(Pd(M,l));return S}if(typeof d!="object")throw new Error("can't serialize object of type "+typeof d);const h=Td(d);if(!h)throw new Error(`can't serialize object of unregistered class ${d.constructor.name}`);if(!Ra[h])throw new Error(`${h} is not registered.`);const{klass:p}=Ra[h],y=p.serialize?p.serialize(d,l):{};if(p.serialize){if(l&&y===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const S in d){if(!d.hasOwnProperty(S)||Ra[h].omit.indexOf(S)>=0)continue;const M=d[S];y[S]=Ra[h].shallow.indexOf(S)>=0?M:Pd(M,l)}d instanceof Error&&(y.message=d.message)}if(y.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(y.$name=h),y}function $u(d){if(wv(d))return d;if(Array.isArray(d))return d.map($u);if(typeof d!="object")throw new Error("can't deserialize object of type "+typeof d);const l=Td(d)||"Object";if(!Ra[l])throw new Error(`can't deserialize unregistered class ${l}`);const{klass:h}=Ra[l];if(!h)throw new Error(`can't deserialize unregistered class ${l}`);if(h.deserialize)return h.deserialize(d);const p=Object.create(h.prototype);for(const y of Object.keys(d)){if(y==="$name")continue;const S=d[y];p[y]=Ra[l].shallow.indexOf(y)>=0?S:$u(S)}return p}class Sv{constructor(){this.first=!0}update(l,h){const p=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=h),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=p,!0))}}const tr={"Latin-1 Supplement":d=>d>=128&&d<=255,"Hangul Jamo":d=>d>=4352&&d<=4607,Khmer:d=>d>=6016&&d<=6143,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Kanbun:d=>d>=12688&&d<=12703,"CJK Strokes":d=>d>=12736&&d<=12783,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Hangul Syllables":d=>d>=44032&&d<=55215,"Private Use Area":d=>d>=57344&&d<=63743,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519};function Mv(d){for(const l of d)if(yp(l.charCodeAt(0)))return!0;return!1}function qx(d){for(const l of d)if(!UC(l.charCodeAt(0)))return!1;return!0}function vp(d){const l=d.map(h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}}).filter(h=>h);return new RegExp(l.join("|"),"u")}const BC=vp(["Arab","Dupl","Mong","Ougr","Syrc"]);function UC(d){return!BC.test(String.fromCodePoint(d))}const Cv=vp(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function yp(d){return!(d!==746&&d!==747&&(d<4352||!(tr["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||tr["CJK Compatibility"](d)||tr["CJK Strokes"](d)||!(!tr["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||tr["Enclosed CJK Letters and Months"](d)||tr["Ideographic Description Characters"](d)||tr.Kanbun(d)||tr.Katakana(d)&&d!==12540||!(!tr["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!tr["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||tr["Vertical Forms"](d)||tr["Yijing Hexagram Symbols"](d)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(d))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(d))||Cv.test(String.fromCodePoint(d)))))}function Ev(d){return!(yp(d)||function(l){return!!(tr["Latin-1 Supplement"](l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||tr["General Punctuation"](l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||tr["Letterlike Symbols"](l)||tr["Number Forms"](l)||tr["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||tr["Control Pictures"](l)&&l!==9251||tr["Optical Character Recognition"](l)||tr["Enclosed Alphanumerics"](l)||tr["Geometric Shapes"](l)||tr["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||tr["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||tr["CJK Symbols and Punctuation"](l)||tr.Katakana(l)||tr["Private Use Area"](l)||tr["CJK Compatibility Forms"](l)||tr["Small Form Variants"](l)||tr["Halfwidth and Fullwidth Forms"](l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(d))}const Xx=vp(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Ad(d){return Xx.test(String.fromCodePoint(d))}function $C(d,l){return!(!l&&Ad(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||tr.Khmer(d))}function Tv(d){for(const l of d)if(Ad(l.charCodeAt(0)))return!0;return!1}const Bl=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(d){this.pluginStatus=d.pluginStatus,this.pluginURL=d.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(d){if(Bl.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=d.applyArabicShaping,this.processBidirectionalText=d.processBidirectionalText,this.processStyledBidirectionalText=d.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(d,l){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(d.pluginStatus!=="loading")return this.setState(d),d;const h=d.pluginURL,p=new Promise(S=>{this.loadScriptResolve=S});l(h);const y=new Promise(S=>setTimeout(()=>S(),this.TIMEOUT));if(yield Promise.race([p,y]),this.isParsed()){const S={pluginStatus:"loaded",pluginURL:h};return this.setState(S),S}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)})}};class Xr{constructor(l,h){this.zoom=l,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new Sv,this.transition=h.transition||{},this.globalState=h.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Sv,this.transition={},this.globalState={})}isSupportedScript(l){return function(h,p){for(const y of h)if(!$C(y.charCodeAt(0),p))return!1;return!0}(l,Bl.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const l=this.zoom,h=l-Math.floor(l),p=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*h}}}class Id{constructor(l,h){this.property=l,this.value=h,this.expression=function(p,y){if(Ac(p))return new bd(p,y);if(sp(p)){const S=fv(p,y);if(S.result==="error")throw new Error(S.value.map(M=>`${M.key}: ${M.message}`).join(", "));return S.value}{let S=p;return y.type==="color"&&typeof p=="string"?S=Qn.parse(p):y.type!=="padding"||typeof p!="number"&&!Array.isArray(p)?y.type!=="numberArray"||typeof p!="number"&&!Array.isArray(p)?y.type!=="colorArray"||typeof p!="string"&&!Array.isArray(p)?y.type==="variableAnchorOffsetCollection"&&Array.isArray(p)?S=sr.parse(p):y.type==="projectionDefinition"&&typeof p=="string"&&(S=Wn.parse(p)):S=Vi.parse(p):S=vo.parse(p):S=bi.parse(p),{globalStateRefs:new Set,kind:"constant",evaluate:()=>S}}}(h===void 0?l.specification.default:h,l.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(l,h,p){return this.property.possiblyEvaluate(this,l,h,p)}}class _p{constructor(l){this.property=l,this.value=new Id(l,void 0)}transitioned(l,h){return new Zx(this.property,this.value,h,un({},l.transition,this.transition),l.now)}untransitioned(){return new Zx(this.property,this.value,null,{},0)}}class Pv{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues)}getValue(l){return vn(this._values[l].value.value)}setValue(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new _p(this._values[l].property)),this._values[l].value=new Id(this._values[l].property,h===null?void 0:vn(h))}getTransition(l){return vn(this._values[l].transition)}setTransition(l,h){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new _p(this._values[l].property)),this._values[l].transition=vn(h)||void 0}serialize(){const l={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(l[h]=p);const y=this.getTransition(h);y!==void 0&&(l[`${h}-transition`]=y)}return l}transitioned(l,h){const p=new Yx(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].transitioned(l,h._values[y]);return p}untransitioned(){const l=new Yx(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].untransitioned();return l}}class Zx{constructor(l,h,p,y,S){this.property=l,this.value=h,this.begin=S+y.delay||0,this.end=this.begin+y.duration||0,l.specification.transition&&(y.delay||y.duration)&&(this.prior=p)}possiblyEvaluate(l,h,p){const y=l.now||0,S=this.value.possiblyEvaluate(l,h,p),M=this.prior;if(M){if(y>this.end)return this.prior=null,S;if(this.value.isDataDriven())return this.prior=null,S;if(y<this.begin)return M.possiblyEvaluate(l,h,p);{const R=(y-this.begin)/(this.end-this.begin);return this.property.interpolate(M.possiblyEvaluate(l,h,p),S,Ot(R))}}return S}}class Yx{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,h,p){const y=new xp(this._properties);for(const S of Object.keys(this._values))y._values[S]=this._values[S].possiblyEvaluate(l,h,p);return y}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class VC{constructor(l){this._properties=l,this._values=Object.create(l.defaultPropertyValues)}hasValue(l){return this._values[l].value!==void 0}getValue(l){return vn(this._values[l].value)}setValue(l,h){this._values[l]=new Id(this._values[l].property,h===null?void 0:vn(h))}serialize(){const l={};for(const h of Object.keys(this._values)){const p=this.getValue(h);p!==void 0&&(l[h]=p)}return l}possiblyEvaluate(l,h,p){const y=new xp(this._properties);for(const S of Object.keys(this._values))y._values[S]=this._values[S].possiblyEvaluate(l,h,p);return y}}class La{constructor(l,h,p){this.property=l,this.value=h,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,h,p,y){return this.property.evaluate(this.value,this.parameters,l,h,p,y)}}class xp{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class En{constructor(l){this.specification=l}possiblyEvaluate(l,h){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(h)}interpolate(l,h,p){const y=cs[this.specification.type];return y?y(l,h,p):l}}class Vn{constructor(l,h){this.specification=l,this.overrides=h}possiblyEvaluate(l,h,p,y){return new La(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(h,null,{},p,y)}:l.expression,h)}interpolate(l,h,p){if(l.value.kind!=="constant"||h.value.kind!=="constant")return l;if(l.value.value===void 0||h.value.value===void 0)return new La(this,{kind:"constant",value:void 0},l.parameters);const y=cs[this.specification.type];if(y){const S=y(l.value.value,h.value.value,p);return new La(this,{kind:"constant",value:S},l.parameters)}return l}evaluate(l,h,p,y,S,M){return l.kind==="constant"?l.value:l.evaluate(h,p,y,S,M)}}class bp extends Vn{possiblyEvaluate(l,h,p,y){if(l.value===void 0)return new La(this,{kind:"constant",value:void 0},h);if(l.expression.kind==="constant"){const S=l.expression.evaluate(h,null,{},p,y),M=l.property.specification.type==="resolvedImage"&&typeof S!="string"?S.name:S,R=this._calculate(M,M,M,h);return new La(this,{kind:"constant",value:R},h)}if(l.expression.kind==="camera"){const S=this._calculate(l.expression.evaluate({zoom:h.zoom-1}),l.expression.evaluate({zoom:h.zoom}),l.expression.evaluate({zoom:h.zoom+1}),h);return new La(this,{kind:"constant",value:S},h)}return new La(this,l.expression,h)}evaluate(l,h,p,y,S,M){if(l.kind==="source"){const R=l.evaluate(h,p,y,S,M);return this._calculate(R,R,R,h)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(h.zoom)-1},p,y),l.evaluate({zoom:Math.floor(h.zoom)},p,y),l.evaluate({zoom:Math.floor(h.zoom)+1},p,y),h):l.value}_calculate(l,h,p,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:p,to:h}}interpolate(l){return l}}class Av{constructor(l){this.specification=l}possiblyEvaluate(l,h,p,y){if(l.value!==void 0){if(l.expression.kind==="constant"){const S=l.expression.evaluate(h,null,{},p,y);return this._calculate(S,S,S,h)}return this._calculate(l.expression.evaluate(new Xr(Math.floor(h.zoom-1),h)),l.expression.evaluate(new Xr(Math.floor(h.zoom),h)),l.expression.evaluate(new Xr(Math.floor(h.zoom+1),h)),h)}}_calculate(l,h,p,y){return y.zoom>y.zoomHistory.lastIntegerZoom?{from:l,to:h}:{from:p,to:h}}interpolate(l){return l}}class Rd{constructor(l){this.specification=l}possiblyEvaluate(l,h,p,y){return!!l.expression.evaluate(h,null,{},p,y)}interpolate(){return!1}}class ko{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in l){const p=l[h];p.specification.overridable&&this.overridableProperties.push(h);const y=this.defaultPropertyValues[h]=new Id(p,void 0),S=this.defaultTransitionablePropertyValues[h]=new _p(p);this.defaultTransitioningPropertyValues[h]=S.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=y.possiblyEvaluate({})}}}xn("DataDrivenProperty",Vn),xn("DataConstantProperty",En),xn("CrossFadedDataDrivenProperty",bp),xn("CrossFadedProperty",Av),xn("ColorRampProperty",Rd);const Kx="-transition";class eo extends Je{constructor(l,h){if(super(),this.id=l.id,this.type=l.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter,this._featureFilter=Fl(l.filter)),h.layout&&(this._unevaluatedLayout=new VC(h.layout)),h.paint)){this._transitionablePaint=new Pv(h.paint);for(const p in l.paint)this.setPaintProperty(p,l.paint[p],{validate:!1});for(const p in l.layout)this.setLayoutProperty(p,l.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xp(h.paint)}}setFilter(l){this.filter=l,this._featureFilter=Fl(l)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}getLayoutAffectingGlobalStateRefs(){const l=new Set;if(this._unevaluatedLayout)for(const h in this._unevaluatedLayout._values){const p=this._unevaluatedLayout._values[h];for(const y of p.getGlobalStateRefs())l.add(y)}for(const h of this._featureFilter.getGlobalStateRefs())l.add(h);return l}setLayoutProperty(l,h,p={}){h!=null&&this._validate(xv,`layers.${this.id}.layout.${l}`,l,h,p)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,h):this.visibility=h)}getPaintProperty(l){return l.endsWith(Kx)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,h,p={}){if(h!=null&&this._validate(NC,`layers.${this.id}.paint.${l}`,l,h,p))return!1;if(l.endsWith(Kx))return this._transitionablePaint.setTransition(l.slice(0,-11),h||void 0),!1;{const y=this._transitionablePaint._values[l],S=y.property.specification["property-type"]==="cross-faded-data-driven",M=y.value.isDataDriven(),R=y.value;this._transitionablePaint.setValue(l,h),this._handleSpecialPaintPropertyUpdate(l);const z=this._transitionablePaint._values[l].value;return z.isDataDriven()||M||S||this._handleOverridablePaintPropertyUpdate(l,R,z)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,h,p){return!1}isHidden(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(l,h){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,h)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),We(l,(h,p)=>!(h===void 0||p==="layout"&&!Object.keys(h).length||p==="paint"&&!Object.keys(h).length))}_validate(l,h,p,y,S={}){return(!S||S.validate!==!1)&&Ed(this,l.call(Bu,{key:h,layerType:this.type,objectKey:p,value:y,styleSpec:Oe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const h=this.paint.get(l);if(h instanceof La&&Iu(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const Jx={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ic{constructor(l,h){this._structArray=l,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,h){return l._trim(),h&&(l.isTransferred=!0,h.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const h=Object.create(this.prototype);return h.arrayBuffer=l.arrayBuffer,h.length=l.length,h.capacity=l.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function si(d,l=1){let h=0,p=0;return{members:d.map(y=>{const S=Jx[y.type].BYTES_PER_ELEMENT,M=h=Qx(h,Math.max(l,S)),R=y.components||1;return p=Math.max(p,S),h+=S*R,{name:y.name,type:y.type,components:R,offset:M}}),size:Qx(h,Math.max(p,l)),alignment:l}}function Qx(d,l){return Math.ceil(d/l)*l}class Ul extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h){const p=this.length;return this.resize(p+1),this.emplace(p,l,h)}emplace(l,h,p){const y=2*l;return this.int16[y+0]=h,this.int16[y+1]=p,l}}Ul.prototype.bytesPerElement=4,xn("StructArrayLayout2i4",Ul);class $l extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=3*l;return this.int16[S+0]=h,this.int16[S+1]=p,this.int16[S+2]=y,l}}$l.prototype.bytesPerElement=6,xn("StructArrayLayout3i6",$l);class Iv extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,p,y)}emplace(l,h,p,y,S){const M=4*l;return this.int16[M+0]=h,this.int16[M+1]=p,this.int16[M+2]=y,this.int16[M+3]=S,l}}Iv.prototype.bytesPerElement=8,xn("StructArrayLayout4i8",Iv);class wp extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,p,y,S,M)}emplace(l,h,p,y,S,M,R){const z=6*l;return this.int16[z+0]=h,this.int16[z+1]=p,this.int16[z+2]=y,this.int16[z+3]=S,this.int16[z+4]=M,this.int16[z+5]=R,l}}wp.prototype.bytesPerElement=12,xn("StructArrayLayout2i4i12",wp);class Rc extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,p,y,S,M)}emplace(l,h,p,y,S,M,R){const z=4*l,B=8*l;return this.int16[z+0]=h,this.int16[z+1]=p,this.uint8[B+4]=y,this.uint8[B+5]=S,this.uint8[B+6]=M,this.uint8[B+7]=R,l}}Rc.prototype.bytesPerElement=8,xn("StructArrayLayout2i4ub8",Rc);class Ld extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h){const p=this.length;return this.resize(p+1),this.emplace(p,l,h)}emplace(l,h,p){const y=2*l;return this.float32[y+0]=h,this.float32[y+1]=p,l}}Ld.prototype.bytesPerElement=8,xn("StructArrayLayout2f8",Ld);class Rv extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M,R,z,B,G){const X=this.length;return this.resize(X+1),this.emplace(X,l,h,p,y,S,M,R,z,B,G)}emplace(l,h,p,y,S,M,R,z,B,G,X){const ie=10*l;return this.uint16[ie+0]=h,this.uint16[ie+1]=p,this.uint16[ie+2]=y,this.uint16[ie+3]=S,this.uint16[ie+4]=M,this.uint16[ie+5]=R,this.uint16[ie+6]=z,this.uint16[ie+7]=B,this.uint16[ie+8]=G,this.uint16[ie+9]=X,l}}Rv.prototype.bytesPerElement=20,xn("StructArrayLayout10ui20",Rv);class Sp extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M,R,z,B,G,X,ie){const ae=this.length;return this.resize(ae+1),this.emplace(ae,l,h,p,y,S,M,R,z,B,G,X,ie)}emplace(l,h,p,y,S,M,R,z,B,G,X,ie,ae){const ce=12*l;return this.int16[ce+0]=h,this.int16[ce+1]=p,this.int16[ce+2]=y,this.int16[ce+3]=S,this.uint16[ce+4]=M,this.uint16[ce+5]=R,this.uint16[ce+6]=z,this.uint16[ce+7]=B,this.int16[ce+8]=G,this.int16[ce+9]=X,this.int16[ce+10]=ie,this.int16[ce+11]=ae,l}}Sp.prototype.bytesPerElement=24,xn("StructArrayLayout4i4ui4i24",Sp);class Lv extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=3*l;return this.float32[S+0]=h,this.float32[S+1]=p,this.float32[S+2]=y,l}}Lv.prototype.bytesPerElement=12,xn("StructArrayLayout3f12",Lv);class b extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint32[1*l+0]=h,l}}b.prototype.bytesPerElement=4,xn("StructArrayLayout1ul4",b);class o extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M,R,z,B){const G=this.length;return this.resize(G+1),this.emplace(G,l,h,p,y,S,M,R,z,B)}emplace(l,h,p,y,S,M,R,z,B,G){const X=10*l,ie=5*l;return this.int16[X+0]=h,this.int16[X+1]=p,this.int16[X+2]=y,this.int16[X+3]=S,this.int16[X+4]=M,this.int16[X+5]=R,this.uint32[ie+3]=z,this.uint16[X+8]=B,this.uint16[X+9]=G,l}}o.prototype.bytesPerElement=20,xn("StructArrayLayout6i1ul2ui20",o);class u extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,p,y,S,M)}emplace(l,h,p,y,S,M,R){const z=6*l;return this.int16[z+0]=h,this.int16[z+1]=p,this.int16[z+2]=y,this.int16[z+3]=S,this.int16[z+4]=M,this.int16[z+5]=R,l}}u.prototype.bytesPerElement=12,xn("StructArrayLayout2i2i2i12",u);class m extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S){const M=this.length;return this.resize(M+1),this.emplace(M,l,h,p,y,S)}emplace(l,h,p,y,S,M){const R=4*l,z=8*l;return this.float32[R+0]=h,this.float32[R+1]=p,this.float32[R+2]=y,this.int16[z+6]=S,this.int16[z+7]=M,l}}m.prototype.bytesPerElement=16,xn("StructArrayLayout2f1f2i16",m);class v extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M){const R=this.length;return this.resize(R+1),this.emplace(R,l,h,p,y,S,M)}emplace(l,h,p,y,S,M,R){const z=16*l,B=4*l,G=8*l;return this.uint8[z+0]=h,this.uint8[z+1]=p,this.float32[B+1]=y,this.float32[B+2]=S,this.int16[G+6]=M,this.int16[G+7]=R,l}}v.prototype.bytesPerElement=16,xn("StructArrayLayout2ub2f2i16",v);class w extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=3*l;return this.uint16[S+0]=h,this.uint16[S+1]=p,this.uint16[S+2]=y,l}}w.prototype.bytesPerElement=6,xn("StructArrayLayout3ui6",w);class P extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M,R,z,B,G,X,ie,ae,ce,de,Ce,ke){const et=this.length;return this.resize(et+1),this.emplace(et,l,h,p,y,S,M,R,z,B,G,X,ie,ae,ce,de,Ce,ke)}emplace(l,h,p,y,S,M,R,z,B,G,X,ie,ae,ce,de,Ce,ke,et){const Ge=24*l,se=12*l,we=48*l;return this.int16[Ge+0]=h,this.int16[Ge+1]=p,this.uint16[Ge+2]=y,this.uint16[Ge+3]=S,this.uint32[se+2]=M,this.uint32[se+3]=R,this.uint32[se+4]=z,this.uint16[Ge+10]=B,this.uint16[Ge+11]=G,this.uint16[Ge+12]=X,this.float32[se+7]=ie,this.float32[se+8]=ae,this.uint8[we+36]=ce,this.uint8[we+37]=de,this.uint8[we+38]=Ce,this.uint32[se+10]=ke,this.int16[Ge+22]=et,l}}P.prototype.bytesPerElement=48,xn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",P);class k extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p,y,S,M,R,z,B,G,X,ie,ae,ce,de,Ce,ke,et,Ge,se,we,Xe,mt,$t,bt,Mt,Jt,jt){const en=this.length;return this.resize(en+1),this.emplace(en,l,h,p,y,S,M,R,z,B,G,X,ie,ae,ce,de,Ce,ke,et,Ge,se,we,Xe,mt,$t,bt,Mt,Jt,jt)}emplace(l,h,p,y,S,M,R,z,B,G,X,ie,ae,ce,de,Ce,ke,et,Ge,se,we,Xe,mt,$t,bt,Mt,Jt,jt,en){const Pt=32*l,Cn=16*l;return this.int16[Pt+0]=h,this.int16[Pt+1]=p,this.int16[Pt+2]=y,this.int16[Pt+3]=S,this.int16[Pt+4]=M,this.int16[Pt+5]=R,this.int16[Pt+6]=z,this.int16[Pt+7]=B,this.uint16[Pt+8]=G,this.uint16[Pt+9]=X,this.uint16[Pt+10]=ie,this.uint16[Pt+11]=ae,this.uint16[Pt+12]=ce,this.uint16[Pt+13]=de,this.uint16[Pt+14]=Ce,this.uint16[Pt+15]=ke,this.uint16[Pt+16]=et,this.uint16[Pt+17]=Ge,this.uint16[Pt+18]=se,this.uint16[Pt+19]=we,this.uint16[Pt+20]=Xe,this.uint16[Pt+21]=mt,this.uint16[Pt+22]=$t,this.uint32[Cn+12]=bt,this.float32[Cn+13]=Mt,this.float32[Cn+14]=Jt,this.uint16[Pt+30]=jt,this.uint16[Pt+31]=en,l}}k.prototype.bytesPerElement=64,xn("StructArrayLayout8i15ui1ul2f2ui64",k);class F extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.float32[1*l+0]=h,l}}F.prototype.bytesPerElement=4,xn("StructArrayLayout1f4",F);class j extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=3*l;return this.uint16[6*l+0]=h,this.float32[S+1]=p,this.float32[S+2]=y,l}}j.prototype.bytesPerElement=12,xn("StructArrayLayout1ui2f12",j);class W extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h,p){const y=this.length;return this.resize(y+1),this.emplace(y,l,h,p)}emplace(l,h,p,y){const S=4*l;return this.uint32[2*l+0]=h,this.uint16[S+2]=p,this.uint16[S+3]=y,l}}W.prototype.bytesPerElement=8,xn("StructArrayLayout1ul2ui8",W);class J extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,h){const p=this.length;return this.resize(p+1),this.emplace(p,l,h)}emplace(l,h,p){const y=2*l;return this.uint16[y+0]=h,this.uint16[y+1]=p,l}}J.prototype.bytesPerElement=4,xn("StructArrayLayout2ui4",J);class Y extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const h=this.length;return this.resize(h+1),this.emplace(h,l)}emplace(l,h){return this.uint16[1*l+0]=h,l}}Y.prototype.bytesPerElement=2,xn("StructArrayLayout1ui2",Y);class oe extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,h,p,y){const S=this.length;return this.resize(S+1),this.emplace(S,l,h,p,y)}emplace(l,h,p,y,S){const M=4*l;return this.float32[M+0]=h,this.float32[M+1]=p,this.float32[M+2]=y,this.float32[M+3]=S,l}}oe.prototype.bytesPerElement=16,xn("StructArrayLayout4f16",oe);class he extends Ic{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new A(this.anchorPointX,this.anchorPointY)}}he.prototype.size=20;class Pe extends o{get(l){return new he(this,l)}}xn("CollisionBoxArray",Pe);class Ee extends Ic{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ee.prototype.size=48;class Ae extends P{get(l){return new Ee(this,l)}}xn("PlacedSymbolArray",Ae);class Fe extends Ic{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Fe.prototype.size=64;class He extends k{get(l){return new Fe(this,l)}}xn("SymbolInstanceArray",He);class Ne extends F{getoffsetX(l){return this.float32[1*l+0]}}xn("GlyphOffsetArray",Ne);class Ye extends $l{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}xn("SymbolLineVertexArray",Ye);class Ke extends Ic{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ke.prototype.size=12;class Ue extends j{get(l){return new Ke(this,l)}}xn("TextAnchorOffsetArray",Ue);class rt extends Ic{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}rt.prototype.size=8;class yt extends W{get(l){return new rt(this,l)}}xn("FeatureIndexArray",yt);class ht extends Ul{}class pt extends Ul{}class _t extends Ul{}class sn extends wp{}class rn extends Rc{}class Vt extends Ld{}class Mn extends Rv{}class Kn extends Sp{}class Mr extends Lv{}class ti extends b{}class Pr extends u{}class ni extends v{}class Dr extends w{}class Ar extends J{}const zr=si([{name:"a_pos",components:2,type:"Int16"}],4),{members:to}=zr;class ur{constructor(l=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=l}prepareSegment(l,h,p,y){const S=this.segments[this.segments.length-1];return l>ur.MAX_VERTEX_ARRAY_LENGTH&&tn(`Max vertices per segment is ${ur.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ur.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!S||S.vertexLength+l>ur.MAX_VERTEX_ARRAY_LENGTH||S.sortKey!==y?this.createNewSegment(h,p,y):S}createNewSegment(l,h,p){const y={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return p!==void 0&&(y.sortKey=p),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(y),y}getOrCreateLatestSegment(l,h,p){return this.prepareSegment(0,l,h,p)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const l of this.segments)for(const h in l.vaos)l.vaos[h].destroy()}static simpleSegment(l,h,p,y){return new ur([{vertexOffset:l,primitiveOffset:h,vertexLength:p,primitiveLength:y,vaos:{},sortKey:0}])}}function Hi(d,l){return 256*(d=Tt(Math.floor(d),0,255))+Tt(Math.floor(l),0,255)}ur.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xn("SegmentVector",ur);const no=si([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Vl,jl,Hl,ka={exports:{}},kd={exports:{}},Dd={exports:{}},Vu=function(){if(Hl)return ka.exports;Hl=1;var d=(Vl||(Vl=1,kd.exports=function(h,p){var y,S,M,R,z,B,G,X;for(S=h.length-(y=3&h.length),M=p,z=3432918353,B=461845907,X=0;X<S;)G=255&h.charCodeAt(X)|(255&h.charCodeAt(++X))<<8|(255&h.charCodeAt(++X))<<16|(255&h.charCodeAt(++X))<<24,++X,M=27492+(65535&(R=5*(65535&(M=(M^=G=(65535&(G=(G=(65535&G)*z+(((G>>>16)*z&65535)<<16)&4294967295)<<15|G>>>17))*B+(((G>>>16)*B&65535)<<16)&4294967295)<<13|M>>>19))+((5*(M>>>16)&65535)<<16)&4294967295))+((58964+(R>>>16)&65535)<<16);switch(G=0,y){case 3:G^=(255&h.charCodeAt(X+2))<<16;case 2:G^=(255&h.charCodeAt(X+1))<<8;case 1:M^=G=(65535&(G=(G=(65535&(G^=255&h.charCodeAt(X)))*z+(((G>>>16)*z&65535)<<16)&4294967295)<<15|G>>>17))*B+(((G>>>16)*B&65535)<<16)&4294967295}return M^=h.length,M=2246822507*(65535&(M^=M>>>16))+((2246822507*(M>>>16)&65535)<<16)&4294967295,M=3266489909*(65535&(M^=M>>>13))+((3266489909*(M>>>16)&65535)<<16)&4294967295,(M^=M>>>16)>>>0}),kd.exports),l=(jl||(jl=1,Dd.exports=function(h,p){for(var y,S=h.length,M=p^S,R=0;S>=4;)y=1540483477*(65535&(y=255&h.charCodeAt(R)|(255&h.charCodeAt(++R))<<8|(255&h.charCodeAt(++R))<<16|(255&h.charCodeAt(++R))<<24))+((1540483477*(y>>>16)&65535)<<16),M=1540483477*(65535&M)+((1540483477*(M>>>16)&65535)<<16)^(y=1540483477*(65535&(y^=y>>>24))+((1540483477*(y>>>16)&65535)<<16)),S-=4,++R;switch(S){case 3:M^=(255&h.charCodeAt(R+2))<<16;case 2:M^=(255&h.charCodeAt(R+1))<<8;case 1:M=1540483477*(65535&(M^=255&h.charCodeAt(R)))+((1540483477*(M>>>16)&65535)<<16)}return M=1540483477*(65535&(M^=M>>>13))+((1540483477*(M>>>16)&65535)<<16),(M^=M>>>15)>>>0}),Dd.exports);return ka.exports=d,ka.exports.murmur3=d,ka.exports.murmur2=l,ka.exports}(),Ko=f(Vu);class Qs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,h,p,y){this.ids.push(Gl(l)),this.positions.push(h,p,y)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=Gl(l);let p=0,y=this.ids.length-1;for(;p<y;){const M=p+y>>1;this.ids[M]>=h?y=M:p=M+1}const S=[];for(;this.ids[p]===h;)S.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return S}static serialize(l,h){const p=new Float64Array(l.ids),y=new Uint32Array(l.positions);return Lc(p,y,0,p.length-1),h&&h.push(p.buffer,y.buffer),{ids:p,positions:y}}static deserialize(l){const h=new Qs;return h.ids=l.ids,h.positions=l.positions,h.indexed=!0,h}}function Gl(d){const l=+d;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:Ko(String(d))}function Lc(d,l,h,p){for(;h<p;){const y=d[h+p>>1];let S=h-1,M=p+1;for(;;){do S++;while(d[S]<y);do M--;while(d[M]>y);if(S>=M)break;hi(d,S,M),hi(l,3*S,3*M),hi(l,3*S+1,3*M+1),hi(l,3*S+2,3*M+2)}M-h<p-M?(Lc(d,l,h,M),h=M+1):(Lc(d,l,M+1,p),p=M)}}function hi(d,l,h){const p=d[l];d[l]=d[h],d[h]=p}xn("FeaturePositionMap",Qs);class Hr{constructor(l,h){this.gl=l.gl,this.location=h}}class Do extends Hr{constructor(l,h){super(l,h),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class Ri extends Hr{constructor(l,h){super(l,h),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class e1 extends Hr{constructor(l,h){super(l,h),this.current=Qn.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}const jC=new Float32Array(16);function kv(d){return[Hi(255*d.r,255*d.g),Hi(255*d.b,255*d.a)]}class zd{constructor(l,h,p){this.value=l,this.uniformNames=h.map(y=>`u_${y}`),this.type=p}setUniform(l,h,p){l.set(p.constantOr(this.value))}getBinding(l,h,p){return this.type==="color"?new e1(l,h):new Do(l,h)}}class ju{constructor(l,h){this.uniformNames=h.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=l.tlbr}setUniform(l,h,p,y){const S=y==="u_pattern_to"?this.patternTo:y==="u_pattern_from"?this.patternFrom:y==="u_pixel_ratio_to"?this.pixelRatioTo:y==="u_pixel_ratio_from"?this.pixelRatioFrom:null;S&&l.set(S)}getBinding(l,h,p){return p.substr(0,9)==="u_pattern"?new Ri(l,h):new Do(l,h)}}class al{constructor(l,h,p,y){this.expression=l,this.type=p,this.maxValue=0,this.paintVertexAttributes=h.map(S=>({name:`a_${S}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new y}populatePaintArray(l,h,p,y,S){const M=this.paintVertexArray.length,R=this.expression.evaluate(new Xr(0),h,{},y,[],S);this.paintVertexArray.resize(l),this._setPaintValue(M,l,R)}updatePaintArray(l,h,p,y){const S=this.expression.evaluate({zoom:0},p,y);this._setPaintValue(l,h,S)}_setPaintValue(l,h,p){if(this.type==="color"){const y=kv(p);for(let S=l;S<h;S++)this.paintVertexArray.emplace(S,y[0],y[1])}else{for(let y=l;y<h;y++)this.paintVertexArray.emplace(y,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ro{constructor(l,h,p,y,S,M){this.expression=l,this.uniformNames=h.map(R=>`u_${R}_t`),this.type=p,this.useIntegerZoom=y,this.zoom=S,this.maxValue=0,this.paintVertexAttributes=h.map(R=>({name:`a_${R}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new M}populatePaintArray(l,h,p,y,S){const M=this.expression.evaluate(new Xr(this.zoom),h,{},y,[],S),R=this.expression.evaluate(new Xr(this.zoom+1),h,{},y,[],S),z=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(z,l,M,R)}updatePaintArray(l,h,p,y){const S=this.expression.evaluate({zoom:this.zoom},p,y),M=this.expression.evaluate({zoom:this.zoom+1},p,y);this._setPaintValue(l,h,S,M)}_setPaintValue(l,h,p,y){if(this.type==="color"){const S=kv(p),M=kv(y);for(let R=l;R<h;R++)this.paintVertexArray.emplace(R,S[0],S[1],M[0],M[1])}else{for(let S=l;S<h;S++)this.paintVertexArray.emplace(S,p,y);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(y))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,h){const p=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,y=Tt(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);l.set(y)}getBinding(l,h,p){return new Do(l,h)}}class ll{constructor(l,h,p,y,S,M){this.expression=l,this.type=h,this.useIntegerZoom=p,this.zoom=y,this.layerId=M,this.zoomInPaintVertexArray=new S,this.zoomOutPaintVertexArray=new S}populatePaintArray(l,h,p){const y=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(y,l,h.patterns&&h.patterns[this.layerId],p)}updatePaintArray(l,h,p,y,S){this._setPaintValues(l,h,p.patterns&&p.patterns[this.layerId],S)}_setPaintValues(l,h,p,y){if(!y||!p)return;const{min:S,mid:M,max:R}=p,z=y[S],B=y[M],G=y[R];if(z&&B&&G)for(let X=l;X<h;X++)this.zoomInPaintVertexArray.emplace(X,B.tl[0],B.tl[1],B.br[0],B.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],B.pixelRatio,z.pixelRatio),this.zoomOutPaintVertexArray.emplace(X,B.tl[0],B.tl[1],B.br[0],B.br[1],G.tl[0],G.tl[1],G.br[0],G.br[1],B.pixelRatio,G.pixelRatio)}upload(l){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,no.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,no.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Dv{constructor(l,h,p){this.binders={},this._buffers=[];const y=[];for(const S in l.paint._values){if(!p(S))continue;const M=l.paint.get(S);if(!(M instanceof La&&Iu(M.property.specification)))continue;const R=zv(S,l.type),z=M.value,B=M.property.specification.type,G=M.property.useIntegerZoom,X=M.property.specification["property-type"],ie=X==="cross-faded"||X==="cross-faded-data-driven";if(z.kind==="constant")this.binders[S]=ie?new ju(z.value,R):new zd(z.value,R,B),y.push(`/u_${S}`);else if(z.kind==="source"||ie){const ae=Ov(S,B,"source");this.binders[S]=ie?new ll(z,B,G,h,ae,l.id):new al(z,R,B,ae),y.push(`/a_${S}`)}else{const ae=Ov(S,B,"composite");this.binders[S]=new ro(z,R,B,G,h,ae),y.push(`/z_${S}`)}}this.cacheKey=y.sort().join("")}getMaxValue(l){const h=this.binders[l];return h instanceof al||h instanceof ro?h.maxValue:0}populatePaintArrays(l,h,p,y,S){for(const M in this.binders){const R=this.binders[M];(R instanceof al||R instanceof ro||R instanceof ll)&&R.populatePaintArray(l,h,p,y,S)}}setConstantPatternPositions(l,h){for(const p in this.binders){const y=this.binders[p];y instanceof ju&&y.setConstantPatternPositions(l,h)}}updatePaintArrays(l,h,p,y,S){let M=!1;for(const R in l){const z=h.getPositions(R);for(const B of z){const G=p.feature(B.index);for(const X in this.binders){const ie=this.binders[X];if((ie instanceof al||ie instanceof ro||ie instanceof ll)&&ie.expression.isStateDependent===!0){const ae=y.paint.get(X);ie.expression=ae.value,ie.updatePaintArray(B.start,B.end,G,l[R],S),M=!0}}}}return M}defines(){const l=[];for(const h in this.binders){const p=this.binders[h];(p instanceof zd||p instanceof ju)&&l.push(...p.uniformNames.map(y=>`#define HAS_UNIFORM_${y}`))}return l}getBinderAttributes(){const l=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof al||p instanceof ro)for(let y=0;y<p.paintVertexAttributes.length;y++)l.push(p.paintVertexAttributes[y].name);else if(p instanceof ll)for(let y=0;y<no.members.length;y++)l.push(no.members[y].name)}return l}getBinderUniforms(){const l=[];for(const h in this.binders){const p=this.binders[h];if(p instanceof zd||p instanceof ju||p instanceof ro)for(const y of p.uniformNames)l.push(y)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,h){const p=[];for(const y in this.binders){const S=this.binders[y];if(S instanceof zd||S instanceof ju||S instanceof ro){for(const M of S.uniformNames)if(h[M]){const R=S.getBinding(l,h[M],M);p.push({name:M,property:y,binding:R})}}}return p}setUniforms(l,h,p,y){for(const{name:S,property:M,binding:R}of h)this.binders[M].setUniform(R,y,p.get(M),S)}updatePaintBuffers(l){this._buffers=[];for(const h in this.binders){const p=this.binders[h];if(l&&p instanceof ll){const y=l.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;y&&this._buffers.push(y)}else(p instanceof al||p instanceof ro)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(l){for(const h in this.binders){const p=this.binders[h];(p instanceof al||p instanceof ro||p instanceof ll)&&p.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const h=this.binders[l];(h instanceof al||h instanceof ro||h instanceof ll)&&h.destroy()}}}class Wl{constructor(l,h,p=()=>!0){this.programConfigurations={};for(const y of l)this.programConfigurations[y.id]=new Dv(y,h,p);this.needsUpload=!1,this._featureMap=new Qs,this._bufferOffset=0}populatePaintArrays(l,h,p,y,S,M){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(l,h,y,S,M);h.id!==void 0&&this._featureMap.add(h.id,p,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,h,p,y){for(const S of p)this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(l,this._featureMap,h,S,y)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}function zv(d,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[d]||[d.replace(`${l}-`,"").replace(/-/g,"_")]}function Ov(d,l,h){const p={color:{source:Ld,composite:oe},number:{source:F,composite:Ld}},y=function(S){return{"line-pattern":{source:Mn,composite:Mn},"fill-pattern":{source:Mn,composite:Mn},"fill-extrusion-pattern":{source:Mn,composite:Mn}}[S]}(d);return y&&y[h]||p[l][h]}xn("ConstantBinder",zd),xn("CrossFadedConstantBinder",ju),xn("SourceExpressionBinder",al),xn("CrossFadedCompositeBinder",ll),xn("CompositeExpressionBinder",ro),xn("ProgramConfiguration",Dv,{omit:["_buffers"]}),xn("ProgramConfigurationSet",Wl);const Od=Math.pow(2,14)-1,JL=-Od-1;function Fd(d){const l=ct/d.extent,h=d.loadGeometry();for(let p=0;p<h.length;p++){const y=h[p];for(let S=0;S<y.length;S++){const M=y[S],R=Math.round(M.x*l),z=Math.round(M.y*l);M.x=Tt(R,JL,Od),M.y=Tt(z,JL,Od),(R<M.x||R>M.x+1||z<M.y||z>M.y+1)&&tn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Nd(d,l){return{type:d.type,id:d.id,properties:d.properties,geometry:l?Fd(d):[]}}const QL=-32768;function lW(d,l,h,p,y){d.emplaceBack(QL+8*l+p,QL+8*h+y)}class HC{constructor(l){this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new pt,this.indexArray=new Dr,this.segments=new ur,this.programConfigurations=new Wl(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,p){const y=this.layers[0],S=[];let M=null,R=!1,z=y.type==="heatmap";if(y.type==="circle"){const G=y;M=G.layout.get("circle-sort-key"),R=!M.isConstant(),z=z||G.paint.get("circle-pitch-alignment")==="map"}const B=z?h.subdivisionGranularity.circle:1;for(const{feature:G,id:X,index:ie,sourceLayerIndex:ae}of l){const ce=this.layers[0]._featureFilter.needGeometry,de=Nd(G,ce);if(!this.layers[0]._featureFilter.filter(new Xr(this.zoom,{globalState:this.globalState}),de,p))continue;const Ce=R?M.evaluate(de,{},p):void 0,ke={id:X,properties:G.properties,type:G.type,sourceLayerIndex:ae,index:ie,geometry:ce?de.geometry:Fd(G),patterns:{},sortKey:Ce};S.push(ke)}R&&S.sort((G,X)=>G.sortKey-X.sortKey);for(const G of S){const{geometry:X,index:ie,sourceLayerIndex:ae}=G,ce=l[ie].feature;this.addFeature(G,X,ie,p,B),h.featureIndex.insert(ce,X,ie,ae,this.index)}}update(l,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,to),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,h,p,y,S=1){let M;switch(S){case 1:M=[0,7];break;case 3:M=[0,2,5,7];break;case 5:M=[0,1,3,4,6,7];break;case 7:M=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${S}; valid values are 1, 3, 5, 7.`)}const R=M.length;for(const z of h)for(const B of z){const G=B.x,X=B.y;if(G<0||G>=ct||X<0||X>=ct)continue;const ie=this.segments.prepareSegment(R*R,this.layoutVertexArray,this.indexArray,l.sortKey),ae=ie.vertexLength;for(let ce=0;ce<R;ce++)for(let de=0;de<R;de++)lW(this.layoutVertexArray,G,X,M[de],M[ce]);for(let ce=0;ce<R-1;ce++)for(let de=0;de<R-1;de++){const Ce=ae+ce*R+de,ke=ae+(ce+1)*R+de;this.indexArray.emplaceBack(Ce,ke+1,Ce+1),this.indexArray.emplaceBack(Ce,ke,ke+1)}ie.vertexLength+=R*R,ie.primitiveLength+=(R-1)*(R-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,{},y)}}function ek(d,l){for(let h=0;h<d.length;h++)if(Mp(l,d[h]))return!0;for(let h=0;h<l.length;h++)if(Mp(d,l[h]))return!0;return!!GC(d,l)}function cW(d,l,h){return!!Mp(d,l)||!!WC(l,d,h)}function tk(d,l){if(d.length===1)return rk(l,d[0]);for(let h=0;h<l.length;h++){const p=l[h];for(let y=0;y<p.length;y++)if(Mp(d,p[y]))return!0}for(let h=0;h<d.length;h++)if(rk(l,d[h]))return!0;for(let h=0;h<l.length;h++)if(GC(d,l[h]))return!0;return!1}function uW(d,l,h){if(d.length>1){if(GC(d,l))return!0;for(let p=0;p<l.length;p++)if(WC(l[p],d,h))return!0}for(let p=0;p<d.length;p++)if(WC(d[p],l,h))return!0;return!1}function GC(d,l){if(d.length===0||l.length===0)return!1;for(let h=0;h<d.length-1;h++){const p=d[h],y=d[h+1];for(let S=0;S<l.length-1;S++)if(hW(p,y,l[S],l[S+1]))return!0}return!1}function hW(d,l,h,p){return Dt(d,h,p)!==Dt(l,h,p)&&Dt(d,l,h)!==Dt(d,l,p)}function WC(d,l,h){const p=h*h;if(l.length===1)return d.distSqr(l[0])<p;for(let y=1;y<l.length;y++)if(nk(d,l[y-1],l[y])<p)return!0;return!1}function nk(d,l,h){const p=l.distSqr(h);if(p===0)return d.distSqr(l);const y=((d.x-l.x)*(h.x-l.x)+(d.y-l.y)*(h.y-l.y))/p;return d.distSqr(y<0?l:y>1?h:h.sub(l)._mult(y)._add(l))}function rk(d,l){let h,p,y,S=!1;for(let M=0;M<d.length;M++){h=d[M];for(let R=0,z=h.length-1;R<h.length;z=R++)p=h[R],y=h[z],p.y>l.y!=y.y>l.y&&l.x<(y.x-p.x)*(l.y-p.y)/(y.y-p.y)+p.x&&(S=!S)}return S}function Mp(d,l){let h=!1;for(let p=0,y=d.length-1;p<d.length;y=p++){const S=d[p],M=d[y];S.y>l.y!=M.y>l.y&&l.x<(M.x-S.x)*(l.y-S.y)/(M.y-S.y)+S.x&&(h=!h)}return h}function dW(d,l,h){const p=h[0],y=h[2];if(d.x<p.x&&l.x<p.x||d.x>y.x&&l.x>y.x||d.y<p.y&&l.y<p.y||d.y>y.y&&l.y>y.y)return!1;const S=Dt(d,l,h[0]);return S!==Dt(d,l,h[1])||S!==Dt(d,l,h[2])||S!==Dt(d,l,h[3])}function Fv(d,l,h){const p=l.paint.get(d).value;return p.kind==="constant"?p.value:h.programConfigurations.get(l.id).getMaxValue(d)}function t1(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function n1(d,l,h,p,y){if(!l[0]&&!l[1])return d;const S=A.convert(l)._mult(y);h==="viewport"&&S._rotate(-p);const M=[];for(let R=0;R<d.length;R++)M.push(d[R].sub(S));return M}let ik,ok;xn("CircleBucket",HC,{omit:["layers"]});var fW={get paint(){return ok=ok||new ko({"circle-radius":new Vn(Oe.paint_circle["circle-radius"]),"circle-color":new Vn(Oe.paint_circle["circle-color"]),"circle-blur":new Vn(Oe.paint_circle["circle-blur"]),"circle-opacity":new Vn(Oe.paint_circle["circle-opacity"]),"circle-translate":new En(Oe.paint_circle["circle-translate"]),"circle-translate-anchor":new En(Oe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new En(Oe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new En(Oe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Vn(Oe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Vn(Oe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Vn(Oe.paint_circle["circle-stroke-opacity"])})},get layout(){return ik=ik||new ko({"circle-sort-key":new Vn(Oe.layout_circle["circle-sort-key"])})}};class pW extends eo{constructor(l){super(l,fW)}createBucket(l){return new HC(l)}queryRadius(l){const h=l;return Fv("circle-radius",this,h)+Fv("circle-stroke-width",this,h)+t1(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:p,geometry:y,transform:S,pixelsToTileUnits:M,unwrappedTileID:R,getElevation:z}){const B=n1(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-S.bearingInRadians,M),G=this.paint.get("circle-radius").evaluate(h,p)+this.paint.get("circle-stroke-width").evaluate(h,p),X=this.paint.get("circle-pitch-alignment")==="map",ie=X?B:function(ce,de,Ce,ke){return ce.map(et=>sk(et,de,Ce,ke))}(B,S,R,z),ae=X?G*M:G;for(const ce of y)for(const de of ce){const Ce=X?de:sk(de,S,R,z);let ke=ae;const et=S.projectTileCoordinates(de.x,de.y,R,z).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ke*=et/S.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ke*=S.cameraToCenterDistance/et),cW(ie,Ce,ke))return!0}return!1}}function sk(d,l,h,p){const y=l.projectTileCoordinates(d.x,d.y,h,p).point;return new A((.5*y.x+.5)*l.width,(.5*-y.y+.5)*l.height)}class ak extends HC{}let lk;xn("HeatmapBucket",ak,{omit:["layers"]});var mW={get paint(){return lk=lk||new ko({"heatmap-radius":new Vn(Oe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Vn(Oe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new En(Oe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Rd(Oe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new En(Oe.paint_heatmap["heatmap-opacity"])})}};function qC(d,{width:l,height:h},p,y){if(y){if(y instanceof Uint8ClampedArray)y=new Uint8Array(y.buffer);else if(y.length!==l*h*p)throw new RangeError(`mismatched image size. expected: ${y.length} but got: ${l*h*p}`)}else y=new Uint8Array(l*h*p);return d.width=l,d.height=h,d.data=y,d}function ck(d,{width:l,height:h},p){if(l===d.width&&h===d.height)return;const y=qC({},{width:l,height:h},p);XC(d,y,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,l),height:Math.min(d.height,h)},p),d.width=l,d.height=h,d.data=y.data}function XC(d,l,h,p,y,S){if(y.width===0||y.height===0)return l;if(y.width>d.width||y.height>d.height||h.x>d.width-y.width||h.y>d.height-y.height)throw new RangeError("out of range source coordinates for image copy");if(y.width>l.width||y.height>l.height||p.x>l.width-y.width||p.y>l.height-y.height)throw new RangeError("out of range destination coordinates for image copy");const M=d.data,R=l.data;if(M===R)throw new Error("srcData equals dstData, so image is already copied");for(let z=0;z<y.height;z++){const B=((h.y+z)*d.width+h.x)*S,G=((p.y+z)*l.width+p.x)*S;for(let X=0;X<y.width*S;X++)R[G+X]=M[B+X]}return l}class Nv{constructor(l,h){qC(this,l,1,h)}resize(l){ck(this,l,1)}clone(){return new Nv({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,p,y,S){XC(l,h,p,y,S,1)}}class us{constructor(l,h){qC(this,l,4,h)}resize(l){ck(this,l,4)}replace(l,h){h?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new us({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,h,p,y,S){XC(l,h,p,y,S,4)}setPixel(l,h,p){const y=4*(l*this.width+h);this.data[y+0]=Math.round(255*p.r/p.a),this.data[y+1]=Math.round(255*p.g/p.a),this.data[y+2]=Math.round(255*p.b/p.a),this.data[y+3]=Math.round(255*p.a)}}function uk(d){const l={},h=d.resolution||256,p=d.clips?d.clips.length:1,y=d.image||new us({width:h,height:p});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const S=(M,R,z)=>{l[d.evaluationKey]=z;const B=d.expression.evaluate(l);y.setPixel(M/4/h,R/4,B)};if(d.clips)for(let M=0,R=0;M<p;++M,R+=4*h)for(let z=0,B=0;z<h;z++,B+=4){const G=z/(h-1),{start:X,end:ie}=d.clips[M];S(R,B,X*(1-G)+ie*G)}else for(let M=0,R=0;M<h;M++,R+=4)S(0,R,M/(h-1));return y}xn("AlphaImage",Nv),xn("RGBAImage",us);const ZC="big-fb";class gW extends eo{createBucket(l){return new ak(l)}constructor(l){super(l,mW),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=uk({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ZC)&&this.heatmapFbos.delete(ZC)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let hk;var vW={get paint(){return hk=hk||new ko({"hillshade-illumination-direction":new En(Oe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new En(Oe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new En(Oe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new En(Oe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new En(Oe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new En(Oe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new En(Oe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new En(Oe.paint_hillshade["hillshade-method"])})}};class yW extends eo{constructor(l){super(l,vW),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let l=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,p=this.paint.get("hillshade-highlight-color").values,y=this.paint.get("hillshade-shadow-color").values;const S=Math.max(l.length,h.length,p.length,y.length);l=l.concat(Array(S-l.length).fill(l.at(-1))),h=h.concat(Array(S-h.length).fill(h.at(-1))),p=p.concat(Array(S-p.length).fill(p.at(-1))),y=y.concat(Array(S-y.length).fill(y.at(-1)));const M=h.map(Zt);return{directionRadians:l.map(Zt),altitudeRadians:M,shadowColor:y,highlightColor:p}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let dk;var _W={get paint(){return dk=dk||new ko({"color-relief-opacity":new En(Oe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Rd(Oe["paint_color-relief"]["color-relief-color"])})}};class YC{constructor(l,h,p,y){this.context=l,this.format=p,this.texture=l.gl.createTexture(),this.update(h,y)}update(l,h,p){const{width:y,height:S}=l,M=!(this.size&&this.size[0]===y&&this.size[1]===S||p),{context:R}=this,{gl:z}=R;if(this.useMipmap=!!(h&&h.useMipmap),z.bindTexture(z.TEXTURE_2D,this.texture),R.pixelStoreUnpackFlipY.set(!1),R.pixelStoreUnpack.set(1),R.pixelStoreUnpackPremultiplyAlpha.set(this.format===z.RGBA&&(!h||h.premultiply!==!1)),M)this.size=[y,S],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||Le(l)?z.texImage2D(z.TEXTURE_2D,0,this.format,this.format,z.UNSIGNED_BYTE,l):z.texImage2D(z.TEXTURE_2D,0,this.format,y,S,0,this.format,z.UNSIGNED_BYTE,l.data);else{const{x:B,y:G}=p||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||Le(l)?z.texSubImage2D(z.TEXTURE_2D,0,B,G,z.RGBA,z.UNSIGNED_BYTE,l):z.texSubImage2D(z.TEXTURE_2D,0,B,G,y,S,z.RGBA,z.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&z.generateMipmap(z.TEXTURE_2D),R.pixelStoreUnpackFlipY.setDefault(),R.pixelStoreUnpack.setDefault(),R.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(l,h,p){const{context:y}=this,{gl:S}=y;S.bindTexture(S.TEXTURE_2D,this.texture),p!==S.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=S.LINEAR),l!==this.filter&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,l),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,p||l),this.filter=l),h!==this.wrap&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,h),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class fk{constructor(l,h,p,y=1,S=1,M=1,R=0){if(this.uid=l,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(p&&!["mapbox","terrarium","custom"].includes(p))return void tn(`"${p}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const z=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),p){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=y,this.greenFactor=S,this.blueFactor=M,this.baseShift=R;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let B=0;B<z;B++)this.data[this._idx(-1,B)]=this.data[this._idx(0,B)],this.data[this._idx(z,B)]=this.data[this._idx(z-1,B)],this.data[this._idx(B,-1)]=this.data[this._idx(B,0)],this.data[this._idx(B,z)]=this.data[this._idx(B,z-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(z,-1)]=this.data[this._idx(z-1,0)],this.data[this._idx(-1,z)]=this.data[this._idx(0,z-1)],this.data[this._idx(z,z)]=this.data[this._idx(z-1,z-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let B=0;B<z;B++)for(let G=0;G<z;G++){const X=this.get(B,G);X>this.max&&(this.max=X),X<this.min&&(this.min=X)}}get(l,h){const p=new Uint8Array(this.data.buffer),y=4*this._idx(l,h);return this.unpack(p[y],p[y+1],p[y+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,h){if(l<-1||l>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(l+1)}unpack(l,h,p){return l*this.redFactor+h*this.greenFactor+p*this.blueFactor-this.baseShift}pack(l){return pk(l,this.getUnpackVector())}getPixels(){return new us({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,h,p){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let y=h*this.dim,S=h*this.dim+this.dim,M=p*this.dim,R=p*this.dim+this.dim;switch(h){case-1:y=S-1;break;case 1:S=y+1}switch(p){case-1:M=R-1;break;case 1:R=M+1}const z=-h*this.dim,B=-p*this.dim;for(let G=M;G<R;G++)for(let X=y;X<S;X++)this.data[this._idx(X,G)]=l.data[this._idx(X+z,G+B)]}}function pk(d,l){const h=l[0],p=l[1],y=l[2],S=l[3],M=Math.min(h,p,y),R=Math.round((d+S)/M);return{r:Math.floor(R*M/h)%256,g:Math.floor(R*M/p)%256,b:Math.floor(R*M/y)%256}}xn("DEMData",fk);class xW extends eo{constructor(l){super(l,_W)}_createColorRamp(l){const h={elevationStops:[],colorStops:[]},p=this._transitionablePaint._values["color-relief-color"].value.expression;if(p instanceof xd&&p._styleExpression.expression instanceof Ro){this.colorRampExpression=p;const M=p._styleExpression.expression;h.elevationStops=M.labels,h.colorStops=[];for(const R of h.elevationStops)h.colorStops.push(M.evaluate({globals:{elevation:R}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[Qn.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=l)return h;const y={elevationStops:[],colorStops:[]},S=(h.elevationStops.length-1)/(l-1);for(let M=0;M<h.elevationStops.length-.5;M+=S)y.elevationStops.push(h.elevationStops[Math.round(M)]),y.colorStops.push(h.colorStops[Math.round(M)]);return tn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),y}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(l,h,p){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const y=this._createColorRamp(h),S=new us({width:y.colorStops.length,height:1}),M=new us({width:y.colorStops.length,height:1});for(let R=0;R<y.elevationStops.length;R++){const z=pk(y.elevationStops[R],p);M.setPixel(0,R,new Qn(z.r/255,z.g/255,z.b/255,1)),S.setPixel(0,R,y.colorStops[R])}return this.colorRampTextures={elevationTexture:new YC(l,M,l.gl.RGBA),colorTexture:new YC(l,S,l.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const bW=si([{name:"a_pos",components:2,type:"Int16"}],4),{members:wW}=bW;function KC(d,l,h){const p=h.patternDependencies;let y=!1;for(const S of l){const M=S.paint.get(`${d}-pattern`);M.isConstant()||(y=!0);const R=M.constantOr(null);R&&(y=!0,p[R.to]=!0,p[R.from]=!0)}return y}function JC(d,l,h,p,y){const S=y.patternDependencies;for(const M of l){const R=M.paint.get(`${d}-pattern`).value;if(R.kind!=="constant"){let z=R.evaluate({zoom:p-1},h,{},y.availableImages),B=R.evaluate({zoom:p},h,{},y.availableImages),G=R.evaluate({zoom:p+1},h,{},y.availableImages);z=z&&z.name?z.name:z,B=B&&B.name?B.name:B,G=G&&G.name?G.name:G,S[z]=!0,S[B]=!0,S[G]=!0,h.patterns[M.id]={min:z,mid:B,max:G}}}return h}function mk(d,l,h,p,y){let S;if(y===function(M,R,z,B){let G=0;for(let X=R,ie=z-B;X<z;X+=B)G+=(M[ie]-M[X])*(M[X+1]+M[ie+1]),ie=X;return G}(d,l,h,p)>0)for(let M=l;M<h;M+=p)S=_k(M/p|0,d[M],d[M+1],S);else for(let M=h-p;M>=l;M-=p)S=_k(M/p|0,d[M],d[M+1],S);return S&&Cp(S,S.next)&&(Vv(S),S=S.next),S}function Bd(d,l){if(!d)return d;l||(l=d);let h,p=d;do if(h=!1,p.steiner||!Cp(p,p.next)&&mi(p.prev,p,p.next)!==0)p=p.next;else{if(Vv(p),p=l=p.prev,p===p.next)break;h=!0}while(h||p!==l);return l}function Bv(d,l,h,p,y,S,M){if(!d)return;!M&&S&&function(z,B,G,X){let ie=z;do ie.z===0&&(ie.z=QC(ie.x,ie.y,B,G,X)),ie.prevZ=ie.prev,ie.nextZ=ie.next,ie=ie.next;while(ie!==z);ie.prevZ.nextZ=null,ie.prevZ=null,function(ae){let ce,de=1;do{let Ce,ke=ae;ae=null;let et=null;for(ce=0;ke;){ce++;let Ge=ke,se=0;for(let Xe=0;Xe<de&&(se++,Ge=Ge.nextZ,Ge);Xe++);let we=de;for(;se>0||we>0&&Ge;)se!==0&&(we===0||!Ge||ke.z<=Ge.z)?(Ce=ke,ke=ke.nextZ,se--):(Ce=Ge,Ge=Ge.nextZ,we--),et?et.nextZ=Ce:ae=Ce,Ce.prevZ=et,et=Ce;ke=Ge}et.nextZ=null,de*=2}while(ce>1)}(ie)}(d,p,y,S);let R=d;for(;d.prev!==d.next;){const z=d.prev,B=d.next;if(S?MW(d,p,y,S):SW(d))l.push(z.i,d.i,B.i),Vv(d),d=B.next,R=B.next;else if((d=B)===R){M?M===1?Bv(d=CW(Bd(d),l),l,h,p,y,S,2):M===2&&EW(d,l,h,p,y,S):Bv(Bd(d),l,h,p,y,S,1);break}}}function SW(d){const l=d.prev,h=d,p=d.next;if(mi(l,h,p)>=0)return!1;const y=l.x,S=h.x,M=p.x,R=l.y,z=h.y,B=p.y,G=Math.min(y,S,M),X=Math.min(R,z,B),ie=Math.max(y,S,M),ae=Math.max(R,z,B);let ce=p.next;for(;ce!==l;){if(ce.x>=G&&ce.x<=ie&&ce.y>=X&&ce.y<=ae&&Uv(y,R,S,z,M,B,ce.x,ce.y)&&mi(ce.prev,ce,ce.next)>=0)return!1;ce=ce.next}return!0}function MW(d,l,h,p){const y=d.prev,S=d,M=d.next;if(mi(y,S,M)>=0)return!1;const R=y.x,z=S.x,B=M.x,G=y.y,X=S.y,ie=M.y,ae=Math.min(R,z,B),ce=Math.min(G,X,ie),de=Math.max(R,z,B),Ce=Math.max(G,X,ie),ke=QC(ae,ce,l,h,p),et=QC(de,Ce,l,h,p);let Ge=d.prevZ,se=d.nextZ;for(;Ge&&Ge.z>=ke&&se&&se.z<=et;){if(Ge.x>=ae&&Ge.x<=de&&Ge.y>=ce&&Ge.y<=Ce&&Ge!==y&&Ge!==M&&Uv(R,G,z,X,B,ie,Ge.x,Ge.y)&&mi(Ge.prev,Ge,Ge.next)>=0||(Ge=Ge.prevZ,se.x>=ae&&se.x<=de&&se.y>=ce&&se.y<=Ce&&se!==y&&se!==M&&Uv(R,G,z,X,B,ie,se.x,se.y)&&mi(se.prev,se,se.next)>=0))return!1;se=se.nextZ}for(;Ge&&Ge.z>=ke;){if(Ge.x>=ae&&Ge.x<=de&&Ge.y>=ce&&Ge.y<=Ce&&Ge!==y&&Ge!==M&&Uv(R,G,z,X,B,ie,Ge.x,Ge.y)&&mi(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.prevZ}for(;se&&se.z<=et;){if(se.x>=ae&&se.x<=de&&se.y>=ce&&se.y<=Ce&&se!==y&&se!==M&&Uv(R,G,z,X,B,ie,se.x,se.y)&&mi(se.prev,se,se.next)>=0)return!1;se=se.nextZ}return!0}function CW(d,l){let h=d;do{const p=h.prev,y=h.next.next;!Cp(p,y)&&vk(p,h,h.next,y)&&$v(p,y)&&$v(y,p)&&(l.push(p.i,h.i,y.i),Vv(h),Vv(h.next),h=d=y),h=h.next}while(h!==d);return Bd(h)}function EW(d,l,h,p,y,S){let M=d;do{let R=M.next.next;for(;R!==M.prev;){if(M.i!==R.i&&RW(M,R)){let z=yk(M,R);return M=Bd(M,M.next),z=Bd(z,z.next),Bv(M,l,h,p,y,S,0),void Bv(z,l,h,p,y,S,0)}R=R.next}M=M.next}while(M!==d)}function TW(d,l){let h=d.x-l.x;return h===0&&(h=d.y-l.y,h===0)&&(h=(d.next.y-d.y)/(d.next.x-d.x)-(l.next.y-l.y)/(l.next.x-l.x)),h}function PW(d,l){const h=function(y,S){let M=S;const R=y.x,z=y.y;let B,G=-1/0;if(Cp(y,M))return M;do{if(Cp(y,M.next))return M.next;if(z<=M.y&&z>=M.next.y&&M.next.y!==M.y){const de=M.x+(z-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(de<=R&&de>G&&(G=de,B=M.x<M.next.x?M:M.next,de===R))return B}M=M.next}while(M!==S);if(!B)return null;const X=B,ie=B.x,ae=B.y;let ce=1/0;M=B;do{if(R>=M.x&&M.x>=ie&&R!==M.x&&gk(z<ae?R:G,z,ie,ae,z<ae?G:R,z,M.x,M.y)){const de=Math.abs(z-M.y)/(R-M.x);$v(M,y)&&(de<ce||de===ce&&(M.x>B.x||M.x===B.x&&AW(B,M)))&&(B=M,ce=de)}M=M.next}while(M!==X);return B}(d,l);if(!h)return l;const p=yk(h,d);return Bd(p,p.next),Bd(h,h.next)}function AW(d,l){return mi(d.prev,d,l.prev)<0&&mi(l.next,d,d.next)<0}function QC(d,l,h,p,y){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-h)*y|0)|d<<8))|d<<4))|d<<2))|d<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-p)*y|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function IW(d){let l=d,h=d;do(l.x<h.x||l.x===h.x&&l.y<h.y)&&(h=l),l=l.next;while(l!==d);return h}function gk(d,l,h,p,y,S,M,R){return(y-M)*(l-R)>=(d-M)*(S-R)&&(d-M)*(p-R)>=(h-M)*(l-R)&&(h-M)*(S-R)>=(y-M)*(p-R)}function Uv(d,l,h,p,y,S,M,R){return!(d===M&&l===R)&&gk(d,l,h,p,y,S,M,R)}function RW(d,l){return d.next.i!==l.i&&d.prev.i!==l.i&&!function(h,p){let y=h;do{if(y.i!==h.i&&y.next.i!==h.i&&y.i!==p.i&&y.next.i!==p.i&&vk(y,y.next,h,p))return!0;y=y.next}while(y!==h);return!1}(d,l)&&($v(d,l)&&$v(l,d)&&function(h,p){let y=h,S=!1;const M=(h.x+p.x)/2,R=(h.y+p.y)/2;do y.y>R!=y.next.y>R&&y.next.y!==y.y&&M<(y.next.x-y.x)*(R-y.y)/(y.next.y-y.y)+y.x&&(S=!S),y=y.next;while(y!==h);return S}(d,l)&&(mi(d.prev,d,l.prev)||mi(d,l.prev,l))||Cp(d,l)&&mi(d.prev,d,d.next)>0&&mi(l.prev,l,l.next)>0)}function mi(d,l,h){return(l.y-d.y)*(h.x-l.x)-(l.x-d.x)*(h.y-l.y)}function Cp(d,l){return d.x===l.x&&d.y===l.y}function vk(d,l,h,p){const y=i1(mi(d,l,h)),S=i1(mi(d,l,p)),M=i1(mi(h,p,d)),R=i1(mi(h,p,l));return y!==S&&M!==R||!(y!==0||!r1(d,h,l))||!(S!==0||!r1(d,p,l))||!(M!==0||!r1(h,d,p))||!(R!==0||!r1(h,l,p))}function r1(d,l,h){return l.x<=Math.max(d.x,h.x)&&l.x>=Math.min(d.x,h.x)&&l.y<=Math.max(d.y,h.y)&&l.y>=Math.min(d.y,h.y)}function i1(d){return d>0?1:d<0?-1:0}function $v(d,l){return mi(d.prev,d,d.next)<0?mi(d,l,d.next)>=0&&mi(d,d.prev,l)>=0:mi(d,l,d.prev)<0||mi(d,d.next,l)<0}function yk(d,l){const h=e2(d.i,d.x,d.y),p=e2(l.i,l.x,l.y),y=d.next,S=l.prev;return d.next=l,l.prev=d,h.next=y,y.prev=h,p.next=h,h.prev=p,S.next=p,p.prev=S,p}function _k(d,l,h,p){const y=e2(d,l,h);return p?(y.next=p.next,y.prev=p,p.next.prev=y,p.next=y):(y.prev=y,y.next=y),y}function Vv(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function e2(d,l,h){return{i:d,x:l,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Ep{constructor(l,h){if(h>l)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=l,this._minGranularity=h}getGranularityForZoomLevel(l){return Math.max(Math.floor(this._baseZoomGranularity/(1<<l)),this._minGranularity,1)}}class o1{constructor(l){this.fill=l.fill,this.line=l.line,this.tile=l.tile,this.stencil=l.stencil,this.circle=l.circle}}o1.noSubdivision=new o1({fill:new Ep(0,0),line:new Ep(0,0),tile:new Ep(0,0),stencil:new Ep(0,0),circle:1}),xn("SubdivisionGranularityExpression",Ep),xn("SubdivisionGranularitySetting",o1);const Tp=-32768,jv=32767;class LW{constructor(l,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=l,this._granularityCellSize=ct/l,this._canonical=h}_getKey(l,h){return(l+=32768)<<16|h+32768}_vertexToIndex(l,h){if(l<-32768||h<-32768||l>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const p=0|Math.round(l),y=0|Math.round(h),S=this._getKey(p,y);if(this._vertexDictionary.has(S))return this._vertexDictionary.get(S);const M=this._vertexBuffer.length/2;return this._vertexDictionary.set(S,M),this._vertexBuffer.push(p,y),M}_subdivideTrianglesScanline(l){if(this._granularity<2)return function(y,S){const M=[];for(let R=0;R<S.length;R+=3){const z=S[R],B=S[R+1],G=S[R+2],X=y[2*z],ie=y[2*z+1];(y[2*B]-X)*(y[2*G+1]-ie)-(y[2*B+1]-ie)*(y[2*G]-X)>0?(M.push(z),M.push(G),M.push(B)):(M.push(z),M.push(B),M.push(G))}return M}(this._vertexBuffer,l);const h=[],p=l.length;for(let y=0;y<p;y+=3){const S=[l[y+0],l[y+1],l[y+2]],M=[this._vertexBuffer[2*l[y+0]+0],this._vertexBuffer[2*l[y+0]+1],this._vertexBuffer[2*l[y+1]+0],this._vertexBuffer[2*l[y+1]+1],this._vertexBuffer[2*l[y+2]+0],this._vertexBuffer[2*l[y+2]+1]];let R=1/0,z=1/0,B=-1/0,G=-1/0;for(let de=0;de<3;de++){const Ce=M[2*de],ke=M[2*de+1];R=Math.min(R,Ce),B=Math.max(B,Ce),z=Math.min(z,ke),G=Math.max(G,ke)}if(R===B||z===G)continue;const X=Math.floor(R/this._granularityCellSize),ie=Math.ceil(B/this._granularityCellSize),ae=Math.floor(z/this._granularityCellSize),ce=Math.ceil(G/this._granularityCellSize);if(X!==ie||ae!==ce)for(let de=ae;de<ce;de++){const Ce=this._scanlineGenerateVertexRingForCellRow(de,M,S);kW(this._vertexBuffer,Ce,h)}else h.push(...S)}return h}_scanlineGenerateVertexRingForCellRow(l,h,p){const y=l*this._granularityCellSize,S=y+this._granularityCellSize,M=[];for(let R=0;R<3;R++){const z=h[2*R],B=h[2*R+1],G=h[2*(R+1)%6],X=h[(2*(R+1)+1)%6],ie=h[2*(R+2)%6],ae=h[(2*(R+2)+1)%6],ce=G-z,de=X-B,Ce=ce===0,ke=de===0,et=(y-B)/de,Ge=(S-B)/de,se=Math.min(et,Ge),we=Math.max(et,Ge);if(!ke&&(se>=1||we<=0)||ke&&(B<y||B>S)){X>=y&&X<=S&&M.push(p[(R+1)%3]);continue}!ke&&se>0&&M.push(this._vertexToIndex(z+ce*se,B+de*se));const Xe=z+ce*Math.max(se,0),mt=z+ce*Math.min(we,1);Ce||this._generateIntraEdgeVertices(M,z,B,G,X,Xe,mt),!ke&&we<1&&M.push(this._vertexToIndex(z+ce*we,B+de*we)),(ke||X>=y&&X<=S)&&M.push(p[(R+1)%3]),!ke&&(X<=y||X>=S)&&this._generateInterEdgeVertices(M,z,B,G,X,ie,ae,mt,y,S)}return M}_generateIntraEdgeVertices(l,h,p,y,S,M,R){const z=y-h,B=S-p,G=B===0,X=G?Math.min(h,y):Math.min(M,R),ie=G?Math.max(h,y):Math.max(M,R),ae=Math.floor(X/this._granularityCellSize)+1,ce=Math.ceil(ie/this._granularityCellSize)-1;if(G?h<y:M<R)for(let de=ae;de<=ce;de++){const Ce=de*this._granularityCellSize;l.push(this._vertexToIndex(Ce,p+B*(Ce-h)/z))}else for(let de=ce;de>=ae;de--){const Ce=de*this._granularityCellSize;l.push(this._vertexToIndex(Ce,p+B*(Ce-h)/z))}}_generateInterEdgeVertices(l,h,p,y,S,M,R,z,B,G){const X=S-p,ie=M-y,ae=R-S,ce=(B-S)/ae,de=(G-S)/ae,Ce=Math.min(ce,de),ke=Math.max(ce,de),et=y+ie*Ce;let Ge=Math.floor(Math.min(et,z)/this._granularityCellSize)+1,se=Math.ceil(Math.max(et,z)/this._granularityCellSize)-1,we=z<et;const Xe=ae===0;if(Xe&&(R===B||R===G))return;if(Xe||Ce>=1||ke<=0){const $t=p-R,bt=M+(h-M)*Math.min((B-R)/$t,(G-R)/$t);Ge=Math.floor(Math.min(bt,z)/this._granularityCellSize)+1,se=Math.ceil(Math.max(bt,z)/this._granularityCellSize)-1,we=z<bt}const mt=X>0?G:B;if(we)for(let $t=Ge;$t<=se;$t++)l.push(this._vertexToIndex($t*this._granularityCellSize,mt));else for(let $t=se;$t>=Ge;$t--)l.push(this._vertexToIndex($t*this._granularityCellSize,mt))}_generateOutline(l){const h=[];for(const p of l){const y=Ud(p,this._granularity,!0),S=this._pointArrayToIndices(y),M=[];for(let R=1;R<S.length;R++)M.push(S[R-1]),M.push(S[R]);h.push(M)}return h}_handlePoles(l){let h=!1,p=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(p=!0)),(h||p)&&this._fillPoles(l,h,p)}_ensureNoPoleVertices(){const l=this._vertexBuffer;for(let h=0;h<l.length;h+=2){const p=l[h+1];p===Tp&&(l[h+1]=-32767),p===jv&&(l[h+1]=32766)}}_generatePoleQuad(l,h,p,y,S,M){y>S!=(M===Tp)?(l.push(h),l.push(p),l.push(this._vertexToIndex(y,M)),l.push(p),l.push(this._vertexToIndex(S,M)),l.push(this._vertexToIndex(y,M))):(l.push(p),l.push(h),l.push(this._vertexToIndex(y,M)),l.push(this._vertexToIndex(S,M)),l.push(p),l.push(this._vertexToIndex(y,M)))}_fillPoles(l,h,p){const y=this._vertexBuffer,S=ct,M=l.length;for(let R=2;R<M;R+=3){const z=l[R-2],B=l[R-1],G=l[R],X=y[2*z],ie=y[2*z+1],ae=y[2*B],ce=y[2*B+1],de=y[2*G],Ce=y[2*G+1];h&&(ie===0&&ce===0&&this._generatePoleQuad(l,z,B,X,ae,Tp),ce===0&&Ce===0&&this._generatePoleQuad(l,B,G,ae,de,Tp),Ce===0&&ie===0&&this._generatePoleQuad(l,G,z,de,X,Tp)),p&&(ie===S&&ce===S&&this._generatePoleQuad(l,z,B,X,ae,jv),ce===S&&Ce===S&&this._generatePoleQuad(l,B,G,ae,de,jv),Ce===S&&ie===S&&this._generatePoleQuad(l,G,z,de,X,jv))}}_initializeVertices(l){for(let h=0;h<l.length;h+=2)this._vertexToIndex(l[h],l[h+1])}subdividePolygonInternal(l,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:p,holeIndices:y}=function(R){const z=[],B=[];for(const G of R)if(G.length!==0){G!==R[0]&&z.push(B.length/2);for(let X=0;X<G.length;X++)B.push(G[X].x),B.push(G[X].y)}return{flattened:B,holeIndices:z}}(l);let S;this._initializeVertices(p);try{const R=function(B,G,X=2){const ie=G&&G.length,ae=ie?G[0]*X:B.length;let ce=mk(B,0,ae,X,!0);const de=[];if(!ce||ce.next===ce.prev)return de;let Ce,ke,et;if(ie&&(ce=function(Ge,se,we,Xe){const mt=[];for(let $t=0,bt=se.length;$t<bt;$t++){const Mt=mk(Ge,se[$t]*Xe,$t<bt-1?se[$t+1]*Xe:Ge.length,Xe,!1);Mt===Mt.next&&(Mt.steiner=!0),mt.push(IW(Mt))}mt.sort(TW);for(let $t=0;$t<mt.length;$t++)we=PW(mt[$t],we);return we}(B,G,ce,X)),B.length>80*X){Ce=1/0,ke=1/0;let Ge=-1/0,se=-1/0;for(let we=X;we<ae;we+=X){const Xe=B[we],mt=B[we+1];Xe<Ce&&(Ce=Xe),mt<ke&&(ke=mt),Xe>Ge&&(Ge=Xe),mt>se&&(se=mt)}et=Math.max(Ge-Ce,se-ke),et=et!==0?32767/et:0}return Bv(ce,de,X,Ce,ke,et,0),de}(p,y),z=this._convertIndices(p,R);S=this._subdivideTrianglesScanline(z)}catch(R){console.error(R)}let M=[];return h&&(M=this._generateOutline(l)),this._ensureNoPoleVertices(),this._handlePoles(S),{verticesFlattened:this._vertexBuffer,indicesTriangles:S,indicesLineList:M}}_convertIndices(l,h){const p=[];for(let y=0;y<h.length;y++)p.push(this._vertexToIndex(l[2*h[y]],l[2*h[y]+1]));return p}_pointArrayToIndices(l){const h=[];for(let p=0;p<l.length;p++){const y=l[p];h.push(this._vertexToIndex(y.x,y.y))}return h}}function xk(d,l,h,p=!0){return new LW(h,l).subdividePolygonInternal(d,p)}function Ud(d,l,h=!1){if(!d||d.length<1)return[];if(d.length<2)return[];const p=d[0],y=d[d.length-1],S=h&&(p.x!==y.x||p.y!==y.y);if(l<2)return S?[...d,d[0]]:[...d];const M=Math.floor(ct/l),R=[];R.push(new A(d[0].x,d[0].y));const z=d.length,B=S?z:z-1;for(let G=0;G<B;G++){const X=d[G],ie=G<z-1?d[G+1]:d[0],ae=X.x,ce=X.y,de=ie.x,Ce=ie.y,ke=ae!==de,et=ce!==Ce;if(!ke&&!et)continue;const Ge=de-ae,se=Ce-ce,we=Math.abs(Ge),Xe=Math.abs(se);let mt=ae,$t=ce;for(;;){const Mt=Ge>0?(Math.floor(mt/M)+1)*M:(Math.ceil(mt/M)-1)*M,Jt=se>0?(Math.floor($t/M)+1)*M:(Math.ceil($t/M)-1)*M,jt=Math.abs(mt-Mt),en=Math.abs($t-Jt),Pt=Math.abs(mt-de),Cn=Math.abs($t-Ce),$n=ke?jt/we:Number.POSITIVE_INFINITY,Bn=et?en/Xe:Number.POSITIVE_INFINITY;if((Pt<=jt||!ke)&&(Cn<=en||!et))break;if($n<Bn&&ke||!et){mt=Mt,$t+=se*$n;const kn=new A(mt,Math.round($t));R[R.length-1].x===kn.x&&R[R.length-1].y===kn.y||R.push(kn)}else{mt+=Ge*Bn,$t=Jt;const kn=new A(Math.round(mt),$t);R[R.length-1].x===kn.x&&R[R.length-1].y===kn.y||R.push(kn)}}const bt=new A(de,Ce);R[R.length-1].x===bt.x&&R[R.length-1].y===bt.y||R.push(bt)}return R}function kW(d,l,h){if(l.length===0)throw new Error("Subdivision vertex ring is empty.");let p=0,y=d[2*l[0]];for(let z=1;z<l.length;z++){const B=d[2*l[z]];B<y&&(y=B,p=z)}const S=l.length;let M=p,R=(M+1)%S;for(;;){const z=M-1>=0?M-1:S-1,B=(R+1)%S,G=d[2*l[z]],X=d[2*l[B]],ie=d[2*l[M]],ae=d[2*l[M]+1],ce=d[2*l[R]+1];let de=!1;if(G<X)de=!0;else if(G>X)de=!1;else{const Ce=ce-ae,ke=-(d[2*l[R]]-ie),et=ae<ce?1:-1;((G-ie)*Ce+(d[2*l[z]+1]-ae)*ke)*et>((X-ie)*Ce+(d[2*l[B]+1]-ae)*ke)*et&&(de=!0)}if(de){const Ce=l[z],ke=l[M],et=l[R];Ce!==ke&&Ce!==et&&ke!==et&&h.push(et,ke,Ce),M--,M<0&&(M=S-1)}else{const Ce=l[B],ke=l[M],et=l[R];Ce!==ke&&Ce!==et&&ke!==et&&h.push(et,ke,Ce),R++,R>=S&&(R=0)}if(z===B)break}}function bk(d,l,h,p,y,S,M,R,z){const B=y.length/2,G=M&&R&&z;if(B<ur.MAX_VERTEX_ARRAY_LENGTH){const X=l.prepareSegment(B,h,p),ie=X.vertexLength;for(let de=0;de<S.length;de+=3)p.emplaceBack(ie+S[de],ie+S[de+1],ie+S[de+2]);let ae,ce;X.vertexLength+=B,X.primitiveLength+=S.length/3,G&&(ce=M.prepareSegment(B,h,R),ae=ce.vertexLength,ce.vertexLength+=B);for(let de=0;de<y.length;de+=2)d(y[de],y[de+1]);if(G)for(let de=0;de<z.length;de++){const Ce=z[de];for(let ke=1;ke<Ce.length;ke+=2)R.emplaceBack(ae+Ce[ke-1],ae+Ce[ke]);ce.primitiveLength+=Ce.length/2}}else(function(X,ie,ae,ce,de,Ce){const ke=[];for(let Xe=0;Xe<ce.length/2;Xe++)ke.push(-1);const et={count:0};let Ge=0,se=X.getOrCreateLatestSegment(ie,ae),we=se.vertexLength;for(let Xe=2;Xe<de.length;Xe+=3){const mt=de[Xe-2],$t=de[Xe-1],bt=de[Xe];let Mt=ke[mt]<Ge,Jt=ke[$t]<Ge,jt=ke[bt]<Ge;se.vertexLength+((Mt?1:0)+(Jt?1:0)+(jt?1:0))>ur.MAX_VERTEX_ARRAY_LENGTH&&(se=X.createNewSegment(ie,ae),Ge=et.count,Mt=!0,Jt=!0,jt=!0,we=0);const en=Hv(ke,ce,Ce,et,mt,Mt,se),Pt=Hv(ke,ce,Ce,et,$t,Jt,se),Cn=Hv(ke,ce,Ce,et,bt,jt,se);ae.emplaceBack(we+en-Ge,we+Pt-Ge,we+Cn-Ge),se.primitiveLength++}})(l,h,p,y,S,d),G&&function(X,ie,ae,ce,de,Ce){const ke=[];for(let Xe=0;Xe<ce.length/2;Xe++)ke.push(-1);const et={count:0};let Ge=0,se=X.getOrCreateLatestSegment(ie,ae),we=se.vertexLength;for(let Xe=0;Xe<de.length;Xe++){const mt=de[Xe];for(let $t=1;$t<de[Xe].length;$t+=2){const bt=mt[$t-1],Mt=mt[$t];let Jt=ke[bt]<Ge,jt=ke[Mt]<Ge;se.vertexLength+((Jt?1:0)+(jt?1:0))>ur.MAX_VERTEX_ARRAY_LENGTH&&(se=X.createNewSegment(ie,ae),Ge=et.count,Jt=!0,jt=!0,we=0);const en=Hv(ke,ce,Ce,et,bt,Jt,se),Pt=Hv(ke,ce,Ce,et,Mt,jt,se);ae.emplaceBack(we+en-Ge,we+Pt-Ge),se.primitiveLength++}}}(M,h,R,y,z,d),l.forceNewSegmentOnNextPrepare(),M==null||M.forceNewSegmentOnNextPrepare()}function Hv(d,l,h,p,y,S,M){if(S){const R=p.count;return h(l[2*y],l[2*y+1]),d[y]=p.count,p.count++,M.vertexLength++,R}return d[y]}class t2{constructor(l){this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _t,this.indexArray=new Dr,this.indexArray2=new Ar,this.programConfigurations=new Wl(l.layers,l.zoom),this.segments=new ur,this.segments2=new ur,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,p){this.hasPattern=KC("fill",this.layers,h);const y=this.layers[0].layout.get("fill-sort-key"),S=!y.isConstant(),M=[];for(const{feature:R,id:z,index:B,sourceLayerIndex:G}of l){const X=this.layers[0]._featureFilter.needGeometry,ie=Nd(R,X);if(!this.layers[0]._featureFilter.filter(new Xr(this.zoom,{globalState:this.globalState}),ie,p))continue;const ae=S?y.evaluate(ie,{},p,h.availableImages):void 0,ce={id:z,properties:R.properties,type:R.type,sourceLayerIndex:G,index:B,geometry:X?ie.geometry:Fd(R),patterns:{},sortKey:ae};M.push(ce)}S&&M.sort((R,z)=>R.sortKey-z.sortKey);for(const R of M){const{geometry:z,index:B,sourceLayerIndex:G}=R;if(this.hasPattern){const X=JC("fill",this.layers,R,this.zoom,h);this.patternFeatures.push(X)}else this.addFeature(R,z,B,p,{},h.subdivisionGranularity);h.featureIndex.insert(l[B].feature,z,B,G,this.index)}}update(l,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,p)}addFeatures(l,h,p){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,h,p,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,wW),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,h,p,y,S,M){for(const R of Jf(h,500)){const z=xk(R,y,M.fill.getGranularityForZoomLevel(y.z)),B=this.layoutVertexArray;bk((G,X)=>{B.emplaceBack(G,X)},this.segments,this.layoutVertexArray,this.indexArray,z.verticesFlattened,z.indicesTriangles,this.segments2,this.indexArray2,z.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,S,y)}}let wk,Sk;xn("FillBucket",t2,{omit:["layers","patternFeatures"]});var DW={get paint(){return Sk=Sk||new ko({"fill-antialias":new En(Oe.paint_fill["fill-antialias"]),"fill-opacity":new Vn(Oe.paint_fill["fill-opacity"]),"fill-color":new Vn(Oe.paint_fill["fill-color"]),"fill-outline-color":new Vn(Oe.paint_fill["fill-outline-color"]),"fill-translate":new En(Oe.paint_fill["fill-translate"]),"fill-translate-anchor":new En(Oe.paint_fill["fill-translate-anchor"]),"fill-pattern":new bp(Oe.paint_fill["fill-pattern"])})},get layout(){return wk=wk||new ko({"fill-sort-key":new Vn(Oe.layout_fill["fill-sort-key"])})}};class zW extends eo{constructor(l){super(l,DW)}recalculate(l,h){super.recalculate(l,h);const p=this.paint._values["fill-outline-color"];p.value.kind==="constant"&&p.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new t2(l)}queryRadius(){return t1(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:l,geometry:h,transform:p,pixelsToTileUnits:y}){return tk(n1(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-p.bearingInRadians,y),h)}isTileClipped(){return!0}}const OW=si([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),FW=si([{name:"a_centroid",components:2,type:"Int16"}],4),{members:NW}=OW;var n2,Mk,r2,Ck,i2,Ek,Tk,s1={};function Pk(){if(Mk)return n2;Mk=1;var d=x();function l(y,S,M,R,z){this.properties={},this.extent=M,this.type=0,this._pbf=y,this._geometry=-1,this._keys=R,this._values=z,y.readFields(h,this,S)}function h(y,S,M){y==1?S.id=M.readVarint():y==2?function(R,z){for(var B=R.readVarint()+R.pos;R.pos<B;){var G=z._keys[R.readVarint()],X=z._values[R.readVarint()];z.properties[G]=X}}(M,S):y==3?S.type=M.readVarint():y==4&&(S._geometry=M.pos)}function p(y){for(var S,M,R=0,z=0,B=y.length,G=B-1;z<B;G=z++)R+=((M=y[G]).x-(S=y[z]).x)*(S.y+M.y);return R}return n2=l,l.types=["Unknown","Point","LineString","Polygon"],l.prototype.loadGeometry=function(){var y=this._pbf;y.pos=this._geometry;for(var S,M=y.readVarint()+y.pos,R=1,z=0,B=0,G=0,X=[];y.pos<M;){if(z<=0){var ie=y.readVarint();R=7&ie,z=ie>>3}if(z--,R===1||R===2)B+=y.readSVarint(),G+=y.readSVarint(),R===1&&(S&&X.push(S),S=[]),S.push(new d(B,G));else{if(R!==7)throw new Error("unknown command "+R);S&&S.push(S[0].clone())}}return S&&X.push(S),X},l.prototype.bbox=function(){var y=this._pbf;y.pos=this._geometry;for(var S=y.readVarint()+y.pos,M=1,R=0,z=0,B=0,G=1/0,X=-1/0,ie=1/0,ae=-1/0;y.pos<S;){if(R<=0){var ce=y.readVarint();M=7&ce,R=ce>>3}if(R--,M===1||M===2)(z+=y.readSVarint())<G&&(G=z),z>X&&(X=z),(B+=y.readSVarint())<ie&&(ie=B),B>ae&&(ae=B);else if(M!==7)throw new Error("unknown command "+M)}return[G,ie,X,ae]},l.prototype.toGeoJSON=function(y,S,M){var R,z,B=this.extent*Math.pow(2,M),G=this.extent*y,X=this.extent*S,ie=this.loadGeometry(),ae=l.types[this.type];function ce(ke){for(var et=0;et<ke.length;et++){var Ge=ke[et];ke[et]=[360*(Ge.x+G)/B-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ge.y+X)/B)*Math.PI/180))-90]}}switch(this.type){case 1:var de=[];for(R=0;R<ie.length;R++)de[R]=ie[R][0];ce(ie=de);break;case 2:for(R=0;R<ie.length;R++)ce(ie[R]);break;case 3:for(ie=function(ke){var et=ke.length;if(et<=1)return[ke];for(var Ge,se,we=[],Xe=0;Xe<et;Xe++){var mt=p(ke[Xe]);mt!==0&&(se===void 0&&(se=mt<0),se===mt<0?(Ge&&we.push(Ge),Ge=[ke[Xe]]):Ge.push(ke[Xe]))}return Ge&&we.push(Ge),we}(ie),R=0;R<ie.length;R++)for(z=0;z<ie[R].length;z++)ce(ie[R][z])}ie.length===1?ie=ie[0]:ae="Multi"+ae;var Ce={type:"Feature",geometry:{type:ae,coordinates:ie},properties:this.properties};return"id"in this&&(Ce.id=this.id),Ce},n2}function Ak(){if(Ck)return r2;Ck=1;var d=Pk();function l(p,y){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(h,this,y),this.length=this._features.length}function h(p,y,S){p===15?y.version=S.readVarint():p===1?y.name=S.readString():p===5?y.extent=S.readVarint():p===2?y._features.push(S.pos):p===3?y._keys.push(S.readString()):p===4&&y._values.push(function(M){for(var R=null,z=M.readVarint()+M.pos;M.pos<z;){var B=M.readVarint()>>3;R=B===1?M.readString():B===2?M.readFloat():B===3?M.readDouble():B===4?M.readVarint64():B===5?M.readVarint():B===6?M.readSVarint():B===7?M.readBoolean():null}return R}(S))}return r2=l,l.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var y=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,y,this.extent,this._keys,this._values)},r2}function Ik(){return Tk||(Tk=1,s1.VectorTile=function(){if(Ek)return i2;Ek=1;var d=Ak();function l(h,p,y){if(h===3){var S=new d(y,y.readVarint()+y.pos);S.length&&(p[S.name]=S)}}return i2=function(h,p){this.layers=h.readFields(l,{},p)},i2}(),s1.VectorTileFeature=Pk(),s1.VectorTileLayer=Ak()),s1}var Gv=f(Ik());const BW=Gv.VectorTileFeature.types,o2=Math.pow(2,13);function Wv(d,l,h,p,y,S,M,R){d.emplaceBack(l,h,2*Math.floor(p*o2)+M,y*o2*2,S*o2*2,Math.round(R))}class s2{constructor(l){this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new sn,this.centroidVertexArray=new ht,this.indexArray=new Dr,this.programConfigurations=new Wl(l.layers,l.zoom),this.segments=new ur,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,p){this.features=[],this.hasPattern=KC("fill-extrusion",this.layers,h);for(const{feature:y,id:S,index:M,sourceLayerIndex:R}of l){const z=this.layers[0]._featureFilter.needGeometry,B=Nd(y,z);if(!this.layers[0]._featureFilter.filter(new Xr(this.zoom,{globalState:this.globalState}),B,p))continue;const G={id:S,sourceLayerIndex:R,index:M,geometry:z?B.geometry:Fd(y),properties:y.properties,type:y.type,patterns:{}};this.hasPattern?this.features.push(JC("fill-extrusion",this.layers,G,this.zoom,h)):this.addFeature(G,G.geometry,M,p,{},h.subdivisionGranularity),h.featureIndex.insert(y,G.geometry,M,R,this.index,!0)}}addFeatures(l,h,p){for(const y of this.features){const{geometry:S}=y;this.addFeature(y,S,y.index,h,p,l.subdivisionGranularity)}}update(l,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,NW),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,FW.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,h,p,y,S,M){for(const R of Jf(h,500)){const z={x:0,y:0,sampleCount:0},B=this.layoutVertexArray.length;this.processPolygon(z,y,l,R,M);const G=this.layoutVertexArray.length-B,X=Math.floor(z.x/z.sampleCount),ie=Math.floor(z.y/z.sampleCount);for(let ae=0;ae<G;ae++)this.centroidVertexArray.emplaceBack(X,ie)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,S,y)}processPolygon(l,h,p,y,S){if(y.length<1||Rk(y[0]))return;for(const X of y)X.length!==0&&UW(l,X);const M={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},R=S.fill.getGranularityForZoomLevel(h.z),z=BW[p.type]==="Polygon";for(const X of y){if(X.length===0||Rk(X))continue;const ie=Ud(X,R,z);this._generateSideFaces(ie,M)}if(!z)return;const B=xk(y,h,R,!1),G=this.layoutVertexArray;bk((X,ie)=>{Wv(G,X,ie,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,B.verticesFlattened,B.indicesTriangles)}_generateSideFaces(l,h){let p=0;for(let y=1;y<l.length;y++){const S=l[y],M=l[y-1];if($W(S,M))continue;h.segment.vertexLength+4>ur.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const R=S.sub(M)._perp()._unit(),z=M.dist(S);p+z>32768&&(p=0),Wv(this.layoutVertexArray,S.x,S.y,R.x,R.y,0,0,p),Wv(this.layoutVertexArray,S.x,S.y,R.x,R.y,0,1,p),p+=z,Wv(this.layoutVertexArray,M.x,M.y,R.x,R.y,0,0,p),Wv(this.layoutVertexArray,M.x,M.y,R.x,R.y,0,1,p);const B=h.segment.vertexLength;this.indexArray.emplaceBack(B,B+2,B+1),this.indexArray.emplaceBack(B+1,B+2,B+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function UW(d,l){for(let h=0;h<l.length;h++){const p=l[h];h===l.length-1&&l[0].x===p.x&&l[0].y===p.y||(d.x+=p.x,d.y+=p.y,d.sampleCount++)}}function $W(d,l){return d.x===l.x&&(d.x<0||d.x>ct)||d.y===l.y&&(d.y<0||d.y>ct)}function Rk(d){return d.every(l=>l.x<0)||d.every(l=>l.x>ct)||d.every(l=>l.y<0)||d.every(l=>l.y>ct)}let Lk;xn("FillExtrusionBucket",s2,{omit:["layers","features"]});var VW={get paint(){return Lk=Lk||new ko({"fill-extrusion-opacity":new En(Oe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Vn(Oe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new En(Oe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new En(Oe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new bp(Oe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Vn(Oe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Vn(Oe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new En(Oe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class jW extends eo{constructor(l){super(l,VW)}createBucket(l){return new s2(l)}queryRadius(){return t1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:p,geometry:y,transform:S,pixelsToTileUnits:M,pixelPosMatrix:R}){const z=n1(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-S.bearingInRadians,M),B=this.paint.get("fill-extrusion-height").evaluate(h,p),G=this.paint.get("fill-extrusion-base").evaluate(h,p),X=function(ae,ce){const de=[];for(const Ce of ae){const ke=[Ce.x,Ce.y,0,1];Se(ke,ke,ce),de.push(new A(ke[0]/ke[3],ke[1]/ke[3]))}return de}(z,R),ie=function(ae,ce,de,Ce){const ke=[],et=[],Ge=Ce[8]*ce,se=Ce[9]*ce,we=Ce[10]*ce,Xe=Ce[11]*ce,mt=Ce[8]*de,$t=Ce[9]*de,bt=Ce[10]*de,Mt=Ce[11]*de;for(const Jt of ae){const jt=[],en=[];for(const Pt of Jt){const Cn=Pt.x,$n=Pt.y,Bn=Ce[0]*Cn+Ce[4]*$n+Ce[12],kn=Ce[1]*Cn+Ce[5]*$n+Ce[13],ir=Ce[2]*Cn+Ce[6]*$n+Ce[14],ai=Ce[3]*Cn+Ce[7]*$n+Ce[15],Li=ir+we,_o=ai+Xe,ta=Bn+mt,hs=kn+$t,io=ir+bt,ri=ai+Mt,Wi=new A((Bn+Ge)/_o,(kn+se)/_o);Wi.z=Li/_o,jt.push(Wi);const oo=new A(ta/ri,hs/ri);oo.z=io/ri,en.push(oo)}ke.push(jt),et.push(en)}return[ke,et]}(y,G,B,R);return function(ae,ce,de){let Ce=1/0;tk(de,ce)&&(Ce=kk(de,ce[0]));for(let ke=0;ke<ce.length;ke++){const et=ce[ke],Ge=ae[ke];for(let se=0;se<et.length-1;se++){const we=et[se],Xe=[we,et[se+1],Ge[se+1],Ge[se],we];ek(de,Xe)&&(Ce=Math.min(Ce,kk(de,Xe)))}}return Ce!==1/0&&Ce}(ie[0],ie[1],X)}}function qv(d,l){return d.x*l.x+d.y*l.y}function kk(d,l){if(d.length===1){let h=0;const p=l[h++];let y;for(;!y||p.equals(y);)if(y=l[h++],!y)return 1/0;for(;h<l.length;h++){const S=l[h],M=d[0],R=y.sub(p),z=S.sub(p),B=M.sub(p),G=qv(R,R),X=qv(R,z),ie=qv(z,z),ae=qv(B,R),ce=qv(B,z),de=G*ie-X*X,Ce=(ie*ae-X*ce)/de,ke=(G*ce-X*ae)/de,et=p.z*(1-Ce-ke)+y.z*Ce+S.z*ke;if(isFinite(et))return et}return 1/0}{let h=1/0;for(const p of l)h=Math.min(h,p.z);return h}}const HW=si([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:GW}=HW,WW=si([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:qW}=WW,XW=Gv.VectorTileFeature.types,ZW=Math.cos(Math.PI/180*37.5),Dk=Math.pow(2,14)/.5;class a2{constructor(l){this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(h=>h.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new rn,this.layoutVertexArray2=new Vt,this.indexArray=new Dr,this.programConfigurations=new Wl(l.layers,l.zoom),this.segments=new ur,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(l,h,p){this.hasPattern=KC("line",this.layers,h);const y=this.layers[0].layout.get("line-sort-key"),S=!y.isConstant(),M=[];for(const{feature:R,id:z,index:B,sourceLayerIndex:G}of l){const X=this.layers[0]._featureFilter.needGeometry,ie=Nd(R,X);if(!this.layers[0]._featureFilter.filter(new Xr(this.zoom,{globalState:this.globalState}),ie,p))continue;const ae=S?y.evaluate(ie,{},p):void 0,ce={id:z,properties:R.properties,type:R.type,sourceLayerIndex:G,index:B,geometry:X?ie.geometry:Fd(R),patterns:{},sortKey:ae};M.push(ce)}S&&M.sort((R,z)=>R.sortKey-z.sortKey);for(const R of M){const{geometry:z,index:B,sourceLayerIndex:G}=R;if(this.hasPattern){const X=JC("line",this.layers,R,this.zoom,h);this.patternFeatures.push(X)}else this.addFeature(R,z,B,p,{},h.subdivisionGranularity);h.featureIndex.insert(l[B].feature,z,B,G,this.index)}}update(l,h,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,h,this.stateDependentLayers,p)}addFeatures(l,h,p){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,h,p,l.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,qW)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,GW),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,h,p,y,S,M){const R=this.layers[0].layout,z=R.get("line-join").evaluate(l,{}),B=R.get("line-cap"),G=R.get("line-miter-limit"),X=R.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const ie of h)this.addLine(ie,l,z,B,G,X,y,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,S,y)}addLine(l,h,p,y,S,M,R,z){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,l=Ud(l,R?z.line.getGranularityForZoomLevel(R.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ge=0;Ge<l.length-1;Ge++)this.totalDistance+=l[Ge].dist(l[Ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const B=XW[h.type]==="Polygon";let G=l.length;for(;G>=2&&l[G-1].equals(l[G-2]);)G--;let X=0;for(;X<G-1&&l[X].equals(l[X+1]);)X++;if(G<(B?3:2))return;p==="bevel"&&(S=1.05);const ie=this.overscaling<=16?122880/(512*this.overscaling):0,ae=this.segments.prepareSegment(10*G,this.layoutVertexArray,this.indexArray);let ce,de,Ce,ke,et;this.e1=this.e2=-1,B&&(ce=l[G-2],et=l[X].sub(ce)._unit()._perp());for(let Ge=X;Ge<G;Ge++){if(Ce=Ge===G-1?B?l[X+1]:void 0:l[Ge+1],Ce&&l[Ge].equals(Ce))continue;et&&(ke=et),ce&&(de=ce),ce=l[Ge],et=Ce?Ce.sub(ce)._unit()._perp():ke,ke=ke||et;let se=ke.add(et);se.x===0&&se.y===0||se._unit();const we=ke.x*et.x+ke.y*et.y,Xe=se.x*et.x+se.y*et.y,mt=Xe!==0?1/Xe:1/0,$t=2*Math.sqrt(2-2*Xe),bt=Xe<ZW&&de&&Ce,Mt=ke.x*et.y-ke.y*et.x>0;if(bt&&Ge>X){const en=ce.dist(de);if(en>2*ie){const Pt=ce.sub(ce.sub(de)._mult(ie/en)._round());this.updateDistance(de,Pt),this.addCurrentVertex(Pt,ke,0,0,ae),de=Pt}}const Jt=de&&Ce;let jt=Jt?p:B?"butt":y;if(Jt&&jt==="round"&&(mt<M?jt="miter":mt<=2&&(jt="fakeround")),jt==="miter"&&mt>S&&(jt="bevel"),jt==="bevel"&&(mt>2&&(jt="flipbevel"),mt<S&&(jt="miter")),de&&this.updateDistance(de,ce),jt==="miter")se._mult(mt),this.addCurrentVertex(ce,se,0,0,ae);else if(jt==="flipbevel"){if(mt>100)se=et.mult(-1);else{const en=mt*ke.add(et).mag()/ke.sub(et).mag();se._perp()._mult(en*(Mt?-1:1))}this.addCurrentVertex(ce,se,0,0,ae),this.addCurrentVertex(ce,se.mult(-1),0,0,ae)}else if(jt==="bevel"||jt==="fakeround"){const en=-Math.sqrt(mt*mt-1),Pt=Mt?en:0,Cn=Mt?0:en;if(de&&this.addCurrentVertex(ce,ke,Pt,Cn,ae),jt==="fakeround"){const $n=Math.round(180*$t/Math.PI/20);for(let Bn=1;Bn<$n;Bn++){let kn=Bn/$n;if(kn!==.5){const ai=kn-.5;kn+=kn*ai*(kn-1)*((1.0904+we*(we*(3.55645-1.43519*we)-3.2452))*ai*ai+(.848013+we*(.215638*we-1.06021)))}const ir=et.sub(ke)._mult(kn)._add(ke)._unit()._mult(Mt?-1:1);this.addHalfVertex(ce,ir.x,ir.y,!1,Mt,0,ae)}}Ce&&this.addCurrentVertex(ce,et,-Pt,-Cn,ae)}else if(jt==="butt")this.addCurrentVertex(ce,se,0,0,ae);else if(jt==="square"){const en=de?1:-1;this.addCurrentVertex(ce,se,en,en,ae)}else jt==="round"&&(de&&(this.addCurrentVertex(ce,ke,0,0,ae),this.addCurrentVertex(ce,ke,1,1,ae,!0)),Ce&&(this.addCurrentVertex(ce,et,-1,-1,ae,!0),this.addCurrentVertex(ce,et,0,0,ae)));if(bt&&Ge<G-1){const en=ce.dist(Ce);if(en>2*ie){const Pt=ce.add(Ce.sub(ce)._mult(ie/en)._round());this.updateDistance(ce,Pt),this.addCurrentVertex(Pt,et,0,0,ae),ce=Pt}}}}addCurrentVertex(l,h,p,y,S,M=!1){const R=h.y*y-h.x,z=-h.y-h.x*y;this.addHalfVertex(l,h.x+h.y*p,h.y-h.x*p,M,!1,p,S),this.addHalfVertex(l,R,z,M,!0,-y,S),this.distance>Dk/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,h,p,y,S,M))}addHalfVertex({x:l,y:h},p,y,S,M,R,z){const B=.5*(this.lineClips?this.scaledDistance*(Dk-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l<<1)+(S?1:0),(h<<1)+(M?1:0),Math.round(63*p)+128,Math.round(63*y)+128,1+(R===0?0:R<0?-1:1)|(63&B)<<2,B>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const G=z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,G,this.e2),z.primitiveLength++),M?this.e2=G:this.e1=G}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,h){this.distance+=l.dist(h),this.updateScaledDistance()}}let zk,Ok;xn("LineBucket",a2,{omit:["layers","patternFeatures"]});var Fk={get paint(){return Ok=Ok||new ko({"line-opacity":new Vn(Oe.paint_line["line-opacity"]),"line-color":new Vn(Oe.paint_line["line-color"]),"line-translate":new En(Oe.paint_line["line-translate"]),"line-translate-anchor":new En(Oe.paint_line["line-translate-anchor"]),"line-width":new Vn(Oe.paint_line["line-width"]),"line-gap-width":new Vn(Oe.paint_line["line-gap-width"]),"line-offset":new Vn(Oe.paint_line["line-offset"]),"line-blur":new Vn(Oe.paint_line["line-blur"]),"line-dasharray":new Av(Oe.paint_line["line-dasharray"]),"line-pattern":new bp(Oe.paint_line["line-pattern"]),"line-gradient":new Rd(Oe.paint_line["line-gradient"])})},get layout(){return zk=zk||new ko({"line-cap":new En(Oe.layout_line["line-cap"]),"line-join":new Vn(Oe.layout_line["line-join"]),"line-miter-limit":new En(Oe.layout_line["line-miter-limit"]),"line-round-limit":new En(Oe.layout_line["line-round-limit"]),"line-sort-key":new Vn(Oe.layout_line["line-sort-key"])})}};class YW extends Vn{possiblyEvaluate(l,h){return h=new Xr(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(l,h)}evaluate(l,h,p,y){return h=un({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(l,h,p,y)}}let a1;class KW extends eo{constructor(l){super(l,Fk),this.gradientVersion=0,a1||(a1=new YW(Fk.paint.properties["line-width"].specification),a1.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(p){return p._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof wu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,h){super.recalculate(l,h),this.paint._values["line-floorwidth"]=a1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new a2(l)}queryRadius(l){const h=l,p=Nk(Fv("line-width",this,h),Fv("line-gap-width",this,h)),y=Fv("line-offset",this,h);return p/2+Math.abs(y)+t1(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:l,feature:h,featureState:p,geometry:y,transform:S,pixelsToTileUnits:M}){const R=n1(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-S.bearingInRadians,M),z=M/2*Nk(this.paint.get("line-width").evaluate(h,p),this.paint.get("line-gap-width").evaluate(h,p)),B=this.paint.get("line-offset").evaluate(h,p);return B&&(y=function(G,X){const ie=[];for(let ae=0;ae<G.length;ae++){const ce=G[ae],de=[];for(let Ce=0;Ce<ce.length;Ce++){const ke=ce[Ce-1],et=ce[Ce],Ge=ce[Ce+1],se=Ce===0?new A(0,0):et.sub(ke)._unit()._perp(),we=Ce===ce.length-1?new A(0,0):Ge.sub(et)._unit()._perp(),Xe=se._add(we)._unit(),mt=Xe.x*we.x+Xe.y*we.y;mt!==0&&Xe._mult(1/mt),de.push(Xe._mult(X)._add(et))}ie.push(de)}return ie}(y,B*M)),function(G,X,ie){for(let ae=0;ae<X.length;ae++){const ce=X[ae];if(G.length>=3){for(let de=0;de<ce.length;de++)if(Mp(G,ce[de]))return!0}if(uW(G,ce,ie))return!0}return!1}(R,y,z)}isTileClipped(){return!0}}function Nk(d,l){return l>0?l+2*d:d}const JW=si([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),QW=si([{name:"a_projected_pos",components:3,type:"Float32"}],4);si([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const eq=si([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);si([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Bk=si([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),tq=si([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function nq(d,l,h){return d.sections.forEach(p=>{p.text=function(y,S,M){const R=S.layout.get("text-transform").evaluate(M,{});return R==="uppercase"?y=y.toLocaleUpperCase():R==="lowercase"&&(y=y.toLocaleLowerCase()),Bl.applyArabicShaping&&(y=Bl.applyArabicShaping(y)),y}(p.text,l,h)}),d}si([{name:"triangle",components:3,type:"Uint16"}]),si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),si([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),si([{type:"Float32",name:"offsetX"}]),si([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),si([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Xv={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Uk,l2,$k,Gi=24,c2={};function rq(){return Uk||(Uk=1,c2.read=function(d,l,h,p,y){var S,M,R=8*y-p-1,z=(1<<R)-1,B=z>>1,G=-7,X=h?y-1:0,ie=h?-1:1,ae=d[l+X];for(X+=ie,S=ae&(1<<-G)-1,ae>>=-G,G+=R;G>0;S=256*S+d[l+X],X+=ie,G-=8);for(M=S&(1<<-G)-1,S>>=-G,G+=p;G>0;M=256*M+d[l+X],X+=ie,G-=8);if(S===0)S=1-B;else{if(S===z)return M?NaN:1/0*(ae?-1:1);M+=Math.pow(2,p),S-=B}return(ae?-1:1)*M*Math.pow(2,S-p)},c2.write=function(d,l,h,p,y,S){var M,R,z,B=8*S-y-1,G=(1<<B)-1,X=G>>1,ie=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,ae=p?0:S-1,ce=p?1:-1,de=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(R=isNaN(l)?1:0,M=G):(M=Math.floor(Math.log(l)/Math.LN2),l*(z=Math.pow(2,-M))<1&&(M--,z*=2),(l+=M+X>=1?ie/z:ie*Math.pow(2,1-X))*z>=2&&(M++,z/=2),M+X>=G?(R=0,M=G):M+X>=1?(R=(l*z-1)*Math.pow(2,y),M+=X):(R=l*Math.pow(2,X-1)*Math.pow(2,y),M=0));y>=8;d[h+ae]=255&R,ae+=ce,R/=256,y-=8);for(M=M<<y|R,B+=y;B>0;d[h+ae]=255&M,ae+=ce,M/=256,B-=8);d[h+ae-ce]|=128*de}),c2}function Vk(){if($k)return l2;$k=1,l2=l;var d=rq();function l(se){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(se)?se:new Uint8Array(se||0),this.pos=0,this.type=0,this.length=this.buf.length}l.Varint=0,l.Fixed64=1,l.Bytes=2,l.Fixed32=5;var h=4294967296,p=1/h,y=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function S(se){return se.type===l.Bytes?se.readVarint()+se.pos:se.pos+1}function M(se,we,Xe){return Xe?4294967296*we+(se>>>0):4294967296*(we>>>0)+(se>>>0)}function R(se,we,Xe){var mt=we<=16383?1:we<=2097151?2:we<=268435455?3:Math.floor(Math.log(we)/(7*Math.LN2));Xe.realloc(mt);for(var $t=Xe.pos-1;$t>=se;$t--)Xe.buf[$t+mt]=Xe.buf[$t]}function z(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeVarint(se[Xe])}function B(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeSVarint(se[Xe])}function G(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeFloat(se[Xe])}function X(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeDouble(se[Xe])}function ie(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeBoolean(se[Xe])}function ae(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeFixed32(se[Xe])}function ce(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeSFixed32(se[Xe])}function de(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeFixed64(se[Xe])}function Ce(se,we){for(var Xe=0;Xe<se.length;Xe++)we.writeSFixed64(se[Xe])}function ke(se,we){return(se[we]|se[we+1]<<8|se[we+2]<<16)+16777216*se[we+3]}function et(se,we,Xe){se[Xe]=we,se[Xe+1]=we>>>8,se[Xe+2]=we>>>16,se[Xe+3]=we>>>24}function Ge(se,we){return(se[we]|se[we+1]<<8|se[we+2]<<16)+(se[we+3]<<24)}return l.prototype={destroy:function(){this.buf=null},readFields:function(se,we,Xe){for(Xe=Xe||this.length;this.pos<Xe;){var mt=this.readVarint(),$t=mt>>3,bt=this.pos;this.type=7&mt,se($t,we,this),this.pos===bt&&this.skip(mt)}return we},readMessage:function(se,we){return this.readFields(se,we,this.readVarint()+this.pos)},readFixed32:function(){var se=ke(this.buf,this.pos);return this.pos+=4,se},readSFixed32:function(){var se=Ge(this.buf,this.pos);return this.pos+=4,se},readFixed64:function(){var se=ke(this.buf,this.pos)+ke(this.buf,this.pos+4)*h;return this.pos+=8,se},readSFixed64:function(){var se=ke(this.buf,this.pos)+Ge(this.buf,this.pos+4)*h;return this.pos+=8,se},readFloat:function(){var se=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,se},readDouble:function(){var se=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,se},readVarint:function(se){var we,Xe,mt=this.buf;return we=127&(Xe=mt[this.pos++]),Xe<128?we:(we|=(127&(Xe=mt[this.pos++]))<<7,Xe<128?we:(we|=(127&(Xe=mt[this.pos++]))<<14,Xe<128?we:(we|=(127&(Xe=mt[this.pos++]))<<21,Xe<128?we:function($t,bt,Mt){var Jt,jt,en=Mt.buf;if(Jt=(112&(jt=en[Mt.pos++]))>>4,jt<128||(Jt|=(127&(jt=en[Mt.pos++]))<<3,jt<128)||(Jt|=(127&(jt=en[Mt.pos++]))<<10,jt<128)||(Jt|=(127&(jt=en[Mt.pos++]))<<17,jt<128)||(Jt|=(127&(jt=en[Mt.pos++]))<<24,jt<128)||(Jt|=(1&(jt=en[Mt.pos++]))<<31,jt<128))return M($t,Jt,bt);throw new Error("Expected varint not more than 10 bytes")}(we|=(15&(Xe=mt[this.pos]))<<28,se,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var se=this.readVarint();return se%2==1?(se+1)/-2:se/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var se=this.readVarint()+this.pos,we=this.pos;return this.pos=se,se-we>=12&&y?function(Xe,mt,$t){return y.decode(Xe.subarray(mt,$t))}(this.buf,we,se):function(Xe,mt,$t){for(var bt="",Mt=mt;Mt<$t;){var Jt,jt,en,Pt=Xe[Mt],Cn=null,$n=Pt>239?4:Pt>223?3:Pt>191?2:1;if(Mt+$n>$t)break;$n===1?Pt<128&&(Cn=Pt):$n===2?(192&(Jt=Xe[Mt+1]))==128&&(Cn=(31&Pt)<<6|63&Jt)<=127&&(Cn=null):$n===3?(jt=Xe[Mt+2],(192&(Jt=Xe[Mt+1]))==128&&(192&jt)==128&&((Cn=(15&Pt)<<12|(63&Jt)<<6|63&jt)<=2047||Cn>=55296&&Cn<=57343)&&(Cn=null)):$n===4&&(jt=Xe[Mt+2],en=Xe[Mt+3],(192&(Jt=Xe[Mt+1]))==128&&(192&jt)==128&&(192&en)==128&&((Cn=(15&Pt)<<18|(63&Jt)<<12|(63&jt)<<6|63&en)<=65535||Cn>=1114112)&&(Cn=null)),Cn===null?(Cn=65533,$n=1):Cn>65535&&(Cn-=65536,bt+=String.fromCharCode(Cn>>>10&1023|55296),Cn=56320|1023&Cn),bt+=String.fromCharCode(Cn),Mt+=$n}return bt}(this.buf,we,se)},readBytes:function(){var se=this.readVarint()+this.pos,we=this.buf.subarray(this.pos,se);return this.pos=se,we},readPackedVarint:function(se,we){if(this.type!==l.Bytes)return se.push(this.readVarint(we));var Xe=S(this);for(se=se||[];this.pos<Xe;)se.push(this.readVarint(we));return se},readPackedSVarint:function(se){if(this.type!==l.Bytes)return se.push(this.readSVarint());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readSVarint());return se},readPackedBoolean:function(se){if(this.type!==l.Bytes)return se.push(this.readBoolean());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readBoolean());return se},readPackedFloat:function(se){if(this.type!==l.Bytes)return se.push(this.readFloat());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readFloat());return se},readPackedDouble:function(se){if(this.type!==l.Bytes)return se.push(this.readDouble());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readDouble());return se},readPackedFixed32:function(se){if(this.type!==l.Bytes)return se.push(this.readFixed32());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readFixed32());return se},readPackedSFixed32:function(se){if(this.type!==l.Bytes)return se.push(this.readSFixed32());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readSFixed32());return se},readPackedFixed64:function(se){if(this.type!==l.Bytes)return se.push(this.readFixed64());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readFixed64());return se},readPackedSFixed64:function(se){if(this.type!==l.Bytes)return se.push(this.readSFixed64());var we=S(this);for(se=se||[];this.pos<we;)se.push(this.readSFixed64());return se},skip:function(se){var we=7&se;if(we===l.Varint)for(;this.buf[this.pos++]>127;);else if(we===l.Bytes)this.pos=this.readVarint()+this.pos;else if(we===l.Fixed32)this.pos+=4;else{if(we!==l.Fixed64)throw new Error("Unimplemented type: "+we);this.pos+=8}},writeTag:function(se,we){this.writeVarint(se<<3|we)},realloc:function(se){for(var we=this.length||16;we<this.pos+se;)we*=2;if(we!==this.length){var Xe=new Uint8Array(we);Xe.set(this.buf),this.buf=Xe,this.length=we}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(se){this.realloc(4),et(this.buf,se,this.pos),this.pos+=4},writeSFixed32:function(se){this.realloc(4),et(this.buf,se,this.pos),this.pos+=4},writeFixed64:function(se){this.realloc(8),et(this.buf,-1&se,this.pos),et(this.buf,Math.floor(se*p),this.pos+4),this.pos+=8},writeSFixed64:function(se){this.realloc(8),et(this.buf,-1&se,this.pos),et(this.buf,Math.floor(se*p),this.pos+4),this.pos+=8},writeVarint:function(se){(se=+se||0)>268435455||se<0?function(we,Xe){var mt,$t;if(we>=0?(mt=we%4294967296|0,$t=we/4294967296|0):($t=~(-we/4294967296),4294967295^(mt=~(-we%4294967296))?mt=mt+1|0:(mt=0,$t=$t+1|0)),we>=18446744073709552e3||we<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Xe.realloc(10),function(bt,Mt,Jt){Jt.buf[Jt.pos++]=127&bt|128,bt>>>=7,Jt.buf[Jt.pos++]=127&bt|128,bt>>>=7,Jt.buf[Jt.pos++]=127&bt|128,bt>>>=7,Jt.buf[Jt.pos++]=127&bt|128,Jt.buf[Jt.pos]=127&(bt>>>=7)}(mt,0,Xe),function(bt,Mt){var Jt=(7&bt)<<4;Mt.buf[Mt.pos++]|=Jt|((bt>>>=3)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt|((bt>>>=7)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt|((bt>>>=7)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt|((bt>>>=7)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt|((bt>>>=7)?128:0),bt&&(Mt.buf[Mt.pos++]=127&bt)))))}($t,Xe)}(se,this):(this.realloc(4),this.buf[this.pos++]=127&se|(se>127?128:0),se<=127||(this.buf[this.pos++]=127&(se>>>=7)|(se>127?128:0),se<=127||(this.buf[this.pos++]=127&(se>>>=7)|(se>127?128:0),se<=127||(this.buf[this.pos++]=se>>>7&127))))},writeSVarint:function(se){this.writeVarint(se<0?2*-se-1:2*se)},writeBoolean:function(se){this.writeVarint(!!se)},writeString:function(se){se=String(se),this.realloc(4*se.length),this.pos++;var we=this.pos;this.pos=function(mt,$t,bt){for(var Mt,Jt,jt=0;jt<$t.length;jt++){if((Mt=$t.charCodeAt(jt))>55295&&Mt<57344){if(!Jt){Mt>56319||jt+1===$t.length?(mt[bt++]=239,mt[bt++]=191,mt[bt++]=189):Jt=Mt;continue}if(Mt<56320){mt[bt++]=239,mt[bt++]=191,mt[bt++]=189,Jt=Mt;continue}Mt=Jt-55296<<10|Mt-56320|65536,Jt=null}else Jt&&(mt[bt++]=239,mt[bt++]=191,mt[bt++]=189,Jt=null);Mt<128?mt[bt++]=Mt:(Mt<2048?mt[bt++]=Mt>>6|192:(Mt<65536?mt[bt++]=Mt>>12|224:(mt[bt++]=Mt>>18|240,mt[bt++]=Mt>>12&63|128),mt[bt++]=Mt>>6&63|128),mt[bt++]=63&Mt|128)}return bt}(this.buf,se,this.pos);var Xe=this.pos-we;Xe>=128&&R(we,Xe,this),this.pos=we-1,this.writeVarint(Xe),this.pos+=Xe},writeFloat:function(se){this.realloc(4),d.write(this.buf,se,this.pos,!0,23,4),this.pos+=4},writeDouble:function(se){this.realloc(8),d.write(this.buf,se,this.pos,!0,52,8),this.pos+=8},writeBytes:function(se){var we=se.length;this.writeVarint(we),this.realloc(we);for(var Xe=0;Xe<we;Xe++)this.buf[this.pos++]=se[Xe]},writeRawMessage:function(se,we){this.pos++;var Xe=this.pos;se(we,this);var mt=this.pos-Xe;mt>=128&&R(Xe,mt,this),this.pos=Xe-1,this.writeVarint(mt),this.pos+=mt},writeMessage:function(se,we,Xe){this.writeTag(se,l.Bytes),this.writeRawMessage(we,Xe)},writePackedVarint:function(se,we){we.length&&this.writeMessage(se,z,we)},writePackedSVarint:function(se,we){we.length&&this.writeMessage(se,B,we)},writePackedBoolean:function(se,we){we.length&&this.writeMessage(se,ie,we)},writePackedFloat:function(se,we){we.length&&this.writeMessage(se,G,we)},writePackedDouble:function(se,we){we.length&&this.writeMessage(se,X,we)},writePackedFixed32:function(se,we){we.length&&this.writeMessage(se,ae,we)},writePackedSFixed32:function(se,we){we.length&&this.writeMessage(se,ce,we)},writePackedFixed64:function(se,we){we.length&&this.writeMessage(se,de,we)},writePackedSFixed64:function(se,we){we.length&&this.writeMessage(se,Ce,we)},writeBytesField:function(se,we){this.writeTag(se,l.Bytes),this.writeBytes(we)},writeFixed32Field:function(se,we){this.writeTag(se,l.Fixed32),this.writeFixed32(we)},writeSFixed32Field:function(se,we){this.writeTag(se,l.Fixed32),this.writeSFixed32(we)},writeFixed64Field:function(se,we){this.writeTag(se,l.Fixed64),this.writeFixed64(we)},writeSFixed64Field:function(se,we){this.writeTag(se,l.Fixed64),this.writeSFixed64(we)},writeVarintField:function(se,we){this.writeTag(se,l.Varint),this.writeVarint(we)},writeSVarintField:function(se,we){this.writeTag(se,l.Varint),this.writeSVarint(we)},writeStringField:function(se,we){this.writeTag(se,l.Bytes),this.writeString(we)},writeFloatField:function(se,we){this.writeTag(se,l.Fixed32),this.writeFloat(we)},writeDoubleField:function(se,we){this.writeTag(se,l.Fixed64),this.writeDouble(we)},writeBooleanField:function(se,we){this.writeVarintField(se,!!we)}},l2}var Hu,u2=f(Vk());function iq(d,l,h){d===1&&h.readMessage(oq,l)}function oq(d,l,h){if(d===3){const{id:p,bitmap:y,width:S,height:M,left:R,top:z,advance:B}=h.readMessage(sq,{});l.push({id:p,bitmap:new Nv({width:S+6,height:M+6},y),metrics:{width:S,height:M,left:R,top:z,advance:B}})}}function sq(d,l,h){d===1?l.id=h.readVarint():d===2?l.bitmap=h.readBytes():d===3?l.width=h.readVarint():d===4?l.height=h.readVarint():d===5?l.left=h.readSVarint():d===6?l.top=h.readSVarint():d===7&&(l.advance=h.readVarint())}function jk(d){let l=0,h=0;for(const M of d)l+=M.w*M.h,h=Math.max(h,M.w);d.sort((M,R)=>R.h-M.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),h),h:1/0}];let y=0,S=0;for(const M of d)for(let R=p.length-1;R>=0;R--){const z=p[R];if(!(M.w>z.w||M.h>z.h)){if(M.x=z.x,M.y=z.y,S=Math.max(S,M.y+M.h),y=Math.max(y,M.x+M.w),M.w===z.w&&M.h===z.h){const B=p.pop();R<p.length&&(p[R]=B)}else M.h===z.h?(z.x+=M.w,z.w-=M.w):M.w===z.w?(z.y+=M.h,z.h-=M.h):(p.push({x:z.x+M.w,y:z.y,w:z.w-M.w,h:M.h}),z.y+=M.h,z.h-=M.h);break}}return{w:y,h:S,fill:l/(y*S)||0}}class h2{constructor(l,{pixelRatio:h,version:p,stretchX:y,stretchY:S,content:M,textFitWidth:R,textFitHeight:z}){this.paddedRect=l,this.pixelRatio=h,this.stretchX=y,this.stretchY=S,this.content=M,this.version=p,this.textFitWidth=R,this.textFitHeight=z}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Hk{constructor(l,h){const p={},y={};this.haveRenderCallbacks=[];const S=[];this.addImages(l,p,S),this.addImages(h,y,S);const{w:M,h:R}=jk(S),z=new us({width:M||1,height:R||1});for(const B in l){const G=l[B],X=p[B].paddedRect;us.copy(G.data,z,{x:0,y:0},{x:X.x+1,y:X.y+1},G.data)}for(const B in h){const G=h[B],X=y[B].paddedRect,ie=X.x+1,ae=X.y+1,ce=G.data.width,de=G.data.height;us.copy(G.data,z,{x:0,y:0},{x:ie,y:ae},G.data),us.copy(G.data,z,{x:0,y:de-1},{x:ie,y:ae-1},{width:ce,height:1}),us.copy(G.data,z,{x:0,y:0},{x:ie,y:ae+de},{width:ce,height:1}),us.copy(G.data,z,{x:ce-1,y:0},{x:ie-1,y:ae},{width:1,height:de}),us.copy(G.data,z,{x:0,y:0},{x:ie+ce,y:ae},{width:1,height:de})}this.image=z,this.iconPositions=p,this.patternPositions=y}addImages(l,h,p){for(const y in l){const S=l[y],M={x:0,y:0,w:S.data.width+2,h:S.data.height+2};p.push(M),h[y]=new h2(M,S),S.hasRenderCallback&&this.haveRenderCallbacks.push(y)}}patchUpdatedImages(l,h){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in l.updatedImages)this.patchUpdatedImage(this.iconPositions[p],l.getImage(p),h),this.patchUpdatedImage(this.patternPositions[p],l.getImage(p),h)}patchUpdatedImage(l,h,p){if(!l||!h||l.version===h.version)return;l.version=h.version;const[y,S]=l.tl;p.update(h.data,void 0,{x:y,y:S})}}xn("ImagePosition",h2),xn("ImageAtlas",Hk),c.an=void 0,(Hu=c.an||(c.an={}))[Hu.none=0]="none",Hu[Hu.horizontal=1]="horizontal",Hu[Hu.vertical=2]="vertical",Hu[Hu.horizontalOnly=3]="horizontalOnly";class Zv{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(l,h,p){const y=new Zv;return y.scale=l||1,y.fontStack=h,y.verticalAlign=p||"bottom",y}static forImage(l,h){const p=new Zv;return p.imageName=l,p.verticalAlign=h||"bottom",p}}class Pp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(l,h){const p=new Pp;for(let y=0;y<l.sections.length;y++){const S=l.sections[y];S.image?p.addImageSection(S):p.addTextSection(S,h)}return p}length(){return this.text.length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}getCharCode(l){return this.text.charCodeAt(l)}verticalizePunctuation(){this.text=function(l){let h="";for(let p=0;p<l.length;p++){const y=l.charCodeAt(p+1)||null,S=l.charCodeAt(p-1)||null;h+=y&&Ev(y)&&!Xv[l[p+1]]||S&&Ev(S)&&!Xv[l[p-1]]||!Xv[l[p]]?l[p]:Xv[l[p]]}return h}(this.text)}trim(){let l=0;for(let p=0;p<this.text.length&&c1[this.text.charCodeAt(p)];p++)l++;let h=this.text.length;for(let p=this.text.length-1;p>=0&&p>=l&&c1[this.text.charCodeAt(p)];p--)h--;this.text=this.text.substring(l,h),this.sectionIndex=this.sectionIndex.slice(l,h)}substring(l,h){const p=new Pp;return p.text=this.text.substring(l,h),p.sectionIndex=this.sectionIndex.slice(l,h),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,h)=>Math.max(l,this.sections[h].scale),0)}getMaxImageSize(l){let h=0,p=0;for(let y=0;y<this.length();y++){const S=this.getSection(y);if(S.imageName){const M=l[S.imageName];if(!M)continue;const R=M.displaySize;h=Math.max(h,R[0]),p=Math.max(p,R[1])}}return{maxImageWidth:h,maxImageHeight:p}}addTextSection(l,h){this.text+=l.text,this.sections.push(Zv.forText(l.scale,l.fontStack||h,l.verticalAlign));const p=this.sections.length-1;for(let y=0;y<l.text.length;++y)this.sectionIndex.push(p)}addImageSection(l){const h=l.image?l.image.name:"";if(h.length===0)return void tn("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Zv.forImage(h,l.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):tn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function l1(d,l,h,p,y,S,M,R,z,B,G,X,ie,ae,ce){const de=Pp.fromFeature(d,y);let Ce;X===c.an.vertical&&de.verticalizePunctuation();const{processBidirectionalText:ke,processStyledBidirectionalText:et}=Bl;if(ke&&de.sections.length===1){Ce=[];const we=ke(de.toString(),d2(de,B,S,l,p,ae));for(const Xe of we){const mt=new Pp;mt.text=Xe,mt.sections=de.sections;for(let $t=0;$t<Xe.length;$t++)mt.sectionIndex.push(0);Ce.push(mt)}}else if(et){Ce=[];const we=et(de.text,de.sectionIndex,d2(de,B,S,l,p,ae));for(const Xe of we){const mt=new Pp;mt.text=Xe[0],mt.sectionIndex=Xe[1],mt.sections=de.sections,Ce.push(mt)}}else Ce=function(we,Xe){const mt=[],$t=we.text;let bt=0;for(const Mt of Xe)mt.push(we.substring(bt,Mt)),bt=Mt;return bt<$t.length&&mt.push(we.substring(bt,$t.length)),mt}(de,d2(de,B,S,l,p,ae));const Ge=[],se={positionedLines:Ge,text:de.toString(),top:G[1],bottom:G[1],left:G[0],right:G[0],writingMode:X,iconsInText:!1,verticalizable:!1};return function(we,Xe,mt,$t,bt,Mt,Jt,jt,en,Pt,Cn,$n){let Bn=0,kn=0,ir=0,ai=0;const Li=jt==="right"?1:jt==="left"?0:.5,_o=Gi/$n;let ta=0;for(const ri of bt){ri.trim();const Wi=ri.getMaxScale(),oo={positionedGlyphs:[],lineOffset:0};we.positionedLines[ta]=oo;const so=oo.positionedGlyphs;let Jo=0;if(!ri.length()){kn+=Mt,++ta;continue}const na=uq($t,ri,_o);for(let ds=0;ds<ri.length();ds++){const ki=ri.getSection(ds),Xi=ri.getSectionIndex(ds),Zi=ri.getCharCode(ds),Si=hq(en,Cn,Zi);let Gr;if(ki.imageName){if(we.iconsInText=!0,ki.scale=ki.scale*_o,Gr=fq(ki,Si,Wi,na,$t),!Gr)continue;Jo=Math.max(Jo,Gr.imageOffset)}else if(Gr=dq(ki,Zi,Si,na,Xe,mt),!Gr)continue;const{rect:cl,metrics:Lp,baselineOffset:ul}=Gr;so.push({glyph:Zi,imageName:ki.imageName,x:Bn,y:kn+ul+-17,vertical:Si,scale:ki.scale,fontStack:ki.fontStack,sectionIndex:Xi,metrics:Lp,rect:cl}),Si?(we.verticalizable=!0,Bn+=(ki.imageName?Lp.advance:Gi)*ki.scale+Pt):Bn+=Lp.advance*ki.scale+Pt}so.length!==0&&(ir=Math.max(Bn-Pt,ir),pq(so,0,so.length-1,Li)),Bn=0,oo.lineOffset=Math.max(Jo,(Wi-1)*Gi);const qi=Mt*Wi+Jo;kn+=qi,ai=Math.max(qi,ai),++ta}const{horizontalAlign:hs,verticalAlign:io}=f2(Jt);(function(ri,Wi,oo,so,Jo,na,qi,ds,ki){const Xi=(Wi-oo)*Jo;let Zi=0;Zi=na!==qi?-ds*so- -17:-so*ki*qi+.5*qi;for(const Si of ri)for(const Gr of Si.positionedGlyphs)Gr.x+=Xi,Gr.y+=Zi})(we.positionedLines,Li,hs,io,ir,ai,Mt,kn,bt.length),we.top+=-io*kn,we.bottom=we.top+kn,we.left+=-hs*ir,we.right=we.left+ir}(se,l,h,p,Ce,M,R,z,X,B,ie,ce),!function(we){for(const Xe of we)if(Xe.positionedGlyphs.length!==0)return!1;return!0}(Ge)&&se}const c1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},aq={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},lq={40:!0};function Gk(d,l,h,p,y,S){if(l.imageName){const M=p[l.imageName];return M?M.displaySize[0]*l.scale*Gi/S+y:0}{const M=h[l.fontStack],R=M&&M[d];return R?R.metrics.advance*l.scale+y:0}}function Wk(d,l,h,p){const y=Math.pow(d-l,2);return p?d<l?y/2:2*y:y+Math.abs(h)*h}function cq(d,l,h){let p=0;return d===10&&(p-=1e4),h&&(p+=150),d!==40&&d!==65288||(p+=50),l!==41&&l!==65289||(p+=50),p}function qk(d,l,h,p,y,S){let M=null,R=Wk(l,h,y,S);for(const z of p){const B=Wk(l-z.x,h,y,S)+z.badness;B<=R&&(M=z,R=B)}return{index:d,x:l,priorBreak:M,badness:R}}function Xk(d){return d?Xk(d.priorBreak).concat(d.index):[]}function d2(d,l,h,p,y,S){if(!d)return[];const M=[],R=function(X,ie,ae,ce,de,Ce){let ke=0;for(let et=0;et<X.length();et++){const Ge=X.getSection(et);ke+=Gk(X.getCharCode(et),Ge,ce,de,ie,Ce)}return ke/Math.max(1,Math.ceil(ke/ae))}(d,l,h,p,y,S),z=d.text.indexOf("​")>=0;let B=0;for(let X=0;X<d.length();X++){const ie=d.getSection(X),ae=d.getCharCode(X);if(c1[ae]||(B+=Gk(ae,ie,p,y,l,S)),X<d.length()-1){const ce=!((G=ae)<11904)&&(!!tr["CJK Compatibility Forms"](G)||!!tr["CJK Compatibility"](G)||!!tr["CJK Strokes"](G)||!!tr["CJK Symbols and Punctuation"](G)||!!tr["Enclosed CJK Letters and Months"](G)||!!tr["Halfwidth and Fullwidth Forms"](G)||!!tr["Ideographic Description Characters"](G)||!!tr["Vertical Forms"](G)||Cv.test(String.fromCodePoint(G)));(aq[ae]||ce||ie.imageName||X!==d.length()-2&&lq[d.getCharCode(X+1)])&&M.push(qk(X+1,B,R,M,cq(ae,d.getCharCode(X+1),ce&&z),!1))}}var G;return Xk(qk(d.length(),B,R,M,0,!0))}function f2(d){let l=.5,h=.5;switch(d){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:l,verticalAlign:h}}function uq(d,l,h){const p=l.getMaxScale()*Gi,{maxImageWidth:y,maxImageHeight:S}=l.getMaxImageSize(d),M=Math.max(p,S*h);return{verticalLineContentWidth:Math.max(p,y*h),horizontalLineContentHeight:M}}function Zk(d){switch(d){case"top":return 0;case"center":return .5;default:return 1}}function hq(d,l,h){return!(d===c.an.horizontal||!l&&!yp(h)||l&&(c1[h]||(p=h,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(p)))));var p}function dq(d,l,h,p,y,S){const M=S[d.fontStack],R=function(B,G,X,ie){if(B&&B.rect)return B;const ae=G[X.fontStack],ce=ae&&ae[ie];return ce?{rect:null,metrics:ce.metrics}:null}(M&&M[l],y,d,l);if(R===null)return null;let z;if(h)z=p.verticalLineContentWidth-d.scale*Gi;else{const B=Zk(d.verticalAlign);z=(p.horizontalLineContentHeight-d.scale*Gi)*B}return{rect:R.rect,metrics:R.metrics,baselineOffset:z}}function fq(d,l,h,p,y){const S=y[d.imageName];if(!S)return null;const M=S.paddedRect,R=S.displaySize,z={width:R[0],height:R[1],left:1,top:-3,advance:l?R[1]:R[0]};let B;if(l)B=p.verticalLineContentWidth-R[1]*d.scale;else{const G=Zk(d.verticalAlign);B=(p.horizontalLineContentHeight-R[1]*d.scale)*G}return{rect:M,metrics:z,baselineOffset:B,imageOffset:(l?R[0]:R[1])*d.scale-Gi*h}}function pq(d,l,h,p){if(p===0)return;const y=d[h],S=(d[h].x+y.metrics.advance*y.scale)*p;for(let M=l;M<=h;M++)d[M].x-=S}function mq(d,l,h){const{horizontalAlign:p,verticalAlign:y}=f2(h),S=l[0]-d.displaySize[0]*p,M=l[1]-d.displaySize[1]*y;return{image:d,top:M,bottom:M+d.displaySize[1],left:S,right:S+d.displaySize[0]}}function Yk(d){var l,h;let p=d.left,y=d.top,S=d.right-p,M=d.bottom-y;const R=(l=d.image.textFitWidth)!==null&&l!==void 0?l:"stretchOrShrink",z=(h=d.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",B=(d.image.content[2]-d.image.content[0])/(d.image.content[3]-d.image.content[1]);if(z==="proportional"){if(R==="stretchOnly"&&S/M<B||R==="proportional"){const G=Math.ceil(M*B);p*=G/S,S=G}}else if(R==="proportional"&&z==="stretchOnly"&&B!==0&&S/M>B){const G=Math.ceil(S/B);y*=G/M,M=G}return{x1:p,y1:y,x2:p+S,y2:y+M}}function Kk(d,l,h,p,y,S){const M=d.image;let R;if(M.content){const Ce=M.content,ke=M.pixelRatio||1;R=[Ce[0]/ke,Ce[1]/ke,M.displaySize[0]-Ce[2]/ke,M.displaySize[1]-Ce[3]/ke]}const z=l.left*S,B=l.right*S;let G,X,ie,ae;h==="width"||h==="both"?(ae=y[0]+z-p[3],X=y[0]+B+p[1]):(ae=y[0]+(z+B-M.displaySize[0])/2,X=ae+M.displaySize[0]);const ce=l.top*S,de=l.bottom*S;return h==="height"||h==="both"?(G=y[1]+ce-p[0],ie=y[1]+de+p[2]):(G=y[1]+(ce+de-M.displaySize[1])/2,ie=G+M.displaySize[1]),{image:M,top:G,right:X,bottom:ie,left:ae,collisionPadding:R}}const kc=128,Gu=32640;function Jk(d,l){const{expression:h}=l;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Xr(d+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:y}=h;let S=0;for(;S<p.length&&p[S]<=d;)S++;S=Math.max(0,S-1);let M=S;for(;M<p.length&&p[M]<d+1;)M++;M=Math.min(p.length-1,M);const R=p[S],z=p[M];return h.kind==="composite"?{kind:"composite",minZoom:R,maxZoom:z,interpolationType:y}:{kind:"camera",minZoom:R,maxZoom:z,minSize:h.evaluate(new Xr(R)),maxSize:h.evaluate(new Xr(z)),interpolationType:y}}}function p2(d,l,h){let p="never";const y=d.get(l);return y?p=y:d.get(h)&&(p="always"),p}const gq=Gv.VectorTileFeature.types,vq=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function u1(d,l,h,p,y,S,M,R,z,B,G,X,ie){const ae=R?Math.min(Gu,Math.round(R[0])):0,ce=R?Math.min(Gu,Math.round(R[1])):0;d.emplaceBack(l,h,Math.round(32*p),Math.round(32*y),S,M,(ae<<1)+(z?1:0),ce,16*B,16*G,256*X,256*ie)}function m2(d,l,h){d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h),d.emplaceBack(l.x,l.y,h)}function yq(d){for(const l of d.sections)if(Tv(l.text))return!0;return!1}class g2{constructor(l){this.layoutVertexArray=new Kn,this.indexArray=new Dr,this.programConfigurations=l,this.segments=new ur,this.dynamicLayoutVertexArray=new Mr,this.opacityVertexArray=new ti,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ae}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,h,p,y){this.isEmpty()||(p&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,JW.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,QW.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,vq,!0),this.opacityVertexBuffer.itemSize=1),(p||y)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}xn("SymbolBuffers",g2);class v2{constructor(l,h,p){this.layoutVertexArray=new l,this.layoutAttributes=h,this.indexArray=new p,this.segments=new ur,this.collisionVertexArray=new ni}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,eq.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}xn("CollisionBuffers",v2);class Ap{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.globalState=l.globalState,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(M=>M.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jk(this.zoom,h["text-size"]),this.iconSizeData=Jk(this.zoom,h["icon-size"]);const p=this.layers[0].layout,y=p.get("symbol-sort-key"),S=p.get("symbol-z-order");this.canOverlap=p2(p,"text-overlap","text-allow-overlap")!=="never"||p2(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=S!=="viewport-y"&&!y.isConstant(),this.sortFeaturesByY=(S==="viewport-y"||S==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(M=>c.an[M])),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.sourceID=l.sourceID}createArrays(){this.text=new g2(new Wl(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new g2(new Wl(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new Ne,this.lineVertexArray=new Ye,this.symbolInstances=new He,this.textAnchorOffsets=new Ue}calculateGlyphDependencies(l,h,p,y,S){for(let M=0;M<l.length;M++)if(h[l.charCodeAt(M)]=!0,(p||y)&&S){const R=Xv[l.charAt(M)];R&&(h[R.charCodeAt(0)]=!0)}}populate(l,h,p){const y=this.layers[0],S=y.layout,M=S.get("text-font"),R=S.get("text-field"),z=S.get("icon-image"),B=(R.value.kind!=="constant"||R.value.value instanceof go&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),G=z.value.kind!=="constant"||!!z.value.value||Object.keys(z.parameters).length>0,X=S.get("symbol-sort-key");if(this.features=[],!B&&!G)return;const ie=h.iconDependencies,ae=h.glyphDependencies,ce=h.availableImages,de=new Xr(this.zoom,{globalState:this.globalState});for(const{feature:Ce,id:ke,index:et,sourceLayerIndex:Ge}of l){const se=y._featureFilter.needGeometry,we=Nd(Ce,se);if(!y._featureFilter.filter(de,we,p))continue;let Xe,mt;if(se||(we.geometry=Fd(Ce)),B){const bt=y.getValueAndResolveTokens("text-field",we,p,ce),Mt=go.factory(bt),Jt=this.hasRTLText=this.hasRTLText||yq(Mt);(!Jt||Bl.getRTLTextPluginStatus()==="unavailable"||Jt&&Bl.isParsed())&&(Xe=nq(Mt,y,we))}if(G){const bt=y.getValueAndResolveTokens("icon-image",we,p,ce);mt=bt instanceof qo?bt:qo.fromString(bt)}if(!Xe&&!mt)continue;const $t=this.sortFeaturesByKey?X.evaluate(we,{},p):void 0;if(this.features.push({id:ke,text:Xe,icon:mt,index:et,sourceLayerIndex:Ge,geometry:we.geometry,properties:Ce.properties,type:gq[Ce.type],sortKey:$t}),mt&&(ie[mt.name]=!0),Xe){const bt=M.evaluate(we,{},p).join(","),Mt=S.get("text-rotation-alignment")!=="viewport"&&S.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.an.vertical)>=0;for(const Jt of Xe.sections)if(Jt.image)ie[Jt.image.name]=!0;else{const jt=Mv(Xe.toString()),en=Jt.fontStack||bt,Pt=ae[en]=ae[en]||{};this.calculateGlyphDependencies(Jt.text,Pt,Mt,this.allowVerticalPlacement,jt)}}}S.get("symbol-placement")==="line"&&(this.features=function(Ce){const ke={},et={},Ge=[];let se=0;function we(bt){Ge.push(Ce[bt]),se++}function Xe(bt,Mt,Jt){const jt=et[bt];return delete et[bt],et[Mt]=jt,Ge[jt].geometry[0].pop(),Ge[jt].geometry[0]=Ge[jt].geometry[0].concat(Jt[0]),jt}function mt(bt,Mt,Jt){const jt=ke[Mt];return delete ke[Mt],ke[bt]=jt,Ge[jt].geometry[0].shift(),Ge[jt].geometry[0]=Jt[0].concat(Ge[jt].geometry[0]),jt}function $t(bt,Mt,Jt){const jt=Jt?Mt[0][Mt[0].length-1]:Mt[0][0];return`${bt}:${jt.x}:${jt.y}`}for(let bt=0;bt<Ce.length;bt++){const Mt=Ce[bt],Jt=Mt.geometry,jt=Mt.text?Mt.text.toString():null;if(!jt){we(bt);continue}const en=$t(jt,Jt),Pt=$t(jt,Jt,!0);if(en in et&&Pt in ke&&et[en]!==ke[Pt]){const Cn=mt(en,Pt,Jt),$n=Xe(en,Pt,Ge[Cn].geometry);delete ke[en],delete et[Pt],et[$t(jt,Ge[$n].geometry,!0)]=$n,Ge[Cn].geometry=null}else en in et?Xe(en,Pt,Jt):Pt in ke?mt(en,Pt,Jt):(we(bt),ke[en]=se-1,et[Pt]=se-1)}return Ge.filter(bt=>bt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ce,ke)=>Ce.sortKey-ke.sortKey)}update(l,h,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,h,this.layers,p),this.icon.programConfigurations.updatePaintArrays(l,h,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,h){const p=this.lineVertexArray.length;if(l.segment!==void 0){let y=l.dist(h[l.segment+1]),S=l.dist(h[l.segment]);const M={};for(let R=l.segment+1;R<h.length;R++)M[R]={x:h[R].x,y:h[R].y,tileUnitDistanceFromAnchor:y},R<h.length-1&&(y+=h[R+1].dist(h[R]));for(let R=l.segment||0;R>=0;R--)M[R]={x:h[R].x,y:h[R].y,tileUnitDistanceFromAnchor:S},R>0&&(S+=h[R-1].dist(h[R]));for(let R=0;R<h.length;R++){const z=M[R];this.lineVertexArray.emplaceBack(z.x,z.y,z.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(l,h,p,y,S,M,R,z,B,G,X,ie){const ae=l.indexArray,ce=l.layoutVertexArray,de=l.segments.prepareSegment(4*h.length,ce,ae,this.canOverlap?M.sortKey:void 0),Ce=this.glyphOffsetArray.length,ke=de.vertexLength,et=this.allowVerticalPlacement&&R===c.an.vertical?Math.PI/2:0,Ge=M.text&&M.text.sections;for(let se=0;se<h.length;se++){const{tl:we,tr:Xe,bl:mt,br:$t,tex:bt,pixelOffsetTL:Mt,pixelOffsetBR:Jt,minFontScaleX:jt,minFontScaleY:en,glyphOffset:Pt,isSDF:Cn,sectionIndex:$n}=h[se],Bn=de.vertexLength,kn=Pt[1];u1(ce,z.x,z.y,we.x,kn+we.y,bt.x,bt.y,p,Cn,Mt.x,Mt.y,jt,en),u1(ce,z.x,z.y,Xe.x,kn+Xe.y,bt.x+bt.w,bt.y,p,Cn,Jt.x,Mt.y,jt,en),u1(ce,z.x,z.y,mt.x,kn+mt.y,bt.x,bt.y+bt.h,p,Cn,Mt.x,Jt.y,jt,en),u1(ce,z.x,z.y,$t.x,kn+$t.y,bt.x+bt.w,bt.y+bt.h,p,Cn,Jt.x,Jt.y,jt,en),m2(l.dynamicLayoutVertexArray,z,et),ae.emplaceBack(Bn,Bn+2,Bn+1),ae.emplaceBack(Bn+1,Bn+2,Bn+3),de.vertexLength+=4,de.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Pt[0]),se!==h.length-1&&$n===h[se+1].sectionIndex||l.programConfigurations.populatePaintArrays(ce.length,M,M.index,{},ie,Ge&&Ge[$n])}l.placedSymbolArray.emplaceBack(z.x,z.y,Ce,this.glyphOffsetArray.length-Ce,ke,B,G,z.segment,p?p[0]:0,p?p[1]:0,y[0],y[1],R,0,!1,0,X)}_addCollisionDebugVertex(l,h,p,y,S,M){return h.emplaceBack(0,0),l.emplaceBack(p.x,p.y,y,S,Math.round(M.x),Math.round(M.y))}addCollisionDebugVertices(l,h,p,y,S,M,R){const z=S.segments.prepareSegment(4,S.layoutVertexArray,S.indexArray),B=z.vertexLength,G=S.layoutVertexArray,X=S.collisionVertexArray,ie=R.anchorX,ae=R.anchorY;this._addCollisionDebugVertex(G,X,M,ie,ae,new A(l,h)),this._addCollisionDebugVertex(G,X,M,ie,ae,new A(p,h)),this._addCollisionDebugVertex(G,X,M,ie,ae,new A(p,y)),this._addCollisionDebugVertex(G,X,M,ie,ae,new A(l,y)),z.vertexLength+=4;const ce=S.indexArray;ce.emplaceBack(B,B+1),ce.emplaceBack(B+1,B+2),ce.emplaceBack(B+2,B+3),ce.emplaceBack(B+3,B),z.primitiveLength+=4}addDebugCollisionBoxes(l,h,p,y){for(let S=l;S<h;S++){const M=this.collisionBoxArray.get(S);this.addCollisionDebugVertices(M.x1,M.y1,M.x2,M.y2,y?this.textCollisionBox:this.iconCollisionBox,M.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new v2(Pr,Bk.members,Ar),this.iconCollisionBox=new v2(Pr,Bk.members,Ar);for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(l,h,p,y,S,M,R,z,B){const G={};for(let X=h;X<p;X++){const ie=l.get(X);G.textBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},G.textFeatureIndex=ie.featureIndex;break}for(let X=y;X<S;X++){const ie=l.get(X);G.verticalTextBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},G.verticalTextFeatureIndex=ie.featureIndex;break}for(let X=M;X<R;X++){const ie=l.get(X);G.iconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},G.iconFeatureIndex=ie.featureIndex;break}for(let X=z;X<B;X++){const ie=l.get(X);G.verticalIconBox={x1:ie.x1,y1:ie.y1,x2:ie.x2,y2:ie.y2,anchorPointX:ie.anchorPointX,anchorPointY:ie.anchorPointY},G.verticalIconFeatureIndex=ie.featureIndex;break}return G}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,h){const p=l.placedSymbolArray.get(h),y=p.vertexStartIndex+4*p.numGlyphs;for(let S=p.vertexStartIndex;S<y;S+=4)l.indexArray.emplaceBack(S,S+2,S+1),l.indexArray.emplaceBack(S+1,S+2,S+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(l),p=Math.cos(l),y=[],S=[],M=[];for(let R=0;R<this.symbolInstances.length;++R){M.push(R);const z=this.symbolInstances.get(R);y.push(0|Math.round(h*z.anchorX+p*z.anchorY)),S.push(z.featureIndex)}return M.sort((R,z)=>y[R]-y[z]||S[z]-S[R]),M}addToSortKeyRanges(l,h){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===h?p.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const p=this.symbolInstances.get(h);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((y,S,M)=>{y>=0&&M.indexOf(y)===S&&this.addIndicesForPlacedSymbol(this.text,y)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Qk,eD;xn("SymbolBucket",Ap,{omit:["layers","collisionBoxArray","features","compareText"]}),Ap.MAX_GLYPHS=65535,Ap.addDynamicAttributes=m2;var y2={get paint(){return eD=eD||new ko({"icon-opacity":new Vn(Oe.paint_symbol["icon-opacity"]),"icon-color":new Vn(Oe.paint_symbol["icon-color"]),"icon-halo-color":new Vn(Oe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Vn(Oe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Vn(Oe.paint_symbol["icon-halo-blur"]),"icon-translate":new En(Oe.paint_symbol["icon-translate"]),"icon-translate-anchor":new En(Oe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Vn(Oe.paint_symbol["text-opacity"]),"text-color":new Vn(Oe.paint_symbol["text-color"],{runtimeType:pn,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new Vn(Oe.paint_symbol["text-halo-color"]),"text-halo-width":new Vn(Oe.paint_symbol["text-halo-width"]),"text-halo-blur":new Vn(Oe.paint_symbol["text-halo-blur"]),"text-translate":new En(Oe.paint_symbol["text-translate"]),"text-translate-anchor":new En(Oe.paint_symbol["text-translate-anchor"])})},get layout(){return Qk=Qk||new ko({"symbol-placement":new En(Oe.layout_symbol["symbol-placement"]),"symbol-spacing":new En(Oe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new En(Oe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Vn(Oe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new En(Oe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new En(Oe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new En(Oe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new En(Oe.layout_symbol["icon-ignore-placement"]),"icon-optional":new En(Oe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new En(Oe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Vn(Oe.layout_symbol["icon-size"]),"icon-text-fit":new En(Oe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new En(Oe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Vn(Oe.layout_symbol["icon-image"]),"icon-rotate":new Vn(Oe.layout_symbol["icon-rotate"]),"icon-padding":new Vn(Oe.layout_symbol["icon-padding"]),"icon-keep-upright":new En(Oe.layout_symbol["icon-keep-upright"]),"icon-offset":new Vn(Oe.layout_symbol["icon-offset"]),"icon-anchor":new Vn(Oe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new En(Oe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new En(Oe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new En(Oe.layout_symbol["text-rotation-alignment"]),"text-field":new Vn(Oe.layout_symbol["text-field"]),"text-font":new Vn(Oe.layout_symbol["text-font"]),"text-size":new Vn(Oe.layout_symbol["text-size"]),"text-max-width":new Vn(Oe.layout_symbol["text-max-width"]),"text-line-height":new En(Oe.layout_symbol["text-line-height"]),"text-letter-spacing":new Vn(Oe.layout_symbol["text-letter-spacing"]),"text-justify":new Vn(Oe.layout_symbol["text-justify"]),"text-radial-offset":new Vn(Oe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new En(Oe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Vn(Oe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Vn(Oe.layout_symbol["text-anchor"]),"text-max-angle":new En(Oe.layout_symbol["text-max-angle"]),"text-writing-mode":new En(Oe.layout_symbol["text-writing-mode"]),"text-rotate":new Vn(Oe.layout_symbol["text-rotate"]),"text-padding":new En(Oe.layout_symbol["text-padding"]),"text-keep-upright":new En(Oe.layout_symbol["text-keep-upright"]),"text-transform":new Vn(Oe.layout_symbol["text-transform"]),"text-offset":new Vn(Oe.layout_symbol["text-offset"]),"text-allow-overlap":new En(Oe.layout_symbol["text-allow-overlap"]),"text-overlap":new En(Oe.layout_symbol["text-overlap"]),"text-ignore-placement":new En(Oe.layout_symbol["text-ignore-placement"]),"text-optional":new En(Oe.layout_symbol["text-optional"])})}};class tD{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:xt,this.defaultValue=l}evaluate(l){if(l.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(l.formattedSection))return h.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}xn("FormatSectionOverride",tD,{omit:["defaultValue"]});class h1 extends eo{constructor(l){super(l,y2)}recalculate(l,h){if(super.recalculate(l,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const y=[];for(const S of p)y.indexOf(S)<0&&y.push(S);this.layout._values["text-writing-mode"]=y}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,h,p,y){const S=this.layout.get(l).evaluate(h,{},p,y),M=this._unevaluatedLayout._values[l];return M.isDataDriven()||sp(M.value)||!S?S:function(R,z){return z.replace(/{([^{}]+)}/g,(B,G)=>R&&G in R?String(R[G]):"")}(h.properties,S)}createBucket(l){return new Ap(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const l of y2.paint.overridableProperties){if(!h1.hasPaintOverride(this.layout,l))continue;const h=this.paint.get(l),p=new tD(h),y=new op(p,h.property.specification);let S=null;S=h.value.kind==="constant"||h.value.kind==="source"?new xd("source",y):new lp("composite",y,h.value.zoomStops),this.paint._values[l]=new La(h.property,S,h.parameters)}}_handleOverridablePaintPropertyUpdate(l,h,p){return!(!this.layout||h.isDataDriven()||p.isDataDriven())&&h1.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,h){const p=l.get("text-field"),y=y2.paint.properties[h];let S=!1;const M=R=>{for(const z of R)if(y.overrides&&y.overrides.hasOverride(z))return void(S=!0)};if(p.value.kind==="constant"&&p.value.value instanceof go)M(p.value.value.sections);else if(p.value.kind==="source"){const R=B=>{S||(B instanceof Io&&Gn(B.value)===vt?M(B.value.sections):B instanceof fd?M(B.sections):B.eachChild(R))},z=p.value;z._styleExpression&&R(z._styleExpression.expression)}return S}}let nD;var _q={get paint(){return nD=nD||new ko({"background-color":new En(Oe.paint_background["background-color"]),"background-pattern":new Av(Oe.paint_background["background-pattern"]),"background-opacity":new En(Oe.paint_background["background-opacity"])})}};class xq extends eo{constructor(l){super(l,_q)}}let rD;var bq={get paint(){return rD=rD||new ko({"raster-opacity":new En(Oe.paint_raster["raster-opacity"]),"raster-hue-rotate":new En(Oe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new En(Oe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new En(Oe.paint_raster["raster-brightness-max"]),"raster-saturation":new En(Oe.paint_raster["raster-saturation"]),"raster-contrast":new En(Oe.paint_raster["raster-contrast"]),"raster-resampling":new En(Oe.paint_raster["raster-resampling"]),"raster-fade-duration":new En(Oe.paint_raster["raster-fade-duration"])})}};class wq extends eo{constructor(l){super(l,bq)}}class Sq extends eo{constructor(l){super(l,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Mq{constructor(l){this._methodToThrottle=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Cq={once:!0},_2=63710088e-1;class Wu{constructor(l,h){if(isNaN(l)||isNaN(h))throw new Error(`Invalid LngLat object: (${l}, ${h})`);if(this.lng=+l,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Wu(Ct(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const h=Math.PI/180,p=this.lat*h,y=l.lat*h,S=Math.sin(p)*Math.sin(y)+Math.cos(p)*Math.cos(y)*Math.cos((l.lng-this.lng)*h);return _2*Math.acos(Math.min(S,1))}static convert(l){if(l instanceof Wu)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Wu(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Wu(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const iD=2*Math.PI*_2;function oD(d){return iD*Math.cos(d*Math.PI/180)}function sD(d){return(180+d)/360}function aD(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function lD(d,l){return d/oD(l)}function x2(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function cD(d,l){return d*oD(x2(l))}class Yv{constructor(l,h,p=0){this.x=+l,this.y=+h,this.z=+p}static fromLngLat(l,h=0){const p=Wu.convert(l);return new Yv(sD(p.lng),aD(p.lat),lD(h,p.lat))}toLngLat(){return new Wu(360*this.x-180,x2(this.y))}toAltitude(){return cD(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/iD*(l=x2(this.y),1/Math.cos(l*Math.PI/180));var l}}function uD(d,l,h){var p=2*Math.PI*6378137/256/Math.pow(2,h);return[d*p-2*Math.PI*6378137/2,l*p-2*Math.PI*6378137/2]}class b2{constructor(l,h,p){if(!function(y,S,M){return!(y<0||y>25||M<0||M>=Math.pow(2,y)||S<0||S>=Math.pow(2,y))}(l,h,p))throw new Error(`x=${h}, y=${p}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=h,this.y=p,this.key=Ip(0,l,l,h,p)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,h,p){const y=(M=this.y,R=this.z,z=uD(256*(S=this.x),256*(M=Math.pow(2,R)-M-1),R),B=uD(256*(S+1),256*(M+1),R),z[0]+","+z[1]+","+B[0]+","+B[1]);var S,M,R,z,B;const G=function(X,ie,ae){let ce,de="";for(let Ce=X;Ce>0;Ce--)ce=1<<Ce-1,de+=(ie&ce?1:0)+(ae&ce?2:0);return de}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,G).replace(/{bbox-epsg-3857}/g,y)}isChildOf(l){const h=this.z-l.z;return h>0&&l.x===this.x>>h&&l.y===this.y>>h}getTilePoint(l){const h=Math.pow(2,this.z);return new A((l.x*h-this.x)*ct,(l.y*h-this.y)*ct)}toString(){return`${this.z}/${this.x}/${this.y}`}}class hD{constructor(l,h){this.wrap=l,this.canonical=h,this.key=Ip(l,h.z,h.z,h.x,h.y)}}class ea{constructor(l,h,p,y,S){if(this.terrainRttPosMatrix32f=null,l<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${p}`);this.overscaledZ=l,this.wrap=h,this.canonical=new b2(p,+y,+S),this.key=Ip(h,l,p,y,S)}clone(){return new ea(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-l;return l>this.canonical.z?new ea(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ea(l,this.wrap,l,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(l,h){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-l;return l>this.canonical.z?Ip(this.wrap*+h,l,this.canonical.z,this.canonical.x,this.canonical.y):Ip(this.wrap*+h,l,l,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(l){if(l.wrap!==this.wrap)return!1;const h=this.canonical.z-l.canonical.z;return l.overscaledZ===0||l.overscaledZ<this.overscaledZ&&l.canonical.x===this.canonical.x>>h&&l.canonical.y===this.canonical.y>>h}children(l){if(this.overscaledZ>=l)return[new ea(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,p=2*this.canonical.x,y=2*this.canonical.y;return[new ea(h,this.wrap,h,p,y),new ea(h,this.wrap,h,p+1,y),new ea(h,this.wrap,h,p,y+1),new ea(h,this.wrap,h,p+1,y+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new ea(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new ea(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new hD(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new Yv(l.x-this.wrap,l.y))}}function Ip(d,l,h,p,y){(d*=2)<0&&(d=-1*d-1);const S=1<<h;return(S*S*d+S*y+p).toString(36)+h.toString(36)+l.toString(36)}xn("CanonicalTileID",b2),xn("OverscaledTileID",ea,{omit:["terrainRttPosMatrix32f"]});class $d{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(l){return this.minX=Math.min(this.minX,l.x),this.minY=Math.min(this.minY,l.y),this.maxX=Math.max(this.maxX,l.x),this.maxY=Math.max(this.maxY,l.y),this}expandBy(l){return this.minX-=l,this.minY-=l,this.maxX+=l,this.maxY+=l,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(l){return this.expandBy(-l)}map(l){const h=new $d;return h.extend(l(new A(this.minX,this.minY))),h.extend(l(new A(this.maxX,this.minY))),h.extend(l(new A(this.minX,this.maxY))),h.extend(l(new A(this.maxX,this.maxY))),h}static fromPoints(l){const h=new $d;for(const p of l)h.extend(p);return h}contains(l){return l.x>=this.minX&&l.x<=this.maxX&&l.y>=this.minY&&l.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(l){return!this.empty()&&!l.empty()&&l.minX>=this.minX&&l.maxX<=this.maxX&&l.minY>=this.minY&&l.maxY<=this.maxY}intersects(l){return!this.empty()&&!l.empty()&&l.minX<=this.maxX&&l.maxX>=this.minX&&l.minY<=this.maxY&&l.maxY>=this.minY}}class dD{constructor(l){this._stringToNumber={},this._numberToString=[];for(let h=0;h<l.length;h++){const p=l[h];this._stringToNumber[p]=h,this._numberToString[h]=p}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class fD{constructor(l,h,p,y,S){this.type="Feature",this._vectorTileFeature=l,l._z=h,l._x=p,l._y=y,this.properties=l.properties,this.id=S}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(l[h]=this[h]);return l}}class pD{constructor(l,h){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new Uu(ct,16,0),this.grid3D=new Uu(ct,16,0),this.featureIndexArray=new yt,this.promoteId=h}insert(l,h,p,y,S,M){const R=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,y,S);const z=M?this.grid3D:this.grid;for(let B=0;B<h.length;B++){const G=h[B],X=[1/0,1/0,-1/0,-1/0];for(let ie=0;ie<G.length;ie++){const ae=G[ie];X[0]=Math.min(X[0],ae.x),X[1]=Math.min(X[1],ae.y),X[2]=Math.max(X[2],ae.x),X[3]=Math.max(X[3],ae.y)}X[0]<ct&&X[1]<ct&&X[2]>=0&&X[3]>=0&&z.insert(R,X[0],X[1],X[2],X[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Gv.VectorTile(new u2(this.rawTileData)).layers,this.sourceLayerCoder=new dD(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(l,h,p,y){this.loadVTLayers();const S=l.params,M=ct/l.tileSize/l.scale,R=Fl(S.filter),z=l.queryGeometry,B=l.queryPadding*M,G=$d.fromPoints(z),X=this.grid.query(G.minX-B,G.minY-B,G.maxX+B,G.maxY+B),ie=$d.fromPoints(l.cameraQueryGeometry).expandBy(B),ae=this.grid3D.query(ie.minX,ie.minY,ie.maxX,ie.maxY,(Ce,ke,et,Ge)=>function(se,we,Xe,mt,$t){for(const Mt of se)if(we<=Mt.x&&Xe<=Mt.y&&mt>=Mt.x&&$t>=Mt.y)return!0;const bt=[new A(we,Xe),new A(we,$t),new A(mt,$t),new A(mt,Xe)];if(se.length>2){for(const Mt of bt)if(Mp(se,Mt))return!0}for(let Mt=0;Mt<se.length-1;Mt++)if(dW(se[Mt],se[Mt+1],bt))return!0;return!1}(l.cameraQueryGeometry,Ce-B,ke-B,et+B,Ge+B));for(const Ce of ae)X.push(Ce);X.sort(Eq);const ce={};let de;for(let Ce=0;Ce<X.length;Ce++){const ke=X[Ce];if(ke===de)continue;de=ke;const et=this.featureIndexArray.get(ke);let Ge=null;this.loadMatchingFeature(ce,et.bucketIndex,et.sourceLayerIndex,et.featureIndex,R,S.layers,S.availableImages,h,p,y,(se,we,Xe)=>(Ge||(Ge=Fd(se)),we.queryIntersectsFeature({queryGeometry:z,feature:se,featureState:Xe,geometry:Ge,zoom:this.z,transform:l.transform,pixelsToTileUnits:M,pixelPosMatrix:l.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:l.getElevation})))}return ce}loadMatchingFeature(l,h,p,y,S,M,R,z,B,G,X){const ie=this.bucketLayerIDs[h];if(M&&!ie.some(Ce=>M.has(Ce)))return;const ae=this.sourceLayerCoder.decode(p),ce=this.vtLayers[ae].feature(y);if(S.needGeometry){const Ce=Nd(ce,!0);if(!S.filter(new Xr(this.tileID.overscaledZ),Ce,this.tileID.canonical))return}else if(!S.filter(new Xr(this.tileID.overscaledZ),ce))return;const de=this.getId(ce,ae);for(let Ce=0;Ce<ie.length;Ce++){const ke=ie[Ce];if(M&&!M.has(ke))continue;const et=z[ke];if(!et)continue;let Ge={};de&&G&&(Ge=G.getState(et.sourceLayer||"_geojsonTileLayer",de));const se=un({},B[ke]);se.paint=mD(se.paint,et.paint,ce,Ge,R),se.layout=mD(se.layout,et.layout,ce,Ge,R);const we=!X||X(ce,et,Ge);if(!we)continue;const Xe=new fD(ce,this.z,this.x,this.y,de);Xe.layer=se;let mt=l[ke];mt===void 0&&(mt=l[ke]=[]),mt.push({featureIndex:y,feature:Xe,intersectionZ:we})}}lookupSymbolFeatures(l,h,p,y,S,M,R,z){const B={};this.loadVTLayers();const G=Fl(S);for(const X of l)this.loadMatchingFeature(B,p,y,X,G,M,R,z,h);return B}hasLayer(l){for(const h of this.bucketLayerIDs)for(const p of h)if(l===p)return!0;return!1}getId(l,h){var p;let y=l.id;return this.promoteId&&(y=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof y=="boolean"&&(y=Number(y)),y===void 0&&(!((p=l.properties)===null||p===void 0)&&p.cluster)&&this.promoteId&&(y=Number(l.properties.cluster_id))),y}}function mD(d,l,h,p,y){return hn(d,(S,M)=>{const R=l instanceof xp?l.get(M):null;return R&&R.evaluate?R.evaluate(h,p,y):R})}function Eq(d,l){return l-d}function gD(d,l,h,p,y){const S=[];for(let M=0;M<d.length;M++){const R=d[M];let z;for(let B=0;B<R.length-1;B++){let G=R[B],X=R[B+1];G.x<l&&X.x<l||(G.x<l?G=new A(l,G.y+(l-G.x)/(X.x-G.x)*(X.y-G.y))._round():X.x<l&&(X=new A(l,G.y+(l-G.x)/(X.x-G.x)*(X.y-G.y))._round()),G.y<h&&X.y<h||(G.y<h?G=new A(G.x+(h-G.y)/(X.y-G.y)*(X.x-G.x),h)._round():X.y<h&&(X=new A(G.x+(h-G.y)/(X.y-G.y)*(X.x-G.x),h)._round()),G.x>=p&&X.x>=p||(G.x>=p?G=new A(p,G.y+(p-G.x)/(X.x-G.x)*(X.y-G.y))._round():X.x>=p&&(X=new A(p,G.y+(p-G.x)/(X.x-G.x)*(X.y-G.y))._round()),G.y>=y&&X.y>=y||(G.y>=y?G=new A(G.x+(y-G.y)/(X.y-G.y)*(X.x-G.x),y)._round():X.y>=y&&(X=new A(G.x+(y-G.y)/(X.y-G.y)*(X.x-G.x),y)._round()),z&&G.equals(z[z.length-1])||(z=[G],S.push(z)),z.push(X)))))}}return S}xn("FeatureIndex",pD,{omit:["rawTileData","sourceLayerCoder"]});class qu extends A{constructor(l,h,p,y){super(l,h),this.angle=p,y!==void 0&&(this.segment=y)}clone(){return new qu(this.x,this.y,this.angle,this.segment)}}function vD(d,l,h,p,y){if(l.segment===void 0||h===0)return!0;let S=l,M=l.segment+1,R=0;for(;R>-h/2;){if(M--,M<0)return!1;R-=d[M].dist(S),S=d[M]}R+=d[M].dist(d[M+1]),M++;const z=[];let B=0;for(;R<h/2;){const G=d[M],X=d[M+1];if(!X)return!1;let ie=d[M-1].angleTo(G)-G.angleTo(X);for(ie=Math.abs((ie+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:R,angleDelta:ie}),B+=ie;R-z[0].distance>p;)B-=z.shift().angleDelta;if(B>y)return!1;M++,R+=G.dist(X)}return!0}function yD(d){let l=0;for(let h=0;h<d.length-1;h++)l+=d[h].dist(d[h+1]);return l}function _D(d,l,h){return d?.6*l*h:0}function xD(d,l){return Math.max(d?d.right-d.left:0,l?l.right-l.left:0)}function Tq(d,l,h,p,y,S){const M=_D(h,y,S),R=xD(h,p)*S;let z=0;const B=yD(d)/2;for(let G=0;G<d.length-1;G++){const X=d[G],ie=d[G+1],ae=X.dist(ie);if(z+ae>B){const ce=(B-z)/ae,de=cs.number(X.x,ie.x,ce),Ce=cs.number(X.y,ie.y,ce),ke=new qu(de,Ce,ie.angleTo(X),G);return ke._round(),!M||vD(d,ke,R,M,l)?ke:void 0}z+=ae}}function Pq(d,l,h,p,y,S,M,R,z){const B=_D(p,S,M),G=xD(p,y),X=G*M,ie=d[0].x===0||d[0].x===z||d[0].y===0||d[0].y===z;return l-X<l/4&&(l=X+l/4),bD(d,ie?l/2*R%l:(G/2+2*S)*M*R%l,l,B,h,X,ie,!1,z)}function bD(d,l,h,p,y,S,M,R,z){const B=S/2,G=yD(d);let X=0,ie=l-h,ae=[];for(let ce=0;ce<d.length-1;ce++){const de=d[ce],Ce=d[ce+1],ke=de.dist(Ce),et=Ce.angleTo(de);for(;ie+h<X+ke;){ie+=h;const Ge=(ie-X)/ke,se=cs.number(de.x,Ce.x,Ge),we=cs.number(de.y,Ce.y,Ge);if(se>=0&&se<z&&we>=0&&we<z&&ie-B>=0&&ie+B<=G){const Xe=new qu(se,we,et,ce);Xe._round(),p&&!vD(d,Xe,S,p,y)||ae.push(Xe)}}X+=ke}return R||ae.length||M||(ae=bD(d,X/2,h,p,y,S,M,!0,z)),ae}function wD(d,l,h,p){const y=[],S=d.image,M=S.pixelRatio,R=S.paddedRect.w-2,z=S.paddedRect.h-2;let B={x1:d.left,y1:d.top,x2:d.right,y2:d.bottom};const G=S.stretchX||[[0,R]],X=S.stretchY||[[0,z]],ie=(Pt,Cn)=>Pt+Cn[1]-Cn[0],ae=G.reduce(ie,0),ce=X.reduce(ie,0),de=R-ae,Ce=z-ce;let ke=0,et=ae,Ge=0,se=ce,we=0,Xe=de,mt=0,$t=Ce;if(S.content&&p){const Pt=S.content,Cn=Pt[2]-Pt[0],$n=Pt[3]-Pt[1];(S.textFitWidth||S.textFitHeight)&&(B=Yk(d)),ke=d1(G,0,Pt[0]),Ge=d1(X,0,Pt[1]),et=d1(G,Pt[0],Pt[2]),se=d1(X,Pt[1],Pt[3]),we=Pt[0]-ke,mt=Pt[1]-Ge,Xe=Cn-et,$t=$n-se}const bt=B.x1,Mt=B.y1,Jt=B.x2-bt,jt=B.y2-Mt,en=(Pt,Cn,$n,Bn)=>{const kn=f1(Pt.stretch-ke,et,Jt,bt),ir=p1(Pt.fixed-we,Xe,Pt.stretch,ae),ai=f1(Cn.stretch-Ge,se,jt,Mt),Li=p1(Cn.fixed-mt,$t,Cn.stretch,ce),_o=f1($n.stretch-ke,et,Jt,bt),ta=p1($n.fixed-we,Xe,$n.stretch,ae),hs=f1(Bn.stretch-Ge,se,jt,Mt),io=p1(Bn.fixed-mt,$t,Bn.stretch,ce),ri=new A(kn,ai),Wi=new A(_o,ai),oo=new A(_o,hs),so=new A(kn,hs),Jo=new A(ir/M,Li/M),na=new A(ta/M,io/M),qi=l*Math.PI/180;if(qi){const Xi=Math.sin(qi),Zi=Math.cos(qi),Si=[Zi,-Xi,Xi,Zi];ri._matMult(Si),Wi._matMult(Si),so._matMult(Si),oo._matMult(Si)}const ds=Pt.stretch+Pt.fixed,ki=Cn.stretch+Cn.fixed;return{tl:ri,tr:Wi,bl:so,br:oo,tex:{x:S.paddedRect.x+1+ds,y:S.paddedRect.y+1+ki,w:$n.stretch+$n.fixed-ds,h:Bn.stretch+Bn.fixed-ki},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Jo,pixelOffsetBR:na,minFontScaleX:Xe/M/Jt,minFontScaleY:$t/M/jt,isSDF:h}};if(p&&(S.stretchX||S.stretchY)){const Pt=SD(G,de,ae),Cn=SD(X,Ce,ce);for(let $n=0;$n<Pt.length-1;$n++){const Bn=Pt[$n],kn=Pt[$n+1];for(let ir=0;ir<Cn.length-1;ir++)y.push(en(Bn,Cn[ir],kn,Cn[ir+1]))}}else y.push(en({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:z+1}));return y}function d1(d,l,h){let p=0;for(const y of d)p+=Math.max(l,Math.min(h,y[1]))-Math.max(l,Math.min(h,y[0]));return p}function SD(d,l,h){const p=[{fixed:-1,stretch:0}];for(const[y,S]of d){const M=p[p.length-1];p.push({fixed:y-M.stretch,stretch:M.stretch}),p.push({fixed:y-M.stretch,stretch:M.stretch+(S-y)})}return p.push({fixed:l+1,stretch:h}),p}function f1(d,l,h,p){return d/l*h+p}function p1(d,l,h,p){return d-l*h/p}xn("Anchor",qu);class m1{constructor(l,h,p,y,S,M,R,z,B,G){var X;if(this.boxStartIndex=l.length,B){let ie=M.top,ae=M.bottom;const ce=M.collisionPadding;ce&&(ie-=ce[1],ae+=ce[3]);let de=ae-ie;de>0&&(de=Math.max(10,de),this.circleDiameter=de)}else{const ie=!((X=M.image)===null||X===void 0)&&X.content&&(M.image.textFitWidth||M.image.textFitHeight)?Yk(M):{x1:M.left,y1:M.top,x2:M.right,y2:M.bottom};ie.y1=ie.y1*R-z[0],ie.y2=ie.y2*R+z[2],ie.x1=ie.x1*R-z[3],ie.x2=ie.x2*R+z[1];const ae=M.collisionPadding;if(ae&&(ie.x1-=ae[0]*R,ie.y1-=ae[1]*R,ie.x2+=ae[2]*R,ie.y2+=ae[3]*R),G){const ce=new A(ie.x1,ie.y1),de=new A(ie.x2,ie.y1),Ce=new A(ie.x1,ie.y2),ke=new A(ie.x2,ie.y2),et=G*Math.PI/180;ce._rotate(et),de._rotate(et),Ce._rotate(et),ke._rotate(et),ie.x1=Math.min(ce.x,de.x,Ce.x,ke.x),ie.x2=Math.max(ce.x,de.x,Ce.x,ke.x),ie.y1=Math.min(ce.y,de.y,Ce.y,ke.y),ie.y2=Math.max(ce.y,de.y,Ce.y,ke.y)}l.emplaceBack(h.x,h.y,ie.x1,ie.y1,ie.x2,ie.y2,p,y,S)}this.boxEndIndex=l.length}}class Aq{constructor(l=[],h=(p,y)=>p<y?-1:p>y?1:0){if(this.data=l,this.length=this.data.length,this.compare=h,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:h,compare:p}=this,y=h[l];for(;l>0;){const S=l-1>>1,M=h[S];if(p(y,M)>=0)break;h[l]=M,l=S}h[l]=y}_down(l){const{data:h,compare:p}=this,y=this.length>>1,S=h[l];for(;l<y;){let M=1+(l<<1);const R=M+1;if(R<this.length&&p(h[R],h[M])<0&&(M=R),p(h[M],S)>=0)break;h[l]=h[M],l=M}h[l]=S}}function Iq(d,l=1,h=!1){const p=$d.fromPoints(d[0]),y=Math.min(p.width(),p.height());let S=y/2;const M=new Aq([],Rq),{minX:R,minY:z,maxX:B,maxY:G}=p;if(y===0)return new A(R,z);for(let ae=R;ae<B;ae+=y)for(let ce=z;ce<G;ce+=y)M.push(new Rp(ae+S,ce+S,S,d));let X=function(ae){let ce=0,de=0,Ce=0;const ke=ae[0];for(let et=0,Ge=ke.length,se=Ge-1;et<Ge;se=et++){const we=ke[et],Xe=ke[se],mt=we.x*Xe.y-Xe.x*we.y;de+=(we.x+Xe.x)*mt,Ce+=(we.y+Xe.y)*mt,ce+=3*mt}return new Rp(de/ce,Ce/ce,0,ae)}(d),ie=M.length;for(;M.length;){const ae=M.pop();(ae.d>X.d||!X.d)&&(X=ae,h&&console.log("found best %d after %d probes",Math.round(1e4*ae.d)/1e4,ie)),ae.max-X.d<=l||(S=ae.h/2,M.push(new Rp(ae.p.x-S,ae.p.y-S,S,d)),M.push(new Rp(ae.p.x+S,ae.p.y-S,S,d)),M.push(new Rp(ae.p.x-S,ae.p.y+S,S,d)),M.push(new Rp(ae.p.x+S,ae.p.y+S,S,d)),ie+=4)}return h&&(console.log(`num probes: ${ie}`),console.log(`best distance: ${X.d}`)),X.p}function Rq(d,l){return l.max-d.max}function Rp(d,l,h,p){this.p=new A(d,l),this.h=h,this.d=function(y,S){let M=!1,R=1/0;for(let z=0;z<S.length;z++){const B=S[z];for(let G=0,X=B.length,ie=X-1;G<X;ie=G++){const ae=B[G],ce=B[ie];ae.y>y.y!=ce.y>y.y&&y.x<(ce.x-ae.x)*(y.y-ae.y)/(ce.y-ae.y)+ae.x&&(M=!M),R=Math.min(R,nk(y,ae,ce))}}return(M?1:-1)*Math.sqrt(R)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}var yo;c.aD=void 0,(yo=c.aD||(c.aD={}))[yo.center=1]="center",yo[yo.left=2]="left",yo[yo.right=3]="right",yo[yo.top=4]="top",yo[yo.bottom=5]="bottom",yo[yo["top-left"]=6]="top-left",yo[yo["top-right"]=7]="top-right",yo[yo["bottom-left"]=8]="bottom-left",yo[yo["bottom-right"]=9]="bottom-right";const w2=Number.POSITIVE_INFINITY;function MD(d,l){return l[1]!==w2?function(h,p,y){let S=0,M=0;switch(p=Math.abs(p),y=Math.abs(y),h){case"top-right":case"top-left":case"top":M=y-7;break;case"bottom-right":case"bottom-left":case"bottom":M=7-y}switch(h){case"top-right":case"bottom-right":case"right":S=-p;break;case"top-left":case"bottom-left":case"left":S=p}return[S,M]}(d,l[0],l[1]):function(h,p){let y=0,S=0;p<0&&(p=0);const M=p/Math.SQRT2;switch(h){case"top-right":case"top-left":S=M-7;break;case"bottom-right":case"bottom-left":S=7-M;break;case"bottom":S=7-p;break;case"top":S=p-7}switch(h){case"top-right":case"bottom-right":y=-M;break;case"top-left":case"bottom-left":y=M;break;case"left":y=p;break;case"right":y=-p}return[y,S]}(d,l[0])}function CD(d,l,h){var p;const y=d.layout,S=(p=y.get("text-variable-anchor-offset"))===null||p===void 0?void 0:p.evaluate(l,{},h);if(S){const R=S.values,z=[];for(let B=0;B<R.length;B+=2){const G=z[B]=R[B],X=R[B+1].map(ie=>ie*Gi);G.startsWith("top")?X[1]-=7:G.startsWith("bottom")&&(X[1]+=7),z[B+1]=X}return new sr(z)}const M=y.get("text-variable-anchor");if(M){let R;R=d._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[y.get("text-radial-offset").evaluate(l,{},h)*Gi,w2]:y.get("text-offset").evaluate(l,{},h).map(B=>B*Gi);const z=[];for(const B of M)z.push(B,MD(B,R));return new sr(z)}return null}function S2(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Lq(d,l,h,p,y,S,M,R,z,B,G,X){let ie=S.textMaxSize.evaluate(l,{});ie===void 0&&(ie=M);const ae=d.layers[0].layout,ce=ae.get("icon-offset").evaluate(l,{},G),de=TD(h.horizontal),Ce=M/24,ke=d.tilePixelRatio*Ce,et=d.tilePixelRatio*ie/24,Ge=d.tilePixelRatio*R,se=d.tilePixelRatio*ae.get("symbol-spacing"),we=ae.get("text-padding")*d.tilePixelRatio,Xe=function($n,Bn,kn,ir=1){const ai=$n.get("icon-padding").evaluate(Bn,{},kn),Li=ai&&ai.values;return[Li[0]*ir,Li[1]*ir,Li[2]*ir,Li[3]*ir]}(ae,l,G,d.tilePixelRatio),mt=ae.get("text-max-angle")/180*Math.PI,$t=ae.get("text-rotation-alignment")!=="viewport"&&ae.get("symbol-placement")!=="point",bt=ae.get("icon-rotation-alignment")==="map"&&ae.get("symbol-placement")!=="point",Mt=ae.get("symbol-placement"),Jt=se/2,jt=ae.get("icon-text-fit");let en;p&&jt!=="none"&&(d.allowVerticalPlacement&&h.vertical&&(en=Kk(p,h.vertical,jt,ae.get("icon-text-fit-padding"),ce,Ce)),de&&(p=Kk(p,de,jt,ae.get("icon-text-fit-padding"),ce,Ce)));const Pt=G?X.line.getGranularityForZoomLevel(G.z):1,Cn=($n,Bn)=>{Bn.x<0||Bn.x>=ct||Bn.y<0||Bn.y>=ct||function(kn,ir,ai,Li,_o,ta,hs,io,ri,Wi,oo,so,Jo,na,qi,ds,ki,Xi,Zi,Si,Gr,cl,Lp,ul,zq){const kp=kn.addToLineVertexArray(ir,ai);let Vd,Dp,zp,Op,RD=0,LD=0,kD=0,DD=0,R2=-1,L2=-1;const Dc={};let zD=Ko("");if(kn.allowVerticalPlacement&&Li.vertical){const zo=io.layout.get("text-rotate").evaluate(Gr,{},ul)+90;zp=new m1(ri,ir,Wi,oo,so,Li.vertical,Jo,na,qi,zo),hs&&(Op=new m1(ri,ir,Wi,oo,so,hs,ki,Xi,qi,zo))}if(_o){const zo=io.layout.get("icon-rotate").evaluate(Gr,{}),ra=io.layout.get("icon-text-fit")!=="none",jd=wD(_o,zo,Lp,ra),dl=hs?wD(hs,zo,Lp,ra):void 0;Dp=new m1(ri,ir,Wi,oo,so,_o,ki,Xi,!1,zo),RD=4*jd.length;const Hd=kn.iconSizeData;let ql=null;Hd.kind==="source"?(ql=[kc*io.layout.get("icon-size").evaluate(Gr,{})],ql[0]>Gu&&tn(`${kn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Hd.kind==="composite"&&(ql=[kc*cl.compositeIconSizes[0].evaluate(Gr,{},ul),kc*cl.compositeIconSizes[1].evaluate(Gr,{},ul)],(ql[0]>Gu||ql[1]>Gu)&&tn(`${kn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),kn.addSymbols(kn.icon,jd,ql,Si,Zi,Gr,c.an.none,ir,kp.lineStartIndex,kp.lineLength,-1,ul),R2=kn.icon.placedSymbolArray.length-1,dl&&(LD=4*dl.length,kn.addSymbols(kn.icon,dl,ql,Si,Zi,Gr,c.an.vertical,ir,kp.lineStartIndex,kp.lineLength,-1,ul),L2=kn.icon.placedSymbolArray.length-1)}const OD=Object.keys(Li.horizontal);for(const zo of OD){const ra=Li.horizontal[zo];if(!Vd){zD=Ko(ra.text);const dl=io.layout.get("text-rotate").evaluate(Gr,{},ul);Vd=new m1(ri,ir,Wi,oo,so,ra,Jo,na,qi,dl)}const jd=ra.positionedLines.length===1;if(kD+=ED(kn,ir,ra,ta,io,qi,Gr,ds,kp,Li.vertical?c.an.horizontal:c.an.horizontalOnly,jd?OD:[zo],Dc,R2,cl,ul),jd)break}Li.vertical&&(DD+=ED(kn,ir,Li.vertical,ta,io,qi,Gr,ds,kp,c.an.vertical,["vertical"],Dc,L2,cl,ul));const Oq=Vd?Vd.boxStartIndex:kn.collisionBoxArray.length,Fq=Vd?Vd.boxEndIndex:kn.collisionBoxArray.length,Nq=zp?zp.boxStartIndex:kn.collisionBoxArray.length,Bq=zp?zp.boxEndIndex:kn.collisionBoxArray.length,Uq=Dp?Dp.boxStartIndex:kn.collisionBoxArray.length,$q=Dp?Dp.boxEndIndex:kn.collisionBoxArray.length,Vq=Op?Op.boxStartIndex:kn.collisionBoxArray.length,jq=Op?Op.boxEndIndex:kn.collisionBoxArray.length;let hl=-1;const v1=(zo,ra)=>zo&&zo.circleDiameter?Math.max(zo.circleDiameter,ra):ra;hl=v1(Vd,hl),hl=v1(zp,hl),hl=v1(Dp,hl),hl=v1(Op,hl);const FD=hl>-1?1:0;FD&&(hl*=zq/Gi),kn.glyphOffsetArray.length>=Ap.MAX_GLYPHS&&tn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Gr.sortKey!==void 0&&kn.addToSortKeyRanges(kn.symbolInstances.length,Gr.sortKey);const Hq=CD(io,Gr,ul),[Gq,Wq]=function(zo,ra){const jd=zo.length,dl=ra==null?void 0:ra.values;if((dl==null?void 0:dl.length)>0)for(let Hd=0;Hd<dl.length;Hd+=2){const ql=dl[Hd+1];zo.emplaceBack(c.aD[dl[Hd]],ql[0],ql[1])}return[jd,zo.length]}(kn.textAnchorOffsets,Hq);kn.symbolInstances.emplaceBack(ir.x,ir.y,Dc.right>=0?Dc.right:-1,Dc.center>=0?Dc.center:-1,Dc.left>=0?Dc.left:-1,Dc.vertical||-1,R2,L2,zD,Oq,Fq,Nq,Bq,Uq,$q,Vq,jq,Wi,kD,DD,RD,LD,FD,0,Jo,hl,Gq,Wq)}(d,Bn,$n,h,p,y,en,d.layers[0],d.collisionBoxArray,l.index,l.sourceLayerIndex,d.index,ke,[we,we,we,we],$t,z,Ge,Xe,bt,ce,l,S,B,G,M)};if(Mt==="line")for(const $n of gD(l.geometry,0,0,ct,ct)){const Bn=Ud($n,Pt),kn=Pq(Bn,se,mt,h.vertical||de,p,24,et,d.overscaling,ct);for(const ir of kn)de&&kq(d,de.text,Jt,ir)||Cn(Bn,ir)}else if(Mt==="line-center"){for(const $n of l.geometry)if($n.length>1){const Bn=Ud($n,Pt),kn=Tq(Bn,mt,h.vertical||de,p,24,et);kn&&Cn(Bn,kn)}}else if(l.type==="Polygon")for(const $n of Jf(l.geometry,0)){const Bn=Iq($n,16);Cn(Ud($n[0],Pt,!0),new qu(Bn.x,Bn.y,0))}else if(l.type==="LineString")for(const $n of l.geometry){const Bn=Ud($n,Pt);Cn(Bn,new qu(Bn[0].x,Bn[0].y,0))}else if(l.type==="Point")for(const $n of l.geometry)for(const Bn of $n)Cn([Bn],new qu(Bn.x,Bn.y,0))}function ED(d,l,h,p,y,S,M,R,z,B,G,X,ie,ae,ce){const de=function(et,Ge,se,we,Xe,mt,$t,bt){const Mt=we.layout.get("text-rotate").evaluate(mt,{})*Math.PI/180,Jt=[];for(const jt of Ge.positionedLines)for(const en of jt.positionedGlyphs){if(!en.rect)continue;const Pt=en.rect||{};let Cn=4,$n=!0,Bn=1,kn=0;const ir=(Xe||bt)&&en.vertical,ai=en.metrics.advance*en.scale/2;if(bt&&Ge.verticalizable&&(kn=jt.lineOffset/2-(en.imageName?-(Gi-en.metrics.width*en.scale)/2:(en.scale-1)*Gi)),en.imageName){const Xi=$t[en.imageName];$n=Xi.sdf,Bn=Xi.pixelRatio,Cn=1/Bn}const Li=Xe?[en.x+ai,en.y]:[0,0];let _o=Xe?[0,0]:[en.x+ai+se[0],en.y+se[1]-kn],ta=[0,0];ir&&(ta=_o,_o=[0,0]);const hs=en.metrics.isDoubleResolution?2:1,io=(en.metrics.left-Cn)*en.scale-ai+_o[0],ri=(-en.metrics.top-Cn)*en.scale+_o[1],Wi=io+Pt.w/hs*en.scale/Bn,oo=ri+Pt.h/hs*en.scale/Bn,so=new A(io,ri),Jo=new A(Wi,ri),na=new A(io,oo),qi=new A(Wi,oo);if(ir){const Xi=new A(-ai,ai- -17),Zi=-Math.PI/2,Si=12-ai,Gr=new A(22-Si,-(en.imageName?Si:0)),cl=new A(...ta);so._rotateAround(Zi,Xi)._add(Gr)._add(cl),Jo._rotateAround(Zi,Xi)._add(Gr)._add(cl),na._rotateAround(Zi,Xi)._add(Gr)._add(cl),qi._rotateAround(Zi,Xi)._add(Gr)._add(cl)}if(Mt){const Xi=Math.sin(Mt),Zi=Math.cos(Mt),Si=[Zi,-Xi,Xi,Zi];so._matMult(Si),Jo._matMult(Si),na._matMult(Si),qi._matMult(Si)}const ds=new A(0,0),ki=new A(0,0);Jt.push({tl:so,tr:Jo,bl:na,br:qi,tex:Pt,writingMode:Ge.writingMode,glyphOffset:Li,sectionIndex:en.sectionIndex,isSDF:$n,pixelOffsetTL:ds,pixelOffsetBR:ki,minFontScaleX:0,minFontScaleY:0})}return Jt}(0,h,R,y,S,M,p,d.allowVerticalPlacement),Ce=d.textSizeData;let ke=null;Ce.kind==="source"?(ke=[kc*y.layout.get("text-size").evaluate(M,{})],ke[0]>Gu&&tn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Ce.kind==="composite"&&(ke=[kc*ae.compositeTextSizes[0].evaluate(M,{},ce),kc*ae.compositeTextSizes[1].evaluate(M,{},ce)],(ke[0]>Gu||ke[1]>Gu)&&tn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),d.addSymbols(d.text,de,ke,R,S,M,B,l,z.lineStartIndex,z.lineLength,ie,ce);for(const et of G)X[et]=d.text.placedSymbolArray.length-1;return 4*de.length}function TD(d){for(const l in d)return d[l];return null}function kq(d,l,h,p){const y=d.compareText;if(l in y){const S=y[l];for(let M=S.length-1;M>=0;M--)if(p.dist(S[M])<h)return!0}else y[l]=[];return y[l].push(p),!1}const PD=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class M2{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,p]=new Uint8Array(l,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const y=p>>4;if(y!==1)throw new Error(`Got v${y} data when expected v1.`);const S=PD[15&p];if(!S)throw new Error("Unrecognized array type.");const[M]=new Uint16Array(l,2,1),[R]=new Uint32Array(l,4,1);return new M2(R,M,S,l)}constructor(l,h=64,p=Float64Array,y){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=p,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const S=PD.indexOf(this.ArrayType),M=2*l*this.ArrayType.BYTES_PER_ELEMENT,R=l*this.IndexArrayType.BYTES_PER_ELEMENT,z=(8-R%8)%8;if(S<0)throw new Error(`Unexpected typed array class: ${p}.`);y&&y instanceof ArrayBuffer?(this.data=y,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+R+z,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+M+R+z),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+R+z,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+S]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=l)}add(l,h){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=l,this.coords[this._pos++]=h,p}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return C2(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,h,p,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:S,coords:M,nodeSize:R}=this,z=[0,S.length-1,0],B=[];for(;z.length;){const G=z.pop()||0,X=z.pop()||0,ie=z.pop()||0;if(X-ie<=R){for(let Ce=ie;Ce<=X;Ce++){const ke=M[2*Ce],et=M[2*Ce+1];ke>=l&&ke<=p&&et>=h&&et<=y&&B.push(S[Ce])}continue}const ae=ie+X>>1,ce=M[2*ae],de=M[2*ae+1];ce>=l&&ce<=p&&de>=h&&de<=y&&B.push(S[ae]),(G===0?l<=ce:h<=de)&&(z.push(ie),z.push(ae-1),z.push(1-G)),(G===0?p>=ce:y>=de)&&(z.push(ae+1),z.push(X),z.push(1-G))}return B}within(l,h,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:S,nodeSize:M}=this,R=[0,y.length-1,0],z=[],B=p*p;for(;R.length;){const G=R.pop()||0,X=R.pop()||0,ie=R.pop()||0;if(X-ie<=M){for(let Ce=ie;Ce<=X;Ce++)ID(S[2*Ce],S[2*Ce+1],l,h)<=B&&z.push(y[Ce]);continue}const ae=ie+X>>1,ce=S[2*ae],de=S[2*ae+1];ID(ce,de,l,h)<=B&&z.push(y[ae]),(G===0?l-p<=ce:h-p<=de)&&(R.push(ie),R.push(ae-1),R.push(1-G)),(G===0?l+p>=ce:h+p>=de)&&(R.push(ae+1),R.push(X),R.push(1-G))}return z}}function C2(d,l,h,p,y,S){if(y-p<=h)return;const M=p+y>>1;AD(d,l,M,p,y,S),C2(d,l,h,p,M-1,1-S),C2(d,l,h,M+1,y,1-S)}function AD(d,l,h,p,y,S){for(;y>p;){if(y-p>600){const B=y-p+1,G=h-p+1,X=Math.log(B),ie=.5*Math.exp(2*X/3),ae=.5*Math.sqrt(X*ie*(B-ie)/B)*(G-B/2<0?-1:1);AD(d,l,h,Math.max(p,Math.floor(h-G*ie/B+ae)),Math.min(y,Math.floor(h+(B-G)*ie/B+ae)),S)}const M=l[2*h+S];let R=p,z=y;for(Kv(d,l,p,h),l[2*y+S]>M&&Kv(d,l,p,y);R<z;){for(Kv(d,l,R,z),R++,z--;l[2*R+S]<M;)R++;for(;l[2*z+S]>M;)z--}l[2*p+S]===M?Kv(d,l,p,z):(z++,Kv(d,l,z,y)),z<=h&&(p=z+1),h<=z&&(y=z-1)}}function Kv(d,l,h,p){E2(d,h,p),E2(l,2*h,2*p),E2(l,2*h+1,2*p+1)}function E2(d,l,h){const p=d[l];d[l]=d[h],d[h]=p}function ID(d,l,h,p){const y=d-h,S=l-p;return y*y+S*S}var T2;c.cw=void 0,(T2=c.cw||(c.cw={})).create="create",T2.load="load",T2.fullLoad="fullLoad";let g1=null,Jv=[];const P2=1e3/60,A2="loadTime",I2="fullLoadTime",Dq={mark(d){performance.mark(d)},frame(d){const l=d;g1!=null&&Jv.push(l-g1),g1=l},clearMetrics(){g1=null,Jv=[],performance.clearMeasures(A2),performance.clearMeasures(I2);for(const d in c.cw)performance.clearMarks(c.cw[d])},getPerformanceMetrics(){performance.measure(A2,c.cw.create,c.cw.load),performance.measure(I2,c.cw.create,c.cw.fullLoad);const d=performance.getEntriesByName(A2)[0].duration,l=performance.getEntriesByName(I2)[0].duration,h=Jv.length,p=1/(Jv.reduce((S,M)=>S+M,0)/h/1e3),y=Jv.filter(S=>S>P2).reduce((S,M)=>S+(M-P2)/P2,0);return{loadTime:d,fullLoadTime:l,fps:p,percentDroppedFrames:y/(h+y)*100,totalFrames:h}}};c.$=ct,c.A=V,c.B=function([d,l,h]){return l+=90,l*=Math.PI/180,h*=Math.PI/180,{x:d*Math.cos(l)*Math.sin(h),y:d*Math.sin(l)*Math.sin(h),z:d*Math.cos(h)}},c.C=cs,c.D=En,c.E=Je,c.F=Xr,c.G=gp,c.H=function(d){if(an==null){const l=d.navigator?d.navigator.userAgent:null;an=!!d.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return an},c.I=h2,c.J=class{constructor(d,l){this.target=d,this.mapId=l,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Mq(()=>this.process()),this.subscription=wt(this.target,"message",h=>this.receive(h),!1),this.globalScope=An(self)?d:window}registerMessageHandler(d,l){this.messageHandlers[d]=l}sendAsync(d,l){return new Promise((h,p)=>{const y=Math.round(1e18*Math.random()).toString(36).substring(0,10),S=l?wt(l.signal,"abort",()=>{S==null||S.unsubscribe(),delete this.resolveRejects[y];const z={id:y,type:"<cancel>",origin:location.origin,targetMapId:d.targetMapId,sourceMapId:this.mapId};this.target.postMessage(z)},Cq):null;this.resolveRejects[y]={resolve:z=>{S==null||S.unsubscribe(),h(z)},reject:z=>{S==null||S.unsubscribe(),p(z)}};const M=[],R=Object.assign(Object.assign({},d),{id:y,sourceMapId:this.mapId,origin:location.origin,data:Pd(d.data,M)});this.target.postMessage(R,{transfer:M})})}receive(d){const l=d.data,h=l.id;if(!(l.origin!=="file://"&&location.origin!=="file://"&&l.origin!=="resource://android"&&location.origin!=="resource://android"&&l.origin!==location.origin||l.targetMapId&&this.mapId!==l.targetMapId)){if(l.type==="<cancel>"){delete this.tasks[h];const p=this.abortControllers[h];return delete this.abortControllers[h],void(p&&p.abort())}if(An(self)||l.mustQueue)return this.tasks[h]=l,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,l)}}process(){if(this.taskQueue.length===0)return;const d=this.taskQueue.shift(),l=this.tasks[d];delete this.tasks[d],this.taskQueue.length>0&&this.invoker.trigger(),l&&this.processTask(d,l)}processTask(d,l){return s(this,void 0,void 0,function*(){if(l.type==="<response>"){const y=this.resolveRejects[d];return delete this.resolveRejects[d],y?void(l.error?y.reject($u(l.error)):y.resolve($u(l.data))):void 0}if(!this.messageHandlers[l.type])return void this.completeTask(d,new Error(`Could not find a registered handler for ${l.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=$u(l.data),p=new AbortController;this.abortControllers[d]=p;try{const y=yield this.messageHandlers[l.type](l.sourceMapId,h,p);this.completeTask(d,null,y)}catch(y){this.completeTask(d,y)}})}completeTask(d,l,h){const p=[];delete this.abortControllers[d];const y={id:d,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:l?Pd(l):null,data:Pd(h,p)};this.target.postMessage(y,{transfer:p})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},c.K=Z,c.L=function(){var d=new V(16);return V!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0),d[0]=1,d[5]=1,d[10]=1,d[15]=1,d},c.M=function(d,l,h){var p,y,S,M,R,z,B,G,X,ie,ae,ce,de=h[0],Ce=h[1],ke=h[2];return l===d?(d[12]=l[0]*de+l[4]*Ce+l[8]*ke+l[12],d[13]=l[1]*de+l[5]*Ce+l[9]*ke+l[13],d[14]=l[2]*de+l[6]*Ce+l[10]*ke+l[14],d[15]=l[3]*de+l[7]*Ce+l[11]*ke+l[15]):(y=l[1],S=l[2],M=l[3],R=l[4],z=l[5],B=l[6],G=l[7],X=l[8],ie=l[9],ae=l[10],ce=l[11],d[0]=p=l[0],d[1]=y,d[2]=S,d[3]=M,d[4]=R,d[5]=z,d[6]=B,d[7]=G,d[8]=X,d[9]=ie,d[10]=ae,d[11]=ce,d[12]=p*de+R*Ce+X*ke+l[12],d[13]=y*de+z*Ce+ie*ke+l[13],d[14]=S*de+B*Ce+ae*ke+l[14],d[15]=M*de+G*Ce+ce*ke+l[15]),d},c.N=function(d,l,h){var p=h[0],y=h[1],S=h[2];return d[0]=l[0]*p,d[1]=l[1]*p,d[2]=l[2]*p,d[3]=l[3]*p,d[4]=l[4]*y,d[5]=l[5]*y,d[6]=l[6]*y,d[7]=l[7]*y,d[8]=l[8]*S,d[9]=l[9]*S,d[10]=l[10]*S,d[11]=l[11]*S,d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15],d},c.O=function(d,l,h){var p=l[0],y=l[1],S=l[2],M=l[3],R=l[4],z=l[5],B=l[6],G=l[7],X=l[8],ie=l[9],ae=l[10],ce=l[11],de=l[12],Ce=l[13],ke=l[14],et=l[15],Ge=h[0],se=h[1],we=h[2],Xe=h[3];return d[0]=Ge*p+se*R+we*X+Xe*de,d[1]=Ge*y+se*z+we*ie+Xe*Ce,d[2]=Ge*S+se*B+we*ae+Xe*ke,d[3]=Ge*M+se*G+we*ce+Xe*et,d[4]=(Ge=h[4])*p+(se=h[5])*R+(we=h[6])*X+(Xe=h[7])*de,d[5]=Ge*y+se*z+we*ie+Xe*Ce,d[6]=Ge*S+se*B+we*ae+Xe*ke,d[7]=Ge*M+se*G+we*ce+Xe*et,d[8]=(Ge=h[8])*p+(se=h[9])*R+(we=h[10])*X+(Xe=h[11])*de,d[9]=Ge*y+se*z+we*ie+Xe*Ce,d[10]=Ge*S+se*B+we*ae+Xe*ke,d[11]=Ge*M+se*G+we*ce+Xe*et,d[12]=(Ge=h[12])*p+(se=h[13])*R+(we=h[14])*X+(Xe=h[15])*de,d[13]=Ge*y+se*z+we*ie+Xe*Ce,d[14]=Ge*S+se*B+we*ae+Xe*ke,d[15]=Ge*M+se*G+we*ce+Xe*et,d},c.P=A,c.Q=function(d,l){const h={};for(let p=0;p<l.length;p++){const y=l[p];y in d&&(h[y]=d[y])}return h},c.R=us,c.S=Wu,c.T=YC,c.U=aD,c.V=sD,c.W=D,c.X=U,c.Y=it,c.Z=ea,c._=s,c.a=ee,c.a$=function(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d[2]=l[2]*h,d[3]=l[3]*h,d},c.a0=Yv,c.a1=$d,c.a2=25,c.a3=b2,c.a4=d=>{const l=window.document.createElement("video");return l.muted=!0,new Promise(h=>{l.onloadstart=()=>{h(l)};for(const p of d){const y=window.document.createElement("source");fe(p)||(l.crossOrigin="Anonymous"),y.src=p,l.appendChild(y)}})},c.a5=gt,c.a6=function(){return gn++},c.a7=Pe,c.a8=Ap,c.a9=Fl,c.aA=Gi,c.aB=Xt,c.aC=function(d,l,h,p,y=!1){if(!h[0]&&!h[1])return[0,0];const S=y?p==="map"?-d.bearingInRadians:0:p==="viewport"?d.bearingInRadians:0;if(S){const M=Math.sin(S),R=Math.cos(S);h=[h[0]*R-h[1]*M,h[0]*M+h[1]*R]}return[y?h[0]:Xt(l,h[0],d.zoom),y?h[1]:Xt(l,h[1],d.zoom)]},c.aE=p2,c.aF=S2,c.aG=f2,c.aH=M2,c.aI=si,c.aJ=o1,c.aK=ht,c.aL=ur,c.aM=Dr,c.aN=Ct,c.aO=Lt,c.aP=cD,c.aQ=ge,c.aR=ye,c.aS=function(d){var l=new V(3);return l[0]=d[0],l[1]=d[1],l[2]=d[2],l},c.aT=function(d,l,h){return d[0]=l[0]-h[0],d[1]=l[1]-h[1],d[2]=l[2]-h[2],d},c.aU=function(d,l){var h=l[0],p=l[1],y=l[2],S=h*h+p*p+y*y;return S>0&&(S=1/Math.sqrt(S)),d[0]=l[0]*S,d[1]=l[1]*S,d[2]=l[2]*S,d},c.aV=Ve,c.aW=function(d,l){return d[0]*l[0]+d[1]*l[1]+d[2]*l[2]},c.aX=function(d,l,h){return d[0]=l[0]*h[0],d[1]=l[1]*h[1],d[2]=l[2]*h[2],d[3]=l[3]*h[3],d},c.aY=N,c.aZ=function(d,l,h){const p=l[0]*h[0]+l[1]*h[1]+l[2]*h[2];return p===0?null:(-(d[0]*h[0]+d[1]*h[1]+d[2]*h[2])-h[3])/p},c.a_=ve,c.aa=Nd,c.ab=fD,c.ac=function(d){const l={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,p,y,S)=>{const M=y||S;return l[p]=!M||M.toLowerCase(),""}),l["max-age"]){const h=parseInt(l["max-age"],10);isNaN(h)?delete l["max-age"]:l["max-age"]=h}return l},c.ad=Zt,c.ae=function(d){return Math.pow(2,d)},c.af=Q,c.ag=Tt,c.ah=85.051129,c.ai=lD,c.aj=function(d){return Math.log(d)/Math.LN2},c.ak=function(d){var l=d[0],h=d[1];return l*l+h*h},c.al=function(d,l){const h=[];for(const p in d)p in l||h.push(p);return h},c.am=function(d,l){let h=0,p=0;if(d.kind==="constant")p=d.layoutSize;else if(d.kind!=="source"){const{interpolationType:y,minZoom:S,maxZoom:M}=d,R=y?Tt(Ro.interpolationFactor(y,l,S,M),0,1):0;d.kind==="camera"?p=cs.number(d.minSize,d.maxSize,R):h=R}return{uSizeT:h,uSize:p}},c.ao=function(d,{uSize:l,uSizeT:h},{lowerSize:p,upperSize:y}){return d.kind==="source"?p/kc:d.kind==="composite"?cs.number(p/kc,y/kc,h):l},c.ap=function(d,l){var h=l[0],p=l[1],y=l[2],S=l[3],M=l[4],R=l[5],z=l[6],B=l[7],G=l[8],X=l[9],ie=l[10],ae=l[11],ce=l[12],de=l[13],Ce=l[14],ke=l[15],et=h*R-p*M,Ge=h*z-y*M,se=h*B-S*M,we=p*z-y*R,Xe=p*B-S*R,mt=y*B-S*z,$t=G*de-X*ce,bt=G*Ce-ie*ce,Mt=G*ke-ae*ce,Jt=X*Ce-ie*de,jt=X*ke-ae*de,en=ie*ke-ae*Ce,Pt=et*en-Ge*jt+se*Jt+we*Mt-Xe*bt+mt*$t;return Pt?(d[0]=(R*en-z*jt+B*Jt)*(Pt=1/Pt),d[1]=(y*jt-p*en-S*Jt)*Pt,d[2]=(de*mt-Ce*Xe+ke*we)*Pt,d[3]=(ie*Xe-X*mt-ae*we)*Pt,d[4]=(z*Mt-M*en-B*bt)*Pt,d[5]=(h*en-y*Mt+S*bt)*Pt,d[6]=(Ce*se-ce*mt-ke*Ge)*Pt,d[7]=(G*mt-ie*se+ae*Ge)*Pt,d[8]=(M*jt-R*Mt+B*$t)*Pt,d[9]=(p*Mt-h*jt-S*$t)*Pt,d[10]=(ce*Xe-de*se+ke*et)*Pt,d[11]=(X*se-G*Xe-ae*et)*Pt,d[12]=(R*bt-M*Jt-z*$t)*Pt,d[13]=(h*Jt-p*bt+y*$t)*Pt,d[14]=(de*Ge-ce*we-Ce*et)*Pt,d[15]=(G*we-X*Ge+ie*et)*Pt,d):null},c.aq=Qe,c.ar=function(d){return Math.hypot(d[0],d[1])},c.as=function(d){return d[0]=0,d[1]=0,d},c.at=function(d,l,h){return d[0]=l[0]*h,d[1]=l[1]*h,d},c.au=m2,c.av=Se,c.aw=function(d,l,h,p){const y=l.y-d.y,S=l.x-d.x,M=p.y-h.y,R=p.x-h.x,z=M*S-R*y;if(z===0)return null;const B=(R*(d.y-h.y)-M*(d.x-h.x))/z;return new A(d.x+B*S,d.y+B*y)},c.ax=gD,c.ay=ek,c.az=function(d){let l=1/0,h=1/0,p=-1/0,y=-1/0;for(const S of d)l=Math.min(l,S.x),h=Math.min(h,S.y),p=Math.max(p,S.x),y=Math.max(y,S.y);return[l,h,p,y]},c.b=Le,c.b$=tq,c.b0=function(d,l){return d[0]*l[0]+d[1]*l[1]+d[2]*l[2]+d[3]},c.b1=hD,c.b2=Ip,c.b3=function(d,l,h,p,y){var S,M=1/Math.tan(l/2);return d[0]=M/h,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=M,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,y!=null&&y!==1/0?(d[10]=(y+p)*(S=1/(p-y)),d[14]=2*y*p*S):(d[10]=-1,d[14]=-2*p),d},c.b4=function(d){var l=new V(16);return l[0]=d[0],l[1]=d[1],l[2]=d[2],l[3]=d[3],l[4]=d[4],l[5]=d[5],l[6]=d[6],l[7]=d[7],l[8]=d[8],l[9]=d[9],l[10]=d[10],l[11]=d[11],l[12]=d[12],l[13]=d[13],l[14]=d[14],l[15]=d[15],l},c.b5=function(d,l,h){var p=Math.sin(h),y=Math.cos(h),S=l[0],M=l[1],R=l[2],z=l[3],B=l[4],G=l[5],X=l[6],ie=l[7];return l!==d&&(d[8]=l[8],d[9]=l[9],d[10]=l[10],d[11]=l[11],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[0]=S*y+B*p,d[1]=M*y+G*p,d[2]=R*y+X*p,d[3]=z*y+ie*p,d[4]=B*y-S*p,d[5]=G*y-M*p,d[6]=X*y-R*p,d[7]=ie*y-z*p,d},c.b6=function(d,l,h){var p=Math.sin(h),y=Math.cos(h),S=l[4],M=l[5],R=l[6],z=l[7],B=l[8],G=l[9],X=l[10],ie=l[11];return l!==d&&(d[0]=l[0],d[1]=l[1],d[2]=l[2],d[3]=l[3],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[4]=S*y+B*p,d[5]=M*y+G*p,d[6]=R*y+X*p,d[7]=z*y+ie*p,d[8]=B*y-S*p,d[9]=G*y-M*p,d[10]=X*y-R*p,d[11]=ie*y-z*p,d},c.b7=function(){const d=new Float32Array(16);return Q(d),d},c.b8=function(){const d=new Float64Array(16);return Q(d),d},c.b9=function(){return new Float64Array(16)},c.bA=function(d){return d[0]=0,d[1]=0,d[2]=0,d},c.bB=function(d,l,h,p){const y=Math.sqrt(d*d+l*l),S=Math.sqrt(h*h+p*p);d/=y,l/=y,h/=S,p/=S;const M=Math.acos(d*h+l*p);return-l*h+d*p>0?M:-M},c.bC=function(d,l){const h=je(d,2*Math.PI),p=je(l,2*Math.PI);return Math.min(Math.abs(h-p),Math.abs(h-p+2*Math.PI),Math.abs(h-p-2*Math.PI))},c.bD=function(){const d={},l=Oe.$version;for(const h in Oe.$root){const p=Oe.$root[h];if(p.required){let y=null;y=h==="version"?l:p.type==="array"?[]:{},y!=null&&(d[h]=y)}}return d},c.bE=Sv,c.bF=Te,c.bG=function d(l,h){if(Array.isArray(l)){if(!Array.isArray(h)||l.length!==h.length)return!1;for(let p=0;p<l.length;p++)if(!d(l[p],h[p]))return!1;return!0}if(typeof l=="object"&&l!==null&&h!==null){if(typeof h!="object"||Object.keys(l).length!==Object.keys(h).length)return!1;for(const p in l)if(!d(l[p],h[p]))return!1;return!0}return l===h},c.bH=function(d){d=d.slice();const l=Object.create(null);for(let h=0;h<d.length;h++)l[d[h].id]=d[h];for(let h=0;h<d.length;h++)"ref"in d[h]&&(d[h]=Ft(d[h],l[d[h].ref]));return d},c.bI=function(d){if(d.type==="custom")return new Sq(d);switch(d.type){case"background":return new xq(d);case"circle":return new pW(d);case"color-relief":return new xW(d);case"fill":return new zW(d);case"fill-extrusion":return new jW(d);case"heatmap":return new gW(d);case"hillshade":return new yW(d);case"line":return new KW(d);case"raster":return new wq(d);case"symbol":return new h1(d)}},c.bJ=vn,c.bK=function(d,l){if(!d)return[{command:"setStyle",args:[l]}];let h=[];try{if(!be(d.version,l.version))return[{command:"setStyle",args:[l]}];be(d.center,l.center)||h.push({command:"setCenter",args:[l.center]}),be(d.state,l.state)||h.push({command:"setGlobalState",args:[l.state]}),be(d.centerAltitude,l.centerAltitude)||h.push({command:"setCenterAltitude",args:[l.centerAltitude]}),be(d.zoom,l.zoom)||h.push({command:"setZoom",args:[l.zoom]}),be(d.bearing,l.bearing)||h.push({command:"setBearing",args:[l.bearing]}),be(d.pitch,l.pitch)||h.push({command:"setPitch",args:[l.pitch]}),be(d.roll,l.roll)||h.push({command:"setRoll",args:[l.roll]}),be(d.sprite,l.sprite)||h.push({command:"setSprite",args:[l.sprite]}),be(d.glyphs,l.glyphs)||h.push({command:"setGlyphs",args:[l.glyphs]}),be(d.transition,l.transition)||h.push({command:"setTransition",args:[l.transition]}),be(d.light,l.light)||h.push({command:"setLight",args:[l.light]}),be(d.terrain,l.terrain)||h.push({command:"setTerrain",args:[l.terrain]}),be(d.sky,l.sky)||h.push({command:"setSky",args:[l.sky]}),be(d.projection,l.projection)||h.push({command:"setProjection",args:[l.projection]});const p={},y=[];(function(M,R,z,B){let G;for(G in R=R||{},M=M||{})Object.prototype.hasOwnProperty.call(M,G)&&(Object.prototype.hasOwnProperty.call(R,G)||At(G,z,B));for(G in R)Object.prototype.hasOwnProperty.call(R,G)&&(Object.prototype.hasOwnProperty.call(M,G)?be(M[G],R[G])||(M[G].type==="geojson"&&R[G].type==="geojson"&&Yt(M,R,G)?qe(z,{command:"setGeoJSONSourceData",args:[G,R[G].data]}):Ht(G,R,z,B)):tt(G,R,z))})(d.sources,l.sources,y,p);const S=[];d.layers&&d.layers.forEach(M=>{"source"in M&&p[M.source]?h.push({command:"removeLayer",args:[M.id]}):S.push(M)}),h=h.concat(y),function(M,R,z){R=R||[];const B=(M=M||[]).map(Gt),G=R.map(Gt),X=M.reduce(yn,{}),ie=R.reduce(yn,{}),ae=B.slice(),ce=Object.create(null);let de,Ce,ke,et,Ge;for(let se=0,we=0;se<B.length;se++)de=B[se],Object.prototype.hasOwnProperty.call(ie,de)?we++:(qe(z,{command:"removeLayer",args:[de]}),ae.splice(ae.indexOf(de,we),1));for(let se=0,we=0;se<G.length;se++)de=G[G.length-1-se],ae[ae.length-1-se]!==de&&(Object.prototype.hasOwnProperty.call(X,de)?(qe(z,{command:"removeLayer",args:[de]}),ae.splice(ae.lastIndexOf(de,ae.length-we),1)):we++,et=ae[ae.length-se],qe(z,{command:"addLayer",args:[ie[de],et]}),ae.splice(ae.length-se,0,de),ce[de]=!0);for(let se=0;se<G.length;se++)if(de=G[se],Ce=X[de],ke=ie[de],!ce[de]&&!be(Ce,ke))if(be(Ce.source,ke.source)&&be(Ce["source-layer"],ke["source-layer"])&&be(Ce.type,ke.type)){for(Ge in qt(Ce.layout,ke.layout,z,de,null,"setLayoutProperty"),qt(Ce.paint,ke.paint,z,de,null,"setPaintProperty"),be(Ce.filter,ke.filter)||qe(z,{command:"setFilter",args:[de,ke.filter]}),be(Ce.minzoom,ke.minzoom)&&be(Ce.maxzoom,ke.maxzoom)||qe(z,{command:"setLayerZoomRange",args:[de,ke.minzoom,ke.maxzoom]}),Ce)Object.prototype.hasOwnProperty.call(Ce,Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?qt(Ce[Ge],ke[Ge],z,de,Ge.slice(6),"setPaintProperty"):be(Ce[Ge],ke[Ge])||qe(z,{command:"setLayerProperty",args:[de,Ge,ke[Ge]]}));for(Ge in ke)Object.prototype.hasOwnProperty.call(ke,Ge)&&!Object.prototype.hasOwnProperty.call(Ce,Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?qt(Ce[Ge],ke[Ge],z,de,Ge.slice(6),"setPaintProperty"):be(Ce[Ge],ke[Ge])||qe(z,{command:"setLayerProperty",args:[de,Ge,ke[Ge]]}))}else qe(z,{command:"removeLayer",args:[de]}),et=ae[ae.lastIndexOf(de)+1],qe(z,{command:"addLayer",args:[ke,et]})}(S,l.layers,h)}catch(p){console.warn("Unable to compute style diff:",p),h=[{command:"setStyle",args:[l]}]}return h},c.bL=function(d){const l=[],h=d.id;return h===void 0&&l.push({message:`layers.${h}: missing required property "id"`}),d.render===void 0&&l.push({message:`layers.${h}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&l.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),l},c.bM=hn,c.bN=We,c.bO=class extends Hr{constructor(d,l){super(d,l),this.current=0}set(d){this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}},c.bP=e1,c.bQ=class extends Hr{constructor(d,l){super(d,l),this.current=jC}set(d){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let l=1;l<16;l++)if(d[l]!==this.current[l]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}},c.bR=Ri,c.bS=class extends Hr{constructor(d,l){super(d,l),this.current=[0,0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2]))}},c.bT=class extends Hr{constructor(d,l){super(d,l),this.current=[0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1]))}},c.bU=q,c.bV=function(d,l){var h=Math.sin(l),p=Math.cos(l);return d[0]=p,d[1]=h,d[2]=0,d[3]=-h,d[4]=p,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},c.bW=function(d,l,h){var p=l[0],y=l[1],S=l[2];return d[0]=p*h[0]+y*h[3]+S*h[6],d[1]=p*h[1]+y*h[4]+S*h[7],d[2]=p*h[2]+y*h[5]+S*h[8],d},c.bX=function(d,l,h,p,y,S,M){var R=1/(l-h),z=1/(p-y),B=1/(S-M);return d[0]=-2*R,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*z,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*B,d[11]=0,d[12]=(l+h)*R,d[13]=(y+p)*z,d[14]=(M+S)*B,d[15]=1,d},c.bY=class extends Hr{constructor(d,l){super(d,l),this.current=new Array}set(d){if(d!=this.current){this.current=d;const l=new Float32Array(4*d.length);for(let h=0;h<d.length;h++)l[4*h]=d[h].r,l[4*h+1]=d[h].g,l[4*h+2]=d[h].b,l[4*h+3]=d[h].a;this.gl.uniform4fv(this.location,l)}}},c.bZ=class extends Hr{constructor(d,l){super(d,l),this.current=new Array}set(d){if(d!=this.current){this.current=d;const l=new Float32Array(d);this.gl.uniform1fv(this.location,l)}}},c.b_=class extends m{},c.ba=function(d,l,h){const p=new Float64Array(4);return Be(p,d,l-90,h),p},c.bb=function(d,l,h,p){var y,S,M,R,z,B=l[0],G=l[1],X=l[2],ie=l[3],ae=h[0],ce=h[1],de=h[2],Ce=h[3];return(S=B*ae+G*ce+X*de+ie*Ce)<0&&(S=-S,ae=-ae,ce=-ce,de=-de,Ce=-Ce),1-S>H?(y=Math.acos(S),M=Math.sin(y),R=Math.sin((1-p)*y)/M,z=Math.sin(p*y)/M):(R=1-p,z=p),d[0]=R*B+z*ae,d[1]=R*G+z*ce,d[2]=R*X+z*de,d[3]=R*ie+z*Ce,d},c.bc=function(d){const l=new Float64Array(9);var h,p,y,S,M,R,z,B,G,X,ie,ae,ce,de,Ce,ke,et,Ge;X=(y=(p=d)[0])*(z=y+y),ie=(S=p[1])*z,ce=(M=p[2])*z,de=M*(B=S+S),ke=(R=p[3])*z,et=R*B,Ge=R*(G=M+M),(h=l)[0]=1-(ae=S*B)-(Ce=M*G),h[3]=ie-Ge,h[6]=ce+et,h[1]=ie+Ge,h[4]=1-X-Ce,h[7]=de-ke,h[2]=ce-et,h[5]=de+ke,h[8]=1-X-ae;const se=Lt(-Math.asin(Tt(l[2],-1,1)));let we,Xe;return Math.hypot(l[5],l[8])<.001?(we=0,Xe=-Lt(Math.atan2(l[3],l[4]))):(we=Lt(l[5]===0&&l[8]===0?0:Math.atan2(l[5],l[8])),Xe=Lt(l[1]===0&&l[0]===0?0:Math.atan2(l[1],l[0]))),{roll:we,pitch:se+90,bearing:Xe}},c.bd=function(d,l){return d.roll==l.roll&&d.pitch==l.pitch&&d.bearing==l.bearing},c.be=Qn,c.bf=Do,c.bg=Tp,c.bh=jv,c.bi=Ep,c.bj=lt,c.bk=Ot,c.bl=Wn,c.bm=function(d,l,h,p,y){return lt(p,y,Tt((d-l)/(h-l),0,1))},c.bn=je,c.bo=function(){return new Float64Array(3)},c.bp=function(d,l,h,p){return d[0]=l[0]+h[0]*p,d[1]=l[1]+h[1]*p,d[2]=l[2]+h[2]*p,d},c.bq=Be,c.br=function(d,l,h){var p=h[0],y=h[1],S=h[2],M=l[0],R=l[1],z=l[2],B=y*z-S*R,G=S*M-p*z,X=p*R-y*M,ie=y*X-S*G,ae=S*B-p*X,ce=p*G-y*B,de=2*h[3];return G*=de,X*=de,ae*=2,ce*=2,d[0]=M+(B*=de)+(ie*=2),d[1]=R+G+ae,d[2]=z+X+ce,d},c.bs=function(d,l,h){const p=(y=[d[0],d[1],d[2],l[0],l[1],l[2],h[0],h[1],h[2]])[0]*((G=y[8])*(M=y[4])-(R=y[5])*(B=y[7]))+y[1]*(-G*(S=y[3])+R*(z=y[6]))+y[2]*(B*S-M*z);var y,S,M,R,z,B,G;if(p===0)return null;const X=Ve([],[l[0],l[1],l[2]],[h[0],h[1],h[2]]),ie=Ve([],[h[0],h[1],h[2]],[d[0],d[1],d[2]]),ae=Ve([],[d[0],d[1],d[2]],[l[0],l[1],l[2]]),ce=ge([],X,-d[3]);return ye(ce,ce,ge([],ie,-l[3])),ye(ce,ce,ge([],ae,-h[3])),ge(ce,ce,1/p),ce},c.bt=_2,c.bu=function(){return new Float64Array(4)},c.bv=function(d,l,h,p){var y=[],S=[];return y[0]=l[0]-h[0],y[1]=l[1]-h[1],y[2]=l[2]-h[2],S[0]=y[0]*Math.cos(p)-y[1]*Math.sin(p),S[1]=y[0]*Math.sin(p)+y[1]*Math.cos(p),S[2]=y[2],d[0]=S[0]+h[0],d[1]=S[1]+h[1],d[2]=S[2]+h[2],d},c.bw=function(d,l,h,p){var y=[],S=[];return y[0]=l[0]-h[0],y[1]=l[1]-h[1],y[2]=l[2]-h[2],S[0]=y[0],S[1]=y[1]*Math.cos(p)-y[2]*Math.sin(p),S[2]=y[1]*Math.sin(p)+y[2]*Math.cos(p),d[0]=S[0]+h[0],d[1]=S[1]+h[1],d[2]=S[2]+h[2],d},c.bx=function(d,l,h,p){var y=[],S=[];return y[0]=l[0]-h[0],y[1]=l[1]-h[1],y[2]=l[2]-h[2],S[0]=y[2]*Math.sin(p)+y[0]*Math.cos(p),S[1]=y[1],S[2]=y[2]*Math.cos(p)-y[0]*Math.sin(p),d[0]=S[0]+h[0],d[1]=S[1]+h[1],d[2]=S[2]+h[2],d},c.by=function(d,l,h){var p=Math.sin(h),y=Math.cos(h),S=l[0],M=l[1],R=l[2],z=l[3],B=l[8],G=l[9],X=l[10],ie=l[11];return l!==d&&(d[4]=l[4],d[5]=l[5],d[6]=l[6],d[7]=l[7],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15]),d[0]=S*y-B*p,d[1]=M*y-G*p,d[2]=R*y-X*p,d[3]=z*y-ie*p,d[8]=S*p+B*y,d[9]=M*p+G*y,d[10]=R*p+X*y,d[11]=z*p+ie*y,d},c.bz=function(d,l){const h=je(d,360),p=je(l,360),y=p-h,S=p>h?y-360:y+360;return Math.abs(y)<Math.abs(S)?y:S},c.c=_e,c.c0=class extends w{},c.c1=ZC,c.c2=function(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))},c.c3=uk,c.c4=function(d,l,h){var p=l[0],y=l[1],S=l[2],M=h[3]*p+h[7]*y+h[11]*S+h[15];return d[0]=(h[0]*p+h[4]*y+h[8]*S+h[12])/(M=M||1),d[1]=(h[1]*p+h[5]*y+h[9]*S+h[13])/M,d[2]=(h[2]*p+h[6]*y+h[10]*S+h[14])/M,d},c.c5=class extends Iv{},c.c6=class extends Y{},c.c7=function(d,l){return d[0]===l[0]&&d[1]===l[1]&&d[2]===l[2]&&d[3]===l[3]&&d[4]===l[4]&&d[5]===l[5]&&d[6]===l[6]&&d[7]===l[7]&&d[8]===l[8]&&d[9]===l[9]&&d[10]===l[10]&&d[11]===l[11]&&d[12]===l[12]&&d[13]===l[13]&&d[14]===l[14]&&d[15]===l[15]},c.c8=function(d,l){var h=d[0],p=d[1],y=d[2],S=d[3],M=d[4],R=d[5],z=d[6],B=d[7],G=d[8],X=d[9],ie=d[10],ae=d[11],ce=d[12],de=d[13],Ce=d[14],ke=d[15],et=l[0],Ge=l[1],se=l[2],we=l[3],Xe=l[4],mt=l[5],$t=l[6],bt=l[7],Mt=l[8],Jt=l[9],jt=l[10],en=l[11],Pt=l[12],Cn=l[13],$n=l[14],Bn=l[15];return Math.abs(h-et)<=H*Math.max(1,Math.abs(h),Math.abs(et))&&Math.abs(p-Ge)<=H*Math.max(1,Math.abs(p),Math.abs(Ge))&&Math.abs(y-se)<=H*Math.max(1,Math.abs(y),Math.abs(se))&&Math.abs(S-we)<=H*Math.max(1,Math.abs(S),Math.abs(we))&&Math.abs(M-Xe)<=H*Math.max(1,Math.abs(M),Math.abs(Xe))&&Math.abs(R-mt)<=H*Math.max(1,Math.abs(R),Math.abs(mt))&&Math.abs(z-$t)<=H*Math.max(1,Math.abs(z),Math.abs($t))&&Math.abs(B-bt)<=H*Math.max(1,Math.abs(B),Math.abs(bt))&&Math.abs(G-Mt)<=H*Math.max(1,Math.abs(G),Math.abs(Mt))&&Math.abs(X-Jt)<=H*Math.max(1,Math.abs(X),Math.abs(Jt))&&Math.abs(ie-jt)<=H*Math.max(1,Math.abs(ie),Math.abs(jt))&&Math.abs(ae-en)<=H*Math.max(1,Math.abs(ae),Math.abs(en))&&Math.abs(ce-Pt)<=H*Math.max(1,Math.abs(ce),Math.abs(Pt))&&Math.abs(de-Cn)<=H*Math.max(1,Math.abs(de),Math.abs(Cn))&&Math.abs(Ce-$n)<=H*Math.max(1,Math.abs(Ce),Math.abs($n))&&Math.abs(ke-Bn)<=H*Math.max(1,Math.abs(ke),Math.abs(Bn))},c.c9=function(d,l){return d[0]=l[0],d[1]=l[1],d[2]=l[2],d[3]=l[3],d[4]=l[4],d[5]=l[5],d[6]=l[6],d[7]=l[7],d[8]=l[8],d[9]=l[9],d[10]=l[10],d[11]=l[11],d[12]=l[12],d[13]=l[13],d[14]=l[14],d[15]=l[15],d},c.cA=function(d){delete ee.REGISTERED_PROTOCOLS[d]},c.cB=function(d,l){const h={};for(let y=0;y<d.length;y++){const S=l&&l[d[y].id]||hp(d[y]);l&&(l[d[y].id]=S);let M=h[S];M||(M=h[S]=[]),M.push(d[y])}const p=[];for(const y in h)p.push(h[y]);return p},c.cC=xn,c.cD=dD,c.cE=pD,c.cF=Hk,c.cG=function(d){d.bucket.createArrays(),d.bucket.tilePixelRatio=ct/(512*d.bucket.overscaling),d.bucket.compareText={},d.bucket.iconsNeedLinear=!1;const l=d.bucket.layers[0],h=l.layout,p=l._unevaluatedLayout._values,y={layoutIconSize:p["icon-size"].possiblyEvaluate(new Xr(d.bucket.zoom+1),d.canonical),layoutTextSize:p["text-size"].possiblyEvaluate(new Xr(d.bucket.zoom+1),d.canonical),textMaxSize:p["text-size"].possiblyEvaluate(new Xr(18))};if(d.bucket.textSizeData.kind==="composite"){const{minZoom:B,maxZoom:G}=d.bucket.textSizeData;y.compositeTextSizes=[p["text-size"].possiblyEvaluate(new Xr(B),d.canonical),p["text-size"].possiblyEvaluate(new Xr(G),d.canonical)]}if(d.bucket.iconSizeData.kind==="composite"){const{minZoom:B,maxZoom:G}=d.bucket.iconSizeData;y.compositeIconSizes=[p["icon-size"].possiblyEvaluate(new Xr(B),d.canonical),p["icon-size"].possiblyEvaluate(new Xr(G),d.canonical)]}const S=h.get("text-line-height")*Gi,M=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",R=h.get("text-keep-upright"),z=h.get("text-size");for(const B of d.bucket.features){const G=h.get("text-font").evaluate(B,{},d.canonical).join(","),X=z.evaluate(B,{},d.canonical),ie=y.layoutTextSize.evaluate(B,{},d.canonical),ae=y.layoutIconSize.evaluate(B,{},d.canonical),ce={horizontal:{},vertical:void 0},de=B.text;let Ce,ke=[0,0];if(de){const se=de.toString(),we=h.get("text-letter-spacing").evaluate(B,{},d.canonical)*Gi,Xe=qx(se)?we:0,mt=h.get("text-anchor").evaluate(B,{},d.canonical),$t=CD(l,B,d.canonical);if(!$t){const jt=h.get("text-radial-offset").evaluate(B,{},d.canonical);ke=jt?MD(mt,[jt*Gi,w2]):h.get("text-offset").evaluate(B,{},d.canonical).map(en=>en*Gi)}let bt=M?"center":h.get("text-justify").evaluate(B,{},d.canonical);const Mt=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(B,{},d.canonical)*Gi:1/0,Jt=()=>{d.bucket.allowVerticalPlacement&&Mv(se)&&(ce.vertical=l1(de,d.glyphMap,d.glyphPositions,d.imagePositions,G,Mt,S,mt,"left",Xe,ke,c.an.vertical,!0,ie,X))};if(!M&&$t){const jt=new Set;if(bt==="auto")for(let Pt=0;Pt<$t.values.length;Pt+=2)jt.add(S2($t.values[Pt]));else jt.add(bt);let en=!1;for(const Pt of jt)if(!ce.horizontal[Pt])if(en)ce.horizontal[Pt]=ce.horizontal[0];else{const Cn=l1(de,d.glyphMap,d.glyphPositions,d.imagePositions,G,Mt,S,"center",Pt,Xe,ke,c.an.horizontal,!1,ie,X);Cn&&(ce.horizontal[Pt]=Cn,en=Cn.positionedLines.length===1)}Jt()}else{bt==="auto"&&(bt=S2(mt));const jt=l1(de,d.glyphMap,d.glyphPositions,d.imagePositions,G,Mt,S,mt,bt,Xe,ke,c.an.horizontal,!1,ie,X);jt&&(ce.horizontal[bt]=jt),Jt(),Mv(se)&&M&&R&&(ce.vertical=l1(de,d.glyphMap,d.glyphPositions,d.imagePositions,G,Mt,S,mt,bt,Xe,ke,c.an.vertical,!1,ie,X))}}let et=!1;if(B.icon&&B.icon.name){const se=d.imageMap[B.icon.name];se&&(Ce=mq(d.imagePositions[B.icon.name],h.get("icon-offset").evaluate(B,{},d.canonical),h.get("icon-anchor").evaluate(B,{},d.canonical)),et=!!se.sdf,d.bucket.sdfIcons===void 0?d.bucket.sdfIcons=et:d.bucket.sdfIcons!==et&&tn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(se.pixelRatio!==d.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(d.bucket.iconsNeedLinear=!0))}const Ge=TD(ce.horizontal)||ce.vertical;d.bucket.iconsInText=!!Ge&&Ge.iconsInText,(Ge||Ce)&&Lq(d.bucket,B,ce,Ce,d.imageMap,y,ie,ae,ke,et,d.canonical,d.subdivisionGranularity)}d.showCollisionBoxes&&d.bucket.generateCollisionDebugBuffers()},c.cH=a2,c.cI=t2,c.cJ=s2,c.cK=Gv,c.cL=u2,c.cM=class{constructor(d){this._marks={start:[d.url,"start"].join("#"),end:[d.url,"end"].join("#"),measure:d.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let d=performance.getEntriesByName(this._marks.measure);return d.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),d=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),d}},c.cN=function(d,l,h,p,y){return s(this,void 0,void 0,function*(){if(U())try{return yield it(d,l,h,p,y)}catch{}return function(S,M,R,z,B){const G=S.width,X=S.height;St&&It||(St=new OffscreenCanvas(G,X),It=St.getContext("2d",{willReadFrequently:!0})),St.width=G,St.height=X,It.drawImage(S,0,0,G,X);const ie=It.getImageData(M,R,z,B);return It.clearRect(0,0,G,X),ie.data}(d,l,h,p,y)})},c.cO=fk,c.cP=f,c.cQ=x,c.cR=Ik,c.cS=Vk,c.cT=ap,c.cU=Bl,c.ca=d=>d.type==="symbol",c.cb=d=>d.type==="circle",c.cc=d=>d.type==="heatmap",c.cd=d=>d.type==="line",c.ce=d=>d.type==="fill",c.cf=d=>d.type==="fill-extrusion",c.cg=d=>d.type==="hillshade",c.ch=d=>d.type==="color-relief",c.ci=d=>d.type==="raster",c.cj=d=>d.type==="background",c.ck=d=>d.type==="custom",c.cl=ut,c.cm=function(d,l,h){const p=st(l.x-h.x,l.y-h.y),y=st(d.x-h.x,d.y-h.y);var S,M;return Lt(Math.atan2(p[0]*y[1]-p[1]*y[0],(S=p)[0]*(M=y)[0]+S[1]*M[1]))},c.cn=ot,c.co=function(d,l){return bn[l]&&(d instanceof MouseEvent||d instanceof WheelEvent)},c.cp=function(d,l){return kt[l]&&"touches"in d},c.cq=function(d){return kt[d]||bn[d]},c.cr=function(d,l,h){var p=l[0],y=l[1];return d[0]=h[0]*p+h[4]*y+h[12],d[1]=h[1]*p+h[5]*y+h[13],d},c.cs=function(d,l){const{x:h,y:p}=Yv.fromLngLat(l);return!(d<0||d>25||p<0||p>=1||h<0||h>=1)},c.ct=function(d,l){return d[0]=l[0],d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=l[1],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=l[2],d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d},c.cu=class extends $l{},c.cv=Dq,c.cx=function(d){return d.message===zt},c.cy=le,c.cz=function(d,l){ee.REGISTERED_PROTOCOLS[d]=l},c.d=fe,c.e=un,c.f=d=>s(void 0,void 0,void 0,function*(){if(d.byteLength===0)return createImageBitmap(new ImageData(1,1));const l=new Blob([new Uint8Array(d)],{type:"image/png"});try{return createImageBitmap(l)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),c.g=ne,c.h=d=>new Promise((l,h)=>{const p=new Image;p.onload=()=>{l(p),URL.revokeObjectURL(p.src),p.onload=null,window.requestAnimationFrame(()=>{p.src=me})},p.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const y=new Blob([new Uint8Array(d)],{type:"image/png"});p.src=d.byteLength?URL.createObjectURL(y):me}),c.i=An,c.j=(d,l)=>$e(un(d,{type:"json"}),l),c.k=ze,c.l=De,c.m=$e,c.n=(d,l)=>$e(un(d,{type:"arrayBuffer"}),l),c.o=function(d){return new u2(d).readFields(iq,[])},c.p=jk,c.q=Nv,c.r=ko,c.s=wt,c.t=Pv,c.u=tr,c.v=Oe,c.w=tn,c.x=FC,c.y=Ed,c.z=Bu}),i("worker",["./shared"],function(c){class s{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,ne){for(const le of ee){this._layerConfigs[le.id]=le;const Te=this._layers[le.id]=c.bI(le);Te._featureFilter=c.a9(Te.filter),this.keyCache[le.id]&&delete this.keyCache[le.id]}for(const le of ne)delete this.keyCache[le],delete this._layerConfigs[le],delete this._layers[le];this.familiesBySource={};const Z=c.cB(Object.values(this._layerConfigs),this.keyCache);for(const le of Z){const Te=le.map(ze=>this._layers[ze.id]),$e=Te[0];if($e.visibility==="none")continue;const fe=$e.source||"";let xe=this.familiesBySource[fe];xe||(xe=this.familiesBySource[fe]={});const Re=$e.sourceLayer||"_geojsonTileLayer";let De=xe[Re];De||(De=xe[Re]=[]),De.push(Te)}}}class f{constructor(ee){const ne={},Z=[];for(const fe in ee){const xe=ee[fe],Re=ne[fe]={};for(const De in xe){const ze=xe[+De];if(!ze||ze.bitmap.width===0||ze.bitmap.height===0)continue;const Je={x:0,y:0,w:ze.bitmap.width+2,h:ze.bitmap.height+2};Z.push(Je),Re[De]={rect:Je,metrics:ze.metrics}}}const{w:le,h:Te}=c.p(Z),$e=new c.q({width:le||1,height:Te||1});for(const fe in ee){const xe=ee[fe];for(const Re in xe){const De=xe[+Re];if(!De||De.bitmap.width===0||De.bitmap.height===0)continue;const ze=ne[fe][Re].rect;c.q.copy(De.bitmap,$e,{x:0,y:0},{x:ze.x+1,y:ze.y+1},De.bitmap)}}this.image=$e,this.positions=ne}}c.cC("GlyphAtlas",f);class g{constructor(ee){this.tileID=new c.Z(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[],this.globalState=ee.globalState}parse(ee,ne,Z,le,Te){return c._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new c.a7;const $e=new c.cD(Object.keys(ee.layers).sort()),fe=new c.cE(this.tileID,this.promoteId);fe.bucketLayerIDs=[];const xe={},Re={featureIndex:fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Z,subdivisionGranularity:Te},De=ne.familiesBySource[this.source];for(const qt in De){const Gt=ee.layers[qt];if(!Gt)continue;Gt.version===1&&c.w(`Vector tile source "${this.source}" layer "${qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const yn=$e.encode(qt),gt=[];for(let In=0;In<Gt.length;In++){const cn=Gt.feature(In),Nn=fe.getId(cn,qt);gt.push({feature:cn,id:Nn,index:In,sourceLayerIndex:yn})}for(const In of De[qt]){const cn=In[0];cn.source!==this.source&&c.w(`layer.source = ${cn.source} does not equal this.source = ${this.source}`),cn.minzoom&&this.zoom<Math.floor(cn.minzoom)||cn.maxzoom&&this.zoom>=cn.maxzoom||cn.visibility!=="none"&&(_(In,this.zoom,Z),(xe[cn.id]=cn.createBucket({index:fe.bucketLayerIDs.length,layers:In,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yn,sourceID:this.source,globalState:this.globalState})).populate(gt,Re,this.tileID.canonical),fe.bucketLayerIDs.push(In.map(Nn=>Nn.id)))}}const ze=c.bM(Re.glyphDependencies,qt=>Object.keys(qt).map(Number));this.inFlightDependencies.forEach(qt=>qt==null?void 0:qt.abort()),this.inFlightDependencies=[];let Je=Promise.resolve({});if(Object.keys(ze).length){const qt=new AbortController;this.inFlightDependencies.push(qt),Je=le.sendAsync({type:"GG",data:{stacks:ze,source:this.source,tileID:this.tileID,type:"glyphs"}},qt)}const Oe=Object.keys(Re.iconDependencies);let Et=Promise.resolve({});if(Oe.length){const qt=new AbortController;this.inFlightDependencies.push(qt),Et=le.sendAsync({type:"GI",data:{icons:Oe,source:this.source,tileID:this.tileID,type:"icons"}},qt)}const Ft=Object.keys(Re.patternDependencies);let be=Promise.resolve({});if(Ft.length){const qt=new AbortController;this.inFlightDependencies.push(qt),be=le.sendAsync({type:"GI",data:{icons:Ft,source:this.source,tileID:this.tileID,type:"patterns"}},qt)}const[qe,tt,At]=yield Promise.all([Je,Et,be]),Ht=new f(qe),Yt=new c.cF(tt,At);for(const qt in xe){const Gt=xe[qt];Gt instanceof c.a8?(_(Gt.layers,this.zoom,Z),c.cG({bucket:Gt,glyphMap:qe,glyphPositions:Ht.positions,imageMap:tt,imagePositions:Yt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Re.subdivisionGranularity})):Gt.hasPattern&&(Gt instanceof c.cH||Gt instanceof c.cI||Gt instanceof c.cJ)&&(_(Gt.layers,this.zoom,Z),Gt.addFeatures(Re,this.tileID.canonical,Yt.patternPositions))}return this.status="done",{buckets:Object.values(xe).filter(qt=>!qt.isEmpty()),featureIndex:fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ht.image,imageAtlas:Yt,glyphMap:this.returnDependencies?qe:null,iconMap:this.returnDependencies?tt:null,glyphPositions:this.returnDependencies?Ht.positions:null}})}}function _(_e,ee,ne){const Z=new c.F(ee);for(const le of _e)le.recalculate(Z,ne)}class x{constructor(ee,ne,Z){this.actor=ee,this.layerIndex=ne,this.availableImages=Z,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,ne){return c._(this,void 0,void 0,function*(){const Z=yield c.n(ee.request,ne);try{return{vectorTile:new c.cK.VectorTile(new c.cL(Z.data)),rawData:Z.data,cacheControl:Z.cacheControl,expires:Z.expires}}catch(le){const Te=new Uint8Array(Z.data);let $e=`Unable to parse the tile at ${ee.request.url}, `;throw $e+=Te[0]===31&&Te[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${le.message}`,new Error($e)}})}loadTile(ee){return c._(this,void 0,void 0,function*(){const ne=ee.uid,Z=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new c.cM(ee.request),le=new g(ee);this.loading[ne]=le;const Te=new AbortController;le.abort=Te;try{const $e=yield this.loadVectorTile(ee,Te);if(delete this.loading[ne],!$e)return null;const fe=$e.rawData,xe={};$e.expires&&(xe.expires=$e.expires),$e.cacheControl&&(xe.cacheControl=$e.cacheControl);const Re={};if(Z){const ze=Z.finish();ze&&(Re.resourceTiming=JSON.parse(JSON.stringify(ze)))}le.vectorTile=$e.vectorTile;const De=le.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);this.loaded[ne]=le,this.fetching[ne]={rawTileData:fe,cacheControl:xe,resourceTiming:Re};try{const ze=yield De;return c.e({rawTileData:fe.slice(0)},ze,xe,Re)}finally{delete this.fetching[ne]}}catch($e){throw delete this.loading[ne],le.status="done",this.loaded[ne]=le,$e}})}reloadTile(ee){return c._(this,void 0,void 0,function*(){const ne=ee.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const Z=this.loaded[ne];if(Z.showCollisionBoxes=ee.showCollisionBoxes,Z.globalState=ee.globalState,Z.status==="parsing"){const le=yield Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);let Te;if(this.fetching[ne]){const{rawTileData:$e,cacheControl:fe,resourceTiming:xe}=this.fetching[ne];delete this.fetching[ne],Te=c.e({rawTileData:$e.slice(0)},le,fe,xe)}else Te=le;return Te}if(Z.status==="done"&&Z.vectorTile)return Z.parse(Z.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity)})}abortTile(ee){return c._(this,void 0,void 0,function*(){const ne=this.loading,Z=ee.uid;ne&&ne[Z]&&ne[Z].abort&&(ne[Z].abort.abort(),delete ne[Z])})}removeTile(ee){return c._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class C{constructor(){this.loaded={}}loadTile(ee){return c._(this,void 0,void 0,function*(){const{uid:ne,encoding:Z,rawImageData:le,redFactor:Te,greenFactor:$e,blueFactor:fe,baseShift:xe}=ee,Re=le.width+2,De=le.height+2,ze=c.b(le)?new c.R({width:Re,height:De},yield c.cN(le,-1,-1,Re,De)):le,Je=new c.cO(ne,ze,Z,Te,$e,fe,xe);return this.loaded=this.loaded||{},this.loaded[ne]=Je,Je})}removeTile(ee){const ne=this.loaded,Z=ee.uid;ne&&ne[Z]&&delete ne[Z]}}var E,A,L=function(){if(A)return E;function _e(ne,Z){if(ne.length!==0){ee(ne[0],Z);for(var le=1;le<ne.length;le++)ee(ne[le],!Z)}}function ee(ne,Z){for(var le=0,Te=0,$e=0,fe=ne.length,xe=fe-1;$e<fe;xe=$e++){var Re=(ne[$e][0]-ne[xe][0])*(ne[xe][1]+ne[$e][1]),De=le+Re;Te+=Math.abs(le)>=Math.abs(Re)?le-De+Re:Re-De+le,le=De}le+Te>=0!=!!Z&&ne.reverse()}return A=1,E=function ne(Z,le){var Te,$e=Z&&Z.type;if($e==="FeatureCollection")for(Te=0;Te<Z.features.length;Te++)ne(Z.features[Te],le);else if($e==="GeometryCollection")for(Te=0;Te<Z.geometries.length;Te++)ne(Z.geometries[Te],le);else if($e==="Feature")ne(Z.geometry,le);else if($e==="Polygon")_e(Z.coordinates,le);else if($e==="MultiPolygon")for(Te=0;Te<Z.coordinates.length;Te++)_e(Z.coordinates[Te],le);return Z}}(),I=c.cP(L);const T=c.cK.VectorTileFeature.prototype.toGeoJSON;class O{constructor(ee){this._feature=ee,this.extent=c.$,this.type=ee.type,this.properties=ee.tags,"id"in ee&&!isNaN(ee.id)&&(this.id=parseInt(ee.id,10))}loadGeometry(){if(this._feature.type===1){const ee=[];for(const ne of this._feature.geometry)ee.push([new c.P(ne[0],ne[1])]);return ee}{const ee=[];for(const ne of this._feature.geometry){const Z=[];for(const le of ne)Z.push(new c.P(le[0],le[1]));ee.push(Z)}return ee}}toGeoJSON(ee,ne,Z){return T.call(this,ee,ne,Z)}}class D{constructor(ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.$,this.length=ee.length,this._features=ee}feature(ee){return new O(this._features[ee])}}var U,H,V,q={exports:{}},Q=function(){if(V)return q.exports;V=1;var _e=c.cS(),ee=function(){if(H)return U;H=1;var De=c.cQ(),ze=c.cR().VectorTileFeature;function Je(Et,Ft){this.options=Ft||{},this.features=Et,this.length=Et.length}function Oe(Et,Ft){this.id=typeof Et.id=="number"?Et.id:void 0,this.type=Et.type,this.rawGeometry=Et.type===1?[Et.geometry]:Et.geometry,this.properties=Et.tags,this.extent=Ft||4096}return U=Je,Je.prototype.feature=function(Et){return new Oe(this.features[Et],this.options.extent)},Oe.prototype.loadGeometry=function(){var Et=this.rawGeometry;this.geometry=[];for(var Ft=0;Ft<Et.length;Ft++){for(var be=Et[Ft],qe=[],tt=0;tt<be.length;tt++)qe.push(new De(be[tt][0],be[tt][1]));this.geometry.push(qe)}return this.geometry},Oe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Et=this.geometry,Ft=1/0,be=-1/0,qe=1/0,tt=-1/0,At=0;At<Et.length;At++)for(var Ht=Et[At],Yt=0;Yt<Ht.length;Yt++){var qt=Ht[Yt];Ft=Math.min(Ft,qt.x),be=Math.max(be,qt.x),qe=Math.min(qe,qt.y),tt=Math.max(tt,qt.y)}return[Ft,qe,be,tt]},Oe.prototype.toGeoJSON=ze.prototype.toGeoJSON,U}();function ne(De){var ze=new _e;return function(Je,Oe){for(var Et in Je.layers)Oe.writeMessage(3,Z,Je.layers[Et])}(De,ze),ze.finish()}function Z(De,ze){var Je;ze.writeVarintField(15,De.version||1),ze.writeStringField(1,De.name||""),ze.writeVarintField(5,De.extent||4096);var Oe={keys:[],values:[],keycache:{},valuecache:{}};for(Je=0;Je<De.length;Je++)Oe.feature=De.feature(Je),ze.writeMessage(2,le,Oe);var Et=Oe.keys;for(Je=0;Je<Et.length;Je++)ze.writeStringField(3,Et[Je]);var Ft=Oe.values;for(Je=0;Je<Ft.length;Je++)ze.writeMessage(4,Re,Ft[Je])}function le(De,ze){var Je=De.feature;Je.id!==void 0&&ze.writeVarintField(1,Je.id),ze.writeMessage(2,Te,De),ze.writeVarintField(3,Je.type),ze.writeMessage(4,xe,Je)}function Te(De,ze){var Je=De.feature,Oe=De.keys,Et=De.values,Ft=De.keycache,be=De.valuecache;for(var qe in Je.properties){var tt=Je.properties[qe],At=Ft[qe];if(tt!==null){At===void 0&&(Oe.push(qe),Ft[qe]=At=Oe.length-1),ze.writeVarint(At);var Ht=typeof tt;Ht!=="string"&&Ht!=="boolean"&&Ht!=="number"&&(tt=JSON.stringify(tt));var Yt=Ht+":"+tt,qt=be[Yt];qt===void 0&&(Et.push(tt),be[Yt]=qt=Et.length-1),ze.writeVarint(qt)}}}function $e(De,ze){return(ze<<3)+(7&De)}function fe(De){return De<<1^De>>31}function xe(De,ze){for(var Je=De.loadGeometry(),Oe=De.type,Et=0,Ft=0,be=Je.length,qe=0;qe<be;qe++){var tt=Je[qe],At=1;Oe===1&&(At=tt.length),ze.writeVarint($e(1,At));for(var Ht=Oe===3?tt.length-1:tt.length,Yt=0;Yt<Ht;Yt++){Yt===1&&Oe!==1&&ze.writeVarint($e(2,Ht-1));var qt=tt[Yt].x-Et,Gt=tt[Yt].y-Ft;ze.writeVarint(fe(qt)),ze.writeVarint(fe(Gt)),Et+=qt,Ft+=Gt}Oe===3&&ze.writeVarint($e(7,1))}}function Re(De,ze){var Je=typeof De;Je==="string"?ze.writeStringField(1,De):Je==="boolean"?ze.writeBooleanField(7,De):Je==="number"&&(De%1!=0?ze.writeDoubleField(3,De):De<0?ze.writeSVarintField(6,De):ze.writeVarintField(5,De))}return q.exports=ne,q.exports.fromVectorTileJs=ne,q.exports.fromGeojsonVt=function(De,ze){ze=ze||{};var Je={};for(var Oe in De)Je[Oe]=new ee(De[Oe].features,ze),Je[Oe].name=Oe,Je[Oe].version=ze.version,Je[Oe].extent=ze.extent;return ne({layers:Je})},q.exports.GeoJSONWrapper=ee,q.exports}(),K=c.cP(Q);const N={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:_e=>_e},re=Math.fround||(ye=new Float32Array(1),_e=>(ye[0]=+_e,ye[0]));var ye;class ge{constructor(ee){this.options=Object.assign(Object.create(N),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:ne,minZoom:Z,maxZoom:le}=this.options;ne&&console.time("total time");const Te=`prepare ${ee.length} points`;ne&&console.time(Te),this.points=ee;const $e=[];for(let xe=0;xe<ee.length;xe++){const Re=ee[xe];if(!Re.geometry)continue;const[De,ze]=Re.geometry.coordinates,Je=re(ve(De)),Oe=re(Se(ze));$e.push(Je,Oe,1/0,xe,-1,1),this.options.reduce&&$e.push(0)}let fe=this.trees[le+1]=this._createTree($e);ne&&console.timeEnd(Te);for(let xe=le;xe>=Z;xe--){const Re=+Date.now();fe=this.trees[xe]=this._createTree(this._cluster(fe,xe)),ne&&console.log("z%d: %d clusters in %dms",xe,fe.numItems,+Date.now()-Re)}return ne&&console.timeEnd("total time"),this}getClusters(ee,ne){let Z=((ee[0]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,ee[1]));let Te=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)Z=-180,Te=180;else if(Z>Te){const ze=this.getClusters([Z,le,180,$e],ne),Je=this.getClusters([-180,le,Te,$e],ne);return ze.concat(Je)}const fe=this.trees[this._limitZoom(ne)],xe=fe.range(ve(Z),Se($e),ve(Te),Se(le)),Re=fe.data,De=[];for(const ze of xe){const Je=this.stride*ze;De.push(Re[Je+5]>1?Ve(Re,Je,this.clusterProps):this.points[Re[Je+3]])}return De}getChildren(ee){const ne=this._getOriginId(ee),Z=this._getOriginZoom(ee),le="No cluster with the specified id.",Te=this.trees[Z];if(!Te)throw new Error(le);const $e=Te.data;if(ne*this.stride>=$e.length)throw new Error(le);const fe=this.options.radius/(this.options.extent*Math.pow(2,Z-1)),xe=Te.within($e[ne*this.stride],$e[ne*this.stride+1],fe),Re=[];for(const De of xe){const ze=De*this.stride;$e[ze+4]===ee&&Re.push($e[ze+5]>1?Ve($e,ze,this.clusterProps):this.points[$e[ze+3]])}if(Re.length===0)throw new Error(le);return Re}getLeaves(ee,ne,Z){const le=[];return this._appendLeaves(le,ee,ne=ne||10,Z=Z||0,0),le}getTile(ee,ne,Z){const le=this.trees[this._limitZoom(ee)],Te=Math.pow(2,ee),{extent:$e,radius:fe}=this.options,xe=fe/$e,Re=(Z-xe)/Te,De=(Z+1+xe)/Te,ze={features:[]};return this._addTileFeatures(le.range((ne-xe)/Te,Re,(ne+1+xe)/Te,De),le.data,ne,Z,Te,ze),ne===0&&this._addTileFeatures(le.range(1-xe/Te,Re,1,De),le.data,Te,Z,Te,ze),ne===Te-1&&this._addTileFeatures(le.range(0,Re,xe/Te,De),le.data,-1,Z,Te,ze),ze.features.length?ze:null}getClusterExpansionZoom(ee){let ne=this._getOriginZoom(ee)-1;for(;ne<=this.options.maxZoom;){const Z=this.getChildren(ee);if(ne++,Z.length!==1)break;ee=Z[0].properties.cluster_id}return ne}_appendLeaves(ee,ne,Z,le,Te){const $e=this.getChildren(ne);for(const fe of $e){const xe=fe.properties;if(xe&&xe.cluster?Te+xe.point_count<=le?Te+=xe.point_count:Te=this._appendLeaves(ee,xe.cluster_id,Z,le,Te):Te<le?Te++:ee.push(fe),ee.length===Z)break}return Te}_createTree(ee){const ne=new c.aH(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Z=0;Z<ee.length;Z+=this.stride)ne.add(ee[Z],ee[Z+1]);return ne.finish(),ne.data=ee,ne}_addTileFeatures(ee,ne,Z,le,Te,$e){for(const fe of ee){const xe=fe*this.stride,Re=ne[xe+5]>1;let De,ze,Je;if(Re)De=Ie(ne,xe,this.clusterProps),ze=ne[xe],Je=ne[xe+1];else{const Ft=this.points[ne[xe+3]];De=Ft.properties;const[be,qe]=Ft.geometry.coordinates;ze=ve(be),Je=Se(qe)}const Oe={type:1,geometry:[[Math.round(this.options.extent*(ze*Te-Z)),Math.round(this.options.extent*(Je*Te-le))]],tags:De};let Et;Et=Re||this.options.generateId?ne[xe+3]:this.points[ne[xe+3]].id,Et!==void 0&&(Oe.id=Et),$e.features.push(Oe)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,ne){const{radius:Z,extent:le,reduce:Te,minPoints:$e}=this.options,fe=Z/(le*Math.pow(2,ne)),xe=ee.data,Re=[],De=this.stride;for(let ze=0;ze<xe.length;ze+=De){if(xe[ze+2]<=ne)continue;xe[ze+2]=ne;const Je=xe[ze],Oe=xe[ze+1],Et=ee.within(xe[ze],xe[ze+1],fe),Ft=xe[ze+5];let be=Ft;for(const qe of Et){const tt=qe*De;xe[tt+2]>ne&&(be+=xe[tt+5])}if(be>Ft&&be>=$e){let qe,tt=Je*Ft,At=Oe*Ft,Ht=-1;const Yt=(ze/De<<5)+(ne+1)+this.points.length;for(const qt of Et){const Gt=qt*De;if(xe[Gt+2]<=ne)continue;xe[Gt+2]=ne;const yn=xe[Gt+5];tt+=xe[Gt]*yn,At+=xe[Gt+1]*yn,xe[Gt+4]=Yt,Te&&(qe||(qe=this._map(xe,ze,!0),Ht=this.clusterProps.length,this.clusterProps.push(qe)),Te(qe,this._map(xe,Gt)))}xe[ze+4]=Yt,Re.push(tt/be,At/be,1/0,Yt,-1,be),Te&&Re.push(Ht)}else{for(let qe=0;qe<De;qe++)Re.push(xe[ze+qe]);if(be>1)for(const qe of Et){const tt=qe*De;if(!(xe[tt+2]<=ne)){xe[tt+2]=ne;for(let At=0;At<De;At++)Re.push(xe[tt+At])}}}}return Re}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,ne,Z){if(ee[ne+5]>1){const $e=this.clusterProps[ee[ne+6]];return Z?Object.assign({},$e):$e}const le=this.points[ee[ne+3]].properties,Te=this.options.map(le);return Z&&Te===le?Object.assign({},Te):Te}}function Ve(_e,ee,ne){return{type:"Feature",id:_e[ee+3],properties:Ie(_e,ee,ne),geometry:{type:"Point",coordinates:[(Z=_e[ee],360*(Z-.5)),Me(_e[ee+1])]}};var Z}function Ie(_e,ee,ne){const Z=_e[ee+5],le=Z>=1e4?`${Math.round(Z/1e3)}k`:Z>=1e3?Math.round(Z/100)/10+"k":Z,Te=_e[ee+6],$e=Te===-1?{}:Object.assign({},ne[Te]);return Object.assign($e,{cluster:!0,cluster_id:_e[ee+3],point_count:Z,point_count_abbreviated:le})}function ve(_e){return _e/360+.5}function Se(_e){const ee=Math.sin(_e*Math.PI/180),ne=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ne<0?0:ne>1?1:ne}function Me(_e){const ee=(180-360*_e)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function Be(_e,ee,ne,Z){let le=Z;const Te=ee+(ne-ee>>1);let $e,fe=ne-ee;const xe=_e[ee],Re=_e[ee+1],De=_e[ne],ze=_e[ne+1];for(let Je=ee+3;Je<ne;Je+=3){const Oe=Qe(_e[Je],_e[Je+1],xe,Re,De,ze);if(Oe>le)$e=Je,le=Oe;else if(Oe===le){const Et=Math.abs(Je-Te);Et<fe&&($e=Je,fe=Et)}}le>Z&&($e-ee>3&&Be(_e,ee,$e,Z),_e[$e+2]=le,ne-$e>3&&Be(_e,$e,ne,Z))}function Qe(_e,ee,ne,Z,le,Te){let $e=le-ne,fe=Te-Z;if($e!==0||fe!==0){const xe=((_e-ne)*$e+(ee-Z)*fe)/($e*$e+fe*fe);xe>1?(ne=le,Z=Te):xe>0&&(ne+=$e*xe,Z+=fe*xe)}return $e=_e-ne,fe=ee-Z,$e*$e+fe*fe}function st(_e,ee,ne,Z){const le={id:_e??null,type:ee,geometry:ne,tags:Z,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")ct(le,ne);else if(ee==="Polygon")ct(le,ne[0]);else if(ee==="MultiLineString")for(const Te of ne)ct(le,Te);else if(ee==="MultiPolygon")for(const Te of ne)ct(le,Te[0]);return le}function ct(_e,ee){for(let ne=0;ne<ee.length;ne+=3)_e.minX=Math.min(_e.minX,ee[ne]),_e.minY=Math.min(_e.minY,ee[ne+1]),_e.maxX=Math.max(_e.maxX,ee[ne]),_e.maxY=Math.max(_e.maxY,ee[ne+1])}function Xt(_e,ee,ne,Z){if(!ee.geometry)return;const le=ee.geometry.coordinates;if(le&&le.length===0)return;const Te=ee.geometry.type,$e=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2);let fe=[],xe=ee.id;if(ne.promoteId?xe=ee.properties[ne.promoteId]:ne.generateId&&(xe=Z||0),Te==="Point")je(le,fe);else if(Te==="MultiPoint")for(const Re of le)je(Re,fe);else if(Te==="LineString")lt(le,fe,$e,!1);else if(Te==="MultiLineString"){if(ne.lineMetrics){for(const Re of le)fe=[],lt(Re,fe,$e,!1),_e.push(st(xe,"LineString",fe,ee.properties));return}Ot(le,fe,$e,!1)}else if(Te==="Polygon")Ot(le,fe,$e,!0);else{if(Te!=="MultiPolygon"){if(Te==="GeometryCollection"){for(const Re of ee.geometry.geometries)Xt(_e,{id:xe,geometry:Re,properties:ee.properties},ne,Z);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Re of le){const De=[];Ot(Re,De,$e,!0),fe.push(De)}}_e.push(st(xe,Te,fe,ee.properties))}function je(_e,ee){ee.push(ut(_e[0]),ot(_e[1]),0)}function lt(_e,ee,ne,Z){let le,Te,$e=0;for(let xe=0;xe<_e.length;xe++){const Re=ut(_e[xe][0]),De=ot(_e[xe][1]);ee.push(Re,De,0),xe>0&&($e+=Z?(le*De-Re*Te)/2:Math.sqrt(Math.pow(Re-le,2)+Math.pow(De-Te,2))),le=Re,Te=De}const fe=ee.length-3;ee[2]=1,Be(ee,0,fe,ne),ee[fe+2]=1,ee.size=Math.abs($e),ee.start=0,ee.end=ee.size}function Ot(_e,ee,ne,Z){for(let le=0;le<_e.length;le++){const Te=[];lt(_e[le],Te,ne,Z),ee.push(Te)}}function ut(_e){return _e/360+.5}function ot(_e){const ee=Math.sin(_e*Math.PI/180),ne=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ne<0?0:ne>1?1:ne}function Tt(_e,ee,ne,Z,le,Te,$e,fe){if(Z/=ee,Te>=(ne/=ee)&&$e<Z)return _e;if($e<ne||Te>=Z)return null;const xe=[];for(const Re of _e){const De=Re.geometry;let ze=Re.type;const Je=le===0?Re.minX:Re.minY,Oe=le===0?Re.maxX:Re.maxY;if(Je>=ne&&Oe<Z){xe.push(Re);continue}if(Oe<ne||Je>=Z)continue;let Et=[];if(ze==="Point"||ze==="MultiPoint")Ct(De,Et,ne,Z,le);else if(ze==="LineString")un(De,Et,ne,Z,le,!1,fe.lineMetrics);else if(ze==="MultiLineString")hn(De,Et,ne,Z,le,!1);else if(ze==="Polygon")hn(De,Et,ne,Z,le,!0);else if(ze==="MultiPolygon")for(const Ft of De){const be=[];hn(Ft,be,ne,Z,le,!0),be.length&&Et.push(be)}if(Et.length){if(fe.lineMetrics&&ze==="LineString"){for(const Ft of Et)xe.push(st(Re.id,ze,Ft,Re.tags));continue}ze!=="LineString"&&ze!=="MultiLineString"||(Et.length===1?(ze="LineString",Et=Et[0]):ze="MultiLineString"),ze!=="Point"&&ze!=="MultiPoint"||(ze=Et.length===3?"Point":"MultiPoint"),xe.push(st(Re.id,ze,Et,Re.tags))}}return xe.length?xe:null}function Ct(_e,ee,ne,Z,le){for(let Te=0;Te<_e.length;Te+=3){const $e=_e[Te+le];$e>=ne&&$e<=Z&&We(ee,_e[Te],_e[Te+1],_e[Te+2])}}function un(_e,ee,ne,Z,le,Te,$e){let fe=gn(_e);const xe=le===0?vn:Ut;let Re,De,ze=_e.start;for(let be=0;be<_e.length-3;be+=3){const qe=_e[be],tt=_e[be+1],At=_e[be+2],Ht=_e[be+3],Yt=_e[be+4],qt=le===0?qe:tt,Gt=le===0?Ht:Yt;let yn=!1;$e&&(Re=Math.sqrt(Math.pow(qe-Ht,2)+Math.pow(tt-Yt,2))),qt<ne?Gt>ne&&(De=xe(fe,qe,tt,Ht,Yt,ne),$e&&(fe.start=ze+Re*De)):qt>Z?Gt<Z&&(De=xe(fe,qe,tt,Ht,Yt,Z),$e&&(fe.start=ze+Re*De)):We(fe,qe,tt,At),Gt<ne&&qt>=ne&&(De=xe(fe,qe,tt,Ht,Yt,ne),yn=!0),Gt>Z&&qt<=Z&&(De=xe(fe,qe,tt,Ht,Yt,Z),yn=!0),!Te&&yn&&($e&&(fe.end=ze+Re*De),ee.push(fe),fe=gn(_e)),$e&&(ze+=Re)}let Je=_e.length-3;const Oe=_e[Je],Et=_e[Je+1],Ft=le===0?Oe:Et;Ft>=ne&&Ft<=Z&&We(fe,Oe,Et,_e[Je+2]),Je=fe.length-3,Te&&Je>=3&&(fe[Je]!==fe[0]||fe[Je+1]!==fe[1])&&We(fe,fe[0],fe[1],fe[2]),fe.length&&ee.push(fe)}function gn(_e){const ee=[];return ee.size=_e.size,ee.start=_e.start,ee.end=_e.end,ee}function hn(_e,ee,ne,Z,le,Te){for(const $e of _e)un($e,ee,ne,Z,le,Te,!1)}function We(_e,ee,ne,Z){_e.push(ee,ne,Z)}function vn(_e,ee,ne,Z,le,Te){const $e=(Te-ee)/(Z-ee);return We(_e,Te,ne+(le-ne)*$e,1),$e}function Ut(_e,ee,ne,Z,le,Te){const $e=(Te-ne)/(le-ne);return We(_e,ee+(Z-ee)*$e,Te,1),$e}function tn(_e,ee){const ne=[];for(let Z=0;Z<_e.length;Z++){const le=_e[Z],Te=le.type;let $e;if(Te==="Point"||Te==="MultiPoint"||Te==="LineString")$e=Dt(le.geometry,ee);else if(Te==="MultiLineString"||Te==="Polygon"){$e=[];for(const fe of le.geometry)$e.push(Dt(fe,ee))}else if(Te==="MultiPolygon"){$e=[];for(const fe of le.geometry){const xe=[];for(const Re of fe)xe.push(Dt(Re,ee));$e.push(xe)}}ne.push(st(le.id,Te,$e,le.tags))}return ne}function Dt(_e,ee){const ne=[];ne.size=_e.size,_e.start!==void 0&&(ne.start=_e.start,ne.end=_e.end);for(let Z=0;Z<_e.length;Z+=3)ne.push(_e[Z]+ee,_e[Z+1],_e[Z+2]);return ne}function An(_e,ee){if(_e.transformed)return _e;const ne=1<<_e.z,Z=_e.x,le=_e.y;for(const Te of _e.features){const $e=Te.geometry,fe=Te.type;if(Te.geometry=[],fe===1)for(let xe=0;xe<$e.length;xe+=2)Te.geometry.push(an($e[xe],$e[xe+1],ee,ne,Z,le));else for(let xe=0;xe<$e.length;xe++){const Re=[];for(let De=0;De<$e[xe].length;De+=2)Re.push(an($e[xe][De],$e[xe][De+1],ee,ne,Z,le));Te.geometry.push(Re)}}return _e.transformed=!0,_e}function an(_e,ee,ne,Z,le,Te){return[Math.round(ne*(_e*Z-le)),Math.round(ne*(ee*Z-Te))]}function Le(_e,ee,ne,Z,le){const Te=ee===le.maxZoom?0:le.tolerance/((1<<ee)*le.extent),$e={features:[],numPoints:0,numSimplified:0,numFeatures:_e.length,source:null,x:ne,y:Z,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const fe of _e)me($e,fe,Te,le);return $e}function me(_e,ee,ne,Z){const le=ee.geometry,Te=ee.type,$e=[];if(_e.minX=Math.min(_e.minX,ee.minX),_e.minY=Math.min(_e.minY,ee.minY),_e.maxX=Math.max(_e.maxX,ee.maxX),_e.maxY=Math.max(_e.maxY,ee.maxY),Te==="Point"||Te==="MultiPoint")for(let fe=0;fe<le.length;fe+=3)$e.push(le[fe],le[fe+1]),_e.numPoints++,_e.numSimplified++;else if(Te==="LineString")it($e,le,_e,ne,!1,!1);else if(Te==="MultiLineString"||Te==="Polygon")for(let fe=0;fe<le.length;fe++)it($e,le[fe],_e,ne,Te==="Polygon",fe===0);else if(Te==="MultiPolygon")for(let fe=0;fe<le.length;fe++){const xe=le[fe];for(let Re=0;Re<xe.length;Re++)it($e,xe[Re],_e,ne,!0,Re===0)}if($e.length){let fe=ee.tags||null;if(Te==="LineString"&&Z.lineMetrics){fe={};for(const Re in ee.tags)fe[Re]=ee.tags[Re];fe.mapbox_clip_start=le.start/le.size,fe.mapbox_clip_end=le.end/le.size}const xe={geometry:$e,type:Te==="Polygon"||Te==="MultiPolygon"?3:Te==="LineString"||Te==="MultiLineString"?2:1,tags:fe};ee.id!==null&&(xe.id=ee.id),_e.features.push(xe)}}function it(_e,ee,ne,Z,le,Te){const $e=Z*Z;if(Z>0&&ee.size<(le?$e:Z))return void(ne.numPoints+=ee.length/3);const fe=[];for(let xe=0;xe<ee.length;xe+=3)(Z===0||ee[xe+2]>$e)&&(ne.numSimplified++,fe.push(ee[xe],ee[xe+1])),ne.numPoints++;le&&function(xe,Re){let De=0;for(let ze=0,Je=xe.length,Oe=Je-2;ze<Je;Oe=ze,ze+=2)De+=(xe[ze]-xe[Oe])*(xe[ze+1]+xe[Oe+1]);if(De>0===Re)for(let ze=0,Je=xe.length;ze<Je/2;ze+=2){const Oe=xe[ze],Et=xe[ze+1];xe[ze]=xe[Je-2-ze],xe[ze+1]=xe[Je-1-ze],xe[Je-2-ze]=Oe,xe[Je-1-ze]=Et}}(fe,Te),_e.push(fe)}const St={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class It{constructor(ee,ne){const Z=(ne=this.options=function(Te,$e){for(const fe in $e)Te[fe]=$e[fe];return Te}(Object.create(St),ne)).debug;if(Z&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");let le=function(Te,$e){const fe=[];if(Te.type==="FeatureCollection")for(let xe=0;xe<Te.features.length;xe++)Xt(fe,Te.features[xe],$e,xe);else Xt(fe,Te.type==="Feature"?Te:{geometry:Te},$e);return fe}(ee,ne);this.tiles={},this.tileCoords=[],Z&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),le=function(Te,$e){const fe=$e.buffer/$e.extent;let xe=Te;const Re=Tt(Te,1,-1-fe,fe,0,-1,2,$e),De=Tt(Te,1,1-fe,2+fe,0,-1,2,$e);return(Re||De)&&(xe=Tt(Te,1,-fe,1+fe,0,-1,2,$e)||[],Re&&(xe=tn(Re,1).concat(xe)),De&&(xe=xe.concat(tn(De,-1)))),xe}(le,ne),le.length&&this.splitTile(le,0,0,0),Z&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,ne,Z,le,Te,$e,fe){const xe=[ee,ne,Z,le],Re=this.options,De=Re.debug;for(;xe.length;){le=xe.pop(),Z=xe.pop(),ne=xe.pop(),ee=xe.pop();const ze=1<<ne,Je=wt(ne,Z,le);let Oe=this.tiles[Je];if(!Oe&&(De>1&&console.time("creation"),Oe=this.tiles[Je]=Le(ee,ne,Z,le,Re),this.tileCoords.push({z:ne,x:Z,y:le}),De)){De>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,Z,le,Oe.numFeatures,Oe.numPoints,Oe.numSimplified),console.timeEnd("creation"));const yn=`z${ne}`;this.stats[yn]=(this.stats[yn]||0)+1,this.total++}if(Oe.source=ee,Te==null){if(ne===Re.indexMaxZoom||Oe.numPoints<=Re.indexMaxPoints)continue}else{if(ne===Re.maxZoom||ne===Te)continue;if(Te!=null){const yn=Te-ne;if(Z!==$e>>yn||le!==fe>>yn)continue}}if(Oe.source=null,ee.length===0)continue;De>1&&console.time("clipping");const Et=.5*Re.buffer/Re.extent,Ft=.5-Et,be=.5+Et,qe=1+Et;let tt=null,At=null,Ht=null,Yt=null,qt=Tt(ee,ze,Z-Et,Z+be,0,Oe.minX,Oe.maxX,Re),Gt=Tt(ee,ze,Z+Ft,Z+qe,0,Oe.minX,Oe.maxX,Re);ee=null,qt&&(tt=Tt(qt,ze,le-Et,le+be,1,Oe.minY,Oe.maxY,Re),At=Tt(qt,ze,le+Ft,le+qe,1,Oe.minY,Oe.maxY,Re),qt=null),Gt&&(Ht=Tt(Gt,ze,le-Et,le+be,1,Oe.minY,Oe.maxY,Re),Yt=Tt(Gt,ze,le+Ft,le+qe,1,Oe.minY,Oe.maxY,Re),Gt=null),De>1&&console.timeEnd("clipping"),xe.push(tt||[],ne+1,2*Z,2*le),xe.push(At||[],ne+1,2*Z,2*le+1),xe.push(Ht||[],ne+1,2*Z+1,2*le),xe.push(Yt||[],ne+1,2*Z+1,2*le+1)}}getTile(ee,ne,Z){ee=+ee,ne=+ne,Z=+Z;const le=this.options,{extent:Te,debug:$e}=le;if(ee<0||ee>24)return null;const fe=1<<ee,xe=wt(ee,ne=ne+fe&fe-1,Z);if(this.tiles[xe])return An(this.tiles[xe],Te);$e>1&&console.log("drilling down to z%d-%d-%d",ee,ne,Z);let Re,De=ee,ze=ne,Je=Z;for(;!Re&&De>0;)De--,ze>>=1,Je>>=1,Re=this.tiles[wt(De,ze,Je)];return Re&&Re.source?($e>1&&(console.log("found parent tile z%d-%d-%d",De,ze,Je),console.time("drilling down")),this.splitTile(Re.source,De,ze,Je,ee,ne,Z),$e>1&&console.timeEnd("drilling down"),this.tiles[xe]?An(this.tiles[xe],Te):null):null}}function wt(_e,ee,ne){return 32*((1<<_e)*ne+ee)+_e}function Zt(_e,ee){return ee?_e.properties[ee]:_e.id}function Lt(_e,ee){if(_e==null)return!0;if(_e.type==="Feature")return Zt(_e,ee)!=null;if(_e.type==="FeatureCollection"){const ne=new Set;for(const Z of _e.features){const le=Zt(Z,ee);if(le==null||ne.has(le))return!1;ne.add(le)}return!0}return!1}function kt(_e,ee){const ne=new Map;if(_e!=null)if(_e.type==="Feature")ne.set(Zt(_e,ee),_e);else for(const Z of _e.features)ne.set(Zt(Z,ee),Z);return ne}class bn extends x{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,ne){return c._(this,void 0,void 0,function*(){const Z=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const le=this._geoJSONIndex.getTile(Z.z,Z.x,Z.y);if(!le)return null;const Te=new D(le.features);let $e=K(Te);return $e.byteOffset===0&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),{vectorTile:Te,rawData:$e.buffer}})}loadData(ee){return c._(this,void 0,void 0,function*(){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const Z=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new c.cM(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest),this._geoJSONIndex=ee.cluster?new ge(function({superclusterOptions:$e,clusterProperties:fe}){if(!fe||!$e)return $e;const xe={},Re={},De={accumulated:null,zoom:0},ze={properties:null},Je=Object.keys(fe);for(const Oe of Je){const[Et,Ft]=fe[Oe],be=c.cT(Ft),qe=c.cT(typeof Et=="string"?[Et,["accumulated"],["get",Oe]]:Et);xe[Oe]=be.value,Re[Oe]=qe.value}return $e.map=Oe=>{ze.properties=Oe;const Et={};for(const Ft of Je)Et[Ft]=xe[Ft].evaluate(De,ze);return Et},$e.reduce=(Oe,Et)=>{ze.properties=Et;for(const Ft of Je)De.accumulated=Oe[Ft],Oe[Ft]=Re[Ft].evaluate(De,ze)},$e}(ee)).load((yield this._pendingData).features):(le=yield this._pendingData,new It(le,ee.geojsonVtOptions)),this.loaded={};const Te={};if(Z){const $e=Z.finish();$e&&(Te.resourceTiming={},Te.resourceTiming[ee.source]=JSON.parse(JSON.stringify($e)))}return Te}catch(Te){if(delete this._pendingRequest,c.cx(Te))return{abandoned:!0};throw Te}var le})}getData(){return c._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){const ne=this.loaded;return ne&&ne[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,ne){return c._(this,void 0,void 0,function*(){let Z=yield this.loadGeoJSON(ee,ne);if(delete this._pendingRequest,typeof Z!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(I(Z,!0),ee.filter){const le=c.cT(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(le.result==="error")throw new Error(le.value.map($e=>`${$e.key}: ${$e.message}`).join(", "));Z={type:"FeatureCollection",features:Z.features.filter($e=>le.value.evaluate({zoom:0},$e))}}return Z})}loadGeoJSON(ee,ne){return c._(this,void 0,void 0,function*(){const{promoteId:Z}=ee;if(ee.request){const le=yield c.j(ee.request,ne);return this._dataUpdateable=Lt(le.data,Z)?kt(le.data,Z):void 0,le.data}if(typeof ee.data=="string")try{const le=JSON.parse(ee.data);return this._dataUpdateable=Lt(le,Z)?kt(le,Z):void 0,le}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return function(le,Te,$e){var fe,xe,Re,De;if(Te.removeAll&&le.clear(),Te.remove)for(const ze of Te.remove)le.delete(ze);if(Te.add)for(const ze of Te.add){const Je=Zt(ze,$e);Je!=null&&le.set(Je,ze)}if(Te.update)for(const ze of Te.update){let Je=le.get(ze.id);if(Je==null)continue;const Oe=!ze.removeAllProperties&&(((fe=ze.removeProperties)===null||fe===void 0?void 0:fe.length)>0||((xe=ze.addOrUpdateProperties)===null||xe===void 0?void 0:xe.length)>0);if((ze.newGeometry||ze.removeAllProperties||Oe)&&(Je=Object.assign({},Je),le.set(ze.id,Je),Oe&&(Je.properties=Object.assign({},Je.properties))),ze.newGeometry&&(Je.geometry=ze.newGeometry),ze.removeAllProperties)Je.properties={};else if(((Re=ze.removeProperties)===null||Re===void 0?void 0:Re.length)>0)for(const Et of ze.removeProperties)Object.prototype.hasOwnProperty.call(Je.properties,Et)&&delete Je.properties[Et];if(((De=ze.addOrUpdateProperties)===null||De===void 0?void 0:De.length)>0)for(const{key:Et,value:Ft}of ze.addOrUpdateProperties)Je.properties[Et]=Ft}}(this._dataUpdateable,ee.dataDiff,Z),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return c._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class zt{constructor(ee){this.self=ee,this.actor=new c.J(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ne,Z)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=Z},this.self.addProtocol=c.cz,this.self.removeProtocol=c.cA,this.self.registerRTLTextPlugin=ne=>{c.cU.setMethods(ne)},this.actor.registerMessageHandler("LDT",(ne,Z)=>this._getDEMWorkerSource(ne,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RDT",(ne,Z)=>c._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,Z.source).removeTile(Z)})),this.actor.registerMessageHandler("GCEZ",(ne,Z)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,Z.type,Z.source).getClusterExpansionZoom(Z)})),this.actor.registerMessageHandler("GCC",(ne,Z)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,Z.type,Z.source).getClusterChildren(Z)})),this.actor.registerMessageHandler("GCL",(ne,Z)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,Z.type,Z.source).getClusterLeaves(Z)})),this.actor.registerMessageHandler("LD",(ne,Z)=>this._getWorkerSource(ne,Z.type,Z.source).loadData(Z)),this.actor.registerMessageHandler("GD",(ne,Z)=>this._getWorkerSource(ne,Z.type,Z.source).getData()),this.actor.registerMessageHandler("LT",(ne,Z)=>this._getWorkerSource(ne,Z.type,Z.source).loadTile(Z)),this.actor.registerMessageHandler("RT",(ne,Z)=>this._getWorkerSource(ne,Z.type,Z.source).reloadTile(Z)),this.actor.registerMessageHandler("AT",(ne,Z)=>this._getWorkerSource(ne,Z.type,Z.source).abortTile(Z)),this.actor.registerMessageHandler("RMT",(ne,Z)=>this._getWorkerSource(ne,Z.type,Z.source).removeTile(Z)),this.actor.registerMessageHandler("RS",(ne,Z)=>c._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][Z.type]||!this.workerSources[ne][Z.type][Z.source])return;const le=this.workerSources[ne][Z.type][Z.source];delete this.workerSources[ne][Z.type][Z.source],le.removeSource!==void 0&&le.removeSource(Z)})),this.actor.registerMessageHandler("RM",ne=>c._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne]})),this.actor.registerMessageHandler("SR",(ne,Z)=>c._(this,void 0,void 0,function*(){this.referrer=Z})),this.actor.registerMessageHandler("SRPS",(ne,Z)=>this._syncRTLPluginState(ne,Z)),this.actor.registerMessageHandler("IS",(ne,Z)=>c._(this,void 0,void 0,function*(){this.self.importScripts(Z)})),this.actor.registerMessageHandler("SI",(ne,Z)=>this._setImages(ne,Z)),this.actor.registerMessageHandler("UL",(ne,Z)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update(Z.layers,Z.removedIds)})),this.actor.registerMessageHandler("SL",(ne,Z)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace(Z)}))}_setImages(ee,ne){return c._(this,void 0,void 0,function*(){this.availableImages[ee]=ne;for(const Z in this.workerSources[ee]){const le=this.workerSources[ee][Z];for(const Te in le)le[Te].availableImages=ne}})}_syncRTLPluginState(ee,ne){return c._(this,void 0,void 0,function*(){return yield c.cU.syncState(ne,this.self.importScripts)})}_getAvailableImages(ee){let ne=this.availableImages[ee];return ne||(ne=[]),ne}_getLayerIndex(ee){let ne=this.layerIndexes[ee];return ne||(ne=this.layerIndexes[ee]=new s),ne}_getWorkerSource(ee,ne,Z){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][ne]||(this.workerSources[ee][ne]={}),!this.workerSources[ee][ne][Z]){const le={sendAsync:(Te,$e)=>(Te.targetMapId=ee,this.actor.sendAsync(Te,$e))};switch(ne){case"vector":this.workerSources[ee][ne][Z]=new x(le,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][ne][Z]=new bn(le,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][ne][Z]=new this.externalWorkerSourceTypes[ne](le,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][ne][Z]}_getDEMWorkerSource(ee,ne){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][ne]||(this.demWorkerSources[ee][ne]=new C),this.demWorkerSources[ee][ne]}}return c.i(self)&&(self.worker=new zt(self)),zt}),i("index",["exports","./shared"],function(c,s){var f="5.6.1";function g(){var b=new s.A(4);return s.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let _,x;const C={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,o,u){const m=requestAnimationFrame(w=>{v(),o(w)}),{unsubscribe:v}=s.s(b.signal,"abort",()=>{v(),cancelAnimationFrame(m),u(s.c())},!1)},frameAsync(b){return new Promise((o,u)=>{this.frame(b,o,u)})},getImageData(b,o=0){return this.getImageCanvasContext(b).getImageData(-o,-o,b.width+2*o,b.height+2*o)},getImageCanvasContext(b){const o=window.document.createElement("canvas"),u=o.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return o.width=b.width,o.height=b.height,u.drawImage(b,0,0,b.width,b.height),u},resolveURL:b=>(_||(_=document.createElement("a")),_.href=b,_.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(x==null&&(x=matchMedia("(prefers-reduced-motion: reduce)")),x.matches)}};class E{static testProp(o){if(!E.docStyle)return o[0];for(let u=0;u<o.length;u++)if(o[u]in E.docStyle)return o[u];return o[0]}static create(o,u,m){const v=window.document.createElement(o);return u!==void 0&&(v.className=u),m&&m.appendChild(v),v}static createNS(o,u){return window.document.createElementNS(o,u)}static disableDrag(){E.docStyle&&E.selectProp&&(E.userSelect=E.docStyle[E.selectProp],E.docStyle[E.selectProp]="none")}static enableDrag(){E.docStyle&&E.selectProp&&(E.docStyle[E.selectProp]=E.userSelect)}static setTransform(o,u){o.style[E.transformProp]=u}static addEventListener(o,u,m,v={}){o.addEventListener(u,m,"passive"in v?v:v.capture)}static removeEventListener(o,u,m,v={}){o.removeEventListener(u,m,"passive"in v?v:v.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",E.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",E.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",E.suppressClickInternal,!0)},0)}static getScale(o){const u=o.getBoundingClientRect();return{x:u.width/o.offsetWidth||1,y:u.height/o.offsetHeight||1,boundingClientRect:u}}static getPoint(o,u,m){const v=u.boundingClientRect;return new s.P((m.clientX-v.left)/u.x-o.clientLeft,(m.clientY-v.top)/u.y-o.clientTop)}static mousePos(o,u){const m=E.getScale(o);return E.getPoint(o,m,u)}static touchPos(o,u){const m=[],v=E.getScale(o);for(let w=0;w<u.length;w++)m.push(E.getPoint(o,v,u[w]));return m}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}static sanitize(o){const u=new DOMParser().parseFromString(o,"text/html").body||document.createElement("body"),m=u.querySelectorAll("script");for(const v of m)v.remove();return E.clean(u),u.innerHTML}static isPossiblyDangerous(o,u){const m=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(o)||!m.includes("javascript:")&&!m.includes("data:"))||!!o.startsWith("on")||void 0}static clean(o){const u=o.children;for(const m of u)E.removeAttributes(m),E.clean(m)}static removeAttributes(o){for(const{name:u,value:m}of o.attributes)E.isPossiblyDangerous(u,m)&&o.removeAttribute(u)}}E.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,E.selectProp=E.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),E.transformProp=E.testProp(["transform","WebkitTransform"]);const A={supported:!1,testSupport:function(b){!T&&I&&(O?D(b):L=b)}};let L,I,T=!1,O=!1;function D(b){const o=b.createTexture();b.bindTexture(b.TEXTURE_2D,o);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,I),b.isContextLost())return;A.supported=!0}catch{}b.deleteTexture(o),T=!0}var U;typeof document<"u"&&(I=document.createElement("img"),I.onload=()=>{L&&D(L),L=null,O=!0},I.onerror=()=>{T=!0,L=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let o,u,m,v;b.resetRequestQueue=()=>{o=[],u=0,m=0,v={}},b.addThrottleControl=F=>{const j=m++;return v[j]=F,j},b.removeThrottleControl=F=>{delete v[F],P()},b.getImage=(F,j,W=!0)=>new Promise((J,Y)=>{A.supported&&(F.headers||(F.headers={}),F.headers.accept="image/webp,*/*"),s.e(F,{type:"image"}),o.push({abortController:j,requestParameters:F,supportImageRefresh:W,state:"queued",onError:oe=>{Y(oe)},onSuccess:oe=>{J(oe)}}),P()});const w=F=>s._(this,void 0,void 0,function*(){F.state="running";const{requestParameters:j,supportImageRefresh:W,onError:J,onSuccess:Y,abortController:oe}=F,he=W===!1&&!s.i(self)&&!s.g(j.url)&&(!j.headers||Object.keys(j.headers).reduce((Ae,Fe)=>Ae&&Fe==="accept",!0));u++;const Pe=he?k(j,oe):s.m(j,oe);try{const Ae=yield Pe;delete F.abortController,F.state="completed",Ae.data instanceof HTMLImageElement||s.b(Ae.data)?Y(Ae):Ae.data&&Y({data:yield(Ee=Ae.data,typeof createImageBitmap=="function"?s.f(Ee):s.h(Ee)),cacheControl:Ae.cacheControl,expires:Ae.expires})}catch(Ae){delete F.abortController,J(Ae)}finally{u--,P()}var Ee}),P=()=>{const F=(()=>{for(const j of Object.keys(v))if(v[j]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=u;j<F&&o.length>0;j++){const W=o.shift();W.abortController.signal.aborted?j--:w(W)}},k=(F,j)=>new Promise((W,J)=>{const Y=new Image,oe=F.url,he=F.credentials;he&&he==="include"?Y.crossOrigin="use-credentials":(he&&he==="same-origin"||!s.d(oe))&&(Y.crossOrigin="anonymous"),j.signal.addEventListener("abort",()=>{Y.src="",J(s.c())}),Y.fetchPriority="high",Y.onload=()=>{Y.onerror=Y.onload=null,W({data:Y})},Y.onerror=()=>{Y.onerror=Y.onload=null,j.signal.aborted||J(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},Y.src=oe})}(U||(U={})),U.resetRequestQueue();class H{constructor(o){this._transformRequestFn=o}transformRequest(o,u){return this._transformRequestFn&&this._transformRequestFn(o,u)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function V(b){const o=[];if(typeof b=="string")o.push({id:"default",url:b});else if(b&&b.length>0){const u=[];for(const{id:m,url:v}of b){const w=`${m}${v}`;u.indexOf(w)===-1&&(u.push(w),o.push({id:m,url:v}))}}return o}function q(b,o,u){try{const m=new URL(b);return m.pathname+=`${o}${u}`,m.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Q(b){const{userImage:o}=b;return!!(o&&o.render&&o.render())&&(b.data.replace(new Uint8Array(o.data.buffer)),!0)}class K extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:u,promiseResolve:m}of this.requestors)m(this._getImagesForIds(u));this.requestors=[]}}getImage(o){const u=this.images[o];if(u&&!u.data&&u.spriteData){const m=u.spriteData;u.data=new s.R({width:m.width,height:m.height},m.context.getImageData(m.x,m.y,m.width,m.height).data),u.spriteData=null}return u}addImage(o,u){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,u)&&(this.images[o]=u)}_validate(o,u){let m=!0;const v=u.data||u.spriteData;return this._validateStretch(u.stretchX,v&&v.width)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,v&&v.height)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "content" value`))),m=!1),m}_validateStretch(o,u){if(!o)return!0;let m=0;for(const v of o){if(v[0]<m||v[1]<v[0]||u<v[1])return!1;m=v[1]}return!0}_validateContent(o,u){if(!o)return!0;if(o.length!==4)return!1;const m=u.spriteData,v=m&&m.width||u.data.width,w=m&&m.height||u.data.height;return!(o[0]<0||v<o[0]||o[1]<0||w<o[1]||o[2]<0||v<o[2]||o[3]<0||w<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,u,m=!0){const v=this.getImage(o);if(m&&(v.data.width!==u.data.width||v.data.height!==u.data.height))throw new Error(`size mismatch between old image (${v.data.width}x${v.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=v.version+1,this.images[o]=u,this.updatedImages[o]=!0}removeImage(o){const u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((u,m)=>{let v=!0;if(!this.isLoaded())for(const w of o)this.images[w]||(v=!1);this.isLoaded()||v?u(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:u})})}_getImagesForIds(o){const u={};for(const m of o){let v=this.getImage(m);v||(this.fire(new s.l("styleimagemissing",{id:m})),v=this.getImage(m)),v?u[m]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,textFitWidth:v.textFitWidth,textFitHeight:v.textFitHeight,hasRenderCallback:!!(v.userImage&&v.userImage.render)}:s.w(`Image "${m}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:o,height:u}=this.atlasImage;return{width:o,height:u}}getPattern(o){const u=this.patterns[o],m=this.getImage(o);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const v={w:m.data.width+2,h:m.data.height+2,x:0,y:0},w=new s.I(v,m);this.patterns[o]={bin:v,position:w}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const w in this.patterns)o.push(this.patterns[w].bin);const{w:u,h:m}=s.p(o),v=this.atlasImage;v.resize({width:u||1,height:m||1});for(const w in this.patterns){const{bin:P}=this.patterns[w],k=P.x+1,F=P.y+1,j=this.getImage(w).data,W=j.width,J=j.height;s.R.copy(j,v,{x:0,y:0},{x:k,y:F},{width:W,height:J}),s.R.copy(j,v,{x:0,y:J-1},{x:k,y:F-1},{width:W,height:1}),s.R.copy(j,v,{x:0,y:0},{x:k,y:F+J},{width:W,height:1}),s.R.copy(j,v,{x:W-1,y:0},{x:k-1,y:F},{width:1,height:J}),s.R.copy(j,v,{x:0,y:0},{x:k+W,y:F},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const u of o){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.getImage(u);m||s.w(`Image with ID: "${u}" was not found`),Q(m)&&this.updateImage(u,m)}}}const N=1e20;function re(b,o,u,m,v,w,P,k,F){for(let j=o;j<o+m;j++)ye(b,u*w+j,w,v,P,k,F);for(let j=u;j<u+v;j++)ye(b,j*w+o,1,m,P,k,F)}function ye(b,o,u,m,v,w,P){w[0]=0,P[0]=-N,P[1]=N,v[0]=b[o];for(let k=1,F=0,j=0;k<m;k++){v[k]=b[o+k*u];const W=k*k;do{const J=w[F];j=(v[k]-v[J]+W-J*J)/(k-J)/2}while(j<=P[F]&&--F>-1);F++,w[F]=k,P[F]=j,P[F+1]=N}for(let k=0,F=0;k<m;k++){for(;P[F+1]<k;)F++;const j=w[F],W=k-j;b[o+k*u]=v[j]+W*W}}class ge{constructor(o,u){this.requestManager=o,this.localIdeographFontFamily=u,this.entries={}}setURL(o){this.url=o}getGlyphs(o){return s._(this,void 0,void 0,function*(){const u=[];for(const w in o)for(const P of o[w])u.push(this._getAndCacheGlyphsPromise(w,P));const m=yield Promise.all(u),v={};for(const{stack:w,id:P,glyph:k}of m)v[w]||(v[w]={}),v[w][P]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};return v})}_getAndCacheGlyphsPromise(o,u){return s._(this,void 0,void 0,function*(){let m=this.entries[o];m||(m=this.entries[o]={glyphs:{},requests:{},ranges:{}});let v=m.glyphs[u];if(v!==void 0)return{stack:o,id:u,glyph:v};if(v=this._tinySDF(m,o,u),v)return m.glyphs[u]=v,{stack:o,id:u,glyph:v};const w=Math.floor(u/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(m.ranges[w])return{stack:o,id:u,glyph:v};if(!this.url)throw new Error("glyphsUrl is not set");if(!m.requests[w]){const k=ge.loadGlyphRange(o,w,this.url,this.requestManager);m.requests[w]=k}const P=yield m.requests[w];for(const k in P)this._doesCharSupportLocalGlyph(+k)||(m.glyphs[+k]=P[+k]);return m.ranges[w]=!0,{stack:o,id:u,glyph:P[u]||null}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(o))||s.u["CJK Unified Ideographs"](o)||s.u["Hangul Syllables"](o)||s.u.Hiragana(o)||s.u.Katakana(o)||s.u["CJK Symbols and Punctuation"](o)||s.u["Halfwidth and Fullwidth Forms"](o))}_tinySDF(o,u,m){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(m))return;let w=o.tinySDF;if(!w){let k="400";/bold/i.test(u)?k="900":/medium/i.test(u)?k="500":/light/i.test(u)&&(k="200"),w=o.tinySDF=new ge.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:v,fontWeight:k})}const P=w.draw(String.fromCharCode(m));return{id:m,bitmap:new s.q({width:P.width||60,height:P.height||60},P.data),metrics:{width:P.glyphWidth/2||24,height:P.glyphHeight/2||24,left:P.glyphLeft/2+.5||0,top:P.glyphTop/2-27.5||-8,advance:P.glyphAdvance/2||24,isDoubleResolution:!0}}}}ge.loadGlyphRange=function(b,o,u,m){return s._(this,void 0,void 0,function*(){const v=256*o,w=v+255,P=m.transformRequest(u.replace("{fontstack}",b).replace("{range}",`${v}-${w}`),"Glyphs"),k=yield s.n(P,new AbortController);if(!k||!k.data)throw new Error(`Could not load glyph range. range: ${o}, ${v}-${w}`);const F={};for(const j of s.o(k.data))F[j.id]=j;return F})},ge.TinySDF=class{constructor({fontSize:b=24,buffer:o=3,radius:u=8,cutoff:m=.25,fontFamily:v="sans-serif",fontWeight:w="normal",fontStyle:P="normal"}={}){this.buffer=o,this.cutoff=m,this.radius=u;const k=this.size=b+4*o,F=this._createCanvas(k),j=this.ctx=F.getContext("2d",{willReadFrequently:!0});j.font=`${P} ${w} ${b}px ${v}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(b){const o=document.createElement("canvas");return o.width=o.height=b,o}draw(b){const{width:o,actualBoundingBoxAscent:u,actualBoundingBoxDescent:m,actualBoundingBoxLeft:v,actualBoundingBoxRight:w}=this.ctx.measureText(b),P=Math.ceil(u),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-v))),F=Math.min(this.size-this.buffer,P+Math.ceil(m)),j=k+2*this.buffer,W=F+2*this.buffer,J=Math.max(j*W,0),Y=new Uint8ClampedArray(J),oe={data:Y,width:j,height:W,glyphWidth:k,glyphHeight:F,glyphTop:P,glyphLeft:0,glyphAdvance:o};if(k===0||F===0)return oe;const{ctx:he,buffer:Pe,gridInner:Ee,gridOuter:Ae}=this;he.clearRect(Pe,Pe,k,F),he.fillText(b,Pe,Pe+P);const Fe=he.getImageData(Pe,Pe,k,F);Ae.fill(N,0,J),Ee.fill(0,0,J);for(let He=0;He<F;He++)for(let Ne=0;Ne<k;Ne++){const Ye=Fe.data[4*(He*k+Ne)+3]/255;if(Ye===0)continue;const Ke=(He+Pe)*j+Ne+Pe;if(Ye===1)Ae[Ke]=0,Ee[Ke]=N;else{const Ue=.5-Ye;Ae[Ke]=Ue>0?Ue*Ue:0,Ee[Ke]=Ue<0?Ue*Ue:0}}re(Ae,0,0,j,W,j,this.f,this.v,this.z),re(Ee,Pe,Pe,k,F,j,this.f,this.v,this.z);for(let He=0;He<J;He++){const Ne=Math.sqrt(Ae[He])-Math.sqrt(Ee[He]);Y[He]=Math.round(255-255*(Ne/this.radius+this.cutoff))}return oe}};class Ve{constructor(){this.specification=s.v.light.position}possiblyEvaluate(o,u){return s.B(o.expression.evaluate(u))}interpolate(o,u,m){return{x:s.C.number(o.x,u.x,m),y:s.C.number(o.y,u.y,m),z:s.C.number(o.z,u.z,m)}}}let Ie;class ve extends s.E{constructor(o){super(),Ie=Ie||new s.r({anchor:new s.D(s.v.light.anchor),position:new Ve,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.t(Ie),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u={}){if(!this._validate(s.x,o,u))for(const m in o){const v=o[m];m.endsWith("-transition")?this._transitionable.setTransition(m.slice(0,-11),v):this._transitionable.setValue(m,v)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,m){return(!m||m.validate!==!1)&&s.y(this,o.call(s.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}const Se=new s.r({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class Me extends s.E{constructor(o){super(),this._transitionable=new s.t(Se),this.setSky(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0))}setSky(o,u={}){if(!this._validate(s.G,o,u)){o||(o={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const m in o){const v=o[m];m.endsWith("-transition")?this._transitionable.setTransition(m.slice(0,-11),v):this._transitionable.setValue(m,v)}}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,m={}){return(m==null?void 0:m.validate)!==!1&&s.y(this,o.call(s.z,s.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class Be{constructor(o,u){this.width=o,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,u){const m=o.join(",")+String(u);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(o,u)),this.dashEntry[m]}getDashRanges(o,u,m){const v=[];let w=o.length%2==1?-o[o.length-1]*m:0,P=o[0]*m,k=!0;v.push({left:w,right:P,isDash:k,zeroLength:o[0]===0});let F=o[0];for(let j=1;j<o.length;j++){k=!k;const W=o[j];w=F*m,F+=W,P=F*m,v.push({left:w,right:P,isDash:k,zeroLength:W===0})}return v}addRoundDash(o,u,m){const v=u/2;for(let w=-m;w<=m;w++){const P=this.width*(this.nextRow+m+w);let k=0,F=o[k];for(let j=0;j<this.width;j++){j/F.right>1&&(F=o[++k]);const W=Math.abs(j-F.left),J=Math.abs(j-F.right),Y=Math.min(W,J);let oe;const he=w/m*(v+1);if(F.isDash){const Pe=v-Math.abs(he);oe=Math.sqrt(Y*Y+Pe*Pe)}else oe=v-Math.sqrt(Y*Y+he*he);this.data[P+j]=Math.max(0,Math.min(255,oe+128))}}}addRegularDash(o){for(let k=o.length-1;k>=0;--k){const F=o[k],j=o[k+1];F.zeroLength?o.splice(k,1):j&&j.isDash===F.isDash&&(j.left=F.left,o.splice(k,1))}const u=o[0],m=o[o.length-1];u.isDash===m.isDash&&(u.left=m.left-this.width,m.right=u.right+this.width);const v=this.width*this.nextRow;let w=0,P=o[w];for(let k=0;k<this.width;k++){k/P.right>1&&(P=o[++w]);const F=Math.abs(k-P.left),j=Math.abs(k-P.right),W=Math.min(F,j);this.data[v+k]=Math.max(0,Math.min(255,(P.isDash?W:-W)+128))}}addDash(o,u){const m=u?7:0,v=2*m+1;if(this.nextRow+v>this.height)return s.w("LineAtlas out of space"),null;let w=0;for(let k=0;k<o.length;k++)w+=o[k];if(w!==0){const k=this.width/w,F=this.getDashRanges(o,this.width,k);u?this.addRoundDash(F,k,m):this.addRegularDash(F)}const P={y:(this.nextRow+m+.5)/this.height,height:2*m/this.height,width:w};return this.nextRow+=v,this.dirty=!0,P}bind(o){const u=o.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const Qe="maplibre_preloaded_worker_pool";class st{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<st.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qe]}numActive(){return Object.keys(this.active).length}}const ct=Math.floor(C.hardwareConcurrency/2);let Xt,je;function lt(){return Xt||(Xt=new st),Xt}st.workerCount=s.H(globalThis)?Math.max(Math.min(ct,3),1):1;class Ot{constructor(o,u){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=u;const m=this.workerPool.acquire(u);for(let v=0;v<m.length;v++){const w=new s.J(m[v],u);w.name=`Worker ${v}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,u){const m=[];for(const v of this.actors)m.push(v.sendAsync({type:o,data:u}));return Promise.all(m)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,u){for(const m of this.actors)m.registerMessageHandler(o,u)}}function ut(){return je||(je=new Ot(lt(),s.K),je.registerMessageHandler("GR",(b,o,u)=>s.m(o,u))),je}function ot(b,o){const u=s.L();return s.M(u,u,[1,1,0]),s.N(u,u,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?s.O(u,u,b.calculatePosMatrix(o.toUnwrapped())):u}function Tt(b,o,u,m,v,w,P){var k;const F=function(Y,oe,he){if(Y)for(const Pe of Y){const Ee=oe[Pe];if(Ee&&Ee.source===he&&Ee.type==="fill-extrusion")return!0}else for(const Pe in oe){const Ee=oe[Pe];if(Ee.source===he&&Ee.type==="fill-extrusion")return!0}return!1}((k=v==null?void 0:v.layers)!==null&&k!==void 0?k:null,o,b.id),j=w.maxPitchScaleFactor(),W=b.tilesIn(m,j,F);W.sort(Ct);const J=[];for(const Y of W)J.push({wrappedTileID:Y.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(o,u,b._state,Y.queryGeometry,Y.cameraQueryGeometry,Y.scale,v,w,j,ot(b.transform,Y.tileID),P?(oe,he)=>P(Y.tileID,oe,he):void 0)});return function(Y,oe){for(const he in Y)for(const Pe of Y[he])un(Pe,oe);return Y}(function(Y){const oe={},he={};for(const Pe of Y){const Ee=Pe.queryResults,Ae=Pe.wrappedTileID,Fe=he[Ae]=he[Ae]||{};for(const He in Ee){const Ne=Ee[He],Ye=Fe[He]=Fe[He]||{},Ke=oe[He]=oe[He]||[];for(const Ue of Ne)Ye[Ue.featureIndex]||(Ye[Ue.featureIndex]=!0,Ke.push(Ue))}}return oe}(J),b)}function Ct(b,o){const u=b.tileID,m=o.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function un(b,o){const u=b.feature,m=o.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=m}function gn(b,o,u){return s._(this,void 0,void 0,function*(){let m=b;if(b.url?m=(yield s.j(o.transformRequest(b.url,"Source"),u)).data:yield C.frameAsync(u),!m)return null;const v=s.Q(s.e(m,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in m&&m.vector_layers&&(v.vectorLayerIds=m.vector_layers.map(w=>w.id)),v})}class hn{constructor(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof s.S?new s.S(o.lng,o.lat):s.S.convert(o),this}setSouthWest(o){return this._sw=o instanceof s.S?new s.S(o.lng,o.lat):s.S.convert(o),this}extend(o){const u=this._sw,m=this._ne;let v,w;if(o instanceof s.S)v=o,w=o;else{if(!(o instanceof hn))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(hn.convert(o)):this.extend(s.S.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(s.S.convert(o)):this;if(v=o._sw,w=o._ne,!v||!w)return this}return u||m?(u.lng=Math.min(v.lng,u.lng),u.lat=Math.min(v.lat,u.lat),m.lng=Math.max(w.lng,m.lng),m.lat=Math.max(w.lat,m.lat)):(this._sw=new s.S(v.lng,v.lat),this._ne=new s.S(w.lng,w.lat)),this}getCenter(){return new s.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.S(this.getWest(),this.getNorth())}getSouthEast(){return new s.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:m}=s.S.convert(o);let v=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&v}static convert(o){return o instanceof hn?o:o&&new hn(o)}static fromLngLat(o,u=0){const m=360*u/40075017,v=m/Math.cos(Math.PI/180*o.lat);return new hn(new s.S(o.lng-v,o.lat-m),new s.S(o.lng+v,o.lat+m))}adjustAntiMeridian(){const o=new s.S(this._sw.lng,this._sw.lat),u=new s.S(this._ne.lng,this._ne.lat);return new hn(o,o.lng>u.lng?new s.S(u.lng+360,u.lat):u)}}class We{constructor(o,u,m){this.bounds=hn.convert(this.validateBounds(o)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const u=Math.pow(2,o.z),m=Math.floor(s.V(this.bounds.getWest())*u),v=Math.floor(s.U(this.bounds.getNorth())*u),w=Math.ceil(s.V(this.bounds.getEast())*u),P=Math.ceil(s.U(this.bounds.getSouth())*u);return o.x>=m&&o.x<w&&o.y>=v&&o.y<P}}class vn extends s.E{constructor(o,u,m,v){if(super(),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.Q(u,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield gn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o&&(s.e(this,o),o.bounds&&(this.tileBounds=new We(o.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new s.k(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(o){return s._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m={request:this.map._requestManager.transformRequest(u,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};m.request.collectResourceTiming=this._collectResourceTiming;let v="RT";if(o.actor&&o.state!=="expired"){if(o.state==="loading")return new Promise((w,P)=>{o.reloadPromise={resolve:w,reject:P}})}else o.actor=this.dispatcher.getActor(),v="LT";o.abortController=new AbortController;try{const w=yield o.actor.sendAsync({type:v,data:m},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,w)}catch(w){if(delete o.abortController,o.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(o,null)}})}_afterTileLoadWorkerResponse(o,u){if(u&&u.resourceTiming&&(o.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&o.setExpiryData(u),o.loadVectorData(u,this.map.painter),o.reloadPromise){const m=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(m.resolve).catch(m.reject)}}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Ut extends s.E{constructor(o,u,m,v){super(),this.id=o,this.dispatcher=m,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},u),s.e(this,s.Q(u,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(o=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield gn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(s.e(this,u),u.bounds&&(this.tileBounds=new We(u.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:o})))}catch(u){this._tileJSONRequest=null,this.fire(new s.k(u))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load(!0)}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return s.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return s._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const m=yield U.getImage(this.map._requestManager.transformRequest(u,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(m&&m.data){this.map._refreshExpiredTiles&&(m.cacheControl||m.expires)&&o.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const v=this.map.painter.context,w=v.gl,P=m.data;o.texture=this.map.painter.getTileTexture(P.width),o.texture?o.texture.update(P,{useMipmap:!0}):(o.texture=new s.T(v,P,w.RGBA,{useMipmap:!0}),o.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(m){if(delete o.abortController,o.aborted)o.state="unloaded";else if(m)throw o.state="errored",m}})}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class tn extends Ut{constructor(o,u,m,v){super(o,u,m,v),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(o){return s._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),m=this.map._requestManager.transformRequest(u,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const v=yield U.getImage(m,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(v&&v.data){const w=v.data;this.map._refreshExpiredTiles&&(v.cacheControl||v.expires)&&o.setExpiryData({cacheControl:v.cacheControl,expires:v.expires});const P=s.b(w)&&s.W()?w:yield this.readImageNow(w),k={type:this.type,uid:o.uid,source:this.id,rawImageData:P,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||o.state==="expired"){o.actor=this.dispatcher.getActor();const F=yield o.actor.sendAsync({type:"LDT",data:k});o.dem=F,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(v){if(delete o.abortController,o.aborted)o.state="unloaded";else if(v)throw o.state="errored",v}})}readImageNow(o){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.X()){const u=o.width+2,m=o.height+2;try{return new s.R({width:u,height:m},yield s.Y(o,-1,-1,u,m))}catch{}}return C.getImageData(o,1)})}_getNeighboringTiles(o){const u=o.canonical,m=Math.pow(2,u.z),v=(u.x-1+m)%m,w=u.x===0?o.wrap-1:o.wrap,P=(u.x+1+m)%m,k=u.x+1===m?o.wrap+1:o.wrap,F={};return F[new s.Z(o.overscaledZ,w,u.z,v,u.y).key]={backfilled:!1},F[new s.Z(o.overscaledZ,k,u.z,P,u.y).key]={backfilled:!1},u.y>0&&(F[new s.Z(o.overscaledZ,w,u.z,v,u.y-1).key]={backfilled:!1},F[new s.Z(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},F[new s.Z(o.overscaledZ,k,u.z,P,u.y-1).key]={backfilled:!1}),u.y+1<m&&(F[new s.Z(o.overscaledZ,w,u.z,v,u.y+1).key]={backfilled:!1},F[new s.Z(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},F[new s.Z(o.overscaledZ,k,u.z,P,u.y+1).key]={backfilled:!1}),F}unloadTile(o){return s._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}class Dt extends s.E{constructor(o,u,m,v){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=m.getActor(),this.setEventedParent(v),this._data=u.data,this._options=s.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:s.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(o){return o*(s.$/this.tileSize)}_getClusterMaxZoom(o){const u=o?Math.round(o):this.maxzoom-1;return Number.isInteger(o)||o===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${o}" rounded to "${u}"`),u}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}getData(){return s._(this,void 0,void 0,function*(){const o=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}getCoordinatesFromGeometry(o){return o.type==="GeometryCollection"?o.geometries.map(u=>u.coordinates).flat(1/0):o.coordinates.flat(1/0)}getBounds(){return s._(this,void 0,void 0,function*(){const o=new hn,u=yield this.getData();let m;switch(u.type){case"FeatureCollection":m=u.features.map(v=>this.getCoordinatesFromGeometry(v.geometry)).flat(1/0);break;case"Feature":m=this.getCoordinatesFromGeometry(u.geometry);break;default:m=this.getCoordinatesFromGeometry(u)}if(m.length==0)return o;for(let v=0;v<m.length-1;v+=2)o.extend([m[v],m[v+1]]);return o})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(o.clusterRadius)),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(o.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,u,m){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:u,offset:m}})}_updateWorkerData(o){return s._(this,void 0,void 0,function*(){const u=s.e({type:this.type},this.workerOptions);o?u.dataDiff=o:typeof this._data=="string"?(u.request=this.map._requestManager.transformRequest(C.resolveURL(this._data),"Source"),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new s.l("dataloading",{dataType:"source"}));try{const m=yield this.actor.sendAsync({type:"LD",data:u});if(this._pendingLoads--,this._removed||m.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));let v=null;m.resourceTiming&&m.resourceTiming[this.id]&&(v=m.resourceTiming[this.id].slice(0));const w={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&s.e(w,{resourceTiming:v}),this.fire(new s.l("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))}catch(m){if(this._pendingLoads--,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(m))}})}loaded(){return this._pendingLoads===0}loadTile(o){return s._(this,void 0,void 0,function*(){const u=o.actor?"RT":"LT";o.actor=this.actor;const m={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};o.abortController=new AbortController;const v=yield this.actor.sendAsync({type:u,data:m},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(v,this.map.painter,u==="RT")})}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class An extends s.E{constructor(o,u,m,v){super(),this.flippedWindingOrder=!1,this.id=o,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=u}load(o){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield U.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,o&&(this.coordinates=o),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new s.k(u))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const u=o.map(s.a0.fromLngLat);var m;return this.tileID=function(v){const w=s.a1.fromPoints(v),P=w.width(),k=w.height(),F=Math.max(P,k),j=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),W=Math.pow(2,j);return new s.a3(j,Math.floor((w.minX+w.maxX)/2*W),Math.floor((w.minY+w.maxY)/2*W))}(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map(v=>this.tileID.getTilePoint(v)._round()),this.flippedWindingOrder=((m=this.tileCoords)[1].x-m[0].x)*(m[2].y-m[0].y)-(m[1].y-m[0].y)*(m[2].x-m[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,u=o.gl;this.texture||(this.texture=new s.T(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let m=!1;for(const v in this.tiles){const w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,m=!0)}m&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(o){const{minX:u,minY:m,maxX:v,maxY:w}=s.a1.fromPoints(o),P={};for(let k=0;k<=s.a2;k++){const F=Math.pow(2,k),j=Math.floor(u*F),W=Math.floor(m*F),J=Math.floor(v*F),Y=Math.floor(w*F);P[k]={minTileX:j,minTileY:W,maxTileX:J,maxTileY:Y}}return P}}class an extends An{constructor(o,u,m,v){super(o,u,m,v),this.roundZoom=!0,this.type="video",this.options=u}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const u of o.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield s.a4(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new s.k(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new s.k(new s.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,u=o.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let m=!1;for(const v in this.tiles){const w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,m=!0)}m&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Le extends An{constructor(o,u,m,v){super(o,u,m,v),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(P=>typeof P!="number"))||this.fire(new s.k(new s.a5(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.a5(`sources.${o}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.k(new s.a5(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.a5(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.a5(`sources.${o}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,m=u.gl;this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(u,this.canvas,m.RGBA,{premultiply:!0});let v=!1;for(const w in this.tiles){const P=this.tiles[w];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,v=!0)}v&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const me={},it=b=>{switch(b){case"geojson":return Dt;case"image":return An;case"raster":return Ut;case"raster-dem":return tn;case"vector":return vn;case"video":return an;case"canvas":return Le}return me[b]},St="RTLPluginLoaded";class It extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ut()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return s._(this,arguments,void 0,function*(u,m=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=C.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!m)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(St))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let wt=null;function Zt(){return wt||(wt=new It),wt}class Lt{constructor(o,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=s.a6(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const u=o+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,u,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(v,w){const P={};if(!w)return P;for(const k of v){const F=k.layerIds.map(j=>w.getLayer(j)).filter(Boolean);if(F.length!==0){k.layers=F,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(j=>F.filter(W=>W.id===j)[0]));for(const j of F)P[j.id]=k}}return P}(o.buckets,u==null?void 0:u.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const w=this.buckets[v];if(w instanceof s.a8){if(this.hasSymbolBuckets=!0,!m)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const w=this.buckets[v];if(w instanceof s.a8&&w.hasRTLText){this.hasRTLText=!0,Zt().lazyLoad();break}}this.queryPadding=0;for(const v in this.buckets){const w=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(v).queryRadius(w))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new s.a7}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const m in this.buckets){const v=this.buckets[m];v.uploadPending()&&v.upload(o)}const u=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(o,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(o,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,u,m,v,w,P,k,F,j,W,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:w,scale:P,tileSize:this.tileSize,pixelPosMatrix:W,transform:F,params:k,queryPadding:this.queryPadding*j,getElevation:J},o,u,m):{}}querySourceFeatures(o,u){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const v=m.loadVTLayers(),w=u&&u.sourceLayer?u.sourceLayer:"",P=v._geojsonTileLayer||v[w];if(!P)return;const k=s.a9(u&&u.filter),{z:F,x:j,y:W}=this.tileID.canonical,J={z:F,x:j,y:W};for(let Y=0;Y<P.length;Y++){const oe=P.feature(Y);if(k.needGeometry){const Ee=s.aa(oe,!0);if(!k.filter(new s.F(this.tileID.overscaledZ),Ee,this.tileID.canonical))continue}else if(!k.filter(new s.F(this.tileID.overscaledZ),oe))continue;const he=m.getId(oe,w),Pe=new s.ab(oe,F,j,W,he);Pe.tile=J,o.push(Pe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const u=this.expirationTime;if(o.cacheControl){const m=s.ac(o.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const m=Date.now();let v=!1;if(this.expirationTime>m)v=!1;else if(u)if(this.expirationTime<u)v=!0;else{const w=this.expirationTime-u;w?this.expirationTime=m+Math.max(w,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const m=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!u.style.hasLayer(v))continue;const w=this.buckets[v],P=w.layers[0].sourceLayer||"_geojsonTileLayer",k=m[P],F=o[P];if(!k||!F||Object.keys(F).length===0)continue;w.update(F,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const j=u&&u.style&&u.style.getLayer(v);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<C.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=C.now()+o}setDependencies(o,u){const m={};for(const v of u)m[v]=!0;this.dependencies[o]=m}hasDependency(o,u){for(const m of o){const v=this.dependencies[m];if(v){for(const w of u)if(v[w])return!0}}return!1}}class kt{constructor(o,u){this.max=o,this.onRemove=u,this.reset()}reset(){for(const o in this.data)for(const u of this.data[o])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(o,u,m){const v=o.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const w={value:u,timeout:void 0};if(m!==void 0&&(w.timeout=setTimeout(()=>{this.remove(o,w)},m)),this.data[v].push(w),this.order.push(v),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const u=this.data[o].shift();return u.timeout&&clearTimeout(u.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),u.value}getByKey(o){const u=this.data[o];return u?u[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,u){if(!this.has(o))return this;const m=o.wrapped().key,v=u===void 0?0:this.data[m].indexOf(u),w=this.data[m][v];return this.data[m].splice(v,1),w.timeout&&clearTimeout(w.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(w.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(o){const u=[];for(const m in this.data)for(const v of this.data[m])o(v.value)||u.push(v);for(const m of u)this.remove(m.value.tileID,m)}}class bn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,u,m){const v=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][v]=this.stateChanges[o][v]||{},s.e(this.stateChanges[o][v],m),this.deletedStates[o]===null){this.deletedStates[o]={};for(const w in this.state[o])w!==v&&(this.deletedStates[o][w]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][v]===null){this.deletedStates[o][v]={};for(const w in this.state[o][v])m[w]||(this.deletedStates[o][v][w]=null)}else for(const w in m)this.deletedStates[o]&&this.deletedStates[o][v]&&this.deletedStates[o][v][w]===null&&delete this.deletedStates[o][v][w]}removeFeatureState(o,u,m){if(this.deletedStates[o]===null)return;const v=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},m&&u!==void 0)this.deletedStates[o][v]!==null&&(this.deletedStates[o][v]=this.deletedStates[o][v]||{},this.deletedStates[o][v][m]=null);else if(u!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][v])for(m in this.deletedStates[o][v]={},this.stateChanges[o][v])this.deletedStates[o][v][m]=null;else this.deletedStates[o][v]=null;else this.deletedStates[o]=null}getState(o,u){const m=String(u),v=s.e({},(this.state[o]||{})[m],(this.stateChanges[o]||{})[m]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const w=this.deletedStates[o][u];if(w===null)return{};for(const P in w)delete v[P]}return v}initializeTileState(o,u){o.setFeatureState(this.state,u)}coalesceChanges(o,u){const m={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const w={};for(const P in this.stateChanges[v])this.state[v][P]||(this.state[v][P]={}),s.e(this.state[v][P],this.stateChanges[v][P]),w[P]=this.state[v][P];m[v]=w}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const w={};if(this.deletedStates[v]===null)for(const P in this.state[v])w[P]={},this.state[v][P]={};else for(const P in this.deletedStates[v]){if(this.deletedStates[v][P]===null)this.state[v][P]={};else for(const k of Object.keys(this.deletedStates[v][P]))delete this.state[v][P][k];w[P]=this.state[v][P]}m[v]=m[v]||{},s.e(m[v],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const v in o)o[v].setFeatureState(m,u)}}const zt=89.25;function _e(b,o){const u=s.ag(o.lat,-s.ah,s.ah);return new s.P(s.V(o.lng)*b,s.U(u)*b)}function ee(b,o){return new s.a0(o.x/b,o.y/b).toLngLat()}function ne(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(s.ad(90-b.pitch)),Math.tan(s.ad(zt-b.pitch)))}function Z(b,o){const u=b.canonical,m=o/s.ae(u.z),v=u.x+Math.pow(2,u.z)*b.wrap,w=s.af(new Float64Array(16));return s.M(w,w,[v*m,u.y*m,0]),s.N(w,w,[m/s.$,m/s.$,1]),w}function le(b,o,u,m,v){const w=s.a0.fromLngLat(b,o),P=v*s.ai(1,b.lat),k=P*Math.cos(s.ad(u)),F=Math.sqrt(P*P-k*k),j=F*Math.sin(s.ad(-m)),W=F*Math.cos(s.ad(-m));return new s.a0(w.x+j,w.y+W,w.z+k)}function Te(b,o,u){const m=o.intersectsFrustum(b);if(!u||m===0)return m;const v=o.intersectsPlane(u);return v===0?0:m===2&&v===2?2:1}function $e(b,o,u){let m=0;const v=(u-o)/10;for(let w=0;w<10;w++)m+=v*Math.pow(Math.cos(o+(w+.5)/10*(u-o)),b);return m}function fe(b,o){return function(u,m,v,w,P){const k=2*((b-1)/s.aj(Math.cos(s.ad(zt-P))/Math.cos(s.ad(zt)))-1),F=Math.acos(v/w),j=2*$e(k-1,0,s.ad(P/2)),W=Math.min(s.ad(zt),F+s.ad(P/2)),J=$e(k-1,Math.min(W,F-s.ad(P/2)),W),Y=Math.atan(m/v),oe=Math.hypot(m,v);let he=u;return he+=s.aj(w/oe/Math.max(.5,Math.cos(s.ad(P/2)))),he+=k*s.aj(Math.cos(Y))/2,he-=s.aj(Math.max(1,J/j/o))/2,he}}const xe=fe(9.314,3);function Re(b,o){const u=(o.roundZoom?Math.round:Math.floor)(b.zoom+s.aj(b.tileSize/o.tileSize));return Math.max(0,u)}function De(b,o){const u=b.getCameraFrustum(),m=b.getClippingPlane(),v=b.screenPointToMercatorCoordinate(b.getCameraPoint()),w=s.a0.fromLngLat(b.center,b.elevation);v.z=w.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const P=b.getCoveringTilesDetailsProvider(),k=P.allowVariableZoom(b,o),F=Re(b,o),j=o.minzoom||0,W=o.maxzoom!==void 0?o.maxzoom:b.maxZoom,J=Math.min(Math.max(0,F),W),Y=Math.pow(2,J),oe=[Y*v.x,Y*v.y,0],he=[Y*w.x,Y*w.y,0],Pe=Math.hypot(w.x-v.x,w.y-v.y),Ee=Math.abs(w.z-v.z),Ae=Math.hypot(Pe,Ee),Fe=Ye=>({zoom:0,x:0,y:0,wrap:Ye,fullyVisible:!1}),He=[],Ne=[];if(b.renderWorldCopies&&P.allowWorldCopies())for(let Ye=1;Ye<=3;Ye++)He.push(Fe(-Ye)),He.push(Fe(Ye));for(He.push(Fe(0));He.length>0;){const Ye=He.pop(),Ke=Ye.x,Ue=Ye.y;let rt=Ye.fullyVisible;const yt={x:Ke,y:Ue,z:Ye.zoom},ht=P.getTileBoundingVolume(yt,Ye.wrap,b.elevation,o);if(!rt){const rn=Te(u,ht,m);if(rn===0)continue;rt=rn===2}const pt=P.distanceToTile2d(v.x,v.y,yt,ht);let _t=F;k&&(_t=(o.calculateTileZoom||xe)(b.zoom+s.aj(b.tileSize/o.tileSize),pt,Ee,Ae,b.fov)),_t=(o.roundZoom?Math.round:Math.floor)(_t),_t=Math.max(0,_t);const sn=Math.min(_t,W);if(Ye.wrap=P.getWrap(w,yt,Ye.wrap),Ye.zoom>=sn){if(Ye.zoom<j)continue;const rn=J-Ye.zoom,Vt=oe[0]-.5-(Ke<<rn),Mn=oe[1]-.5-(Ue<<rn),Kn=o.reparseOverscaled?Math.max(Ye.zoom,_t):Ye.zoom;Ne.push({tileID:new s.Z(Ye.zoom===W?Kn:Ye.zoom,Ye.wrap,Ye.zoom,Ke,Ue),distanceSq:s.ak([he[0]-.5-Ke,he[1]-.5-Ue]),tileDistanceToCamera:Math.sqrt(Vt*Vt+Mn*Mn)})}else for(let rn=0;rn<4;rn++)He.push({zoom:Ye.zoom+1,x:(Ke<<1)+rn%2,y:(Ue<<1)+(rn>>1),wrap:Ye.wrap,fullyVisible:rt})}return Ne.sort((Ye,Ke)=>Ye.distanceSq-Ke.distanceSq).map(Ye=>Ye.tileID)}const ze=s.a1.fromPoints([new s.P(0,0),new s.P(s.$,s.$)]);class Je extends s.E{constructor(o,u,m){super(),this.id=o,this.dispatcher=m,this.on("data",v=>this._dataHandler(v)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((v,w,P,k)=>{const F=new(it(w.type))(v,w,P,k);if(F.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${F.id}`);return F})(o,u,m,this),this._tiles={},this._cache=new kt(0,v=>this._unloadTile(v)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new bn,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,u,m){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,u,m)}catch(v){o.state="errored",v.status!==404?this._source.fire(new s.k(v,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new s.l("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const m=this._tiles[u];m.upload(o),m.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Oe).map(o=>o.key)}getRenderableIds(o){const u=[];for(const m in this._tiles)this._isIdRenderable(m,o)&&u.push(this._tiles[m]);return o?u.sort((m,v)=>{const w=m.tileID,P=v.tileID,k=new s.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),F=new s.P(P.canonical.x,P.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-P.overscaledZ||F.y-k.y||F.x-k.x}).map(m=>m.tileID.key):u.map(m=>m.tileID).sort(Oe).map(m=>m.key)}hasRenderableParent(o){const u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())}reload(o){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)o?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(o,u){return s._(this,void 0,void 0,function*(){const m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=u),yield this._loadTile(m,o,u))})}_tileLoaded(o,u,m){o.timeAdded=C.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const u=this.getRenderableIds();for(let v=0;v<u.length;v++){const w=u[v];if(o.neighboringTiles&&o.neighboringTiles[w]){const P=this.getTileByID(w);m(o,P),m(P,o)}}function m(v,w){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let P=w.tileID.canonical.x-v.tileID.canonical.x;const k=w.tileID.canonical.y-v.tileID.canonical.y,F=Math.pow(2,v.tileID.canonical.z),j=w.tileID.key;P===0&&k===0||Math.abs(k)>1||(Math.abs(P)>1&&(Math.abs(P+F)===1?P+=F:Math.abs(P-F)===1&&(P-=F)),w.dem&&v.dem&&(v.dem.backfillBorder(w.dem,P,k),v.neighboringTiles&&v.neighboringTiles[j]&&(v.neighboringTiles[j].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,u,m,v){for(const w in this._tiles){let P=this._tiles[w];if(v[w]||!P.hasData()||P.tileID.overscaledZ<=u||P.tileID.overscaledZ>m)continue;let k=P.tileID;for(;P&&P.tileID.overscaledZ>u+1;){const j=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[j.key],P&&P.hasData()&&(k=j)}let F=k;for(;F.overscaledZ>u;)if(F=F.scaledTo(F.overscaledZ-1),o[F.key]||o[F.canonical.key]){v[k.key]=k;break}}}findLoadedParent(o,u){if(o.key in this._loadedParentTiles){const m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=u?m:null}for(let m=o.overscaledZ-1;m>=u;m--){const v=o.scaledTo(m),w=this._getLoadedTile(v);if(w)return w}}findLoadedSibling(o){return this._getLoadedTile(o)}_getLoadedTile(o){const u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const u=Math.ceil(o.width/this._source.tileSize)+1,m=Math.ceil(o.height/this._source.tileSize)+1,v=Math.floor(u*m*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(w)}handleWrapJump(o){const u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){const m={};for(const v in this._tiles){const w=this._tiles[v];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+u),m[w.tileID.key]=w}this._tiles=m;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}_updateCoveredAndRetainedTiles(o,u,m,v,w,P){const k={},F={},j=Object.keys(o),W=C.now();for(const J of j){const Y=o[J],oe=this._tiles[J];if(!oe||oe.fadeEndTime!==0&&oe.fadeEndTime<=W)continue;const he=this.findLoadedParent(Y,u),Pe=this.findLoadedSibling(Y),Ee=he||Pe||null;Ee&&(this._addTile(Ee.tileID),k[Ee.tileID.key]=Ee.tileID),F[J]=Y}this._retainLoadedChildren(F,v,m,o);for(const J in k)o[J]||(this._coveredTiles[J]=!0,o[J]=k[J]);if(P){const J={},Y={};for(const oe of w)this._tiles[oe.key].hasData()?J[oe.key]=oe:Y[oe.key]=oe;for(const oe in Y){const he=Y[oe].children(this._source.maxzoom);this._tiles[he[0].key]&&this._tiles[he[1].key]&&this._tiles[he[2].key]&&this._tiles[he[3].key]&&(J[he[0].key]=o[he[0].key]=he[0],J[he[1].key]=o[he[1].key]=he[1],J[he[2].key]=o[he[2].key]=he[2],J[he[3].key]=o[he[3].key]=he[3],delete Y[oe])}for(const oe in Y){const he=Y[oe],Pe=this.findLoadedParent(he,this._source.minzoom),Ee=this.findLoadedSibling(he),Ae=Pe||Ee||null;if(Ae){J[Ae.tileID.key]=o[Ae.tileID.key]=Ae.tileID;for(const Fe in J)J[Fe].isChildOf(Ae.tileID)&&delete J[Fe]}}for(const oe in this._tiles)J[oe]||(this._coveredTiles[oe]=!0)}}update(o,u){if(!this._sourceLoaded||this._paused)return;let m;this.transform=o,this.terrain=u,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new s.Z(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y)):(m=De(o,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(m=m.filter(W=>this._source.hasTile(W)))):m=[];const v=Re(o,this._source),w=Math.max(v-Je.maxOverzooming,this._source.minzoom),P=Math.max(v+Je.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const W={};for(const J of m)if(J.canonical.z>this._source.minzoom){const Y=J.scaledTo(J.canonical.z-1);W[Y.key]=Y;const oe=J.scaledTo(Math.max(this._source.minzoom,Math.min(J.canonical.z,5)));W[oe.key]=oe}m=m.concat(Object.values(W))}const k=m.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,k&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const F=this._updateRetainedTiles(m,v);Et(this._source.type)&&this._updateCoveredAndRetainedTiles(F,w,P,v,m,u);for(const W in F)this._tiles[W].clearFadeHold();const j=s.al(this._tiles,F);for(const W of j){const J=this._tiles[W];J.hasSymbolBuckets&&!J.holdingForFade()?J.setHoldDuration(this.map._fadeDuration):J.hasSymbolBuckets&&!J.symbolFadeFinished()||this._removeTile(W)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,u){var m;const v={},w={},P=Math.max(u-Je.maxOverzooming,this._source.minzoom),k=Math.max(u+Je.maxUnderzooming,this._source.minzoom),F={};for(const j of o){const W=this._addTile(j);v[j.key]=j,W.hasData()||u<this._source.maxzoom&&(F[j.key]=j)}this._retainLoadedChildren(F,u,k,v);for(const j of o){let W=this._tiles[j.key];if(W.hasData())continue;if(u+1>this._source.maxzoom){const Y=j.children(this._source.maxzoom)[0],oe=this.getTile(Y);if(oe&&oe.hasData()){v[Y.key]=Y;continue}}else{const Y=j.children(this._source.maxzoom);if(v[Y[0].key]&&v[Y[1].key]&&v[Y[2].key]&&v[Y[3].key])continue}let J=W.wasRequested();for(let Y=j.overscaledZ-1;Y>=P;--Y){const oe=j.scaledTo(Y);if(w[oe.key])break;if(w[oe.key]=!0,W=this.getTile(oe),!W&&J&&(W=this._addTile(oe)),W){const he=W.hasData();if((he||!(!((m=this.map)===null||m===void 0)&&m.cancelPendingTileRequestsWhileZooming)||J)&&(v[oe.key]=oe),J=W.wasRequested(),he)break}}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const u=[];let m,v=this._tiles[o].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){m=this._loadedParentTiles[v.key];break}u.push(v.key);const w=v.scaledTo(v.overscaledZ-1);if(m=this._getLoadedTile(w),m)break;v=w}for(const w of u)this._loadedParentTiles[w]=m}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const o in this._tiles){const u=this._tiles[o].tileID,m=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=m}}_addTile(o){let u=this._tiles[o.key];if(u)return u;u=this._cache.getAndRemove(o),u&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));const m=u;return u||(u=new Lt(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,o.key,u.state)),u.uses++,this._tiles[o.key]=u,m||this._source.fire(new s.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(o,u){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const m=u.getExpiryTimeout();m&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},m))}refreshTiles(o){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&o.some(m=>m.equals(this._tiles[u].tileID.canonical))&&this._reloadTile(u,"expired")}_removeTile(o){const u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(o){const u=o.sourceDataType;o.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&o.dataType==="source"&&u==="content"&&(this.reload(o.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,u,m){const v=[],w=this.transform;if(!w)return v;const P=w.getCoveringTilesDetailsProvider().allowWorldCopies(),k=m?w.getCameraQueryGeometry(o):o,F=oe=>w.screenPointToMercatorCoordinate(oe,this.terrain),j=this.transformBbox(o,F,!P),W=this.transformBbox(k,F,!P),J=this.getIds(),Y=s.a1.fromPoints(W);for(let oe=0;oe<J.length;oe++){const he=this._tiles[J[oe]];if(he.holdingForFade())continue;const Pe=P?[he.tileID]:[he.tileID.unwrapTo(-1),he.tileID.unwrapTo(0)],Ee=Math.pow(2,w.zoom-he.tileID.overscaledZ),Ae=u*he.queryPadding*s.$/he.tileSize/Ee;for(const Fe of Pe){const He=Y.map(Ne=>Fe.getTilePoint(new s.a0(Ne.x,Ne.y)));if(He.expandBy(Ae),He.intersects(ze)){const Ne=j.map(Ke=>Fe.getTilePoint(Ke)),Ye=W.map(Ke=>Fe.getTilePoint(Ke));v.push({tile:he,tileID:P?Fe:Fe.unwrapTo(0),queryGeometry:Ne,cameraQueryGeometry:Ye,scale:Ee})}}}return v}transformBbox(o,u,m){let v=o.map(u);if(m){const w=s.a1.fromPoints(o);w.shrinkBy(.001*Math.min(w.width(),w.height()));const P=w.map(u);s.a1.fromPoints(v).covers(P)||(v=v.map(k=>k.x>.5?new s.a0(k.x-1,k.y,k.z):k))}return v}getVisibleCoordinates(o){const u=this.getRenderableIds(o).map(m=>this._tiles[m].tileID);return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(Et(this._source.type)){const o=C.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=o)return!0}return!1}setFeatureState(o,u,m){this._state.updateState(o=o||"_geojsonTileLayer",u,m)}removeFeatureState(o,u,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,m)}getFeatureState(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)}setDependencies(o,u,m){const v=this._tiles[o];v&&v.setDependencies(u,m)}reloadTilesForDependencies(o,u){for(const m in this._tiles)this._tiles[m].hasDependency(o,u)&&this._reloadTile(m,"reloading");this._cache.filter(m=>!m.hasDependency(o,u))}}function Oe(b,o){const u=Math.abs(2*b.wrap)-+(b.wrap<0),m=Math.abs(2*o.wrap)-+(o.wrap<0);return b.overscaledZ-o.overscaledZ||m-u||o.canonical.y-b.canonical.y||o.canonical.x-b.canonical.x}function Et(b){return b==="raster"||b==="image"||b==="video"}Je.maxOverzooming=10,Je.maxUnderzooming=3;class Ft{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=s.ag(o,0,1);let u=1,m=this._distances[u];const v=o*this.paddedLength+this.padding;for(;m<v&&u<this._distances.length;)m=this._distances[++u];const w=u-1,P=this._distances[w],k=m-P,F=k>0?(v-P)/k:0;return this.points[w].mult(1-F).add(this.points[u].mult(F))}}function be(b,o){let u=!0;return b==="always"||b!=="never"&&o!=="never"||(u=!1),u}class qe{constructor(o,u,m){const v=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(o/m),this.yCellCount=Math.ceil(u/m);for(let P=0;P<this.xCellCount*this.yCellCount;P++)v.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,m,v,w){this._forEachCell(u,m,v,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(w)}insertCircle(o,u,m,v){this._forEachCell(u-v,m-v,u+v,m+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(m),this.circles.push(v)}_insertBoxCell(o,u,m,v,w,P){this.boxCells[w].push(P)}_insertCircleCell(o,u,m,v,w,P){this.circleCells[w].push(P)}_query(o,u,m,v,w,P,k){if(m<0||o>this.width||v<0||u>this.height)return[];const F=[];if(o<=0&&u<=0&&this.width<=m&&this.height<=v){if(w)return[{key:null,x1:o,y1:u,x2:m,y2:v}];for(let j=0;j<this.boxKeys.length;j++)F.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const W=this.circles[3*j],J=this.circles[3*j+1],Y=this.circles[3*j+2];F.push({key:this.circleKeys[j],x1:W-Y,y1:J-Y,x2:W+Y,y2:J+Y})}}else this._forEachCell(o,u,m,v,this._queryCell,F,{hitTest:w,overlapMode:P,seenUids:{box:{},circle:{}}},k);return F}query(o,u,m,v){return this._query(o,u,m,v,!1,null)}hitTest(o,u,m,v,w,P){return this._query(o,u,m,v,!0,w,P).length>0}hitTestCircle(o,u,m,v,w){const P=o-m,k=o+m,F=u-m,j=u+m;if(k<0||P>this.width||j<0||F>this.height)return!1;const W=[];return this._forEachCell(P,F,k,j,this._queryCellCircle,W,{hitTest:!0,overlapMode:v,circle:{x:o,y:u,radius:m},seenUids:{box:{},circle:{}}},w),W.length>0}_queryCell(o,u,m,v,w,P,k,F){const{seenUids:j,hitTest:W,overlapMode:J}=k,Y=this.boxCells[w];if(Y!==null){const he=this.bboxes;for(const Pe of Y)if(!j.box[Pe]){j.box[Pe]=!0;const Ee=4*Pe,Ae=this.boxKeys[Pe];if(o<=he[Ee+2]&&u<=he[Ee+3]&&m>=he[Ee+0]&&v>=he[Ee+1]&&(!F||F(Ae))&&(!W||!be(J,Ae.overlapMode))&&(P.push({key:Ae,x1:he[Ee],y1:he[Ee+1],x2:he[Ee+2],y2:he[Ee+3]}),W))return!0}}const oe=this.circleCells[w];if(oe!==null){const he=this.circles;for(const Pe of oe)if(!j.circle[Pe]){j.circle[Pe]=!0;const Ee=3*Pe,Ae=this.circleKeys[Pe];if(this._circleAndRectCollide(he[Ee],he[Ee+1],he[Ee+2],o,u,m,v)&&(!F||F(Ae))&&(!W||!be(J,Ae.overlapMode))){const Fe=he[Ee],He=he[Ee+1],Ne=he[Ee+2];if(P.push({key:Ae,x1:Fe-Ne,y1:He-Ne,x2:Fe+Ne,y2:He+Ne}),W)return!0}}}return!1}_queryCellCircle(o,u,m,v,w,P,k,F){const{circle:j,seenUids:W,overlapMode:J}=k,Y=this.boxCells[w];if(Y!==null){const he=this.bboxes;for(const Pe of Y)if(!W.box[Pe]){W.box[Pe]=!0;const Ee=4*Pe,Ae=this.boxKeys[Pe];if(this._circleAndRectCollide(j.x,j.y,j.radius,he[Ee+0],he[Ee+1],he[Ee+2],he[Ee+3])&&(!F||F(Ae))&&!be(J,Ae.overlapMode))return P.push(!0),!0}}const oe=this.circleCells[w];if(oe!==null){const he=this.circles;for(const Pe of oe)if(!W.circle[Pe]){W.circle[Pe]=!0;const Ee=3*Pe,Ae=this.circleKeys[Pe];if(this._circlesCollide(he[Ee],he[Ee+1],he[Ee+2],j.x,j.y,j.radius)&&(!F||F(Ae))&&!be(J,Ae.overlapMode))return P.push(!0),!0}}}_forEachCell(o,u,m,v,w,P,k,F){const j=this._convertToXCellCoord(o),W=this._convertToYCellCoord(u),J=this._convertToXCellCoord(m),Y=this._convertToYCellCoord(v);for(let oe=j;oe<=J;oe++)for(let he=W;he<=Y;he++)if(w.call(this,o,u,m,v,this.xCellCount*he+oe,P,k,F))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,m,v,w,P){const k=v-o,F=w-u,j=m+P;return j*j>k*k+F*F}_circleAndRectCollide(o,u,m,v,w,P,k){const F=(P-v)/2,j=Math.abs(o-(v+F));if(j>F+m)return!1;const W=(k-w)/2,J=Math.abs(u-(w+W));if(J>W+m)return!1;if(j<=F||J<=W)return!0;const Y=j-F,oe=J-W;return Y*Y+oe*oe<=m*m}}function tt(b,o,u){const m=s.L();if(!b){const{vecSouth:J,vecEast:Y}=Ht(o),oe=g();oe[0]=Y[0],oe[1]=Y[1],oe[2]=J[0],oe[3]=J[1],v=oe,(W=(P=(w=oe)[0])*(j=w[3])-(F=w[2])*(k=w[1]))&&(v[0]=j*(W=1/W),v[1]=-k*W,v[2]=-F*W,v[3]=P*W),m[0]=oe[0],m[1]=oe[1],m[4]=oe[2],m[5]=oe[3]}var v,w,P,k,F,j,W;return s.N(m,m,[1/u,1/u,1]),m}function At(b,o,u,m){if(b){const v=s.L();if(!o){const{vecSouth:w,vecEast:P}=Ht(u);v[0]=P[0],v[1]=P[1],v[4]=w[0],v[5]=w[1]}return s.N(v,v,[m,m,1]),v}return u.pixelsToClipSpaceMatrix}function Ht(b){const o=Math.cos(b.rollInRadians),u=Math.sin(b.rollInRadians),m=Math.cos(b.pitchInRadians),v=Math.cos(b.bearingInRadians),w=Math.sin(b.bearingInRadians),P=s.aq();P[0]=-v*m*u-w*o,P[1]=-w*m*u+v*o;const k=s.ar(P);k<1e-9?s.as(P):s.at(P,P,1/k);const F=s.aq();F[0]=v*m*o-w*u,F[1]=w*m*o+v*u;const j=s.ar(F);return j<1e-9?s.as(F):s.at(F,F,1/j),{vecEast:F,vecSouth:P}}function Yt(b,o,u,m){let v;m?(v=[b,o,m(b,o),1],s.av(v,v,u)):(v=[b,o,0,1],vt(v,v,u));const w=v[3];return{point:new s.P(v[0]/w,v[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function qt(b,o){return .5+b/o*.5}function Gt(b,o){return b.x>=-o[0]&&b.x<=o[0]&&b.y>=-o[1]&&b.y<=o[1]}function yn(b,o,u,m,v,w,P,k,F,j,W,J,Y){const oe=u?b.textSizeData:b.iconSizeData,he=s.am(oe,o.transform.zoom),Pe=[256/o.width*2+1,256/o.height*2+1],Ee=u?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;Ee.clear();const Ae=b.lineVertexArray,Fe=u?b.text.placedSymbolArray:b.icon.placedSymbolArray,He=o.transform.width/o.transform.height;let Ne=!1;for(let Ye=0;Ye<Fe.length;Ye++){const Ke=Fe.get(Ye);if(Ke.hidden||Ke.writingMode===s.an.vertical&&!Ne){nt(Ke.numGlyphs,Ee);continue}Ne=!1;const Ue=new s.P(Ke.anchorX,Ke.anchorY),rt={getElevation:Y,pitchedLabelPlaneMatrix:m,lineVertexArray:Ae,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:o.transform,tileAnchorPoint:Ue,unwrappedTileID:F,width:j,height:W,translation:J},yt=Wt(Ke.anchorX,Ke.anchorY,rt);if(!Gt(yt.point,Pe)){nt(Ke.numGlyphs,Ee);continue}const ht=qt(o.transform.cameraToCenterDistance,yt.signedDistanceFromCamera),pt=s.ao(oe,he,Ke),_t=w?pt*o.transform.getPitchedTextCorrection(Ke.anchorX,Ke.anchorY,F)/ht:pt*ht,sn=cn({projectionContext:rt,pitchedLabelPlaneMatrixInverse:v,symbol:Ke,fontSize:_t,flip:!1,keepUpright:P,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:Ee,aspectRatio:He,rotateToLine:k});Ne=sn.useVertical,(sn.notEnoughRoom||Ne||sn.needsFlipping&&cn({projectionContext:rt,pitchedLabelPlaneMatrixInverse:v,symbol:Ke,fontSize:_t,flip:!0,keepUpright:P,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:Ee,aspectRatio:He,rotateToLine:k}).notEnoughRoom)&&nt(Ke.numGlyphs,Ee)}u?b.text.dynamicLayoutVertexBuffer.updateData(Ee):b.icon.dynamicLayoutVertexBuffer.updateData(Ee)}function gt(b,o,u,m,v,w,P,k){const F=w.glyphStartIndex+w.numGlyphs,j=w.lineStartIndex,W=w.lineStartIndex+w.lineLength,J=o.getoffsetX(w.glyphStartIndex),Y=o.getoffsetX(F-1),oe=qn(b*J,u,m,v,w.segment,j,W,k,P);if(!oe)return null;const he=qn(b*Y,u,m,v,w.segment,j,W,k,P);return he?k.projectionCache.anyProjectionOccluded?null:{first:oe,last:he}:null}function In(b,o,u,m){return b===s.an.horizontal&&Math.abs(u.y-o.y)>Math.abs(u.x-o.x)*m?{useVertical:!0}:(b===s.an.vertical?o.y<u.y:o.x>u.x)?{needsFlipping:!0}:null}function cn(b){const{projectionContext:o,pitchedLabelPlaneMatrixInverse:u,symbol:m,fontSize:v,flip:w,keepUpright:P,glyphOffsetArray:k,dynamicLayoutVertexArray:F,aspectRatio:j,rotateToLine:W}=b,J=v/24,Y=m.lineOffsetX*J,oe=m.lineOffsetY*J;let he;if(m.numGlyphs>1){const Pe=m.glyphStartIndex+m.numGlyphs,Ee=m.lineStartIndex,Ae=m.lineStartIndex+m.lineLength,Fe=gt(J,k,Y,oe,w,m,W,o);if(!Fe)return{notEnoughRoom:!0};const He=Rt(Fe.first.point.x,Fe.first.point.y,o,u),Ne=Rt(Fe.last.point.x,Fe.last.point.y,o,u);if(P&&!w){const Ye=In(m.writingMode,He,Ne,j);if(Ye)return Ye}he=[Fe.first];for(let Ye=m.glyphStartIndex+1;Ye<Pe-1;Ye++){const Ke=qn(J*k.getoffsetX(Ye),Y,oe,w,m.segment,Ee,Ae,o,W);if(!Ke)return{notEnoughRoom:!0};he.push(Ke)}he.push(Fe.last)}else{if(P&&!w){const Ee=Ze(o.tileAnchorPoint.x,o.tileAnchorPoint.y,o).point,Ae=m.lineStartIndex+m.segment+1,Fe=new s.P(o.lineVertexArray.getx(Ae),o.lineVertexArray.gety(Ae)),He=Ze(Fe.x,Fe.y,o),Ne=He.signedDistanceFromCamera>0?He.point:Nn(o.tileAnchorPoint,Fe,Ee,1,o),Ye=Rt(Ee.x,Ee.y,o,u),Ke=Rt(Ne.x,Ne.y,o,u),Ue=In(m.writingMode,Ye,Ke,j);if(Ue)return Ue}const Pe=qn(J*k.getoffsetX(m.glyphStartIndex),Y,oe,w,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,o,W);if(!Pe||o.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};he=[Pe]}for(const Pe of he)s.au(F,Pe.point,Pe.angle);return{}}function Nn(b,o,u,m,v){const w=b.add(b.sub(o)._unit()),P=Ze(w.x,w.y,v).point,k=u.sub(P);return u.add(k._mult(m/k.mag()))}function xt(b,o,u){const m=o.projectionCache;if(m.projections[b])return m.projections[b];const v=new s.P(o.lineVertexArray.getx(b),o.lineVertexArray.gety(b)),w=Ze(v.x,v.y,o);if(w.signedDistanceFromCamera>0)return m.projections[b]=w.point,m.anyProjectionOccluded=m.anyProjectionOccluded||w.isOccluded,w.point;const P=b-u.direction;return Nn(u.distanceFromAnchor===0?o.tileAnchorPoint:new s.P(o.lineVertexArray.getx(P),o.lineVertexArray.gety(P)),v,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,o)}function Ze(b,o,u){const m=b+u.translation[0],v=o+u.translation[1];let w;return u.pitchWithMap?(w=Yt(m,v,u.pitchedLabelPlaneMatrix,u.getElevation),w.isOccluded=!1):(w=u.transform.projectTileCoordinates(m,v,u.unwrappedTileID,u.getElevation),w.point.x=(.5*w.point.x+.5)*u.width,w.point.y=(.5*-w.point.y+.5)*u.height),w}function Rt(b,o,u,m){if(u.pitchWithMap){const v=[b,o,0,1];return s.av(v,v,m),u.transform.projectTileCoordinates(v[0]/v[3],v[1]/v[3],u.unwrappedTileID,u.getElevation).point}return{x:b/u.width*2-1,y:1-o/u.height*2}}function Wt(b,o,u){return u.transform.projectTileCoordinates(b,o,u.unwrappedTileID,u.getElevation)}function pn(b,o,u){return b._unit()._perp()._mult(o*u)}function cr(b,o,u,m,v,w,P,k,F){if(k.projectionCache.offsets[b])return k.projectionCache.offsets[b];const j=u.add(o);if(b+F.direction<m||b+F.direction>=v)return k.projectionCache.offsets[b]=j,j;const W=xt(b+F.direction,k,F),J=pn(W.sub(u),P,F.direction),Y=u.add(J),oe=W.add(J);return k.projectionCache.offsets[b]=s.aw(w,j,Y,oe)||j,k.projectionCache.offsets[b]}function qn(b,o,u,m,v,w,P,k,F){const j=m?b-o:b+o;let W=j>0?1:-1,J=0;m&&(W*=-1,J=Math.PI),W<0&&(J+=Math.PI);let Y,oe=W>0?w+v:w+v+1;k.projectionCache.cachedAnchorPoint?Y=k.projectionCache.cachedAnchorPoint:(Y=Ze(k.tileAnchorPoint.x,k.tileAnchorPoint.y,k).point,k.projectionCache.cachedAnchorPoint=Y);let he,Pe,Ee=Y,Ae=Y,Fe=0,He=0;const Ne=Math.abs(j),Ye=[];let Ke;for(;Fe+He<=Ne;){if(oe+=W,oe<w||oe>=P)return null;Fe+=He,Ae=Ee,Pe=he;const yt={absOffsetX:Ne,direction:W,distanceFromAnchor:Fe,previousVertex:Ae};if(Ee=xt(oe,k,yt),u===0)Ye.push(Ae),Ke=Ee.sub(Ae);else{let ht;const pt=Ee.sub(Ae);ht=pt.mag()===0?pn(xt(oe+W,k,yt).sub(Ee),u,W):pn(pt,u,W),Pe||(Pe=Ae.add(ht)),he=cr(oe,ht,Ee,w,P,Pe,u,k,yt),Ye.push(Pe),Ke=he.sub(Pe)}He=Ke.mag()}const Ue=Ke._mult((Ne-Fe)/He)._add(Pe||Ae),rt=J+Math.atan2(Ee.y-Ae.y,Ee.x-Ae.x);return Ye.push(Ue),{point:Ue,angle:F?rt:0,path:Ye}}const pe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function nt(b,o){for(let u=0;u<b;u++){const m=o.length;o.resize(m+4),o.float32.set(pe,3*m)}}function vt(b,o,u){const m=o[0],v=o[1];return b[0]=u[0]*m+u[4]*v+u[12],b[1]=u[1]*m+u[5]*v+u[13],b[3]=u[3]*m+u[7]*v+u[15],b}const ft=100;class at{constructor(o,u=new qe(o.width+200,o.height+200,25),m=new qe(o.width+200,o.height+200,25)){this.transform=o,this.grid=u,this.ignoredGrid=m,this.pitchFactor=Math.cos(o.pitch*Math.PI/180)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+ft,this.screenBottomBoundary=o.height+ft,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,u,m,v,w,P,k,F,j,W,J,Y){const oe=this.projectAndGetPerspectiveRatio(o.anchorPointX+F[0],o.anchorPointY+F[1],w,W,Y),he=m*oe.perspectiveRatio;let Pe;if(P||k)Pe=this._projectCollisionBox(o,he,v,w,P,k,F,oe,W,J,Y);else{const Ke=oe.x+(J?J.x*he:0),Ue=oe.y+(J?J.y*he:0);Pe={allPointsOccluded:!1,box:[Ke+o.x1*he,Ue+o.y1*he,Ke+o.x2*he,Ue+o.y2*he]}}const[Ee,Ae,Fe,He]=Pe.box,Ne=P?Pe.allPointsOccluded:oe.isOccluded;let Ye=Ne;return Ye||(Ye=oe.perspectiveRatio<this.perspectiveRatioCutoff),Ye||(Ye=!this.isInsideGrid(Ee,Ae,Fe,He)),Ye||u!=="always"&&this.grid.hitTest(Ee,Ae,Fe,He,u,j)?{box:[Ee,Ae,Fe,He],placeable:!1,offscreen:!1,occluded:Ne}:{box:[Ee,Ae,Fe,He],placeable:!0,offscreen:this.isOffscreen(Ee,Ae,Fe,He),occluded:Ne}}placeCollisionCircles(o,u,m,v,w,P,k,F,j,W,J,Y,oe,he){const Pe=[],Ee=new s.P(u.anchorX,u.anchorY),Ae=this.getPerspectiveRatio(Ee.x,Ee.y,P,he),Fe=(j?w*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,P)/Ae:w*Ae)/s.aA,He={getElevation:he,pitchedLabelPlaneMatrix:k,lineVertexArray:m,pitchWithMap:j,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Ee,unwrappedTileID:P,width:this.transform.width,height:this.transform.height,translation:oe},Ne=gt(Fe,v,u.lineOffsetX*Fe,u.lineOffsetY*Fe,!1,u,!1,He);let Ye=!1,Ke=!1,Ue=!0;if(Ne){const rt=.5*J*Ae+Y,yt=new s.P(-100,-100),ht=new s.P(this.screenRightBoundary,this.screenBottomBoundary),pt=new Ft,_t=Ne.first,sn=Ne.last;let rn=[];for(let Kn=_t.path.length-1;Kn>=1;Kn--)rn.push(_t.path[Kn]);for(let Kn=1;Kn<sn.path.length;Kn++)rn.push(sn.path[Kn]);const Vt=2.5*rt;if(j){const Kn=this.projectPathToScreenSpace(rn,He);rn=Kn.some(Mr=>Mr.signedDistanceFromCamera<=0)?[]:Kn.map(Mr=>Mr.point)}let Mn=[];if(rn.length>0){const Kn=rn[0].clone(),Mr=rn[0].clone();for(let ti=1;ti<rn.length;ti++)Kn.x=Math.min(Kn.x,rn[ti].x),Kn.y=Math.min(Kn.y,rn[ti].y),Mr.x=Math.max(Mr.x,rn[ti].x),Mr.y=Math.max(Mr.y,rn[ti].y);Mn=Kn.x>=yt.x&&Mr.x<=ht.x&&Kn.y>=yt.y&&Mr.y<=ht.y?[rn]:Mr.x<yt.x||Kn.x>ht.x||Mr.y<yt.y||Kn.y>ht.y?[]:s.ax([rn],yt.x,yt.y,ht.x,ht.y)}for(const Kn of Mn){pt.reset(Kn,.25*rt);let Mr=0;Mr=pt.length<=.5*rt?1:Math.ceil(pt.paddedLength/Vt)+1;for(let ti=0;ti<Mr;ti++){const Pr=ti/Math.max(Mr-1,1),ni=pt.lerp(Pr),Dr=ni.x+ft,Ar=ni.y+ft;Pe.push(Dr,Ar,rt,0);const zr=Dr-rt,to=Ar-rt,ur=Dr+rt,Hi=Ar+rt;if(Ue=Ue&&this.isOffscreen(zr,to,ur,Hi),Ke=Ke||this.isInsideGrid(zr,to,ur,Hi),o!=="always"&&this.grid.hitTestCircle(Dr,Ar,rt,o,W)&&(Ye=!0,!F))return{circles:[],offscreen:!1,collisionDetected:Ye}}}}return{circles:!F&&Ye||!Ke||Ae<this.perspectiveRatioCutoff?[]:Pe,offscreen:Ue,collisionDetected:Ye}}projectPathToScreenSpace(o,u){const m=function(v,w){const P=s.L();return s.ap(P,w.pitchedLabelPlaneMatrix),v.map(k=>{const F=Yt(k.x,k.y,P,w.getElevation),j=w.transform.projectTileCoordinates(F.point.x,F.point.y,w.unwrappedTileID,w.getElevation);return j.point.x=(.5*j.point.x+.5)*w.width,j.point.y=(.5*-j.point.y+.5)*w.height,j})}(o,u);return function(v){let w=0,P=0,k=0,F=0;for(let j=0;j<v.length;j++)v[j].isOccluded?(k=j+1,F=0):(F++,F>P&&(P=F,w=k));return v.slice(w,w+P)}(m)}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],m=new s.a1;for(const J of o){const Y=new s.P(J.x+ft,J.y+ft);m.extend(Y),u.push(Y)}const{minX:v,minY:w,maxX:P,maxY:k}=m,F=this.grid.query(v,w,P,k).concat(this.ignoredGrid.query(v,w,P,k)),j={},W={};for(const J of F){const Y=J.key;if(j[Y.bucketInstanceId]===void 0&&(j[Y.bucketInstanceId]={}),j[Y.bucketInstanceId][Y.featureIndex])continue;const oe=[new s.P(J.x1,J.y1),new s.P(J.x2,J.y1),new s.P(J.x2,J.y2),new s.P(J.x1,J.y2)];s.ay(u,oe)&&(j[Y.bucketInstanceId][Y.featureIndex]=!0,W[Y.bucketInstanceId]===void 0&&(W[Y.bucketInstanceId]=[]),W[Y.bucketInstanceId].push(Y.featureIndex))}return W}insertCollisionBox(o,u,m,v,w,P){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:w,collisionGroupID:P,overlapMode:u},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,m,v,w,P){const k=m?this.ignoredGrid:this.grid,F={bucketInstanceId:v,featureIndex:w,collisionGroupID:P,overlapMode:u};for(let j=0;j<o.length;j+=4)k.insertCircle(F,o[j],o[j+1],o[j+2])}projectAndGetPerspectiveRatio(o,u,m,v,w){if(w){let P;v?(P=[o,u,v(o,u),1],s.av(P,P,w)):(P=[o,u,0,1],vt(P,P,w));const k=P[3];return{x:(P[0]/k+1)/2*this.transform.width+ft,y:(-P[1]/k+1)/2*this.transform.height+ft,perspectiveRatio:.5+this.transform.cameraToCenterDistance/k*.5,isOccluded:!1,signedDistanceFromCamera:k}}{const P=this.transform.projectTileCoordinates(o,u,m,v);return{x:(P.point.x+1)/2*this.transform.width+ft,y:(1-P.point.y)/2*this.transform.height+ft,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P.signedDistanceFromCamera*.5,isOccluded:P.isOccluded,signedDistanceFromCamera:P.signedDistanceFromCamera}}}getPerspectiveRatio(o,u,m,v){const w=this.transform.projectTileCoordinates(o,u,m,v);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(o,u,m,v){return m<ft||o>=this.screenRightBoundary||v<ft||u>this.screenBottomBoundary}isInsideGrid(o,u,m,v){return m>=0&&o<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=s.af([]);return s.M(o,o,[-100,-100,0]),o}_projectCollisionBox(o,u,m,v,w,P,k,F,j,W,J){let Y=1,oe=0,he=0,Pe=1;const Ee=o.anchorPointX+k[0],Ae=o.anchorPointY+k[1];if(P&&!w){const rn=this.projectAndGetPerspectiveRatio(Ee+1,Ae,v,j,J),Vt=rn.x-F.x,Mn=Math.atan((rn.y-F.y)/Vt)+(Vt<0?Math.PI:0),Kn=Math.sin(Mn),Mr=Math.cos(Mn);Y=Mr,oe=Kn,he=-Kn,Pe=Mr}else if(!P&&w){const rn=Ht(this.transform);Y=rn.vecEast[0],oe=rn.vecEast[1],he=rn.vecSouth[0],Pe=rn.vecSouth[1]}let Fe=F.x,He=F.y,Ne=u;w&&(Fe=Ee,He=Ae,Ne=Math.pow(2,-(this.transform.zoom-m.overscaledZ)),Ne*=this.transform.getPitchedTextCorrection(Ee,Ae,v),W||(Ne*=s.ag(.5+F.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),W&&(Fe+=Y*W.x*Ne+he*W.y*Ne,He+=oe*W.x*Ne+Pe*W.y*Ne);const Ye=o.x1*Ne,Ke=o.x2*Ne,Ue=(Ye+Ke)/2,rt=o.y1*Ne,yt=o.y2*Ne,ht=(rt+yt)/2,pt=[{offsetX:Ye,offsetY:rt},{offsetX:Ue,offsetY:rt},{offsetX:Ke,offsetY:rt},{offsetX:Ke,offsetY:ht},{offsetX:Ke,offsetY:yt},{offsetX:Ue,offsetY:yt},{offsetX:Ye,offsetY:yt},{offsetX:Ye,offsetY:ht}];let _t=[];for(const{offsetX:rn,offsetY:Vt}of pt)_t.push(new s.P(Fe+Y*rn+he*Vt,He+oe*rn+Pe*Vt));let sn=!1;if(w){const rn=_t.map(Vt=>this.projectAndGetPerspectiveRatio(Vt.x,Vt.y,v,j,J));sn=rn.some(Vt=>!Vt.isOccluded),_t=rn.map(Vt=>new s.P(Vt.x,Vt.y))}else sn=!0;return{box:s.az(_t),allPointsOccluded:!sn}}}class Kt{constructor(o,u,m,v){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):v&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class fn{constructor(o,u,m,v,w){this.text=new Kt(o?o.text:null,u,m,w),this.icon=new Kt(o?o.icon:null,u,v,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qt{constructor(o,u,m){this.text=o,this.icon=u,this.skipFade=m}}class ln{constructor(o,u,m,v,w){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=v,this.tileID=w}}class Nt{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[o]}}function zn(b,o,u,m,v){const{horizontalAlign:w,verticalAlign:P}=s.aG(b);return new s.P(-(w-.5)*o+m[0]*v,-(P-.5)*u+m[1]*v)}class _n{constructor(o,u,m,v,w){this.transform=o.clone(),this.terrain=u,this.collisionIndex=new at(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new Nt(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const u=this.terrain;return u?(m,v)=>u.getElevation(o,m,v):null}getBucketParts(o,u,m,v){const w=m.getBucket(u),P=m.latestFeatureIndex;if(!w||!P||u.id!==w.layerIds[0])return;const k=m.collisionBoxArray,F=w.layers[0].layout,j=w.layers[0].paint,W=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),J=m.tileSize/s.$,Y=m.tileID.toUnwrapped(),oe=F.get("text-rotation-alignment")==="map",he=s.aB(m,1,this.transform.zoom),Pe=s.aC(this.collisionIndex.transform,m,j.get("text-translate"),j.get("text-translate-anchor")),Ee=s.aC(this.collisionIndex.transform,m,j.get("icon-translate"),j.get("icon-translate-anchor")),Ae=tt(oe,this.transform,he);this.retainedQueryData[w.bucketInstanceId]=new ln(w.bucketInstanceId,P,w.sourceLayerIndex,w.index,m.tileID);const Fe={bucket:w,layout:F,translationText:Pe,translationIcon:Ee,unwrappedTileID:Y,pitchedLabelPlaneMatrix:Ae,scale:W,textPixelRatio:J,holdingForFade:m.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:s.am(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(v)for(const He of w.sortKeyRanges){const{sortKey:Ne,symbolInstanceStart:Ye,symbolInstanceEnd:Ke}=He;o.push({sortKey:Ne,symbolInstanceStart:Ye,symbolInstanceEnd:Ke,parameters:Fe})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Fe})}attemptAnchorPlacement(o,u,m,v,w,P,k,F,j,W,J,Y,oe,he,Pe,Ee,Ae,Fe,He,Ne){const Ye=s.aD[o.textAnchor],Ke=[o.textOffset0,o.textOffset1],Ue=zn(Ye,m,v,Ke,w),rt=this.collisionIndex.placeCollisionBox(u,Y,F,j,W,k,P,Ee,J.predicate,He,Ue,Ne);if((!Fe||this.collisionIndex.placeCollisionBox(Fe,Y,F,j,W,k,P,Ae,J.predicate,He,Ue,Ne).placeable)&&rt.placeable){let yt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[oe.crossTileID]&&this.prevPlacement.placements[oe.crossTileID]&&this.prevPlacement.placements[oe.crossTileID].text&&(yt=this.prevPlacement.variableOffsets[oe.crossTileID].anchor),oe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[oe.crossTileID]={textOffset:Ke,width:m,height:v,anchor:Ye,textBoxScale:w,prevAnchor:yt},this.markUsedJustification(he,Ye,oe,Pe),he.allowVerticalPlacement&&(this.markUsedOrientation(he,Pe,oe),this.placedOrientations[oe.crossTileID]=Pe),{shift:Ue,placedGlyphBoxes:rt}}}placeLayerBucketPart(o,u,m){const{bucket:v,layout:w,translationText:P,translationIcon:k,unwrappedTileID:F,pitchedLabelPlaneMatrix:j,textPixelRatio:W,holdingForFade:J,collisionBoxArray:Y,partiallyEvaluatedTextSize:oe,collisionGroup:he}=o.parameters,Pe=w.get("text-optional"),Ee=w.get("icon-optional"),Ae=s.aE(w,"text-overlap","text-allow-overlap"),Fe=Ae==="always",He=s.aE(w,"icon-overlap","icon-allow-overlap"),Ne=He==="always",Ye=w.get("text-rotation-alignment")==="map",Ke=w.get("text-pitch-alignment")==="map",Ue=w.get("icon-text-fit")!=="none",rt=w.get("symbol-z-order")==="viewport-y",yt=Fe&&(Ne||!v.hasIconData()||Ee),ht=Ne&&(Fe||!v.hasTextData()||Pe);!v.collisionArrays&&Y&&v.deserializeCollisionBoxes(Y);const pt=this.retainedQueryData[v.bucketInstanceId].tileID,_t=this._getTerrainElevationFunc(pt),sn=this.transform.getFastPathSimpleProjectionMatrix(pt),rn=(Vt,Mn,Kn)=>{var Mr,ti;if(u[Vt.crossTileID])return;if(J)return void(this.placements[Vt.crossTileID]=new Qt(!1,!1,!1));let Pr=!1,ni=!1,Dr=!0,Ar=null,zr={box:null,placeable:!1,offscreen:null,occluded:!1},to={placeable:!1},ur=null,Hi=null,no=null,Vl=0,jl=0,Hl=0;Mn.textFeatureIndex?Vl=Mn.textFeatureIndex:Vt.useRuntimeCollisionCircles&&(Vl=Vt.featureIndex),Mn.verticalTextFeatureIndex&&(jl=Mn.verticalTextFeatureIndex);const ka=Mn.textBox;if(ka){const Ko=hi=>{let Hr=s.an.horizontal;if(v.allowVerticalPlacement&&!hi&&this.prevPlacement){const Do=this.prevPlacement.placedOrientations[Vt.crossTileID];Do&&(this.placedOrientations[Vt.crossTileID]=Do,Hr=Do,this.markUsedOrientation(v,Hr,Vt))}return Hr},Qs=(hi,Hr)=>{if(v.allowVerticalPlacement&&Vt.numVerticalGlyphVertices>0&&Mn.verticalTextBox){for(const Do of v.writingModes)if(Do===s.an.vertical?(zr=Hr(),to=zr):zr=hi(),zr&&zr.placeable)break}else zr=hi()},Gl=Vt.textAnchorOffsetStartIndex,Lc=Vt.textAnchorOffsetEndIndex;if(Lc===Gl){const hi=(Hr,Do)=>{const Ri=this.collisionIndex.placeCollisionBox(Hr,Ae,W,pt,F,Ke,Ye,P,he.predicate,_t,void 0,sn);return Ri&&Ri.placeable&&(this.markUsedOrientation(v,Do,Vt),this.placedOrientations[Vt.crossTileID]=Do),Ri};Qs(()=>hi(ka,s.an.horizontal),()=>{const Hr=Mn.verticalTextBox;return v.allowVerticalPlacement&&Vt.numVerticalGlyphVertices>0&&Hr?hi(Hr,s.an.vertical):{box:null,offscreen:null}}),Ko(zr&&zr.placeable)}else{let hi=s.aD[(ti=(Mr=this.prevPlacement)===null||Mr===void 0?void 0:Mr.variableOffsets[Vt.crossTileID])===null||ti===void 0?void 0:ti.anchor];const Hr=(Ri,e1,jC)=>{const kv=Ri.x2-Ri.x1,zd=Ri.y2-Ri.y1,ju=Vt.textBoxScale,al=Ue&&He==="never"?e1:null;let ro=null,ll=Ae==="never"?1:2,Dv="never";hi&&ll++;for(let Wl=0;Wl<ll;Wl++){for(let zv=Gl;zv<Lc;zv++){const Ov=v.textAnchorOffsets.get(zv);if(hi&&Ov.textAnchor!==hi)continue;const Od=this.attemptAnchorPlacement(Ov,Ri,kv,zd,ju,Ye,Ke,W,pt,F,he,Dv,Vt,v,jC,P,k,al,_t);if(Od&&(ro=Od.placedGlyphBoxes,ro&&ro.placeable))return Pr=!0,Ar=Od.shift,ro}hi?hi=null:Dv=Ae}return m&&!ro&&(ro={box:this.collisionIndex.placeCollisionBox(ka,"always",W,pt,F,Ke,Ye,P,he.predicate,_t,void 0,sn).box,offscreen:!1,placeable:!1,occluded:!1}),ro};Qs(()=>Hr(ka,Mn.iconBox,s.an.horizontal),()=>{const Ri=Mn.verticalTextBox;return v.allowVerticalPlacement&&(!zr||!zr.placeable)&&Vt.numVerticalGlyphVertices>0&&Ri?Hr(Ri,Mn.verticalIconBox,s.an.vertical):{box:null,occluded:!0,offscreen:null}}),zr&&(Pr=zr.placeable,Dr=zr.offscreen);const Do=Ko(zr&&zr.placeable);if(!Pr&&this.prevPlacement){const Ri=this.prevPlacement.variableOffsets[Vt.crossTileID];Ri&&(this.variableOffsets[Vt.crossTileID]=Ri,this.markUsedJustification(v,Ri.anchor,Vt,Do))}}}if(ur=zr,Pr=ur&&ur.placeable,Dr=ur&&ur.offscreen,Vt.useRuntimeCollisionCircles){const Ko=v.text.placedSymbolArray.get(Vt.centerJustifiedTextSymbolIndex),Qs=s.ao(v.textSizeData,oe,Ko),Gl=w.get("text-padding");Hi=this.collisionIndex.placeCollisionCircles(Ae,Ko,v.lineVertexArray,v.glyphOffsetArray,Qs,F,j,m,Ke,he.predicate,Vt.collisionCircleDiameter,Gl,P,_t),Hi.circles.length&&Hi.collisionDetected&&!m&&s.w("Collisions detected, but collision boxes are not shown"),Pr=Fe||Hi.circles.length>0&&!Hi.collisionDetected,Dr=Dr&&Hi.offscreen}if(Mn.iconFeatureIndex&&(Hl=Mn.iconFeatureIndex),Mn.iconBox){const Ko=Qs=>this.collisionIndex.placeCollisionBox(Qs,He,W,pt,F,Ke,Ye,k,he.predicate,_t,Ue&&Ar?Ar:void 0,sn);to&&to.placeable&&Mn.verticalIconBox?(no=Ko(Mn.verticalIconBox),ni=no.placeable):(no=Ko(Mn.iconBox),ni=no.placeable),Dr=Dr&&no.offscreen}const kd=Pe||Vt.numHorizontalGlyphVertices===0&&Vt.numVerticalGlyphVertices===0,Dd=Ee||Vt.numIconVertices===0;kd||Dd?Dd?kd||(ni=ni&&Pr):Pr=ni&&Pr:ni=Pr=ni&&Pr;const Vu=ni&&no.placeable;if(Pr&&ur.placeable&&this.collisionIndex.insertCollisionBox(ur.box,Ae,w.get("text-ignore-placement"),v.bucketInstanceId,to&&to.placeable&&jl?jl:Vl,he.ID),Vu&&this.collisionIndex.insertCollisionBox(no.box,He,w.get("icon-ignore-placement"),v.bucketInstanceId,Hl,he.ID),Hi&&Pr&&this.collisionIndex.insertCollisionCircles(Hi.circles,Ae,w.get("text-ignore-placement"),v.bucketInstanceId,Vl,he.ID),m&&this.storeCollisionData(v.bucketInstanceId,Kn,Mn,ur,no,Hi),Vt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Vt.crossTileID]=new Qt((Pr||yt)&&!(ur!=null&&ur.occluded),(ni||ht)&&!(no!=null&&no.occluded),Dr||v.justReloaded),u[Vt.crossTileID]=!0};if(rt){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Vt=v.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Mn=Vt.length-1;Mn>=0;--Mn){const Kn=Vt[Mn];rn(v.symbolInstances.get(Kn),v.collisionArrays[Kn],Kn)}}else for(let Vt=o.symbolInstanceStart;Vt<o.symbolInstanceEnd;Vt++)rn(v.symbolInstances.get(Vt),v.collisionArrays[Vt],Vt);v.justReloaded=!1}storeCollisionData(o,u,m,v,w,P){if(m.textBox||m.iconBox){let k,F;this.collisionBoxArrays.has(o)?k=this.collisionBoxArrays.get(o):(k=new Map,this.collisionBoxArrays.set(o,k)),k.has(u)?F=k.get(u):(F={text:null,icon:null},k.set(u,F)),m.textBox&&(F.text=v.box),m.iconBox&&(F.icon=w.box)}if(P){let k=this.collisionCircleArrays[o];k===void 0&&(k=this.collisionCircleArrays[o]=[]);for(let F=0;F<P.circles.length;F+=4)k.push(P.circles[F+0]-ft),k.push(P.circles[F+1]-ft),k.push(P.circles[F+2]),k.push(P.collisionDetected?1:0)}}markUsedJustification(o,u,m,v){let w;w=v===s.an.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[s.aF(u)];const P=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const k of P)k>=0&&(o.text.placedSymbolArray.get(k).crossTileID=w>=0&&k!==w?0:m.crossTileID)}markUsedOrientation(o,u,m){const v=u===s.an.horizontal||u===s.an.horizontalOnly?u:0,w=u===s.an.vertical?u:0,P=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const k of P)o.text.placedSymbolArray.get(k).placedOrientation=v;m.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const v=u?u.symbolFadeChange(o):1,w=u?u.opacities:{},P=u?u.variableOffsets:{},k=u?u.placedOrientations:{};for(const F in this.placements){const j=this.placements[F],W=w[F];W?(this.opacities[F]=new fn(W,v,j.text,j.icon),m=m||j.text!==W.text.placed||j.icon!==W.icon.placed):(this.opacities[F]=new fn(null,v,j.text,j.icon,j.skipFade),m=m||j.text||j.icon)}for(const F in w){const j=w[F];if(!this.opacities[F]){const W=new fn(j,v,!1,!1);W.isHidden()||(this.opacities[F]=W,m=m||j.text.placed||j.icon.placed)}}for(const F in P)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=P[F]);for(const F in k)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=k[F]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");m?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u){const m={};for(const v of u){const w=v.getBucket(o);w&&v.latestFeatureIndex&&o.id===w.layerIds[0]&&this.updateBucketOpacities(w,v.tileID,m,v.collisionBoxArray)}}updateBucketOpacities(o,u,m,v){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const w=o.layers[0],P=w.layout,k=new fn(null,0,!1,!1,!0),F=P.get("text-allow-overlap"),j=P.get("icon-allow-overlap"),W=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),J=P.get("text-rotation-alignment")==="map",Y=P.get("text-pitch-alignment")==="map",oe=P.get("icon-text-fit")!=="none",he=new fn(null,0,F&&(j||!o.hasIconData()||P.get("icon-optional")),j&&(F||!o.hasTextData()||P.get("text-optional")),!0);!o.collisionArrays&&v&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(v);const Pe=(Ae,Fe,He)=>{for(let Ne=0;Ne<Fe/4;Ne++)Ae.opacityVertexArray.emplaceBack(He);Ae.hasVisibleVertices=Ae.hasVisibleVertices||He!==Ms},Ee=this.collisionBoxArrays.get(o.bucketInstanceId);for(let Ae=0;Ae<o.symbolInstances.length;Ae++){const Fe=o.symbolInstances.get(Ae),{numHorizontalGlyphVertices:He,numVerticalGlyphVertices:Ne,crossTileID:Ye}=Fe;let Ke=this.opacities[Ye];m[Ye]?Ke=k:Ke||(Ke=he,this.opacities[Ye]=Ke),m[Ye]=!0;const Ue=Fe.numIconVertices>0,rt=this.placedOrientations[Fe.crossTileID],yt=rt===s.an.vertical,ht=rt===s.an.horizontal||rt===s.an.horizontalOnly;if(He>0||Ne>0){const _t=Wo(Ke.text);Pe(o.text,He,yt?Ms:_t),Pe(o.text,Ne,ht?Ms:_t);const sn=Ke.text.isHidden();[Fe.rightJustifiedTextSymbolIndex,Fe.centerJustifiedTextSymbolIndex,Fe.leftJustifiedTextSymbolIndex].forEach(Mn=>{Mn>=0&&(o.text.placedSymbolArray.get(Mn).hidden=sn||yt?1:0)}),Fe.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(Fe.verticalPlacedTextSymbolIndex).hidden=sn||ht?1:0);const rn=this.variableOffsets[Fe.crossTileID];rn&&this.markUsedJustification(o,rn.anchor,Fe,rt);const Vt=this.placedOrientations[Fe.crossTileID];Vt&&(this.markUsedJustification(o,"left",Fe,Vt),this.markUsedOrientation(o,Vt,Fe))}if(Ue){const _t=Wo(Ke.icon),sn=!(oe&&Fe.verticalPlacedIconSymbolIndex&&yt);Fe.placedIconSymbolIndex>=0&&(Pe(o.icon,Fe.numIconVertices,sn?_t:Ms),o.icon.placedSymbolArray.get(Fe.placedIconSymbolIndex).hidden=Ke.icon.isHidden()),Fe.verticalPlacedIconSymbolIndex>=0&&(Pe(o.icon,Fe.numVerticalIconVertices,sn?Ms:_t),o.icon.placedSymbolArray.get(Fe.verticalPlacedIconSymbolIndex).hidden=Ke.icon.isHidden())}const pt=Ee&&Ee.has(Ae)?Ee.get(Ae):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const _t=o.collisionArrays[Ae];if(_t){let sn=new s.P(0,0);if(_t.textBox||_t.verticalTextBox){let rn=!0;if(W){const Vt=this.variableOffsets[Ye];Vt?(sn=zn(Vt.anchor,Vt.width,Vt.height,Vt.textOffset,Vt.textBoxScale),J&&sn._rotate(Y?-this.transform.bearingInRadians:this.transform.bearingInRadians)):rn=!1}if(_t.textBox||_t.verticalTextBox){let Vt;_t.textBox&&(Vt=yt),_t.verticalTextBox&&(Vt=ht),Rn(o.textCollisionBox.collisionVertexArray,Ke.text.placed,!rn||Vt,pt.text,sn.x,sn.y)}}if(_t.iconBox||_t.verticalIconBox){const rn=!!(!ht&&_t.verticalIconBox);let Vt;_t.iconBox&&(Vt=rn),_t.verticalIconBox&&(Vt=!rn),Rn(o.iconCollisionBox.collisionVertexArray,Ke.icon.placed,Vt,pt.icon,oe?sn.x:0,oe?sn.y:0)}}}}if(o.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);o.bucketInstanceId in this.collisionCircleArrays&&(o.collisionCircleArray=this.collisionCircleArrays[o.bucketInstanceId],delete this.collisionCircleArrays[o.bucketInstanceId])}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>o}setStale(){this.stale=!0}}function Rn(b,o,u,m,v,w){m&&m.length!==0||(m=[0,0,0,0]);const P=m[0]-ft,k=m[1]-ft,F=m[2]-ft,j=m[3]-ft;b.emplaceBack(o?1:0,u?1:0,v||0,w||0,P,k),b.emplaceBack(o?1:0,u?1:0,v||0,w||0,F,k),b.emplaceBack(o?1:0,u?1:0,v||0,w||0,F,j),b.emplaceBack(o?1:0,u?1:0,v||0,w||0,P,j)}const jn=Math.pow(2,25),hr=Math.pow(2,24),dr=Math.pow(2,17),Zn=Math.pow(2,16),Hn=Math.pow(2,9),Jr=Math.pow(2,8),wr=Math.pow(2,1);function Wo(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const o=b.placed?1:0,u=Math.floor(127*b.opacity);return u*jn+o*hr+u*dr+o*Zn+u*Hn+o*Jr+u*wr+o}const Ms=0;class Ao{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,u,m,v,w){const P=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(P,v,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((k,F)=>k.sortKey-F.sortKey));this._currentPartIndex<P.length;)if(u.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,w())return!0;return!1}}class Dl{constructor(o,u,m,v,w,P,k,F){this.placement=new _n(o,u,P,k,F),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(o,u,m){const v=C.now(),w=()=>!this._forceFullPlacement&&C.now()-v>2;for(;this._currentPlacementIndex>=0;){const P=u[o[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=k)&&(!P.maxzoom||P.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Ao(P)),this._inProgressLayer.continuePlacement(m[P.source],this.placement,this._showCollisionBoxes,P,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Cr=512/s.$/2;class po{constructor(o,u,m){this.tileID=o,this.bucketInstanceId=m,this._symbolsByKey={};const v=new Map;for(let w=0;w<u.length;w++){const P=u.get(w),k=P.key,F=v.get(k);F?F.push(P):v.set(k,[P])}for(const[w,P]of v){const k={positions:P.map(F=>({x:Math.floor(F.anchorX*Cr),y:Math.floor(F.anchorY*Cr)})),crossTileIDs:P.map(F=>F.crossTileID)};if(k.positions.length>128){const F=new s.aH(k.positions.length,16,Uint16Array);for(const{x:j,y:W}of k.positions)F.add(j,W);F.finish(),delete k.positions,k.index=F}this._symbolsByKey[w]=k}}getScaledCoordinates(o,u){const{x:m,y:v,z:w}=this.tileID.canonical,{x:P,y:k,z:F}=u.canonical,j=Cr/Math.pow(2,F-w),W=(k*s.$+o.anchorY)*j,J=v*s.$*Cr;return{x:Math.floor((P*s.$+o.anchorX)*j-m*s.$*Cr),y:Math.floor(W-J)}}findMatches(o,u,m){const v=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let w=0;w<o.length;w++){const P=o.get(w);if(P.crossTileID)continue;const k=this._symbolsByKey[P.key];if(!k)continue;const F=this.getScaledCoordinates(P,u);if(k.index){const j=k.index.range(F.x-v,F.y-v,F.x+v,F.y+v).sort();for(const W of j){const J=k.crossTileIDs[W];if(!m[J]){m[J]=!0,P.crossTileID=J;break}}}else if(k.positions)for(let j=0;j<k.positions.length;j++){const W=k.positions[j],J=k.crossTileIDs[j];if(Math.abs(W.x-F.x)<=v&&Math.abs(W.y-F.y)<=v&&!m[J]){m[J]=!0,P.crossTileID=J;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class mo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ui{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(u!==0)for(const m in this.indexes){const v=this.indexes[m],w={};for(const P in v){const k=v[P];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+u),w[k.tileID.key]=k}this.indexes[m]=w}this.lng=o}addBucket(o,u,m){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let w=0;w<u.symbolInstances.length;w++)u.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const v=this.usedCrossTileIDs[o.overscaledZ];for(const w in this.indexes){const P=this.indexes[w];if(Number(w)>o.overscaledZ)for(const k in P){const F=P[k];F.tileID.isChildOf(o)&&F.findMatches(u.symbolInstances,o,v)}else{const k=P[o.scaledTo(Number(w)).key];k&&k.findMatches(u.symbolInstances,o,v)}}for(let w=0;w<u.symbolInstances.length;w++){const P=u.symbolInstances.get(w);P.crossTileID||(P.crossTileID=m.generate(),v[P.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new po(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const m of u.getCrossTileIDsLists())for(const v of m)delete this.usedCrossTileIDs[o][v]}removeStaleBuckets(o){let u=!1;for(const m in this.indexes){const v=this.indexes[m];for(const w in v)o[v[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,v[w]),delete v[w],u=!0)}return u}}class Ii{constructor(){this.layerIndexes={},this.crossTileIDs=new mo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,m){let v=this.layerIndexes[o.id];v===void 0&&(v=this.layerIndexes[o.id]=new Ui);let w=!1;const P={};v.handleWrapJump(m);for(const k of u){const F=k.getBucket(o);F&&o.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(k.tileID,F,this.crossTileIDs)&&(w=!0),P[F.bucketInstanceId]=!0)}return v.removeStaleBuckets(P)&&(w=!0),w}pruneUnusedLayers(o){const u={};o.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}var zl="void main() {fragColor=vec4(1.0);}";const $i={prelude:Jn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Jn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Jn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Jn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Jn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Jn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Jn(zl,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Jn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Jn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Jn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Jn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Jn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Jn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Jn(zl,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Jn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Jn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Jn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Jn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Jn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Jn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Jn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Jn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Jn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Jn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Jn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Jn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Jn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Jn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Jn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Jn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Jn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Jn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Jn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Jn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Jn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Jn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Jn(b,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=o.match(/in ([\w]+) ([\w]+)/g),v=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=w?w.concat(v):v,k={};return{fragmentSource:b=b.replace(u,(F,j,W,J,Y)=>(k[Y]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
in ${W} ${J} ${Y};
#else
uniform ${W} ${J} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${W} ${J} ${Y} = u_${Y};
#endif
`)),vertexSource:o=o.replace(u,(F,j,W,J,Y)=>{const oe=J==="float"?"vec2":"vec4",he=Y.match(/color/)?"color":oe;return k[Y]?j==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${W} ${oe} a_${Y};
out ${W} ${J} ${Y};
#else
uniform ${W} ${J} u_${Y};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${W} ${J} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${he}(a_${Y}, u_${Y}_t);
#else
    ${W} ${J} ${Y} = u_${Y};
#endif
`:j==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${W} ${oe} a_${Y};
#else
uniform ${W} ${J} u_${Y};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${W} ${J} ${Y} = a_${Y};
#else
    ${W} ${J} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${W} ${J} ${Y} = unpack_mix_${he}(a_${Y}, u_${Y}_t);
#else
    ${W} ${J} ${Y} = u_${Y};
#endif
`}),staticAttributes:m,staticUniforms:P}}class rl{constructor(o,u,m){this.vertexBuffer=o,this.indexBuffer=u,this.segments=m}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var il=s.aI([{name:"a_pos",type:"Int16",components:2}]);const wc="#define PROJECTION_MERCATOR",Hg="mercator";class Gg{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Hg}get shaderDefine(){return wc}get shaderPreludeCode(){return $i.projectionMercator}get vertexShaderPreludeCode(){return $i.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(o){}getMeshFromTileID(o,u,m,v,w){if(this._cachedMesh)return this._cachedMesh;const P=new s.aK;P.emplaceBack(0,0),P.emplaceBack(s.$,0),P.emplaceBack(0,s.$),P.emplaceBack(s.$,s.$);const k=o.createVertexBuffer(P,il.members),F=s.aL.simpleSegment(0,0,4,2),j=new s.aM;j.emplaceBack(1,0,2),j.emplaceBack(1,2,3);const W=o.createIndexBuffer(j);return this._cachedMesh=new rl(k,W,F),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(o){}}class Cs{constructor(o=0,u=0,m=0,v=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=m,this.right=v}interpolate(o,u,m){return u.top!=null&&o.top!=null&&(this.top=s.C.number(o.top,u.top,m)),u.bottom!=null&&o.bottom!=null&&(this.bottom=s.C.number(o.bottom,u.bottom,m)),u.left!=null&&o.left!=null&&(this.left=s.C.number(o.left,u.left,m)),u.right!=null&&o.right!=null&&(this.right=s.C.number(o.right,u.right,m)),this}getCenter(o,u){const m=s.ag((this.left+o-this.right)/2,0,o),v=s.ag((this.top+u-this.bottom)/2,0,u);return new s.P(m,v)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Cs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ol(b,o){if(!b.renderWorldCopies||b.lngRange)return;const u=o.lng-b.center.lng;o.lng+=u>180?-360:u<-180?360:0}function Qn(b){return Math.max(0,Math.floor(b))}class sd{constructor(o,u,m,v,w,P){this._callbacks=o,this._tileSize=512,this._renderWorldCopies=P===void 0||!!P,this._minZoom=u||0,this._maxZoom=m||22,this._minPitch=v??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Qn(this._zoom),this._scale=s.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Cs,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(o,u,m){this._latRange=o.latRange,this._lngRange=o.lngRange,this._width=o.width,this._height=o.height,this._center=o.center,this._elevation=o.elevation,this._minElevationForCurrentTile=o.minElevationForCurrentTile,this._zoom=o.zoom,this._tileZoom=Qn(this._zoom),this._scale=s.ae(this._zoom),this._bearingInRadians=o.bearingInRadians,this._fovInRadians=o.fovInRadians,this._pitchInRadians=o.pitchInRadians,this._rollInRadians=o.rollInRadians,this._unmodified=o.unmodified,this._edgeInsets=new Cs(o.padding.top,o.padding.bottom,o.padding.left,o.padding.right),this._minZoom=o.minZoom,this._maxZoom=o.maxZoom,this._minPitch=o.minPitch,this._maxPitch=o.maxPitch,this._renderWorldCopies=o.renderWorldCopies,this._cameraToCenterDistance=o.cameraToCenterDistance,this._nearZ=o.nearZ,this._farZ=o.farZ,this._autoCalculateNearFarZ=!m&&o.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(o){this._minElevationForCurrentTile=o}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(o){this._minZoom!==o&&(this._minZoom=o,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(o){this._minPitch!==o&&(this._minPitch=o,this.setPitch(Math.max(this.pitch,o)))}get maxPitch(){return this._maxPitch}setMaxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.setPitch(Math.min(this.pitch,o)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(o){const u=s.aN(o,-180,180)*Math.PI/180;var m,v,w,P,k,F,j,W,J;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=g(),m=this._rotationMatrix,w=-this._bearingInRadians,P=(v=this._rotationMatrix)[0],k=v[1],F=v[2],j=v[3],W=Math.sin(w),J=Math.cos(w),m[0]=P*J+F*W,m[1]=k*J+j*W,m[2]=P*-W+F*J,m[3]=k*-W+j*J)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(o){const u=s.ag(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(o){const u=o/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aO(this._fovInRadians)}setFov(o){o=s.ag(o,.1,150),this.fov!==o&&(this._unmodified=!1,this._fovInRadians=s.ad(o),this._calcMatrices())}get zoom(){return this._zoom}setZoom(o){const u=this.getConstrained(this._center,o).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=s.ae(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(o,u){this._autoCalculateNearFarZ=!1,this._nearZ=o,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,m){this._unmodified=!1,this._edgeInsets.interpolate(o,u,m),this._constrain(),this._calcMatrices()}resize(o,u,m=!0){this._width=o,this._height=u,m&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new hn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(o){o?(this._lngRange=[o.getWest(),o.getEast()],this._latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-s.ah,s.ah])}getConstrained(o,u){return this._callbacks.getConstrained(o,u)}getCameraQueryGeometry(o,u){if(u.length===1)return[u[0],o];{const{minX:m,minY:v,maxX:w,maxY:P}=s.a1.fromPoints(u).extend(o);return[new s.P(m,v),new s.P(w,v),new s.P(w,P),new s.P(m,P),new s.P(m,v)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:u,zoom:m}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(m),this._unmodified=o,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let o=s.af(new Float64Array(16));s.N(o,o,[this._width/2,-this._height/2,1]),s.M(o,o,[1,-1,0]),this._clipSpaceToPixelsMatrix=o,o=s.af(new Float64Array(16)),s.N(o,o,[1,-1,1]),s.M(o,o,[-1,-1,0]),s.N(o,o,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=o,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(o,u,m,v){const w=m!==void 0?m:this.bearing,P=v=v!==void 0?v:this.pitch,k=s.a0.fromLngLat(o,u),F=-Math.cos(s.ad(P)),j=Math.sin(s.ad(P)),W=j*Math.sin(s.ad(w)),J=-j*Math.cos(s.ad(w));let Y=this.elevation;const oe=u-Y;let he;F*oe>=0||Math.abs(F)<.1?(he=1e4,Y=u+he*F):he=-oe/F;let Pe,Ee,Ae=s.aP(1,k.y),Fe=0;do{if(Fe+=1,Fe>10)break;Ee=he/Ae,Pe=new s.a0(k.x+W*Ee,k.y+J*Ee),Ae=1/Pe.meterInMercatorCoordinateUnits()}while(Math.abs(he-Ee*Ae)>1e-12);return{center:Pe.toLngLat(),elevation:Y,zoom:s.aj(this.height/2/Math.tan(this.fovInRadians/2)/Ee/this.tileSize)}}recalculateZoomAndCenter(o){if(this.elevation-o==0)return;const u=s.ai(1,this.center.lat)*this.worldSize,m=this.cameraToCenterDistance/u,v=s.a0.fromLngLat(this.center,this.elevation),w=le(this.center,this.elevation,this.pitch,this.bearing,m);this._elevation=o;const P=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),s.aP(w.z,v.y),this.bearing,this.pitch);this._elevation=P.elevation,this._center=P.center,this.setZoom(P.zoom)}getCameraPoint(){const o=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(o*Math.sin(this.rollInRadians),o*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const o=s.ai(1,this.center.lat)*this.worldSize;return le(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/o).toLngLat()}getMercatorTileCoordinates(o){if(!o)return[0,0,1,1];const u=o.canonical.z>=0?1<<o.canonical.z:Math.pow(2,o.canonical.z);return[o.canonical.x/u,o.canonical.y/u,1/u/s.$,1/u/s.$]}}class Gf{constructor(o,u){this.min=o,this.max=u,this.center=s.aQ([],s.aR([],this.min,this.max),.5)}quadrant(o){const u=[o%2==0,o<2],m=s.aS(this.min),v=s.aS(this.max);for(let w=0;w<u.length;w++)m[w]=u[w]?this.min[w]:this.center[w],v[w]=u[w]?this.center[w]:this.max[w];return v[2]=this.max[2],new Gf(m,v)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersectsFrustum(o){let u=!0;for(let m=0;m<o.planes.length;m++){const v=this.intersectsPlane(o.planes[m]);if(v===0)return 0;v===1&&(u=!1)}return u?2:o.aabb.min[0]>this.max[0]||o.aabb.min[1]>this.max[1]||o.aabb.min[2]>this.max[2]||o.aabb.max[0]<this.min[0]||o.aabb.max[1]<this.min[1]||o.aabb.max[2]<this.min[2]?0:1}intersectsPlane(o){let u=o[3],m=o[3];for(let v=0;v<3;v++)o[v]>0?(u+=o[v]*this.min[v],m+=o[v]*this.max[v]):(m+=o[v]*this.min[v],u+=o[v]*this.max[v]);return u>=0?2:m<0?0:1}}class Wg{distanceToTile2d(o,u,m,v){const w=v.distanceX([o,u]),P=v.distanceY([o,u]);return Math.hypot(w,P)}getWrap(o,u,m){return m}getTileBoundingVolume(o,u,m,v){var w,P;let k=m,F=m;if(v!=null&&v.terrain){const W=new s.Z(o.z,u,o.z,o.x,o.y),J=v.terrain.getMinMaxElevation(W);k=(w=J.minElevation)!==null&&w!==void 0?w:m,F=(P=J.maxElevation)!==null&&P!==void 0?P:m}const j=1<<o.z;return new Gf([u+o.x/j,o.y/j,k],[u+(o.x+1)/j,(o.y+1)/j,F])}allowVariableZoom(o,u){const m=o.fov*(Math.abs(Math.cos(o.rollInRadians))*o.height+Math.abs(Math.sin(o.rollInRadians))*o.width)/o.height,v=s.ag(78.5-m/2,0,60);return!!u.terrain||o.pitch>v}allowWorldCopies(){return!0}prepareNextFrame(){}}class go{constructor(o,u,m){this.points=o,this.planes=u,this.aabb=m}static fromInvProjectionMatrix(o,u=1,m=0,v,w){const P=w?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],k=Math.pow(2,m),F=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Y=>function(oe,he,Pe,Ee){const Ae=s.av([],oe,he),Fe=1/Ae[3]/Pe*Ee;return s.aX(Ae,Ae,[Fe,Fe,1/Ae[3],Fe])}(Y,o,u,k));v&&function(Y,oe,he,Pe){const Ee=Pe?4:0,Ae=Pe?0:4;let Fe=0;const He=[],Ne=[];for(let Ue=0;Ue<4;Ue++){const rt=s.aT([],Y[Ue+Ae],Y[Ue+Ee]),yt=s.aY(rt);s.aQ(rt,rt,1/yt),He.push(yt),Ne.push(rt)}for(let Ue=0;Ue<4;Ue++){const rt=s.aZ(Y[Ue+Ee],Ne[Ue],he);Fe=rt!==null&&rt>=0?Math.max(Fe,rt):Math.max(Fe,He[Ue])}const Ye=function(Ue,rt){const yt=s.aT([],Ue[rt[0]],Ue[rt[1]]),ht=s.aT([],Ue[rt[2]],Ue[rt[1]]),pt=[0,0,0,0];return s.aU(pt,s.aV([],yt,ht)),pt[3]=-s.aW(pt,Ue[rt[0]]),pt}(Y,oe),Ke=function(Ue,rt){const yt=s.a_(Ue),ht=s.a$([],Ue,1/yt),pt=s.aT([],rt,s.aQ([],ht,s.aW(rt,ht))),_t=s.a_(pt);if(_t>0){const sn=Math.sqrt(1-ht[3]*ht[3]),rn=s.aQ([],ht,-ht[3]),Vt=s.aR([],rn,s.aQ([],pt,sn/_t));return s.b0(rt,Vt)}return null}(he,Ye);if(Ke!==null){const Ue=Ke/s.aW(Ne[0],Ye);Fe=Math.min(Fe,Ue)}for(let Ue=0;Ue<4;Ue++){const rt=Math.min(Fe,He[Ue]);Y[Ue+Ae]=[Y[Ue+Ee][0]+Ne[Ue][0]*rt,Y[Ue+Ee][1]+Ne[Ue][1]*rt,Y[Ue+Ee][2]+Ne[Ue][2]*rt,1]}}(F,P[0],v,w);const j=P.map(Y=>{const oe=s.aT([],F[Y[0]],F[Y[1]]),he=s.aT([],F[Y[2]],F[Y[1]]),Pe=s.aU([],s.aV([],oe,he)),Ee=-s.aW(Pe,F[Y[1]]);return Pe.concat(Ee)}),W=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],J=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const Y of F)for(let oe=0;oe<3;oe++)W[oe]=Math.min(W[oe],Y[oe]),J[oe]=Math.max(J[oe],Y[oe]);return new go(F,j,new Gf(W,J))}}class bi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,m){return this._helper.interpolatePadding(o,u,m)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u,m=!0){this._helper.resize(o,u,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o,u){}constructor(o,u,m,v,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new sd({calcMatrices:()=>{this._calcMatrices()},getConstrained:(P,k)=>this.getConstrained(P,k)},o,u,m,v,w),this._coveringTilesDetailsProvider=new Wg}clone(){const o=new bi;return o.apply(this),o}apply(o,u,m){this._helper.apply(o,u,m)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(o){const u=[new s.b1(0,o)];if(this._helper._renderWorldCopies){const m=this.screenPointToMercatorCoordinate(new s.P(0,0)),v=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),P=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),k=Math.floor(Math.min(m.x,v.x,w.x,P.x)),F=Math.floor(Math.max(m.x,v.x,w.x,P.x)),j=1;for(let W=k-j;W<=F+j;W++)W!==0&&u.push(new s.b1(W,o))}return u}getCameraFrustum(){return go.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){const u=this.screenPointToLocation(this.centerPoint,o),m=o?o.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(m)}setLocationAtPoint(o,u){const m=s.ai(this.elevation,this.center.lat),v=this.screenPointToMercatorCoordinateAtZ(u,m),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,m),P=s.a0.fromLngLat(o),k=new s.a0(P.x-(v.x-w.x),P.y-(v.y-w.y));this.setCenter(k==null?void 0:k.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(o,u){return u?this.coordinatePoint(s.a0.fromLngLat(o),u.getElevationForLngLatZoom(o,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(s.a0.fromLngLat(o))}screenPointToLocation(o,u){var m;return(m=this.screenPointToMercatorCoordinate(o,u))===null||m===void 0?void 0:m.toLngLat()}screenPointToMercatorCoordinate(o,u){if(u){const m=u.pointCoordinate(o);if(m!=null)return m}return this.screenPointToMercatorCoordinateAtZ(o)}screenPointToMercatorCoordinateAtZ(o,u){const m=u||0,v=[o.x,o.y,0,1],w=[o.x,o.y,1,1];s.av(v,v,this._pixelMatrixInverse),s.av(w,w,this._pixelMatrixInverse);const P=v[3],k=w[3],F=v[1]/P,j=w[1]/k,W=v[2]/P,J=w[2]/k,Y=W===J?0:(m-W)/(J-W);return new s.a0(s.C.number(v[0]/P,w[0]/k,Y)/this.worldSize,s.C.number(F,j,Y)/this.worldSize,m)}coordinatePoint(o,u=0,m=this._pixelMatrix){const v=[o.x*this.worldSize,o.y*this.worldSize,u,1];return s.av(v,v,m),new s.P(v[0]/v[3],v[1]/v[3])}getBounds(){const o=Math.max(0,this._helper._height/2-ne(this));return new hn().extend(this.screenPointToLocation(new s.P(0,o))).extend(this.screenPointToLocation(new s.P(this._helper._width,o))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(o,u){return u?u.pointCoordinate(o)!=null:o.y>this.height/2-ne(this)}calculatePosMatrix(o,u=!1,m){var v;const w=(v=o.key)!==null&&v!==void 0?v:s.b2(o.wrap,o.canonical.z,o.canonical.z,o.canonical.x,o.canonical.y),P=u?this._alignedPosMatrixCache:this._posMatrixCache;if(P.has(w)){const j=P.get(w);return m?j.f32:j.f64}const k=Z(o,this.worldSize);s.O(k,u?this._alignedProjMatrix:this._viewProjMatrix,k);const F={f64:k,f32:new Float32Array(k)};return P.set(w,F),m?F.f32:F.f64}calculateFogMatrix(o){const u=o.key,m=this._fogMatrixCacheF32;if(m.has(u))return m.get(u);const v=Z(o,this.worldSize);return s.O(v,this._fogMatrix,v),m.set(u,new Float32Array(v)),m.get(u)}getConstrained(o,u){u=s.ag(+u,this.minZoom,this.maxZoom);const m={center:new s.S(o.lng,o.lat),zoom:u};let v=this._helper._lngRange;if(!this._helper._renderWorldCopies&&v===null){const He=179.9999999999;v=[-He,He]}const w=this.tileSize*s.ae(m.zoom);let P=0,k=w,F=0,j=w,W=0,J=0;const{x:Y,y:oe}=this.size;if(this._helper._latRange){const He=this._helper._latRange;P=s.U(He[1])*w,k=s.U(He[0])*w,k-P<oe&&(W=oe/(k-P))}v&&(F=s.aN(s.V(v[0])*w,0,w),j=s.aN(s.V(v[1])*w,0,w),j<F&&(j+=w),j-F<Y&&(J=Y/(j-F)));const{x:he,y:Pe}=_e(w,o);let Ee,Ae;const Fe=Math.max(J||0,W||0);if(Fe){const He=new s.P(J?(j+F)/2:he,W?(k+P)/2:Pe);return m.center=ee(w,He).wrap(),m.zoom+=s.aj(Fe),m}if(this._helper._latRange){const He=oe/2;Pe-He<P&&(Ae=P+He),Pe+He>k&&(Ae=k-He)}if(v){const He=(F+j)/2;let Ne=he;this._helper._renderWorldCopies&&(Ne=s.aN(he,He-w/2,He+w/2));const Ye=Y/2;Ne-Ye<F&&(Ee=F+Ye),Ne+Ye>j&&(Ee=j-Ye)}if(Ee!==void 0||Ae!==void 0){const He=new s.P(Ee??he,Ae??Pe);m.center=ee(w,He).wrap()}return m}calculateCenterFromCameraLngLatAlt(o,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,m,v)}_calculateNearFarZIfNeeded(o,u,m){if(!this._helper.autoCalculateNearFarZ)return;const v=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=o-v*this._helper._pixelPerMeter/Math.cos(u),P=v<0?w:o,k=Math.PI/2+this.pitchInRadians,F=s.ad(this.fov)*(Math.abs(Math.cos(s.ad(this.roll)))*this.height+Math.abs(Math.sin(s.ad(this.roll)))*this.width)/this.height*(.5+m.y/this.height),j=Math.sin(F)*P/Math.sin(s.ag(Math.PI-k-F,.01,Math.PI-.01)),W=ne(this),J=Math.atan(W/this._helper.cameraToCenterDistance),Y=s.ad(.75),oe=J>Y?2*J*(.5+m.y/(2*W)):Y,he=Math.sin(oe)*P/Math.sin(s.ag(Math.PI-k-oe,.01,Math.PI-.01)),Pe=Math.min(j,he);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*Pe+P),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const o=this.centerOffset,u=_e(this.worldSize,this.center),m=u.x,v=u.y;this._helper._pixelPerMeter=s.ai(1,this.center.lat)*this.worldSize;const w=s.ad(Math.min(this.pitch,zt)),P=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let k;this._calculateNearFarZIfNeeded(P,w,o),k=new Float64Array(16),s.b3(k,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.ap(this._invProjMatrix,k),k[8]=2*-o.x/this._helper._width,k[9]=2*o.y/this._helper._height,this._projectionMatrix=s.b4(k),s.N(k,k,[1,-1,1]),s.M(k,k,[0,0,-this._helper.cameraToCenterDistance]),s.b5(k,k,-this.rollInRadians),s.b6(k,k,this.pitchInRadians),s.b5(k,k,-this.bearingInRadians),s.M(k,k,[-m,-v,0]),this._mercatorMatrix=s.N([],k,[this.worldSize,this.worldSize,this.worldSize]),s.N(k,k,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,k),s.M(k,k,[0,0,-this.elevation]),this._viewProjMatrix=k,this._invViewProjMatrix=s.ap([],k);const F=[0,0,-1,1];s.av(F,F,this._invViewProjMatrix),this._cameraPosition=[F[0]/F[3],F[1]/F[3],F[2]/F[3]],this._fogMatrix=new Float64Array(16),s.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,P,this._helper._farZ),this._fogMatrix[8]=2*-o.x/this.width,this._fogMatrix[9]=2*o.y/this.height,s.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.M(this._fogMatrix,this._fogMatrix,[-m,-v,0]),s.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,k);const j=this._helper._width%2/2,W=this._helper._height%2/2,J=Math.cos(this.bearingInRadians),Y=Math.sin(-this.bearingInRadians),oe=m-Math.round(m)+J*j+Y*W,he=v-Math.round(v)+J*W+Y*j,Pe=new Float64Array(k);if(s.M(Pe,Pe,[oe>.5?oe-1:oe,he>.5?he-1:he,0]),this._alignedProjMatrix=Pe,k=s.ap(new Float64Array(16),this._pixelMatrix),!k)throw new Error("failed to invert matrix");this._pixelMatrixInverse=k,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const o=this.screenPointToMercatorCoordinate(new s.P(0,0)),u=[o.x*this.worldSize,o.y*this.worldSize,0,1];return s.av(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const o=s.ai(1,this.center.lat)*this.worldSize;return le(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/o).toLngLat()}lngLatToCameraDepth(o,u){const m=s.a0.fromLngLat(o),v=[m.x*this.worldSize,m.y*this.worldSize,u,1];return s.av(v,v,this._viewProjMatrix),v[2]/v[3]}getProjectionData(o){const{overscaledTileID:u,aligned:m,applyTerrainMatrix:v}=o,w=this._helper.getMercatorTileCoordinates(u),P=u?this.calculatePosMatrix(u,m,!0):null;let k;return k=u&&u.terrainRttPosMatrix32f&&v?u.terrainRttPosMatrix32f:P||s.b7(),{mainMatrix:k,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:k}}isLocationOccluded(o){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(o,u,m){return 1}transformLightDirection(o){return s.aS(o)}getRayDirectionFromPixel(o){throw new Error("Not implemented.")}projectTileCoordinates(o,u,m,v){const w=this.calculatePosMatrix(m);let P;v?(P=[o,u,v(o,u),1],s.av(P,P,w)):(P=[o,u,0,1],vt(P,P,w));const k=P[3];return{point:new s.P(P[0]/k,P[1]/k),signedDistanceFromCamera:k,isOccluded:!1}}populateCache(o){for(const u of o)this.calculatePosMatrix(u)}getMatrixForModel(o,u){const m=s.a0.fromLngLat(o,u),v=m.meterInMercatorCoordinateUnits(),w=s.b8();return s.M(w,w,[m.x,m.y,m.z]),s.b5(w,w,Math.PI),s.b6(w,w,Math.PI/2),s.N(w,w,[-v,v,v]),w}getProjectionDataForCustomLayer(o=!0){const u=new s.Z(0,0,0,0,0),m=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:o}),v=Z(u,this.worldSize);s.O(v,this._viewProjMatrix,v),m.tileMercatorCoords=[0,0,1,1];const w=[s.$,s.$,this.worldSize/this._helper.pixelsPerMeter],P=s.b9();return s.N(P,v,w),m.fallbackMatrix=P,m.mainMatrix=P,m}getFastPathSimpleProjectionMatrix(o){return this.calculatePosMatrix(o)}}function vo(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Vi(b){if(b.useSlerp)if(b.k<1){const o=s.ba(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),u=s.ba(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),m=new Float64Array(4);s.bb(m,o,u,b.k);const v=s.bc(m);b.tr.setRoll(v.roll),b.tr.setPitch(v.pitch),b.tr.setBearing(v.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(s.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(s.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(s.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function Qr(b,o,u,m,v){const w=v.padding,P=_e(v.worldSize,u.getNorthWest()),k=_e(v.worldSize,u.getNorthEast()),F=_e(v.worldSize,u.getSouthEast()),j=_e(v.worldSize,u.getSouthWest()),W=s.ad(-m),J=P.rotate(W),Y=k.rotate(W),oe=F.rotate(W),he=j.rotate(W),Pe=new s.P(Math.max(J.x,Y.x,he.x,oe.x),Math.max(J.y,Y.y,he.y,oe.y)),Ee=new s.P(Math.min(J.x,Y.x,he.x,oe.x),Math.min(J.y,Y.y,he.y,oe.y)),Ae=Pe.sub(Ee),Fe=(v.width-(w.left+w.right+o.left+o.right))/Ae.x,He=(v.height-(w.top+w.bottom+o.top+o.bottom))/Ae.y;if(He<0||Fe<0)return void vo();const Ne=Math.min(s.aj(v.scale*Math.min(Fe,He)),b.maxZoom),Ye=s.P.convert(b.offset),Ke=new s.P((o.left-o.right)/2,(o.top-o.bottom)/2).rotate(s.ad(m)),Ue=Ye.add(Ke).mult(v.scale/s.ae(Ne));return{center:ee(v.worldSize,P.add(F).div(2).sub(Ue)),zoom:Ne,bearing:m}}class Wf{get useGlobeControls(){return!1}handlePanInertia(o,u){return{easingOffset:o,easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(o,u){o.bearingDelta&&u.setBearing(u.bearing+o.bearingDelta),o.pitchDelta&&u.setPitch(u.pitch+o.pitchDelta),o.rollDelta&&u.setRoll(u.roll+o.rollDelta),o.zoomDelta&&u.setZoom(u.zoom+o.zoomDelta)}handleMapControlsPan(o,u,m){o.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(m,o.around)}cameraForBoxAndBearing(o,u,m,v,w){return Qr(o,u,m,v,w)}handleJumpToCenterZoom(o,u){o.zoom!==(u.zoom!==void 0?+u.zoom:o.zoom)&&o.setZoom(+u.zoom),u.center!==void 0&&o.setCenter(s.S.convert(u.center))}handleEaseTo(o,u){const m=o.zoom,v=o.padding,w={roll:o.roll,pitch:o.pitch,bearing:o.bearing},P={roll:u.roll===void 0?o.roll:u.roll,pitch:u.pitch===void 0?o.pitch:u.pitch,bearing:u.bearing===void 0?o.bearing:u.bearing},k=u.zoom!==void 0,F=!o.isPaddingEqual(u.padding);let j=!1;const W=k?+u.zoom:o.zoom;let J=o.centerPoint.add(u.offsetAsPoint);const Y=o.screenPointToLocation(J),{center:oe,zoom:he}=o.getConstrained(s.S.convert(u.center||Y),W??m);ol(o,oe);const Pe=_e(o.worldSize,Y),Ee=_e(o.worldSize,oe).sub(Pe),Ae=s.ae(he-m);return j=he!==m,{easeFunc:Fe=>{if(j&&o.setZoom(s.C.number(m,he,Fe)),s.bd(w,P)||Vi({startEulerAngles:w,endEulerAngles:P,tr:o,k:Fe,useSlerp:w.roll!=P.roll}),F&&(o.interpolatePadding(v,u.padding,Fe),J=o.centerPoint.add(u.offsetAsPoint)),u.around)o.setLocationAtPoint(u.around,u.aroundPoint);else{const He=s.ae(o.zoom-m),Ne=he>m?Math.min(2,Ae):Math.max(.5,Ae),Ye=Math.pow(Ne,1-Fe),Ke=ee(o.worldSize,Pe.add(Ee.mult(Fe*Ye)).mult(He));o.setLocationAtPoint(o.renderWorldCopies?Ke.wrap():Ke,J)}},isZooming:j,elevationCenter:oe}}handleFlyTo(o,u){const m=u.zoom!==void 0,v=o.zoom,w=o.getConstrained(s.S.convert(u.center||u.locationAtOffset),m?+u.zoom:v),P=w.center,k=w.zoom;ol(o,P);const F=_e(o.worldSize,u.locationAtOffset),j=_e(o.worldSize,P).sub(F),W=j.mag(),J=s.ae(k-v);let Y;if(u.minZoom!==void 0){const oe=Math.min(+u.minZoom,v,k),he=o.getConstrained(P,oe).zoom;Y=s.ae(he-v)}return{easeFunc:(oe,he,Pe,Ee)=>{o.setZoom(oe===1?k:v+s.aj(he));const Ae=oe===1?P:ee(o.worldSize,F.add(j.mult(Pe)).mult(he));o.setLocationAtPoint(o.renderWorldCopies?Ae.wrap():Ae,Ee)},scaleOfZoom:J,targetCenter:P,scaleOfMinZoom:Y,pixelPathLength:W}}}class sr{constructor(o,u,m){this.blendFunction=o,this.blendColor=u,this.mask=m}}sr.Replace=[1,0],sr.disabled=new sr(sr.Replace,s.be.transparent,[!1,!1,!1,!1]),sr.unblended=new sr(sr.Replace,s.be.transparent,[!0,!0,!0,!0]),sr.alphaBlended=new sr([1,771],s.be.transparent,[!0,!0,!0,!0]);const qo=2305;class Wn{constructor(o,u,m){this.enable=o,this.mode=u,this.frontFace=m}}Wn.disabled=new Wn(!1,1029,qo),Wn.backCCW=new Wn(!0,1029,qo),Wn.frontCCW=new Wn(!0,1028,qo);class Yn{constructor(o,u,m){this.func=o,this.mask=u,this.range=m}}Yn.ReadOnly=!1,Yn.ReadWrite=!0,Yn.disabled=new Yn(519,Yn.ReadOnly,[0,1]);const Sc=7680;class Gn{constructor(o,u,m,v,w,P){this.test=o,this.ref=u,this.mask=m,this.fail=v,this.depthFail=w,this.pass=P}}Gn.disabled=new Gn({func:519,mask:0},0,0,Sc,Sc,Sc);const Mc=new WeakMap;function Io(b){var o;if(Mc.has(b))return Mc.get(b);{const u=(o=b.getParameter(b.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return Mc.set(b,u),u}}class yu{get awaitingQuery(){return!!this._readbackQueue}constructor(o){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=o;const u=o.context,m=u.gl;this._texFormat=m.RGBA,this._texType=m.UNSIGNED_BYTE;const v=new s.aK;v.emplaceBack(-1,-1),v.emplaceBack(2,-1),v.emplaceBack(-1,2);const w=new s.aM;w.emplaceBack(0,1,2),this._fullscreenTriangle=new rl(u.createVertexBuffer(v,il.members),u.createIndexBuffer(w),s.aL.simpleSegment(0,0,v.length,w.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(m.TEXTURE1);const P=m.createTexture();m.bindTexture(m.TEXTURE_2D,P),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST),m.texImage2D(m.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(P),Io(m)&&(this._pbo=m.createBuffer(),m.bindBuffer(m.PIXEL_PACK_BUFFER,this._pbo),m.bufferData(m.PIXEL_PACK_BUFFER,4,m.STREAM_READ),m.bindBuffer(m.PIXEL_PACK_BUFFER,null))}destroy(){const o=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),o.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(o,u){const m=this._updateCount;return this._readbackQueue?m>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():m>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(o,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const o=this._cachedRenderContext.context,u=o.gl;o.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),o.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(o,u){const m=this._cachedRenderContext.context,v=m.gl;if(this._bindFramebuffer(),m.viewport.set([0,0,this._texWidth,this._texHeight]),m.clear({color:s.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(m,v.TRIANGLES,Yn.disabled,Gn.disabled,sr.unblended,Wn.disabled,((w,P)=>({u_input:w,u_output_expected:P}))(o,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Io(v)){v.bindBuffer(v.PIXEL_PACK_BUFFER,this._pbo),v.readBuffer(v.COLOR_ATTACHMENT0),v.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),v.bindBuffer(v.PIXEL_PACK_BUFFER,null);const w=v.fenceSync(v.SYNC_GPU_COMMANDS_COMPLETE,0);v.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const o=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Io(o)){const u=o.clientWaitSync(this._readbackQueue.sync,0,0);if(u===o.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===o.TIMEOUT_EXPIRED)return;o.bindBuffer(o.PIXEL_PACK_BUFFER,this._pbo),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),o.bindBuffer(o.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),o.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=yu._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(o){let u=0;return u+=o[0]/256,u+=o[1]/65536,u+=o[2]/16777216,o[3]<127&&(u=-u),u/128}}const Xo=s.$/128;function qg(b,o){const u=b.granularity!==void 0?Math.max(b.granularity,1):1,m=u+(b.generateBorders?2:0),v=u+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),w=m+1,P=v+1,k=b.generateBorders?-1:0,F=b.generateBorders||b.extendToNorthPole?-1:0,j=u+(b.generateBorders?1:0),W=u+(b.generateBorders||b.extendToSouthPole?1:0),J=w*P,Y=m*v*6,oe=w*P>65536;if(oe&&o==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const he=oe||o==="32bit",Pe=new Int16Array(2*J);let Ee=0;for(let He=F;He<=W;He++)for(let Ne=k;Ne<=j;Ne++){let Ye=Ne/u*s.$;Ne===-1&&(Ye=-Xo),Ne===u+1&&(Ye=s.$+Xo);let Ke=He/u*s.$;He===-1&&(Ke=b.extendToNorthPole?s.bg:-Xo),He===u+1&&(Ke=b.extendToSouthPole?s.bh:s.$+Xo),Pe[Ee++]=Ye,Pe[Ee++]=Ke}const Ae=he?new Uint32Array(Y):new Uint16Array(Y);let Fe=0;for(let He=0;He<v;He++)for(let Ne=0;Ne<m;Ne++){const Ye=Ne+1+He*w,Ke=Ne+(He+1)*w,Ue=Ne+1+(He+1)*w;Ae[Fe++]=Ne+He*w,Ae[Fe++]=Ke,Ae[Fe++]=Ye,Ae[Fe++]=Ye,Ae[Fe++]=Ke,Ae[Fe++]=Ue}return{vertices:Pe.buffer.slice(0),indices:Ae.buffer.slice(0),uses32bitIndices:he}}const Aa=new s.aJ({fill:new s.bi(128,2),line:new s.bi(512,0),tile:new s.bi(128,32),stencil:new s.bi(128,1),circle:3});class mx{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return $i.projectionGlobe}get vertexShaderPreludeCode(){return $i.projectionMercator.vertexSource}get subdivisionGranularity(){return Aa}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(o){this._errorMeasurement||(this._errorMeasurement=new yu(o));const u=s.U(this._errorQueryLatitudeDegrees),m=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,v=this._errorMeasurement.updateErrorLoop(u,m),w=C.now();v!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=v,this._errorMeasurementLastChangeTime=w);const P=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bk(P))}_getMeshKey(o){return`${o.granularity.toString(36)}_${o.generateBorders?"b":""}${o.extendToNorthPole?"n":""}${o.extendToSouthPole?"s":""}`}getMeshFromTileID(o,u,m,v,w){const P=(w==="stencil"?Aa.stencil:Aa.tile).getGranularityForZoomLevel(u.z);return this._getMesh(o,{granularity:P,generateBorders:m,extendToNorthPole:u.y===0&&v,extendToSouthPole:u.y===(1<<u.z)-1&&v})}_getMesh(o,u){const m=this._getMeshKey(u);if(m in this._tileMeshCache)return this._tileMeshCache[m];const v=function(w,P){const k=qg(P,"16bit"),F=s.aK.deserialize({arrayBuffer:k.vertices,length:k.vertices.byteLength/2/2}),j=s.aM.deserialize({arrayBuffer:k.indices,length:k.indices.byteLength/2/3});return new rl(w.createVertexBuffer(F,il.members),w.createIndexBuffer(j),s.aL.simpleSegment(0,0,F.length,j.length))}(o,u);return this._tileMeshCache[m]=v,v}recalculate(o){}hasTransition(){const o=C.now();let u=!1;return u=u||(o-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(o){this._errorQueryLatitudeDegrees=o}}const gx=new s.r({type:new s.D(s.v.projection.type)});class ad extends s.E{constructor(o){super(),this._transitionable=new s.t(gx),this.setProjection(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0)),this._mercatorProjection=new Gg,this._verticalPerspectiveProjection=new mx}get transitionState(){const o=this.properties.get("type");if(typeof o=="string"&&o==="mercator")return 0;if(typeof o=="string"&&o==="vertical-perspective")return 1;if(o instanceof s.bl){if(o.from==="vertical-perspective"&&o.to==="mercator")return 1-o.transition;if(o.from==="mercator"&&o.to==="vertical-perspective")return o.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(o){this._mercatorProjection.updateGPUdependent(o),this._verticalPerspectiveProjection.updateGPUdependent(o)}getMeshFromTileID(o,u,m,v,w){return this.currentProjection.getMeshFromTileID(o,u,m,v,w)}setProjection(o){this._transitionable.setValue("type",(o==null?void 0:o.type)||"mercator")}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}setErrorQueryLatitudeDegrees(o){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(o),this._mercatorProjection.setErrorQueryLatitudeDegrees(o)}}function ld(b){const o=_u(b.worldSize,b.center.lat);return 2*Math.PI*o}function Ys(b,o,u,m,v){const w=1/(1<<v),P=o/s.$*w+m*w,k=s.bn((b/s.$*w+u*w)*Math.PI*2+Math.PI,2*Math.PI),F=2*Math.atan(Math.exp(Math.PI-P*Math.PI*2))-.5*Math.PI,j=Math.cos(F),W=new Float64Array(3);return W[0]=Math.sin(k)*j,W[1]=Math.sin(F),W[2]=Math.cos(k)*j,W}function ji(b){return function(o,u){const m=Math.cos(u),v=new Float64Array(3);return v[0]=Math.sin(o)*m,v[1]=Math.sin(u),v[2]=Math.cos(o)*m,v}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function _u(b,o){return b/(2*Math.PI)/Math.cos(o*Math.PI/180)}function cd(b){const o=Math.asin(b[1])/Math.PI*180,u=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(u>1e-6){const m=b[0]/u,v=Math.acos(b[2]/u),w=(m>0?v:-v)/Math.PI*180;return new s.S(s.aN(w,-180,180),o)}return new s.S(0,o)}function xu(b){return Math.cos(b*Math.PI/180)}function wi(b,o){const u=xu(b),m=xu(o);return s.aj(m/u)}function ud(b,o){const u=b.rotate(o.bearingInRadians),m=o.zoom+wi(o.center.lat,0),v=s.bj(1/xu(o.center.lat),1/xu(Math.min(Math.abs(o.center.lat),60)),s.bm(m,7,3,0,1)),w=360/ld({worldSize:o.worldSize,center:{lat:o.center.lat}});return new s.S(o.center.lng-u.x*w*v,s.ag(o.center.lat+u.y*w,-s.ah,s.ah))}function bu(b){const o=.5*b,u=Math.sin(o),m=Math.cos(o);return Math.log(u+m)-Math.log(m-u)}function wu(b,o,u,m){const v=b.lat+u*m;if(Math.abs(u)>1){const w=(Math.sign(b.lat+u)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,P=Math.abs(b.lat+u)*Math.PI/180,k=bu(w+m*(P-w)),F=bu(w),j=bu(P);return new s.S(b.lng+o*((k-F)/(j-F)),v)}return new s.S(b.lng+o*m,v)}class yC{constructor(o){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=o}swapBuffers(){if(!this._hadAnyChanges)return;const o=this._cachePrevious;this._cachePrevious=this._cache,this._cache=o,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(o,u,m,v){const w=`${o.z}_${o.x}_${o.y}_${v!=null&&v.terrain?"t":""}`,P=this._cache.get(w);if(P)return P;const k=this._cachePrevious.get(w);if(k)return this._cache.set(w,k),k;const F=this._boundingVolumeFactory(o,u,m,v);return this._cache.set(w,F),this._hadAnyChanges=!0,F}}class Ol{constructor(o,u,m,v){this.min=m,this.max=v,this.points=o,this.planes=u}static fromAabb(o,u){const m=[];for(let v=0;v<8;v++)m.push([1&~v?o[0]:u[0],(v>>1&1)==1?u[1]:o[1],(v>>2&1)==1?u[2]:o[2]]);return new Ol(m,[[-1,0,0,u[0]],[1,0,0,-o[0]],[0,-1,0,u[1]],[0,1,0,-o[1]],[0,0,-1,u[2]],[0,0,1,-o[2]]],o,u)}static fromCenterSizeAngles(o,u,m){const v=s.bq([],m[0],m[1],m[2]),w=s.br([],[u[0],0,0],v),P=s.br([],[0,u[1],0],v),k=s.br([],[0,0,u[2]],v),F=[...o],j=[...o];for(let J=0;J<8;J++)for(let Y=0;Y<3;Y++){const oe=o[Y]+w[Y]*(1&~J?-1:1)+P[Y]*((J>>1&1)==1?1:-1)+k[Y]*((J>>2&1)==1?1:-1);F[Y]=Math.min(F[Y],oe),j[Y]=Math.max(j[Y],oe)}const W=[];for(let J=0;J<8;J++){const Y=[...o];s.aR(Y,Y,s.aQ([],w,1&~J?-1:1)),s.aR(Y,Y,s.aQ([],P,(J>>1&1)==1?1:-1)),s.aR(Y,Y,s.aQ([],k,(J>>2&1)==1?1:-1)),W.push(Y)}return new Ol(W,[[...w,-s.aW(w,W[0])],[...P,-s.aW(P,W[0])],[...k,-s.aW(k,W[0])],[-w[0],-w[1],-w[2],-s.aW(w,W[7])],[-P[0],-P[1],-P[2],-s.aW(P,W[7])],[-k[0],-k[1],-k[2],-s.aW(k,W[7])]],F,j)}intersectsFrustum(o){let u=!0;const m=this.points.length,v=this.planes.length,w=o.planes.length,P=o.points.length;for(let k=0;k<w;k++){const F=o.planes[k];let j=0;for(let W=0;W<m;W++){const J=this.points[W];F[0]*J[0]+F[1]*J[1]+F[2]*J[2]+F[3]>=0&&j++}if(j===0)return 0;j<m&&(u=!1)}if(u)return 2;for(let k=0;k<v;k++){const F=this.planes[k];let j=0;for(let W=0;W<P;W++){const J=o.points[W];F[0]*J[0]+F[1]*J[1]+F[2]*J[2]+F[3]>=0&&j++}if(j===0)return 0}return 1}intersectsPlane(o){const u=this.points.length;let m=0;for(let v=0;v<u;v++){const w=this.points[v];o[0]*w[0]+o[1]*w[1]+o[2]*w[2]+o[3]>=0&&m++}return m===u?2:m===0?0:1}}function hd(b,o,u){const m=b-o;return m<0?-m:Math.max(0,m-u)}function Xg(b,o,u,m,v){const w=b-u;let P;return P=w<0?Math.min(-w,1+w-v):w>1?Math.min(Math.max(w-v,0),1-w):0,Math.max(P,hd(o,m,v))}class _C{constructor(){this._boundingVolumeCache=new yC(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(o,u,m,v){const w=1<<m.z,P=1/w,k=m.x/w,F=m.y/w;let j=2;return j=Math.min(j,Xg(o,u,k,F,P)),j=Math.min(j,Xg(o,u,k+.5,-F-P,P)),j=Math.min(j,Xg(o,u,k+.5,2-F-P,P)),j}getWrap(o,u,m){const v=1<<u.z,w=1/v,P=u.x/v,k=hd(o.x,P,w),F=hd(o.x,P-1,w),j=hd(o.x,P+1,w),W=Math.min(k,F,j);return W===j?1:W===F?-1:0}allowVariableZoom(o,u){return Re(o,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(o,u,m,v){return this._boundingVolumeCache.getTileBoundingVolume(o,u,m,v)}_computeTileBoundingVolume(o,u,m,v){var w,P;let k=m,F=m;if(v!=null&&v.terrain){const j=new s.Z(o.z,u,o.z,o.x,o.y),W=v.terrain.getMinMaxElevation(j);k=(w=W.minElevation)!==null&&w!==void 0?w:m,F=(P=W.maxElevation)!==null&&P!==void 0?P:m}if(k/=s.bt,F/=s.bt,k+=1,F+=1,o.z<=0)return Ol.fromAabb([-F,-F,-F],[F,F,F]);if(o.z===1)return Ol.fromAabb([o.x===0?-F:0,o.y===0?0:-F,-F],[o.x===0?0:F,o.y===0?F:0,F]);{const j=[Ys(0,0,o.x,o.y,o.z),Ys(s.$,0,o.x,o.y,o.z),Ys(s.$,s.$,o.x,o.y,o.z),Ys(0,s.$,o.x,o.y,o.z)],W=[];for(const pt of j)W.push(s.aQ([],pt,F));if(F!==k)for(const pt of j)W.push(s.aQ([],pt,k));o.y===0&&W.push([0,1,0]),o.y===(1<<o.z)-1&&W.push([0,-1,0]);const J=[1,1,1],Y=[-1,-1,-1];for(const pt of W)for(let _t=0;_t<3;_t++)J[_t]=Math.min(J[_t],pt[_t]),Y[_t]=Math.max(Y[_t],pt[_t]);const oe=Ys(s.$/2,s.$/2,o.x,o.y,o.z),he=s.aV([],[0,1,0],oe);s.aU(he,he);const Pe=s.aV([],oe,he);s.aU(Pe,Pe);const Ee=s.aV([],j[2],j[1]);s.aU(Ee,Ee);const Ae=s.aV([],j[0],j[3]);s.aU(Ae,Ae),W.push(s.aQ([],oe,F)),o.y>=(1<<o.z)/2&&W.push(s.aQ([],Ys(s.$/2,0,o.x,o.y,o.z),F)),o.y<(1<<o.z)/2&&W.push(s.aQ([],Ys(s.$/2,s.$,o.x,o.y,o.z),F));const Fe=Ro(oe,W),He=Ro(Pe,W),Ne=[-oe[0],-oe[1],-oe[2],Fe.max],Ye=[oe[0],oe[1],oe[2],-Fe.min],Ke=[-Pe[0],-Pe[1],-Pe[2],He.max],Ue=[Pe[0],Pe[1],Pe[2],-He.min],rt=[...Ee,0],yt=[...Ae,0],ht=[];return o.y===0?ht.push(s.bs(yt,rt,Ne),s.bs(yt,rt,Ye)):ht.push(s.bs(Ke,rt,Ne),s.bs(Ke,rt,Ye),s.bs(Ke,yt,Ne),s.bs(Ke,yt,Ye)),o.y===(1<<o.z)-1?ht.push(s.bs(yt,rt,Ne),s.bs(yt,rt,Ye)):ht.push(s.bs(Ue,rt,Ne),s.bs(Ue,rt,Ye),s.bs(Ue,yt,Ne),s.bs(Ue,yt,Ye)),new Ol(ht,[Ne,Ye,Ke,Ue,rt,yt],J,Y)}}}function Ro(b,o){let u=1/0,m=-1/0;for(const v of o){const w=s.aW(b,v);u=Math.min(u,w),m=Math.max(m,w)}return{min:u,max:m}}class Su{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,m){return this._helper.interpolatePadding(o,u,m)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u){this._helper.resize(o,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o){}constructor(){this._cachedClippingPlane=s.bu(),this._projectionMatrix=s.b8(),this._globeViewProjMatrix32f=s.b7(),this._globeViewProjMatrixNoCorrection=s.b8(),this._globeViewProjMatrixNoCorrectionInverted=s.b8(),this._globeProjMatrixInverted=s.b8(),this._cameraPosition=s.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new sd({calcMatrices:()=>{this._calcMatrices()},getConstrained:(o,u)=>this.getConstrained(o,u)}),this._coveringTilesDetailsProvider=new _C}clone(){const o=new Su;return o.apply(this),o}apply(o,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(o)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const o=s.bo();return o[0]=this._cameraPosition[0],o[1]=this._cameraPosition[1],o[2]=this._cameraPosition[2],o}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(o){const{overscaledTileID:u,applyGlobeMatrix:m}=o,v=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:v,clippingPlane:this._cachedClippingPlane,projectionTransition:m?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(o){const u=this.pitchInRadians,m=this.cameraToCenterDistance/o,v=Math.sin(u)*m,w=Math.cos(u)*m+1,P=1/Math.sqrt(v*v+w*w)*1;let k=-v,F=w;const j=Math.sqrt(k*k+F*F);k/=j,F/=j;const W=[0,k,F];s.bv(W,W,[0,0,0],-this.bearingInRadians),s.bw(W,W,[0,0,0],-1*this.center.lat*Math.PI/180),s.bx(W,W,[0,0,0],this.center.lng*Math.PI/180);const J=1/s.aY(W);return s.aQ(W,W,J),[...W,-P*J]}isLocationOccluded(o){return!this.isSurfacePointVisible(ji(o))}transformLightDirection(o){const u=this._helper._center.lng*Math.PI/180,m=this._helper._center.lat*Math.PI/180,v=Math.cos(m),w=[Math.sin(u)*v,Math.sin(m),Math.cos(u)*v],P=[w[2],0,-w[0]],k=[0,0,0];s.aV(k,P,w),s.aU(P,P),s.aU(k,k);const F=[0,0,0];return s.aU(F,[P[0]*o[0]+k[0]*o[1]+w[0]*o[2],P[1]*o[0]+k[1]*o[1]+w[1]*o[2],P[2]*o[0]+k[2]*o[1]+w[2]*o[2]]),F}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(o,u,m){const v=function(k,F,j){const W=1/(1<<j.z);return new s.a0(k/s.$*W+j.x*W,F/s.$*W+j.y*W)}(o,u,m.canonical),w=(P=v.y,[s.bn(v.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-P*Math.PI*2))-.5*Math.PI]);var P;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(o,u,m,v){const w=m.canonical,P=Ys(o,u,w.x,w.y,w.z),k=1+(v?v(o,u):0)/s.bt,F=[P[0]*k,P[1]*k,P[2]*k,1];s.av(F,F,this._globeViewProjMatrixNoCorrection);const j=this._cachedClippingPlane,W=j[0]*P[0]+j[1]*P[1]+j[2]*P[2]+j[3]<0;return{point:new s.P(F[0]/F[3],F[1]/F[3]),signedDistanceFromCamera:F[3],isOccluded:W}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const o=_u(this.worldSize,this.center.lat),u=s.b9(),m=s.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*o),s.b3(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const v=this.centerOffset;u[8]=2*-v.x/this._helper._width,u[9]=2*v.y/this._helper._height,this._projectionMatrix=s.b4(u),this._globeProjMatrixInverted=s.b9(),s.ap(this._globeProjMatrixInverted,u),s.M(u,u,[0,0,-this.cameraToCenterDistance]),s.b5(u,u,this.rollInRadians),s.b6(u,u,-this.pitchInRadians),s.b5(u,u,this.bearingInRadians),s.M(u,u,[0,0,-o]);const w=s.bo();w[0]=o,w[1]=o,w[2]=o,s.b6(m,u,this.center.lat*Math.PI/180),s.by(m,m,-this.center.lng*Math.PI/180),s.N(m,m,w),this._globeViewProjMatrixNoCorrection=m,s.b6(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.by(u,u,-this.center.lng*Math.PI/180),s.N(u,u,w),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=s.b9(),s.ap(this._globeViewProjMatrixNoCorrectionInverted,m);const P=s.bo();this._cameraPosition=s.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/o,s.bv(this._cameraPosition,this._cameraPosition,P,-this.rollInRadians),s.bw(this._cameraPosition,this._cameraPosition,P,this.pitchInRadians),s.bv(this._cameraPosition,this._cameraPosition,P,-this.bearingInRadians),s.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bw(this._cameraPosition,this._cameraPosition,P,-this.center.lat*Math.PI/180),s.bx(this._cameraPosition,this._cameraPosition,P,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(o);const k=s.b4(this._globeViewProjMatrixNoCorrectionInverted);s.N(k,k,[1,1,-1]),this._cachedFrustum=go.fromInvProjectionMatrix(k,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(o){s.w("calculateFogMatrix is not supported on globe projection.");const u=s.b9();return s.af(u),u}getVisibleUnwrappedCoordinates(o){return[new s.b1(0,o)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){o&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const m=ji(o);s.aQ(m,m,1+u/s.bt);const v=s.bu();return s.av(v,[m[0],m[1],m[2],1],this._globeViewProjMatrixNoCorrection),v[2]/v[3]}populateCache(o){}getBounds(){const o=.5*this.width,u=.5*this.height,m=[new s.P(0,0),new s.P(o,0),new s.P(this.width,0),new s.P(this.width,u),new s.P(this.width,this.height),new s.P(o,this.height),new s.P(0,this.height),new s.P(0,u)],v=[];for(const J of m)v.push(this.unprojectScreenPoint(J));let w=0,P=0,k=0,F=0;const j=this.center;for(const J of v){const Y=s.bz(j.lng,J.lng),oe=s.bz(j.lat,J.lat);Y<P&&(P=Y),Y>w&&(w=Y),oe<F&&(F=oe),oe>k&&(k=oe)}const W=[j.lng+P,j.lat+F,j.lng+w,j.lat+k];return this.isSurfacePointOnScreen([0,1,0])&&(W[3]=90,W[0]=-180,W[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(W[1]=-90,W[0]=-180,W[2]=180),new hn(W)}getConstrained(o,u){const m=s.ag(o.lat,-s.ah,s.ah),v=s.ag(+u,this.minZoom+wi(0,m),this.maxZoom);return{center:new s.S(o.lng,m),zoom:v}}calculateCenterFromCameraLngLatAlt(o,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,m,v)}setLocationAtPoint(o,u){const m=ji(this.unprojectScreenPoint(u)),v=ji(o),w=s.bo();s.bA(w);const P=s.bo();s.bx(P,m,w,-this.center.lng*Math.PI/180),s.bw(P,P,w,this.center.lat*Math.PI/180);const k=v[0]*v[0]+v[2]*v[2],F=P[0]*P[0];if(k<F)return;const j=Math.sqrt(k-F),W=-j,J=s.bB(v[0],v[2],P[0],j),Y=s.bB(v[0],v[2],P[0],W),oe=s.bo();s.bx(oe,v,w,-J);const he=s.bB(oe[1],oe[2],P[1],P[2]),Pe=s.bo();s.bx(Pe,v,w,-Y);const Ee=s.bB(Pe[1],Pe[2],P[1],P[2]),Ae=.5*Math.PI,Fe=he>=-Ae&&he<=Ae,He=Ee>=-Ae&&Ee<=Ae;let Ne,Ye;if(Fe&&He){const yt=this.center.lng*Math.PI/180,ht=this.center.lat*Math.PI/180;s.bC(J,yt)+s.bC(he,ht)<s.bC(Y,yt)+s.bC(Ee,ht)?(Ne=J,Ye=he):(Ne=Y,Ye=Ee)}else if(Fe)Ne=J,Ye=he;else{if(!He)return;Ne=Y,Ye=Ee}const Ke=Ne/Math.PI*180,Ue=Ye/Math.PI*180,rt=this.center.lat;this.setCenter(new s.S(Ke,s.ag(Ue,-90,90))),this.setZoom(this.zoom+wi(rt,this.center.lat))}locationToScreenPoint(o,u){const m=ji(o);if(u){const v=u.getElevationForLngLatZoom(o,this._helper._tileZoom);s.aQ(m,m,1+v/s.bt)}return this._projectSurfacePointToScreen(m)}_projectSurfacePointToScreen(o){const u=s.bu();return s.av(u,[...o,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new s.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(o,u){if(u){const m=u.pointCoordinate(o);if(m)return m}return s.a0.fromLngLat(this.unprojectScreenPoint(o))}screenPointToLocation(o,u){var m;return(m=this.screenPointToMercatorCoordinate(o,u))===null||m===void 0?void 0:m.toLngLat()}isPointOnMapSurface(o,u){const m=this._cameraPosition,v=this.getRayDirectionFromPixel(o);return!!this.rayPlanetIntersection(m,v)}getRayDirectionFromPixel(o){const u=s.bu();u[0]=o.x/this.width*2-1,u[1]=-1*(o.y/this.height*2-1),u[2]=1,u[3]=1,s.av(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const m=s.bo();m[0]=u[0]-this._cameraPosition[0],m[1]=u[1]-this._cameraPosition[1],m[2]=u[2]-this._cameraPosition[2];const v=s.bo();return s.aU(v,m),v}isSurfacePointVisible(o){const u=this._cachedClippingPlane;return u[0]*o[0]+u[1]*o[1]+u[2]*o[2]+u[3]>=0}isSurfacePointOnScreen(o){if(!this.isSurfacePointVisible(o))return!1;const u=s.bu();return s.av(u,[...o,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(o,u){const m=s.aW(o,u),v=s.bo(),w=s.bo();s.aQ(w,u,m),s.aT(v,o,w);const P=1-s.aW(v,v);if(P<0)return null;const k=s.aW(o,o)-1,F=-m+(m<0?1:-1)*Math.sqrt(P),j=k/F,W=F;return{tMin:Math.min(j,W),tMax:Math.max(j,W)}}unprojectScreenPoint(o){const u=this._cameraPosition,m=this.getRayDirectionFromPixel(o),v=this.rayPlanetIntersection(u,m);if(v){const W=s.bo();s.aR(W,u,[m[0]*v.tMin,m[1]*v.tMin,m[2]*v.tMin]);const J=s.bo();return s.aU(J,W),cd(J)}const w=this._cachedClippingPlane,P=w[0]*m[0]+w[1]*m[1]+w[2]*m[2],k=-s.b0(w,u)/P,F=s.bo();if(k>0)s.aR(F,u,[m[0]*k,m[1]*k,m[2]*k]);else{const W=s.bo();s.aR(W,u,[2*m[0],2*m[1],2*m[2]]);const J=s.b0(this._cachedClippingPlane,W);s.aT(F,W,[this._cachedClippingPlane[0]*J,this._cachedClippingPlane[1]*J,this._cachedClippingPlane[2]*J])}const j=function(W){const J=s.bo();return J[0]=W[0]*-W[3],J[1]=W[1]*-W[3],J[2]=W[2]*-W[3],{center:J,radius:Math.sqrt(1-W[3]*W[3])}}(w);return cd(function(W,J,Y){const oe=s.bo();s.aT(oe,Y,W);const he=s.bo();return s.bp(he,W,oe,J/s.a_(oe)),he}(j.center,j.radius,F))}getMatrixForModel(o,u){const m=s.S.convert(o),v=1/s.bt,w=s.b8();return s.by(w,w,m.lng/180*Math.PI),s.b6(w,w,-m.lat/180*Math.PI),s.M(w,w,[0,0,1+u/s.bt]),s.b6(w,w,.5*Math.PI),s.N(w,w,[v,v,v]),w}getProjectionDataForCustomLayer(o=!0){const u=this.getProjectionData({overscaledTileID:new s.Z(0,0,0,0,0),applyGlobeMatrix:o});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(o){}}class cs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,m){return this._helper.interpolatePadding(o,u,m)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u,m=!0){this._helper.resize(o,u,m)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(o,u){this._globeness=o,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new sd({calcMatrices:()=>{this._calcMatrices()},getConstrained:(o,u)=>this.getConstrained(o,u)}),this._globeness=1,this._mercatorTransform=new bi,this._verticalPerspectiveTransform=new Su}clone(){const o=new cs;return o._globeness=this._globeness,o._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,o.apply(this),o}apply(o){this._helper.apply(o),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(o){const u=this._mercatorTransform.getProjectionData(o),m=this._verticalPerspectiveTransform.getProjectionData(o);return{mainMatrix:this.isGlobeRendering?m.mainMatrix:u.mainMatrix,clippingPlane:m.clippingPlane,tileMercatorCoords:m.tileMercatorCoords,projectionTransition:o.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(o){return this.currentTransform.isLocationOccluded(o)}transformLightDirection(o){return this.currentTransform.transformLightDirection(o)}getPixelScale(){return s.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(o,u,m){const v=this._mercatorTransform.getPitchedTextCorrection(o,u,m),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(o,u,m);return s.bj(v,w,this._globeness)}projectTileCoordinates(o,u,m,v){return this.currentTransform.projectTileCoordinates(o,u,m,v)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(o){return this.currentTransform.calculateFogMatrix(o)}getVisibleUnwrappedCoordinates(o){return this.currentTransform.getVisibleUnwrappedCoordinates(o)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(o){this._mercatorTransform.recalculateZoomAndCenter(o),this._verticalPerspectiveTransform.recalculateZoomAndCenter(o)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,u){return this.currentTransform.lngLatToCameraDepth(o,u)}populateCache(o){this._mercatorTransform.populateCache(o),this._verticalPerspectiveTransform.populateCache(o)}getBounds(){return this.currentTransform.getBounds()}getConstrained(o,u){return this.currentTransform.getConstrained(o,u)}calculateCenterFromCameraLngLatAlt(o,u,m,v){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,m,v)}setLocationAtPoint(o,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(o,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(o,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(o,u){return this.currentTransform.locationToScreenPoint(o,u)}screenPointToMercatorCoordinate(o,u){return this.currentTransform.screenPointToMercatorCoordinate(o,u)}screenPointToLocation(o,u){return this.currentTransform.screenPointToLocation(o,u)}isPointOnMapSurface(o,u){return this.currentTransform.isPointOnMapSurface(o,u)}getRayDirectionFromPixel(o){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(o)}getMatrixForModel(o,u){return this.currentTransform.getMatrixForModel(o,u)}getProjectionDataForCustomLayer(o=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(o);if(!this.isGlobeRendering)return u;const m=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(o);return m.fallbackMatrix=u.mainMatrix,m}getFastPathSimpleProjectionMatrix(o){return this.currentTransform.getFastPathSimpleProjectionMatrix(o)}}class Zo{get useGlobeControls(){return!0}handlePanInertia(o,u){const m=ud(o,u);return Math.abs(m.lng-u.center.lng)>180&&(m.lng=u.center.lng+179.5*Math.sign(m.lng-u.center.lng)),{easingCenter:m,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(o,u){const m=o.around,v=u.screenPointToLocation(m);o.bearingDelta&&u.setBearing(u.bearing+o.bearingDelta),o.pitchDelta&&u.setPitch(u.pitch+o.pitchDelta),o.rollDelta&&u.setRoll(u.roll+o.rollDelta);const w=u.zoom;o.zoomDelta&&u.setZoom(u.zoom+o.zoomDelta);const P=u.zoom-w;if(P===0)return;const k=s.bz(u.center.lng,v.lng),F=k/(Math.abs(k/180)+1),j=s.bz(u.center.lat,v.lat),W=u.getRayDirectionFromPixel(m),J=u.cameraPosition,Y=-1*s.aW(J,W),oe=s.bo();s.aR(oe,J,[W[0]*Y,W[1]*Y,W[2]*Y]);const he=s.aY(oe)-1,Pe=Math.exp(.5*-Math.max(he-.3,0)),Ee=_u(u.worldSize,u.center.lat)/Math.min(u.width,u.height),Ae=s.bm(Ee,.9,.5,1,.25),Fe=(1-s.ae(-P))*Math.min(Pe,Ae),He=u.center.lat,Ne=u.zoom,Ye=new s.S(u.center.lng+F*Fe,s.ag(u.center.lat+j*Fe,-s.ah,s.ah));u.setLocationAtPoint(v,m);const Ke=u.center,Ue=s.bm(Math.abs(k),45,85,0,1),rt=s.bm(Ee,.75,.35,0,1),yt=Math.pow(Math.max(Ue,rt),.25),ht=s.bz(Ke.lng,Ye.lng),pt=s.bz(Ke.lat,Ye.lat);u.setCenter(new s.S(Ke.lng+ht*yt,Ke.lat+pt*yt).wrap()),u.setZoom(Ne+wi(He,u.center.lat))}handleMapControlsPan(o,u,m){if(!o.panDelta)return;const v=u.center.lat,w=u.zoom;u.setCenter(ud(o.panDelta,u).wrap()),u.setZoom(w+wi(v,u.center.lat))}cameraForBoxAndBearing(o,u,m,v,w){const P=Qr(o,u,m,v,w),k=u.left/w.width*2-1,F=(w.width-u.right)/w.width*2-1,j=u.top/w.height*-2+1,W=(w.height-u.bottom)/w.height*-2+1,J=s.bz(m.getWest(),m.getEast())<0,Y=J?m.getEast():m.getWest(),oe=J?m.getWest():m.getEast(),he=Math.max(m.getNorth(),m.getSouth()),Pe=Math.min(m.getNorth(),m.getSouth()),Ee=Y+.5*s.bz(Y,oe),Ae=he+.5*s.bz(he,Pe),Fe=w.clone();Fe.setCenter(P.center),Fe.setBearing(P.bearing),Fe.setPitch(0),Fe.setRoll(0),Fe.setZoom(P.zoom);const He=Fe.modelViewProjectionMatrix,Ne=[ji(m.getNorthWest()),ji(m.getNorthEast()),ji(m.getSouthWest()),ji(m.getSouthEast()),ji(new s.S(oe,Ae)),ji(new s.S(Y,Ae)),ji(new s.S(Ee,he)),ji(new s.S(Ee,Pe))],Ye=ji(P.center);let Ke=Number.POSITIVE_INFINITY;for(const Ue of Ne)k<0&&(Ke=Zo.getLesserNonNegativeNonNull(Ke,Zo.solveVectorScale(Ue,Ye,He,"x",k))),F>0&&(Ke=Zo.getLesserNonNegativeNonNull(Ke,Zo.solveVectorScale(Ue,Ye,He,"x",F))),j>0&&(Ke=Zo.getLesserNonNegativeNonNull(Ke,Zo.solveVectorScale(Ue,Ye,He,"y",j))),W<0&&(Ke=Zo.getLesserNonNegativeNonNull(Ke,Zo.solveVectorScale(Ue,Ye,He,"y",W)));if(Number.isFinite(Ke)&&Ke!==0)return P.zoom=Fe.zoom+s.aj(Ke),P;vo()}handleJumpToCenterZoom(o,u){const m=o.center.lat,v=o.getConstrained(u.center?s.S.convert(u.center):o.center,o.zoom).center;o.setCenter(v.wrap());const w=u.zoom!==void 0?+u.zoom:o.zoom+wi(m,v.lat);o.zoom!==w&&o.setZoom(w)}handleEaseTo(o,u){const m=o.zoom,v=o.center,w=o.padding,P={roll:o.roll,pitch:o.pitch,bearing:o.bearing},k={roll:u.roll===void 0?o.roll:u.roll,pitch:u.pitch===void 0?o.pitch:u.pitch,bearing:u.bearing===void 0?o.bearing:u.bearing},F=u.zoom!==void 0,j=!o.isPaddingEqual(u.padding);let W=!1;const J=u.center?s.S.convert(u.center):v,Y=o.getConstrained(J,m).center;ol(o,Y);const oe=o.clone();oe.setCenter(Y),oe.setZoom(F?+u.zoom:m+wi(v.lat,J.lat)),oe.setBearing(u.bearing);const he=new s.P(s.ag(o.centerPoint.x+u.offsetAsPoint.x,0,o.width),s.ag(o.centerPoint.y+u.offsetAsPoint.y,0,o.height));oe.setLocationAtPoint(Y,he);const Pe=(u.offset&&u.offsetAsPoint.mag())>0?oe.center:Y,Ee=F?+u.zoom:m+wi(v.lat,Pe.lat),Ae=m+wi(v.lat,0),Fe=Ee+wi(Pe.lat,0),He=s.bz(v.lng,Pe.lng),Ne=s.bz(v.lat,Pe.lat),Ye=s.ae(Fe-Ae);return W=Ee!==m,{easeFunc:Ke=>{if(s.bd(P,k)||Vi({startEulerAngles:P,endEulerAngles:k,tr:o,k:Ke,useSlerp:P.roll!=k.roll}),j&&o.interpolatePadding(w,u.padding,Ke),u.around)s.w("Easing around a point is not supported under globe projection."),o.setLocationAtPoint(u.around,u.aroundPoint);else{const Ue=Fe>Ae?Math.min(2,Ye):Math.max(.5,Ye),rt=Math.pow(Ue,1-Ke),yt=wu(v,He,Ne,Ke*rt);o.setCenter(yt.wrap())}if(W){const Ue=s.C.number(Ae,Fe,Ke)+wi(0,o.center.lat);o.setZoom(Ue)}},isZooming:W,elevationCenter:Pe}}handleFlyTo(o,u){const m=u.zoom!==void 0,v=o.center,w=o.zoom,P=o.padding,k=!o.isPaddingEqual(u.padding),F=o.getConstrained(s.S.convert(u.center||u.locationAtOffset),w).center,j=m?+u.zoom:o.zoom+wi(o.center.lat,F.lat),W=o.clone();W.setCenter(F),W.setZoom(j),W.setBearing(u.bearing);const J=new s.P(s.ag(o.centerPoint.x+u.offsetAsPoint.x,0,o.width),s.ag(o.centerPoint.y+u.offsetAsPoint.y,0,o.height));W.setLocationAtPoint(F,J);const Y=W.center;ol(o,Y);const oe=function(Ne,Ye,Ke){const Ue=ji(Ye),rt=ji(Ke),yt=s.aW(Ue,rt),ht=Math.acos(yt),pt=ld(Ne);return ht/(2*Math.PI)*pt}(o,v,Y),he=w+wi(v.lat,0),Pe=j+wi(Y.lat,0),Ee=s.ae(Pe-he);let Ae;if(typeof u.minZoom=="number"){const Ne=+u.minZoom+wi(Y.lat,0),Ye=Math.min(Ne,he,Pe)+wi(0,Y.lat),Ke=o.getConstrained(Y,Ye).zoom+wi(Y.lat,0);Ae=s.ae(Ke-he)}const Fe=s.bz(v.lng,Y.lng),He=s.bz(v.lat,Y.lat);return{easeFunc:(Ne,Ye,Ke,Ue)=>{const rt=wu(v,Fe,He,Ke);k&&o.interpolatePadding(P,u.padding,Ne);const yt=Ne===1?Y:rt;o.setCenter(yt.wrap());const ht=he+s.aj(Ye);o.setZoom(Ne===1?j:ht+wi(0,yt.lat))},scaleOfZoom:Ee,targetCenter:Y,scaleOfMinZoom:Ae,pixelPathLength:oe}}static solveVectorScale(o,u,m,v,w){const P=v==="x"?[m[0],m[4],m[8],m[12]]:[m[1],m[5],m[9],m[13]],k=[m[3],m[7],m[11],m[15]],F=o[0]*P[0]+o[1]*P[1]+o[2]*P[2],j=o[0]*k[0]+o[1]*k[1]+o[2]*k[2],W=u[0]*P[0]+u[1]*P[1]+u[2]*P[2],J=u[0]*k[0]+u[1]*k[1]+u[2]*k[2];return W+w*j===F+w*J||k[3]*(F-W)+P[3]*(J-j)+F*J==W*j?null:(W+P[3]-w*J-w*k[3])/(W-F-w*J+w*j)}static getLesserNonNegativeNonNull(o,u){return u!==null&&u>=0&&u<o?u:o}}class Zg{constructor(o){this._globe=o,this._mercatorCameraHelper=new Wf,this._verticalPerspectiveCameraHelper=new Zo}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(o,u){return this.currentHelper.handlePanInertia(o,u)}handleMapControlsRollPitchBearingZoom(o,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(o,u)}handleMapControlsPan(o,u,m){this.currentHelper.handleMapControlsPan(o,u,m)}cameraForBoxAndBearing(o,u,m,v,w){return this.currentHelper.cameraForBoxAndBearing(o,u,m,v,w)}handleJumpToCenterZoom(o,u){this.currentHelper.handleJumpToCenterZoom(o,u)}handleEaseTo(o,u){return this.currentHelper.handleEaseTo(o,u)}handleFlyTo(o,u){return this.currentHelper.handleFlyTo(o,u)}}const dd=(b,o)=>s.y(b,o&&o.filter(u=>u.identifier!=="source.canvas")),Mu=s.bD();class Yg extends s.E{constructor(o,u={}){super(),this._rtlPluginLoaded=()=>{for(const m in this.sourceCaches){const v=this.sourceCaches[m].getSource().type;v!=="vector"&&v!=="geojson"||this.sourceCaches[m].reload()}},this.map=o,this.dispatcher=new Ot(lt(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(m,v)=>this.getGlyphs(m,v)),this.dispatcher.registerMessageHandler("GI",(m,v)=>this.getImages(m,v)),this.imageManager=new K,this.imageManager.setEventedParent(this),this.glyphManager=new ge(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new Be(256,512),this.crossTileSymbolIndex=new Ii,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",s.bF()),Zt().on(St,this._rtlPluginLoaded),this.on("data",m=>{if(m.dataType!=="source"||m.sourceDataType!=="metadata")return;const v=this.sourceCaches[m.sourceId];if(!v)return;const w=v.getSource();if(w&&w.vectorLayerIds)for(const P in this._layers){const k=this._layers[P];k.source===w.id&&this._validateLayer(k)}})}setGlobalStateProperty(o,u){var m,v,w;this._checkLoaded();const P=u===null?(w=(v=(m=this.stylesheet.state)===null||m===void 0?void 0:m[o])===null||v===void 0?void 0:v.default)!==null&&w!==void 0?w:null:u;if(s.bG(P,this._globalState[o]))return this;this._globalState[o]=P;const k=this._findGlobalStateAffectedSources([o]);for(const F in this.sourceCaches)k.has(F)&&(this._reloadSource(F),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(o){this._checkLoaded();const u=[];for(const v in o)!s.bG(this._globalState[v],o[v].default)&&(u.push(v),this._globalState[v]=o[v].default);const m=this._findGlobalStateAffectedSources(u);for(const v in this.sourceCaches)m.has(v)&&(this._reloadSource(v),this._changed=!0)}_findGlobalStateAffectedSources(o){if(o.length===0)return new Set;const u=new Set;for(const m in this._layers){const v=this._layers[m],w=v.getLayoutAffectingGlobalStateRefs();for(const P of o)w.has(P)&&u.add(v.source)}return u}loadURL(o,u={},m){this.fire(new s.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const v=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;s.j(v,this._loadStyleRequest).then(P=>{this._loadStyleRequest=null,this._load(P.data,u,m)}).catch(P=>{this._loadStyleRequest=null,P&&!w.signal.aborted&&this.fire(new s.k(P))})}loadJSON(o,u={},m){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,C.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(o,u,m)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(Mu,{validate:!1})}_load(o,u,m){var v,w,P;const k=u.transformStyle?u.transformStyle(m,o):o;if(!u.validate||!dd(this,s.z(k))){this._loaded=!0,this.stylesheet=k;for(const F in k.sources)this.addSource(F,k.sources[F],{validate:!1});k.sprite?this._loadSprite(k.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(k.glyphs),this._createLayers(),this.light=new ve(this.stylesheet.light),this._setProjectionInternal(((v=this.stylesheet.projection)===null||v===void 0?void 0:v.type)||"mercator"),this.sky=new Me(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.setGlobalState((P=this.stylesheet.state)!==null&&P!==void 0?P:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){const o=s.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",o),this._order=o.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of o){const m=s.bI(u);m.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=m}}_loadSprite(o,u=!1,m=void 0){let v;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,P,k,F){return s._(this,void 0,void 0,function*(){const j=V(w),W=k>1?"@2x":"",J={},Y={};for(const{id:oe,url:he}of j){const Pe=P.transformRequest(q(he,W,".json"),"SpriteJSON");J[oe]=s.j(Pe,F);const Ee=P.transformRequest(q(he,W,".png"),"SpriteImage");Y[oe]=U.getImage(Ee,F)}return yield Promise.all([...Object.values(J),...Object.values(Y)]),function(oe,he){return s._(this,void 0,void 0,function*(){const Pe={};for(const Ee in oe){Pe[Ee]={};const Ae=C.getImageCanvasContext((yield he[Ee]).data),Fe=(yield oe[Ee]).data;for(const He in Fe){const{width:Ne,height:Ye,x:Ke,y:Ue,sdf:rt,pixelRatio:yt,stretchX:ht,stretchY:pt,content:_t,textFitWidth:sn,textFitHeight:rn}=Fe[He];Pe[Ee][He]={data:null,pixelRatio:yt,sdf:rt,stretchX:ht,stretchY:pt,content:_t,textFitWidth:sn,textFitHeight:rn,spriteData:{width:Ne,height:Ye,x:Ke,y:Ue,context:Ae}}}}return Pe})}(J,Y)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const P in w){this._spritesImagesIds[P]=[];const k=this._spritesImagesIds[P]?this._spritesImagesIds[P].filter(F=>!(F in w)):[];for(const F of k)this.imageManager.removeImage(F),this._changedImages[F]=!0;for(const F in w[P]){const j=P==="default"?F:`${P}:${F}`;this._spritesImagesIds[P].push(j),j in this.imageManager.images?this.imageManager.updateImage(j,w[P][F],!1):this.imageManager.addImage(j,w[P][F]),u&&(this._changedImages[j]=!0)}}}).catch(w=>{this._spriteRequest=null,v=w,this.fire(new s.k(v))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),m&&m(v)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(o){const u=this.sourceCaches[o.source];if(!u)return;const m=o.sourceLayer;if(!m)return;const v=u.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(m)===-1)&&this.fire(new s.k(new Error(`Source layer "${m}" does not exist on source "${v.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o,u=!1){const m=this._serializedAllLayers();if(!o||o.length===0)return Object.values(u?s.bJ(m):m);const v=[];for(const w of o)if(m[w]){const P=u?s.bJ(m[w]):m[w];v.push(P)}return v}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const u=Object.keys(this._layers);for(const m of u){const v=this._layers[m];v.type!=="custom"&&(o[m]=v.serialize())}return o}hasTransitions(){var o,u,m;if(!((o=this.light)===null||o===void 0)&&o.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((m=this.projection)===null||m===void 0)&&m.hasTransition())return!0;for(const v in this.sourceCaches)if(this.sourceCaches[v].hasTransition())return!0;for(const v in this._layers)if(this._layers[v].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const u=this._changed;if(u){const v=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(v.length||w.length)&&this._updateWorkerLayers(v,w);for(const P in this._updatedSources){const k=this._updatedSources[P];if(k==="reload")this._reloadSource(P);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(P)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const m={};for(const v in this.sourceCaches){const w=this.sourceCaches[v];m[v]=w.used,w.used=!1}for(const v of this._order){const w=this._layers[v];w.recalculate(o,this._availableImages),!w.isHidden(o.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const v in m){const w=this.sourceCaches[v];!!m[v]!=!!w.used&&w.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(o),this.sky.recalculate(o),this.projection.recalculate(o),this.z=o.zoom,u&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,u={}){var m;this._checkLoaded();const v=this.serialize();if(o=u.transformStyle?u.transformStyle(v,o):o,((m=u.validate)===null||m===void 0||m)&&dd(this,s.z(o)))return!1;(o=s.bJ(o)).layers=s.bH(o.layers);const w=s.bK(v,o),P=this._getOperationsToPerform(w);if(P.unimplemented.length>0)throw new Error(`Unimplemented: ${P.unimplemented.join(", ")}.`);if(P.operations.length===0)return!1;for(const k of P.operations)k();return this.stylesheet=o,this._serializedLayers=null,!0}_getOperationsToPerform(o){const u=[],m=[];for(const v of o)switch(v.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,v.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,v.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,v.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,v.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,v.args));break;case"addSource":u.push(()=>this.addSource.apply(this,v.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,v.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,v.args));break;case"setLight":u.push(()=>this.setLight.apply(this,v.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,v.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,v.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,v.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,v.args));break;case"setSky":u.push(()=>this.setSky.apply(this,v.args));break;case"setProjection":this.setProjection.apply(this,v.args);break;case"setGlobalState":u.push(()=>this.setGlobalState.apply(this,v.args));break;case"setTransition":u.push(()=>{});break;default:m.push(v.command)}return{operations:u,unimplemented:m}}addImage(o,u){if(this.getImage(o))return this.fire(new s.k(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,u),this._afterImageUpdated(o)}updateImage(o,u){this.imageManager.updateImage(o,u)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new s.k(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,u,m={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.z.source,`sources.${o}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const v=this.sourceCaches[o]=new Je(o,u,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:v.loaded(),source:v.serialize(),sourceId:o})),v.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===o)return this.fire(new s.k(new Error(`Source "${o}" cannot be removed while layer "${m}" is using it.`)));const u=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],u.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,u){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const m=this.sourceCaches[o].getSource();if(m.type!=="geojson")throw new Error(`geojsonSource.type is ${m.type}, which is !== 'geojson`);m.setData(u),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,u,m={}){this._checkLoaded();const v=o.id;if(this.getLayer(v))return void this.fire(new s.k(new Error(`Layer "${v}" already exists on this map.`)));let w;if(o.type==="custom"){if(dd(this,s.bL(o)))return;w=s.bI(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(v,o.source),o=s.bJ(o),o=s.e(o,{source:v})),this._validate(s.z.layer,`layers.${v}`,o,{arrayIndex:-1},m))return;w=s.bI(o),this._validateLayer(w),w.setEventedParent(this,{layer:{id:v}})}const P=u?this._order.indexOf(u):this._order.length;if(u&&P===-1)this.fire(new s.k(new Error(`Cannot add layer "${v}" before non-existing layer "${u}".`)));else{if(this._order.splice(P,0,v),this._layerOrderChanged=!0,this._layers[v]=w,this._removedLayers[v]&&w.source&&w.type!=="custom"){const k=this._removedLayers[v];delete this._removedLayers[v],k.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(o,u){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new s.k(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===u)return;const m=this._order.indexOf(o);this._order.splice(m,1);const v=u?this._order.indexOf(u):this._order.length;u&&v===-1?this.fire(new s.k(new Error(`Cannot move layer "${o}" before non-existing layer "${u}".`))):(this._order.splice(v,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const u=this._layers[o];if(!u)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${o}".`)));u.setEventedParent(null);const m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,u,m){this._checkLoaded();const v=this.getLayer(o);v?v.minzoom===u&&v.maxzoom===m||(u!=null&&(v.minzoom=u),m!=null&&(v.maxzoom=m),this._updateLayer(v)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,u,m={}){this._checkLoaded();const v=this.getLayer(o);if(v){if(!s.bG(v.filter,u))return u==null?(v.setFilter(void 0),void this._updateLayer(v)):void(this._validate(s.z.filter,`layers.${v.id}.filter`,u,null,m)||(v.setFilter(s.bJ(u)),this._updateLayer(v)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return s.bJ(this.getLayer(o).filter)}setLayoutProperty(o,u,m,v={}){this._checkLoaded();const w=this.getLayer(o);w?s.bG(w.getLayoutProperty(u),m)||(w.setLayoutProperty(u,m,v),this._updateLayer(w)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,u){const m=this.getLayer(o);if(m)return m.getLayoutProperty(u);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,u,m,v={}){this._checkLoaded();const w=this.getLayer(o);w?s.bG(w.getPaintProperty(u),m)||(w.setPaintProperty(u,m,v)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[o]=!0,this._serializedLayers=null):this.fire(new s.k(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,u){return this.getLayer(o).getPaintProperty(u)}setFeatureState(o,u){this._checkLoaded();const m=o.source,v=o.sourceLayer,w=this.sourceCaches[m];if(w===void 0)return void this.fire(new s.k(new Error(`The source '${m}' does not exist in the map's style.`)));const P=w.getSource().type;P==="geojson"&&v?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||v?(o.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(v,o.id,u)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,u){this._checkLoaded();const m=o.source,v=this.sourceCaches[m];if(v===void 0)return void this.fire(new s.k(new Error(`The source '${m}' does not exist in the map's style.`)));const w=v.getSource().type,P=w==="vector"?o.sourceLayer:void 0;w!=="vector"||P?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(P,o.id,u):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const u=o.source,m=o.sourceLayer,v=this.sourceCaches[u];if(v!==void 0)return v.getSource().type!=="vector"||m?(o.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),v.getFeatureState(m,o.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=s.bM(this.sourceCaches,w=>w.serialize()),u=this._serializeByIds(this._order,!0),m=this.map.getTerrain()||void 0,v=this.stylesheet;return s.bN({version:v.version,name:v.name,metadata:v.metadata,light:v.light,sky:v.sky,center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch,sprite:v.sprite,glyphs:v.glyphs,transition:v.transition,projection:v.projection,sources:o,layers:u,terrain:m},w=>w!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const u=P=>this._layers[P].type==="fill-extrusion",m={},v=[];for(let P=this._order.length-1;P>=0;P--){const k=this._order[P];if(u(k)){m[k]=P;for(const F of o){const j=F[k];if(j)for(const W of j)v.push(W)}}}v.sort((P,k)=>k.intersectionZ-P.intersectionZ);const w=[];for(let P=this._order.length-1;P>=0;P--){const k=this._order[P];if(u(k))for(let F=v.length-1;F>=0;F--){const j=v[F].feature;if(m[j.layer.id]<P)break;w.push(j),v.pop()}else for(const F of o){const j=F[k];if(j)for(const W of j)w.push(W.feature)}}return w}queryRenderedFeatures(o,u,m){u&&u.filter&&this._validate(s.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const v={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const j of u.layers){const W=this._layers[j];if(!W)return this.fire(new s.k(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];v[W.source]=!0}}const w=[];u.availableImages=this._availableImages;const P=this._serializedAllLayers(),k=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,F=Object.assign(Object.assign({},u),{layers:k});for(const j in this.sourceCaches)u.layers&&!v[j]||w.push(Tt(this.sourceCaches[j],this._layers,P,o,F,m,this.map.terrain?(W,J,Y)=>this.map.terrain.getElevation(W,J,Y):void 0));return this.placement&&w.push(function(j,W,J,Y,oe,he,Pe){const Ee={},Ae=he.queryRenderedSymbols(Y),Fe=[];for(const He of Object.keys(Ae).map(Number))Fe.push(Pe[He]);Fe.sort(Ct);for(const He of Fe){const Ne=He.featureIndex.lookupSymbolFeatures(Ae[He.bucketInstanceId],W,He.bucketIndex,He.sourceLayerIndex,oe.filter,oe.layers,oe.availableImages,j);for(const Ye in Ne){const Ke=Ee[Ye]=Ee[Ye]||[],Ue=Ne[Ye];Ue.sort((rt,yt)=>{const ht=He.featureSortOrder;if(ht){const pt=ht.indexOf(rt.featureIndex);return ht.indexOf(yt.featureIndex)-pt}return yt.featureIndex-rt.featureIndex});for(const rt of Ue)Ke.push(rt)}}return function(He,Ne,Ye){for(const Ke in He)for(const Ue of He[Ke])un(Ue,Ye[Ne[Ke].source]);return He}(Ee,j,J)}(this._layers,P,this.sourceCaches,o,F,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(o,u){u&&u.filter&&this._validate(s.z.filter,"querySourceFeatures.filter",u.filter,null,u);const m=this.sourceCaches[o];return m?function(v,w){const P=v.getRenderableIds().map(j=>v.getTileByID(j)),k=[],F={};for(let j=0;j<P.length;j++){const W=P[j],J=W.tileID.canonical.key;F[J]||(F[J]=!0,W.querySourceFeatures(k,w))}return k}(m,u):[]}getLight(){return this.light.getLight()}setLight(o,u={}){this._checkLoaded();const m=this.light.getLight();let v=!1;for(const P in o)if(!s.bG(o[P],m[P])){v=!0;break}if(!v)return;const w={now:C.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(w)}getProjection(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.projection}setProjection(o){if(this._checkLoaded(),this.projection){if(this.projection.name===o.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=o,this._setProjectionInternal(o.type)}getSky(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.sky}setSky(o,u={}){this._checkLoaded();const m=this.getSky();let v=!1;if(!o&&!m)return;if(o&&!m)v=!0;else if(!o&&m)v=!0;else for(const P in o)if(!s.bG(o[P],m[P])){v=!0;break}if(!v)return;const w={now:C.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,u),this.sky.updateTransitions(w)}_setProjectionInternal(o){const u=function(m){if(Array.isArray(m)){const v=new ad({type:m});return{projection:v,transform:new cs,cameraHelper:new Zg(v)}}switch(m){case"mercator":return{projection:new Gg,transform:new bi,cameraHelper:new Wf};case"globe":{const v=new ad({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:v,transform:new cs,cameraHelper:new Zg(v)}}case"vertical-perspective":return{projection:new mx,transform:new Su,cameraHelper:new Zo};default:return s.w(`Unknown projection name: ${m}. Falling back to mercator projection.`),{projection:new Gg,transform:new bi,cameraHelper:new Wf}}}(o);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const m in this.sourceCaches)this.sourceCaches[m].reload()}_validate(o,u,m,v,w={}){return(!w||w.validate!==!1)&&dd(this,o.call(s.z,s.e({key:u,style:this.serialize(),value:m,styleSpec:s.v},v)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Zt().off(St,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const m=this.sourceCaches[u];m.setEventedParent(null),m.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const u in this.sourceCaches)this.sourceCaches[u].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,u,m,v,w=!1){let P=!1,k=!1;const F={};for(const j of this._order){const W=this._layers[j];if(W.type!=="symbol")continue;if(!F[W.source]){const Y=this.sourceCaches[W.source];F[W.source]=Y.getRenderableIds(!0).map(oe=>Y.getTileByID(oe)).sort((oe,he)=>he.tileID.overscaledZ-oe.tileID.overscaledZ||(oe.tileID.isLessThan(he.tileID)?-1:1))}const J=this.crossTileSymbolIndex.addLayer(W,F[W.source],o.center.lng);P=P||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(C.now(),o.zoom))&&(this.pauseablePlacement=new Dl(o,this.map.terrain,this._order,w,u,m,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(C.now()),k=!0),P&&this.pauseablePlacement.placement.setStale()),k||P)for(const j of this._order){const W=this._layers[j];W.type==="symbol"&&this.placement.updateLayerOpacities(W,F[W.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(C.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,u){return s._(this,void 0,void 0,function*(){const m=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const v=this.sourceCaches[u.source];return v&&v.setDependencies(u.tileID.key,u.type,u.icons),m})}getGlyphs(o,u){return s._(this,void 0,void 0,function*(){const m=yield this.glyphManager.getGlyphs(u.stacks),v=this.sourceCaches[u.source];return v&&v.setDependencies(u.tileID.key,u.type,[""]),m})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,u={}){this._checkLoaded(),o&&this._validate(s.z.glyphs,"glyphs",o,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,u,m={},v){this._checkLoaded();const w=[{id:o,url:u}],P=[...V(this.stylesheet.sprite),...w];this._validate(s.z.sprite,"sprite",P,null,m)||(this.stylesheet.sprite=P,this._loadSprite(w,!0,v))}removeSprite(o){this._checkLoaded();const u=V(this.stylesheet.sprite);if(u.find(m=>m.id===o)){if(this._spritesImagesIds[o])for(const m of this._spritesImagesIds[o])this.imageManager.removeImage(m),this._changedImages[m]=!0;u.splice(u.findIndex(m=>m.id===o),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return V(this.stylesheet.sprite)}setSprite(o,u={},m){this._checkLoaded(),o&&this._validate(s.z.sprite,"sprite",o,null,u)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,m):(this._unloadSprite(),m&&m(null)))}}var xC=s.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class bC{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,u,m,v,w,P,k,F,j){this.context=o;let W=this.boundPaintVertexBuffers.length!==v.length;for(let J=0;!W&&J<v.length;J++)this.boundPaintVertexBuffers[J]!==v[J]&&(W=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==m||W||this.boundIndexBuffer!==w||this.boundVertexOffset!==P||this.boundDynamicVertexBuffer!==k||this.boundDynamicVertexBuffer2!==F||this.boundDynamicVertexBuffer3!==j?this.freshBind(u,m,v,w,P,k,F,j):(o.bindVertexArray.set(this.vao),k&&k.bind(),w&&w.dynamicDraw&&w.bind(),F&&F.bind(),j&&j.bind())}freshBind(o,u,m,v,w,P,k,F){const j=o.numAttributes,W=this.context,J=W.gl;this.vao&&this.destroy(),this.vao=W.createVertexArray(),W.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=v,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=F,u.enableAttributes(J,o);for(const Y of m)Y.enableAttributes(J,o);P&&P.enableAttributes(J,o),k&&k.enableAttributes(J,o),F&&F.enableAttributes(J,o),u.bind(),u.setVertexAttribPointers(J,o,w);for(const Y of m)Y.bind(),Y.setVertexAttribPointers(J,o,w);P&&(P.bind(),P.setVertexAttribPointers(J,o,w)),v&&v.bind(),k&&(k.bind(),k.setVertexAttribPointers(J,o,w)),F&&(F.bind(),F.setVertexAttribPointers(J,o,w)),W.currentNumAttributes=j}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const wC=(b,o,u,m,v)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:o,u_fog_color:u?u.properties.get("fog-color"):s.be.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:v?0:u?u.calculateFogBlendOpacity(m):0,u_horizon_color:u?u.properties.get("horizon-color"):s.be.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:v?1:0}),SC={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function qf(b){const o=[];for(let u=0;u<b.length;u++){if(b[u]===null)continue;const m=b[u].split(" ");o.push(m.pop())}return o}class Xf{constructor(o,u,m,v,w,P,k,F,j=[]){const W=o.gl;this.program=W.createProgram();const J=qf(u.staticAttributes),Y=m?m.getBinderAttributes():[],oe=J.concat(Y),he=$i.prelude.staticUniforms?qf($i.prelude.staticUniforms):[],Pe=k.staticUniforms?qf(k.staticUniforms):[],Ee=u.staticUniforms?qf(u.staticUniforms):[],Ae=m?m.getBinderUniforms():[],Fe=he.concat(Pe).concat(Ee).concat(Ae),He=[];for(const ht of Fe)He.indexOf(ht)<0&&He.push(ht);const Ne=m?m.defines():[];Io(W)&&Ne.unshift("#version 300 es"),w&&Ne.push("#define OVERDRAW_INSPECTOR;"),P&&Ne.push("#define TERRAIN3D;"),F&&Ne.push(F),j&&Ne.push(...j);let Ye=Ne.concat($i.prelude.fragmentSource,k.fragmentSource,u.fragmentSource).join(`
`),Ke=Ne.concat($i.prelude.vertexSource,k.vertexSource,u.vertexSource).join(`
`);Io(W)||(Ye=function(ht){return ht.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Ye),Ke=function(ht){return ht.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Ke));const Ue=W.createShader(W.FRAGMENT_SHADER);if(W.isContextLost())return void(this.failedToCreate=!0);if(W.shaderSource(Ue,Ye),W.compileShader(Ue),!W.getShaderParameter(Ue,W.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${W.getShaderInfoLog(Ue)}`);W.attachShader(this.program,Ue);const rt=W.createShader(W.VERTEX_SHADER);if(W.isContextLost())return void(this.failedToCreate=!0);if(W.shaderSource(rt,Ke),W.compileShader(rt),!W.getShaderParameter(rt,W.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${W.getShaderInfoLog(rt)}`);W.attachShader(this.program,rt),this.attributes={};const yt={};this.numAttributes=oe.length;for(let ht=0;ht<this.numAttributes;ht++)oe[ht]&&(W.bindAttribLocation(this.program,ht,oe[ht]),this.attributes[oe[ht]]=ht);if(W.linkProgram(this.program),!W.getProgramParameter(this.program,W.LINK_STATUS))throw new Error(`Program failed to link: ${W.getProgramInfoLog(this.program)}`);W.deleteShader(rt),W.deleteShader(Ue);for(let ht=0;ht<He.length;ht++){const pt=He[ht];if(pt&&!yt[pt]){const _t=W.getUniformLocation(this.program,pt);_t&&(yt[pt]=_t)}}this.fixedUniforms=v(o,yt),this.terrainUniforms=((ht,pt)=>({u_depth:new s.bO(ht,pt.u_depth),u_terrain:new s.bO(ht,pt.u_terrain),u_terrain_dim:new s.bf(ht,pt.u_terrain_dim),u_terrain_matrix:new s.bQ(ht,pt.u_terrain_matrix),u_terrain_unpack:new s.bR(ht,pt.u_terrain_unpack),u_terrain_exaggeration:new s.bf(ht,pt.u_terrain_exaggeration)}))(o,yt),this.projectionUniforms=((ht,pt)=>({u_projection_matrix:new s.bQ(ht,pt.u_projection_matrix),u_projection_tile_mercator_coords:new s.bR(ht,pt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.bR(ht,pt.u_projection_clipping_plane),u_projection_transition:new s.bf(ht,pt.u_projection_transition),u_projection_fallback_matrix:new s.bQ(ht,pt.u_projection_fallback_matrix)}))(o,yt),this.binderUniforms=m?m.getUniforms(o,yt):[]}draw(o,u,m,v,w,P,k,F,j,W,J,Y,oe,he,Pe,Ee,Ae,Fe,He){const Ne=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(m),o.setStencilMode(v),o.setColorMode(w),o.setCullFace(P),F){o.activeTexture.set(Ne.TEXTURE2),Ne.bindTexture(Ne.TEXTURE_2D,F.depthTexture),o.activeTexture.set(Ne.TEXTURE3),Ne.bindTexture(Ne.TEXTURE_2D,F.texture);for(const Ke in this.terrainUniforms)this.terrainUniforms[Ke].set(F[Ke])}if(j)for(const Ke in j)this.projectionUniforms[SC[Ke]].set(j[Ke]);if(k)for(const Ke in this.fixedUniforms)this.fixedUniforms[Ke].set(k[Ke]);Ee&&Ee.setUniforms(o,this.binderUniforms,he,{zoom:Pe});let Ye=0;switch(u){case Ne.LINES:Ye=2;break;case Ne.TRIANGLES:Ye=3;break;case Ne.LINE_STRIP:Ye=1}for(const Ke of oe.get()){const Ue=Ke.vaos||(Ke.vaos={});(Ue[W]||(Ue[W]=new bC)).bind(o,this,J,Ee?Ee.getPaintVertexBuffers():[],Y,Ke.vertexOffset,Ae,Fe,He),Ne.drawElements(u,Ke.primitiveLength*Ye,Ne.UNSIGNED_SHORT,Ke.primitiveOffset*Ye*2)}}}function Zf(b,o,u){const m=1/s.aB(u,1,o.transform.tileZoom),v=Math.pow(2,u.tileID.overscaledZ),w=u.tileSize*Math.pow(2,o.transform.tileZoom)/v,P=w*(u.tileID.canonical.x+u.tileID.wrap*v),k=w*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[m,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[P>>16,k>>16],u_pixel_coord_lower:[65535&P,65535&k]}}const fd=(b,o,u,m)=>{const v=b.style.light,w=v.properties.get("position"),P=[w.x,w.y,w.z],k=s.bU();v.properties.get("anchor")==="viewport"&&s.bV(k,b.transform.bearingInRadians),s.bW(P,P,k);const F=b.transform.transformLightDirection(P),j=v.properties.get("color");return{u_lightpos:P,u_lightpos_globe:F,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+o,u_opacity:u,u_fill_translate:m}},Kg=(b,o,u,m,v,w,P)=>s.e(fd(b,o,u,m),Zf(w,b,P),{u_height_factor:-Math.pow(2,v.overscaledZ)/P.tileSize/8}),Yf=(b,o,u,m)=>s.e(Zf(o,b,u),{u_fill_translate:m}),Ia=(b,o)=>({u_world:b,u_fill_translate:o}),MC=(b,o,u,m,v)=>s.e(Yf(b,o,u,v),{u_world:m}),Jg=(b,o,u,m,v)=>{const w=b.transform;let P,k,F=0;if(u.paint.get("circle-pitch-alignment")==="map"){const j=s.aB(o,1,w.zoom);P=!0,k=[j,j],F=j/(s.$*Math.pow(2,o.tileID.overscaledZ))*2*Math.PI*v}else P=!1,k=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+P,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:k,u_globe_extrude_scale:F,u_translate:m}},pd=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),md=b=>({u_viewport_size:[b.width,b.height]}),vx=(b,o=1)=>({u_color:b,u_overlay:0,u_overlay_scale:o}),gd=(b,o,u,m)=>{const v=s.aB(b,1,o)/(s.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*m;return{u_extrude_scale:s.aB(b,1,o),u_intensity:u,u_globe_extrude_scale:v}},yx=(b,o,u,m)=>{const v=s.L();s.bX(v,0,b.width,b.height,0,0,1);const w=b.context.gl;return{u_matrix:v,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:u,u_color_ramp:m,u_opacity:o.paint.get("heatmap-opacity")}},Cu=(b,o,u)=>{const m=u.paint.get("hillshade-accent-color");let v;switch(u.paint.get("hillshade-method")){case"basic":v=4;break;case"combined":v=1;break;case"igor":v=2;break;case"multidirectional":v=3;break;default:v=0}const w=u.getIlluminationProperties();for(let P=0;P<w.directionRadians.length;P++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(w.directionRadians[P]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:_x(0,o.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:w.altitudeRadians,u_azimuths:w.directionRadians,u_accent:m,u_method:v,u_highlights:w.highlightColor,u_shadows:w.shadowColor}},CC=(b,o)=>{const u=o.stride,m=s.L();return s.bX(m,0,s.$,-s.$,0,0,1),s.M(m,m,[0,-s.$,0]),{u_matrix:m,u_image:1,u_dimension:[u,u],u_zoom:b.overscaledZ,u_unpack:o.getUnpackVector()}};function _x(b,o){const u=Math.pow(2,o.canonical.z),m=o.canonical.y;return[new s.a0(0,m/u).toLngLat().lat,new s.a0(0,(m+1)/u).toLngLat().lat]}const EC=(b,o,u=0)=>({u_image:0,u_unpack:o.getUnpackVector(),u_dimension:[o.stride,o.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:b.paint.get("color-relief-opacity")}),Kf=(b,o,u,m)=>{const v=b.transform;return{u_translation:tv(b,o,u),u_ratio:m/s.aB(o,1,v.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Qg=(b,o,u,m,v)=>s.e(Kf(b,o,u,m),{u_image:0,u_image_height:v}),xx=(b,o,u,m,v)=>{const w=b.transform,P=ev(o,w);return{u_translation:tv(b,o,u),u_texsize:o.imageAtlasTexture.size,u_ratio:m/s.aB(o,1,w.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[P,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},bx=(b,o,u,m,v,w)=>{const P=b.lineAtlas,k=ev(o,b.transform),F=u.layout.get("line-cap")==="round",j=P.getDash(v.from,F),W=P.getDash(v.to,F),J=j.width*w.fromScale,Y=W.width*w.toScale;return s.e(Kf(b,o,u,m),{u_patternscale_a:[k/J,-j.height/2],u_patternscale_b:[k/Y,-W.height/2],u_sdfgamma:P.width/(256*Math.min(J,Y)*b.pixelRatio)/2,u_image:0,u_tex_y_a:j.y,u_tex_y_b:W.y,u_mix:w.t})};function ev(b,o){return 1/s.aB(b,1,o.tileZoom)}function tv(b,o,u){return s.aC(b.transform,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Cc=(b,o,u,m,v)=>{return{u_tl_parent:b,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(P=m.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(w=m.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:wx(m.paint.get("raster-hue-rotate")),u_coords_top:[v[0].x,v[0].y,v[1].x,v[1].y],u_coords_bottom:[v[3].x,v[3].y,v[2].x,v[2].y]};var w,P};function wx(b){b*=Math.PI/180;const o=Math.sin(b),u=Math.cos(b);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const nv=(b,o,u,m,v,w,P,k,F,j,W,J,Y)=>{const oe=P.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:oe.cameraToCenterDistance,u_pitch:oe.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:oe.width/oe.height,u_fade_change:P.options.fadeDuration?P.symbolFadeChange:1,u_label_plane_matrix:k,u_coord_matrix:F,u_is_text:+W,u_pitch_with_map:+m,u_is_along_line:v,u_is_variable_anchor:w,u_texsize:J,u_texture:0,u_translation:j,u_pitched_scale:Y}},Eu=(b,o,u,m,v,w,P,k,F,j,W,J,Y,oe)=>{const he=P.transform;return s.e(nv(b,o,u,m,v,w,P,k,F,j,W,J,oe),{u_gamma_scale:m?Math.cos(he.pitch*Math.PI/180)*he.cameraToCenterDistance:1,u_device_pixel_ratio:P.pixelRatio,u_is_halo:1})},TC=(b,o,u,m,v,w,P,k,F,j,W,J,Y)=>s.e(Eu(b,o,u,m,v,w,P,k,F,j,!0,W,0,Y),{u_texsize_icon:J,u_texture_icon:1}),Jf=(b,o)=>({u_opacity:b,u_color:o}),PC=(b,o,u,m,v)=>s.e(function(w,P,k,F){const j=k.imageManager.getPattern(w.from.toString()),W=k.imageManager.getPattern(w.to.toString()),{width:J,height:Y}=k.imageManager.getPixelSize(),oe=Math.pow(2,F.tileID.overscaledZ),he=F.tileSize*Math.pow(2,k.transform.tileZoom)/oe,Pe=he*(F.tileID.canonical.x+F.tileID.wrap*oe),Ee=he*F.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:W.tl,u_pattern_br_b:W.br,u_texsize:[J,Y],u_mix:P.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:W.displaySize,u_scale_a:P.fromScale,u_scale_b:P.toScale,u_tile_units_to_pixels:1/s.aB(F,1,k.transform.tileZoom),u_pixel_coord_upper:[Pe>>16,Ee>>16],u_pixel_coord_lower:[65535&Pe,65535&Ee]}}(u,v,o,m),{u_opacity:b}),Sx=(b,o)=>{},Mx={fillExtrusion:(b,o)=>({u_lightpos:new s.bS(b,o.u_lightpos),u_lightpos_globe:new s.bS(b,o.u_lightpos_globe),u_lightintensity:new s.bf(b,o.u_lightintensity),u_lightcolor:new s.bS(b,o.u_lightcolor),u_vertical_gradient:new s.bf(b,o.u_vertical_gradient),u_opacity:new s.bf(b,o.u_opacity),u_fill_translate:new s.bT(b,o.u_fill_translate)}),fillExtrusionPattern:(b,o)=>({u_lightpos:new s.bS(b,o.u_lightpos),u_lightpos_globe:new s.bS(b,o.u_lightpos_globe),u_lightintensity:new s.bf(b,o.u_lightintensity),u_lightcolor:new s.bS(b,o.u_lightcolor),u_vertical_gradient:new s.bf(b,o.u_vertical_gradient),u_height_factor:new s.bf(b,o.u_height_factor),u_opacity:new s.bf(b,o.u_opacity),u_fill_translate:new s.bT(b,o.u_fill_translate),u_image:new s.bO(b,o.u_image),u_texsize:new s.bT(b,o.u_texsize),u_pixel_coord_upper:new s.bT(b,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(b,o.u_pixel_coord_lower),u_scale:new s.bS(b,o.u_scale),u_fade:new s.bf(b,o.u_fade)}),fill:(b,o)=>({u_fill_translate:new s.bT(b,o.u_fill_translate)}),fillPattern:(b,o)=>({u_image:new s.bO(b,o.u_image),u_texsize:new s.bT(b,o.u_texsize),u_pixel_coord_upper:new s.bT(b,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(b,o.u_pixel_coord_lower),u_scale:new s.bS(b,o.u_scale),u_fade:new s.bf(b,o.u_fade),u_fill_translate:new s.bT(b,o.u_fill_translate)}),fillOutline:(b,o)=>({u_world:new s.bT(b,o.u_world),u_fill_translate:new s.bT(b,o.u_fill_translate)}),fillOutlinePattern:(b,o)=>({u_world:new s.bT(b,o.u_world),u_image:new s.bO(b,o.u_image),u_texsize:new s.bT(b,o.u_texsize),u_pixel_coord_upper:new s.bT(b,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(b,o.u_pixel_coord_lower),u_scale:new s.bS(b,o.u_scale),u_fade:new s.bf(b,o.u_fade),u_fill_translate:new s.bT(b,o.u_fill_translate)}),circle:(b,o)=>({u_camera_to_center_distance:new s.bf(b,o.u_camera_to_center_distance),u_scale_with_map:new s.bO(b,o.u_scale_with_map),u_pitch_with_map:new s.bO(b,o.u_pitch_with_map),u_extrude_scale:new s.bT(b,o.u_extrude_scale),u_device_pixel_ratio:new s.bf(b,o.u_device_pixel_ratio),u_globe_extrude_scale:new s.bf(b,o.u_globe_extrude_scale),u_translate:new s.bT(b,o.u_translate)}),collisionBox:(b,o)=>({u_pixel_extrude_scale:new s.bT(b,o.u_pixel_extrude_scale)}),collisionCircle:(b,o)=>({u_viewport_size:new s.bT(b,o.u_viewport_size)}),debug:(b,o)=>({u_color:new s.bP(b,o.u_color),u_overlay:new s.bO(b,o.u_overlay),u_overlay_scale:new s.bf(b,o.u_overlay_scale)}),depth:Sx,clippingMask:Sx,heatmap:(b,o)=>({u_extrude_scale:new s.bf(b,o.u_extrude_scale),u_intensity:new s.bf(b,o.u_intensity),u_globe_extrude_scale:new s.bf(b,o.u_globe_extrude_scale)}),heatmapTexture:(b,o)=>({u_matrix:new s.bQ(b,o.u_matrix),u_world:new s.bT(b,o.u_world),u_image:new s.bO(b,o.u_image),u_color_ramp:new s.bO(b,o.u_color_ramp),u_opacity:new s.bf(b,o.u_opacity)}),hillshade:(b,o)=>({u_image:new s.bO(b,o.u_image),u_latrange:new s.bT(b,o.u_latrange),u_exaggeration:new s.bf(b,o.u_exaggeration),u_altitudes:new s.bZ(b,o.u_altitudes),u_azimuths:new s.bZ(b,o.u_azimuths),u_accent:new s.bP(b,o.u_accent),u_method:new s.bO(b,o.u_method),u_shadows:new s.bY(b,o.u_shadows),u_highlights:new s.bY(b,o.u_highlights)}),hillshadePrepare:(b,o)=>({u_matrix:new s.bQ(b,o.u_matrix),u_image:new s.bO(b,o.u_image),u_dimension:new s.bT(b,o.u_dimension),u_zoom:new s.bf(b,o.u_zoom),u_unpack:new s.bR(b,o.u_unpack)}),colorRelief:(b,o)=>({u_image:new s.bO(b,o.u_image),u_unpack:new s.bR(b,o.u_unpack),u_dimension:new s.bT(b,o.u_dimension),u_elevation_stops:new s.bO(b,o.u_elevation_stops),u_color_stops:new s.bO(b,o.u_color_stops),u_color_ramp_size:new s.bO(b,o.u_color_ramp_size),u_opacity:new s.bf(b,o.u_opacity)}),line:(b,o)=>({u_translation:new s.bT(b,o.u_translation),u_ratio:new s.bf(b,o.u_ratio),u_device_pixel_ratio:new s.bf(b,o.u_device_pixel_ratio),u_units_to_pixels:new s.bT(b,o.u_units_to_pixels)}),lineGradient:(b,o)=>({u_translation:new s.bT(b,o.u_translation),u_ratio:new s.bf(b,o.u_ratio),u_device_pixel_ratio:new s.bf(b,o.u_device_pixel_ratio),u_units_to_pixels:new s.bT(b,o.u_units_to_pixels),u_image:new s.bO(b,o.u_image),u_image_height:new s.bf(b,o.u_image_height)}),linePattern:(b,o)=>({u_translation:new s.bT(b,o.u_translation),u_texsize:new s.bT(b,o.u_texsize),u_ratio:new s.bf(b,o.u_ratio),u_device_pixel_ratio:new s.bf(b,o.u_device_pixel_ratio),u_image:new s.bO(b,o.u_image),u_units_to_pixels:new s.bT(b,o.u_units_to_pixels),u_scale:new s.bS(b,o.u_scale),u_fade:new s.bf(b,o.u_fade)}),lineSDF:(b,o)=>({u_translation:new s.bT(b,o.u_translation),u_ratio:new s.bf(b,o.u_ratio),u_device_pixel_ratio:new s.bf(b,o.u_device_pixel_ratio),u_units_to_pixels:new s.bT(b,o.u_units_to_pixels),u_patternscale_a:new s.bT(b,o.u_patternscale_a),u_patternscale_b:new s.bT(b,o.u_patternscale_b),u_sdfgamma:new s.bf(b,o.u_sdfgamma),u_image:new s.bO(b,o.u_image),u_tex_y_a:new s.bf(b,o.u_tex_y_a),u_tex_y_b:new s.bf(b,o.u_tex_y_b),u_mix:new s.bf(b,o.u_mix)}),raster:(b,o)=>({u_tl_parent:new s.bT(b,o.u_tl_parent),u_scale_parent:new s.bf(b,o.u_scale_parent),u_buffer_scale:new s.bf(b,o.u_buffer_scale),u_fade_t:new s.bf(b,o.u_fade_t),u_opacity:new s.bf(b,o.u_opacity),u_image0:new s.bO(b,o.u_image0),u_image1:new s.bO(b,o.u_image1),u_brightness_low:new s.bf(b,o.u_brightness_low),u_brightness_high:new s.bf(b,o.u_brightness_high),u_saturation_factor:new s.bf(b,o.u_saturation_factor),u_contrast_factor:new s.bf(b,o.u_contrast_factor),u_spin_weights:new s.bS(b,o.u_spin_weights),u_coords_top:new s.bR(b,o.u_coords_top),u_coords_bottom:new s.bR(b,o.u_coords_bottom)}),symbolIcon:(b,o)=>({u_is_size_zoom_constant:new s.bO(b,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(b,o.u_is_size_feature_constant),u_size_t:new s.bf(b,o.u_size_t),u_size:new s.bf(b,o.u_size),u_camera_to_center_distance:new s.bf(b,o.u_camera_to_center_distance),u_pitch:new s.bf(b,o.u_pitch),u_rotate_symbol:new s.bO(b,o.u_rotate_symbol),u_aspect_ratio:new s.bf(b,o.u_aspect_ratio),u_fade_change:new s.bf(b,o.u_fade_change),u_label_plane_matrix:new s.bQ(b,o.u_label_plane_matrix),u_coord_matrix:new s.bQ(b,o.u_coord_matrix),u_is_text:new s.bO(b,o.u_is_text),u_pitch_with_map:new s.bO(b,o.u_pitch_with_map),u_is_along_line:new s.bO(b,o.u_is_along_line),u_is_variable_anchor:new s.bO(b,o.u_is_variable_anchor),u_texsize:new s.bT(b,o.u_texsize),u_texture:new s.bO(b,o.u_texture),u_translation:new s.bT(b,o.u_translation),u_pitched_scale:new s.bf(b,o.u_pitched_scale)}),symbolSDF:(b,o)=>({u_is_size_zoom_constant:new s.bO(b,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(b,o.u_is_size_feature_constant),u_size_t:new s.bf(b,o.u_size_t),u_size:new s.bf(b,o.u_size),u_camera_to_center_distance:new s.bf(b,o.u_camera_to_center_distance),u_pitch:new s.bf(b,o.u_pitch),u_rotate_symbol:new s.bO(b,o.u_rotate_symbol),u_aspect_ratio:new s.bf(b,o.u_aspect_ratio),u_fade_change:new s.bf(b,o.u_fade_change),u_label_plane_matrix:new s.bQ(b,o.u_label_plane_matrix),u_coord_matrix:new s.bQ(b,o.u_coord_matrix),u_is_text:new s.bO(b,o.u_is_text),u_pitch_with_map:new s.bO(b,o.u_pitch_with_map),u_is_along_line:new s.bO(b,o.u_is_along_line),u_is_variable_anchor:new s.bO(b,o.u_is_variable_anchor),u_texsize:new s.bT(b,o.u_texsize),u_texture:new s.bO(b,o.u_texture),u_gamma_scale:new s.bf(b,o.u_gamma_scale),u_device_pixel_ratio:new s.bf(b,o.u_device_pixel_ratio),u_is_halo:new s.bO(b,o.u_is_halo),u_translation:new s.bT(b,o.u_translation),u_pitched_scale:new s.bf(b,o.u_pitched_scale)}),symbolTextAndIcon:(b,o)=>({u_is_size_zoom_constant:new s.bO(b,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(b,o.u_is_size_feature_constant),u_size_t:new s.bf(b,o.u_size_t),u_size:new s.bf(b,o.u_size),u_camera_to_center_distance:new s.bf(b,o.u_camera_to_center_distance),u_pitch:new s.bf(b,o.u_pitch),u_rotate_symbol:new s.bO(b,o.u_rotate_symbol),u_aspect_ratio:new s.bf(b,o.u_aspect_ratio),u_fade_change:new s.bf(b,o.u_fade_change),u_label_plane_matrix:new s.bQ(b,o.u_label_plane_matrix),u_coord_matrix:new s.bQ(b,o.u_coord_matrix),u_is_text:new s.bO(b,o.u_is_text),u_pitch_with_map:new s.bO(b,o.u_pitch_with_map),u_is_along_line:new s.bO(b,o.u_is_along_line),u_is_variable_anchor:new s.bO(b,o.u_is_variable_anchor),u_texsize:new s.bT(b,o.u_texsize),u_texsize_icon:new s.bT(b,o.u_texsize_icon),u_texture:new s.bO(b,o.u_texture),u_texture_icon:new s.bO(b,o.u_texture_icon),u_gamma_scale:new s.bf(b,o.u_gamma_scale),u_device_pixel_ratio:new s.bf(b,o.u_device_pixel_ratio),u_is_halo:new s.bO(b,o.u_is_halo),u_translation:new s.bT(b,o.u_translation),u_pitched_scale:new s.bf(b,o.u_pitched_scale)}),background:(b,o)=>({u_opacity:new s.bf(b,o.u_opacity),u_color:new s.bP(b,o.u_color)}),backgroundPattern:(b,o)=>({u_opacity:new s.bf(b,o.u_opacity),u_image:new s.bO(b,o.u_image),u_pattern_tl_a:new s.bT(b,o.u_pattern_tl_a),u_pattern_br_a:new s.bT(b,o.u_pattern_br_a),u_pattern_tl_b:new s.bT(b,o.u_pattern_tl_b),u_pattern_br_b:new s.bT(b,o.u_pattern_br_b),u_texsize:new s.bT(b,o.u_texsize),u_mix:new s.bf(b,o.u_mix),u_pattern_size_a:new s.bT(b,o.u_pattern_size_a),u_pattern_size_b:new s.bT(b,o.u_pattern_size_b),u_scale_a:new s.bf(b,o.u_scale_a),u_scale_b:new s.bf(b,o.u_scale_b),u_pixel_coord_upper:new s.bT(b,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(b,o.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bf(b,o.u_tile_units_to_pixels)}),terrain:(b,o)=>({u_texture:new s.bO(b,o.u_texture),u_ele_delta:new s.bf(b,o.u_ele_delta),u_fog_matrix:new s.bQ(b,o.u_fog_matrix),u_fog_color:new s.bP(b,o.u_fog_color),u_fog_ground_blend:new s.bf(b,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bf(b,o.u_fog_ground_blend_opacity),u_horizon_color:new s.bP(b,o.u_horizon_color),u_horizon_fog_blend:new s.bf(b,o.u_horizon_fog_blend),u_is_globe_mode:new s.bf(b,o.u_is_globe_mode)}),terrainDepth:(b,o)=>({u_ele_delta:new s.bf(b,o.u_ele_delta)}),terrainCoords:(b,o)=>({u_texture:new s.bO(b,o.u_texture),u_terrain_coords_id:new s.bf(b,o.u_terrain_coords_id),u_ele_delta:new s.bf(b,o.u_ele_delta)}),projectionErrorMeasurement:(b,o)=>({u_input:new s.bf(b,o.u_input),u_output_expected:new s.bf(b,o.u_output_expected)}),atmosphere:(b,o)=>({u_sun_pos:new s.bS(b,o.u_sun_pos),u_atmosphere_blend:new s.bf(b,o.u_atmosphere_blend),u_globe_position:new s.bS(b,o.u_globe_position),u_globe_radius:new s.bf(b,o.u_globe_radius),u_inv_proj_matrix:new s.bQ(b,o.u_inv_proj_matrix)}),sky:(b,o)=>({u_sky_color:new s.bP(b,o.u_sky_color),u_horizon_color:new s.bP(b,o.u_horizon_color),u_horizon:new s.bT(b,o.u_horizon),u_horizon_normal:new s.bT(b,o.u_horizon_normal),u_sky_horizon_blend:new s.bf(b,o.u_sky_horizon_blend),u_sky_blend:new s.bf(b,o.u_sky_blend)})};class Cx{constructor(o,u,m){this.context=o;const v=o.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ex={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class rv{constructor(o,u,m,v){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=v,this.context=o;const w=o.gl;this.buffer=w.createBuffer(),o.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let m=0;m<this.attributes.length;m++){const v=u.attributes[this.attributes[m].name];v!==void 0&&o.enableVertexAttribArray(v)}}setVertexAttribPointers(o,u,m){for(let v=0;v<this.attributes.length;v++){const w=this.attributes[v],P=u.attributes[w.name];P!==void 0&&o.vertexAttribPointer(P,w.components,o[Ex[w.type]],!1,this.itemSize,w.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Sr{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Qf extends Sr{getDefault(){return s.be.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class sl extends Sr{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class iv extends Sr{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class ov extends Sr{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class sv extends Sr{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Tx extends Sr{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class av extends Sr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Ec extends Sr{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class lv extends Sr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class AC extends Sr{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class IC extends Sr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class RC extends Sr{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class LC extends Sr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class Px extends Sr{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class kC extends Sr{getDefault(){return s.be.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Ax extends Sr{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class ep extends Sr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class tp extends Sr{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class np extends Sr{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class cv extends Sr{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class Tc extends Sr{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class vd extends Sr{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Tu extends Sr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Es extends Sr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ix extends Sr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Rx extends Sr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class uv extends Sr{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Pc extends Sr{getDefault(){return null}set(o){var u;if(o===this.current&&!this.dirty)return;const m=this.gl;Io(m)?m.bindVertexArray(o):(u=m.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class rp extends Sr{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ip extends Sr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class yd extends Sr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Pu extends Sr{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class Lx extends Pu{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Au extends Pu{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Iu extends Pu{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}const hv="Framebuffer is not complete";class dv{constructor(o,u,m,v,w){this.context=o,this.width=u,this.height=m;const P=o.gl,k=this.framebuffer=P.createFramebuffer();if(this.colorAttachment=new Lx(o,k),v)this.depthAttachment=w?new Iu(o,k):new Au(o,k);else if(w)throw new Error("Stencil cannot be set without depth");if(P.checkFramebufferStatus(P.FRAMEBUFFER)!==P.FRAMEBUFFER_COMPLETE)throw new Error(hv)}destroy(){const o=this.context.gl,u=this.colorAttachment.get();if(u&&o.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&o.deleteRenderbuffer(m)}o.deleteFramebuffer(this.framebuffer)}}class er{constructor(o){var u,m;if(this.gl=o,this.clearColor=new Qf(this),this.clearDepth=new sl(this),this.clearStencil=new iv(this),this.colorMask=new ov(this),this.depthMask=new sv(this),this.stencilMask=new Tx(this),this.stencilFunc=new av(this),this.stencilOp=new Ec(this),this.stencilTest=new lv(this),this.depthRange=new AC(this),this.depthTest=new IC(this),this.depthFunc=new RC(this),this.blend=new LC(this),this.blendFunc=new Px(this),this.blendColor=new kC(this),this.blendEquation=new Ax(this),this.cullFace=new ep(this),this.cullFaceSide=new tp(this),this.frontFace=new np(this),this.program=new cv(this),this.activeTexture=new Tc(this),this.viewport=new vd(this),this.bindFramebuffer=new Tu(this),this.bindRenderbuffer=new Es(this),this.bindTexture=new Ix(this),this.bindVertexBuffer=new Rx(this),this.bindElementBuffer=new uv(this),this.bindVertexArray=new Pc(this),this.pixelStoreUnpack=new rp(this),this.pixelStoreUnpackPremultiplyAlpha=new ip(this),this.pixelStoreUnpackFlipY=new yd(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),Io(o)){this.HALF_FLOAT=o.HALF_FLOAT;const v=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=o.RGBA16F)!==null&&u!==void 0?u:v==null?void 0:v.RGBA16F_EXT,this.RGB16F=(m=o.RGB16F)!==null&&m!==void 0?m:v==null?void 0:v.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const v=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=v==null?void 0:v.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u){return new Cx(this,o,u)}createVertexBuffer(o,u,m){return new rv(this,o,u,m)}createRenderbuffer(o,u,m){const v=this.gl,w=v.createRenderbuffer();return this.bindRenderbuffer.set(w),v.renderbufferStorage(v.RENDERBUFFER,o,u,m),this.bindRenderbuffer.set(null),w}createFramebuffer(o,u,m,v){return new dv(this,o,u,m,v)}clear({color:o,depth:u,stencil:m}){const v=this.gl;let w=0;o&&(w|=v.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(w|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),m!==void 0&&(w|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),v.clear(w)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){s.bG(o.blendFunction,sr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return Io(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var u;return Io(this.gl)?this.gl.deleteVertexArray(o):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}let Ac;function kx(b,o,u,m,v){const w=b.context,P=b.transform,k=w.gl,F=b.useProgram("collisionBox"),j=[];let W=0,J=0;for(let Ae=0;Ae<m.length;Ae++){const Fe=m[Ae],He=o.getTile(Fe).getBucket(u);if(!He)continue;const Ne=v?He.textCollisionBox:He.iconCollisionBox,Ye=He.collisionCircleArray;Ye.length>0&&(j.push({circleArray:Ye,circleOffset:J,coord:Fe}),W+=Ye.length/4,J=W),Ne&&F.draw(w,k.LINES,Yn.disabled,Gn.disabled,b.colorModeForRenderPass(),Wn.disabled,pd(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(Fe),P.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,null,b.transform.zoom,null,null,Ne.collisionVertexBuffer)}if(!v||!j.length)return;const Y=b.useProgram("collisionCircle"),oe=new s.b_;oe.resize(4*W),oe._trim();let he=0;for(const Ae of j)for(let Fe=0;Fe<Ae.circleArray.length/4;Fe++){const He=4*Fe,Ne=Ae.circleArray[He+0],Ye=Ae.circleArray[He+1],Ke=Ae.circleArray[He+2],Ue=Ae.circleArray[He+3];oe.emplace(he++,Ne,Ye,Ke,Ue,0),oe.emplace(he++,Ne,Ye,Ke,Ue,1),oe.emplace(he++,Ne,Ye,Ke,Ue,2),oe.emplace(he++,Ne,Ye,Ke,Ue,3)}(!Ac||Ac.length<2*W)&&(Ac=function(Ae){const Fe=2*Ae,He=new s.c0;He.resize(Fe),He._trim();for(let Ne=0;Ne<Fe;Ne++){const Ye=6*Ne;He.uint16[Ye+0]=4*Ne+0,He.uint16[Ye+1]=4*Ne+1,He.uint16[Ye+2]=4*Ne+2,He.uint16[Ye+3]=4*Ne+2,He.uint16[Ye+4]=4*Ne+3,He.uint16[Ye+5]=4*Ne+0}return He}(W));const Pe=w.createIndexBuffer(Ac,!0),Ee=w.createVertexBuffer(oe,s.b$.members,!0);for(const Ae of j){const Fe=md(b.transform);Y.draw(w,k.TRIANGLES,Yn.disabled,Gn.disabled,b.colorModeForRenderPass(),Wn.disabled,Fe,b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ae.coord),null,u.id,Ee,Pe,s.aL.simpleSegment(0,2*Ae.circleOffset,Ae.circleArray.length,Ae.circleArray.length/2),null,b.transform.zoom,null,null,null)}Ee.destroy(),Pe.destroy()}const Dx=s.af(new Float32Array(16));function _d(b,o,u,m,v,w){const{horizontalAlign:P,verticalAlign:k}=s.aG(b);return new s.P((-(P-.5)*o/v+m[0])*w,(-(k-.5)*u/v+m[1])*w)}function DC(b,o,u,m,v,w){const P=o.tileAnchorPoint.add(new s.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let k=m.mult(w);u||(k=k.rotate(-v));const F=P.add(k);return Yt(F.x,F.y,o.pitchedLabelPlaneMatrix,o.getElevation).point}if(u){const k=Ze(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub(b),F=Math.atan(k.y/k.x)+(k.x<0?Math.PI:0);return b.add(m.rotate(F))}return b.add(m)}function zC(b,o,u,m,v,w,P,k,F,j,W,J){const Y=b.text.placedSymbolArray,oe=b.text.dynamicLayoutVertexArray,he=b.icon.dynamicLayoutVertexArray,Pe={};oe.clear();for(let Ee=0;Ee<Y.length;Ee++){const Ae=Y.get(Ee),Fe=Ae.hidden||!Ae.crossTileID||b.allowVerticalPlacement&&!Ae.placedOrientation?null:m[Ae.crossTileID];if(Fe){const He=new s.P(Ae.anchorX,Ae.anchorY),Ne={getElevation:J,width:v.width,height:v.height,pitchedLabelPlaneMatrix:w,pitchWithMap:u,transform:v,tileAnchorPoint:He,translation:j,unwrappedTileID:W},Ye=u?Wt(He.x,He.y,Ne):Ze(He.x,He.y,Ne),Ke=qt(v.cameraToCenterDistance,Ye.signedDistanceFromCamera);let Ue=s.ao(b.textSizeData,k,Ae)*Ke/s.aA;u&&(Ue*=b.tilePixelRatio/P);const{width:rt,height:yt,anchor:ht,textOffset:pt,textBoxScale:_t}=Fe,sn=_d(ht,rt,yt,pt,_t,Ue),rn=v.getPitchedTextCorrection(He.x+j[0],He.y+j[1],W),Vt=DC(Ye.point,Ne,o,sn,-v.bearingInRadians,rn),Mn=b.allowVerticalPlacement&&Ae.placedOrientation===s.an.vertical?Math.PI/2:0;for(let Kn=0;Kn<Ae.numGlyphs;Kn++)s.au(oe,Vt,Mn);F&&Ae.associatedIconIndex>=0&&(Pe[Ae.associatedIconIndex]={shiftedAnchor:Vt,angle:Mn})}else nt(Ae.numGlyphs,oe)}if(F){he.clear();const Ee=b.icon.placedSymbolArray;for(let Ae=0;Ae<Ee.length;Ae++){const Fe=Ee.get(Ae);if(Fe.hidden)nt(Fe.numGlyphs,he);else{const He=Pe[Ae];if(He)for(let Ne=0;Ne<Fe.numGlyphs;Ne++)s.au(he,He.shiftedAnchor,He.angle);else nt(Fe.numGlyphs,he)}}b.icon.dynamicLayoutVertexBuffer.updateData(he)}b.text.dynamicLayoutVertexBuffer.updateData(oe)}function zx(b,o,u){return u.iconsInText&&o?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function Ox(b,o,u,m,v,w,P,k,F,j,W,J,Y){const oe=b.context,he=oe.gl,Pe=b.transform,Ee=k==="map",Ae=F==="map",Fe=k!=="viewport"&&u.layout.get("symbol-placement")!=="point",He=Ee&&!Ae&&!Fe,Ne=!u.layout.get("symbol-sort-key").isConstant();let Ye=!1;const Ke=b.getDepthModeForSublayer(0,Yn.ReadOnly),Ue=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),rt=[],yt=Pe.getCircleRadiusCorrection();for(const ht of m){const pt=o.getTile(ht),_t=pt.getBucket(u);if(!_t)continue;const sn=v?_t.text:_t.icon;if(!sn||!sn.segments.get().length||!sn.hasVisibleVertices)continue;const rn=sn.programConfigurations.get(u.id),Vt=v||_t.sdfIcons,Mn=v?_t.textSizeData:_t.iconSizeData,Kn=Ae||Pe.pitch!==0,Mr=b.useProgram(zx(Vt,v,_t),rn),ti=s.am(Mn,Pe.zoom),Pr=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ht);let ni,Dr,Ar,zr,to=[0,0],ur=null;if(v)Dr=pt.glyphAtlasTexture,Ar=he.LINEAR,ni=pt.glyphAtlasTexture.size,_t.iconsInText&&(to=pt.imageAtlasTexture.size,ur=pt.imageAtlasTexture,zr=Kn||b.options.rotating||b.options.zooming||Mn.kind==="composite"||Mn.kind==="camera"?he.LINEAR:he.NEAREST);else{const hi=u.layout.get("icon-size").constantOr(0)!==1||_t.iconsNeedLinear;Dr=pt.imageAtlasTexture,Ar=Vt||b.options.rotating||b.options.zooming||hi||Kn?he.LINEAR:he.NEAREST,ni=pt.imageAtlasTexture.size}const Hi=s.aB(pt,1,b.transform.zoom),no=tt(Ee,b.transform,Hi),Vl=s.L();s.ap(Vl,no);const jl=At(Ae,Ee,b.transform,Hi),Hl=s.aC(Pe,pt,w,P),ka=Pe.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),kd=Ue&&_t.hasTextData(),Dd=u.layout.get("icon-text-fit")!=="none"&&kd&&_t.hasIconData();if(Fe){const hi=b.style.map.terrain?(Do,Ri)=>b.style.map.terrain.getElevation(ht,Do,Ri):null,Hr=u.layout.get("text-rotation-alignment")==="map";yn(_t,b,v,no,Vl,Ae,j,Hr,ht.toUnwrapped(),Pe.width,Pe.height,Hl,hi)}const Vu=v&&Ue||Dd,Ko=Fe||Vu?Dx:Ae?no:b.transform.clipSpaceToPixelsMatrix,Qs=Vt&&u.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Gl;Gl=Vt?_t.iconsInText?TC(Mn.kind,ti,He,Ae,Fe,Vu,b,Ko,jl,Hl,ni,to,yt):Eu(Mn.kind,ti,He,Ae,Fe,Vu,b,Ko,jl,Hl,v,ni,0,yt):nv(Mn.kind,ti,He,Ae,Fe,Vu,b,Ko,jl,Hl,v,ni,yt);const Lc={program:Mr,buffers:sn,uniformValues:Gl,projectionData:ka,atlasTexture:Dr,atlasTextureIcon:ur,atlasInterpolation:Ar,atlasInterpolationIcon:zr,isSDF:Vt,hasHalo:Qs};if(Ne&&_t.canOverlap){Ye=!0;const hi=sn.segments.get();for(const Hr of hi)rt.push({segments:new s.aL([Hr]),sortKey:Hr.sortKey,state:Lc,terrainData:Pr})}else rt.push({segments:sn.segments,sortKey:0,state:Lc,terrainData:Pr})}Ye&&rt.sort((ht,pt)=>ht.sortKey-pt.sortKey);for(const ht of rt){const pt=ht.state;if(oe.activeTexture.set(he.TEXTURE0),pt.atlasTexture.bind(pt.atlasInterpolation,he.CLAMP_TO_EDGE),pt.atlasTextureIcon&&(oe.activeTexture.set(he.TEXTURE1),pt.atlasTextureIcon&&pt.atlasTextureIcon.bind(pt.atlasInterpolationIcon,he.CLAMP_TO_EDGE)),pt.isSDF){const _t=pt.uniformValues;pt.hasHalo&&(_t.u_is_halo=1,op(pt.buffers,ht.segments,u,b,pt.program,Ke,W,J,_t,pt.projectionData,ht.terrainData)),_t.u_is_halo=0}op(pt.buffers,ht.segments,u,b,pt.program,Ke,W,J,pt.uniformValues,pt.projectionData,ht.terrainData)}}function op(b,o,u,m,v,w,P,k,F,j,W){const J=m.context;v.draw(J,J.gl.TRIANGLES,w,P,k,Wn.backCCW,F,W,j,u.id,b.layoutVertexBuffer,b.indexBuffer,o,u.paint,m.transform.zoom,b.programConfigurations.get(u.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function sp(b,o,u,m,v){const w=b.context,P=w.gl,k=Gn.disabled,F=new sr([P.ONE,P.ONE],s.be.transparent,[!0,!0,!0,!0]),j=o.getBucket(u);if(!j)return;const W=m.key;let J=u.heatmapFbos.get(W);J||(J=xd(w,o.tileSize,o.tileSize),u.heatmapFbos.set(W,J)),w.bindFramebuffer.set(J.framebuffer),w.viewport.set([0,0,o.tileSize,o.tileSize]),w.clear({color:s.be.transparent});const Y=j.programConfigurations.get(u.id),oe=b.useProgram("heatmap",Y,!v),he=b.transform.getProjectionData({overscaledTileID:o.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Pe=b.style.map.terrain.getTerrainData(m);oe.draw(w,P.TRIANGLES,Yn.disabled,k,F,Wn.disabled,gd(o,b.transform.zoom,u.paint.get("heatmap-intensity"),1),Pe,he,u.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,u.paint,b.transform.zoom,Y)}function ap(b,o,u,m,v){const w=b.context,P=w.gl,k=b.transform;w.setColorMode(b.colorModeForRenderPass());const F=lp(w,o),j=u.key,W=o.heatmapFbos.get(j);if(!W)return;w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,W.colorAttachment.get()),w.activeTexture.set(P.TEXTURE1),F.bind(P.LINEAR,P.CLAMP_TO_EDGE);const J=k.getProjectionData({overscaledTileID:u,applyTerrainMatrix:v,applyGlobeMatrix:!m});b.useProgram("heatmapTexture").draw(w,P.TRIANGLES,Yn.disabled,Gn.disabled,b.colorModeForRenderPass(),Wn.disabled,yx(b,o,0,1),null,J,o.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,o.paint,k.zoom),W.destroy(),o.heatmapFbos.delete(j)}function xd(b,o,u){var m,v;const w=b.gl,P=w.createTexture();w.bindTexture(w.TEXTURE_2D,P),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const k=(m=b.HALF_FLOAT)!==null&&m!==void 0?m:w.UNSIGNED_BYTE,F=(v=b.RGBA16F)!==null&&v!==void 0?v:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,F,o,u,0,w.RGBA,k,null);const j=b.createFramebuffer(o,u,!1,!1);return j.colorAttachment.set(P),j}function lp(b,o){return o.colorRampTexture||(o.colorRampTexture=new s.T(b,o.colorRamp,b.gl.RGBA)),o.colorRampTexture}function fv(b,o,u,m,v){if(!u||!m||!m.imageAtlas)return;const w=m.imageAtlas.patternPositions;let P=w[u.to.toString()],k=w[u.from.toString()];if(!P&&k&&(P=k),!k&&P&&(k=P),!P||!k){const F=v.getPaintProperty(o);P=w[F],k=w[F]}P&&k&&b.setConstantPatternPositions(P,k)}function bd(b,o,u,m,v,w,P,k){const F=b.context.gl,j="fill-pattern",W=u.paint.get(j),J=W&&W.constantOr(1),Y=u.getCrossfadeParameters();let oe,he,Pe,Ee,Ae;const Fe=b.transform,He=u.paint.get("fill-translate"),Ne=u.paint.get("fill-translate-anchor");P?(he=J&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",oe=F.LINES):(he=J?"fillPattern":"fill",oe=F.TRIANGLES);const Ye=W.constantOr(null);for(const Ke of m){const Ue=o.getTile(Ke);if(J&&!Ue.patternsLoaded())continue;const rt=Ue.getBucket(u);if(!rt)continue;const yt=rt.programConfigurations.get(u.id),ht=b.useProgram(he,yt),pt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ke);J&&(b.context.activeTexture.set(F.TEXTURE0),Ue.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),yt.updatePaintBuffers(Y)),fv(yt,j,Ye,Ue,u);const _t=Fe.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),sn=s.aC(Fe,Ue,He,Ne);if(P){Ee=rt.indexBuffer2,Ae=rt.segments2;const Vt=[F.drawingBufferWidth,F.drawingBufferHeight];Pe=he==="fillOutlinePattern"&&J?MC(b,Y,Ue,Vt,sn):Ia(Vt,sn)}else Ee=rt.indexBuffer,Ae=rt.segments,Pe=J?Yf(b,Y,Ue,sn):{u_fill_translate:sn};const rn=b.stencilModeForClipping(Ke);ht.draw(b.context,oe,v,rn,w,Wn.backCCW,Pe,pt,_t,u.id,rt.layoutVertexBuffer,Ee,Ae,u.paint,b.transform.zoom,yt)}}function Ru(b,o,u,m,v,w,P,k){const F=b.context,j=F.gl,W="fill-extrusion-pattern",J=u.paint.get(W),Y=J.constantOr(1),oe=u.getCrossfadeParameters(),he=u.paint.get("fill-extrusion-opacity"),Pe=J.constantOr(null),Ee=b.transform;for(const Ae of m){const Fe=o.getTile(Ae),He=Fe.getBucket(u);if(!He)continue;const Ne=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ae),Ye=He.programConfigurations.get(u.id),Ke=b.useProgram(Y?"fillExtrusionPattern":"fillExtrusion",Ye);Y&&(b.context.activeTexture.set(j.TEXTURE0),Fe.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Ye.updatePaintBuffers(oe));const Ue=Ee.getProjectionData({overscaledTileID:Ae,applyGlobeMatrix:!k,applyTerrainMatrix:!0});fv(Ye,W,Pe,Fe,u);const rt=s.aC(Ee,Fe,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),yt=u.paint.get("fill-extrusion-vertical-gradient"),ht=Y?Kg(b,yt,he,rt,Ae,oe,Fe):fd(b,yt,he,rt);Ke.draw(F,F.gl.TRIANGLES,v,w,P,Wn.backCCW,ht,Ne,Ue,u.id,He.layoutVertexBuffer,He.indexBuffer,He.segments,u.paint,b.transform.zoom,Ye,b.style.map.terrain&&He.centroidVertexBuffer)}}function Lu(b,o,u,m,v,w,P,k,F){var j;const W=b.style.projection,J=b.context,Y=b.transform,oe=J.gl,he=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],Pe=b.useProgram("hillshade",null,!1,he),Ee=!b.options.moving;for(const Ae of m){const Fe=o.getTile(Ae),He=Fe.fbo;if(!He)continue;const Ne=W.getMeshFromTileID(J,Ae.canonical,k,!0,"raster"),Ye=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(Ae);J.activeTexture.set(oe.TEXTURE0),oe.bindTexture(oe.TEXTURE_2D,He.colorAttachment.get());const Ke=Y.getProjectionData({overscaledTileID:Ae,aligned:Ee,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Pe.draw(J,oe.TRIANGLES,w,v[Ae.overscaledZ],P,Wn.backCCW,Cu(b,Fe,u),Ye,Ke,u.id,Ne.vertexBuffer,Ne.indexBuffer,Ne.segments)}}function wd(b,o,u,m,v,w,P,k,F){var j;const W=b.style.projection,J=b.context,Y=b.transform,oe=J.gl,he=b.useProgram("colorRelief"),Pe=!b.options.moving;let Ee=!0,Ae=0;for(const Fe of m){const He=o.getTile(Fe),Ne=He.dem;if(Ee){const ht=oe.getParameter(oe.MAX_TEXTURE_SIZE),{elevationTexture:pt,colorTexture:_t}=u.getColorRampTextures(J,ht,Ne.getUnpackVector());J.activeTexture.set(oe.TEXTURE1),pt.bind(oe.NEAREST,oe.CLAMP_TO_EDGE),J.activeTexture.set(oe.TEXTURE4),_t.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Ee=!1,Ae=pt.size[0]}if(!Ne||!Ne.data)continue;const Ye=Ne.stride,Ke=Ne.getPixels();if(J.activeTexture.set(oe.TEXTURE0),J.pixelStoreUnpackPremultiplyAlpha.set(!1),He.demTexture=He.demTexture||b.getTileTexture(Ye),He.demTexture){const ht=He.demTexture;ht.update(Ke,{premultiply:!1}),ht.bind(oe.LINEAR,oe.CLAMP_TO_EDGE)}else He.demTexture=new s.T(J,Ke,oe.RGBA,{premultiply:!1}),He.demTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE);const Ue=W.getMeshFromTileID(J,Fe.canonical,k,!0,"raster"),rt=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(Fe),yt=Y.getProjectionData({overscaledTileID:Fe,aligned:Pe,applyGlobeMatrix:!F,applyTerrainMatrix:!0});he.draw(J,oe.TRIANGLES,w,v[Fe.overscaledZ],P,Wn.backCCW,EC(u,He.dem,Ae),rt,yt,u.id,Ue.vertexBuffer,Ue.indexBuffer,Ue.segments)}}const pv=[new s.P(0,0),new s.P(s.$,0),new s.P(s.$,s.$),new s.P(0,s.$)];function Fl(b,o,u,m,v,w,P,k,F=!1,j=!1){const W=m[m.length-1].overscaledZ,J=b.context,Y=J.gl,oe=b.useProgram("raster"),he=b.transform,Pe=b.style.projection,Ee=b.colorModeForRenderPass(),Ae=!b.options.moving;for(const Fe of m){const He=b.getDepthModeForSublayer(Fe.overscaledZ-W,u.paint.get("raster-opacity")===1?Yn.ReadWrite:Yn.ReadOnly,Y.LESS),Ne=o.getTile(Fe);Ne.registerFadeDuration(u.paint.get("raster-fade-duration"));const Ye=o.findLoadedParent(Fe,0),Ke=o.findLoadedSibling(Fe),Ue=OC(Ne,Ye||Ke||null,o,u,b.transform,b.style.map.terrain);let rt,yt;const ht=u.paint.get("raster-resampling")==="nearest"?Y.NEAREST:Y.LINEAR;J.activeTexture.set(Y.TEXTURE0),Ne.texture.bind(ht,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),J.activeTexture.set(Y.TEXTURE1),Ye?(Ye.texture.bind(ht,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),rt=Math.pow(2,Ye.tileID.overscaledZ-Ne.tileID.overscaledZ),yt=[Ne.tileID.canonical.x*rt%1,Ne.tileID.canonical.y*rt%1]):Ne.texture.bind(ht,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),Ne.texture.useMipmap&&J.extTextureFilterAnisotropic&&b.transform.pitch>20&&Y.texParameterf(Y.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax);const pt=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Fe),_t=he.getProjectionData({overscaledTileID:Fe,aligned:Ae,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),sn=Cc(yt||[0,0],rt||1,Ue,u,k),rn=Pe.getMeshFromTileID(J,Fe.canonical,w,P,"raster");oe.draw(J,Y.TRIANGLES,He,v?v[Fe.overscaledZ]:Gn.disabled,Ee,F?Wn.frontCCW:Wn.backCCW,sn,pt,_t,u.id,rn.vertexBuffer,rn.indexBuffer,rn.segments)}}function OC(b,o,u,m,v,w){const P=m.paint.get("raster-fade-duration");if(!w&&P>0){const k=C.now(),F=(k-b.timeAdded)/P,j=o?(k-o.timeAdded)/P:-1,W=u.getSource(),J=Re(v,{tileSize:W.tileSize,roundZoom:W.roundZoom}),Y=!o||Math.abs(o.tileID.overscaledZ-J)>Math.abs(b.tileID.overscaledZ-J),oe=Y&&b.refreshedUponExpiration?1:s.ag(Y?F:1-j,0,1);return b.refreshedUponExpiration&&F>=1&&(b.refreshedUponExpiration=!1),o?{opacity:1,mix:1-oe}:{opacity:oe,mix:0}}return{opacity:1,mix:0}}const Fx=new s.be(1,0,0,1),cp=new s.be(0,1,0,1),mv=new s.be(0,0,1,1),Nx=new s.be(1,0,1,1),Bx=new s.be(0,1,1,1);function Sd(b,o,u,m){hp(b,0,o+u/2,b.transform.width,u,m)}function up(b,o,u,m){hp(b,o-u/2,0,u,b.transform.height,m)}function hp(b,o,u,m,v,w){const P=b.context,k=P.gl;k.enable(k.SCISSOR_TEST),k.scissor(o*b.pixelRatio,u*b.pixelRatio,m*b.pixelRatio,v*b.pixelRatio),P.clear({color:w}),k.disable(k.SCISSOR_TEST)}function Ux(b,o,u){const m=b.context,v=m.gl,w=b.useProgram("debug"),P=Yn.disabled,k=Gn.disabled,F=b.colorModeForRenderPass(),j="$debug",W=b.style.map.terrain&&b.style.map.terrain.getTerrainData(u);m.activeTexture.set(v.TEXTURE0);const J=o.getTileByID(u.key).latestRawTileData,Y=Math.floor((J&&J.byteLength||0)/1024),oe=o.getTile(u).tileSize,he=512/Math.min(oe,512)*(u.overscaledZ/b.transform.zoom)*.5;let Pe=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Pe+=` => ${u.overscaledZ}`),function(Ae,Fe){Ae.initDebugOverlayCanvas();const He=Ae.debugOverlayCanvas,Ne=Ae.context.gl,Ye=Ae.debugOverlayCanvas.getContext("2d");Ye.clearRect(0,0,He.width,He.height),Ye.shadowColor="white",Ye.shadowBlur=2,Ye.lineWidth=1.5,Ye.strokeStyle="white",Ye.textBaseline="top",Ye.font="bold 36px Open Sans, sans-serif",Ye.fillText(Fe,5,5),Ye.strokeText(Fe,5,5),Ae.debugOverlayTexture.update(He),Ae.debugOverlayTexture.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE)}(b,`${Pe} ${Y}kB`);const Ee=b.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(m,v.TRIANGLES,P,k,sr.alphaBlended,Wn.disabled,vx(s.be.transparent,he),null,Ee,j,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),w.draw(m,v.LINE_STRIP,P,k,F,Wn.disabled,vx(s.be.red),W,Ee,j,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function oi(b,o,u,m){const{isRenderingGlobe:v}=m,w=b.context,P=w.gl,k=b.transform,F=b.colorModeForRenderPass(),j=b.getDepthModeFor3D(),W=b.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,b.width,b.height]);for(const J of u){const Y=o.getTerrainMesh(J.tileID),oe=b.renderToTexture.getTexture(J),he=o.getTerrainData(J.tileID);w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,oe.texture);const Pe=o.getMeshFrameDelta(k.zoom),Ee=k.calculateFogMatrix(J.tileID.toUnwrapped()),Ae=wC(Pe,Ee,b.style.sky,k.pitch,v),Fe=k.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});W.draw(w,P.TRIANGLES,j,Gn.disabled,F,Wn.backCCW,Ae,he,Fe,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}function Nl(b,o){if(!o.mesh){const u=new s.aK;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const m=new s.aM;m.emplaceBack(0,1,2),m.emplaceBack(0,2,3),o.mesh=new rl(b.createVertexBuffer(u,il.members),b.createIndexBuffer(m),s.aL.simpleSegment(0,0,u.length,m.length))}return o.mesh}class Ts{constructor(o,u){this.context=new er(o),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Je.maxUnderzooming+Je.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ii}resize(o,u,m){if(this.width=Math.floor(o*m),this.height=Math.floor(u*m),this.pixelRatio=m,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const o=this.context,u=new s.aK;u.emplaceBack(0,0),u.emplaceBack(s.$,0),u.emplaceBack(0,s.$),u.emplaceBack(s.$,s.$),this.tileExtentBuffer=o.createVertexBuffer(u,il.members),this.tileExtentSegments=s.aL.simpleSegment(0,0,4,2);const m=new s.aK;m.emplaceBack(0,0),m.emplaceBack(s.$,0),m.emplaceBack(0,s.$),m.emplaceBack(s.$,s.$),this.debugBuffer=o.createVertexBuffer(m,il.members),this.debugSegments=s.aL.simpleSegment(0,0,4,5);const v=new s.c5;v.emplaceBack(0,0,0,0),v.emplaceBack(s.$,0,s.$,0),v.emplaceBack(0,s.$,0,s.$),v.emplaceBack(s.$,s.$,s.$,s.$),this.rasterBoundsBuffer=o.createVertexBuffer(v,xC.members),this.rasterBoundsSegments=s.aL.simpleSegment(0,0,4,2);const w=new s.aK;w.emplaceBack(0,0),w.emplaceBack(s.$,0),w.emplaceBack(0,s.$),w.emplaceBack(s.$,s.$),this.rasterBoundsBufferPosOnly=o.createVertexBuffer(w,il.members),this.rasterBoundsSegmentsPosOnly=s.aL.simpleSegment(0,0,4,5);const P=new s.aK;P.emplaceBack(0,0),P.emplaceBack(1,0),P.emplaceBack(0,1),P.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(P,il.members),this.viewportSegments=s.aL.simpleSegment(0,0,4,2);const k=new s.c6;k.emplaceBack(0),k.emplaceBack(1),k.emplaceBack(3),k.emplaceBack(2),k.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(k);const F=new s.aM;F.emplaceBack(1,0,2),F.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(F);const j=this.context.gl;this.stencilClearMode=new Gn({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.tileExtentMesh=new rl(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const o=this.context,u=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const m=s.L();s.bX(m,0,this.width,this.height,0,0,1),s.N(m,m,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const v={mainMatrix:m,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:m};this.useProgram("clippingMask",null,!0).draw(o,u.TRIANGLES,Yn.disabled,this.stencilClearMode,sr.disabled,Wn.disabled,null,null,v,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,u,m){if(this.currentStencilSource===o.source||!o.isTileClipped()||!u||!u.length)return;this.currentStencilSource=o.source,this.nextStencilID+u.length>256&&this.clearStencil();const v=this.context;v.setColorMode(sr.disabled),v.setDepthMode(Yn.disabled);const w={};for(const P of u)w[P.key]=this.nextStencilID++;this._renderTileMasks(w,u,m,!0),this._renderTileMasks(w,u,m,!1),this._tileClippingMaskIDs=w}_renderTileMasks(o,u,m,v){const w=this.context,P=w.gl,k=this.style.projection,F=this.transform,j=this.useProgram("clippingMask");for(const W of u){const J=o[W.key],Y=this.style.map.terrain&&this.style.map.terrain.getTerrainData(W),oe=k.getMeshFromTileID(this.context,W.canonical,v,!0,"stencil"),he=F.getProjectionData({overscaledTileID:W,applyGlobeMatrix:!m,applyTerrainMatrix:!0});j.draw(w,P.TRIANGLES,Yn.disabled,new Gn({func:P.ALWAYS,mask:0},J,255,P.KEEP,P.KEEP,P.REPLACE),sr.disabled,m?Wn.disabled:Wn.backCCW,null,Y,he,"$clipping",oe.vertexBuffer,oe.indexBuffer,oe.segments)}}_renderTilesDepthBuffer(){const o=this.context,u=o.gl,m=this.style.projection,v=this.transform,w=this.useProgram("depth"),P=this.getDepthModeFor3D(),k=De(v,{tileSize:v.tileSize});for(const F of k){const j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),W=m.getMeshFromTileID(this.context,F.canonical,!0,!0,"raster"),J=v.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(o,u.TRIANGLES,P,Gn.disabled,sr.disabled,Wn.backCCW,null,j,J,"$clipping",W.vertexBuffer,W.indexBuffer,W.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new Gn({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){const u=this.context.gl;return new Gn({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(o){const u=this.context.gl,m=o.sort((P,k)=>k.overscaledZ-P.overscaledZ),v=m[m.length-1].overscaledZ,w=m[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const P={};for(let k=0;k<w;k++)P[k+v]=new Gn({func:u.GEQUAL,mask:255},k+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=w,[P,m]}return[{[v]:Gn.disabled},m]}stencilConfigForOverlapTwoPass(o){const u=this.context.gl,m=o.sort((P,k)=>k.overscaledZ-P.overscaledZ),v=m[m.length-1].overscaledZ,w=m[0].overscaledZ-v+1;if(this.clearStencil(),w>1){const P={},k={};for(let F=0;F<w;F++)P[F+v]=new Gn({func:u.GREATER,mask:255},w+1+F,255,u.KEEP,u.KEEP,u.REPLACE),k[F+v]=new Gn({func:u.GREATER,mask:255},1+F,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*w+1,[P,k,m]}return this.nextStencilID=3,[{[v]:new Gn({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[v]:new Gn({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},m]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new sr([o.CONSTANT_COLOR,o.ONE],new s.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?sr.unblended:sr.alphaBlended}getDepthModeForSublayer(o,u,m){if(!this.opaquePassEnabledForLayer())return Yn.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Yn(m||this.context.gl.LEQUAL,u,[v,v])}getDepthModeFor3D(){return new Yn(this.context.gl.LEQUAL,Yn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,u){var m,v;this.style=o,this.options=u,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(C.now()),this.imageManager.beginFrame();const w=this.style._order,P=this.style.sourceCaches,k={},F={},j={},W={isRenderingToTexture:!1,isRenderingGlobe:((m=o.projection)===null||m===void 0?void 0:m.transitionState)>0};for(const Y in P){const oe=P[Y];oe.used&&oe.prepare(this.context),k[Y]=oe.getVisibleCoordinates(!1),F[Y]=k[Y].slice().reverse(),j[Y]=oe.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Y=0;Y<w.length;Y++)if(this.style._layers[w[Y]].is3D()){this.opaquePassCutoff=Y;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const Y of w){const oe=this.style._layers[Y];if(!oe.hasOffscreenPass()||oe.isHidden(this.transform.zoom))continue;const he=F[oe.source];(oe.type==="custom"||he.length)&&this.renderLayer(this,P[oe.source],oe,he,W)}if((v=this.style.projection)===null||v===void 0||v.updateGPUdependent({context:this.context,useProgram:Y=>this.useProgram(Y)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?s.be.black:s.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(Y,oe){const he=Y.context,Pe=he.gl,Ee=((Ke,Ue,rt)=>{const yt=Math.cos(Ue.rollInRadians),ht=Math.sin(Ue.rollInRadians),pt=ne(Ue),_t=Ue.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ke.properties.get("sky-color"),u_horizon_color:Ke.properties.get("horizon-color"),u_horizon:[(Ue.width/2-pt*ht)*rt,(Ue.height/2+pt*yt)*rt],u_horizon_normal:[-ht,yt],u_sky_horizon_blend:Ke.properties.get("sky-horizon-blend")*Ue.height/2*rt,u_sky_blend:_t}})(oe,Y.style.map.transform,Y.pixelRatio),Ae=new Yn(Pe.LEQUAL,Yn.ReadWrite,[0,1]),Fe=Gn.disabled,He=Y.colorModeForRenderPass(),Ne=Y.useProgram("sky"),Ye=Nl(he,oe);Ne.draw(he,Pe.TRIANGLES,Ae,Fe,He,Wn.disabled,Ee,null,void 0,"sky",Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const Y=this.style._layers[w[this.currentLayer]],oe=P[Y.source],he=k[Y.source];this._renderTileClippingMasks(Y,he,!1),this.renderLayer(this,oe,Y,he,W)}this.renderPass="translucent";let J=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const Y=this.style._layers[w[this.currentLayer]],oe=P[Y.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Y,W))continue;this.opaquePassEnabledForLayer()||J||(J=!0,W.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const he=(Y.type==="symbol"?j:F)[Y.source];this._renderTileClippingMasks(Y,k[Y.source],!!this.renderToTexture),this.renderLayer(this,oe,Y,he,W)}if(W.isRenderingGlobe&&function(Y,oe,he){const Pe=Y.context,Ee=Pe.gl,Ae=Y.useProgram("atmosphere"),Fe=new Yn(Ee.LEQUAL,Yn.ReadOnly,[0,1]),He=Y.transform,Ne=function(_t,sn){const rn=_t.properties.get("position"),Vt=[-rn.x,-rn.y,-rn.z],Mn=s.af(new Float64Array(16));return _t.properties.get("anchor")==="map"&&(s.b5(Mn,Mn,sn.rollInRadians),s.b6(Mn,Mn,-sn.pitchInRadians),s.b5(Mn,Mn,sn.bearingInRadians),s.b6(Mn,Mn,sn.center.lat*Math.PI/180),s.by(Mn,Mn,-sn.center.lng*Math.PI/180)),s.c4(Vt,Vt,Mn),Vt}(he,Y.transform),Ye=He.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ke=oe.properties.get("atmosphere-blend")*Ye.projectionTransition;if(Ke===0)return;const Ue=_u(He.worldSize,He.center.lat),rt=He.inverseProjectionMatrix,yt=new Float64Array(4);yt[3]=1,s.av(yt,yt,He.modelViewProjectionMatrix),yt[0]/=yt[3],yt[1]/=yt[3],yt[2]/=yt[3],yt[3]=1,s.av(yt,yt,rt),yt[0]/=yt[3],yt[1]/=yt[3],yt[2]/=yt[3],yt[3]=1;const ht=((_t,sn,rn,Vt,Mn)=>({u_sun_pos:_t,u_atmosphere_blend:sn,u_globe_position:rn,u_globe_radius:Vt,u_inv_proj_matrix:Mn}))(Ne,Ke,[yt[0],yt[1],yt[2]],Ue,rt),pt=Nl(Pe,oe);Ae.draw(Pe,Ee.TRIANGLES,Fe,Gn.disabled,sr.alphaBlended,Wn.disabled,ht,null,null,"atmosphere",pt.vertexBuffer,pt.indexBuffer,pt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const Y=function(oe,he){let Pe=null;const Ee=Object.values(oe._layers).flatMap(Ne=>Ne.source&&!Ne.isHidden(he)?[oe.sourceCaches[Ne.source]]:[]),Ae=Ee.filter(Ne=>Ne.getSource().type==="vector"),Fe=Ee.filter(Ne=>Ne.getSource().type!=="vector"),He=Ne=>{(!Pe||Pe.getSource().maxzoom<Ne.getSource().maxzoom)&&(Pe=Ne)};return Ae.forEach(Ne=>He(Ne)),Pe||Fe.forEach(Ne=>He(Ne)),Pe}(this.style,this.transform.zoom);Y&&function(oe,he,Pe){for(let Ee=0;Ee<Pe.length;Ee++)Ux(oe,he,Pe[Ee])}(this,Y,Y.getVisibleCoordinates())}this.options.showPadding&&function(Y){const oe=Y.transform.padding;Sd(Y,Y.transform.height-(oe.top||0),3,Fx),Sd(Y,oe.bottom||0,3,cp),up(Y,oe.left||0,3,mv),up(Y,Y.transform.width-(oe.right||0),3,Nx);const he=Y.transform.centerPoint;(function(Pe,Ee,Ae,Fe){hp(Pe,Ee-1,Ae-10,2,20,Fe),hp(Pe,Ee-10,Ae-1,20,2,Fe)})(Y,he.x,Y.transform.height-he.y,Bx)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,m=this.transform.modelViewProjectionMatrix;let v=this.terrainFacilitator.dirty;v||(v=o?!s.c7(u,m):!s.c8(u,m)),v||(v=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),v&&(s.c9(u,m),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,P){const k=w.context,F=k.gl,j=w.transform,W=sr.unblended,J=new Yn(F.LEQUAL,Yn.ReadWrite,[0,1]),Y=P.sourceCache.getRenderableTiles(),oe=w.useProgram("terrainDepth");k.bindFramebuffer.set(P.getFramebuffer("depth").framebuffer),k.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),k.clear({color:s.be.transparent,depth:1});for(const he of Y){const Pe=P.getTerrainMesh(he.tileID),Ee=P.getTerrainData(he.tileID),Ae=j.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Fe={u_ele_delta:P.getMeshFrameDelta(j.zoom)};oe.draw(k,F.TRIANGLES,J,Gn.disabled,W,Wn.backCCW,Fe,Ee,Ae,"terrain",Pe.vertexBuffer,Pe.indexBuffer,Pe.segments)}k.bindFramebuffer.set(null),k.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,P){const k=w.context,F=k.gl,j=w.transform,W=sr.unblended,J=new Yn(F.LEQUAL,Yn.ReadWrite,[0,1]),Y=P.getCoordsTexture(),oe=P.sourceCache.getRenderableTiles(),he=w.useProgram("terrainCoords");k.bindFramebuffer.set(P.getFramebuffer("coords").framebuffer),k.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),k.clear({color:s.be.transparent,depth:1}),P.coordsIndex=[];for(const Pe of oe){const Ee=P.getTerrainMesh(Pe.tileID),Ae=P.getTerrainData(Pe.tileID);k.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,Y.texture);const Fe={u_terrain_coords_id:(255-P.coordsIndex.length)/255,u_texture:0,u_ele_delta:P.getMeshFrameDelta(j.zoom)},He=j.getProjectionData({overscaledTileID:Pe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});he.draw(k,F.TRIANGLES,J,Gn.disabled,W,Wn.backCCW,Fe,Ae,He,"terrain",Ee.vertexBuffer,Ee.indexBuffer,Ee.segments),P.coordsIndex.push(Pe.tileID.key)}k.bindFramebuffer.set(null),k.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(o,u,m,v,w){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="custom"||(v||[]).length)&&(this.id=m.id,s.ca(m)?function(P,k,F,j,W,J){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=J,oe=Gn.disabled,he=P.colorModeForRenderPass();(F._unevaluatedLayout.hasValue("text-variable-anchor")||F._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Pe,Ee,Ae,Fe,He,Ne,Ye,Ke,Ue){const rt=Ee.transform,yt=Ee.style.map.terrain,ht=He==="map",pt=Ne==="map";for(const _t of Pe){const sn=Fe.getTile(_t),rn=sn.getBucket(Ae);if(!rn||!rn.text||!rn.text.segments.get().length)continue;const Vt=s.am(rn.textSizeData,rt.zoom),Mn=s.aB(sn,1,Ee.transform.zoom),Kn=tt(ht,Ee.transform,Mn),Mr=Ae.layout.get("icon-text-fit")!=="none"&&rn.hasIconData();if(Vt){const ti=Math.pow(2,rt.zoom-sn.tileID.overscaledZ),Pr=yt?(ni,Dr)=>yt.getElevation(_t,ni,Dr):null;zC(rn,ht,pt,Ue,rt,Kn,ti,Vt,Mr,s.aC(rt,sn,Ye,Ke),_t.toUnwrapped(),Pr)}}}(j,P,F,k,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),W),F.paint.get("icon-opacity").constantOr(1)!==0&&Ox(P,k,F,j,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),oe,he,Y),F.paint.get("text-opacity").constantOr(1)!==0&&Ox(P,k,F,j,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),oe,he,Y),k.map.showCollisionBoxes&&(kx(P,k,F,j,!0),kx(P,k,F,j,!1))}(o,u,m,v,this.style.placement.variableOffsets,w):s.cb(m)?function(P,k,F,j,W){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:J}=W,Y=F.paint.get("circle-opacity"),oe=F.paint.get("circle-stroke-width"),he=F.paint.get("circle-stroke-opacity"),Pe=!F.layout.get("circle-sort-key").isConstant();if(Y.constantOr(1)===0&&(oe.constantOr(1)===0||he.constantOr(1)===0))return;const Ee=P.context,Ae=Ee.gl,Fe=P.transform,He=P.getDepthModeForSublayer(0,Yn.ReadOnly),Ne=Gn.disabled,Ye=P.colorModeForRenderPass(),Ke=[],Ue=Fe.getCircleRadiusCorrection();for(let rt=0;rt<j.length;rt++){const yt=j[rt],ht=k.getTile(yt),pt=ht.getBucket(F);if(!pt)continue;const _t=F.paint.get("circle-translate"),sn=F.paint.get("circle-translate-anchor"),rn=s.aC(Fe,ht,_t,sn),Vt=pt.programConfigurations.get(F.id),Mn=P.useProgram("circle",Vt),Kn=pt.layoutVertexBuffer,Mr=pt.indexBuffer,ti=P.style.map.terrain&&P.style.map.terrain.getTerrainData(yt),Pr={programConfiguration:Vt,program:Mn,layoutVertexBuffer:Kn,indexBuffer:Mr,uniformValues:Jg(P,ht,F,rn,Ue),terrainData:ti,projectionData:Fe.getProjectionData({overscaledTileID:yt,applyGlobeMatrix:!J,applyTerrainMatrix:!0})};if(Pe){const ni=pt.segments.get();for(const Dr of ni)Ke.push({segments:new s.aL([Dr]),sortKey:Dr.sortKey,state:Pr})}else Ke.push({segments:pt.segments,sortKey:0,state:Pr})}Pe&&Ke.sort((rt,yt)=>rt.sortKey-yt.sortKey);for(const rt of Ke){const{programConfiguration:yt,program:ht,layoutVertexBuffer:pt,indexBuffer:_t,uniformValues:sn,terrainData:rn,projectionData:Vt}=rt.state;ht.draw(Ee,Ae.TRIANGLES,He,Ne,Ye,Wn.backCCW,sn,rn,Vt,F.id,pt,_t,rt.segments,F.paint,P.transform.zoom,yt)}}(o,u,m,v,w):s.cc(m)?function(P,k,F,j,W){if(F.paint.get("heatmap-opacity")===0)return;const J=P.context,{isRenderingToTexture:Y,isRenderingGlobe:oe}=W;if(P.style.map.terrain){for(const he of j){const Pe=k.getTile(he);k.hasRenderableParent(he)||(P.renderPass==="offscreen"?sp(P,Pe,F,he,oe):P.renderPass==="translucent"&&ap(P,F,he,Y,oe))}J.viewport.set([0,0,P.width,P.height])}else P.renderPass==="offscreen"?function(he,Pe,Ee,Ae){const Fe=he.context,He=Fe.gl,Ne=he.transform,Ye=Gn.disabled,Ke=new sr([He.ONE,He.ONE],s.be.transparent,[!0,!0,!0,!0]);(function(Ue,rt,yt){const ht=Ue.gl;Ue.activeTexture.set(ht.TEXTURE1),Ue.viewport.set([0,0,rt.width/4,rt.height/4]);let pt=yt.heatmapFbos.get(s.c1);pt?(ht.bindTexture(ht.TEXTURE_2D,pt.colorAttachment.get()),Ue.bindFramebuffer.set(pt.framebuffer)):(pt=xd(Ue,rt.width/4,rt.height/4),yt.heatmapFbos.set(s.c1,pt))})(Fe,he,Ee),Fe.clear({color:s.be.transparent});for(let Ue=0;Ue<Ae.length;Ue++){const rt=Ae[Ue];if(Pe.hasRenderableParent(rt))continue;const yt=Pe.getTile(rt),ht=yt.getBucket(Ee);if(!ht)continue;const pt=ht.programConfigurations.get(Ee.id),_t=he.useProgram("heatmap",pt),sn=Ne.getProjectionData({overscaledTileID:rt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),rn=Ne.getCircleRadiusCorrection();_t.draw(Fe,He.TRIANGLES,Yn.disabled,Ye,Ke,Wn.backCCW,gd(yt,Ne.zoom,Ee.paint.get("heatmap-intensity"),rn),null,sn,Ee.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,Ee.paint,Ne.zoom,pt)}Fe.viewport.set([0,0,he.width,he.height])}(P,k,F,j):P.renderPass==="translucent"&&function(he,Pe){const Ee=he.context,Ae=Ee.gl;Ee.setColorMode(he.colorModeForRenderPass());const Fe=Pe.heatmapFbos.get(s.c1);Fe&&(Ee.activeTexture.set(Ae.TEXTURE0),Ae.bindTexture(Ae.TEXTURE_2D,Fe.colorAttachment.get()),Ee.activeTexture.set(Ae.TEXTURE1),lp(Ee,Pe).bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),he.useProgram("heatmapTexture").draw(Ee,Ae.TRIANGLES,Yn.disabled,Gn.disabled,he.colorModeForRenderPass(),Wn.disabled,yx(he,Pe,0,1),null,null,Pe.id,he.viewportBuffer,he.quadTriangleIndexBuffer,he.viewportSegments,Pe.paint,he.transform.zoom))}(P,F)}(o,u,m,v,w):s.cd(m)?function(P,k,F,j,W){if(P.renderPass!=="translucent")return;const{isRenderingToTexture:J}=W,Y=F.paint.get("line-opacity"),oe=F.paint.get("line-width");if(Y.constantOr(1)===0||oe.constantOr(1)===0)return;const he=P.getDepthModeForSublayer(0,Yn.ReadOnly),Pe=P.colorModeForRenderPass(),Ee=F.paint.get("line-dasharray"),Ae=F.paint.get("line-pattern"),Fe=Ae.constantOr(1),He=F.paint.get("line-gradient"),Ne=F.getCrossfadeParameters(),Ye=Fe?"linePattern":Ee?"lineSDF":He?"lineGradient":"line",Ke=P.context,Ue=Ke.gl,rt=P.transform;let yt=!0;for(const ht of j){const pt=k.getTile(ht);if(Fe&&!pt.patternsLoaded())continue;const _t=pt.getBucket(F);if(!_t)continue;const sn=_t.programConfigurations.get(F.id),rn=P.context.program.get(),Vt=P.useProgram(Ye,sn),Mn=yt||Vt.program!==rn,Kn=P.style.map.terrain&&P.style.map.terrain.getTerrainData(ht),Mr=Ae.constantOr(null);if(Mr&&pt.imageAtlas){const Ar=pt.imageAtlas,zr=Ar.patternPositions[Mr.to.toString()],to=Ar.patternPositions[Mr.from.toString()];zr&&to&&sn.setConstantPatternPositions(zr,to)}const ti=rt.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!J,applyTerrainMatrix:!0}),Pr=rt.getPixelScale(),ni=Fe?xx(P,pt,F,Pr,Ne):Ee?bx(P,pt,F,Pr,Ee,Ne):He?Qg(P,pt,F,Pr,_t.lineClipsArray.length):Kf(P,pt,F,Pr);if(Fe)Ke.activeTexture.set(Ue.TEXTURE0),pt.imageAtlasTexture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),sn.updatePaintBuffers(Ne);else if(Ee&&(Mn||P.lineAtlas.dirty))Ke.activeTexture.set(Ue.TEXTURE0),P.lineAtlas.bind(Ke);else if(He){const Ar=_t.gradients[F.id];let zr=Ar.texture;if(F.gradientVersion!==Ar.version){let to=256;if(F.stepInterpolant){const ur=k.getSource().maxzoom,Hi=ht.canonical.z===ur?Math.ceil(1<<P.transform.maxZoom-ht.canonical.z):1;to=s.ag(s.c2(_t.maxLineLength/s.$*1024*Hi),256,Ke.maxTextureSize)}Ar.gradient=s.c3({expression:F.gradientExpression(),evaluationKey:"lineProgress",resolution:to,image:Ar.gradient||void 0,clips:_t.lineClipsArray}),Ar.texture?Ar.texture.update(Ar.gradient):Ar.texture=new s.T(Ke,Ar.gradient,Ue.RGBA),Ar.version=F.gradientVersion,zr=Ar.texture}Ke.activeTexture.set(Ue.TEXTURE0),zr.bind(F.stepInterpolant?Ue.NEAREST:Ue.LINEAR,Ue.CLAMP_TO_EDGE)}const Dr=P.stencilModeForClipping(ht);Vt.draw(Ke,Ue.TRIANGLES,he,Dr,Pe,Wn.disabled,ni,Kn,ti,F.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,F.paint,P.transform.zoom,sn,_t.layoutVertexBuffer2),yt=!1}}(o,u,m,v,w):s.ce(m)?function(P,k,F,j,W){const J=F.paint.get("fill-color"),Y=F.paint.get("fill-opacity");if(Y.constantOr(1)===0)return;const{isRenderingToTexture:oe}=W,he=P.colorModeForRenderPass(),Pe=F.paint.get("fill-pattern"),Ee=P.opaquePassEnabledForLayer()&&!Pe.constantOr(1)&&J.constantOr(s.be.transparent).a===1&&Y.constantOr(0)===1?"opaque":"translucent";if(P.renderPass===Ee){const Ae=P.getDepthModeForSublayer(1,P.renderPass==="opaque"?Yn.ReadWrite:Yn.ReadOnly);bd(P,k,F,j,Ae,he,!1,oe)}if(P.renderPass==="translucent"&&F.paint.get("fill-antialias")){const Ae=P.getDepthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Yn.ReadOnly);bd(P,k,F,j,Ae,he,!0,oe)}}(o,u,m,v,w):s.cf(m)?function(P,k,F,j,W){const J=F.paint.get("fill-extrusion-opacity");if(J===0)return;const{isRenderingToTexture:Y}=W;if(P.renderPass==="translucent"){const oe=new Yn(P.context.gl.LEQUAL,Yn.ReadWrite,P.depthRangeFor3D);if(J!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))Ru(P,k,F,j,oe,Gn.disabled,sr.disabled,Y),Ru(P,k,F,j,oe,P.stencilModeFor3D(),P.colorModeForRenderPass(),Y);else{const he=P.colorModeForRenderPass();Ru(P,k,F,j,oe,Gn.disabled,he,Y)}}}(o,u,m,v,w):s.cg(m)?function(P,k,F,j,W){if(P.renderPass!=="offscreen"&&P.renderPass!=="translucent")return;const{isRenderingToTexture:J}=W,Y=P.context,oe=P.style.projection.useSubdivision,he=P.getDepthModeForSublayer(0,Yn.ReadOnly),Pe=P.colorModeForRenderPass();if(P.renderPass==="offscreen")(function(Ee,Ae,Fe,He,Ne,Ye,Ke){const Ue=Ee.context,rt=Ue.gl;for(const yt of Fe){const ht=Ae.getTile(yt),pt=ht.dem;if(!pt||!pt.data||!ht.needsHillshadePrepare)continue;const _t=pt.dim,sn=pt.stride,rn=pt.getPixels();if(Ue.activeTexture.set(rt.TEXTURE1),Ue.pixelStoreUnpackPremultiplyAlpha.set(!1),ht.demTexture=ht.demTexture||Ee.getTileTexture(sn),ht.demTexture){const Mn=ht.demTexture;Mn.update(rn,{premultiply:!1}),Mn.bind(rt.NEAREST,rt.CLAMP_TO_EDGE)}else ht.demTexture=new s.T(Ue,rn,rt.RGBA,{premultiply:!1}),ht.demTexture.bind(rt.NEAREST,rt.CLAMP_TO_EDGE);Ue.activeTexture.set(rt.TEXTURE0);let Vt=ht.fbo;if(!Vt){const Mn=new s.T(Ue,{width:_t,height:_t,data:null},rt.RGBA);Mn.bind(rt.LINEAR,rt.CLAMP_TO_EDGE),Vt=ht.fbo=Ue.createFramebuffer(_t,_t,!0,!1),Vt.colorAttachment.set(Mn.texture)}Ue.bindFramebuffer.set(Vt.framebuffer),Ue.viewport.set([0,0,_t,_t]),Ee.useProgram("hillshadePrepare").draw(Ue,rt.TRIANGLES,Ne,Ye,Ke,Wn.disabled,CC(ht.tileID,pt),null,null,He.id,Ee.rasterBoundsBuffer,Ee.quadTriangleIndexBuffer,Ee.rasterBoundsSegments),ht.needsHillshadePrepare=!1}})(P,k,j,F,he,Gn.disabled,Pe),Y.viewport.set([0,0,P.width,P.height]);else if(P.renderPass==="translucent")if(oe){const[Ee,Ae,Fe]=P.stencilConfigForOverlapTwoPass(j);Lu(P,k,F,Fe,Ee,he,Pe,!1,J),Lu(P,k,F,Fe,Ae,he,Pe,!0,J)}else{const[Ee,Ae]=P.getStencilConfigForOverlapAndUpdateStencilID(j);Lu(P,k,F,Ae,Ee,he,Pe,!1,J)}}(o,u,m,v,w):s.ch(m)?function(P,k,F,j,W){if(P.renderPass!=="translucent"||!j.length)return;const{isRenderingToTexture:J}=W,Y=P.style.projection.useSubdivision,oe=P.getDepthModeForSublayer(0,Yn.ReadOnly),he=P.colorModeForRenderPass();if(Y){const[Pe,Ee,Ae]=P.stencilConfigForOverlapTwoPass(j);wd(P,k,F,Ae,Pe,oe,he,!1,J),wd(P,k,F,Ae,Ee,oe,he,!0,J)}else{const[Pe,Ee]=P.getStencilConfigForOverlapAndUpdateStencilID(j);wd(P,k,F,Ee,Pe,oe,he,!1,J)}}(o,u,m,v,w):s.ci(m)?function(P,k,F,j,W){if(P.renderPass!=="translucent"||F.paint.get("raster-opacity")===0||!j.length)return;const{isRenderingToTexture:J}=W,Y=k.getSource(),oe=P.style.projection.useSubdivision;if(Y instanceof An)Fl(P,k,F,j,null,!1,!1,Y.tileCoords,Y.flippedWindingOrder,J);else if(oe){const[he,Pe,Ee]=P.stencilConfigForOverlapTwoPass(j);Fl(P,k,F,Ee,he,!1,!0,pv,!1,J),Fl(P,k,F,Ee,Pe,!0,!0,pv,!1,J)}else{const[he,Pe]=P.getStencilConfigForOverlapAndUpdateStencilID(j);Fl(P,k,F,Pe,he,!1,!0,pv,!1,J)}}(o,u,m,v,w):s.cj(m)?function(P,k,F,j,W){const J=F.paint.get("background-color"),Y=F.paint.get("background-opacity");if(Y===0)return;const{isRenderingToTexture:oe}=W,he=P.context,Pe=he.gl,Ee=P.style.projection,Ae=P.transform,Fe=Ae.tileSize,He=F.paint.get("background-pattern");if(P.isPatternMissing(He))return;const Ne=!He&&J.a===1&&Y===1&&P.opaquePassEnabledForLayer()?"opaque":"translucent";if(P.renderPass!==Ne)return;const Ye=Gn.disabled,Ke=P.getDepthModeForSublayer(0,Ne==="opaque"?Yn.ReadWrite:Yn.ReadOnly),Ue=P.colorModeForRenderPass(),rt=P.useProgram(He?"backgroundPattern":"background"),yt=j||De(Ae,{tileSize:Fe,terrain:P.style.map.terrain});He&&(he.activeTexture.set(Pe.TEXTURE0),P.imageManager.bind(P.context));const ht=F.getCrossfadeParameters();for(const pt of yt){const _t=Ae.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!oe,applyTerrainMatrix:!0}),sn=He?PC(Y,P,He,{tileID:pt,tileSize:Fe},ht):Jf(Y,J),rn=P.style.map.terrain&&P.style.map.terrain.getTerrainData(pt),Vt=Ee.getMeshFromTileID(he,pt.canonical,!1,!0,"raster");rt.draw(he,Pe.TRIANGLES,Ke,Ye,Ue,Wn.backCCW,sn,rn,_t,F.id,Vt.vertexBuffer,Vt.indexBuffer,Vt.segments)}}(o,0,m,v,w):s.ck(m)&&function(P,k,F,j){const{isRenderingGlobe:W}=j,J=P.context,Y=F.implementation,oe=P.style.projection,he=P.transform,Pe=he.getProjectionDataForCustomLayer(W),Ee={farZ:he.farZ,nearZ:he.nearZ,fov:he.fov*Math.PI/180,modelViewProjectionMatrix:he.modelViewProjectionMatrix,projectionMatrix:he.projectionMatrix,shaderData:{variantName:oe.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${oe.shaderPreludeCode.vertexSource}`,define:oe.shaderDefine},defaultProjectionData:Pe},Ae=Y.renderingMode?Y.renderingMode:"2d";if(P.renderPass==="offscreen"){const Fe=Y.prerender;Fe&&(P.setCustomLayerDefaults(),J.setColorMode(P.colorModeForRenderPass()),Fe.call(Y,J.gl,Ee),J.setDirty(),P.setBaseState())}else if(P.renderPass==="translucent"){P.setCustomLayerDefaults(),J.setColorMode(P.colorModeForRenderPass()),J.setStencilMode(Gn.disabled);const Fe=Ae==="3d"?P.getDepthModeFor3D():P.getDepthModeForSublayer(0,Yn.ReadOnly);J.setDepthMode(Fe),Y.render(J.gl,Ee),J.setDirty(),P.setBaseState(),J.bindFramebuffer.set(null)}}(o,0,m,w))}saveTileTexture(o){const u=this._tileTextures[o.size[0]];u?u.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const u=this.imageManager.getPattern(o.from.toString()),m=this.imageManager.getPattern(o.to.toString());return!u||!m}useProgram(o,u,m=!1,v=[]){this.cache=this.cache||{};const w=!!this.style.map.terrain,P=this.style.projection,k=m?$i.projectionMercator:P.shaderPreludeCode,F=m?wc:P.shaderDefine,j=o+(u?u.cacheKey:"")+`/${m?Hg:P.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(w?"/terrain":"")+(v?`/${v.join("/")}`:"");return this.cache[j]||(this.cache[j]=new Xf(this.context,$i[o],u,Mx[o],this._showOverdrawInspector,w,k,F,v)),this.cache[j]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:u}=this.context.gl;return this.width!==o||this.height!==u}}function dp(b,o){let u,m=!1,v=null,w=null;const P=()=>{v=null,m&&(b.apply(w,u),v=setTimeout(P,o),m=!1)};return(...k)=>(m=!0,w=this,u=k,v||P(),v)}class Md{constructor(o){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let m;return u.split("&").map(v=>v.split("=")).forEach(v=>{v[0]===this._hashName&&(m=v)}),(m&&m[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const m=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const m=u.join("/");let v=m;v.split("&").length>0&&(v=v.split("&")[0]),this._hashName&&(v=`${this._hashName}=${m}`);let w=window.location.hash.replace(v,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let P=window.location.href.replace(/(#.+)?$/,w);P=P.replace("&&","&"),window.history.replaceState(window.history.state,null,P)},this._updateHash=dp(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const u=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,v=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,v),P=Math.round(u.lng*w)/w,k=Math.round(u.lat*w)/w,F=this._map.getBearing(),j=this._map.getPitch();let W="";if(W+=o?`/${P}/${k}/${m}`:`${m}/${k}/${P}`,(F||j)&&(W+="/"+Math.round(10*F)/10),j&&(W+=`/${Math.round(j)}`),this._hashName){const J=this._hashName;let Y=!1;const oe=window.location.hash.slice(1).split("&").map(he=>{const Pe=he.split("=")[0];return Pe===J?(Y=!0,`${Pe}=${W}`):he}).filter(he=>he);return Y||oe.push(`${J}=${W}`),`#${oe.join("&")}`}return`#${W}`}_isValidHash(o){if(o.length<3||o.some(isNaN))return!1;try{new s.S(+o[2],+o[1])}catch{return!1}const u=+o[0],m=+(o[3]||0),v=+(o[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&m>=-180&&m<=180&&v>=this._map.getMinPitch()&&v<=this._map.getMaxPitch()}}const ku={linearity:.3,easing:s.cl(0,0,.3,1)},Du=s.e({deceleration:2500,maxSpeed:1400},ku),gv=s.e({deceleration:20,maxSpeed:1400},ku),Cd=s.e({deceleration:1e3,maxSpeed:360},ku),vv=s.e({deceleration:1e3,maxSpeed:90},ku),$x=s.e({deceleration:1e3,maxSpeed:360},ku);class Vx{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:C.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=C.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)u.zoom+=w.zoomDelta||0,u.bearing+=w.bearingDelta||0,u.pitch+=w.pitchDelta||0,u.roll+=w.rollDelta||0,w.panDelta&&u.pan._add(w.panDelta),w.around&&(u.around=w.around),w.pinchAround&&(u.pinchAround=w.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(u.pan.mag()){const w=Ou(u.pan.mag(),m,s.e({},Du,o||{})),P=u.pan.mult(w.amount/u.pan.mag()),k=this._map.cameraHelper.handlePanInertia(P,this._map.transform);v.center=k.easingCenter,v.offset=k.easingOffset,zu(v,w)}if(u.zoom){const w=Ou(u.zoom,m,gv);v.zoom=this._map.transform.zoom+w.amount,zu(v,w)}if(u.bearing){const w=Ou(u.bearing,m,Cd);v.bearing=this._map.transform.bearing+s.ag(w.amount,-179,179),zu(v,w)}if(u.pitch){const w=Ou(u.pitch,m,vv);v.pitch=this._map.transform.pitch+w.amount,zu(v,w)}if(u.roll){const w=Ou(u.roll,m,$x);v.roll=this._map.transform.roll+s.ag(w.amount,-179,179),zu(v,w)}if(v.zoom||v.bearing){const w=u.pinchAround===void 0?u.around:u.pinchAround;v.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),s.e(v,{noMoveStart:!0})}}function zu(b,o){(!b.duration||b.duration<o.duration)&&(b.duration=o.duration,b.easing=o.easing)}function Ou(b,o,u){const{maxSpeed:m,linearity:v,deceleration:w}=u,P=s.ag(b*v/(o/1e3),-m,m),k=Math.abs(P)/(w*v);return{easing:u.easing,duration:1e3*k,amount:P*(k/2)}}class Yo extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,m,v={}){m=m instanceof MouseEvent?m:new MouseEvent(o,m);const w=E.mousePos(u.getCanvas(),m),P=u.unproject(w);super(o,s.e({point:w,lngLat:P,originalEvent:m},v)),this._defaultPrevented=!1,this.target=u}}class Ks extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,m){const v=o==="touchend"?m.changedTouches:m.touches,w=E.touchPos(u.getCanvasContainer(),v),P=w.map(F=>u.unproject(F)),k=w.reduce((F,j,W,J)=>F.add(j.div(J.length)),new s.P(0,0));super(o,{points:w,point:k,lngLats:P,lngLat:u.unproject(k),originalEvent:m}),this._defaultPrevented=!1}}class yv extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,m){super(o,{originalEvent:m}),this._defaultPrevented=!1}}class jx{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new yv(o.type,this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new Yo(o.type,this._map,o))}mouseup(o){this._map.fire(new Yo(o.type,this._map,o))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Yo(o.type,this._map,o))}dblclick(o){return this._firePreventable(new Yo(o.type,this._map,o))}mouseover(o){this._map.fire(new Yo(o.type,this._map,o))}mouseout(o){this._map.fire(new Yo(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Ks(o.type,this._map,o))}touchmove(o){this._map.fire(new Ks(o.type,this._map,o))}touchend(o){this._map.fire(new Ks(o.type,this._map,o))}touchcancel(o){this._map.fire(new Ks(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hx{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new Yo(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Yo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new Yo(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fu{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.screenPointToLocation(s.P.convert(o),this._map.terrain)}}class _v{constructor(o,u){this._map=o,this._tr=new Fu(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&o.button===0&&(E.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const m=u;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=m,this._box||(this._box=E.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const w=Math.min(v.x,m.x),P=Math.max(v.x,m.x),k=Math.min(v.y,m.y),F=Math.max(v.y,m.y);E.setTransform(this._box,`translate(${w}px,${k}px)`),this._box.style.width=P-w+"px",this._box.style.height=F-k+"px"}mouseupWindow(o,u){if(!this._active||o.button!==0)return;const m=this._startPos,v=u;if(this.reset(),E.suppressClick(),m.x!==v.x||m.y!==v.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:o})),{cameraAnimation:w=>w.fitScreenCoordinates(m,v,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(E.remove(this._box),this._box=null),E.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new s.l(o,{originalEvent:u}))}}function fp(b,o){if(b.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${o.length}`);const u={};for(let m=0;m<b.length;m++)u[b[m].identifier]=o[m];return u}class Gx{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),m.length===this.numTouches&&(this.centroid=function(v){const w=new s.P(0,0);for(const P of v)w._add(P);return w.div(v.length)}(u),this.touches=fp(m,u)))}touchmove(o,u,m){if(this.aborted||!this.centroid)return;const v=fp(m,u);for(const w in this.touches){const P=v[w];(!P||P.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(o,u,m){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class pp{constructor(o){this.singleTap=new Gx(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,u,m){this.singleTap.touchstart(o,u,m)}touchmove(o,u,m){this.singleTap.touchmove(o,u,m)}touchend(o,u,m){const v=this.singleTap.touchend(o,u,m);if(v){const w=o.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(v)<30;if(w&&P||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class mp{constructor(o){this._tr=new Fu(o),this._zoomIn=new pp({numTouches:1,numTaps:2}),this._zoomOut=new pp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,m){this._zoomIn.touchstart(o,u,m),this._zoomOut.touchstart(o,u,m)}touchmove(o,u,m){this._zoomIn.touchmove(o,u,m),this._zoomOut.touchmove(o,u,m)}touchend(o,u,m){const v=this._zoomIn.touchend(o,u,m),w=this._zoomOut.touchend(o,u,m),P=this._tr;return v?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:P.zoom+1,around:P.unproject(v)},{originalEvent:o})}):w?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:P.zoom-1,around:P.unproject(w)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Nu{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const u=this._moveFunction(...o);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(o,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,u){if(!this.isEnabled())return;const m=this._lastPoint;if(!m)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const v=Array.isArray(u)?u[0]:u;return!this._moved&&v.dist(m)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=v,this._move(m,v))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&E.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ps=0,Js=2,Wx={[Ps]:1,[Js]:2};class Lo{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const u=E.mouseButton(o);this._eventButton=u}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(u,m){const v=Wx[m];return u.buttons===void 0||(u.buttons&v)!==v}(o,this._eventButton)}isValidEndEvent(o){return E.mouseButton(o)===this._eventButton}}class Bu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}class FC{constructor(o=new Lo({checkCorrectEvent:()=>!0}),u=new Bu){this.mouseMoveStateManager=o,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(o,u,m){return o instanceof MouseEvent?u(o):typeof TouchEvent<"u"&&o instanceof TouchEvent?m(o):void 0}startMove(o){this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.startMove(u),u=>this.oneFingerTouchMoveStateManager.startMove(u))}endMove(o){this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.endMove(u),u=>this.oneFingerTouchMoveStateManager.endMove(u))}isValidStartEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidStartEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u))}isValidMoveEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidMoveEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u))}isValidEndEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidEndEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u))}}const gp=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=o=>{o.preventDefault()}};class NC{constructor(o,u){this._clickTolerance=o.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,u,m){return this._calculateTransform(o,u,m)}touchmove(o,u,m){if(this._active){if(!this._shouldBePrevented(m.length))return o.preventDefault(),this._calculateTransform(o,u,m);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,u,m){this._calculateTransform(o,u,m),this._active&&this._shouldBePrevented(m.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,m){m.length>0&&(this._active=!0);const v=fp(m,u),w=new s.P(0,0),P=new s.P(0,0);let k=0;for(const j in v){const W=v[j],J=this._touches[j];J&&(w._add(W),P._add(W.sub(J)),k++,v[j]=W)}if(this._touches=v,this._shouldBePrevented(k)||!P.mag())return;const F=P.div(k);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(k),panDelta:F}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xv{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,m){if(!this._firstTwoTouches)return;o.preventDefault();const[v,w]=this._firstTwoTouches,P=Ed(m,u,v),k=Ed(m,u,w);if(!P||!k)return;const F=this._aroundCenter?null:P.add(k).div(2);return this._move([P,k],F,o)}touchend(o,u,m){if(!this._firstTwoTouches)return;const[v,w]=this._firstTwoTouches,P=Ed(m,u,v),k=Ed(m,u,w);P&&k||(this._active&&E.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Ed(b,o,u){for(let m=0;m<b.length;m++)if(b[m].identifier===u)return o[m]}function Uu(b,o){return Math.log(b/o)/Math.LN2}class Ra extends xv{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Uu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Uu(this._distance,m),pinchAround:u}}}function xn(b,o){return 180*b.angleWith(o)/Math.PI}class bv extends xv{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u,m){const v=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xn(this._vector,v),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,m=xn(o,this._startVector);return Math.abs(m)<u}}function Td(b){return Math.abs(b.y)>Math.abs(b.x)}class wv extends xv{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,u,m){super.touchstart(o,u,m),this._currentTouchCount=m.length}_start(o){this._lastPoints=o,Td(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,m){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const v=o[0].sub(this._lastPoints[0]),w=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,w,m.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(v.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(o,u,m){if(this._valid!==void 0)return this._valid;const v=o.mag()>=2,w=u.mag()>=2;if(!v&&!w)return;if(!v||!w)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;const P=o.y>0==u.y>0;return Td(o)&&Td(u)&&P}}const Pd={panStep:100,bearingStep:15,pitchStep:10};class $u{constructor(o){this._tr=new Fu(o);const u=Pd;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,m=0,v=0,w=0,P=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?m=-1:(o.preventDefault(),w=-1);break;case 39:o.shiftKey?m=1:(o.preventDefault(),w=1);break;case 38:o.shiftKey?v=1:(o.preventDefault(),P=-1);break;case 40:o.shiftKey?v=-1:(o.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(m=0,v=0),{cameraAnimation:k=>{const F=this._tr;k.easeTo({duration:300,easeId:"keyboardHandler",easing:Sv,zoom:u?Math.round(F.zoom)+u*(o.shiftKey?2:1):F.zoom,bearing:F.bearing+m*this._bearingStep,pitch:F.pitch+v*this._pitchStep,offset:[-w*this._panStep,-P*this._panStep],center:F.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Sv(b){return b*(2-b)}const tr=4.000244140625,Mv=1/450;class qx{constructor(o,u){this._onTimeout=m=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(m)},this._map=o,this._tr=new Fu(o),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Mv}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let u=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const m=C.now(),v=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,u!==0&&u%tr==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(v*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=E.mousePos(this._map.getCanvas(),o),m=this._tr;this._aroundPoint=this._aroundCenter?m.transform.locationToScreenPoint(s.S.convert(m.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const k=o.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=k),typeof this._targetZoom=="number"&&(this._targetZoom+=k)}if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>tr?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&F!==0&&(F=1/F);const j=typeof this._targetZoom!="number"?o.scale:s.ae(this._targetZoom);this._targetZoom=o.getConstrained(o.getCameraLngLat(),s.aj(j*F)).zoom,this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?o.zoom:this._targetZoom,m=this._startZoom,v=this._easing;let w,P=!1;if(this._type==="wheel"&&m&&v){const k=C.now()-this._lastWheelEventTime,F=Math.min((k+5)/200,1),j=v(F);w=s.C.number(m,u,j),F<1?this._frameId||(this._frameId=!0):P=!0}else w=u,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!P,zoomDelta:w-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=s.cn;if(this._prevEase){const m=this._prevEase,v=(C.now()-m.start)/m.duration,w=m.easing(v+.01)-m.easing(v),P=.27/Math.sqrt(w*w+1e-4)*.01,k=Math.sqrt(.0729-P*P);u=s.cl(P,k,.25,1)}return this._prevEase={start:C.now(),duration:o,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class vp{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class BC{constructor(o){this._tr=new Fu(o),this.reset()}reset(){this._active=!1}dblclick(o,u){return o.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class UC{constructor(){this._tap=new pp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,u,m){if(!this._swipePoint)if(this._tapTime){const v=u[0],w=o.timeStamp-this._tapTime<500,P=this._tapPoint.dist(v)<30;w&&P?m.length>0&&(this._swipePoint=v,this._swipeTouch=m[0].identifier):this.reset()}else this._tap.touchstart(o,u,m)}touchmove(o,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const v=u[0],w=v.y-this._swipePoint.y;return this._swipePoint=v,o.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(o,u,m)}touchend(o,u,m){if(this._tapTime)this._swipePoint&&m.length===0&&this.reset();else{const v=this._tap.touchend(o,u,m);v&&(this._tapTime=o.timeStamp,this._tapPoint=v)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cv{constructor(o,u,m){this._el=o,this._mousePan=u,this._touchPan=m}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yp{constructor(o,u,m,v){this._pitchWithRotate=o.pitchWithRotate,this._rollEnabled=o.rollEnabled,this._mouseRotate=u,this._mousePitch=m,this._mouseRoll=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Ev{constructor(o,u,m,v){this._el=o,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Xx{constructor(o,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=o,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=E.create("div","maplibregl-cooperative-gesture-screen",o);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const m=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),v=document.createElement("div");v.className="maplibregl-desktop-message",v.textContent=u,this._container.appendChild(v);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=m,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(E.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,u){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:o,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ad=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class $C extends s.l{}function Tv(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class Bl{constructor(o,u){this.handleWindowEvent=v=>{this.handleEvent(v,`${v.type}Window`)},this.handleEvent=(v,w)=>{if(v.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const P=v.type==="renderFrame"?void 0:v,k={needsRenderFrame:!1},F={},j={};for(const{handlerName:Y,handler:oe,allowed:he}of this._handlers){if(!oe.isEnabled())continue;let Pe;if(this._blockedByActive(j,he,Y))oe.reset();else if(oe[w||v.type]){if(s.co(v,w||v.type)){const Ee=E.mousePos(this._map.getCanvas(),v);Pe=oe[w||v.type](v,Ee)}else if(s.cp(v,w||v.type)){const Ee=this._getMapTouches(v.touches),Ae=E.touchPos(this._map.getCanvas(),Ee);Pe=oe[w||v.type](v,Ae,Ee)}else s.cq(w||v.type)||(Pe=oe[w||v.type](v));this.mergeHandlerResult(k,F,Pe,Y,P),Pe&&Pe.needsRenderFrame&&this._triggerRenderFrame()}(Pe||oe.isActive())&&(j[Y]=oe)}const W={};for(const Y in this._previousActiveHandlers)j[Y]||(W[Y]=P);this._previousActiveHandlers=j,(Object.keys(W).length||Tv(k))&&(this._changes.push([k,F,W]),this._triggerRenderFrame()),(Object.keys(j).length||Tv(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=k;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Vx(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,w,P]of this._listeners)E.addEventListener(v,w,v===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[o,u,m]of this._listeners)E.removeEventListener(o,u,o===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(o){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new jx(u,o));const v=u.boxZoom=new _v(u,o);this._add("boxZoom",v),o.interactive&&o.boxZoom&&v.enable();const w=u.cooperativeGestures=new Xx(u,o.cooperativeGestures);this._add("cooperativeGestures",w),o.cooperativeGestures&&w.enable();const P=new mp(u),k=new BC(u);u.doubleClickZoom=new vp(k,P),this._add("tapZoom",P),this._add("clickZoom",k),o.interactive&&o.doubleClickZoom&&u.doubleClickZoom.enable();const F=new UC;this._add("tapDragZoom",F);const j=u.touchPitch=new wv(u);this._add("touchPitch",j),o.interactive&&o.touchPitch&&u.touchPitch.enable(o.touchPitch);const W=()=>u.project(u.getCenter()),J=function({enable:Ne,clickTolerance:Ye,aroundCenter:Ke=!0,minPixelCenterThreshold:Ue=100,rotateDegreesPerPixelMoved:rt=.8},yt){const ht=new Lo({checkCorrectEvent:pt=>E.mouseButton(pt)===0&&pt.ctrlKey||E.mouseButton(pt)===2&&!pt.ctrlKey});return new Nu({clickTolerance:Ye,move:(pt,_t)=>{const sn=yt();if(Ke&&Math.abs(sn.y-pt.y)>Ue)return{bearingDelta:s.cm(new s.P(pt.x,_t.y),_t,sn)};let rn=(_t.x-pt.x)*rt;return Ke&&_t.y<sn.y&&(rn=-rn),{bearingDelta:rn}},moveStateManager:ht,enable:Ne,assignEvents:gp})}(o,W),Y=function({enable:Ne,clickTolerance:Ye,pitchDegreesPerPixelMoved:Ke=-.5}){const Ue=new Lo({checkCorrectEvent:rt=>E.mouseButton(rt)===0&&rt.ctrlKey||E.mouseButton(rt)===2});return new Nu({clickTolerance:Ye,move:(rt,yt)=>({pitchDelta:(yt.y-rt.y)*Ke}),moveStateManager:Ue,enable:Ne,assignEvents:gp})}(o),oe=function({enable:Ne,clickTolerance:Ye,rollDegreesPerPixelMoved:Ke=.3},Ue){const rt=new Lo({checkCorrectEvent:yt=>E.mouseButton(yt)===2&&yt.ctrlKey});return new Nu({clickTolerance:Ye,move:(yt,ht)=>{const pt=Ue();let _t=(ht.x-yt.x)*Ke;return ht.y<pt.y&&(_t=-_t),{rollDelta:_t}},moveStateManager:rt,enable:Ne,assignEvents:gp})}(o,W);u.dragRotate=new yp(o,J,Y,oe),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate","mouseRoll"]),this._add("mouseRoll",oe,["mousePitch"]),o.interactive&&o.dragRotate&&u.dragRotate.enable();const he=function({enable:Ne,clickTolerance:Ye}){const Ke=new Lo({checkCorrectEvent:Ue=>E.mouseButton(Ue)===0&&!Ue.ctrlKey});return new Nu({clickTolerance:Ye,move:(Ue,rt)=>({around:rt,panDelta:rt.sub(Ue)}),activateOnStart:!0,moveStateManager:Ke,enable:Ne,assignEvents:gp})}(o),Pe=new NC(o,u);u.dragPan=new Cv(m,he,Pe),this._add("mousePan",he),this._add("touchPan",Pe,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&u.dragPan.enable(o.dragPan);const Ee=new bv,Ae=new Ra;u.touchZoomRotate=new Ev(m,Ae,Ee,F),this._add("touchRotate",Ee,["touchPan","touchZoom"]),this._add("touchZoom",Ae,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&u.touchZoomRotate.enable(o.touchZoomRotate);const Fe=u.scrollZoom=new qx(u,()=>this._triggerRenderFrame());this._add("scrollZoom",Fe,["mousePan"]),o.interactive&&o.scrollZoom&&u.scrollZoom.enable(o.scrollZoom);const He=u.keyboard=new $u(u);this._add("keyboard",He),o.interactive&&o.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new Hx(u))}_add(o,u,m){this._handlers.push({handlerName:o,handler:u,allowed:m}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ad(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,u,m){for(const v in o)if(v!==m&&(!u||u.indexOf(v)<0))return!0;return!1}_getMapTouches(o){const u=[];for(const m of o)this._el.contains(m.target)&&u.push(m);return u}mergeHandlerResult(o,u,m,v,w){if(!m)return;s.e(o,m);const P={handlerName:v,originalEvent:m.originalEvent||w};m.zoomDelta!==void 0&&(u.zoom=P),m.panDelta!==void 0&&(u.drag=P),m.rollDelta!==void 0&&(u.roll=P),m.pitchDelta!==void 0&&(u.pitch=P),m.bearingDelta!==void 0&&(u.rotate=P)}_applyChanges(){const o={},u={},m={};for(const[v,w,P]of this._changes)v.panDelta&&(o.panDelta=(o.panDelta||new s.P(0,0))._add(v.panDelta)),v.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+v.pitchDelta),v.rollDelta&&(o.rollDelta=(o.rollDelta||0)+v.rollDelta),v.around!==void 0&&(o.around=v.around),v.pinchAround!==void 0&&(o.pinchAround=v.pinchAround),v.noInertia&&(o.noInertia=v.noInertia),s.e(u,w),s.e(m,P);this._updateMapTransform(o,u,m),this._changes=[]}_updateMapTransform(o,u,m){const v=this._map,w=v._getTransformForUpdate(),P=v.terrain;if(!(Tv(o)||P&&this._terrainMovement))return this._fireEvents(u,m,!0);v._stop(!0);let{panDelta:k,zoomDelta:F,bearingDelta:j,pitchDelta:W,rollDelta:J,around:Y,pinchAround:oe}=o;oe!==void 0&&(Y=oe),Y=Y||v.transform.centerPoint,P&&!w.isPointOnMapSurface(Y)&&(Y=w.centerPoint);const he={panDelta:k,zoomDelta:F,rollDelta:J,pitchDelta:W,bearingDelta:j,around:Y};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(Y)&&(Y=w.centerPoint);const Pe=Y.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(k?Y.sub(k):Y);P?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(he,w),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?w.setCenter(w.screenPointToLocation(w.centerPoint.sub(k))):this._map.cameraHelper.handleMapControlsPan(he,w,Pe):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(he,w,Pe))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(he,w),this._map.cameraHelper.handleMapControlsPan(he,w,Pe)),v._applyUpdatedTransform(w),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,m,!0)}_fireEvents(o,u,m){const v=Ad(this._eventsInProgress),w=Ad(o),P={};for(const J in o){const{originalEvent:Y}=o[J];this._eventsInProgress[J]||(P[`${J}start`]=Y),this._eventsInProgress[J]=o[J]}!v&&w&&this._fireEvent("movestart",w.originalEvent);for(const J in P)this._fireEvent(J,P[J]);w&&this._fireEvent("move",w.originalEvent);for(const J in o){const{originalEvent:Y}=o[J];this._fireEvent(J,Y)}const k={};let F;for(const J in this._eventsInProgress){const{handlerName:Y,originalEvent:oe}=this._eventsInProgress[J];this._handlersById[Y].isActive()||(delete this._eventsInProgress[J],F=u[Y]||oe,k[`${J}end`]=F)}for(const J in k)this._fireEvent(J,k[J]);const j=Ad(this._eventsInProgress),W=(v||w)&&!j;if(W&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const J=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&J.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(J)}if(m&&W){this._updatingCamera=!0;const J=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=oe=>oe!==0&&-this._bearingSnap<oe&&oe<this._bearingSnap;!J||!J.essential&&C.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:F})),Y(this._map.getBearing())&&this._map.resetNorth()):(Y(J.bearing||this._map.getBearing())&&(J.bearing=0),J.freezeElevation=!0,this._map.easeTo(J,{originalEvent:F})),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new s.l(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new $C("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Xr extends s.E{constructor(o,u,m){super(),this._renderFrameCallback=()=>{const v=Math.min((C.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=m.bearingSnap,this.cameraHelper=u,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(o,u){o.apply(this.transform),this.transform=o,this.cameraHelper=u}getCenter(){return new s.S(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(o,u){return this.jumpTo({elevation:o},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(o){this._centerClampedToGround=o}panBy(o,u,m){return o=s.P.convert(o).mult(-1),this.panTo(this.transform.center,s.e({offset:o},u),m)}panTo(o,u,m){return this.easeTo(s.e({center:o},u),m)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,m){return this.easeTo(s.e({zoom:o},u),m)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(o,u){return o!=this.transform.fov&&(this.transform.setFov(o),this.fire(new s.l("movestart",u)).fire(new s.l("move",u)).fire(new s.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,m){return this.easeTo(s.e({bearing:o},u),m)}resetNorth(o,u){return this.rotateTo(0,s.e({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}getRoll(){return this.transform.roll}setRoll(o,u){return this.jumpTo({roll:o},u),this}cameraForBounds(o,u){o=hn.convert(o).adjustAntiMeridian();const m=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),m,u)}_cameraForBoxAndBearing(o,u,m,v){const w={top:0,bottom:0,right:0,left:0};if(typeof(v=s.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const j=v.padding;v.padding={top:j,bottom:j,right:j,left:j}}const P=s.e(w,v.padding);v.padding=P;const k=this.transform,F=new hn(o,u);return this.cameraHelper.cameraForBoxAndBearing(v,P,F,m,k)}fitBounds(o,u,m){return this._fitInternal(this.cameraForBounds(o,u),u,m)}fitScreenCoordinates(o,u,m,v,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(o)),this.transform.screenPointToLocation(s.P.convert(u)),m,v),v,w)}_fitInternal(o,u,m){return o?(delete(u=s.e(o,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(o,u){this.stop();const m=this._getTransformForUpdate();let v=!1,w=!1,P=!1;const k=m.zoom;this.cameraHelper.handleJumpToCenterZoom(m,o);const F=m.zoom!==k;return"elevation"in o&&m.elevation!==+o.elevation&&m.setElevation(+o.elevation),"bearing"in o&&m.bearing!==+o.bearing&&(v=!0,m.setBearing(+o.bearing)),"pitch"in o&&m.pitch!==+o.pitch&&(w=!0,m.setPitch(+o.pitch)),"roll"in o&&m.roll!==+o.roll&&(P=!0,m.setRoll(+o.roll)),o.padding==null||m.isPaddingEqual(o.padding)||m.setPadding(o.padding),this._applyUpdatedTransform(m),this.fire(new s.l("movestart",u)).fire(new s.l("move",u)),F&&this.fire(new s.l("zoomstart",u)).fire(new s.l("zoom",u)).fire(new s.l("zoomend",u)),v&&this.fire(new s.l("rotatestart",u)).fire(new s.l("rotate",u)).fire(new s.l("rotateend",u)),w&&this.fire(new s.l("pitchstart",u)).fire(new s.l("pitch",u)).fire(new s.l("pitchend",u)),P&&this.fire(new s.l("rollstart",u)).fire(new s.l("roll",u)).fire(new s.l("rollend",u)),this.fire(new s.l("moveend",u))}calculateCameraOptionsFromTo(o,u,m,v=0){const w=s.a0.fromLngLat(o,u),P=s.a0.fromLngLat(m,v),k=P.x-w.x,F=P.y-w.y,j=P.z-w.z,W=Math.hypot(k,F,j);if(W===0)throw new Error("Can't calculate camera options with same From and To");const J=Math.hypot(k,F),Y=s.aj(this.transform.cameraToCenterDistance/W/this.transform.tileSize),oe=180*Math.atan2(k,-F)/Math.PI;let he=180*Math.acos(J/W)/Math.PI;return he=j<0?90-he:90+he,{center:P.toLngLat(),elevation:v,zoom:Y,pitch:he,bearing:oe}}calculateCameraOptionsFromCameraLngLatAltRotation(o,u,m,v,w){const P=this.transform.calculateCenterFromCameraLngLatAlt(o,u,m,v);return{center:P.center,elevation:P.elevation,zoom:P.zoom,bearing:m,pitch:v,roll:w}}easeTo(o,u){this._stop(!1,o.easeId),((o=s.e({offset:[0,0],duration:500,easing:s.cn},o)).animate===!1||!o.essential&&C.prefersReducedMotion)&&(o.duration=0);const m=this._getTransformForUpdate(),v=this.getBearing(),w=m.pitch,P=m.roll,k="bearing"in o?this._normalizeBearing(o.bearing,v):v,F="pitch"in o?+o.pitch:w,j="roll"in o?this._normalizeBearing(o.roll,P):P,W="padding"in o?o.padding:m.padding,J=s.P.convert(o.offset);let Y,oe;o.around&&(Y=s.S.convert(o.around),oe=m.locationToScreenPoint(Y));const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Pe=this.cameraHelper.handleEaseTo(m,{bearing:k,pitch:F,roll:j,padding:W,around:Y,aroundPoint:oe,offsetAsPoint:J,offset:o.offset,zoom:o.zoom,center:o.center});return this._rotating=this._rotating||v!==k,this._pitching=this._pitching||F!==w,this._rolling=this._rolling||j!==P,this._padding=!m.isPaddingEqual(W),this._zooming=this._zooming||Pe.isZooming,this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,he),this.terrain&&this._prepareElevation(Pe.elevationCenter),this._ease(Ee=>{Pe.easeFunc(Ee),this.terrain&&!o.freezeElevation&&this._updateElevation(Ee),this._applyUpdatedTransform(m),this._fireMoveEvents(u)},Ee=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(u,Ee)},o),this}_prepareEase(o,u,m={}){this._moving=!0,u||m.moving||this.fire(new s.l("movestart",o)),this._zooming&&!m.zooming&&this.fire(new s.l("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new s.l("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new s.l("pitchstart",o)),this._rolling&&!m.rolling&&this.fire(new s.l("rollstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&u!==this._elevationTarget){const m=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(m-(u-(m*o+this._elevationStart))/(1-o)),this._elevationTarget=u}this.transform.setElevation(s.C.number(this._elevationStart,this._elevationTarget,o))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){if(!this.terrain&&o.elevation>=0&&o.pitch<=90)return{};const u=o.getCameraLngLat(),m=o.getCameraAltitude(),v=this.terrain?this.terrain.getElevationForLngLatZoom(u,o.zoom):0;if(m<v){const w=this.calculateCameraOptionsFromTo(u,v,o.center,o.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(o){const u=[];if(u.push(v=>this._elevateCameraIfInsideTerrain(v)),this.transformCameraUpdate&&u.push(v=>this.transformCameraUpdate(v)),!u.length)return;const m=o.clone();for(const v of u){const w=m.clone(),{center:P,zoom:k,roll:F,pitch:j,bearing:W,elevation:J}=v(w);P&&w.setCenter(P),J!==void 0&&w.setElevation(J),k!==void 0&&w.setZoom(k),F!==void 0&&w.setRoll(F),j!==void 0&&w.setPitch(j),W!==void 0&&w.setBearing(W),m.apply(w)}this.transform.apply(m)}_fireMoveEvents(o){this.fire(new s.l("move",o)),this._zooming&&this.fire(new s.l("zoom",o)),this._rotating&&this.fire(new s.l("rotate",o)),this._pitching&&this.fire(new s.l("pitch",o)),this._rolling&&this.fire(new s.l("roll",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const m=this._zooming,v=this._rotating,w=this._pitching,P=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,m&&this.fire(new s.l("zoomend",o)),v&&this.fire(new s.l("rotateend",o)),w&&this.fire(new s.l("pitchend",o)),P&&this.fire(new s.l("rollend",o)),this.fire(new s.l("moveend",o))}flyTo(o,u){if(!o.essential&&C.prefersReducedMotion){const _t=s.Q(o,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(_t,u)}this.stop(),o=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cn},o);const m=this._getTransformForUpdate(),v=m.bearing,w=m.pitch,P=m.roll,k=m.padding,F="bearing"in o?this._normalizeBearing(o.bearing,v):v,j="pitch"in o?+o.pitch:w,W="roll"in o?this._normalizeBearing(o.roll,P):P,J="padding"in o?o.padding:m.padding,Y=s.P.convert(o.offset);let oe=m.centerPoint.add(Y);const he=m.screenPointToLocation(oe),Pe=this.cameraHelper.handleFlyTo(m,{bearing:F,pitch:j,roll:W,padding:J,locationAtOffset:he,offsetAsPoint:Y,center:o.center,minZoom:o.minZoom,zoom:o.zoom});let Ee=o.curve;const Ae=Math.max(m.width,m.height),Fe=Ae/Pe.scaleOfZoom,He=Pe.pixelPathLength;typeof Pe.scaleOfMinZoom=="number"&&(Ee=Math.sqrt(Ae/Pe.scaleOfMinZoom/He*2));const Ne=Ee*Ee;function Ye(_t){const sn=(Fe*Fe-Ae*Ae+(_t?-1:1)*Ne*Ne*He*He)/(2*(_t?Fe:Ae)*Ne*He);return Math.log(Math.sqrt(sn*sn+1)-sn)}function Ke(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function Ue(_t){return(Math.exp(_t)+Math.exp(-_t))/2}const rt=Ye(!1);let yt=function(_t){return Ue(rt)/Ue(rt+Ee*_t)},ht=function(_t){return Ae*((Ue(rt)*(Ke(sn=rt+Ee*_t)/Ue(sn))-Ke(rt))/Ne)/He;var sn},pt=(Ye(!0)-rt)/Ee;if(Math.abs(He)<2e-6||!isFinite(pt)){if(Math.abs(Ae-Fe)<1e-6)return this.easeTo(o,u);const _t=Fe<Ae?-1:1;pt=Math.abs(Math.log(Fe/Ae))/Ee,ht=()=>0,yt=sn=>Math.exp(_t*Ee*sn)}return o.duration="duration"in o?+o.duration:1e3*pt/("screenSpeed"in o?+o.screenSpeed/Ee:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=v!==F,this._pitching=j!==w,this._rolling=W!==P,this._padding=!m.isPaddingEqual(J),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(Pe.targetCenter),this._ease(_t=>{const sn=_t*pt,rn=1/yt(sn),Vt=ht(sn);this._rotating&&m.setBearing(s.C.number(v,F,_t)),this._pitching&&m.setPitch(s.C.number(w,j,_t)),this._rolling&&m.setRoll(s.C.number(P,W,_t)),this._padding&&(m.interpolatePadding(k,J,_t),oe=m.centerPoint.add(Y)),Pe.easeFunc(_t,rn,Vt,oe),this.terrain&&!o.freezeElevation&&this._updateElevation(_t),this._applyUpdatedTransform(m),this._fireMoveEvents(u)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,u){var m;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,u)}return o||(m=this.handlers)===null||m===void 0||m.stop(!1),this}_ease(o,u,m){m.animate===!1||m.duration===0?(o(1),u()):(this._easeStart=C.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,u){o=s.aN(o,-180,180);const m=Math.abs(o-u);return Math.abs(o-360-u)<m&&(o-=360),Math.abs(o+360-u)<m&&(o+=360),o}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(s.S.convert(o),this.transform.tileZoom):null}}const Id={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class _p{constructor(o=Id){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=E.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=E.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){E.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,u){const m=this._map._getUIString(`AttributionControl.${u}`);o.title=m,o.setAttribute("aria-label",m)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const u=this._map.style.sourceCaches;for(const v in u){const w=u[v];if(w.used||w.usedForTerrain){const P=w.getSource();P.attribution&&o.indexOf(P.attribution)<0&&o.push(P.attribution)}}o=o.filter(v=>String(v).trim()),o.sort((v,w)=>v.length-w.length),o=o.filter((v,w)=>{for(let P=w+1;P<o.length;P++)if(o[P].indexOf(v)>=0)return!1;return!0});const m=o.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,o.length?(this._innerContainer.innerHTML=E.sanitize(m),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Pv{constructor(o={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const m=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&m.classList.add("maplibregl-compact"):m.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=E.create("div","maplibregl-ctrl");const u=E.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){E.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Zx{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const v of m)if(v.id===o)return void(v.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Yx=s.aI([{name:"a_pos3d",type:"Int16",components:3}]);class VC extends s.E{constructor(o){super(),this._lastTilesetChange=C.now(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=o._source.tileSize*2**this.deltaZoom,o.usedForTerrain=!0,o.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,u){this.sourceCache.update(o,u),this._renderableTilesKeys=[];const m={};for(const v of De(o,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))m[v.key]=!0,this._renderableTilesKeys.push(v.key),this._tiles[v.key]||(v.terrainRttPosMatrix32f=new Float64Array(16),s.bX(v.terrainRttPosMatrix32f,0,s.$,s.$,0,0,1),this._tiles[v.key]=new Lt(v,this.tileSize),this._lastTilesetChange=C.now());for(const v in this._tiles)m[v]||delete this._tiles[v]}freeRtt(o){for(const u in this._tiles){const m=this._tiles[u];(!o||m.tileID.equals(o)||m.tileID.isChildOf(o)||o.isChildOf(m.tileID))&&(m.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o,u){return u?this._getTerrainCoordsForTileRanges(o,u):this._getTerrainCoordsForRegularTile(o)}_getTerrainCoordsForRegularTile(o){const u={};for(const m of this._renderableTilesKeys){const v=this._tiles[m].tileID,w=o.clone(),P=s.b9();if(v.canonical.equals(o.canonical))s.bX(P,0,s.$,s.$,0,0,1);else if(v.canonical.isChildOf(o.canonical)){const k=v.canonical.z-o.canonical.z,F=v.canonical.x-(v.canonical.x>>k<<k),j=v.canonical.y-(v.canonical.y>>k<<k),W=s.$>>k;s.bX(P,0,W,W,0,0,1),s.M(P,P,[-F*W,-j*W,0])}else{if(!o.canonical.isChildOf(v.canonical))continue;{const k=o.canonical.z-v.canonical.z,F=o.canonical.x-(o.canonical.x>>k<<k),j=o.canonical.y-(o.canonical.y>>k<<k),W=s.$>>k;s.bX(P,0,s.$,s.$,0,0,1),s.M(P,P,[F*W,j*W,0]),s.N(P,P,[1/2**k,1/2**k,0])}}w.terrainRttPosMatrix32f=new Float32Array(P),u[m]=w}return u}_getTerrainCoordsForTileRanges(o,u){const m={};for(const v of this._renderableTilesKeys){const w=this._tiles[v].tileID;if(!this._isWithinTileRanges(w,u))continue;const P=o.clone(),k=s.b9();if(w.canonical.z===o.canonical.z){const F=o.canonical.x-w.canonical.x,j=o.canonical.y-w.canonical.y;s.bX(k,0,s.$,s.$,0,0,1),s.M(k,k,[F*s.$,j*s.$,0])}else if(w.canonical.z>o.canonical.z){const F=w.canonical.z-o.canonical.z,j=w.canonical.x-(w.canonical.x>>F<<F),W=w.canonical.y-(w.canonical.y>>F<<F),J=o.canonical.x-(w.canonical.x>>F),Y=o.canonical.y-(w.canonical.y>>F),oe=s.$>>F;s.bX(k,0,oe,oe,0,0,1),s.M(k,k,[-j*oe+J*s.$,-W*oe+Y*s.$,0])}else{const F=o.canonical.z-w.canonical.z,j=o.canonical.x-(o.canonical.x>>F<<F),W=o.canonical.y-(o.canonical.y>>F<<F),J=(o.canonical.x>>F)-w.canonical.x,Y=(o.canonical.y>>F)-w.canonical.y,oe=s.$<<F;s.bX(k,0,oe,oe,0,0,1),s.M(k,k,[j*s.$+J*oe,W*s.$+Y*oe,0])}P.terrainRttPosMatrix32f=new Float32Array(k),m[v]=P}return m}getSourceTile(o,u){const m=this.sourceCache._source;let v=o.overscaledZ-this.deltaZoom;if(v>m.maxzoom&&(v=m.maxzoom),v<m.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(v).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!w||!w.dem)&&u)for(;v>=m.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(o.scaledTo(v--).key);return w}anyTilesAfterTime(o=Date.now()){return this._lastTilesetChange>=o}_isWithinTileRanges(o,u){return u[o.canonical.z]&&o.canonical.x>=u[o.canonical.z].minTileX&&o.canonical.x<=u[o.canonical.z].maxTileX&&o.canonical.y>=u[o.canonical.z].minTileY&&o.canonical.y<=u[o.canonical.z].maxTileY}}class La{constructor(o,u,m){this._meshCache={},this.painter=o,this.sourceCache=new VC(u),this.options=m,this.exaggeration=typeof m.exaggeration=="number"?m.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,u,m,v=s.$){var w;if(!(u>=0&&u<v&&m>=0&&m<v))return 0;const P=this.getTerrainData(o),k=(w=P.tile)===null||w===void 0?void 0:w.dem;if(!k)return 0;const F=s.cr([],[u/v*s.$,m/v*s.$],P.u_terrain_matrix),j=[F[0]*k.dim,F[1]*k.dim],W=Math.floor(j[0]),J=Math.floor(j[1]),Y=j[0]-W,oe=j[1]-J;return k.get(W,J)*(1-Y)*(1-oe)+k.get(W+1,J)*Y*(1-oe)+k.get(W,J+1)*(1-Y)*oe+k.get(W+1,J+1)*Y*oe}getElevationForLngLatZoom(o,u){if(!s.cs(u,o.wrap()))return 0;const{tileID:m,mercatorX:v,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(o,u);return this.getElevation(m,v%s.$,w%s.$,s.$)}getElevation(o,u,m,v=s.$){return this.getDEMElevation(o,u,m,v)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const v=this.painter.context,w=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(v,w,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(v,new s.R({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.af([])}const u=this.sourceCache.getSourceTile(o,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const v=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new s.T(v,u.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),u.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const m=u&&u+u.tileID.key+o.key;if(m&&!this._demMatrixCache[m]){const v=this.sourceCache.sourceCache._source.maxzoom;let w=o.canonical.z-u.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=v?w=o.canonical.z-v:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=o.canonical.x-(o.canonical.x>>w<<w),k=o.canonical.y-(o.canonical.y>>w<<w),F=s.ct(new Float64Array(16),[1/(s.$<<w),1/(s.$<<w),0]);s.M(F,F,[P*s.$,k*s.$,0]),this._demMatrixCache[o.key]={matrix:F,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:m?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(o){const u=this.painter,m=u.width/devicePixelRatio,v=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===m&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(u.context,{width:m,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(u.context,{width:m,height:v,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(m,v,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,m,v))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,P=0;w<this._coordsTextureSize;w++)for(let k=0;k<this._coordsTextureSize;k++,P+=4)u[P+0]=255&k,u[P+1]=255&w,u[P+2]=k>>8<<4|w>>8,u[P+3]=0;const m=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),v=new s.T(o,m,o.gl.RGBA,{premultiply:!1});return v.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),m=this.painter.context,v=m.gl,w=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),P=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),k=Math.round(this.painter.height/devicePixelRatio);m.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(w,k-P-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),m.bindFramebuffer.set(null);const F=u[0]+(u[2]>>4<<8),j=u[1]+((15&u[2])<<8),W=this.coordsIndex[255-u[3]],J=W&&this.sourceCache.getTileByID(W);if(!J)return null;const Y=this._coordsTextureSize,oe=(1<<J.tileID.canonical.z)*Y;return new s.a0((J.tileID.canonical.x*Y+F)/oe+J.tileID.wrap,(J.tileID.canonical.y*Y+j)/oe,this.getElevation(J.tileID,F,j,Y))}depthAtPoint(o){const u=new Uint8Array(4),m=this.painter.context,v=m.gl;return m.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),v.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,u),m.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(o){var u;const m=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,v=m&&o.canonical.y===0,w=m&&o.canonical.y===(1<<o.canonical.z)-1,P=`m_${v?"n":""}_${w?"s":""}`;if(this._meshCache[P])return this._meshCache[P];const k=this.painter.context,F=new s.cu,j=new s.aM,W=this.meshSize,J=s.$/W,Y=W*W;for(let Ue=0;Ue<=W;Ue++)for(let rt=0;rt<=W;rt++)F.emplaceBack(rt*J,Ue*J,0);for(let Ue=0;Ue<Y;Ue+=W+1)for(let rt=0;rt<W;rt++)j.emplaceBack(rt+Ue,W+rt+Ue+1,W+rt+Ue+2),j.emplaceBack(rt+Ue,W+rt+Ue+2,rt+Ue+1);const oe=F.length,he=oe+(W+1),Pe=(W+1)*W,Ee=v?s.bg:0,Ae=v?0:1,Fe=w?s.bh:s.$,He=w?0:1;for(let Ue=0;Ue<=W;Ue++)F.emplaceBack(Ue*J,Ee,Ae);for(let Ue=0;Ue<=W;Ue++)F.emplaceBack(Ue*J,Fe,He);for(let Ue=0;Ue<W;Ue++)j.emplaceBack(Pe+Ue,he+Ue,he+Ue+1),j.emplaceBack(Pe+Ue,he+Ue+1,Pe+Ue+1),j.emplaceBack(0+Ue,oe+Ue+1,oe+Ue),j.emplaceBack(0+Ue,0+Ue+1,oe+Ue+1);const Ne=F.length,Ye=Ne+2*(W+1);for(const Ue of[0,1])for(let rt=0;rt<=W;rt++)for(const yt of[0,1])F.emplaceBack(Ue*s.$,rt*J,yt);for(let Ue=0;Ue<2*W;Ue+=2)j.emplaceBack(Ne+Ue,Ne+Ue+1,Ne+Ue+3),j.emplaceBack(Ne+Ue,Ne+Ue+3,Ne+Ue+2),j.emplaceBack(Ye+Ue,Ye+Ue+3,Ye+Ue+1),j.emplaceBack(Ye+Ue,Ye+Ue+2,Ye+Ue+3);const Ke=new rl(k.createVertexBuffer(F,Yx.members),k.createIndexBuffer(j),s.aL.simpleSegment(0,0,F.length,j.length));return this._meshCache[P]=Ke,Ke}getMeshFrameDelta(o){return 2*Math.PI*s.bt/Math.pow(2,Math.max(o,0))/5}getMinTileElevationForLngLatZoom(o,u){var m;const{tileID:v}=this._getOverscaledTileIDFromLngLatZoom(o,u);return(m=this.getMinMaxElevation(v).minElevation)!==null&&m!==void 0?m:0}getMinMaxElevation(o){const u=this.getTerrainData(o).tile,m={minElevation:null,maxElevation:null};return u&&u.dem&&(m.minElevation=u.dem.min*this.exaggeration,m.maxElevation=u.dem.max*this.exaggeration),m}_getOverscaledTileIDFromLngLatZoom(o,u){const m=s.a0.fromLngLat(o.wrap()),v=(1<<u)*s.$,w=m.x*v,P=m.y*v,k=Math.floor(w/s.$),F=Math.floor(P/s.$);return{tileID:new s.Z(u,0,u,k,F),mercatorX:w,mercatorY:P}}}class xp{constructor(o,u,m){this._context=o,this._size=u,this._tileSize=m,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),m=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return m.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(m.texture),{id:o,fbo:u,texture:m,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>o.id!==u),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const En={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Vn{constructor(o,u){this.painter=o,this.terrain=u,this.pool=new xp(o.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(m=>!o._layers[m].isHidden(u)),this._coordsAscending={};for(const m in o.sourceCaches){this._coordsAscending[m]={};const v=o.sourceCaches[m].getVisibleCoordinates(),w=o.sourceCaches[m].getSource(),P=w instanceof An?w.terrainTileRanges:null;for(const k of v){const F=this.terrain.sourceCache.getTerrainCoords(k,P);for(const j in F)this._coordsAscending[m][j]||(this._coordsAscending[m][j]=[]),this._coordsAscending[m][j].push(F[j])}}this._coordsAscendingStr={};for(const m of o._order){const v=o._layers[m],w=v.source;if(En[v.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const P in this._coordsAscending[w])this._coordsAscendingStr[w][P]=this._coordsAscending[w][P].map(k=>k.key).sort().join()}}for(const m of this._renderableTiles)for(const v in this._coordsAscendingStr){const w=this._coordsAscendingStr[v][m.tileID.key];w&&w!==m.rttCoords[v]&&(m.rtt=[])}}renderLayer(o,u){if(o.isHidden(this.painter.transform.zoom))return!1;const m=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),v=o.type,w=this.painter,P=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(En[v]&&(this._prevType&&En[this._prevType]||this._stacks.push([]),this._prevType=v,this._stacks[this._stacks.length-1].push(o.id),!P))return!0;if(En[this._prevType]||En[v]&&P){this._prevType=v;const k=this._stacks.length-1,F=this._stacks[k]||[];for(const j of this._renderableTiles){if(this.pool.isFull()&&(oi(this.painter,this.terrain,this._rttTiles,m),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(j),j.rtt[k]){const J=this.pool.getObjectForId(j.rtt[k].id);if(J.stamp===j.rtt[k].stamp){this.pool.useObject(J);continue}}const W=this.pool.getOrCreateFreeObject();this.pool.useObject(W),this.pool.stampObject(W),j.rtt[k]={id:W.id,stamp:W.stamp},w.context.bindFramebuffer.set(W.fbo.framebuffer),w.context.clear({color:s.be.transparent,stencil:0}),w.currentStencilSource=void 0;for(let J=0;J<F.length;J++){const Y=w.style._layers[F[J]],oe=Y.source?this._coordsAscending[Y.source][j.tileID.key]:[j.tileID];w.context.viewport.set([0,0,W.fbo.width,W.fbo.height]),w._renderTileClippingMasks(Y,oe,!0),w.renderLayer(w,w.style.sourceCaches[Y.source],Y,oe,m),Y.source&&(j.rttCoords[Y.source]=this._coordsAscendingStr[Y.source][j.tileID.key])}}return oi(this.painter,this.terrain,this._rttTiles,m),this._rttTiles=[],this.pool.freeAllObjects(),En[v]}return!1}}const bp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Av=f,Rd={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Id,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ko={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Kx{constructor(o,u,m=!1){this.mousedown=w=>{this.startMove(w,E.mousePos(this.element,w)),E.addEventListener(window,"mousemove",this.mousemove),E.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,E.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHanlder.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=E.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),E.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),E.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=E.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const v=new FC;this._rotatePitchHanlder=new Nu({clickTolerance:3,move:(w,P)=>{const k=u.getBoundingClientRect(),F=new s.P((k.bottom-k.top)/2,(k.right-k.left)/2);return{bearingDelta:s.cm(new s.P(w.x,P.y),P,F),pitchDelta:m?-.5*(P.y-w.y):void 0}},moveStateManager:v,enable:!0,assignEvents:()=>{}}),this.map=o,E.addEventListener(u,"mousedown",this.mousedown),E.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),E.addEventListener(u,"touchcancel",this.reset)}startMove(o,u){this._rotatePitchHanlder.dragStart(o,u),E.disableDrag()}move(o,u){const m=this.map,{bearingDelta:v,pitchDelta:w}=this._rotatePitchHanlder.dragMove(o,u)||{};v&&m.setBearing(m.getBearing()+v),w&&m.setPitch(m.getPitch()+w)}off(){const o=this.element;E.removeEventListener(o,"mousedown",this.mousedown),E.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),E.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),E.removeEventListener(window,"touchend",this.touchend),E.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){E.enableDrag(),E.removeEventListener(window,"mousemove",this.mousemove),E.removeEventListener(window,"mouseup",this.mouseup),E.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),E.removeEventListener(window,"touchend",this.touchend)}}let eo;function Jx(b,o,u,m=!1){if(m||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return b==null?void 0:b.wrap();const v=new s.S(b.lng,b.lat);if(b=new s.S(b.lng,b.lat),o){const w=new s.S(b.lng-360,b.lat),P=new s.S(b.lng+360,b.lat),k=u.locationToScreenPoint(b).distSqr(o);u.locationToScreenPoint(w).distSqr(o)<k?b=w:u.locationToScreenPoint(P).distSqr(o)<k&&(b=P)}for(;Math.abs(b.lng-u.center.lng)>180;){const w=u.locationToScreenPoint(b);if(w.x>=0&&w.y>=0&&w.x<=u.width&&w.y<=u.height)break;b.lng>u.center.lng?b.lng-=360:b.lng+=360}return b.lng!==v.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(b))?b:v}const Ic={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ei(b,o,u){const m=b.classList;for(const v in Ic)m.remove(`maplibregl-${u}-anchor-${v}`);m.add(`maplibregl-${u}-anchor-${o}`)}class si extends s.E{constructor(o){if(super(),this._onKeyPress=u=>{const m=u.code,v=u.charCode||u.keyCode;m!=="Space"&&m!=="Enter"&&v!==32&&v!==13||this.togglePopup()},this._onMapClick=u=>{const m=u.originalEvent.target,v=this._element;this._popup&&(m===v||v.contains(m))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const m=this._map.loaded()&&!this._map.isMoving();((u==null?void 0:u.type)==="terrain"||(u==null?void 0:u.type)==="render"&&!m)&&this._map.once("render",this._update),this._lngLat=Jx(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),E.setTransform(this._element,`${Ic[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${v}`),C.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const m=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=m}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this.setOpacity(o==null?void 0:o.opacity,o==null?void 0:o.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=s.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=E.create("div");const u=E.createNS("http://www.w3.org/2000/svg","svg"),m=41,v=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${m}px`),u.setAttributeNS(null,"width",`${v}px`),u.setAttributeNS(null,"viewBox",`0 0 ${v} ${m}`);const w=E.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const P=E.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill-rule","nonzero");const k=E.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const F=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ae of F){const Fe=E.createNS("http://www.w3.org/2000/svg","ellipse");Fe.setAttributeNS(null,"opacity","0.04"),Fe.setAttributeNS(null,"cx","10.5"),Fe.setAttributeNS(null,"cy","5.80029008"),Fe.setAttributeNS(null,"rx",Ae.rx),Fe.setAttributeNS(null,"ry",Ae.ry),k.appendChild(Fe)}const j=E.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill",this._color);const W=E.createNS("http://www.w3.org/2000/svg","path");W.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),j.appendChild(W);const J=E.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"fill","#000000");const Y=E.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),J.appendChild(Y);const oe=E.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),oe.setAttributeNS(null,"fill","#FFFFFF");const he=E.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Pe=E.createNS("http://www.w3.org/2000/svg","circle");Pe.setAttributeNS(null,"fill","#000000"),Pe.setAttributeNS(null,"opacity","0.25"),Pe.setAttributeNS(null,"cx","5.5"),Pe.setAttributeNS(null,"cy","5.5"),Pe.setAttributeNS(null,"r","5.4999962");const Ee=E.createNS("http://www.w3.org/2000/svg","circle");Ee.setAttributeNS(null,"fill","#FFFFFF"),Ee.setAttributeNS(null,"cx","5.5"),Ee.setAttributeNS(null,"cy","5.5"),Ee.setAttributeNS(null,"r","5.4999962"),he.appendChild(Pe),he.appendChild(Ee),P.appendChild(k),P.appendChild(j),P.appendChild(J),P.appendChild(oe),P.appendChild(he),u.appendChild(P),u.setAttributeNS(null,"height",m*this._scale+"px"),u.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(u),this._offset=s.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),ei(this._element,this._anchor,"marker"),o&&o.className)for(const u of o.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),o.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),E.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.S.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const v=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var u,m;const v=(u=this._map)===null||u===void 0?void 0:u.terrain,w=this._map.transform.isLocationOccluded(this._lngLat);if(!v||w){const oe=w?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==oe&&(this._element.style.opacity=oe))}if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const P=this._map,k=P.terrain.depthAtPoint(this._pos),F=P.terrain.getElevationForLngLatZoom(this._lngLat,P.transform.tileZoom);if(P.transform.lngLatToCameraDepth(this._lngLat,F)-k<.006)return void(this._element.style.opacity=this._opacity);const j=-this._offset.y/P.transform.pixelsPerMeter,W=Math.sin(P.getPitch()*Math.PI/180)*j,J=P.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),Y=P.transform.lngLatToCameraDepth(this._lngLat,F+W)-J>.006;!((m=this._popup)===null||m===void 0)&&m.isOpen()&&Y&&this._popup.remove(),this._element.style.opacity=Y?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=s.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,u){return(this._opacity===void 0||o===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),o!==void 0&&(this._opacity=o),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Qx={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ul=0,$l=!1;const Iv={maxWidth:100,unit:"metric"};function wp(b,o,u){const m=u&&u.maxWidth||100,v=b._container.clientHeight/2,w=b._container.clientWidth/2,P=b.unproject([w-m/2,v]),k=b.unproject([w+m/2,v]),F=Math.round(b.project(k).x-b.project(P).x),j=Math.min(m,F,b._container.clientWidth),W=P.distanceTo(k);if(u&&u.unit==="imperial"){const J=3.2808*W;J>5280?Rc(o,j,J/5280,b._getUIString("ScaleControl.Miles")):Rc(o,j,J,b._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Rc(o,j,W/1852,b._getUIString("ScaleControl.NauticalMiles")):W>=1e3?Rc(o,j,W/1e3,b._getUIString("ScaleControl.Kilometers")):Rc(o,j,W,b._getUIString("ScaleControl.Meters"))}function Rc(b,o,u,m){const v=function(w){const P=Math.pow(10,`${Math.floor(w)}`.length-1);let k=w/P;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(F){const j=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*j)/j}(k),P*k}(u);b.style.width=o*(v/u)+"px",b.innerHTML=`${v}&nbsp;${m}`}const Ld={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Rv=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Sp(b){if(b){if(typeof b=="number"){const o=Math.round(Math.abs(b)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,b),"top-left":new s.P(o,o),"top-right":new s.P(-o,o),bottom:new s.P(0,-b),"bottom-left":new s.P(o,-o),"bottom-right":new s.P(-o,-o),left:new s.P(b,0),right:new s.P(-b,0)}}if(b instanceof s.P||Array.isArray(b)){const o=s.P.convert(b);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:s.P.convert(b.center||[0,0]),top:s.P.convert(b.top||[0,0]),"top-left":s.P.convert(b["top-left"]||[0,0]),"top-right":s.P.convert(b["top-right"]||[0,0]),bottom:s.P.convert(b.bottom||[0,0]),"bottom-left":s.P.convert(b["bottom-left"]||[0,0]),"bottom-right":s.P.convert(b["bottom-right"]||[0,0]),left:s.P.convert(b.left||[0,0]),right:s.P.convert(b.right||[0,0])}}return Sp(new s.P(0,0))}const Lv=f;c.AJAXError=s.cy,c.Event=s.l,c.Evented=s.E,c.LngLat=s.S,c.MercatorCoordinate=s.a0,c.Point=s.P,c.addProtocol=s.cz,c.config=s.a,c.removeProtocol=s.cA,c.AttributionControl=_p,c.BoxZoomHandler=_v,c.CanvasSource=Le,c.CooperativeGesturesHandler=Xx,c.DoubleClickZoomHandler=vp,c.DragPanHandler=Cv,c.DragRotateHandler=yp,c.EdgeInsets=Cs,c.FullscreenControl=class extends s.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var o;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((o=u==null?void 0:u.shadowRoot)===null||o===void 0)&&o.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){E.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=E.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);E.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},c.GeoJSONSource=Dt,c.GeolocateControl=class extends s.E{constructor(b){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",o)),this._finish()}},this._updateCamera=o=>{const u=new s.S(o.coords.longitude,o.coords.latitude),m=o.coords.accuracy,v=this._map.getBearing(),w=s.e({bearing:v},this.options.fitBoundsOptions),P=hn.fromLngLat(u,m);this._map.fitBounds(P,w,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const u=new s.S(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&$l)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=E.create("button","maplibregl-ctrl-geolocate",this._container),E.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(o===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new si({element:this._dotElement}),this._circleElement=E.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new si({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},Qx,b)}onAdd(b){return this._map=b,this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(o=!1){if(eo!==void 0&&!o)return eo;if(window.navigator.permissions===void 0)return eo=!!window.navigator.geolocation,eo;try{eo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{eo=!!window.navigator.geolocation}return eo})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),E.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ul=0,$l=!1}_isOutOfMapMaxBounds(b){const o=this._map.getMaxBounds(),u=b.coords;return o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const b=this._map.getBounds(),o=b.getSouthEast(),u=b.getNorthEast(),m=o.distanceTo(u),v=Math.ceil(this._accuracy/(m/this._map._container.clientHeight)*2);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ul--,$l=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ul++,Ul>1?(b={maximumAge:6e5,timeout:0},$l=!0):(b=this.options.positionOptions,$l=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},c.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const o=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(o!=="mercator"&&o?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=E.create("button","maplibregl-ctrl-globe",this._container),E.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){E.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},c.Hash=Md,c.ImageSource=An,c.KeyboardHandler=$u,c.LngLatBounds=hn,c.LogoControl=Pv,c.Map=class extends Xr{constructor(b){var o,u;s.cv.mark(s.cw.create);const m=Object.assign(Object.assign(Object.assign({},Rd),b),{canvasContextAttributes:Object.assign(Object.assign({},Rd.canvasContextAttributes),b.canvasContextAttributes)});if(m.minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const v=new bi,w=new Wf;if(m.minZoom!==void 0&&v.setMinZoom(m.minZoom),m.maxZoom!==void 0&&v.setMaxZoom(m.maxZoom),m.minPitch!==void 0&&v.setMinPitch(m.minPitch),m.maxPitch!==void 0&&v.setMaxPitch(m.maxPitch),m.renderWorldCopies!==void 0&&v.setRenderWorldCopies(m.renderWorldCopies),super(v,w,{bearingSnap:m.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Zx,this._controls=[],this._mapId=s.a6(),this._contextLost=k=>{k.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.l("webglcontextlost",{originalEvent:k}))},this._contextRestored=k=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:k}))},this._onMapScroll=k=>{if(k.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=m.interactive,this._maxTileCacheSize=m.maxTileCacheSize,this._maxTileCacheZoomLevels=m.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},m.canvasContextAttributes),this._trackResize=m.trackResize===!0,this._bearingSnap=m.bearingSnap,this._centerClampedToGround=m.centerClampedToGround,this._refreshExpiredTiles=m.refreshExpiredTiles===!0,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions===!0,this._collectResourceTiming=m.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},bp),m.locale),this._clickTolerance=m.clickTolerance,this._overridePixelRatio=m.pixelRatio,this._maxCanvasSize=m.maxCanvasSize,this.transformCameraUpdate=m.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=m.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=U.addThrottleControl(()=>this.isMoving()),this._requestManager=new H(m.transformRequest),typeof m.container=="string"){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let k=!1;const F=dp(j=>{this._trackResize&&!this._removed&&(this.resize(j),this.redraw())},50);this._resizeObserver=new ResizeObserver(j=>{k?F(j):k=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Bl(this,m),this._hash=m.hash&&new Md(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,elevation:m.elevation,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,roll:m.roll}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,s.e({},m.fitBoundsOptions,{duration:0}))));const P=typeof m.style=="string"||((u=(o=m.style)===null||o===void 0?void 0:o.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,P),this._localIdeographFontFamily=m.localIdeographFontFamily,this._validateStyle=m.validateStyle,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new _p(typeof m.attributionControl=="boolean"?void 0:m.attributionControl)),m.maplibreLogo&&this.addControl(new Pv,m.logoPosition),this.on("style.load",()=>{if(P||this._resizeTransform(),this.transform.unmodified){const k=s.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(k)}}),this.on("data",k=>{this._update(k.dataType==="style"),this.fire(new s.l(`${k.dataType}data`,k))}),this.on("dataloading",k=>{this.fire(new s.l(`${k.dataType}dataloading`,k))}),this.on("dataabort",k=>{this.fire(new s.l("sourcedataabort",k))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,o){return this.style.setGlobalStateProperty(b,o),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,o){if(o===void 0&&(o=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=b.onAdd(this);this._controls.push(b);const m=this._controlPositions[o];return o.indexOf("bottom")!==-1?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(b);return o>-1&&this._controls.splice(o,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,o,u,m){return m==null&&this.terrain&&(m=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,o,u,m)}resize(b,o=!0){const[u,m]=this._containerDimensions(),v=this._getClampedPixelRatio(u,m);if(this._resizeCanvas(u,m,v),this.painter.resize(u,m,v),this.painter.overLimit()){const P=this.painter.context.gl;this._maxCanvasSize=[P.drawingBufferWidth,P.drawingBufferHeight];const k=this._getClampedPixelRatio(u,m);this._resizeCanvas(u,m,k),this.painter.resize(u,m,k)}this._resizeTransform(o);const w=!this._moving;return w&&(this.stop(),this.fire(new s.l("movestart",b)).fire(new s.l("move",b))),this.fire(new s.l("resize",b)),w&&this.fire(new s.l("moveend",b)),this}_resizeTransform(b=!0){var o;const[u,m]=this._containerDimensions();this.transform.resize(u,m,b),(o=this._requestedCameraState)===null||o===void 0||o.resize(u,m,b)}_getClampedPixelRatio(b,o){const{0:u,1:m}=this._maxCanvasSize,v=this.getPixelRatio(),w=b*v,P=o*v;return Math.min(w>u?u/w:1,P>m?m/P:1)*v}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(hn.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(s.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(s.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,o,u){if(b==="mouseenter"||b==="mouseover"){let m=!1;return{layers:o,listener:u,delegates:{mousemove:w=>{const P=o.filter(F=>this.getLayer(F)),k=P.length!==0?this.queryRenderedFeatures(w.point,{layers:P}):[];k.length?m||(m=!0,u.call(this,new Yo(b,this,w.originalEvent,{features:k}))):m=!1},mouseout:()=>{m=!1}}}}if(b==="mouseleave"||b==="mouseout"){let m=!1;return{layers:o,listener:u,delegates:{mousemove:P=>{const k=o.filter(F=>this.getLayer(F));(k.length!==0?this.queryRenderedFeatures(P.point,{layers:k}):[]).length?m=!0:m&&(m=!1,u.call(this,new Yo(b,this,P.originalEvent)))},mouseout:P=>{m&&(m=!1,u.call(this,new Yo(b,this,P.originalEvent)))}}}}{const m=v=>{const w=o.filter(k=>this.getLayer(k)),P=w.length!==0?this.queryRenderedFeatures(v.point,{layers:w}):[];P.length&&(v.features=P,u.call(this,v),delete v.features)};return{layers:o,listener:u,delegates:{[b]:m}}}}_saveDelegatedListener(b,o){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(o)}_removeDelegatedListener(b,o,u){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const m=this._delegatedListeners[b];for(let v=0;v<m.length;v++){const w=m[v];if(w.listener===u&&w.layers.length===o.length&&w.layers.every(P=>o.includes(P))){for(const P in w.delegates)this.off(P,w.delegates[P]);return void m.splice(v,1)}}}on(b,o,u){if(u===void 0)return super.on(b,o);const m=typeof o=="string"?[o]:o,v=this._createDelegatedListener(b,m,u);this._saveDelegatedListener(b,v);for(const w in v.delegates)this.on(w,v.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(b,m,u)}}}once(b,o,u){if(u===void 0)return super.once(b,o);const m=typeof o=="string"?[o]:o,v=this._createDelegatedListener(b,m,u);for(const w in v.delegates){const P=v.delegates[w];v.delegates[w]=(...k)=>{this._removeDelegatedListener(b,m,u),P(...k)}}this._saveDelegatedListener(b,v);for(const w in v.delegates)this.once(w,v.delegates[w]);return this}off(b,o,u){return u===void 0?super.off(b,o):(this._removeDelegatedListener(b,typeof o=="string"?[o]:o,u),this)}queryRenderedFeatures(b,o){if(!this.style)return[];let u;const m=b instanceof s.P||Array.isArray(b),v=m?b:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(m?{}:b)||{},v instanceof s.P||typeof v[0]=="number")u=[s.P.convert(v)];else{const w=s.P.convert(v[0]),P=s.P.convert(v[1]);u=[w,new s.P(P.x,w.y),P,new s.P(w.x,P.y),w]}return this.style.queryRenderedFeatures(u,o,this.transform)}querySourceFeatures(b,o){return this.style.querySourceFeatures(b,o)}setStyle(b,o){return(o=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(b,o))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const o=this._locale[b];if(o==null)throw new Error(`Missing UI string '${b}'`);return o}_updateStyle(b,o){var u,m;if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,o));const v=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new Yg(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,o,v):this.style.loadJSON(b,o,v),this):((m=(u=this.style)===null||u===void 0?void 0:u.projection)===null||m===void 0||m.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Yg(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,o){if(typeof b=="string"){const u=this._requestManager.transformRequest(b,"Style");s.j(u,new AbortController).then(m=>{this._updateDiff(m.data,o)}).catch(m=>{m&&this.fire(new s.k(m))})}else typeof b=="object"&&this._updateDiff(b,o)}_updateDiff(b,o){try{this.style.setState(b,o)&&this._update(!0)}catch(u){s.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(b,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(b,o){return this._lazyInitEmptyStyle(),this.style.addSource(b,o),this._update(!0)}isSourceLoaded(b){const o=this.style&&this.style.sourceCaches[b];if(o!==void 0)return o.loaded();this.fire(new s.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const o=this.style.sourceCaches[b.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&o.reload();for(const u in this.style._layers){const m=this.style._layers[u];m.type==="hillshade"&&m.source===b.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),m.type==="color-relief"&&m.source===b.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new La(this.painter,o,b),this.painter.renderToTexture=new Vn(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var m;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((m=u.source)===null||m===void 0?void 0:m.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:b})),this}getTerrain(){var b,o;return(o=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const o in b){const u=b[o]._tiles;for(const m in u){const v=u[m];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,o,u){if(u){const m=this.getSource(u);if(!m)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);m.calculateTileZoom=fe(Math.max(1,b),Math.max(1,o))}else for(const m in this.style.sourceCaches)this.style.sourceCaches[m].getSource().calculateTileZoom=fe(Math.max(1,b),Math.max(1,o));return this._update(!0),this}refreshTiles(b,o){const u=this.style.sourceCaches[b];if(!u)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);o===void 0?u.reload(!0):u.refreshTiles(o.map(m=>new s.a3(m.z,m.x,m.y)))}addImage(b,o,u={}){const{pixelRatio:m=1,sdf:v=!1,stretchX:w,stretchY:P,content:k,textFitWidth:F,textFitHeight:j}=u;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||s.b(o))){if(o.width===void 0||o.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:W,height:J,data:Y}=o,oe=o;return this.style.addImage(b,{data:new s.R({width:W,height:J},new Uint8Array(Y)),pixelRatio:m,stretchX:w,stretchY:P,content:k,textFitWidth:F,textFitHeight:j,sdf:v,version:0,userImage:oe}),oe.onAdd&&oe.onAdd(this,b),this}}{const{width:W,height:J,data:Y}=C.getImageData(o);this.style.addImage(b,{data:new s.R({width:W,height:J},Y),pixelRatio:m,stretchX:w,stretchY:P,content:k,textFitWidth:F,textFitHeight:j,sdf:v,version:0})}}updateImage(b,o){const u=this.style.getImage(b);if(!u)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=o instanceof HTMLImageElement||s.b(o)?C.getImageData(o):o,{width:v,height:w,data:P}=m;if(v===void 0||w===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==u.data.width||w!==u.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(o instanceof HTMLImageElement||s.b(o));return u.data.replace(P,k),this.style.updateImage(b,u),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return U.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,o){return this._lazyInitEmptyStyle(),this.style.addLayer(b,o),this._update(!0)}moveLayer(b,o){return this.style.moveLayer(b,o),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,o,u){return this.style.setLayerZoomRange(b,o,u),this._update(!0)}setFilter(b,o,u={}){return this.style.setFilter(b,o,u),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,o,u,m={}){return this.style.setPaintProperty(b,o,u,m),this._update(!0)}getPaintProperty(b,o){return this.style.getPaintProperty(b,o)}setLayoutProperty(b,o,u,m={}){return this.style.setLayoutProperty(b,o,u,m),this._update(!0)}getLayoutProperty(b,o){return this.style.getLayoutProperty(b,o)}setGlyphs(b,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,o,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,o,u,m=>{m||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,o,u=>{u||this._update(!0)}),this}setLight(b,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,o),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,o={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,o),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,o){return this.style.setFeatureState(b,o),this._update()}removeFeatureState(b,o){return this.style.removeFeatureState(b,o),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,o=0;return this._container&&(b=this._container.clientWidth||400,o=this._container.clientHeight||300),[b,o]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const o=this._canvasContainer=E.create("div","maplibregl-canvas-container",b);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=E.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),m=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],m);const v=this._controlContainer=E.create("div","maplibregl-control-container",b),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(P=>{w[P]=E.create("div",`maplibregl-ctrl-${P} `,v)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,o,u){this._canvas.width=Math.floor(u*b),this._canvas.height=Math.floor(u*o),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let o=null;this._canvas.addEventListener("webglcontextcreationerror",m=>{o={requestedAttributes:b},m&&(o.statusMessage=m.statusMessage,o.type=m.type)},{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!u){const m="Failed to initialize WebGL";throw o?(o.message=m,new Error(JSON.stringify(o))):new Error(m)}this.painter=new Ts(u,this.transform),A.testSupport(u)}migrateProjection(b,o){super.migrateProjection(b,o),this.painter.transform=b,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var o,u,m,v,w;const P=this._idleTriggered?this._fadeDuration:0,k=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let F=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const J=this.transform.zoom,Y=C.now();this.style.zoomHistory.update(J,Y);const oe=new s.F(J,{now:Y,fadeDuration:P,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),he=oe.crossFadingFactor();he===1&&he===this._crossFadingFactor||(F=!0,this._crossFadingFactor=he),this.style.update(oe)}const j=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==k;(m=this.style.projection)===null||m===void 0||m.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((v=this.style.projection)===null||v===void 0?void 0:v.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||j)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,P,this._crossSourceCollisions,j),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:P,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cv.mark(s.cw.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||F)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const W=this._sourcesDirty||this._styleDirty||this._placementDirty;return W||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||W||(this._fullyLoaded=!0,s.cv.mark(s.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),U.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o!=null&&o.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),E.remove(this._canvasContainer),E.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cv.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,C.frame(this._frameRequest,b=>{s.cv.frame(b),this._frameRequest=null;try{this._render(b)}catch(o){if(!s.cx(o)&&!function(u){return u.message===hv}(o))throw o}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return Av}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},c.MapMouseEvent=Yo,c.MapTouchEvent=Ks,c.MapWheelEvent=yv,c.Marker=si,c.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const o=this._map.getZoom(),u=o===this._map.getMaxZoom(),m=o===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(o,u)=>{const m=this._map._getUIString(`NavigationControl.${u}`);o.title=m,o.setAttribute("aria-label",m)},this.options=s.e({},ko,b),this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),E.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),E.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=E.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Kx(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){E.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,o){const u=E.create("button",b,this._container);return u.type="button",u.addEventListener("click",o),u}},c.Popup=class extends s.E{constructor(b){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&E.remove(this._content),this._container&&(E.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=E.create("div","maplibregl-popup",this._map.getContainer()),this._tip=E.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const P of this.options.className.split(" "))this._container.classList.add(P);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Jx(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!o)return;const u=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationToScreenPoint(this._lngLat));let m=this.options.anchor;const v=Sp(this.options.offset);if(!m){const P=this._container.offsetWidth,k=this._container.offsetHeight;let F;F=u.y+v.bottom.y<k?["top"]:u.y>this._map.transform.height-k?["bottom"]:[],u.x<P/2?F.push("left"):u.x>this._map.transform.width-P/2&&F.push("right"),m=F.length===0?"bottom":F.join("-")}let w=u.add(v[m]);this.options.subpixelPositioning||(w=w.round()),E.setTransform(this._container,`${Ic[m]} translate(${w.x}px,${w.y}px)`),ei(this._container,m,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(Ld),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=s.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const o=document.createDocumentFragment(),u=document.createElement("body");let m;for(u.innerHTML=b;m=u.firstChild,m;)o.appendChild(m);return this.setDOMContent(o)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=E.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=E.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Rv);b&&b.focus()}},c.RasterDEMTileSource=tn,c.RasterTileSource=Ut,c.ScaleControl=class{constructor(b){this._onMove=()=>{wp(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,wp(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Iv),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){E.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},c.ScrollZoomHandler=qx,c.Style=Yg,c.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=E.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=E.create("button","maplibregl-ctrl-terrain",this._container),E.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){E.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},c.TwoFingersTouchPitchHandler=wv,c.TwoFingersTouchRotateHandler=bv,c.TwoFingersTouchZoomHandler=Ra,c.TwoFingersTouchZoomRotateHandler=Ev,c.VectorTileSource=vn,c.VideoSource=an,c.addSourceType=(b,o)=>s._(void 0,void 0,void 0,function*(){if(it(b))throw new Error(`A source type called "${b}" already exists.`);((u,m)=>{me[u]=m})(b,o)}),c.clearPrewarmedResources=function(){const b=Xt;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(Qe),Xt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},c.createTileMesh=qg,c.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},c.getRTLTextPluginStatus=function(){return Zt().getRTLTextPluginStatus()},c.getVersion=function(){return Lv},c.getWorkerCount=function(){return st.workerCount},c.getWorkerUrl=function(){return s.a.WORKER_URL},c.importScriptInWorkers=function(b){return ut().broadcast("IS",b)},c.prewarm=function(){lt().acquire(Qe)},c.setMaxParallelImageRequests=function(b){s.a.MAX_PARALLEL_IMAGE_REQUESTS=b},c.setRTLTextPlugin=function(b,o){return Zt().setRTLTextPlugin(b,o)},c.setWorkerCount=function(b){st.workerCount=b},c.setWorkerUrl=function(b){s.a.WORKER_URL=b}});var a=n;return a})})(DV);var KM=DV.exports;const OV=$I(KM),ude=UB({__proto__:null,default:OV},[KM]);var Jm=Math.pow,Bo=(e,t,n)=>new Promise((r,i)=>{var a=f=>{try{s(n.next(f))}catch(g){i(g)}},c=f=>{try{s(n.throw(f))}catch(g){i(g)}},s=f=>f.done?r(f.value):Promise.resolve(f.value).then(a,c);s((n=n.apply(e,t)).next())}),ma=Uint8Array,ly=Uint16Array,hde=Int32Array,FV=new ma([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),NV=new ma([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),dde=new ma([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),BV=function(e,t){for(var n=new ly(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new hde(n[30]),r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i}},UV=BV(FV,2),$V=UV.b,fde=UV.r;$V[28]=258,fde[258]=28;var pde=BV(NV,0),mde=pde.b,VV=new ly(32768);for(Lr=0;Lr<32768;++Lr)Oc=(Lr&43690)>>1|(Lr&21845)<<1,Oc=(Oc&52428)>>2|(Oc&13107)<<2,Oc=(Oc&61680)>>4|(Oc&3855)<<4,VV[Lr]=((Oc&65280)>>8|(Oc&255)<<8)>>1;var Oc,Lr,cy=function(e,t,n){for(var r=e.length,i=0,a=new ly(t);i<r;++i)e[i]&&++a[e[i]-1];var c=new ly(t);for(i=1;i<t;++i)c[i]=c[i-1]+a[i-1]<<1;var s;{s=new ly(1<<t);var f=15-t;for(i=0;i<r;++i)if(e[i])for(var g=i<<4|e[i],_=t-e[i],x=c[e[i]-1]++<<_,C=x|(1<<_)-1;x<=C;++x)s[VV[x]>>f]=g}return s},G_=new ma(288);for(Lr=0;Lr<144;++Lr)G_[Lr]=8;var Lr;for(Lr=144;Lr<256;++Lr)G_[Lr]=9;var Lr;for(Lr=256;Lr<280;++Lr)G_[Lr]=7;var Lr;for(Lr=280;Lr<288;++Lr)G_[Lr]=8;var Lr,jV=new ma(32);for(Lr=0;Lr<32;++Lr)jV[Lr]=5;var Lr,gde=cy(G_,9),vde=cy(jV,5),SE=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},pl=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},ME=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},yde=function(e){return(e+7)/8|0},_de=function(e,t,n){(n==null||n>e.length)&&(n=e.length);var r=new ma(n-t);return r.set(e.subarray(t,n)),r},xde=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ca=function(e,t,n){var r=new Error(t||xde[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,ca),!n)throw r;return r},K3=function(e,t,n,r){var i=e.length,a=0;if(!i||t.f&&!t.l)return n||new ma(0);var c=!n||t.i!=2,s=t.i;n||(n=new ma(i*3));var f=function(Ct){var un=n.length;if(Ct>un){var gn=new ma(Math.max(un*2,Ct));gn.set(n),n=gn}},g=t.f||0,_=t.p||0,x=t.b||0,C=t.l,E=t.d,A=t.m,L=t.n,I=i*8;do{if(!C){g=pl(e,_,1);var T=pl(e,_+1,3);if(_+=3,T)if(T==1)C=gde,E=vde,A=9,L=5;else if(T==2){var H=pl(e,_,31)+257,V=pl(e,_+10,15)+4,q=H+pl(e,_+5,31)+1;_+=14;for(var Q=new ma(q),K=new ma(19),N=0;N<V;++N)K[dde[N]]=pl(e,_+N*3,7);_+=V*3;for(var re=SE(K),ye=(1<<re)-1,ge=cy(K,re),N=0;N<q;){var Ve=ge[pl(e,_,ye)];_+=Ve&15;var O=Ve>>4;if(O<16)Q[N++]=O;else{var Ie=0,ve=0;for(O==16?(ve=3+pl(e,_,3),_+=2,Ie=Q[N-1]):O==17?(ve=3+pl(e,_,7),_+=3):O==18&&(ve=11+pl(e,_,127),_+=7);ve--;)Q[N++]=Ie}}var Se=Q.subarray(0,H),Me=Q.subarray(H);A=SE(Se),L=SE(Me),C=cy(Se,A),E=cy(Me,L)}else ca(1);else{var O=yde(_)+4,D=e[O-4]|e[O-3]<<8,U=O+D;if(U>i){s&&ca(0);break}c&&f(x+D),n.set(e.subarray(O,U),x),t.b=x+=D,t.p=_=U*8,t.f=g;continue}if(_>I){s&&ca(0);break}}c&&f(x+131072);for(var Be=(1<<A)-1,Qe=(1<<L)-1,st=_;;st=_){var Ie=C[ME(e,_)&Be],ct=Ie>>4;if(_+=Ie&15,_>I){s&&ca(0);break}if(Ie||ca(2),ct<256)n[x++]=ct;else if(ct==256){st=_,C=null;break}else{var Xt=ct-254;if(ct>264){var N=ct-257,je=FV[N];Xt=pl(e,_,(1<<je)-1)+$V[N],_+=je}var lt=E[ME(e,_)&Qe],Ot=lt>>4;lt||ca(3),_+=lt&15;var Me=mde[Ot];if(Ot>3){var je=NV[Ot];Me+=ME(e,_)&(1<<je)-1,_+=je}if(_>I){s&&ca(0);break}c&&f(x+131072);var ut=x+Xt;if(x<Me){var ot=a-Me,Tt=Math.min(Me,ut);for(ot+x<0&&ca(3);x<Tt;++x)n[x]=r[ot+x]}for(;x<ut;x+=4)n[x]=n[x-Me],n[x+1]=n[x+1-Me],n[x+2]=n[x+2-Me],n[x+3]=n[x+3-Me];x=ut}}t.l=C,t.p=st,t.b=x,t.f=g,C&&(g=1,t.m=A,t.d=E,t.n=L)}while(!g);return x==n.length?n:_de(n,0,x)},bde=new ma(0),wde=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&ca(6,"invalid gzip data");var t=e[3],n=10;t&4&&(n+=(e[10]|e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(t&2)},Sde=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Mde=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ca(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&ca(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Cde(e,t){return K3(e,{i:2},t,t)}function Ede(e,t){var n=wde(e);return n+8>e.length&&ca(6,"invalid gzip data"),K3(e.subarray(n,-8),{i:2},new ma(Sde(e)),t)}function Tde(e,t){return K3(e.subarray(Mde(e,t),-4),{i:2},t,t)}function SA(e,t){return e[0]==31&&e[1]==139&&e[2]==8?Ede(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?Cde(e,t):Tde(e,t)}var Pde=typeof TextDecoder<"u"&&new TextDecoder,Ade=0;try{Pde.decode(bde,{stream:!0}),Ade=1}catch{}var HV=(e,t)=>e*Jm(2,t),g0=(e,t)=>Math.floor(e/Jm(2,t)),rS=(e,t)=>HV(e.getUint16(t+1,!0),8)+e.getUint8(t),GV=(e,t)=>HV(e.getUint32(t+2,!0),16)+e.getUint16(t,!0),Ide=(e,t,n,r,i)=>{if(e!==r.getUint8(i))return e-r.getUint8(i);const a=rS(r,i+1);if(t!==a)return t-a;const c=rS(r,i+4);return n!==c?n-c:0},Rde=(e,t,n,r)=>{const i=WV(e,t|128,n,r);return i?{z:t,x:n,y:r,offset:i[0],length:i[1],isDir:!0}:null},H5=(e,t,n,r)=>{const i=WV(e,t,n,r);return i?{z:t,x:n,y:r,offset:i[0],length:i[1],isDir:!1}:null},WV=(e,t,n,r)=>{let i=0,a=e.byteLength/17-1;for(;i<=a;){const c=a+i>>1,s=Ide(t,n,r,e,c*17);if(s>0)i=c+1;else if(s<0)a=c-1;else return[GV(e,c*17+7),e.getUint32(c*17+13,!0)]}return null},Lde=(e,t)=>e.isDir&&!t.isDir?1:!e.isDir&&t.isDir?-1:e.z!==t.z?e.z-t.z:e.x!==t.x?e.x-t.x:e.y-t.y,qV=(e,t)=>{const n=e.getUint8(t*17);return{z:n&127,x:rS(e,t*17+1),y:rS(e,t*17+4),offset:GV(e,t*17+7),length:e.getUint32(t*17+13,!0),isDir:n>>7===1}},G5=e=>{const t=[],n=new DataView(e);for(let r=0;r<n.byteLength/17;r++)t.push(qV(n,r));return kde(t)},kde=e=>{e.sort(Lde);const t=new ArrayBuffer(17*e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++){const i=e[r];let a=i.z;i.isDir&&(a=a|128),n[r*17]=a,n[r*17+1]=i.x&255,n[r*17+2]=i.x>>8&255,n[r*17+3]=i.x>>16&255,n[r*17+4]=i.y&255,n[r*17+5]=i.y>>8&255,n[r*17+6]=i.y>>16&255,n[r*17+7]=i.offset&255,n[r*17+8]=g0(i.offset,8)&255,n[r*17+9]=g0(i.offset,16)&255,n[r*17+10]=g0(i.offset,24)&255,n[r*17+11]=g0(i.offset,32)&255,n[r*17+12]=g0(i.offset,48)&255,n[r*17+13]=i.length&255,n[r*17+14]=i.length>>8&255,n[r*17+15]=i.length>>16&255,n[r*17+16]=i.length>>24&255}return t},Dde=(e,t)=>{if(e.byteLength<17)return null;const n=e.byteLength/17,r=qV(e,n-1);if(r.isDir){const i=r.z,a=t.z-i,c=Math.trunc(t.x/(1<<a)),s=Math.trunc(t.y/(1<<a));return{z:i,x:c,y:s}}return null};function zde(e){return Bo(this,null,function*(){const t=yield e.getBytes(0,512e3),n=new DataView(t.data),r=n.getUint32(4,!0),i=n.getUint16(8,!0),a=new TextDecoder("utf-8"),c=JSON.parse(a.decode(new DataView(t.data,10,r)));let s=0;c.compression==="gzip"&&(s=2);let f=0;"minzoom"in c&&(f=+c.minzoom);let g=0;"maxzoom"in c&&(g=+c.maxzoom);let _=0,x=0,C=0,E=-180,A=-85,L=180,I=85;if(c.bounds){const O=c.bounds.split(",");E=+O[0],A=+O[1],L=+O[2],I=+O[3]}if(c.center){const O=c.center.split(",");_=+O[0],x=+O[1],C=+O[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:i*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:s,tileType:1,minZoom:f,maxZoom:g,minLon:E,minLat:A,maxLon:L,maxLat:I,centerZoom:C,centerLon:_,centerLat:x,etag:t.etag}})}function Ode(e,t,n,r,i,a,c){return Bo(this,null,function*(){let s=yield n.getArrayBuffer(t,e.rootDirectoryOffset,e.rootDirectoryLength,e);e.specVersion===1&&(s=G5(s));const f=H5(new DataView(s),r,i,a);if(f){let x=(yield t.getBytes(f.offset,f.length,c)).data;const C=new DataView(x);return C.getUint8(0)===31&&C.getUint8(1)===139&&(x=SA(new Uint8Array(x))),{data:x}}const g=Dde(new DataView(s),{z:r,x:i,y:a});if(g){const _=Rde(new DataView(s),g.z,g.x,g.y);if(_){let x=yield n.getArrayBuffer(t,_.offset,_.length,e);e.specVersion===1&&(x=G5(x));const C=H5(new DataView(x),r,i,a);if(C){let A=(yield t.getBytes(C.offset,C.length,c)).data;const L=new DataView(A);return L.getUint8(0)===31&&L.getUint8(1)===139&&(A=SA(new Uint8Array(A))),{data:A}}}}})}var XV={getHeader:zde,getZxy:Ode},Fde=e=>(t,n)=>{if(n instanceof AbortController)return e(t,n);const r=new AbortController;return e(t,r).then(i=>n(void 0,i.data,i.cacheControl||"",i.expires||""),i=>n(i)).catch(i=>n(i)),{cancel:()=>r.abort()}},Nde=class{constructor(e){this.tilev4=(t,n)=>Bo(this,null,function*(){if(t.type==="json"){const C=t.url.substr(10);let E=this.tiles.get(C);if(E||(E=new W5(C),this.tiles.set(C,E)),this.metadata)return{data:yield E.getTileJson(t.url)};const A=yield E.getHeader();return{data:{tiles:[`${t.url}/{z}/{x}/{y}`],minzoom:A.minZoom,maxzoom:A.maxZoom,bounds:[A.minLon,A.minLat,A.maxLon,A.maxLat]}}}const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),i=t.url.match(r);if(!i)throw new Error("Invalid PMTiles protocol URL");const a=i[1];let c=this.tiles.get(a);c||(c=new W5(a),this.tiles.set(a,c));const s=i[2],f=i[3],g=i[4],_=yield c.getHeader(),x=yield c==null?void 0:c.getZxy(+s,+f,+g,n.signal);return x?{data:new Uint8Array(x.data),cacheControl:x.cacheControl,expires:x.expires}:_.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=Fde(this.tilev4),this.tiles=new Map,this.metadata=(e==null?void 0:e.metadata)||!1}add(e){this.tiles.set(e.source.getKey(),e)}get(e){return this.tiles.get(e)}};function Hp(e,t){return(t>>>0)*4294967296+(e>>>0)}function Bde(e,t){const n=t.buf;let r=n[t.pos++],i=(r&112)>>4;if(r<128||(r=n[t.pos++],i|=(r&127)<<3,r<128)||(r=n[t.pos++],i|=(r&127)<<10,r<128)||(r=n[t.pos++],i|=(r&127)<<17,r<128)||(r=n[t.pos++],i|=(r&127)<<24,r<128)||(r=n[t.pos++],i|=(r&1)<<31,r<128))return Hp(e,i);throw new Error("Expected varint not more than 10 bytes")}function v0(e){const t=e.buf;let n=t[e.pos++],r=n&127;return n<128||(n=t[e.pos++],r|=(n&127)<<7,n<128)||(n=t[e.pos++],r|=(n&127)<<14,n<128)||(n=t[e.pos++],r|=(n&127)<<21,n<128)?r:(n=t[e.pos],r|=(n&15)<<28,Bde(r,e))}function Ude(e,t,n,r){if(r===0){n===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const i=t[0];t[0]=t[1],t[1]=i}}var $de=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Vde(e,t,n){if(e>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(t>Jm(2,e)-1||n>Jm(2,e)-1)throw Error("tile x/y outside zoom level bounds");const r=$de[e],i=Jm(2,e);let a=0,c=0,s=0;const f=[t,n];let g=i/2;for(;g>0;)a=(f[0]&g)>0?1:0,c=(f[1]&g)>0?1:0,s+=g*g*(3*a^c),Ude(g,f,a,c),g=g/2;return r+s}function ZV(e,t){return Bo(this,null,function*(){if(t===1||t===0)return e;if(t===2){if(typeof globalThis.DecompressionStream>"u")return SA(new Uint8Array(e));const n=new Response(e).body;if(!n)throw Error("Failed to read response stream");const r=n.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(r).arrayBuffer()}throw Error("Compression method not supported")})}function jde(e){return e===1?".mvt":e===2?".png":e===3?".jpg":e===4?".webp":e===5?".avif":""}var Hde=127;function Gde(e,t){let n=0,r=e.length-1;for(;n<=r;){const i=r+n>>1,a=t-e[i].tileId;if(a>0)n=i+1;else if(a<0)r=i-1;else return e[i]}return r>=0&&(e[r].runLength===0||t-e[r].tileId<e[r].runLength)?e[r]:null}var Wde=class{constructor(e,t=new Headers){this.url=e,this.customHeaders=t,this.mustReload=!1;let n="";"navigator"in globalThis&&(n=globalThis.navigator.userAgent||"");const r=n.indexOf("Windows")>-1,i=/Chrome|Chromium|Edg|OPR|Brave/.test(n);this.chromeWindowsNoCache=!1,r&&i&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(e){this.customHeaders=e}getBytes(e,t,n,r){return Bo(this,null,function*(){let i,a;n?a=n:(i=new AbortController,a=i.signal);const c=new Headers(this.customHeaders);c.set("range",`bytes=${e}-${e+t-1}`);let s;this.mustReload?s="reload":this.chromeWindowsNoCache&&(s="no-store");let f=yield fetch(this.url,{signal:a,cache:s,headers:c});if(e===0&&f.status===416){const C=f.headers.get("Content-Range");if(!C||!C.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const E=+C.substr(8);f=yield fetch(this.url,{signal:a,cache:"reload",headers:{range:`bytes=0-${E-1}`}})}let g=f.headers.get("Etag");if(g!=null&&g.startsWith("W/")&&(g=null),f.status===416||r&&g&&g!==r)throw this.mustReload=!0,new MA(`Server returned non-matching ETag ${r} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(f.status>=300)throw Error(`Bad response code: ${f.status}`);const _=f.headers.get("Content-Length");if(f.status===200&&(!_||+_>t))throw i&&i.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield f.arrayBuffer(),etag:g||void 0,cacheControl:f.headers.get("Cache-Control")||void 0,expires:f.headers.get("Expires")||void 0}})}};function ml(e,t){const n=e.getUint32(t+4,!0),r=e.getUint32(t+0,!0);return n*Jm(2,32)+r}function qde(e,t){const n=new DataView(e),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:ml(n,8),rootDirectoryLength:ml(n,16),jsonMetadataOffset:ml(n,24),jsonMetadataLength:ml(n,32),leafDirectoryOffset:ml(n,40),leafDirectoryLength:ml(n,48),tileDataOffset:ml(n,56),tileDataLength:ml(n,64),numAddressedTiles:ml(n,72),numTileEntries:ml(n,80),numTileContents:ml(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:t}}function YV(e){const t={buf:new Uint8Array(e),pos:0},n=v0(t),r=[];let i=0;for(let a=0;a<n;a++){const c=v0(t);r.push({tileId:i+c,offset:0,length:0,runLength:1}),i+=c}for(let a=0;a<n;a++)r[a].runLength=v0(t);for(let a=0;a<n;a++)r[a].length=v0(t);for(let a=0;a<n;a++){const c=v0(t);c===0&&a>0?r[a].offset=r[a-1].offset+r[a-1].length:r[a].offset=c-1}return r}function Xde(e){const t=new DataView(e);return t.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):t.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var MA=class extends Error{};function Zde(e,t){return Bo(this,null,function*(){const n=yield e.getBytes(0,16384);if(new DataView(n.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Xde(n.data)<3)return[yield XV.getHeader(e)];const i=n.data.slice(0,Hde),a=qde(i,n.etag),c=n.data.slice(a.rootDirectoryOffset,a.rootDirectoryOffset+a.rootDirectoryLength),s=`${e.getKey()}|${a.etag||""}|${a.rootDirectoryOffset}|${a.rootDirectoryLength}`,f=YV(yield t(c,a.internalCompression));return[a,[s,f.length,f]]})}function Yde(e,t,n,r,i){return Bo(this,null,function*(){const a=yield e.getBytes(n,r,void 0,i.etag),c=yield t(a.data,i.internalCompression),s=YV(c);if(s.length===0)throw new Error("Empty directory is invalid");return s})}var Kde=class{constructor(e=100,t=!0,n=ZV){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=e,this.counter=1,this.decompress=n}getHeader(e){return Bo(this,null,function*(){const t=e.getKey(),n=this.cache.get(t);if(n)return n.lastUsed=this.counter++,yield n.data;const r=new Promise((i,a)=>{Zde(e,this.decompress).then(c=>{c[1]&&this.cache.set(c[1][0],{lastUsed:this.counter++,data:Promise.resolve(c[1][2])}),i(c[0]),this.prune()}).catch(c=>{a(c)})});return this.cache.set(t,{lastUsed:this.counter++,data:r}),r})}getDirectory(e,t,n,r){return Bo(this,null,function*(){const i=`${e.getKey()}|${r.etag||""}|${t}|${n}`,a=this.cache.get(i);if(a)return a.lastUsed=this.counter++,yield a.data;const c=new Promise((s,f)=>{Yde(e,this.decompress,t,n,r).then(g=>{s(g),this.prune()}).catch(g=>{f(g)})});return this.cache.set(i,{lastUsed:this.counter++,data:c}),c})}getArrayBuffer(e,t,n,r){return Bo(this,null,function*(){const i=`${e.getKey()}|${r.etag||""}|${t}|${n}`,a=this.cache.get(i);if(a)return a.lastUsed=this.counter++,yield a.data;const c=new Promise((s,f)=>{e.getBytes(t,n,void 0,r.etag).then(g=>{s(g.data),this.cache.has(i),this.prune()}).catch(g=>{f(g)})});return this.cache.set(i,{lastUsed:this.counter++,data:c}),c})}prune(){if(this.cache.size>=this.maxCacheEntries){let e=1/0,t;this.cache.forEach((n,r)=>{n.lastUsed<e&&(e=n.lastUsed,t=r)}),t&&this.cache.delete(t)}}invalidate(e){return Bo(this,null,function*(){const t=e.getKey();if(this.invalidations.get(t))return yield this.invalidations.get(t);this.cache.delete(e.getKey());const n=new Promise((r,i)=>{this.getHeader(e).then(a=>{r(),this.invalidations.delete(t)}).catch(a=>{i(a)})});this.invalidations.set(t,n)})}},W5=class{constructor(e,t,n){typeof e=="string"?this.source=new Wde(e):this.source=e,n?this.decompress=n:this.decompress=ZV,t?this.cache=t:this.cache=new Kde}getHeader(){return Bo(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(e,t,n,r){return Bo(this,null,function*(){const i=Vde(e,t,n),a=yield this.cache.getHeader(this.source);if(a.specVersion<3)return XV.getZxy(a,this.source,this.cache,e,t,n,r);if(e<a.minZoom||e>a.maxZoom)return;let c=a.rootDirectoryOffset,s=a.rootDirectoryLength;for(let f=0;f<=3;f++){const g=yield this.cache.getDirectory(this.source,c,s,a),_=Gde(g,i);if(_){if(_.runLength>0){const x=yield this.source.getBytes(a.tileDataOffset+_.offset,_.length,r,a.etag);return{data:yield this.decompress(x.data,a.tileCompression),cacheControl:x.cacheControl,expires:x.expires}}c=a.leafDirectoryOffset+_.offset,s=_.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(e,t,n,r){return Bo(this,null,function*(){try{return yield this.getZxyAttempt(e,t,n,r)}catch(i){if(i instanceof MA)return this.cache.invalidate(this.source),yield this.getZxyAttempt(e,t,n,r);throw i}})}getMetadataAttempt(){return Bo(this,null,function*(){const e=yield this.cache.getHeader(this.source),t=yield this.source.getBytes(e.jsonMetadataOffset,e.jsonMetadataLength,void 0,e.etag),n=yield this.decompress(t.data,e.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(n))})}getMetadata(){return Bo(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(e){if(e instanceof MA)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw e}})}getTileJson(e){return Bo(this,null,function*(){const t=yield this.getHeader(),n=yield this.getMetadata(),r=jde(t.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${e}/{z}/{x}/{y}${r}`],vector_layers:n.vector_layers,attribution:n.attribution,description:n.description,name:n.name,version:n.version,bounds:[t.minLon,t.minLat,t.maxLon,t.maxLat],center:[t.centerLon,t.centerLat,t.centerZoom],minzoom:t.minZoom,maxzoom:t.maxZoom}})}};let q5=!1;function J3(){if(q5)return;const e=new Nde;OV.addProtocol("pmtiles",e.tile),q5=!0}const JM=e=>{J3();const{mode:t="light",children:n,tileRootUrl:r}=e,i=Y3[t];return te.jsxs(te.Fragment,{children:[te.jsx(fr,{id:"background",type:"background",paint:{"background-color":i.land}}),te.jsxs(Nh,{id:"world",type:"vector",url:`pmtiles://${r}/world.pmtiles`,children:[te.jsx(fr,{"source-layer":"water",type:"fill",paint:{"fill-color":i.water}}),n,te.jsx(fr,{"source-layer":"states",type:"line",paint:{"line-color":i.stateBorder,"line-width":1,"line-opacity":1,"line-dasharray":[2,2]}}),te.jsx(fr,{"source-layer":"countries",type:"line",filter:["!=",["get","name"],"Serbia-Kosovo"],paint:{"line-color":i.countryBorder,"line-width":2,"line-opacity":1}}),te.jsx(fr,{"source-layer":"countries",type:"line",filter:["==",["get","name"],"Serbia-Kosovo"],paint:{"line-color":i.countryBorder,"line-width":2,"line-opacity":1,"line-dasharray":[3,2]}})]})]})},CA=e=>(J3(),te.jsx(Nh,{type:"vector",url:`pmtiles://${e.tileRootUrl}/${e.game}-contours.pmtiles`,children:te.jsx(fr,{"source-layer":"contours",type:"fill",layout:{"fill-sort-key":["get","elevation"],visibility:e.showContours?"visible":"none"},paint:{"fill-color":["interpolate",["linear"],["get","elevation"],-200,"#77c571",0,"#77c571",100,"#afd35f",150,"#ece75b",200,"#decb4c",250,"#d2b446",300,"#bf9c4a",400,"#ba8839",500,"#ac792d"]}})}));class W_ extends Error{constructor(t){super("unreachable value "+JSON.stringify(t))}}class Lf{static checkArgument(t,n){if(!t)throw new Error(n)}static checkState(t,n){if(!t)throw new Error(n)}static checkExists(t,n){return nr(t,n)}}var Pi=(e=>(e[e.FuelStation=0]="FuelStation",e[e.Toll=1]="Toll",e[e.Parking=2]="Parking",e[e.RecruitmentAgency=3]="RecruitmentAgency",e[e.Service=4]="Service",e[e.TruckDealer=5]="TruckDealer",e[e.Port=6]="Port",e[e.Train=7]="Train",e[e.Viewpoint=8]="Viewpoint",e[e.PhotoSight=9]="PhotoSight",e[e.AgricultureCheck=10]="AgricultureCheck",e[e.BorderCheck=11]="BorderCheck",e[e.Garage=12]="Garage",e[e.WeighStation=13]="WeighStation",e[e.CityNames=14]="CityNames",e[e.Company=15]="Company",e[e.RoadNumber=16]="RoadNumber",e[e.Roadwork=17]="Roadwork",e[e.RailCrossing=18]="RailCrossing",e))(Pi||{});const Bh=new Set(Array.from({length:19},(e,t)=>t)),bg=e=>{const{game:t,tileRootUrl:n,visibleIcons:r=Bh,enableIconAutoHide:i=!0,mode:a="light"}=e,c=t==="ats"?Y5(t,e.dlcs??Rf):Y5(t,e.dlcs??Ahe),s=Y3[a];return J3(),te.jsxs(Nh,{id:t,type:"vector",url:`pmtiles://${n}/${t}.pmtiles`,children:[te.jsx(fr,{id:t+"mapAreas","source-layer":t,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"mapArea"],c],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":EE(a),"fill-outline-color":["case",["==",["get","color"],PV.Road],s.mapAreaOutline,EE(a)]}}),te.jsx(fr,{id:t+"prefabs","source-layer":t,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"prefab"],c],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":EE(a)}}),te.jsx(Jde,{game:t,tileRootUrl:n,mode:a,color:s.footprint}),te.jsx(fr,{id:t+"hidden-roads","source-layer":t,type:"line",minzoom:9,filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!0],c],paint:{"line-color":s.hiddenRoad,"line-width":1,"line-opacity":.7}}),te.jsx(fr,{id:t+"visible-roads-case","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],c],layout:K5,paint:{"line-color":ife(a),"line-gap-width":J5,"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,14,2,16,3]}}),te.jsx(fr,{id:t+"visible-roads","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],c],layout:K5,paint:{"line-color":rfe(a),"line-width":J5}}),te.jsx(fr,{id:t+"ferries","source-layer":t,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],paint:{"line-color":s.ferryLine,"line-width":1,"line-opacity":.8,"line-dasharray":[2,2]}}),te.jsx(fr,{id:t+"trains-a","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":s.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,-6]}}),te.jsx(fr,{id:t+"trains-b","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":s.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,6]}}),te.jsx(fr,{id:t+"train-hatch","source-layer":t,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":s.trainLine,"line-width":10,"line-opacity":.8,"line-dasharray":[.1,1]}}),te.jsx(fr,{id:t+"ferry-labels","source-layer":t,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],layout:{...Vc,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":s.ferryHalo,"text-color":s.ferryLabel}}),te.jsx(fr,{id:t+"train-labels","source-layer":t,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],layout:{...Vc,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":s.trainHalo,"text-color":s.trainLabel}}),r.has(15)&&te.jsx(fr,{id:t+"company-icons","source-layer":t,type:"symbol",minzoom:i?8:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"company"],c],layout:Zu(i,1,1.25,3.5)}),t==="ets2"&&r.has(16)&&te.jsx(fr,{id:"euro-road-overlays","source-layer":t,minzoom:i?4.5:0,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["!",["in",["get","sprite"],["literal",X5]]]],layout:Zu(i,.4*1.25,.75*1.25,1.25*1.25)}),t==="ats"&&r.has(16)&&te.jsx(fr,{id:t+"road-interstate-overlays","source-layer":t,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","is",["get","sprite"]],0],c],layout:Zu(i,.4,.75,1.25)}),t==="ats"&&r.has(16)&&te.jsx(fr,{id:t+"road-us-route-overlays","source-layer":t,type:"symbol",minzoom:i?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","us",["get","sprite"]],0],c],layout:Zu(i,.4,.75,1.25)}),t==="ats"&&r.has(16)&&te.jsx(fr,{id:t+"road-state-route-overlays","source-layer":t,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],c,["!",["any",["==",["index-of","is",["get","sprite"]],0],["==",["index-of","us",["get","sprite"]],0],["in",["get","sprite"],["literal",X5]]]]],layout:Zu(i,.4,.75,1.25)}),r.has(14)&&te.jsx(fr,{id:t+"city-labels-small","source-layer":t,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],[">",["get","scaleRank"],6],c],layout:{...Vc,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":dm,"text-size":12,"icon-image":CE,"icon-allow-overlap":!i,"icon-size":.6},paint:s.primaryTextPaint}),r.has(14)&&te.jsx(fr,{id:t+"city-labels-medium","source-layer":t,type:"symbol",minzoom:i?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],6],[">",["get","scaleRank"],3],c],layout:{...Vc,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":dm,"text-size":13,"icon-image":CE,"icon-allow-overlap":!i,"icon-size":.6},paint:s.primaryTextPaint}),r.has(14)&&te.jsx(fr,{id:t+"city-labels-big","source-layer":t,type:"symbol",minzoom:i?4:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],3],c],layout:{...Vc,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":dm,"text-size":14,"icon-image":CE,"icon-allow-overlap":!i,"icon-size":.8},paint:s.primaryTextPaint}),t==="ets2"&&r.has(14)&&te.jsx(fr,{id:t+"country-labels","source-layer":t,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...Vc,"text-font":["Klokantech Noto Sans Bold"],"text-field":"{name}","text-variable-anchor":dm,"text-size":14},paint:s.primaryTextPaint}),t==="ats"&&r.has(14)&&te.jsx(fr,{id:t+"country-labels","source-layer":t,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...Vc,"text-font":["Open Sans Light"],"text-field":"{name}","text-transform":"uppercase","text-variable-anchor":dm,"text-size":["step",["zoom"],10,5,13]},paint:s.secondaryTextPaint}),EA(r)&&te.jsx(fr,{id:t+"poi-icons","source-layer":t,type:"symbol",minzoom:i?7:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],Z5(r),c],layout:Zu(i,.6,1.25,2.5,{vertical:2,horizontal:2})}),EA(r)&&(r.has(8)||r.has(9)||r.has(5))&&te.jsx(fr,{id:t+"poi-icon-labels","source-layer":t,type:"symbol",minzoom:i?9.5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["any",["in",["get","poiType"],["literal",["viewpoint","landmark"]]],["all",["==",["get","poiType"],"facility"],["==",["get","sprite"],"dealer_ico"]]],Z5(r),c],layout:{...Zu(i,.6,1.25,2.5,{vertical:2,horizontal:2}),...Vc,"text-field":"{poiName}","text-allow-overlap":!i,"text-variable-anchor":["left","right","top","bottom"],"text-radial-offset":1.5,"text-size":10},paint:s.primaryTextPaint}),(r.has(17)||r.has(18))&&te.jsx(fr,{id:t+"traffic-icons","source-layer":t,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"traffic"],tfe(r),c],layout:Zu(i,.6*.5,1.25*.5,2.5*.5,{vertical:2,horizontal:2})})]})},Jde=({game:e,tileRootUrl:t,color:n,mode:r})=>te.jsxs(Nh,{id:e+"footprints",type:"vector",url:`pmtiles://${t}/${e}-footprints.pmtiles`,children:[te.jsx(fr,{id:e+"footprints","source-layer":"footprints",type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-color":n,"fill-opacity":["step",["zoom"],1,9,.8]}}),te.jsx(fr,{id:e+"extrusions",minzoom:9,"source-layer":"footprints",type:"fill-extrusion",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-extrusion-color":n,"fill-extrusion-height":["interpolate",["exponential",1.5],["zoom"],9,["*",10,["get","height"]],13,["*",20,["get","height"]]],"fill-extrusion-opacity":r==="light"?.33:.67}})]});function Zu(e,t,n,r,i={vertical:10,horizontal:30}){const a=["literal",[i.vertical,i.horizontal]];return{"icon-image":"{sprite}","icon-allow-overlap":!e,"icon-padding":a,"icon-size":["interpolate",["exponential",1.5],["zoom"],4,t,9,n,13,r]}}const CE=["step",["zoom"],["case",["==",["get","capital"],2],"dotdot","dot"],8,""],Qde=[9,8,6,7,2,0,4,5,12,3,13,1,10,11],KV=[17,18],X5=["weigh_ico","toll_ico","agri_check","border_ico"];function EA(e){return Qde.some(t=>e.has(t))}function efe(e){return KV.some(t=>e.has(t))}function tfe(e){Lf.checkArgument(efe(e));const t=[];return e.has(17)&&t.push("roadwork"),e.has(18)&&t.push("railcrossing"),["any",t.length>0?["in",["get","sprite"],["literal",t]]:!1]}function Z5(e){Lf.checkArgument(EA(e));const t=[];e.has(9)&&t.push("landmark"),e.has(8)&&t.push("viewpoint"),e.has(6)&&t.push("ferry"),e.has(7)&&t.push("train");const n=[];e.has(0)&&n.push("gas_ico"),e.has(4)&&n.push("service_ico"),e.has(13)&&n.push("weigh_station_ico"),e.has(5)&&n.push("dealer_ico"),e.has(12)&&n.push("garage_large_ico"),e.has(3)&&n.push("recruitment_ico"),e.has(2)&&n.push("parking_ico");const r=[];e.has(13)&&r.push("weigh_ico"),e.has(1)&&r.push("toll_ico"),e.has(10)&&r.push("agri_check"),e.has(11)&&r.push("border_ico");const i=t.length>0?["in",["get","poiType"],["literal",t]]:!1,a=n.length>0?["all",["==",["get","poiType"],"facility"],["in",["get","sprite"],["literal",n]]]:!1,c=r.length>0?["all",["==",["get","poiType"],"road"],["in",["get","sprite"],["literal",r]]]:!1;return["any",i,a,c]}function Y5(e,t){let n;return e==="ats"?n=H_(t):(n=Rhe(t),n.add(null)),["in",["get","dlcGuard"],["literal",[...n]]]}const dm=["step",["zoom"],["literal",["top","bottom","right","left"]],7,["literal",["center"]]],Vc={"text-radial-offset":.5,"text-justify":"auto","text-font":["Klokantech Noto Sans Regular"]},K5={"line-cap":"round","line-join":"bevel"},J5=["interpolate",["exponential",1.5],["zoom"],3,.8,14,30,16,150],JV={light:{freeway:["#fde293","#f8c248"],divided:["#ffffff","#dddddd"],no_vehicles:["#aaaaaa","#888888"],local:["#f1f3f4","#dddddd"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]},dark:{freeway:["#95813e","#372f21"],divided:["#3c4043","#4c5043"],no_vehicles:["#606166","#888888"],local:["#606166","#333"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]}},nfe={light:{0:"hsl(200, 8%, 92%)",1:"hsl(38, 59%, 76%)",2:"hsl(38, 64%, 58%)",3:"hsl(92, 31%, 70%)",4:"hsl(0, 100%, 30%)",5:"hsl(107, 51%, 43%)",6:"hsl(201, 53%, 39%)",7:"hsl(53, 84%, 53%)",8:"hsl(267,46% ,45%)"},dark:{0:"hsl(200, 2%, 36%)",1:"hsl(38, 25%, 35%)",2:"hsl(38, 25%, 25%)",3:"hsl(143, 20%, 25%)",4:"hsl(0, 100%, 25%)",5:"hsl(107, 51%, 25%)",6:"hsl(201, 53%, 25%)",7:"hsl(53, 84%, 25%)",8:"hsl(267, 46%, 25%)"}},rfe=e=>["match",["get","roadType"],...Object.entries(JV[e]).flatMap(([t,[n]])=>[t,n]),"#f0f"],ife=e=>["match",["get","roadType"],...Object.entries(JV[e]).flatMap(([t,[,n]])=>[t,n]),"#b0b"],EE=e=>["match",["get","color"],...Object.entries(nfe[e]).flatMap(([t,n])=>[Number(t),n]),"#b0b"],QV="/extra-labels.geojson",ej="/ets2-villages.geojson";var ao=(e=>(e.AR="AR",e.AZ="AZ",e.CA="CA",e.CO="CO",e.IA="IA",e.ID="ID",e.KS="KS",e.MO="MO",e.MT="MT",e.NE="NE",e.NM="NM",e.NV="NV",e.OK="OK",e.OR="OR",e.TX="TX",e.UT="UT",e.WA="WA",e.WY="WY",e))(ao||{});const ofe={AR:void 0,AZ:void 0,CA:void 0,CO:void 0,IA:void 0,ID:void 0,KS:void 0,MO:void 0,MT:void 0,NE:void 0,NM:void 0,NV:void 0,OK:void 0,OR:void 0,TX:void 0,UT:void 0,WA:void 0,WY:void 0},sfe=new Set(Object.keys(ofe)),TA=e=>{const{game:t,enableAutoHide:n=!0,mode:r="light"}=e,i=t==="ats"?QV:ej,a=t==="ats"?["all",["boolean",["get","show"],!0],["in",["slice",["get","country"],-2],["literal",[...e.enabledStates??sfe]]]]:["boolean",!0],c=Y3[r];return te.jsx(Nh,{id:`${t}-scenery-towns`,type:"geojson",data:i,children:te.jsx(fr,{id:`${t}-scenery-towns`,type:"symbol",minzoom:n?7:0,filter:a,layout:{...Vc,"text-field":"{text}","text-allow-overlap":!n,"text-variable-anchor":dm,"text-size":10.5},paint:c.primaryTextPaint})})},QM=new Proxy({version:8,sprite:"/sprites",glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",sources:{},layers:[]},{get(e,t,n){var r;return t==="sprite"&&((r=e.sprite)!=null&&r.toString().match(/^\/\w/))?window.location.origin+e.sprite.toString():Reflect.get(e,t,n)}}),afe=qs(te.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6"})),lfe=qs(te.jsx("path",{d:"M10.85 12.65h2.3L12 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM14.3 16l-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9z"})),cfe=qs(te.jsx("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6m0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4"})),ufe=qs(te.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6"})),Q5=qs(te.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),hfe=qs(te.jsx("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"})),dfe=qs(te.jsx("path",{d:"m16 5-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2"})),ffe=qs(te.jsx("path",{d:"M19 5v14H5V5zm1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9M11 7h6v2h-6zm0 4h6v2h-6zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"})),pfe=qs(te.jsx("path",{d:"M15 11V5l-3-3-3 3v2H3v14h18V11zm-8 8H5v-2h2zm0-4H5v-2h2zm0-4H5V9h2zm6 8h-2v-2h2zm0-4h-2v-2h2zm0-4h-2V9h2zm0-4h-2V5h2zm6 12h-2v-2h2zm0-4h-2v-2h2z"})),mfe=qs(te.jsx("path",{d:"M2 18v4h3v-2h5.5v2h3v-2H19v2h3v-4zM18 2H6c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1m-3 6H9V6h6z"})),tj=qs(te.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),nj=qs(te.jsx("path",{d:"m21.58 16.09-1.09-7.66C20.21 6.46 18.52 5 16.53 5H7.47C5.48 5 3.79 6.46 3.51 8.43l-1.09 7.66C2.2 17.63 3.39 19 4.94 19c.68 0 1.32-.27 1.8-.75L9 16h6l2.25 2.25c.48.48 1.13.75 1.8.75 1.56 0 2.75-1.37 2.53-2.91M11 11H9v2H8v-2H6v-1h2V8h1v2h2zm4-1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m2 3c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),rj=qs(te.jsx("path",{d:"M20.69 4.05C18.66 4.73 15.86 5.5 12 5.5c-3.89 0-6.95-.84-8.69-1.43-.64-.22-1.31.26-1.31.95V19c0 .68.66 1.17 1.31.95C5.36 19.26 8.1 18.5 12 18.5c3.87 0 6.66.76 8.69 1.45.65.21 1.31-.27 1.31-.95V5c0-.68-.66-1.16-1.31-.95M12 15c-2.34 0-4.52.15-6.52.41l3.69-4.42 2 2.4L14 10l4.51 5.4c-1.99-.25-4.21-.4-6.51-.4"}));function ij(e,t){return aj(e,t,(n,r,i,a)=>Math.sqrt(Math.pow(i-n,2)+Math.pow(a-r,2)))}function gfe(e,t){return aj(e,t,(n,r,i,a)=>[(n+i)/2,(r+a)/2])}function e4([e,t,n,r]){return gfe([e,t],[n,r])}function oj(e){let t=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(const a of e)Array.isArray(a)?(t=Math.min(t,a[0]),r=Math.max(r,a[0]),n=Math.min(n,a[1]),i=Math.max(i,a[1])):(t=Math.min(t,a.x),r=Math.max(r,a.x),n=Math.min(n,a.y),i=Math.max(i,a.y));return[t,n,r,i]}function H1(e,t){const[n,r]=e,[i,a,c,s]=t;return i<=n&&n<=c&&a<=r&&r<=s}function sj(e){const t=Math.PI*2;let n=e%t;return n=(n+t)%t,n<=Math.PI?n:n-t}function t4(e){return sj(e*Math.PI/180)}function aj(e,t,n){let r,i;Array.isArray(e)?(Lf.checkArgument(e.length>=2),r=e[0],i=e[1]):(r=e.x,i=e.y);let a,c;return Array.isArray(t)?(Lf.checkArgument(t.length>=2),a=t[0],c=t[1]):(a=t.x,c=t.y),n(r,i,a,c)}function vfe(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)e("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}var kf=1,Df=2,Qm=3,yfe=4,PA=5,n4=6378137,_fe=6356752314e-3,r4=.0066943799901413165,uy=484813681109536e-20,on=Math.PI/2,xfe=.16666666666666666,bfe=.04722222222222222,wfe=.022156084656084655,Pn=1e-10,Fo=.017453292519943295,ac=57.29577951308232,Or=Math.PI/4,i_=Math.PI*2,Di=3.14159265359,Xs={};Xs.greenwich=0;Xs.lisbon=-9.131906111111;Xs.paris=2.337229166667;Xs.bogota=-74.080916666667;Xs.madrid=-3.687938888889;Xs.rome=12.452333333333;Xs.bern=7.439583333333;Xs.jakarta=106.807719444444;Xs.ferro=-17.666666666667;Xs.brussels=4.367975;Xs.stockholm=18.058277777778;Xs.athens=23.7163375;Xs.oslo=10.722916666667;const Sfe={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var i4=/[\s_\-\/\(\)]/g;function Uh(e,t){if(e[t])return e[t];for(var n=Object.keys(e),r=t.toLowerCase().replace(i4,""),i=-1,a,c;++i<n.length;)if(a=n[i],c=a.toLowerCase().replace(i4,""),c===r)return e[a]}function AA(e){var t={},n=e.split("+").map(function(s){return s.trim()}).filter(function(s){return s}).reduce(function(s,f){var g=f.split("=");return g.push(!0),s[g[0].toLowerCase()]=g[1],s},{}),r,i,a,c={proj:"projName",datum:"datumCode",rf:function(s){t.rf=parseFloat(s)},lat_0:function(s){t.lat0=s*Fo},lat_1:function(s){t.lat1=s*Fo},lat_2:function(s){t.lat2=s*Fo},lat_ts:function(s){t.lat_ts=s*Fo},lon_0:function(s){t.long0=s*Fo},lon_1:function(s){t.long1=s*Fo},lon_2:function(s){t.long2=s*Fo},alpha:function(s){t.alpha=parseFloat(s)*Fo},gamma:function(s){t.rectified_grid_angle=parseFloat(s)},lonc:function(s){t.longc=s*Fo},x_0:function(s){t.x0=parseFloat(s)},y_0:function(s){t.y0=parseFloat(s)},k_0:function(s){t.k0=parseFloat(s)},k:function(s){t.k0=parseFloat(s)},a:function(s){t.a=parseFloat(s)},b:function(s){t.b=parseFloat(s)},r:function(s){t.a=t.b=parseFloat(s)},r_a:function(){t.R_A=!0},zone:function(s){t.zone=parseInt(s,10)},south:function(){t.utmSouth=!0},towgs84:function(s){t.datum_params=s.split(",").map(function(f){return parseFloat(f)})},to_meter:function(s){t.to_meter=parseFloat(s)},units:function(s){t.units=s;var f=Uh(Sfe,s);f&&(t.to_meter=f.to_meter)},from_greenwich:function(s){t.from_greenwich=s*Fo},pm:function(s){var f=Uh(Xs,s);t.from_greenwich=(f||parseFloat(s))*Fo},nadgrids:function(s){s==="@null"?t.datumCode="none":t.nadgrids=s},axis:function(s){var f="ewnsud";s.length===3&&f.indexOf(s.substr(0,1))!==-1&&f.indexOf(s.substr(1,1))!==-1&&f.indexOf(s.substr(2,1))!==-1&&(t.axis=s)},approx:function(){t.approx=!0}};for(r in n)i=n[r],r in c?(a=c[r],typeof a=="function"?a(i):t[a]=i):t[r]=i;return typeof t.datumCode=="string"&&t.datumCode!=="WGS84"&&(t.datumCode=t.datumCode.toLowerCase()),t}var o_=1,lj=2,cj=3,iS=4,uj=5,Q3=-1,Mfe=/\s/,Cfe=/[A-Za-z]/,Efe=/[A-Za-z84_]/,eC=/[,\]]/,hj=/[\d\.E\-\+]/;function gu(e){if(typeof e!="string")throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=o_}gu.prototype.readCharicter=function(){var e=this.text[this.place++];if(this.state!==iS)for(;Mfe.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case o_:return this.neutral(e);case lj:return this.keyword(e);case iS:return this.quoted(e);case uj:return this.afterquote(e);case cj:return this.number(e);case Q3:return}};gu.prototype.afterquote=function(e){if(e==='"'){this.word+='"',this.state=iS;return}if(eC.test(e)){this.word=this.word.trim(),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in afterquote yet, index '+this.place)};gu.prototype.afterItem=function(e){if(e===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=o_;return}if(e==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=o_,this.currentObject=this.stack.pop(),this.currentObject||(this.state=Q3);return}};gu.prototype.number=function(e){if(hj.test(e)){this.word+=e;return}if(eC.test(e)){this.word=parseFloat(this.word),this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in number yet, index '+this.place)};gu.prototype.quoted=function(e){if(e==='"'){this.state=uj;return}this.word+=e};gu.prototype.keyword=function(e){if(Efe.test(e)){this.word+=e;return}if(e==="["){var t=[];t.push(this.word),this.level++,this.root===null?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,this.state=o_;return}if(eC.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in keyword yet, index '+this.place)};gu.prototype.neutral=function(e){if(Cfe.test(e)){this.word=e,this.state=lj;return}if(e==='"'){this.word="",this.state=iS;return}if(hj.test(e)){this.word=e,this.state=cj;return}if(eC.test(e)){this.afterItem(e);return}throw new Error(`havn't handled "`+e+'" in neutral yet, index '+this.place)};gu.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===Q3)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Tfe(e){var t=new gu(e);return t.output()}function TE(e,t,n){Array.isArray(t)&&(n.unshift(t),t=null);var r=t?{}:e,i=n.reduce(function(a,c){return Lm(c,a),a},r);t&&(e[t]=i)}function Lm(e,t){if(!Array.isArray(e)){t[e]=!0;return}var n=e.shift();if(n==="PARAMETER"&&(n=e.shift()),e.length===1){if(Array.isArray(e[0])){t[n]={},Lm(e[0],t[n]);return}t[n]=e[0];return}if(!e.length){t[n]=!0;return}if(n==="TOWGS84"){t[n]=e;return}if(n==="AXIS"){n in t||(t[n]=[]),t[n].push(e);return}Array.isArray(n)||(t[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":t[n]={name:e[0].toLowerCase(),convert:e[1]},e.length===3&&Lm(e[2],t[n]);return;case"SPHEROID":case"ELLIPSOID":t[n]={name:e[0],a:e[1],rf:e[2]},e.length===4&&Lm(e[3],t[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":e[0]=["name",e[0]],TE(t,n,e);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":e[0]=["name",e[0]],TE(t,n,e),t[n].type=n;return;default:for(r=-1;++r<e.length;)if(!Array.isArray(e[r]))return Lm(e,t[n]);return TE(t,n,e)}}var Pfe=.017453292519943295,Afe=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function Ife(e,t){var n=t[0],r=t[1];!(n in e)&&r in e&&(e[n]=e[r],t.length===3&&(e[n]=t[2](e[n])))}function Yl(e){return e*Pfe}function dj(e){for(var t=Object.keys(e),n=0,r=t.length;n<r;++n){var i=t[n];Afe.indexOf(i)!==-1&&Rfe(e[i]),typeof e[i]=="object"&&dj(e[i])}}function Rfe(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if(e.type==="GEOGCS"?e.projName="longlat":e.type==="LOCAL_CS"?(e.projName="identity",e.local=!0):typeof e.PROJECTION=="object"?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.AXIS){for(var n="",r=0,i=e.AXIS.length;r<i;++r){var a=[e.AXIS[r][0].toLowerCase(),e.AXIS[r][1].toLowerCase()];a[0].indexOf("north")!==-1||(a[0]==="y"||a[0]==="lat")&&a[1]==="north"?n+="n":a[0].indexOf("south")!==-1||(a[0]==="y"||a[0]==="lat")&&a[1]==="south"?n+="s":a[0].indexOf("east")!==-1||(a[0]==="x"||a[0]==="lon")&&a[1]==="east"?n+="e":(a[0].indexOf("west")!==-1||(a[0]==="x"||a[0]==="lon")&&a[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(e.axis=n)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),e.units==="metre"&&(e.units="meter"),e.UNIT.convert&&(e.type==="GEOGCS"?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var c=e.GEOGCS;e.type==="GEOGCS"&&(c=e),c&&(c.DATUM?e.datumCode=c.DATUM.name.toLowerCase():e.datumCode=c.name.toLowerCase(),e.datumCode.slice(0,2)==="d_"&&(e.datumCode=e.datumCode.slice(2)),e.datumCode==="new_zealand_1949"&&(e.datumCode="nzgd49"),(e.datumCode==="wgs_1984"||e.datumCode==="world_geodetic_system_1984")&&(e.PROJECTION==="Mercator_Auxiliary_Sphere"&&(e.sphere=!0),e.datumCode="wgs84"),e.datumCode==="belge_1972"&&(e.datumCode="rnb72"),c.DATUM&&c.DATUM.SPHEROID&&(e.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),e.ellps.toLowerCase().slice(0,13)==="international"&&(e.ellps="intl"),e.a=c.DATUM.SPHEROID.a,e.rf=parseFloat(c.DATUM.SPHEROID.rf,10)),c.DATUM&&c.DATUM.TOWGS84&&(e.datum_params=c.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),e.datumCode==="ch1903+"&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a);function s(_){var x=e.to_meter||1;return _*x}var f=function(_){return Ife(e,_)},g=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Yl],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",Yl],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",Yl],["lat0","latitude_of_origin",Yl],["lat0","standard_parallel_1",Yl],["lat1","standard_parallel_1",Yl],["lat2","standard_parallel_2",Yl],["azimuth","Azimuth"],["alpha","azimuth",Yl],["srsCode","name"]];g.forEach(f),!e.long0&&e.longc&&(e.projName==="Albers_Conic_Equal_Area"||e.projName==="Lambert_Azimuthal_Equal_Area")&&(e.long0=e.longc),!e.lat_ts&&e.lat1&&(e.projName==="Stereographic_South_Pole"||e.projName==="Polar Stereographic (variant B)")?(e.lat0=Yl(e.lat1>0?90:-90),e.lat_ts=e.lat1):!e.lat_ts&&e.lat0&&e.projName==="Polar_Stereographic"&&(e.lat_ts=e.lat0,e.lat0=Yl(e.lat0>0?90:-90))}function fj(e){var t=Tfe(e),n=t[0],r={};return Lm(t,r),dj(r),r[n]}function ms(e){var t=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?ms[e]=AA(arguments[1]):ms[e]=fj(arguments[1]):ms[e]=n}else if(arguments.length===1){if(Array.isArray(e))return e.map(function(r){Array.isArray(r)?ms.apply(t,r):ms(r)});if(typeof e=="string"){if(e in ms)return ms[e]}else"EPSG"in e?ms["EPSG:"+e.EPSG]=e:"ESRI"in e?ms["ESRI:"+e.ESRI]=e:"IAU2000"in e?ms["IAU2000:"+e.IAU2000]=e:console.log(e);return}}vfe(ms);function Lfe(e){return typeof e=="string"}function kfe(e){return e in ms}var Dfe=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function zfe(e){return Dfe.some(function(t){return e.indexOf(t)>-1})}var Ofe=["3857","900913","3785","102113"];function Ffe(e){var t=Uh(e,"authority");if(t){var n=Uh(t,"epsg");return n&&Ofe.indexOf(n)>-1}}function Nfe(e){var t=Uh(e,"extension");if(t)return Uh(t,"proj4")}function Bfe(e){return e[0]==="+"}function Ufe(e){if(Lfe(e)){if(kfe(e))return ms[e];if(zfe(e)){var t=fj(e);if(Ffe(t))return ms["EPSG:3857"];var n=Nfe(t);return n?AA(n):t}if(Bfe(e))return AA(e)}else return e}function o4(e,t){e=e||{};var n,r;if(!t)return e;for(r in t)n=t[r],n!==void 0&&(e[r]=n);return e}function vc(e,t,n){var r=e*t;return n/Math.sqrt(1-r*r)}function q_(e){return e<0?-1:1}function Ln(e){return Math.abs(e)<=Di?e:e-q_(e)*i_}function Al(e,t,n){var r=e*n,i=.5*e;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(on-t))/r}function s_(e,t){for(var n=.5*e,r,i,a=on-2*Math.atan(t),c=0;c<=15;c++)if(r=e*Math.sin(a),i=on-2*Math.atan(t*Math.pow((1-r)/(1+r),n))-a,a+=i,Math.abs(i)<=1e-10)return a;return-9999}function $fe(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=vc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function Vfe(e){var t=e.x,n=e.y;if(n*ac>90&&n*ac<-90&&t*ac>180&&t*ac<-180)return null;var r,i;if(Math.abs(Math.abs(n)-on)<=Pn)return null;if(this.sphere)r=this.x0+this.a*this.k0*Ln(t-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(Or+.5*n));else{var a=Math.sin(n),c=Al(this.e,n,a);r=this.x0+this.a*this.k0*Ln(t-this.long0),i=this.y0-this.a*this.k0*Math.log(c)}return e.x=r,e.y=i,e}function jfe(e){var t=e.x-this.x0,n=e.y-this.y0,r,i;if(this.sphere)i=on-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var a=Math.exp(-n/(this.a*this.k0));if(i=s_(this.e,a),i===-9999)return null}return r=Ln(this.long0+t/(this.a*this.k0)),e.x=r,e.y=i,e}var Hfe=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const Gfe={init:$fe,forward:Vfe,inverse:jfe,names:Hfe};function Wfe(){}function s4(e){return e}var qfe=["longlat","identity"];const Xfe={init:Wfe,forward:s4,inverse:s4,names:qfe};var Zfe=[Gfe,Xfe],Kb={},oS=[];function pj(e,t){var n=oS.length;return e.names?(oS[n]=e,e.names.forEach(function(r){Kb[r.toLowerCase()]=n}),this):(console.log(t),!0)}function Yfe(e){if(!e)return!1;var t=e.toLowerCase();if(typeof Kb[t]<"u"&&oS[Kb[t]])return oS[Kb[t]]}function Kfe(){Zfe.forEach(pj)}const Jfe={start:Kfe,add:pj,get:Yfe};var Xn={};Xn.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Xn.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Xn.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Xn.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Xn.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};Xn.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Xn.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Xn.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};Xn.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Xn.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Xn.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Xn.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};Xn.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Xn.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};Xn.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};Xn.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};Xn.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};Xn.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Xn.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Xn.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};Xn.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};Xn.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};Xn.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};Xn.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};Xn.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Xn.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Xn.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Xn.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Xn.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Xn.hough={a:6378270,rf:297,ellipseName:"Hough"};Xn.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Xn.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Xn.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Xn.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Xn.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};Xn.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Xn.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Xn.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};Xn.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};Xn.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Xn.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Xn.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Qfe=Xn.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Xn.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function epe(e,t,n,r){var i=e*e,a=t*t,c=(i-a)/i,s=0;r?(e*=1-c*(xfe+c*(bfe+c*wfe)),i=e*e,c=0):s=Math.sqrt(c);var f=(i-a)/a;return{es:c,e:s,ep2:f}}function tpe(e,t,n,r,i){if(!e){var a=Uh(Xn,r);a||(a=Qfe),e=a.a,t=a.b,n=a.rf}return n&&!t&&(t=(1-1/n)*e),(n===0||Math.abs(e-t)<Pn)&&(i=!0,t=e),{a:e,b:t,rf:n,sphere:i}}var Jb={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var npe in Jb){var a4=Jb[npe];Jb[a4.datumName]=a4}function rpe(e,t,n,r,i,a,c){var s={};return e===void 0||e==="none"?s.datum_type=PA:s.datum_type=yfe,t&&(s.datum_params=t.map(parseFloat),(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0)&&(s.datum_type=kf),s.datum_params.length>3&&(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0)&&(s.datum_type=Df,s.datum_params[3]*=uy,s.datum_params[4]*=uy,s.datum_params[5]*=uy,s.datum_params[6]=s.datum_params[6]/1e6+1)),c&&(s.datum_type=Qm,s.grids=c),s.a=n,s.b=r,s.es=i,s.ep2=a,s}var mj={};function ipe(e,t){var n=new DataView(t),r=ape(n),i=lpe(n,r),a=cpe(n,i,r),c={header:i,subgrids:a};return mj[e]=c,c}function ope(e){if(e===void 0)return null;var t=e.split(",");return t.map(spe)}function spe(e){if(e.length===0)return null;var t=e[0]==="@";return t&&(e=e.slice(1)),e==="null"?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:mj[e]||null,isNull:!1}}function km(e){return e/3600*Math.PI/180}function ape(e){var t=e.getInt32(8,!1);return t===11?!1:(t=e.getInt32(8,!0),t!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function lpe(e,t){return{nFields:e.getInt32(8,t),nSubgridFields:e.getInt32(24,t),nSubgrids:e.getInt32(40,t),shiftType:IA(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,t),fromSemiMinorAxis:e.getFloat64(136,t),toSemiMajorAxis:e.getFloat64(152,t),toSemiMinorAxis:e.getFloat64(168,t)}}function IA(e,t,n){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,n)))}function cpe(e,t,n){for(var r=176,i=[],a=0;a<t.nSubgrids;a++){var c=hpe(e,r,n),s=dpe(e,r,c,n),f=Math.round(1+(c.upperLongitude-c.lowerLongitude)/c.longitudeInterval),g=Math.round(1+(c.upperLatitude-c.lowerLatitude)/c.latitudeInterval);i.push({ll:[km(c.lowerLongitude),km(c.lowerLatitude)],del:[km(c.longitudeInterval),km(c.latitudeInterval)],lim:[f,g],count:c.gridNodeCount,cvs:upe(s)}),r+=176+c.gridNodeCount*16}return i}function upe(e){return e.map(function(t){return[km(t.longitudeShift),km(t.latitudeShift)]})}function hpe(e,t,n){return{name:IA(e,t+8,t+16).trim(),parent:IA(e,t+24,t+24+8).trim(),lowerLatitude:e.getFloat64(t+72,n),upperLatitude:e.getFloat64(t+88,n),lowerLongitude:e.getFloat64(t+104,n),upperLongitude:e.getFloat64(t+120,n),latitudeInterval:e.getFloat64(t+136,n),longitudeInterval:e.getFloat64(t+152,n),gridNodeCount:e.getInt32(t+168,n)}}function dpe(e,t,n,r){for(var i=t+176,a=16,c=[],s=0;s<n.gridNodeCount;s++){var f={latitudeShift:e.getFloat32(i+s*a,r),longitudeShift:e.getFloat32(i+s*a+4,r),latitudeAccuracy:e.getFloat32(i+s*a+8,r),longitudeAccuracy:e.getFloat32(i+s*a+12,r)};c.push(f)}return c}function pc(e,t){if(!(this instanceof pc))return new pc(e);t=t||function(g){if(g)throw g};var n=Ufe(e);if(typeof n!="object"){t("Could not parse to valid json: "+e);return}var r=pc.projections.get(n.projName);if(!r){t("Could not get projection name from: "+e);return}if(n.datumCode&&n.datumCode!=="none"){var i=Uh(Jb,n.datumCode);i&&(n.datum_params=n.datum_params||(i.towgs84?i.towgs84.split(","):null),n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var a=tpe(n.a,n.b,n.rf,n.ellps,n.sphere),c=epe(a.a,a.b,a.rf,n.R_A),s=ope(n.nadgrids),f=n.datum||rpe(n.datumCode,n.datum_params,a.a,a.b,c.es,c.ep2,s);o4(this,n),o4(this,r),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=c.es,this.e=c.e,this.ep2=c.ep2,this.datum=f,this.init(),t(null,this)}pc.projections=Jfe;pc.projections.start();function fpe(e,t){return e.datum_type!==t.datum_type||e.a!==t.a||Math.abs(e.es-t.es)>5e-11?!1:e.datum_type===kf?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:e.datum_type===Df?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6]:!0}function gj(e,t,n){var r=e.x,i=e.y,a=e.z?e.z:0,c,s,f,g;if(i<-on&&i>-1.001*on)i=-on;else if(i>on&&i<1.001*on)i=on;else{if(i<-on)return{x:-1/0,y:-1/0,z:e.z};if(i>on)return{x:1/0,y:1/0,z:e.z}}return r>Math.PI&&(r-=2*Math.PI),s=Math.sin(i),g=Math.cos(i),f=s*s,c=n/Math.sqrt(1-t*f),{x:(c+a)*g*Math.cos(r),y:(c+a)*g*Math.sin(r),z:(c*(1-t)+a)*s}}function vj(e,t,n,r){var i=1e-12,a=i*i,c=30,s,f,g,_,x,C,E,A,L,I,T,O,D,U=e.x,H=e.y,V=e.z?e.z:0,q,Q,K;if(s=Math.sqrt(U*U+H*H),f=Math.sqrt(U*U+H*H+V*V),s/n<i){if(q=0,f/n<i)return Q=on,K=-r,{x:e.x,y:e.y,z:e.z}}else q=Math.atan2(H,U);g=V/f,_=s/f,x=1/Math.sqrt(1-t*(2-t)*_*_),A=_*(1-t)*x,L=g*x,D=0;do D++,E=n/Math.sqrt(1-t*L*L),K=s*A+V*L-E*(1-t*L*L),C=t*E/(E+K),x=1/Math.sqrt(1-C*(2-C)*_*_),I=_*(1-C)*x,T=g*x,O=T*A-I*L,A=I,L=T;while(O*O>a&&D<c);return Q=Math.atan(T/Math.abs(I)),{x:q,y:Q,z:K}}function ppe(e,t,n){if(t===kf)return{x:e.x+n[0],y:e.y+n[1],z:e.z+n[2]};if(t===Df){var r=n[0],i=n[1],a=n[2],c=n[3],s=n[4],f=n[5],g=n[6];return{x:g*(e.x-f*e.y+s*e.z)+r,y:g*(f*e.x+e.y-c*e.z)+i,z:g*(-s*e.x+c*e.y+e.z)+a}}}function mpe(e,t,n){if(t===kf)return{x:e.x-n[0],y:e.y-n[1],z:e.z-n[2]};if(t===Df){var r=n[0],i=n[1],a=n[2],c=n[3],s=n[4],f=n[5],g=n[6],_=(e.x-r)/g,x=(e.y-i)/g,C=(e.z-a)/g;return{x:_+f*x-s*C,y:-f*_+x+c*C,z:s*_-c*x+C}}}function G1(e){return e===kf||e===Df}function gpe(e,t,n){if(fpe(e,t)||e.datum_type===PA||t.datum_type===PA)return n;var r=e.a,i=e.es;if(e.datum_type===Qm){var a=l4(e,!1,n);if(a!==0)return;r=n4,i=r4}var c=t.a,s=t.b,f=t.es;if(t.datum_type===Qm&&(c=n4,s=_fe,f=r4),i===f&&r===c&&!G1(e.datum_type)&&!G1(t.datum_type))return n;if(n=gj(n,i,r),G1(e.datum_type)&&(n=ppe(n,e.datum_type,e.datum_params)),G1(t.datum_type)&&(n=mpe(n,t.datum_type,t.datum_params)),n=vj(n,f,c,s),t.datum_type===Qm){var g=l4(t,!0,n);if(g!==0)return}return n}function l4(e,t,n){if(e.grids===null||e.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},i={x:Number.NaN,y:Number.NaN},a=[];e:for(var c=0;c<e.grids.length;c++){var s=e.grids[c];if(a.push(s.name),s.isNull){i=r;break}if(s.mandatory,s.grid===null){if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1;continue}for(var f=s.grid.subgrids,g=0,_=f.length;g<_;g++){var x=f[g],C=(Math.abs(x.del[1])+Math.abs(x.del[0]))/1e4,E=x.ll[0]-C,A=x.ll[1]-C,L=x.ll[0]+(x.lim[0]-1)*x.del[0]+C,I=x.ll[1]+(x.lim[1]-1)*x.del[1]+C;if(!(A>r.y||E>r.x||I<r.y||L<r.x)&&(i=vpe(r,t,x),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*ac+" "+r.y*ac+" tried: '"+a+"'"),-1):(n.x=-i.x,n.y=i.y,0)}function vpe(e,t,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return r;var i={x:e.x,y:e.y};i.x-=n.ll[0],i.y-=n.ll[1],i.x=Ln(i.x-Math.PI)+Math.PI;var a=c4(i,n);if(t){if(isNaN(a.x))return r;a.x=i.x-a.x,a.y=i.y-a.y;var c=9,s=1e-12,f,g;do{if(g=c4(a,n),isNaN(g.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}f={x:i.x-(g.x+a.x),y:i.y-(g.y+a.y)},a.x+=f.x,a.y+=f.y}while(c--&&Math.abs(f.x)>s&&Math.abs(f.y)>s);if(c<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=Ln(a.x+n.ll[0]),r.y=a.y+n.ll[1]}else isNaN(a.x)||(r.x=e.x+a.x,r.y=e.y+a.y);return r}function c4(e,t){var n={x:e.x/t.del[0],y:e.y/t.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},i={x:n.x-1*r.x,y:n.y-1*r.y},a={x:Number.NaN,y:Number.NaN},c;if(r.x<0||r.x>=t.lim[0]||r.y<0||r.y>=t.lim[1])return a;c=r.y*t.lim[0]+r.x;var s={x:t.cvs[c][0],y:t.cvs[c][1]};c++;var f={x:t.cvs[c][0],y:t.cvs[c][1]};c+=t.lim[0];var g={x:t.cvs[c][0],y:t.cvs[c][1]};c--;var _={x:t.cvs[c][0],y:t.cvs[c][1]},x=i.x*i.y,C=i.x*(1-i.y),E=(1-i.x)*(1-i.y),A=(1-i.x)*i.y;return a.x=E*s.x+C*f.x+A*_.x+x*g.x,a.y=E*s.y+C*f.y+A*_.y+x*g.y,a}function u4(e,t,n){var r=n.x,i=n.y,a=n.z||0,c,s,f,g={};for(f=0;f<3;f++)if(!(t&&f===2&&n.z===void 0))switch(f===0?(c=r,"ew".indexOf(e.axis[f])!==-1?s="x":s="y"):f===1?(c=i,"ns".indexOf(e.axis[f])!==-1?s="y":s="x"):(c=a,s="z"),e.axis[f]){case"e":g[s]=c;break;case"w":g[s]=-c;break;case"n":g[s]=c;break;case"s":g[s]=-c;break;case"u":n[s]!==void 0&&(g.z=c);break;case"d":n[s]!==void 0&&(g.z=-c);break;default:return null}return g}function yj(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}function ype(e){h4(e.x),h4(e.y)}function h4(e){if(typeof Number.isFinite=="function"){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if(typeof e!="number"||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function _pe(e,t){return(e.datum.datum_type===kf||e.datum.datum_type===Df||e.datum.datum_type===Qm)&&t.datumCode!=="WGS84"||(t.datum.datum_type===kf||t.datum.datum_type===Df||t.datum.datum_type===Qm)&&e.datumCode!=="WGS84"}function sS(e,t,n,r){var i;Array.isArray(n)?n=yj(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var a=n.z!==void 0;if(ype(n),e.datum&&t.datum&&_pe(e,t)&&(i=new pc("WGS84"),n=sS(e,i,n,r),e=i),r&&e.axis!=="enu"&&(n=u4(e,!1,n)),e.projName==="longlat")n={x:n.x*Fo,y:n.y*Fo,z:n.z||0};else if(e.to_meter&&(n={x:n.x*e.to_meter,y:n.y*e.to_meter,z:n.z||0}),n=e.inverse(n),!n)return;if(e.from_greenwich&&(n.x+=e.from_greenwich),n=gpe(e.datum,t.datum,n),!!n)return t.from_greenwich&&(n={x:n.x-t.from_greenwich,y:n.y,z:n.z||0}),t.projName==="longlat"?n={x:n.x*ac,y:n.y*ac,z:n.z||0}:(n=t.forward(n),t.to_meter&&(n={x:n.x/t.to_meter,y:n.y/t.to_meter,z:n.z||0})),r&&t.axis!=="enu"?u4(t,!0,n):(n&&!a&&delete n.z,n)}var d4=pc("WGS84");function PE(e,t,n,r){var i,a,c;return Array.isArray(n)?(i=sS(e,t,n,r)||{x:NaN,y:NaN},n.length>2?typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(n.slice(3)):[i.x,i.y,n[2]].concat(n.slice(3)):[i.x,i.y].concat(n.slice(2)):[i.x,i.y]):(a=sS(e,t,n,r),c=Object.keys(n),c.length===2||c.forEach(function(s){if(typeof e.name<"u"&&e.name==="geocent"||typeof t.name<"u"&&t.name==="geocent"){if(s==="x"||s==="y"||s==="z")return}else if(s==="x"||s==="y")return;a[s]=n[s]}),a)}function f4(e){return e instanceof pc?e:e.oProj?e.oProj:pc(e)}function Ws(e,t,n){e=f4(e);var r=!1,i;return typeof t>"u"?(t=e,e=d4,r=!0):(typeof t.x<"u"||Array.isArray(t))&&(n=t,t=e,e=d4,r=!0),t=f4(t),n?PE(e,t,n):(i={forward:function(a,c){return PE(e,t,a,c)},inverse:function(a,c){return PE(t,e,a,c)}},r&&(i.oProj=t),i)}var p4=6,_j="AJSAJS",xj="AFAFAF",Dm=65,Rs=73,Oa=79,U0=86,$0=90;const xpe={forward:bj,inverse:bpe,toPoint:wj};function bj(e,t){return t=t||5,Mpe(wpe({lat:e[1],lon:e[0]}),t)}function bpe(e){var t=eL(Mj(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]}function wj(e){var t=eL(Mj(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function AE(e){return e*(Math.PI/180)}function m4(e){return 180*(e/Math.PI)}function wpe(e){var t=e.lat,n=e.lon,r=6378137,i=.00669438,a=.9996,c,s,f,g,_,x,C,E=AE(t),A=AE(n),L,I;I=Math.floor((n+180)/6)+1,n===180&&(I=60),t>=56&&t<64&&n>=3&&n<12&&(I=32),t>=72&&t<84&&(n>=0&&n<9?I=31:n>=9&&n<21?I=33:n>=21&&n<33?I=35:n>=33&&n<42&&(I=37)),c=(I-1)*6-180+3,L=AE(c),s=i/(1-i),f=r/Math.sqrt(1-i*Math.sin(E)*Math.sin(E)),g=Math.tan(E)*Math.tan(E),_=s*Math.cos(E)*Math.cos(E),x=Math.cos(E)*(A-L),C=r*((1-i/4-3*i*i/64-5*i*i*i/256)*E-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*E)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*E)-35*i*i*i/3072*Math.sin(6*E));var T=a*f*(x+(1-g+_)*x*x*x/6+(5-18*g+g*g+72*_-58*s)*x*x*x*x*x/120)+5e5,O=a*(C+f*Math.tan(E)*(x*x/2+(5-g+9*_+4*_*_)*x*x*x*x/24+(61-58*g+g*g+600*_-330*s)*x*x*x*x*x*x/720));return t<0&&(O+=1e7),{northing:Math.round(O),easting:Math.round(T),zoneNumber:I,zoneLetter:Spe(t)}}function eL(e){var t=e.northing,n=e.easting,r=e.zoneLetter,i=e.zoneNumber;if(i<0||i>60)return null;var a=.9996,c=6378137,s=.00669438,f,g=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s)),_,x,C,E,A,L,I,T,O,D=n-5e5,U=t;r<"N"&&(U-=1e7),I=(i-1)*6-180+3,f=s/(1-s),L=U/a,T=L/(c*(1-s/4-3*s*s/64-5*s*s*s/256)),O=T+(3*g/2-27*g*g*g/32)*Math.sin(2*T)+(21*g*g/16-55*g*g*g*g/32)*Math.sin(4*T)+151*g*g*g/96*Math.sin(6*T),_=c/Math.sqrt(1-s*Math.sin(O)*Math.sin(O)),x=Math.tan(O)*Math.tan(O),C=f*Math.cos(O)*Math.cos(O),E=c*(1-s)/Math.pow(1-s*Math.sin(O)*Math.sin(O),1.5),A=D/(_*a);var H=O-_*Math.tan(O)/E*(A*A/2-(5+3*x+10*C-4*C*C-9*f)*A*A*A*A/24+(61+90*x+298*C+45*x*x-252*f-3*C*C)*A*A*A*A*A*A/720);H=m4(H);var V=(A-(1+2*x+C)*A*A*A/6+(5-2*C+28*x-3*C*C+8*f+24*x*x)*A*A*A*A*A/120)/Math.cos(O);V=I+m4(V);var q;if(e.accuracy){var Q=eL({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});q={top:Q.lat,right:Q.lon,bottom:H,left:V}}else q={lat:H,lon:V};return q}function Spe(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function Mpe(e,t){var n="00000"+e.easting,r="00000"+e.northing;return e.zoneNumber+e.zoneLetter+Cpe(e.easting,e.northing,e.zoneNumber)+n.substr(n.length-5,t)+r.substr(r.length-5,t)}function Cpe(e,t,n){var r=Sj(n),i=Math.floor(e/1e5),a=Math.floor(t/1e5)%20;return Epe(i,a,r)}function Sj(e){var t=e%p4;return t===0&&(t=p4),t}function Epe(e,t,n){var r=n-1,i=_j.charCodeAt(r),a=xj.charCodeAt(r),c=i+e-1,s=a+t,f=!1;c>$0&&(c=c-$0+Dm-1,f=!0),(c===Rs||i<Rs&&c>Rs||(c>Rs||i<Rs)&&f)&&c++,(c===Oa||i<Oa&&c>Oa||(c>Oa||i<Oa)&&f)&&(c++,c===Rs&&c++),c>$0&&(c=c-$0+Dm-1),s>U0?(s=s-U0+Dm-1,f=!0):f=!1,(s===Rs||a<Rs&&s>Rs||(s>Rs||a<Rs)&&f)&&s++,(s===Oa||a<Oa&&s>Oa||(s>Oa||a<Oa)&&f)&&(s++,s===Rs&&s++),s>U0&&(s=s-U0+Dm-1);var g=String.fromCharCode(c)+String.fromCharCode(s);return g}function Mj(e){if(e&&e.length===0)throw"MGRSPoint coverting from nothing";for(var t=e.length,n=null,r="",i,a=0;!/[A-Z]/.test(i=e.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+e;r+=i,a++}var c=parseInt(r,10);if(a===0||a+3>t)throw"MGRSPoint bad conversion from: "+e;var s=e.charAt(a++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O")throw"MGRSPoint zone letter "+s+" not handled: "+e;n=e.substring(a,a+=2);for(var f=Sj(c),g=Tpe(n.charAt(0),f),_=Ppe(n.charAt(1),f);_<Ape(s);)_+=2e6;var x=t-a;if(x%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+e;var C=x/2,E=0,A=0,L,I,T,O,D;return C>0&&(L=1e5/Math.pow(10,C),I=e.substring(a,a+C),E=parseFloat(I)*L,T=e.substring(a+C),A=parseFloat(T)*L),O=E+g,D=A+_,{easting:O,northing:D,zoneLetter:s,zoneNumber:c,accuracy:L}}function Tpe(e,t){for(var n=_j.charCodeAt(t-1),r=1e5,i=!1;n!==e.charCodeAt(0);){if(n++,n===Rs&&n++,n===Oa&&n++,n>$0){if(i)throw"Bad character: "+e;n=Dm,i=!0}r+=1e5}return r}function Ppe(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var n=xj.charCodeAt(t-1),r=0,i=!1;n!==e.charCodeAt(0);){if(n++,n===Rs&&n++,n===Oa&&n++,n>U0){if(i)throw"Bad character: "+e;n=Dm,i=!0}r+=1e5}return r}function Ape(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function wg(e,t,n){if(!(this instanceof wg))return new wg(e,t,n);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if(typeof e=="object")this.x=e.x,this.y=e.y,this.z=e.z||0;else if(typeof e=="string"&&typeof t>"u"){var r=e.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=e,this.y=t,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}wg.fromMGRS=function(e){return new wg(wj(e))};wg.prototype.toMGRS=function(e){return bj([this.x,this.y],e)};var Ipe=1,Rpe=.25,g4=.046875,v4=.01953125,y4=.01068115234375,Lpe=.75,kpe=.46875,Dpe=.013020833333333334,zpe=.007120768229166667,Ope=.3645833333333333,Fpe=.005696614583333333,Npe=.3076171875;function tL(e){var t=[];t[0]=Ipe-e*(Rpe+e*(g4+e*(v4+e*y4))),t[1]=e*(Lpe-e*(g4+e*(v4+e*y4)));var n=e*e;return t[2]=n*(kpe-e*(Dpe+e*zpe)),n*=e,t[3]=n*(Ope-e*Fpe),t[4]=n*e*Npe,t}function Fg(e,t,n,r){return n*=t,t*=t,r[0]*e-n*(r[1]+t*(r[2]+t*(r[3]+t*r[4])))}var Bpe=20;function nL(e,t,n){for(var r=1/(1-t),i=e,a=Bpe;a;--a){var c=Math.sin(i),s=1-t*c*c;if(s=(Fg(i,c,Math.cos(i),n)-e)*(s*Math.sqrt(s))*r,i-=s,Math.abs(s)<Pn)return i}return i}function Upe(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=tL(this.es),this.ml0=Fg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function $pe(e){var t=e.x,n=e.y,r=Ln(t-this.long0),i,a,c,s=Math.sin(n),f=Math.cos(n);if(this.es){var _=f*r,x=Math.pow(_,2),C=this.ep2*Math.pow(f,2),E=Math.pow(C,2),A=Math.abs(f)>Pn?Math.tan(n):0,L=Math.pow(A,2),I=Math.pow(L,2);i=1-this.es*Math.pow(s,2),_=_/Math.sqrt(i);var T=Fg(n,s,f,this.en);a=this.a*(this.k0*_*(1+x/6*(1-L+C+x/20*(5-18*L+I+14*C-58*L*C+x/42*(61+179*I-I*L-479*L)))))+this.x0,c=this.a*(this.k0*(T-this.ml0+s*r*_/2*(1+x/12*(5-L+9*C+4*E+x/30*(61+I-58*L+270*C-330*L*C+x/56*(1385+543*I-I*L-3111*L))))))+this.y0}else{var g=f*Math.sin(r);if(Math.abs(Math.abs(g)-1)<Pn)return 93;if(a=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0,c=f*Math.cos(r)/Math.sqrt(1-Math.pow(g,2)),g=Math.abs(c),g>=1){if(g-1>Pn)return 93;c=0}else c=Math.acos(c);n<0&&(c=-c),c=this.a*this.k0*(c-this.lat0)+this.y0}return e.x=a,e.y=c,e}function Vpe(e){var t,n,r,i,a=(e.x-this.x0)*(1/this.a),c=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+c/this.k0,n=nL(t,this.es,this.en),Math.abs(n)<on){var x=Math.sin(n),C=Math.cos(n),E=Math.abs(C)>Pn?Math.tan(n):0,A=this.ep2*Math.pow(C,2),L=Math.pow(A,2),I=Math.pow(E,2),T=Math.pow(I,2);t=1-this.es*Math.pow(x,2);var O=a*Math.sqrt(t)/this.k0,D=Math.pow(O,2);t=t*E,r=n-t*D/(1-this.es)*.5*(1-D/12*(5+3*I-9*A*I+A-4*L-D/30*(61+90*I-252*A*I+45*T+46*A-D/56*(1385+3633*I+4095*T+1574*T*I)))),i=Ln(this.long0+O*(1-D/6*(1+2*I+A-D/20*(5+28*I+24*T+8*A*I+6*A-D/42*(61+662*I+1320*T+720*T*I))))/C)}else r=on*q_(c),i=0;else{var s=Math.exp(a/this.k0),f=.5*(s-1/s),g=this.lat0+c/this.k0,_=Math.cos(g);t=Math.sqrt((1-Math.pow(_,2))/(1+Math.pow(f,2))),r=Math.asin(t),c<0&&(r=-r),f===0&&_===0?i=0:i=Ln(Math.atan2(f,_)+this.long0)}return e.x=i,e.y=r,e}var jpe=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const Qb={init:Upe,forward:$pe,inverse:Vpe,names:jpe};function Cj(e){var t=Math.exp(e);return t=(t-1/t)/2,t}function Ds(e,t){e=Math.abs(e),t=Math.abs(t);var n=Math.max(e,t),r=Math.min(e,t)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function Hpe(e){var t=1+e,n=t-1;return n===0?e:e*Math.log(t)/n}function Gpe(e){var t=Math.abs(e);return t=Hpe(t*(1+t/(Ds(1,t)+1))),e<0?-t:t}function rL(e,t){for(var n=2*Math.cos(2*t),r=e.length-1,i=e[r],a=0,c;--r>=0;)c=-a+n*i+e[r],a=i,i=c;return t+c*Math.sin(2*t)}function Wpe(e,t){for(var n=2*Math.cos(t),r=e.length-1,i=e[r],a=0,c;--r>=0;)c=-a+n*i+e[r],a=i,i=c;return Math.sin(t)*c}function qpe(e){var t=Math.exp(e);return t=(t+1/t)/2,t}function Ej(e,t,n){for(var r=Math.sin(t),i=Math.cos(t),a=Cj(n),c=qpe(n),s=2*i*c,f=-2*r*a,g=e.length-1,_=e[g],x=0,C=0,E=0,A,L;--g>=0;)A=C,L=x,C=_,x=E,_=-A+s*C-f*x+e[g],E=-L+f*C+s*x;return s=r*c,f=i*a,[s*_-f*E,s*E+f*_]}function Xpe(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Qb.init.apply(this),this.forward=Qb.forward,this.inverse=Qb.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),n=t;this.cgb[0]=t*(2+t*(-2/3+t*(-2+t*(116/45+t*(26/45+t*(-2854/675)))))),this.cbg[0]=t*(-2+t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))),n=n*t,this.cgb[1]=n*(7/3+t*(-8/5+t*(-227/45+t*(2704/315+t*(2323/945))))),this.cbg[1]=n*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),n=n*t,this.cgb[2]=n*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=n*(-26/15+t*(34/21+t*(8/5+t*(-12686/2835)))),n=n*t,this.cgb[3]=n*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=n*(1237/630+t*(-12/5+t*(-24832/14175))),n=n*t,this.cgb[4]=n*(4174/315+t*(-144838/6237)),this.cbg[4]=n*(-734/315+t*(109598/31185)),n=n*t,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=t*(-.5+t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=n*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=n*(13/48+t*(-3/5+t*(557/1440+t*(281/630+t*(-1983433/1935360))))),n=n*t,this.utg[2]=n*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=n*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),n=n*t,this.utg[3]=n*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=n*(49561/161280+t*(-179/168+t*(6601661/7257600))),n=n*t,this.utg[4]=n*(-4583/161280+t*(108847/3991680)),this.gtu[4]=n*(34729/80640+t*(-3418889/1995840)),n=n*t,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=rL(this.cbg,this.lat0);this.Zb=-this.Qn*(r+Wpe(this.gtu,2*r))}function Zpe(e){var t=Ln(e.x-this.long0),n=e.y;n=rL(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),a=Math.sin(t),c=Math.cos(t);n=Math.atan2(r,c*i),t=Math.atan2(a*i,Ds(r,i*c)),t=Gpe(Math.tan(t));var s=Ej(this.gtu,2*n,2*t);n=n+s[0],t=t+s[1];var f,g;return Math.abs(t)<=2.623395162778?(f=this.a*(this.Qn*t)+this.x0,g=this.a*(this.Qn*n+this.Zb)+this.y0):(f=1/0,g=1/0),e.x=f,e.y=g,e}function Ype(e){var t=(e.x-this.x0)*(1/this.a),n=(e.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,t=t/this.Qn;var r,i;if(Math.abs(t)<=2.623395162778){var a=Ej(this.utg,2*n,2*t);n=n+a[0],t=t+a[1],t=Math.atan(Cj(t));var c=Math.sin(n),s=Math.cos(n),f=Math.sin(t),g=Math.cos(t);n=Math.atan2(c*g,Ds(f,g*s)),t=Math.atan2(f,g*s),r=Ln(t+this.long0),i=rL(this.cgb,n)}else r=1/0,i=1/0;return e.x=r,e.y=i,e}var Kpe=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const ew={init:Xpe,forward:Zpe,inverse:Ype,names:Kpe};function Jpe(e,t){if(e===void 0){if(e=Math.floor((Ln(t)+Math.PI)*30/Math.PI)+1,e<0)return 0;if(e>60)return 60}return e}var Qpe="etmerc";function eme(){var e=Jpe(this.zone,this.long0);if(e===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*Fo,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,ew.init.apply(this),this.forward=ew.forward,this.inverse=ew.inverse}var tme=["Universal Transverse Mercator System","utm"];const nme={init:eme,names:tme,dependsOn:Qpe};function iL(e,t){return Math.pow((1-e)/(1+e),t)}var rme=20;function ime(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+Or)/(Math.pow(Math.tan(.5*this.lat0+Or),this.C)*iL(this.e*e,this.ratexp))}function ome(e){var t=e.x,n=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+Or),this.C)*iL(this.e*Math.sin(n),this.ratexp))-on,e.x=this.C*t,e}function sme(e){for(var t=1e-14,n=e.x/this.C,r=e.y,i=Math.pow(Math.tan(.5*r+Or)/this.K,1/this.C),a=rme;a>0&&(r=2*Math.atan(i*iL(this.e*Math.sin(e.y),-.5*this.e))-on,!(Math.abs(r-e.y)<t));--a)e.y=r;return a?(e.x=n,e.y=r,e):null}var ame=["gauss"];const oL={init:ime,forward:ome,inverse:sme,names:ame};function lme(){oL.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function cme(e){var t,n,r,i;return e.x=Ln(e.x-this.long0),oL.forward.apply(this,[e]),t=Math.sin(e.y),n=Math.cos(e.y),r=Math.cos(e.x),i=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*n*r),e.x=i*n*Math.sin(e.x),e.y=i*(this.cosc0*t-this.sinc0*n*r),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function ume(e){var t,n,r,i,a;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,a=Ds(e.x,e.y)){var c=2*Math.atan2(a,this.R2);t=Math.sin(c),n=Math.cos(c),i=Math.asin(n*this.sinc0+e.y*t*this.cosc0/a),r=Math.atan2(e.x*t,a*this.cosc0*n-e.y*this.sinc0*t)}else i=this.phic0,r=0;return e.x=r,e.y=i,oL.inverse.apply(this,[e]),e.x=Ln(e.x+this.long0),e}var hme=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const dme={init:lme,forward:cme,inverse:ume,names:hme};function fme(e,t,n){return t*=n,Math.tan(.5*(on+e))*Math.pow((1-t)/(1+t),.5*n)}function pme(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Pn&&(this.k0=.5*(1+q_(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Pn&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Pn&&Math.abs(Math.cos(this.lat_ts))>Pn&&(this.k0=.5*this.cons*vc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Al(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=vc(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-on,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function mme(e){var t=e.x,n=e.y,r=Math.sin(n),i=Math.cos(n),a,c,s,f,g,_,x=Ln(t-this.long0);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=Pn&&Math.abs(n+this.lat0)<=Pn?(e.x=NaN,e.y=NaN,e):this.sphere?(a=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(x)),e.x=this.a*a*i*Math.sin(x)+this.x0,e.y=this.a*a*(this.coslat0*r-this.sinlat0*i*Math.cos(x))+this.y0,e):(c=2*Math.atan(this.ssfn_(n,r,this.e))-on,f=Math.cos(c),s=Math.sin(c),Math.abs(this.coslat0)<=Pn?(g=Al(this.e,n*this.con,this.con*r),_=2*this.a*this.k0*g/this.cons,e.x=this.x0+_*Math.sin(t-this.long0),e.y=this.y0-this.con*_*Math.cos(t-this.long0),e):(Math.abs(this.sinlat0)<Pn?(a=2*this.a*this.k0/(1+f*Math.cos(x)),e.y=a*s):(a=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*f*Math.cos(x))),e.y=a*(this.cosX0*s-this.sinX0*f*Math.cos(x))+this.y0),e.x=a*f*Math.sin(x)+this.x0,e))}function gme(e){e.x-=this.x0,e.y-=this.y0;var t,n,r,i,a,c=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var s=2*Math.atan(c/(2*this.a*this.k0));return t=this.long0,n=this.lat0,c<=Pn?(e.x=t,e.y=n,e):(n=Math.asin(Math.cos(s)*this.sinlat0+e.y*Math.sin(s)*this.coslat0/c),Math.abs(this.coslat0)<Pn?this.lat0>0?t=Ln(this.long0+Math.atan2(e.x,-1*e.y)):t=Ln(this.long0+Math.atan2(e.x,e.y)):t=Ln(this.long0+Math.atan2(e.x*Math.sin(s),c*this.coslat0*Math.cos(s)-e.y*this.sinlat0*Math.sin(s))),e.x=t,e.y=n,e)}else if(Math.abs(this.coslat0)<=Pn){if(c<=Pn)return n=this.lat0,t=this.long0,e.x=t,e.y=n,e;e.x*=this.con,e.y*=this.con,r=c*this.cons/(2*this.a*this.k0),n=this.con*s_(this.e,r),t=this.con*Ln(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else i=2*Math.atan(c*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,c<=Pn?a=this.X0:(a=Math.asin(Math.cos(i)*this.sinX0+e.y*Math.sin(i)*this.cosX0/c),t=Ln(this.long0+Math.atan2(e.x*Math.sin(i),c*this.cosX0*Math.cos(i)-e.y*this.sinX0*Math.sin(i)))),n=-1*s_(this.e,Math.tan(.5*(on+a)));return e.x=t,e.y=n,e}var vme=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const yme={init:pme,forward:mme,inverse:gme,names:vme,ssfn_:fme};function _me(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),n=this.a,r=this.rf,i=1/r,a=2*i-Math.pow(i,2),c=this.e=Math.sqrt(a);this.R=this.k0*n*Math.sqrt(1-a)/(1-a*Math.pow(t,2)),this.alpha=Math.sqrt(1+a/(1-a)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),f=Math.log(Math.tan(Math.PI/4+e/2)),g=Math.log((1+c*t)/(1-c*t));this.K=s-this.alpha*f+this.alpha*c/2*g}function xme(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),r=-this.alpha*(t+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),a=this.alpha*(e.x-this.lambda0),c=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(a))),s=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(a));return e.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,e.x=this.R*c+this.x0,e}function bme(e){for(var t=e.x-this.x0,n=e.y-this.y0,r=t/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),c=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),s=this.lambda0+c/this.alpha,f=0,g=a,_=-1e3,x=0;Math.abs(g-_)>1e-7;){if(++x>20)return;f=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(g))/2)),_=g,g=2*Math.atan(Math.exp(f))-Math.PI/2}return e.x=s,e.y=g,e}var wme=["somerc"];const Sme={init:_me,forward:xme,inverse:bme,names:wme};var fm=1e-7;function Mme(e){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof e.PROJECTION=="object"?Object.keys(e.PROJECTION)[0]:e.PROJECTION;return"no_uoff"in e||"no_off"in e||t.indexOf(n)!==-1}function Cme(){var e,t,n,r,i,a,c,s,f,g,_=0,x,C=0,E=0,A=0,L=0,I=0,T=0;this.no_off=Mme(this),this.no_rot="no_rot"in this;var O=!1;"alpha"in this&&(O=!0);var D=!1;if("rectified_grid_angle"in this&&(D=!0),O&&(T=this.alpha),D&&(_=this.rectified_grid_angle*Fo),O||D)C=this.longc;else if(E=this.long1,L=this.lat1,A=this.long2,I=this.lat2,Math.abs(L-I)<=fm||(e=Math.abs(L))<=fm||Math.abs(e-on)<=fm||Math.abs(Math.abs(this.lat0)-on)<=fm||Math.abs(Math.abs(I)-on)<=fm)throw new Error;var U=1-this.es;t=Math.sqrt(U),Math.abs(this.lat0)>Pn?(s=Math.sin(this.lat0),n=Math.cos(this.lat0),e=1-this.es*s*s,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/U),this.A=this.B*this.k0*t/e,r=this.B*t/(n*Math.sqrt(e)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(Al(this.e,this.lat0,s),this.B)):(this.B=1/t,this.A=this.k0,this.E=r=i=1),O||D?(O?(x=Math.asin(Math.sin(T)/r),D||(_=T)):(x=_,T=Math.asin(r*Math.sin(x))),this.lam0=C-Math.asin(.5*(i-1/i)*Math.tan(x))/this.B):(a=Math.pow(Al(this.e,L,Math.sin(L)),this.B),c=Math.pow(Al(this.e,I,Math.sin(I)),this.B),i=this.E/a,f=(c-a)/(c+a),g=this.E*this.E,g=(g-c*a)/(g+c*a),e=E-A,e<-Math.pi?A-=i_:e>Math.pi&&(A+=i_),this.lam0=Ln(.5*(E+A)-Math.atan(g*Math.tan(.5*this.B*(E-A))/f)/this.B),x=Math.atan(2*Math.sin(this.B*Ln(E-this.lam0))/(i-1/i)),_=T=Math.asin(r*Math.sin(x))),this.singam=Math.sin(x),this.cosgam=Math.cos(x),this.sinrot=Math.sin(_),this.cosrot=Math.cos(_),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(T))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*x,this.v_pole_n=this.ArB*Math.log(Math.tan(Or-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(Or+i))}function Eme(e){var t={},n,r,i,a,c,s,f,g;if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-on)>Pn){if(c=this.E/Math.pow(Al(this.e,e.y,Math.sin(e.y)),this.B),s=1/c,n=.5*(c-s),r=.5*(c+s),a=Math.sin(this.B*e.x),i=(n*this.singam-a*this.cosgam)/r,Math.abs(Math.abs(i)-1)<Pn)throw new Error;g=.5*this.ArB*Math.log((1-i)/(1+i)),s=Math.cos(this.B*e.x),Math.abs(s)<fm?f=this.A*e.x:f=this.ArB*Math.atan2(n*this.cosgam+a*this.singam,s)}else g=e.y>0?this.v_pole_n:this.v_pole_s,f=this.ArB*e.y;return this.no_rot?(t.x=f,t.y=g):(f-=this.u_0,t.x=g*this.cosrot+f*this.sinrot,t.y=f*this.cosrot-g*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Tme(e){var t,n,r,i,a,c,s,f={};if(e.x=(e.x-this.x0)*(1/this.a),e.y=(e.y-this.y0)*(1/this.a),this.no_rot?(n=e.y,t=e.x):(n=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),i=.5*(r-1/r),a=.5*(r+1/r),c=Math.sin(this.BrA*t),s=(c*this.cosgam+i*this.singam)/a,Math.abs(Math.abs(s)-1)<Pn)f.x=0,f.y=s<0?-on:on;else{if(f.y=this.E/Math.sqrt((1+s)/(1-s)),f.y=s_(this.e,Math.pow(f.y,1/this.B)),f.y===1/0)throw new Error;f.x=-this.rB*Math.atan2(i*this.cosgam-c*this.singam,Math.cos(this.BrA*t))}return f.x+=this.lam0,f}var Pme=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Ame={init:Cme,forward:Eme,inverse:Tme,names:Pme};function Ime(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Pn)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),n=Math.cos(this.lat1),r=vc(this.e,t,n),i=Al(this.e,this.lat1,t),a=Math.sin(this.lat2),c=Math.cos(this.lat2),s=vc(this.e,a,c),f=Al(this.e,this.lat2,a),g=Al(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Pn?this.ns=Math.log(r/s)/Math.log(i/f):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(g,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Rme(e){var t=e.x,n=e.y;Math.abs(2*Math.abs(n)-Math.PI)<=Pn&&(n=q_(n)*(on-2*Pn));var r=Math.abs(Math.abs(n)-on),i,a;if(r>Pn)i=Al(this.e,n,Math.sin(n)),a=this.a*this.f0*Math.pow(i,this.ns);else{if(r=n*this.ns,r<=0)return null;a=0}var c=this.ns*Ln(t-this.long0);return e.x=this.k0*(a*Math.sin(c))+this.x0,e.y=this.k0*(this.rh-a*Math.cos(c))+this.y0,e}function Lme(e){var t,n,r,i,a,c=(e.x-this.x0)/this.k0,s=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(c*c+s*s),n=1):(t=-Math.sqrt(c*c+s*s),n=-1);var f=0;if(t!==0&&(f=Math.atan2(n*c,n*s)),t!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(t/(this.a*this.f0),n),i=s_(this.e,r),i===-9999)return null}else i=-on;return a=Ln(f/this.ns+this.long0),e.x=a,e.y=i,e}var kme=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const Dme={init:Ime,forward:Rme,inverse:Lme,names:kme};function zme(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Ome(e){var t,n,r,i,a,c,s,f=e.x,g=e.y,_=Ln(f-this.long0);return t=Math.pow((1+this.e*Math.sin(g))/(1-this.e*Math.sin(g)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(g/2+this.s45),this.alfa)/t)-this.s45),r=-_*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),a=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),c=this.n*a,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),e.y=s*Math.cos(c)/1,e.x=s*Math.sin(c)/1,this.czech||(e.y*=-1,e.x*=-1),e}function Fme(e){var t,n,r,i,a,c,s,f,g=e.x;e.x=e.y,e.y=g,this.czech||(e.y*=-1,e.x*=-1),c=Math.sqrt(e.x*e.x+e.y*e.y),a=Math.atan2(e.y,e.x),i=a/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/c,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(t)),e.x=this.long0-n/this.alfa,s=t,f=0;var _=0;do e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-e.y)<1e-10&&(f=1),s=e.y,_+=1;while(f===0&&_<15);return _>=15?null:e}var Nme=["Krovak","krovak"];const Bme={init:zme,forward:Ome,inverse:Fme,names:Nme};function ys(e,t,n,r,i){return e*i-t*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)}function X_(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function Z_(e){return .375*e*(1+.25*e*(1+.46875*e))}function Y_(e){return .05859375*e*e*(1+.75*e)}function K_(e){return e*e*e*(35/3072)}function Sg(e,t,n){var r=t*n;return e/Math.sqrt(1-r*r)}function td(e){return Math.abs(e)<on?e:e-q_(e)*Math.PI}function aS(e,t,n,r,i){var a,c;a=e/t;for(var s=0;s<15;s++)if(c=(e-(t*a-n*Math.sin(2*a)+r*Math.sin(4*a)-i*Math.sin(6*a)))/(t-2*n*Math.cos(2*a)+4*r*Math.cos(4*a)-6*i*Math.cos(6*a)),a+=c,Math.abs(c)<=1e-10)return a;return NaN}function Ume(){this.sphere||(this.e0=X_(this.es),this.e1=Z_(this.es),this.e2=Y_(this.es),this.e3=K_(this.es),this.ml0=this.a*ys(this.e0,this.e1,this.e2,this.e3,this.lat0))}function $me(e){var t,n,r=e.x,i=e.y;if(r=Ln(r-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var a=Math.sin(i),c=Math.cos(i),s=Sg(this.a,this.e,a),f=Math.tan(i)*Math.tan(i),g=r*Math.cos(i),_=g*g,x=this.es*c*c/(1-this.es),C=this.a*ys(this.e0,this.e1,this.e2,this.e3,i);t=s*g*(1-_*f*(1/6-(8-f+8*x)*_/120)),n=C-this.ml0+s*a/c*_*(.5+(5-f+6*x)*_/24)}return e.x=t+this.x0,e.y=n+this.y0,e}function Vme(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,n=e.y/this.a,r,i;if(this.sphere){var a=n+this.lat0;r=Math.asin(Math.sin(a)*Math.cos(t)),i=Math.atan2(Math.tan(t),Math.cos(a))}else{var c=this.ml0/this.a+n,s=aS(c,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-on)<=Pn)return e.x=this.long0,e.y=on,n<0&&(e.y*=-1),e;var f=Sg(this.a,this.e,Math.sin(s)),g=f*f*f/this.a/this.a*(1-this.es),_=Math.pow(Math.tan(s),2),x=t*this.a/f,C=x*x;r=s-f*Math.tan(s)/g*x*x*(.5-(1+3*_)*x*x/24),i=x*(1-C*(_/3+(1+3*_)*_*C/15))/Math.cos(s)}return e.x=Ln(i+this.long0),e.y=td(r),e}var jme=["Cassini","Cassini_Soldner","cass"];const Hme={init:Ume,forward:$me,inverse:Vme,names:jme};function Th(e,t){var n;return e>1e-7?(n=e*t,(1-e*e)*(t/(1-n*n)-.5/e*Math.log((1-n)/(1+n)))):2*t}var Gme=1,Wme=2,qme=3,Xme=4;function Zme(){var e=Math.abs(this.lat0);if(Math.abs(e-on)<Pn?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<Pn?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var t;switch(this.qp=Th(this.e,1),this.mmf=.5/(1-this.es),this.apa=ige(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Th(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function Yme(e){var t,n,r,i,a,c,s,f,g,_,x=e.x,C=e.y;if(x=Ln(x-this.long0),this.sphere){if(a=Math.sin(C),_=Math.cos(C),r=Math.cos(x),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+_*r:1+this.sinph0*a+this.cosph0*_*r,n<=Pn)return null;n=Math.sqrt(2/n),t=n*_*Math.sin(x),n*=this.mode===this.EQUIT?a:this.cosph0*a-this.sinph0*_*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(C+this.lat0)<Pn)return null;n=Or-C*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),t=n*Math.sin(x),n*=r}}else{switch(s=0,f=0,g=0,r=Math.cos(x),i=Math.sin(x),a=Math.sin(C),c=Th(this.e,a),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(s=c/this.qp,f=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:g=1+this.sinb1*s+this.cosb1*f*r;break;case this.EQUIT:g=1+f*r;break;case this.N_POLE:g=on+C,c=this.qp-c;break;case this.S_POLE:g=C-on,c=this.qp+c;break}if(Math.abs(g)<Pn)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:g=Math.sqrt(2/g),this.mode===this.OBLIQ?n=this.ymf*g*(this.cosb1*s-this.sinb1*f*r):n=(g=Math.sqrt(2/(1+f*r)))*s*this.ymf,t=this.xmf*g*f*i;break;case this.N_POLE:case this.S_POLE:c>=0?(t=(g=Math.sqrt(c))*i,n=r*(this.mode===this.S_POLE?g:-g)):t=n=0;break}}return e.x=this.a*t+this.x0,e.y=this.a*n+this.y0,e}function Kme(e){e.x-=this.x0,e.y-=this.y0;var t=e.x/this.a,n=e.y/this.a,r,i,a,c,s,f,g;if(this.sphere){var _=0,x,C=0;if(x=Math.sqrt(t*t+n*n),i=x*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(C=Math.sin(i),_=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(x)<=Pn?0:Math.asin(n*C/x),t*=C,n=_*x;break;case this.OBLIQ:i=Math.abs(x)<=Pn?this.lat0:Math.asin(_*this.sinph0+n*C*this.cosph0/x),t*=C*this.cosph0,n=(_-Math.sin(i)*this.sinph0)*x;break;case this.N_POLE:n=-n,i=on-i;break;case this.S_POLE:i-=on;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(t,n)}else{if(g=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,n*=this.dd,f=Math.sqrt(t*t+n*n),f<Pn)return e.x=this.long0,e.y=this.lat0,e;c=2*Math.asin(.5*f/this.rq),a=Math.cos(c),t*=c=Math.sin(c),this.mode===this.OBLIQ?(g=a*this.sinb1+n*c*this.cosb1/f,s=this.qp*g,n=f*this.cosb1*a-n*this.sinb1*c):(g=n*c/f,s=this.qp*g,n=f*a)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),s=t*t+n*n,!s)return e.x=this.long0,e.y=this.lat0,e;g=1-s/this.qp,this.mode===this.S_POLE&&(g=-g)}r=Math.atan2(t,n),i=oge(Math.asin(g),this.apa)}return e.x=Ln(this.long0+r),e.y=i,e}var Jme=.3333333333333333,Qme=.17222222222222222,ege=.10257936507936508,tge=.06388888888888888,nge=.0664021164021164,rge=.016415012942191543;function ige(e){var t,n=[];return n[0]=e*Jme,t=e*e,n[0]+=t*Qme,n[1]=t*tge,t*=e,n[0]+=t*ege,n[1]+=t*nge,n[2]=t*rge,n}function oge(e,t){var n=e+e;return e+t[0]*Math.sin(n)+t[1]*Math.sin(n+n)+t[2]*Math.sin(n+n+n)}var sge=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const age={init:Zme,forward:Yme,inverse:Kme,names:sge,S_POLE:Gme,N_POLE:Wme,EQUIT:qme,OBLIQ:Xme};function $h(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}function lge(){Math.abs(this.lat1+this.lat2)<Pn||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=vc(this.e3,this.sin_po,this.cos_po),this.qs1=Th(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=vc(this.e3,this.sin_po,this.cos_po),this.qs2=Th(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Th(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Pn?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function cge(e){var t=e.x,n=e.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Th(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,a=this.ns0*Ln(t-this.long0),c=i*Math.sin(a)+this.x0,s=this.rh-i*Math.cos(a)+this.y0;return e.x=c,e.y=s,e}function uge(e){var t,n,r,i,a,c;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),r=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),r=-1),i=0,t!==0&&(i=Math.atan2(r*e.x,r*e.y)),r=t*this.ns0/this.a,this.sphere?c=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,c=this.phi1z(this.e3,n)),a=Ln(i/this.ns0+this.long0),e.x=a,e.y=c,e}function hge(e,t){var n,r,i,a,c,s=$h(.5*t);if(e<Pn)return s;for(var f=e*e,g=1;g<=25;g++)if(n=Math.sin(s),r=Math.cos(s),i=e*n,a=1-i*i,c=.5*a*a/r*(t/(1-f)-n/a+.5/e*Math.log((1-i)/(1+i))),s=s+c,Math.abs(c)<=1e-7)return s;return null}var dge=["Albers_Conic_Equal_Area","Albers","aea"];const fge={init:lge,forward:cge,inverse:uge,names:dge,phi1z:hge};function pge(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function mge(e){var t,n,r,i,a,c,s,f,g=e.x,_=e.y;return r=Ln(g-this.long0),t=Math.sin(_),n=Math.cos(_),i=Math.cos(r),c=this.sin_p14*t+this.cos_p14*n*i,a=1,c>0||Math.abs(c)<=Pn?(s=this.x0+this.a*a*n*Math.sin(r)/c,f=this.y0+this.a*a*(this.cos_p14*t-this.sin_p14*n*i)/c):(s=this.x0+this.infinity_dist*n*Math.sin(r),f=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*n*i)),e.x=s,e.y=f,e}function gge(e){var t,n,r,i,a,c;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(i=Math.atan2(t,this.rc),n=Math.sin(i),r=Math.cos(i),c=$h(r*this.sin_p14+e.y*n*this.cos_p14/t),a=Math.atan2(e.x*n,t*this.cos_p14*r-e.y*this.sin_p14*n),a=Ln(this.long0+a)):(c=this.phic0,a=0),e.x=a,e.y=c,e}var vge=["gnom"];const yge={init:pge,forward:mge,inverse:gge,names:vge};function _ge(e,t){var n=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-n)<1e-6)return t<0?-1*on:on;for(var r=Math.asin(.5*t),i,a,c,s,f=0;f<30;f++)if(a=Math.sin(r),c=Math.cos(r),s=e*a,i=Math.pow(1-s*s,2)/(2*c)*(t/(1-e*e)-a/(1-s*s)+.5/e*Math.log((1-s)/(1+s))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function xge(){this.sphere||(this.k0=vc(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function bge(e){var t=e.x,n=e.y,r,i,a=Ln(t-this.long0);if(this.sphere)r=this.x0+this.a*a*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var c=Th(this.e,Math.sin(n));r=this.x0+this.a*this.k0*a,i=this.y0+this.a*c*.5/this.k0}return e.x=r,e.y=i,e}function wge(e){e.x-=this.x0,e.y-=this.y0;var t,n;return this.sphere?(t=Ln(this.long0+e.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(n=_ge(this.e,2*e.y*this.k0/this.a),t=Ln(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=n,e}var Sge=["cea"];const Mge={init:xge,forward:bge,inverse:wge,names:Sge};function Cge(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Ege(e){var t=e.x,n=e.y,r=Ln(t-this.long0),i=td(n-this.lat0);return e.x=this.x0+this.a*r*this.rc,e.y=this.y0+this.a*i,e}function Tge(e){var t=e.x,n=e.y;return e.x=Ln(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=td(this.lat0+(n-this.y0)/this.a),e}var Pge=["Equirectangular","Equidistant_Cylindrical","eqc"];const Age={init:Cge,forward:Ege,inverse:Tge,names:Pge};var _4=20;function Ige(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=X_(this.es),this.e1=Z_(this.es),this.e2=Y_(this.es),this.e3=K_(this.es),this.ml0=this.a*ys(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Rge(e){var t=e.x,n=e.y,r,i,a,c=Ln(t-this.long0);if(a=c*Math.sin(n),this.sphere)Math.abs(n)<=Pn?(r=this.a*c,i=-1*this.a*this.lat0):(r=this.a*Math.sin(a)/Math.tan(n),i=this.a*(td(n-this.lat0)+(1-Math.cos(a))/Math.tan(n)));else if(Math.abs(n)<=Pn)r=this.a*c,i=-1*this.ml0;else{var s=Sg(this.a,this.e,Math.sin(n))/Math.tan(n);r=s*Math.sin(a),i=this.a*ys(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+s*(1-Math.cos(a))}return e.x=r+this.x0,e.y=i+this.y0,e}function Lge(e){var t,n,r,i,a,c,s,f,g;if(r=e.x-this.x0,i=e.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=Pn)t=Ln(r/this.a+this.long0),n=0;else{c=this.lat0+i/this.a,s=r*r/this.a/this.a+c*c,f=c;var _;for(a=_4;a;--a)if(_=Math.tan(f),g=-1*(c*(f*_+1)-f-.5*(f*f+s)*_)/((f-c)/_-1),f+=g,Math.abs(g)<=Pn){n=f;break}t=Ln(this.long0+Math.asin(r*Math.tan(f)/this.a)/Math.sin(n))}else if(Math.abs(i+this.ml0)<=Pn)n=0,t=Ln(this.long0+r/this.a);else{c=(this.ml0+i)/this.a,s=r*r/this.a/this.a+c*c,f=c;var x,C,E,A,L;for(a=_4;a;--a)if(L=this.e*Math.sin(f),x=Math.sqrt(1-L*L)*Math.tan(f),C=this.a*ys(this.e0,this.e1,this.e2,this.e3,f),E=this.e0-2*this.e1*Math.cos(2*f)+4*this.e2*Math.cos(4*f)-6*this.e3*Math.cos(6*f),A=C/this.a,g=(c*(x*A+1)-A-.5*x*(A*A+s))/(this.es*Math.sin(2*f)*(A*A+s-2*c*A)/(4*x)+(c-A)*(x*E-2/Math.sin(2*f))-E),f-=g,Math.abs(g)<=Pn){n=f;break}x=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),t=Ln(this.long0+Math.asin(r*x/this.a)/Math.sin(n))}return e.x=t,e.y=n,e}var kge=["Polyconic","poly"];const Dge={init:Ige,forward:Rge,inverse:Lge,names:kge};function zge(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Oge(e){var t,n=e.x,r=e.y,i=r-this.lat0,a=n-this.long0,c=i/uy*1e-5,s=a,f=1,g=0;for(t=1;t<=10;t++)f=f*c,g=g+this.A[t]*f;var _=g,x=s,C=1,E=0,A,L,I=0,T=0;for(t=1;t<=6;t++)A=C*_-E*x,L=E*_+C*x,C=A,E=L,I=I+this.B_re[t]*C-this.B_im[t]*E,T=T+this.B_im[t]*C+this.B_re[t]*E;return e.x=T*this.a+this.x0,e.y=I*this.a+this.y0,e}function Fge(e){var t,n=e.x,r=e.y,i=n-this.x0,a=r-this.y0,c=a/this.a,s=i/this.a,f=1,g=0,_,x,C=0,E=0;for(t=1;t<=6;t++)_=f*c-g*s,x=g*c+f*s,f=_,g=x,C=C+this.C_re[t]*f-this.C_im[t]*g,E=E+this.C_im[t]*f+this.C_re[t]*g;for(var A=0;A<this.iterations;A++){var L=C,I=E,T,O,D=c,U=s;for(t=2;t<=6;t++)T=L*C-I*E,O=I*C+L*E,L=T,I=O,D=D+(t-1)*(this.B_re[t]*L-this.B_im[t]*I),U=U+(t-1)*(this.B_im[t]*L+this.B_re[t]*I);L=1,I=0;var H=this.B_re[1],V=this.B_im[1];for(t=2;t<=6;t++)T=L*C-I*E,O=I*C+L*E,L=T,I=O,H=H+t*(this.B_re[t]*L-this.B_im[t]*I),V=V+t*(this.B_im[t]*L+this.B_re[t]*I);var q=H*H+V*V;C=(D*H+U*V)/q,E=(U*H-D*V)/q}var Q=C,K=E,N=1,re=0;for(t=1;t<=9;t++)N=N*Q,re=re+this.D[t]*N;var ye=this.lat0+re*uy*1e5,ge=this.long0+K;return e.x=ge,e.y=ye,e}var Nge=["New_Zealand_Map_Grid","nzmg"];const Bge={init:zge,forward:Oge,inverse:Fge,names:Nge};function Uge(){}function $ge(e){var t=e.x,n=e.y,r=Ln(t-this.long0),i=this.x0+this.a*r,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return e.x=i,e.y=a,e}function Vge(e){e.x-=this.x0,e.y-=this.y0;var t=Ln(this.long0+e.x/this.a),n=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=n,e}var jge=["Miller_Cylindrical","mill"];const Hge={init:Uge,forward:$ge,inverse:Vge,names:jge};var Gge=20;function Wge(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=tL(this.es)}function qge(e){var t,n,r=e.x,i=e.y;if(r=Ln(r-this.long0),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var a=this.n*Math.sin(i),c=Gge;c;--c){var s=(this.m*i+Math.sin(i)-a)/(this.m+Math.cos(i));if(i-=s,Math.abs(s)<Pn)break}t=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var f=Math.sin(i),g=Math.cos(i);n=this.a*Fg(i,f,g,this.en),t=this.a*r*g/Math.sqrt(1-this.es*f*f)}return e.x=t,e.y=n,e}function Xge(e){var t,n,r,i;return e.x-=this.x0,r=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(t))),this.m?t=$h((this.m*t+Math.sin(t))/this.n):this.n!==1&&(t=$h(Math.sin(t)/this.n)),r=Ln(r+this.long0),t=td(t)):(t=nL(e.y/this.a,this.es,this.en),i=Math.abs(t),i<on?(i=Math.sin(t),n=this.long0+e.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(t)),r=Ln(n)):i-Pn<on&&(r=this.long0)),e.x=r,e.y=t,e}var Zge=["Sinusoidal","sinu"];const Yge={init:Wge,forward:qge,inverse:Xge,names:Zge};function Kge(){}function Jge(e){for(var t=e.x,n=e.y,r=Ln(t-this.long0),i=n,a=Math.PI*Math.sin(n);;){var c=-(i+Math.sin(i)-a)/(1+Math.cos(i));if(i+=c,Math.abs(c)<Pn)break}i/=2,Math.PI/2-Math.abs(n)<Pn&&(r=0);var s=.900316316158*this.a*r*Math.cos(i)+this.x0,f=1.4142135623731*this.a*Math.sin(i)+this.y0;return e.x=s,e.y=f,e}function Qge(e){var t,n;e.x-=this.x0,e.y-=this.y0,n=e.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),t=Math.asin(n);var r=Ln(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*t+Math.sin(2*t))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return e.x=r,e.y=i,e}var eve=["Mollweide","moll"];const tve={init:Kge,forward:Jge,inverse:Qge,names:eve};function nve(){Math.abs(this.lat1+this.lat2)<Pn||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=X_(this.es),this.e1=Z_(this.es),this.e2=Y_(this.es),this.e3=K_(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=vc(this.e,this.sinphi,this.cosphi),this.ml1=ys(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Pn?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=vc(this.e,this.sinphi,this.cosphi),this.ml2=ys(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=ys(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function rve(e){var t=e.x,n=e.y,r;if(this.sphere)r=this.a*(this.g-n);else{var i=ys(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-i)}var a=this.ns*Ln(t-this.long0),c=this.x0+r*Math.sin(a),s=this.y0+this.rh-r*Math.cos(a);return e.x=c,e.y=s,e}function ive(e){e.x-=this.x0,e.y=this.rh-e.y+this.y0;var t,n,r,i;this.ns>=0?(n=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(n=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var a=0;if(n!==0&&(a=Math.atan2(t*e.x,t*e.y)),this.sphere)return i=Ln(this.long0+a/this.ns),r=td(this.g-n/this.a),e.x=i,e.y=r,e;var c=this.g-n/this.a;return r=aS(c,this.e0,this.e1,this.e2,this.e3),i=Ln(this.long0+a/this.ns),e.x=i,e.y=r,e}var ove=["Equidistant_Conic","eqdc"];const sve={init:nve,forward:rve,inverse:ive,names:ove};function ave(){this.R=this.a}function lve(e){var t=e.x,n=e.y,r=Ln(t-this.long0),i,a;Math.abs(n)<=Pn&&(i=this.x0+this.R*r,a=this.y0);var c=$h(2*Math.abs(n/Math.PI));(Math.abs(r)<=Pn||Math.abs(Math.abs(n)-on)<=Pn)&&(i=this.x0,n>=0?a=this.y0+Math.PI*this.R*Math.tan(.5*c):a=this.y0+Math.PI*this.R*-Math.tan(.5*c));var s=.5*Math.abs(Math.PI/r-r/Math.PI),f=s*s,g=Math.sin(c),_=Math.cos(c),x=_/(g+_-1),C=x*x,E=x*(2/g-1),A=E*E,L=Math.PI*this.R*(s*(x-A)+Math.sqrt(f*(x-A)*(x-A)-(A+f)*(C-A)))/(A+f);r<0&&(L=-L),i=this.x0+L;var I=f+x;return L=Math.PI*this.R*(E*I-s*Math.sqrt((A+f)*(f+1)-I*I))/(A+f),n>=0?a=this.y0+L:a=this.y0-L,e.x=i,e.y=a,e}function cve(e){var t,n,r,i,a,c,s,f,g,_,x,C,E;return e.x-=this.x0,e.y-=this.y0,x=Math.PI*this.R,r=e.x/x,i=e.y/x,a=r*r+i*i,c=-Math.abs(i)*(1+a),s=c-2*i*i+r*r,f=-2*c+1+2*i*i+a*a,E=i*i/f+(2*s*s*s/f/f/f-9*c*s/f/f)/27,g=(c-s*s/3/f)/f,_=2*Math.sqrt(-g/3),x=3*E/g/_,Math.abs(x)>1&&(x>=0?x=1:x=-1),C=Math.acos(x)/3,e.y>=0?n=(-_*Math.cos(C+Math.PI/3)-s/3/f)*Math.PI:n=-(-_*Math.cos(C+Math.PI/3)-s/3/f)*Math.PI,Math.abs(r)<Pn?t=this.long0:t=Ln(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(r*r-i*i)+a*a))/2/r),e.x=t,e.y=n,e}var uve=["Van_der_Grinten_I","VanDerGrinten","vandg"];const hve={init:ave,forward:lve,inverse:cve,names:uve};function dve(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function fve(e){var t=e.x,n=e.y,r=Math.sin(e.y),i=Math.cos(e.y),a=Ln(t-this.long0),c,s,f,g,_,x,C,E,A,L,I,T,O,D,U,H,V,q,Q,K,N,re,ye;return this.sphere?Math.abs(this.sin_p12-1)<=Pn?(e.x=this.x0+this.a*(on-n)*Math.sin(a),e.y=this.y0-this.a*(on-n)*Math.cos(a),e):Math.abs(this.sin_p12+1)<=Pn?(e.x=this.x0+this.a*(on+n)*Math.sin(a),e.y=this.y0+this.a*(on+n)*Math.cos(a),e):(q=this.sin_p12*r+this.cos_p12*i*Math.cos(a),H=Math.acos(q),V=H?H/Math.sin(H):1,e.x=this.x0+this.a*V*i*Math.sin(a),e.y=this.y0+this.a*V*(this.cos_p12*r-this.sin_p12*i*Math.cos(a)),e):(c=X_(this.es),s=Z_(this.es),f=Y_(this.es),g=K_(this.es),Math.abs(this.sin_p12-1)<=Pn?(_=this.a*ys(c,s,f,g,on),x=this.a*ys(c,s,f,g,n),e.x=this.x0+(_-x)*Math.sin(a),e.y=this.y0-(_-x)*Math.cos(a),e):Math.abs(this.sin_p12+1)<=Pn?(_=this.a*ys(c,s,f,g,on),x=this.a*ys(c,s,f,g,n),e.x=this.x0+(_+x)*Math.sin(a),e.y=this.y0+(_+x)*Math.cos(a),e):(C=r/i,E=Sg(this.a,this.e,this.sin_p12),A=Sg(this.a,this.e,r),L=Math.atan((1-this.es)*C+this.es*E*this.sin_p12/(A*i)),I=Math.atan2(Math.sin(a),this.cos_p12*Math.tan(L)-this.sin_p12*Math.cos(a)),I===0?Q=Math.asin(this.cos_p12*Math.sin(L)-this.sin_p12*Math.cos(L)):Math.abs(Math.abs(I)-Math.PI)<=Pn?Q=-Math.asin(this.cos_p12*Math.sin(L)-this.sin_p12*Math.cos(L)):Q=Math.asin(Math.sin(a)*Math.cos(L)/Math.sin(I)),T=this.e*this.sin_p12/Math.sqrt(1-this.es),O=this.e*this.cos_p12*Math.cos(I)/Math.sqrt(1-this.es),D=T*O,U=O*O,K=Q*Q,N=K*Q,re=N*Q,ye=re*Q,H=E*Q*(1-K*U*(1-U)/6+N/8*D*(1-2*U)+re/120*(U*(4-7*U)-3*T*T*(1-7*U))-ye/48*D),e.x=this.x0+H*Math.sin(I),e.y=this.y0+H*Math.cos(I),e))}function pve(e){e.x-=this.x0,e.y-=this.y0;var t,n,r,i,a,c,s,f,g,_,x,C,E,A,L,I,T,O,D,U,H,V,q,Q;return this.sphere?(t=Math.sqrt(e.x*e.x+e.y*e.y),t>2*on*this.a?void 0:(n=t/this.a,r=Math.sin(n),i=Math.cos(n),a=this.long0,Math.abs(t)<=Pn?c=this.lat0:(c=$h(i*this.sin_p12+e.y*r*this.cos_p12/t),s=Math.abs(this.lat0)-on,Math.abs(s)<=Pn?this.lat0>=0?a=Ln(this.long0+Math.atan2(e.x,-e.y)):a=Ln(this.long0-Math.atan2(-e.x,e.y)):a=Ln(this.long0+Math.atan2(e.x*r,t*this.cos_p12*i-e.y*this.sin_p12*r))),e.x=a,e.y=c,e)):(f=X_(this.es),g=Z_(this.es),_=Y_(this.es),x=K_(this.es),Math.abs(this.sin_p12-1)<=Pn?(C=this.a*ys(f,g,_,x,on),t=Math.sqrt(e.x*e.x+e.y*e.y),E=C-t,c=aS(E/this.a,f,g,_,x),a=Ln(this.long0+Math.atan2(e.x,-1*e.y)),e.x=a,e.y=c,e):Math.abs(this.sin_p12+1)<=Pn?(C=this.a*ys(f,g,_,x,on),t=Math.sqrt(e.x*e.x+e.y*e.y),E=t-C,c=aS(E/this.a,f,g,_,x),a=Ln(this.long0+Math.atan2(e.x,e.y)),e.x=a,e.y=c,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),I=Math.atan2(e.x,e.y),A=Sg(this.a,this.e,this.sin_p12),T=Math.cos(I),O=this.e*this.cos_p12*T,D=-O*O/(1-this.es),U=3*this.es*(1-D)*this.sin_p12*this.cos_p12*T/(1-this.es),H=t/A,V=H-D*(1+D)*Math.pow(H,3)/6-U*(1+3*D)*Math.pow(H,4)/24,q=1-D*V*V/2-H*V*V*V/6,L=Math.asin(this.sin_p12*Math.cos(V)+this.cos_p12*Math.sin(V)*T),a=Ln(this.long0+Math.asin(Math.sin(I)*Math.sin(V)/Math.cos(L))),Q=Math.sin(L),c=Math.atan2((Q-this.es*q*this.sin_p12)*Math.tan(L),Q*(1-this.es)),e.x=a,e.y=c,e))}var mve=["Azimuthal_Equidistant","aeqd"];const gve={init:dve,forward:fve,inverse:pve,names:mve};function vve(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function yve(e){var t,n,r,i,a,c,s,f,g=e.x,_=e.y;return r=Ln(g-this.long0),t=Math.sin(_),n=Math.cos(_),i=Math.cos(r),c=this.sin_p14*t+this.cos_p14*n*i,a=1,(c>0||Math.abs(c)<=Pn)&&(s=this.a*a*n*Math.sin(r),f=this.y0+this.a*a*(this.cos_p14*t-this.sin_p14*n*i)),e.x=s,e.y=f,e}function _ve(e){var t,n,r,i,a,c,s;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),n=$h(t/this.a),r=Math.sin(n),i=Math.cos(n),c=this.long0,Math.abs(t)<=Pn?(s=this.lat0,e.x=c,e.y=s,e):(s=$h(i*this.sin_p14+e.y*r*this.cos_p14/t),a=Math.abs(this.lat0)-on,Math.abs(a)<=Pn?(this.lat0>=0?c=Ln(this.long0+Math.atan2(e.x,-e.y)):c=Ln(this.long0-Math.atan2(-e.x,e.y)),e.x=c,e.y=s,e):(c=Ln(this.long0+Math.atan2(e.x*r,t*this.cos_p14*i-e.y*this.sin_p14*r)),e.x=c,e.y=s,e))}var xve=["ortho"];const bve={init:vve,forward:yve,inverse:_ve,names:xve};var gi={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Fr={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function wve(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=on-Or/2?this.face=gi.TOP:this.lat0<=-(on-Or/2)?this.face=gi.BOTTOM:Math.abs(this.long0)<=Or?this.face=gi.FRONT:Math.abs(this.long0)<=on+Or?this.face=this.long0>0?gi.RIGHT:gi.LEFT:this.face=gi.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function Sve(e){var t={x:0,y:0},n,r,i,a,c,s,f={value:0};if(e.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(e.y)):n=e.y,r=e.x,this.face===gi.TOP)a=on-n,r>=Or&&r<=on+Or?(f.value=Fr.AREA_0,i=r-on):r>on+Or||r<=-(on+Or)?(f.value=Fr.AREA_1,i=r>0?r-Di:r+Di):r>-(on+Or)&&r<=-Or?(f.value=Fr.AREA_2,i=r+on):(f.value=Fr.AREA_3,i=r);else if(this.face===gi.BOTTOM)a=on+n,r>=Or&&r<=on+Or?(f.value=Fr.AREA_0,i=-r+on):r<Or&&r>=-Or?(f.value=Fr.AREA_1,i=-r):r<-Or&&r>=-(on+Or)?(f.value=Fr.AREA_2,i=-r-on):(f.value=Fr.AREA_3,i=r>0?-r+Di:-r-Di);else{var g,_,x,C,E,A,L;this.face===gi.RIGHT?r=eg(r,+on):this.face===gi.BACK?r=eg(r,+Di):this.face===gi.LEFT&&(r=eg(r,-on)),C=Math.sin(n),E=Math.cos(n),A=Math.sin(r),L=Math.cos(r),g=E*L,_=E*A,x=C,this.face===gi.FRONT?(a=Math.acos(g),i=W1(a,x,_,f)):this.face===gi.RIGHT?(a=Math.acos(_),i=W1(a,x,-g,f)):this.face===gi.BACK?(a=Math.acos(-g),i=W1(a,x,-_,f)):this.face===gi.LEFT?(a=Math.acos(-_),i=W1(a,x,g,f)):(a=i=0,f.value=Fr.AREA_0)}return s=Math.atan(12/Di*(i+Math.acos(Math.sin(i)*Math.cos(Or))-on)),c=Math.sqrt((1-Math.cos(a))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(i))))),f.value===Fr.AREA_1?s+=on:f.value===Fr.AREA_2?s+=Di:f.value===Fr.AREA_3&&(s+=1.5*Di),t.x=c*Math.cos(s),t.y=c*Math.sin(s),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,e.x=t.x,e.y=t.y,e}function Mve(e){var t={lam:0,phi:0},n,r,i,a,c,s,f,g,_,x={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,r=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),n=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?x.value=Fr.AREA_0:e.y>=0&&e.y>=Math.abs(e.x)?(x.value=Fr.AREA_1,n-=on):e.x<0&&-e.x>=Math.abs(e.y)?(x.value=Fr.AREA_2,n=n<0?n+Di:n-Di):(x.value=Fr.AREA_3,n+=on),_=Di/12*Math.tan(n),c=Math.sin(_)/(Math.cos(_)-1/Math.sqrt(2)),s=Math.atan(c),i=Math.cos(n),a=Math.tan(r),f=1-i*i*a*a*(1-Math.cos(Math.atan(1/Math.cos(s)))),f<-1?f=-1:f>1&&(f=1),this.face===gi.TOP)g=Math.acos(f),t.phi=on-g,x.value===Fr.AREA_0?t.lam=s+on:x.value===Fr.AREA_1?t.lam=s<0?s+Di:s-Di:x.value===Fr.AREA_2?t.lam=s-on:t.lam=s;else if(this.face===gi.BOTTOM)g=Math.acos(f),t.phi=g-on,x.value===Fr.AREA_0?t.lam=-s+on:x.value===Fr.AREA_1?t.lam=-s:x.value===Fr.AREA_2?t.lam=-s-on:t.lam=s<0?-s-Di:-s+Di;else{var C,E,A;C=f,_=C*C,_>=1?A=0:A=Math.sqrt(1-_)*Math.sin(s),_+=A*A,_>=1?E=0:E=Math.sqrt(1-_),x.value===Fr.AREA_1?(_=E,E=-A,A=_):x.value===Fr.AREA_2?(E=-E,A=-A):x.value===Fr.AREA_3&&(_=E,E=A,A=-_),this.face===gi.RIGHT?(_=C,C=-E,E=_):this.face===gi.BACK?(C=-C,E=-E):this.face===gi.LEFT&&(_=C,C=E,E=-_),t.phi=Math.acos(-A)-on,t.lam=Math.atan2(E,C),this.face===gi.RIGHT?t.lam=eg(t.lam,-on):this.face===gi.BACK?t.lam=eg(t.lam,-Di):this.face===gi.LEFT&&(t.lam=eg(t.lam,+on))}if(this.es!==0){var L,I,T;L=t.phi<0?1:0,I=Math.tan(t.phi),T=this.b/Math.sqrt(I*I+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-T*T)/(this.one_minus_f*T)),L&&(t.phi=-t.phi)}return t.lam+=this.long0,e.x=t.lam,e.y=t.phi,e}function W1(e,t,n,r){var i;return e<Pn?(r.value=Fr.AREA_0,i=0):(i=Math.atan2(t,n),Math.abs(i)<=Or?r.value=Fr.AREA_0:i>Or&&i<=on+Or?(r.value=Fr.AREA_1,i-=on):i>on+Or||i<=-(on+Or)?(r.value=Fr.AREA_2,i=i>=0?i-Di:i+Di):(r.value=Fr.AREA_3,i+=on)),i}function eg(e,t){var n=e+t;return n<-Di?n+=i_:n>+Di&&(n-=i_),n}var Cve=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Eve={init:wve,forward:Sve,inverse:Mve,names:Cve};var RA=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],V0=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Tj=.8487,Pj=1.3523,Aj=ac/5,Tve=1/Aj,zm=18,lS=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))},Pve=function(e,t){return e[1]+t*(2*e[2]+t*3*e[3])};function Ave(e,t,n,r){for(var i=t;r;--r){var a=e(i);if(i-=a,Math.abs(a)<n)break}return i}function Ive(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function Rve(e){var t=Ln(e.x-this.long0),n=Math.abs(e.y),r=Math.floor(n*Aj);r<0?r=0:r>=zm&&(r=zm-1),n=ac*(n-Tve*r);var i={x:lS(RA[r],n)*t,y:lS(V0[r],n)};return e.y<0&&(i.y=-i.y),i.x=i.x*this.a*Tj+this.x0,i.y=i.y*this.a*Pj+this.y0,i}function Lve(e){var t={x:(e.x-this.x0)/(this.a*Tj),y:Math.abs(e.y-this.y0)/(this.a*Pj)};if(t.y>=1)t.x/=RA[zm][0],t.y=e.y<0?-on:on;else{var n=Math.floor(t.y*zm);for(n<0?n=0:n>=zm&&(n=zm-1);;)if(V0[n][0]>t.y)--n;else if(V0[n+1][0]<=t.y)++n;else break;var r=V0[n],i=5*(t.y-r[0])/(V0[n+1][0]-r[0]);i=Ave(function(a){return(lS(r,a)-t.y)/Pve(r,a)},i,Pn,100),t.x/=lS(RA[n],i),t.y=(5*n+i)*Fo,e.y<0&&(t.y=-t.y)}return t.x=Ln(t.x+this.long0),t}var kve=["Robinson","robin"];const Dve={init:Ive,forward:Rve,inverse:Lve,names:kve};function zve(){this.name="geocent"}function Ove(e){var t=gj(e,this.es,this.a);return t}function Fve(e){var t=vj(e,this.es,this.a,this.b);return t}var Nve=["Geocentric","geocentric","geocent","Geocent"];const Bve={init:zve,forward:Ove,inverse:Fve,names:Nve};var os={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},y0={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function Uve(){if(Object.keys(y0).forEach((function(n){if(typeof this[n]>"u")this[n]=y0[n].def;else{if(y0[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);y0[n].num&&(this[n]=parseFloat(this[n]))}y0[n].degrees&&(this[n]=this[n]*Fo)}).bind(this)),Math.abs(Math.abs(this.lat0)-on)<Pn?this.mode=this.lat0<0?os.S_POLE:os.N_POLE:Math.abs(this.lat0)<Pn?this.mode=os.EQUIT:(this.mode=os.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)}function $ve(e){e.x-=this.long0;var t=Math.sin(e.y),n=Math.cos(e.y),r=Math.cos(e.x),i,a;switch(this.mode){case os.OBLIQ:a=this.sinph0*t+this.cosph0*n*r;break;case os.EQUIT:a=n*r;break;case os.S_POLE:a=-t;break;case os.N_POLE:a=t;break}switch(a=this.pn1/(this.p-a),i=a*n*Math.sin(e.x),this.mode){case os.OBLIQ:a*=this.cosph0*t-this.sinph0*n*r;break;case os.EQUIT:a*=t;break;case os.N_POLE:a*=-(n*r);break;case os.S_POLE:a*=n*r;break}var c,s;return c=a*this.cg+i*this.sg,s=1/(c*this.sw*this.h1+this.cw),i=(i*this.cg-a*this.sg)*this.cw*s,a=c*s,e.x=i*this.a,e.y=a*this.a,e}function Vve(e){e.x/=this.a,e.y/=this.a;var t={x:e.x,y:e.y},n,r,i;i=1/(this.pn1-e.y*this.sw),n=this.pn1*e.x*i,r=this.pn1*e.y*this.cw*i,e.x=n*this.cg+r*this.sg,e.y=r*this.cg-n*this.sg;var a=Ds(e.x,e.y);if(Math.abs(a)<Pn)t.x=0,t.y=e.y;else{var c,s;switch(s=1-a*a*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/a+a/this.pn1),c=Math.sqrt(1-s*s),this.mode){case os.OBLIQ:t.y=Math.asin(c*this.sinph0+e.y*s*this.cosph0/a),e.y=(c-this.sinph0*Math.sin(t.y))*a,e.x*=s*this.cosph0;break;case os.EQUIT:t.y=Math.asin(e.y*s/a),e.y=c*a,e.x*=s;break;case os.N_POLE:t.y=Math.asin(c),e.y=-e.y;break;case os.S_POLE:t.y=-Math.asin(c);break}t.x=Math.atan2(e.x,e.y)}return e.x=t.x+this.long0,e.y=t.y,e}var jve=["Tilted_Perspective","tpers"];const Hve={init:Uve,forward:$ve,inverse:Vve,names:jve};function Gve(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var e=1-this.es,t=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function Wve(e){var t=e.x,n=e.y,r,i,a,c;if(t=t-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var s=this.radius_p/Ds(this.radius_p*Math.cos(n),Math.sin(n));if(i=s*Math.cos(t)*Math.cos(n),a=s*Math.sin(t)*Math.cos(n),c=s*Math.sin(n),(this.radius_g-i)*i-a*a-c*c*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;r=this.radius_g-i,this.flip_axis?(e.x=this.radius_g_1*Math.atan(a/Ds(c,r)),e.y=this.radius_g_1*Math.atan(c/r)):(e.x=this.radius_g_1*Math.atan(a/r),e.y=this.radius_g_1*Math.atan(c/Ds(a,r)))}else this.shape==="sphere"&&(r=Math.cos(n),i=Math.cos(t)*r,a=Math.sin(t)*r,c=Math.sin(n),r=this.radius_g-i,this.flip_axis?(e.x=this.radius_g_1*Math.atan(a/Ds(c,r)),e.y=this.radius_g_1*Math.atan(c/r)):(e.x=this.radius_g_1*Math.atan(a/r),e.y=this.radius_g_1*Math.atan(c/Ds(a,r))));return e.x=e.x*this.a,e.y=e.y*this.a,e}function qve(e){var t=-1,n=0,r=0,i,a,c,s;if(e.x=e.x/this.a,e.y=e.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(e.y/this.radius_g_1),n=Math.tan(e.x/this.radius_g_1)*Ds(1,r)):(n=Math.tan(e.x/this.radius_g_1),r=Math.tan(e.y/this.radius_g_1)*Ds(1,n));var f=r/this.radius_p;if(i=n*n+f*f+t*t,a=2*this.radius_g*t,c=a*a-4*i*this.C,c<0)return e.x=Number.NaN,e.y=Number.NaN,e;s=(-a-Math.sqrt(c))/(2*i),t=this.radius_g+s*t,n*=s,r*=s,e.x=Math.atan2(n,t),e.y=Math.atan(r*Math.cos(e.x)/t),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(e.y/this.radius_g_1),n=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(e.x/this.radius_g_1),r=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+n*n)),i=n*n+r*r+t*t,a=2*this.radius_g*t,c=a*a-4*i*this.C,c<0)return e.x=Number.NaN,e.y=Number.NaN,e;s=(-a-Math.sqrt(c))/(2*i),t=this.radius_g+s*t,n*=s,r*=s,e.x=Math.atan2(n,t),e.y=Math.atan(r*Math.cos(e.x)/t)}return e.x=e.x+this.long0,e}var Xve=["Geostationary Satellite View","Geostationary_Satellite","geos"];const Zve={init:Gve,forward:Wve,inverse:qve,names:Xve};var hy=1.340264,dy=-.081106,fy=893e-6,py=.003796,cS=Math.sqrt(3)/2;function Yve(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function Kve(e){var t=Ln(e.x-this.long0),n=e.y,r=Math.asin(cS*Math.sin(n)),i=r*r,a=i*i*i;return e.x=t*Math.cos(r)/(cS*(hy+3*dy*i+a*(7*fy+9*py*i))),e.y=r*(hy+dy*i+a*(fy+py*i)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Jve(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var t=1e-9,n=12,r=e.y,i,a,c,s,f,g;for(g=0;g<n&&(i=r*r,a=i*i*i,c=r*(hy+dy*i+a*(fy+py*i))-e.y,s=hy+3*dy*i+a*(7*fy+9*py*i),r-=f=c/s,!(Math.abs(f)<t));++g);return i=r*r,a=i*i*i,e.x=cS*e.x*(hy+3*dy*i+a*(7*fy+9*py*i))/Math.cos(r),e.y=Math.asin(Math.sin(r)/cS),e.x=Ln(e.x+this.long0),e}var Qve=["eqearth","Equal Earth","Equal_Earth"];const e0e={init:Yve,forward:Kve,inverse:Jve,names:Qve};var a_=1e-10;function t0e(){var e;if(this.phi1=this.lat1,Math.abs(this.phi1)<a_)throw new Error;this.es?(this.en=tL(this.es),this.m1=Fg(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=r0e,this.forward=n0e):(Math.abs(this.phi1)+a_>=on?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=o0e,this.forward=i0e)}function n0e(e){var t=Ln(e.x-(this.long0||0)),n=e.y,r,i,a;return r=this.am1+this.m1-Fg(n,i=Math.sin(n),a=Math.cos(n),this.en),i=a*t/(r*Math.sqrt(1-this.es*i*i)),e.x=r*Math.sin(i),e.y=this.am1-r*Math.cos(i),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function r0e(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,n,r,i;if(n=Ds(e.x,e.y=this.am1-e.y),i=nL(this.am1+this.m1-n,this.es,this.en),(t=Math.abs(i))<on)t=Math.sin(i),r=n*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*t*t)/Math.cos(i);else if(Math.abs(t-on)<=a_)r=0;else throw new Error;return e.x=Ln(r+(this.long0||0)),e.y=td(i),e}function i0e(e){var t=Ln(e.x-(this.long0||0)),n=e.y,r,i;return i=this.cphi1+this.phi1-n,Math.abs(i)>a_?(e.x=i*Math.sin(r=t*Math.cos(n)/i),e.y=this.cphi1-i*Math.cos(r)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function o0e(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,n,r=Ds(e.x,e.y=this.cphi1-e.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>on)throw new Error;return Math.abs(Math.abs(n)-on)<=a_?t=0:t=r*Math.atan2(e.x,e.y)/Math.cos(n),e.x=Ln(t+(this.long0||0)),e.y=td(n),e}var s0e=["bonne","Bonne (Werner lat_1=90)"];const a0e={init:t0e,names:s0e};function l0e(e){e.Proj.projections.add(Qb),e.Proj.projections.add(ew),e.Proj.projections.add(nme),e.Proj.projections.add(dme),e.Proj.projections.add(yme),e.Proj.projections.add(Sme),e.Proj.projections.add(Ame),e.Proj.projections.add(Dme),e.Proj.projections.add(Bme),e.Proj.projections.add(Hme),e.Proj.projections.add(age),e.Proj.projections.add(fge),e.Proj.projections.add(yge),e.Proj.projections.add(Mge),e.Proj.projections.add(Age),e.Proj.projections.add(Dge),e.Proj.projections.add(Bge),e.Proj.projections.add(Hge),e.Proj.projections.add(Yge),e.Proj.projections.add(tve),e.Proj.projections.add(sve),e.Proj.projections.add(hve),e.Proj.projections.add(gve),e.Proj.projections.add(bve),e.Proj.projections.add(Eve),e.Proj.projections.add(Dve),e.Proj.projections.add(Bve),e.Proj.projections.add(Hve),e.Proj.projections.add(Zve),e.Proj.projections.add(e0e),e.Proj.projections.add(a0e)}Ws.defaultDatum="WGS84";Ws.Proj=pc;Ws.WGS84=new Ws.Proj("WGS84");Ws.Point=wg;Ws.toPoint=yj;Ws.defs=ms;Ws.nadgrid=ipe;Ws.transform=sS;Ws.mgrs=xpe;Ws.version="__VERSION__";l0e(Ws);const sL=6370997,uS=sL*Math.PI/180,Om={mapProjection:"lambert_conic",standardParalel1:33,standardParalel2:45,mapOrigin:[39,-96],mapFactor:[-.00017706234,.000176689948]},c0e=["+proj=lcc",`+R=${sL}`,`+lat_1=${Om.standardParalel1}`,`+lat_2=${Om.standardParalel2}`,`+lat_0=${Om.mapOrigin[0]}`,`+lon_0=${Om.mapOrigin[1]}`].join(" "),u0e=Ws(c0e),Ij=([e,t])=>{const n=u0e.forward([e,t]);return[n[0]/Om.mapFactor[1]/uS,n[1]/Om.mapFactor[0]/uS].map(r=>Number(r.toFixed(10)))},gh={mapProjection:"lambert_conic",standardParalel1:37,standardParalel2:65,mapOrigin:[50,15],mapOffset:[16660,4150],mapFactor:[-.000171570875,.0001729241463]},h0e=["+proj=lcc",`+R=${sL}`,`+lat_1=${gh.standardParalel1}`,`+lat_2=${gh.standardParalel2}`,`+lat_0=${gh.mapOrigin[0]}`,`+lon_0=${gh.mapOrigin[1]}`].join(" "),d0e=Ws(h0e),Rj=([e,t])=>{const n=d0e.forward([e,t]);let[r,i]=[n[0]/gh.mapFactor[1]/uS,n[1]/gh.mapFactor[0]/uS];const a=.75,c=[-31100,-5500],s=r/a-c[0]/2,f=i/a-c[1]/2;return s*a<c[0]&&s*a<c[1]&&(r=s,i=f),[r+gh.mapOffset[0],i+gh.mapOffset[1]].map(_=>Number(_.toFixed(10)))};var ia=63710088e-1,f0e={centimeters:ia*100,centimetres:ia*100,degrees:360/(2*Math.PI),feet:ia*3.28084,inches:ia*39.37,kilometers:ia/1e3,kilometres:ia/1e3,meters:ia,metres:ia,miles:ia/1609.344,millimeters:ia*1e3,millimetres:ia*1e3,nauticalmiles:ia/1852,radians:1,yards:ia*1.0936};function p0e(e,t="kilometers"){const n=f0e[t];if(!n)throw new Error(t+" units is invalid");return e*n}function q1(e){return e%360*Math.PI/180}function x4(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function LA(e,t,n={}){var r=x4(e),i=x4(t),a=q1(i[1]-r[1]),c=q1(i[0]-r[0]),s=q1(r[1]),f=q1(i[1]),g=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(c/2),2)*Math.cos(s)*Math.cos(f);return p0e(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)),n.units)}const Yu={ats:[[-124.477162,25.767968].map(e=>Math.floor(e)),[-88.777474,49.1223839].map(e=>Math.ceil(e))].flat(),ets2:[[-10.025698,34.897275].map(e=>Math.floor(e)),[33.284941,61.881437].map(e=>Math.ceil(e))].flat()},m0e=()=>{const e=nr(ZM().current),[t,n]=$.useState(null),[r,i]=$.useState(!1),[a,c]=$.useState(!1),[s,f]=$.useState([]),g=$.useCallback(E=>{E!=="clickaway"&&i(!1)},[]),_=$.useCallback(()=>{c(!1),f([])},[]),x=E=>()=>{i(!0);const A=nr(t).position;switch(E){case"lngLat":navigator.clipboard.writeText(A.lngLat.map(L=>w4(L,4)).join(","));break;case"xz":navigator.clipboard.writeText(nr(A.xz).map(L=>w4(L,1)).join(";"));break;default:throw new W_(E)}},C=$.useCallback(()=>{n(null),e.off("move",C)},[]);return $.useEffect(()=>{const E=A=>{const{clientX:L,clientY:I}=A.originalEvent,T=A.lngLat.toArray();let O;H1(T,Yu.ats)?O=Ij(T):H1(T,Yu.ets2)&&(O=Rj(T));const D=LA(T,e4(Yu.ats)),U=LA(T,e4(Yu.ets2)),H=D<=U?"ats":"ets2";n({position:{lngLat:T,xz:O},closestGame:H,anchorEl:{getBoundingClientRect:()=>({width:0,height:0,top:I,right:L,bottom:I,left:L})}}),e.once("move",C)};return e.on("contextmenu",E),()=>void e.off("contextmenu",E)},[e]),$.useEffect(()=>{if(!a){e.getCanvas().style.cursor="";return}let E=0;const A=()=>E++,L={type:"Feature",geometry:{type:"LineString",coordinates:s},properties:{id:A()}},I={type:"FeatureCollection",features:[...s.map(D=>S4(D,A())),...s.length>1?[L]:[]]},T=D=>{const U=e.queryRenderedFeatures(D.point,{layers:["measure-points"]}),H=H1(D.lngLat.toArray(),a==="ats"?Yu.ats:Yu.ets2);e.getCanvas().style.cursor=H?U.length?"pointer":"crosshair":"not-allowed"},O=D=>{if(!H1(D.lngLat.toArray(),a==="ats"?Yu.ats:Yu.ets2))return;const H=e.queryRenderedFeatures(D.point,{layers:["measure-points"]});if(I.features.length>1&&I.features.pop(),H.length){const V=H[0].properties.id;I.features=I.features.filter(q=>q.properties.id!==V)}else I.features.push(S4(D.lngLat.toArray(),A()));I.features.length>1&&(L.geometry.coordinates=I.features.map(V=>(EV(V.geometry.type==="Point",`unexpected non-Point geometry: ${V.geometry.type}`),V.geometry.coordinates)),I.features.push(L)),nr(e.getSource("measure")).setData(I),f(I.features.filter(V=>V.geometry.type==="Point").map(V=>V.geometry.coordinates))};return e.on("mousemove",T),e.on("click",O),nr(e.getSource("measure")).setData(I),()=>{e.off("mousemove",T),e.off("click",O),nr(e.getSource("measure")).setData({type:"FeatureCollection",features:[]})}},[e,s,a]),te.jsxs(te.Fragment,{children:[te.jsx("div",{style:{display:t!=null?"block":"none",zIndex:10,position:"absolute",top:0,left:0,right:0,bottom:0},onMouseDown:E=>{E.currentTarget===E.target&&C()},children:te.jsx(k8,{size:"sm",open:t!=null,anchorEl:t==null?void 0:t.anchorEl,placement:"bottom-start",onClick:C,onContextMenu:E=>E.preventDefault(),children:t?te.jsxs(te.Fragment,{children:[te.jsxs(df,{sx:{justifyContent:"space-between"},onClick:x("lngLat"),children:[te.jsx(tj,{}),te.jsx(Yw,{children:te.jsx(b4,{coords:{lat:t.position.lngLat[1],lng:t.position.lngLat[0]},fractionDigits:4})}),te.jsx(Q5,{sx:{ml:1}})]}),t.position.xz?te.jsxs(te.Fragment,{children:[te.jsxs(df,{sx:{justifyContent:"space-between"},onClick:x("xz"),children:[te.jsx(nj,{}),te.jsx(Yw,{children:te.jsx(b4,{coords:{x:t.position.xz[0],z:t.position.xz[1]},fractionDigits:1})}),te.jsx(Q5,{sx:{ml:1}})]}),te.jsx(Zw,{}),a?te.jsx(df,{onClick:_,children:"Clear measurement"}):te.jsx(df,{onClick:()=>{c(nr(t).closestGame),f([nr(t).position.lngLat])},children:"Measure distance"})]}):te.jsxs(te.Fragment,{children:[te.jsx(Zw,{}),te.jsx(Jh,{children:te.jsxs(ci,{level:"body-xs",sx:{opacity:.75},children:["Right-click within the"," ",t.closestGame.toUpperCase()," game map for more options."]})})]})]}):null})}),te.jsx(g0e,{measuring:a,close:_,measuringPoints:s}),te.jsx(v0e,{open:r,close:g})]})},b4=e=>Object.entries(e.coords).map(([t,n],r)=>te.jsxs($.Fragment,{children:[r>0?te.jsx("span",{children:"  "}):null,te.jsx(d8,{size:"sm",variant:"plain",sx:{opacity:.4},children:t}),j0(n,e.fractionDigits)]},t)),g0e=$.memo(e=>e.measuring===!1?null:te.jsx(F8,{open:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",sx:{alignItems:"baseline",mb:4},endDecorator:te.jsx(lu,{onClick:e.close,children:te.jsx(X3,{})}),children:te.jsxs(ja,{gap:1,children:[te.jsx(ci,{level:"title-md",children:"Measure distance"}),e.measuringPoints.length<=1?te.jsx(ci,{level:"body-sm",children:"Click on the map to trace a path you want to measure."}):te.jsxs(ja,{gap:2,children:[te.jsx(ci,{level:"body-sm",children:"Click on the map to add to your path. Click on an existing point to remove it from the path."}),te.jsxs(ja,{direction:"row",gap:2,sx:{textWrap:"nowrap"},children:[te.jsx(ci,{level:"title-sm",children:"Total distance:"}),te.jsxs(ja,{direction:"row",gap:.5,children:[te.jsx(ci,{level:"body-xs",children:te.jsx(tj,{})}),te.jsx(ci,{level:"title-sm",children:M4(e.measuringPoints,"irl",e.measuring)})]}),te.jsxs(ja,{direction:"row",gap:.5,children:[te.jsx(ci,{level:"body-xs",children:te.jsx(nj,{})}),te.jsx(ci,{level:"title-sm",children:M4(e.measuringPoints,"game",e.measuring)})]})]})]})]})})),v0e=$.memo(e=>te.jsx(F8,{open:e.open,onClose:(t,n)=>e.close(n),autoHideDuration:3e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",endDecorator:te.jsx(lu,{onClick:()=>e.close("escapeKeyDown"),children:te.jsx(X3,{})}),children:"Copied to clipboard."}));function w4(e,t){return Number(e.toFixed(t))}function j0(e,t){return Number(e.toFixed(t)).toLocaleString(void 0,{maximumFractionDigits:t})}function S4(e,t){return{type:"Feature",geometry:{type:"Point",coordinates:e},properties:{id:t}}}function M4(e,t,n){let r;if(t==="irl")r=e;else{const f=n==="ats"?Ij:Rj;r=e.map(f)}const i=t==="irl"?LA:(f,g)=>ij(f,g)/1e3;let a=r[0],c=0;for(const f of r.slice(1))c+=i(a,f),a=f;const s=c<1?`${j0(c*1e3,1)} meters`:`${j0(c,2)} km`;if(t==="irl"){const f=c*.6213712,g=f<1?`${j0(f*5280,0)} ft`:`${j0(f,2)} mi`;return`${n==="ats"?g:s} (${n==="ats"?s:g})`}else return s}const Lj={[Pi.FuelStation]:{iconName:"gas_ico",label:"Fuel station"},[Pi.Toll]:{iconName:"toll_ico",label:"Toll gate"},[Pi.Parking]:{iconName:"parking_ico",label:"Rest stop"},[Pi.RecruitmentAgency]:{iconName:"recruitment_ico",label:"Recruitment agency"},[Pi.Service]:{iconName:"service_ico",label:"Service"},[Pi.TruckDealer]:{iconName:"dealer_ico",label:"Truck dealer"},[Pi.Port]:{iconName:"port_overlay",label:"Port"},[Pi.Train]:{iconName:"train_ico",label:"Train"},[Pi.Viewpoint]:{iconName:"viewpoint",label:"Viewpoint"},[Pi.PhotoSight]:{iconName:"photo_sight_captured",label:"Photo trophy"},[Pi.AgricultureCheck]:{iconName:"agri_check",label:"Agricultural inspection"},[Pi.BorderCheck]:{iconName:"border_ico",label:"Border inspection"},[Pi.Garage]:{iconName:"garage_large_ico",label:"Garage"},[Pi.WeighStation]:{iconName:"weigh_station_ico",label:"Weigh station"},[Pi.CityNames]:{iconName:"city_names_ico",label:"City names"},[Pi.Company]:{iconName:"companies_ico",label:"Companies"},[Pi.RoadNumber]:{iconName:"road_numbers_ico",label:"Road numbers"},[Pi.Roadwork]:{iconName:"roadwork",label:"Roadwork"},[Pi.RailCrossing]:{iconName:"railcrossing",label:"Rail Crossing"}},C4=new Map(Object.entries(Lj).map(([e,t])=>[Number(e),t.label])),E4=new Map(Object.entries(The).map(([e,t])=>[Number(e),t]));function hS(e,t,n){return{selectedItems:e,onSelectAllToggle:r=>t(new Set(r?n:[])),onItemToggle:(r,i)=>{t(a=>{const c=new Set(a);return i?c.add(r):c.delete(r),c})}}}const kj=e=>{const t=$.useRef(null),[n,r]=$.useState(!1),[i,a]=$.useState(0);return tl(()=>({onAdd:()=>nr(t.current),onRemove:()=>nr(t.current).remove()}),{position:"bottom-left"}),te.jsxs("div",{ref:t,className:"maplibregl-ctrl maplibregl-ctrl-group",children:[te.jsx(lu,{title:"Map Options",sx:{minWidth:0,minHeight:0,borderRadius:0},onClick:()=>r(!0),children:te.jsx(ffe,{})}),te.jsx(L8,{open:n,onClose:()=>r(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",justifyContent:"end"}}},children:te.jsxs(z8,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,height:"80%",overflow:"auto"},children:[te.jsx(T8,{children:"Map Options"}),te.jsx(D8,{}),te.jsx(WO,{onChange:(c,s)=>a(Number(s)),children:te.jsxs(Dse,{tabFlex:1,sx:{borderRadius:0},children:[te.jsx(fE,{children:"Icons"}),te.jsx(fE,{children:"ATS DLC"}),te.jsx(fE,{children:"Advanced"})]})}),te.jsx(E8,{sx:{overflowX:"hidden"},children:te.jsxs(WO,{value:i,children:[te.jsx(pE,{sx:{p:0},value:0,children:te.jsx(T4,{items:C4,selectedItems:e.icons.selectedItems,onItemToggle:e.icons.onItemToggle,icon:c=>te.jsx("img",{style:{marginLeft:-3},width:32,height:32,src:`map-icons/${Lj[c].iconName}.png`})})}),te.jsx(pE,{sx:{p:0},value:1,children:te.jsx(T4,{items:E4,selectedItems:e.atsDlcs.selectedItems,onItemToggle:e.atsDlcs.onItemToggle})}),te.jsx(pE,{sx:{p:0},value:2,children:te.jsx(b0e,{showContours:e.advanced.showContours,onContoursToggle:e.advanced.onContoursToggle,showPhotoSpheresUi:e.advanced.showPhotoSpheresUi,onPhotoSpheresToggleUi:e.advanced.onPhotoSpheresToggleUi})})]})}),te.jsx(e_,{}),i===0&&te.jsx(y0e,{enableAutoHiding:e.icons.enableAutoHiding,enableSelectAll:e.icons.selectedItems.size===C4.size,onAutoHidingToggle:e.icons.onAutoHidingToggle,onSelectAllToggle:e.icons.onSelectAllToggle}),i===1&&te.jsx(x0e,{enableSelectAll:e.atsDlcs.selectedItems.size===E4.size,onSelectAllToggle:e.atsDlcs.onSelectAllToggle})]})})]})},y0e=$.memo(e=>te.jsxs(ja,{direction:"row",justifyContent:"space-between",gap:1,mx:2,children:[te.jsx(Xse,{enterDelay:500,title:"Enable to hide icons based on zoom and nearby icons. Disable to always show icons.",children:te.jsx(Af,{label:"Enable icon hiding",checked:e.enableAutoHiding,onChange:t=>{var n;return(n=e.onAutoHidingToggle)==null?void 0:n.call(e,t.target.checked)}})}),te.jsx(Af,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:e.enableSelectAll,onChange:t=>{var n;return(n=e.onSelectAllToggle)==null?void 0:n.call(e,t.target.checked)}})]})),_0e=e=>te.jsx(D_,{size:"lg",sx:{p:0,[`& .${_f.root}`]:{flexGrow:1,alignItems:"center",flexDirection:"row-reverse"}},children:[...e.items.entries()].map(([t,n])=>{var r;return te.jsxs(Jh,{children:[(r=e.icon)==null?void 0:r.call(e,t),te.jsx(Af,{overlay:!0,label:n,checked:e.selectedItems.has(t),onChange:i=>e.onItemToggle(t,i.target.checked)})]},String(t))})}),T4=$.memo(_0e),x0e=$.memo(e=>te.jsx(ja,{direction:"row",justifyContent:"end",gap:1,mx:2,children:te.jsx(Af,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:e.enableSelectAll,onChange:t=>{var n;return(n=e.onSelectAllToggle)==null?void 0:n.call(e,t.target.checked)}})})),b0e=e=>te.jsxs(ja,{mx:2,children:[te.jsx(ci,{mb:2,level:"title-lg",children:"Experimental Features"}),te.jsxs(ja,{gap:2,children:[te.jsxs(dA,{children:[te.jsx(Af,{sx:{flexDirection:"row-reverse"},label:"Show elevation data",checked:e.showContours,onChange:t=>e.onContoursToggle(t.target.checked)}),te.jsx(ci,{level:"body-xs",color:"warning",children:"Note: elevation data for points further away from roads is estimated and likely inaccurate."})]}),te.jsxs(dA,{children:[te.jsx(Af,{sx:{flexDirection:"row-reverse"},label:"Show Photo Spheres button",checked:e.showPhotoSpheresUi,onChange:t=>e.onPhotoSpheresToggleUi(t.target.checked)}),te.jsxs(ci,{level:"body-xs",color:"neutral",children:["Shows a ",te.jsx(rj,{style:{position:"relative",top:"0.25em"}})," ","button in the upper-right of the app."]}),te.jsx(ci,{level:"body-xs",color:"warning",children:"Note: the positions of Photo Spheres were determined with 💩 heuristics. The landmarks they're meant to capture aren't always in view."})]})]})]}),Dj=()=>{const e=$.useRef(null),{mode:t="light",setMode:n}=_R();return tl(()=>({onAdd:()=>nr(e.current),onRemove:()=>nr(e.current).remove()})),te.jsx("div",{ref:e,className:"maplibregl-ctrl maplibregl-ctrl-group",children:te.jsxs(XK,{children:[te.jsx(zoe,{slots:{root:lu},sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Set map theme",children:te.jsx(afe,{})}),te.jsxs(k8,{placement:"left",children:[te.jsx(Jh,{sticky:!0,children:te.jsx(ci,{m:1,level:"body-xs",textTransform:"uppercase",fontWeight:"lg",children:"Map theme"})}),te.jsxs(df,{onClick:()=>n("light"),selected:t==="light",children:[te.jsx(sy,{children:te.jsx(cfe,{})})," ","Light"]}),te.jsxs(df,{onClick:()=>n("dark"),selected:t==="dark",children:[te.jsx(sy,{children:te.jsx(ufe,{})})," ","Dark"]}),te.jsxs(df,{onClick:()=>n("system"),selected:t==="system",children:[te.jsx(sy,{children:te.jsx(lfe,{})})," ","Auto"]})]})]})})};function w0e(e,t,n){let r=n.get(e);return r==null&&(r=t,n.set(e,r)),r}const S0e=e=>{const{map:t,selectDecorator:n,onSelect:r}=e,[i,a]=$.useState([]);$.useEffect(()=>{const f=t==="usa"?"ats":"ets2";Promise.all([fetch(`${f}-achievements.json`).then(g=>g.json()),fetch(`${f}-achievements.geojson`).then(g=>g.json())]).then(([g,_])=>{const x=new Map;for(const E of _.features)w0e(E.properties.name,[],x).push({coordinates:E.geometry.coordinates,dlcGuard:E.properties.dlcGuard});const C=new Set(_.features.map(E=>E.properties.name));a([...g.data.filter(E=>C.has(E.id)).map(E=>({...E,label:E.title,value:E.id,features:nr(x.get(E.id))})).sort((E,A)=>E.label.localeCompare(A.label))])},()=>console.error("could not load achievements json."))},[t]);const c=i.filter(f=>{if(t==="europe")return!0;const g=H_(e.visibleStateDlcs);return f.features.some(_=>g.has(_.dlcGuard))}),s=bM({stringify:f=>[f.label,f.desc].join(" ")});return te.jsx(Qy,{onChange:(f,g)=>r(g),placeholder:"Search achievements...",options:c,filterOptions:s,blurOnSelect:!0,autoComplete:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,renderOption:(f,g)=>$.createElement(x8,{...f,key:g.value},te.jsx(sy,{sx:{border:"2px solid var(--joy-palette-neutral-outlinedBorder)",borderRadius:6,overflow:"hidden",minWidth:"fit-content",mr:.5},children:te.jsx("img",{loading:"lazy",width:"48",height:"48",src:g.imgUrl,alt:""})}),te.jsxs(Yw,{children:[te.jsx(ci,{level:"title-md",children:g.label}),te.jsx(ci,{level:"body-xs",children:g.desc})]}))},t)},M0e=e=>{const{map:t,selectDecorator:n,onSelect:r}=e,[i,a]=$.useState([]);$.useEffect(()=>{Promise.all([fetch("cities.geojson").then(f=>f.json()),fetch(QV).then(f=>f.json()),fetch(ej).then(f=>f.json())]).then(([f,g,_])=>{a(E0e(f,g,_))},()=>console.error("could not load cities/towns geojson."))},[]);const c=i.filter(f=>{const g=f.map===t;return t==="europe"?g:g&&e.visibleStates.has(f.stateCode)}),s=bM({stringify:f=>[f.state,f.label].join(" ")});return te.jsx(Qy,{onChange:(f,g)=>g&&r(g),placeholder:"Search cities...",options:c,filterOptions:s,groupBy:f=>f.state,blurOnSelect:!0,autoComplete:!0,renderGroup:C0e,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n},t)};function C0e(e){return te.jsxs($.Fragment,{children:[te.jsx(ci,{m:1,level:"body-xs",textTransform:"uppercase",fontWeight:"lg",children:e.group}),te.jsx(D_,{children:e.children}),te.jsx(Zw,{})]},e.key)}function E0e(e,t,n){const r=[],i=new Map;for(const a of e.features)if(a.properties.type==="city")r.push(a);else if(a.properties.type==="country")i.set(a.properties.code,a.properties.name);else throw new Error;for(const a of t.features)a.properties.show===!1||a.properties.kind==="city"||a.properties.country==null||a.properties.text==null||r.push({type:"Feature",geometry:a.geometry,properties:{type:"city",map:"usa",countryCode:a.properties.country.replace(/^..-/,""),name:a.properties.text}});for(const a of n.features)r.push({type:"Feature",geometry:a.geometry,properties:{type:"city",map:"europe",countryCode:a.properties.state,name:a.properties.name}});return r.filter(a=>i.has(a.properties.countryCode)).map(({properties:a,geometry:c})=>({map:a.map,state:nr(i.get(a.countryCode)),stateCode:a.countryCode,label:a.name,value:c.coordinates})).sort((a,c)=>a.state!==c.state?a.state.localeCompare(c.state):a.label.localeCompare(c.label))}var P4=Object.prototype.toString,zj=function(t){var n=P4.call(t),r=n==="[object Arguments]";return r||(r=n!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&P4.call(t.callee)==="[object Function]"),r},IE,A4;function T0e(){if(A4)return IE;A4=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=zj,i=Object.prototype.propertyIsEnumerable,a=!i.call({toString:null},"toString"),c=i.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(C){var E=C.constructor;return E&&E.prototype===C},g={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},_=function(){if(typeof window>"u")return!1;for(var C in window)try{if(!g["$"+C]&&t.call(window,C)&&window[C]!==null&&typeof window[C]=="object")try{f(window[C])}catch{return!0}}catch{return!0}return!1}(),x=function(C){if(typeof window>"u"||!_)return f(C);try{return f(C)}catch{return!1}};e=function(E){var A=E!==null&&typeof E=="object",L=n.call(E)==="[object Function]",I=r(E),T=A&&n.call(E)==="[object String]",O=[];if(!A&&!L&&!I)throw new TypeError("Object.keys called on a non-object");var D=c&&L;if(T&&E.length>0&&!t.call(E,0))for(var U=0;U<E.length;++U)O.push(String(U));if(I&&E.length>0)for(var H=0;H<E.length;++H)O.push(String(H));else for(var V in E)!(D&&V==="prototype")&&t.call(E,V)&&O.push(String(V));if(a)for(var q=x(E),Q=0;Q<s.length;++Q)!(q&&s[Q]==="constructor")&&t.call(E,s[Q])&&O.push(s[Q]);return O}}return IE=e,IE}var P0e=Array.prototype.slice,A0e=zj,I4=Object.keys,tw=I4?function(t){return I4(t)}:T0e(),R4=Object.keys;tw.shim=function(){if(Object.keys){var t=function(){var n=Object.keys(arguments);return n&&n.length===arguments.length}(1,2);t||(Object.keys=function(r){return A0e(r)?R4(P0e.call(r)):R4(r)})}else Object.keys=tw;return Object.keys||tw};var I0e=tw,nw=Object.defineProperty||!1;if(nw)try{nw({},"a",{value:1})}catch{nw=!1}var J_=nw,nd=SyntaxError,rr=TypeError,R0e=Object.getOwnPropertyDescriptor,rw=R0e;if(rw)try{rw([],"length")}catch{rw=null}var Ng=rw,L4=J_,L0e=nd,Gp=rr,k4=Ng,Oj=function(t,n,r){if(!t||typeof t!="object"&&typeof t!="function")throw new Gp("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new Gp("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Gp("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Gp("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Gp("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Gp("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,a=arguments.length>4?arguments[4]:null,c=arguments.length>5?arguments[5]:null,s=arguments.length>6?arguments[6]:!1,f=!!k4&&k4(t,n);if(L4)L4(t,n,{configurable:c===null&&f?f.configurable:!c,enumerable:i===null&&f?f.enumerable:!i,value:r,writable:a===null&&f?f.writable:!a});else if(s||!i&&!a&&!c)t[n]=r;else throw new L0e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},kA=J_,Fj=function(){return!!kA};Fj.hasArrayLengthDefineBug=function(){if(!kA)return null;try{return kA([],"length",{value:1}).length!==1}catch{return!0}};var aL=Fj,k0e=I0e,D0e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",z0e=Object.prototype.toString,O0e=Array.prototype.concat,D4=Oj,F0e=function(e){return typeof e=="function"&&z0e.call(e)==="[object Function]"},Nj=aL(),N0e=function(e,t,n,r){if(t in e){if(r===!0){if(e[t]===n)return}else if(!F0e(r)||!r())return}Nj?D4(e,t,n,!0):D4(e,t,n)},Bj=function(e,t){var n=arguments.length>2?arguments[2]:{},r=k0e(t);D0e&&(r=O0e.call(r,Object.getOwnPropertySymbols(t)));for(var i=0;i<r.length;i+=1)N0e(e,r[i],t[r[i]],n[r[i]])};Bj.supportsDescriptors=!!Nj;var Uj=Bj,$j={exports:{}},B0e=Object,U0e=Error,$0e=EvalError,V0e=RangeError,j0e=ReferenceError,H0e=URIError,Vj=Math.abs,jj=Math.floor,G0e=Math.max,W0e=Math.min,q0e=Math.pow,RE,z4;function Hj(){return z4||(z4=1,RE=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;t[n]=i;for(var a in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var c=Object.getOwnPropertySymbols(t);if(c.length!==1||c[0]!==n||!Object.prototype.propertyIsEnumerable.call(t,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(t,n);if(s.value!==i||s.enumerable!==!0)return!1}return!0}),RE}var LE,O4;function tC(){if(O4)return LE;O4=1;var e=typeof Symbol<"u"&&Symbol,t=Hj();return LE=function(){return typeof e!="function"||typeof Symbol!="function"||typeof e("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:t()},LE}var X0e="Function.prototype.bind called on incompatible ",Z0e=Object.prototype.toString,Y0e=Math.max,K0e="[object Function]",F4=function(t,n){for(var r=[],i=0;i<t.length;i+=1)r[i]=t[i];for(var a=0;a<n.length;a+=1)r[a+t.length]=n[a];return r},J0e=function(t,n){for(var r=[],i=n,a=0;i<t.length;i+=1,a+=1)r[a]=t[i];return r},Q0e=function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n},eye=function(t){var n=this;if(typeof n!="function"||Z0e.apply(n)!==K0e)throw new TypeError(X0e+n);for(var r=J0e(arguments,1),i,a=function(){if(this instanceof i){var _=n.apply(this,F4(r,arguments));return Object(_)===_?_:this}return n.apply(t,F4(r,arguments))},c=Y0e(0,n.length-r.length),s=[],f=0;f<c;f++)s[f]="$"+f;if(i=Function("binder","return function ("+Q0e(s,",")+"){ return binder.apply(this,arguments); }")(a),n.prototype){var g=function(){};g.prototype=n.prototype,i.prototype=new g,g.prototype=null}return i},tye=eye,Q_=Function.prototype.bind||tye,lL=Function.prototype.call,cL=Function.prototype.apply,nye=typeof Reflect<"u"&&Reflect&&Reflect.apply,rye=Q_,iye=cL,oye=lL,sye=nye,Gj=sye||rye.call(oye,iye),aye=Q_,lye=rr,cye=lL,uye=Gj,uL=function(t){if(t.length<1||typeof t[0]!="function")throw new lye("a function is required");return uye(aye,cye,t)},kE,N4;function hye(){if(N4)return kE;N4=1;var e=uL,t=Ng,n;try{n=[].__proto__===Array.prototype}catch(c){if(!c||typeof c!="object"||!("code"in c)||c.code!=="ERR_PROTO_ACCESS")throw c}var r=!!n&&t&&t(Object.prototype,"__proto__"),i=Object,a=i.getPrototypeOf;return kE=r&&typeof r.get=="function"?e([r.get]):typeof a=="function"?function(s){return a(s==null?s:i(s))}:!1,kE}var DE,B4;function vu(){if(B4)return DE;B4=1;var e=Function.prototype.call,t=Object.prototype.hasOwnProperty,n=Q_;return DE=n.call(e,t),DE}var yr,Wj=B0e,dye=U0e,fye=$0e,pye=V0e,mye=j0e,Mg=nd,tg=rr,gye=H0e,vye=Vj,yye=jj,_ye=G0e,xye=W0e,bye=q0e,qj=Function,zE=function(e){try{return qj('"use strict"; return ('+e+").constructor;")()}catch{}},l_=Ng,wye=J_,OE=function(){throw new tg},Sye=l_?function(){try{return arguments.callee,OE}catch{try{return l_(arguments,"callee").get}catch{return OE}}}():OE,Wp=tC()(),Mye=hye(),wo=typeof Reflect=="function"&&Reflect.getPrototypeOf||Wj.getPrototypeOf||Mye,Xj=cL,ex=lL,pm={},Cye=typeof Uint8Array>"u"||!wo?yr:wo(Uint8Array),bf={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?yr:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?yr:ArrayBuffer,"%ArrayIteratorPrototype%":Wp&&wo?wo([][Symbol.iterator]()):yr,"%AsyncFromSyncIteratorPrototype%":yr,"%AsyncFunction%":pm,"%AsyncGenerator%":pm,"%AsyncGeneratorFunction%":pm,"%AsyncIteratorPrototype%":pm,"%Atomics%":typeof Atomics>"u"?yr:Atomics,"%BigInt%":typeof BigInt>"u"?yr:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?yr:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?yr:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?yr:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":dye,"%eval%":eval,"%EvalError%":fye,"%Float32Array%":typeof Float32Array>"u"?yr:Float32Array,"%Float64Array%":typeof Float64Array>"u"?yr:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?yr:FinalizationRegistry,"%Function%":qj,"%GeneratorFunction%":pm,"%Int8Array%":typeof Int8Array>"u"?yr:Int8Array,"%Int16Array%":typeof Int16Array>"u"?yr:Int16Array,"%Int32Array%":typeof Int32Array>"u"?yr:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Wp&&wo?wo(wo([][Symbol.iterator]())):yr,"%JSON%":typeof JSON=="object"?JSON:yr,"%Map%":typeof Map>"u"?yr:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Wp||!wo?yr:wo(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Wj,"%Object.getOwnPropertyDescriptor%":l_,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?yr:Promise,"%Proxy%":typeof Proxy>"u"?yr:Proxy,"%RangeError%":pye,"%ReferenceError%":mye,"%Reflect%":typeof Reflect>"u"?yr:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?yr:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Wp||!wo?yr:wo(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?yr:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Wp&&wo?wo(""[Symbol.iterator]()):yr,"%Symbol%":Wp?Symbol:yr,"%SyntaxError%":Mg,"%ThrowTypeError%":Sye,"%TypedArray%":Cye,"%TypeError%":tg,"%Uint8Array%":typeof Uint8Array>"u"?yr:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?yr:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?yr:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?yr:Uint32Array,"%URIError%":gye,"%WeakMap%":typeof WeakMap>"u"?yr:WeakMap,"%WeakRef%":typeof WeakRef>"u"?yr:WeakRef,"%WeakSet%":typeof WeakSet>"u"?yr:WeakSet,"%Function.prototype.call%":ex,"%Function.prototype.apply%":Xj,"%Object.defineProperty%":wye,"%Math.abs%":vye,"%Math.floor%":yye,"%Math.max%":_ye,"%Math.min%":xye,"%Math.pow%":bye};if(wo)try{null.error}catch(e){var Eye=wo(wo(e));bf["%Error.prototype%"]=Eye}var Tye=function e(t){var n;if(t==="%AsyncFunction%")n=zE("async function () {}");else if(t==="%GeneratorFunction%")n=zE("function* () {}");else if(t==="%AsyncGeneratorFunction%")n=zE("async function* () {}");else if(t==="%AsyncGenerator%"){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=e("%AsyncGenerator%");i&&wo&&(n=wo(i.prototype))}return bf[t]=n,n},U4={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},tx=Q_,dS=vu(),Pye=tx.call(ex,Array.prototype.concat),Aye=tx.call(Xj,Array.prototype.splice),$4=tx.call(ex,String.prototype.replace),fS=tx.call(ex,String.prototype.slice),Iye=tx.call(ex,RegExp.prototype.exec),Rye=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Lye=/\\(\\)?/g,kye=function(t){var n=fS(t,0,1),r=fS(t,-1);if(n==="%"&&r!=="%")throw new Mg("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new Mg("invalid intrinsic syntax, expected opening `%`");var i=[];return $4(t,Rye,function(a,c,s,f){i[i.length]=s?$4(f,Lye,"$1"):c||a}),i},Dye=function(t,n){var r=t,i;if(dS(U4,r)&&(i=U4[r],r="%"+i[0]+"%"),dS(bf,r)){var a=bf[r];if(a===pm&&(a=Tye(r)),typeof a>"u"&&!n)throw new tg("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:a}}throw new Mg("intrinsic "+t+" does not exist!")},ls=function(t,n){if(typeof t!="string"||t.length===0)throw new tg("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new tg('"allowMissing" argument must be a boolean');if(Iye(/^%?[^%]*%?$/,t)===null)throw new Mg("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=kye(t),i=r.length>0?r[0]:"",a=Dye("%"+i+"%",n),c=a.name,s=a.value,f=!1,g=a.alias;g&&(i=g[0],Aye(r,Pye([0,1],g)));for(var _=1,x=!0;_<r.length;_+=1){var C=r[_],E=fS(C,0,1),A=fS(C,-1);if((E==='"'||E==="'"||E==="`"||A==='"'||A==="'"||A==="`")&&E!==A)throw new Mg("property names with quotes must have matching quotes");if((C==="constructor"||!x)&&(f=!0),i+="."+C,c="%"+i+"%",dS(bf,c))s=bf[c];else if(s!=null){if(!(C in s)){if(!n)throw new tg("base intrinsic for "+t+" exists, but the property is not available.");return}if(l_&&_+1>=r.length){var L=l_(s,C);x=!!L,x&&"get"in L&&!("originalValue"in L.get)?s=L.get:s=s[C]}else x=dS(s,C),s=s[C];x&&!f&&(bf[c]=s)}}return s},zye=ls,V4=Oj,Oye=aL(),j4=Ng,H4=rr,Fye=zye("%Math.floor%"),Nye=function(t,n){if(typeof t!="function")throw new H4("`fn` is not a function");if(typeof n!="number"||n<0||n>4294967295||Fye(n)!==n)throw new H4("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,a=!0;if("length"in t&&j4){var c=j4(t,"length");c&&!c.configurable&&(i=!1),c&&!c.writable&&(a=!1)}return(i||a||!r)&&(Oye?V4(t,"length",n,!0,!0):V4(t,"length",n)),t},Bye=Q_,Uye=cL,$ye=Gj,Vye=function(){return $ye(Bye,Uye,arguments)};(function(e){var t=Nye,n=J_,r=uL,i=Vye;e.exports=function(c){var s=r(arguments),f=c.length-(arguments.length-1);return t(s,1+(f>0?f:0),!0)},n?n(e.exports,"apply",{value:i}):e.exports.apply=i})($j);var Zj=$j.exports,jf=function(t){return typeof t=="string"||typeof t=="symbol"},jye=rr,_0=vu(),Hye={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0},Hf=function(t){if(!t||typeof t!="object")return!1;for(var n in t)if(_0(t,n)&&!Hye[n])return!1;var r=_0(t,"[[Value]]")||_0(t,"[[Writable]]"),i=_0(t,"[[Get]]")||_0(t,"[[Set]]");if(r&&i)throw new jye("Property Descriptors may not be both accessor and data descriptors");return!0},Gye=rr,G4=vu(),Wye=Hf,hL=function(t){if(typeof t>"u")return!1;if(!Wye(t))throw new Gye("Assertion failed: `Desc` must be a Property Descriptor");return!(!G4(t,"[[Get]]")&&!G4(t,"[[Set]]"))},FE,W4;function qye(){return W4||(W4=1,FE=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),FE}var Yj=ls,Xye=Yj("%Object.preventExtensions%",!0),Zye=Yj("%Object.isExtensible%",!0),q4=qye(),Yye=Xye?function(t){return!q4(t)&&Zye(t)}:function(t){return!q4(t)},Kj=Function.prototype.toString,Fm=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,DA,iw;if(typeof Fm=="function"&&typeof Object.defineProperty=="function")try{DA=Object.defineProperty({},"length",{get:function(){throw iw}}),iw={},Fm(function(){throw 42},null,DA)}catch(e){e!==iw&&(Fm=null)}else Fm=null;var Kye=/^\s*class\b/,zA=function(t){try{var n=Kj.call(t);return Kye.test(n)}catch{return!1}},NE=function(t){try{return zA(t)?!1:(Kj.call(t),!0)}catch{return!1}},ow=Object.prototype.toString,Jye="[object Object]",Qye="[object Function]",e_e="[object GeneratorFunction]",t_e="[object HTMLAllCollection]",n_e="[object HTML document.all class]",r_e="[object HTMLCollection]",i_e=typeof Symbol=="function"&&!!Symbol.toStringTag,o_e=!(0 in[,]),OA=function(){return!1};if(typeof document=="object"){var s_e=document.all;ow.call(s_e)===ow.call(document.all)&&(OA=function(t){if((o_e||!t)&&(typeof t>"u"||typeof t=="object"))try{var n=ow.call(t);return(n===t_e||n===n_e||n===r_e||n===Jye)&&t("")==null}catch{}return!1})}var Jj=Fm?function(t){if(OA(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{Fm(t,null,DA)}catch(n){if(n!==iw)return!1}return!zA(t)&&NE(t)}:function(t){if(OA(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(i_e)return NE(t);if(zA(t))return!1;var n=ow.call(t);return n!==Qye&&n!==e_e&&!/^\[object HTML/.test(n)?!1:NE(t)},nx=Jj,Qj=function(t){return!!t},Ss=function(t){return!!t&&(typeof t=="function"||typeof t=="object")},Kl=vu(),X1=rr,X4=nx,BE=Qj,a_e=Ss,l_e=function(t){if(!a_e(t))throw new X1("ToPropertyDescriptor requires an object");var n={};if(Kl(t,"enumerable")&&(n["[[Enumerable]]"]=BE(t.enumerable)),Kl(t,"configurable")&&(n["[[Configurable]]"]=BE(t.configurable)),Kl(t,"value")&&(n["[[Value]]"]=t.value),Kl(t,"writable")&&(n["[[Writable]]"]=BE(t.writable)),Kl(t,"get")){var r=t.get;if(typeof r<"u"&&!X4(r))throw new X1("getter must be a function");n["[[Get]]"]=r}if(Kl(t,"set")){var i=t.set;if(typeof i<"u"&&!X4(i))throw new X1("setter must be a function");n["[[Set]]"]=i}if((Kl(n,"[[Get]]")||Kl(n,"[[Set]]"))&&(Kl(n,"[[Value]]")||Kl(n,"[[Writable]]")))throw new X1("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return n},dL=Number.isNaN||function(t){return t!==t},Z4=dL,fL=function(t,n){return t===n?t===0?1/t===1/n:!0:Z4(t)&&Z4(n)},e9=ls,t9=uL,c_e=t9([e9("%String.prototype.indexOf%")]),Zs=function(t,n){var r=e9(t,!!n);return typeof r=="function"&&c_e(t,".prototype.")>-1?t9([r]):r},UE,Y4;function pL(){if(Y4)return UE;Y4=1;var e=ls,t=e("%Array%"),n=!t.isArray&&Zs("Object.prototype.toString");return UE=t.isArray||function(i){return n(i)==="[object Array]"},UE}var u_e=aL,K4=J_,n9=u_e.hasArrayLengthDefineBug(),h_e=n9&&pL(),d_e=Zs,f_e=d_e("Object.prototype.propertyIsEnumerable"),p_e=function(t,n,r,i,a,c){if(!K4){if(!t(c)||!c["[[Configurable]]"]||!c["[[Writable]]"]||a in i&&f_e(i,a)!==!!c["[[Enumerable]]"])return!1;var s=c["[[Value]]"];return i[a]=s,n(i[a],s)}return n9&&a==="length"&&"[[Value]]"in c&&h_e(i)&&i.length!==c["[[Value]]"]?(i.length=c["[[Value]]"],i.length===c["[[Value]]"]):(K4(i,a,r(c)),!0)},m_e=Hf,g_e=function(t,n){return m_e(n)&&"[[Enumerable]]"in n&&"[[Configurable]]"in n&&(t.IsAccessorDescriptor(n)||t.IsDataDescriptor(n))},v_e=function(t){if(typeof t>"u")return t;var n={};return"[[Value]]"in t&&(n.value=t["[[Value]]"]),"[[Writable]]"in t&&(n.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(n.get=t["[[Get]]"]),"[[Set]]"in t&&(n.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(n.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(n.configurable=!!t["[[Configurable]]"]),n},y_e=rr,__e=Hf,x_e=v_e,b_e=function(t){if(typeof t<"u"&&!__e(t))throw new y_e("Assertion failed: `Desc` must be a Property Descriptor");return x_e(t)},w_e=rr,J4=vu(),S_e=Hf,r9=function(t){if(typeof t>"u")return!1;if(!S_e(t))throw new w_e("Assertion failed: `Desc` must be a Property Descriptor");return!(!J4(t,"[[Value]]")&&!J4(t,"[[Writable]]"))},M_e=rr,C_e=hL,E_e=r9,T_e=Hf,P_e=function(t){if(typeof t>"u")return!1;if(!T_e(t))throw new M_e("Assertion failed: `Desc` must be a Property Descriptor");return!C_e(t)&&!E_e(t)},A_e=Ss,I_e=function(t){if(t===null)return"Null";if(typeof t>"u")return"Undefined";if(A_e(t))return"Object";if(typeof t=="number")return"Number";if(typeof t=="boolean")return"Boolean";if(typeof t=="string")return"String"},R_e=I_e,L_e=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":R_e(t)},qp=rr,x0=p_e,k_e=g_e,Q4=Hf,b0=b_e,Wd=hL,Ku=r9,D_e=P_e,z_e=jf,Jl=fL,O_e=L_e,F_e=Ss,N_e=function(t,n,r,i,a){var c=O_e(t);if(typeof t<"u"&&!F_e(t))throw new qp("Assertion failed: O must be undefined or an Object");if(!z_e(n))throw new qp("Assertion failed: P must be a Property Key");if(typeof r!="boolean")throw new qp("Assertion failed: extensible must be a Boolean");if(!Q4(i))throw new qp("Assertion failed: Desc must be a Property Descriptor");if(typeof a<"u"&&!Q4(a))throw new qp("Assertion failed: current must be a Property Descriptor, or undefined");if(typeof a>"u")return r?c==="Undefined"?!0:Wd(i)?x0(Ku,Jl,b0,t,n,i):x0(Ku,Jl,b0,t,n,{"[[Configurable]]":!!i["[[Configurable]]"],"[[Enumerable]]":!!i["[[Enumerable]]"],"[[Value]]":i["[[Value]]"],"[[Writable]]":!!i["[[Writable]]"]}):!1;if(!k_e({IsAccessorDescriptor:Wd,IsDataDescriptor:Ku},a))throw new qp("`current`, when present, must be a fully populated and valid Property Descriptor");if(!a["[[Configurable]]"]){if("[[Configurable]]"in i&&i["[[Configurable]]"]||"[[Enumerable]]"in i&&!Jl(i["[[Enumerable]]"],a["[[Enumerable]]"])||!D_e(i)&&!Jl(Wd(i),Wd(a)))return!1;if(Wd(a)){if("[[Get]]"in i&&!Jl(i["[[Get]]"],a["[[Get]]"])||"[[Set]]"in i&&!Jl(i["[[Set]]"],a["[[Set]]"]))return!1}else if(!a["[[Writable]]"]&&("[[Writable]]"in i&&i["[[Writable]]"]||"[[Value]]"in i&&!Jl(i["[[Value]]"],a["[[Value]]"])))return!1}if(c!=="Undefined"){var s,f;return Ku(a)&&Wd(i)?(s=("[[Configurable]]"in i?i:a)["[[Configurable]]"],f=("[[Enumerable]]"in i?i:a)["[[Enumerable]]"],x0(Ku,Jl,b0,t,n,{"[[Configurable]]":!!s,"[[Enumerable]]":!!f,"[[Get]]":("[[Get]]"in i?i:a)["[[Get]]"],"[[Set]]":("[[Set]]"in i?i:a)["[[Set]]"]})):Wd(a)&&Ku(i)?(s=("[[Configurable]]"in i?i:a)["[[Configurable]]"],f=("[[Enumerable]]"in i?i:a)["[[Enumerable]]"],x0(Ku,Jl,b0,t,n,{"[[Configurable]]":!!s,"[[Enumerable]]":!!f,"[[Value]]":("[[Value]]"in i?i:a)["[[Value]]"],"[[Writable]]":!!("[[Writable]]"in i?i:a)["[[Writable]]"]})):x0(Ku,Jl,b0,t,n,i)}return!0},eF=Ng,tF=nd,$E=rr,B_e=Hf,U_e=hL,$_e=Yye,V_e=jf,j_e=l_e,H_e=fL,G_e=N_e,W_e=Ss,q_e=function(t,n,r){if(!W_e(t))throw new $E("Assertion failed: O must be an Object");if(!V_e(n))throw new $E("Assertion failed: P must be a Property Key");if(!B_e(r))throw new $E("Assertion failed: Desc must be a Property Descriptor");if(!eF){if(U_e(r))throw new tF("This environment does not support accessor property descriptors.");var i=!(n in t)&&r["[[Writable]]"]&&r["[[Enumerable]]"]&&r["[[Configurable]]"]&&"[[Value]]"in r,a=n in t&&(!("[[Configurable]]"in r)||r["[[Configurable]]"])&&(!("[[Enumerable]]"in r)||r["[[Enumerable]]"])&&(!("[[Writable]]"in r)||r["[[Writable]]"])&&"[[Value]]"in r;if(i||a)return t[n]=r["[[Value]]"],H_e(t[n],r["[[Value]]"]);throw new tF("This environment does not support defining non-writable, non-enumerable, or non-configurable properties")}var c=eF(t,n),s=c&&j_e(c),f=$_e(t);return G_e(t,n,f,r,s)},nF=rr,X_e=jf,Z_e=q_e,Y_e=Ss,K_e=function(t,n,r){if(!Y_e(t))throw new nF("Assertion failed: Type(O) is not Object");if(!X_e(n))throw new nF("Assertion failed: P is not a Property Key");var i={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Value]]":r,"[[Writable]]":!0};return Z_e(t,n,i)},VE=rr,J_e=K_e,Q_e=Ss,exe=jf,txe=function(t,n,r){if(!Q_e(t))throw new VE("Assertion failed: Type(O) is not Object");if(!exe(n))throw new VE("Assertion failed: P is not a Property Key");var i=J_e(t,n,r);if(!i)throw new VE("unable to create data property")},jE,rF;function mL(){return rF||(rF=1,jE=pL()),jE}var gL=function(t,n){for(var r=0;r<t.length;r+=1)n(t[r],r,t)};const nxe={},rxe=Object.freeze(Object.defineProperty({__proto__:null,default:nxe},Symbol.toStringTag,{value:"Module"})),ixe=Yq(rxe);var HE,iF;function rd(){if(iF)return HE;iF=1;var e=typeof Map=="function"&&Map.prototype,t=Object.getOwnPropertyDescriptor&&e?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,n=e&&t&&typeof t.get=="function"?t.get:null,r=e&&Map.prototype.forEach,i=typeof Set=="function"&&Set.prototype,a=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=i&&a&&typeof a.get=="function"?a.get:null,s=i&&Set.prototype.forEach,f=typeof WeakMap=="function"&&WeakMap.prototype,g=f?WeakMap.prototype.has:null,_=typeof WeakSet=="function"&&WeakSet.prototype,x=_?WeakSet.prototype.has:null,C=typeof WeakRef=="function"&&WeakRef.prototype,E=C?WeakRef.prototype.deref:null,A=Boolean.prototype.valueOf,L=Object.prototype.toString,I=Function.prototype.toString,T=String.prototype.match,O=String.prototype.slice,D=String.prototype.replace,U=String.prototype.toUpperCase,H=String.prototype.toLowerCase,V=RegExp.prototype.test,q=Array.prototype.concat,Q=Array.prototype.join,K=Array.prototype.slice,N=Math.floor,re=typeof BigInt=="function"?BigInt.prototype.valueOf:null,ye=Object.getOwnPropertySymbols,ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ve=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Ie=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ve||!0)?Symbol.toStringTag:null,ve=Object.prototype.propertyIsEnumerable,Se=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(Z){return Z.__proto__}:null);function Me(Z,le){if(Z===1/0||Z===-1/0||Z!==Z||Z&&Z>-1e3&&Z<1e3||V.call(/e/,le))return le;var Te=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof Z=="number"){var $e=Z<0?-N(-Z):N(Z);if($e!==Z){var fe=String($e),xe=O.call(le,fe.length+1);return D.call(fe,Te,"$&_")+"."+D.call(D.call(xe,/([0-9]{3})/g,"$&_"),/_$/,"")}}return D.call(le,Te,"$&_")}var Be=ixe,Qe=Be.custom,st=hn(Qe)?Qe:null,ct={__proto__:null,double:'"',single:"'"},Xt={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};HE=function Z(le,Te,$e,fe){var xe=Te||{};if(Ut(xe,"quoteStyle")&&!Ut(ct,xe.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ut(xe,"maxStringLength")&&(typeof xe.maxStringLength=="number"?xe.maxStringLength<0&&xe.maxStringLength!==1/0:xe.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Re=Ut(xe,"customInspect")?xe.customInspect:!0;if(typeof Re!="boolean"&&Re!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ut(xe,"indent")&&xe.indent!==null&&xe.indent!=="	"&&!(parseInt(xe.indent,10)===xe.indent&&xe.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ut(xe,"numericSeparator")&&typeof xe.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var De=xe.numericSeparator;if(typeof le>"u")return"undefined";if(le===null)return"null";if(typeof le=="boolean")return le?"true":"false";if(typeof le=="string")return wt(le,xe);if(typeof le=="number"){if(le===0)return 1/0/le>0?"0":"-0";var ze=String(le);return De?Me(le,ze):ze}if(typeof le=="bigint"){var Je=String(le)+"n";return De?Me(le,Je):Je}var Oe=typeof xe.depth>"u"?5:xe.depth;if(typeof $e>"u"&&($e=0),$e>=Oe&&Oe>0&&typeof le=="object")return Ot(le)?"[Array]":"[Object]";var Et=_e(xe,$e);if(typeof fe>"u")fe=[];else if(An(fe,le)>=0)return"[Circular]";function Ft(Wt,pn,cr){if(pn&&(fe=K.call(fe),fe.push(pn)),cr){var qn={depth:xe.depth};return Ut(xe,"quoteStyle")&&(qn.quoteStyle=xe.quoteStyle),Z(Wt,qn,$e+1,fe)}return Z(Wt,xe,$e+1,fe)}if(typeof le=="function"&&!ot(le)){var be=Dt(le),qe=ne(le,Ft);return"[Function"+(be?": "+be:" (anonymous)")+"]"+(qe.length>0?" { "+Q.call(qe,", ")+" }":"")}if(hn(le)){var tt=Ve?D.call(String(le),/^(Symbol\(.*\))_[^)]*$/,"$1"):ge.call(le);return typeof le=="object"&&!Ve?Lt(tt):tt}if(It(le)){for(var At="<"+H.call(String(le.nodeName)),Ht=le.attributes||[],Yt=0;Yt<Ht.length;Yt++)At+=" "+Ht[Yt].name+"="+je(lt(Ht[Yt].value),"double",xe);return At+=">",le.childNodes&&le.childNodes.length&&(At+="..."),At+="</"+H.call(String(le.nodeName))+">",At}if(Ot(le)){if(le.length===0)return"[]";var qt=ne(le,Ft);return Et&&!zt(qt)?"["+ee(qt,Et)+"]":"[ "+Q.call(qt,", ")+" ]"}if(Tt(le)){var Gt=ne(le,Ft);return!("cause"in Error.prototype)&&"cause"in le&&!ve.call(le,"cause")?"{ ["+String(le)+"] "+Q.call(q.call("[cause]: "+Ft(le.cause),Gt),", ")+" }":Gt.length===0?"["+String(le)+"]":"{ ["+String(le)+"] "+Q.call(Gt,", ")+" }"}if(typeof le=="object"&&Re){if(st&&typeof le[st]=="function"&&Be)return Be(le,{depth:Oe-$e});if(Re!=="symbol"&&typeof le.inspect=="function")return le.inspect()}if(an(le)){var yn=[];return r&&r.call(le,function(Wt,pn){yn.push(Ft(pn,le,!0)+" => "+Ft(Wt,le))}),bn("Map",n.call(le),yn,Et)}if(it(le)){var gt=[];return s&&s.call(le,function(Wt){gt.push(Ft(Wt,le))}),bn("Set",c.call(le),gt,Et)}if(Le(le))return kt("WeakMap");if(St(le))return kt("WeakSet");if(me(le))return kt("WeakRef");if(un(le))return Lt(Ft(Number(le)));if(We(le))return Lt(Ft(re.call(le)));if(gn(le))return Lt(A.call(le));if(Ct(le))return Lt(Ft(String(le)));if(typeof window<"u"&&le===window)return"{ [object Window] }";if(typeof globalThis<"u"&&le===globalThis||typeof lP<"u"&&le===lP)return"{ [object globalThis] }";if(!ut(le)&&!ot(le)){var In=ne(le,Ft),cn=Se?Se(le)===Object.prototype:le instanceof Object||le.constructor===Object,Nn=le instanceof Object?"":"null prototype",xt=!cn&&Ie&&Object(le)===le&&Ie in le?O.call(tn(le),8,-1):Nn?"Object":"",Ze=cn||typeof le.constructor!="function"?"":le.constructor.name?le.constructor.name+" ":"",Rt=Ze+(xt||Nn?"["+Q.call(q.call([],xt||[],Nn||[]),": ")+"] ":"");return In.length===0?Rt+"{}":Et?Rt+"{"+ee(In,Et)+"}":Rt+"{ "+Q.call(In,", ")+" }"}return String(le)};function je(Z,le,Te){var $e=Te.quoteStyle||le,fe=ct[$e];return fe+Z+fe}function lt(Z){return D.call(String(Z),/"/g,"&quot;")}function Ot(Z){return tn(Z)==="[object Array]"&&(!Ie||!(typeof Z=="object"&&Ie in Z))}function ut(Z){return tn(Z)==="[object Date]"&&(!Ie||!(typeof Z=="object"&&Ie in Z))}function ot(Z){return tn(Z)==="[object RegExp]"&&(!Ie||!(typeof Z=="object"&&Ie in Z))}function Tt(Z){return tn(Z)==="[object Error]"&&(!Ie||!(typeof Z=="object"&&Ie in Z))}function Ct(Z){return tn(Z)==="[object String]"&&(!Ie||!(typeof Z=="object"&&Ie in Z))}function un(Z){return tn(Z)==="[object Number]"&&(!Ie||!(typeof Z=="object"&&Ie in Z))}function gn(Z){return tn(Z)==="[object Boolean]"&&(!Ie||!(typeof Z=="object"&&Ie in Z))}function hn(Z){if(Ve)return Z&&typeof Z=="object"&&Z instanceof Symbol;if(typeof Z=="symbol")return!0;if(!Z||typeof Z!="object"||!ge)return!1;try{return ge.call(Z),!0}catch{}return!1}function We(Z){if(!Z||typeof Z!="object"||!re)return!1;try{return re.call(Z),!0}catch{}return!1}var vn=Object.prototype.hasOwnProperty||function(Z){return Z in this};function Ut(Z,le){return vn.call(Z,le)}function tn(Z){return L.call(Z)}function Dt(Z){if(Z.name)return Z.name;var le=T.call(I.call(Z),/^function\s*([\w$]+)/);return le?le[1]:null}function An(Z,le){if(Z.indexOf)return Z.indexOf(le);for(var Te=0,$e=Z.length;Te<$e;Te++)if(Z[Te]===le)return Te;return-1}function an(Z){if(!n||!Z||typeof Z!="object")return!1;try{n.call(Z);try{c.call(Z)}catch{return!0}return Z instanceof Map}catch{}return!1}function Le(Z){if(!g||!Z||typeof Z!="object")return!1;try{g.call(Z,g);try{x.call(Z,x)}catch{return!0}return Z instanceof WeakMap}catch{}return!1}function me(Z){if(!E||!Z||typeof Z!="object")return!1;try{return E.call(Z),!0}catch{}return!1}function it(Z){if(!c||!Z||typeof Z!="object")return!1;try{c.call(Z);try{n.call(Z)}catch{return!0}return Z instanceof Set}catch{}return!1}function St(Z){if(!x||!Z||typeof Z!="object")return!1;try{x.call(Z,x);try{g.call(Z,g)}catch{return!0}return Z instanceof WeakSet}catch{}return!1}function It(Z){return!Z||typeof Z!="object"?!1:typeof HTMLElement<"u"&&Z instanceof HTMLElement?!0:typeof Z.nodeName=="string"&&typeof Z.getAttribute=="function"}function wt(Z,le){if(Z.length>le.maxStringLength){var Te=Z.length-le.maxStringLength,$e="... "+Te+" more character"+(Te>1?"s":"");return wt(O.call(Z,0,le.maxStringLength),le)+$e}var fe=Xt[le.quoteStyle||"single"];fe.lastIndex=0;var xe=D.call(D.call(Z,fe,"\\$1"),/[\x00-\x1f]/g,Zt);return je(xe,"single",le)}function Zt(Z){var le=Z.charCodeAt(0),Te={8:"b",9:"t",10:"n",12:"f",13:"r"}[le];return Te?"\\"+Te:"\\x"+(le<16?"0":"")+U.call(le.toString(16))}function Lt(Z){return"Object("+Z+")"}function kt(Z){return Z+" { ? }"}function bn(Z,le,Te,$e){var fe=$e?ee(Te,$e):Q.call(Te,", ");return Z+" ("+le+") {"+fe+"}"}function zt(Z){for(var le=0;le<Z.length;le++)if(An(Z[le],`
`)>=0)return!1;return!0}function _e(Z,le){var Te;if(Z.indent==="	")Te="	";else if(typeof Z.indent=="number"&&Z.indent>0)Te=Q.call(Array(Z.indent+1)," ");else return null;return{base:Te,prev:Q.call(Array(le+1),Te)}}function ee(Z,le){if(Z.length===0)return"";var Te=`
`+le.prev+le.base;return Te+Q.call(Z,","+Te)+`
`+le.prev}function ne(Z,le){var Te=Ot(Z),$e=[];if(Te){$e.length=Z.length;for(var fe=0;fe<Z.length;fe++)$e[fe]=Ut(Z,fe)?le(Z[fe],Z):""}var xe=typeof ye=="function"?ye(Z):[],Re;if(Ve){Re={};for(var De=0;De<xe.length;De++)Re["$"+xe[De]]=xe[De]}for(var ze in Z)Ut(Z,ze)&&(Te&&String(Number(ze))===ze&&ze<Z.length||Ve&&Re["$"+ze]instanceof Symbol||(V.call(/[^\w$]/,ze)?$e.push(le(ze,Z)+": "+le(Z[ze],Z)):$e.push(ze+": "+le(Z[ze],Z))));if(typeof ye=="function")for(var Je=0;Je<xe.length;Je++)ve.call(Z,xe[Je])&&$e.push("["+le(xe[Je])+"]: "+le(Z[xe[Je]],Z));return $e}return HE}var GE,oF;function oxe(){if(oF)return GE;oF=1;var e=rd(),t=rr,n=function(s,f,g){for(var _=s,x;(x=_.next)!=null;_=x)if(x.key===f)return _.next=x.next,g||(x.next=s.next,s.next=x),x},r=function(s,f){if(s){var g=n(s,f);return g&&g.value}},i=function(s,f,g){var _=n(s,f);_?_.value=g:s.next={key:f,next:s.next,value:g}},a=function(s,f){return s?!!n(s,f):!1},c=function(s,f){if(s)return n(s,f,!0)};return GE=function(){var f,g={assert:function(_){if(!g.has(_))throw new t("Side channel does not contain "+e(_))},delete:function(_){var x=f&&f.next,C=c(f,_);return C&&x&&x===C&&(f=void 0),!!C},get:function(_){return r(f,_)},has:function(_){return a(f,_)},set:function(_,x){f||(f={next:void 0}),i(f,_,x)}};return g},GE}var WE,sF;function i9(){if(sF)return WE;sF=1;var e=ls,t=Zs,n=rd(),r=rr,i=e("%Map%",!0),a=t("Map.prototype.get",!0),c=t("Map.prototype.set",!0),s=t("Map.prototype.has",!0),f=t("Map.prototype.delete",!0),g=t("Map.prototype.size",!0);return WE=!!i&&function(){var x,C={assert:function(E){if(!C.has(E))throw new r("Side channel does not contain "+n(E))},delete:function(E){if(x){var A=f(x,E);return g(x)===0&&(x=void 0),A}return!1},get:function(E){if(x)return a(x,E)},has:function(E){return x?s(x,E):!1},set:function(E,A){x||(x=new i),c(x,E,A)}};return C},WE}var qE,aF;function sxe(){if(aF)return qE;aF=1;var e=ls,t=Zs,n=rd(),r=i9(),i=rr,a=e("%WeakMap%",!0),c=t("WeakMap.prototype.get",!0),s=t("WeakMap.prototype.set",!0),f=t("WeakMap.prototype.has",!0),g=t("WeakMap.prototype.delete",!0);return qE=a?function(){var x,C,E={assert:function(A){if(!E.has(A))throw new i("Side channel does not contain "+n(A))},delete:function(A){if(a&&A&&(typeof A=="object"||typeof A=="function")){if(x)return g(x,A)}else if(r&&C)return C.delete(A);return!1},get:function(A){return a&&A&&(typeof A=="object"||typeof A=="function")&&x?c(x,A):C&&C.get(A)},has:function(A){return a&&A&&(typeof A=="object"||typeof A=="function")&&x?f(x,A):!!C&&C.has(A)},set:function(A,L){a&&A&&(typeof A=="object"||typeof A=="function")?(x||(x=new a),s(x,A,L)):r&&(C||(C=r()),C.set(A,L))}};return E}:r,qE}var XE,lF;function axe(){if(lF)return XE;lF=1;var e=rr,t=rd(),n=oxe(),r=i9(),i=sxe(),a=i||r||n;return XE=function(){var s,f={assert:function(g){if(!f.has(g))throw new e("Side channel does not contain "+t(g))},delete:function(g){return!!s&&s.delete(g)},get:function(g){return s&&s.get(g)},has:function(g){return!!s&&s.has(g)},set:function(g,_){s||(s=a()),s.set(g,_)}};return f},XE}var ZE,cF;function vL(){if(cF)return ZE;cF=1;var e=vu(),t=axe()(),n=rr,r={assert:function(i,a){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof a!="string")throw new n("`slot` must be a string");if(t.assert(i),!r.has(i,a))throw new n("`"+a+"` is not present on `O`")},get:function(i,a){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof a!="string")throw new n("`slot` must be a string");var c=t.get(i);return c&&c["$"+a]},has:function(i,a){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof a!="string")throw new n("`slot` must be a string");var c=t.get(i);return!!c&&e(c,"$"+a)},set:function(i,a,c){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof a!="string")throw new n("`slot` must be a string");var s=t.get(i);s||(s={},t.set(i,s)),s["$"+a]=c}};return Object.freeze&&Object.freeze(r),ZE=r,ZE}var YE,uF;function lxe(){if(uF)return YE;uF=1;var e={__proto__:null,foo:{}},t={__proto__:e}.foo===e.foo&&!(e instanceof Object);return YE=function(){return t},YE}var cxe=ls,hF=cxe("%Object.create%",!0),dF=rr,uxe=nd,hxe=mL(),dxe=gL,fxe=Ss,pxe=vL(),mxe=lxe()(),o9=function(t){if(t!==null&&!fxe(t))throw new dF("Assertion failed: `proto` must be null or an object");var n=arguments.length<2?[]:arguments[1];if(!hxe(n))throw new dF("Assertion failed: `additionalInternalSlotsList` must be an Array");var r;if(hF)r=hF(t);else if(mxe)r={__proto__:t};else{if(t===null)throw new uxe("native Object.create support is required to create null objects");var i=function(){};i.prototype=t,r=new i}return n.length>0&&dxe(n,function(a){pxe.set(r,a,void 0)}),r},gxe=function(t){return t===0&&1/t===-1/0},s9=Number.MAX_SAFE_INTEGER||9007199254740991,KE,fF;function vxe(){return fF||(fF=1,KE=function(t,n){for(var r=0;r<t.length;r+=1)if(!n(t[r],r,t))return!1;return!0}),KE}var pF=rr,yxe=Zs,mF=yxe("Array.prototype.push"),_xe=fL,a9=pL(),xxe=vxe(),bxe=gL,gF=vu(),wxe=function(e){return gF(e,"[[Key]]")&&gF(e,"[[Elements]]")&&a9(e["[[Elements]]"])},Sxe=function(t,n,r){if(!a9(t)||t.length>0&&!xxe(t,wxe))throw new pF("Assertion failed: `groups` must be a List of Records with [[Key]] and [[Elements]]");var i=0;if(bxe(t,function(c){if(_xe(c["[[Key]]"],n)){if(i+=1,i>1)throw new pF("Assertion failed: Exactly one element of groups meets this criterion");mF(c["[[Elements]]"],r)}}),i===0){var a={"[[Key]]":n,"[[Elements]]":[r]};mF(t,a)}},Mxe=ls,Cxe=Zs,Exe=rr,Txe=mL(),Pxe=Mxe("%Reflect.apply%",!0)||Cxe("Function.prototype.apply"),rx=function(t,n){var r=arguments.length>2?arguments[2]:[];if(!Txe(r))throw new Exe("Assertion failed: optional `argumentsList`, if provided, must be a List");return Pxe(t,n,r)},JE,vF;function l9(){return vF||(vF=1,JE=function(t){return typeof t=="number"&&t>=55296&&t<=56319}),JE}var QE,yF;function c9(){return yF||(yF=1,QE=function(t){return typeof t=="number"&&t>=56320&&t<=57343}),QE}var eT,_F;function Axe(){if(_F)return eT;_F=1;var e=ls,t=rr,n=e("%String.fromCharCode%"),r=l9(),i=c9();return eT=function(c,s){if(!r(c)||!i(s))throw new t("Assertion failed: `lead` must be a leading surrogate char code, and `trail` must be a trailing surrogate char code");return n(c)+n(s)},eT}var tT,xF;function Ixe(){if(xF)return tT;xF=1;var e=rr,t=Zs,n=l9(),r=c9(),i=Axe(),a=t("String.prototype.charAt"),c=t("String.prototype.charCodeAt");return tT=function(f,g){if(typeof f!="string")throw new e("Assertion failed: `string` must be a String");var _=f.length;if(g<0||g>=_)throw new e("Assertion failed: `position` must be >= 0, and < the length of `string`");var x=c(f,g),C=a(f,g),E=n(x),A=r(x);if(!E&&!A)return{"[[CodePoint]]":C,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!1};if(A||g+1===_)return{"[[CodePoint]]":C,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0};var L=c(f,g+1);return r(L)?{"[[CodePoint]]":i(x,L),"[[CodeUnitCount]]":2,"[[IsUnpairedSurrogate]]":!1}:{"[[CodePoint]]":C,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0}},tT}var nT,bF;function Rxe(){if(bF)return nT;bF=1;var e=dL;return nT=function(n){return(typeof n=="number"||typeof n=="bigint")&&!e(n)&&n!==1/0&&n!==-1/0},nT}var rT,wF;function Lxe(){if(wF)return rT;wF=1;var e=Vj,t=jj,n=dL,r=Rxe();return rT=function(a){if(typeof a!="number"||n(a)||!r(a))return!1;var c=e(a);return t(c)===c},rT}var iT,SF;function kxe(){if(SF)return iT;SF=1;var e=Ixe(),t=rr,n=Lxe(),r=s9;return iT=function(a,c,s){if(typeof a!="string")throw new t("Assertion failed: `S` must be a String");if(!n(c)||c<0||c>r)throw new t("Assertion failed: `length` must be an integer >= 0 and <= 2**53");if(typeof s!="boolean")throw new t("Assertion failed: `unicode` must be a Boolean");if(!s)return c+1;var f=a.length;if(c+1>=f)return c+1;var g=e(a,c);return c+g["[[CodeUnitCount]]"]},iT}var oT,MF;function u9(){if(MF)return oT;MF=1;var e=rr;return oT=function(n,r){if(typeof r!="boolean")throw new e("Assertion failed: Type(done) is not Boolean");return{value:n,done:r}},oT}var CF=rr,Dxe=rd(),zxe=Ss,Oxe=jf,nC=function(t,n){if(!zxe(t))throw new CF("Assertion failed: Type(O) is not Object");if(!Oxe(n))throw new CF("Assertion failed: P is not a Property Key, got "+Dxe(n));return t[n]},Fxe=rr,Nxe=nC,Bxe=Qj,Uxe=Ss,h9=function(t){if(!Uxe(t))throw new Fxe("Assertion failed: Type(iterResult) is not Object");return Bxe(Nxe(t,"done"))},$xe=rr,Vxe=nC,jxe=Ss,d9=function(t){if(!jxe(t))throw new $xe("Assertion failed: Type(iterResult) is not Object");return Vxe(t,"value")},sT,EF;function Hxe(){if(EF)return sT;EF=1;var e=ls,t=Zj,n=nd,r=e("%Promise.resolve%",!0),i=r&&t(r);return sT=function(c,s){if(!i)throw new n("This environment does not support Promises.");return i(c,s)},sT}var aT,TF;function Gxe(){if(TF)return aT;TF=1;var e=ls,t=nd,n=rr,r=e("%Promise%",!0),i=Zs,a=u9(),c=h9,s=d9,f=Hxe(),g=Ss,_=i("Promise.prototype.then",!0);return aT=function(C){if(!g(C))throw new n("Assertion failed: Type(O) is not Object");if(arguments.length>1)throw new t("although AsyncFromSyncIteratorContinuation should take a second argument, it is not used in this implementation");if(!r)throw new t("This environment does not support Promises.");return new r(function(E){var A=c(C),L=s(C),I=f(r,L),T=function(O){return a(O,A)};E(_(I,T))})},aT}var Wxe=rr,qxe=rd(),Xxe=jf,Zxe=function(t,n){if(!Xxe(n))throw new Wxe("Assertion failed: P is not a Property Key, got "+qxe(n));return t[n]},PF=rr,Yxe=Zxe,Kxe=nx,Jxe=jf,AF=rd(),yL=function(t,n){if(!Jxe(n))throw new PF("Assertion failed: P is not a Property Key");var r=Yxe(t,n);if(r!=null){if(!Kxe(r))throw new PF(AF(n)+" is not a function: "+AF(r));return r}},lT=vu(),rC=function(t){return!!t&&typeof t=="object"&&lT(t,"[[Iterator]]")&&lT(t,"[[NextMethod]]")&&lT(t,"[[Done]]")&&typeof t["[[Done]]"]=="boolean"},IF=rr,RF=rx,Qxe=Ss,e1e=rC,f9=function(t){if(!e1e(t))throw new IF("Assertion failed: `iteratorRecord` must be an Iterator Record");var n;if(arguments.length<2?n=RF(t["[[NextMethod]]"],t["[[Iterator]]"]):n=RF(t["[[NextMethod]]"],t["[[Iterator]]"],[arguments[1]]),!Qxe(n))throw new IF("iterator next must return an object");return n},cT,LF;function t1e(){if(LF)return cT;LF=1;var e=ls,t=nd,n=rr,r=e("%Promise%",!0),i=Gxe(),a=rx,c=u9(),s=nC,f=yL,g=f9,_=o9,x=Ss,C=rC,E=vL(),A=e("%AsyncFromSyncIteratorPrototype%",!0)||{next:function(I){if(!r)throw new t("This environment does not support Promises.");var T=this;E.assert(T,"[[SyncIteratorRecord]]");var O=arguments.length;return new r(function(D){var U=E.get(T,"[[SyncIteratorRecord]]"),H;O>0?H=g(U,I):H=g(U),D(i(H))})},return:function(){if(!r)throw new t("This environment does not support Promises.");var L=this;E.assert(L,"[[SyncIteratorRecord]]");var I=arguments.length>0,T=I?arguments[0]:void 0;return new r(function(O,D){var U=E.get(L,"[[SyncIteratorRecord]]")["[[Iterator]]"],H=f(U,"return");if(typeof H>"u"){var V=c(T,!0);a(O,void 0,[V]);return}var q;if(I?q=a(H,U,[T]):q=a(H,U),!x(q)){a(D,void 0,[new n("Iterator `return` method returned a non-object value.")]);return}O(i(q))})},throw:function(){if(!r)throw new t("This environment does not support Promises.");var L=this;E.assert(L,"[[SyncIteratorRecord]]");var I=arguments.length>0,T=I?arguments[0]:void 0;return new r(function(O,D){var U=E.get(L,"[[SyncIteratorRecord]]")["[[Iterator]]"],H=f(U,"throw");if(typeof H>"u"){a(D,void 0,[T]);return}var V;if(I?V=a(H,U,[T]):V=a(H,U),!x(V)){a(D,void 0,[new n("Iterator `throw` method returned a non-object value.")]);return}O(i(V))})}};return cT=function(I){if(!C(I))throw new n("Assertion failed: `syncIteratorRecord` must be an Iterator Record");var T=_(A);E.set(T,"[[SyncIteratorRecord]]",I);var O=s(T,"next");return{"[[Iterator]]":T,"[[NextMethod]]":O,"[[Done]]":!1}},cT}var uT,kF;function n1e(){if(kF)return uT;kF=1;var e=rr,t=rx,n=nC,r=nx,i=Ss;return uT=function(c,s){if(!r(s))throw new e("method must be a function");var f=t(s,c);if(!i(f))throw new e("iterator must return an object");var g=n(f,"next");return{"[[Iterator]]":f,"[[NextMethod]]":g,"[[Done]]":!1}},uT}var hT,DF;function _L(){if(DF)return hT;DF=1;var e=Hj();return hT=function(){return e()&&!!Symbol.toStringTag},hT}var dT,zF;function r1e(){if(zF)return dT;zF=1;var e=Zs,t=e("String.prototype.valueOf"),n=function(s){try{return t(s),!0}catch{return!1}},r=e("Object.prototype.toString"),i="[object String]",a=_L()();return dT=function(s){return typeof s=="string"?!0:!s||typeof s!="object"?!1:a?n(s):r(s)===i},dT}var fT,OF;function i1e(){if(OF)return fT;OF=1;var e=tC()(),t=ls,n=Zs,r=r1e(),i=t("%Symbol.iterator%",!0),a=n("String.prototype.slice"),c=t("%String%");return fT=function(f,g){var _;return e?_=f.GetMethod(g,i):f.IsArray(g)?_=function(){var x=-1,C=this;return{next:function(){return x+=1,{done:x>=C.length,value:C[x]}}}}:r(g)&&(_=function(){var x=0;return{next:function(){var C=f.AdvanceStringIndex(c(g),x,!0),E=a(g,x,C);return x=C,{done:C>g.length,value:E}}}}),_},fT}var o1e=ls,pT=rr,FF=o1e("%Symbol.asyncIterator%",!0),s1e=rd(),a1e=tC()(),l1e=kxe(),c1e=t1e(),NF=n1e(),p9=yL,u1e=mL(),h1e={AdvanceStringIndex:l1e,GetMethod:p9,IsArray:u1e},d1e=i1e(),f1e=function(t,n){if(n!=="SYNC"&&n!=="ASYNC")throw new pT("Assertion failed: `kind` must be one of 'sync' or 'async', got "+s1e(n));var r;if(n==="ASYNC"&&a1e&&FF&&(r=p9(t,FF)),typeof r>"u"){var i=d1e(h1e,t);if(n==="ASYNC"){if(typeof i>"u")throw new pT("iterator method is `undefined`");var a=NF(t,i);return c1e(a)}r=i}if(typeof r>"u")throw new pT("iterator method is `undefined`");return NF(t,r)},m9=nd,Vh=vL(),ix=function e(t,n){if(!(this instanceof e))return new e(t,n);if(t!=="normal"&&t!=="break"&&t!=="continue"&&t!=="return"&&t!=="throw")throw new m9('Assertion failed: `type` must be one of "normal", "break", "continue", "return", or "throw"');Vh.set(this,"[[Type]]",t),Vh.set(this,"[[Value]]",n)};ix.prototype.type=function(){return Vh.get(this,"[[Type]]")};ix.prototype.value=function(){return Vh.get(this,"[[Value]]")};ix.prototype["?"]=function(){var t=Vh.get(this,"[[Type]]"),n=Vh.get(this,"[[Value]]");if(t==="throw")throw n;return n};ix.prototype["!"]=function(){var t=Vh.get(this,"[[Type]]");if(t!=="normal")throw new m9('Assertion failed: Completion Record is not of type "normal"');return Vh.get(this,"[[Value]]")};var g9=ix,Z1=rr,p1e=rx,BF=g9,m1e=yL,g1e=nx,UF=Ss,v1e=rC,y1e=function(t,n){if(!v1e(t))throw new Z1("Assertion failed: `iteratorRecord` must be an Iterator Record");if(!UF(t["[[Iterator]]"]))throw new Z1("Assertion failed: iteratorRecord.[[Iterator]] must be an Object");if(!g1e(n)&&!(n instanceof BF))throw new Z1("Assertion failed: completion is not a thunk representing a Completion Record, nor a Completion Record instance");var r=n instanceof BF?function(){return n["?"]()}:n,i=t["[[Iterator]]"],a;try{a=m1e(i,"return")}catch(f){throw r(),r=null,f}if(typeof a>"u")return r();var c;try{c=p1e(a,i,[])}catch(f){throw r(),r=null,f}var s=r();if(r=null,!UF(c))throw new Z1("iterator .return must return an object");return s},_1e=rr,x1e=h9,b1e=f9,w1e=rC,S1e=function(t){if(!w1e(t))throw new _1e("Assertion failed: `iteratorRecord` must be an Iterator Record");var n=b1e(t),r=x1e(n);return r===!0?!1:n},M1e=rr,C1e=function(t){if(t==null)throw new M1e(arguments.length>0&&arguments[1]||"Cannot call method on "+t);return t},E1e=C1e,T1e=g9,P1e=function(t){return new T1e("throw",t)},mT,$F;function A1e(){return $F||($F=1,mT=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),mT}var gT,VF;function I1e(){if(VF)return gT;VF=1;var e=Zs,t=e("Date.prototype.getDay"),n=function(s){try{return t(s),!0}catch{return!1}},r=e("Object.prototype.toString"),i="[object Date]",a=_L()();return gT=function(s){return typeof s!="object"||s===null?!1:a?n(s):r(s)===i},gT}var Y1={exports:{}},vT,jF;function R1e(){if(jF)return vT;jF=1;var e=Zs,t=_L()(),n=vu(),r=Ng,i;if(t){var a=e("RegExp.prototype.exec"),c={},s=function(){throw c},f={toString:s,valueOf:s};typeof Symbol.toPrimitive=="symbol"&&(f[Symbol.toPrimitive]=s),i=function(C){if(!C||typeof C!="object")return!1;var E=r(C,"lastIndex"),A=E&&n(E,"value");if(!A)return!1;try{a(C,f)}catch(L){return L===c}}}else{var g=e("Object.prototype.toString"),_="[object RegExp]";i=function(C){return!C||typeof C!="object"&&typeof C!="function"?!1:g(C)===_}}return vT=i,vT}var yT,HF;function L1e(){if(HF)return yT;HF=1;var e=Zs,t=R1e(),n=e("RegExp.prototype.exec"),r=rr;return yT=function(a){if(!t(a))throw new r("`regex` must be a RegExp");return function(s){return n(a,s)!==null}},yT}var GF;function k1e(){if(GF)return Y1.exports;GF=1;var e=Zs,t=e("Object.prototype.toString"),n=tC()(),r=L1e();if(n){var i=e("Symbol.prototype.toString"),a=r(/^Symbol\(.*\)$/),c=function(f){return typeof f.valueOf()!="symbol"?!1:a(i(f))};Y1.exports=function(f){if(typeof f=="symbol")return!0;if(!f||typeof f!="object"||t(f)!=="[object Symbol]")return!1;try{return c(f)}catch{return!1}}}else Y1.exports=function(f){return!1};return Y1.exports}var _T,WF;function D1e(){if(WF)return _T;WF=1;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",t=A1e(),n=Jj,r=I1e(),i=k1e(),a=function(f,g){if(typeof f>"u"||f===null)throw new TypeError("Cannot call method on "+f);if(typeof g!="string"||g!=="number"&&g!=="string")throw new TypeError('hint must be "string" or "number"');var _=g==="string"?["toString","valueOf"]:["valueOf","toString"],x,C,E;for(E=0;E<_.length;++E)if(x=f[_[E]],n(x)&&(C=x.call(f),t(C)))return C;throw new TypeError("No default value")},c=function(f,g){var _=f[g];if(_!==null&&typeof _<"u"){if(!n(_))throw new TypeError(_+" returned for property "+String(g)+" of object "+f+" is not a function");return _}};return _T=function(f){if(t(f))return f;var g="default";arguments.length>1&&(arguments[1]===String?g="string":arguments[1]===Number&&(g="number"));var _;if(e&&(Symbol.toPrimitive?_=c(f,Symbol.toPrimitive):i(f)&&(_=Symbol.prototype.valueOf)),typeof _<"u"){var x=_.call(f,g);if(t(x))return x;throw new TypeError("unable to convert exotic object to primitive")}return g==="default"&&(r(f)||i(f))&&(g="string"),a(f,g==="default"?"number":g)},_T}var xT,qF;function z1e(){if(qF)return xT;qF=1;var e=D1e();return xT=function(n){return arguments.length>1?e(n,arguments[1]):e(n)},xT}var bT,XF;function O1e(){if(XF)return bT;XF=1;var e=ls,t=e("%String%"),n=rr;return bT=function(i){if(typeof i=="symbol")throw new n("Cannot convert a Symbol value to a string");return t(i)},bT}var F1e=ls,N1e=F1e("%String%"),B1e=z1e(),U1e=O1e(),$1e=function(t){var n=B1e(t,N1e);return typeof n=="symbol"?n:U1e(n)},K1=rr,V1e=gxe,j1e=s9,H1e=Sxe,G1e=rx,W1e=f1e,q1e=nx,wT=y1e,X1e=S1e,Z1e=d9,Y1e=E1e,ST=P1e,K1e=$1e,J1e=function(t,n,r){if(r!=="PROPERTY"&&r!=="ZERO")throw new K1('Assertion failed: `keyCoercion` must be `"PROPERTY"` or `"ZERO"`');if(Y1e(t),!q1e(n))throw new K1("callbackfn must be callable");for(var i=[],a=W1e(t,"SYNC"),c=0;;){if(c>=j1e){var s=ST(new K1("k must be less than 2 ** 53 - 1"));wT(a,s);return}var f=X1e(a);if(!f)return i;var g=Z1e(f),_;try{_=G1e(n,void 0,[g,c])}catch(x){wT(a,ST(x));return}if(r==="PROPERTY")try{_=K1e(_)}catch(x){wT(a,ST(x));return}else{if(r!=="ZERO")throw new K1("keyCoercion must be ~PROPERTY~ or ~ZERO~");V1e(_)&&(_=0)}H1e(i,_,g),c+=1}},Q1e=txe,ebe=o9,tbe=gL,nbe=J1e,v9=function(t,n){var r=nbe(t,n,"PROPERTY"),i=ebe(null);return tbe(r,function(a){Q1e(i,a["[[Key]]"],a["[[Elements]]"])}),i},rbe=v9,y9=function(){return Object.groupBy||rbe},MT,ZF;function ibe(){if(ZF)return MT;ZF=1;var e=Uj,t=y9;return MT=function(){var r=t();return e(Object,{groupBy:r},{groupBy:function(){return Object.groupBy!==r}}),r},MT}var obe=Uj,sbe=Zj,abe=v9,_9=y9,lbe=_9(),cbe=ibe(),x9=sbe(lbe,Object);obe(x9,{getPolyfill:_9,implementation:abe,shim:cbe});var ube=x9;const b9=$I(ube),hbe=e=>{const{map:t,selectDecorator:n,onSelect:r}=e,[i,a]=$.useState([]);$.useEffect(()=>{Promise.all([fetch("sprites.json").then(f=>f.json()),fetch("companies.geojson").then(f=>f.json())]).then(([f,g])=>{const _=new Map(Object.entries(g.properties.tokenLut)),x=b9(g.features,E=>nr(_.get(E.properties.token))),C=[];for(const E of Object.values(x)){const A=E[0].properties;if(A.map!==e.map)continue;const L=f[A.token]??{height:0,width:0,x:0,y:0};f[A.token]==null&&console.warn("no sprite for company token:",A.token),C.push({label:_.get(A.token)??A.token,token:A.token,spriteEntry:L,map:A.map,features:E.map(I=>({coordinates:I.geometry.coordinates,dlcGuard:I.properties.dlcGuard}))})}C.sort((E,A)=>E.label.localeCompare(A.label)),a(C)},f=>console.error("could not load company data.",f))},[t]);const c=i.filter(f=>{const g=f.map===t;if(t==="europe")return!0;const _=H_(e.visibleStateDlcs);return g&&f.features.some(x=>_.has(x.dlcGuard))}),s=bM({stringify:f=>f.label});return te.jsx(Qy,{onChange:(f,g)=>r(g),placeholder:"Search companies...",options:c,filterOptions:s,blurOnSelect:!0,autoComplete:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,renderOption:(f,{token:g,spriteEntry:_,label:x})=>$.createElement(x8,{...f,key:g},te.jsx(sy,{children:te.jsx(pie,{sx:{width:_.width+"px",height:_.height+"px",background:`url(sprites.png) -${_.x}px -${_.y}px`}})}),te.jsx(Yw,{children:x}))},t)},FA=[{label:"ATS",value:{map:"usa",search:"cities"}},{label:"ATS",value:{map:"usa",search:"companies"}},{label:"ATS",value:{map:"usa",search:"achievements"}},{label:"ETS2",value:{map:"europe",search:"cities"}},{label:"ETS2",value:{map:"europe",search:"companies"}},{label:"ETS2",value:{map:"europe",search:"achievements"}}],CT=(e,t)=>Lf.checkExists(FA.find(n=>n.value.map===e&&n.value.search===t)),ET=({selected:e,onSelect:t})=>te.jsx(hse,{sx:{paddingBlock:0,minWidth:"fit-content"},variant:"plain",size:"sm",slotProps:{listbox:{placement:"bottom-start"}},value:e,onChange:(n,r)=>{n!=null&&t(nr(FA.find(i=>i.value===r)))},renderValue:n=>{if(n)return te.jsxs(ja,{direction:"row",gap:1,sx:{alignItems:"center"},children:[te.jsx(ci,{level:"body-xs",fontWeight:"lg",children:n.value.map==="usa"?"ATS":"ETS2"}),te.jsx(YF,{search:n.value.search})]})},children:Object.entries(b9(FA,({label:n})=>n)).map(([n,r])=>te.jsxs(D_,{children:[te.jsx(Jh,{children:te.jsx(ci,{level:"body-xs",fontWeight:"lg",children:n})}),r==null?void 0:r.map(i=>te.jsxs(Joe,{value:i.value,sx:{px:"1em",textTransform:"capitalize"},children:[te.jsx(YF,{search:i.value.search}),i.value.search]},i.value.search))]},n))}),YF=({search:e})=>{switch(e){case"cities":return te.jsx(pfe,{});case"companies":return te.jsx(mfe,{});case"achievements":return te.jsx(hfe,{});default:throw new W_(e)}},sw={usa:{longitude:-108,latitude:39},europe:{longitude:12,latitude:51}},dbe=e=>{const t=$.useRef(null);tl(()=>({onAdd:()=>nr(t.current),onRemove:()=>nr(t.current).remove()}),{position:"top-left"});const{current:n}=ZM(),[r,i]=$.useState(CT(localStorage.getItem("tm-map")==="europe"?"europe":"usa",pbe(localStorage.getItem("tm-search")))),a=W0.useCallback(I=>{if(I==null||(i(I),localStorage.setItem("tm-map",I.value.map),localStorage.setItem("tm-search",I.value.search),!n||I.value.map===r.value.map))return;const{longitude:T,latitude:O}=sw[I.value.map];n.easeTo({zoom:4,center:[T,O]})},[n,r]);$.useEffect(()=>{if(!n)return;const I=()=>{const T=n.getCenter().lng,O=KF(T,sw.usa.longitude),D=KF(T,sw.europe.longitude);O<D&&r.value.map!=="usa"?(i(CT("usa",r.value.search)),localStorage.setItem("tm-map","usa")):D<O&&r.value.map!=="europe"&&(i(CT("europe",r.value.search)),localStorage.setItem("tm-map","europe"))};return n.on("moveend",I),()=>void n.off("moveend",I)},[n,r,i]);const c=W0.useCallback(I=>{n==null||I==null||(n.flyTo({curve:1,zoom:9,center:I.value.map(T=>Number(T.toFixed(3)))}),n.once("moveend",T=>{const{lat:O,lng:D}=T.target.getCenter(),U=T.target.getZoom(),H=Number(T.target.getBearing().toFixed(1)),V=Math.round(T.target.getPitch());V?window.location.hash=`${U}/${O.toFixed(3)}/${D.toFixed(3)}/${H}/${V}`:H?window.location.hash=`${U}/${O.toFixed(3)}/${D.toFixed(3)}/${H}`:window.location.hash=`${U}/${O.toFixed(3)}/${D.toFixed(3)}`}))},[n]),[s,f]=$.useState([]),g=I=>W0.useCallback((T,O={enableFitBounds:!0})=>{if(s.forEach(H=>H.remove()),I(T),n==null||T==null)return;const D=H_(e.visibleStateDlcs),U=T.features.filter(H=>D.has(H.dlcGuard)).map(({coordinates:H})=>new KM.Marker().setLngLat(H).addTo(n.getMap()));if(f(U),U.length&&O.enableFitBounds){const H=oj(U.map(Q=>Q.getLngLat().toArray())),V=[H[0],H[1]],q=[H[2],H[3]];n.fitBounds([V,q],{curve:1,padding:100,maxZoom:9})}},[n,s,I,f,e.visibleStateDlcs]),[_,x]=$.useState(null),C=g(x);$.useEffect(()=>{C(_,{enableFitBounds:!1})},[_,e.visibleStateDlcs]);const[E,A]=$.useState(null),L=g(A);return $.useEffect(()=>{L(E,{enableFitBounds:!1})},[E,e.visibleStateDlcs]),te.jsx("div",{ref:t,className:"maplibregl-ctrl",style:{width:"calc(100svw - 64px)"},children:te.jsx(ja,{direction:"row",gap:1,children:te.jsx(fbe,{selected:r.value,onMapSelect:a,onCitySelect:c,onCompanySelect:L,onAchievementSelect:C,visibleStates:e.visibleStates,visibleStateDlcs:e.visibleStateDlcs})})})},fbe=({selected:e,onMapSelect:t,onCitySelect:n,onCompanySelect:r,onAchievementSelect:i,visibleStates:a,visibleStateDlcs:c})=>{switch(e.search){case"cities":return te.jsx(M0e,{selectDecorator:te.jsx(ET,{selected:e,onSelect:t}),map:e.map,onSelect:n,visibleStates:a});case"companies":return te.jsx(hbe,{selectDecorator:te.jsx(ET,{selected:e,onSelect:t}),map:e.map,onSelect:r,visibleStateDlcs:c});case"achievements":return te.jsx(S0e,{selectDecorator:te.jsx(ET,{selected:e,onSelect:t}),map:e.map,onSelect:i,visibleStateDlcs:c});default:throw new W_(e.search)}};function pbe(e){return e==="achievements"||e==="cities"||e==="companies"?e:"cities"}function KF(e,t){const n=t4(e)/2,r=t4(t)/2;return Math.abs(Math.sin(n)-Math.sin(r))}const mbe=e=>{const t=$.useRef(null),[n,r]=$.useState(!1);tl(()=>({onAdd:()=>nr(t.current),onRemove:()=>nr(t.current).remove()}));const i=$.useCallback(()=>{r(!n),e.onToggle(!n)},[n]);return te.jsx("div",{ref:t,className:"maplibregl-ctrl maplibregl-ctrl-group",style:{display:e.visible?"":"none"},children:te.jsx(lu,{slots:{root:lu},sx:{minWidth:0,minHeight:0,borderRadius:0,backgroundColor:n?"var(--joy-palette-primary-softHoverBg) !important":void 0},variant:n?"soft":"plain",title:"Browse Photo Spheres",onClick:i,children:te.jsx(rj,{})})})},TT=(e,t)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},gbe=()=>{const e=$.useRef(null),[t,n]=$.useState(!1),[r,i]=$.useState(!1),[a,c]=$.useState(window.location.origin),s=ZM();return tl(()=>({onAdd:()=>nr(e.current),onRemove:()=>nr(e.current).remove()})),$.useEffect(()=>{const f=s.current;if(!f||!t)return;const g=()=>{const C=f.getCenter(),E=f.getBearing(),A=f.getPitch(),L=E||A?[E,A]:[],I=f.getZoom(),T=_?"?"+new URLSearchParams({mlat:String(TT(_.getLngLat().lat,2)),mlon:String(TT(_.getLngLat().lng,2))}).toString():"",O="#"+[I,C.lat,C.lng,...L].map(D=>TT(D,2)).join("/");c(window.location.origin+T+O)};let _,x;if(r){_=new KM.Marker,_.setLngLat(f.getCenter()).setDraggable(!0).addTo(f.getMap());let C=!0;x=()=>C&&_.setLngLat(f.getCenter()),_.on("dragend",()=>{C=!1,f.easeTo({center:_==null?void 0:_.getLngLat()}),f.once("moveend",()=>C=!0)})}return g(),f.on("moveend",g),x&&f.on("move",x),()=>{f.off("moveend",g),x&&f.off("move",x),_==null||_.remove()}},[s,t,r]),te.jsxs("div",{ref:e,children:[te.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:te.jsx(lu,{sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Share",onClick:()=>n(!t),children:te.jsx(dfe,{})})}),te.jsx(L8,{open:t,anchor:"right",onClose:()=>n(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",right:t?48:0}}},children:te.jsxs(z8,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,overflow:"auto"},children:[te.jsx(T8,{children:"Share"}),te.jsx(D8,{}),te.jsx(e_,{}),te.jsxs(E8,{sx:{gap:2,overflow:"hidden",flexGrow:1,justifyContent:"center"},children:[te.jsx(ci,{children:"Share a link to this map"}),te.jsx(Dre,{readOnly:!0,sx:{"--Input-decoratorChildHeight":"36px"},onFocus:f=>f.target.select(),value:a,endDecorator:te.jsx(w8,{sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:()=>void navigator.clipboard.writeText(a).catch(()=>alert("Could not copy to clipboard 🙁")),children:"Copy"})}),te.jsx(Af,{label:"Include marker",checked:r,onChange:f=>i(f.target.checked)})]})]})})]})};function w9(e){return new Set([...e].map(vbe).concat(ao.CA))}function vbe(e){switch(e){case bo.Arizona:return ao.AZ;case bo.Arkansas:return ao.AR;case bo.Colorado:return ao.CO;case bo.Idaho:return ao.ID;case bo.Iowa:return ao.IA;case bo.Kansas:return ao.KS;case bo.Missouri:return ao.MO;case bo.Montana:return ao.MT;case bo.Nebraska:return ao.NE;case bo.Nevada:return ao.NV;case bo.NewMexico:return ao.NM;case bo.Oklahoma:return ao.OK;case bo.Oregon:return ao.OR;case bo.Texas:return ao.TX;case bo.Utah:return ao.UT;case bo.Washington:return ao.WA;case bo.Wyoming:return ao.WY;default:throw new W_(e)}}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const xL="175",ybe=0,JF=1,_be=2,S9=1,xbe=2,jc=3,jh=0,Vs=1,qc=2,Ph=0,ng=1,QF=2,eN=3,tN=4,bbe=5,af=100,wbe=101,Sbe=102,Mbe=103,Cbe=104,Ebe=200,Tbe=201,Pbe=202,Abe=203,NA=204,BA=205,Ibe=206,Rbe=207,Lbe=208,kbe=209,Dbe=210,zbe=211,Obe=212,Fbe=213,Nbe=214,UA=0,$A=1,VA=2,Cg=3,jA=4,HA=5,GA=6,WA=7,M9=0,Bbe=1,Ube=2,Ah=0,C9=1,$be=2,Vbe=3,jbe=4,Hbe=5,Gbe=6,Wbe=7,E9=300,Eg=301,Tg=302,qA=303,XA=304,iC=306,ZA=1e3,mf=1001,YA=1002,Il=1003,qbe=1004,J1=1005,va=1006,PT=1007,vh=1008,uu=1009,T9=1010,P9=1011,c_=1012,bL=1013,zf=1014,Yc=1015,ox=1016,wL=1017,SL=1018,u_=1020,A9=35902,I9=1021,R9=1022,El=1023,L9=1024,k9=1025,h_=1026,d_=1027,D9=1028,ML=1029,z9=1030,CL=1031,EL=1033,aw=33776,lw=33777,cw=33778,uw=33779,KA=35840,JA=35841,QA=35842,eI=35843,tI=36196,nI=37492,rI=37496,iI=37808,oI=37809,sI=37810,aI=37811,lI=37812,cI=37813,uI=37814,hI=37815,dI=37816,fI=37817,pI=37818,mI=37819,gI=37820,vI=37821,hw=36492,yI=36494,_I=36495,O9=36283,xI=36284,bI=36285,wI=36286,Xbe=3200,Zbe=3201,Ybe=0,Kbe=1,fh="",Na="srgb",Of="srgb-linear",pS="linear",Wr="srgb",Xp=7680,nN=519,Jbe=512,Qbe=513,ewe=514,F9=515,twe=516,nwe=517,rwe=518,iwe=519,rN=35044,iN="300 es",Kc=2e3,mS=2001;class Bg{addEventListener(t,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(n)===-1&&r[t].push(n)}hasEventListener(t,n){const r=this._listeners;return r===void 0?!1:r[t]!==void 0&&r[t].indexOf(n)!==-1}removeEventListener(t,n){const r=this._listeners;if(r===void 0)return;const i=r[t];if(i!==void 0){const a=i.indexOf(n);a!==-1&&i.splice(a,1)}}dispatchEvent(t){const n=this._listeners;if(n===void 0)return;const r=n[t.type];if(r!==void 0){t.target=this;const i=r.slice(0);for(let a=0,c=i.length;a<c;a++)i[a].call(this,t);t.target=null}}}const ns=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let oN=1234567;const my=Math.PI/180,f_=180/Math.PI;function Ug(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ns[e&255]+ns[e>>8&255]+ns[e>>16&255]+ns[e>>24&255]+"-"+ns[t&255]+ns[t>>8&255]+"-"+ns[t>>16&15|64]+ns[t>>24&255]+"-"+ns[n&63|128]+ns[n>>8&255]+"-"+ns[n>>16&255]+ns[n>>24&255]+ns[r&255]+ns[r>>8&255]+ns[r>>16&255]+ns[r>>24&255]).toLowerCase()}function _r(e,t,n){return Math.max(t,Math.min(n,e))}function TL(e,t){return(e%t+t)%t}function owe(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)}function swe(e,t,n){return e!==t?(n-e)/(t-e):0}function gy(e,t,n){return(1-n)*e+n*t}function awe(e,t,n,r){return gy(e,t,1-Math.exp(-n*r))}function lwe(e,t=1){return t-Math.abs(TL(e,t*2)-t)}function cwe(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))}function uwe(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(e*6-15)+10))}function hwe(e,t){return e+Math.floor(Math.random()*(t-e+1))}function dwe(e,t){return e+Math.random()*(t-e)}function fwe(e){return e*(.5-Math.random())}function pwe(e){e!==void 0&&(oN=e);let t=oN+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function mwe(e){return e*my}function gwe(e){return e*f_}function vwe(e){return(e&e-1)===0&&e!==0}function ywe(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function _we(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function xwe(e,t,n,r,i){const a=Math.cos,c=Math.sin,s=a(n/2),f=c(n/2),g=a((t+r)/2),_=c((t+r)/2),x=a((t-r)/2),C=c((t-r)/2),E=a((r-t)/2),A=c((r-t)/2);switch(i){case"XYX":e.set(s*_,f*x,f*C,s*g);break;case"YZY":e.set(f*C,s*_,f*x,s*g);break;case"ZXZ":e.set(f*x,f*C,s*_,s*g);break;case"XZX":e.set(s*_,f*A,f*E,s*g);break;case"YXY":e.set(f*E,s*_,f*A,s*g);break;case"ZYZ":e.set(f*A,f*E,s*_,s*g);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function mm(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function fs(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(e*4294967295);case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int32Array:return Math.round(e*2147483647);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}const pr={DEG2RAD:my,RAD2DEG:f_,generateUUID:Ug,clamp:_r,euclideanModulo:TL,mapLinear:owe,inverseLerp:swe,lerp:gy,damp:awe,pingpong:lwe,smoothstep:cwe,smootherstep:uwe,randInt:hwe,randFloat:dwe,randFloatSpread:fwe,seededRandom:pwe,degToRad:mwe,radToDeg:gwe,isPowerOfTwo:vwe,ceilPowerOfTwo:ywe,floorPowerOfTwo:_we,setQuaternionFromProperEuler:xwe,normalize:fs,denormalize:mm};class kr{constructor(t=0,n=0){kr.prototype.isVector2=!0,this.x=t,this.y=n}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,n){return this.x=t,this.y=n,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const n=this.x,r=this.y,i=t.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,n){return this.x=_r(this.x,t.x,n.x),this.y=_r(this.y,t.y,n.y),this}clampScalar(t,n){return this.x=_r(this.x,t,n),this.y=_r(this.y,t,n),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(_r(r,t,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const n=Math.sqrt(this.lengthSq()*t.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(t)/n;return Math.acos(_r(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const n=this.x-t.x,r=this.y-t.y;return n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this}rotateAround(t,n){const r=Math.cos(n),i=Math.sin(n),a=this.x-t.x,c=this.y-t.y;return this.x=a*r-c*i+t.x,this.y=a*i+c*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class or{constructor(t,n,r,i,a,c,s,f,g){or.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,n,r,i,a,c,s,f,g)}set(t,n,r,i,a,c,s,f,g){const _=this.elements;return _[0]=t,_[1]=i,_[2]=s,_[3]=n,_[4]=a,_[5]=f,_[6]=r,_[7]=c,_[8]=g,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const n=this.elements,r=t.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(t,n,r){return t.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const n=t.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,n){const r=t.elements,i=n.elements,a=this.elements,c=r[0],s=r[3],f=r[6],g=r[1],_=r[4],x=r[7],C=r[2],E=r[5],A=r[8],L=i[0],I=i[3],T=i[6],O=i[1],D=i[4],U=i[7],H=i[2],V=i[5],q=i[8];return a[0]=c*L+s*O+f*H,a[3]=c*I+s*D+f*V,a[6]=c*T+s*U+f*q,a[1]=g*L+_*O+x*H,a[4]=g*I+_*D+x*V,a[7]=g*T+_*U+x*q,a[2]=C*L+E*O+A*H,a[5]=C*I+E*D+A*V,a[8]=C*T+E*U+A*q,this}multiplyScalar(t){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=t,n[4]*=t,n[7]*=t,n[2]*=t,n[5]*=t,n[8]*=t,this}determinant(){const t=this.elements,n=t[0],r=t[1],i=t[2],a=t[3],c=t[4],s=t[5],f=t[6],g=t[7],_=t[8];return n*c*_-n*s*g-r*a*_+r*s*f+i*a*g-i*c*f}invert(){const t=this.elements,n=t[0],r=t[1],i=t[2],a=t[3],c=t[4],s=t[5],f=t[6],g=t[7],_=t[8],x=_*c-s*g,C=s*f-_*a,E=g*a-c*f,A=n*x+r*C+i*E;if(A===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/A;return t[0]=x*L,t[1]=(i*g-_*r)*L,t[2]=(s*r-i*c)*L,t[3]=C*L,t[4]=(_*n-i*f)*L,t[5]=(i*a-s*n)*L,t[6]=E*L,t[7]=(r*f-g*n)*L,t[8]=(c*n-r*a)*L,this}transpose(){let t;const n=this.elements;return t=n[1],n[1]=n[3],n[3]=t,t=n[2],n[2]=n[6],n[6]=t,t=n[5],n[5]=n[7],n[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const n=this.elements;return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],this}setUvTransform(t,n,r,i,a,c,s){const f=Math.cos(a),g=Math.sin(a);return this.set(r*f,r*g,-r*(f*c+g*s)+c+t,-i*g,i*f,-i*(-g*c+f*s)+s+n,0,0,1),this}scale(t,n){return this.premultiply(AT.makeScale(t,n)),this}rotate(t){return this.premultiply(AT.makeRotation(-t)),this}translate(t,n){return this.premultiply(AT.makeTranslation(t,n)),this}makeTranslation(t,n){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,n,0,0,1),this}makeRotation(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(t,n){return this.set(t,0,0,0,n,0,0,0,1),this}equals(t){const n=this.elements,r=t.elements;for(let i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0}fromArray(t,n=0){for(let r=0;r<9;r++)this.elements[r]=t[r+n];return this}toArray(t=[],n=0){const r=this.elements;return t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=r[3],t[n+4]=r[4],t[n+5]=r[5],t[n+6]=r[6],t[n+7]=r[7],t[n+8]=r[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const AT=new or;function N9(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function gS(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function bwe(){const e=gS("canvas");return e.style.display="block",e}const sN={};function dw(e){e in sN||(sN[e]=!0,console.warn(e))}function wwe(e,t,n){return new Promise(function(r,i){function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(a,n);break;default:r()}}setTimeout(a,n)})}function Swe(e){const t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}function Mwe(e){const t=e.elements;t[11]===-1?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=-t[14]+1)}const aN=new or().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),lN=new or().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Cwe(){const e={enabled:!0,workingColorSpace:Of,spaces:{},convert:function(i,a,c){return this.enabled===!1||a===c||!a||!c||(this.spaces[a].transfer===Wr&&(i.r=Qc(i.r),i.g=Qc(i.g),i.b=Qc(i.b)),this.spaces[a].primaries!==this.spaces[c].primaries&&(i.applyMatrix3(this.spaces[a].toXYZ),i.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===Wr&&(i.r=rg(i.r),i.g=rg(i.g),i.b=rg(i.b))),i},fromWorkingColorSpace:function(i,a){return this.convert(i,this.workingColorSpace,a)},toWorkingColorSpace:function(i,a){return this.convert(i,a,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===fh?pS:this.spaces[i].transfer},getLuminanceCoefficients:function(i,a=this.workingColorSpace){return i.fromArray(this.spaces[a].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,a,c){return i.copy(this.spaces[a].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[Of]:{primaries:t,whitePoint:r,transfer:pS,toXYZ:aN,fromXYZ:lN,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Na},outputColorSpaceConfig:{drawingBufferColorSpace:Na}},[Na]:{primaries:t,whitePoint:r,transfer:Wr,toXYZ:aN,fromXYZ:lN,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Na}}}),e}const Er=Cwe();function Qc(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function rg(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}let Zp;class Ewe{static getDataURL(t,n="image/png"){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let r;if(t instanceof HTMLCanvasElement)r=t;else{Zp===void 0&&(Zp=gS("canvas")),Zp.width=t.width,Zp.height=t.height;const i=Zp.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),r=Zp}return r.toDataURL(n)}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const n=gS("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");r.drawImage(t,0,0,t.width,t.height);const i=r.getImageData(0,0,t.width,t.height),a=i.data;for(let c=0;c<a.length;c++)a[c]=Qc(a[c]/255)*255;return r.putImageData(i,0,0),n}else if(t.data){const n=t.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(Qc(n[r]/255)*255):n[r]=Qc(n[r]);return{data:n,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Twe=0;class PL{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Twe++}),this.uuid=Ug(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const n=t===void 0||typeof t=="string";if(!n&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let c=0,s=i.length;c<s;c++)i[c].isDataTexture?a.push(IT(i[c].image)):a.push(IT(i[c]))}else a=IT(i);r.url=a}return n||(t.images[this.uuid]=r),r}}function IT(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?Ewe.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Pwe=0;class jo extends Bg{constructor(t=jo.DEFAULT_IMAGE,n=jo.DEFAULT_MAPPING,r=mf,i=mf,a=va,c=vh,s=El,f=uu,g=jo.DEFAULT_ANISOTROPY,_=fh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Pwe++}),this.uuid=Ug(),this.name="",this.source=new PL(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=a,this.minFilter=c,this.anisotropy=g,this.format=s,this.internalFormat=null,this.type=f,this.offset=new kr(0,0),this.repeat=new kr(1,1),this.center=new kr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new or,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=_,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==E9)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ZA:t.x=t.x-Math.floor(t.x);break;case mf:t.x=t.x<0?0:1;break;case YA:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case ZA:t.y=t.y-Math.floor(t.y);break;case mf:t.y=t.y<0?0:1;break;case YA:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}jo.DEFAULT_IMAGE=null;jo.DEFAULT_MAPPING=E9;jo.DEFAULT_ANISOTROPY=1;class Oi{constructor(t=0,n=0,r=0,i=1){Oi.prototype.isVector4=!0,this.x=t,this.y=n,this.z=r,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,n,r,i){return this.x=t,this.y=n,this.z=r,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this.w=t.w+n.w,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this.w+=t.w*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this.w=t.w-n.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const n=this.x,r=this.y,i=this.z,a=this.w,c=t.elements;return this.x=c[0]*n+c[4]*r+c[8]*i+c[12]*a,this.y=c[1]*n+c[5]*r+c[9]*i+c[13]*a,this.z=c[2]*n+c[6]*r+c[10]*i+c[14]*a,this.w=c[3]*n+c[7]*r+c[11]*i+c[15]*a,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const n=Math.sqrt(1-t.w*t.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/n,this.y=t.y/n,this.z=t.z/n),this}setAxisAngleFromRotationMatrix(t){let n,r,i,a;const f=t.elements,g=f[0],_=f[4],x=f[8],C=f[1],E=f[5],A=f[9],L=f[2],I=f[6],T=f[10];if(Math.abs(_-C)<.01&&Math.abs(x-L)<.01&&Math.abs(A-I)<.01){if(Math.abs(_+C)<.1&&Math.abs(x+L)<.1&&Math.abs(A+I)<.1&&Math.abs(g+E+T-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const D=(g+1)/2,U=(E+1)/2,H=(T+1)/2,V=(_+C)/4,q=(x+L)/4,Q=(A+I)/4;return D>U&&D>H?D<.01?(r=0,i=.707106781,a=.707106781):(r=Math.sqrt(D),i=V/r,a=q/r):U>H?U<.01?(r=.707106781,i=0,a=.707106781):(i=Math.sqrt(U),r=V/i,a=Q/i):H<.01?(r=.707106781,i=.707106781,a=0):(a=Math.sqrt(H),r=q/a,i=Q/a),this.set(r,i,a,n),this}let O=Math.sqrt((I-A)*(I-A)+(x-L)*(x-L)+(C-_)*(C-_));return Math.abs(O)<.001&&(O=1),this.x=(I-A)/O,this.y=(x-L)/O,this.z=(C-_)/O,this.w=Math.acos((g+E+T-1)/2),this}setFromMatrixPosition(t){const n=t.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,n){return this.x=_r(this.x,t.x,n.x),this.y=_r(this.y,t.y,n.y),this.z=_r(this.z,t.z,n.z),this.w=_r(this.w,t.w,n.w),this}clampScalar(t,n){return this.x=_r(this.x,t,n),this.y=_r(this.y,t,n),this.z=_r(this.z,t,n),this.w=_r(this.w,t,n),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(_r(r,t,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this.w+=(t.w-this.w)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this.w=t.w+(n.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this.w=t.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Awe extends Bg{constructor(t=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=t,this.height=n,this.depth=1,this.scissor=new Oi(0,0,t,n),this.scissorTest=!1,this.viewport=new Oi(0,0,t,n);const i={width:t,height:n,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:va,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const a=new jo(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);a.flipY=!1,a.generateMipmaps=r.generateMipmaps,a.internalFormat=r.internalFormat,this.textures=[];const c=r.count;for(let s=0;s<c;s++)this.textures[s]=a.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),t!==null&&(t.renderTarget=this),this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,n,r=1){if(this.width!==t||this.height!==n||this.depth!==r){this.width=t,this.height=n,this.depth=r;for(let i=0,a=this.textures.length;i<a;i++)this.textures[i].image.width=t,this.textures[i].image.height=n,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,t,n),this.scissor.set(0,0,t,n)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let n=0,r=t.textures.length;n<r;n++){this.textures[n]=t.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const i=Object.assign({},t.textures[n].image);this.textures[n].source=new PL(i)}return this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Hh extends Awe{constructor(t=1,n=1,r={}){super(t,n,r),this.isWebGLRenderTarget=!0}}class B9 extends jo{constructor(t=null,n=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:n,height:r,depth:i},this.magFilter=Il,this.minFilter=Il,this.wrapR=mf,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class Iwe extends jo{constructor(t=null,n=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:n,height:r,depth:i},this.magFilter=Il,this.minFilter=Il,this.wrapR=mf,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class id{constructor(t=0,n=0,r=0,i=1){this.isQuaternion=!0,this._x=t,this._y=n,this._z=r,this._w=i}static slerpFlat(t,n,r,i,a,c,s){let f=r[i+0],g=r[i+1],_=r[i+2],x=r[i+3];const C=a[c+0],E=a[c+1],A=a[c+2],L=a[c+3];if(s===0){t[n+0]=f,t[n+1]=g,t[n+2]=_,t[n+3]=x;return}if(s===1){t[n+0]=C,t[n+1]=E,t[n+2]=A,t[n+3]=L;return}if(x!==L||f!==C||g!==E||_!==A){let I=1-s;const T=f*C+g*E+_*A+x*L,O=T>=0?1:-1,D=1-T*T;if(D>Number.EPSILON){const H=Math.sqrt(D),V=Math.atan2(H,T*O);I=Math.sin(I*V)/H,s=Math.sin(s*V)/H}const U=s*O;if(f=f*I+C*U,g=g*I+E*U,_=_*I+A*U,x=x*I+L*U,I===1-s){const H=1/Math.sqrt(f*f+g*g+_*_+x*x);f*=H,g*=H,_*=H,x*=H}}t[n]=f,t[n+1]=g,t[n+2]=_,t[n+3]=x}static multiplyQuaternionsFlat(t,n,r,i,a,c){const s=r[i],f=r[i+1],g=r[i+2],_=r[i+3],x=a[c],C=a[c+1],E=a[c+2],A=a[c+3];return t[n]=s*A+_*x+f*E-g*C,t[n+1]=f*A+_*C+g*x-s*E,t[n+2]=g*A+_*E+s*C-f*x,t[n+3]=_*A-s*x-f*C-g*E,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,n,r,i){return this._x=t,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,n=!0){const r=t._x,i=t._y,a=t._z,c=t._order,s=Math.cos,f=Math.sin,g=s(r/2),_=s(i/2),x=s(a/2),C=f(r/2),E=f(i/2),A=f(a/2);switch(c){case"XYZ":this._x=C*_*x+g*E*A,this._y=g*E*x-C*_*A,this._z=g*_*A+C*E*x,this._w=g*_*x-C*E*A;break;case"YXZ":this._x=C*_*x+g*E*A,this._y=g*E*x-C*_*A,this._z=g*_*A-C*E*x,this._w=g*_*x+C*E*A;break;case"ZXY":this._x=C*_*x-g*E*A,this._y=g*E*x+C*_*A,this._z=g*_*A+C*E*x,this._w=g*_*x-C*E*A;break;case"ZYX":this._x=C*_*x-g*E*A,this._y=g*E*x+C*_*A,this._z=g*_*A-C*E*x,this._w=g*_*x+C*E*A;break;case"YZX":this._x=C*_*x+g*E*A,this._y=g*E*x+C*_*A,this._z=g*_*A-C*E*x,this._w=g*_*x-C*E*A;break;case"XZY":this._x=C*_*x-g*E*A,this._y=g*E*x-C*_*A,this._z=g*_*A+C*E*x,this._w=g*_*x+C*E*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,n){const r=n/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const n=t.elements,r=n[0],i=n[4],a=n[8],c=n[1],s=n[5],f=n[9],g=n[2],_=n[6],x=n[10],C=r+s+x;if(C>0){const E=.5/Math.sqrt(C+1);this._w=.25/E,this._x=(_-f)*E,this._y=(a-g)*E,this._z=(c-i)*E}else if(r>s&&r>x){const E=2*Math.sqrt(1+r-s-x);this._w=(_-f)/E,this._x=.25*E,this._y=(i+c)/E,this._z=(a+g)/E}else if(s>x){const E=2*Math.sqrt(1+s-r-x);this._w=(a-g)/E,this._x=(i+c)/E,this._y=.25*E,this._z=(f+_)/E}else{const E=2*Math.sqrt(1+x-r-s);this._w=(c-i)/E,this._x=(a+g)/E,this._y=(f+_)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(t,n){let r=t.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*n.z-t.z*n.y,this._y=t.z*n.x-t.x*n.z,this._z=t.x*n.y-t.y*n.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(_r(this.dot(t),-1,1)))}rotateTowards(t,n){const r=this.angleTo(t);if(r===0)return this;const i=Math.min(1,n/r);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,n){const r=t._x,i=t._y,a=t._z,c=t._w,s=n._x,f=n._y,g=n._z,_=n._w;return this._x=r*_+c*s+i*g-a*f,this._y=i*_+c*f+a*s-r*g,this._z=a*_+c*g+r*f-i*s,this._w=c*_-r*s-i*f-a*g,this._onChangeCallback(),this}slerp(t,n){if(n===0)return this;if(n===1)return this.copy(t);const r=this._x,i=this._y,a=this._z,c=this._w;let s=c*t._w+r*t._x+i*t._y+a*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=c,this._x=r,this._y=i,this._z=a,this;const f=1-s*s;if(f<=Number.EPSILON){const E=1-n;return this._w=E*c+n*this._w,this._x=E*r+n*this._x,this._y=E*i+n*this._y,this._z=E*a+n*this._z,this.normalize(),this}const g=Math.sqrt(f),_=Math.atan2(g,s),x=Math.sin((1-n)*_)/g,C=Math.sin(n*_)/g;return this._w=c*x+this._w*C,this._x=r*x+this._x*C,this._y=i*x+this._y*C,this._z=a*x+this._z*C,this._onChangeCallback(),this}slerpQuaternions(t,n,r){return this.copy(t).slerp(n,r)}random(){const t=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),a=Math.sqrt(r);return this.set(i*Math.sin(t),i*Math.cos(t),a*Math.sin(n),a*Math.cos(n))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,n=0){return this._x=t[n],this._y=t[n+1],this._z=t[n+2],this._w=t[n+3],this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._w,t}fromBufferAttribute(t,n){return this._x=t.getX(n),this._y=t.getY(n),this._z=t.getZ(n),this._w=t.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class dt{constructor(t=0,n=0,r=0){dt.prototype.isVector3=!0,this.x=t,this.y=n,this.z=r}set(t,n,r){return r===void 0&&(r=this.z),this.x=t,this.y=n,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,n){return this.x=t.x*n.x,this.y=t.y*n.y,this.z=t.z*n.z,this}applyEuler(t){return this.applyQuaternion(cN.setFromEuler(t))}applyAxisAngle(t,n){return this.applyQuaternion(cN.setFromAxisAngle(t,n))}applyMatrix3(t){const n=this.x,r=this.y,i=this.z,a=t.elements;return this.x=a[0]*n+a[3]*r+a[6]*i,this.y=a[1]*n+a[4]*r+a[7]*i,this.z=a[2]*n+a[5]*r+a[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const n=this.x,r=this.y,i=this.z,a=t.elements,c=1/(a[3]*n+a[7]*r+a[11]*i+a[15]);return this.x=(a[0]*n+a[4]*r+a[8]*i+a[12])*c,this.y=(a[1]*n+a[5]*r+a[9]*i+a[13])*c,this.z=(a[2]*n+a[6]*r+a[10]*i+a[14])*c,this}applyQuaternion(t){const n=this.x,r=this.y,i=this.z,a=t.x,c=t.y,s=t.z,f=t.w,g=2*(c*i-s*r),_=2*(s*n-a*i),x=2*(a*r-c*n);return this.x=n+f*g+c*x-s*_,this.y=r+f*_+s*g-a*x,this.z=i+f*x+a*_-c*g,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const n=this.x,r=this.y,i=this.z,a=t.elements;return this.x=a[0]*n+a[4]*r+a[8]*i,this.y=a[1]*n+a[5]*r+a[9]*i,this.z=a[2]*n+a[6]*r+a[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,n){return this.x=_r(this.x,t.x,n.x),this.y=_r(this.y,t.y,n.y),this.z=_r(this.z,t.z,n.z),this}clampScalar(t,n){return this.x=_r(this.x,t,n),this.y=_r(this.y,t,n),this.z=_r(this.z,t,n),this}clampLength(t,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(_r(r,t,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this}lerpVectors(t,n,r){return this.x=t.x+(n.x-t.x)*r,this.y=t.y+(n.y-t.y)*r,this.z=t.z+(n.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,n){const r=t.x,i=t.y,a=t.z,c=n.x,s=n.y,f=n.z;return this.x=i*f-a*s,this.y=a*c-r*f,this.z=r*s-i*c,this}projectOnVector(t){const n=t.lengthSq();if(n===0)return this.set(0,0,0);const r=t.dot(this)/n;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return RT.copy(this).projectOnVector(t),this.sub(RT)}reflect(t){return this.sub(RT.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const n=Math.sqrt(this.lengthSq()*t.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(t)/n;return Math.acos(_r(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const n=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return n*n+r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,n,r){const i=Math.sin(n)*t;return this.x=i*Math.sin(r),this.y=Math.cos(n)*t,this.z=i*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,n,r){return this.x=t*Math.sin(n),this.y=r,this.z=t*Math.cos(n),this}setFromMatrixPosition(t){const n=t.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(t){const n=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=n,this.y=r,this.z=i,this}setFromMatrixColumn(t,n){return this.fromArray(t.elements,n*4)}setFromMatrix3Column(t,n){return this.fromArray(t.elements,n*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this.z=t[n+2],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t}fromBufferAttribute(t,n){return this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(t),this.y=n,this.z=r*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const RT=new dt,cN=new id;class $g{constructor(t=new dt(1/0,1/0,1/0),n=new dt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=n}set(t,n){return this.min.copy(t),this.max.copy(n),this}setFromArray(t){this.makeEmpty();for(let n=0,r=t.length;n<r;n+=3)this.expandByPoint(gl.fromArray(t,n));return this}setFromBufferAttribute(t){this.makeEmpty();for(let n=0,r=t.count;n<r;n++)this.expandByPoint(gl.fromBufferAttribute(t,n));return this}setFromPoints(t){this.makeEmpty();for(let n=0,r=t.length;n<r;n++)this.expandByPoint(t[n]);return this}setFromCenterAndSize(t,n){const r=gl.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,n=!1){return this.makeEmpty(),this.expandByObject(t,n)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,n=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(r!==void 0){const a=r.getAttribute("position");if(n===!0&&a!==void 0&&t.isInstancedMesh!==!0)for(let c=0,s=a.count;c<s;c++)t.isMesh===!0?t.getVertexPosition(c,gl):gl.fromBufferAttribute(a,c),gl.applyMatrix4(t.matrixWorld),this.expandByPoint(gl);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),Q1.copy(t.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),Q1.copy(r.boundingBox)),Q1.applyMatrix4(t.matrixWorld),this.union(Q1)}const i=t.children;for(let a=0,c=i.length;a<c;a++)this.expandByObject(i[a],n);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,n){return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,gl),gl.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let n,r;return t.normal.x>0?(n=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(n=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(n+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(n+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(n+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(n+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),n<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(w0),eb.subVectors(this.max,w0),Yp.subVectors(t.a,w0),Kp.subVectors(t.b,w0),Jp.subVectors(t.c,w0),Ju.subVectors(Kp,Yp),Qu.subVectors(Jp,Kp),qd.subVectors(Yp,Jp);let n=[0,-Ju.z,Ju.y,0,-Qu.z,Qu.y,0,-qd.z,qd.y,Ju.z,0,-Ju.x,Qu.z,0,-Qu.x,qd.z,0,-qd.x,-Ju.y,Ju.x,0,-Qu.y,Qu.x,0,-qd.y,qd.x,0];return!LT(n,Yp,Kp,Jp,eb)||(n=[1,0,0,0,1,0,0,0,1],!LT(n,Yp,Kp,Jp,eb))?!1:(tb.crossVectors(Ju,Qu),n=[tb.x,tb.y,tb.z],LT(n,Yp,Kp,Jp,eb))}clampPoint(t,n){return n.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,gl).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(gl).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Fc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Fc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Fc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Fc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Fc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Fc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Fc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Fc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Fc),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Fc=[new dt,new dt,new dt,new dt,new dt,new dt,new dt,new dt],gl=new dt,Q1=new $g,Yp=new dt,Kp=new dt,Jp=new dt,Ju=new dt,Qu=new dt,qd=new dt,w0=new dt,eb=new dt,tb=new dt,Xd=new dt;function LT(e,t,n,r,i){for(let a=0,c=e.length-3;a<=c;a+=3){Xd.fromArray(e,a);const s=i.x*Math.abs(Xd.x)+i.y*Math.abs(Xd.y)+i.z*Math.abs(Xd.z),f=t.dot(Xd),g=n.dot(Xd),_=r.dot(Xd);if(Math.max(-Math.max(f,g,_),Math.min(f,g,_))>s)return!1}return!0}const Rwe=new $g,S0=new dt,kT=new dt;class oC{constructor(t=new dt,n=-1){this.isSphere=!0,this.center=t,this.radius=n}set(t,n){return this.center.copy(t),this.radius=n,this}setFromPoints(t,n){const r=this.center;n!==void 0?r.copy(n):Rwe.setFromPoints(t).getCenter(r);let i=0;for(let a=0,c=t.length;a<c;a++)i=Math.max(i,r.distanceToSquared(t[a]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const n=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=n*n}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,n){const r=this.center.distanceToSquared(t);return n.copy(t),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;S0.subVectors(t,this.center);const n=S0.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),i=(r-this.radius)*.5;this.center.addScaledVector(S0,i/r),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(kT.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(S0.copy(t.center).add(kT)),this.expandByPoint(S0.copy(t.center).sub(kT))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Nc=new dt,DT=new dt,nb=new dt,eh=new dt,zT=new dt,rb=new dt,OT=new dt;class AL{constructor(t=new dt,n=new dt(0,0,-1)){this.origin=t,this.direction=n}set(t,n){return this.origin.copy(t),this.direction.copy(n),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,n){return n.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Nc)),this}closestPointToPoint(t,n){n.subVectors(t,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const n=Nc.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(Nc.copy(this.origin).addScaledVector(this.direction,n),Nc.distanceToSquared(t))}distanceSqToSegment(t,n,r,i){DT.copy(t).add(n).multiplyScalar(.5),nb.copy(n).sub(t).normalize(),eh.copy(this.origin).sub(DT);const a=t.distanceTo(n)*.5,c=-this.direction.dot(nb),s=eh.dot(this.direction),f=-eh.dot(nb),g=eh.lengthSq(),_=Math.abs(1-c*c);let x,C,E,A;if(_>0)if(x=c*f-s,C=c*s-f,A=a*_,x>=0)if(C>=-A)if(C<=A){const L=1/_;x*=L,C*=L,E=x*(x+c*C+2*s)+C*(c*x+C+2*f)+g}else C=a,x=Math.max(0,-(c*C+s)),E=-x*x+C*(C+2*f)+g;else C=-a,x=Math.max(0,-(c*C+s)),E=-x*x+C*(C+2*f)+g;else C<=-A?(x=Math.max(0,-(-c*a+s)),C=x>0?-a:Math.min(Math.max(-a,-f),a),E=-x*x+C*(C+2*f)+g):C<=A?(x=0,C=Math.min(Math.max(-a,-f),a),E=C*(C+2*f)+g):(x=Math.max(0,-(c*a+s)),C=x>0?a:Math.min(Math.max(-a,-f),a),E=-x*x+C*(C+2*f)+g);else C=c>0?-a:a,x=Math.max(0,-(c*C+s)),E=-x*x+C*(C+2*f)+g;return r&&r.copy(this.origin).addScaledVector(this.direction,x),i&&i.copy(DT).addScaledVector(nb,C),E}intersectSphere(t,n){Nc.subVectors(t.center,this.origin);const r=Nc.dot(this.direction),i=Nc.dot(Nc)-r*r,a=t.radius*t.radius;if(i>a)return null;const c=Math.sqrt(a-i),s=r-c,f=r+c;return f<0?null:s<0?this.at(f,n):this.at(s,n)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const n=t.normal.dot(this.direction);if(n===0)return t.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(t.normal)+t.constant)/n;return r>=0?r:null}intersectPlane(t,n){const r=this.distanceToPlane(t);return r===null?null:this.at(r,n)}intersectsPlane(t){const n=t.distanceToPoint(this.origin);return n===0||t.normal.dot(this.direction)*n<0}intersectBox(t,n){let r,i,a,c,s,f;const g=1/this.direction.x,_=1/this.direction.y,x=1/this.direction.z,C=this.origin;return g>=0?(r=(t.min.x-C.x)*g,i=(t.max.x-C.x)*g):(r=(t.max.x-C.x)*g,i=(t.min.x-C.x)*g),_>=0?(a=(t.min.y-C.y)*_,c=(t.max.y-C.y)*_):(a=(t.max.y-C.y)*_,c=(t.min.y-C.y)*_),r>c||a>i||((a>r||isNaN(r))&&(r=a),(c<i||isNaN(i))&&(i=c),x>=0?(s=(t.min.z-C.z)*x,f=(t.max.z-C.z)*x):(s=(t.max.z-C.z)*x,f=(t.min.z-C.z)*x),r>f||s>i)||((s>r||r!==r)&&(r=s),(f<i||i!==i)&&(i=f),i<0)?null:this.at(r>=0?r:i,n)}intersectsBox(t){return this.intersectBox(t,Nc)!==null}intersectTriangle(t,n,r,i,a){zT.subVectors(n,t),rb.subVectors(r,t),OT.crossVectors(zT,rb);let c=this.direction.dot(OT),s;if(c>0){if(i)return null;s=1}else if(c<0)s=-1,c=-c;else return null;eh.subVectors(this.origin,t);const f=s*this.direction.dot(rb.crossVectors(eh,rb));if(f<0)return null;const g=s*this.direction.dot(zT.cross(eh));if(g<0||f+g>c)return null;const _=-s*eh.dot(OT);return _<0?null:this.at(_/c,a)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Vr{constructor(t,n,r,i,a,c,s,f,g,_,x,C,E,A,L,I){Vr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,n,r,i,a,c,s,f,g,_,x,C,E,A,L,I)}set(t,n,r,i,a,c,s,f,g,_,x,C,E,A,L,I){const T=this.elements;return T[0]=t,T[4]=n,T[8]=r,T[12]=i,T[1]=a,T[5]=c,T[9]=s,T[13]=f,T[2]=g,T[6]=_,T[10]=x,T[14]=C,T[3]=E,T[7]=A,T[11]=L,T[15]=I,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Vr().fromArray(this.elements)}copy(t){const n=this.elements,r=t.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(t){const n=this.elements,r=t.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(t){const n=t.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(t,n,r){return t.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,n,r){return this.set(t.x,n.x,r.x,0,t.y,n.y,r.y,0,t.z,n.z,r.z,0,0,0,0,1),this}extractRotation(t){const n=this.elements,r=t.elements,i=1/Qp.setFromMatrixColumn(t,0).length(),a=1/Qp.setFromMatrixColumn(t,1).length(),c=1/Qp.setFromMatrixColumn(t,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*a,n[5]=r[5]*a,n[6]=r[6]*a,n[7]=0,n[8]=r[8]*c,n[9]=r[9]*c,n[10]=r[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(t){const n=this.elements,r=t.x,i=t.y,a=t.z,c=Math.cos(r),s=Math.sin(r),f=Math.cos(i),g=Math.sin(i),_=Math.cos(a),x=Math.sin(a);if(t.order==="XYZ"){const C=c*_,E=c*x,A=s*_,L=s*x;n[0]=f*_,n[4]=-f*x,n[8]=g,n[1]=E+A*g,n[5]=C-L*g,n[9]=-s*f,n[2]=L-C*g,n[6]=A+E*g,n[10]=c*f}else if(t.order==="YXZ"){const C=f*_,E=f*x,A=g*_,L=g*x;n[0]=C+L*s,n[4]=A*s-E,n[8]=c*g,n[1]=c*x,n[5]=c*_,n[9]=-s,n[2]=E*s-A,n[6]=L+C*s,n[10]=c*f}else if(t.order==="ZXY"){const C=f*_,E=f*x,A=g*_,L=g*x;n[0]=C-L*s,n[4]=-c*x,n[8]=A+E*s,n[1]=E+A*s,n[5]=c*_,n[9]=L-C*s,n[2]=-c*g,n[6]=s,n[10]=c*f}else if(t.order==="ZYX"){const C=c*_,E=c*x,A=s*_,L=s*x;n[0]=f*_,n[4]=A*g-E,n[8]=C*g+L,n[1]=f*x,n[5]=L*g+C,n[9]=E*g-A,n[2]=-g,n[6]=s*f,n[10]=c*f}else if(t.order==="YZX"){const C=c*f,E=c*g,A=s*f,L=s*g;n[0]=f*_,n[4]=L-C*x,n[8]=A*x+E,n[1]=x,n[5]=c*_,n[9]=-s*_,n[2]=-g*_,n[6]=E*x+A,n[10]=C-L*x}else if(t.order==="XZY"){const C=c*f,E=c*g,A=s*f,L=s*g;n[0]=f*_,n[4]=-x,n[8]=g*_,n[1]=C*x+L,n[5]=c*_,n[9]=E*x-A,n[2]=A*x-E,n[6]=s*_,n[10]=L*x+C}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Lwe,t,kwe)}lookAt(t,n,r){const i=this.elements;return oa.subVectors(t,n),oa.lengthSq()===0&&(oa.z=1),oa.normalize(),th.crossVectors(r,oa),th.lengthSq()===0&&(Math.abs(r.z)===1?oa.x+=1e-4:oa.z+=1e-4,oa.normalize(),th.crossVectors(r,oa)),th.normalize(),ib.crossVectors(oa,th),i[0]=th.x,i[4]=ib.x,i[8]=oa.x,i[1]=th.y,i[5]=ib.y,i[9]=oa.y,i[2]=th.z,i[6]=ib.z,i[10]=oa.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,n){const r=t.elements,i=n.elements,a=this.elements,c=r[0],s=r[4],f=r[8],g=r[12],_=r[1],x=r[5],C=r[9],E=r[13],A=r[2],L=r[6],I=r[10],T=r[14],O=r[3],D=r[7],U=r[11],H=r[15],V=i[0],q=i[4],Q=i[8],K=i[12],N=i[1],re=i[5],ye=i[9],ge=i[13],Ve=i[2],Ie=i[6],ve=i[10],Se=i[14],Me=i[3],Be=i[7],Qe=i[11],st=i[15];return a[0]=c*V+s*N+f*Ve+g*Me,a[4]=c*q+s*re+f*Ie+g*Be,a[8]=c*Q+s*ye+f*ve+g*Qe,a[12]=c*K+s*ge+f*Se+g*st,a[1]=_*V+x*N+C*Ve+E*Me,a[5]=_*q+x*re+C*Ie+E*Be,a[9]=_*Q+x*ye+C*ve+E*Qe,a[13]=_*K+x*ge+C*Se+E*st,a[2]=A*V+L*N+I*Ve+T*Me,a[6]=A*q+L*re+I*Ie+T*Be,a[10]=A*Q+L*ye+I*ve+T*Qe,a[14]=A*K+L*ge+I*Se+T*st,a[3]=O*V+D*N+U*Ve+H*Me,a[7]=O*q+D*re+U*Ie+H*Be,a[11]=O*Q+D*ye+U*ve+H*Qe,a[15]=O*K+D*ge+U*Se+H*st,this}multiplyScalar(t){const n=this.elements;return n[0]*=t,n[4]*=t,n[8]*=t,n[12]*=t,n[1]*=t,n[5]*=t,n[9]*=t,n[13]*=t,n[2]*=t,n[6]*=t,n[10]*=t,n[14]*=t,n[3]*=t,n[7]*=t,n[11]*=t,n[15]*=t,this}determinant(){const t=this.elements,n=t[0],r=t[4],i=t[8],a=t[12],c=t[1],s=t[5],f=t[9],g=t[13],_=t[2],x=t[6],C=t[10],E=t[14],A=t[3],L=t[7],I=t[11],T=t[15];return A*(+a*f*x-i*g*x-a*s*C+r*g*C+i*s*E-r*f*E)+L*(+n*f*E-n*g*C+a*c*C-i*c*E+i*g*_-a*f*_)+I*(+n*g*x-n*s*E-a*c*x+r*c*E+a*s*_-r*g*_)+T*(-i*s*_-n*f*x+n*s*C+i*c*x-r*c*C+r*f*_)}transpose(){const t=this.elements;let n;return n=t[1],t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,this}setPosition(t,n,r){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=n,i[14]=r),this}invert(){const t=this.elements,n=t[0],r=t[1],i=t[2],a=t[3],c=t[4],s=t[5],f=t[6],g=t[7],_=t[8],x=t[9],C=t[10],E=t[11],A=t[12],L=t[13],I=t[14],T=t[15],O=x*I*g-L*C*g+L*f*E-s*I*E-x*f*T+s*C*T,D=A*C*g-_*I*g-A*f*E+c*I*E+_*f*T-c*C*T,U=_*L*g-A*x*g+A*s*E-c*L*E-_*s*T+c*x*T,H=A*x*f-_*L*f-A*s*C+c*L*C+_*s*I-c*x*I,V=n*O+r*D+i*U+a*H;if(V===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const q=1/V;return t[0]=O*q,t[1]=(L*C*a-x*I*a-L*i*E+r*I*E+x*i*T-r*C*T)*q,t[2]=(s*I*a-L*f*a+L*i*g-r*I*g-s*i*T+r*f*T)*q,t[3]=(x*f*a-s*C*a-x*i*g+r*C*g+s*i*E-r*f*E)*q,t[4]=D*q,t[5]=(_*I*a-A*C*a+A*i*E-n*I*E-_*i*T+n*C*T)*q,t[6]=(A*f*a-c*I*a-A*i*g+n*I*g+c*i*T-n*f*T)*q,t[7]=(c*C*a-_*f*a+_*i*g-n*C*g-c*i*E+n*f*E)*q,t[8]=U*q,t[9]=(A*x*a-_*L*a-A*r*E+n*L*E+_*r*T-n*x*T)*q,t[10]=(c*L*a-A*s*a+A*r*g-n*L*g-c*r*T+n*s*T)*q,t[11]=(_*s*a-c*x*a-_*r*g+n*x*g+c*r*E-n*s*E)*q,t[12]=H*q,t[13]=(_*L*i-A*x*i+A*r*C-n*L*C-_*r*I+n*x*I)*q,t[14]=(A*s*i-c*L*i-A*r*f+n*L*f+c*r*I-n*s*I)*q,t[15]=(c*x*i-_*s*i+_*r*f-n*x*f-c*r*C+n*s*C)*q,this}scale(t){const n=this.elements,r=t.x,i=t.y,a=t.z;return n[0]*=r,n[4]*=i,n[8]*=a,n[1]*=r,n[5]*=i,n[9]*=a,n[2]*=r,n[6]*=i,n[10]*=a,n[3]*=r,n[7]*=i,n[11]*=a,this}getMaxScaleOnAxis(){const t=this.elements,n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(n,r,i))}makeTranslation(t,n,r){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(t){const n=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(t){const n=Math.cos(t),r=Math.sin(t);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,n){const r=Math.cos(n),i=Math.sin(n),a=1-r,c=t.x,s=t.y,f=t.z,g=a*c,_=a*s;return this.set(g*c+r,g*s-i*f,g*f+i*s,0,g*s+i*f,_*s+r,_*f-i*c,0,g*f-i*s,_*f+i*c,a*f*f+r,0,0,0,0,1),this}makeScale(t,n,r){return this.set(t,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,n,r,i,a,c){return this.set(1,r,a,0,t,1,c,0,n,i,1,0,0,0,0,1),this}compose(t,n,r){const i=this.elements,a=n._x,c=n._y,s=n._z,f=n._w,g=a+a,_=c+c,x=s+s,C=a*g,E=a*_,A=a*x,L=c*_,I=c*x,T=s*x,O=f*g,D=f*_,U=f*x,H=r.x,V=r.y,q=r.z;return i[0]=(1-(L+T))*H,i[1]=(E+U)*H,i[2]=(A-D)*H,i[3]=0,i[4]=(E-U)*V,i[5]=(1-(C+T))*V,i[6]=(I+O)*V,i[7]=0,i[8]=(A+D)*q,i[9]=(I-O)*q,i[10]=(1-(C+L))*q,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,n,r){const i=this.elements;let a=Qp.set(i[0],i[1],i[2]).length();const c=Qp.set(i[4],i[5],i[6]).length(),s=Qp.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),t.x=i[12],t.y=i[13],t.z=i[14],vl.copy(this);const g=1/a,_=1/c,x=1/s;return vl.elements[0]*=g,vl.elements[1]*=g,vl.elements[2]*=g,vl.elements[4]*=_,vl.elements[5]*=_,vl.elements[6]*=_,vl.elements[8]*=x,vl.elements[9]*=x,vl.elements[10]*=x,n.setFromRotationMatrix(vl),r.x=a,r.y=c,r.z=s,this}makePerspective(t,n,r,i,a,c,s=Kc){const f=this.elements,g=2*a/(n-t),_=2*a/(r-i),x=(n+t)/(n-t),C=(r+i)/(r-i);let E,A;if(s===Kc)E=-(c+a)/(c-a),A=-2*c*a/(c-a);else if(s===mS)E=-c/(c-a),A=-c*a/(c-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return f[0]=g,f[4]=0,f[8]=x,f[12]=0,f[1]=0,f[5]=_,f[9]=C,f[13]=0,f[2]=0,f[6]=0,f[10]=E,f[14]=A,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(t,n,r,i,a,c,s=Kc){const f=this.elements,g=1/(n-t),_=1/(r-i),x=1/(c-a),C=(n+t)*g,E=(r+i)*_;let A,L;if(s===Kc)A=(c+a)*x,L=-2*x;else if(s===mS)A=a*x,L=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return f[0]=2*g,f[4]=0,f[8]=0,f[12]=-C,f[1]=0,f[5]=2*_,f[9]=0,f[13]=-E,f[2]=0,f[6]=0,f[10]=L,f[14]=-A,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(t){const n=this.elements,r=t.elements;for(let i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0}fromArray(t,n=0){for(let r=0;r<16;r++)this.elements[r]=t[r+n];return this}toArray(t=[],n=0){const r=this.elements;return t[n]=r[0],t[n+1]=r[1],t[n+2]=r[2],t[n+3]=r[3],t[n+4]=r[4],t[n+5]=r[5],t[n+6]=r[6],t[n+7]=r[7],t[n+8]=r[8],t[n+9]=r[9],t[n+10]=r[10],t[n+11]=r[11],t[n+12]=r[12],t[n+13]=r[13],t[n+14]=r[14],t[n+15]=r[15],t}}const Qp=new dt,vl=new Vr,Lwe=new dt(0,0,0),kwe=new dt(1,1,1),th=new dt,ib=new dt,oa=new dt,uN=new Vr,hN=new id;class yc{constructor(t=0,n=0,r=0,i=yc.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,i=this._order){return this._x=t,this._y=n,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const i=t.elements,a=i[0],c=i[4],s=i[8],f=i[1],g=i[5],_=i[9],x=i[2],C=i[6],E=i[10];switch(n){case"XYZ":this._y=Math.asin(_r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-_,E),this._z=Math.atan2(-c,a)):(this._x=Math.atan2(C,g),this._z=0);break;case"YXZ":this._x=Math.asin(-_r(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(s,E),this._z=Math.atan2(f,g)):(this._y=Math.atan2(-x,a),this._z=0);break;case"ZXY":this._x=Math.asin(_r(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(-x,E),this._z=Math.atan2(-c,g)):(this._y=0,this._z=Math.atan2(f,a));break;case"ZYX":this._y=Math.asin(-_r(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(C,E),this._z=Math.atan2(f,a)):(this._x=0,this._z=Math.atan2(-c,g));break;case"YZX":this._z=Math.asin(_r(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-_,g),this._y=Math.atan2(-x,a)):(this._x=0,this._y=Math.atan2(s,E));break;case"XZY":this._z=Math.asin(-_r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(C,g),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-_,E),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return uN.makeRotationFromQuaternion(t),this.setFromRotationMatrix(uN,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return hN.setFromEuler(this),this.setFromQuaternion(hN,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}yc.DEFAULT_ORDER="XYZ";class IL{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let Dwe=0;const dN=new dt,em=new id,Bc=new Vr,ob=new dt,M0=new dt,zwe=new dt,Owe=new id,fN=new dt(1,0,0),pN=new dt(0,1,0),mN=new dt(0,0,1),gN={type:"added"},Fwe={type:"removed"},tm={type:"childadded",child:null},FT={type:"childremoved",child:null};class Ho extends Bg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Dwe++}),this.uuid=Ug(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ho.DEFAULT_UP.clone();const t=new dt,n=new yc,r=new id,i=new dt(1,1,1);function a(){r.setFromEuler(n,!1)}function c(){n.setFromQuaternion(r,void 0,!1)}n._onChange(a),r._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Vr},normalMatrix:{value:new or}}),this.matrix=new Vr,this.matrixWorld=new Vr,this.matrixAutoUpdate=Ho.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Ho.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new IL,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return em.setFromAxisAngle(t,n),this.quaternion.multiply(em),this}rotateOnWorldAxis(t,n){return em.setFromAxisAngle(t,n),this.quaternion.premultiply(em),this}rotateX(t){return this.rotateOnAxis(fN,t)}rotateY(t){return this.rotateOnAxis(pN,t)}rotateZ(t){return this.rotateOnAxis(mN,t)}translateOnAxis(t,n){return dN.copy(t).applyQuaternion(this.quaternion),this.position.add(dN.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(fN,t)}translateY(t){return this.translateOnAxis(pN,t)}translateZ(t){return this.translateOnAxis(mN,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Bc.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?ob.copy(t):ob.set(t,n,r);const i=this.parent;this.updateWorldMatrix(!0,!1),M0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Bc.lookAt(M0,ob,this.up):Bc.lookAt(ob,M0,this.up),this.quaternion.setFromRotationMatrix(Bc),i&&(Bc.extractRotation(i.matrixWorld),em.setFromRotationMatrix(Bc),this.quaternion.premultiply(em.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(gN),tm.child=t,this.dispatchEvent(tm),tm.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Fwe),FT.child=t,this.dispatchEvent(FT),FT.child=null),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Bc.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Bc.multiply(t.parent.matrixWorld)),t.applyMatrix4(Bc),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(gN),tm.child=t,this.dispatchEvent(tm),tm.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,i=this.children.length;r<i;r++){const c=this.children[r].getObjectByProperty(t,n);if(c!==void 0)return c}}getObjectsByProperty(t,n,r=[]){this[t]===n&&r.push(this);const i=this.children;for(let a=0,c=i.length;a<c;a++)i[a].getObjectsByProperty(t,n,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(M0,t,zwe),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(M0,Owe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverseVisible(t)}traverseAncestors(t){const n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].updateMatrixWorld(t)}updateWorldMatrix(t,n){const r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const i=this.children;for(let a=0,c=i.length;a<c;a++)i[a].updateWorldMatrix(!1,!0)}}toJSON(t){const n=t===void 0||typeof t=="string",r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function a(s,f){return s[f.uuid]===void 0&&(s[f.uuid]=f.toJSON(t)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(t.geometries,this.geometry);const s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){const f=s.shapes;if(Array.isArray(f))for(let g=0,_=f.length;g<_;g++){const x=f[g];a(t.shapes,x)}else a(t.shapes,f)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const s=[];for(let f=0,g=this.material.length;f<g;f++)s.push(a(t.materials,this.material[f]));i.material=s}else i.material=a(t.materials,this.material);if(this.children.length>0){i.children=[];for(let s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let s=0;s<this.animations.length;s++){const f=this.animations[s];i.animations.push(a(t.animations,f))}}if(n){const s=c(t.geometries),f=c(t.materials),g=c(t.textures),_=c(t.images),x=c(t.shapes),C=c(t.skeletons),E=c(t.animations),A=c(t.nodes);s.length>0&&(r.geometries=s),f.length>0&&(r.materials=f),g.length>0&&(r.textures=g),_.length>0&&(r.images=_),x.length>0&&(r.shapes=x),C.length>0&&(r.skeletons=C),E.length>0&&(r.animations=E),A.length>0&&(r.nodes=A)}return r.object=i,r;function c(s){const f=[];for(const g in s){const _=s[g];delete _.metadata,f.push(_)}return f}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let r=0;r<t.children.length;r++){const i=t.children[r];this.add(i.clone())}return this}}Ho.DEFAULT_UP=new dt(0,1,0);Ho.DEFAULT_MATRIX_AUTO_UPDATE=!0;Ho.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const yl=new dt,Uc=new dt,NT=new dt,$c=new dt,nm=new dt,rm=new dt,vN=new dt,BT=new dt,UT=new dt,$T=new dt,VT=new Oi,jT=new Oi,HT=new Oi;class Ml{constructor(t=new dt,n=new dt,r=new dt){this.a=t,this.b=n,this.c=r}static getNormal(t,n,r,i){i.subVectors(r,n),yl.subVectors(t,n),i.cross(yl);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(t,n,r,i,a){yl.subVectors(i,n),Uc.subVectors(r,n),NT.subVectors(t,n);const c=yl.dot(yl),s=yl.dot(Uc),f=yl.dot(NT),g=Uc.dot(Uc),_=Uc.dot(NT),x=c*g-s*s;if(x===0)return a.set(0,0,0),null;const C=1/x,E=(g*f-s*_)*C,A=(c*_-s*f)*C;return a.set(1-E-A,A,E)}static containsPoint(t,n,r,i){return this.getBarycoord(t,n,r,i,$c)===null?!1:$c.x>=0&&$c.y>=0&&$c.x+$c.y<=1}static getInterpolation(t,n,r,i,a,c,s,f){return this.getBarycoord(t,n,r,i,$c)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(a,$c.x),f.addScaledVector(c,$c.y),f.addScaledVector(s,$c.z),f)}static getInterpolatedAttribute(t,n,r,i,a,c){return VT.setScalar(0),jT.setScalar(0),HT.setScalar(0),VT.fromBufferAttribute(t,n),jT.fromBufferAttribute(t,r),HT.fromBufferAttribute(t,i),c.setScalar(0),c.addScaledVector(VT,a.x),c.addScaledVector(jT,a.y),c.addScaledVector(HT,a.z),c}static isFrontFacing(t,n,r,i){return yl.subVectors(r,n),Uc.subVectors(t,n),yl.cross(Uc).dot(i)<0}set(t,n,r){return this.a.copy(t),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(t,n,r,i){return this.a.copy(t[n]),this.b.copy(t[r]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,n,r,i){return this.a.fromBufferAttribute(t,n),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return yl.subVectors(this.c,this.b),Uc.subVectors(this.a,this.b),yl.cross(Uc).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Ml.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,n){return Ml.getBarycoord(t,this.a,this.b,this.c,n)}getInterpolation(t,n,r,i,a){return Ml.getInterpolation(t,this.a,this.b,this.c,n,r,i,a)}containsPoint(t){return Ml.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Ml.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,n){const r=this.a,i=this.b,a=this.c;let c,s;nm.subVectors(i,r),rm.subVectors(a,r),BT.subVectors(t,r);const f=nm.dot(BT),g=rm.dot(BT);if(f<=0&&g<=0)return n.copy(r);UT.subVectors(t,i);const _=nm.dot(UT),x=rm.dot(UT);if(_>=0&&x<=_)return n.copy(i);const C=f*x-_*g;if(C<=0&&f>=0&&_<=0)return c=f/(f-_),n.copy(r).addScaledVector(nm,c);$T.subVectors(t,a);const E=nm.dot($T),A=rm.dot($T);if(A>=0&&E<=A)return n.copy(a);const L=E*g-f*A;if(L<=0&&g>=0&&A<=0)return s=g/(g-A),n.copy(r).addScaledVector(rm,s);const I=_*A-E*x;if(I<=0&&x-_>=0&&E-A>=0)return vN.subVectors(a,i),s=(x-_)/(x-_+(E-A)),n.copy(i).addScaledVector(vN,s);const T=1/(I+L+C);return c=L*T,s=C*T,n.copy(r).addScaledVector(nm,c).addScaledVector(rm,s)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const U9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nh={h:0,s:0,l:0},sb={h:0,s:0,l:0};function GT(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*6*(2/3-n):e}class Nr{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,n,r)}set(t,n,r){if(n===void 0&&r===void 0){const i=t;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(t,n,r);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=Na){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Er.toWorkingColorSpace(this,n),this}setRGB(t,n,r,i=Er.workingColorSpace){return this.r=t,this.g=n,this.b=r,Er.toWorkingColorSpace(this,i),this}setHSL(t,n,r,i=Er.workingColorSpace){if(t=TL(t,1),n=_r(n,0,1),r=_r(r,0,1),n===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+n):r+n-r*n,c=2*r-a;this.r=GT(c,a,t+1/3),this.g=GT(c,a,t),this.b=GT(c,a,t-1/3)}return Er.toWorkingColorSpace(this,i),this}setStyle(t,n=Na){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let a;const c=i[1],s=i[2];switch(c){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const a=i[1],c=a.length;if(c===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,n);if(c===6)return this.setHex(parseInt(a,16),n);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,n);return this}setColorName(t,n=Na){const r=U9[t.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Qc(t.r),this.g=Qc(t.g),this.b=Qc(t.b),this}copyLinearToSRGB(t){return this.r=rg(t.r),this.g=rg(t.g),this.b=rg(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Na){return Er.fromWorkingColorSpace(rs.copy(this),t),Math.round(_r(rs.r*255,0,255))*65536+Math.round(_r(rs.g*255,0,255))*256+Math.round(_r(rs.b*255,0,255))}getHexString(t=Na){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=Er.workingColorSpace){Er.fromWorkingColorSpace(rs.copy(this),n);const r=rs.r,i=rs.g,a=rs.b,c=Math.max(r,i,a),s=Math.min(r,i,a);let f,g;const _=(s+c)/2;if(s===c)f=0,g=0;else{const x=c-s;switch(g=_<=.5?x/(c+s):x/(2-c-s),c){case r:f=(i-a)/x+(i<a?6:0);break;case i:f=(a-r)/x+2;break;case a:f=(r-i)/x+4;break}f/=6}return t.h=f,t.s=g,t.l=_,t}getRGB(t,n=Er.workingColorSpace){return Er.fromWorkingColorSpace(rs.copy(this),n),t.r=rs.r,t.g=rs.g,t.b=rs.b,t}getStyle(t=Na){Er.fromWorkingColorSpace(rs.copy(this),t);const n=rs.r,r=rs.g,i=rs.b;return t!==Na?`color(${t} ${n.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(t,n,r){return this.getHSL(nh),this.setHSL(nh.h+t,nh.s+n,nh.l+r)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(nh),t.getHSL(sb);const r=gy(nh.h,sb.h,n),i=gy(nh.s,sb.s,n),a=gy(nh.l,sb.l,n);return this.setHSL(r,i,a),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const n=this.r,r=this.g,i=this.b,a=t.elements;return this.r=a[0]*n+a[3]*r+a[6]*i,this.g=a[1]*n+a[4]*r+a[7]*i,this.b=a[2]*n+a[5]*r+a[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const rs=new Nr;Nr.NAMES=U9;let Nwe=0;class sx extends Bg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Nwe++}),this.uuid=Ug(),this.name="",this.type="Material",this.blending=ng,this.side=jh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=NA,this.blendDst=BA,this.blendEquation=af,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Nr(0,0,0),this.blendAlpha=0,this.depthFunc=Cg,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=nN,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Xp,this.stencilZFail=Xp,this.stencilZPass=Xp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const n in t){const r=t[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const i=this[n];if(i===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}}toJSON(t){const n=t===void 0||typeof t=="string";n&&(t={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==ng&&(r.blending=this.blending),this.side!==jh&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==NA&&(r.blendSrc=this.blendSrc),this.blendDst!==BA&&(r.blendDst=this.blendDst),this.blendEquation!==af&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Cg&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==nN&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Xp&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Xp&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Xp&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(a){const c=[];for(const s in a){const f=a[s];delete f.metadata,c.push(f)}return c}if(n){const a=i(t.textures),c=i(t.images);a.length>0&&(r.textures=a),c.length>0&&(r.images=c)}return r}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const n=t.clippingPlanes;let r=null;if(n!==null){const i=n.length;r=new Array(i);for(let a=0;a!==i;++a)r[a]=n[a].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Gh extends sx{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Nr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new yc,this.combine=M9,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Yi=new dt,ab=new kr;let Bwe=0;class mc{constructor(t,n,r=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Bwe++}),this.name="",this.array=t,this.itemSize=n,this.count=t!==void 0?t.length/n:0,this.normalized=r,this.usage=rN,this.updateRanges=[],this.gpuType=Yc,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,n){this.updateRanges.push({start:t,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,n,r){t*=this.itemSize,r*=n.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[t+i]=n.array[r+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)ab.fromBufferAttribute(this,n),ab.applyMatrix3(t),this.setXY(n,ab.x,ab.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Yi.fromBufferAttribute(this,n),Yi.applyMatrix3(t),this.setXYZ(n,Yi.x,Yi.y,Yi.z);return this}applyMatrix4(t){for(let n=0,r=this.count;n<r;n++)Yi.fromBufferAttribute(this,n),Yi.applyMatrix4(t),this.setXYZ(n,Yi.x,Yi.y,Yi.z);return this}applyNormalMatrix(t){for(let n=0,r=this.count;n<r;n++)Yi.fromBufferAttribute(this,n),Yi.applyNormalMatrix(t),this.setXYZ(n,Yi.x,Yi.y,Yi.z);return this}transformDirection(t){for(let n=0,r=this.count;n<r;n++)Yi.fromBufferAttribute(this,n),Yi.transformDirection(t),this.setXYZ(n,Yi.x,Yi.y,Yi.z);return this}set(t,n=0){return this.array.set(t,n),this}getComponent(t,n){let r=this.array[t*this.itemSize+n];return this.normalized&&(r=mm(r,this.array)),r}setComponent(t,n,r){return this.normalized&&(r=fs(r,this.array)),this.array[t*this.itemSize+n]=r,this}getX(t){let n=this.array[t*this.itemSize];return this.normalized&&(n=mm(n,this.array)),n}setX(t,n){return this.normalized&&(n=fs(n,this.array)),this.array[t*this.itemSize]=n,this}getY(t){let n=this.array[t*this.itemSize+1];return this.normalized&&(n=mm(n,this.array)),n}setY(t,n){return this.normalized&&(n=fs(n,this.array)),this.array[t*this.itemSize+1]=n,this}getZ(t){let n=this.array[t*this.itemSize+2];return this.normalized&&(n=mm(n,this.array)),n}setZ(t,n){return this.normalized&&(n=fs(n,this.array)),this.array[t*this.itemSize+2]=n,this}getW(t){let n=this.array[t*this.itemSize+3];return this.normalized&&(n=mm(n,this.array)),n}setW(t,n){return this.normalized&&(n=fs(n,this.array)),this.array[t*this.itemSize+3]=n,this}setXY(t,n,r){return t*=this.itemSize,this.normalized&&(n=fs(n,this.array),r=fs(r,this.array)),this.array[t+0]=n,this.array[t+1]=r,this}setXYZ(t,n,r,i){return t*=this.itemSize,this.normalized&&(n=fs(n,this.array),r=fs(r,this.array),i=fs(i,this.array)),this.array[t+0]=n,this.array[t+1]=r,this.array[t+2]=i,this}setXYZW(t,n,r,i,a){return t*=this.itemSize,this.normalized&&(n=fs(n,this.array),r=fs(r,this.array),i=fs(i,this.array),a=fs(a,this.array)),this.array[t+0]=n,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=a,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==rN&&(t.usage=this.usage),t}}class $9 extends mc{constructor(t,n,r){super(new Uint16Array(t),n,r)}}class V9 extends mc{constructor(t,n,r){super(new Uint32Array(t),n,r)}}class Sa extends mc{constructor(t,n,r){super(new Float32Array(t),n,r)}}let Uwe=0;const Da=new Vr,WT=new Ho,im=new dt,sa=new $g,C0=new $g,xo=new dt;class bc extends Bg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Uwe++}),this.uuid=Ug(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(N9(t)?V9:$9)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,n){return this.attributes[t]=n,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,n,r=0){this.groups.push({start:t,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(t,n){this.drawRange.start=t,this.drawRange.count=n}applyMatrix4(t){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(t),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const a=new or().getNormalMatrix(t);r.applyNormalMatrix(a),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Da.makeRotationFromQuaternion(t),this.applyMatrix4(Da),this}rotateX(t){return Da.makeRotationX(t),this.applyMatrix4(Da),this}rotateY(t){return Da.makeRotationY(t),this.applyMatrix4(Da),this}rotateZ(t){return Da.makeRotationZ(t),this.applyMatrix4(Da),this}translate(t,n,r){return Da.makeTranslation(t,n,r),this.applyMatrix4(Da),this}scale(t,n,r){return Da.makeScale(t,n,r),this.applyMatrix4(Da),this}lookAt(t){return WT.lookAt(t),WT.updateMatrix(),this.applyMatrix4(WT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(im).negate(),this.translate(im.x,im.y,im.z),this}setFromPoints(t){const n=this.getAttribute("position");if(n===void 0){const r=[];for(let i=0,a=t.length;i<a;i++){const c=t[i];r.push(c.x,c.y,c.z||0)}this.setAttribute("position",new Sa(r,3))}else{const r=Math.min(t.length,n.count);for(let i=0;i<r;i++){const a=t[i];n.setXYZ(i,a.x,a.y,a.z||0)}t.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new $g);const t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new dt(-1/0,-1/0,-1/0),new dt(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),n)for(let r=0,i=n.length;r<i;r++){const a=n[r];sa.setFromBufferAttribute(a),this.morphTargetsRelative?(xo.addVectors(this.boundingBox.min,sa.min),this.boundingBox.expandByPoint(xo),xo.addVectors(this.boundingBox.max,sa.max),this.boundingBox.expandByPoint(xo)):(this.boundingBox.expandByPoint(sa.min),this.boundingBox.expandByPoint(sa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new oC);const t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new dt,1/0);return}if(t){const r=this.boundingSphere.center;if(sa.setFromBufferAttribute(t),n)for(let a=0,c=n.length;a<c;a++){const s=n[a];C0.setFromBufferAttribute(s),this.morphTargetsRelative?(xo.addVectors(sa.min,C0.min),sa.expandByPoint(xo),xo.addVectors(sa.max,C0.max),sa.expandByPoint(xo)):(sa.expandByPoint(C0.min),sa.expandByPoint(C0.max))}sa.getCenter(r);let i=0;for(let a=0,c=t.count;a<c;a++)xo.fromBufferAttribute(t,a),i=Math.max(i,r.distanceToSquared(xo));if(n)for(let a=0,c=n.length;a<c;a++){const s=n[a],f=this.morphTargetsRelative;for(let g=0,_=s.count;g<_;g++)xo.fromBufferAttribute(s,g),f&&(im.fromBufferAttribute(t,g),xo.add(im)),i=Math.max(i,r.distanceToSquared(xo))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,n=this.attributes;if(t===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,i=n.normal,a=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new mc(new Float32Array(4*r.count),4));const c=this.getAttribute("tangent"),s=[],f=[];for(let Q=0;Q<r.count;Q++)s[Q]=new dt,f[Q]=new dt;const g=new dt,_=new dt,x=new dt,C=new kr,E=new kr,A=new kr,L=new dt,I=new dt;function T(Q,K,N){g.fromBufferAttribute(r,Q),_.fromBufferAttribute(r,K),x.fromBufferAttribute(r,N),C.fromBufferAttribute(a,Q),E.fromBufferAttribute(a,K),A.fromBufferAttribute(a,N),_.sub(g),x.sub(g),E.sub(C),A.sub(C);const re=1/(E.x*A.y-A.x*E.y);isFinite(re)&&(L.copy(_).multiplyScalar(A.y).addScaledVector(x,-E.y).multiplyScalar(re),I.copy(x).multiplyScalar(E.x).addScaledVector(_,-A.x).multiplyScalar(re),s[Q].add(L),s[K].add(L),s[N].add(L),f[Q].add(I),f[K].add(I),f[N].add(I))}let O=this.groups;O.length===0&&(O=[{start:0,count:t.count}]);for(let Q=0,K=O.length;Q<K;++Q){const N=O[Q],re=N.start,ye=N.count;for(let ge=re,Ve=re+ye;ge<Ve;ge+=3)T(t.getX(ge+0),t.getX(ge+1),t.getX(ge+2))}const D=new dt,U=new dt,H=new dt,V=new dt;function q(Q){H.fromBufferAttribute(i,Q),V.copy(H);const K=s[Q];D.copy(K),D.sub(H.multiplyScalar(H.dot(K))).normalize(),U.crossVectors(V,K);const re=U.dot(f[Q])<0?-1:1;c.setXYZW(Q,D.x,D.y,D.z,re)}for(let Q=0,K=O.length;Q<K;++Q){const N=O[Q],re=N.start,ye=N.count;for(let ge=re,Ve=re+ye;ge<Ve;ge+=3)q(t.getX(ge+0)),q(t.getX(ge+1)),q(t.getX(ge+2))}}computeVertexNormals(){const t=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new mc(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let C=0,E=r.count;C<E;C++)r.setXYZ(C,0,0,0);const i=new dt,a=new dt,c=new dt,s=new dt,f=new dt,g=new dt,_=new dt,x=new dt;if(t)for(let C=0,E=t.count;C<E;C+=3){const A=t.getX(C+0),L=t.getX(C+1),I=t.getX(C+2);i.fromBufferAttribute(n,A),a.fromBufferAttribute(n,L),c.fromBufferAttribute(n,I),_.subVectors(c,a),x.subVectors(i,a),_.cross(x),s.fromBufferAttribute(r,A),f.fromBufferAttribute(r,L),g.fromBufferAttribute(r,I),s.add(_),f.add(_),g.add(_),r.setXYZ(A,s.x,s.y,s.z),r.setXYZ(L,f.x,f.y,f.z),r.setXYZ(I,g.x,g.y,g.z)}else for(let C=0,E=n.count;C<E;C+=3)i.fromBufferAttribute(n,C+0),a.fromBufferAttribute(n,C+1),c.fromBufferAttribute(n,C+2),_.subVectors(c,a),x.subVectors(i,a),_.cross(x),r.setXYZ(C+0,_.x,_.y,_.z),r.setXYZ(C+1,_.x,_.y,_.z),r.setXYZ(C+2,_.x,_.y,_.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let n=0,r=t.count;n<r;n++)xo.fromBufferAttribute(t,n),xo.normalize(),t.setXYZ(n,xo.x,xo.y,xo.z)}toNonIndexed(){function t(s,f){const g=s.array,_=s.itemSize,x=s.normalized,C=new g.constructor(f.length*_);let E=0,A=0;for(let L=0,I=f.length;L<I;L++){s.isInterleavedBufferAttribute?E=f[L]*s.data.stride+s.offset:E=f[L]*_;for(let T=0;T<_;T++)C[A++]=g[E++]}return new mc(C,_,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new bc,r=this.index.array,i=this.attributes;for(const s in i){const f=i[s],g=t(f,r);n.setAttribute(s,g)}const a=this.morphAttributes;for(const s in a){const f=[],g=a[s];for(let _=0,x=g.length;_<x;_++){const C=g[_],E=t(C,r);f.push(E)}n.morphAttributes[s]=f}n.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let s=0,f=c.length;s<f;s++){const g=c[s];n.addGroup(g.start,g.count,g.materialIndex)}return n}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const g in f)f[g]!==void 0&&(t[g]=f[g]);return t}t.data={attributes:{}};const n=this.index;n!==null&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const f in r){const g=r[f];t.data.attributes[f]=g.toJSON(t.data)}const i={};let a=!1;for(const f in this.morphAttributes){const g=this.morphAttributes[f],_=[];for(let x=0,C=g.length;x<C;x++){const E=g[x];_.push(E.toJSON(t.data))}_.length>0&&(i[f]=_,a=!0)}a&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(t.data.groups=JSON.parse(JSON.stringify(c)));const s=this.boundingSphere;return s!==null&&(t.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=t.name;const r=t.index;r!==null&&this.setIndex(r.clone());const i=t.attributes;for(const g in i){const _=i[g];this.setAttribute(g,_.clone(n))}const a=t.morphAttributes;for(const g in a){const _=[],x=a[g];for(let C=0,E=x.length;C<E;C++)_.push(x[C].clone(n));this.morphAttributes[g]=_}this.morphTargetsRelative=t.morphTargetsRelative;const c=t.groups;for(let g=0,_=c.length;g<_;g++){const x=c[g];this.addGroup(x.start,x.count,x.materialIndex)}const s=t.boundingBox;s!==null&&(this.boundingBox=s.clone());const f=t.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const yN=new Vr,Zd=new AL,lb=new oC,_N=new dt,cb=new dt,ub=new dt,hb=new dt,qT=new dt,db=new dt,xN=new dt,fb=new dt;class Os extends Ho{constructor(t=new bc,n=new Gh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=i.length;a<c;a++){const s=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=a}}}}getVertexPosition(t,n){const r=this.geometry,i=r.attributes.position,a=r.morphAttributes.position,c=r.morphTargetsRelative;n.fromBufferAttribute(i,t);const s=this.morphTargetInfluences;if(a&&s){db.set(0,0,0);for(let f=0,g=a.length;f<g;f++){const _=s[f],x=a[f];_!==0&&(qT.fromBufferAttribute(x,t),c?db.addScaledVector(qT,_):db.addScaledVector(qT.sub(n),_))}n.add(db)}return n}raycast(t,n){const r=this.geometry,i=this.material,a=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),lb.copy(r.boundingSphere),lb.applyMatrix4(a),Zd.copy(t.ray).recast(t.near),!(lb.containsPoint(Zd.origin)===!1&&(Zd.intersectSphere(lb,_N)===null||Zd.origin.distanceToSquared(_N)>(t.far-t.near)**2))&&(yN.copy(a).invert(),Zd.copy(t.ray).applyMatrix4(yN),!(r.boundingBox!==null&&Zd.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(t,n,Zd)))}_computeIntersections(t,n,r){let i;const a=this.geometry,c=this.material,s=a.index,f=a.attributes.position,g=a.attributes.uv,_=a.attributes.uv1,x=a.attributes.normal,C=a.groups,E=a.drawRange;if(s!==null)if(Array.isArray(c))for(let A=0,L=C.length;A<L;A++){const I=C[A],T=c[I.materialIndex],O=Math.max(I.start,E.start),D=Math.min(s.count,Math.min(I.start+I.count,E.start+E.count));for(let U=O,H=D;U<H;U+=3){const V=s.getX(U),q=s.getX(U+1),Q=s.getX(U+2);i=pb(this,T,t,r,g,_,x,V,q,Q),i&&(i.faceIndex=Math.floor(U/3),i.face.materialIndex=I.materialIndex,n.push(i))}}else{const A=Math.max(0,E.start),L=Math.min(s.count,E.start+E.count);for(let I=A,T=L;I<T;I+=3){const O=s.getX(I),D=s.getX(I+1),U=s.getX(I+2);i=pb(this,c,t,r,g,_,x,O,D,U),i&&(i.faceIndex=Math.floor(I/3),n.push(i))}}else if(f!==void 0)if(Array.isArray(c))for(let A=0,L=C.length;A<L;A++){const I=C[A],T=c[I.materialIndex],O=Math.max(I.start,E.start),D=Math.min(f.count,Math.min(I.start+I.count,E.start+E.count));for(let U=O,H=D;U<H;U+=3){const V=U,q=U+1,Q=U+2;i=pb(this,T,t,r,g,_,x,V,q,Q),i&&(i.faceIndex=Math.floor(U/3),i.face.materialIndex=I.materialIndex,n.push(i))}}else{const A=Math.max(0,E.start),L=Math.min(f.count,E.start+E.count);for(let I=A,T=L;I<T;I+=3){const O=I,D=I+1,U=I+2;i=pb(this,c,t,r,g,_,x,O,D,U),i&&(i.faceIndex=Math.floor(I/3),n.push(i))}}}}function $we(e,t,n,r,i,a,c,s){let f;if(t.side===Vs?f=r.intersectTriangle(c,a,i,!0,s):f=r.intersectTriangle(i,a,c,t.side===jh,s),f===null)return null;fb.copy(s),fb.applyMatrix4(e.matrixWorld);const g=n.ray.origin.distanceTo(fb);return g<n.near||g>n.far?null:{distance:g,point:fb.clone(),object:e}}function pb(e,t,n,r,i,a,c,s,f,g){e.getVertexPosition(s,cb),e.getVertexPosition(f,ub),e.getVertexPosition(g,hb);const _=$we(e,t,n,r,cb,ub,hb,xN);if(_){const x=new dt;Ml.getBarycoord(xN,cb,ub,hb,x),i&&(_.uv=Ml.getInterpolatedAttribute(i,s,f,g,x,new kr)),a&&(_.uv1=Ml.getInterpolatedAttribute(a,s,f,g,x,new kr)),c&&(_.normal=Ml.getInterpolatedAttribute(c,s,f,g,x,new dt),_.normal.dot(r.direction)>0&&_.normal.multiplyScalar(-1));const C={a:s,b:f,c:g,normal:new dt,materialIndex:0};Ml.getNormal(cb,ub,hb,C.normal),_.face=C,_.barycoord=x}return _}class ax extends bc{constructor(t=1,n=1,r=1,i=1,a=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:n,depth:r,widthSegments:i,heightSegments:a,depthSegments:c};const s=this;i=Math.floor(i),a=Math.floor(a),c=Math.floor(c);const f=[],g=[],_=[],x=[];let C=0,E=0;A("z","y","x",-1,-1,r,n,t,c,a,0),A("z","y","x",1,-1,r,n,-t,c,a,1),A("x","z","y",1,1,t,r,n,i,c,2),A("x","z","y",1,-1,t,r,-n,i,c,3),A("x","y","z",1,-1,t,n,r,i,a,4),A("x","y","z",-1,-1,t,n,-r,i,a,5),this.setIndex(f),this.setAttribute("position",new Sa(g,3)),this.setAttribute("normal",new Sa(_,3)),this.setAttribute("uv",new Sa(x,2));function A(L,I,T,O,D,U,H,V,q,Q,K){const N=U/q,re=H/Q,ye=U/2,ge=H/2,Ve=V/2,Ie=q+1,ve=Q+1;let Se=0,Me=0;const Be=new dt;for(let Qe=0;Qe<ve;Qe++){const st=Qe*re-ge;for(let ct=0;ct<Ie;ct++){const Xt=ct*N-ye;Be[L]=Xt*O,Be[I]=st*D,Be[T]=Ve,g.push(Be.x,Be.y,Be.z),Be[L]=0,Be[I]=0,Be[T]=V>0?1:-1,_.push(Be.x,Be.y,Be.z),x.push(ct/q),x.push(1-Qe/Q),Se+=1}}for(let Qe=0;Qe<Q;Qe++)for(let st=0;st<q;st++){const ct=C+st+Ie*Qe,Xt=C+st+Ie*(Qe+1),je=C+(st+1)+Ie*(Qe+1),lt=C+(st+1)+Ie*Qe;f.push(ct,Xt,lt),f.push(Xt,je,lt),Me+=6}s.addGroup(E,Me,K),E+=Me,C+=Se}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new ax(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Pg(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function ps(e){const t={};for(let n=0;n<e.length;n++){const r=Pg(e[n]);for(const i in r)t[i]=r[i]}return t}function Vwe(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}function j9(e){const t=e.getRenderTarget();return t===null?e.outputColorSpace:t.isXRRenderTarget===!0?t.texture.colorSpace:Er.workingColorSpace}const jwe={clone:Pg,merge:ps};var Hwe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Gwe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class hu extends sx{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Hwe,this.fragmentShader=Gwe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Pg(t.uniforms),this.uniformsGroups=Vwe(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const n=super.toJSON(t);n.glslVersion=this.glslVersion,n.uniforms={};for(const i in this.uniforms){const c=this.uniforms[i].value;c&&c.isTexture?n.uniforms[i]={type:"t",value:c.toJSON(t).uuid}:c&&c.isColor?n.uniforms[i]={type:"c",value:c.getHex()}:c&&c.isVector2?n.uniforms[i]={type:"v2",value:c.toArray()}:c&&c.isVector3?n.uniforms[i]={type:"v3",value:c.toArray()}:c&&c.isVector4?n.uniforms[i]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?n.uniforms[i]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?n.uniforms[i]={type:"m4",value:c.toArray()}:n.uniforms[i]={value:c}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class H9 extends Ho{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Vr,this.projectionMatrix=new Vr,this.projectionMatrixInverse=new Vr,this.coordinateSystem=Kc}copy(t,n){return super.copy(t,n),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,n){super.updateWorldMatrix(t,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const rh=new dt,bN=new kr,wN=new kr;class da extends H9{constructor(t=50,n=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,n){return super.copy(t,n),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const n=.5*this.getFilmHeight()/t;this.fov=f_*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(my*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return f_*2*Math.atan(Math.tan(my*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,n,r){rh.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(rh.x,rh.y).multiplyScalar(-t/rh.z),rh.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(rh.x,rh.y).multiplyScalar(-t/rh.z)}getViewSize(t,n){return this.getViewBounds(t,bN,wN),n.subVectors(wN,bN)}setViewOffset(t,n,r,i,a,c){this.aspect=t/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let n=t*Math.tan(my*.5*this.fov)/this.zoom,r=2*n,i=this.aspect*r,a=-.5*i;const c=this.view;if(this.view!==null&&this.view.enabled){const f=c.fullWidth,g=c.fullHeight;a+=c.offsetX*i/f,n-=c.offsetY*r/g,i*=c.width/f,r*=c.height/g}const s=this.filmOffset;s!==0&&(a+=t*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,n,n-r,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const n=super.toJSON(t);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const om=-90,sm=1;class Wwe extends Ho{constructor(t,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new da(om,sm,t,n);i.layers=this.layers,this.add(i);const a=new da(om,sm,t,n);a.layers=this.layers,this.add(a);const c=new da(om,sm,t,n);c.layers=this.layers,this.add(c);const s=new da(om,sm,t,n);s.layers=this.layers,this.add(s);const f=new da(om,sm,t,n);f.layers=this.layers,this.add(f);const g=new da(om,sm,t,n);g.layers=this.layers,this.add(g)}updateCoordinateSystem(){const t=this.coordinateSystem,n=this.children.concat(),[r,i,a,c,s,f]=n;for(const g of n)this.remove(g);if(t===Kc)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(t===mS)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);for(const g of n)this.add(g),g.updateMatrixWorld()}update(t,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[a,c,s,f,g,_]=this.children,x=t.getRenderTarget(),C=t.getActiveCubeFace(),E=t.getActiveMipmapLevel(),A=t.xr.enabled;t.xr.enabled=!1;const L=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,t.setRenderTarget(r,0,i),t.render(n,a),t.setRenderTarget(r,1,i),t.render(n,c),t.setRenderTarget(r,2,i),t.render(n,s),t.setRenderTarget(r,3,i),t.render(n,f),t.setRenderTarget(r,4,i),t.render(n,g),r.texture.generateMipmaps=L,t.setRenderTarget(r,5,i),t.render(n,_),t.setRenderTarget(x,C,E),t.xr.enabled=A,r.texture.needsPMREMUpdate=!0}}class G9 extends jo{constructor(t=[],n=Eg,r,i,a,c,s,f,g,_){super(t,n,r,i,a,c,s,f,g,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class qwe extends Hh{constructor(t=1,n={}){super(t,t,n),this.isWebGLCubeRenderTarget=!0;const r={width:t,height:t,depth:1},i=[r,r,r,r,r,r];this.texture=new G9(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:va}fromEquirectangularTexture(t,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ax(5,5,5),a=new hu({name:"CubemapFromEquirect",uniforms:Pg(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Vs,blending:Ph});a.uniforms.tEquirect.value=n;const c=new Os(i,a),s=n.minFilter;return n.minFilter===vh&&(n.minFilter=va),new Wwe(1,10,this).update(t,c),n.minFilter=s,c.geometry.dispose(),c.material.dispose(),this}clear(t,n=!0,r=!0,i=!0){const a=t.getRenderTarget();for(let c=0;c<6;c++)t.setRenderTarget(this,c),t.clear(n,r,i);t.setRenderTarget(a)}}class yh extends Ho{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Xwe={type:"move"};class XT{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new yh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new yh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new dt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new dt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new yh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new dt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new dt),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const n=this._hand;if(n)for(const r of t.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,n,r){let i=null,a=null,c=null;const s=this._targetRay,f=this._grip,g=this._hand;if(t&&n.session.visibilityState!=="visible-blurred"){if(g&&t.hand){c=!0;for(const L of t.hand.values()){const I=n.getJointPose(L,r),T=this._getHandJoint(g,L);I!==null&&(T.matrix.fromArray(I.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=I.radius),T.visible=I!==null}const _=g.joints["index-finger-tip"],x=g.joints["thumb-tip"],C=_.position.distanceTo(x.position),E=.02,A=.005;g.inputState.pinching&&C>E+A?(g.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!g.inputState.pinching&&C<=E-A&&(g.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else f!==null&&t.gripSpace&&(a=n.getPose(t.gripSpace,r),a!==null&&(f.matrix.fromArray(a.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,a.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(a.linearVelocity)):f.hasLinearVelocity=!1,a.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(a.angularVelocity)):f.hasAngularVelocity=!1));s!==null&&(i=n.getPose(t.targetRaySpace,r),i===null&&a!==null&&(i=a),i!==null&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Xwe)))}return s!==null&&(s.visible=i!==null),f!==null&&(f.visible=a!==null),g!==null&&(g.visible=c!==null),this}_getHandJoint(t,n){if(t.joints[n.jointName]===void 0){const r=new yh;r.matrixAutoUpdate=!1,r.visible=!1,t.joints[n.jointName]=r,t.add(r)}return t.joints[n.jointName]}}class vS extends Ho{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new yc,this.environmentIntensity=1,this.environmentRotation=new yc,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,n){return super.copy(t,n),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const n=super.toJSON(t);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}const ZT=new dt,Zwe=new dt,Ywe=new or;class nf{constructor(t=new dt(1,0,0),n=0){this.isPlane=!0,this.normal=t,this.constant=n}set(t,n){return this.normal.copy(t),this.constant=n,this}setComponents(t,n,r,i){return this.normal.set(t,n,r),this.constant=i,this}setFromNormalAndCoplanarPoint(t,n){return this.normal.copy(t),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(t,n,r){const i=ZT.subVectors(r,n).cross(Zwe.subVectors(t,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,n){return n.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,n){const r=t.delta(ZT),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(t.start)===0?n.copy(t.start):null;const a=-(t.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:n.copy(t.start).addScaledVector(r,a)}intersectsLine(t){const n=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return n<0&&r>0||r<0&&n>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,n){const r=n||Ywe.getNormalMatrix(t),i=this.coplanarPoint(ZT).applyMatrix4(t),a=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(a),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Yd=new oC,mb=new dt;class RL{constructor(t=new nf,n=new nf,r=new nf,i=new nf,a=new nf,c=new nf){this.planes=[t,n,r,i,a,c]}set(t,n,r,i,a,c){const s=this.planes;return s[0].copy(t),s[1].copy(n),s[2].copy(r),s[3].copy(i),s[4].copy(a),s[5].copy(c),this}copy(t){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(t.planes[r]);return this}setFromProjectionMatrix(t,n=Kc){const r=this.planes,i=t.elements,a=i[0],c=i[1],s=i[2],f=i[3],g=i[4],_=i[5],x=i[6],C=i[7],E=i[8],A=i[9],L=i[10],I=i[11],T=i[12],O=i[13],D=i[14],U=i[15];if(r[0].setComponents(f-a,C-g,I-E,U-T).normalize(),r[1].setComponents(f+a,C+g,I+E,U+T).normalize(),r[2].setComponents(f+c,C+_,I+A,U+O).normalize(),r[3].setComponents(f-c,C-_,I-A,U-O).normalize(),r[4].setComponents(f-s,C-x,I-L,U-D).normalize(),n===Kc)r[5].setComponents(f+s,C+x,I+L,U+D).normalize();else if(n===mS)r[5].setComponents(s,x,L,D).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),Yd.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const n=t.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Yd.copy(n.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Yd)}intersectsSprite(t){return Yd.center.set(0,0,0),Yd.radius=.7071067811865476,Yd.applyMatrix4(t.matrixWorld),this.intersectsSphere(Yd)}intersectsSphere(t){const n=this.planes,r=t.center,i=-t.radius;for(let a=0;a<6;a++)if(n[a].distanceToPoint(r)<i)return!1;return!0}intersectsBox(t){const n=this.planes;for(let r=0;r<6;r++){const i=n[r];if(mb.x=i.normal.x>0?t.max.x:t.min.x,mb.y=i.normal.y>0?t.max.y:t.min.y,mb.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(mb)<0)return!1}return!0}containsPoint(t){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class Kwe extends sx{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Nr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const yS=new dt,_S=new dt,SN=new Vr,E0=new AL,gb=new oC,YT=new dt,MN=new dt;class Jwe extends Ho{constructor(t=new bc,n=new Kwe){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const n=t.attributes.position,r=[0];for(let i=1,a=n.count;i<a;i++)yS.fromBufferAttribute(n,i-1),_S.fromBufferAttribute(n,i),r[i]=r[i-1],r[i]+=yS.distanceTo(_S);t.setAttribute("lineDistance",new Sa(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,n){const r=this.geometry,i=this.matrixWorld,a=t.params.Line.threshold,c=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),gb.copy(r.boundingSphere),gb.applyMatrix4(i),gb.radius+=a,t.ray.intersectsSphere(gb)===!1)return;SN.copy(i).invert(),E0.copy(t.ray).applyMatrix4(SN);const s=a/((this.scale.x+this.scale.y+this.scale.z)/3),f=s*s,g=this.isLineSegments?2:1,_=r.index,C=r.attributes.position;if(_!==null){const E=Math.max(0,c.start),A=Math.min(_.count,c.start+c.count);for(let L=E,I=A-1;L<I;L+=g){const T=_.getX(L),O=_.getX(L+1),D=vb(this,t,E0,f,T,O,L);D&&n.push(D)}if(this.isLineLoop){const L=_.getX(A-1),I=_.getX(E),T=vb(this,t,E0,f,L,I,A-1);T&&n.push(T)}}else{const E=Math.max(0,c.start),A=Math.min(C.count,c.start+c.count);for(let L=E,I=A-1;L<I;L+=g){const T=vb(this,t,E0,f,L,L+1,L);T&&n.push(T)}if(this.isLineLoop){const L=vb(this,t,E0,f,A-1,E,A-1);L&&n.push(L)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,c=i.length;a<c;a++){const s=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=a}}}}}function vb(e,t,n,r,i,a,c){const s=e.geometry.attributes.position;if(yS.fromBufferAttribute(s,i),_S.fromBufferAttribute(s,a),n.distanceSqToSegment(yS,_S,YT,MN)>r)return;YT.applyMatrix4(e.matrixWorld);const g=t.ray.origin.distanceTo(YT);if(!(g<t.near||g>t.far))return{distance:g,point:MN.clone().applyMatrix4(e.matrixWorld),index:c,face:null,faceIndex:null,barycoord:null,object:e}}const CN=new dt,EN=new dt;class Qwe extends Jwe{constructor(t,n){super(t,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.index===null){const n=t.attributes.position,r=[];for(let i=0,a=n.count;i<a;i+=2)CN.fromBufferAttribute(n,i),EN.fromBufferAttribute(n,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+CN.distanceTo(EN);t.setAttribute("lineDistance",new Sa(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class eSe extends jo{constructor(t,n,r,i,a=va,c=va,s,f,g){super(t,n,r,i,a,c,s,f,g),this.isVideoTexture=!0,this.generateMipmaps=!1;const _=this;function x(){_.needsUpdate=!0,t.requestVideoFrameCallback(x)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(x)}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;"requestVideoFrameCallback"in t===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class W9 extends jo{constructor(t,n,r=zf,i,a,c,s=Il,f=Il,g,_=h_){if(_!==h_&&_!==d_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,i,a,c,s,f,_,r,g),this.isDepthTexture=!0,this.image={width:t,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.source=new PL(Object.assign({},t.image)),this.compareFunction=t.compareFunction,this}toJSON(t){const n=super.toJSON(t);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class lx extends bc{constructor(t=1,n=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:n,widthSegments:r,heightSegments:i};const a=t/2,c=n/2,s=Math.floor(r),f=Math.floor(i),g=s+1,_=f+1,x=t/s,C=n/f,E=[],A=[],L=[],I=[];for(let T=0;T<_;T++){const O=T*C-c;for(let D=0;D<g;D++){const U=D*x-a;A.push(U,-O,0),L.push(0,0,1),I.push(D/s),I.push(1-T/f)}}for(let T=0;T<f;T++)for(let O=0;O<s;O++){const D=O+g*T,U=O+g*(T+1),H=O+1+g*(T+1),V=O+1+g*T;E.push(D,U,V),E.push(U,H,V)}this.setIndex(E),this.setAttribute("position",new Sa(A,3)),this.setAttribute("normal",new Sa(L,3)),this.setAttribute("uv",new Sa(I,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new lx(t.width,t.height,t.widthSegments,t.heightSegments)}}class Vg extends bc{constructor(t=1,n=32,r=16,i=0,a=Math.PI*2,c=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:n,heightSegments:r,phiStart:i,phiLength:a,thetaStart:c,thetaLength:s},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const f=Math.min(c+s,Math.PI);let g=0;const _=[],x=new dt,C=new dt,E=[],A=[],L=[],I=[];for(let T=0;T<=r;T++){const O=[],D=T/r;let U=0;T===0&&c===0?U=.5/n:T===r&&f===Math.PI&&(U=-.5/n);for(let H=0;H<=n;H++){const V=H/n;x.x=-t*Math.cos(i+V*a)*Math.sin(c+D*s),x.y=t*Math.cos(c+D*s),x.z=t*Math.sin(i+V*a)*Math.sin(c+D*s),A.push(x.x,x.y,x.z),C.copy(x).normalize(),L.push(C.x,C.y,C.z),I.push(V+U,1-D),O.push(g++)}_.push(O)}for(let T=0;T<r;T++)for(let O=0;O<n;O++){const D=_[T][O+1],U=_[T][O],H=_[T+1][O],V=_[T+1][O+1];(T!==0||c>0)&&E.push(D,U,V),(T!==r-1||f<Math.PI)&&E.push(U,H,V)}this.setIndex(E),this.setAttribute("position",new Sa(A,3)),this.setAttribute("normal",new Sa(L,3)),this.setAttribute("uv",new Sa(I,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Vg(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class tSe extends bc{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},t!==null){const n=[],r=new Set,i=new dt,a=new dt;if(t.index!==null){const c=t.attributes.position,s=t.index;let f=t.groups;f.length===0&&(f=[{start:0,count:s.count,materialIndex:0}]);for(let g=0,_=f.length;g<_;++g){const x=f[g],C=x.start,E=x.count;for(let A=C,L=C+E;A<L;A+=3)for(let I=0;I<3;I++){const T=s.getX(A+I),O=s.getX(A+(I+1)%3);i.fromBufferAttribute(c,T),a.fromBufferAttribute(c,O),TN(i,a,r)===!0&&(n.push(i.x,i.y,i.z),n.push(a.x,a.y,a.z))}}}else{const c=t.attributes.position;for(let s=0,f=c.count/3;s<f;s++)for(let g=0;g<3;g++){const _=3*s+g,x=3*s+(g+1)%3;i.fromBufferAttribute(c,_),a.fromBufferAttribute(c,x),TN(i,a,r)===!0&&(n.push(i.x,i.y,i.z),n.push(a.x,a.y,a.z))}}this.setAttribute("position",new Sa(n,3))}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}}function TN(e,t,n){const r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return n.has(r)===!0||n.has(i)===!0?!1:(n.add(r),n.add(i),!0)}class nSe extends sx{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Xbe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class rSe extends sx{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}const SI={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class iSe{constructor(t,n,r){const i=this;let a=!1,c=0,s=0,f;const g=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(_){s++,a===!1&&i.onStart!==void 0&&i.onStart(_,c,s),a=!0},this.itemEnd=function(_){c++,i.onProgress!==void 0&&i.onProgress(_,c,s),c===s&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(_){i.onError!==void 0&&i.onError(_)},this.resolveURL=function(_){return f?f(_):_},this.setURLModifier=function(_){return f=_,this},this.addHandler=function(_,x){return g.push(_,x),this},this.removeHandler=function(_){const x=g.indexOf(_);return x!==-1&&g.splice(x,2),this},this.getHandler=function(_){for(let x=0,C=g.length;x<C;x+=2){const E=g[x],A=g[x+1];if(E.global&&(E.lastIndex=0),E.test(_))return A}return null}}}const oSe=new iSe;let LL=class{constructor(t){this.manager=t!==void 0?t:oSe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){const r=this;return new Promise(function(i,a){r.load(t,i,n,a)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}};LL.DEFAULT_MATERIAL_NAME="__DEFAULT";class sSe extends H9{constructor(t=-1,n=1,r=1,i=-1,a=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=n,this.top=r,this.bottom=i,this.near=a,this.far=c,this.updateProjectionMatrix()}copy(t,n){return super.copy(t,n),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,n,r,i,a,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=a,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=r-t,c=r+t,s=i+n,f=i-n;if(this.view!==null&&this.view.enabled){const g=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=g*this.view.offsetX,c=a+g*this.view.width,s-=_*this.view.offsetY,f=s-_*this.view.height}this.projectionMatrix.makeOrthographic(a,c,s,f,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const n=super.toJSON(t);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class aSe extends da{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t,this.index=0}}const PN=new Vr;class lSe{constructor(t,n,r=0,i=1/0){this.ray=new AL(t,n),this.near=r,this.far=i,this.camera=null,this.layers=new IL,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,n){this.ray.set(t,n)}setFromCamera(t,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(t){return PN.identity().extractRotation(t.matrixWorld),this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(PN),this}intersectObject(t,n=!0,r=[]){return MI(t,this,r,n),r.sort(AN),r}intersectObjects(t,n=!0,r=[]){for(let i=0,a=t.length;i<a;i++)MI(t[i],this,r,n);return r.sort(AN),r}}function AN(e,t){return e.distance-t.distance}function MI(e,t,n,r){let i=!0;if(e.layers.test(t.layers)&&e.raycast(t,n)===!1&&(i=!1),i===!0&&r===!0){const a=e.children;for(let c=0,s=a.length;c<s;c++)MI(a[c],t,n,!0)}}function IN(e,t,n,r){const i=cSe(r);switch(n){case I9:return e*t;case L9:return e*t;case k9:return e*t*2;case D9:return e*t/i.components*i.byteLength;case ML:return e*t/i.components*i.byteLength;case z9:return e*t*2/i.components*i.byteLength;case CL:return e*t*2/i.components*i.byteLength;case R9:return e*t*3/i.components*i.byteLength;case El:return e*t*4/i.components*i.byteLength;case EL:return e*t*4/i.components*i.byteLength;case aw:case lw:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case cw:case uw:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case JA:case eI:return Math.max(e,16)*Math.max(t,8)/4;case KA:case QA:return Math.max(e,8)*Math.max(t,8)/2;case tI:case nI:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case rI:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case iI:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case oI:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case sI:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case aI:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case lI:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case cI:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case uI:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case hI:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case dI:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case fI:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case pI:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case mI:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case gI:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case vI:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case hw:case yI:case _I:return Math.ceil(e/4)*Math.ceil(t/4)*16;case O9:case xI:return Math.ceil(e/4)*Math.ceil(t/4)*8;case bI:case wI:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function cSe(e){switch(e){case uu:case T9:return{byteLength:1,components:1};case c_:case P9:case ox:return{byteLength:2,components:1};case wL:case SL:return{byteLength:2,components:4};case zf:case bL:case Yc:return{byteLength:4,components:1};case A9:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:xL}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=xL);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function q9(){let e=null,t=!1,n=null,r=null;function i(a,c){n(a,c),r=e.requestAnimationFrame(i)}return{start:function(){t!==!0&&n!==null&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(a){n=a},setContext:function(a){e=a}}}function uSe(e){const t=new WeakMap;function n(s,f){const g=s.array,_=s.usage,x=g.byteLength,C=e.createBuffer();e.bindBuffer(f,C),e.bufferData(f,g,_),s.onUploadCallback();let E;if(g instanceof Float32Array)E=e.FLOAT;else if(g instanceof Uint16Array)s.isFloat16BufferAttribute?E=e.HALF_FLOAT:E=e.UNSIGNED_SHORT;else if(g instanceof Int16Array)E=e.SHORT;else if(g instanceof Uint32Array)E=e.UNSIGNED_INT;else if(g instanceof Int32Array)E=e.INT;else if(g instanceof Int8Array)E=e.BYTE;else if(g instanceof Uint8Array)E=e.UNSIGNED_BYTE;else if(g instanceof Uint8ClampedArray)E=e.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+g);return{buffer:C,type:E,bytesPerElement:g.BYTES_PER_ELEMENT,version:s.version,size:x}}function r(s,f,g){const _=f.array,x=f.updateRanges;if(e.bindBuffer(g,s),x.length===0)e.bufferSubData(g,0,_);else{x.sort((E,A)=>E.start-A.start);let C=0;for(let E=1;E<x.length;E++){const A=x[C],L=x[E];L.start<=A.start+A.count+1?A.count=Math.max(A.count,L.start+L.count-A.start):(++C,x[C]=L)}x.length=C+1;for(let E=0,A=x.length;E<A;E++){const L=x[E];e.bufferSubData(g,L.start*_.BYTES_PER_ELEMENT,_,L.start,L.count)}f.clearUpdateRanges()}f.onUploadCallback()}function i(s){return s.isInterleavedBufferAttribute&&(s=s.data),t.get(s)}function a(s){s.isInterleavedBufferAttribute&&(s=s.data);const f=t.get(s);f&&(e.deleteBuffer(f.buffer),t.delete(s))}function c(s,f){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){const _=t.get(s);(!_||_.version<s.version)&&t.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}const g=t.get(s);if(g===void 0)t.set(s,n(s,f));else if(g.version<s.version){if(g.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(g.buffer,s,f),g.version=s.version}}return{get:i,remove:a,update:c}}var hSe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,dSe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,fSe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,pSe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mSe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,gSe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,vSe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,ySe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,_Se=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,xSe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,bSe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,wSe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,SSe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,MSe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,CSe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,ESe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,TSe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,PSe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,ASe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,ISe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,RSe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,LSe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,kSe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,DSe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,zSe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,OSe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,FSe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,NSe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,BSe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,USe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,$Se="gl_FragColor = linearToOutputTexel( gl_FragColor );",VSe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,jSe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,HSe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,GSe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,WSe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,qSe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,XSe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,ZSe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,YSe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,KSe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,JSe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,QSe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,eMe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,tMe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,nMe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,rMe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,iMe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,oMe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,sMe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,aMe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lMe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,cMe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,uMe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,hMe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,dMe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,fMe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,pMe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,mMe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,gMe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,vMe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,yMe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,_Me=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,xMe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,bMe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,wMe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,SMe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,MMe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,CMe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,EMe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,TMe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,PMe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,AMe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,IMe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,RMe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,LMe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,kMe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,DMe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,zMe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,OMe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,FMe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,NMe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,BMe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,UMe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,$Me=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,VMe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,jMe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,HMe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,GMe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,WMe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,qMe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,XMe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,ZMe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,YMe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,KMe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,JMe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,QMe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,eCe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,tCe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,nCe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,rCe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,iCe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,oCe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,sCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,aCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,lCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,cCe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const uCe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,hCe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,dCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fCe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,pCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,mCe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,gCe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,vCe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,yCe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,_Ce=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,xCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,bCe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wCe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,SCe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,MCe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,CCe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ECe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,TCe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,PCe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ACe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ICe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,RCe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,LCe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kCe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,DCe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,zCe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,OCe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,FCe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,NCe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,BCe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,UCe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$Ce=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,VCe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,jCe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ar={alphahash_fragment:hSe,alphahash_pars_fragment:dSe,alphamap_fragment:fSe,alphamap_pars_fragment:pSe,alphatest_fragment:mSe,alphatest_pars_fragment:gSe,aomap_fragment:vSe,aomap_pars_fragment:ySe,batching_pars_vertex:_Se,batching_vertex:xSe,begin_vertex:bSe,beginnormal_vertex:wSe,bsdfs:SSe,iridescence_fragment:MSe,bumpmap_pars_fragment:CSe,clipping_planes_fragment:ESe,clipping_planes_pars_fragment:TSe,clipping_planes_pars_vertex:PSe,clipping_planes_vertex:ASe,color_fragment:ISe,color_pars_fragment:RSe,color_pars_vertex:LSe,color_vertex:kSe,common:DSe,cube_uv_reflection_fragment:zSe,defaultnormal_vertex:OSe,displacementmap_pars_vertex:FSe,displacementmap_vertex:NSe,emissivemap_fragment:BSe,emissivemap_pars_fragment:USe,colorspace_fragment:$Se,colorspace_pars_fragment:VSe,envmap_fragment:jSe,envmap_common_pars_fragment:HSe,envmap_pars_fragment:GSe,envmap_pars_vertex:WSe,envmap_physical_pars_fragment:rMe,envmap_vertex:qSe,fog_vertex:XSe,fog_pars_vertex:ZSe,fog_fragment:YSe,fog_pars_fragment:KSe,gradientmap_pars_fragment:JSe,lightmap_pars_fragment:QSe,lights_lambert_fragment:eMe,lights_lambert_pars_fragment:tMe,lights_pars_begin:nMe,lights_toon_fragment:iMe,lights_toon_pars_fragment:oMe,lights_phong_fragment:sMe,lights_phong_pars_fragment:aMe,lights_physical_fragment:lMe,lights_physical_pars_fragment:cMe,lights_fragment_begin:uMe,lights_fragment_maps:hMe,lights_fragment_end:dMe,logdepthbuf_fragment:fMe,logdepthbuf_pars_fragment:pMe,logdepthbuf_pars_vertex:mMe,logdepthbuf_vertex:gMe,map_fragment:vMe,map_pars_fragment:yMe,map_particle_fragment:_Me,map_particle_pars_fragment:xMe,metalnessmap_fragment:bMe,metalnessmap_pars_fragment:wMe,morphinstance_vertex:SMe,morphcolor_vertex:MMe,morphnormal_vertex:CMe,morphtarget_pars_vertex:EMe,morphtarget_vertex:TMe,normal_fragment_begin:PMe,normal_fragment_maps:AMe,normal_pars_fragment:IMe,normal_pars_vertex:RMe,normal_vertex:LMe,normalmap_pars_fragment:kMe,clearcoat_normal_fragment_begin:DMe,clearcoat_normal_fragment_maps:zMe,clearcoat_pars_fragment:OMe,iridescence_pars_fragment:FMe,opaque_fragment:NMe,packing:BMe,premultiplied_alpha_fragment:UMe,project_vertex:$Me,dithering_fragment:VMe,dithering_pars_fragment:jMe,roughnessmap_fragment:HMe,roughnessmap_pars_fragment:GMe,shadowmap_pars_fragment:WMe,shadowmap_pars_vertex:qMe,shadowmap_vertex:XMe,shadowmask_pars_fragment:ZMe,skinbase_vertex:YMe,skinning_pars_vertex:KMe,skinning_vertex:JMe,skinnormal_vertex:QMe,specularmap_fragment:eCe,specularmap_pars_fragment:tCe,tonemapping_fragment:nCe,tonemapping_pars_fragment:rCe,transmission_fragment:iCe,transmission_pars_fragment:oCe,uv_pars_fragment:sCe,uv_pars_vertex:aCe,uv_vertex:lCe,worldpos_vertex:cCe,background_vert:uCe,background_frag:hCe,backgroundCube_vert:dCe,backgroundCube_frag:fCe,cube_vert:pCe,cube_frag:mCe,depth_vert:gCe,depth_frag:vCe,distanceRGBA_vert:yCe,distanceRGBA_frag:_Ce,equirect_vert:xCe,equirect_frag:bCe,linedashed_vert:wCe,linedashed_frag:SCe,meshbasic_vert:MCe,meshbasic_frag:CCe,meshlambert_vert:ECe,meshlambert_frag:TCe,meshmatcap_vert:PCe,meshmatcap_frag:ACe,meshnormal_vert:ICe,meshnormal_frag:RCe,meshphong_vert:LCe,meshphong_frag:kCe,meshphysical_vert:DCe,meshphysical_frag:zCe,meshtoon_vert:OCe,meshtoon_frag:FCe,points_vert:NCe,points_frag:BCe,shadow_vert:UCe,shadow_frag:$Ce,sprite_vert:VCe,sprite_frag:jCe},Tn={common:{diffuse:{value:new Nr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new or},alphaMap:{value:null},alphaMapTransform:{value:new or},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new or}},envmap:{envMap:{value:null},envMapRotation:{value:new or},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new or}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new or}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new or},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new or},normalScale:{value:new kr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new or},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new or}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new or}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new or}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Nr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Nr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new or},alphaTest:{value:0},uvTransform:{value:new or}},sprite:{diffuse:{value:new Nr(16777215)},opacity:{value:1},center:{value:new kr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new or},alphaMap:{value:null},alphaMapTransform:{value:new or},alphaTest:{value:0}}},oc={basic:{uniforms:ps([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.fog]),vertexShader:ar.meshbasic_vert,fragmentShader:ar.meshbasic_frag},lambert:{uniforms:ps([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.fog,Tn.lights,{emissive:{value:new Nr(0)}}]),vertexShader:ar.meshlambert_vert,fragmentShader:ar.meshlambert_frag},phong:{uniforms:ps([Tn.common,Tn.specularmap,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.fog,Tn.lights,{emissive:{value:new Nr(0)},specular:{value:new Nr(1118481)},shininess:{value:30}}]),vertexShader:ar.meshphong_vert,fragmentShader:ar.meshphong_frag},standard:{uniforms:ps([Tn.common,Tn.envmap,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.roughnessmap,Tn.metalnessmap,Tn.fog,Tn.lights,{emissive:{value:new Nr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ar.meshphysical_vert,fragmentShader:ar.meshphysical_frag},toon:{uniforms:ps([Tn.common,Tn.aomap,Tn.lightmap,Tn.emissivemap,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.gradientmap,Tn.fog,Tn.lights,{emissive:{value:new Nr(0)}}]),vertexShader:ar.meshtoon_vert,fragmentShader:ar.meshtoon_frag},matcap:{uniforms:ps([Tn.common,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,Tn.fog,{matcap:{value:null}}]),vertexShader:ar.meshmatcap_vert,fragmentShader:ar.meshmatcap_frag},points:{uniforms:ps([Tn.points,Tn.fog]),vertexShader:ar.points_vert,fragmentShader:ar.points_frag},dashed:{uniforms:ps([Tn.common,Tn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ar.linedashed_vert,fragmentShader:ar.linedashed_frag},depth:{uniforms:ps([Tn.common,Tn.displacementmap]),vertexShader:ar.depth_vert,fragmentShader:ar.depth_frag},normal:{uniforms:ps([Tn.common,Tn.bumpmap,Tn.normalmap,Tn.displacementmap,{opacity:{value:1}}]),vertexShader:ar.meshnormal_vert,fragmentShader:ar.meshnormal_frag},sprite:{uniforms:ps([Tn.sprite,Tn.fog]),vertexShader:ar.sprite_vert,fragmentShader:ar.sprite_frag},background:{uniforms:{uvTransform:{value:new or},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ar.background_vert,fragmentShader:ar.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new or}},vertexShader:ar.backgroundCube_vert,fragmentShader:ar.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ar.cube_vert,fragmentShader:ar.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ar.equirect_vert,fragmentShader:ar.equirect_frag},distanceRGBA:{uniforms:ps([Tn.common,Tn.displacementmap,{referencePosition:{value:new dt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ar.distanceRGBA_vert,fragmentShader:ar.distanceRGBA_frag},shadow:{uniforms:ps([Tn.lights,Tn.fog,{color:{value:new Nr(0)},opacity:{value:1}}]),vertexShader:ar.shadow_vert,fragmentShader:ar.shadow_frag}};oc.physical={uniforms:ps([oc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new or},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new or},clearcoatNormalScale:{value:new kr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new or},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new or},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new or},sheen:{value:0},sheenColor:{value:new Nr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new or},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new or},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new or},transmissionSamplerSize:{value:new kr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new or},attenuationDistance:{value:0},attenuationColor:{value:new Nr(0)},specularColor:{value:new Nr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new or},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new or},anisotropyVector:{value:new kr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new or}}]),vertexShader:ar.meshphysical_vert,fragmentShader:ar.meshphysical_frag};const yb={r:0,b:0,g:0},Kd=new yc,HCe=new Vr;function GCe(e,t,n,r,i,a,c){const s=new Nr(0);let f=a===!0?0:1,g,_,x=null,C=0,E=null;function A(D){let U=D.isScene===!0?D.background:null;return U&&U.isTexture&&(U=(D.backgroundBlurriness>0?n:t).get(U)),U}function L(D){let U=!1;const H=A(D);H===null?T(s,f):H&&H.isColor&&(T(H,1),U=!0);const V=e.xr.getEnvironmentBlendMode();V==="additive"?r.buffers.color.setClear(0,0,0,1,c):V==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,c),(e.autoClear||U)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))}function I(D,U){const H=A(U);H&&(H.isCubeTexture||H.mapping===iC)?(_===void 0&&(_=new Os(new ax(1,1,1),new hu({name:"BackgroundCubeMaterial",uniforms:Pg(oc.backgroundCube.uniforms),vertexShader:oc.backgroundCube.vertexShader,fragmentShader:oc.backgroundCube.fragmentShader,side:Vs,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(V,q,Q){this.matrixWorld.copyPosition(Q.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(_)),Kd.copy(U.backgroundRotation),Kd.x*=-1,Kd.y*=-1,Kd.z*=-1,H.isCubeTexture&&H.isRenderTargetTexture===!1&&(Kd.y*=-1,Kd.z*=-1),_.material.uniforms.envMap.value=H,_.material.uniforms.flipEnvMap.value=H.isCubeTexture&&H.isRenderTargetTexture===!1?-1:1,_.material.uniforms.backgroundBlurriness.value=U.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,_.material.uniforms.backgroundRotation.value.setFromMatrix4(HCe.makeRotationFromEuler(Kd)),_.material.toneMapped=Er.getTransfer(H.colorSpace)!==Wr,(x!==H||C!==H.version||E!==e.toneMapping)&&(_.material.needsUpdate=!0,x=H,C=H.version,E=e.toneMapping),_.layers.enableAll(),D.unshift(_,_.geometry,_.material,0,0,null)):H&&H.isTexture&&(g===void 0&&(g=new Os(new lx(2,2),new hu({name:"BackgroundMaterial",uniforms:Pg(oc.background.uniforms),vertexShader:oc.background.vertexShader,fragmentShader:oc.background.fragmentShader,side:jh,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),g.geometry.deleteAttribute("normal"),Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(g)),g.material.uniforms.t2D.value=H,g.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,g.material.toneMapped=Er.getTransfer(H.colorSpace)!==Wr,H.matrixAutoUpdate===!0&&H.updateMatrix(),g.material.uniforms.uvTransform.value.copy(H.matrix),(x!==H||C!==H.version||E!==e.toneMapping)&&(g.material.needsUpdate=!0,x=H,C=H.version,E=e.toneMapping),g.layers.enableAll(),D.unshift(g,g.geometry,g.material,0,0,null))}function T(D,U){D.getRGB(yb,j9(e)),r.buffers.color.setClear(yb.r,yb.g,yb.b,U,c)}function O(){_!==void 0&&(_.geometry.dispose(),_.material.dispose(),_=void 0),g!==void 0&&(g.geometry.dispose(),g.material.dispose(),g=void 0)}return{getClearColor:function(){return s},setClearColor:function(D,U=1){s.set(D),f=U,T(s,f)},getClearAlpha:function(){return f},setClearAlpha:function(D){f=D,T(s,f)},render:L,addToRenderList:I,dispose:O}}function WCe(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=C(null);let a=i,c=!1;function s(N,re,ye,ge,Ve){let Ie=!1;const ve=x(ge,ye,re);a!==ve&&(a=ve,g(a.object)),Ie=E(N,ge,ye,Ve),Ie&&A(N,ge,ye,Ve),Ve!==null&&t.update(Ve,e.ELEMENT_ARRAY_BUFFER),(Ie||c)&&(c=!1,U(N,re,ye,ge),Ve!==null&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(Ve).buffer))}function f(){return e.createVertexArray()}function g(N){return e.bindVertexArray(N)}function _(N){return e.deleteVertexArray(N)}function x(N,re,ye){const ge=ye.wireframe===!0;let Ve=r[N.id];Ve===void 0&&(Ve={},r[N.id]=Ve);let Ie=Ve[re.id];Ie===void 0&&(Ie={},Ve[re.id]=Ie);let ve=Ie[ge];return ve===void 0&&(ve=C(f()),Ie[ge]=ve),ve}function C(N){const re=[],ye=[],ge=[];for(let Ve=0;Ve<n;Ve++)re[Ve]=0,ye[Ve]=0,ge[Ve]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:re,enabledAttributes:ye,attributeDivisors:ge,object:N,attributes:{},index:null}}function E(N,re,ye,ge){const Ve=a.attributes,Ie=re.attributes;let ve=0;const Se=ye.getAttributes();for(const Me in Se)if(Se[Me].location>=0){const Qe=Ve[Me];let st=Ie[Me];if(st===void 0&&(Me==="instanceMatrix"&&N.instanceMatrix&&(st=N.instanceMatrix),Me==="instanceColor"&&N.instanceColor&&(st=N.instanceColor)),Qe===void 0||Qe.attribute!==st||st&&Qe.data!==st.data)return!0;ve++}return a.attributesNum!==ve||a.index!==ge}function A(N,re,ye,ge){const Ve={},Ie=re.attributes;let ve=0;const Se=ye.getAttributes();for(const Me in Se)if(Se[Me].location>=0){let Qe=Ie[Me];Qe===void 0&&(Me==="instanceMatrix"&&N.instanceMatrix&&(Qe=N.instanceMatrix),Me==="instanceColor"&&N.instanceColor&&(Qe=N.instanceColor));const st={};st.attribute=Qe,Qe&&Qe.data&&(st.data=Qe.data),Ve[Me]=st,ve++}a.attributes=Ve,a.attributesNum=ve,a.index=ge}function L(){const N=a.newAttributes;for(let re=0,ye=N.length;re<ye;re++)N[re]=0}function I(N){T(N,0)}function T(N,re){const ye=a.newAttributes,ge=a.enabledAttributes,Ve=a.attributeDivisors;ye[N]=1,ge[N]===0&&(e.enableVertexAttribArray(N),ge[N]=1),Ve[N]!==re&&(e.vertexAttribDivisor(N,re),Ve[N]=re)}function O(){const N=a.newAttributes,re=a.enabledAttributes;for(let ye=0,ge=re.length;ye<ge;ye++)re[ye]!==N[ye]&&(e.disableVertexAttribArray(ye),re[ye]=0)}function D(N,re,ye,ge,Ve,Ie,ve){ve===!0?e.vertexAttribIPointer(N,re,ye,Ve,Ie):e.vertexAttribPointer(N,re,ye,ge,Ve,Ie)}function U(N,re,ye,ge){L();const Ve=ge.attributes,Ie=ye.getAttributes(),ve=re.defaultAttributeValues;for(const Se in Ie){const Me=Ie[Se];if(Me.location>=0){let Be=Ve[Se];if(Be===void 0&&(Se==="instanceMatrix"&&N.instanceMatrix&&(Be=N.instanceMatrix),Se==="instanceColor"&&N.instanceColor&&(Be=N.instanceColor)),Be!==void 0){const Qe=Be.normalized,st=Be.itemSize,ct=t.get(Be);if(ct===void 0)continue;const Xt=ct.buffer,je=ct.type,lt=ct.bytesPerElement,Ot=je===e.INT||je===e.UNSIGNED_INT||Be.gpuType===bL;if(Be.isInterleavedBufferAttribute){const ut=Be.data,ot=ut.stride,Tt=Be.offset;if(ut.isInstancedInterleavedBuffer){for(let Ct=0;Ct<Me.locationSize;Ct++)T(Me.location+Ct,ut.meshPerAttribute);N.isInstancedMesh!==!0&&ge._maxInstanceCount===void 0&&(ge._maxInstanceCount=ut.meshPerAttribute*ut.count)}else for(let Ct=0;Ct<Me.locationSize;Ct++)I(Me.location+Ct);e.bindBuffer(e.ARRAY_BUFFER,Xt);for(let Ct=0;Ct<Me.locationSize;Ct++)D(Me.location+Ct,st/Me.locationSize,je,Qe,ot*lt,(Tt+st/Me.locationSize*Ct)*lt,Ot)}else{if(Be.isInstancedBufferAttribute){for(let ut=0;ut<Me.locationSize;ut++)T(Me.location+ut,Be.meshPerAttribute);N.isInstancedMesh!==!0&&ge._maxInstanceCount===void 0&&(ge._maxInstanceCount=Be.meshPerAttribute*Be.count)}else for(let ut=0;ut<Me.locationSize;ut++)I(Me.location+ut);e.bindBuffer(e.ARRAY_BUFFER,Xt);for(let ut=0;ut<Me.locationSize;ut++)D(Me.location+ut,st/Me.locationSize,je,Qe,st*lt,st/Me.locationSize*ut*lt,Ot)}}else if(ve!==void 0){const Qe=ve[Se];if(Qe!==void 0)switch(Qe.length){case 2:e.vertexAttrib2fv(Me.location,Qe);break;case 3:e.vertexAttrib3fv(Me.location,Qe);break;case 4:e.vertexAttrib4fv(Me.location,Qe);break;default:e.vertexAttrib1fv(Me.location,Qe)}}}}O()}function H(){Q();for(const N in r){const re=r[N];for(const ye in re){const ge=re[ye];for(const Ve in ge)_(ge[Ve].object),delete ge[Ve];delete re[ye]}delete r[N]}}function V(N){if(r[N.id]===void 0)return;const re=r[N.id];for(const ye in re){const ge=re[ye];for(const Ve in ge)_(ge[Ve].object),delete ge[Ve];delete re[ye]}delete r[N.id]}function q(N){for(const re in r){const ye=r[re];if(ye[N.id]===void 0)continue;const ge=ye[N.id];for(const Ve in ge)_(ge[Ve].object),delete ge[Ve];delete ye[N.id]}}function Q(){K(),c=!0,a!==i&&(a=i,g(a.object))}function K(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:s,reset:Q,resetDefaultState:K,dispose:H,releaseStatesOfGeometry:V,releaseStatesOfProgram:q,initAttributes:L,enableAttribute:I,disableUnusedAttributes:O}}function qCe(e,t,n){let r;function i(g){r=g}function a(g,_){e.drawArrays(r,g,_),n.update(_,r,1)}function c(g,_,x){x!==0&&(e.drawArraysInstanced(r,g,_,x),n.update(_,r,x))}function s(g,_,x){if(x===0)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,g,0,_,0,x);let E=0;for(let A=0;A<x;A++)E+=_[A];n.update(E,r,1)}function f(g,_,x,C){if(x===0)return;const E=t.get("WEBGL_multi_draw");if(E===null)for(let A=0;A<g.length;A++)c(g[A],_[A],C[A]);else{E.multiDrawArraysInstancedWEBGL(r,g,0,_,0,C,0,x);let A=0;for(let L=0;L<x;L++)A+=_[L]*C[L];n.update(A,r,1)}}this.setMode=i,this.render=a,this.renderInstances=c,this.renderMultiDraw=s,this.renderMultiDrawInstances=f}function XCe(e,t,n,r){let i;function a(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){const q=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(q.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function c(q){return!(q!==El&&r.convert(q)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT))}function s(q){const Q=q===ox&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(q!==uu&&r.convert(q)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&q!==Yc&&!Q)}function f(q){if(q==="highp"){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";q="mediump"}return q==="mediump"&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let g=n.precision!==void 0?n.precision:"highp";const _=f(g);_!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",_,"instead."),g=_);const x=n.logarithmicDepthBuffer===!0,C=n.reverseDepthBuffer===!0&&t.has("EXT_clip_control"),E=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),A=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),L=e.getParameter(e.MAX_TEXTURE_SIZE),I=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),T=e.getParameter(e.MAX_VERTEX_ATTRIBS),O=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),D=e.getParameter(e.MAX_VARYING_VECTORS),U=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),H=A>0,V=e.getParameter(e.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:f,textureFormatReadable:c,textureTypeReadable:s,precision:g,logarithmicDepthBuffer:x,reverseDepthBuffer:C,maxTextures:E,maxVertexTextures:A,maxTextureSize:L,maxCubemapSize:I,maxAttributes:T,maxVertexUniforms:O,maxVaryings:D,maxFragmentUniforms:U,vertexTextures:H,maxSamples:V}}function ZCe(e){const t=this;let n=null,r=0,i=!1,a=!1;const c=new nf,s=new or,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(x,C){const E=x.length!==0||C||r!==0||i;return i=C,r=x.length,E},this.beginShadows=function(){a=!0,_(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(x,C){n=_(x,C,0)},this.setState=function(x,C,E){const A=x.clippingPlanes,L=x.clipIntersection,I=x.clipShadows,T=e.get(x);if(!i||A===null||A.length===0||a&&!I)a?_(null):g();else{const O=a?0:r,D=O*4;let U=T.clippingState||null;f.value=U,U=_(A,C,D,E);for(let H=0;H!==D;++H)U[H]=n[H];T.clippingState=U,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=O}};function g(){f.value!==n&&(f.value=n,f.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function _(x,C,E,A){const L=x!==null?x.length:0;let I=null;if(L!==0){if(I=f.value,A!==!0||I===null){const T=E+L*4,O=C.matrixWorldInverse;s.getNormalMatrix(O),(I===null||I.length<T)&&(I=new Float32Array(T));for(let D=0,U=E;D!==L;++D,U+=4)c.copy(x[D]).applyMatrix4(O,s),c.normal.toArray(I,U),I[U+3]=c.constant}f.value=I,f.needsUpdate=!0}return t.numPlanes=L,t.numIntersection=0,I}}function YCe(e){let t=new WeakMap;function n(c,s){return s===qA?c.mapping=Eg:s===XA&&(c.mapping=Tg),c}function r(c){if(c&&c.isTexture){const s=c.mapping;if(s===qA||s===XA)if(t.has(c)){const f=t.get(c).texture;return n(f,c.mapping)}else{const f=c.image;if(f&&f.height>0){const g=new qwe(f.height);return g.fromEquirectangularTexture(e,c),t.set(c,g),c.addEventListener("dispose",i),n(g.texture,c.mapping)}else return null}}return c}function i(c){const s=c.target;s.removeEventListener("dispose",i);const f=t.get(s);f!==void 0&&(t.delete(s),f.dispose())}function a(){t=new WeakMap}return{get:r,dispose:a}}const Nm=4,RN=[.125,.215,.35,.446,.526,.582],lf=20,KT=new sSe,LN=new Nr;let JT=null,QT=0,eP=0,tP=!1;const rf=(1+Math.sqrt(5))/2,am=1/rf,kN=[new dt(-rf,am,0),new dt(rf,am,0),new dt(-am,0,rf),new dt(am,0,rf),new dt(0,rf,-am),new dt(0,rf,am),new dt(-1,1,-1),new dt(1,1,-1),new dt(-1,1,1),new dt(1,1,1)],KCe=new dt;class DN{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,n=0,r=.1,i=100,a={}){const{size:c=256,position:s=KCe}=a;JT=this._renderer.getRenderTarget(),QT=this._renderer.getActiveCubeFace(),eP=this._renderer.getActiveMipmapLevel(),tP=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(c);const f=this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(t,r,i,f,s),n>0&&this._blur(f,0,0,n),this._applyPMREM(f),this._cleanup(f),f}fromEquirectangular(t,n=null){return this._fromTexture(t,n)}fromCubemap(t,n=null){return this._fromTexture(t,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=FN(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=ON(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(JT,QT,eP),this._renderer.xr.enabled=tP,t.scissorTest=!1,_b(t,0,0,t.width,t.height)}_fromTexture(t,n){t.mapping===Eg||t.mapping===Tg?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),JT=this._renderer.getRenderTarget(),QT=this._renderer.getActiveCubeFace(),eP=this._renderer.getActiveMipmapLevel(),tP=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=n||this._allocateTargets();return this._textureToCubeUV(t,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:va,minFilter:va,generateMipmaps:!1,type:ox,format:El,colorSpace:Of,depthBuffer:!1},i=zN(t,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=zN(t,n,r);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=JCe(a)),this._blurMaterial=QCe(a,t,n)}return i}_compileMaterial(t){const n=new Os(this._lodPlanes[0],t);this._renderer.compile(n,KT)}_sceneToCubeUV(t,n,r,i,a){const f=new da(90,1,n,r),g=[1,-1,1,1,1,1],_=[1,1,1,-1,-1,-1],x=this._renderer,C=x.autoClear,E=x.toneMapping;x.getClearColor(LN),x.toneMapping=Ah,x.autoClear=!1;const A=new Gh({name:"PMREM.Background",side:Vs,depthWrite:!1,depthTest:!1}),L=new Os(new ax,A);let I=!1;const T=t.background;T?T.isColor&&(A.color.copy(T),t.background=null,I=!0):(A.color.copy(LN),I=!0);for(let O=0;O<6;O++){const D=O%3;D===0?(f.up.set(0,g[O],0),f.position.set(a.x,a.y,a.z),f.lookAt(a.x+_[O],a.y,a.z)):D===1?(f.up.set(0,0,g[O]),f.position.set(a.x,a.y,a.z),f.lookAt(a.x,a.y+_[O],a.z)):(f.up.set(0,g[O],0),f.position.set(a.x,a.y,a.z),f.lookAt(a.x,a.y,a.z+_[O]));const U=this._cubeSize;_b(i,D*U,O>2?U:0,U,U),x.setRenderTarget(i),I&&x.render(L,f),x.render(t,f)}L.geometry.dispose(),L.material.dispose(),x.toneMapping=E,x.autoClear=C,t.background=T}_textureToCubeUV(t,n){const r=this._renderer,i=t.mapping===Eg||t.mapping===Tg;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=FN()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=ON());const a=i?this._cubemapMaterial:this._equirectMaterial,c=new Os(this._lodPlanes[0],a),s=a.uniforms;s.envMap.value=t;const f=this._cubeSize;_b(n,0,0,3*f,2*f),r.setRenderTarget(n),r.render(c,KT)}_applyPMREM(t){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const i=this._lodPlanes.length;for(let a=1;a<i;a++){const c=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),s=kN[(i-a-1)%kN.length];this._blur(t,a-1,a,c,s)}n.autoClear=r}_blur(t,n,r,i,a){const c=this._pingPongRenderTarget;this._halfBlur(t,c,n,r,i,"latitudinal",a),this._halfBlur(c,t,r,r,i,"longitudinal",a)}_halfBlur(t,n,r,i,a,c,s){const f=this._renderer,g=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const _=3,x=new Os(this._lodPlanes[i],g),C=g.uniforms,E=this._sizeLods[r]-1,A=isFinite(a)?Math.PI/(2*E):2*Math.PI/(2*lf-1),L=a/A,I=isFinite(a)?1+Math.floor(_*L):lf;I>lf&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${I} samples when the maximum is set to ${lf}`);const T=[];let O=0;for(let q=0;q<lf;++q){const Q=q/L,K=Math.exp(-Q*Q/2);T.push(K),q===0?O+=K:q<I&&(O+=2*K)}for(let q=0;q<T.length;q++)T[q]=T[q]/O;C.envMap.value=t.texture,C.samples.value=I,C.weights.value=T,C.latitudinal.value=c==="latitudinal",s&&(C.poleAxis.value=s);const{_lodMax:D}=this;C.dTheta.value=A,C.mipInt.value=D-r;const U=this._sizeLods[i],H=3*U*(i>D-Nm?i-D+Nm:0),V=4*(this._cubeSize-U);_b(n,H,V,3*U,2*U),f.setRenderTarget(n),f.render(x,KT)}}function JCe(e){const t=[],n=[],r=[];let i=e;const a=e-Nm+1+RN.length;for(let c=0;c<a;c++){const s=Math.pow(2,i);n.push(s);let f=1/s;c>e-Nm?f=RN[c-e+Nm-1]:c===0&&(f=0),r.push(f);const g=1/(s-2),_=-g,x=1+g,C=[_,_,x,_,x,x,_,_,x,x,_,x],E=6,A=6,L=3,I=2,T=1,O=new Float32Array(L*A*E),D=new Float32Array(I*A*E),U=new Float32Array(T*A*E);for(let V=0;V<E;V++){const q=V%3*2/3-1,Q=V>2?0:-1,K=[q,Q,0,q+2/3,Q,0,q+2/3,Q+1,0,q,Q,0,q+2/3,Q+1,0,q,Q+1,0];O.set(K,L*A*V),D.set(C,I*A*V);const N=[V,V,V,V,V,V];U.set(N,T*A*V)}const H=new bc;H.setAttribute("position",new mc(O,L)),H.setAttribute("uv",new mc(D,I)),H.setAttribute("faceIndex",new mc(U,T)),t.push(H),i>Nm&&i--}return{lodPlanes:t,sizeLods:n,sigmas:r}}function zN(e,t,n){const r=new Hh(e,t,n);return r.texture.mapping=iC,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function _b(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function QCe(e,t,n){const r=new Float32Array(lf),i=new dt(0,1,0);return new hu({name:"SphericalGaussianBlur",defines:{n:lf,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:kL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ph,depthTest:!1,depthWrite:!1})}function ON(){return new hu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:kL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ph,depthTest:!1,depthWrite:!1})}function FN(){return new hu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:kL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ph,depthTest:!1,depthWrite:!1})}function kL(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function e2e(e){let t=new WeakMap,n=null;function r(s){if(s&&s.isTexture){const f=s.mapping,g=f===qA||f===XA,_=f===Eg||f===Tg;if(g||_){let x=t.get(s);const C=x!==void 0?x.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==C)return n===null&&(n=new DN(e)),x=g?n.fromEquirectangular(s,x):n.fromCubemap(s,x),x.texture.pmremVersion=s.pmremVersion,t.set(s,x),x.texture;if(x!==void 0)return x.texture;{const E=s.image;return g&&E&&E.height>0||_&&E&&i(E)?(n===null&&(n=new DN(e)),x=g?n.fromEquirectangular(s):n.fromCubemap(s),x.texture.pmremVersion=s.pmremVersion,t.set(s,x),s.addEventListener("dispose",a),x.texture):null}}}return s}function i(s){let f=0;const g=6;for(let _=0;_<g;_++)s[_]!==void 0&&f++;return f===g}function a(s){const f=s.target;f.removeEventListener("dispose",a);const g=t.get(f);g!==void 0&&(t.delete(f),g.dispose())}function c(){t=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:c}}function t2e(e){const t={};function n(r){if(t[r]!==void 0)return t[r];let i;switch(r){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(r)}return t[r]=i,i}return{has:function(r){return n(r)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(r){const i=n(r);return i===null&&dw("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function n2e(e,t,n,r){const i={},a=new WeakMap;function c(x){const C=x.target;C.index!==null&&t.remove(C.index);for(const A in C.attributes)t.remove(C.attributes[A]);C.removeEventListener("dispose",c),delete i[C.id];const E=a.get(C);E&&(t.remove(E),a.delete(C)),r.releaseStatesOfGeometry(C),C.isInstancedBufferGeometry===!0&&delete C._maxInstanceCount,n.memory.geometries--}function s(x,C){return i[C.id]===!0||(C.addEventListener("dispose",c),i[C.id]=!0,n.memory.geometries++),C}function f(x){const C=x.attributes;for(const E in C)t.update(C[E],e.ARRAY_BUFFER)}function g(x){const C=[],E=x.index,A=x.attributes.position;let L=0;if(E!==null){const O=E.array;L=E.version;for(let D=0,U=O.length;D<U;D+=3){const H=O[D+0],V=O[D+1],q=O[D+2];C.push(H,V,V,q,q,H)}}else if(A!==void 0){const O=A.array;L=A.version;for(let D=0,U=O.length/3-1;D<U;D+=3){const H=D+0,V=D+1,q=D+2;C.push(H,V,V,q,q,H)}}else return;const I=new(N9(C)?V9:$9)(C,1);I.version=L;const T=a.get(x);T&&t.remove(T),a.set(x,I)}function _(x){const C=a.get(x);if(C){const E=x.index;E!==null&&C.version<E.version&&g(x)}else g(x);return a.get(x)}return{get:s,update:f,getWireframeAttribute:_}}function r2e(e,t,n){let r;function i(C){r=C}let a,c;function s(C){a=C.type,c=C.bytesPerElement}function f(C,E){e.drawElements(r,E,a,C*c),n.update(E,r,1)}function g(C,E,A){A!==0&&(e.drawElementsInstanced(r,E,a,C*c,A),n.update(E,r,A))}function _(C,E,A){if(A===0)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,E,0,a,C,0,A);let I=0;for(let T=0;T<A;T++)I+=E[T];n.update(I,r,1)}function x(C,E,A,L){if(A===0)return;const I=t.get("WEBGL_multi_draw");if(I===null)for(let T=0;T<C.length;T++)g(C[T]/c,E[T],L[T]);else{I.multiDrawElementsInstancedWEBGL(r,E,0,a,C,0,L,0,A);let T=0;for(let O=0;O<A;O++)T+=E[O]*L[O];n.update(T,r,1)}}this.setMode=i,this.setIndex=s,this.render=f,this.renderInstances=g,this.renderMultiDraw=_,this.renderMultiDrawInstances=x}function i2e(e){const t={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,c,s){switch(n.calls++,c){case e.TRIANGLES:n.triangles+=s*(a/3);break;case e.LINES:n.lines+=s*(a/2);break;case e.LINE_STRIP:n.lines+=s*(a-1);break;case e.LINE_LOOP:n.lines+=s*a;break;case e.POINTS:n.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function i(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:t,render:n,programs:null,autoReset:!0,reset:i,update:r}}function o2e(e,t,n){const r=new WeakMap,i=new Oi;function a(c,s,f){const g=c.morphTargetInfluences,_=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,x=_!==void 0?_.length:0;let C=r.get(s);if(C===void 0||C.count!==x){let N=function(){Q.dispose(),r.delete(s),s.removeEventListener("dispose",N)};var E=N;C!==void 0&&C.texture.dispose();const A=s.morphAttributes.position!==void 0,L=s.morphAttributes.normal!==void 0,I=s.morphAttributes.color!==void 0,T=s.morphAttributes.position||[],O=s.morphAttributes.normal||[],D=s.morphAttributes.color||[];let U=0;A===!0&&(U=1),L===!0&&(U=2),I===!0&&(U=3);let H=s.attributes.position.count*U,V=1;H>t.maxTextureSize&&(V=Math.ceil(H/t.maxTextureSize),H=t.maxTextureSize);const q=new Float32Array(H*V*4*x),Q=new B9(q,H,V,x);Q.type=Yc,Q.needsUpdate=!0;const K=U*4;for(let re=0;re<x;re++){const ye=T[re],ge=O[re],Ve=D[re],Ie=H*V*4*re;for(let ve=0;ve<ye.count;ve++){const Se=ve*K;A===!0&&(i.fromBufferAttribute(ye,ve),q[Ie+Se+0]=i.x,q[Ie+Se+1]=i.y,q[Ie+Se+2]=i.z,q[Ie+Se+3]=0),L===!0&&(i.fromBufferAttribute(ge,ve),q[Ie+Se+4]=i.x,q[Ie+Se+5]=i.y,q[Ie+Se+6]=i.z,q[Ie+Se+7]=0),I===!0&&(i.fromBufferAttribute(Ve,ve),q[Ie+Se+8]=i.x,q[Ie+Se+9]=i.y,q[Ie+Se+10]=i.z,q[Ie+Se+11]=Ve.itemSize===4?i.w:1)}}C={count:x,texture:Q,size:new kr(H,V)},r.set(s,C),s.addEventListener("dispose",N)}if(c.isInstancedMesh===!0&&c.morphTexture!==null)f.getUniforms().setValue(e,"morphTexture",c.morphTexture,n);else{let A=0;for(let I=0;I<g.length;I++)A+=g[I];const L=s.morphTargetsRelative?1:1-A;f.getUniforms().setValue(e,"morphTargetBaseInfluence",L),f.getUniforms().setValue(e,"morphTargetInfluences",g)}f.getUniforms().setValue(e,"morphTargetsTexture",C.texture,n),f.getUniforms().setValue(e,"morphTargetsTextureSize",C.size)}return{update:a}}function s2e(e,t,n,r){let i=new WeakMap;function a(f){const g=r.render.frame,_=f.geometry,x=t.get(f,_);if(i.get(x)!==g&&(t.update(x),i.set(x,g)),f.isInstancedMesh&&(f.hasEventListener("dispose",s)===!1&&f.addEventListener("dispose",s),i.get(f)!==g&&(n.update(f.instanceMatrix,e.ARRAY_BUFFER),f.instanceColor!==null&&n.update(f.instanceColor,e.ARRAY_BUFFER),i.set(f,g))),f.isSkinnedMesh){const C=f.skeleton;i.get(C)!==g&&(C.update(),i.set(C,g))}return x}function c(){i=new WeakMap}function s(f){const g=f.target;g.removeEventListener("dispose",s),n.remove(g.instanceMatrix),g.instanceColor!==null&&n.remove(g.instanceColor)}return{update:a,dispose:c}}const X9=new jo,NN=new W9(1,1),Z9=new B9,Y9=new Iwe,K9=new G9,BN=[],UN=[],$N=new Float32Array(16),VN=new Float32Array(9),jN=new Float32Array(4);function jg(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=BN[i];if(a===void 0&&(a=new Float32Array(i),BN[i]=a),t!==0){r.toArray(a,0);for(let c=1,s=0;c!==t;++c)s+=n,e[c].toArray(a,s)}return a}function ho(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function fo(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function sC(e,t){let n=UN[t];n===void 0&&(n=new Int32Array(t),UN[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function a2e(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function l2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ho(n,t))return;e.uniform2fv(this.addr,t),fo(n,t)}}function c2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(t.r!==void 0)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(ho(n,t))return;e.uniform3fv(this.addr,t),fo(n,t)}}function u2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ho(n,t))return;e.uniform4fv(this.addr,t),fo(n,t)}}function h2e(e,t){const n=this.cache,r=t.elements;if(r===void 0){if(ho(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),fo(n,t)}else{if(ho(n,r))return;jN.set(r),e.uniformMatrix2fv(this.addr,!1,jN),fo(n,r)}}function d2e(e,t){const n=this.cache,r=t.elements;if(r===void 0){if(ho(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),fo(n,t)}else{if(ho(n,r))return;VN.set(r),e.uniformMatrix3fv(this.addr,!1,VN),fo(n,r)}}function f2e(e,t){const n=this.cache,r=t.elements;if(r===void 0){if(ho(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),fo(n,t)}else{if(ho(n,r))return;$N.set(r),e.uniformMatrix4fv(this.addr,!1,$N),fo(n,r)}}function p2e(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function m2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ho(n,t))return;e.uniform2iv(this.addr,t),fo(n,t)}}function g2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(ho(n,t))return;e.uniform3iv(this.addr,t),fo(n,t)}}function v2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ho(n,t))return;e.uniform4iv(this.addr,t),fo(n,t)}}function y2e(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function _2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(ho(n,t))return;e.uniform2uiv(this.addr,t),fo(n,t)}}function x2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(ho(n,t))return;e.uniform3uiv(this.addr,t),fo(n,t)}}function b2e(e,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(ho(n,t))return;e.uniform4uiv(this.addr,t),fo(n,t)}}function w2e(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i);let a;this.type===e.SAMPLER_2D_SHADOW?(NN.compareFunction=F9,a=NN):a=X9,n.setTexture2D(t||a,i)}function S2e(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||Y9,i)}function M2e(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||K9,i)}function C2e(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Z9,i)}function E2e(e){switch(e){case 5126:return a2e;case 35664:return l2e;case 35665:return c2e;case 35666:return u2e;case 35674:return h2e;case 35675:return d2e;case 35676:return f2e;case 5124:case 35670:return p2e;case 35667:case 35671:return m2e;case 35668:case 35672:return g2e;case 35669:case 35673:return v2e;case 5125:return y2e;case 36294:return _2e;case 36295:return x2e;case 36296:return b2e;case 35678:case 36198:case 36298:case 36306:case 35682:return w2e;case 35679:case 36299:case 36307:return S2e;case 35680:case 36300:case 36308:case 36293:return M2e;case 36289:case 36303:case 36311:case 36292:return C2e}}function T2e(e,t){e.uniform1fv(this.addr,t)}function P2e(e,t){const n=jg(t,this.size,2);e.uniform2fv(this.addr,n)}function A2e(e,t){const n=jg(t,this.size,3);e.uniform3fv(this.addr,n)}function I2e(e,t){const n=jg(t,this.size,4);e.uniform4fv(this.addr,n)}function R2e(e,t){const n=jg(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function L2e(e,t){const n=jg(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function k2e(e,t){const n=jg(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function D2e(e,t){e.uniform1iv(this.addr,t)}function z2e(e,t){e.uniform2iv(this.addr,t)}function O2e(e,t){e.uniform3iv(this.addr,t)}function F2e(e,t){e.uniform4iv(this.addr,t)}function N2e(e,t){e.uniform1uiv(this.addr,t)}function B2e(e,t){e.uniform2uiv(this.addr,t)}function U2e(e,t){e.uniform3uiv(this.addr,t)}function $2e(e,t){e.uniform4uiv(this.addr,t)}function V2e(e,t,n){const r=this.cache,i=t.length,a=sC(n,i);ho(r,a)||(e.uniform1iv(this.addr,a),fo(r,a));for(let c=0;c!==i;++c)n.setTexture2D(t[c]||X9,a[c])}function j2e(e,t,n){const r=this.cache,i=t.length,a=sC(n,i);ho(r,a)||(e.uniform1iv(this.addr,a),fo(r,a));for(let c=0;c!==i;++c)n.setTexture3D(t[c]||Y9,a[c])}function H2e(e,t,n){const r=this.cache,i=t.length,a=sC(n,i);ho(r,a)||(e.uniform1iv(this.addr,a),fo(r,a));for(let c=0;c!==i;++c)n.setTextureCube(t[c]||K9,a[c])}function G2e(e,t,n){const r=this.cache,i=t.length,a=sC(n,i);ho(r,a)||(e.uniform1iv(this.addr,a),fo(r,a));for(let c=0;c!==i;++c)n.setTexture2DArray(t[c]||Z9,a[c])}function W2e(e){switch(e){case 5126:return T2e;case 35664:return P2e;case 35665:return A2e;case 35666:return I2e;case 35674:return R2e;case 35675:return L2e;case 35676:return k2e;case 5124:case 35670:return D2e;case 35667:case 35671:return z2e;case 35668:case 35672:return O2e;case 35669:case 35673:return F2e;case 5125:return N2e;case 36294:return B2e;case 36295:return U2e;case 36296:return $2e;case 35678:case 36198:case 36298:case 36306:case 35682:return V2e;case 35679:case 36299:case 36307:return j2e;case 35680:case 36300:case 36308:case 36293:return H2e;case 36289:case 36303:case 36311:case 36292:return G2e}}class q2e{constructor(t,n,r){this.id=t,this.addr=r,this.cache=[],this.type=n.type,this.setValue=E2e(n.type)}}class X2e{constructor(t,n,r){this.id=t,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=W2e(n.type)}}class Z2e{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,n,r){const i=this.seq;for(let a=0,c=i.length;a!==c;++a){const s=i[a];s.setValue(t,n[s.id],r)}}}const nP=/(\w+)(\])?(\[|\.)?/g;function HN(e,t){e.seq.push(t),e.map[t.id]=t}function Y2e(e,t,n){const r=e.name,i=r.length;for(nP.lastIndex=0;;){const a=nP.exec(r),c=nP.lastIndex;let s=a[1];const f=a[2]==="]",g=a[3];if(f&&(s=s|0),g===void 0||g==="["&&c+2===i){HN(n,g===void 0?new q2e(s,e,t):new X2e(s,e,t));break}else{let x=n.map[s];x===void 0&&(x=new Z2e(s),HN(n,x)),n=x}}}class fw{constructor(t,n){this.seq=[],this.map={};const r=t.getProgramParameter(n,t.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const a=t.getActiveUniform(n,i),c=t.getUniformLocation(n,a.name);Y2e(a,c,this)}}setValue(t,n,r,i){const a=this.map[n];a!==void 0&&a.setValue(t,r,i)}setOptional(t,n,r){const i=n[r];i!==void 0&&this.setValue(t,r,i)}static upload(t,n,r,i){for(let a=0,c=n.length;a!==c;++a){const s=n[a],f=r[s.id];f.needsUpdate!==!1&&s.setValue(t,f.value,i)}}static seqWithValue(t,n){const r=[];for(let i=0,a=t.length;i!==a;++i){const c=t[i];c.id in n&&r.push(c)}return r}}function GN(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}const K2e=37297;let J2e=0;function Q2e(e,t){const n=e.split(`
`),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let c=i;c<a;c++){const s=c+1;r.push(`${s===t?">":" "} ${s}: ${n[c]}`)}return r.join(`
`)}const WN=new or;function eEe(e){Er._getMatrix(WN,Er.workingColorSpace,e);const t=`mat3( ${WN.elements.map(n=>n.toFixed(4))} )`;switch(Er.getTransfer(e)){case pS:return[t,"LinearTransferOETF"];case Wr:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}function qN(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(r&&i==="")return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const c=parseInt(a[1]);return n.toUpperCase()+`

`+i+`

`+Q2e(e.getShaderSource(t),c)}else return i}function tEe(e,t){const n=eEe(t);return[`vec4 ${e}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function nEe(e,t){let n;switch(t){case C9:n="Linear";break;case $be:n="Reinhard";break;case Vbe:n="Cineon";break;case jbe:n="ACESFilmic";break;case Gbe:n="AgX";break;case Wbe:n="Neutral";break;case Hbe:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const xb=new dt;function rEe(){Er.getLuminanceCoefficients(xb);const e=xb.x.toFixed(4),t=xb.y.toFixed(4),n=xb.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${e}, ${t}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function iEe(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(H0).join(`
`)}function oEe(e){const t=[];for(const n in e){const r=e[n];r!==!1&&t.push("#define "+n+" "+r)}return t.join(`
`)}function sEe(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const a=e.getActiveAttrib(t,i),c=a.name;let s=1;a.type===e.FLOAT_MAT2&&(s=2),a.type===e.FLOAT_MAT3&&(s=3),a.type===e.FLOAT_MAT4&&(s=4),n[c]={type:a.type,location:e.getAttribLocation(t,c),locationSize:s}}return n}function H0(e){return e!==""}function XN(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function ZN(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const aEe=/^[ \t]*#include +<([\w\d./]+)>/gm;function CI(e){return e.replace(aEe,cEe)}const lEe=new Map;function cEe(e,t){let n=ar[t];if(n===void 0){const r=lEe.get(t);if(r!==void 0)n=ar[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,r);else throw new Error("Can not resolve #include <"+t+">")}return CI(n)}const uEe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function YN(e){return e.replace(uEe,hEe)}function hEe(e,t,n,r){let i="";for(let a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function KN(e){let t=`precision ${e.precision} float;
	precision ${e.precision} int;
	precision ${e.precision} sampler2D;
	precision ${e.precision} samplerCube;
	precision ${e.precision} sampler3D;
	precision ${e.precision} sampler2DArray;
	precision ${e.precision} sampler2DShadow;
	precision ${e.precision} samplerCubeShadow;
	precision ${e.precision} sampler2DArrayShadow;
	precision ${e.precision} isampler2D;
	precision ${e.precision} isampler3D;
	precision ${e.precision} isamplerCube;
	precision ${e.precision} isampler2DArray;
	precision ${e.precision} usampler2D;
	precision ${e.precision} usampler3D;
	precision ${e.precision} usamplerCube;
	precision ${e.precision} usampler2DArray;
	`;return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function dEe(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===S9?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===xbe?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===jc&&(t="SHADOWMAP_TYPE_VSM"),t}function fEe(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Eg:case Tg:t="ENVMAP_TYPE_CUBE";break;case iC:t="ENVMAP_TYPE_CUBE_UV";break}return t}function pEe(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Tg:t="ENVMAP_MODE_REFRACTION";break}return t}function mEe(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case M9:t="ENVMAP_BLENDING_MULTIPLY";break;case Bbe:t="ENVMAP_BLENDING_MIX";break;case Ube:t="ENVMAP_BLENDING_ADD";break}return t}function gEe(e){const t=e.envMapCubeUVHeight;if(t===null)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function vEe(e,t,n,r){const i=e.getContext(),a=n.defines;let c=n.vertexShader,s=n.fragmentShader;const f=dEe(n),g=fEe(n),_=pEe(n),x=mEe(n),C=gEe(n),E=iEe(n),A=oEe(a),L=i.createProgram();let I,T,O=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(I=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A].filter(H0).join(`
`),I.length>0&&(I+=`
`),T=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A].filter(H0).join(`
`),T.length>0&&(T+=`
`)):(I=[KN(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+_:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(H0).join(`
`),T=[KN(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,A,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+g:"",n.envMap?"#define "+_:"",n.envMap?"#define "+x:"",C?"#define CUBEUV_TEXEL_WIDTH "+C.texelWidth:"",C?"#define CUBEUV_TEXEL_HEIGHT "+C.texelHeight:"",C?"#define CUBEUV_MAX_MIP "+C.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+f:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ah?"#define TONE_MAPPING":"",n.toneMapping!==Ah?ar.tonemapping_pars_fragment:"",n.toneMapping!==Ah?nEe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",ar.colorspace_pars_fragment,tEe("linearToOutputTexel",n.outputColorSpace),rEe(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(H0).join(`
`)),c=CI(c),c=XN(c,n),c=ZN(c,n),s=CI(s),s=XN(s,n),s=ZN(s,n),c=YN(c),s=YN(s),n.isRawShaderMaterial!==!0&&(O=`#version 300 es
`,I=[E,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+I,T=["#define varying in",n.glslVersion===iN?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===iN?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const D=O+I+c,U=O+T+s,H=GN(i,i.VERTEX_SHADER,D),V=GN(i,i.FRAGMENT_SHADER,U);i.attachShader(L,H),i.attachShader(L,V),n.index0AttributeName!==void 0?i.bindAttribLocation(L,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(L,0,"position"),i.linkProgram(L);function q(re){if(e.debug.checkShaderErrors){const ye=i.getProgramInfoLog(L).trim(),ge=i.getShaderInfoLog(H).trim(),Ve=i.getShaderInfoLog(V).trim();let Ie=!0,ve=!0;if(i.getProgramParameter(L,i.LINK_STATUS)===!1)if(Ie=!1,typeof e.debug.onShaderError=="function")e.debug.onShaderError(i,L,H,V);else{const Se=qN(i,H,"vertex"),Me=qN(i,V,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(L,i.VALIDATE_STATUS)+`

Material Name: `+re.name+`
Material Type: `+re.type+`

Program Info Log: `+ye+`
`+Se+`
`+Me)}else ye!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ye):(ge===""||Ve==="")&&(ve=!1);ve&&(re.diagnostics={runnable:Ie,programLog:ye,vertexShader:{log:ge,prefix:I},fragmentShader:{log:Ve,prefix:T}})}i.deleteShader(H),i.deleteShader(V),Q=new fw(i,L),K=sEe(i,L)}let Q;this.getUniforms=function(){return Q===void 0&&q(this),Q};let K;this.getAttributes=function(){return K===void 0&&q(this),K};let N=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return N===!1&&(N=i.getProgramParameter(L,K2e)),N},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(L),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=J2e++,this.cacheKey=t,this.usedTimes=1,this.program=L,this.vertexShader=H,this.fragmentShader=V,this}let yEe=0;class _Ee{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const n=t.vertexShader,r=t.fragmentShader,i=this._getShaderStage(n),a=this._getShaderStage(r),c=this._getShaderCacheForMaterial(t);return c.has(i)===!1&&(c.add(i),i.usedTimes++),c.has(a)===!1&&(c.add(a),a.usedTimes++),this}remove(t){const n=this.materialCache.get(t);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const n=this.materialCache;let r=n.get(t);return r===void 0&&(r=new Set,n.set(t,r)),r}_getShaderStage(t){const n=this.shaderCache;let r=n.get(t);return r===void 0&&(r=new xEe(t),n.set(t,r)),r}}class xEe{constructor(t){this.id=yEe++,this.code=t,this.usedTimes=0}}function bEe(e,t,n,r,i,a,c){const s=new IL,f=new _Ee,g=new Set,_=[],x=i.logarithmicDepthBuffer,C=i.vertexTextures;let E=i.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function L(K){return g.add(K),K===0?"uv":`uv${K}`}function I(K,N,re,ye,ge){const Ve=ye.fog,Ie=ge.geometry,ve=K.isMeshStandardMaterial?ye.environment:null,Se=(K.isMeshStandardMaterial?n:t).get(K.envMap||ve),Me=Se&&Se.mapping===iC?Se.image.height:null,Be=A[K.type];K.precision!==null&&(E=i.getMaxPrecision(K.precision),E!==K.precision&&console.warn("THREE.WebGLProgram.getParameters:",K.precision,"not supported, using",E,"instead."));const Qe=Ie.morphAttributes.position||Ie.morphAttributes.normal||Ie.morphAttributes.color,st=Qe!==void 0?Qe.length:0;let ct=0;Ie.morphAttributes.position!==void 0&&(ct=1),Ie.morphAttributes.normal!==void 0&&(ct=2),Ie.morphAttributes.color!==void 0&&(ct=3);let Xt,je,lt,Ot;if(Be){const be=oc[Be];Xt=be.vertexShader,je=be.fragmentShader}else Xt=K.vertexShader,je=K.fragmentShader,f.update(K),lt=f.getVertexShaderID(K),Ot=f.getFragmentShaderID(K);const ut=e.getRenderTarget(),ot=e.state.buffers.depth.getReversed(),Tt=ge.isInstancedMesh===!0,Ct=ge.isBatchedMesh===!0,un=!!K.map,gn=!!K.matcap,hn=!!Se,We=!!K.aoMap,vn=!!K.lightMap,Ut=!!K.bumpMap,tn=!!K.normalMap,Dt=!!K.displacementMap,An=!!K.emissiveMap,an=!!K.metalnessMap,Le=!!K.roughnessMap,me=K.anisotropy>0,it=K.clearcoat>0,St=K.dispersion>0,It=K.iridescence>0,wt=K.sheen>0,Zt=K.transmission>0,Lt=me&&!!K.anisotropyMap,kt=it&&!!K.clearcoatMap,bn=it&&!!K.clearcoatNormalMap,zt=it&&!!K.clearcoatRoughnessMap,_e=It&&!!K.iridescenceMap,ee=It&&!!K.iridescenceThicknessMap,ne=wt&&!!K.sheenColorMap,Z=wt&&!!K.sheenRoughnessMap,le=!!K.specularMap,Te=!!K.specularColorMap,$e=!!K.specularIntensityMap,fe=Zt&&!!K.transmissionMap,xe=Zt&&!!K.thicknessMap,Re=!!K.gradientMap,De=!!K.alphaMap,ze=K.alphaTest>0,Je=!!K.alphaHash,Oe=!!K.extensions;let Et=Ah;K.toneMapped&&(ut===null||ut.isXRRenderTarget===!0)&&(Et=e.toneMapping);const Ft={shaderID:Be,shaderType:K.type,shaderName:K.name,vertexShader:Xt,fragmentShader:je,defines:K.defines,customVertexShaderID:lt,customFragmentShaderID:Ot,isRawShaderMaterial:K.isRawShaderMaterial===!0,glslVersion:K.glslVersion,precision:E,batching:Ct,batchingColor:Ct&&ge._colorsTexture!==null,instancing:Tt,instancingColor:Tt&&ge.instanceColor!==null,instancingMorph:Tt&&ge.morphTexture!==null,supportsVertexTextures:C,outputColorSpace:ut===null?e.outputColorSpace:ut.isXRRenderTarget===!0?ut.texture.colorSpace:Of,alphaToCoverage:!!K.alphaToCoverage,map:un,matcap:gn,envMap:hn,envMapMode:hn&&Se.mapping,envMapCubeUVHeight:Me,aoMap:We,lightMap:vn,bumpMap:Ut,normalMap:tn,displacementMap:C&&Dt,emissiveMap:An,normalMapObjectSpace:tn&&K.normalMapType===Kbe,normalMapTangentSpace:tn&&K.normalMapType===Ybe,metalnessMap:an,roughnessMap:Le,anisotropy:me,anisotropyMap:Lt,clearcoat:it,clearcoatMap:kt,clearcoatNormalMap:bn,clearcoatRoughnessMap:zt,dispersion:St,iridescence:It,iridescenceMap:_e,iridescenceThicknessMap:ee,sheen:wt,sheenColorMap:ne,sheenRoughnessMap:Z,specularMap:le,specularColorMap:Te,specularIntensityMap:$e,transmission:Zt,transmissionMap:fe,thicknessMap:xe,gradientMap:Re,opaque:K.transparent===!1&&K.blending===ng&&K.alphaToCoverage===!1,alphaMap:De,alphaTest:ze,alphaHash:Je,combine:K.combine,mapUv:un&&L(K.map.channel),aoMapUv:We&&L(K.aoMap.channel),lightMapUv:vn&&L(K.lightMap.channel),bumpMapUv:Ut&&L(K.bumpMap.channel),normalMapUv:tn&&L(K.normalMap.channel),displacementMapUv:Dt&&L(K.displacementMap.channel),emissiveMapUv:An&&L(K.emissiveMap.channel),metalnessMapUv:an&&L(K.metalnessMap.channel),roughnessMapUv:Le&&L(K.roughnessMap.channel),anisotropyMapUv:Lt&&L(K.anisotropyMap.channel),clearcoatMapUv:kt&&L(K.clearcoatMap.channel),clearcoatNormalMapUv:bn&&L(K.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:zt&&L(K.clearcoatRoughnessMap.channel),iridescenceMapUv:_e&&L(K.iridescenceMap.channel),iridescenceThicknessMapUv:ee&&L(K.iridescenceThicknessMap.channel),sheenColorMapUv:ne&&L(K.sheenColorMap.channel),sheenRoughnessMapUv:Z&&L(K.sheenRoughnessMap.channel),specularMapUv:le&&L(K.specularMap.channel),specularColorMapUv:Te&&L(K.specularColorMap.channel),specularIntensityMapUv:$e&&L(K.specularIntensityMap.channel),transmissionMapUv:fe&&L(K.transmissionMap.channel),thicknessMapUv:xe&&L(K.thicknessMap.channel),alphaMapUv:De&&L(K.alphaMap.channel),vertexTangents:!!Ie.attributes.tangent&&(tn||me),vertexColors:K.vertexColors,vertexAlphas:K.vertexColors===!0&&!!Ie.attributes.color&&Ie.attributes.color.itemSize===4,pointsUvs:ge.isPoints===!0&&!!Ie.attributes.uv&&(un||De),fog:!!Ve,useFog:K.fog===!0,fogExp2:!!Ve&&Ve.isFogExp2,flatShading:K.flatShading===!0,sizeAttenuation:K.sizeAttenuation===!0,logarithmicDepthBuffer:x,reverseDepthBuffer:ot,skinning:ge.isSkinnedMesh===!0,morphTargets:Ie.morphAttributes.position!==void 0,morphNormals:Ie.morphAttributes.normal!==void 0,morphColors:Ie.morphAttributes.color!==void 0,morphTargetsCount:st,morphTextureStride:ct,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numLightProbes:N.numLightProbes,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:K.dithering,shadowMapEnabled:e.shadowMap.enabled&&re.length>0,shadowMapType:e.shadowMap.type,toneMapping:Et,decodeVideoTexture:un&&K.map.isVideoTexture===!0&&Er.getTransfer(K.map.colorSpace)===Wr,decodeVideoTextureEmissive:An&&K.emissiveMap.isVideoTexture===!0&&Er.getTransfer(K.emissiveMap.colorSpace)===Wr,premultipliedAlpha:K.premultipliedAlpha,doubleSided:K.side===qc,flipSided:K.side===Vs,useDepthPacking:K.depthPacking>=0,depthPacking:K.depthPacking||0,index0AttributeName:K.index0AttributeName,extensionClipCullDistance:Oe&&K.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Oe&&K.extensions.multiDraw===!0||Ct)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:K.customProgramCacheKey()};return Ft.vertexUv1s=g.has(1),Ft.vertexUv2s=g.has(2),Ft.vertexUv3s=g.has(3),g.clear(),Ft}function T(K){const N=[];if(K.shaderID?N.push(K.shaderID):(N.push(K.customVertexShaderID),N.push(K.customFragmentShaderID)),K.defines!==void 0)for(const re in K.defines)N.push(re),N.push(K.defines[re]);return K.isRawShaderMaterial===!1&&(O(N,K),D(N,K),N.push(e.outputColorSpace)),N.push(K.customProgramCacheKey),N.join()}function O(K,N){K.push(N.precision),K.push(N.outputColorSpace),K.push(N.envMapMode),K.push(N.envMapCubeUVHeight),K.push(N.mapUv),K.push(N.alphaMapUv),K.push(N.lightMapUv),K.push(N.aoMapUv),K.push(N.bumpMapUv),K.push(N.normalMapUv),K.push(N.displacementMapUv),K.push(N.emissiveMapUv),K.push(N.metalnessMapUv),K.push(N.roughnessMapUv),K.push(N.anisotropyMapUv),K.push(N.clearcoatMapUv),K.push(N.clearcoatNormalMapUv),K.push(N.clearcoatRoughnessMapUv),K.push(N.iridescenceMapUv),K.push(N.iridescenceThicknessMapUv),K.push(N.sheenColorMapUv),K.push(N.sheenRoughnessMapUv),K.push(N.specularMapUv),K.push(N.specularColorMapUv),K.push(N.specularIntensityMapUv),K.push(N.transmissionMapUv),K.push(N.thicknessMapUv),K.push(N.combine),K.push(N.fogExp2),K.push(N.sizeAttenuation),K.push(N.morphTargetsCount),K.push(N.morphAttributeCount),K.push(N.numDirLights),K.push(N.numPointLights),K.push(N.numSpotLights),K.push(N.numSpotLightMaps),K.push(N.numHemiLights),K.push(N.numRectAreaLights),K.push(N.numDirLightShadows),K.push(N.numPointLightShadows),K.push(N.numSpotLightShadows),K.push(N.numSpotLightShadowsWithMaps),K.push(N.numLightProbes),K.push(N.shadowMapType),K.push(N.toneMapping),K.push(N.numClippingPlanes),K.push(N.numClipIntersection),K.push(N.depthPacking)}function D(K,N){s.disableAll(),N.supportsVertexTextures&&s.enable(0),N.instancing&&s.enable(1),N.instancingColor&&s.enable(2),N.instancingMorph&&s.enable(3),N.matcap&&s.enable(4),N.envMap&&s.enable(5),N.normalMapObjectSpace&&s.enable(6),N.normalMapTangentSpace&&s.enable(7),N.clearcoat&&s.enable(8),N.iridescence&&s.enable(9),N.alphaTest&&s.enable(10),N.vertexColors&&s.enable(11),N.vertexAlphas&&s.enable(12),N.vertexUv1s&&s.enable(13),N.vertexUv2s&&s.enable(14),N.vertexUv3s&&s.enable(15),N.vertexTangents&&s.enable(16),N.anisotropy&&s.enable(17),N.alphaHash&&s.enable(18),N.batching&&s.enable(19),N.dispersion&&s.enable(20),N.batchingColor&&s.enable(21),K.push(s.mask),s.disableAll(),N.fog&&s.enable(0),N.useFog&&s.enable(1),N.flatShading&&s.enable(2),N.logarithmicDepthBuffer&&s.enable(3),N.reverseDepthBuffer&&s.enable(4),N.skinning&&s.enable(5),N.morphTargets&&s.enable(6),N.morphNormals&&s.enable(7),N.morphColors&&s.enable(8),N.premultipliedAlpha&&s.enable(9),N.shadowMapEnabled&&s.enable(10),N.doubleSided&&s.enable(11),N.flipSided&&s.enable(12),N.useDepthPacking&&s.enable(13),N.dithering&&s.enable(14),N.transmission&&s.enable(15),N.sheen&&s.enable(16),N.opaque&&s.enable(17),N.pointsUvs&&s.enable(18),N.decodeVideoTexture&&s.enable(19),N.decodeVideoTextureEmissive&&s.enable(20),N.alphaToCoverage&&s.enable(21),K.push(s.mask)}function U(K){const N=A[K.type];let re;if(N){const ye=oc[N];re=jwe.clone(ye.uniforms)}else re=K.uniforms;return re}function H(K,N){let re;for(let ye=0,ge=_.length;ye<ge;ye++){const Ve=_[ye];if(Ve.cacheKey===N){re=Ve,++re.usedTimes;break}}return re===void 0&&(re=new vEe(e,N,K,a),_.push(re)),re}function V(K){if(--K.usedTimes===0){const N=_.indexOf(K);_[N]=_[_.length-1],_.pop(),K.destroy()}}function q(K){f.remove(K)}function Q(){f.dispose()}return{getParameters:I,getProgramCacheKey:T,getUniforms:U,acquireProgram:H,releaseProgram:V,releaseShaderCache:q,programs:_,dispose:Q}}function wEe(){let e=new WeakMap;function t(c){return e.has(c)}function n(c){let s=e.get(c);return s===void 0&&(s={},e.set(c,s)),s}function r(c){e.delete(c)}function i(c,s,f){e.get(c)[s]=f}function a(){e=new WeakMap}return{has:t,get:n,remove:r,update:i,dispose:a}}function SEe(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function JN(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function QN(){const e=[];let t=0;const n=[],r=[],i=[];function a(){t=0,n.length=0,r.length=0,i.length=0}function c(x,C,E,A,L,I){let T=e[t];return T===void 0?(T={id:x.id,object:x,geometry:C,material:E,groupOrder:A,renderOrder:x.renderOrder,z:L,group:I},e[t]=T):(T.id=x.id,T.object=x,T.geometry=C,T.material=E,T.groupOrder=A,T.renderOrder=x.renderOrder,T.z=L,T.group=I),t++,T}function s(x,C,E,A,L,I){const T=c(x,C,E,A,L,I);E.transmission>0?r.push(T):E.transparent===!0?i.push(T):n.push(T)}function f(x,C,E,A,L,I){const T=c(x,C,E,A,L,I);E.transmission>0?r.unshift(T):E.transparent===!0?i.unshift(T):n.unshift(T)}function g(x,C){n.length>1&&n.sort(x||SEe),r.length>1&&r.sort(C||JN),i.length>1&&i.sort(C||JN)}function _(){for(let x=t,C=e.length;x<C;x++){const E=e[x];if(E.id===null)break;E.id=null,E.object=null,E.geometry=null,E.material=null,E.group=null}}return{opaque:n,transmissive:r,transparent:i,init:a,push:s,unshift:f,finish:_,sort:g}}function MEe(){let e=new WeakMap;function t(r,i){const a=e.get(r);let c;return a===void 0?(c=new QN,e.set(r,[c])):i>=a.length?(c=new QN,a.push(c)):c=a[i],c}function n(){e=new WeakMap}return{get:t,dispose:n}}function CEe(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new dt,color:new Nr};break;case"SpotLight":n={position:new dt,direction:new dt,color:new Nr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new dt,color:new Nr,distance:0,decay:0};break;case"HemisphereLight":n={direction:new dt,skyColor:new Nr,groundColor:new Nr};break;case"RectAreaLight":n={color:new Nr,position:new dt,halfWidth:new dt,halfHeight:new dt};break}return e[t.id]=n,n}}}function EEe(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let n;switch(t.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new kr};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new kr};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new kr,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=n,n}}}let TEe=0;function PEe(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function AEe(e){const t=new CEe,n=EEe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let g=0;g<9;g++)r.probe.push(new dt);const i=new dt,a=new Vr,c=new Vr;function s(g){let _=0,x=0,C=0;for(let K=0;K<9;K++)r.probe[K].set(0,0,0);let E=0,A=0,L=0,I=0,T=0,O=0,D=0,U=0,H=0,V=0,q=0;g.sort(PEe);for(let K=0,N=g.length;K<N;K++){const re=g[K],ye=re.color,ge=re.intensity,Ve=re.distance,Ie=re.shadow&&re.shadow.map?re.shadow.map.texture:null;if(re.isAmbientLight)_+=ye.r*ge,x+=ye.g*ge,C+=ye.b*ge;else if(re.isLightProbe){for(let ve=0;ve<9;ve++)r.probe[ve].addScaledVector(re.sh.coefficients[ve],ge);q++}else if(re.isDirectionalLight){const ve=t.get(re);if(ve.color.copy(re.color).multiplyScalar(re.intensity),re.castShadow){const Se=re.shadow,Me=n.get(re);Me.shadowIntensity=Se.intensity,Me.shadowBias=Se.bias,Me.shadowNormalBias=Se.normalBias,Me.shadowRadius=Se.radius,Me.shadowMapSize=Se.mapSize,r.directionalShadow[E]=Me,r.directionalShadowMap[E]=Ie,r.directionalShadowMatrix[E]=re.shadow.matrix,O++}r.directional[E]=ve,E++}else if(re.isSpotLight){const ve=t.get(re);ve.position.setFromMatrixPosition(re.matrixWorld),ve.color.copy(ye).multiplyScalar(ge),ve.distance=Ve,ve.coneCos=Math.cos(re.angle),ve.penumbraCos=Math.cos(re.angle*(1-re.penumbra)),ve.decay=re.decay,r.spot[L]=ve;const Se=re.shadow;if(re.map&&(r.spotLightMap[H]=re.map,H++,Se.updateMatrices(re),re.castShadow&&V++),r.spotLightMatrix[L]=Se.matrix,re.castShadow){const Me=n.get(re);Me.shadowIntensity=Se.intensity,Me.shadowBias=Se.bias,Me.shadowNormalBias=Se.normalBias,Me.shadowRadius=Se.radius,Me.shadowMapSize=Se.mapSize,r.spotShadow[L]=Me,r.spotShadowMap[L]=Ie,U++}L++}else if(re.isRectAreaLight){const ve=t.get(re);ve.color.copy(ye).multiplyScalar(ge),ve.halfWidth.set(re.width*.5,0,0),ve.halfHeight.set(0,re.height*.5,0),r.rectArea[I]=ve,I++}else if(re.isPointLight){const ve=t.get(re);if(ve.color.copy(re.color).multiplyScalar(re.intensity),ve.distance=re.distance,ve.decay=re.decay,re.castShadow){const Se=re.shadow,Me=n.get(re);Me.shadowIntensity=Se.intensity,Me.shadowBias=Se.bias,Me.shadowNormalBias=Se.normalBias,Me.shadowRadius=Se.radius,Me.shadowMapSize=Se.mapSize,Me.shadowCameraNear=Se.camera.near,Me.shadowCameraFar=Se.camera.far,r.pointShadow[A]=Me,r.pointShadowMap[A]=Ie,r.pointShadowMatrix[A]=re.shadow.matrix,D++}r.point[A]=ve,A++}else if(re.isHemisphereLight){const ve=t.get(re);ve.skyColor.copy(re.color).multiplyScalar(ge),ve.groundColor.copy(re.groundColor).multiplyScalar(ge),r.hemi[T]=ve,T++}}I>0&&(e.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Tn.LTC_FLOAT_1,r.rectAreaLTC2=Tn.LTC_FLOAT_2):(r.rectAreaLTC1=Tn.LTC_HALF_1,r.rectAreaLTC2=Tn.LTC_HALF_2)),r.ambient[0]=_,r.ambient[1]=x,r.ambient[2]=C;const Q=r.hash;(Q.directionalLength!==E||Q.pointLength!==A||Q.spotLength!==L||Q.rectAreaLength!==I||Q.hemiLength!==T||Q.numDirectionalShadows!==O||Q.numPointShadows!==D||Q.numSpotShadows!==U||Q.numSpotMaps!==H||Q.numLightProbes!==q)&&(r.directional.length=E,r.spot.length=L,r.rectArea.length=I,r.point.length=A,r.hemi.length=T,r.directionalShadow.length=O,r.directionalShadowMap.length=O,r.pointShadow.length=D,r.pointShadowMap.length=D,r.spotShadow.length=U,r.spotShadowMap.length=U,r.directionalShadowMatrix.length=O,r.pointShadowMatrix.length=D,r.spotLightMatrix.length=U+H-V,r.spotLightMap.length=H,r.numSpotLightShadowsWithMaps=V,r.numLightProbes=q,Q.directionalLength=E,Q.pointLength=A,Q.spotLength=L,Q.rectAreaLength=I,Q.hemiLength=T,Q.numDirectionalShadows=O,Q.numPointShadows=D,Q.numSpotShadows=U,Q.numSpotMaps=H,Q.numLightProbes=q,r.version=TEe++)}function f(g,_){let x=0,C=0,E=0,A=0,L=0;const I=_.matrixWorldInverse;for(let T=0,O=g.length;T<O;T++){const D=g[T];if(D.isDirectionalLight){const U=r.directional[x];U.direction.setFromMatrixPosition(D.matrixWorld),i.setFromMatrixPosition(D.target.matrixWorld),U.direction.sub(i),U.direction.transformDirection(I),x++}else if(D.isSpotLight){const U=r.spot[E];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(I),U.direction.setFromMatrixPosition(D.matrixWorld),i.setFromMatrixPosition(D.target.matrixWorld),U.direction.sub(i),U.direction.transformDirection(I),E++}else if(D.isRectAreaLight){const U=r.rectArea[A];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(I),c.identity(),a.copy(D.matrixWorld),a.premultiply(I),c.extractRotation(a),U.halfWidth.set(D.width*.5,0,0),U.halfHeight.set(0,D.height*.5,0),U.halfWidth.applyMatrix4(c),U.halfHeight.applyMatrix4(c),A++}else if(D.isPointLight){const U=r.point[C];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(I),C++}else if(D.isHemisphereLight){const U=r.hemi[L];U.direction.setFromMatrixPosition(D.matrixWorld),U.direction.transformDirection(I),L++}}}return{setup:s,setupView:f,state:r}}function eB(e){const t=new AEe(e),n=[],r=[];function i(_){g.camera=_,n.length=0,r.length=0}function a(_){n.push(_)}function c(_){r.push(_)}function s(){t.setup(n)}function f(_){t.setupView(n,_)}const g={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:i,state:g,setupLights:s,setupLightsView:f,pushLight:a,pushShadow:c}}function IEe(e){let t=new WeakMap;function n(i,a=0){const c=t.get(i);let s;return c===void 0?(s=new eB(e),t.set(i,[s])):a>=c.length?(s=new eB(e),c.push(s)):s=c[a],s}function r(){t=new WeakMap}return{get:n,dispose:r}}const REe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,LEe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function kEe(e,t,n){let r=new RL;const i=new kr,a=new kr,c=new Oi,s=new nSe({depthPacking:Zbe}),f=new rSe,g={},_=n.maxTextureSize,x={[jh]:Vs,[Vs]:jh,[qc]:qc},C=new hu({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new kr},radius:{value:4}},vertexShader:REe,fragmentShader:LEe}),E=C.clone();E.defines.HORIZONTAL_PASS=1;const A=new bc;A.setAttribute("position",new mc(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new Os(A,C),I=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=S9;let T=this.type;this.render=function(V,q,Q){if(I.enabled===!1||I.autoUpdate===!1&&I.needsUpdate===!1||V.length===0)return;const K=e.getRenderTarget(),N=e.getActiveCubeFace(),re=e.getActiveMipmapLevel(),ye=e.state;ye.setBlending(Ph),ye.buffers.color.setClear(1,1,1,1),ye.buffers.depth.setTest(!0),ye.setScissorTest(!1);const ge=T!==jc&&this.type===jc,Ve=T===jc&&this.type!==jc;for(let Ie=0,ve=V.length;Ie<ve;Ie++){const Se=V[Ie],Me=Se.shadow;if(Me===void 0){console.warn("THREE.WebGLShadowMap:",Se,"has no shadow.");continue}if(Me.autoUpdate===!1&&Me.needsUpdate===!1)continue;i.copy(Me.mapSize);const Be=Me.getFrameExtents();if(i.multiply(Be),a.copy(Me.mapSize),(i.x>_||i.y>_)&&(i.x>_&&(a.x=Math.floor(_/Be.x),i.x=a.x*Be.x,Me.mapSize.x=a.x),i.y>_&&(a.y=Math.floor(_/Be.y),i.y=a.y*Be.y,Me.mapSize.y=a.y)),Me.map===null||ge===!0||Ve===!0){const st=this.type!==jc?{minFilter:Il,magFilter:Il}:{};Me.map!==null&&Me.map.dispose(),Me.map=new Hh(i.x,i.y,st),Me.map.texture.name=Se.name+".shadowMap",Me.camera.updateProjectionMatrix()}e.setRenderTarget(Me.map),e.clear();const Qe=Me.getViewportCount();for(let st=0;st<Qe;st++){const ct=Me.getViewport(st);c.set(a.x*ct.x,a.y*ct.y,a.x*ct.z,a.y*ct.w),ye.viewport(c),Me.updateMatrices(Se,st),r=Me.getFrustum(),U(q,Q,Me.camera,Se,this.type)}Me.isPointLightShadow!==!0&&this.type===jc&&O(Me,Q),Me.needsUpdate=!1}T=this.type,I.needsUpdate=!1,e.setRenderTarget(K,N,re)};function O(V,q){const Q=t.update(L);C.defines.VSM_SAMPLES!==V.blurSamples&&(C.defines.VSM_SAMPLES=V.blurSamples,E.defines.VSM_SAMPLES=V.blurSamples,C.needsUpdate=!0,E.needsUpdate=!0),V.mapPass===null&&(V.mapPass=new Hh(i.x,i.y)),C.uniforms.shadow_pass.value=V.map.texture,C.uniforms.resolution.value=V.mapSize,C.uniforms.radius.value=V.radius,e.setRenderTarget(V.mapPass),e.clear(),e.renderBufferDirect(q,null,Q,C,L,null),E.uniforms.shadow_pass.value=V.mapPass.texture,E.uniforms.resolution.value=V.mapSize,E.uniforms.radius.value=V.radius,e.setRenderTarget(V.map),e.clear(),e.renderBufferDirect(q,null,Q,E,L,null)}function D(V,q,Q,K){let N=null;const re=Q.isPointLight===!0?V.customDistanceMaterial:V.customDepthMaterial;if(re!==void 0)N=re;else if(N=Q.isPointLight===!0?f:s,e.localClippingEnabled&&q.clipShadows===!0&&Array.isArray(q.clippingPlanes)&&q.clippingPlanes.length!==0||q.displacementMap&&q.displacementScale!==0||q.alphaMap&&q.alphaTest>0||q.map&&q.alphaTest>0){const ye=N.uuid,ge=q.uuid;let Ve=g[ye];Ve===void 0&&(Ve={},g[ye]=Ve);let Ie=Ve[ge];Ie===void 0&&(Ie=N.clone(),Ve[ge]=Ie,q.addEventListener("dispose",H)),N=Ie}if(N.visible=q.visible,N.wireframe=q.wireframe,K===jc?N.side=q.shadowSide!==null?q.shadowSide:q.side:N.side=q.shadowSide!==null?q.shadowSide:x[q.side],N.alphaMap=q.alphaMap,N.alphaTest=q.alphaTest,N.map=q.map,N.clipShadows=q.clipShadows,N.clippingPlanes=q.clippingPlanes,N.clipIntersection=q.clipIntersection,N.displacementMap=q.displacementMap,N.displacementScale=q.displacementScale,N.displacementBias=q.displacementBias,N.wireframeLinewidth=q.wireframeLinewidth,N.linewidth=q.linewidth,Q.isPointLight===!0&&N.isMeshDistanceMaterial===!0){const ye=e.properties.get(N);ye.light=Q}return N}function U(V,q,Q,K,N){if(V.visible===!1)return;if(V.layers.test(q.layers)&&(V.isMesh||V.isLine||V.isPoints)&&(V.castShadow||V.receiveShadow&&N===jc)&&(!V.frustumCulled||r.intersectsObject(V))){V.modelViewMatrix.multiplyMatrices(Q.matrixWorldInverse,V.matrixWorld);const ge=t.update(V),Ve=V.material;if(Array.isArray(Ve)){const Ie=ge.groups;for(let ve=0,Se=Ie.length;ve<Se;ve++){const Me=Ie[ve],Be=Ve[Me.materialIndex];if(Be&&Be.visible){const Qe=D(V,Be,K,N);V.onBeforeShadow(e,V,q,Q,ge,Qe,Me),e.renderBufferDirect(Q,null,ge,Qe,V,Me),V.onAfterShadow(e,V,q,Q,ge,Qe,Me)}}}else if(Ve.visible){const Ie=D(V,Ve,K,N);V.onBeforeShadow(e,V,q,Q,ge,Ie,null),e.renderBufferDirect(Q,null,ge,Ie,V,null),V.onAfterShadow(e,V,q,Q,ge,Ie,null)}}const ye=V.children;for(let ge=0,Ve=ye.length;ge<Ve;ge++)U(ye[ge],q,Q,K,N)}function H(V){V.target.removeEventListener("dispose",H);for(const Q in g){const K=g[Q],N=V.target.uuid;N in K&&(K[N].dispose(),delete K[N])}}}const DEe={[UA]:$A,[VA]:GA,[jA]:WA,[Cg]:HA,[$A]:UA,[GA]:VA,[WA]:jA,[HA]:Cg};function zEe(e,t){function n(){let fe=!1;const xe=new Oi;let Re=null;const De=new Oi(0,0,0,0);return{setMask:function(ze){Re!==ze&&!fe&&(e.colorMask(ze,ze,ze,ze),Re=ze)},setLocked:function(ze){fe=ze},setClear:function(ze,Je,Oe,Et,Ft){Ft===!0&&(ze*=Et,Je*=Et,Oe*=Et),xe.set(ze,Je,Oe,Et),De.equals(xe)===!1&&(e.clearColor(ze,Je,Oe,Et),De.copy(xe))},reset:function(){fe=!1,Re=null,De.set(-1,0,0,0)}}}function r(){let fe=!1,xe=!1,Re=null,De=null,ze=null;return{setReversed:function(Je){if(xe!==Je){const Oe=t.get("EXT_clip_control");Je?Oe.clipControlEXT(Oe.LOWER_LEFT_EXT,Oe.ZERO_TO_ONE_EXT):Oe.clipControlEXT(Oe.LOWER_LEFT_EXT,Oe.NEGATIVE_ONE_TO_ONE_EXT),xe=Je;const Et=ze;ze=null,this.setClear(Et)}},getReversed:function(){return xe},setTest:function(Je){Je?ut(e.DEPTH_TEST):ot(e.DEPTH_TEST)},setMask:function(Je){Re!==Je&&!fe&&(e.depthMask(Je),Re=Je)},setFunc:function(Je){if(xe&&(Je=DEe[Je]),De!==Je){switch(Je){case UA:e.depthFunc(e.NEVER);break;case $A:e.depthFunc(e.ALWAYS);break;case VA:e.depthFunc(e.LESS);break;case Cg:e.depthFunc(e.LEQUAL);break;case jA:e.depthFunc(e.EQUAL);break;case HA:e.depthFunc(e.GEQUAL);break;case GA:e.depthFunc(e.GREATER);break;case WA:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}De=Je}},setLocked:function(Je){fe=Je},setClear:function(Je){ze!==Je&&(xe&&(Je=1-Je),e.clearDepth(Je),ze=Je)},reset:function(){fe=!1,Re=null,De=null,ze=null,xe=!1}}}function i(){let fe=!1,xe=null,Re=null,De=null,ze=null,Je=null,Oe=null,Et=null,Ft=null;return{setTest:function(be){fe||(be?ut(e.STENCIL_TEST):ot(e.STENCIL_TEST))},setMask:function(be){xe!==be&&!fe&&(e.stencilMask(be),xe=be)},setFunc:function(be,qe,tt){(Re!==be||De!==qe||ze!==tt)&&(e.stencilFunc(be,qe,tt),Re=be,De=qe,ze=tt)},setOp:function(be,qe,tt){(Je!==be||Oe!==qe||Et!==tt)&&(e.stencilOp(be,qe,tt),Je=be,Oe=qe,Et=tt)},setLocked:function(be){fe=be},setClear:function(be){Ft!==be&&(e.clearStencil(be),Ft=be)},reset:function(){fe=!1,xe=null,Re=null,De=null,ze=null,Je=null,Oe=null,Et=null,Ft=null}}}const a=new n,c=new r,s=new i,f=new WeakMap,g=new WeakMap;let _={},x={},C=new WeakMap,E=[],A=null,L=!1,I=null,T=null,O=null,D=null,U=null,H=null,V=null,q=new Nr(0,0,0),Q=0,K=!1,N=null,re=null,ye=null,ge=null,Ve=null;const Ie=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ve=!1,Se=0;const Me=e.getParameter(e.VERSION);Me.indexOf("WebGL")!==-1?(Se=parseFloat(/^WebGL (\d)/.exec(Me)[1]),ve=Se>=1):Me.indexOf("OpenGL ES")!==-1&&(Se=parseFloat(/^OpenGL ES (\d)/.exec(Me)[1]),ve=Se>=2);let Be=null,Qe={};const st=e.getParameter(e.SCISSOR_BOX),ct=e.getParameter(e.VIEWPORT),Xt=new Oi().fromArray(st),je=new Oi().fromArray(ct);function lt(fe,xe,Re,De){const ze=new Uint8Array(4),Je=e.createTexture();e.bindTexture(fe,Je),e.texParameteri(fe,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(fe,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let Oe=0;Oe<Re;Oe++)fe===e.TEXTURE_3D||fe===e.TEXTURE_2D_ARRAY?e.texImage3D(xe,0,e.RGBA,1,1,De,0,e.RGBA,e.UNSIGNED_BYTE,ze):e.texImage2D(xe+Oe,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,ze);return Je}const Ot={};Ot[e.TEXTURE_2D]=lt(e.TEXTURE_2D,e.TEXTURE_2D,1),Ot[e.TEXTURE_CUBE_MAP]=lt(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ot[e.TEXTURE_2D_ARRAY]=lt(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),Ot[e.TEXTURE_3D]=lt(e.TEXTURE_3D,e.TEXTURE_3D,1,1),a.setClear(0,0,0,1),c.setClear(1),s.setClear(0),ut(e.DEPTH_TEST),c.setFunc(Cg),Ut(!1),tn(JF),ut(e.CULL_FACE),We(Ph);function ut(fe){_[fe]!==!0&&(e.enable(fe),_[fe]=!0)}function ot(fe){_[fe]!==!1&&(e.disable(fe),_[fe]=!1)}function Tt(fe,xe){return x[fe]!==xe?(e.bindFramebuffer(fe,xe),x[fe]=xe,fe===e.DRAW_FRAMEBUFFER&&(x[e.FRAMEBUFFER]=xe),fe===e.FRAMEBUFFER&&(x[e.DRAW_FRAMEBUFFER]=xe),!0):!1}function Ct(fe,xe){let Re=E,De=!1;if(fe){Re=C.get(xe),Re===void 0&&(Re=[],C.set(xe,Re));const ze=fe.textures;if(Re.length!==ze.length||Re[0]!==e.COLOR_ATTACHMENT0){for(let Je=0,Oe=ze.length;Je<Oe;Je++)Re[Je]=e.COLOR_ATTACHMENT0+Je;Re.length=ze.length,De=!0}}else Re[0]!==e.BACK&&(Re[0]=e.BACK,De=!0);De&&e.drawBuffers(Re)}function un(fe){return A!==fe?(e.useProgram(fe),A=fe,!0):!1}const gn={[af]:e.FUNC_ADD,[wbe]:e.FUNC_SUBTRACT,[Sbe]:e.FUNC_REVERSE_SUBTRACT};gn[Mbe]=e.MIN,gn[Cbe]=e.MAX;const hn={[Ebe]:e.ZERO,[Tbe]:e.ONE,[Pbe]:e.SRC_COLOR,[NA]:e.SRC_ALPHA,[Dbe]:e.SRC_ALPHA_SATURATE,[Lbe]:e.DST_COLOR,[Ibe]:e.DST_ALPHA,[Abe]:e.ONE_MINUS_SRC_COLOR,[BA]:e.ONE_MINUS_SRC_ALPHA,[kbe]:e.ONE_MINUS_DST_COLOR,[Rbe]:e.ONE_MINUS_DST_ALPHA,[zbe]:e.CONSTANT_COLOR,[Obe]:e.ONE_MINUS_CONSTANT_COLOR,[Fbe]:e.CONSTANT_ALPHA,[Nbe]:e.ONE_MINUS_CONSTANT_ALPHA};function We(fe,xe,Re,De,ze,Je,Oe,Et,Ft,be){if(fe===Ph){L===!0&&(ot(e.BLEND),L=!1);return}if(L===!1&&(ut(e.BLEND),L=!0),fe!==bbe){if(fe!==I||be!==K){if((T!==af||U!==af)&&(e.blendEquation(e.FUNC_ADD),T=af,U=af),be)switch(fe){case ng:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case QF:e.blendFunc(e.ONE,e.ONE);break;case eN:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case tN:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}else switch(fe){case ng:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case QF:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case eN:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case tN:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",fe);break}O=null,D=null,H=null,V=null,q.set(0,0,0),Q=0,I=fe,K=be}return}ze=ze||xe,Je=Je||Re,Oe=Oe||De,(xe!==T||ze!==U)&&(e.blendEquationSeparate(gn[xe],gn[ze]),T=xe,U=ze),(Re!==O||De!==D||Je!==H||Oe!==V)&&(e.blendFuncSeparate(hn[Re],hn[De],hn[Je],hn[Oe]),O=Re,D=De,H=Je,V=Oe),(Et.equals(q)===!1||Ft!==Q)&&(e.blendColor(Et.r,Et.g,Et.b,Ft),q.copy(Et),Q=Ft),I=fe,K=!1}function vn(fe,xe){fe.side===qc?ot(e.CULL_FACE):ut(e.CULL_FACE);let Re=fe.side===Vs;xe&&(Re=!Re),Ut(Re),fe.blending===ng&&fe.transparent===!1?We(Ph):We(fe.blending,fe.blendEquation,fe.blendSrc,fe.blendDst,fe.blendEquationAlpha,fe.blendSrcAlpha,fe.blendDstAlpha,fe.blendColor,fe.blendAlpha,fe.premultipliedAlpha),c.setFunc(fe.depthFunc),c.setTest(fe.depthTest),c.setMask(fe.depthWrite),a.setMask(fe.colorWrite);const De=fe.stencilWrite;s.setTest(De),De&&(s.setMask(fe.stencilWriteMask),s.setFunc(fe.stencilFunc,fe.stencilRef,fe.stencilFuncMask),s.setOp(fe.stencilFail,fe.stencilZFail,fe.stencilZPass)),An(fe.polygonOffset,fe.polygonOffsetFactor,fe.polygonOffsetUnits),fe.alphaToCoverage===!0?ut(e.SAMPLE_ALPHA_TO_COVERAGE):ot(e.SAMPLE_ALPHA_TO_COVERAGE)}function Ut(fe){N!==fe&&(fe?e.frontFace(e.CW):e.frontFace(e.CCW),N=fe)}function tn(fe){fe!==ybe?(ut(e.CULL_FACE),fe!==re&&(fe===JF?e.cullFace(e.BACK):fe===_be?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):ot(e.CULL_FACE),re=fe}function Dt(fe){fe!==ye&&(ve&&e.lineWidth(fe),ye=fe)}function An(fe,xe,Re){fe?(ut(e.POLYGON_OFFSET_FILL),(ge!==xe||Ve!==Re)&&(e.polygonOffset(xe,Re),ge=xe,Ve=Re)):ot(e.POLYGON_OFFSET_FILL)}function an(fe){fe?ut(e.SCISSOR_TEST):ot(e.SCISSOR_TEST)}function Le(fe){fe===void 0&&(fe=e.TEXTURE0+Ie-1),Be!==fe&&(e.activeTexture(fe),Be=fe)}function me(fe,xe,Re){Re===void 0&&(Be===null?Re=e.TEXTURE0+Ie-1:Re=Be);let De=Qe[Re];De===void 0&&(De={type:void 0,texture:void 0},Qe[Re]=De),(De.type!==fe||De.texture!==xe)&&(Be!==Re&&(e.activeTexture(Re),Be=Re),e.bindTexture(fe,xe||Ot[fe]),De.type=fe,De.texture=xe)}function it(){const fe=Qe[Be];fe!==void 0&&fe.type!==void 0&&(e.bindTexture(fe.type,null),fe.type=void 0,fe.texture=void 0)}function St(){try{e.compressedTexImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function It(){try{e.compressedTexImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function wt(){try{e.texSubImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Zt(){try{e.texSubImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function Lt(){try{e.compressedTexSubImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function kt(){try{e.compressedTexSubImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function bn(){try{e.texStorage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function zt(){try{e.texStorage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function _e(){try{e.texImage2D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function ee(){try{e.texImage3D(...arguments)}catch(fe){console.error("THREE.WebGLState:",fe)}}function ne(fe){Xt.equals(fe)===!1&&(e.scissor(fe.x,fe.y,fe.z,fe.w),Xt.copy(fe))}function Z(fe){je.equals(fe)===!1&&(e.viewport(fe.x,fe.y,fe.z,fe.w),je.copy(fe))}function le(fe,xe){let Re=g.get(xe);Re===void 0&&(Re=new WeakMap,g.set(xe,Re));let De=Re.get(fe);De===void 0&&(De=e.getUniformBlockIndex(xe,fe.name),Re.set(fe,De))}function Te(fe,xe){const De=g.get(xe).get(fe);f.get(xe)!==De&&(e.uniformBlockBinding(xe,De,fe.__bindingPointIndex),f.set(xe,De))}function $e(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),c.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),_={},Be=null,Qe={},x={},C=new WeakMap,E=[],A=null,L=!1,I=null,T=null,O=null,D=null,U=null,H=null,V=null,q=new Nr(0,0,0),Q=0,K=!1,N=null,re=null,ye=null,ge=null,Ve=null,Xt.set(0,0,e.canvas.width,e.canvas.height),je.set(0,0,e.canvas.width,e.canvas.height),a.reset(),c.reset(),s.reset()}return{buffers:{color:a,depth:c,stencil:s},enable:ut,disable:ot,bindFramebuffer:Tt,drawBuffers:Ct,useProgram:un,setBlending:We,setMaterial:vn,setFlipSided:Ut,setCullFace:tn,setLineWidth:Dt,setPolygonOffset:An,setScissorTest:an,activeTexture:Le,bindTexture:me,unbindTexture:it,compressedTexImage2D:St,compressedTexImage3D:It,texImage2D:_e,texImage3D:ee,updateUBOMapping:le,uniformBlockBinding:Te,texStorage2D:bn,texStorage3D:zt,texSubImage2D:wt,texSubImage3D:Zt,compressedTexSubImage2D:Lt,compressedTexSubImage3D:kt,scissor:ne,viewport:Z,reset:$e}}function OEe(e,t,n,r,i,a,c){const s=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),g=new kr,_=new WeakMap;let x;const C=new WeakMap;let E=!1;try{E=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function A(Le,me){return E?new OffscreenCanvas(Le,me):gS("canvas")}function L(Le,me,it){let St=1;const It=an(Le);if((It.width>it||It.height>it)&&(St=it/Math.max(It.width,It.height)),St<1)if(typeof HTMLImageElement<"u"&&Le instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Le instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Le instanceof ImageBitmap||typeof VideoFrame<"u"&&Le instanceof VideoFrame){const wt=Math.floor(St*It.width),Zt=Math.floor(St*It.height);x===void 0&&(x=A(wt,Zt));const Lt=me?A(wt,Zt):x;return Lt.width=wt,Lt.height=Zt,Lt.getContext("2d").drawImage(Le,0,0,wt,Zt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+It.width+"x"+It.height+") to ("+wt+"x"+Zt+")."),Lt}else return"data"in Le&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+It.width+"x"+It.height+")."),Le;return Le}function I(Le){return Le.generateMipmaps}function T(Le){e.generateMipmap(Le)}function O(Le){return Le.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:Le.isWebGL3DRenderTarget?e.TEXTURE_3D:Le.isWebGLArrayRenderTarget||Le.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function D(Le,me,it,St,It=!1){if(Le!==null){if(e[Le]!==void 0)return e[Le];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Le+"'")}let wt=me;if(me===e.RED&&(it===e.FLOAT&&(wt=e.R32F),it===e.HALF_FLOAT&&(wt=e.R16F),it===e.UNSIGNED_BYTE&&(wt=e.R8)),me===e.RED_INTEGER&&(it===e.UNSIGNED_BYTE&&(wt=e.R8UI),it===e.UNSIGNED_SHORT&&(wt=e.R16UI),it===e.UNSIGNED_INT&&(wt=e.R32UI),it===e.BYTE&&(wt=e.R8I),it===e.SHORT&&(wt=e.R16I),it===e.INT&&(wt=e.R32I)),me===e.RG&&(it===e.FLOAT&&(wt=e.RG32F),it===e.HALF_FLOAT&&(wt=e.RG16F),it===e.UNSIGNED_BYTE&&(wt=e.RG8)),me===e.RG_INTEGER&&(it===e.UNSIGNED_BYTE&&(wt=e.RG8UI),it===e.UNSIGNED_SHORT&&(wt=e.RG16UI),it===e.UNSIGNED_INT&&(wt=e.RG32UI),it===e.BYTE&&(wt=e.RG8I),it===e.SHORT&&(wt=e.RG16I),it===e.INT&&(wt=e.RG32I)),me===e.RGB_INTEGER&&(it===e.UNSIGNED_BYTE&&(wt=e.RGB8UI),it===e.UNSIGNED_SHORT&&(wt=e.RGB16UI),it===e.UNSIGNED_INT&&(wt=e.RGB32UI),it===e.BYTE&&(wt=e.RGB8I),it===e.SHORT&&(wt=e.RGB16I),it===e.INT&&(wt=e.RGB32I)),me===e.RGBA_INTEGER&&(it===e.UNSIGNED_BYTE&&(wt=e.RGBA8UI),it===e.UNSIGNED_SHORT&&(wt=e.RGBA16UI),it===e.UNSIGNED_INT&&(wt=e.RGBA32UI),it===e.BYTE&&(wt=e.RGBA8I),it===e.SHORT&&(wt=e.RGBA16I),it===e.INT&&(wt=e.RGBA32I)),me===e.RGB&&it===e.UNSIGNED_INT_5_9_9_9_REV&&(wt=e.RGB9_E5),me===e.RGBA){const Zt=It?pS:Er.getTransfer(St);it===e.FLOAT&&(wt=e.RGBA32F),it===e.HALF_FLOAT&&(wt=e.RGBA16F),it===e.UNSIGNED_BYTE&&(wt=Zt===Wr?e.SRGB8_ALPHA8:e.RGBA8),it===e.UNSIGNED_SHORT_4_4_4_4&&(wt=e.RGBA4),it===e.UNSIGNED_SHORT_5_5_5_1&&(wt=e.RGB5_A1)}return(wt===e.R16F||wt===e.R32F||wt===e.RG16F||wt===e.RG32F||wt===e.RGBA16F||wt===e.RGBA32F)&&t.get("EXT_color_buffer_float"),wt}function U(Le,me){let it;return Le?me===null||me===zf||me===u_?it=e.DEPTH24_STENCIL8:me===Yc?it=e.DEPTH32F_STENCIL8:me===c_&&(it=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):me===null||me===zf||me===u_?it=e.DEPTH_COMPONENT24:me===Yc?it=e.DEPTH_COMPONENT32F:me===c_&&(it=e.DEPTH_COMPONENT16),it}function H(Le,me){return I(Le)===!0||Le.isFramebufferTexture&&Le.minFilter!==Il&&Le.minFilter!==va?Math.log2(Math.max(me.width,me.height))+1:Le.mipmaps!==void 0&&Le.mipmaps.length>0?Le.mipmaps.length:Le.isCompressedTexture&&Array.isArray(Le.image)?me.mipmaps.length:1}function V(Le){const me=Le.target;me.removeEventListener("dispose",V),Q(me),me.isVideoTexture&&_.delete(me)}function q(Le){const me=Le.target;me.removeEventListener("dispose",q),N(me)}function Q(Le){const me=r.get(Le);if(me.__webglInit===void 0)return;const it=Le.source,St=C.get(it);if(St){const It=St[me.__cacheKey];It.usedTimes--,It.usedTimes===0&&K(Le),Object.keys(St).length===0&&C.delete(it)}r.remove(Le)}function K(Le){const me=r.get(Le);e.deleteTexture(me.__webglTexture);const it=Le.source,St=C.get(it);delete St[me.__cacheKey],c.memory.textures--}function N(Le){const me=r.get(Le);if(Le.depthTexture&&(Le.depthTexture.dispose(),r.remove(Le.depthTexture)),Le.isWebGLCubeRenderTarget)for(let St=0;St<6;St++){if(Array.isArray(me.__webglFramebuffer[St]))for(let It=0;It<me.__webglFramebuffer[St].length;It++)e.deleteFramebuffer(me.__webglFramebuffer[St][It]);else e.deleteFramebuffer(me.__webglFramebuffer[St]);me.__webglDepthbuffer&&e.deleteRenderbuffer(me.__webglDepthbuffer[St])}else{if(Array.isArray(me.__webglFramebuffer))for(let St=0;St<me.__webglFramebuffer.length;St++)e.deleteFramebuffer(me.__webglFramebuffer[St]);else e.deleteFramebuffer(me.__webglFramebuffer);if(me.__webglDepthbuffer&&e.deleteRenderbuffer(me.__webglDepthbuffer),me.__webglMultisampledFramebuffer&&e.deleteFramebuffer(me.__webglMultisampledFramebuffer),me.__webglColorRenderbuffer)for(let St=0;St<me.__webglColorRenderbuffer.length;St++)me.__webglColorRenderbuffer[St]&&e.deleteRenderbuffer(me.__webglColorRenderbuffer[St]);me.__webglDepthRenderbuffer&&e.deleteRenderbuffer(me.__webglDepthRenderbuffer)}const it=Le.textures;for(let St=0,It=it.length;St<It;St++){const wt=r.get(it[St]);wt.__webglTexture&&(e.deleteTexture(wt.__webglTexture),c.memory.textures--),r.remove(it[St])}r.remove(Le)}let re=0;function ye(){re=0}function ge(){const Le=re;return Le>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Le+" texture units while this GPU supports only "+i.maxTextures),re+=1,Le}function Ve(Le){const me=[];return me.push(Le.wrapS),me.push(Le.wrapT),me.push(Le.wrapR||0),me.push(Le.magFilter),me.push(Le.minFilter),me.push(Le.anisotropy),me.push(Le.internalFormat),me.push(Le.format),me.push(Le.type),me.push(Le.generateMipmaps),me.push(Le.premultiplyAlpha),me.push(Le.flipY),me.push(Le.unpackAlignment),me.push(Le.colorSpace),me.join()}function Ie(Le,me){const it=r.get(Le);if(Le.isVideoTexture&&Dt(Le),Le.isRenderTargetTexture===!1&&Le.version>0&&it.__version!==Le.version){const St=Le.image;if(St===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(St.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{je(it,Le,me);return}}n.bindTexture(e.TEXTURE_2D,it.__webglTexture,e.TEXTURE0+me)}function ve(Le,me){const it=r.get(Le);if(Le.version>0&&it.__version!==Le.version){je(it,Le,me);return}n.bindTexture(e.TEXTURE_2D_ARRAY,it.__webglTexture,e.TEXTURE0+me)}function Se(Le,me){const it=r.get(Le);if(Le.version>0&&it.__version!==Le.version){je(it,Le,me);return}n.bindTexture(e.TEXTURE_3D,it.__webglTexture,e.TEXTURE0+me)}function Me(Le,me){const it=r.get(Le);if(Le.version>0&&it.__version!==Le.version){lt(it,Le,me);return}n.bindTexture(e.TEXTURE_CUBE_MAP,it.__webglTexture,e.TEXTURE0+me)}const Be={[ZA]:e.REPEAT,[mf]:e.CLAMP_TO_EDGE,[YA]:e.MIRRORED_REPEAT},Qe={[Il]:e.NEAREST,[qbe]:e.NEAREST_MIPMAP_NEAREST,[J1]:e.NEAREST_MIPMAP_LINEAR,[va]:e.LINEAR,[PT]:e.LINEAR_MIPMAP_NEAREST,[vh]:e.LINEAR_MIPMAP_LINEAR},st={[Jbe]:e.NEVER,[iwe]:e.ALWAYS,[Qbe]:e.LESS,[F9]:e.LEQUAL,[ewe]:e.EQUAL,[rwe]:e.GEQUAL,[twe]:e.GREATER,[nwe]:e.NOTEQUAL};function ct(Le,me){if(me.type===Yc&&t.has("OES_texture_float_linear")===!1&&(me.magFilter===va||me.magFilter===PT||me.magFilter===J1||me.magFilter===vh||me.minFilter===va||me.minFilter===PT||me.minFilter===J1||me.minFilter===vh)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(Le,e.TEXTURE_WRAP_S,Be[me.wrapS]),e.texParameteri(Le,e.TEXTURE_WRAP_T,Be[me.wrapT]),(Le===e.TEXTURE_3D||Le===e.TEXTURE_2D_ARRAY)&&e.texParameteri(Le,e.TEXTURE_WRAP_R,Be[me.wrapR]),e.texParameteri(Le,e.TEXTURE_MAG_FILTER,Qe[me.magFilter]),e.texParameteri(Le,e.TEXTURE_MIN_FILTER,Qe[me.minFilter]),me.compareFunction&&(e.texParameteri(Le,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(Le,e.TEXTURE_COMPARE_FUNC,st[me.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){if(me.magFilter===Il||me.minFilter!==J1&&me.minFilter!==vh||me.type===Yc&&t.has("OES_texture_float_linear")===!1)return;if(me.anisotropy>1||r.get(me).__currentAnisotropy){const it=t.get("EXT_texture_filter_anisotropic");e.texParameterf(Le,it.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(me.anisotropy,i.getMaxAnisotropy())),r.get(me).__currentAnisotropy=me.anisotropy}}}function Xt(Le,me){let it=!1;Le.__webglInit===void 0&&(Le.__webglInit=!0,me.addEventListener("dispose",V));const St=me.source;let It=C.get(St);It===void 0&&(It={},C.set(St,It));const wt=Ve(me);if(wt!==Le.__cacheKey){It[wt]===void 0&&(It[wt]={texture:e.createTexture(),usedTimes:0},c.memory.textures++,it=!0),It[wt].usedTimes++;const Zt=It[Le.__cacheKey];Zt!==void 0&&(It[Le.__cacheKey].usedTimes--,Zt.usedTimes===0&&K(me)),Le.__cacheKey=wt,Le.__webglTexture=It[wt].texture}return it}function je(Le,me,it){let St=e.TEXTURE_2D;(me.isDataArrayTexture||me.isCompressedArrayTexture)&&(St=e.TEXTURE_2D_ARRAY),me.isData3DTexture&&(St=e.TEXTURE_3D);const It=Xt(Le,me),wt=me.source;n.bindTexture(St,Le.__webglTexture,e.TEXTURE0+it);const Zt=r.get(wt);if(wt.version!==Zt.__version||It===!0){n.activeTexture(e.TEXTURE0+it);const Lt=Er.getPrimaries(Er.workingColorSpace),kt=me.colorSpace===fh?null:Er.getPrimaries(me.colorSpace),bn=me.colorSpace===fh||Lt===kt?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,me.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,me.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,bn);let zt=L(me.image,!1,i.maxTextureSize);zt=An(me,zt);const _e=a.convert(me.format,me.colorSpace),ee=a.convert(me.type);let ne=D(me.internalFormat,_e,ee,me.colorSpace,me.isVideoTexture);ct(St,me);let Z;const le=me.mipmaps,Te=me.isVideoTexture!==!0,$e=Zt.__version===void 0||It===!0,fe=wt.dataReady,xe=H(me,zt);if(me.isDepthTexture)ne=U(me.format===d_,me.type),$e&&(Te?n.texStorage2D(e.TEXTURE_2D,1,ne,zt.width,zt.height):n.texImage2D(e.TEXTURE_2D,0,ne,zt.width,zt.height,0,_e,ee,null));else if(me.isDataTexture)if(le.length>0){Te&&$e&&n.texStorage2D(e.TEXTURE_2D,xe,ne,le[0].width,le[0].height);for(let Re=0,De=le.length;Re<De;Re++)Z=le[Re],Te?fe&&n.texSubImage2D(e.TEXTURE_2D,Re,0,0,Z.width,Z.height,_e,ee,Z.data):n.texImage2D(e.TEXTURE_2D,Re,ne,Z.width,Z.height,0,_e,ee,Z.data);me.generateMipmaps=!1}else Te?($e&&n.texStorage2D(e.TEXTURE_2D,xe,ne,zt.width,zt.height),fe&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,zt.width,zt.height,_e,ee,zt.data)):n.texImage2D(e.TEXTURE_2D,0,ne,zt.width,zt.height,0,_e,ee,zt.data);else if(me.isCompressedTexture)if(me.isCompressedArrayTexture){Te&&$e&&n.texStorage3D(e.TEXTURE_2D_ARRAY,xe,ne,le[0].width,le[0].height,zt.depth);for(let Re=0,De=le.length;Re<De;Re++)if(Z=le[Re],me.format!==El)if(_e!==null)if(Te){if(fe)if(me.layerUpdates.size>0){const ze=IN(Z.width,Z.height,me.format,me.type);for(const Je of me.layerUpdates){const Oe=Z.data.subarray(Je*ze/Z.data.BYTES_PER_ELEMENT,(Je+1)*ze/Z.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,Re,0,0,Je,Z.width,Z.height,1,_e,Oe)}me.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,Re,0,0,0,Z.width,Z.height,zt.depth,_e,Z.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,Re,ne,Z.width,Z.height,zt.depth,0,Z.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Te?fe&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,Re,0,0,0,Z.width,Z.height,zt.depth,_e,ee,Z.data):n.texImage3D(e.TEXTURE_2D_ARRAY,Re,ne,Z.width,Z.height,zt.depth,0,_e,ee,Z.data)}else{Te&&$e&&n.texStorage2D(e.TEXTURE_2D,xe,ne,le[0].width,le[0].height);for(let Re=0,De=le.length;Re<De;Re++)Z=le[Re],me.format!==El?_e!==null?Te?fe&&n.compressedTexSubImage2D(e.TEXTURE_2D,Re,0,0,Z.width,Z.height,_e,Z.data):n.compressedTexImage2D(e.TEXTURE_2D,Re,ne,Z.width,Z.height,0,Z.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Te?fe&&n.texSubImage2D(e.TEXTURE_2D,Re,0,0,Z.width,Z.height,_e,ee,Z.data):n.texImage2D(e.TEXTURE_2D,Re,ne,Z.width,Z.height,0,_e,ee,Z.data)}else if(me.isDataArrayTexture)if(Te){if($e&&n.texStorage3D(e.TEXTURE_2D_ARRAY,xe,ne,zt.width,zt.height,zt.depth),fe)if(me.layerUpdates.size>0){const Re=IN(zt.width,zt.height,me.format,me.type);for(const De of me.layerUpdates){const ze=zt.data.subarray(De*Re/zt.data.BYTES_PER_ELEMENT,(De+1)*Re/zt.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,De,zt.width,zt.height,1,_e,ee,ze)}me.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,zt.width,zt.height,zt.depth,_e,ee,zt.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,ne,zt.width,zt.height,zt.depth,0,_e,ee,zt.data);else if(me.isData3DTexture)Te?($e&&n.texStorage3D(e.TEXTURE_3D,xe,ne,zt.width,zt.height,zt.depth),fe&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,zt.width,zt.height,zt.depth,_e,ee,zt.data)):n.texImage3D(e.TEXTURE_3D,0,ne,zt.width,zt.height,zt.depth,0,_e,ee,zt.data);else if(me.isFramebufferTexture){if($e)if(Te)n.texStorage2D(e.TEXTURE_2D,xe,ne,zt.width,zt.height);else{let Re=zt.width,De=zt.height;for(let ze=0;ze<xe;ze++)n.texImage2D(e.TEXTURE_2D,ze,ne,Re,De,0,_e,ee,null),Re>>=1,De>>=1}}else if(le.length>0){if(Te&&$e){const Re=an(le[0]);n.texStorage2D(e.TEXTURE_2D,xe,ne,Re.width,Re.height)}for(let Re=0,De=le.length;Re<De;Re++)Z=le[Re],Te?fe&&n.texSubImage2D(e.TEXTURE_2D,Re,0,0,_e,ee,Z):n.texImage2D(e.TEXTURE_2D,Re,ne,_e,ee,Z);me.generateMipmaps=!1}else if(Te){if($e){const Re=an(zt);n.texStorage2D(e.TEXTURE_2D,xe,ne,Re.width,Re.height)}fe&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,_e,ee,zt)}else n.texImage2D(e.TEXTURE_2D,0,ne,_e,ee,zt);I(me)&&T(St),Zt.__version=wt.version,me.onUpdate&&me.onUpdate(me)}Le.__version=me.version}function lt(Le,me,it){if(me.image.length!==6)return;const St=Xt(Le,me),It=me.source;n.bindTexture(e.TEXTURE_CUBE_MAP,Le.__webglTexture,e.TEXTURE0+it);const wt=r.get(It);if(It.version!==wt.__version||St===!0){n.activeTexture(e.TEXTURE0+it);const Zt=Er.getPrimaries(Er.workingColorSpace),Lt=me.colorSpace===fh?null:Er.getPrimaries(me.colorSpace),kt=me.colorSpace===fh||Zt===Lt?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,me.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,me.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,kt);const bn=me.isCompressedTexture||me.image[0].isCompressedTexture,zt=me.image[0]&&me.image[0].isDataTexture,_e=[];for(let De=0;De<6;De++)!bn&&!zt?_e[De]=L(me.image[De],!0,i.maxCubemapSize):_e[De]=zt?me.image[De].image:me.image[De],_e[De]=An(me,_e[De]);const ee=_e[0],ne=a.convert(me.format,me.colorSpace),Z=a.convert(me.type),le=D(me.internalFormat,ne,Z,me.colorSpace),Te=me.isVideoTexture!==!0,$e=wt.__version===void 0||St===!0,fe=It.dataReady;let xe=H(me,ee);ct(e.TEXTURE_CUBE_MAP,me);let Re;if(bn){Te&&$e&&n.texStorage2D(e.TEXTURE_CUBE_MAP,xe,le,ee.width,ee.height);for(let De=0;De<6;De++){Re=_e[De].mipmaps;for(let ze=0;ze<Re.length;ze++){const Je=Re[ze];me.format!==El?ne!==null?Te?fe&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze,0,0,Je.width,Je.height,ne,Je.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze,le,Je.width,Je.height,0,Je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze,0,0,Je.width,Je.height,ne,Z,Je.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze,le,Je.width,Je.height,0,ne,Z,Je.data)}}}else{if(Re=me.mipmaps,Te&&$e){Re.length>0&&xe++;const De=an(_e[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,xe,le,De.width,De.height)}for(let De=0;De<6;De++)if(zt){Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,_e[De].width,_e[De].height,ne,Z,_e[De].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,le,_e[De].width,_e[De].height,0,ne,Z,_e[De].data);for(let ze=0;ze<Re.length;ze++){const Oe=Re[ze].image[De].image;Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze+1,0,0,Oe.width,Oe.height,ne,Z,Oe.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze+1,le,Oe.width,Oe.height,0,ne,Z,Oe.data)}}else{Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,ne,Z,_e[De]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,le,ne,Z,_e[De]);for(let ze=0;ze<Re.length;ze++){const Je=Re[ze];Te?fe&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze+1,0,0,ne,Z,Je.image[De]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+De,ze+1,le,ne,Z,Je.image[De])}}}I(me)&&T(e.TEXTURE_CUBE_MAP),wt.__version=It.version,me.onUpdate&&me.onUpdate(me)}Le.__version=me.version}function Ot(Le,me,it,St,It,wt){const Zt=a.convert(it.format,it.colorSpace),Lt=a.convert(it.type),kt=D(it.internalFormat,Zt,Lt,it.colorSpace),bn=r.get(me),zt=r.get(it);if(zt.__renderTarget=me,!bn.__hasExternalTextures){const _e=Math.max(1,me.width>>wt),ee=Math.max(1,me.height>>wt);It===e.TEXTURE_3D||It===e.TEXTURE_2D_ARRAY?n.texImage3D(It,wt,kt,_e,ee,me.depth,0,Zt,Lt,null):n.texImage2D(It,wt,kt,_e,ee,0,Zt,Lt,null)}n.bindFramebuffer(e.FRAMEBUFFER,Le),tn(me)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,St,It,zt.__webglTexture,0,Ut(me)):(It===e.TEXTURE_2D||It>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&It<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,St,It,zt.__webglTexture,wt),n.bindFramebuffer(e.FRAMEBUFFER,null)}function ut(Le,me,it){if(e.bindRenderbuffer(e.RENDERBUFFER,Le),me.depthBuffer){const St=me.depthTexture,It=St&&St.isDepthTexture?St.type:null,wt=U(me.stencilBuffer,It),Zt=me.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,Lt=Ut(me);tn(me)?s.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Lt,wt,me.width,me.height):it?e.renderbufferStorageMultisample(e.RENDERBUFFER,Lt,wt,me.width,me.height):e.renderbufferStorage(e.RENDERBUFFER,wt,me.width,me.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,Zt,e.RENDERBUFFER,Le)}else{const St=me.textures;for(let It=0;It<St.length;It++){const wt=St[It],Zt=a.convert(wt.format,wt.colorSpace),Lt=a.convert(wt.type),kt=D(wt.internalFormat,Zt,Lt,wt.colorSpace),bn=Ut(me);it&&tn(me)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,bn,kt,me.width,me.height):tn(me)?s.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,bn,kt,me.width,me.height):e.renderbufferStorage(e.RENDERBUFFER,kt,me.width,me.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function ot(Le,me){if(me&&me.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,Le),!(me.depthTexture&&me.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const St=r.get(me.depthTexture);St.__renderTarget=me,(!St.__webglTexture||me.depthTexture.image.width!==me.width||me.depthTexture.image.height!==me.height)&&(me.depthTexture.image.width=me.width,me.depthTexture.image.height=me.height,me.depthTexture.needsUpdate=!0),Ie(me.depthTexture,0);const It=St.__webglTexture,wt=Ut(me);if(me.depthTexture.format===h_)tn(me)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,It,0,wt):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,It,0);else if(me.depthTexture.format===d_)tn(me)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,It,0,wt):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,It,0);else throw new Error("Unknown depthTexture format")}function Tt(Le){const me=r.get(Le),it=Le.isWebGLCubeRenderTarget===!0;if(me.__boundDepthTexture!==Le.depthTexture){const St=Le.depthTexture;if(me.__depthDisposeCallback&&me.__depthDisposeCallback(),St){const It=()=>{delete me.__boundDepthTexture,delete me.__depthDisposeCallback,St.removeEventListener("dispose",It)};St.addEventListener("dispose",It),me.__depthDisposeCallback=It}me.__boundDepthTexture=St}if(Le.depthTexture&&!me.__autoAllocateDepthBuffer){if(it)throw new Error("target.depthTexture not supported in Cube render targets");ot(me.__webglFramebuffer,Le)}else if(it){me.__webglDepthbuffer=[];for(let St=0;St<6;St++)if(n.bindFramebuffer(e.FRAMEBUFFER,me.__webglFramebuffer[St]),me.__webglDepthbuffer[St]===void 0)me.__webglDepthbuffer[St]=e.createRenderbuffer(),ut(me.__webglDepthbuffer[St],Le,!1);else{const It=Le.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,wt=me.__webglDepthbuffer[St];e.bindRenderbuffer(e.RENDERBUFFER,wt),e.framebufferRenderbuffer(e.FRAMEBUFFER,It,e.RENDERBUFFER,wt)}}else if(n.bindFramebuffer(e.FRAMEBUFFER,me.__webglFramebuffer),me.__webglDepthbuffer===void 0)me.__webglDepthbuffer=e.createRenderbuffer(),ut(me.__webglDepthbuffer,Le,!1);else{const St=Le.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,It=me.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,It),e.framebufferRenderbuffer(e.FRAMEBUFFER,St,e.RENDERBUFFER,It)}n.bindFramebuffer(e.FRAMEBUFFER,null)}function Ct(Le,me,it){const St=r.get(Le);me!==void 0&&Ot(St.__webglFramebuffer,Le,Le.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),it!==void 0&&Tt(Le)}function un(Le){const me=Le.texture,it=r.get(Le),St=r.get(me);Le.addEventListener("dispose",q);const It=Le.textures,wt=Le.isWebGLCubeRenderTarget===!0,Zt=It.length>1;if(Zt||(St.__webglTexture===void 0&&(St.__webglTexture=e.createTexture()),St.__version=me.version,c.memory.textures++),wt){it.__webglFramebuffer=[];for(let Lt=0;Lt<6;Lt++)if(me.mipmaps&&me.mipmaps.length>0){it.__webglFramebuffer[Lt]=[];for(let kt=0;kt<me.mipmaps.length;kt++)it.__webglFramebuffer[Lt][kt]=e.createFramebuffer()}else it.__webglFramebuffer[Lt]=e.createFramebuffer()}else{if(me.mipmaps&&me.mipmaps.length>0){it.__webglFramebuffer=[];for(let Lt=0;Lt<me.mipmaps.length;Lt++)it.__webglFramebuffer[Lt]=e.createFramebuffer()}else it.__webglFramebuffer=e.createFramebuffer();if(Zt)for(let Lt=0,kt=It.length;Lt<kt;Lt++){const bn=r.get(It[Lt]);bn.__webglTexture===void 0&&(bn.__webglTexture=e.createTexture(),c.memory.textures++)}if(Le.samples>0&&tn(Le)===!1){it.__webglMultisampledFramebuffer=e.createFramebuffer(),it.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,it.__webglMultisampledFramebuffer);for(let Lt=0;Lt<It.length;Lt++){const kt=It[Lt];it.__webglColorRenderbuffer[Lt]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,it.__webglColorRenderbuffer[Lt]);const bn=a.convert(kt.format,kt.colorSpace),zt=a.convert(kt.type),_e=D(kt.internalFormat,bn,zt,kt.colorSpace,Le.isXRRenderTarget===!0),ee=Ut(Le);e.renderbufferStorageMultisample(e.RENDERBUFFER,ee,_e,Le.width,Le.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+Lt,e.RENDERBUFFER,it.__webglColorRenderbuffer[Lt])}e.bindRenderbuffer(e.RENDERBUFFER,null),Le.depthBuffer&&(it.__webglDepthRenderbuffer=e.createRenderbuffer(),ut(it.__webglDepthRenderbuffer,Le,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(wt){n.bindTexture(e.TEXTURE_CUBE_MAP,St.__webglTexture),ct(e.TEXTURE_CUBE_MAP,me);for(let Lt=0;Lt<6;Lt++)if(me.mipmaps&&me.mipmaps.length>0)for(let kt=0;kt<me.mipmaps.length;kt++)Ot(it.__webglFramebuffer[Lt][kt],Le,me,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+Lt,kt);else Ot(it.__webglFramebuffer[Lt],Le,me,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+Lt,0);I(me)&&T(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Zt){for(let Lt=0,kt=It.length;Lt<kt;Lt++){const bn=It[Lt],zt=r.get(bn);n.bindTexture(e.TEXTURE_2D,zt.__webglTexture),ct(e.TEXTURE_2D,bn),Ot(it.__webglFramebuffer,Le,bn,e.COLOR_ATTACHMENT0+Lt,e.TEXTURE_2D,0),I(bn)&&T(e.TEXTURE_2D)}n.unbindTexture()}else{let Lt=e.TEXTURE_2D;if((Le.isWebGL3DRenderTarget||Le.isWebGLArrayRenderTarget)&&(Lt=Le.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(Lt,St.__webglTexture),ct(Lt,me),me.mipmaps&&me.mipmaps.length>0)for(let kt=0;kt<me.mipmaps.length;kt++)Ot(it.__webglFramebuffer[kt],Le,me,e.COLOR_ATTACHMENT0,Lt,kt);else Ot(it.__webglFramebuffer,Le,me,e.COLOR_ATTACHMENT0,Lt,0);I(me)&&T(Lt),n.unbindTexture()}Le.depthBuffer&&Tt(Le)}function gn(Le){const me=Le.textures;for(let it=0,St=me.length;it<St;it++){const It=me[it];if(I(It)){const wt=O(Le),Zt=r.get(It).__webglTexture;n.bindTexture(wt,Zt),T(wt),n.unbindTexture()}}}const hn=[],We=[];function vn(Le){if(Le.samples>0){if(tn(Le)===!1){const me=Le.textures,it=Le.width,St=Le.height;let It=e.COLOR_BUFFER_BIT;const wt=Le.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,Zt=r.get(Le),Lt=me.length>1;if(Lt)for(let kt=0;kt<me.length;kt++)n.bindFramebuffer(e.FRAMEBUFFER,Zt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+kt,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,Zt.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+kt,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,Zt.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,Zt.__webglFramebuffer);for(let kt=0;kt<me.length;kt++){if(Le.resolveDepthBuffer&&(Le.depthBuffer&&(It|=e.DEPTH_BUFFER_BIT),Le.stencilBuffer&&Le.resolveStencilBuffer&&(It|=e.STENCIL_BUFFER_BIT)),Lt){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,Zt.__webglColorRenderbuffer[kt]);const bn=r.get(me[kt]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,bn,0)}e.blitFramebuffer(0,0,it,St,0,0,it,St,It,e.NEAREST),f===!0&&(hn.length=0,We.length=0,hn.push(e.COLOR_ATTACHMENT0+kt),Le.depthBuffer&&Le.resolveDepthBuffer===!1&&(hn.push(wt),We.push(wt),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,We)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,hn))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),Lt)for(let kt=0;kt<me.length;kt++){n.bindFramebuffer(e.FRAMEBUFFER,Zt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+kt,e.RENDERBUFFER,Zt.__webglColorRenderbuffer[kt]);const bn=r.get(me[kt]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,Zt.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+kt,e.TEXTURE_2D,bn,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,Zt.__webglMultisampledFramebuffer)}else if(Le.depthBuffer&&Le.resolveDepthBuffer===!1&&f){const me=Le.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[me])}}}function Ut(Le){return Math.min(i.maxSamples,Le.samples)}function tn(Le){const me=r.get(Le);return Le.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&me.__useRenderToTexture!==!1}function Dt(Le){const me=c.render.frame;_.get(Le)!==me&&(_.set(Le,me),Le.update())}function An(Le,me){const it=Le.colorSpace,St=Le.format,It=Le.type;return Le.isCompressedTexture===!0||Le.isVideoTexture===!0||it!==Of&&it!==fh&&(Er.getTransfer(it)===Wr?(St!==El||It!==uu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",it)),me}function an(Le){return typeof HTMLImageElement<"u"&&Le instanceof HTMLImageElement?(g.width=Le.naturalWidth||Le.width,g.height=Le.naturalHeight||Le.height):typeof VideoFrame<"u"&&Le instanceof VideoFrame?(g.width=Le.displayWidth,g.height=Le.displayHeight):(g.width=Le.width,g.height=Le.height),g}this.allocateTextureUnit=ge,this.resetTextureUnits=ye,this.setTexture2D=Ie,this.setTexture2DArray=ve,this.setTexture3D=Se,this.setTextureCube=Me,this.rebindTextures=Ct,this.setupRenderTarget=un,this.updateRenderTargetMipmap=gn,this.updateMultisampleRenderTarget=vn,this.setupDepthRenderbuffer=Tt,this.setupFrameBufferTexture=Ot,this.useMultisampledRTT=tn}function FEe(e,t){function n(r,i=fh){let a;const c=Er.getTransfer(i);if(r===uu)return e.UNSIGNED_BYTE;if(r===wL)return e.UNSIGNED_SHORT_4_4_4_4;if(r===SL)return e.UNSIGNED_SHORT_5_5_5_1;if(r===A9)return e.UNSIGNED_INT_5_9_9_9_REV;if(r===T9)return e.BYTE;if(r===P9)return e.SHORT;if(r===c_)return e.UNSIGNED_SHORT;if(r===bL)return e.INT;if(r===zf)return e.UNSIGNED_INT;if(r===Yc)return e.FLOAT;if(r===ox)return e.HALF_FLOAT;if(r===I9)return e.ALPHA;if(r===R9)return e.RGB;if(r===El)return e.RGBA;if(r===L9)return e.LUMINANCE;if(r===k9)return e.LUMINANCE_ALPHA;if(r===h_)return e.DEPTH_COMPONENT;if(r===d_)return e.DEPTH_STENCIL;if(r===D9)return e.RED;if(r===ML)return e.RED_INTEGER;if(r===z9)return e.RG;if(r===CL)return e.RG_INTEGER;if(r===EL)return e.RGBA_INTEGER;if(r===aw||r===lw||r===cw||r===uw)if(c===Wr)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(r===aw)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===lw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===cw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===uw)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(r===aw)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===lw)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===cw)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===uw)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===KA||r===JA||r===QA||r===eI)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(r===KA)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===JA)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===QA)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===eI)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===tI||r===nI||r===rI)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(r===tI||r===nI)return c===Wr?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(r===rI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===iI||r===oI||r===sI||r===aI||r===lI||r===cI||r===uI||r===hI||r===dI||r===fI||r===pI||r===mI||r===gI||r===vI)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(r===iI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===oI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===sI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===aI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===lI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===cI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===uI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===hI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===dI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===fI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===pI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===mI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===gI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===vI)return c===Wr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===hw||r===yI||r===_I)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(r===hw)return c===Wr?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===yI)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===_I)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===O9||r===xI||r===bI||r===wI)if(a=t.get("EXT_texture_compression_rgtc"),a!==null){if(r===hw)return a.COMPRESSED_RED_RGTC1_EXT;if(r===xI)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===bI)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===wI)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===u_?e.UNSIGNED_INT_24_8:e[r]!==void 0?e[r]:null}return{convert:n}}const NEe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,BEe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class UEe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,n,r){if(this.texture===null){const i=new jo,a=t.properties.get(i);a.__webglTexture=n.texture,(n.depthNear!==r.depthNear||n.depthFar!==r.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=i}}getMesh(t){if(this.texture!==null&&this.mesh===null){const n=t.cameras[0].viewport,r=new hu({vertexShader:NEe,fragmentShader:BEe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Os(new lx(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class $Ee extends Bg{constructor(t,n){super();const r=this;let i=null,a=1,c=null,s="local-floor",f=1,g=null,_=null,x=null,C=null,E=null,A=null;const L=new UEe,I=n.getContextAttributes();let T=null,O=null;const D=[],U=[],H=new kr;let V=null;const q=new da;q.viewport=new Oi;const Q=new da;Q.viewport=new Oi;const K=[q,Q],N=new aSe;let re=null,ye=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(je){let lt=D[je];return lt===void 0&&(lt=new XT,D[je]=lt),lt.getTargetRaySpace()},this.getControllerGrip=function(je){let lt=D[je];return lt===void 0&&(lt=new XT,D[je]=lt),lt.getGripSpace()},this.getHand=function(je){let lt=D[je];return lt===void 0&&(lt=new XT,D[je]=lt),lt.getHandSpace()};function ge(je){const lt=U.indexOf(je.inputSource);if(lt===-1)return;const Ot=D[lt];Ot!==void 0&&(Ot.update(je.inputSource,je.frame,g||c),Ot.dispatchEvent({type:je.type,data:je.inputSource}))}function Ve(){i.removeEventListener("select",ge),i.removeEventListener("selectstart",ge),i.removeEventListener("selectend",ge),i.removeEventListener("squeeze",ge),i.removeEventListener("squeezestart",ge),i.removeEventListener("squeezeend",ge),i.removeEventListener("end",Ve),i.removeEventListener("inputsourceschange",Ie);for(let je=0;je<D.length;je++){const lt=U[je];lt!==null&&(U[je]=null,D[je].disconnect(lt))}re=null,ye=null,L.reset(),t.setRenderTarget(T),E=null,C=null,x=null,i=null,O=null,Xt.stop(),r.isPresenting=!1,t.setPixelRatio(V),t.setSize(H.width,H.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(je){a=je,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(je){s=je,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return g||c},this.setReferenceSpace=function(je){g=je},this.getBaseLayer=function(){return C!==null?C:E},this.getBinding=function(){return x},this.getFrame=function(){return A},this.getSession=function(){return i},this.setSession=async function(je){if(i=je,i!==null){if(T=t.getRenderTarget(),i.addEventListener("select",ge),i.addEventListener("selectstart",ge),i.addEventListener("selectend",ge),i.addEventListener("squeeze",ge),i.addEventListener("squeezestart",ge),i.addEventListener("squeezeend",ge),i.addEventListener("end",Ve),i.addEventListener("inputsourceschange",Ie),I.xrCompatible!==!0&&await n.makeXRCompatible(),V=t.getPixelRatio(),t.getSize(H),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ot=null,ut=null,ot=null;I.depth&&(ot=I.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,Ot=I.stencil?d_:h_,ut=I.stencil?u_:zf);const Tt={colorFormat:n.RGBA8,depthFormat:ot,scaleFactor:a};x=new XRWebGLBinding(i,n),C=x.createProjectionLayer(Tt),i.updateRenderState({layers:[C]}),t.setPixelRatio(1),t.setSize(C.textureWidth,C.textureHeight,!1),O=new Hh(C.textureWidth,C.textureHeight,{format:El,type:uu,depthTexture:new W9(C.textureWidth,C.textureHeight,ut,void 0,void 0,void 0,void 0,void 0,void 0,Ot),stencilBuffer:I.stencil,colorSpace:t.outputColorSpace,samples:I.antialias?4:0,resolveDepthBuffer:C.ignoreDepthValues===!1,resolveStencilBuffer:C.ignoreDepthValues===!1})}else{const Ot={antialias:I.antialias,alpha:!0,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:a};E=new XRWebGLLayer(i,n,Ot),i.updateRenderState({baseLayer:E}),t.setPixelRatio(1),t.setSize(E.framebufferWidth,E.framebufferHeight,!1),O=new Hh(E.framebufferWidth,E.framebufferHeight,{format:El,type:uu,colorSpace:t.outputColorSpace,stencilBuffer:I.stencil,resolveDepthBuffer:E.ignoreDepthValues===!1,resolveStencilBuffer:E.ignoreDepthValues===!1})}O.isXRRenderTarget=!0,this.setFoveation(f),g=null,c=await i.requestReferenceSpace(s),Xt.setContext(i),Xt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return L.getDepthTexture()};function Ie(je){for(let lt=0;lt<je.removed.length;lt++){const Ot=je.removed[lt],ut=U.indexOf(Ot);ut>=0&&(U[ut]=null,D[ut].disconnect(Ot))}for(let lt=0;lt<je.added.length;lt++){const Ot=je.added[lt];let ut=U.indexOf(Ot);if(ut===-1){for(let Tt=0;Tt<D.length;Tt++)if(Tt>=U.length){U.push(Ot),ut=Tt;break}else if(U[Tt]===null){U[Tt]=Ot,ut=Tt;break}if(ut===-1)break}const ot=D[ut];ot&&ot.connect(Ot)}}const ve=new dt,Se=new dt;function Me(je,lt,Ot){ve.setFromMatrixPosition(lt.matrixWorld),Se.setFromMatrixPosition(Ot.matrixWorld);const ut=ve.distanceTo(Se),ot=lt.projectionMatrix.elements,Tt=Ot.projectionMatrix.elements,Ct=ot[14]/(ot[10]-1),un=ot[14]/(ot[10]+1),gn=(ot[9]+1)/ot[5],hn=(ot[9]-1)/ot[5],We=(ot[8]-1)/ot[0],vn=(Tt[8]+1)/Tt[0],Ut=Ct*We,tn=Ct*vn,Dt=ut/(-We+vn),An=Dt*-We;if(lt.matrixWorld.decompose(je.position,je.quaternion,je.scale),je.translateX(An),je.translateZ(Dt),je.matrixWorld.compose(je.position,je.quaternion,je.scale),je.matrixWorldInverse.copy(je.matrixWorld).invert(),ot[10]===-1)je.projectionMatrix.copy(lt.projectionMatrix),je.projectionMatrixInverse.copy(lt.projectionMatrixInverse);else{const an=Ct+Dt,Le=un+Dt,me=Ut-An,it=tn+(ut-An),St=gn*un/Le*an,It=hn*un/Le*an;je.projectionMatrix.makePerspective(me,it,St,It,an,Le),je.projectionMatrixInverse.copy(je.projectionMatrix).invert()}}function Be(je,lt){lt===null?je.matrixWorld.copy(je.matrix):je.matrixWorld.multiplyMatrices(lt.matrixWorld,je.matrix),je.matrixWorldInverse.copy(je.matrixWorld).invert()}this.updateCamera=function(je){if(i===null)return;let lt=je.near,Ot=je.far;L.texture!==null&&(L.depthNear>0&&(lt=L.depthNear),L.depthFar>0&&(Ot=L.depthFar)),N.near=Q.near=q.near=lt,N.far=Q.far=q.far=Ot,(re!==N.near||ye!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),re=N.near,ye=N.far),q.layers.mask=je.layers.mask|2,Q.layers.mask=je.layers.mask|4,N.layers.mask=q.layers.mask|Q.layers.mask;const ut=je.parent,ot=N.cameras;Be(N,ut);for(let Tt=0;Tt<ot.length;Tt++)Be(ot[Tt],ut);ot.length===2?Me(N,q,Q):N.projectionMatrix.copy(q.projectionMatrix),Qe(je,N,ut)};function Qe(je,lt,Ot){Ot===null?je.matrix.copy(lt.matrixWorld):(je.matrix.copy(Ot.matrixWorld),je.matrix.invert(),je.matrix.multiply(lt.matrixWorld)),je.matrix.decompose(je.position,je.quaternion,je.scale),je.updateMatrixWorld(!0),je.projectionMatrix.copy(lt.projectionMatrix),je.projectionMatrixInverse.copy(lt.projectionMatrixInverse),je.isPerspectiveCamera&&(je.fov=f_*2*Math.atan(1/je.projectionMatrix.elements[5]),je.zoom=1)}this.getCamera=function(){return N},this.getFoveation=function(){if(!(C===null&&E===null))return f},this.setFoveation=function(je){f=je,C!==null&&(C.fixedFoveation=je),E!==null&&E.fixedFoveation!==void 0&&(E.fixedFoveation=je)},this.hasDepthSensing=function(){return L.texture!==null},this.getDepthSensingMesh=function(){return L.getMesh(N)};let st=null;function ct(je,lt){if(_=lt.getViewerPose(g||c),A=lt,_!==null){const Ot=_.views;E!==null&&(t.setRenderTargetFramebuffer(O,E.framebuffer),t.setRenderTarget(O));let ut=!1;Ot.length!==N.cameras.length&&(N.cameras.length=0,ut=!0);for(let Ct=0;Ct<Ot.length;Ct++){const un=Ot[Ct];let gn=null;if(E!==null)gn=E.getViewport(un);else{const We=x.getViewSubImage(C,un);gn=We.viewport,Ct===0&&(t.setRenderTargetTextures(O,We.colorTexture,We.depthStencilTexture),t.setRenderTarget(O))}let hn=K[Ct];hn===void 0&&(hn=new da,hn.layers.enable(Ct),hn.viewport=new Oi,K[Ct]=hn),hn.matrix.fromArray(un.transform.matrix),hn.matrix.decompose(hn.position,hn.quaternion,hn.scale),hn.projectionMatrix.fromArray(un.projectionMatrix),hn.projectionMatrixInverse.copy(hn.projectionMatrix).invert(),hn.viewport.set(gn.x,gn.y,gn.width,gn.height),Ct===0&&(N.matrix.copy(hn.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale)),ut===!0&&N.cameras.push(hn)}const ot=i.enabledFeatures;if(ot&&ot.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&x){const Ct=x.getDepthInformation(Ot[0]);Ct&&Ct.isValid&&Ct.texture&&L.init(t,Ct,i.renderState)}}for(let Ot=0;Ot<D.length;Ot++){const ut=U[Ot],ot=D[Ot];ut!==null&&ot!==void 0&&ot.update(ut,lt,g||c)}st&&st(je,lt),lt.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:lt}),A=null}const Xt=new q9;Xt.setAnimationLoop(ct),this.setAnimationLoop=function(je){st=je},this.dispose=function(){}}}const Jd=new yc,VEe=new Vr;function jEe(e,t){function n(I,T){I.matrixAutoUpdate===!0&&I.updateMatrix(),T.value.copy(I.matrix)}function r(I,T){T.color.getRGB(I.fogColor.value,j9(e)),T.isFog?(I.fogNear.value=T.near,I.fogFar.value=T.far):T.isFogExp2&&(I.fogDensity.value=T.density)}function i(I,T,O,D,U){T.isMeshBasicMaterial||T.isMeshLambertMaterial?a(I,T):T.isMeshToonMaterial?(a(I,T),x(I,T)):T.isMeshPhongMaterial?(a(I,T),_(I,T)):T.isMeshStandardMaterial?(a(I,T),C(I,T),T.isMeshPhysicalMaterial&&E(I,T,U)):T.isMeshMatcapMaterial?(a(I,T),A(I,T)):T.isMeshDepthMaterial?a(I,T):T.isMeshDistanceMaterial?(a(I,T),L(I,T)):T.isMeshNormalMaterial?a(I,T):T.isLineBasicMaterial?(c(I,T),T.isLineDashedMaterial&&s(I,T)):T.isPointsMaterial?f(I,T,O,D):T.isSpriteMaterial?g(I,T):T.isShadowMaterial?(I.color.value.copy(T.color),I.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function a(I,T){I.opacity.value=T.opacity,T.color&&I.diffuse.value.copy(T.color),T.emissive&&I.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(I.map.value=T.map,n(T.map,I.mapTransform)),T.alphaMap&&(I.alphaMap.value=T.alphaMap,n(T.alphaMap,I.alphaMapTransform)),T.bumpMap&&(I.bumpMap.value=T.bumpMap,n(T.bumpMap,I.bumpMapTransform),I.bumpScale.value=T.bumpScale,T.side===Vs&&(I.bumpScale.value*=-1)),T.normalMap&&(I.normalMap.value=T.normalMap,n(T.normalMap,I.normalMapTransform),I.normalScale.value.copy(T.normalScale),T.side===Vs&&I.normalScale.value.negate()),T.displacementMap&&(I.displacementMap.value=T.displacementMap,n(T.displacementMap,I.displacementMapTransform),I.displacementScale.value=T.displacementScale,I.displacementBias.value=T.displacementBias),T.emissiveMap&&(I.emissiveMap.value=T.emissiveMap,n(T.emissiveMap,I.emissiveMapTransform)),T.specularMap&&(I.specularMap.value=T.specularMap,n(T.specularMap,I.specularMapTransform)),T.alphaTest>0&&(I.alphaTest.value=T.alphaTest);const O=t.get(T),D=O.envMap,U=O.envMapRotation;D&&(I.envMap.value=D,Jd.copy(U),Jd.x*=-1,Jd.y*=-1,Jd.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&(Jd.y*=-1,Jd.z*=-1),I.envMapRotation.value.setFromMatrix4(VEe.makeRotationFromEuler(Jd)),I.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,I.reflectivity.value=T.reflectivity,I.ior.value=T.ior,I.refractionRatio.value=T.refractionRatio),T.lightMap&&(I.lightMap.value=T.lightMap,I.lightMapIntensity.value=T.lightMapIntensity,n(T.lightMap,I.lightMapTransform)),T.aoMap&&(I.aoMap.value=T.aoMap,I.aoMapIntensity.value=T.aoMapIntensity,n(T.aoMap,I.aoMapTransform))}function c(I,T){I.diffuse.value.copy(T.color),I.opacity.value=T.opacity,T.map&&(I.map.value=T.map,n(T.map,I.mapTransform))}function s(I,T){I.dashSize.value=T.dashSize,I.totalSize.value=T.dashSize+T.gapSize,I.scale.value=T.scale}function f(I,T,O,D){I.diffuse.value.copy(T.color),I.opacity.value=T.opacity,I.size.value=T.size*O,I.scale.value=D*.5,T.map&&(I.map.value=T.map,n(T.map,I.uvTransform)),T.alphaMap&&(I.alphaMap.value=T.alphaMap,n(T.alphaMap,I.alphaMapTransform)),T.alphaTest>0&&(I.alphaTest.value=T.alphaTest)}function g(I,T){I.diffuse.value.copy(T.color),I.opacity.value=T.opacity,I.rotation.value=T.rotation,T.map&&(I.map.value=T.map,n(T.map,I.mapTransform)),T.alphaMap&&(I.alphaMap.value=T.alphaMap,n(T.alphaMap,I.alphaMapTransform)),T.alphaTest>0&&(I.alphaTest.value=T.alphaTest)}function _(I,T){I.specular.value.copy(T.specular),I.shininess.value=Math.max(T.shininess,1e-4)}function x(I,T){T.gradientMap&&(I.gradientMap.value=T.gradientMap)}function C(I,T){I.metalness.value=T.metalness,T.metalnessMap&&(I.metalnessMap.value=T.metalnessMap,n(T.metalnessMap,I.metalnessMapTransform)),I.roughness.value=T.roughness,T.roughnessMap&&(I.roughnessMap.value=T.roughnessMap,n(T.roughnessMap,I.roughnessMapTransform)),T.envMap&&(I.envMapIntensity.value=T.envMapIntensity)}function E(I,T,O){I.ior.value=T.ior,T.sheen>0&&(I.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),I.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(I.sheenColorMap.value=T.sheenColorMap,n(T.sheenColorMap,I.sheenColorMapTransform)),T.sheenRoughnessMap&&(I.sheenRoughnessMap.value=T.sheenRoughnessMap,n(T.sheenRoughnessMap,I.sheenRoughnessMapTransform))),T.clearcoat>0&&(I.clearcoat.value=T.clearcoat,I.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(I.clearcoatMap.value=T.clearcoatMap,n(T.clearcoatMap,I.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(I.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,n(T.clearcoatRoughnessMap,I.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(I.clearcoatNormalMap.value=T.clearcoatNormalMap,n(T.clearcoatNormalMap,I.clearcoatNormalMapTransform),I.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),T.side===Vs&&I.clearcoatNormalScale.value.negate())),T.dispersion>0&&(I.dispersion.value=T.dispersion),T.iridescence>0&&(I.iridescence.value=T.iridescence,I.iridescenceIOR.value=T.iridescenceIOR,I.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],I.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(I.iridescenceMap.value=T.iridescenceMap,n(T.iridescenceMap,I.iridescenceMapTransform)),T.iridescenceThicknessMap&&(I.iridescenceThicknessMap.value=T.iridescenceThicknessMap,n(T.iridescenceThicknessMap,I.iridescenceThicknessMapTransform))),T.transmission>0&&(I.transmission.value=T.transmission,I.transmissionSamplerMap.value=O.texture,I.transmissionSamplerSize.value.set(O.width,O.height),T.transmissionMap&&(I.transmissionMap.value=T.transmissionMap,n(T.transmissionMap,I.transmissionMapTransform)),I.thickness.value=T.thickness,T.thicknessMap&&(I.thicknessMap.value=T.thicknessMap,n(T.thicknessMap,I.thicknessMapTransform)),I.attenuationDistance.value=T.attenuationDistance,I.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(I.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(I.anisotropyMap.value=T.anisotropyMap,n(T.anisotropyMap,I.anisotropyMapTransform))),I.specularIntensity.value=T.specularIntensity,I.specularColor.value.copy(T.specularColor),T.specularColorMap&&(I.specularColorMap.value=T.specularColorMap,n(T.specularColorMap,I.specularColorMapTransform)),T.specularIntensityMap&&(I.specularIntensityMap.value=T.specularIntensityMap,n(T.specularIntensityMap,I.specularIntensityMapTransform))}function A(I,T){T.matcap&&(I.matcap.value=T.matcap)}function L(I,T){const O=t.get(T).light;I.referencePosition.value.setFromMatrixPosition(O.matrixWorld),I.nearDistance.value=O.shadow.camera.near,I.farDistance.value=O.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function HEe(e,t,n,r){let i={},a={},c=[];const s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function f(O,D){const U=D.program;r.uniformBlockBinding(O,U)}function g(O,D){let U=i[O.id];U===void 0&&(A(O),U=_(O),i[O.id]=U,O.addEventListener("dispose",I));const H=D.program;r.updateUBOMapping(O,H);const V=t.render.frame;a[O.id]!==V&&(C(O),a[O.id]=V)}function _(O){const D=x();O.__bindingPointIndex=D;const U=e.createBuffer(),H=O.__size,V=O.usage;return e.bindBuffer(e.UNIFORM_BUFFER,U),e.bufferData(e.UNIFORM_BUFFER,H,V),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,D,U),U}function x(){for(let O=0;O<s;O++)if(c.indexOf(O)===-1)return c.push(O),O;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function C(O){const D=i[O.id],U=O.uniforms,H=O.__cache;e.bindBuffer(e.UNIFORM_BUFFER,D);for(let V=0,q=U.length;V<q;V++){const Q=Array.isArray(U[V])?U[V]:[U[V]];for(let K=0,N=Q.length;K<N;K++){const re=Q[K];if(E(re,V,K,H)===!0){const ye=re.__offset,ge=Array.isArray(re.value)?re.value:[re.value];let Ve=0;for(let Ie=0;Ie<ge.length;Ie++){const ve=ge[Ie],Se=L(ve);typeof ve=="number"||typeof ve=="boolean"?(re.__data[0]=ve,e.bufferSubData(e.UNIFORM_BUFFER,ye+Ve,re.__data)):ve.isMatrix3?(re.__data[0]=ve.elements[0],re.__data[1]=ve.elements[1],re.__data[2]=ve.elements[2],re.__data[3]=0,re.__data[4]=ve.elements[3],re.__data[5]=ve.elements[4],re.__data[6]=ve.elements[5],re.__data[7]=0,re.__data[8]=ve.elements[6],re.__data[9]=ve.elements[7],re.__data[10]=ve.elements[8],re.__data[11]=0):(ve.toArray(re.__data,Ve),Ve+=Se.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,ye,re.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function E(O,D,U,H){const V=O.value,q=D+"_"+U;if(H[q]===void 0)return typeof V=="number"||typeof V=="boolean"?H[q]=V:H[q]=V.clone(),!0;{const Q=H[q];if(typeof V=="number"||typeof V=="boolean"){if(Q!==V)return H[q]=V,!0}else if(Q.equals(V)===!1)return Q.copy(V),!0}return!1}function A(O){const D=O.uniforms;let U=0;const H=16;for(let q=0,Q=D.length;q<Q;q++){const K=Array.isArray(D[q])?D[q]:[D[q]];for(let N=0,re=K.length;N<re;N++){const ye=K[N],ge=Array.isArray(ye.value)?ye.value:[ye.value];for(let Ve=0,Ie=ge.length;Ve<Ie;Ve++){const ve=ge[Ve],Se=L(ve),Me=U%H,Be=Me%Se.boundary,Qe=Me+Be;U+=Be,Qe!==0&&H-Qe<Se.storage&&(U+=H-Qe),ye.__data=new Float32Array(Se.storage/Float32Array.BYTES_PER_ELEMENT),ye.__offset=U,U+=Se.storage}}}const V=U%H;return V>0&&(U+=H-V),O.__size=U,O.__cache={},this}function L(O){const D={boundary:0,storage:0};return typeof O=="number"||typeof O=="boolean"?(D.boundary=4,D.storage=4):O.isVector2?(D.boundary=8,D.storage=8):O.isVector3||O.isColor?(D.boundary=16,D.storage=12):O.isVector4?(D.boundary=16,D.storage=16):O.isMatrix3?(D.boundary=48,D.storage=48):O.isMatrix4?(D.boundary=64,D.storage=64):O.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",O),D}function I(O){const D=O.target;D.removeEventListener("dispose",I);const U=c.indexOf(D.__bindingPointIndex);c.splice(U,1),e.deleteBuffer(i[D.id]),delete i[D.id],delete a[D.id]}function T(){for(const O in i)e.deleteBuffer(i[O]);c=[],i={},a={}}return{bind:f,update:g,dispose:T}}class GEe{constructor(t={}){const{canvas:n=bwe(),context:r=null,depth:i=!0,stencil:a=!1,alpha:c=!1,antialias:s=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:g=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:x=!1,reverseDepthBuffer:C=!1}=t;this.isWebGLRenderer=!0;let E;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");E=r.getContextAttributes().alpha}else E=c;const A=new Uint32Array(4),L=new Int32Array(4);let I=null,T=null;const O=[],D=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Ah,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const U=this;let H=!1;this._outputColorSpace=Na;let V=0,q=0,Q=null,K=-1,N=null;const re=new Oi,ye=new Oi;let ge=null;const Ve=new Nr(0);let Ie=0,ve=n.width,Se=n.height,Me=1,Be=null,Qe=null;const st=new Oi(0,0,ve,Se),ct=new Oi(0,0,ve,Se);let Xt=!1;const je=new RL;let lt=!1,Ot=!1;const ut=new Vr,ot=new Vr,Tt=new dt,Ct=new Oi,un={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let gn=!1;function hn(){return Q===null?Me:1}let We=r;function vn(pe,nt){return n.getContext(pe,nt)}try{const pe={alpha:!0,depth:i,stencil:a,antialias:s,premultipliedAlpha:f,preserveDrawingBuffer:g,powerPreference:_,failIfMajorPerformanceCaveat:x};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${xL}`),n.addEventListener("webglcontextlost",De,!1),n.addEventListener("webglcontextrestored",ze,!1),n.addEventListener("webglcontextcreationerror",Je,!1),We===null){const nt="webgl2";if(We=vn(nt,pe),We===null)throw vn(nt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(pe){throw console.error("THREE.WebGLRenderer: "+pe.message),pe}let Ut,tn,Dt,An,an,Le,me,it,St,It,wt,Zt,Lt,kt,bn,zt,_e,ee,ne,Z,le,Te,$e,fe;function xe(){Ut=new t2e(We),Ut.init(),Te=new FEe(We,Ut),tn=new XCe(We,Ut,t,Te),Dt=new zEe(We,Ut),tn.reverseDepthBuffer&&C&&Dt.buffers.depth.setReversed(!0),An=new i2e(We),an=new wEe,Le=new OEe(We,Ut,Dt,an,tn,Te,An),me=new YCe(U),it=new e2e(U),St=new uSe(We),$e=new WCe(We,St),It=new n2e(We,St,An,$e),wt=new s2e(We,It,St,An),ne=new o2e(We,tn,Le),zt=new ZCe(an),Zt=new bEe(U,me,it,Ut,tn,$e,zt),Lt=new jEe(U,an),kt=new MEe,bn=new IEe(Ut),ee=new GCe(U,me,it,Dt,wt,E,f),_e=new kEe(U,wt,tn),fe=new HEe(We,An,tn,Dt),Z=new qCe(We,Ut,An),le=new r2e(We,Ut,An),An.programs=Zt.programs,U.capabilities=tn,U.extensions=Ut,U.properties=an,U.renderLists=kt,U.shadowMap=_e,U.state=Dt,U.info=An}xe();const Re=new $Ee(U,We);this.xr=Re,this.getContext=function(){return We},this.getContextAttributes=function(){return We.getContextAttributes()},this.forceContextLoss=function(){const pe=Ut.get("WEBGL_lose_context");pe&&pe.loseContext()},this.forceContextRestore=function(){const pe=Ut.get("WEBGL_lose_context");pe&&pe.restoreContext()},this.getPixelRatio=function(){return Me},this.setPixelRatio=function(pe){pe!==void 0&&(Me=pe,this.setSize(ve,Se,!1))},this.getSize=function(pe){return pe.set(ve,Se)},this.setSize=function(pe,nt,vt=!0){if(Re.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ve=pe,Se=nt,n.width=Math.floor(pe*Me),n.height=Math.floor(nt*Me),vt===!0&&(n.style.width=pe+"px",n.style.height=nt+"px"),this.setViewport(0,0,pe,nt)},this.getDrawingBufferSize=function(pe){return pe.set(ve*Me,Se*Me).floor()},this.setDrawingBufferSize=function(pe,nt,vt){ve=pe,Se=nt,Me=vt,n.width=Math.floor(pe*vt),n.height=Math.floor(nt*vt),this.setViewport(0,0,pe,nt)},this.getCurrentViewport=function(pe){return pe.copy(re)},this.getViewport=function(pe){return pe.copy(st)},this.setViewport=function(pe,nt,vt,ft){pe.isVector4?st.set(pe.x,pe.y,pe.z,pe.w):st.set(pe,nt,vt,ft),Dt.viewport(re.copy(st).multiplyScalar(Me).round())},this.getScissor=function(pe){return pe.copy(ct)},this.setScissor=function(pe,nt,vt,ft){pe.isVector4?ct.set(pe.x,pe.y,pe.z,pe.w):ct.set(pe,nt,vt,ft),Dt.scissor(ye.copy(ct).multiplyScalar(Me).round())},this.getScissorTest=function(){return Xt},this.setScissorTest=function(pe){Dt.setScissorTest(Xt=pe)},this.setOpaqueSort=function(pe){Be=pe},this.setTransparentSort=function(pe){Qe=pe},this.getClearColor=function(pe){return pe.copy(ee.getClearColor())},this.setClearColor=function(){ee.setClearColor(...arguments)},this.getClearAlpha=function(){return ee.getClearAlpha()},this.setClearAlpha=function(){ee.setClearAlpha(...arguments)},this.clear=function(pe=!0,nt=!0,vt=!0){let ft=0;if(pe){let at=!1;if(Q!==null){const Kt=Q.texture.format;at=Kt===EL||Kt===CL||Kt===ML}if(at){const Kt=Q.texture.type,fn=Kt===uu||Kt===zf||Kt===c_||Kt===u_||Kt===wL||Kt===SL,Qt=ee.getClearColor(),ln=ee.getClearAlpha(),Nt=Qt.r,zn=Qt.g,_n=Qt.b;fn?(A[0]=Nt,A[1]=zn,A[2]=_n,A[3]=ln,We.clearBufferuiv(We.COLOR,0,A)):(L[0]=Nt,L[1]=zn,L[2]=_n,L[3]=ln,We.clearBufferiv(We.COLOR,0,L))}else ft|=We.COLOR_BUFFER_BIT}nt&&(ft|=We.DEPTH_BUFFER_BIT),vt&&(ft|=We.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),We.clear(ft)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",De,!1),n.removeEventListener("webglcontextrestored",ze,!1),n.removeEventListener("webglcontextcreationerror",Je,!1),ee.dispose(),kt.dispose(),bn.dispose(),an.dispose(),me.dispose(),it.dispose(),wt.dispose(),$e.dispose(),fe.dispose(),Zt.dispose(),Re.dispose(),Re.removeEventListener("sessionstart",At),Re.removeEventListener("sessionend",Ht),Yt.stop()};function De(pe){pe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function ze(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;const pe=An.autoReset,nt=_e.enabled,vt=_e.autoUpdate,ft=_e.needsUpdate,at=_e.type;xe(),An.autoReset=pe,_e.enabled=nt,_e.autoUpdate=vt,_e.needsUpdate=ft,_e.type=at}function Je(pe){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",pe.statusMessage)}function Oe(pe){const nt=pe.target;nt.removeEventListener("dispose",Oe),Et(nt)}function Et(pe){Ft(pe),an.remove(pe)}function Ft(pe){const nt=an.get(pe).programs;nt!==void 0&&(nt.forEach(function(vt){Zt.releaseProgram(vt)}),pe.isShaderMaterial&&Zt.releaseShaderCache(pe))}this.renderBufferDirect=function(pe,nt,vt,ft,at,Kt){nt===null&&(nt=un);const fn=at.isMesh&&at.matrixWorld.determinant()<0,Qt=Ze(pe,nt,vt,ft,at);Dt.setMaterial(ft,fn);let ln=vt.index,Nt=1;if(ft.wireframe===!0){if(ln=It.getWireframeAttribute(vt),ln===void 0)return;Nt=2}const zn=vt.drawRange,_n=vt.attributes.position;let Rn=zn.start*Nt,jn=(zn.start+zn.count)*Nt;Kt!==null&&(Rn=Math.max(Rn,Kt.start*Nt),jn=Math.min(jn,(Kt.start+Kt.count)*Nt)),ln!==null?(Rn=Math.max(Rn,0),jn=Math.min(jn,ln.count)):_n!=null&&(Rn=Math.max(Rn,0),jn=Math.min(jn,_n.count));const hr=jn-Rn;if(hr<0||hr===1/0)return;$e.setup(at,ft,Qt,vt,ln);let dr,Zn=Z;if(ln!==null&&(dr=St.get(ln),Zn=le,Zn.setIndex(dr)),at.isMesh)ft.wireframe===!0?(Dt.setLineWidth(ft.wireframeLinewidth*hn()),Zn.setMode(We.LINES)):Zn.setMode(We.TRIANGLES);else if(at.isLine){let Hn=ft.linewidth;Hn===void 0&&(Hn=1),Dt.setLineWidth(Hn*hn()),at.isLineSegments?Zn.setMode(We.LINES):at.isLineLoop?Zn.setMode(We.LINE_LOOP):Zn.setMode(We.LINE_STRIP)}else at.isPoints?Zn.setMode(We.POINTS):at.isSprite&&Zn.setMode(We.TRIANGLES);if(at.isBatchedMesh)if(at._multiDrawInstances!==null)dw("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Zn.renderMultiDrawInstances(at._multiDrawStarts,at._multiDrawCounts,at._multiDrawCount,at._multiDrawInstances);else if(Ut.get("WEBGL_multi_draw"))Zn.renderMultiDraw(at._multiDrawStarts,at._multiDrawCounts,at._multiDrawCount);else{const Hn=at._multiDrawStarts,Jr=at._multiDrawCounts,wr=at._multiDrawCount,Wo=ln?St.get(ln).bytesPerElement:1,Ms=an.get(ft).currentProgram.getUniforms();for(let Ao=0;Ao<wr;Ao++)Ms.setValue(We,"_gl_DrawID",Ao),Zn.render(Hn[Ao]/Wo,Jr[Ao])}else if(at.isInstancedMesh)Zn.renderInstances(Rn,hr,at.count);else if(vt.isInstancedBufferGeometry){const Hn=vt._maxInstanceCount!==void 0?vt._maxInstanceCount:1/0,Jr=Math.min(vt.instanceCount,Hn);Zn.renderInstances(Rn,hr,Jr)}else Zn.render(Rn,hr)};function be(pe,nt,vt){pe.transparent===!0&&pe.side===qc&&pe.forceSinglePass===!1?(pe.side=Vs,pe.needsUpdate=!0,cn(pe,nt,vt),pe.side=jh,pe.needsUpdate=!0,cn(pe,nt,vt),pe.side=qc):cn(pe,nt,vt)}this.compile=function(pe,nt,vt=null){vt===null&&(vt=pe),T=bn.get(vt),T.init(nt),D.push(T),vt.traverseVisible(function(at){at.isLight&&at.layers.test(nt.layers)&&(T.pushLight(at),at.castShadow&&T.pushShadow(at))}),pe!==vt&&pe.traverseVisible(function(at){at.isLight&&at.layers.test(nt.layers)&&(T.pushLight(at),at.castShadow&&T.pushShadow(at))}),T.setupLights();const ft=new Set;return pe.traverse(function(at){if(!(at.isMesh||at.isPoints||at.isLine||at.isSprite))return;const Kt=at.material;if(Kt)if(Array.isArray(Kt))for(let fn=0;fn<Kt.length;fn++){const Qt=Kt[fn];be(Qt,vt,at),ft.add(Qt)}else be(Kt,vt,at),ft.add(Kt)}),T=D.pop(),ft},this.compileAsync=function(pe,nt,vt=null){const ft=this.compile(pe,nt,vt);return new Promise(at=>{function Kt(){if(ft.forEach(function(fn){an.get(fn).currentProgram.isReady()&&ft.delete(fn)}),ft.size===0){at(pe);return}setTimeout(Kt,10)}Ut.get("KHR_parallel_shader_compile")!==null?Kt():setTimeout(Kt,10)})};let qe=null;function tt(pe){qe&&qe(pe)}function At(){Yt.stop()}function Ht(){Yt.start()}const Yt=new q9;Yt.setAnimationLoop(tt),typeof self<"u"&&Yt.setContext(self),this.setAnimationLoop=function(pe){qe=pe,Re.setAnimationLoop(pe),pe===null?Yt.stop():Yt.start()},Re.addEventListener("sessionstart",At),Re.addEventListener("sessionend",Ht),this.render=function(pe,nt){if(nt!==void 0&&nt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H===!0)return;if(pe.matrixWorldAutoUpdate===!0&&pe.updateMatrixWorld(),nt.parent===null&&nt.matrixWorldAutoUpdate===!0&&nt.updateMatrixWorld(),Re.enabled===!0&&Re.isPresenting===!0&&(Re.cameraAutoUpdate===!0&&Re.updateCamera(nt),nt=Re.getCamera()),pe.isScene===!0&&pe.onBeforeRender(U,pe,nt,Q),T=bn.get(pe,D.length),T.init(nt),D.push(T),ot.multiplyMatrices(nt.projectionMatrix,nt.matrixWorldInverse),je.setFromProjectionMatrix(ot),Ot=this.localClippingEnabled,lt=zt.init(this.clippingPlanes,Ot),I=kt.get(pe,O.length),I.init(),O.push(I),Re.enabled===!0&&Re.isPresenting===!0){const Kt=U.xr.getDepthSensingMesh();Kt!==null&&qt(Kt,nt,-1/0,U.sortObjects)}qt(pe,nt,0,U.sortObjects),I.finish(),U.sortObjects===!0&&I.sort(Be,Qe),gn=Re.enabled===!1||Re.isPresenting===!1||Re.hasDepthSensing()===!1,gn&&ee.addToRenderList(I,pe),this.info.render.frame++,lt===!0&&zt.beginShadows();const vt=T.state.shadowsArray;_e.render(vt,pe,nt),lt===!0&&zt.endShadows(),this.info.autoReset===!0&&this.info.reset();const ft=I.opaque,at=I.transmissive;if(T.setupLights(),nt.isArrayCamera){const Kt=nt.cameras;if(at.length>0)for(let fn=0,Qt=Kt.length;fn<Qt;fn++){const ln=Kt[fn];yn(ft,at,pe,ln)}gn&&ee.render(pe);for(let fn=0,Qt=Kt.length;fn<Qt;fn++){const ln=Kt[fn];Gt(I,pe,ln,ln.viewport)}}else at.length>0&&yn(ft,at,pe,nt),gn&&ee.render(pe),Gt(I,pe,nt);Q!==null&&q===0&&(Le.updateMultisampleRenderTarget(Q),Le.updateRenderTargetMipmap(Q)),pe.isScene===!0&&pe.onAfterRender(U,pe,nt),$e.resetDefaultState(),K=-1,N=null,D.pop(),D.length>0?(T=D[D.length-1],lt===!0&&zt.setGlobalState(U.clippingPlanes,T.state.camera)):T=null,O.pop(),O.length>0?I=O[O.length-1]:I=null};function qt(pe,nt,vt,ft){if(pe.visible===!1)return;if(pe.layers.test(nt.layers)){if(pe.isGroup)vt=pe.renderOrder;else if(pe.isLOD)pe.autoUpdate===!0&&pe.update(nt);else if(pe.isLight)T.pushLight(pe),pe.castShadow&&T.pushShadow(pe);else if(pe.isSprite){if(!pe.frustumCulled||je.intersectsSprite(pe)){ft&&Ct.setFromMatrixPosition(pe.matrixWorld).applyMatrix4(ot);const fn=wt.update(pe),Qt=pe.material;Qt.visible&&I.push(pe,fn,Qt,vt,Ct.z,null)}}else if((pe.isMesh||pe.isLine||pe.isPoints)&&(!pe.frustumCulled||je.intersectsObject(pe))){const fn=wt.update(pe),Qt=pe.material;if(ft&&(pe.boundingSphere!==void 0?(pe.boundingSphere===null&&pe.computeBoundingSphere(),Ct.copy(pe.boundingSphere.center)):(fn.boundingSphere===null&&fn.computeBoundingSphere(),Ct.copy(fn.boundingSphere.center)),Ct.applyMatrix4(pe.matrixWorld).applyMatrix4(ot)),Array.isArray(Qt)){const ln=fn.groups;for(let Nt=0,zn=ln.length;Nt<zn;Nt++){const _n=ln[Nt],Rn=Qt[_n.materialIndex];Rn&&Rn.visible&&I.push(pe,fn,Rn,vt,Ct.z,_n)}}else Qt.visible&&I.push(pe,fn,Qt,vt,Ct.z,null)}}const Kt=pe.children;for(let fn=0,Qt=Kt.length;fn<Qt;fn++)qt(Kt[fn],nt,vt,ft)}function Gt(pe,nt,vt,ft){const at=pe.opaque,Kt=pe.transmissive,fn=pe.transparent;T.setupLightsView(vt),lt===!0&&zt.setGlobalState(U.clippingPlanes,vt),ft&&Dt.viewport(re.copy(ft)),at.length>0&&gt(at,nt,vt),Kt.length>0&&gt(Kt,nt,vt),fn.length>0&&gt(fn,nt,vt),Dt.buffers.depth.setTest(!0),Dt.buffers.depth.setMask(!0),Dt.buffers.color.setMask(!0),Dt.setPolygonOffset(!1)}function yn(pe,nt,vt,ft){if((vt.isScene===!0?vt.overrideMaterial:null)!==null)return;T.state.transmissionRenderTarget[ft.id]===void 0&&(T.state.transmissionRenderTarget[ft.id]=new Hh(1,1,{generateMipmaps:!0,type:Ut.has("EXT_color_buffer_half_float")||Ut.has("EXT_color_buffer_float")?ox:uu,minFilter:vh,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Er.workingColorSpace}));const Kt=T.state.transmissionRenderTarget[ft.id],fn=ft.viewport||re;Kt.setSize(fn.z*U.transmissionResolutionScale,fn.w*U.transmissionResolutionScale);const Qt=U.getRenderTarget();U.setRenderTarget(Kt),U.getClearColor(Ve),Ie=U.getClearAlpha(),Ie<1&&U.setClearColor(16777215,.5),U.clear(),gn&&ee.render(vt);const ln=U.toneMapping;U.toneMapping=Ah;const Nt=ft.viewport;if(ft.viewport!==void 0&&(ft.viewport=void 0),T.setupLightsView(ft),lt===!0&&zt.setGlobalState(U.clippingPlanes,ft),gt(pe,vt,ft),Le.updateMultisampleRenderTarget(Kt),Le.updateRenderTargetMipmap(Kt),Ut.has("WEBGL_multisampled_render_to_texture")===!1){let zn=!1;for(let _n=0,Rn=nt.length;_n<Rn;_n++){const jn=nt[_n],hr=jn.object,dr=jn.geometry,Zn=jn.material,Hn=jn.group;if(Zn.side===qc&&hr.layers.test(ft.layers)){const Jr=Zn.side;Zn.side=Vs,Zn.needsUpdate=!0,In(hr,vt,ft,dr,Zn,Hn),Zn.side=Jr,Zn.needsUpdate=!0,zn=!0}}zn===!0&&(Le.updateMultisampleRenderTarget(Kt),Le.updateRenderTargetMipmap(Kt))}U.setRenderTarget(Qt),U.setClearColor(Ve,Ie),Nt!==void 0&&(ft.viewport=Nt),U.toneMapping=ln}function gt(pe,nt,vt){const ft=nt.isScene===!0?nt.overrideMaterial:null;for(let at=0,Kt=pe.length;at<Kt;at++){const fn=pe[at],Qt=fn.object,ln=fn.geometry,Nt=fn.group;let zn=fn.material;zn.allowOverride===!0&&ft!==null&&(zn=ft),Qt.layers.test(vt.layers)&&In(Qt,nt,vt,ln,zn,Nt)}}function In(pe,nt,vt,ft,at,Kt){pe.onBeforeRender(U,nt,vt,ft,at,Kt),pe.modelViewMatrix.multiplyMatrices(vt.matrixWorldInverse,pe.matrixWorld),pe.normalMatrix.getNormalMatrix(pe.modelViewMatrix),at.onBeforeRender(U,nt,vt,ft,pe,Kt),at.transparent===!0&&at.side===qc&&at.forceSinglePass===!1?(at.side=Vs,at.needsUpdate=!0,U.renderBufferDirect(vt,nt,ft,at,pe,Kt),at.side=jh,at.needsUpdate=!0,U.renderBufferDirect(vt,nt,ft,at,pe,Kt),at.side=qc):U.renderBufferDirect(vt,nt,ft,at,pe,Kt),pe.onAfterRender(U,nt,vt,ft,at,Kt)}function cn(pe,nt,vt){nt.isScene!==!0&&(nt=un);const ft=an.get(pe),at=T.state.lights,Kt=T.state.shadowsArray,fn=at.state.version,Qt=Zt.getParameters(pe,at.state,Kt,nt,vt),ln=Zt.getProgramCacheKey(Qt);let Nt=ft.programs;ft.environment=pe.isMeshStandardMaterial?nt.environment:null,ft.fog=nt.fog,ft.envMap=(pe.isMeshStandardMaterial?it:me).get(pe.envMap||ft.environment),ft.envMapRotation=ft.environment!==null&&pe.envMap===null?nt.environmentRotation:pe.envMapRotation,Nt===void 0&&(pe.addEventListener("dispose",Oe),Nt=new Map,ft.programs=Nt);let zn=Nt.get(ln);if(zn!==void 0){if(ft.currentProgram===zn&&ft.lightsStateVersion===fn)return xt(pe,Qt),zn}else Qt.uniforms=Zt.getUniforms(pe),pe.onBeforeCompile(Qt,U),zn=Zt.acquireProgram(Qt,ln),Nt.set(ln,zn),ft.uniforms=Qt.uniforms;const _n=ft.uniforms;return(!pe.isShaderMaterial&&!pe.isRawShaderMaterial||pe.clipping===!0)&&(_n.clippingPlanes=zt.uniform),xt(pe,Qt),ft.needsLights=Wt(pe),ft.lightsStateVersion=fn,ft.needsLights&&(_n.ambientLightColor.value=at.state.ambient,_n.lightProbe.value=at.state.probe,_n.directionalLights.value=at.state.directional,_n.directionalLightShadows.value=at.state.directionalShadow,_n.spotLights.value=at.state.spot,_n.spotLightShadows.value=at.state.spotShadow,_n.rectAreaLights.value=at.state.rectArea,_n.ltc_1.value=at.state.rectAreaLTC1,_n.ltc_2.value=at.state.rectAreaLTC2,_n.pointLights.value=at.state.point,_n.pointLightShadows.value=at.state.pointShadow,_n.hemisphereLights.value=at.state.hemi,_n.directionalShadowMap.value=at.state.directionalShadowMap,_n.directionalShadowMatrix.value=at.state.directionalShadowMatrix,_n.spotShadowMap.value=at.state.spotShadowMap,_n.spotLightMatrix.value=at.state.spotLightMatrix,_n.spotLightMap.value=at.state.spotLightMap,_n.pointShadowMap.value=at.state.pointShadowMap,_n.pointShadowMatrix.value=at.state.pointShadowMatrix),ft.currentProgram=zn,ft.uniformsList=null,zn}function Nn(pe){if(pe.uniformsList===null){const nt=pe.currentProgram.getUniforms();pe.uniformsList=fw.seqWithValue(nt.seq,pe.uniforms)}return pe.uniformsList}function xt(pe,nt){const vt=an.get(pe);vt.outputColorSpace=nt.outputColorSpace,vt.batching=nt.batching,vt.batchingColor=nt.batchingColor,vt.instancing=nt.instancing,vt.instancingColor=nt.instancingColor,vt.instancingMorph=nt.instancingMorph,vt.skinning=nt.skinning,vt.morphTargets=nt.morphTargets,vt.morphNormals=nt.morphNormals,vt.morphColors=nt.morphColors,vt.morphTargetsCount=nt.morphTargetsCount,vt.numClippingPlanes=nt.numClippingPlanes,vt.numIntersection=nt.numClipIntersection,vt.vertexAlphas=nt.vertexAlphas,vt.vertexTangents=nt.vertexTangents,vt.toneMapping=nt.toneMapping}function Ze(pe,nt,vt,ft,at){nt.isScene!==!0&&(nt=un),Le.resetTextureUnits();const Kt=nt.fog,fn=ft.isMeshStandardMaterial?nt.environment:null,Qt=Q===null?U.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:Of,ln=(ft.isMeshStandardMaterial?it:me).get(ft.envMap||fn),Nt=ft.vertexColors===!0&&!!vt.attributes.color&&vt.attributes.color.itemSize===4,zn=!!vt.attributes.tangent&&(!!ft.normalMap||ft.anisotropy>0),_n=!!vt.morphAttributes.position,Rn=!!vt.morphAttributes.normal,jn=!!vt.morphAttributes.color;let hr=Ah;ft.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(hr=U.toneMapping);const dr=vt.morphAttributes.position||vt.morphAttributes.normal||vt.morphAttributes.color,Zn=dr!==void 0?dr.length:0,Hn=an.get(ft),Jr=T.state.lights;if(lt===!0&&(Ot===!0||pe!==N)){const Ui=pe===N&&ft.id===K;zt.setState(ft,pe,Ui)}let wr=!1;ft.version===Hn.__version?(Hn.needsLights&&Hn.lightsStateVersion!==Jr.state.version||Hn.outputColorSpace!==Qt||at.isBatchedMesh&&Hn.batching===!1||!at.isBatchedMesh&&Hn.batching===!0||at.isBatchedMesh&&Hn.batchingColor===!0&&at.colorTexture===null||at.isBatchedMesh&&Hn.batchingColor===!1&&at.colorTexture!==null||at.isInstancedMesh&&Hn.instancing===!1||!at.isInstancedMesh&&Hn.instancing===!0||at.isSkinnedMesh&&Hn.skinning===!1||!at.isSkinnedMesh&&Hn.skinning===!0||at.isInstancedMesh&&Hn.instancingColor===!0&&at.instanceColor===null||at.isInstancedMesh&&Hn.instancingColor===!1&&at.instanceColor!==null||at.isInstancedMesh&&Hn.instancingMorph===!0&&at.morphTexture===null||at.isInstancedMesh&&Hn.instancingMorph===!1&&at.morphTexture!==null||Hn.envMap!==ln||ft.fog===!0&&Hn.fog!==Kt||Hn.numClippingPlanes!==void 0&&(Hn.numClippingPlanes!==zt.numPlanes||Hn.numIntersection!==zt.numIntersection)||Hn.vertexAlphas!==Nt||Hn.vertexTangents!==zn||Hn.morphTargets!==_n||Hn.morphNormals!==Rn||Hn.morphColors!==jn||Hn.toneMapping!==hr||Hn.morphTargetsCount!==Zn)&&(wr=!0):(wr=!0,Hn.__version=ft.version);let Wo=Hn.currentProgram;wr===!0&&(Wo=cn(ft,nt,at));let Ms=!1,Ao=!1,Dl=!1;const Cr=Wo.getUniforms(),po=Hn.uniforms;if(Dt.useProgram(Wo.program)&&(Ms=!0,Ao=!0,Dl=!0),ft.id!==K&&(K=ft.id,Ao=!0),Ms||N!==pe){Dt.buffers.depth.getReversed()?(ut.copy(pe.projectionMatrix),Swe(ut),Mwe(ut),Cr.setValue(We,"projectionMatrix",ut)):Cr.setValue(We,"projectionMatrix",pe.projectionMatrix),Cr.setValue(We,"viewMatrix",pe.matrixWorldInverse);const Ii=Cr.map.cameraPosition;Ii!==void 0&&Ii.setValue(We,Tt.setFromMatrixPosition(pe.matrixWorld)),tn.logarithmicDepthBuffer&&Cr.setValue(We,"logDepthBufFC",2/(Math.log(pe.far+1)/Math.LN2)),(ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshLambertMaterial||ft.isMeshBasicMaterial||ft.isMeshStandardMaterial||ft.isShaderMaterial)&&Cr.setValue(We,"isOrthographic",pe.isOrthographicCamera===!0),N!==pe&&(N=pe,Ao=!0,Dl=!0)}if(at.isSkinnedMesh){Cr.setOptional(We,at,"bindMatrix"),Cr.setOptional(We,at,"bindMatrixInverse");const Ui=at.skeleton;Ui&&(Ui.boneTexture===null&&Ui.computeBoneTexture(),Cr.setValue(We,"boneTexture",Ui.boneTexture,Le))}at.isBatchedMesh&&(Cr.setOptional(We,at,"batchingTexture"),Cr.setValue(We,"batchingTexture",at._matricesTexture,Le),Cr.setOptional(We,at,"batchingIdTexture"),Cr.setValue(We,"batchingIdTexture",at._indirectTexture,Le),Cr.setOptional(We,at,"batchingColorTexture"),at._colorsTexture!==null&&Cr.setValue(We,"batchingColorTexture",at._colorsTexture,Le));const mo=vt.morphAttributes;if((mo.position!==void 0||mo.normal!==void 0||mo.color!==void 0)&&ne.update(at,vt,Wo),(Ao||Hn.receiveShadow!==at.receiveShadow)&&(Hn.receiveShadow=at.receiveShadow,Cr.setValue(We,"receiveShadow",at.receiveShadow)),ft.isMeshGouraudMaterial&&ft.envMap!==null&&(po.envMap.value=ln,po.flipEnvMap.value=ln.isCubeTexture&&ln.isRenderTargetTexture===!1?-1:1),ft.isMeshStandardMaterial&&ft.envMap===null&&nt.environment!==null&&(po.envMapIntensity.value=nt.environmentIntensity),Ao&&(Cr.setValue(We,"toneMappingExposure",U.toneMappingExposure),Hn.needsLights&&Rt(po,Dl),Kt&&ft.fog===!0&&Lt.refreshFogUniforms(po,Kt),Lt.refreshMaterialUniforms(po,ft,Me,Se,T.state.transmissionRenderTarget[pe.id]),fw.upload(We,Nn(Hn),po,Le)),ft.isShaderMaterial&&ft.uniformsNeedUpdate===!0&&(fw.upload(We,Nn(Hn),po,Le),ft.uniformsNeedUpdate=!1),ft.isSpriteMaterial&&Cr.setValue(We,"center",at.center),Cr.setValue(We,"modelViewMatrix",at.modelViewMatrix),Cr.setValue(We,"normalMatrix",at.normalMatrix),Cr.setValue(We,"modelMatrix",at.matrixWorld),ft.isShaderMaterial||ft.isRawShaderMaterial){const Ui=ft.uniformsGroups;for(let Ii=0,zl=Ui.length;Ii<zl;Ii++){const $i=Ui[Ii];fe.update($i,Wo),fe.bind($i,Wo)}}return Wo}function Rt(pe,nt){pe.ambientLightColor.needsUpdate=nt,pe.lightProbe.needsUpdate=nt,pe.directionalLights.needsUpdate=nt,pe.directionalLightShadows.needsUpdate=nt,pe.pointLights.needsUpdate=nt,pe.pointLightShadows.needsUpdate=nt,pe.spotLights.needsUpdate=nt,pe.spotLightShadows.needsUpdate=nt,pe.rectAreaLights.needsUpdate=nt,pe.hemisphereLights.needsUpdate=nt}function Wt(pe){return pe.isMeshLambertMaterial||pe.isMeshToonMaterial||pe.isMeshPhongMaterial||pe.isMeshStandardMaterial||pe.isShadowMaterial||pe.isShaderMaterial&&pe.lights===!0}this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return q},this.getRenderTarget=function(){return Q},this.setRenderTargetTextures=function(pe,nt,vt){const ft=an.get(pe);ft.__autoAllocateDepthBuffer=pe.resolveDepthBuffer===!1,ft.__autoAllocateDepthBuffer===!1&&(ft.__useRenderToTexture=!1),an.get(pe.texture).__webglTexture=nt,an.get(pe.depthTexture).__webglTexture=ft.__autoAllocateDepthBuffer?void 0:vt,ft.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(pe,nt){const vt=an.get(pe);vt.__webglFramebuffer=nt,vt.__useDefaultFramebuffer=nt===void 0};const pn=We.createFramebuffer();this.setRenderTarget=function(pe,nt=0,vt=0){Q=pe,V=nt,q=vt;let ft=!0,at=null,Kt=!1,fn=!1;if(pe){const ln=an.get(pe);if(ln.__useDefaultFramebuffer!==void 0)Dt.bindFramebuffer(We.FRAMEBUFFER,null),ft=!1;else if(ln.__webglFramebuffer===void 0)Le.setupRenderTarget(pe);else if(ln.__hasExternalTextures)Le.rebindTextures(pe,an.get(pe.texture).__webglTexture,an.get(pe.depthTexture).__webglTexture);else if(pe.depthBuffer){const _n=pe.depthTexture;if(ln.__boundDepthTexture!==_n){if(_n!==null&&an.has(_n)&&(pe.width!==_n.image.width||pe.height!==_n.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Le.setupDepthRenderbuffer(pe)}}const Nt=pe.texture;(Nt.isData3DTexture||Nt.isDataArrayTexture||Nt.isCompressedArrayTexture)&&(fn=!0);const zn=an.get(pe).__webglFramebuffer;pe.isWebGLCubeRenderTarget?(Array.isArray(zn[nt])?at=zn[nt][vt]:at=zn[nt],Kt=!0):pe.samples>0&&Le.useMultisampledRTT(pe)===!1?at=an.get(pe).__webglMultisampledFramebuffer:Array.isArray(zn)?at=zn[vt]:at=zn,re.copy(pe.viewport),ye.copy(pe.scissor),ge=pe.scissorTest}else re.copy(st).multiplyScalar(Me).floor(),ye.copy(ct).multiplyScalar(Me).floor(),ge=Xt;if(vt!==0&&(at=pn),Dt.bindFramebuffer(We.FRAMEBUFFER,at)&&ft&&Dt.drawBuffers(pe,at),Dt.viewport(re),Dt.scissor(ye),Dt.setScissorTest(ge),Kt){const ln=an.get(pe.texture);We.framebufferTexture2D(We.FRAMEBUFFER,We.COLOR_ATTACHMENT0,We.TEXTURE_CUBE_MAP_POSITIVE_X+nt,ln.__webglTexture,vt)}else if(fn){const ln=an.get(pe.texture),Nt=nt;We.framebufferTextureLayer(We.FRAMEBUFFER,We.COLOR_ATTACHMENT0,ln.__webglTexture,vt,Nt)}else if(pe!==null&&vt!==0){const ln=an.get(pe.texture);We.framebufferTexture2D(We.FRAMEBUFFER,We.COLOR_ATTACHMENT0,We.TEXTURE_2D,ln.__webglTexture,vt)}K=-1},this.readRenderTargetPixels=function(pe,nt,vt,ft,at,Kt,fn){if(!(pe&&pe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Qt=an.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&fn!==void 0&&(Qt=Qt[fn]),Qt){Dt.bindFramebuffer(We.FRAMEBUFFER,Qt);try{const ln=pe.texture,Nt=ln.format,zn=ln.type;if(!tn.textureFormatReadable(Nt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!tn.textureTypeReadable(zn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}nt>=0&&nt<=pe.width-ft&&vt>=0&&vt<=pe.height-at&&We.readPixels(nt,vt,ft,at,Te.convert(Nt),Te.convert(zn),Kt)}finally{const ln=Q!==null?an.get(Q).__webglFramebuffer:null;Dt.bindFramebuffer(We.FRAMEBUFFER,ln)}}},this.readRenderTargetPixelsAsync=async function(pe,nt,vt,ft,at,Kt,fn){if(!(pe&&pe.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Qt=an.get(pe).__webglFramebuffer;if(pe.isWebGLCubeRenderTarget&&fn!==void 0&&(Qt=Qt[fn]),Qt)if(nt>=0&&nt<=pe.width-ft&&vt>=0&&vt<=pe.height-at){Dt.bindFramebuffer(We.FRAMEBUFFER,Qt);const ln=pe.texture,Nt=ln.format,zn=ln.type;if(!tn.textureFormatReadable(Nt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!tn.textureTypeReadable(zn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const _n=We.createBuffer();We.bindBuffer(We.PIXEL_PACK_BUFFER,_n),We.bufferData(We.PIXEL_PACK_BUFFER,Kt.byteLength,We.STREAM_READ),We.readPixels(nt,vt,ft,at,Te.convert(Nt),Te.convert(zn),0);const Rn=Q!==null?an.get(Q).__webglFramebuffer:null;Dt.bindFramebuffer(We.FRAMEBUFFER,Rn);const jn=We.fenceSync(We.SYNC_GPU_COMMANDS_COMPLETE,0);return We.flush(),await wwe(We,jn,4),We.bindBuffer(We.PIXEL_PACK_BUFFER,_n),We.getBufferSubData(We.PIXEL_PACK_BUFFER,0,Kt),We.deleteBuffer(_n),We.deleteSync(jn),Kt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(pe,nt=null,vt=0){const ft=Math.pow(2,-vt),at=Math.floor(pe.image.width*ft),Kt=Math.floor(pe.image.height*ft),fn=nt!==null?nt.x:0,Qt=nt!==null?nt.y:0;Le.setTexture2D(pe,0),We.copyTexSubImage2D(We.TEXTURE_2D,vt,0,0,fn,Qt,at,Kt),Dt.unbindTexture()};const cr=We.createFramebuffer(),qn=We.createFramebuffer();this.copyTextureToTexture=function(pe,nt,vt=null,ft=null,at=0,Kt=null){Kt===null&&(at!==0?(dw("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Kt=at,at=0):Kt=0);let fn,Qt,ln,Nt,zn,_n,Rn,jn,hr;const dr=pe.isCompressedTexture?pe.mipmaps[Kt]:pe.image;if(vt!==null)fn=vt.max.x-vt.min.x,Qt=vt.max.y-vt.min.y,ln=vt.isBox3?vt.max.z-vt.min.z:1,Nt=vt.min.x,zn=vt.min.y,_n=vt.isBox3?vt.min.z:0;else{const mo=Math.pow(2,-at);fn=Math.floor(dr.width*mo),Qt=Math.floor(dr.height*mo),pe.isDataArrayTexture?ln=dr.depth:pe.isData3DTexture?ln=Math.floor(dr.depth*mo):ln=1,Nt=0,zn=0,_n=0}ft!==null?(Rn=ft.x,jn=ft.y,hr=ft.z):(Rn=0,jn=0,hr=0);const Zn=Te.convert(nt.format),Hn=Te.convert(nt.type);let Jr;nt.isData3DTexture?(Le.setTexture3D(nt,0),Jr=We.TEXTURE_3D):nt.isDataArrayTexture||nt.isCompressedArrayTexture?(Le.setTexture2DArray(nt,0),Jr=We.TEXTURE_2D_ARRAY):(Le.setTexture2D(nt,0),Jr=We.TEXTURE_2D),We.pixelStorei(We.UNPACK_FLIP_Y_WEBGL,nt.flipY),We.pixelStorei(We.UNPACK_PREMULTIPLY_ALPHA_WEBGL,nt.premultiplyAlpha),We.pixelStorei(We.UNPACK_ALIGNMENT,nt.unpackAlignment);const wr=We.getParameter(We.UNPACK_ROW_LENGTH),Wo=We.getParameter(We.UNPACK_IMAGE_HEIGHT),Ms=We.getParameter(We.UNPACK_SKIP_PIXELS),Ao=We.getParameter(We.UNPACK_SKIP_ROWS),Dl=We.getParameter(We.UNPACK_SKIP_IMAGES);We.pixelStorei(We.UNPACK_ROW_LENGTH,dr.width),We.pixelStorei(We.UNPACK_IMAGE_HEIGHT,dr.height),We.pixelStorei(We.UNPACK_SKIP_PIXELS,Nt),We.pixelStorei(We.UNPACK_SKIP_ROWS,zn),We.pixelStorei(We.UNPACK_SKIP_IMAGES,_n);const Cr=pe.isDataArrayTexture||pe.isData3DTexture,po=nt.isDataArrayTexture||nt.isData3DTexture;if(pe.isDepthTexture){const mo=an.get(pe),Ui=an.get(nt),Ii=an.get(mo.__renderTarget),zl=an.get(Ui.__renderTarget);Dt.bindFramebuffer(We.READ_FRAMEBUFFER,Ii.__webglFramebuffer),Dt.bindFramebuffer(We.DRAW_FRAMEBUFFER,zl.__webglFramebuffer);for(let $i=0;$i<ln;$i++)Cr&&(We.framebufferTextureLayer(We.READ_FRAMEBUFFER,We.COLOR_ATTACHMENT0,an.get(pe).__webglTexture,at,_n+$i),We.framebufferTextureLayer(We.DRAW_FRAMEBUFFER,We.COLOR_ATTACHMENT0,an.get(nt).__webglTexture,Kt,hr+$i)),We.blitFramebuffer(Nt,zn,fn,Qt,Rn,jn,fn,Qt,We.DEPTH_BUFFER_BIT,We.NEAREST);Dt.bindFramebuffer(We.READ_FRAMEBUFFER,null),Dt.bindFramebuffer(We.DRAW_FRAMEBUFFER,null)}else if(at!==0||pe.isRenderTargetTexture||an.has(pe)){const mo=an.get(pe),Ui=an.get(nt);Dt.bindFramebuffer(We.READ_FRAMEBUFFER,cr),Dt.bindFramebuffer(We.DRAW_FRAMEBUFFER,qn);for(let Ii=0;Ii<ln;Ii++)Cr?We.framebufferTextureLayer(We.READ_FRAMEBUFFER,We.COLOR_ATTACHMENT0,mo.__webglTexture,at,_n+Ii):We.framebufferTexture2D(We.READ_FRAMEBUFFER,We.COLOR_ATTACHMENT0,We.TEXTURE_2D,mo.__webglTexture,at),po?We.framebufferTextureLayer(We.DRAW_FRAMEBUFFER,We.COLOR_ATTACHMENT0,Ui.__webglTexture,Kt,hr+Ii):We.framebufferTexture2D(We.DRAW_FRAMEBUFFER,We.COLOR_ATTACHMENT0,We.TEXTURE_2D,Ui.__webglTexture,Kt),at!==0?We.blitFramebuffer(Nt,zn,fn,Qt,Rn,jn,fn,Qt,We.COLOR_BUFFER_BIT,We.NEAREST):po?We.copyTexSubImage3D(Jr,Kt,Rn,jn,hr+Ii,Nt,zn,fn,Qt):We.copyTexSubImage2D(Jr,Kt,Rn,jn,Nt,zn,fn,Qt);Dt.bindFramebuffer(We.READ_FRAMEBUFFER,null),Dt.bindFramebuffer(We.DRAW_FRAMEBUFFER,null)}else po?pe.isDataTexture||pe.isData3DTexture?We.texSubImage3D(Jr,Kt,Rn,jn,hr,fn,Qt,ln,Zn,Hn,dr.data):nt.isCompressedArrayTexture?We.compressedTexSubImage3D(Jr,Kt,Rn,jn,hr,fn,Qt,ln,Zn,dr.data):We.texSubImage3D(Jr,Kt,Rn,jn,hr,fn,Qt,ln,Zn,Hn,dr):pe.isDataTexture?We.texSubImage2D(We.TEXTURE_2D,Kt,Rn,jn,fn,Qt,Zn,Hn,dr.data):pe.isCompressedTexture?We.compressedTexSubImage2D(We.TEXTURE_2D,Kt,Rn,jn,dr.width,dr.height,Zn,dr.data):We.texSubImage2D(We.TEXTURE_2D,Kt,Rn,jn,fn,Qt,Zn,Hn,dr);We.pixelStorei(We.UNPACK_ROW_LENGTH,wr),We.pixelStorei(We.UNPACK_IMAGE_HEIGHT,Wo),We.pixelStorei(We.UNPACK_SKIP_PIXELS,Ms),We.pixelStorei(We.UNPACK_SKIP_ROWS,Ao),We.pixelStorei(We.UNPACK_SKIP_IMAGES,Dl),Kt===0&&nt.generateMipmaps&&We.generateMipmap(Jr),Dt.unbindTexture()},this.copyTextureToTexture3D=function(pe,nt,vt=null,ft=null,at=0){return dw('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(pe,nt,vt,ft,at)},this.initRenderTarget=function(pe){an.get(pe).__webglFramebuffer===void 0&&Le.setupRenderTarget(pe)},this.initTexture=function(pe){pe.isCubeTexture?Le.setTextureCube(pe,0):pe.isData3DTexture?Le.setTexture3D(pe,0):pe.isDataArrayTexture||pe.isCompressedArrayTexture?Le.setTexture2DArray(pe,0):Le.setTexture2D(pe,0),Dt.unbindTexture()},this.resetState=function(){V=0,q=0,Q=null,Dt.reset(),$e.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Kc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const n=this.getContext();n.drawingBufferColorSpace=Er._getDrawingBufferColorSpace(t),n.unpackColorSpace=Er._getUnpackColorSpace()}}/*!
 * Photo Sphere Viewer 5.13.4
 * @copyright 2014-2015 Jérémy Heleine
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var WEe=Object.defineProperty,DL=(e,t)=>{for(var n in t)WEe(e,n,{get:t[n],enumerable:!0})},Ag={};DL(Ag,{ACTIONS:()=>rH,ANIMATION_MIN_DURATION:()=>EI,CAPTURE_EVENTS_CLASS:()=>cx,CTRLZOOM_TIMEOUT:()=>nH,DBLCLICK_DELAY:()=>Q9,EASINGS:()=>pw,ICONS:()=>kl,IDS:()=>Uo,KEY_CODES:()=>Co,LONGTOUCH_DELAY:()=>eH,MOVE_THRESHOLD:()=>J9,SPHERE_RADIUS:()=>Ff,TWOFINGERSOVERLAY_DELAY:()=>tH,VIEWER_DATA:()=>Wh});var qEe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>
`,XEe='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',ZEe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>
`,YEe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,KEe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,JEe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>
`,QEe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kunák from the Noun Project--></svg>
`,eTe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,tTe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,EI=500,J9=4,Q9=300,eH=500,tH=100,nH=2e3,Ff=10,Wh="photoSphereViewer",cx="psv--capture-event",rH=(e=>(e.ROTATE_UP="ROTATE_UP",e.ROTATE_DOWN="ROTATE_DOWN",e.ROTATE_RIGHT="ROTATE_RIGHT",e.ROTATE_LEFT="ROTATE_LEFT",e.ZOOM_IN="ZOOM_IN",e.ZOOM_OUT="ZOOM_OUT",e))(rH||{}),Uo={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},Co={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},kl={arrow:qEe,close:XEe,download:ZEe,fullscreenIn:YEe,fullscreenOut:KEe,info:JEe,menu:QEe,zoomIn:eTe,zoomOut:tTe},pw={linear:e=>e,inQuad:e=>e*e,outQuad:e=>e*(2-e),inOutQuad:e=>e<.5?2*e*e:-1+(4-2*e)*e,inCubic:e=>e*e*e,outCubic:e=>--e*e*e+1,inOutCubic:e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1,inQuart:e=>e*e*e*e,outQuart:e=>1- --e*e*e*e,inOutQuart:e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e,inQuint:e=>e*e*e*e*e,outQuint:e=>1+--e*e*e*e*e,inOutQuint:e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e,inSine:e=>1-Math.cos(e*(Math.PI/2)),outSine:e=>Math.sin(e*(Math.PI/2)),inOutSine:e=>.5-.5*Math.cos(Math.PI*e),inExpo:e=>Math.pow(2,10*(e-1)),outExpo:e=>1-Math.pow(2,-10*e),inOutExpo:e=>(e=e*2-1)<0?.5*Math.pow(2,10*e):1-.5*Math.pow(2,-10*e),inCirc:e=>1-Math.sqrt(1-e*e),outCirc:e=>Math.sqrt(1-(e-1)*(e-1)),inOutCirc:e=>(e*=2)<1?.5-.5*Math.sqrt(1-e*e):.5+.5*Math.sqrt(1-(e-=2)*e)},Dn={};DL(Dn,{Animation:()=>MS,Dynamic:()=>G0,MultiDynamic:()=>EH,PressHandler:()=>hC,Slider:()=>PH,SliderDirection:()=>TH,addClasses:()=>zL,angle:()=>oH,applyEulerInverse:()=>RI,checkClosedShadowDom:()=>MH,checkStylesheet:()=>SH,checkVersion:()=>UL,cleanCssPosition:()=>bH,clone:()=>lC,createTexture:()=>II,cssPositionIsOrdered:()=>BL,dasherize:()=>sTe,deepEqual:()=>yH,deepmerge:()=>gH,distance:()=>iH,exitFullscreen:()=>pH,firstNonNull:()=>oh,getAbortError:()=>PI,getAngle:()=>aH,getClosest:()=>cH,getConfigParser:()=>uC,getElement:()=>lH,getEventTarget:()=>xS,getMatchingTarget:()=>uH,getPosition:()=>hH,getShortestArc:()=>sH,getStyleProperty:()=>lc,getTouchData:()=>TI,getXMPValue:()=>aa,greatArcDistance:()=>rTe,hasParent:()=>oTe,invertResolvableBoolean:()=>cC,isAbortError:()=>xH,isEmpty:()=>vH,isExtendedPosition:()=>NL,isFullscreenEnabled:()=>dH,isNil:()=>Eo,isPlainObject:()=>OL,logWarn:()=>$o,mergePanoData:()=>CH,parseAngle:()=>nc,parsePoint:()=>aTe,parseSpeed:()=>wH,removeClasses:()=>iTe,requestFullscreen:()=>fH,resolveBoolean:()=>FL,speedToDuration:()=>AI,sum:()=>nTe,throttle:()=>mH,toggleClass:()=>aC,wrap:()=>vy});function vy(e,t){let n=e%t;return n<0&&(n+=t),n}function nTe(e){return e.reduce((t,n)=>t+n,0)}function iH(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function oH(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function sH(e,t){return[0,Math.PI*2,-Math.PI*2].reduce((r,i)=>{const a=t-e+i;return Math.abs(a)<Math.abs(r)?a:r},1/0)}function aH(e,t){return Math.acos(Math.cos(e.pitch)*Math.cos(t.pitch)*Math.cos(e.yaw-t.yaw)+Math.sin(e.pitch)*Math.sin(t.pitch))}function rTe([e,t],[n,r]){e-n>Math.PI?e-=2*Math.PI:e-n<-Math.PI&&(e+=2*Math.PI);const i=(n-e)*Math.cos((t+r)/2),a=r-t;return Math.sqrt(i*i+a*a)}function lH(e){return typeof e=="string"?e.match(/^[a-z]/i)?document.getElementById(e):document.querySelector(e):e}function aC(e,t,n){n===void 0?e.classList.toggle(t):n?e.classList.add(t):n||e.classList.remove(t)}function zL(e,t){e.classList.add(...t.split(" ").filter(n=>!!n))}function iTe(e,t){e.classList.remove(...t.split(" ").filter(n=>!!n))}function oTe(e,t){let n=e;do{if(n===t)return!0;n=n.parentElement}while(n);return!1}function cH(e,t){if(!(e!=null&&e.matches))return null;let n=e;do{if(n.matches(t))return n;n=n.parentElement}while(n);return null}function xS(e){return(e==null?void 0:e.composedPath()[0])||null}function uH(e,t){return e?e.composedPath().find(n=>!(n instanceof HTMLElement)&&!(n instanceof SVGElement)?!1:n.matches(t)):null}function hH(e){let t=0,n=0,r=e;for(;r;)t+=r.offsetLeft-r.scrollLeft+r.clientLeft,n+=r.offsetTop-r.scrollTop+r.clientTop,r=r.offsetParent;return t-=window.scrollX,n-=window.scrollY,{x:t,y:n}}function lc(e,t){return window.getComputedStyle(e).getPropertyValue(t)}function TI(e){if(e.touches.length<2)return null;const t={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:e.touches[1].clientX,y:e.touches[1].clientY};return{distance:iH(t,n),angle:oH(t,n),center:{x:(t.x+n.x)/2,y:(t.y+n.y)/2}}}var bS;function dH(e,t=!1){return t?e===bS:document.fullscreenElement===e}function fH(e,t=!1){t?(bS=e,e.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):e.requestFullscreen()}function pH(e=!1){e?(bS.classList.remove("psv-fullscreen-emulation"),bS=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function sTe(e){return e.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(t,n)=>(n>0?"-":"")+t.toLowerCase())}function mH(e,t){let n=!1;return function(...r){n||(n=!0,setTimeout(()=>{e.apply(this,r),n=!1},t))}}function OL(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function gH(e,t){const n=t;return function r(i,a){return Array.isArray(a)?(!i||!Array.isArray(i)?i=[]:i.length=0,a.forEach((c,s)=>{i[s]=r(null,c)})):typeof a=="object"?((!i||Array.isArray(i))&&(i={}),Object.keys(a).forEach(c=>{c!=="__proto__"&&(typeof a[c]!="object"||!a[c]||!OL(a[c])?i[c]=a[c]:a[c]!==n&&(i[c]?r(i[c],a[c]):i[c]=r(null,a[c])))})):i=a,i}(e,t)}function lC(e){return gH(null,e)}function vH(e){return!e||Object.keys(e).length===0&&e.constructor===Object}function Eo(e){return e==null}function oh(...e){for(const t of e)if(!Eo(t))return t;return null}function yH(e,t){if(e===t)return!0;if(tB(e)&&tB(t)){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n of Object.keys(e))if(!yH(e[n],t[n]))return!1;return!0}else return!1}function tB(e){return typeof e=="object"&&e!==null}var Sn=class _H extends Error{constructor(t,n){var r;super(n&&n instanceof Error?`${t}: ${n.message}`:t),this.name="PSVError",(r=Error.captureStackTrace)==null||r.call(Error,this,_H)}};function FL(e,t){OL(e)?(t(e.initial,!0),e.promise.then(n=>t(n,!1))):t(e,!0)}function cC(e){return{initial:!e.initial,promise:e.promise.then(t=>!t)}}function PI(){const e=new Error("Loading was aborted.");return e.name="AbortError",e}function xH(e){return(e==null?void 0:e.name)==="AbortError"}function $o(e){console.warn(`PhotoSphereViewer: ${e}`)}function NL(e){return!e||Array.isArray(e)?!1:[["textureX","textureY"],["yaw","pitch"]].some(([t,n])=>e[t]!==void 0&&e[n]!==void 0)}function aa(e,t,n=!0){let r=e.match("<GPano:"+t+">(.*)</GPano:"+t+">");if(r!==null){const i=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(i)?null:i}if(r=e.match("GPano:"+t+'="(.*?)"'),r!==null){const i=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(i)?null:i}return null}var nB={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},wS=["left","center","right"],SS=["top","center","bottom"],rB=[...wS,...SS],za="center";function aTe(e){if(!e)return{x:.5,y:.5};if(typeof e=="object")return e;let t=e.toLocaleLowerCase().split(" ").slice(0,2);t.length===1&&(nB[t[0]]?t=[t[0],za]:t=[t[0],t[0]]);const n=t[1]!=="left"&&t[1]!=="right"&&t[0]!=="top"&&t[0]!=="bottom";t=t.map(i=>nB[i]||i),n||t.reverse();const r=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return r?{x:parseFloat(r[1])/100,y:parseFloat(r[2])/100}:{x:.5,y:.5}}function bH(e,{allowCenter:t,cssOrder:n}={allowCenter:!0,cssOrder:!0}){return e?(typeof e=="string"&&(e=e.split(" ")),e.length===1&&(e[0]===za?e=[za,za]:wS.indexOf(e[0])!==-1?e=[za,e[0]]:SS.indexOf(e[0])!==-1&&(e=[e[0],za])),e.length!==2||rB.indexOf(e[0])===-1||rB.indexOf(e[1])===-1?($o(`Unparsable position ${e}`),null):!t&&e[0]===za&&e[1]===za?($o("Invalid position center center"),null):(n&&!BL(e)&&(e=[e[1],e[0]]),e[1]===za&&wS.indexOf(e[0])!==-1&&(e=[za,e[0]]),e[0]===za&&SS.indexOf(e[1])!==-1&&(e=[e[1],za]),e)):null}function BL(e){return SS.indexOf(e[0])!==-1&&wS.indexOf(e[1])!==-1}function wH(e){let t;if(typeof e=="string"){const n=e.toString().trim();let r=parseFloat(n.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const i=n.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(i.match(/(pm|per minute)$/)&&(r/=60),i){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=pr.degToRad(r);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":t=r;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=r*Math.PI*2;break;default:throw new Sn(`Unknown speed unit "${i}"`)}}else t=e;return t}function AI(e,t){if(typeof e!="number"){const n=wH(e);return t/Math.abs(n)*1e3}else return Math.abs(e)}function nc(e,t=!1,n=t){let r;if(typeof e=="string"){const i=e.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!i)throw new Sn(`Unknown angle "${e}"`);const a=parseFloat(i[1]),c=i[2];if(c)switch(c){case"deg":case"degs":r=pr.degToRad(a);break;case"rad":case"rads":r=a;break;default:throw new Sn(`Unknown angle unit "${c}"`)}else r=a}else if(typeof e=="number"&&!isNaN(e))r=e;else throw new Sn(`Unknown angle "${e}"`);return r=vy(t?r+Math.PI:r,Math.PI*2),t?pr.clamp(r-Math.PI,-Math.PI/(n?2:1),Math.PI/(n?2:1)):r}function II(e,t=!1){const n=new jo(e);return n.needsUpdate=!0,n.minFilter=t?vh:va,n.generateMipmaps=t,n.anisotropy=t?2:1,n}var iB=new id;function RI(e,t){iB.setFromEuler(t).invert(),e.applyQuaternion(iB)}function uC(e,t){const n=function(r){const i=lC({...e,...r}),a={};for(let[c,s]of Object.entries(i)){if(t&&c in t)s=t[c](s,{rawConfig:i,defValue:e[c]});else if(!(c in e)){$o(`Unknown option ${c}`);continue}a[c]=s}return a};return n.defaults=e,n.parsers=t||{},n}function SH(e,t){lc(e,`--psv-${t}-loaded`)!=="true"&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${t}/index.css" is not loaded`)}function UL(e,t,n){t&&t!==n&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${e} is in version ${t} but @photo-sphere-viewer/core is in version ${n}`)}function MH(e){do{if(e instanceof ShadowRoot&&e.mode==="closed"){console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");return}e=e.parentNode}while(e)}function CH(e,t,n,r){const i={isEquirectangular:!0,fullWidth:oh(n==null?void 0:n.fullWidth,r==null?void 0:r.fullWidth),fullHeight:oh(n==null?void 0:n.fullHeight,r==null?void 0:r.fullHeight),croppedWidth:e,croppedHeight:t,croppedX:oh(n==null?void 0:n.croppedX,r==null?void 0:r.croppedX),croppedY:oh(n==null?void 0:n.croppedY,r==null?void 0:r.croppedY),poseHeading:oh(n==null?void 0:n.poseHeading,r==null?void 0:r.poseHeading,0),posePitch:oh(n==null?void 0:n.posePitch,r==null?void 0:r.posePitch,0),poseRoll:oh(n==null?void 0:n.poseRoll,r==null?void 0:r.poseRoll,0),initialHeading:r==null?void 0:r.initialHeading,initialPitch:r==null?void 0:r.initialPitch,initialFov:r==null?void 0:r.initialFov};return!i.fullWidth&&!i.fullHeight&&(i.fullWidth=Math.max(e,t*2),i.fullHeight=Math.round(i.fullWidth/2)),i.fullWidth||(i.fullWidth=i.fullHeight*2),i.fullHeight||(i.fullHeight=Math.round(i.fullWidth/2)),i.croppedX===null&&(i.croppedX=Math.round((i.fullWidth-e)/2)),i.croppedY===null&&(i.croppedY=Math.round((i.fullHeight-t)/2)),Math.abs(i.fullWidth-i.fullHeight*2)>1&&($o("Invalid panoData, fullWidth should be twice fullHeight"),i.fullHeight=Math.round(i.fullWidth/2)),i.croppedX+i.croppedWidth>i.fullWidth&&($o("Invalid panoData, croppedX + croppedWidth > fullWidth"),i.croppedX=i.fullWidth-i.croppedWidth),i.croppedY+i.croppedHeight>i.fullHeight&&($o("Invalid panoData, croppedY + croppedHeight > fullHeight"),i.croppedY=i.fullHeight-i.croppedHeight),i.croppedX<0&&($o("Invalid panoData, croppedX < 0"),i.croppedX=0),i.croppedY<0&&($o("Invalid panoData, croppedY < 0"),i.croppedY=0),i}var MS=class{constructor(e){this.easing=pw.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=e,e?(e.easing&&(this.easing=typeof e.easing=="function"?e.easing:pw[e.easing]||pw.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(t=>this.__run(t))},e.delay||0)):this.resolved=!0}__run(e){if(this.cancelled)return;this.start||(this.start=e);const t=(e-this.start)/this.options.duration,n={};if(t<1){for(const[r,i]of Object.entries(this.options.properties))if(i){const a=i.start+(i.end-i.start)*this.easing(t);n[r]=a}this.options.onTick(n,t),this.animationFrame=window.requestAnimationFrame(r=>this.__run(r))}else{for(const[r,i]of Object.entries(this.options.properties))i&&(n[r]=i.end);this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(e){e?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(t=>t(e)),this.callbacks.length=0}then(e){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(e):new Promise(t=>{this.callbacks.push(t)}).then(e)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},G0=class{constructor(e,t){if(this.fn=e,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=t.min,this.max=t.max,this.wrap=t.wrap,this.current=t.defaultValue,this.wrap&&this.min!==0)throw new Sn("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(e){this.__current=e}setSpeed(e){this.speed=e}goto(e,t=1){this.mode=2,this.target=this.wrap?vy(e,this.max):pr.clamp(e,this.min,this.max),this.speedMult=t}step(e,t=1){t===0?this.setValue(this.current+e):(this.mode!==2&&(this.target=this.current),this.goto(this.target+e,t))}roll(e=!1,t=1){this.mode=1,this.target=e?-1/0:1/0,this.speedMult=t}stop(){this.mode=0}setValue(e){return this.target=this.wrap?vy(e,this.max):pr.clamp(e,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current?(this.current=this.target,this.fn&&this.fn(this.current),!0):!1}update(e){if(this.mode===2){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const r=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=r&&(this.mode=0)}let t=this.mode===0?0:this.speed*this.speedMult;this.target<this.current&&(t=-t),this.currentSpeed<t?this.currentSpeed=Math.min(t,this.currentSpeed+e/1e3*this.speed*this.speedMult*2):this.currentSpeed>t&&(this.currentSpeed=Math.max(t,this.currentSpeed-e/1e3*this.speed*this.speedMult*2));let n=null;return this.current>this.target&&this.currentSpeed?n=Math.max(this.target,this.current+this.currentSpeed*e/1e3):this.current<this.target&&this.currentSpeed&&(n=Math.min(this.target,this.current+this.currentSpeed*e/1e3)),n!==null&&(n=this.wrap?vy(n,this.max):pr.clamp(n,this.min,this.max),n!==this.current)?(this.current=n,this.fn&&this.fn(this.current),!0):!1}},EH=class{constructor(e,t){this.fn=e,this.dynamics=t,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((e,[t,n])=>(e[t]=n.current,e),{})}setSpeed(e){for(const t of Object.values(this.dynamics))t.setSpeed(e)}goto(e,t=1){for(const[n,r]of Object.entries(e))this.dynamics[n].goto(r,t)}step(e,t=1){if(t===0)this.setValue(Object.keys(e).reduce((n,r)=>(n[r]=e[r]+this.dynamics[r].current,n),{}));else for(const[n,r]of Object.entries(e))this.dynamics[n].step(r,t)}roll(e,t=1){for(const[n,r]of Object.entries(e))this.dynamics[n].roll(r,t)}stop(){for(const e of Object.values(this.dynamics))e.stop()}setValue(e){let t=!1;for(const[n,r]of Object.entries(e))t=this.dynamics[n].setValue(r)||t;return t&&this.fn&&this.fn(this.current),t}update(e){let t=!1;for(const n of Object.values(this.dynamics))t=n.update(e)||t;return t&&this.fn&&this.fn(this.current),t}},hC=class{constructor(e=200){this.delay=e,this.time=0,this.delay=e}get pending(){return this.time!==0}down(e){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime(),this.data=e}up(e){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{e(this.data),this.timeout=void 0,this.time=0,this.data=void 0},this.delay):(e(this.data),this.time=0,this.data=void 0)}},TH=(e=>(e.VERTICAL="VERTICAL",e.HORIZONTAL="HORIZONTAL",e))(TH||{}),PH=class{constructor(e,t,n){this.container=e,this.direction=t,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return this.direction==="VERTICAL"}get isHorizontal(){return this.direction==="HORIZONTAL"}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(e){switch(e.type){case"click":e.stopPropagation();break;case"mousedown":this.__onMouseDown(e);break;case"mouseenter":this.__onMouseEnter(e);break;case"mouseleave":this.__onMouseLeave(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e);break}}__onMouseDown(e){this.mousedown=!0,this.__update(e.clientX,e.clientY,!0)}__onMouseEnter(e){this.mouseover=!0,this.__update(e.clientX,e.clientY,!0)}__onTouchStart(e){this.mouseover=!0,this.mousedown=!0;const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}__onMouseMove(e){(this.mousedown||this.mouseover)&&(e.stopPropagation(),this.__update(e.clientX,e.clientY,!0))}__onTouchMove(e){if(this.mousedown||this.mouseover){e.stopPropagation();const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}}__onMouseUp(e){this.mousedown&&(this.mousedown=!1,this.__update(e.clientX,e.clientY,!1))}__onMouseLeave(e){this.mouseover&&(this.mouseover=!1,this.__update(e.clientX,e.clientY,!0))}__onTouchEnd(e){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!1)}}__update(e,t,n){const r=this.container.getBoundingClientRect();let i;this.isVertical?i=pr.clamp((r.bottom-t)/r.height,0,1):i=pr.clamp((e-r.left)/r.width,0,1),this.listener({value:i,click:!n,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:e,clientY:t}})}},Fn={};DL(Fn,{BeforeAnimateEvent:()=>$L,BeforeRenderEvent:()=>yy,BeforeRotateEvent:()=>OH,ClickEvent:()=>BH,ConfigChangedEvent:()=>js,DoubleClickEvent:()=>HH,FullscreenEvent:()=>_y,HideNotificationEvent:()=>xy,HideOverlayEvent:()=>KH,HidePanelEvent:()=>Ih,HideTooltipEvent:()=>n7,KeypressEvent:()=>Rh,LoadProgressEvent:()=>a7,ObjectEnterEvent:()=>W7,ObjectEvent:()=>dC,ObjectHoverEvent:()=>K7,ObjectLeaveEvent:()=>LI,PanoramaErrorEvent:()=>m7,PanoramaLoadEvent:()=>u7,PanoramaLoadedEvent:()=>ig,PositionUpdatedEvent:()=>by,ReadyEvent:()=>Sy,RenderEvent:()=>T7,RollUpdatedEvent:()=>wy,ShowNotificationEvent:()=>My,ShowOverlayEvent:()=>L7,ShowPanelEvent:()=>Lh,ShowTooltipEvent:()=>F7,SizeUpdatedEvent:()=>Cy,StopAllEvent:()=>Ey,TransitionDoneEvent:()=>y7,ViewerEvent:()=>Ur,ZoomUpdatedEvent:()=>eu});var ux=class extends Event{constructor(e,t=!1){super(e,{cancelable:t})}},AH=class extends EventTarget{dispatchEvent(e){return super.dispatchEvent(e)}addEventListener(e,t,n){super.addEventListener(e,t,n)}removeEventListener(e,t,n){super.removeEventListener(e,t,n)}},Ur=class extends ux{},IH=class RH extends Ur{constructor(t,n){super(RH.type,!0),this.position=t,this.zoomLevel=n}};IH.type="before-animate";var $L=IH,LH=class kH extends Ur{constructor(t,n){super(kH.type),this.timestamp=t,this.elapsed=n}};LH.type="before-render";var yy=LH,DH=class zH extends Ur{constructor(t){super(zH.type,!0),this.position=t}};DH.type="before-rotate";var OH=DH,FH=class NH extends Ur{constructor(t){super(NH.type),this.data=t}};FH.type="click";var BH=FH,UH=class $H extends Ur{constructor(t){super($H.type),this.options=t}containsOptions(...t){return t.some(n=>this.options.includes(n))}};UH.type="config-changed";var js=UH,VH=class jH extends Ur{constructor(t){super(jH.type),this.data=t}};VH.type="dblclick";var HH=VH,GH=class WH extends Ur{constructor(t){super(WH.type),this.fullscreenEnabled=t}};GH.type="fullscreen";var _y=GH,qH=class XH extends Ur{constructor(t){super(XH.type),this.notificationId=t}};qH.type="hide-notification";var xy=qH,ZH=class YH extends Ur{constructor(t){super(YH.type),this.overlayId=t}};ZH.type="hide-overlay";var KH=ZH,JH=class QH extends Ur{constructor(t){super(QH.type),this.panelId=t}};JH.type="hide-panel";var Ih=JH,e7=class t7 extends Ur{constructor(t){super(t7.type),this.tooltipData=t}};e7.type="hide-tooltip";var n7=e7,r7=class i7 extends Ur{constructor(t,n){super(i7.type,!0),this.key=t,this.originalEvent=n}};r7.type="key-press";var Rh=r7,o7=class s7 extends Ur{constructor(t){super(s7.type),this.progress=t}};o7.type="load-progress";var a7=o7,l7=class c7 extends Ur{constructor(t){super(c7.type),this.panorama=t}};l7.type="panorama-load";var u7=l7,h7=class d7 extends Ur{constructor(t){super(d7.type),this.data=t}};h7.type="panorama-loaded";var ig=h7,f7=class p7 extends Ur{constructor(t,n){super(p7.type),this.panorama=t,this.error=n}};f7.type="panorama-error";var m7=f7,g7=class v7 extends Ur{constructor(t){super(v7.type),this.completed=t}};g7.type="transition-done";var y7=g7,_7=class x7 extends Ur{constructor(t){super(x7.type),this.position=t}};_7.type="position-updated";var by=_7,b7=class w7 extends Ur{constructor(t){super(w7.type),this.roll=t}};b7.type="roll-updated";var wy=b7,S7=class M7 extends Ur{constructor(){super(M7.type)}};S7.type="ready";var Sy=S7,C7=class E7 extends Ur{constructor(){super(E7.type)}};C7.type="render";var T7=C7,P7=class A7 extends Ur{constructor(t){super(A7.type),this.notificationId=t}};P7.type="show-notification";var My=P7,I7=class R7 extends Ur{constructor(t){super(R7.type),this.overlayId=t}};I7.type="show-overlay";var L7=I7,k7=class D7 extends Ur{constructor(t){super(D7.type),this.panelId=t}};k7.type="show-panel";var Lh=k7,z7=class O7 extends Ur{constructor(t,n){super(O7.type),this.tooltip=t,this.tooltipData=n}};z7.type="show-tooltip";var F7=z7,N7=class B7 extends Ur{constructor(t){super(B7.type),this.size=t}};N7.type="size-updated";var Cy=N7,U7=class $7 extends Ur{constructor(){super($7.type)}};U7.type="stop-all";var Ey=U7,V7=class j7 extends Ur{constructor(t){super(j7.type),this.zoomLevel=t}};V7.type="zoom-updated";var eu=V7,dC=class extends Ur{constructor(e,t,n,r,i){super(e),this.originalEvent=t,this.object=n,this.viewerPoint=r,this.userDataKey=i}},H7=class G7 extends dC{constructor(t,n,r,i){super(G7.type,t,n,r,i)}};H7.type="enter-object";var W7=H7,q7=class X7 extends dC{constructor(t,n,r,i){super(X7.type,t,n,r,i)}};q7.type="leave-object";var LI=q7,Z7=class Y7 extends dC{constructor(t,n,r,i){super(Y7.type,t,n,r,i)}};Z7.type="hover-object";var K7=Z7,fC=class{constructor(e){this.viewer=e}init(){}destroy(){}supportsTransition(e){return!1}supportsPreload(e){return!1}textureCoordsToSphericalCoords(e,t){throw new Sn("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(e,t){throw new Sn("Current adapter does not support texture coordinates.")}};fC.supportsDownload=!1;function oB(e){if(e){for(const[,t]of[["_",e],...Object.entries(e)])if(t.prototype instanceof fC)return UL(t.id,t.VERSION,"5.13.4"),t}return null}var T0=`${Wh}_touchSupport`,vs={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return this.__maxCanvasWidth===null&&(this.__maxCanvasWidth=uTe(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const e=lTe();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!e,this.maxTextureWidth=e?e.getParameter(e.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=cTe(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!vs.isWebGLSupported)throw new Sn("WebGL 2 is not supported.");if(vs.maxTextureWidth===0)throw new Sn("Unable to detect system capabilities")}};function lTe(){try{return document.createElement("canvas").getContext("webgl2")}catch{return null}}function cTe(){let e="ontouchstart"in window||navigator.maxTouchPoints>0;T0 in localStorage&&(e=localStorage[T0]==="true");const t=new Promise(n=>{const r=()=>{window.removeEventListener("mousedown",i),window.removeEventListener("touchstart",a),clearTimeout(s)},i=()=>{r(),localStorage[T0]=!1,n(!1)},a=()=>{r(),localStorage[T0]=!0,n(!0)},c=()=>{r(),localStorage[T0]=e,n(e)};window.addEventListener("mousedown",i,!1),window.addEventListener("touchstart",a,!1);const s=setTimeout(c,1e4)});return{initial:e,promise:t}}function uTe(e){let t=e,n=!1;const r=document.createElement("canvas"),i=r.getContext("2d");for(r.width=1,r.height=1;t>1024&&!n;){const a=document.createElement("canvas"),c=a.getContext("2d");a.width=t,a.height=t/2;try{c.fillStyle="white",c.fillRect(t-1,t/2-1,1,1),i.drawImage(a,t-1,t/2-1,1,1,0,0,1,1),i.getImageData(0,0,1,1).data[0]>0&&(n=!0)}catch{}a.width=0,a.height=0,n||(t/=2)}if(n)return t;throw new Sn("Unable to detect system capabilities")}var hTe=uC({resolution:64,useXmpData:!0,blur:!1},{resolution:e=>{if(!e||!pr.isPowerOfTwo(e))throw new Sn("EquirectangularAdapter resolution must be power of two.");return e}}),pC=class J7 extends fC{static withConfig(t){return[J7,t]}constructor(t,n){super(t),this.config=hTe(n),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(t,n){if(Eo(t.textureX)||Eo(t.textureY))throw new Sn("Texture position is missing 'textureX' or 'textureY'");const r=(t.textureX+n.croppedX)/n.fullWidth*Math.PI*2,i=(t.textureY+n.croppedY)/n.fullHeight*Math.PI;return{yaw:r>=Math.PI?r-Math.PI:r+Math.PI,pitch:Math.PI/2-i}}sphericalCoordsToTextureCoords(t,n){const r=t.yaw/Math.PI/2*n.fullWidth,i=t.pitch/Math.PI*n.fullHeight;let a=Math.round(t.yaw<Math.PI?r+n.fullWidth/2:r-n.fullWidth/2)-n.croppedX,c=Math.round(n.fullHeight/2-i)-n.croppedY;return(a<0||a>n.croppedWidth||c<0||c>n.croppedHeight)&&(a=c=void 0),{textureX:a,textureY:c}}async loadTexture(t,n=!0,r,i=this.config.useXmpData){if(typeof t!="string"&&(typeof t!="object"||!t.path))return Promise.reject(new Sn("Invalid panorama url, are you using the right adapter?"));let a;typeof t=="string"?a={path:t,data:r}:a={data:r,...t};const c=await this.viewer.textureLoader.loadFile(a.path,n?x=>this.viewer.textureLoader.dispatchProgress(x):null,a.path),s=i?await this.loadXMP(c):null,f=await this.viewer.textureLoader.blobToImage(c);typeof a.data=="function"&&(a.data=a.data(f,s));const g=CH(f.width,f.height,a.data,s),_=this.createEquirectangularTexture(f);return{panorama:t,texture:_,panoData:g,cacheKey:a.path}}async loadXMP(t){const n=await this.loadBlobAsString(t),r=n.indexOf("<x:xmpmeta");if(r===-1)return null;const i=n.indexOf("</x:xmpmeta>",r);if(i===-1)return null;const a=n.substring(r,i);return a.includes("GPano:")?{fullWidth:aa(a,"FullPanoWidthPixels"),fullHeight:aa(a,"FullPanoHeightPixels"),croppedWidth:aa(a,"CroppedAreaImageWidthPixels"),croppedHeight:aa(a,"CroppedAreaImageHeightPixels"),croppedX:aa(a,"CroppedAreaLeftPixels"),croppedY:aa(a,"CroppedAreaTopPixels"),poseHeading:aa(a,"PoseHeadingDegrees",!1),posePitch:aa(a,"PosePitchDegrees",!1),poseRoll:aa(a,"PoseRollDegrees",!1),initialHeading:aa(a,"InitialViewHeadingDegrees",!1),initialPitch:aa(a,"InitialViewPitchDegrees",!1),initialFov:aa(a,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(t){return new Promise((n,r)=>{const i=new FileReader;i.onload=()=>n(i.result),i.onerror=r,i.readAsText(t)})}createEquirectangularTexture(t){if(this.config.blur||t.width>vs.maxTextureWidth){const n=Math.min(1,vs.maxCanvasWidth/t.width),r=new OffscreenCanvas(Math.floor(t.width*n),Math.floor(t.height*n)),i=r.getContext("2d");return this.config.blur&&(i.filter=`blur(${r.width/2048}px)`),i.drawImage(t,0,0,r.width,r.height),II(r)}return II(t)}createMesh(t){const n=t.croppedX/t.fullWidth*2*Math.PI,r=t.croppedWidth/t.fullWidth*2*Math.PI,i=t.croppedY/t.fullHeight*Math.PI,a=t.croppedHeight/t.fullHeight*Math.PI,c=new Vg(Ff,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*r),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*a),-Math.PI/2+n,r,i,a).scale(-1,1,1),s=new Gh({depthTest:!1,depthWrite:!1});return new Os(c,s)}setTexture(t,n){t.material.map=n.texture}setTextureOpacity(t,n){t.material.opacity=n,t.material.transparent=n<1}disposeTexture({texture:t}){t.dispose()}disposeMesh(t){t.geometry.dispose(),t.material.dispose()}};pC.id="equirectangular";pC.VERSION="5.13.4";pC.supportsDownload=!0;var VL=pC,Q7=class eG extends VL{static withConfig(t){return[eG,t]}constructor(t,n){super(t,{resolution:(n==null?void 0:n.resolution)??64,useXmpData:!1})}async loadTexture(t,n){const r=await super.loadTexture(t,n,null,!1);return r.panoData=null,r}createMesh(){const t=new Vg(Ff,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),n=t.getAttribute("uv"),r=t.getAttribute("normal");for(let a=0;a<n.count;a++)for(let c=0;c<3;c++){const s=a*3+c,f=r.getX(s),g=r.getY(s),_=r.getZ(s),x=.947;if(a<n.count/6){const C=f===0&&_===0?1:Math.acos(g)/Math.sqrt(f*f+_*_)*(2/Math.PI);n.setXY(s,f*(x/4)*C+1/4,_*(x/2)*C+1/2)}else{const C=f===0&&_===0?1:Math.acos(-g)/Math.sqrt(f*f+_*_)*(2/Math.PI);n.setXY(s,-f*(x/4)*C+3/4,_*(x/2)*C+1/2)}}t.rotateX(-Math.PI/2),t.rotateY(Math.PI);const i=new Gh({depthTest:!1,depthWrite:!1});return new Os(t,i)}};Q7.id="dual-fisheye";Q7.VERSION="5.13.4";var od=class tG{constructor(t,n){this.parent=t,this.children=[],this.state={visible:!0},this.viewer=t instanceof tG?t.viewer:t,this.container=document.createElement(n.tagName??"div"),this.container.className=n.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const t=this.parent.children.indexOf(this);t!==-1&&this.parent.children.splice(t,1),this.children.slice().forEach(n=>n.destroy()),this.children.length=0}toggle(t=!this.isVisible()){t?this.show():this.hide()}hide(t){this.container.style.display="none",this.state.visible=!1}show(t){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},dTe=uC({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),_s=class extends od{constructor(e,t){super(e,{tagName:t.tagName,className:`psv-button ${t.hoverScale?"psv-button--hover-scale":""} ${t.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=dTe(t),t.id||(this.config.id=this.constructor.id),t.icon&&this.__setIcon(t.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.viewer.config.lang[this.config.title]??this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),t.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",n=>{this.state.enabled&&this.onClick(),n.stopPropagation()}),this.container.addEventListener("keydown",n=>{n.key===Co.Enter&&this.state.enabled&&(this.onClick(),n.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(e=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),e&&this.viewer.navbar.autoSize())}hide(e=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",e&&this.viewer.navbar.autoSize())}checkSupported(){FL(this.isSupported(),(e,t)=>{this.state&&(this.state.supported=e,t?e||this.hide():this.toggle(e))})}autoSize(){}isSupported(){return!0}toggleActive(e=!this.state.active){e!==this.state.active&&(this.state.active=e,aC(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(e){this.container.innerHTML=e,zL(this.container.querySelector("svg"),"psv-button-svg")}},fTe=class extends _s{constructor(e,t){var n,r;super(e,{id:t.id??`psvButton-${Math.random().toString(36).substring(2)}`,className:`psv-custom-button ${t.className||""}`,hoverScale:!1,collapsable:t.collapsable!==!1,tabbable:t.tabbable!==!1,title:t.title}),this.customOnClick=t.onClick,t.content&&(typeof t.content=="string"?this.container.innerHTML=t.content:(this.container.classList.add("psv-custom-button--no-padding"),t.content.style.height="100%",(r=(n=t.content).attachViewer)==null||r.call(n,this.viewer),this.container.appendChild(t.content))),this.state.width=this.container.offsetWidth,t.disabled&&this.disable(),t.visible===!1&&this.hide()}onClick(){var e;(e=this.customOnClick)==null||e.call(this,this.viewer)}},p_=class extends _s{constructor(e){super(e,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:kl.info}),this.mode=0,this.viewer.addEventListener(xy.type,this),this.viewer.addEventListener(My.type,this),this.viewer.addEventListener(Ih.type,this),this.viewer.addEventListener(Lh.type,this),this.viewer.addEventListener(js.type,this)}destroy(){this.viewer.removeEventListener(xy.type,this),this.viewer.removeEventListener(My.type,this),this.viewer.removeEventListener(Ih.type,this),this.viewer.removeEventListener(Lh.type,this),this.viewer.removeEventListener(js.type,this),super.destroy()}handleEvent(e){if(e instanceof js){e.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let t=!1;e instanceof xy?t=this.mode===1:e instanceof My?t=this.mode===1&&e.notificationId!==Uo.DESCRIPTION:e instanceof Ih?t=this.mode===2:e instanceof Lh&&(t=this.mode===2&&e.panelId!==Uo.DESCRIPTION),t&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(e){super.hide(e),this.mode&&this.__close()}autoSize(e=!1){if(e){const t=this.viewer.navbar.getButton("caption",!1),n=t&&!t.isVisible(),r=!!this.viewer.config.description;n||r?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(Uo.DESCRIPTION);break;case 2:this.viewer.panel.hide(Uo.DESCRIPTION);break}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:Uo.DESCRIPTION,content:`${this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:""}${this.viewer.config.description}`})):(this.mode=1,this.viewer.notification.show({id:Uo.DESCRIPTION,content:this.viewer.config.caption}))}};p_.id="description";var nG=class extends _s{constructor(e){super(e,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:kl.download}),this.viewer.addEventListener(js.type,this),this.viewer.addEventListener(ig.type,this)}destroy(){this.viewer.removeEventListener(js.type,this),this.viewer.removeEventListener(ig.type,this),super.destroy()}handleEvent(e){e instanceof js?(e.containsOptions("downloadUrl")&&this.checkSupported(),e.containsOptions("downloadUrl","downloadName")&&this.__update()):e instanceof ig&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){const e=this.container;e.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,e.target="_blank",e.href.startsWith("data:")&&!this.viewer.config.downloadName?e.download="panorama."+e.href.substring(0,e.href.indexOf(";")).split("/").pop():e.download=this.viewer.config.downloadName||e.href.split("/").pop()}};nG.id="download";var rG=class extends _s{constructor(e){super(e,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:kl.fullscreenIn,iconActive:kl.fullscreenOut}),this.viewer.addEventListener(_y.type,this)}destroy(){this.viewer.removeEventListener(_y.type,this),super.destroy()}handleEvent(e){e instanceof _y&&this.toggleActive(e.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};rG.id="fullscreen";var pTe="psvButton",mTe=(e,t)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${kl.menu} ${t}</h1>
  <ul class="psv-panel-menu-list">
    ${e.map(n=>`
    <li data-psv-button="${n.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${n.content}</span>
      <span class="psv-panel-menu-item-label">${n.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`,mw=class extends _s{constructor(e){super(e,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:kl.menu}),this.viewer.addEventListener(Lh.type,this),this.viewer.addEventListener(Ih.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Lh.type,this),this.viewer.removeEventListener(Ih.type,this),super.destroy()}handleEvent(e){e instanceof Lh?this.toggleActive(e.panelId===Uo.MENU):e instanceof Ih&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(e){super.hide(e),this.__hideMenu()}show(e){super.show(e),this.state.active&&this.__showMenu()}__showMenu(){this.viewer.panel.show({id:Uo.MENU,content:mTe(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:e=>{const t=e?cH(e,".psv-panel-menu-item"):void 0,n=t?t.dataset[pTe]:void 0;n&&(this.viewer.navbar.getButton(n).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(Uo.MENU)}};mw.id="menu";function gTe(e){let t=0;switch(e){case 0:t=90;break;case 1:t=-90;break;case 3:t=180;break;default:t=0;break}return kl.arrow.replace("rotate(0",`rotate(${t}`)}var hx=class extends _s{constructor(e,t){super(e,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:gTe(t)}),this.direction=t,this.handler=new hC,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":e.key===Co.Enter&&this.__onMouseDown();break;case"keyup":e.key===Co.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return cC(vs.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const e={};switch(this.direction){case 0:e.pitch=!1;break;case 1:e.pitch=!0;break;case 3:e.yaw=!1;break;default:e.yaw=!0;break}this.viewer.stopAll(),this.viewer.dynamics.position.roll(e),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};hx.groupId="move";var iG=class extends hx{constructor(e){super(e,1)}};iG.id="moveDown";var oG=class extends hx{constructor(e){super(e,2)}};oG.id="moveLeft";var sG=class extends hx{constructor(e){super(e,3)}};sG.id="moveRight";var aG=class extends hx{constructor(e){super(e,0)}};aG.id="moveUp";var jL=class extends _s{constructor(e,t,n){super(e,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:t}),this.direction=n,this.handler=new hC,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":e.key===Co.Enter&&this.__onMouseDown();break;case"keyup":e.key===Co.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return cC(vs.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(this.direction===1),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};jL.groupId="zoom";var lG=class extends jL{constructor(e){super(e,kl.zoomIn,0)}};lG.id="zoomIn";var cG=class extends jL{constructor(e){super(e,kl.zoomOut,1)}};cG.id="zoomOut";var HL=class extends _s{constructor(e){super(e,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new PH(this.container,"HORIZONTAL",t=>this.__onSliderUpdate(t)),this.mediaMinWidth=parseInt(lc(this.container,"max-width"),10),this.viewer.addEventListener(eu.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(Sy.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(eu.type,this),this.viewer.removeEventListener(Sy.type,this),super.destroy()}handleEvent(e){e instanceof eu?this.__moveZoomValue(e.zoomLevel):e instanceof Sy&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return cC(vs.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(e){this.zoomValue.style.left=e/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(e){e.mousedown&&this.viewer.zoom(e.value*100)}};HL.id="zoomRange";HL.groupId="zoom";var uG=class extends AH{constructor(e){super(),this.viewer=e}init(){}destroy(){}},GL=class extends uG{constructor(e,t){super(e),this.config=this.constructor.configParser(t)}setOption(e,t){this.setOptions({[e]:t})}setOptions(e){const t={...this.config,...e},n=this.constructor,r=n.configParser,i=n.readonlyOptions,a=n.id;for(let[c,s]of Object.entries(e)){if(!(c in r.defaults)){$o(`${a}: Unknown option "${c}"`);continue}if(i.includes(c)){$o(`${a}: Option "${c}" cannot be updated`);continue}c in r.parsers&&(s=r.parsers[c](s,{rawConfig:t,defValue:r.defaults[c]})),this.config[c]=s}}};GL.readonlyOptions=[];function kI(e){if(e){for(const[,t]of[["_",e],...Object.entries(e)])if(t.prototype instanceof uG)return UL(t.id,t.VERSION,"5.13.4"),t}return null}var du={panorama:null,container:null,adapter:[VL,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:()=>!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[Co.ArrowUp]:"ROTATE_UP",[Co.ArrowDown]:"ROTATE_DOWN",[Co.ArrowRight]:"ROTATE_RIGHT",[Co.ArrowLeft]:"ROTATE_LEFT",[Co.PageUp]:"ZOOM_IN",[Co.PageDown]:"ZOOM_OUT",[Co.Plus]:"ZOOM_IN",[Co.Minus]:"ZOOM_OUT"}},sB={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},DI={container:e=>{if(!e)throw new Sn("No value given for container.");return e},adapter:(e,{defValue:t})=>{if(e?Array.isArray(e)?e=[oB(e[0]),e[1]]:e=[oB(e),null]:e=t,!e[0])throw new Sn("An undefined value was given for adapter.");if(!e[0].id)throw new Sn("Adapter has no id.");return e},defaultYaw:e=>nc(e),defaultPitch:e=>nc(e,!0),defaultZoomLvl:e=>pr.clamp(e,0,100),minFov:(e,{rawConfig:t})=>(t.maxFov<e&&($o("maxFov cannot be lower than minFov"),e=t.maxFov),pr.clamp(e,1,179)),maxFov:(e,{rawConfig:t})=>(e<t.minFov&&(e=t.minFov),pr.clamp(e,1,179)),moveInertia:(e,{defValue:t})=>e===!0?t:e===!1?0:e,lang:e=>({...du.lang,...e}),keyboardActions:(e,{rawConfig:t})=>t.keyboard&&typeof t.keyboard=="object"?t.keyboard:e,fisheye:e=>e===!0?1:e===!1?0:e,requestHeaders:e=>e&&typeof e=="object"?()=>e:typeof e=="function"?e:null,withCredentials:e=>typeof e=="boolean"?()=>e:typeof e=="function"?e:()=>!1,defaultTransition:(e,{defValue:t})=>e===null||e.speed===0?null:{...t,...e},rendererParameters:(e,{defValue:t})=>({...e,...t}),plugins:e=>e.map((t,n)=>{if(Array.isArray(t)?t=[kI(t[0]),t[1]]:t=[kI(t),null],!t[0])throw new Sn(`An undefined value was given for plugin ${n}.`);if(!t[0].id)throw new Sn(`Plugin ${n} has no id.`);return t}),navbar:e=>e===!1?null:e===!0?lC(du.navbar):typeof e=="string"?e.split(/[ ,]/):e},vTe=uC(du,DI),Bm=class extends _s{constructor(e){super(e,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(e){this.show(),this.contentElt.innerHTML=e??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){var e;(e=this.viewer.navbar.getButton(p_.id,!1))==null||e.autoSize(!0)}};Bm.id="caption";var zI={},CS={};function WL(e,t){if(!e.id)throw new Sn("Button id is required");if(zI[e.id]=e,e.groupId&&(CS[e.groupId]=CS[e.groupId]||[]).push(e),t){const n=du.navbar;switch(t){case"start":n.unshift(e.id);break;case"end":n.push(e.id);break;default:{const[r,i]=t.split(":"),a=n.indexOf(r);if(!r||!i||a===-1)throw new Sn(`Invalid defaultPosition ${t}`);n.splice(a+(i==="right"?1:0),0,e.id)}}}}[cG,HL,lG,p_,Bm,nG,rG,oG,sG,aG,iG].forEach(e=>WL(e));var yTe=class extends od{constructor(e){super(e,{className:`psv-navbar ${cx}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(e){this.children.slice().forEach(t=>t.destroy()),this.children.length=0,e.indexOf(Bm.id)!==-1&&e.indexOf(p_.id)===-1&&e.splice(e.indexOf(Bm.id),0,p_.id),e.forEach(t=>{typeof t=="object"?new fTe(this,t):zI[t]?new zI[t](this):CS[t]?CS[t].forEach(n=>{new n(this)}):$o(`Unknown button ${t}`)}),new mw(this),this.children.forEach(t=>{t instanceof _s&&t.checkSupported()}),this.autoSize()}setCaption(e){this.children.some(t=>t instanceof Bm?(t.setCaption(e),!0):!1)}getButton(e,t=!0){const n=this.children.find(r=>r instanceof _s&&r.id===e);return!n&&t&&$o(`button "${e}" not found in the navbar`),n}focusButton(e){var t,n;this.isVisible()&&((n=((t=this.getButton(e,!1))==null?void 0:t.container)||this.container.firstElementChild)==null||n.focus())}autoSize(){var r;this.children.forEach(i=>{i instanceof _s&&i.autoSize()});const e=this.container.offsetWidth;let t=0;const n=[];this.children.forEach(i=>{i.isVisible()&&i instanceof _s&&(t+=i.width,i.collapsable&&n.push(i))}),t!==0&&(e<t&&n.length>0?(n.forEach(i=>i.collapse()),this.collapsed=n,this.getButton(mw.id).show(!1)):e>=t&&this.collapsed.length>0&&(this.collapsed.forEach(i=>i.uncollapse()),this.collapsed=[],this.getButton(mw.id).hide(!1)),(r=this.getButton(Bm.id,!1))==null||r.autoSize())}};SI.enabled=!1;var gm={enabled:!0,maxItems:10,ttl:10*60,items:{},purgeInterval:null,init(){SI.enabled&&($o("ThreeJS cache should be disabled"),SI.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),60*1e3))},add(e,t,n){this.enabled&&t&&(this.items[t]=this.items[t]??{files:{},lastAccess:null},this.items[t].files[e]=n,this.items[t].lastAccess=Date.now())},get(e,t){if(this.enabled&&t&&this.items[t])return this.items[t].lastAccess=Date.now(),this.items[t].files[e]},remove(e,t){this.enabled&&t&&this.items[t]&&(delete this.items[t].files[e],Object.keys(this.items[t].files).length===0&&delete this.items[t])},purge(){Object.entries(this.items).sort(([,e],[,t])=>t.lastAccess-e.lastAccess).forEach(([e,{lastAccess:t}],n)=>{n>0&&(Date.now()-t>=this.ttl*1e3||n>=this.maxItems)&&delete this.items[e]})}},_Te=class extends od{constructor(e){super(e,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=lc(this.loader,"color"),this.color=lc(this.canvas,"color"),this.border=parseInt(lc(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(lc(this.loader,"--psv-loader-tickness"),10);const t=this.size/2;this.canvas.innerHTML=`
            <circle cx="${t}" cy="${t}" r="${t}" fill="${this.color}"/>
            <path d="" fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>
        `,this.viewer.addEventListener(js.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(js.type,this),super.destroy()}handleEvent(e){e instanceof js&&e.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(e){this.container.classList.remove("psv-loader--undefined");const t=pr.clamp(e,0,99.999)/100*Math.PI*2,n=this.size/2,r=n,i=this.thickness/2+this.border,a=(this.size-this.thickness)/2-this.border,c=Math.sin(t)*a+n,s=-Math.cos(t)*a+n,f=e>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d",`M ${r} ${i} A ${a} ${a} 0 ${f} 1 ${c} ${s}`)}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){const e=this.loader.querySelector(".psv-loader-image, .psv-loader-text");e&&this.loader.removeChild(e);let t;if(this.viewer.config.loadingImg?(t=document.createElement("img"),t.className="psv-loader-image",t.src=this.viewer.config.loadingImg):this.viewer.config.loadingTxt!==null&&(t=document.createElement("div"),t.className="psv-loader-text",t.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),t){const n=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));t.style.maxWidth=n+"px",t.style.maxHeight=n+"px",this.loader.appendChild(t)}}},xTe=class extends od{constructor(e){super(e,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Sn("Notification cannot be toggled")}show(e){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),typeof e=="string"&&(e={content:e}),this.state.contentId=e.id||null,this.content.innerHTML=e.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new My(this.state.contentId)),e.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),e.timeout))}hide(e){if(this.isVisible(e)){const t=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new xy(t))}}},bTe=class extends od{constructor(e){super(e,{className:`psv-overlay ${cx}`}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(Rh.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Rh.type,this),super.destroy()}handleEvent(e){e.type==="click"?this.isVisible()&&this.state.dismissible&&(this.hide(),e.stopPropagation()):e instanceof Rh&&this.isVisible()&&this.state.dismissible&&e.key===Co.Escape&&(this.hide(),e.preventDefault())}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Sn("Overlay cannot be toggled")}show(e){typeof e=="string"&&(e={title:e}),this.state.contentId=e.id||null,this.state.dismissible=e.dismissible!==!1,this.image.innerHTML=e.image||"",this.title.innerHTML=e.title||"",this.text.innerHTML=e.text||"",super.show(),this.viewer.dispatchEvent(new L7(this.state.contentId))}hide(e){if(this.isVisible(e)){const t=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new KH(t))}}},wTe=200,rP="psv-panel-content--no-interaction",STe=class extends od{constructor(e){super(e,{className:`psv-panel ${cx}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const t=document.createElement("div");t.className="psv-panel-resizer",this.container.appendChild(t);const n=document.createElement("div");n.className="psv-panel-close-button",n.innerHTML=kl.close,n.title=e.config.lang.close,this.container.appendChild(n),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),n.addEventListener("click",()=>this.hide()),t.addEventListener("mousedown",this),t.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(Rh.type,this)}destroy(){this.viewer.removeEventListener(Rh.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(e){switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e);break;case Rh.type:this.__onKeyPress(e);break}}isVisible(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}toggle(){throw new Sn("Panel cannot be toggled")}show(e){typeof e=="string"&&(e={content:e});const t=this.isVisible(e.id);this.state.contentId=e.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),e.id&&this.state.width[e.id]?this.container.style.width=this.state.width[e.id]:e.width?this.container.style.width=e.width:this.container.style.width=null,this.content.innerHTML=e.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),aC(this.content,"psv-panel-content--no-margin",e.noMargin===!0),e.clickHandler&&(this.state.clickHandler=n=>{e.clickHandler(xS(n))},this.state.keyHandler=n=>{n.key===Co.Enter&&e.clickHandler(xS(n))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),t||setTimeout(()=>{var n;(n=this.content.querySelector("a,button,[tabindex]"))==null||n.focus()},300)),this.viewer.dispatchEvent(new Lh(this.state.contentId))}hide(e){if(this.isVisible(e)){const t=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new Ih(t))}}__onMouseDown(e){e.stopPropagation(),this.__startResize(e.clientX,e.clientY)}__onTouchStart(e){if(e.stopPropagation(),e.touches.length===1){const t=e.touches[0];this.__startResize(t.clientX,t.clientY)}}__onMouseUp(e){this.state.mousedown&&(e.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(rP))}__onTouchEnd(e){this.state.mousedown&&(e.stopPropagation(),e.touches.length===0&&(this.state.mousedown=!1,this.content.classList.remove(rP)))}__onMouseMove(e){this.state.mousedown&&(e.stopPropagation(),this.__resize(e.clientX,e.clientY))}__onTouchMove(e){if(this.state.mousedown){const t=e.touches[0];this.__resize(t.clientX,t.clientY)}}__onKeyPress(e){this.isVisible()&&e.key===Co.Escape&&(this.hide(),e.preventDefault())}__startResize(e,t){this.state.mouseX=e,this.state.mouseY=t,this.state.mousedown=!0,this.content.classList.add(rP)}__resize(e,t){const n=e,r=t,i=Math.max(wTe,this.container.offsetWidth-(n-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=i),this.container.style.width=i,this.state.mouseX=n,this.state.mouseY=r}},MTe=class extends od{constructor(e,t){super(e,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",n=>n.stopPropagation()),this.container.addEventListener("mousedown",n=>n.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(t)}handleEvent(e){e.type==="transitionend"&&this.__onTransitionEnd(e)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new Sn("Tooltip cannot be toggled")}show(e){if(this.state.state!==0)throw new Sn("Initialized tooltip cannot be re-initialized");e.className&&zL(this.container,e.className),e.style&&Object.assign(this.container.style,e.style),this.state.state=3,this.update(e.content,e),this.state.data=e.data,this.state.state=1,this.viewer.dispatchEvent(new F7(this,this.state.data)),this.__waitImages()}update(e,t){this.content.innerHTML=e;const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.state.arrow=parseInt(lc(this.arrow,"border-top-width"),10),this.state.border=parseInt(lc(this.container,"border-top-left-radius"),10),this.move(t??this.state.config),this.__waitImages()}move(e){var s;if(this.state.state!==1&&this.state.state!==3)throw new Sn("Uninitialized tooltip cannot be moved");e.box=e.box??((s=this.state.config)==null?void 0:s.box)??{width:0,height:0},this.state.config=e;const t=this.container,n=this.arrow,r={posClass:bH(e.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(r,e);let i=null,a=null;if(r.top<0?i="bottom":r.top+r.height>this.viewer.state.size.height&&(i="top"),r.left<0?a="right":r.left+r.width>this.viewer.state.size.width&&(a="left"),a||i){const f=BL(r.posClass);i&&(r.posClass[f?0:1]=i),a&&(r.posClass[f?1:0]=a),this.__computeTooltipPosition(r,e)}t.style.top=r.top+"px",t.style.left=r.left+"px",n.style.top=r.arrowTop+"px",n.style.left=r.arrowLeft+"px";const c=r.posClass.join("-");c!==this.state.pos&&(t.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=c,t.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new n7(this.state.data));const e=parseFloat(lc(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},e*2)}__onTransitionEnd(e){if(e.propertyName==="transform")switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy();break}}__computeTooltipPosition(e,t){const n=this.state.arrow,r=t.top,i=e.height,a=t.left,c=e.width,s=n+this.state.border,f=t.box.width/2+n*2,g=t.box.height/2+n*2;switch(e.posClass.join("-")){case"top-left":e.top=r-g-i,e.left=a+s-c,e.arrowTop=i,e.arrowLeft=c-s-n;break;case"top-center":e.top=r-g-i,e.left=a-c/2,e.arrowTop=i,e.arrowLeft=c/2-n;break;case"top-right":e.top=r-g-i,e.left=a-s,e.arrowTop=i,e.arrowLeft=n;break;case"bottom-left":e.top=r+g,e.left=a+s-c,e.arrowTop=-n*2,e.arrowLeft=c-s-n;break;case"bottom-center":e.top=r+g,e.left=a-c/2,e.arrowTop=-n*2,e.arrowLeft=c/2-n;break;case"bottom-right":e.top=r+g,e.left=a-s,e.arrowTop=-n*2,e.arrowLeft=n;break;case"left-top":e.top=r+s-i,e.left=a-f-c,e.arrowTop=i-s-n,e.arrowLeft=c;break;case"center-left":e.top=r-i/2,e.left=a-f-c,e.arrowTop=i/2-n,e.arrowLeft=c;break;case"left-bottom":e.top=r-s,e.left=a-f-c,e.arrowTop=n,e.arrowLeft=c;break;case"right-top":e.top=r+s-i,e.left=a+f,e.arrowTop=i-s-n,e.arrowLeft=-n*2;break;case"center-right":e.top=r-i/2,e.left=a+f,e.arrowTop=i/2-n,e.arrowLeft=-n*2;break;case"right-bottom":e.top=r-s,e.left=a+f,e.arrowTop=n,e.arrowLeft=-n*2;break}}__waitImages(){const e=this.content.querySelectorAll("img");if(e.length>0){const t=[];e.forEach(n=>{n.complete||t.push(new Promise(r=>{n.onload=r,n.onerror=r}))}),t.length&&Promise.all(t).then(()=>{if(this.state.state===1||this.state.state===3){const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.move(this.state.config)}})}}},CTe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/><!--Created by Shastry from the Noun Project--></svg>
`,dx=class{constructor(e){this.viewer=e,this.config=e.config,this.state=e.state}destroy(){}},_l=new dt,bb=new yc(0,0,0,"ZXY"),ETe=class extends dx{constructor(e){super(e)}fovToZoomLevel(e){const t=Math.round((e-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return pr.clamp(t-2*(t-50),0,100)}zoomLevelToFov(e){return this.config.maxFov+e/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(e){return pr.radToDeg(2*Math.atan(Math.tan(pr.degToRad(e)/2)*this.state.aspect))}hFovToVFov(e){return pr.radToDeg(2*Math.atan(Math.tan(pr.degToRad(e)/2)/this.state.aspect))}getAnimationProperties(e,t,n){const r=!Eo(t),i=!Eo(n),a={};let c=null;if(r){const s=this.viewer.getPosition(),f=sH(s.yaw,t.yaw);a.yaw={start:s.yaw,end:s.yaw+f},a.pitch={start:s.pitch,end:t.pitch},c=AI(e,aH(s,t))}if(i){const s=this.viewer.getZoomLevel(),f=Math.abs(n-s);a.zoom={start:s,end:n},c===null&&(c=AI(e,Math.PI/4*f/100))}return c===null?typeof e=="number"?c=e:c=EI:c=Math.max(EI,c),{duration:c,properties:a}}getTransitionOptions(e){let t;const n=this.config.defaultTransition??du.defaultTransition;return e.transition===!1||e.transition===null?t=null:e.transition===!0?t={...n}:typeof e.transition=="object"?t={...n,...e.transition}:t=this.config.defaultTransition,t}textureCoordsToSphericalCoords(e){var n;if(!((n=this.state.textureData)!=null&&n.panoData))throw new Sn("Current adapter does not support texture coordinates or no texture has been loaded");const t=this.viewer.adapter.textureCoordsToSphericalCoords(e,this.state.textureData.panoData);return!bb.equals(this.viewer.renderer.panoramaPose)||!bb.equals(this.viewer.renderer.sphereCorrection)?(this.sphericalCoordsToVector3(t,_l),_l.applyEuler(this.viewer.renderer.panoramaPose),_l.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(_l)):t}sphericalCoordsToTextureCoords(e){var t;if(!((t=this.state.textureData)!=null&&t.panoData))throw new Sn("Current adapter does not support texture coordinates or no texture has been loaded");return(!bb.equals(this.viewer.renderer.panoramaPose)||!bb.equals(this.viewer.renderer.sphereCorrection))&&(this.sphericalCoordsToVector3(e,_l),RI(_l,this.viewer.renderer.sphereCorrection),RI(_l,this.viewer.renderer.panoramaPose),e=this.vector3ToSphericalCoords(_l)),this.viewer.adapter.sphericalCoordsToTextureCoords(e,this.state.textureData.panoData)}sphericalCoordsToVector3(e,t,n=Ff){return t||(t=new dt),t.x=n*-Math.cos(e.pitch)*Math.sin(e.yaw),t.y=n*Math.sin(e.pitch),t.z=n*Math.cos(e.pitch)*Math.cos(e.yaw),t}vector3ToSphericalCoords(e){const t=Math.acos(e.y/Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)),n=Math.atan2(e.x,e.z);return{yaw:n<0?-n:Math.PI*2-n,pitch:Math.PI/2-t}}viewerCoordsToVector3(e){const t=this.viewer.renderer.getIntersections(e).filter(n=>n.object.userData[Wh]);return t.length?t[0].point:null}viewerCoordsToSphericalCoords(e){const t=this.viewerCoordsToVector3(e);return t?this.vector3ToSphericalCoords(t):null}vector3ToViewerCoords(e){const t=e.clone();return t.project(this.viewer.renderer.camera),{x:Math.round((t.x+1)/2*this.state.size.width),y:Math.round((1-t.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(e){return this.sphericalCoordsToVector3(e,_l),this.vector3ToViewerCoords(_l)}isPointVisible(e){let t,n;if(e instanceof dt)t=e,n=this.vector3ToViewerCoords(e);else if(NL(e))t=this.sphericalCoordsToVector3(e,_l),n=this.vector3ToViewerCoords(t);else return!1;return t.dot(this.viewer.state.direction)>0&&n.x>=0&&n.x<=this.viewer.state.size.width&&n.y>=0&&n.y<=this.viewer.state.size.height}cleanPosition(e){if("yaw"in e||"pitch"in e){if(!("yaw"in e)||!("pitch"in e))throw new Sn("Position is missing 'yaw' or 'pitch'");return{yaw:nc(e.yaw),pitch:nc(e.pitch,!0)}}else return this.textureCoordsToSphericalCoords(e)}cleanSphereCorrection(e){return{pan:nc((e==null?void 0:e.pan)||0),tilt:nc((e==null?void 0:e.tilt)||0,!0),roll:nc((e==null?void 0:e.roll)||0,!0,!1)}}cleanPanoramaPose(e){return{pan:pr.degToRad((e==null?void 0:e.poseHeading)||0),tilt:pr.degToRad((e==null?void 0:e.posePitch)||0),roll:pr.degToRad((e==null?void 0:e.poseRoll)||0)}}cleanPanoramaOptions(e,t){return t!=null&&t.isEquirectangular&&(Eo(e.zoom)&&!Eo(t.initialFov)&&(e={...e,zoom:this.fovToZoomLevel(this.hFovToVFov(t.initialFov))}),Eo(e.position)&&!Eo(t.initialHeading)&&!Eo(t.initialPitch)&&(e={...e,position:{yaw:nc(t.initialHeading),pitch:nc(t.initialPitch,!0)}})),e}},TTe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/><!--Created by AomAm from the Noun Project--></svg>
`,PTe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/><!-- Created by Icon Island from the Noun Project --></svg>
`,mC=class hG{constructor(){this.$=hG.IDLE}is(...t){return t.some(n=>this.$&n)}set(t){this.$=t}add(t){this.$|=t}remove(t){this.$&=~t}};mC.IDLE=0;mC.CLICK=1;mC.MOVING=2;var Ki=mC,ATe=class extends dx{constructor(e){super(e),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new Ki,this.keyHandler=new hC,this.resizeObserver=new ResizeObserver(mH(()=>this.viewer.autoSize(),50)),this.moveThreshold=J9*vs.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(yy.type,this),this.viewer.addEventListener(Ey.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(yy.type,this),this.viewer.removeEventListener(Ey.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(e){switch(e.type){case"keydown":this.__onKeyDown(e);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchmove":this.__onTouchMove(e);break;case"touchend":this.__onTouchEnd(e);break;case"fullscreenchange":this.__onFullscreenChange();break;case yy.type:this.__applyMoveDelta();break;case Ey.type:this.__clearMoveDelta();break}if(!uH(e,"."+cx))switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"wheel":this.__onMouseWheel(e);break}}__onKeyDown(e){var n;if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=e.key===Co.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(Uo.CTRL_ZOOM))),!this.viewer.dispatchEvent(new Rh(e.key,e))||!this.state.keyboardEnabled)return;const t=(n=this.config.keyboardActions)==null?void 0:n[e.key];if(typeof t=="function"){t(this.viewer,e),e.preventDefault();return}if(!(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&t&&!this.keyHandler.pending){switch(t!=="ZOOM_IN"&&t!=="ZOOM_OUT"&&this.viewer.stopAll(),t){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0);break}this.keyHandler.down(t),e.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(e=>{e==="ZOOM_IN"||e==="ZOOM_OUT"?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())})}__onMouseDown(e){this.step.add(Ki.CLICK),this.data.startMouseX=e.clientX,this.data.startMouseY=e.clientY,this.config.mousemove&&e.preventDefault()}__onMouseUp(e){this.step.is(Ki.CLICK,Ki.MOVING)&&this.__stopMove(e.clientX,e.clientY,e,e.button===2)}__onMouseMove(e){this.config.mousemove&&this.step.is(Ki.CLICK,Ki.MOVING)&&(e.preventDefault(),this.__doMove(e.clientX,e.clientY)),this.__handleObjectsEvents(e)}__onTouchStart(e){e.touches.length===1?(this.step.add(Ki.CLICK),this.data.startMouseX=e.touches[0].clientX,this.data.startMouseY=e.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const t=e.touches[0];this.__stopMove(t.clientX,t.clientY,e,!0),this.data.longtouchTimeout=null},eH))):e.touches.length===2&&(this.step.set(Ki.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(e),e.preventDefault()))}__onTouchEnd(e){if(this.__cancelLongTouch(),this.step.is(Ki.CLICK,Ki.MOVING)){if(e.preventDefault(),this.__cancelTwoFingersOverlay(),e.touches.length===1)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(e.touches.length===0){const t=e.changedTouches[0];this.__stopMove(t.clientX,t.clientY,e)}}}__onTouchMove(e){if(this.__cancelLongTouch(),!!this.config.mousemove)if(e.touches.length===1){if(this.config.touchmoveTwoFingers)this.step.is(Ki.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:Uo.TWO_FINGERS,image:TTe,title:this.config.lang.twoFingers})},tH));else if(this.step.is(Ki.CLICK,Ki.MOVING)){e.preventDefault();const t=e.touches[0];this.__doMove(t.clientX,t.clientY)}}else this.__doMoveZoom(e),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(Uo.TWO_FINGERS))}__onMouseWheel(e){if(!this.config.mousewheel||!e.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown){this.viewer.overlay.show({id:Uo.CTRL_ZOOM,image:PTe,title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(Uo.CTRL_ZOOM),nH);return}e.preventDefault(),e.stopPropagation();const t=e.deltaY/Math.abs(e.deltaY)*5*this.config.zoomSpeed;t!==0&&this.viewer.dynamics.zoom.step(-t,5)}__onFullscreenChange(){const e=this.viewer.isFullscreenEnabled();this.config.keyboard==="fullscreen"&&(e?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new _y(e))}__resetMove(){this.step.set(Ki.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(e){this.viewer.stopAll(),this.__resetMove();const t=TI(e);this.step.set(Ki.MOVING),this.data.accumulatorFactor=this.config.moveInertia,{distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=t}__stopMove(e,t,n,r=!1){this.step.is(Ki.CLICK)&&!this.__moveThresholdReached(e,t)&&this.__doClick(e,t,n,r),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(e,t,n,r=!1){const i=this.viewer.container.getBoundingClientRect(),a=e-i.left,c=t-i.top,s=this.viewer.renderer.getIntersections({x:a,y:c}),f=s.find(g=>g.object.userData[Wh]);if(f){const g=this.viewer.dataHelper.vector3ToSphericalCoords(f.point),_={rightclick:r,originalEvent:n,target:xS(n),clientX:e,clientY:t,viewerX:a,viewerY:c,yaw:g.yaw,pitch:g.pitch,objects:s.map(x=>x.object).filter(x=>!x.userData[Wh])};try{const x=this.viewer.dataHelper.sphericalCoordsToTextureCoords(_);Object.assign(_,x)}catch{}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-_.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-_.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new HH(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new BH(_)),this.data.dblclickData=lC(_),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},Q9))}}__handleObjectsEvents(e){if(!vH(this.state.objectsObservers)&&e.composedPath().includes(this.viewer.container)){const t=hH(this.viewer.container),n={x:e.clientX-t.x,y:e.clientY-t.y},r=this.viewer.renderer.getIntersections(n),i=(a,c,s)=>{this.viewer.dispatchEvent(new s(e,a,n,c))};for(const[a,c]of Object.entries(this.state.objectsObservers)){const s=r.find(f=>f.object.userData[a]);s?(c&&s.object!==c&&(i(c,a,LI),this.state.objectsObservers[a]=null),c?i(s.object,a,K7):(this.state.objectsObservers[a]=s.object,i(s.object,a,W7))):c&&(i(c,a,LI),this.state.objectsObservers[a]=null)}}}__doMove(e,t){if(this.step.is(Ki.CLICK)&&this.__moveThresholdReached(e,t))this.viewer.stopAll(),this.__resetMove(),this.step.set(Ki.MOVING),this.data.mouseX=e,this.data.mouseY=t,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(Ki.MOVING)){const n=(e-this.data.mouseX)*Math.cos(this.state.roll)-(t-this.data.mouseY)*Math.sin(this.state.roll),r=(t-this.data.mouseY)*Math.cos(this.state.roll)+(e-this.data.mouseX)*Math.sin(this.state.roll),i={yaw:this.config.moveSpeed*(n/this.state.size.width)*pr.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(r/this.state.size.height)*pr.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=i.yaw,this.data.moveDelta.pitch+=i.pitch,this.data.mouseX=e,this.data.mouseY=t}}__moveThresholdReached(e,t){return Math.abs(e-this.data.startMouseX)>=this.moveThreshold||Math.abs(t-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(e){if(this.step.is(Ki.MOVING)){e.preventDefault();const t=TI(e);this.__doMove(t.center.x,t.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((t.distance-this.data.pinchDist)/vs.pixelRatio),this.data.pinchDist=t.distance}}__applyMoveDelta(){if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){const t=this.viewer.getPosition();this.viewer.rotate({yaw:t.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:t.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,Math.abs(this.data.moveDelta.yaw)<=.001&&(this.data.moveDelta.yaw=0),Math.abs(this.data.moveDelta.pitch)<=.001&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){const t=this.viewer.getZoomLevel();this.viewer.zoom(t+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,Math.abs(this.data.moveDelta.zoom)<=.001&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};Er.enabled=!1;var wb=new kr,aB=new Vr,lB=new $g,ITe=class extends dx{constructor(e){super(e),this.frustumNeedsUpdate=!0,this.renderer=new GEe(this.config.rendererParameters),this.renderer.setPixelRatio(vs.pixelRatio),this.renderer.outputColorSpace=Of,this.renderer.toneMapping=C9,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new vS,this.camera=new da(50,16/9,.1,2*Ff),this.camera.matrixAutoUpdate=!1;const t=new Os(new Vg(Ff).scale(-1,1,1),new Gh({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));t.userData={[Wh]:!0},this.scene.add(t),this.raycaster=new lSe,this.frustum=new RL,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",n=>n.preventDefault()),this.viewer.addEventListener(Cy.type,this),this.viewer.addEventListener(eu.type,this),this.viewer.addEventListener(by.type,this),this.viewer.addEventListener(wy.type,this),this.viewer.addEventListener(js.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(e=>this.__renderLoop(e))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(Cy.type,this),this.viewer.removeEventListener(eu.type,this),this.viewer.removeEventListener(by.type,this),this.viewer.removeEventListener(wy.type,this),this.viewer.removeEventListener(js.type,this),super.destroy()}handleEvent(e){switch(e.type){case Cy.type:this.__onSizeUpdated();break;case eu.type:this.__onZoomUpdated();break;case by.type:this.__onPositionUpdated();break;case wy.type:this.__onPositionUpdated();break;case js.type:e.containsOptions("fisheye")&&this.__onPositionUpdated(),e.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground);break}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(e){e?this.customRenderer=e(this.renderer):this.customRenderer=null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(e){const t=this.timestamp?e-this.timestamp:0;this.timestamp=e,this.viewer.dispatchEvent(new yy(e,t)),this.viewer.dynamics.update(t),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new T7))}setTexture(e){this.meshContainer||(this.meshContainer=new yh,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(e.panoData),this.viewer.adapter.setTexture(this.mesh,e,!1),this.meshContainer.add(this.mesh),this.state.textureData=e,this.viewer.needsUpdate()}setPanoramaPose(e,t=this.mesh){const n=this.viewer.dataHelper.cleanPanoramaPose(e);t.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}setSphereCorrection(e,t=this.meshContainer){const n=this.viewer.dataHelper.cleanSphereCorrection(e);t.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}transition(e,t,n){const r=n.effect==="fade"||n.rotation,i=!Eo(t.position),a=!Eo(t.zoom),c=new $L(i?this.viewer.dataHelper.cleanPosition(t.position):void 0,t.zoom);this.viewer.dispatchEvent(c);const s=new yh,f=this.viewer.adapter.createMesh(e.panoData);if(this.viewer.adapter.setTexture(f,e,!0),this.viewer.adapter.setTextureOpacity(f,0),this.setPanoramaPose(e.panoData,f),this.setSphereCorrection(t.sphereCorrection,s),i&&!n.rotation){const C=this.viewer.getPosition(),E=new dt(0,1,0);s.rotateOnWorldAxis(E,c.position.yaw-C.yaw);const A=new dt(0,1,0).cross(this.camera.getWorldDirection(new dt)).normalize();s.rotateOnWorldAxis(A,c.position.pitch-C.pitch)}s.add(f),this.scene.add(s),this.renderer.setRenderTarget(new Hh),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:g,properties:_}=this.viewer.dataHelper.getAnimationProperties(n.speed,n.rotation?c.position:null,r?c.zoomLevel:null),x=new MS({properties:{..._,opacity:{start:0,end:1}},duration:g,easing:"inOutCubic",onTick:C=>{switch(n.effect){case"fade":this.viewer.adapter.setTextureOpacity(f,C.opacity);break;case"black":case"white":C.opacity<.5?this.renderer.toneMappingExposure=n.effect==="black"?pr.mapLinear(C.opacity,0,.5,1,0):pr.mapLinear(C.opacity,0,.5,1,4):(this.renderer.toneMappingExposure=n.effect==="black"?pr.mapLinear(C.opacity,.5,1,0,1):pr.mapLinear(C.opacity,.5,1,4,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(f,1),a&&!r&&this.viewer.dynamics.zoom.setValue(c.zoomLevel));break}i&&n.rotation&&this.viewer.dynamics.position.setValue({yaw:C.yaw,pitch:C.pitch}),a&&r&&this.viewer.dynamics.zoom.setValue(C.zoom),this.viewer.needsUpdate()}});return x.then(C=>{s.remove(f),this.scene.remove(s),C?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=f,this.meshContainer.add(f),this.state.textureData=e,this.setPanoramaPose(e.panoData),this.setSphereCorrection(t.sphereCorrection),i&&!n.rotation&&this.viewer.rotate(t.position)):(this.viewer.adapter.disposeTexture(e),this.viewer.adapter.disposeMesh(f))}),x}getIntersections(e){var n;wb.x=2*e.x/this.state.size.width-1,wb.y=-2*e.y/this.state.size.height+1,this.raycaster.setFromCamera(wb,this.camera);const t=this.raycaster.intersectObjects(this.scene.children,!0).filter(r=>r.object.visible).filter(r=>r.object.isMesh&&!!r.object.userData);return(n=this.customRenderer)!=null&&n.getIntersections&&t.push(...this.customRenderer.getIntersections(this.raycaster,wb)),t}isObjectVisible(e){if(!e)return!1;if(this.frustumNeedsUpdate&&(aB.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(aB),this.frustumNeedsUpdate=!1),e.isVector3)return this.frustum.containsPoint(e);if(e.isMesh&&e.geometry){const t=e;return t.geometry.boundingBox||t.geometry.computeBoundingBox(),lB.copy(t.geometry.boundingBox).applyMatrix4(t.matrixWorld),this.frustum.intersectsBox(lB)}else return e.isObject3D?this.frustum.intersectsObject(e):!1}addObject(e){this.scene.add(e)}removeObject(e){this.scene.remove(e)}cleanScene(e){const t=n=>{var r;(r=n.map)==null||r.dispose(),n.uniforms&&Object.values(n.uniforms).forEach(i=>{var a,c;(c=(a=i.value)==null?void 0:a.dispose)==null||c.call(a)}),n.dispose()};e.traverse(n=>{var r,i;(r=n.geometry)==null||r.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(a=>{t(a)}):t(n.material)),n instanceof vS||(i=n.dispose)==null||i.call(n),n!==e&&this.cleanScene(n)})}},RTe=class extends LL{load(e,t,n,r,i){const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(a,{signal:i}).then(c=>{if(c.status===200||c.status===0){const s=c.body.getReader(),f=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),g=f?parseInt(f):0,_=g!==0;let x=0;const C=new ReadableStream({start(E){A();function A(){s.read().then(({done:L,value:I})=>{if(L)E.close();else{x+=I.byteLength;const T=new ProgressEvent("progress",{lengthComputable:_,loaded:x,total:g});n(T),E.enqueue(I),A()}}).catch(L=>{r(L)})}}});return new Response(C)}else throw new Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>c.blob()).then(c=>{t(c)}).catch(c=>{r(c)})}},LTe=class extends LL{load(e,t,n,r){const i=document.createElement("img");function a(){f(),t(this)}function c(g){if(f(),r!=null&&r.aborted){const _=new Error;_.name="AbortError",_.message="The operation was aborted.",n(_)}else n(g)}function s(){i.src=""}function f(){i.removeEventListener("load",a,!1),i.removeEventListener("error",c,!1),r==null||r.removeEventListener("abort",s,!1)}return i.addEventListener("load",a,!1),i.addEventListener("error",c,!1),r==null||r.addEventListener("abort",s,!1),e.startsWith("data:")||(i.crossOrigin=this.withCredentials?"use-credentials":"anonymous"),i.src=e,i}},kTe=class extends dx{constructor(e){super(e),this.abortCtrl={},this.fileLoader=new RTe,this.imageLoader=new LTe}destroy(){this.abortLoading(),super.destroy()}abortLoading(){Object.values(this.abortCtrl).forEach(e=>e.abort()),this.abortCtrl={}}loadFile(e,t,n){const r=gm.get(e,n);if(r){if(r instanceof Blob)return t==null||t(100),Promise.resolve(r);gm.remove(e,n)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(e)),this.fileLoader.setWithCredentials(this.config.withCredentials(e)),new Promise((i,a)=>{let c=0;t==null||t(c),this.fileLoader.load(e,s=>{c=100,t==null||t(c),gm.add(e,n,s),i(s)},s=>{if(s.lengthComputable){const f=s.loaded/s.total*100;f>c&&(c=f,t==null||t(c))}},s=>{a(s)},this.__getAbortSignal(n))})}loadImage(e,t,n){const r=gm.get(e,n);return r?(t==null||t(100),r instanceof Blob?this.blobToImage(r):Promise.resolve(r)):!t&&!this.config.requestHeaders?(this.imageLoader.setWithCredentials(this.config.withCredentials(e)),new Promise((i,a)=>{this.imageLoader.load(e,c=>{gm.add(e,n,c),i(c)},c=>{a(c)},this.__getAbortSignal(n))})):this.loadFile(e,t,n).then(i=>this.blobToImage(i))}blobToImage(e){return new Promise((t,n)=>{const r=document.createElement("img");r.onload=()=>{URL.revokeObjectURL(r.src),t(r)},r.onerror=n,r.src=URL.createObjectURL(e)})}preloadPanorama(e){return this.viewer.adapter.supportsPreload(e)?this.viewer.adapter.loadTexture(e,!1):Promise.reject(new Sn("Current adapter does not support preload"))}dispatchProgress(e){this.viewer.loader.setProgress(e),this.viewer.dispatchEvent(new a7(Math.round(e)))}__getAbortSignal(e){var t;return e?((t=this.abortCtrl[e])!=null&&t.signal.aborted&&delete this.abortCtrl[e],this.abortCtrl[e]||(this.abortCtrl[e]=new AbortController),this.abortCtrl[e].signal):null}},DTe=class extends dx{constructor(e){super(e),this.zoom=new G0(t=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(t),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new eu(t))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new EH(t=>{this.viewer.dataHelper.sphericalCoordsToVector3(t,this.viewer.state.direction),this.viewer.dispatchEvent(new by(t))},{yaw:new G0(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new G0(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new G0(t=>{this.viewer.state.roll=t,this.viewer.dispatchEvent(new wy(t))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(this.config.zoomSpeed*50),this.position.setSpeed(pr.degToRad(this.config.moveSpeed*50)),this.roll.setSpeed(pr.degToRad(this.config.moveSpeed*50))}update(e){this.zoom.update(e),this.position.update(e),this.roll.update(e)}},zTe=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new dt(0,0,Ff),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},OTe=class extends AH{constructor(e){var t,n,r;if(super(),this.plugins={},this.children=[],this.parent=lH(e.container),!this.parent)throw new Sn('"container" element not found.');this.parent[Wh]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),MH(this.parent),SH(this.container,"core"),this.state=new zTe,this.config=vTe(e),this.__setSize(this.config.size),this.overlay=new bTe(this);try{vs.load()}catch(i){console.error(i),this.showError(this.config.lang.webglError);return}gm.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new ITe(this),this.textureLoader=new kTe(this),this.eventsHandler=new ATe(this),this.dataHelper=new ETe(this),this.dynamics=new DTe(this),(n=(t=this.adapter).init)==null||n.call(t),this.loader=new _Te(this),this.navbar=new yTe(this),this.panel=new STe(this),this.notification=new xTe(this),this.autoSize(),this.setCursor(null),FL(vs.isTouchEnabled,i=>{aC(this.container,"psv--is-touch",i)}),this.config.plugins.forEach(([i,a])=>{this.plugins[i.id]=new i(this,a)});for(const i of Object.values(this.plugins))(r=i.init)==null||r.call(i);this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){var e,t,n,r,i,a;this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[c,s]of Object.entries(this.plugins))s.destroy(),delete this.plugins[c];this.children.slice().forEach(c=>c.destroy()),this.children.length=0,(e=this.eventsHandler)==null||e.destroy(),(t=this.renderer)==null||t.destroy(),(n=this.textureLoader)==null||n.destroy(),(r=this.dataHelper)==null||r.destroy(),(i=this.adapter)==null||i.destroy(),(a=this.dynamics)==null||a.destroy(),this.parent.removeChild(this.container),delete this.parent[Wh]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),this.config.keyboard==="always"&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new Sy)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(e){if(typeof e=="string")return this.plugins[e];{const t=kI(e);return t?this.plugins[t.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return dH(this.parent,vs.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(e){e?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){(this.container.clientWidth!==this.state.size.width||this.container.clientHeight!==this.state.size.height)&&(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new Cy(this.getSize())),this.navbar.autoSize())}setPanorama(e,t={}){var a;this.textureLoader.abortLoading(),(a=this.state.transitionAnimation)==null||a.cancel();const n=this.dataHelper.getTransitionOptions(t);t.showLoader===void 0&&(t.showLoader=!0),t.caption===void 0&&(t.caption=this.config.caption),t.description===void 0&&(t.description=this.config.description),!t.panoData&&typeof this.config.panoData=="function"&&(t.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=e,this.config.caption=t.caption,this.config.description=t.description,this.config.sphereCorrection=t.sphereCorrection;const r=c=>{if(xH(c))return!1;if(this.loader.hide(),this.state.loadingPromise=null,c)throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(c),this.dispatchEvent(new m7(e,c)),c;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),(t.showLoader||!this.state.ready)&&this.loader.show(),this.dispatchEvent(new u7(e));const i=this.adapter.loadTexture(this.config.panorama,!0,t.panoData).then(c=>{if(c.panorama!==this.config.panorama)throw this.adapter.disposeTexture(c),PI();const s=this.dataHelper.cleanPanoramaOptions(t,c.panoData);return(!Eo(s.zoom)||!Eo(s.position))&&this.stopAll(),{textureData:c,cleanOptions:s}});return!n||!this.state.ready||!this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=i.then(({textureData:c,cleanOptions:s})=>{this.renderer.show(),this.renderer.setTexture(c),this.renderer.setPanoramaPose(c.panoData),this.renderer.setSphereCorrection(t.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new ig(c)),Eo(s.zoom)||this.zoom(s.zoom),Eo(s.position)||this.rotate(s.position)}).then(()=>r(),c=>r(c)):this.state.loadingPromise=i.then(({textureData:c,cleanOptions:s})=>(this.loader.hide(),this.dispatchEvent(new ig(c)),this.state.transitionAnimation=this.renderer.transition(c,s,n),this.state.transitionAnimation)).then(c=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new y7(c)),!c)throw PI()}).then(()=>r(),c=>r(c)),this.state.loadingPromise}setOptions(e){const t={...this.config,...e};for(let[n,r]of Object.entries(e)){if(!(n in du)){$o(`Unknown option ${n}`);continue}if(n in sB){$o(sB[n]);continue}switch(n in DI&&(r=DI[n](r,{rawConfig:t,defValue:du[n]})),this.config[n]=r,n){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new eu(this.getZoomLevel()));break;case"keyboard":this.config.keyboard==="always"?this.startKeyboardControl():this.stopKeyboardControl();break}}this.needsUpdate(),this.dispatchEvent(new js(Object.keys(e)))}setOption(e,t){this.setOptions({[e]:t})}showError(e){this.overlay.show({id:Uo.ERROR,image:CTe,title:e,dismissible:!1})}hideError(){this.overlay.hide(Uo.ERROR)}rotate(e){const t=new OH(this.dataHelper.cleanPosition(e));this.dispatchEvent(t),!t.defaultPrevented&&this.dynamics.position.setValue(t.position)}zoom(e){this.dynamics.zoom.setValue(e)}zoomIn(e=1){this.dynamics.zoom.step(e)}zoomOut(e=1){this.dynamics.zoom.step(-e)}animate(e){const t=NL(e),n=!Eo(e.zoom),r=new $L(t?this.dataHelper.cleanPosition(e):void 0,e.zoom);if(this.dispatchEvent(r),r.defaultPrevented)return;this.stopAll();const{duration:i,properties:a}=this.dataHelper.getAnimationProperties(e.speed,r.position,r.zoomLevel);return i?(this.state.animation=new MS({properties:a,duration:i,easing:e.easing||"inOutSine",onTick:c=>{t&&this.dynamics.position.setValue({yaw:c.yaw,pitch:c.pitch}),n&&this.dynamics.zoom.setValue(c.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(t&&this.rotate(r.position),n&&this.zoom(r.zoomLevel),new MS(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(e){this.__setSize(e),this.autoSize()}__setSize(e){["width","height"].forEach(t=>{e!=null&&e[t]&&(/^[0-9.]+$/.test(e[t])&&(e[t]+="px"),this.parent.style[t]=e[t])})}enterFullscreen(){this.isFullscreenEnabled()||fH(this.parent,vs.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&pH(vs.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(e){return new MTe(this,e)}setCursor(e){this.state.cursorOverride=e,e?this.container.style.cursor=e:this.container.style.cursor=this.config.mousemove?"move":"default"}observeObjects(e){this.state.objectsObservers[e]||(this.state.objectsObservers[e]=null)}unobserveObjects(e){delete this.state.objectsObservers[e]}stopAll(){return this.dispatchEvent(new Ey),this.disableIdleTimer(),this.stopAnimation()}};/*!
 * Photo Sphere Viewer / Equirectangular Tiles Adapter 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var FTe=class{constructor(e,t,n){this.id=e,this.priority=t,this.fn=n,this.status=1}start(){return this.status=2,this.fn(this).then(()=>{this.status=4},()=>{this.status=5})}cancel(){this.status=3}isCancelled(){return this.status===3}},NTe=class{constructor(t=8){this.concurency=t,this.runningTasks={},this.tasks={}}enqueue(t){this.tasks[t.id]=t}clear(){Object.values(this.tasks).forEach(t=>t.cancel()),this.tasks={},this.runningTasks={}}setPriority(t,n){const r=this.tasks[t];r&&(r.priority=n,r.status===0&&(r.status=1))}disableAllTasks(){Object.values(this.tasks).forEach(t=>{t.status=0})}start(){if(Object.keys(this.runningTasks).length>=this.concurency)return;const t=Object.values(this.tasks).filter(n=>n.status===1).sort((n,r)=>r.priority-n.priority).pop();t&&(this.runningTasks[t.id]=!0,t.start().then(()=>{t.isCancelled()||(delete this.tasks[t.id],delete this.runningTasks[t.id],this.start())}),this.start())}};function BTe(e){let t=0;e.forEach((n,r)=>{if(!n.zoomRange||n.zoomRange.length!==2)throw new Sn(`Tiles level ${r} is missing "zoomRange" property`);if(n.zoomRange[0]>=n.zoomRange[1]||n.zoomRange[0]!==t||r===0&&n.zoomRange[0]!==0||r===e.length-1&&n.zoomRange[1]!==100)throw new Sn(`Tiles levels' "zoomRange" are not orderer or are not covering the whole 0-100 range`);t=n.zoomRange[1]})}function UTe(e,t){return e.findIndex(n=>t>=n.zoomRange[0]&&t<=n.zoomRange[1])}function $Te(){const e=new OffscreenCanvas(512,512),t=e.getContext("2d");return t.fillStyle="#333",t.fillRect(0,0,e.width,e.height),t.font=`${e.width/5}px serif`,t.fillStyle="#a22",t.textAlign="center",t.textBaseline="middle",t.fillText("⚠",e.width/2,e.height/2),new Gh({map:Dn.createTexture(e)})}function VTe(e){const t=new tSe(e),n=new Qwe(t);return n.material.depthTest=!1,n.material.depthWrite=!1,n.material.opacity=.25,n.material.transparent=!0,n}var cB=["dodgerblue","limegreen","indianred"];function jTe(e,t,n){const r=document.createElement("canvas");r.width=e.width,r.height=e.height;const i=r.getContext("2d");i.fillStyle=cB[t%cB.length],i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="multiply",i.drawImage(e,0,0);const a=e.width/7;return i.globalCompositeOperation="source-over",i.fillStyle="white",i.font=`${a}px monospace`,i.textAlign="center",n.split(`
`).forEach((c,s)=>{i.fillText(c,e.width/2,e.height/2+a*(.3+s))}),r}function qL(e){return!!e.levels}function dG(e,t,n){return{...e,level:t,colSize:e.width/e.cols,rowSize:e.width/2/e.rows,facesByCol:n.SPHERE_SEGMENTS/e.cols,facesByRow:n.SPHERE_HORIZONTAL_SEGMENTS/e.rows}}function uB(e,t,n){let r,i;return qL(e)?(i=UTe(e.levels,t),r=e.levels[i]):(i=0,r={...e,zoomRange:[0,100]}),dG(r,i,n)}function HTe(e,t,n){return!qL(e)||!e.levels[t]?null:dG(e.levels[t],t,n)}function GTe(e,t){if(typeof e!="object"||!e.tileUrl)throw new Sn("Invalid panorama configuration, are you using the right adapter?");qL(e)?(e.levels.forEach(n=>hB(n,t)),BTe(e.levels)):hB(e,t)}function hB(e,t){if(!e.width||!e.cols||!e.rows)throw new Sn("Invalid panorama configuration, are you using the right adapter?");if(e.cols>t.SPHERE_SEGMENTS)throw new Sn(`Panorama cols must not be greater than ${t.SPHERE_SEGMENTS}.`);if(e.rows>t.SPHERE_HORIZONTAL_SEGMENTS)throw new Sn(`Panorama rows must not be greater than ${t.SPHERE_HORIZONTAL_SEGMENTS}.`);if(!pr.isPowerOfTwo(e.cols)||!pr.isPowerOfTwo(e.rows))throw new Sn("Panorama cols and rows must be powers of 2.")}function WTe(e,t){for(let n=0;n<t.cols;n++){const r=e.tileUrl(n,t.rows/2,t.level);if(r)return r}return e.tileUrl.toString()}var P0=6,As=3,qTe="uv",XTe="position",dB=-1;function iP(e){return`${e.col}x${e.row}/${e.config.level}`}function Sb(e){return e.children}var ZTe=Dn.getConfigParser({resolution:64,showErrorTile:!0,baseBlur:!0,antialias:!0,debug:!1,useXmpData:!1}),Mb=new dt,gC=class fG extends fC{constructor(t,n){super(t),this.state={tileConfig:null,tiles:{},faces:{},geom:null,materials:[],errorMaterial:null,inTransition:!1},this.queue=new NTe,this.config=ZTe(n),this.adapter=new VL(this.viewer,{resolution:this.config.resolution,blur:this.config.baseBlur}),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2,this.NB_VERTICES=2*this.SPHERE_SEGMENTS*As+(this.SPHERE_HORIZONTAL_SEGMENTS-2)*this.SPHERE_SEGMENTS*P0,this.NB_GROUPS=this.SPHERE_SEGMENTS*this.SPHERE_HORIZONTAL_SEGMENTS,this.viewer.config.requestHeaders&&Dn.logWarn('EquirectangularTilesAdapter fallbacks to file loader because "requestHeaders" where provided. Consider removing "requestHeaders" if you experience performances issues.')}static withConfig(t){return[fG,t]}init(){super.init(),this.viewer.addEventListener(Fn.TransitionDoneEvent.type,this),this.viewer.addEventListener(Fn.PositionUpdatedEvent.type,this),this.viewer.addEventListener(Fn.ZoomUpdatedEvent.type,this)}destroy(){var t,n,r;this.viewer.removeEventListener(Fn.TransitionDoneEvent.type,this),this.viewer.removeEventListener(Fn.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(Fn.ZoomUpdatedEvent.type,this),this.__cleanup(),(n=(t=this.state.errorMaterial)==null?void 0:t.map)==null||n.dispose(),(r=this.state.errorMaterial)==null||r.dispose(),this.adapter.destroy(),delete this.adapter,delete this.state.geom,delete this.state.errorMaterial,super.destroy()}handleEvent(t){switch(t.type){case Fn.PositionUpdatedEvent.type:case Fn.ZoomUpdatedEvent.type:this.__refresh();break;case Fn.TransitionDoneEvent.type:this.state.inTransition=!1,t.completed&&this.__switchMesh(this.viewer.renderer.mesh);break}}supportsTransition(t){return!!t.baseUrl}supportsPreload(t){return!!t.baseUrl}textureCoordsToSphericalCoords(t,n){return this.adapter.textureCoordsToSphericalCoords(t,n)}sphericalCoordsToTextureCoords(t,n){return this.adapter.sphericalCoordsToTextureCoords(t,n)}async loadTexture(t,n=!0){GTe(t,this);const r=uB(t,0,this),i={isEquirectangular:!0,fullWidth:r.width,fullHeight:r.width/2,croppedWidth:r.width,croppedHeight:r.width/2,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0};if(t.baseUrl){const a=await this.adapter.loadTexture(t.baseUrl,n,t.basePanoData,!0);return{panorama:t,panoData:{...i,baseData:a.panoData},cacheKey:a.cacheKey,texture:a.texture}}else return{panorama:t,panoData:{...i,baseData:null},cacheKey:WTe(t,r),texture:null}}createMesh(t){const n=this.adapter.createMesh(t.baseData??t),r=new Vg(Ag.SPHERE_RADIUS,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1).toNonIndexed();r.clearGroups();let i=0,a=0;for(;i<this.SPHERE_SEGMENTS*As;i+=As)r.addGroup(i,As,a++);for(;i<this.NB_VERTICES-this.SPHERE_SEGMENTS*As;i+=P0)r.addGroup(i,P0,a++);for(;i<this.NB_VERTICES;i+=As)r.addGroup(i,As,a++);const c=[],s=new Gh({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1});for(let _=0;_<this.NB_GROUPS;_++)c.push(s);const f=new Os(r,c);f.renderOrder=1;const g=new yh;return g.add(n),g.add(f),g}setTexture(t,n,r){const[i]=Sb(t);n.texture?this.adapter.setTexture(i,{panorama:n.panorama.baseUrl,texture:n.texture,panoData:n.panoData.baseData}):i.visible=!1,r?this.state.inTransition=!0:this.__switchMesh(t)}setTextureOpacity(t,n){const[r]=Sb(t);this.adapter.setTextureOpacity(r,n)}disposeTexture({texture:t}){t==null||t.dispose()}disposeMesh(t){const[n,r]=Sb(t);n.geometry.dispose(),n.material.dispose(),r.geometry.dispose(),r.material.forEach(i=>{var a;(a=i.map)==null||a.dispose(),i.dispose()})}__refresh(){if(!this.state.geom||this.state.inTransition)return;const t=this.viewer.config.panorama,n=this.viewer.getZoomLevel(),r=uB(t,n,this),i=this.state.geom.getAttribute(XTe),a={};for(let c=0;c<this.NB_VERTICES;c+=1)if(Mb.fromBufferAttribute(i,c),Mb.applyEuler(this.viewer.renderer.sphereCorrection),this.viewer.renderer.isObjectVisible(Mb)){let s;c<this.SPHERE_SEGMENTS*As?s=Math.floor(c/3):c<this.NB_VERTICES-this.SPHERE_SEGMENTS*As?s=Math.floor((c/3-this.SPHERE_SEGMENTS)/2)+this.SPHERE_SEGMENTS:s=Math.floor((c-this.NB_VERTICES-this.SPHERE_SEGMENTS*As)/3)+this.SPHERE_HORIZONTAL_SEGMENTS*(this.SPHERE_SEGMENTS-1);const f=Math.floor(s/this.SPHERE_SEGMENTS),g=s-f*this.SPHERE_SEGMENTS;let _=r;for(;_;){const x=Math.floor(f/_.facesByRow),C=Math.floor(g/_.facesByCol);let E=Mb.angleTo(this.viewer.state.direction);(x===0||x===_.rows-1)&&(E*=2);const A={row:x,col:C,angle:E,config:_,url:null},L=iP(A);if(a[L]){a[L].angle=Math.min(a[L].angle,E);break}else if(A.url=t.tileUrl(C,x,_.level),A.url){a[L]=A;break}else _=HTe(t,_.level-1,this)}}this.state.tileConfig=r,this.__loadTiles(Object.values(a))}__loadTiles(t){this.queue.disableAllTasks(),t.forEach(n=>{const r=iP(n);this.state.tiles[r]?this.queue.setPriority(r,n.angle):(this.state.tiles[r]=!0,this.queue.enqueue(new FTe(r,n.angle,i=>this.__loadTile(n,i))))}),this.queue.start()}__loadTile(t,n){return this.viewer.textureLoader.loadImage(t.url,null,this.viewer.state.textureData.cacheKey).then(r=>{if(!n.isCancelled()){this.config.debug&&(r=jTe(r,t.config.level,iP(t)));const i=this.config.antialias&&t.config.level>0,a=new Gh({map:Dn.createTexture(r,i)});this.__swapMaterial(t,a,!1),this.viewer.needsUpdate()}}).catch(r=>{!Dn.isAbortError(r)&&!n.isCancelled()&&this.config.showErrorTile&&(this.state.errorMaterial||(this.state.errorMaterial=$Te()),this.__swapMaterial(t,this.state.errorMaterial,!0),this.viewer.needsUpdate())})}__swapMaterial(t,n,r){const i=this.state.geom.getAttribute(qTe);for(let a=0;a<t.config.facesByCol;a++)for(let c=0;c<t.config.facesByRow;c++){const s=t.col*t.config.facesByCol+a,f=t.row*t.config.facesByRow+c,g=f===0,_=f===this.SPHERE_HORIZONTAL_SEGMENTS-1;let x;if(g?x=s*As:_?x=this.NB_VERTICES-this.SPHERE_SEGMENTS*As+s*As:x=this.SPHERE_SEGMENTS*As+(f-1)*this.SPHERE_SEGMENTS*P0+s*P0,r&&this.state.faces[x]>dB||this.state.faces[x]>t.config.level)continue;this.state.faces[x]=r?dB:t.config.level;const C=this.state.geom.groups.find(T=>T.start===x).materialIndex;this.state.materials[C]=n;const E=1-c/t.config.facesByRow,A=1-(c+1)/t.config.facesByRow,L=a/t.config.facesByCol,I=(a+1)/t.config.facesByCol;g?(i.setXY(x,(L+I)/2,E),i.setXY(x+1,L,A),i.setXY(x+2,I,A)):_?(i.setXY(x,I,E),i.setXY(x+1,L,E),i.setXY(x+2,(L+I)/2,A)):(i.setXY(x,I,E),i.setXY(x+1,L,E),i.setXY(x+2,I,A),i.setXY(x+3,L,E),i.setXY(x+4,L,A),i.setXY(x+5,I,A))}i.needsUpdate=!0}__switchMesh(t){const[,n]=Sb(t);if(this.__cleanup(),this.state.materials=n.material,this.state.geom=n.geometry,this.config.debug){const r=VTe(this.state.geom);this.viewer.renderer.addObject(r),this.viewer.renderer.setSphereCorrection(this.viewer.config.sphereCorrection,r)}setTimeout(()=>this.__refresh())}__cleanup(){this.queue.clear(),this.state.tiles={},this.state.faces={},this.state.materials=[],this.state.inTransition=!1}};gC.id="equirectangular-tiles";gC.VERSION="5.13.4";gC.supportsDownload=!1;var pG=gC;function fB(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function YTe(e){if(Array.isArray(e))return e}function KTe(e,t,n){return(t=tPe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JTe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,i,a,c,s=[],f=!0,g=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;f=!1}else for(;!(f=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);f=!0);}catch(_){g=!0,i=_}finally{try{if(!f&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(g)throw i}}return s}}function QTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function OI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pB(Object(n),!0).forEach(function(r){KTe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pB(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vm(e,t){return YTe(e)||JTe(e,t)||nPe(e,t)||QTe()}function ePe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tPe(e){var t=ePe(e,"string");return typeof t=="symbol"?t:t+""}function ES(e){"@babel/helpers - typeof";return ES=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ES(e)}function nPe(e,t){if(e){if(typeof e=="string")return fB(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fB(e,t):void 0}}function rPe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var mG={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(f,g,_){this.fn=f,this.context=g,this.once=_||!1}function a(f,g,_,x,C){if(typeof _!="function")throw new TypeError("The listener must be a function");var E=new i(_,x||f,C),A=n?n+g:g;return f._events[A]?f._events[A].fn?f._events[A]=[f._events[A],E]:f._events[A].push(E):(f._events[A]=E,f._eventsCount++),f}function c(f,g){--f._eventsCount===0?f._events=new r:delete f._events[g]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var g=[],_,x;if(this._eventsCount===0)return g;for(x in _=this._events)t.call(_,x)&&g.push(n?x.slice(1):x);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(_)):g},s.prototype.listeners=function(g){var _=n?n+g:g,x=this._events[_];if(!x)return[];if(x.fn)return[x.fn];for(var C=0,E=x.length,A=new Array(E);C<E;C++)A[C]=x[C].fn;return A},s.prototype.listenerCount=function(g){var _=n?n+g:g,x=this._events[_];return x?x.fn?1:x.length:0},s.prototype.emit=function(g,_,x,C,E,A){var L=n?n+g:g;if(!this._events[L])return!1;var I=this._events[L],T=arguments.length,O,D;if(I.fn){switch(I.once&&this.removeListener(g,I.fn,void 0,!0),T){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,_),!0;case 3:return I.fn.call(I.context,_,x),!0;case 4:return I.fn.call(I.context,_,x,C),!0;case 5:return I.fn.call(I.context,_,x,C,E),!0;case 6:return I.fn.call(I.context,_,x,C,E,A),!0}for(D=1,O=new Array(T-1);D<T;D++)O[D-1]=arguments[D];I.fn.apply(I.context,O)}else{var U=I.length,H;for(D=0;D<U;D++)switch(I[D].once&&this.removeListener(g,I[D].fn,void 0,!0),T){case 1:I[D].fn.call(I[D].context);break;case 2:I[D].fn.call(I[D].context,_);break;case 3:I[D].fn.call(I[D].context,_,x);break;case 4:I[D].fn.call(I[D].context,_,x,C);break;default:if(!O)for(H=1,O=new Array(T-1);H<T;H++)O[H-1]=arguments[H];I[D].fn.apply(I[D].context,O)}}return!0},s.prototype.on=function(g,_,x){return a(this,g,_,x,!1)},s.prototype.once=function(g,_,x){return a(this,g,_,x,!0)},s.prototype.removeListener=function(g,_,x,C){var E=n?n+g:g;if(!this._events[E])return this;if(!_)return c(this,E),this;var A=this._events[E];if(A.fn)A.fn===_&&(!C||A.once)&&(!x||A.context===x)&&c(this,E);else{for(var L=0,I=[],T=A.length;L<T;L++)(A[L].fn!==_||C&&!A[L].once||x&&A[L].context!==x)&&I.push(A[L]);I.length?this._events[E]=I.length===1?I[0]:I:c(this,E)}return this},s.prototype.removeAllListeners=function(g){var _;return g?(_=n?n+g:g,this._events[_]&&c(this,_)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s})(mG);var iPe=mG.exports,oPe=rPe(iPe),Cb=new oPe,Is={on:function(t,n){return Cb.on(t,n)},once:function(t,n){return Cb.once(t,n)},off:function(t,n){return Cb.off(t,n)},emit:function(t,n){return Cb.emit(t,n)}};Object.freeze(Is);var sPe=["src","height","width","hideNavbarButton","containerClass","littlePlanet","onPositionChange","onZoomChange","onClick","onDblclick","onReady"],FI=["zoom","fullscreen"];function aPe(e){var t=OI({},e);for(var n in t)sPe.includes(n)&&delete t[n];return t}function lPe(e,t,n,r,i){return(e-t)*(i-r)/(n-t)+r}function mB(e){return e==null?FI:Array.isArray(e)?e:typeof e=="string"?e===""?!1:[e]:e?FI:!1}function cPe(){var e=$.useState(),t=vm(e,2),n=t[0],r=t[1],i=$.useCallback(function(a){a&&a!==n&&r(a)},[n]);return[n,i]}var XL=$.forwardRef(function(e,t){var n=cPe(),r=vm(n,2),i=r[0],a=r[1],c=$.useMemo(function(){return e},[e.panorama,e.src,e.size,e.canvasBackground,e.navbar,e.height,e.width,e.containerClass,e.hideNavbarButton||!0,e.littlePlanet,e.fishEye,e.lang,e.onPositionChange,e.onZoomChange,e.onClick,e.onDblclick,e.onReady,e.moveSpeed,e.zoomSpeed,e.moveInertia,e.mousewheel,e.mousemove,e.mousewheelCtrlKey,e.touchmoveTwoFingers,e.panoData,e.requestHeaders,e.withCredentials,e.keyboard,e.keyboardActions,e.plugins,e.adapter,e.sphereCorrection,e.minFov,e.maxFov,e.defaultZoomLvl,e.defaultYaw,e.defaultPitch,e.caption,e.description,e.downloadUrl,e.downloadName,e.loadingImg,e.loadingTxt,e.rendererParameters,e.defaultTransition]),s=$.useRef(null),f=130,g=$.useState(-90),_=vm(g,1),x=_[0],C=$.useState(2),E=vm(C,1),A=E[0],L=$.useState(0),I=vm(L,1),T=I[0],O=$.useState(FI),D=vm(O,2),U=D[0],H=D[1],V=$.useRef(!0);$.useEffect(function(){function Q(){var K=window.innerWidth/window.innerHeight;f=Math.floor(lPe(K,.5,1.8,140,115))}return window.addEventListener("resize",Q),Q(),function(){return window.removeEventListener("resize",Q)}},[]),$.useEffect(function(){if(i&&!s.current){var Q,K,N,re,ye,ge,Ve,Ie,ve,Se=new OTe(OI(OI({},aPe(c)),{},{container:i,panorama:c.panorama||c.src,size:{height:c.height,width:c.width||"100px"},fisheye:c.littlePlanet?A:c.fisheye||!1,minFov:(Q=c.minFov)!==null&&Q!==void 0?Q:30,maxFov:c.littlePlanet?f:(K=c.maxFov)!==null&&K!==void 0?K:90,defaultZoomLvl:c.littlePlanet?T:(N=c.defaultZoomLvl)!==null&&N!==void 0?N:50,defaultYaw:(re=c.defaultYaw)!==null&&re!==void 0?re:0,defaultPitch:c.littlePlanet?x:(ye=c.defaultPitch)!==null&&ye!==void 0?ye:0,sphereCorrection:c.sphereCorrection||{pan:0,tilt:0,roll:0},moveSpeed:c.moveSpeed||1,zoomSpeed:c.zoomSpeed||1,moveInertia:(ge=c.moveInertia)!==null&&ge!==void 0?ge:!0,mousewheel:c.littlePlanet?!1:(Ve=c.mousewheel)!==null&&Ve!==void 0?Ve:!0,mousemove:(Ie=c.mousemove)!==null&&Ie!==void 0?Ie:!0,mousewheelCtrlKey:c.mousewheelCtrlKey||!1,touchmoveTwoFingers:c.touchmoveTwoFingers||!1,panoData:c.panoData||void 0,requestHeaders:c.requestHeaders||void 0,withCredentials:c.withCredentials||!1,navbar:mB(c.navbar),lang:c.lang||{},keyboard:c.keyboard||"fullscreen",plugins:(ve=c.plugins)!==null&&ve!==void 0?ve:[]}));Se.addEventListener("ready",function(){c.onReady&&c.onReady(Se)},{once:!0}),Se.addEventListener("click",function(je){c.onClick&&c.onClick(je,Se),c.littlePlanet&&V.current&&(V.current=!1,Se.animate({yaw:0,pitch:x,zoom:75,speed:"3rpm"}).then(function(){Se.animate({yaw:0,pitch:0,zoom:90,speed:"10rpm"}).then(function(){var lt;Se.setOption("maxFov",c.maxFov||70),Se.setOption("mousewheel",(lt=c.mousewheel)!==null&&lt!==void 0?lt:!0)})}))}),Se.addEventListener("dblclick",function(je){c.onDblclick&&c.onDblclick(je,Se)}),Se.addEventListener("zoom-updated",function(je){c.onZoomChange&&c.onZoomChange(je,Se)}),Se.addEventListener("position-updated",function(je){c.onPositionChange&&c.onPositionChange(je.position.pitch,je.position.yaw,Se)});var Me=mB(c.navbar);if(c.littlePlanet){var Be,Qe,st=`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 20C16.4183 20 20 16.4183 20 12C20 11.8805 19.9974 11.7615 19.9922 11.6433C20.2479 11.4141 20.4882 11.1864 20.7118 10.9611C21.0037 10.6672 21.002 10.1923 20.708 9.90049C20.4336 9.628 20.0014 9.61143 19.7077 9.84972C19.4023 8.75248 18.8688 7.75024 18.1616 6.89725C18.4607 6.84611 18.7436 6.8084 19.0087 6.784C19.4212 6.74604 19.7247 6.38089 19.6868 5.96842C19.6488 5.55595 19.2837 5.25235 18.8712 5.29032C18.4474 5.32932 17.9972 5.39638 17.5262 5.48921C17.3267 5.52851 17.1614 5.64353 17.0543 5.79852C15.6765 4.67424 13.917 4 12 4C7.58172 4 4 7.58172 4 12C4 12.2776 4.01414 12.552 4.04175 12.8223C3.78987 12.7532 3.50899 12.8177 3.31137 13.0159C2.97651 13.3517 2.67596 13.6846 2.415 14.0113C2.15647 14.3349 2.20924 14.8069 2.53287 15.0654C2.8565 15.3239 3.32843 15.2711 3.58696 14.9475C3.78866 14.695 4.02466 14.4302 4.2938 14.1557C4.60754 15.2796 5.16056 16.3037 5.8945 17.1697C5.66824 17.3368 5.54578 17.6248 5.60398 17.919C5.68437 18.3253 6.07894 18.5896 6.48528 18.5092C6.7024 18.4662 6.92455 18.4177 7.15125 18.3637C8.49656 19.3903 10.1771 20 12 20ZM7.15125 18.3637C6.69042 18.012 6.26891 17.6114 5.8945 17.1697C5.98073 17.106 6.08204 17.0599 6.19417 17.0377C7.19089 16.8405 8.33112 16.5084 9.55581 16.0486C9.94359 15.903 10.376 16.0994 10.5216 16.4872C10.6671 16.8749 10.4708 17.3073 10.083 17.4529C9.05325 17.8395 8.0653 18.1459 7.15125 18.3637ZM19.7077 9.84972C19.6869 9.86663 19.6667 9.88483 19.6474 9.90431C18.9609 10.5957 18.0797 11.3337 17.0388 12.0753C16.7014 12.3157 16.6228 12.784 16.8631 13.1213C17.1035 13.4587 17.5718 13.5373 17.9091 13.297C18.6809 12.7471 19.3806 12.1912 19.9922 11.6433C19.965 11.0246 19.8676 10.4241 19.7077 9.84972ZM20.9366 5.37924C20.5336 5.28378 20.1294 5.53313 20.034 5.93619C19.9385 6.33925 20.1879 6.74339 20.5909 6.83886C20.985 6.93219 21.1368 7.07125 21.1932 7.16142C21.2565 7.26269 21.3262 7.52732 21.0363 8.10938C20.8516 8.48014 21.0025 8.93042 21.3732 9.1151C21.744 9.29979 22.1943 9.14894 22.379 8.77818C22.7566 8.02003 22.9422 7.12886 22.4648 6.36582C22.1206 5.81574 21.5416 5.52252 20.9366 5.37924ZM2.81481 16.2501C2.94057 15.8555 2.72259 15.4336 2.32793 15.3078C1.93327 15.1821 1.51138 15.4 1.38562 15.7947C1.19392 16.3963 1.17354 17.0573 1.53488 17.6349C1.98775 18.3587 2.84153 18.6413 3.68907 18.7224C4.1014 18.7619 4.46765 18.4596 4.50712 18.0473C4.54658 17.635 4.24432 17.2687 3.83199 17.2293C3.13763 17.1628 2.88355 16.9624 2.80651 16.8393C2.75679 16.7598 2.70479 16.5954 2.81481 16.2501ZM15.7504 14.704C16.106 14.4915 16.2218 14.0309 16.0093 13.6754C15.7967 13.3199 15.3362 13.204 14.9807 13.4166C14.4991 13.7045 13.9974 13.9881 13.4781 14.2648C12.9445 14.5491 12.4132 14.8149 11.8883 15.0615C11.5134 15.2376 11.3522 15.6843 11.5283 16.0592C11.7044 16.4341 12.1511 16.5953 12.526 16.4192C13.0739 16.1618 13.6277 15.8847 14.1834 15.5887C14.7242 15.3005 15.2474 15.0048 15.7504 14.704Z" fill="rgba(255,255,255,.7)"/>
                </svg>`,ct={id:"resetLittlePlanetButton",content:((Be=e.lang)===null||Be===void 0?void 0:Be.littlePlanetIcon)||st,title:((Qe=e.lang)===null||Qe===void 0?void 0:Qe.littlePlanetButton)||"Reset Little Planet",className:"resetLittlePlanetButton",onClick:function(){V.current=!0,Se.setOption("maxFov",f),Se.setOption("mousewheel",!1),Se.animate({yaw:0,pitch:x,zoom:T,speed:"10rpm"})}};Me!==!1&&!Me.find(function(je){return ES(je)==="object"&&(je==null?void 0:je.id)==="resetLittlePlanetButton"})&&Me.splice(1,0,ct)}if(c.hideNavbarButton){var Xt={id:"hideNavbarButton",content:`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                            <g clip-path="url(#clip0_429_11083)">
                            <path d="M7 7.00006L17 17.0001M7 17.0001L17 7.00006" stroke="rgba(255,255,255,.7)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                            <clipPath id="clip0_429_11083">
                            <rect width="24" height="24" fill="white"/>
                            </clipPath>
                            </defs>
                            </svg>`,title:"Hide Navbar",className:"hideNavbarButton",onClick:function(){Se.navbar.hide();var lt=document.createElement("a");lt.className="showNavbarButton",lt.innerHTML=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 26 26" style="enable-background:new 0 0 26 26;" xml:space="preserve" class="icon icon-back-to-top">
                                        <g>
                                        <path d="M13.8,1.3L21.6,9c0.1,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.1,0.3,0.1,0.4s0,0.3-0.1,0.4c-0.1,0.1-0.1,0.3-0.3,0.4
                                            c-0.1,0.1-0.2,0.2-0.4,0.3c-0.2,0.1-0.3,0.1-0.4,0.1c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.3-0.2-0.4-0.3L14.2,5l0,19.1
                                            c0,0.2-0.1,0.3-0.1,0.5c0,0.1-0.1,0.3-0.3,0.4c-0.1,0.1-0.2,0.2-0.4,0.3c-0.1,0.1-0.3,0.1-0.5,0.1c-0.1,0-0.3,0-0.4-0.1
                                            c-0.1-0.1-0.3-0.1-0.4-0.3c-0.1-0.1-0.2-0.2-0.3-0.4c-0.1-0.1-0.1-0.3-0.1-0.5l0-19.1l-5.7,5.7C6,10.8,5.8,10.9,5.7,11
                                            c-0.1,0.1-0.3,0.1-0.4,0.1c-0.2,0-0.3,0-0.4-0.1c-0.1-0.1-0.3-0.2-0.4-0.3c-0.1-0.1-0.1-0.2-0.2-0.4C4.1,10.2,4,10.1,4.1,9.9
                                            c0-0.1,0-0.3,0.1-0.4c0-0.1,0.1-0.3,0.3-0.4l7.7-7.8c0.1,0,0.2-0.1,0.2-0.1c0,0,0.1-0.1,0.2-0.1c0.1,0,0.2,0,0.2-0.1
                                            c0.1,0,0.1,0,0.2,0c0,0,0.1,0,0.2,0c0.1,0,0.2,0,0.2,0.1c0.1,0,0.1,0.1,0.2,0.1C13.7,1.2,13.8,1.2,13.8,1.3z"></path>
                                        </g>
                                        </svg>`,lt.title="Show Navbar",lt.onclick=function(Ot){Ot.preventDefault(),Se.navbar.show(),lt.remove()},document.body.appendChild(lt)}};Me!==!1&&!Me.find(function(je){return ES(je)==="object"&&(je==null?void 0:je.id)==="hideNavbarButton"})&&Me.push(Xt)}Me!==!1?(Se.setOption("navbar",Me),H(Me)):Se.navbar.hide(),Is.on("animate",function(je){Se.animate(je)}).on("stop-animation",function(){Se.stopAnimation()}).on("destroy",function(){Se.destroy()}).on("rotate",function(je){Se.rotate(je)}).on("setOption",function(je){var lt=je.option,Ot=je.value;Se.setOption(lt,Ot)}).on("setOptions",function(je){Se.setOptions(je)}).on("zoom",function(je){Se.zoom(je)}).on("zoomIn",function(je){Se.zoomIn(je)}).on("zoomOut",function(je){Se.zoomOut(je)}).on("resize",function(je){Se.resize(je)}).on("enterFullscreen",function(){Se.enterFullscreen()}).on("exitFullscreen",function(){Se.exitFullscreen()}).on("toggleFullscreen",function(){Se.toggleFullscreen()}).on("needsContinuousUpdate",function(je){Se.needsContinuousUpdate(je)}).on("observeObjects",function(je){Se.observeObjects(je)}).on("unobserveObjects",function(je){Se.unobserveObjects(je)}).on("setCursor",function(je){Se.setCursor(je)}).on("setPanorama",function(je){Se.setPanorama(je.path,je.options)}).on("showError",function(je){Se.showError(je)}).on("hideError",function(){Se.hideError()}).on("startKeyboardControl",function(){Se.startKeyboardControl()}).on("stopKeyboardControl",function(){Se.stopKeyboardControl()}),s.current=Se}},[i,c]),$.useEffect(function(){var Q=s.current;if(Q&&Q.container&&Q.container.parentNode&&Q&&Q.container&&Q.container.parentNode){var K,N,re,ye;(K=Q.renderer)===null||K===void 0||(N=K.renderer)===null||N===void 0||N.dispose(),(re=Q.renderer)===null||re===void 0||(ye=re.renderer)===null||ye===void 0||ye.forceContextLoss(),Q.destroy()}},[s]),$.useEffect(function(){var Q,K=(Q=c.panorama)!==null&&Q!==void 0?Q:c.src;s.current&&K&&s.current.setPanorama(K,{})},[c.src,c.panorama]);var q=function(){return{animate:function(N){Is.emit("animate",N)},destroy:function(){Is.emit("destroy",{})},createTooltip:function(N){var re;return(re=s.current)===null||re===void 0?void 0:re.createTooltip(N)},needsContinuousUpdate:function(N){Is.emit("needsContinuousUpdate",N)},observeObjects:function(N){Is.emit("observeObjects",N)},unobserveObjects:function(N){Is.emit("unobserveObjects",N)},setCursor:function(N){Is.emit("setCursor",N)},stopAnimation:function(){Is.emit("stop-animation",{})},rotate:function(N){Is.emit("rotate",N)},setOption:function(N,re){Is.emit("setOption",{option:N,value:re})},setOptions:function(N){var re;return(re=s.current)===null||re===void 0?void 0:re.setOptions(N)},getCurrentNavbar:function(){return U},zoom:function(N){Is.emit("zoom",N)},zoomIn:function(N){Is.emit("zoomIn",{step:N})},zoomOut:function(N){Is.emit("zoomOut",{step:N})},resize:function(N){var re;return(re=s.current)===null||re===void 0?void 0:re.resize(N)},enterFullscreen:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.enterFullscreen()},exitFullscreen:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.exitFullscreen()},toggleFullscreen:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.toggleFullscreen()},isFullscreenEnabled:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.isFullscreenEnabled()},getPlugin:function(N){var re;return(re=s.current)===null||re===void 0?void 0:re.getPlugin(N)},getPosition:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.getPosition()},getZoomLevel:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.getZoomLevel()},getSize:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.getSize()},needsUpdate:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.needsUpdate()},autoSize:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.autoSize()},setPanorama:function(N,re){var ye;return(ye=s.current)===null||ye===void 0?void 0:ye.setPanorama(N,re)},showError:function(N){var re;return(re=s.current)===null||re===void 0?void 0:re.showError(N)},hideError:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.hideError()},startKeyboardControl:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.startKeyboardControl()},stopKeyboardControl:function(){var N;return(N=s.current)===null||N===void 0?void 0:N.stopKeyboardControl()}}};return $.useImperativeHandle(t,q,[s.current,i,c,t]),W0.createElement("div",{className:c.containerClass||"view-container",ref:a})});XL.displayName="ReactPhotoSphereViewer";const uPe=(e,t)=>({width:8192,cols:16,rows:8,baseUrl:`${e}/${t}_thumb.jpg`,tileUrl:(n,r)=>`${e}/${t}_${n}_${r}.jpg`}),hPe=e=>{const{panorama:t,tileRootUrl:n,pixelRootUrl:r,mode:i="light"}=e,a=$.useRef(null),c=$.useRef(null),s=(f,g)=>{var _;return(_=c.current)==null?void 0:_.setRotation(g/Math.PI*180)};return te.jsxs(te.Fragment,{children:[te.jsx(XL,{adapter:pG,src:uPe(r,t.id),height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:s,defaultYaw:e.panorama.yaw??0}),te.jsxs(dA,{sx:{position:"absolute",m:2.5,top:0,left:0,background:"#000a"},color:"neutral",invertedColors:!0,variant:"solid",children:[te.jsx(ci,{level:"title-lg",children:t.label}),te.jsx(e_,{}),te.jsxs(ja,{direction:"row",gap:2,children:[te.jsx(ci,{level:"body-xs",children:"August 2025"}),te.jsx(e_,{orientation:"vertical"}),te.jsx(ci,{level:"body-xs",children:"ATS v1.55.2.2"})]})]}),te.jsx("div",{className:"credits",children:"Images © SCS Software. Captured by Trucker Mudgeon."}),te.jsxs(YM,{ref:a,style:{position:"absolute",left:20,bottom:20,width:"200px",height:"200px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:9,maxZoom:14,maxBounds:[t.point.map(f=>f-1),t.point.map(f=>f+1)],mapStyle:QM,attributionControl:!1,initialViewState:{longitude:t.point[0],latitude:t.point[1],zoom:10},children:[te.jsx(Z3,{ref:c,longitude:t.point[0],latitude:t.point[1],rotation:(t.yaw??0)/Math.PI*180,rotationAlignment:"map",children:te.jsx("div",{className:"street-view-marker"})}),te.jsx(JM,{tileRootUrl:n,mode:i}),te.jsx(bg,{tileRootUrl:n,game:"ats",mode:i,enableIconAutoHide:!0,visibleIcons:Bh,dlcs:Rf}),te.jsx(bg,{tileRootUrl:n,game:"ets2",mode:i,enableIconAutoHide:!0,visibleIcons:Bh})]})]})},gG=8192,ym=512,dPe=gG/360,gB=gG/ym,lm=100,fPe=e=>{const{pixelRootUrl:t,panorama:n}=e,r=sj(n.yaw??0)*180/Math.PI+180,i=Math.floor(dPe*r);let a,c;return i%ym<ym/2?(c=Math.floor(i/ym),a=c===0?gB-1:c-1):(a=Math.floor(i/ym),c=a===gB-1?0:a+1),te.jsx("div",{style:{overflow:"hidden",width:lm},children:te.jsxs("div",{style:{display:"flex",position:"relative",left:-r*lm/ym},children:[te.jsx("img",{width:lm,height:lm,src:`${t}/${n.id}_${a}_3.jpg`}),te.jsx("img",{width:lm,height:lm,src:`${t}/${n.id}_${c}_3.jpg`})]})})},vB=(e,[t,n])=>!isNaN(e)&&t<=e&&e<=n,pPe=e=>{const{tileRootUrl:t,pixelRootUrl:n}=e,{mode:r,systemMode:i}=_R(),a=r==="system"?i:r,{longitude:c,latitude:s}=sw[mPe(localStorage.getItem("tm-map"))],[f]=oce(),g=Number(f.get("mlat")??void 0),_=Number(f.get("mlon")??void 0),x=vB(g,[-90,90])&&vB(_,[-180,180])?{lat:g,lon:_}:void 0,C=new Set([...Bh].filter(Be=>!KV.includes(Be))),[E,A]=$.useState(!0),[L,I]=$.useState(C),[T,O]=$.useState(new Set(Rf)),D=w9(T),U=hS(L,I,Bh),H=hS(T,O,Rf),[V,q]=$.useState(!1),[Q,K]=$.useState(!1),N=$.useRef(null),[re,ye]=$.useState(!1),[ge,Ve]=$.useState(null),[Ie,ve]=$.useState(null),Se=$.useCallback(()=>Ve(null),[]);$.useEffect(()=>{if(!N.current||!re||!Q)return;const Be=N.current,Qe=Xt=>{const je=Be.queryRenderedFeatures(Xt.point,{layers:["photo-spheres"]})[0];if(Be.getCanvas().style.cursor=je?"pointer":"",je){if((Ie==null?void 0:Ie.id)!==je.properties.id){const lt=je;ve({id:lt.properties.id,point:lt.geometry.coordinates,yaw:lt.properties.yaw,label:lt.properties.label})}}else Ie&&ve(null)},st=Xt=>{const je=Be.queryRenderedFeatures(Xt.point,{layers:["photo-spheres"]})[0];!je||je.properties.cluster===!0||(ve(null),Ve(Ie))},ct=Xt=>{ge!=null&&Xt.key==="Escape"&&Ve(null)};return ge&&document.addEventListener("keydown",ct),Be.on("mousemove",Qe),Be.on("click",st),()=>{Be.off("mousemove",Qe),Be.off("click",st),document.removeEventListener("keydown",ct)}},[N.current,re,ge,Ie,Q]);const Me=te.jsxs(YM,{ref:N,style:{width:"100svw",height:"100svh",display:ge?"none":void 0},hash:!0,minZoom:4,maxZoom:15,mapStyle:QM,attributionControl:!1,initialViewState:{longitude:c,latitude:s,zoom:4},children:[x&&te.jsx(Z3,{longitude:x.lon,latitude:x.lat}),te.jsxs(JM,{tileRootUrl:t,mode:a,children:[te.jsx(CA,{tileRootUrl:t,game:"ats",showContours:V}),te.jsx(CA,{tileRootUrl:t,game:"ets2",showContours:V})]}),te.jsx(bg,{tileRootUrl:t,game:"ats",mode:a,enableIconAutoHide:E,visibleIcons:L,dlcs:T}),te.jsx(bg,{tileRootUrl:t,game:"ets2",mode:a,enableIconAutoHide:E,visibleIcons:L}),L.has(Pi.CityNames)&&te.jsx(TA,{game:"ats",mode:a,enableAutoHide:E,enabledStates:D}),L.has(Pi.CityNames)&&te.jsx(TA,{game:"ets2",mode:a,enableAutoHide:E}),Q&&re&&te.jsxs(Nh,{id:"street-view",type:"geojson",data:"/street-view.geojson",cluster:!1,clusterMaxZoom:7,clusterRadius:10,children:[te.jsx(fr,{id:"photo-spheres-halo",type:"circle",paint:{"circle-radius":10,"circle-color":a==="light"?"#fff8":"#8884","circle-blur":.75},filter:["in","$type","Point"]}),te.jsx(fr,{id:"photo-spheres",type:"circle",paint:{"circle-radius":5,"circle-color":"#48f2","circle-stroke-width":2,"circle-stroke-color":"#48f"},filter:["in","$type","Point"]})]}),te.jsxs(Nh,{id:"measure",type:"geojson",data:{type:"FeatureCollection",features:[]},children:[te.jsx(fr,{id:"measure-lines",type:"line",paint:{"line-color":"#f00","line-width":3,"line-opacity":1},filter:["in","$type","LineString"]}),te.jsx(fr,{id:"measure-points",type:"circle",paint:{"circle-radius":5,"circle-color":"#fff","circle-stroke-width":3,"circle-stroke-color":"#f00"},filter:["in","$type","Point"]})]}),te.jsx(kV,{visualizePitch:!0}),te.jsx(mbe,{visible:Q,onToggle:ye}),te.jsx(LV,{containerId:"fsElem"}),te.jsx(gbe,{}),te.jsx(Dj,{}),te.jsx(RV,{compact:!0,style:{marginLeft:54},customAttribution:"© Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a> and <a href='https://forum.scssoft.com/viewtopic.php?p=1946956#p1946956'>krmarci</a>."}),te.jsx(dbe,{visibleStates:D,visibleStateDlcs:T}),te.jsx(kj,{icons:{...U,enableAutoHiding:E,onAutoHidingToggle:A},advanced:{showContours:V,onContoursToggle:q,showPhotoSpheresUi:Q,onPhotoSpheresToggleUi:K},atsDlcs:H}),Ie&&te.jsx(Whe,{className:"pano-preview-popup",closeButton:!1,closeOnClick:!1,closeOnMove:!0,longitude:Ie.point[0],latitude:Ie.point[1],children:te.jsx(fPe,{panorama:Ie,pixelRootUrl:n})}),te.jsx(m0e,{})]});return te.jsxs(te.Fragment,{children:[Me,ge&&te.jsxs(te.Fragment,{children:[te.jsx(hPe,{tileRootUrl:t,pixelRootUrl:n,panorama:ge,mode:a}),te.jsx(lu,{sx:{background:"#000a",position:"absolute",borderRadius:"50%",m:2.5,top:0,right:0},size:"lg",variant:"solid",onClick:Se,children:te.jsx(X3,{})})]})]})};function mPe(e){return e==="europe"?e:"usa"}var gPe=Object.defineProperty,vPe=(e,t,n)=>t in e?gPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yPe=(e,t,n)=>(vPe(e,t+"",n),n);class _Pe{constructor(t){yPe(this,"_kind"),this._kind=t}}function xPe(e,t){const n=e.toString(),r=t.toString();return n>r?1:n<r?-1:0}const bPe=xPe;var wPe=Object.defineProperty,SPe=(e,t,n)=>t in e?wPe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yB=(e,t,n)=>(SPe(e,typeof t!="symbol"?t+"":t,n),n);function MPe(e,t,n){const r=t*2,i=t*2+1;let a=t;return r<e.length&&n(e[a],e[r])<0&&(a=r),i<e.length&&n(e[a],e[i])<0&&(a=i),a}function ZL(e,t,n){const r=MPe(e,t,n);if(r!==t){const i=e[t];e[t]=e[r],e[r]=i,ZL(e,r,n)}}function _B(e){for(let t=Math.floor(e.collection.length/2)-1;t>=0;--t)ZL(e.collection,t,e.comparator)}class TS extends _Pe{constructor({comparator:t=bPe}={}){super("BinaryHeap"),yB(this,"comparator"),yB(this,"collection",[]),this.comparator=t}static from(t,n={}){const r=new TS(n);return r.collection=Array.from(t),_B(r),r}clear(){this.collection.length=0}toArray(){return[...this.collection].sort(this.comparator)}get length(){return this.collection.length}top(){if(this.length===0)throw new Error("invalid operation: top() called for empty BinaryHeap");return this.collection[0]}pop(){if(this.length===0)throw new Error("invalid operation: pop() called for empty BinaryHeap");const t=this.collection[0];return this.collection.length>1?(this.collection[0]=this.collection.pop(),ZL(this.collection,0,this.comparator)):this.collection.pop(),t}push(t){this.collection.push(t);const n=this.collection;for(let r=n.length-1,i=Math.floor(r/2);r>0&&this.comparator(n[i],n[r])<0;r=i,i=Math.floor(i/2)){const a=n[r];n[r]=n[i],n[i]=a}}merge(t){t instanceof TS?this.collection=this.collection.concat(t.collection):this.collection=this.collection.concat(t.toArray()),_B(this),t.clear()}isEmpty(){return!this.collection.length}}function CPe(e,t,n,r,i){const a=`${e}-${t}-${n}-${r}`,{nodeLUT:c,graph:s}=i,f=nr(c.get(e)),g=nr(c.get(t)),_=new TPe({comparator:(O,D)=>{const U=I.get(O)??1/0;return(I.get(D)??1/0)-U}}),x={nodeUid:e,distance:0,direction:n,dlcGuard:-1};_.push(x);const C=new Map,E=new Map;E.set(x,0);const A=O=>ij(O,g),L=(O,D)=>{switch(r){case"shortest":return D.distance;case"smallRoads":return D.isOneLaneRoad?D.distance:D.distance*10;default:throw new W_(r)}},I=new Map;I.set(x,A(f));let T=0;for(;!_.isEmpty();){T++;const O=_.pop();if(O.nodeUid===t)return{success:!0,key:a,mode:r,...EPe(C,O)};const D=s.get(O.nodeUid);if(!D)continue;const U=O.direction==="forward"?D.forward:D.backward;for(const H of U){if(!i.enabledDlcGuards.has(H.dlcGuard))continue;const V=(E.get(O)??1/0)+L(O,H);V<(E.get(H)??1/0)&&(C.set(H,O),E.set(H,V),I.set(H,V+A(nr(c.get(H.nodeUid)))),_.has(H)||_.push(H))}}return{success:!1,key:a,mode:r,numIters:T}}function EPe(e,t){let n=0;const r=[t];for(;e.has(t);)t=e.get(t),r.unshift(t),n+=t.distance;return r.length===1&&r.push(r[0]),{route:r,distance:n}}class TPe extends TS{constructor(n){super(n);ND(this,"items",new Set)}has(n){return this.items.has(n)}push(n){Lf.checkState(!this.items.has(n)),super.push(n),this.items.add(n)}pop(){const n=super.pop();return Lf.checkState(this.items.has(n)),this.items.delete(n),n}clear(){super.clear(),this.items.clear()}merge(n){super.merge(n);for(const r of this.collection)this.items.add(r)}}const PPe=e=>{const{tileRootUrl:t}=e,{mode:n,systemMode:r}=_R(),i=n==="system"?r:n,[a,c]=$.useState(!0),[s,f]=$.useState(new Set(Bh)),[g,_]=$.useState(new Set(Rf)),x=w9(g),C=hS(s,f,Bh),E=hS(g,_,Rf),[A,L]=$.useState(!1);return te.jsxs(YM,{style:{width:"100vw",height:"100vh"},minZoom:4,maxZoom:15,maxBounds:[[-135,21],[-84,54]],mapStyle:QM,attributionControl:!1,initialViewState:{longitude:-115,latitude:36,zoom:9},children:[te.jsx(JM,{tileRootUrl:t,mode:i,children:te.jsx(CA,{tileRootUrl:t,game:"ats",showContours:A})}),te.jsx(bg,{tileRootUrl:t,game:"ats",mode:i,enableIconAutoHide:a,visibleIcons:s,dlcs:g}),te.jsx(TA,{game:"ats",mode:i,enableAutoHide:a,enabledStates:x}),te.jsx(Nh,{id:"route1",type:"geojson",data:{type:"FeatureCollection",features:[]},children:te.jsx(fr,{type:"line",paint:{"line-color":["match",["get","mode"],"shortest","#f00","smallRoads","#0f0","#f0f"],"line-width":3,"line-opacity":.7}})}),te.jsx(kV,{visualizePitch:!0}),te.jsx(LV,{}),te.jsx(Dj,{}),te.jsx(RV,{compact:!0,customAttribution:"© Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a>."}),te.jsx(APe,{dlcs:g}),te.jsx(kj,{icons:{...C,enableAutoHiding:a,onAutoHidingToggle:c},advanced:{showContours:A,onContoursToggle:L,showPhotoSpheresUi:!1,onPhotoSpheresToggleUi:()=>{}},atsDlcs:E})]})},APe=e=>{const{current:t}=ZM(),n=H_(e.dlcs),[r,i]=$.useState(void 0),[a,c]=$.useState(void 0),[s,f]=$.useState([]),[g,_]=$.useState([]);$.useEffect(()=>{fetch("usa-graph-demo.json").then(q=>q.json()).then(q=>{f(q.demoCompanies.map(wB)),c(IPe(q)),i(q)},()=>console.error("could not load usa-graph-demo.json"))},[]);const[x,C]=$.useState(void 0),[E,A]=$.useState(void 0),L=$.useCallback(q=>{q=nr(q),C(q.value);let Q;if(r!=null){Q=nr(r.demoCompanies.find(re=>re.n===q.value));const K=nr(r.demoCompanyDefs.find(re=>re.t===Q.t)),N=new Set(K.d);_(r.demoCompanies.filter(re=>N.has(re.t)).map(wB))}if(!(t==null||a==null)&&(E!=null&&(nr(t.getSource("route1")).setData({type:"FeatureCollection",features:[]}),A(void 0)),Q)){const K=nr(a.nodeLUT.get(BigInt(parseInt(Q.n,36))));t.flyTo({curve:1,zoom:9,center:[K.x,K.y]})}},[t,E,a,r]),I=$.useCallback(q=>{q=nr(q),A(q.value),!(t==null||a==null)&&T(nr(x),q.value,t,{...a,enabledDlcGuards:n})},[t,x,a,e.dlcs]),T=(q,Q,K,N)=>{Promise.all([SB(q,Q,"shortest",N),SB(q,Q,"smallRoads",N)]).then(re=>{const ye=nr(K.getSource("route1"));if(re.some(Ve=>Ve==null)){alert("Cannot calculate a route 🙁"),ye.setData({type:"FeatureCollection",features:[]});return}const ge=re;ye.setData({type:"FeatureCollection",features:ge}),K.fitBounds(oj(ge.flatMap(Ve=>Ve.geometry.coordinates)),{padding:150,curve:1,duration:2500})},re=>{console.error("error finding route",re)})},O=new Map;if(r)for(const[,q]of r.demoGraph)for(const Q of[...q.b??[],...q.f??[]]){const K=O.get(Q.n)??0;O.set(Q.n,K||Q.g)}const D=q=>{if(a==null)return!0;const Q=nr(O.get(q.value));return n.has(Q)},U=(q,Q)=>q.city!==Q.city?q.city.localeCompare(Q.city):q.label.localeCompare(Q.label),H=s.filter(D).sort(U),V=g.filter(D).sort(U);return te.jsxs("div",{style:{width:300,margin:20,display:"grid",position:"relative",gridTemplateColumns:"100px auto",alignItems:"center"},children:[te.jsx("h2",{children:"Start"}),te.jsx(Qy,{options:H,onChange:(q,Q)=>Q&&L(Q),groupBy:q=>q.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,renderGroup:xB}),te.jsx("h2",{children:"End"}),te.jsx(Qy,{options:V,onChange:(q,Q)=>Q&&I(Q),groupBy:q=>q.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,disabled:x==null,renderGroup:xB},x)]})};function xB(e){return te.jsxs(te.Fragment,{children:[te.jsx(ci,{m:1,level:"body-xs",textTransform:"uppercase",children:e.group}),te.jsx(D_,{children:e.children}),te.jsx(Zw,{})]})}function IPe(e){const t=new Map,n=new Map;for(const[r,i]of e.demoGraph)t.set(BigInt(parseInt(r,36)),{forward:(i.f??[]).map(bB),backward:(i.b??[]).map(bB)});for(const[r,i]of e.demoNodes)n.set(BigInt(parseInt(r,36)),{x:i[0],y:i[1]});return{graph:t,nodeLUT:n}}function bB(e){return{nodeUid:BigInt(parseInt(e.n,36)),distance:e.l,isOneLaneRoad:e.o,direction:e.d==="f"?"forward":"backward",dlcGuard:e.g}}function wB(e){return{label:e.t,city:e.c,value:e.n}}function SB(e,t,n,r){return new Promise(i=>{const a=CPe(BigInt(parseInt(e,36)),BigInt(parseInt(t,36)),"forward",n,r);if(!a.success){i(void 0);return}i({type:"Feature",geometry:{type:"LineString",coordinates:a.route.map(c=>{const s=nr(r.nodeLUT.get(c.nodeUid));return[s.x,s.y]})},properties:{distance:a.distance,mode:n}})})}/*!
 * Photo Sphere Viewer / Markers Plugin 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var RPe=Object.defineProperty,LPe=(e,t)=>{for(var n in t)RPe(e,n,{get:t[n],enumerable:!0})},kPe={};LPe(kPe,{EnterMarkerEvent:()=>TG,GotoMarkerDoneEvent:()=>NI,HideMarkersEvent:()=>Ty,LeaveMarkerEvent:()=>MG,MarkerVisibilityEvent:()=>_G,MarkersPluginEvent:()=>nl,RenderMarkersListEvent:()=>WG,SelectMarkerEvent:()=>IG,SelectMarkerListEvent:()=>kG,SetMarkersEvent:()=>$G,ShowMarkersEvent:()=>Py,UnselectMarkerEvent:()=>OG});var nl=class extends ux{},vG=class yG extends nl{constructor(t,n){super(yG.type),this.marker=t,this.visible=n}};vG.type="marker-visibility";var _G=vG,xG=class bG extends nl{constructor(t){super(bG.type),this.marker=t}};xG.type="goto-marker-done";var NI=xG,wG=class SG extends nl{constructor(t){super(SG.type),this.marker=t}};wG.type="leave-marker";var MG=wG,CG=class EG extends nl{constructor(t){super(EG.type),this.marker=t}};CG.type="enter-marker";var TG=CG,PG=class AG extends nl{constructor(t,n,r){super(AG.type),this.marker=t,this.doubleClick=n,this.rightClick=r}};PG.type="select-marker";var IG=PG,RG=class LG extends nl{constructor(t){super(LG.type),this.marker=t}};RG.type="select-marker-list";var kG=RG,DG=class zG extends nl{constructor(t){super(zG.type),this.marker=t}};DG.type="unselect-marker";var OG=DG,FG=class NG extends nl{constructor(){super(NG.type)}};FG.type="hide-markers";var Ty=FG,BG=class UG extends nl{constructor(t){super(UG.type),this.markers=t}};BG.type="set-markers";var $G=BG,VG=class jG extends nl{constructor(){super(jG.type)}};VG.type="show-markers";var Py=VG,HG=class GG extends nl{constructor(t){super(GG.type),this.markers=t}};HG.type="render-markers-list";var WG=HG,DPe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,m_=class extends _s{constructor(e){super(e,{className:"psv-markers-button",icon:DPe,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(Py.type,this),this.plugin.addEventListener(Ty.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(Py.type,this),this.plugin.removeEventListener(Ty.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(e){e instanceof Py?this.toggleActive(!0):e instanceof Ty&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};m_.id="markers";var qG=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,PS="http://www.w3.org/2000/svg",fi="psvMarker",zPe=Dn.dasherize(fi),A0="marker",_m="markersList",BI={amount:2,duration:100,easing:"linear"},OPe=(e,t)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
    <h1 class="psv-panel-menu-title">${qG} ${t}</h1>
    <ul class="psv-panel-menu-list">
    ${e.map(n=>`
        <li data-${zPe}="${n.id}" class="psv-panel-menu-item" tabindex="0">
          ${n.type==="image"?`<span class="psv-panel-menu-item-icon"><img src="${n.definition}"/></span>`:""}
          <span class="psv-panel-menu-item-label">${n.getListContent()}</span>
        </li>
    `).join("")}
    </ul>
</div>
`,vC=class extends _s{constructor(e){super(e,{className:" psv-markers-list-button",icon:qG,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(Fn.ShowPanelEvent.type,this),this.viewer.addEventListener(Fn.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(Fn.ShowPanelEvent.type,this),this.viewer.removeEventListener(Fn.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(e){e instanceof Fn.ShowPanelEvent?this.toggleActive(e.panelId===_m):e instanceof Fn.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};vC.id="markersList";var MB=new dt,FPe=new id,CB=new dt,NPe=class extends Ho{constructor(t=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof n.element.ownerDocument.defaultView.Element&&n.element.parentNode!==null&&n.element.remove()})})}copy(t,n){return super.copy(t,n),this.element=t.element.cloneNode(!0),this}},Ql=new Vr,BPe=new Vr,UPe=class{constructor(t={}){const n=this;let r,i,a,c;const s={camera:{style:""},objects:new WeakMap},f=t.element!==void 0?t.element:document.createElement("div");f.style.overflow="hidden",this.domElement=f;const g=document.createElement("div");g.style.transformOrigin="0 0",g.style.pointerEvents="none",f.appendChild(g);const _=document.createElement("div");_.style.transformStyle="preserve-3d",g.appendChild(_),this.getSize=function(){return{width:r,height:i}},this.render=function(I,T){const O=T.projectionMatrix.elements[5]*c;T.view&&T.view.enabled?(g.style.transform=`translate( ${-T.view.offsetX*(r/T.view.width)}px, ${-T.view.offsetY*(i/T.view.height)}px )`,g.style.transform+=`scale( ${T.view.fullWidth/T.view.width}, ${T.view.fullHeight/T.view.height} )`):g.style.transform="",I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld(),T.parent===null&&T.matrixWorldAutoUpdate===!0&&T.updateMatrixWorld();let D,U;T.isOrthographicCamera&&(D=-(T.right+T.left)/2,U=(T.top+T.bottom)/2);const H=T.view&&T.view.enabled?T.view.height/T.view.fullHeight:1,V=T.isOrthographicCamera?`scale( ${H} )scale(`+O+")translate("+x(D)+"px,"+x(U)+"px)"+C(T.matrixWorldInverse):`scale( ${H} )translateZ(`+O+"px)"+C(T.matrixWorldInverse),Q=(T.isPerspectiveCamera?"perspective("+O+"px) ":"")+V+"translate("+a+"px,"+c+"px)";s.camera.style!==Q&&(_.style.transform=Q,s.camera.style=Q),L(I,I,T)},this.setSize=function(I,T){r=I,i=T,a=r/2,c=i/2,f.style.width=I+"px",f.style.height=T+"px",g.style.width=I+"px",g.style.height=T+"px",_.style.width=I+"px",_.style.height=T+"px"};function x(I){return Math.abs(I)<1e-10?0:I}function C(I){const T=I.elements;return"matrix3d("+x(T[0])+","+x(-T[1])+","+x(T[2])+","+x(T[3])+","+x(T[4])+","+x(-T[5])+","+x(T[6])+","+x(T[7])+","+x(T[8])+","+x(-T[9])+","+x(T[10])+","+x(T[11])+","+x(T[12])+","+x(-T[13])+","+x(T[14])+","+x(T[15])+")"}function E(I){const T=I.elements;return"translate(-50%,-50%)"+("matrix3d("+x(T[0])+","+x(T[1])+","+x(T[2])+","+x(T[3])+","+x(-T[4])+","+x(-T[5])+","+x(-T[6])+","+x(-T[7])+","+x(T[8])+","+x(T[9])+","+x(T[10])+","+x(T[11])+","+x(T[12])+","+x(T[13])+","+x(T[14])+","+x(T[15])+")")}function A(I){I.isCSS3DObject&&(I.element.style.display="none");for(let T=0,O=I.children.length;T<O;T++)A(I.children[T])}function L(I,T,O,D){if(I.visible===!1){A(I);return}if(I.isCSS3DObject){const U=I.layers.test(O.layers)===!0,H=I.element;if(H.style.display=U===!0?"":"none",U===!0){I.onBeforeRender(n,T,O);let V;I.isCSS3DSprite?(Ql.copy(O.matrixWorldInverse),Ql.transpose(),I.rotation2D!==0&&Ql.multiply(BPe.makeRotationZ(I.rotation2D)),I.matrixWorld.decompose(MB,FPe,CB),Ql.setPosition(MB),Ql.scale(CB),Ql.elements[3]=0,Ql.elements[7]=0,Ql.elements[11]=0,Ql.elements[15]=1,V=E(Ql)):V=E(I.matrixWorld);const q=s.objects.get(I);if(q===void 0||q.style!==V){H.style.transform=V;const Q={style:V};s.objects.set(I,Q)}H.parentNode!==_&&_.appendChild(H),I.onAfterRender(n,T,O)}}for(let U=0,H=I.children.length;U<H;U++)L(I.children[U],T,O)}}},$Pe=class{constructor(e){this.viewer=e,this.element=document.createElement("div"),this.element.className="psv-markers-css3d-container",this.renderer=new UPe({element:this.element}),this.scene=new vS,this.intersectionObserver=new IntersectionObserver(t=>{t.forEach(n=>{const r=n.target[fi];r.config.visible&&(r.viewportIntersection=n.isIntersecting)})},{root:this.element}),e.addEventListener(Fn.ReadyEvent.type,this,{once:!0}),e.addEventListener(Fn.SizeUpdatedEvent.type,this),e.addEventListener(Fn.RenderEvent.type,this)}handleEvent(e){switch(e.type){case Fn.ReadyEvent.type:case Fn.SizeUpdatedEvent.type:this.updateSize();break;case Fn.RenderEvent.type:this.render();break}}destroy(){this.viewer.removeEventListener(Fn.ReadyEvent.type,this),this.viewer.removeEventListener(Fn.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(Fn.RenderEvent.type,this),this.intersectionObserver.disconnect()}updateSize(){const e=this.viewer.getSize();this.renderer.setSize(e.width,e.height)}render(){this.renderer.render(this.scene,this.viewer.renderer.camera)}addObject(e){this.scene.add(e.threeElement),this.intersectionObserver.observe(e.domElement)}removeObject(e){this.scene.remove(e.threeElement),this.intersectionObserver.unobserve(e.domElement)}},gw=(e=>(e.image="image",e.html="html",e.element="element",e.imageLayer="imageLayer",e.videoLayer="videoLayer",e.elementLayer="elementLayer",e.polygon="polygon",e.polygonPixels="polygonPixels",e.polyline="polyline",e.polylinePixels="polylinePixels",e.square="square",e.rect="rect",e.circle="circle",e.ellipse="ellipse",e.path="path",e))(gw||{});function UI(e,t=!1){const n=[];if(Object.keys(gw).forEach(r=>{e[r]&&n.push(r)}),n.length===0&&!t)throw new Sn(`missing marker content, either ${Object.keys(gw).join(", ")}`);if(n.length>1)throw new Sn(`multiple marker content, either ${Object.keys(gw).join(", ")}`);return n[0]}var XG=class{constructor(e,t,n){if(this.viewer=e,this.plugin=t,this.state={anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!n.id)throw new Sn("missing marker id");this.type=UI(n),this.createElement(),this.update(n)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return null}get threeElement(){return null}get video(){return null}destroy(){delete this.viewer,delete this.plugin,delete this.element,this.hideTooltip()}is3d(){return!1}isNormal(){return!1}isPoly(){return!1}isSvg(){return!1}isCss3d(){return!1}update(e){const t=UI(e,!0);if(t!==void 0&&t!==this.type)throw new Sn(`cannot change marker ${e.id} type`);if(this.config=Dn.deepmerge(this.config,e),typeof this.config.tooltip=="string"&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),Dn.isNil(this.config.visible)&&(this.config.visible=!0),Dn.isNil(this.config.zIndex)&&(this.config.zIndex=1),Dn.isNil(this.config.opacity)&&(this.config.opacity=1),this.config.rotation){const n=this.config.rotation;typeof n=="object"?this.config.rotation={yaw:n.yaw?Dn.parseAngle(n.yaw,!0,!1):0,pitch:n.pitch?Dn.parseAngle(n.pitch,!0,!1):0,roll:n.roll?Dn.parseAngle(n.roll,!0,!1):0}:this.config.rotation={yaw:0,pitch:0,roll:Dn.parseAngle(n,!0,!1)}}else this.config.rotation={yaw:0,pitch:0,roll:0};this.state.anchor=Dn.parsePoint(this.config.anchor)}getListContent(){var e;return this.config.listContent?this.config.listContent:(e=this.config.tooltip)!=null&&e.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(e,t,n=!1){var r;if(this.state.visible&&((r=this.config.tooltip)!=null&&r.content)&&this.state.position2D){const i={...this.config.tooltip,style:{pointerEvents:this.state.staticTooltip?"auto":"none"},data:this,top:0,left:0};if(this.isPoly()||this.is3d()||this.isCss3d())if(e||t){const a=Dn.getPosition(this.viewer.container);i.top=t-a.y+10,i.left=e-a.x,i.box={width:20,height:20}}else i.top=this.state.position2D.y,i.left=this.state.position2D.x;else{const a=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);let c=this.state.size.width,s=this.state.size.height;this.config.hoverScale&&!this.state.staticTooltip&&(c*=this.config.hoverScale.amount,s*=this.config.hoverScale.amount),i.top=a.y-s*this.state.anchor.y+s/2,i.left=a.x-c*this.state.anchor.x+c/2,i.box={width:c,height:s}}this.tooltip?n?this.tooltip.update(this.config.tooltip.content,i):this.tooltip.move(i):this.tooltip=this.viewer.createTooltip(i)}}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}},YL=class extends XG{get domElement(){return this.element}constructor(e,t,n){super(e,t,n)}afterCreateElement(){this.element[fi]=this}destroy(){delete this.element[fi],super.destroy()}update(e){super.update(e);const t=this.domElement;t.id=`psv-marker-${this.config.id}`,t.setAttribute("class","psv-marker"),this.state.visible&&t.classList.add("psv-marker--visible"),this.config.tooltip&&t.classList.add("psv-marker--has-tooltip"),this.config.content&&t.classList.add("psv-marker--has-content"),this.config.className&&Dn.addClasses(t,this.config.className),t.style.opacity=`${this.config.opacity}`,t.style.zIndex=`${30+this.config.zIndex}`,this.config.style&&Object.assign(t.style,this.config.style)}},AS=class extends YL{constructor(e,t,n){super(e,t,n)}afterCreateElement(){super.afterCreateElement(),this.domElement.addEventListener("transitionend",()=>{this.domElement.style.transition=""})}render({viewerPosition:e,zoomLevel:t,hoveringMarker:n}){this.__updateSize();const r=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);return r.x-=this.state.size.width*this.state.anchor.x,r.y-=this.state.size.height*this.state.anchor.y,this.state.positions3D[0].dot(this.viewer.state.direction)>0&&r.x+this.state.size.width>=0&&r.x-this.state.size.width<=this.viewer.state.size.width&&r.y+this.state.size.height>=0&&r.y-this.state.size.height<=this.viewer.state.size.height?(this.domElement.style.translate=`${r.x}px ${r.y}px 0px`,this.applyScale({zoomLevel:t,viewerPosition:e,mouseover:this===n}),r):null}update(e){if(super.update(e),!Dn.isExtendedPosition(this.config.position))throw new Sn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(n){throw new Sn(`invalid marker ${this.id} position`,n)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const t=this.domElement;t.classList.add("psv-marker--normal"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),typeof this.config.hoverScale=="boolean"?this.config.hoverScale=this.config.hoverScale?this.plugin.config.defaultHoverScale||BI:null:typeof this.config.hoverScale=="number"?this.config.hoverScale={amount:this.config.hoverScale}:this.config.hoverScale||(this.config.hoverScale=this.plugin.config.defaultHoverScale),this.config.hoverScale&&(this.config.hoverScale={...this.plugin.config.defaultHoverScale,...this.config.hoverScale}),t.style.rotate=this.config.rotation.roll!==0?pr.radToDeg(this.config.rotation.roll)+"deg":null,t.style.transformOrigin=`${this.state.anchor.x*100}% ${this.state.anchor.y*100}%`}__updateSize(){if(!this.needsUpdateSize)return;const e=this.domElement,t=!this.state.visible||!this.state.size;if(t&&e.classList.add("psv-marker--transparent"),this.isSvg()){const n=e.firstElementChild.getBoundingClientRect();this.state.size={width:n.width,height:n.height}}else this.state.size={width:e.offsetWidth,height:e.offsetHeight};t&&e.classList.remove("psv-marker--transparent"),this.isSvg()&&(e.style.width=this.state.size.width+"px",e.style.height=this.state.size.height+"px"),this.type!=="element"&&(this.needsUpdateSize=!1)}applyScale({zoomLevel:e,viewerPosition:t,mouseover:n}){n!==null&&this.config.hoverScale&&(this.domElement.style.transition=`scale ${this.config.hoverScale.duration}ms ${this.config.hoverScale.easing}`);let r=1;if(typeof this.config.scale=="function")r=this.config.scale(e,t);else if(this.config.scale){if(Array.isArray(this.config.scale.zoom)){const[i,a]=this.config.scale.zoom;r*=i+(a-i)*Ag.EASINGS.inQuad(e/100)}if(Array.isArray(this.config.scale.yaw)){const[i,a]=this.config.scale.yaw,c=pr.degToRad(this.viewer.state.hFov)/2,s=Math.abs(Dn.getShortestArc(this.state.position.yaw,t.yaw));r*=a+(i-a)*Ag.EASINGS.outQuad(Math.max(0,(c-s)/c))}}n&&this.config.hoverScale&&(r*=this.config.hoverScale.amount),this.domElement.style.scale=`${r}`}},VPe=`// https://www.8thwall.com/playground/chromakey-threejs

uniform sampler2D map;
uniform float alpha;
uniform bool keying;
uniform vec3 color;
uniform float similarity;
uniform float smoothness;
uniform float spill;

varying vec2 vUv;

vec2 RGBtoUV(vec3 rgb) {
    return vec2(
        rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,
        rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5
    );
}

void main(void) {
    gl_FragColor = texture2D(map, vUv);

    if (keying) {
        float chromaDist = distance(RGBtoUV(gl_FragColor.rgb), RGBtoUV(color));

        float baseMask = chromaDist - similarity;
        float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);
        gl_FragColor.a *= fullMask * alpha;

        float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);
        float desat = clamp(gl_FragColor.r * 0.2126 + gl_FragColor.g * 0.7152 + gl_FragColor.b * 0.0722, 0., 1.);
        gl_FragColor.rgb = mix(vec3(desat, desat, desat), gl_FragColor.rgb, spillVal);
    } else {
        gl_FragColor.a *= alpha;
    }
}
`,jPe=`varying vec2 vUv;
uniform vec2 repeat;
uniform vec2 offset;

void main() {
    vUv = uv * repeat + offset;
    gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );
}
`,HPe=class extends hu{get map(){return this.uniforms.map.value}set map(e){this.uniforms.map.value=e}set alpha(e){this.uniforms.alpha.value=e}get offset(){return this.uniforms.offset.value}get repeat(){return this.uniforms.repeat.value}set chromaKey(e){this.uniforms.keying.value=(e==null?void 0:e.enabled)===!0,e!=null&&e.enabled&&(typeof e.color=="object"&&"r"in e.color?this.uniforms.color.value.set(e.color.r/255,e.color.g/255,e.color.b/255):this.uniforms.color.value.set(e.color??65280),this.uniforms.similarity.value=e.similarity??.2,this.uniforms.smoothness.value=e.smoothness??.2)}constructor(e){super({transparent:!0,depthTest:!1,depthWrite:!1,uniforms:{map:{value:e==null?void 0:e.map},repeat:{value:new kr(1,1)},offset:{value:new kr(0,0)},alpha:{value:(e==null?void 0:e.alpha)??1},keying:{value:!1},color:{value:new Nr(65280)},similarity:{value:.2},smoothness:{value:.2},spill:{value:.1}},vertexShader:jPe,fragmentShader:VPe}),this.chromaKey=e==null?void 0:e.chromaKey}};function GPe({src:e,withCredentials:t,muted:n,autoplay:r}){const i=document.createElement("video");return i.crossOrigin=t?"use-credentials":"anonymous",i.loop=!0,i.playsInline=!0,i.autoplay=r,i.muted=n,i.preload="metadata",e instanceof MediaStream?i.srcObject=e:i.src=e,i}function WPe(e,t,n){const[r,i]=e,[a,c]=t,s=Dn.greatArcDistance(e,t),f=Math.sin((1-n)*s)/Math.sin(s),g=Math.sin(n*s)/Math.sin(s),_=f*Math.cos(i)*Math.cos(r)+g*Math.cos(c)*Math.cos(a),x=f*Math.cos(i)*Math.sin(r)+g*Math.cos(c)*Math.sin(a),C=f*Math.sin(i)+g*Math.sin(c);return[Math.atan2(x,_),Math.atan2(C,Math.sqrt(_*_+x*x))]}function qPe(e){const t=[e[0]];let n=0;for(let r=1;r<e.length;r++){const i=e[r-1][0]-e[r][0];i>Math.PI?n+=1:i<-Math.PI&&(n-=1),t.push([e[r][0]+n*2*Math.PI,e[r][1]])}return t}function ZG(e){return e.reduce((t,n)=>t.add(n),new dt).normalize()}function XPe(e){const t=qPe(e);let n=0;const r=[];for(let a=0;a<t.length-1;a++){const c=Dn.greatArcDistance(t[a],t[a+1])*Ag.SPHERE_RADIUS;r.push(c),n+=c}let i=0;for(let a=0;a<t.length-1;a++){if(i+r[a]>n/2){const c=(n/2-i)/r[a];return WPe(t[a],t[a+1],c)}i+=r[a]}return t[Math.round(t.length/2)]}var Eb=new dt,EB=new dt,oP=new dt,TB=new dt,PB=new dt,AB=new dt;function ZPe(e,t,n){Eb.copy(n).normalize(),EB.crossVectors(e,t).normalize(),oP.crossVectors(EB,e).normalize(),TB.copy(e).multiplyScalar(-Eb.dot(oP)),PB.copy(oP).multiplyScalar(Eb.dot(e));const r=new dt().addVectors(TB,PB).normalize();return AB.crossVectors(r,Eb),r.applyAxisAngle(AB,.01).multiplyScalar(Ag.SPHERE_RADIUS)}var YPe=class extends XG{get threeElement(){return this.element}get threeMesh(){return this.threeElement.children[0]}get video(){return this.type==="videoLayer"?this.threeMesh.material.map.image:null}constructor(e,t,n){super(e,t,n)}is3d(){return!0}createElement(){const e=new HPe({alpha:0}),t=new lx(1,1),n=new Os(t,e);n.userData={[fi]:this},Object.defineProperty(n,"visible",{enumerable:!0,get:function(){return this.userData[fi].config.visible},set:function(r){this.userData[fi].config.visible=r}}),this.element=new yh().add(n),this.type==="videoLayer"&&this.viewer.needsContinuousUpdate(!0)}destroy(){delete this.threeMesh.userData[fi],this.type==="videoLayer"&&(this.video.pause(),this.viewer.needsContinuousUpdate(!1)),super.destroy()}render(){return this.viewer.renderer.isObjectVisible(this.threeMesh)?this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position):null}update(e){var i,a,c;super.update(e);const t=this.threeMesh,n=t.parent,r=t.material;if(Dn.isExtendedPosition(this.config.position)){try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(f){throw new Sn(`invalid marker ${this.id} position`,f)}if(!this.config.size)throw new Sn(`missing marker ${this.id} size`);this.state.size=this.config.size,t.scale.set(this.config.size.width/100,this.config.size.height/100,1),t.position.set(t.scale.x*(.5-this.state.anchor.x),t.scale.y*(this.state.anchor.y-.5),0),t.rotation.set(0,0,0),this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position,n.position),n.lookAt(0,n.position.y,0),t.rotateY(-this.config.rotation.yaw),t.rotateX(-this.config.rotation.pitch),t.rotateZ(-this.config.rotation.roll);const s=t.geometry.getAttribute("position");this.state.positions3D=[0,1,3,2].map(f=>{const g=new dt;return g.fromBufferAttribute(s,f),t.localToWorld(g)})}else{if(((i=this.config.position)==null?void 0:i.length)!==4)throw new Sn(`missing marker ${this.id} position`);let s;try{s=this.config.position.map(x=>this.viewer.dataHelper.cleanPosition(x))}catch(x){throw new Sn(`invalid marker ${this.id} position`,x)}const f=s.map(x=>this.viewer.dataHelper.sphericalCoordsToVector3(x)),g=ZG(f);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(g),this.state.positions3D=f;const _=t.geometry.getAttribute("position");[f[0],f[1],f[3],f[2]].forEach((x,C)=>{_.setX(C,x.x),_.setY(C,x.y),_.setZ(C,x.z)}),_.needsUpdate=!0,this.__setTextureWrap(r)}switch(this.type){case"videoLayer":if(this.definition!==this.config.videoLayer){(a=r.map)==null||a.dispose();const s=GPe({src:this.config.videoLayer,withCredentials:this.viewer.config.withCredentials(this.config.videoLayer),muted:!0,autoplay:this.config.autoplay??!0}),f=new eSe(s);r.map=f,r.alpha=0,s.addEventListener("loadedmetadata",()=>{this.viewer&&(r.alpha=this.config.opacity,Dn.isExtendedPosition(this.config.position)||(t.material.userData[fi]={width:s.videoWidth,height:s.videoHeight},this.__setTextureWrap(r)))},{once:!0}),s.autoplay&&s.play(),this.definition=this.config.videoLayer}else r.alpha=this.config.opacity;break;case"imageLayer":if(this.definition!==this.config.imageLayer){(c=r.map)==null||c.dispose();const s=new jo;r.map=s,r.alpha=0,this.viewer.textureLoader.loadImage(this.config.imageLayer).then(f=>{this.viewer&&(Dn.isExtendedPosition(this.config.position)||(t.material.userData[fi]={width:f.width,height:f.height},this.__setTextureWrap(r)),s.image=f,s.anisotropy=4,s.needsUpdate=!0,r.alpha=this.config.opacity,this.viewer.needsUpdate())}),this.definition=this.config.imageLayer}else r.alpha=this.config.opacity;break}r.chromaKey=this.config.chromaKey,t.renderOrder=1e3+this.config.zIndex,t.geometry.boundingBox=null}__setTextureWrap(e){const t=e.userData[fi];if(!t||!t.height||!t.width){e.repeat.set(1,1),e.offset.set(0,0);return}const n=this.config.position.map(x=>this.viewer.dataHelper.cleanPosition(x)),r=Dn.greatArcDistance([n[0].yaw,n[0].pitch],[n[1].yaw,n[1].pitch]),i=Dn.greatArcDistance([n[3].yaw,n[3].pitch],[n[2].yaw,n[2].pitch]),a=Dn.greatArcDistance([n[1].yaw,n[1].pitch],[n[2].yaw,n[2].pitch]),c=Dn.greatArcDistance([n[0].yaw,n[0].pitch],[n[3].yaw,n[3].pitch]),s=(r+i)/(a+c),f=t.width/t.height;let g=0,_=0;s<f?g=f-s:_=1/f-1/s,e.repeat.set(1-g,1-_),e.offset.set(g/2,_/2)}},KPe=class extends YL{constructor(e,t,n){super(e,t,n),this.viewportIntersection=!1}get threeElement(){return this.object}isCss3d(){return!0}createElement(){this.element=document.createElement("div"),this.object=new NPe(this.element),this.object.userData={[fi]:this},Object.defineProperty(this.object,"visible",{enumerable:!0,get:function(){return this.userData[fi].config.visible},set:function(e){this.userData[fi].config.visible=e}}),this.afterCreateElement()}destroy(){delete this.object.userData[fi],delete this.object,super.destroy()}render({viewerPosition:e,zoomLevel:t}){var i,a;const n=this.domElement;if(this.state.size={width:n.offsetWidth,height:n.offsetHeight},this.state.positions3D[0].dot(this.viewer.state.direction)>0&&this.viewportIntersection){const c=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position);return(a=(i=this.config.elementLayer).updateMarker)==null||a.call(i,{marker:this,position:c,viewerPosition:e,zoomLevel:t,viewerSize:this.viewer.state.size}),c}else return null}update(e){if(super.update(e),!Dn.isExtendedPosition(this.config.position))throw new Sn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(r){throw new Sn(`invalid marker ${this.id} position`,r)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const t=this.threeElement,n=this.domElement;n.classList.add("psv-marker--css3d"),n.childNodes.forEach(r=>r.remove()),n.appendChild(this.config.elementLayer),this.config.elementLayer.style.display="block",t.position.copy(this.state.positions3D[0]).multiplyScalar(100),t.lookAt(0,this.state.positions3D[0].y*100,0),t.rotateY(-this.config.rotation.yaw),t.rotateX(-this.config.rotation.pitch),t.rotateZ(-this.config.rotation.roll)}},JPe=class extends AS{constructor(e,t,n){super(e,t,n)}isNormal(){return!0}createElement(){this.element=document.createElement("div"),this.afterCreateElement()}render(e){var n,r;const t=super.render(e);return t&&this.type==="element"&&((r=(n=this.config.element).updateMarker)==null||r.call(n,{marker:this,position:t,viewerPosition:e.viewerPosition,zoomLevel:e.zoomLevel,viewerSize:this.viewer.state.size})),t}update(e){super.update(e);const t=this.domElement;if(this.config.image&&!this.config.size)throw new Sn(`missing marker ${this.id} size`);switch(this.config.size?(this.needsUpdateSize=!1,this.state.size=this.config.size,t.style.width=this.config.size.width+"px",t.style.height=this.config.size.height+"px"):this.needsUpdateSize=!0,this.type){case"image":this.definition=this.config.image,t.style.backgroundImage=`url("${this.config.image}")`;break;case"html":this.definition=this.config.html,t.innerHTML=this.config.html;break;case"element":this.definition!==this.config.element&&(this.definition=this.config.element,t.childNodes.forEach(n=>n.remove()),t.appendChild(this.config.element),this.config.element.style.display="block");break}}},QPe=class extends YL{constructor(e,t,n){super(e,t,n)}createElement(){this.element=document.createElementNS(PS,"path"),this.element[fi]=this}isPoly(){return!0}get isPixels(){return this.type==="polygonPixels"||this.type==="polylinePixels"}get isPolygon(){return this.type==="polygon"||this.type==="polygonPixels"}get isPolyline(){return this.type==="polyline"||this.type==="polylinePixels"}get coords(){return this.definition}render(){const e=this.__getAllPolyPositions();if(e[0].length>(this.isPolygon?2:1)){const n=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position),r=e.filter(i=>i.length>0).map(i=>{let a="M";return a+=i.map(c=>`${c.x-n.x},${c.y-n.y}`).join("L"),this.isPolygon&&(a+="Z"),a}).join(" ");return this.domElement.setAttributeNS(null,"d",r),this.domElement.setAttributeNS(null,"transform",`translate(${n.x} ${n.y})`),n}else return null}update(e){super.update(e);const t=this.domElement;t.classList.add("psv-marker--poly"),this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach(([n,r])=>{t.setAttributeNS(null,Dn.dasherize(n),r)}),this.isPolyline&&!this.config.svgStyle.fill&&t.setAttributeNS(null,"fill","none")):this.isPolygon?t.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline&&(t.setAttributeNS(null,"fill","none"),t.setAttributeNS(null,"stroke","rgb(0,0,0)"));try{let n=this.config[this.type];if(!Array.isArray(n[0])&&typeof n[0]!="object")for(let r=0;r<n.length;r++)n.splice(r,2,[n[r],n[r+1]]);if(!Array.isArray(n[0][0])&&typeof n[0][0]!="object"&&(n=[n]),this.isPolyline&&n.length>1)throw new Sn("polylines cannot have holes");this.isPixels?this.definition=n.map(r=>r.map(i=>{let a;return Dn.isExtendedPosition(i)?a=this.viewer.dataHelper.cleanPosition(i):a=this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:i[0],textureY:i[1]}),[a.yaw,a.pitch]})):this.definition=n.map(r=>r.map(i=>{let a;return Dn.isExtendedPosition(i)?a=this.viewer.dataHelper.cleanPosition(i):a=this.viewer.dataHelper.cleanPosition({yaw:i[0],pitch:i[1]}),[a.yaw,a.pitch]}))}catch(n){throw new Sn(`invalid marker ${this.id} position`,n)}if(this.positions3D=this.coords.map(n=>n.map(r=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:r[0],pitch:r[1]}))),this.isPolygon){const n=ZG(this.positions3D[0]);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(n)}else{const n=XPe(this.coords[0]);this.state.position={yaw:n[0],pitch:n[1]}}this.state.positions3D=this.positions3D[0]}__getAllPolyPositions(){return this.positions3D.map(e=>this.__getPolyPositions(e))}__getPolyPositions(e){const t=e.length,n=e.map(i=>({vector:i,visible:i.dot(this.viewer.state.direction)>0})),r=[];return n.forEach((i,a)=>{i.visible||[a===0?n[t-1]:n[a-1],a===t-1?n[0]:n[a+1]].forEach(s=>{s.visible&&r.push({visible:s.vector,invisible:i.vector,index:a})})}),r.reverse().forEach(i=>{n.splice(i.index,0,{vector:ZPe(i.visible,i.invisible,this.viewer.state.direction),visible:!0})}),n.filter(i=>i.visible).map(i=>this.viewer.dataHelper.vector3ToViewerCoords(i.vector))}},eAe=class extends AS{get svgElement(){return this.domElement.firstElementChild}constructor(e,t,n){super(e,t,n)}isSvg(){return!0}createElement(){const e=this.type==="square"?"rect":this.type,t=document.createElementNS(PS,e);this.element=document.createElementNS(PS,"svg"),this.element.appendChild(t),this.afterCreateElement()}update(e){super.update(e);const t=this.svgElement;switch(this.needsUpdateSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path};break}Object.entries(this.definition).forEach(([n,r])=>{t.setAttributeNS(null,n,r)}),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach(([n,r])=>{t.setAttributeNS(null,Dn.dasherize(n),r)}):t.setAttributeNS(null,"fill","rgba(0,0,0,0.5)")}},tAe=Dn.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null,defaultHoverScale:null},{defaultHoverScale(e){return e?(e===!0&&(e=BI),typeof e=="number"&&(e={amount:e}),{...BI,...e}):null}});function nAe(e){switch(UI(e,!1)){case"image":case"html":case"element":return JPe;case"imageLayer":case"videoLayer":return YPe;case"elementLayer":return KPe;case"polygon":case"polyline":case"polygonPixels":case"polylinePixels":return QPe;case"square":case"rect":case"circle":case"ellipse":case"path":return eAe;default:throw new Sn("invalid marker type")}}var fx=class YG extends GL{constructor(t,n){super(t,n),this.markers={},this.state={allVisible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null,needsReRender:!1,lastClientX:null,lastClientY:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",r=>r.preventDefault()),this.svgContainer=document.createElementNS(PS,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.css3DContainer=new $Pe(t),this.container.appendChild(this.css3DContainer.element),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0)}static withConfig(t){return[YG,t]}init(){super.init(),Dn.checkStylesheet(this.viewer.container,"markers-plugin"),this.viewer.addEventListener(Fn.ClickEvent.type,this),this.viewer.addEventListener(Fn.DoubleClickEvent.type,this),this.viewer.addEventListener(Fn.RenderEvent.type,this),this.viewer.addEventListener(Fn.ConfigChangedEvent.type,this),this.viewer.addEventListener(Fn.ObjectEnterEvent.type,this),this.viewer.addEventListener(Fn.ObjectHoverEvent.type,this),this.viewer.addEventListener(Fn.ObjectLeaveEvent.type,this),this.viewer.addEventListener(Fn.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(fi),this.viewer.removeEventListener(Fn.ClickEvent.type,this),this.viewer.removeEventListener(Fn.DoubleClickEvent.type,this),this.viewer.removeEventListener(Fn.RenderEvent.type,this),this.viewer.removeEventListener(Fn.ObjectEnterEvent.type,this),this.viewer.removeEventListener(Fn.ObjectHoverEvent.type,this),this.viewer.removeEventListener(Fn.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(Fn.ReadyEvent.type,this),this.css3DContainer.destroy(),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(t){var n;switch(t.type){case Fn.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case Fn.RenderEvent.type:this.renderMarkers();break;case Fn.ClickEvent.type:this.__onClick(t,!1);break;case Fn.DoubleClickEvent.type:this.__onClick(t,!0);break;case Fn.ObjectEnterEvent.type:case Fn.ObjectLeaveEvent.type:case Fn.ObjectHoverEvent.type:if(t.userDataKey===fi){const r=t.originalEvent,i=t.object.userData[fi];switch(t.type){case Fn.ObjectEnterEvent.type:(n=i.config.style)!=null&&n.cursor?this.viewer.setCursor(i.config.style.cursor):(i.config.tooltip||i.config.content)&&this.viewer.setCursor("pointer"),this.__onEnterMarker(r,i);break;case Fn.ObjectLeaveEvent.type:this.viewer.setCursor(null),this.__onLeaveMarker(i);break;case Fn.ObjectHoverEvent.type:this.__onHoverMarker(r,i);break}}break;case"mouseenter":{const r=this.__getTargetMarker(Dn.getEventTarget(t));this.__onEnterMarker(t,r);break}case"mouseleave":{const r=this.__getTargetMarker(Dn.getEventTarget(t));this.__onLeaveMarker(r);break}case"mousemove":{const r=this.__getTargetMarker(Dn.getEventTarget(t),!0);this.__onHoverMarker(t,r);break}}}toggleAllMarkers(){this.state.allVisible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.allVisible=!0,Object.values(this.markers).forEach(t=>{t.config.visible=!0}),this.renderMarkers(),this.dispatchEvent(new Py)}hideAllMarkers(){this.state.allVisible=!1,Object.values(this.markers).forEach(t=>{t.config.visible=!1}),this.renderMarkers(),this.dispatchEvent(new Ty)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach(t=>{t.state.staticTooltip=!0,t.showTooltip()})}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach(t=>{t.state.staticTooltip=!1,t.hideTooltip()})}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(t,n=!0){if(this.markers[t.id])throw new Sn(`marker "${t.id}" already exists`);const r=new(nAe(t))(this.viewer,this,t);r.isPoly()?this.svgContainer.appendChild(r.domElement):r.isCss3d()?this.css3DContainer.addObject(r):r.is3d()?this.viewer.renderer.addObject(r.threeElement):this.container.appendChild(r.domElement),this.markers[r.id]=r,this.state.showAllTooltips&&(r.state.staticTooltip=!0),n&&this.__afterChangeMarkers()}getMarker(t){const n=typeof t=="object"?t.id:t;if(!this.markers[n])throw new Sn(`cannot find marker "${n}"`);return this.markers[n]}getCurrentMarker(){return this.state.currentMarker}updateMarker(t,n=!0){var i;const r=this.getMarker(t.id);r.update(t),n&&(this.__afterChangeMarkers(),(r===this.state.hoveringMarker&&((i=r.config.tooltip)==null?void 0:i.trigger)==="hover"||r.state.staticTooltip)&&r.showTooltip(this.state.lastClientX,this.state.lastClientY,!0))}removeMarker(t,n=!0){const r=this.getMarker(t);r.isPoly()?this.svgContainer.removeChild(r.domElement):r.isCss3d()?this.css3DContainer.removeObject(r):r.is3d()?this.viewer.renderer.removeObject(r.threeElement):this.container.removeChild(r.domElement),this.state.hoveringMarker===r&&(this.state.hoveringMarker=null),this.state.currentMarker===r&&(this.state.currentMarker=null),r.destroy(),delete this.markers[r.id],n&&this.__afterChangeMarkers()}removeMarkers(t,n=!0){t.forEach(r=>this.removeMarker(r,!1)),n&&this.__afterChangeMarkers()}setMarkers(t,n=!0){this.clearMarkers(!1),t==null||t.forEach(r=>{this.addMarker(r,!1)}),n&&this.__afterChangeMarkers()}clearMarkers(t=!0){Object.keys(this.markers).forEach(n=>{this.removeMarker(n,!1)}),t&&this.__afterChangeMarkers()}gotoMarker(t,n=this.config.gotoMarkerSpeed){const r=this.getMarker(t);return n?this.viewer.animate({...r.state.position,zoom:r.config.zoomLvl,speed:n}).then(()=>{this.dispatchEvent(new NI(r))}):(this.viewer.rotate(r.state.position),Dn.isNil(r.config.zoomLvl)||this.viewer.zoom(r.config.zoomLvl),this.dispatchEvent(new NI(r)),Promise.resolve())}hideMarker(t){this.toggleMarker(t,!1)}showMarker(t){this.toggleMarker(t,!0)}showMarkerTooltip(t){const n=this.getMarker(t);n.state.staticTooltip=!0,n.showTooltip()}hideMarkerTooltip(t){const n=this.getMarker(t);n.state.staticTooltip=!1,n.hideTooltip()}toggleMarker(t,n){const r=this.getMarker(t);r.config.visible=Dn.isNil(n)?!r.config.visible:n,this.renderMarkers()}showMarkerPanel(t){const n=this.getMarker(t);n.config.content?this.viewer.panel.show({id:A0,content:n.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(A0)}toggleMarkersList(){this.viewer.panel.isVisible(_m)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let t=[];Object.values(this.markers).forEach(r=>{r.config.visible&&!r.config.hideList&&t.push(r)});const n=new WG(t);this.dispatchEvent(n),t=n.markers,this.viewer.panel.show({id:_m,content:OPe(t,this.viewer.config.lang[m_.id]),noMargin:!0,clickHandler:r=>{const i=Dn.getClosest(r,".psv-panel-menu-item"),a=i?i.dataset[fi]:void 0;if(a){const c=this.getMarker(a);this.dispatchEvent(new kG(c)),this.gotoMarker(c.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(_m)}renderMarkers(){if(this.state.needsReRender){this.state.needsReRender=!1;return}const t=this.viewer.getZoomLevel(),n=this.viewer.getPosition(),r=this.state.hoveringMarker;Object.values(this.markers).forEach(i=>{let a=i.config.visible,c=!1,s=null;a&&(s=i.render({viewerPosition:n,zoomLevel:t,hoveringMarker:r}),a=!!s),c=i.state.visible!==a,i.state.visible=a,i.state.position2D=s,i.domElement&&Dn.toggleClass(i.domElement,"psv-marker--visible",a),a?i.state.staticTooltip?i.showTooltip():i!==this.state.hoveringMarker&&i.hideTooltip():i.hideTooltip(),c&&(this.dispatchEvent(new _G(i,a)),(i.is3d()||i.isCss3d())&&(this.state.needsReRender=!0))}),this.state.needsReRender&&this.viewer.needsUpdate()}__getTargetMarker(t,n=!1){if(t instanceof Node){const r=n?Dn.getClosest(t,".psv-marker"):t;return r?r[fi]:void 0}else return Array.isArray(t)?t.map(r=>r.userData[fi]).filter(r=>!!r).sort((r,i)=>i.config.zIndex-r.config.zIndex)[0]:null}__onEnterMarker(t,n){var r;n&&(this.state.hoveringMarker=n,this.state.lastClientX=t.clientX,this.state.lastClientY=t.clientY,this.dispatchEvent(new TG(n)),n instanceof AS&&n.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!0}),!n.state.staticTooltip&&((r=n.config.tooltip)==null?void 0:r.trigger)==="hover"&&n.showTooltip(t.clientX,t.clientY))}__onLeaveMarker(t){var n;t&&(this.dispatchEvent(new MG(t)),t instanceof AS&&t.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!1}),this.state.hoveringMarker=null,!t.state.staticTooltip&&((n=t.config.tooltip)==null?void 0:n.trigger)==="hover"?t.hideTooltip():t.state.staticTooltip&&t.showTooltip())}__onHoverMarker(t,n){var r;n&&(this.state.lastClientX=t.clientX,this.state.lastClientY=t.clientY,(n.isPoly()||n.is3d()||n.isCss3d())&&((r=n.config.tooltip)==null?void 0:r.trigger)==="hover"&&n.showTooltip(t.clientX,t.clientY))}__onClick(t,n){var c,s;const r=this.__getTargetMarker(t.data.objects),a=this.__getTargetMarker(t.data.target,!0)||r;this.state.currentMarker&&this.state.currentMarker!==a&&(this.dispatchEvent(new OG(this.state.currentMarker)),this.viewer.panel.hide(A0),!this.state.showAllTooltips&&((c=this.state.currentMarker.config.tooltip)==null?void 0:c.trigger)==="click"&&this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null),a&&(this.state.currentMarker=a,this.dispatchEvent(new IG(a,n,t.data.rightclick)),this.config.clickEventOnMarker?t.data.marker=a:t.stopImmediatePropagation(),this.markers[a.id]&&!t.data.rightclick&&(((s=a.config.tooltip)==null?void 0:s.trigger)==="click"?a.tooltip?this.hideMarkerTooltip(a.id):this.showMarkerTooltip(a.id):this.showMarkerPanel(a.id)))}__afterChangeMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new $G(this.getMarkers()))}__refreshUi(){var n,r;const t=Object.values(this.markers).filter(i=>!i.config.hideList).length;t===0?(this.viewer.panel.hide(A0),this.viewer.panel.hide(_m)):this.viewer.panel.isVisible(_m)?this.showMarkersList():this.viewer.panel.isVisible(A0)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),(n=this.viewer.navbar.getButton(m_.id,!1))==null||n.toggle(t>0),(r=this.viewer.navbar.getButton(vC.id,!1))==null||r.toggle(t>0)}__checkObjectsObserver(){Object.values(this.markers).some(n=>n.is3d())?this.viewer.observeObjects(fi):this.viewer.unobserveObjects(fi)}};fx.id="markers";fx.VERSION="5.13.4";fx.configParser=tAe;fx.readonlyOptions=["markers"];var rAe=fx;du.lang[m_.id]="Markers";du.lang[vC.id]="Markers list";WL(m_,"caption:left");WL(vC,"caption:left");/*!
 * Photo Sphere Viewer / Virtual Tour Plugin 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var iAe=Object.defineProperty,oAe=(e,t)=>{for(var n in t)iAe(e,n,{get:t[n],enumerable:!0})},sAe={};oAe(sAe,{EnterArrowEvent:()=>nW,LeaveArrowEvent:()=>oW,NodeChangedEvent:()=>QG});var KG=class JG extends ux{constructor(t,n){super(JG.type),this.node=t,this.data=n}};KG.type="node-changed";var QG=KG,eW=class tW extends ux{constructor(t,n){super(tW.type),this.link=t,this.node=n}};eW.type="enter-arrow";var nW=eW,rW=class iW extends ux{constructor(t,n){super(iW.type),this.link=t,this.node=n}};rW.type="leave-arrow";var oW=rW,aAe=class extends Ho{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new kr(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}},cm=new dt,IB=new Vr,RB=new Vr,LB=new dt,kB=new dt,lAe=class{constructor(e={}){const t=this;let n,r,i,a;const c={objects:new WeakMap},s=e.element!==void 0?e.element:document.createElement("div");s.style.overflow="hidden",this.domElement=s,this.getSize=function(){return{width:n,height:r}},this.render=function(E,A){E.matrixWorldAutoUpdate===!0&&E.updateMatrixWorld(),A.parent===null&&A.matrixWorldAutoUpdate===!0&&A.updateMatrixWorld(),IB.copy(A.matrixWorldInverse),RB.multiplyMatrices(A.projectionMatrix,IB),g(E,E,A),C(E)},this.setSize=function(E,A){n=E,r=A,i=n/2,a=r/2,s.style.width=E+"px",s.style.height=A+"px"};function f(E){E.isCSS2DObject&&(E.element.style.display="none");for(let A=0,L=E.children.length;A<L;A++)f(E.children[A])}function g(E,A,L){if(E.visible===!1){f(E);return}if(E.isCSS2DObject){cm.setFromMatrixPosition(E.matrixWorld),cm.applyMatrix4(RB);const I=cm.z>=-1&&cm.z<=1&&E.layers.test(L.layers)===!0,T=E.element;T.style.display=I===!0?"":"none",I===!0&&(E.onBeforeRender(t,A,L),T.style.transform="translate("+-100*E.center.x+"%,"+-100*E.center.y+"%)translate("+(cm.x*i+i)+"px,"+(-cm.y*a+a)+"px)",T.parentNode!==s&&s.appendChild(T),E.onAfterRender(t,A,L));const O={distanceToCameraSquared:_(L,E)};c.objects.set(E,O)}for(let I=0,T=E.children.length;I<T;I++)g(E.children[I],A,L)}function _(E,A){return LB.setFromMatrixPosition(E.matrixWorld),kB.setFromMatrixPosition(A.matrixWorld),LB.distanceToSquared(kB)}function x(E){const A=[];return E.traverseVisible(function(L){L.isCSS2DObject&&A.push(L)}),A}function C(E){const A=x(E).sort(function(I,T){if(I.renderOrder!==T.renderOrder)return T.renderOrder-I.renderOrder;const O=c.objects.get(I).distanceToCameraSquared,D=c.objects.get(T).distanceToCameraSquared;return O-D}),L=A.length;for(let I=0,T=A.length;I<T;I++)A[I].element.style.zIndex=L-I}}},DB=new dt,cAe=new id,zB=new dt,uAe=class extends Ho{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}},ec=new Vr,hAe=new Vr,dAe=class{constructor(e={}){const t=this;let n,r,i,a;const c={camera:{style:""},objects:new WeakMap},s=e.element!==void 0?e.element:document.createElement("div");s.style.overflow="hidden",this.domElement=s;const f=document.createElement("div");f.style.transformOrigin="0 0",f.style.pointerEvents="none",s.appendChild(f);const g=document.createElement("div");g.style.transformStyle="preserve-3d",f.appendChild(g),this.getSize=function(){return{width:n,height:r}},this.render=function(L,I){const T=I.projectionMatrix.elements[5]*a;I.view&&I.view.enabled?(f.style.transform=`translate( ${-I.view.offsetX*(n/I.view.width)}px, ${-I.view.offsetY*(r/I.view.height)}px )`,f.style.transform+=`scale( ${I.view.fullWidth/I.view.width}, ${I.view.fullHeight/I.view.height} )`):f.style.transform="",L.matrixWorldAutoUpdate===!0&&L.updateMatrixWorld(),I.parent===null&&I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld();let O,D;I.isOrthographicCamera&&(O=-(I.right+I.left)/2,D=(I.top+I.bottom)/2);const U=I.view&&I.view.enabled?I.view.height/I.view.fullHeight:1,H=I.isOrthographicCamera?`scale( ${U} )scale(`+T+")translate("+_(O)+"px,"+_(D)+"px)"+x(I.matrixWorldInverse):`scale( ${U} )translateZ(`+T+"px)"+x(I.matrixWorldInverse),q=(I.isPerspectiveCamera?"perspective("+T+"px) ":"")+H+"translate("+i+"px,"+a+"px)";c.camera.style!==q&&(g.style.transform=q,c.camera.style=q),A(L,L,I)},this.setSize=function(L,I){n=L,r=I,i=n/2,a=r/2,s.style.width=L+"px",s.style.height=I+"px",f.style.width=L+"px",f.style.height=I+"px",g.style.width=L+"px",g.style.height=I+"px"};function _(L){return Math.abs(L)<1e-10?0:L}function x(L){const I=L.elements;return"matrix3d("+_(I[0])+","+_(-I[1])+","+_(I[2])+","+_(I[3])+","+_(I[4])+","+_(-I[5])+","+_(I[6])+","+_(I[7])+","+_(I[8])+","+_(-I[9])+","+_(I[10])+","+_(I[11])+","+_(I[12])+","+_(-I[13])+","+_(I[14])+","+_(I[15])+")"}function C(L){const I=L.elements;return"translate(-50%,-50%)"+("matrix3d("+_(I[0])+","+_(I[1])+","+_(I[2])+","+_(I[3])+","+_(-I[4])+","+_(-I[5])+","+_(-I[6])+","+_(-I[7])+","+_(I[8])+","+_(I[9])+","+_(I[10])+","+_(I[11])+","+_(I[12])+","+_(I[13])+","+_(I[14])+","+_(I[15])+")")}function E(L){L.isCSS3DObject&&(L.element.style.display="none");for(let I=0,T=L.children.length;I<T;I++)E(L.children[I])}function A(L,I,T,O){if(L.visible===!1){E(L);return}if(L.isCSS3DObject){const D=L.layers.test(T.layers)===!0,U=L.element;if(U.style.display=D===!0?"":"none",D===!0){L.onBeforeRender(t,I,T);let H;L.isCSS3DSprite?(ec.copy(T.matrixWorldInverse),ec.transpose(),L.rotation2D!==0&&ec.multiply(hAe.makeRotationZ(L.rotation2D)),L.matrixWorld.decompose(DB,cAe,zB),ec.setPosition(DB),ec.scale(zB),ec.elements[3]=0,ec.elements[7]=0,ec.elements[11]=0,ec.elements[15]=1,H=C(ec)):H=C(L.matrixWorld);const V=c.objects.get(L);if(V===void 0||V.style!==H){U.style.transform=H;const q={style:H};c.objects.set(L,q)}U.parentNode!==g&&g.appendChild(U),L.onAfterRender(t,I,T)}}for(let D=0,U=L.children.length;D<U;D++)A(L.children[D],I,T)}}},fAe=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
    <path fill-rule="even-odd" fill="currentColor" d="
        M50,50 m45,0
        a45,45 0 1,0 -90,0
        a45,45 0 1,0  90,0

        M50,50 m38,0
        a38,38 0 0,1 -76,0
        a38,38 0 0,1  76,0

        M50,50 m30,0
        a30,30 0 1,0 -60,0
        a30,30 0 1,0  60,0
        
        M50,40 m2.5,-2.5
        l17.5,17.5
        a 2.5,2.5 0 0 1 -5,5
        l-15,-15
        l-15,15
        a 2.5,2.5 0 0 1 -5,-5
        l17.5,-17.5
        a 3.5,3.5 0 0 1 5,0
    "/>
</svg>`,IS="tourLink",um="__tour-link__",pAe={className:"psv-virtual-tour-tooltip",content:'<div class="psv-virtual-tour-loader"><div></div><div></div><div></div></div>'},mAe={element:()=>{const e=document.createElement("button");return e.className="psv-virtual-tour-arrow",e.innerHTML=fAe,e},size:{width:80,height:80}},sP="arrow",gAe=class extends od{constructor(e,t){super(e,{className:"psv-virtual-tour-arrows"}),this.plugin=t,this.renderer=this.is3D?new dAe({element:this.container}):new lAe({element:this.container}),this.camera=this.is3D?new da(30,1):null,this.scene=new vS,this.viewer.addEventListener(Fn.ReadyEvent.type,this,{once:!0}),this.viewer.addEventListener(Fn.PositionUpdatedEvent.type,this),this.viewer.addEventListener(Fn.SizeUpdatedEvent.type,this),this.viewer.addEventListener(Fn.RenderEvent.type,this),this.viewer.addEventListener(Fn.ClickEvent.type,this),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("contextmenu",n=>n.preventDefault())}get is3D(){return this.plugin.is3D}get arrowsPosition(){return this.plugin.config.arrowsPosition}get arrowStyle(){return this.plugin.config.arrowStyle}init(){var e,t;this.is3D&&(this.gallery=this.viewer.getPlugin("gallery"),(e=this.gallery)==null||e.addEventListener("show-gallery",this),(t=this.gallery)==null||t.addEventListener("hide-gallery",this))}destroy(){var e,t;this.viewer.removeEventListener(Fn.ReadyEvent.type,this),this.viewer.removeEventListener(Fn.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(Fn.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(Fn.RenderEvent.type,this),this.viewer.removeEventListener(Fn.ClickEvent.type,this),(e=this.gallery)==null||e.removeEventListener("show-gallery",this),(t=this.gallery)==null||t.removeEventListener("hide-gallery",this),super.destroy()}handleEvent(e){switch(e.type){case Fn.ReadyEvent.type:case Fn.SizeUpdatedEvent.type:case Fn.PositionUpdatedEvent.type:this.__updateCamera();break;case Fn.RenderEvent.type:this.render();break;case Fn.ClickEvent.type:{if(e.data.rightclick)break;const t=this.__getTargetLink(e.data.target,!0);t&&this.plugin.setCurrentNode(t.nodeId,null,t);break}case"mouseenter":{const t=this.__getTargetLink(Dn.getEventTarget(e));t&&this.plugin.__onEnterArrow(t,e);break}case"mouseleave":{const t=this.__getTargetLink(Dn.getEventTarget(e));t&&this.plugin.__onLeaveArrow(t);break}case"mousemove":{this.__getTargetLink(Dn.getEventTarget(e),!0)&&this.plugin.__onHoverArrow(e);break}case"hide-gallery":this.__onToggleGallery(!1);break;case"show-gallery":e.fullscreen||this.__onToggleGallery(!0);break}}__updateCamera(){const e=this.viewer.getSize();if(this.renderer.setSize(e.width,e.height),this.is3D){const t=this.viewer.getPosition();t.pitch=pr.clamp(t.pitch,-this.arrowsPosition.maxPitch,-this.arrowsPosition.minPitch),this.viewer.dataHelper.sphericalCoordsToVector3(t,this.camera.position,e.height*2).negate(),this.camera.lookAt(0,0,0),this.camera.translateY(e.height/3),this.camera.updateProjectionMatrix()}}render(){if(this.is3D){const e=this.viewer.getPosition(),t=[];let n=Number.MAX_SAFE_INTEGER;this.scene.children.forEach(r=>{const i=r.userData[sP];if(i.conflict){const a=Math.abs(Dn.getShortestArc(e.yaw,i.yaw));n=Math.min(n,a),t.push([r,a])}}),t.forEach(([r,i])=>{const a=i!==n;r.element.style.opacity=a?"0.5":null,r.element.style.zIndex=a?"-1":null}),this.renderer.render(this.scene,this.camera)}else this.renderer.render(this.scene,this.viewer.renderer.camera)}clear(){this.scene.clear()}__buildArrowElement(e,t){if(t!=null&&t.image){const n=document.createElement("img");return n.src=t.image,n}else if(t!=null&&t.element)return typeof t.element=="function"?t.element(e):t.element}addLinkArrow(e,t,n=1){let r=this.__buildArrowElement(e,e.arrowStyle);r||(r=this.__buildArrowElement(e,this.arrowStyle)),r[IS]=e;const i={...this.arrowStyle,...e.arrowStyle};if(r.classList.add("psv-virtual-tour-link"),i.className&&Dn.addClasses(r,i.className),i.style&&Object.assign(r.style,i.style),this.is3D){r.style.width=i.size.width*1.5+"px",r.style.height=i.size.height*1.5+"px";let a=!1;this.scene.children.forEach(s=>{const f=s.userData[sP];Math.abs(Dn.getShortestArc(f.yaw,t.yaw))<this.arrowsPosition.linkOverlapAngle&&(f.conflict=!0,a=!0)});const c=new uAe(r);c.userData[sP]={yaw:t.yaw,conflict:a},c.rotation.set(-Math.PI/2,0,Math.PI-t.yaw),this.viewer.dataHelper.sphericalCoordsToVector3({yaw:t.yaw,pitch:0},c.position,n*100),this.scene.add(c)}else{r.style.width=i.size.width+"px",r.style.height=i.size.height+"px",r.style.pointerEvents="auto";const a=new aAe(r);this.viewer.dataHelper.sphericalCoordsToVector3(t,a.position),this.scene.add(a)}}__getTargetLink(e,t=!1){const n=t?Dn.getClosest(e,".psv-virtual-tour-link"):e;return n?n[IS]:void 0}__onToggleGallery(e){e?this.container.style.marginBottom=this.viewer.container.querySelector(".psv-gallery").offsetHeight+"px":this.container.style.marginBottom=""}},sW=class{constructor(e,t){this.plugin=e,this.viewer=t,this.nodes={}}destroy(){}checkNode(e){var t,n;if(!e.id)throw new Sn("No id given for node");if(!e.panorama)throw new Sn(`No panorama provided for node ${e.id}`);if(this.plugin.isGps&&!(((t=e.gps)==null?void 0:t.length)>=2))throw new Sn(`No GPS position provided for node ${e.id}`);if(!this.plugin.isGps&&((n=e.markers)!=null&&n.some(r=>r.gps&&!r.position)))throw new Sn("Cannot use GPS positioning for markers in manual mode");e.links||(Dn.logWarn(`Node ${e.id} has no links`),e.links=[])}checkLink(e,t){if(!t.nodeId)throw new Sn(`Link of node ${e.id} has no target id`);if(t.nodeId===e.id)throw new Sn(`Node ${e.id} links to itself`);if(!this.plugin.isGps&&!Dn.isExtendedPosition(t.position))throw new Sn(`No position provided for link ${t.nodeId} of node ${e.id}`);if(this.plugin.isGps&&!t.gps)throw new Sn(`No GPS position provided for link ${t.nodeId} of node ${e.id}`)}},vAe=class extends sW{async loadNode(e){if(this.nodes[e])return this.nodes[e];throw new Sn(`Node ${e} not found`)}setNodes(e){if(!(e!=null&&e.length))throw new Sn("No nodes provided");const t={},n={};e.forEach(r=>{if(this.checkNode(r),t[r.id])throw new Sn(`Duplicate node ${r.id}`);t[r.id]=r}),e.forEach(r=>{this.__checkLinks(r,t),r.links.forEach(i=>{n[i.nodeId]=!0})}),e.forEach(r=>{n[r.id]||Dn.logWarn(`Node ${r.id} is never linked to`)}),this.nodes=t}updateNode(e){if(!e.id)throw new Sn("No id given for node");const t=this.nodes[e.id];if(!t)throw new Sn(`Node ${e.id} does not exist`);return Object.assign(t,e),this.checkNode(t),this.__checkLinks(t,this.nodes),t}__checkLinks(e,t){e.links.forEach(n=>{if(!t[n.nodeId])throw new Sn(`Target node ${n.nodeId} of node ${e.id} does not exists`);n.gps=n.gps||t[n.nodeId].gps,this.checkLink(e,n)})}},yAe=class extends sW{constructor(e,t){if(super(e,t),!e.config.getNode)throw new Sn("Missing getNode() option.");this.nodeResolver=e.config.getNode}async loadNode(e){if(this.nodes[e])return this.nodes[e];{const t=await this.nodeResolver(e);return this.checkNode(t),t.links.forEach(n=>{this.checkLink(t,n)}),this.nodes[e]=t,t}}clearCache(){this.nodes={}}};function OB(e,t){const n=FB(e),r=FB(t),i=e[2]??0,a=t[2]??0;let c=0;return i!==a&&(c=Math.atan((a-i)/_Ae(n,r))),{yaw:xAe(n,r),pitch:c}}function FB(e){return[pr.degToRad(e[0]),pr.degToRad(e[1])]}function _Ae(e,t){return Dn.greatArcDistance(e,t)*6371e3}function xAe(e,t){const[n,r]=e,[i,a]=t,c=Math.sin(i-n)*Math.cos(a),s=Math.cos(r)*Math.sin(a)-Math.sin(r)*Math.cos(a)*Math.cos(i-n);return Math.atan2(c,s)}var KL=Dn.getConfigParser({dataMode:"client",positionMode:"manual",renderMode:"3d",nodes:null,getNode:null,startNodeId:null,preload:!1,transitionOptions:{showLoader:!0,speed:"20rpm",effect:"fade",rotation:!0},linksOnCompass:!0,showLinkTooltip:!0,getLinkTooltip:null,arrowStyle:mAe,arrowsPosition:{minPitch:.3,maxPitch:Math.PI/2,linkOverlapAngle:Math.PI/4,linkPitchOffset:-.1},map:null},{dataMode(e){if(e!=="client"&&e!=="server")throw new Sn("VirtualTourPlugin: invalid dataMode");return e},positionMode(e){if(e!=="gps"&&e!=="manual")throw new Sn("VirtualTourPlugin: invalid positionMode");return e},renderMode(e){if(e!=="3d"&&e!=="2d")throw new Sn("VirtualTourPlugin: invalid renderMode");return e},arrowsPosition(e,{defValue:t}){return{...t,...e}},arrowStyle(e,{defValue:t}){return{...t,...e}},map(e,{rawConfig:t}){if(e){if(t.dataMode==="server")return Dn.logWarn("VirtualTourPlugin: The map cannot be used in server side mode"),null;if(!e.imageUrl)return Dn.logWarn('VirtualTourPlugin: configuring the map requires at least "imageUrl"'),null}return e}}),px=class aW extends GL{constructor(t,n){super(t,n),this.state={currentNode:null,currentTooltip:null,loadingNode:null,preload:{}},this.arrowsRenderer=new gAe(this.viewer,this)}get is3D(){return this.config.renderMode==="3d"}get isServerSide(){return this.config.dataMode==="server"}get isGps(){return this.config.positionMode==="gps"}static withConfig(t){return[aW,t]}init(){var t,n;super.init(),this.arrowsRenderer.init(),Dn.checkStylesheet(this.viewer.container,"virtual-tour-plugin"),this.markers=this.viewer.getPlugin("markers"),this.compass=this.viewer.getPlugin("compass"),(t=this.markers)!=null&&t.config.markers&&(Dn.logWarn("No default markers can be configured on the MarkersPlugin when using the VirtualTourPlugin. Consider defining `markers` on each tour node."),delete this.markers.config.markers),this.isGps&&(this.plan=this.viewer.getPlugin("plan")),this.isServerSide||(this.gallery=this.viewer.getPlugin("gallery"),this.map=this.viewer.getPlugin("map"),this.config.map&&!this.map&&Dn.logWarn("The map is configured on the VirtualTourPlugin but the MapPlugin is not loaded.")),this.datasource=this.isServerSide?new yAe(this,this.viewer):new vAe(this,this.viewer),this.map&&(this.map.addEventListener("select-hotspot",this),this.map.setImage(this.config.map.imageUrl)),(n=this.plan)==null||n.addEventListener("select-hotspot",this),this.isServerSide?this.config.startNodeId&&this.setCurrentNode(this.config.startNodeId):this.config.nodes&&(this.setNodes(this.config.nodes,this.config.startNodeId),delete this.config.nodes)}destroy(){var t,n;(t=this.map)==null||t.removeEventListener("select-hotspot",this),(n=this.plan)==null||n.removeEventListener("select-hotspot",this),this.datasource.destroy(),this.arrowsRenderer.destroy(),delete this.datasource,delete this.markers,delete this.compass,delete this.gallery,delete this.arrowsRenderer,super.destroy()}handleEvent(t){var n;if(t instanceof Fn.ClickEvent){const r=(n=t.data.objects.find(i=>i.userData[IS]))==null?void 0:n.userData[IS];r&&this.setCurrentNode(r.nodeId,null,r)}else if(t.type==="select-hotspot"){const r=t.hotspotId;r.startsWith(um)&&this.setCurrentNode(r.substring(um.length))}}getCurrentNode(){return this.state.currentNode}setNodes(t,n){if(this.isServerSide)throw new Sn("Cannot set nodes in server side mode");this.__hideTooltip(),this.state.currentNode=null,this.datasource.setNodes(t),n?this.datasource.nodes[n]||(n=t[0].id,Dn.logWarn(`startNodeId not found is provided nodes, resetted to ${n}`)):n=t[0].id,this.setCurrentNode(n),this.__setGalleryItems(),this.__setMapHotspots(),this.__setPlanHotspots()}setCurrentNode(t,n,r){var c;if(t===((c=this.state.currentNode)==null?void 0:c.id)&&!(n!=null&&n.forceUpdate))return Promise.resolve(!0);n!=null&&n.forceUpdate&&this.isServerSide&&this.datasource.clearCache(),this.viewer.hideError(),this.state.loadingNode=t;const i=this.state.currentNode,a=i&&r?this.__getLinkPosition(i,r):null;return Promise.resolve(this.state.preload[t]).then(()=>{if(this.state.loadingNode!==t)throw Dn.getAbortError();return this.datasource.loadNode(t)}).then(s=>{var g,_,x;if(this.state.loadingNode!==t)throw Dn.getAbortError();const f={...KL.defaults.transitionOptions,rotateTo:a,zoomTo:a?this.viewer.getZoomLevel():null,...typeof this.config.transitionOptions=="function"?this.config.transitionOptions(s,i,r):this.config.transitionOptions,...n};return f.effect||(f.effect="none"),this.viewer.panel.hide("description"),this.__hideTooltip(),this.arrowsRenderer.clear(),(g=this.gallery)!=null&&g.config.hideOnClick&&this.gallery.hide(),(_=this.map)!=null&&_.config.minimizeOnHotspotClick&&this.map.minimize(),(x=this.plan)!=null&&x.config.minimizeOnHotspotClick&&this.plan.minimize(),f.rotation&&f.effect==="none"?this.viewer.animate({...f.rotateTo,zoom:f.zoomTo,speed:f.speed}).then(()=>[s,f]):Promise.resolve([s,f])}).then(([s,f])=>{var g,_;if(this.state.loadingNode!==t)throw Dn.getAbortError();return(g=this.markers)==null||g.clearMarkers(),this.config.linksOnCompass&&((_=this.compass)==null||_.clearHotspots()),this.viewer.setPanorama(s.panorama,{caption:s.caption,description:s.description,panoData:s.panoData,sphereCorrection:s.sphereCorrection,showLoader:f.showLoader,position:f.rotateTo,zoom:f.zoomTo,transition:f.effect==="none"?!1:{effect:f.effect,rotation:f.rotation,speed:f.speed}}).then(x=>{if(!x)throw Dn.getAbortError();return s})}).then(s=>{var f;if(this.state.loadingNode!==t)throw Dn.getAbortError();return this.state.currentNode=s,this.map&&this.map.setCenter(this.__getNodeMapPosition(s)??this.map.config.center),(f=this.plan)==null||f.setCoordinates(s.gps),this.__addNodeMarkers(s),this.__renderLinks(s),this.__preload(s),this.state.loadingNode=null,this.dispatchEvent(new QG(s,{fromNode:i,fromLink:r,fromLinkPosition:a})),this.viewer.resetIdleTimer(),!0}).catch(s=>{if(Dn.isAbortError(s))return!1;throw this.viewer.showError(this.viewer.config.lang.loadError),this.viewer.loader.hide(),this.viewer.navbar.setCaption(""),this.state.loadingNode=null,s})}async gotoLink(t,n="8rpm"){const r=this.getLinkPosition(t);n?await this.viewer.animate({...r,speed:n}):this.viewer.rotate(r)}getLinkPosition(t){var r;const n=(r=this.state.currentNode)==null?void 0:r.links.find(i=>i.nodeId===t);if(!n)throw new Sn(`Cannot find link "${t}"`);return this.__getLinkPosition(this.state.currentNode,n)}updateNode(t){var r,i,a;if(this.isServerSide)throw new Sn("Cannot update node in server side mode");const n=this.datasource.updateNode(t);if((t.name||t.thumbnail||t.panorama)&&this.__setGalleryItems(),(t.name||t.gps||t.map)&&this.__setMapHotspots(),(t.name||t.gps||t.plan)&&this.__setPlanHotspots(),((r=this.state.currentNode)==null?void 0:r.id)===n.id){if(this.__hideTooltip(),t.panorama||t.panoData||t.sphereCorrection){this.setCurrentNode(n.id,{forceUpdate:!0});return}t.caption&&this.viewer.setOption("caption",n.caption),t.description&&this.viewer.setOption("description",n.description),(t.links||t.gps)&&this.__renderLinks(n),t.gps&&((i=this.plan)==null||i.setCoordinates(n.gps)),(t.map||t.gps)&&((a=this.map)==null||a.setCenter(this.__getNodeMapPosition(n))),(t.markers||t.gps)&&this.__addNodeMarkers(n)}}__setGalleryItems(){this.gallery&&this.gallery.setItems(Object.values(this.datasource.nodes).filter(t=>t.showInGallery!==!1).map(t=>({id:t.id,panorama:t.panorama,name:t.name,thumbnail:t.thumbnail})),t=>{this.setCurrentNode(t)})}__setMapHotspots(){this.map&&this.map.setHotspots(Object.values(this.datasource.nodes).filter(t=>t.map!==!1).map(t=>({tooltip:t.name,...t.map||{},...this.__getNodeMapPosition(t),id:um+t.id})))}__setPlanHotspots(){this.plan&&this.plan.setHotspots(Object.values(this.datasource.nodes).filter(t=>t.plan!==!1).map(t=>({tooltip:t.name,...t.plan||{},coordinates:t.gps,id:um+t.id})))}__renderLinks(t){var r;this.arrowsRenderer.clear();const n=[];t.links.forEach(i=>{var c,s,f;const a=this.__getLinkPosition(t,i);a.yaw+=((c=i.linkOffset)==null?void 0:c.yaw)??0,a.pitch+=((s=i.linkOffset)==null?void 0:s.pitch)??0,this.isGps&&!this.is3D&&(a.pitch+=this.config.arrowsPosition.linkPitchOffset),n.push(a),this.arrowsRenderer.addLinkArrow(i,a,(f=i.linkOffset)==null?void 0:f.depth)}),this.arrowsRenderer.render(),this.config.linksOnCompass&&((r=this.compass)==null||r.setHotspots(n))}__getLinkPosition(t,n){return this.isGps?OB(t.gps,n.gps):this.viewer.dataHelper.cleanPosition(n.position)}async __getTooltipContent(t){const n=await this.datasource.loadNode(t.nodeId),r=[];(n.name||n.thumbnail||n.caption)&&(n.name&&r.push(`<h3>${n.name}</h3>`),n.thumbnail&&r.push(`<img src="${n.thumbnail}">`),n.caption&&r.push(`<p>${n.caption}</p>`));let i=r.join("");return this.config.getLinkTooltip&&(i=this.config.getLinkTooltip(i,t,n)),i}__onEnterArrow(t,n){var a,c;const r=Dn.getPosition(this.viewer.container),i={x:n.clientX-r.x,y:n.clientY-r.y};this.config.showLinkTooltip&&(this.state.currentTooltip=this.viewer.createTooltip({...pAe,left:i.x,top:i.y,box:{width:20,height:20}}),this.__getTooltipContent(t).then(s=>{s?this.state.currentTooltip.update(s):this.__hideTooltip()})),(a=this.map)==null||a.setActiveHotspot(um+t.nodeId),(c=this.plan)==null||c.setActiveHotspot(um+t.nodeId),this.dispatchEvent(new nW(t,this.state.currentNode))}__onHoverArrow(t){var i;const n=Dn.getPosition(this.viewer.container),r={x:t.clientX-n.x,y:t.clientY-n.y};(i=this.state.currentTooltip)==null||i.move({left:r.x,top:r.y})}__onLeaveArrow(t){var n,r;this.__hideTooltip(),(n=this.map)==null||n.setActiveHotspot(null),(r=this.plan)==null||r.setActiveHotspot(null),this.dispatchEvent(new oW(t,this.state.currentNode))}__hideTooltip(){var t;(t=this.state.currentTooltip)==null||t.hide(),this.state.currentTooltip=null}__preload(t){this.config.preload&&(this.state.preload[t.id]=!0,this.state.currentNode.links.filter(n=>!this.state.preload[n.nodeId]).filter(n=>typeof this.config.preload=="function"?this.config.preload(this.state.currentNode,n):!0).forEach(n=>{this.state.preload[n.nodeId]=this.datasource.loadNode(n.nodeId).then(r=>this.viewer.textureLoader.preloadPanorama(r.panorama)).then(()=>{this.state.preload[n.nodeId]=!0}).catch(()=>{delete this.state.preload[n.nodeId]})}))}__addNodeMarkers(t){t.markers&&(this.markers?this.markers.setMarkers(t.markers.map(n=>{var r,i;return n.gps&&this.isGps&&(n.position=OB(t.gps,n.gps),(r=n.data)!=null&&r.map&&Object.assign(n.data.map,this.__getGpsMapPosition(n.gps)),(i=n.data)!=null&&i.plan&&(n.data.plan.coordinates=n.gps)),n})):Dn.logWarn(`Node ${t.id} markers ignored because the plugin is not loaded.`))}__getNodeMapPosition(t){const n=this.__getGpsMapPosition(t.gps);return n||(t.map?{x:t.map.x,y:t.map.y}:null)}__getGpsMapPosition(t){const n=this.config.map;return this.isGps&&n&&n.extent&&n.size?{x:pr.mapLinear(t[0],n.extent[0],n.extent[2],0,n.size.width),y:pr.mapLinear(t[1],n.extent[1],n.extent[3],0,n.size.height)}:null}};px.id="virtual-tour";px.VERSION="5.13.4";px.configParser=KL;px.readonlyOptions=Object.keys(KL.defaults);var NB=px;const of=[{id:"0",point:[-92.12572989672026,38.53421432713342]},{id:"1",point:[-92.12304341293509,38.53672723512331]},{id:"2",point:[-92.11945284530871,38.54133496582979]},{id:"3",point:[-92.11576785749503,38.54478606247235]},{id:"4",point:[-92.10778464530942,38.544770729312454]},{id:"5",point:[-92.10258732764407,38.541357585467786]},{id:"6",point:[-92.09670854574377,38.53854148846571]},{id:"7",point:[-92.09328790813723,38.53629576427041]},{id:"8",point:[-92.11176575050796,38.5479069429093]}],bAe={id:"marker-viewpoint",image:"map-icons/viewpoint.png",gps:[-92.102043,38.54042],size:{width:32,height:32}},wAe={id:"marker-photo-trophy",image:"map-icons/photo_sight_captured.png",gps:[-92.157874,38.578638],size:{width:32,height:32}},I0=[bAe,wAe],SAe=e=>t=>({width:8192,cols:16,rows:8,baseUrl:`${e}/${t}_thumb.jpg`,tileUrl:(n,r)=>`${e}/${t}_${n}_${r}.jpg`}),MAe=e=>{const t=i=>({id:`node-${i}`,panorama:e(i),gps:of[i].point}),n=(...i)=>i.map(a=>({nodeId:`node-${a}`}));return{positionMode:"gps",nodes:[{...t(0),links:n(1)},{...t(1),links:n(0,2)},{...t(2),links:n(1,3)},{...t(3),links:n(2,8)},{...t(4),links:n(8,5),markers:I0},{...t(5),links:n(4,6),markers:I0},{...t(6),links:n(5,7),markers:I0},{...t(7),links:n(6),markers:I0},{...t(8),links:n(3,4),markers:I0}]}},CAe=e=>{const t=$.useRef(null),n=$.useRef(null),r=$.useRef(null),i=SAe(e.pixelRootUrl),a=MAe(i),c=(g,_)=>nr(r.current).setRotation(_/Math.PI*180),s=({node:g})=>{const[_,x]=nr(g.gps),C=[_,x];nr(t.current).panTo(C),nr(r.current).setLngLat(C)},f=()=>{const g=nr(n.current);nr(g.getPlugin(NB)).addEventListener("node-changed",s)};return $.useEffect(()=>{document.title="ATS Street View Proof of Concept"}),te.jsxs(te.Fragment,{children:[te.jsx(XL,{ref:n,adapter:pG,plugins:[NB.withConfig(a),rAe],src:i(0),height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:c,onReady:f}),te.jsx("div",{className:"credits",children:"Game data and images © SCS Software. Images captured by Trucker Mudgeon."}),te.jsxs(YM,{ref:t,style:{position:"absolute",left:20,bottom:20,width:"250px",height:"125px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:4,maxZoom:15,maxBounds:[of[0].point.map(g=>g-1),of[0].point.map(g=>g+1)],mapStyle:QM,attributionControl:!1,initialViewState:{longitude:of[0].point[0],latitude:of[0].point[1],zoom:12},children:[te.jsx(Z3,{ref:r,longitude:of[0].point[0],latitude:of[0].point[1],rotationAlignment:"map",children:te.jsx("div",{className:"street-view-marker"})}),te.jsx(JM,{tileRootUrl:e.tileRootUrl,mode:"light"}),te.jsx(bg,{tileRootUrl:e.tileRootUrl,game:"ats",mode:"light",enableIconAutoHide:!0,visibleIcons:Bh,dlcs:Rf})]})]})},aP="https://maps.truckermudgeon.com",BB="https://pixels.truckermudgeon.com",EAe=Jle(Tle([te.jsx(qb,{path:"/",element:te.jsx(pPe,{tileRootUrl:aP,pixelRootUrl:BB})}),te.jsx(qb,{path:"routes",element:te.jsx(PPe,{tileRootUrl:aP})}),te.jsx(qb,{path:"street-view",element:te.jsx(CAe,{tileRootUrl:aP,pixelRootUrl:BB})})])),TAe=U6({components:{JoyIconButton:{styleOverrides:{root:{backgroundColor:"var(--joy-palette-background-surface)"}}}}}),PAe=document.getElementById("root"),AAe=N8(PAe);AAe.render(te.jsx($.StrictMode,{children:te.jsxs(kK,{defaultMode:"system",modeStorageKey:"tm-mode",theme:TAe,children:[te.jsx(Zie,{}),te.jsx(hce,{router:EAe})]})}))});export default IAe();
