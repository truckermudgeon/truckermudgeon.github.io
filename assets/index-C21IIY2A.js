var dV=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var B_e=dV(Cr=>{function GO(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const l=Object.getOwnPropertyDescriptor(r,i);l&&Object.defineProperty(t,i,l.get?l:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}})();var _R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function fV(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var QS={exports:{}},i0={},e2={exports:{}},Gr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xR;function pV(){if(xR)return Gr;xR=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),w=Symbol.iterator;function S(Re){return Re===null||typeof Re!="object"?null:(Re=w&&Re[w]||Re["@@iterator"],typeof Re=="function"?Re:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,D={};function R(Re,Qe,Vt){this.props=Re,this.context=Qe,this.refs=D,this.updater=Vt||M}R.prototype.isReactComponent={},R.prototype.setState=function(Re,Qe){if(typeof Re!="object"&&typeof Re!="function"&&Re!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Re,Qe,"setState")},R.prototype.forceUpdate=function(Re){this.updater.enqueueForceUpdate(this,Re,"forceUpdate")};function L(){}L.prototype=R.prototype;function V(Re,Qe,Vt){this.props=Re,this.context=Qe,this.refs=D,this.updater=Vt||M}var B=V.prototype=new L;B.constructor=V,I(B,R.prototype),B.isPureReactComponent=!0;var H=Array.isArray,q=Object.prototype.hasOwnProperty,X={current:null},ee={key:!0,ref:!0,__self:!0,__source:!0};function se(Re,Qe,Vt){var je,ct={},Ct=null,ut=null;if(Qe!=null)for(je in Qe.ref!==void 0&&(ut=Qe.ref),Qe.key!==void 0&&(Ct=""+Qe.key),Qe)q.call(Qe,je)&&!ee.hasOwnProperty(je)&&(ct[je]=Qe[je]);var lt=arguments.length-2;if(lt===1)ct.children=Vt;else if(1<lt){for(var _t=Array(lt),wt=0;wt<lt;wt++)_t[wt]=arguments[wt+2];ct.children=_t}if(Re&&Re.defaultProps)for(je in lt=Re.defaultProps,lt)ct[je]===void 0&&(ct[je]=lt[je]);return{$$typeof:t,type:Re,key:Ct,ref:ut,props:ct,_owner:X.current}}function J(Re,Qe){return{$$typeof:t,type:Re.type,key:Qe,ref:Re.ref,props:Re.props,_owner:Re._owner}}function $(Re){return typeof Re=="object"&&Re!==null&&Re.$$typeof===t}function le(Re){var Qe={"=":"=0",":":"=2"};return"$"+Re.replace(/[=:]/g,function(Vt){return Qe[Vt]})}var Ce=/\/+/g;function we(Re,Qe){return typeof Re=="object"&&Re!==null&&Re.key!=null?le(""+Re.key):Qe.toString(36)}function We(Re,Qe,Vt,je,ct){var Ct=typeof Re;(Ct==="undefined"||Ct==="boolean")&&(Re=null);var ut=!1;if(Re===null)ut=!0;else switch(Ct){case"string":case"number":ut=!0;break;case"object":switch(Re.$$typeof){case t:case e:ut=!0}}if(ut)return ut=Re,ct=ct(ut),Re=je===""?"."+we(ut,0):je,H(ct)?(Vt="",Re!=null&&(Vt=Re.replace(Ce,"$&/")+"/"),We(ct,Qe,Vt,"",function(wt){return wt})):ct!=null&&($(ct)&&(ct=J(ct,Vt+(!ct.key||ut&&ut.key===ct.key?"":(""+ct.key).replace(Ce,"$&/")+"/")+Re)),Qe.push(ct)),1;if(ut=0,je=je===""?".":je+":",H(Re))for(var lt=0;lt<Re.length;lt++){Ct=Re[lt];var _t=je+we(Ct,lt);ut+=We(Ct,Qe,Vt,_t,ct)}else if(_t=S(Re),typeof _t=="function")for(Re=_t.call(Re),lt=0;!(Ct=Re.next()).done;)Ct=Ct.value,_t=je+we(Ct,lt++),ut+=We(Ct,Qe,Vt,_t,ct);else if(Ct==="object")throw Qe=String(Re),Error("Objects are not valid as a React child (found: "+(Qe==="[object Object]"?"object with keys {"+Object.keys(Re).join(", ")+"}":Qe)+"). If you meant to render a collection of children, use an array instead.");return ut}function Fe(Re,Qe,Vt){if(Re==null)return Re;var je=[],ct=0;return We(Re,je,"","",function(Ct){return Qe.call(Vt,Ct,ct++)}),je}function Me(Re){if(Re._status===-1){var Qe=Re._result;Qe=Qe(),Qe.then(function(Vt){(Re._status===0||Re._status===-1)&&(Re._status=1,Re._result=Vt)},function(Vt){(Re._status===0||Re._status===-1)&&(Re._status=2,Re._result=Vt)}),Re._status===-1&&(Re._status=0,Re._result=Qe)}if(Re._status===1)return Re._result.default;throw Re._result}var Ee={current:null},Te={transition:null},Ze={ReactCurrentDispatcher:Ee,ReactCurrentBatchConfig:Te,ReactCurrentOwner:X};function rt(){throw Error("act(...) is not supported in production builds of React.")}return Gr.Children={map:Fe,forEach:function(Re,Qe,Vt){Fe(Re,function(){Qe.apply(this,arguments)},Vt)},count:function(Re){var Qe=0;return Fe(Re,function(){Qe++}),Qe},toArray:function(Re){return Fe(Re,function(Qe){return Qe})||[]},only:function(Re){if(!$(Re))throw Error("React.Children.only expected to receive a single React element child.");return Re}},Gr.Component=R,Gr.Fragment=n,Gr.Profiler=i,Gr.PureComponent=V,Gr.StrictMode=r,Gr.Suspense=p,Gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ze,Gr.act=rt,Gr.cloneElement=function(Re,Qe,Vt){if(Re==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Re+".");var je=I({},Re.props),ct=Re.key,Ct=Re.ref,ut=Re._owner;if(Qe!=null){if(Qe.ref!==void 0&&(Ct=Qe.ref,ut=X.current),Qe.key!==void 0&&(ct=""+Qe.key),Re.type&&Re.type.defaultProps)var lt=Re.type.defaultProps;for(_t in Qe)q.call(Qe,_t)&&!ee.hasOwnProperty(_t)&&(je[_t]=Qe[_t]===void 0&&lt!==void 0?lt[_t]:Qe[_t])}var _t=arguments.length-2;if(_t===1)je.children=Vt;else if(1<_t){lt=Array(_t);for(var wt=0;wt<_t;wt++)lt[wt]=arguments[wt+2];je.children=lt}return{$$typeof:t,type:Re.type,key:ct,ref:Ct,props:je,_owner:ut}},Gr.createContext=function(Re){return Re={$$typeof:c,_currentValue:Re,_currentValue2:Re,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Re.Provider={$$typeof:l,_context:Re},Re.Consumer=Re},Gr.createElement=se,Gr.createFactory=function(Re){var Qe=se.bind(null,Re);return Qe.type=Re,Qe},Gr.createRef=function(){return{current:null}},Gr.forwardRef=function(Re){return{$$typeof:s,render:Re}},Gr.isValidElement=$,Gr.lazy=function(Re){return{$$typeof:_,_payload:{_status:-1,_result:Re},_init:Me}},Gr.memo=function(Re,Qe){return{$$typeof:y,type:Re,compare:Qe===void 0?null:Qe}},Gr.startTransition=function(Re){var Qe=Te.transition;Te.transition={};try{Re()}finally{Te.transition=Qe}},Gr.unstable_act=rt,Gr.useCallback=function(Re,Qe){return Ee.current.useCallback(Re,Qe)},Gr.useContext=function(Re){return Ee.current.useContext(Re)},Gr.useDebugValue=function(){},Gr.useDeferredValue=function(Re){return Ee.current.useDeferredValue(Re)},Gr.useEffect=function(Re,Qe){return Ee.current.useEffect(Re,Qe)},Gr.useId=function(){return Ee.current.useId()},Gr.useImperativeHandle=function(Re,Qe,Vt){return Ee.current.useImperativeHandle(Re,Qe,Vt)},Gr.useInsertionEffect=function(Re,Qe){return Ee.current.useInsertionEffect(Re,Qe)},Gr.useLayoutEffect=function(Re,Qe){return Ee.current.useLayoutEffect(Re,Qe)},Gr.useMemo=function(Re,Qe){return Ee.current.useMemo(Re,Qe)},Gr.useReducer=function(Re,Qe,Vt){return Ee.current.useReducer(Re,Qe,Vt)},Gr.useRef=function(Re){return Ee.current.useRef(Re)},Gr.useState=function(Re){return Ee.current.useState(Re)},Gr.useSyncExternalStore=function(Re,Qe,Vt){return Ee.current.useSyncExternalStore(Re,Qe,Vt)},Gr.useTransition=function(){return Ee.current.useTransition()},Gr.version="18.3.1",Gr}var bR;function wP(){return bR||(bR=1,e2.exports=pV()),e2.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wR;function mV(){if(wR)return i0;wR=1;var t=wP(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(s,p,y){var _,w={},S=null,M=null;y!==void 0&&(S=""+y),p.key!==void 0&&(S=""+p.key),p.ref!==void 0&&(M=p.ref);for(_ in p)r.call(p,_)&&!l.hasOwnProperty(_)&&(w[_]=p[_]);if(s&&s.defaultProps)for(_ in p=s.defaultProps,p)w[_]===void 0&&(w[_]=p[_]);return{$$typeof:e,type:s,key:S,ref:M,props:w,_owner:i.current}}return i0.Fragment=n,i0.jsx=c,i0.jsxs=c,i0}var SR;function gV(){return SR||(SR=1,QS.exports=mV()),QS.exports}var ie=gV();const o0={grey:{50:"#FBFCFE",100:"#F0F4F8",200:"#DDE7EE",300:"#CDD7E1",400:"#9FA6AD",500:"#636B74",600:"#555E68",700:"#32383E",800:"#171A1C",900:"#0B0D0E"},blue:{50:"#EDF5FD",100:"#E3EFFB",200:"#C7DFF7",300:"#97C3F0",400:"#4393E4",500:"#0B6BCB",600:"#185EA5",700:"#12467B",800:"#0A2744",900:"#051423"},yellow:{50:"#FEFAF6",100:"#FDF0E1",200:"#FCE1C2",300:"#F3C896",400:"#EA9A3E",500:"#9A5B13",600:"#72430D",700:"#492B08",800:"#2E1B05",900:"#1D1002"},red:{50:"#FEF6F6",100:"#FCE4E4",200:"#F7C5C5",300:"#F09898",400:"#E47474",500:"#C41C1C",600:"#A51818",700:"#7D1212",800:"#430A0A",900:"#240505"},green:{50:"#F6FEF6",100:"#E3FBE3",200:"#C7F7C7",300:"#A1E8A1",400:"#51BC51",500:"#1F7A1F",600:"#136C13",700:"#0A470A",800:"#042F04",900:"#021D02"}},O_="$$joy";function f_(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}function me(){return me=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},me.apply(null,arguments)}var G=wP();const B0=vw(G),zE=GO({__proto__:null,default:B0},[G]);function vV(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function yV(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var _V=function(){function t(n){var r=this;this._insertTag=function(i){var l;r.tags.length===0?r.insertionPoint?l=r.insertionPoint.nextSibling:r.prepend?l=r.container.firstChild:l=r.before:l=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,l),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(yV(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var l=vV(i);try{l.insertRule(r,l.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var i;return(i=r.parentNode)==null?void 0:i.removeChild(r)}),this.tags=[],this.ctr=0},t}(),aa="-ms-",Mb="-moz-",di="-webkit-",WO="comm",SP="rule",MP="decl",xV="@import",qO="@keyframes",bV="@layer",wV=Math.abs,yw=String.fromCharCode,SV=Object.assign;function MV(t,e){return Hs(t,0)^45?(((e<<2^Hs(t,0))<<2^Hs(t,1))<<2^Hs(t,2))<<2^Hs(t,3):0}function XO(t){return t.trim()}function CV(t,e){return(t=e.exec(t))?t[0]:t}function fi(t,e,n){return t.replace(e,n)}function OE(t,e){return t.indexOf(e)}function Hs(t,e){return t.charCodeAt(e)|0}function p_(t,e,n){return t.slice(e,n)}function vh(t){return t.length}function CP(t){return t.length}function i1(t,e){return e.push(t),t}function EV(t,e){return t.map(e).join("")}var _w=1,Xv=1,ZO=0,rl=0,Ko=0,hy="";function xw(t,e,n,r,i,l,c){return{value:t,root:e,parent:n,type:r,props:i,children:l,line:_w,column:Xv,length:c,return:""}}function s0(t,e){return SV(xw("",null,null,"",null,null,0),t,{length:-t.length},e)}function TV(){return Ko}function PV(){return Ko=rl>0?Hs(hy,--rl):0,Xv--,Ko===10&&(Xv=1,_w--),Ko}function jl(){return Ko=rl<ZO?Hs(hy,rl++):0,Xv++,Ko===10&&(Xv=1,_w++),Ko}function Mh(){return Hs(hy,rl)}function K1(){return rl}function F_(t,e){return p_(hy,t,e)}function m_(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function YO(t){return _w=Xv=1,ZO=vh(hy=t),rl=0,[]}function KO(t){return hy="",t}function J1(t){return XO(F_(rl-1,FE(t===91?t+2:t===40?t+1:t)))}function AV(t){for(;(Ko=Mh())&&Ko<33;)jl();return m_(t)>2||m_(Ko)>3?"":" "}function IV(t,e){for(;--e&&jl()&&!(Ko<48||Ko>102||Ko>57&&Ko<65||Ko>70&&Ko<97););return F_(t,K1()+(e<6&&Mh()==32&&jl()==32))}function FE(t){for(;jl();)switch(Ko){case t:return rl;case 34:case 39:t!==34&&t!==39&&FE(Ko);break;case 40:t===41&&FE(t);break;case 92:jl();break}return rl}function RV(t,e){for(;jl()&&t+Ko!==57;)if(t+Ko===84&&Mh()===47)break;return"/*"+F_(e,rl-1)+"*"+yw(t===47?t:jl())}function LV(t){for(;!m_(Mh());)jl();return F_(t,rl)}function kV(t){return KO(Q1("",null,null,null,[""],t=YO(t),0,[0],t))}function Q1(t,e,n,r,i,l,c,s,p){for(var y=0,_=0,w=c,S=0,M=0,I=0,D=1,R=1,L=1,V=0,B="",H=i,q=l,X=r,ee=B;R;)switch(I=V,V=jl()){case 40:if(I!=108&&Hs(ee,w-1)==58){OE(ee+=fi(J1(V),"&","&\f"),"&\f")!=-1&&(L=-1);break}case 34:case 39:case 91:ee+=J1(V);break;case 9:case 10:case 13:case 32:ee+=AV(I);break;case 92:ee+=IV(K1()-1,7);continue;case 47:switch(Mh()){case 42:case 47:i1(DV(RV(jl(),K1()),e,n),p);break;default:ee+="/"}break;case 123*D:s[y++]=vh(ee)*L;case 125*D:case 59:case 0:switch(V){case 0:case 125:R=0;case 59+_:L==-1&&(ee=fi(ee,/\f/g,"")),M>0&&vh(ee)-w&&i1(M>32?CR(ee+";",r,n,w-1):CR(fi(ee," ","")+";",r,n,w-2),p);break;case 59:ee+=";";default:if(i1(X=MR(ee,e,n,y,_,i,s,B,H=[],q=[],w),l),V===123)if(_===0)Q1(ee,e,X,X,H,l,w,s,q);else switch(S===99&&Hs(ee,3)===110?100:S){case 100:case 108:case 109:case 115:Q1(t,X,X,r&&i1(MR(t,X,X,0,0,i,s,B,i,H=[],w),q),i,q,w,s,r?H:q);break;default:Q1(ee,X,X,X,[""],q,0,s,q)}}y=_=M=0,D=L=1,B=ee="",w=c;break;case 58:w=1+vh(ee),M=I;default:if(D<1){if(V==123)--D;else if(V==125&&D++==0&&PV()==125)continue}switch(ee+=yw(V),V*D){case 38:L=_>0?1:(ee+="\f",-1);break;case 44:s[y++]=(vh(ee)-1)*L,L=1;break;case 64:Mh()===45&&(ee+=J1(jl())),S=Mh(),_=w=vh(B=ee+=LV(K1())),V++;break;case 45:I===45&&vh(ee)==2&&(D=0)}}return l}function MR(t,e,n,r,i,l,c,s,p,y,_){for(var w=i-1,S=i===0?l:[""],M=CP(S),I=0,D=0,R=0;I<r;++I)for(var L=0,V=p_(t,w+1,w=wV(D=c[I])),B=t;L<M;++L)(B=XO(D>0?S[L]+" "+V:fi(V,/&\f/g,S[L])))&&(p[R++]=B);return xw(t,e,n,i===0?SP:s,p,y,_)}function DV(t,e,n){return xw(t,e,n,WO,yw(TV()),p_(t,2,-2),0)}function CR(t,e,n,r){return xw(t,e,n,MP,p_(t,0,r),p_(t,r+1,-1),r)}function zv(t,e){for(var n="",r=CP(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function zV(t,e,n,r){switch(t.type){case bV:if(t.children.length)break;case xV:case MP:return t.return=t.return||t.value;case WO:return"";case qO:return t.return=t.value+"{"+zv(t.children,r)+"}";case SP:t.value=t.props.join(",")}return vh(n=zv(t.children,r))?t.return=t.value+"{"+n+"}":""}function OV(t){var e=CP(t);return function(n,r,i,l){for(var c="",s=0;s<e;s++)c+=t[s](n,r,i,l)||"";return c}}function FV(t){return function(e){e.root||(e=e.return)&&t(e)}}function JO(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var NV=function(e,n,r){for(var i=0,l=0;i=l,l=Mh(),i===38&&l===12&&(n[r]=1),!m_(l);)jl();return F_(e,rl)},BV=function(e,n){var r=-1,i=44;do switch(m_(i)){case 0:i===38&&Mh()===12&&(n[r]=1),e[r]+=NV(rl-1,n,r);break;case 2:e[r]+=J1(i);break;case 4:if(i===44){e[++r]=Mh()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=yw(i)}while(i=jl());return e},UV=function(e,n){return KO(BV(YO(e),n))},ER=new WeakMap,$V=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!ER.get(r))&&!i){ER.set(e,!0);for(var l=[],c=UV(n,l),s=r.props,p=0,y=0;p<c.length;p++)for(var _=0;_<s.length;_++,y++)e.props[y]=l[p]?c[p].replace(/&\f/g,s[_]):s[_]+" "+c[p]}}},VV=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function QO(t,e){switch(MV(t,e)){case 5103:return di+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return di+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return di+t+Mb+t+aa+t+t;case 6828:case 4268:return di+t+aa+t+t;case 6165:return di+t+aa+"flex-"+t+t;case 5187:return di+t+fi(t,/(\w+).+(:[^]+)/,di+"box-$1$2"+aa+"flex-$1$2")+t;case 5443:return di+t+aa+"flex-item-"+fi(t,/flex-|-self/,"")+t;case 4675:return di+t+aa+"flex-line-pack"+fi(t,/align-content|flex-|-self/,"")+t;case 5548:return di+t+aa+fi(t,"shrink","negative")+t;case 5292:return di+t+aa+fi(t,"basis","preferred-size")+t;case 6060:return di+"box-"+fi(t,"-grow","")+di+t+aa+fi(t,"grow","positive")+t;case 4554:return di+fi(t,/([^-])(transform)/g,"$1"+di+"$2")+t;case 6187:return fi(fi(fi(t,/(zoom-|grab)/,di+"$1"),/(image-set)/,di+"$1"),t,"")+t;case 5495:case 3959:return fi(t,/(image-set\([^]*)/,di+"$1$`$1");case 4968:return fi(fi(t,/(.+:)(flex-)?(.*)/,di+"box-pack:$3"+aa+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+di+t+t;case 4095:case 3583:case 4068:case 2532:return fi(t,/(.+)-inline(.+)/,di+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(vh(t)-1-e>6)switch(Hs(t,e+1)){case 109:if(Hs(t,e+4)!==45)break;case 102:return fi(t,/(.+:)(.+)-([^]+)/,"$1"+di+"$2-$3$1"+Mb+(Hs(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~OE(t,"stretch")?QO(fi(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Hs(t,e+1)!==115)break;case 6444:switch(Hs(t,vh(t)-3-(~OE(t,"!important")&&10))){case 107:return fi(t,":",":"+di)+t;case 101:return fi(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+di+(Hs(t,14)===45?"inline-":"")+"box$3$1"+di+"$2$3$1"+aa+"$2box$3")+t}break;case 5936:switch(Hs(t,e+11)){case 114:return di+t+aa+fi(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return di+t+aa+fi(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return di+t+aa+fi(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return di+t+aa+t+t}return t}var jV=function(e,n,r,i){if(e.length>-1&&!e.return)switch(e.type){case MP:e.return=QO(e.value,e.length);break;case qO:return zv([s0(e,{value:fi(e.value,"@","@"+di)})],i);case SP:if(e.length)return EV(e.props,function(l){switch(CV(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return zv([s0(e,{props:[fi(l,/:(read-\w+)/,":"+Mb+"$1")]})],i);case"::placeholder":return zv([s0(e,{props:[fi(l,/:(plac\w+)/,":"+di+"input-$1")]}),s0(e,{props:[fi(l,/:(plac\w+)/,":"+Mb+"$1")]}),s0(e,{props:[fi(l,/:(plac\w+)/,aa+"input-$1")]})],i)}return""})}},HV=[jV],GV=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(D){var R=D.getAttribute("data-emotion");R.indexOf(" ")!==-1&&(document.head.appendChild(D),D.setAttribute("data-s",""))})}var i=e.stylisPlugins||HV,l={},c,s=[];c=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(D){for(var R=D.getAttribute("data-emotion").split(" "),L=1;L<R.length;L++)l[R[L]]=!0;s.push(D)});var p,y=[$V,VV];{var _,w=[zV,FV(function(D){_.insert(D)})],S=OV(y.concat(i,w)),M=function(R){return zv(kV(R),S)};p=function(R,L,V,B){_=V,M(R?R+"{"+L.styles+"}":L.styles),B&&(I.inserted[L.name]=!0)}}var I={key:n,sheet:new _V({key:n,container:c,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:p};return I.sheet.hydrate(s),I},t2={exports:{}},yi={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TR;function WV(){if(TR)return yi;TR=1;var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,i=t?Symbol.for("react.strict_mode"):60108,l=t?Symbol.for("react.profiler"):60114,c=t?Symbol.for("react.provider"):60109,s=t?Symbol.for("react.context"):60110,p=t?Symbol.for("react.async_mode"):60111,y=t?Symbol.for("react.concurrent_mode"):60111,_=t?Symbol.for("react.forward_ref"):60112,w=t?Symbol.for("react.suspense"):60113,S=t?Symbol.for("react.suspense_list"):60120,M=t?Symbol.for("react.memo"):60115,I=t?Symbol.for("react.lazy"):60116,D=t?Symbol.for("react.block"):60121,R=t?Symbol.for("react.fundamental"):60117,L=t?Symbol.for("react.responder"):60118,V=t?Symbol.for("react.scope"):60119;function B(q){if(typeof q=="object"&&q!==null){var X=q.$$typeof;switch(X){case e:switch(q=q.type,q){case p:case y:case r:case l:case i:case w:return q;default:switch(q=q&&q.$$typeof,q){case s:case _:case I:case M:case c:return q;default:return X}}case n:return X}}}function H(q){return B(q)===y}return yi.AsyncMode=p,yi.ConcurrentMode=y,yi.ContextConsumer=s,yi.ContextProvider=c,yi.Element=e,yi.ForwardRef=_,yi.Fragment=r,yi.Lazy=I,yi.Memo=M,yi.Portal=n,yi.Profiler=l,yi.StrictMode=i,yi.Suspense=w,yi.isAsyncMode=function(q){return H(q)||B(q)===p},yi.isConcurrentMode=H,yi.isContextConsumer=function(q){return B(q)===s},yi.isContextProvider=function(q){return B(q)===c},yi.isElement=function(q){return typeof q=="object"&&q!==null&&q.$$typeof===e},yi.isForwardRef=function(q){return B(q)===_},yi.isFragment=function(q){return B(q)===r},yi.isLazy=function(q){return B(q)===I},yi.isMemo=function(q){return B(q)===M},yi.isPortal=function(q){return B(q)===n},yi.isProfiler=function(q){return B(q)===l},yi.isStrictMode=function(q){return B(q)===i},yi.isSuspense=function(q){return B(q)===w},yi.isValidElementType=function(q){return typeof q=="string"||typeof q=="function"||q===r||q===y||q===l||q===i||q===w||q===S||typeof q=="object"&&q!==null&&(q.$$typeof===I||q.$$typeof===M||q.$$typeof===c||q.$$typeof===s||q.$$typeof===_||q.$$typeof===R||q.$$typeof===L||q.$$typeof===V||q.$$typeof===D)},yi.typeOf=B,yi}var PR;function qV(){return PR||(PR=1,t2.exports=WV()),t2.exports}var n2,AR;function XV(){if(AR)return n2;AR=1;var t=qV(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};l[t.ForwardRef]=r,l[t.Memo]=i;function c(I){return t.isMemo(I)?i:l[I.$$typeof]||e}var s=Object.defineProperty,p=Object.getOwnPropertyNames,y=Object.getOwnPropertySymbols,_=Object.getOwnPropertyDescriptor,w=Object.getPrototypeOf,S=Object.prototype;function M(I,D,R){if(typeof D!="string"){if(S){var L=w(D);L&&L!==S&&M(I,L,R)}var V=p(D);y&&(V=V.concat(y(D)));for(var B=c(I),H=c(D),q=0;q<V.length;++q){var X=V[q];if(!n[X]&&!(R&&R[X])&&!(H&&H[X])&&!(B&&B[X])){var ee=_(D,X);try{s(I,X,ee)}catch{}}}}return I}return n2=M,n2}XV();var ZV=!0;function e4(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):i&&(r+=i+" ")}),r}var EP=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||ZV===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},TP=function(e,n,r){EP(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var l=n;do e.insert(n===l?"."+i:"",l,e.sheet,!0),l=l.next;while(l!==void 0)}};function YV(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var KV={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},JV=/[A-Z]|^ms/g,QV=/_EMO_([^_]+?)_([^]*?)_EMO_/g,t4=function(e){return e.charCodeAt(1)===45},IR=function(e){return e!=null&&typeof e!="boolean"},r2=JO(function(t){return t4(t)?t:t.replace(JV,"-$&").toLowerCase()}),RR=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(QV,function(r,i,l){return yh={name:i,styles:l,next:yh},i})}return KV[e]!==1&&!t4(e)&&typeof n=="number"&&n!==0?n+"px":n};function g_(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0)return r;switch(typeof n){case"boolean":return"";case"object":{var i=n;if(i.anim===1)return yh={name:i.name,styles:i.styles,next:yh},i.name;var l=n;if(l.styles!==void 0){var c=l.next;if(c!==void 0)for(;c!==void 0;)yh={name:c.name,styles:c.styles,next:yh},c=c.next;var s=l.styles+";";return s}return ej(t,e,n)}case"function":{if(t!==void 0){var p=yh,y=n(t);return yh=p,g_(t,e,y)}break}}var _=n;if(e==null)return _;var w=e[_];return w!==void 0?w:_}function ej(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=g_(t,e,n[i])+";";else for(var l in n){var c=n[l];if(typeof c!="object"){var s=c;e!=null&&e[s]!==void 0?r+=l+"{"+e[s]+"}":IR(s)&&(r+=r2(l)+":"+RR(l,s)+";")}else if(Array.isArray(c)&&typeof c[0]=="string"&&(e==null||e[c[0]]===void 0))for(var p=0;p<c.length;p++)IR(c[p])&&(r+=r2(l)+":"+RR(l,c[p])+";");else{var y=g_(t,e,c);switch(l){case"animation":case"animationName":{r+=r2(l)+":"+y+";";break}default:r+=l+"{"+y+"}"}}}return r}var LR=/label:\s*([^\s;{]+)\s*(;|$)/g,yh;function N_(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,i="";yh=void 0;var l=t[0];if(l==null||l.raw===void 0)r=!1,i+=g_(n,e,l);else{var c=l;i+=c[0]}for(var s=1;s<t.length;s++)if(i+=g_(n,e,t[s]),r){var p=l;i+=p[s]}LR.lastIndex=0;for(var y="",_;(_=LR.exec(i))!==null;)y+="-"+_[1];var w=YV(i)+y;return{name:w,styles:i,next:yh}}var tj=function(e){return e()},n4=zE.useInsertionEffect?zE.useInsertionEffect:!1,r4=n4||tj,kR=n4||G.useLayoutEffect,i4=G.createContext(typeof HTMLElement<"u"?GV({key:"css"}):null);i4.Provider;var PP=function(e){return G.forwardRef(function(n,r){var i=G.useContext(i4);return e(n,i,r)})},B_=G.createContext({}),AP={}.hasOwnProperty,NE="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",nj=function(e,n){var r={};for(var i in n)AP.call(n,i)&&(r[i]=n[i]);return r[NE]=e,r},rj=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return EP(n,r,i),r4(function(){return TP(n,r,i)}),null},ij=PP(function(t,e,n){var r=t.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var i=t[NE],l=[r],c="";typeof t.className=="string"?c=e4(e.registered,l,t.className):t.className!=null&&(c=t.className+" ");var s=N_(l,void 0,G.useContext(B_));c+=e.key+"-"+s.name;var p={};for(var y in t)AP.call(t,y)&&y!=="css"&&y!==NE&&(p[y]=t[y]);return p.className=c,n&&(p.ref=n),G.createElement(G.Fragment,null,G.createElement(rj,{cache:e,serialized:s,isStringTag:typeof i=="string"}),G.createElement(i,p))}),oj=ij,DR=function(e,n){var r=arguments;if(n==null||!AP.call(n,"css"))return G.createElement.apply(void 0,r);var i=r.length,l=new Array(i);l[0]=oj,l[1]=nj(e,n);for(var c=2;c<i;c++)l[c]=r[c];return G.createElement.apply(null,l)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(DR||(DR={}));var sj=PP(function(t,e){var n=t.styles,r=N_([n],void 0,G.useContext(B_)),i=G.useRef();return kR(function(){var l=e.key+"-global",c=new e.sheet.constructor({key:l,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),s=!1,p=document.querySelector('style[data-emotion="'+l+" "+r.name+'"]');return e.sheet.tags.length&&(c.before=e.sheet.tags[0]),p!==null&&(s=!0,p.setAttribute("data-emotion",l),c.hydrate([p])),i.current=[c,s],function(){c.flush()}},[e]),kR(function(){var l=i.current,c=l[0],s=l[1];if(s){l[1]=!1;return}if(r.next!==void 0&&TP(e,r.next,!0),c.tags.length){var p=c.tags[c.tags.length-1].nextElementSibling;c.before=p,c.flush()}e.insert("",r,c,!1)},[e,r.name]),null});function o4(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return N_(e)}function IP(){var t=o4.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var aj=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,lj=JO(function(t){return aj.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),cj=lj,uj=function(e){return e!=="theme"},zR=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?cj:uj},OR=function(e,n,r){var i;if(n){var l=n.shouldForwardProp;i=e.__emotion_forwardProp&&l?function(c){return e.__emotion_forwardProp(c)&&l(c)}:l}return typeof i!="function"&&r&&(i=e.__emotion_forwardProp),i},hj=function(e){var n=e.cache,r=e.serialized,i=e.isStringTag;return EP(n,r,i),r4(function(){return TP(n,r,i)}),null},dj=function t(e,n){var r=e.__emotion_real===e,i=r&&e.__emotion_base||e,l,c;n!==void 0&&(l=n.label,c=n.target);var s=OR(e,n,r),p=s||zR(i),y=!p("as");return function(){var _=arguments,w=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(l!==void 0&&w.push("label:"+l+";"),_[0]==null||_[0].raw===void 0)w.push.apply(w,_);else{var S=_[0];w.push(S[0]);for(var M=_.length,I=1;I<M;I++)w.push(_[I],S[I])}var D=PP(function(R,L,V){var B=y&&R.as||i,H="",q=[],X=R;if(R.theme==null){X={};for(var ee in R)X[ee]=R[ee];X.theme=G.useContext(B_)}typeof R.className=="string"?H=e4(L.registered,q,R.className):R.className!=null&&(H=R.className+" ");var se=N_(w.concat(q),L.registered,X);H+=L.key+"-"+se.name,c!==void 0&&(H+=" "+c);var J=y&&s===void 0?zR(B):p,$={};for(var le in R)y&&le==="as"||J(le)&&($[le]=R[le]);return $.className=H,V&&($.ref=V),G.createElement(G.Fragment,null,G.createElement(hj,{cache:L,serialized:se,isStringTag:typeof B=="string"}),G.createElement(B,$))});return D.displayName=l!==void 0?l:"Styled("+(typeof i=="string"?i:i.displayName||i.name||"Component")+")",D.defaultProps=e.defaultProps,D.__emotion_real=D,D.__emotion_base=i,D.__emotion_styles=w,D.__emotion_forwardProp=s,Object.defineProperty(D,"toString",{value:function(){return"."+c}}),D.withComponent=function(R,L){var V=t(R,me({},n,L,{shouldForwardProp:OR(D,L,!0)}));return V.apply(void 0,w)},D}},fj=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Cb=dj.bind(null);fj.forEach(function(t){Cb[t]=Cb(t)});function pj(t){return t==null||Object.keys(t).length===0}function eb(t){const{styles:e,defaultTheme:n={}}=t,r=typeof e=="function"?i=>e(pj(i)?n:i):e;return ie.jsx(sj,{styles:r})}function s4(t,e){return Cb(t,e)}const mj=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))};function rr(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function Gf(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function a4(t){if(G.isValidElement(t)||!Gf(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=a4(t[n])}),e}function Hl(t,e,n={clone:!0}){const r=n.clone?me({},t):t;return Gf(t)&&Gf(e)&&Object.keys(e).forEach(i=>{G.isValidElement(e[i])?r[i]=e[i]:Gf(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&Gf(t[i])?r[i]=Hl(t[i],e[i],n):n.clone?r[i]=Gf(e[i])?a4(e[i]):e[i]:r[i]=e[i]}),r}const gj=["values","unit","step"],vj=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>me({},n,{[r.key]:r.val}),{})};function l4(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5}=t,i=rr(t,gj),l=vj(e),c=Object.keys(l);function s(S){return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${n})`}function p(S){return`@media (max-width:${(typeof e[S]=="number"?e[S]:S)-r/100}${n})`}function y(S,M){const I=c.indexOf(M);return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${n}) and (max-width:${(I!==-1&&typeof e[c[I]]=="number"?e[c[I]]:M)-r/100}${n})`}function _(S){return c.indexOf(S)+1<c.length?y(S,c[c.indexOf(S)+1]):s(S)}function w(S){const M=c.indexOf(S);return M===0?s(c[1]):M===c.length-1?p(c[M]):y(S,c[c.indexOf(S)+1]).replace("@media","@media not all and")}return me({keys:c,values:l,up:s,down:p,between:y,only:_,not:w,unit:n},i)}const yj={borderRadius:4};function U0(t,e){return e?Hl(t,e,{clone:!1}):t}const RP={xs:0,sm:600,md:900,lg:1200,xl:1536},FR={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${RP[t]}px)`};function wu(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const l=r.breakpoints||FR;return e.reduce((c,s,p)=>(c[l.up(l.keys[p])]=n(e[p]),c),{})}if(typeof e=="object"){const l=r.breakpoints||FR;return Object.keys(e).reduce((c,s)=>{if(Object.keys(l.values||RP).indexOf(s)!==-1){const p=l.up(s);c[p]=n(e[s],s)}else{const p=s;c[p]=e[p]}return c},{})}return n(e)}function c4(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((r,i)=>{const l=t.up(i);return r[l]={},r},{}))||{}}function u4(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function _j(t,...e){const n=c4(t),r=[n,...e].reduce((i,l)=>Hl(i,l),{});return u4(Object.keys(n),r)}function xj(t,e){if(typeof t!="object")return{};const n={},r=Object.keys(e);return Array.isArray(t)?r.forEach((i,l)=>{l<t.length&&(n[i]=!0)}):r.forEach(i=>{t[i]!=null&&(n[i]=!0)}),n}function i2({values:t,breakpoints:e,base:n}){const r=n||xj(t,e),i=Object.keys(r);if(i.length===0)return t;let l;return i.reduce((c,s,p)=>(Array.isArray(t)?(c[s]=t[p]!=null?t[p]:t[l],l=p):typeof t=="object"?(c[s]=t[s]!=null?t[s]:t[l],l=s):c[s]=t,c),{})}function Rn(t){if(typeof t!="string")throw new Error(f_(7));return t.charAt(0).toUpperCase()+t.slice(1)}function ip(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,l)=>i&&i[l]?i[l]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function Eb(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=ip(t,n)||r,e&&(i=e(i,r,t)),i}function Oo(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,l=c=>{if(c[e]==null)return null;const s=c[e],p=c.theme,y=ip(p,r)||{};return wu(c,s,w=>{let S=Eb(y,i,w);return w===S&&typeof w=="string"&&(S=Eb(y,i,`${e}${w==="default"?"":Rn(w)}`,w)),n===!1?S:{[n]:S}})};return l.propTypes={},l.filterProps=[e],l}function bj(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const wj={m:"margin",p:"padding"},Sj={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},NR={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Mj=bj(t=>{if(t.length>2)if(NR[t])t=NR[t];else return[t];const[e,n]=t.split(""),r=wj[e],i=Sj[n]||"";return Array.isArray(i)?i.map(l=>r+l):[r+i]}),LP=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],kP=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...LP,...kP];function U_(t,e,n,r){var i;const l=(i=ip(t,e,!1))!=null?i:n;return typeof l=="number"?c=>typeof c=="string"?c:l*c:Array.isArray(l)?c=>typeof c=="string"?c:l[c]:typeof l=="function"?l:()=>{}}function DP(t){return U_(t,"spacing",8)}function Bm(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),r=t(n);return e>=0?r:typeof r=="number"?-r:`-${r}`}function Cj(t,e){return n=>t.reduce((r,i)=>(r[i]=Bm(e,n),r),{})}function Ej(t,e,n,r){if(e.indexOf(n)===-1)return null;const i=Mj(n),l=Cj(i,r),c=t[n];return wu(t,c,l)}function h4(t,e){const n=DP(t.theme);return Object.keys(t).map(r=>Ej(t,e,r,n)).reduce(U0,{})}function bo(t){return h4(t,LP)}bo.propTypes={};bo.filterProps=LP;function wo(t){return h4(t,kP)}wo.propTypes={};wo.filterProps=kP;function d4(t=8){if(t.mui)return t;const e=DP({spacing:t}),n=(...r)=>(r.length===0?[1]:r).map(l=>{const c=e(l);return typeof c=="number"?`${c}px`:c}).join(" ");return n.mui=!0,n}function bw(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(l=>{r[l]=i}),r),{}),n=r=>Object.keys(r).reduce((i,l)=>e[l]?U0(i,e[l](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Tc(t){return typeof t!="number"?t:`${t}px solid`}function kc(t,e){return Oo({prop:t,themeKey:"borders",transform:e})}const Tj=kc("border",Tc),Pj=kc("borderTop",Tc),Aj=kc("borderRight",Tc),Ij=kc("borderBottom",Tc),Rj=kc("borderLeft",Tc),Lj=kc("borderColor"),kj=kc("borderTopColor"),Dj=kc("borderRightColor"),zj=kc("borderBottomColor"),Oj=kc("borderLeftColor"),Fj=kc("outline",Tc),Nj=kc("outlineColor"),ww=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=U_(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:Bm(e,r)});return wu(t,t.borderRadius,n)}return null};ww.propTypes={};ww.filterProps=["borderRadius"];bw(Tj,Pj,Aj,Ij,Rj,Lj,kj,Dj,zj,Oj,ww,Fj,Nj);const Sw=t=>{if(t.gap!==void 0&&t.gap!==null){const e=U_(t.theme,"spacing",8),n=r=>({gap:Bm(e,r)});return wu(t,t.gap,n)}return null};Sw.propTypes={};Sw.filterProps=["gap"];const Mw=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=U_(t.theme,"spacing",8),n=r=>({columnGap:Bm(e,r)});return wu(t,t.columnGap,n)}return null};Mw.propTypes={};Mw.filterProps=["columnGap"];const Cw=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=U_(t.theme,"spacing",8),n=r=>({rowGap:Bm(e,r)});return wu(t,t.rowGap,n)}return null};Cw.propTypes={};Cw.filterProps=["rowGap"];const Bj=Oo({prop:"gridColumn"}),Uj=Oo({prop:"gridRow"}),$j=Oo({prop:"gridAutoFlow"}),Vj=Oo({prop:"gridAutoColumns"}),jj=Oo({prop:"gridAutoRows"}),Hj=Oo({prop:"gridTemplateColumns"}),Gj=Oo({prop:"gridTemplateRows"}),Wj=Oo({prop:"gridTemplateAreas"}),qj=Oo({prop:"gridArea"});bw(Sw,Mw,Cw,Bj,Uj,$j,Vj,jj,Hj,Gj,Wj,qj);function Ov(t,e){return e==="grey"?e:t}const Xj=Oo({prop:"color",themeKey:"palette",transform:Ov}),Zj=Oo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Ov}),Yj=Oo({prop:"backgroundColor",themeKey:"palette",transform:Ov});bw(Xj,Zj,Yj);function Bl(t){return t<=1&&t!==0?`${t*100}%`:t}const Kj=Oo({prop:"width",transform:Bl}),zP=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var r,i;const l=((r=t.theme)==null||(r=r.breakpoints)==null||(r=r.values)==null?void 0:r[n])||RP[n];return l?((i=t.theme)==null||(i=i.breakpoints)==null?void 0:i.unit)!=="px"?{maxWidth:`${l}${t.theme.breakpoints.unit}`}:{maxWidth:l}:{maxWidth:Bl(n)}};return wu(t,t.maxWidth,e)}return null};zP.filterProps=["maxWidth"];const Jj=Oo({prop:"minWidth",transform:Bl}),Qj=Oo({prop:"height",transform:Bl}),e9=Oo({prop:"maxHeight",transform:Bl}),t9=Oo({prop:"minHeight",transform:Bl});Oo({prop:"size",cssProperty:"width",transform:Bl});Oo({prop:"size",cssProperty:"height",transform:Bl});const n9=Oo({prop:"boxSizing"});bw(Kj,zP,Jj,Qj,e9,t9,n9);const Ew={border:{themeKey:"borders",transform:Tc},borderTop:{themeKey:"borders",transform:Tc},borderRight:{themeKey:"borders",transform:Tc},borderBottom:{themeKey:"borders",transform:Tc},borderLeft:{themeKey:"borders",transform:Tc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Tc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:ww},color:{themeKey:"palette",transform:Ov},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Ov},backgroundColor:{themeKey:"palette",transform:Ov},p:{style:wo},pt:{style:wo},pr:{style:wo},pb:{style:wo},pl:{style:wo},px:{style:wo},py:{style:wo},padding:{style:wo},paddingTop:{style:wo},paddingRight:{style:wo},paddingBottom:{style:wo},paddingLeft:{style:wo},paddingX:{style:wo},paddingY:{style:wo},paddingInline:{style:wo},paddingInlineStart:{style:wo},paddingInlineEnd:{style:wo},paddingBlock:{style:wo},paddingBlockStart:{style:wo},paddingBlockEnd:{style:wo},m:{style:bo},mt:{style:bo},mr:{style:bo},mb:{style:bo},ml:{style:bo},mx:{style:bo},my:{style:bo},margin:{style:bo},marginTop:{style:bo},marginRight:{style:bo},marginBottom:{style:bo},marginLeft:{style:bo},marginX:{style:bo},marginY:{style:bo},marginInline:{style:bo},marginInlineStart:{style:bo},marginInlineEnd:{style:bo},marginBlock:{style:bo},marginBlockStart:{style:bo},marginBlockEnd:{style:bo},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Sw},rowGap:{style:Cw},columnGap:{style:Mw},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Bl},maxWidth:{style:zP},minWidth:{transform:Bl},height:{transform:Bl},maxHeight:{transform:Bl},minHeight:{transform:Bl},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function r9(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function i9(t,e){return typeof t=="function"?t(e):t}function o9(){function t(n,r,i,l){const c={[n]:r,theme:i},s=l[n];if(!s)return{[n]:r};const{cssProperty:p=n,themeKey:y,transform:_,style:w}=s;if(r==null)return null;if(y==="typography"&&r==="inherit")return{[n]:r};const S=ip(i,y)||{};return w?w(c):wu(c,r,I=>{let D=Eb(S,_,I);return I===D&&typeof I=="string"&&(D=Eb(S,_,`${n}${I==="default"?"":Rn(I)}`,I)),p===!1?D:{[p]:D}})}function e(n){var r;const{sx:i,theme:l={}}=n||{};if(!i)return null;const c=(r=l.unstable_sxConfig)!=null?r:Ew;function s(p){let y=p;if(typeof p=="function")y=p(l);else if(typeof p!="object")return p;if(!y)return null;const _=c4(l.breakpoints),w=Object.keys(_);let S=_;return Object.keys(y).forEach(M=>{const I=i9(y[M],l);if(I!=null)if(typeof I=="object")if(c[M])S=U0(S,t(M,I,l,c));else{const D=wu({theme:l},I,R=>({[M]:R}));r9(D,I)?S[M]=e({sx:I,theme:l}):S=U0(S,D)}else S=U0(S,t(M,I,l,c))}),u4(w,S)}return Array.isArray(i)?i.map(s):s(i)}return e}const $_=o9();$_.filterProps=["sx"];function f4(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const s9=["breakpoints","palette","spacing","shape"];function OP(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:l={}}=t,c=rr(t,s9),s=l4(n),p=d4(i);let y=Hl({breakpoints:s,direction:"ltr",components:{},palette:me({mode:"light"},r),spacing:p,shape:me({},yj,l)},c);return y.applyStyles=f4,y=e.reduce((_,w)=>Hl(_,w),y),y.unstable_sxConfig=me({},Ew,c?.unstable_sxConfig),y.unstable_sx=function(w){return $_({sx:w,theme:this})},y}function a9(t){return Object.keys(t).length===0}function p4(t=null){const e=G.useContext(B_);return!e||a9(e)?t:e}const l9=OP();function FP(t=l9){return p4(t)}function c9({styles:t,themeId:e,defaultTheme:n={}}){const r=FP(n),i=typeof t=="function"?t(e&&r[e]||r):t;return ie.jsx(eb,{styles:i})}const u9=["sx"],h9=t=>{var e,n;const r={systemProps:{},otherProps:{}},i=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:Ew;return Object.keys(t).forEach(l=>{i[l]?r.systemProps[l]=t[l]:r.otherProps[l]=t[l]}),r};function Tw(t){const{sx:e}=t,n=rr(t,u9),{systemProps:r,otherProps:i}=h9(n);let l;return Array.isArray(e)?l=[r,...e]:typeof e=="function"?l=(...c)=>{const s=e(...c);return Gf(s)?me({},r,s):r}:l=me({},r,e),me({},i,{sx:l})}const BR=t=>t,d9=()=>{let t=BR;return{configure(e){t=e},generate(e){return t(e)},reset(){t=BR}}},m4=d9();function g4(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=g4(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function co(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=g4(t))&&(r&&(r+=" "),r+=e);return r}const f9=["className","component"];function p9(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:i}=t,l=s4("div",{shouldForwardProp:s=>s!=="theme"&&s!=="sx"&&s!=="as"})($_);return G.forwardRef(function(p,y){const _=FP(n),w=Tw(p),{className:S,component:M="div"}=w,I=rr(w,f9);return ie.jsx(l,me({as:M,ref:y,className:co(S,i?i(r):r),theme:e&&_[e]||_},I))})}const v4={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function NP(t,e,n="Mui"){const r=v4[e];return r?`${n}-${r}`:`${m4.generate(t)}-${e}`}function y4(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=NP(t,i,n)}),r}const m9=["ownerState"],g9=["variants"],v9=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function y9(t){return Object.keys(t).length===0}function _9(t){return typeof t=="string"&&t.charCodeAt(0)>96}function o2(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const x9=OP(),b9=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function o1({defaultTheme:t,theme:e,themeId:n}){return y9(e)?t:e[n]||e}function w9(t){return t?(e,n)=>n[t]:null}function tb(t,e){let{ownerState:n}=e,r=rr(e,m9);const i=typeof t=="function"?t(me({ownerState:n},r)):t;if(Array.isArray(i))return i.flatMap(l=>tb(l,me({ownerState:n},r)));if(i&&typeof i=="object"&&Array.isArray(i.variants)){const{variants:l=[]}=i;let s=rr(i,g9);return l.forEach(p=>{let y=!0;typeof p.props=="function"?y=p.props(me({ownerState:n},r,n)):Object.keys(p.props).forEach(_=>{n?.[_]!==p.props[_]&&r[_]!==p.props[_]&&(y=!1)}),y&&(Array.isArray(s)||(s=[s]),s.push(typeof p.style=="function"?p.style(me({ownerState:n},r,n)):p.style))}),s}return i}function _4(t={}){const{themeId:e,defaultTheme:n=x9,rootShouldForwardProp:r=o2,slotShouldForwardProp:i=o2}=t,l=c=>$_(me({},c,{theme:o1(me({},c,{defaultTheme:n,themeId:e}))}));return l.__mui_systemSx=!0,(c,s={})=>{mj(c,q=>q.filter(X=>!(X!=null&&X.__mui_systemSx)));const{name:p,slot:y,skipVariantsResolver:_,skipSx:w,overridesResolver:S=w9(b9(y))}=s,M=rr(s,v9),I=_!==void 0?_:y&&y!=="Root"&&y!=="root"||!1,D=w||!1;let R,L=o2;y==="Root"||y==="root"?L=r:y?L=i:_9(c)&&(L=void 0);const V=s4(c,me({shouldForwardProp:L,label:R},M)),B=q=>typeof q=="function"&&q.__emotion_real!==q||Gf(q)?X=>tb(q,me({},X,{theme:o1({theme:X.theme,defaultTheme:n,themeId:e})})):q,H=(q,...X)=>{let ee=B(q);const se=X?X.map(B):[];p&&S&&se.push(le=>{const Ce=o1(me({},le,{defaultTheme:n,themeId:e}));if(!Ce.components||!Ce.components[p]||!Ce.components[p].styleOverrides)return null;const we=Ce.components[p].styleOverrides,We={};return Object.entries(we).forEach(([Fe,Me])=>{We[Fe]=tb(Me,me({},le,{theme:Ce}))}),S(le,We)}),p&&!I&&se.push(le=>{var Ce;const we=o1(me({},le,{defaultTheme:n,themeId:e})),We=we==null||(Ce=we.components)==null||(Ce=Ce[p])==null?void 0:Ce.variants;return tb({variants:We},me({},le,{theme:we}))}),D||se.push(l);const J=se.length-X.length;if(Array.isArray(q)&&J>0){const le=new Array(J).fill("");ee=[...q,...le],ee.raw=[...q.raw,...le]}const $=V(ee,...se);return c.muiName&&($.muiName=c.muiName),$};return V.withConfig&&(H.withConfig=V.withConfig),H}}const S9=_4();function x4(t,e){const n=me({},e);return Object.keys(t).forEach(r=>{if(r.toString().match(/^(components|slots)$/))n[r]=me({},t[r],n[r]);else if(r.toString().match(/^(componentsProps|slotProps)$/)){const i=t[r]||{},l=e[r];n[r]={},!l||!Object.keys(l)?n[r]=i:!i||!Object.keys(i)?n[r]=l:(n[r]=me({},l),Object.keys(i).forEach(c=>{n[r][c]=x4(i[c],l[c])}))}else n[r]===void 0&&(n[r]=t[r])}),n}function M9(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:x4(e.components[n].defaultProps,r)}function b4({props:t,name:e,defaultTheme:n,themeId:r}){let i=FP(n);return r&&(i=i[r]||i),M9({theme:i,name:e,props:t})}const Hd=typeof window<"u"?G.useLayoutEffect:G.useEffect;function C9(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function w4(t){if(t.type)return t;if(t.charAt(0)==="#")return w4(C9(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error(f_(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(i)===-1)throw new Error(f_(10,i))}else r=r.split(",");return r=r.map(l=>parseFloat(l)),{type:n,values:r,colorSpace:i}}const mm=t=>{const e=w4(t);return e.values.slice(0,3).map((n,r)=>e.type.indexOf("hsl")!==-1&&r!==0?`${n}%`:n).join(" ")};function UR(...t){return t.reduce((e,n)=>n==null?e:function(...i){e.apply(this,i),n.apply(this,i)},()=>{})}function Pw(t,e){var n,r;return G.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(r=t.type)==null||(r=r._payload)==null||(r=r.value)==null?void 0:r.muiName)!==-1}function Gl(t){return t&&t.ownerDocument||document}function BP(t){return Gl(t).defaultView||window}function Tb(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let $R=0;function E9(t){const[e,n]=G.useState(t),r=t||e;return G.useEffect(()=>{e==null&&($R+=1,n(`mui-${$R}`))},[e]),r}const VR=zE.useId;function il(t){if(VR!==void 0){const e=VR();return t??e}return E9(t)}function Fv({controlled:t,default:e,name:n,state:r="value"}){const{current:i}=G.useRef(t!==void 0),[l,c]=G.useState(e),s=i?t:l,p=G.useCallback(y=>{i||c(y)},[]);return[s,p]}function yu(t){const e=G.useRef(t);return Hd(()=>{e.current=t}),G.useRef((...n)=>(0,e.current)(...n)).current}function mi(...t){return G.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{Tb(n,e)})},t)}const jR={};function T9(t,e){const n=G.useRef(jR);return n.current===jR&&(n.current=t(e)),n}const P9=[];function A9(t){G.useEffect(t,P9)}class V_{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new V_}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function T0(){const t=T9(V_.create).current;return A9(t.disposeEffect),t}let Aw=!0,BE=!1;const I9=new V_,R9={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function L9(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&R9[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function k9(t){t.metaKey||t.altKey||t.ctrlKey||(Aw=!0)}function s2(){Aw=!1}function D9(){this.visibilityState==="hidden"&&BE&&(Aw=!0)}function z9(t){t.addEventListener("keydown",k9,!0),t.addEventListener("mousedown",s2,!0),t.addEventListener("pointerdown",s2,!0),t.addEventListener("touchstart",s2,!0),t.addEventListener("visibilitychange",D9,!0)}function O9(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return Aw||L9(e)}function Iw(){const t=G.useCallback(i=>{i!=null&&z9(i.ownerDocument)},[]),e=G.useRef(!1);function n(){return e.current?(BE=!0,I9.start(100,()=>{BE=!1}),e.current=!1,!0):!1}function r(i){return O9(i)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:r,onBlur:n,ref:t}}function F9(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const N9=t=>{const e=G.useRef({});return G.useEffect(()=>{e.current=t}),e.current},B9={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};function Vr(t,e,n=void 0){const r={};return Object.keys(t).forEach(i=>{r[i]=t[i].reduce((l,c)=>{if(c){const s=e(c);s!==""&&l.push(s),n&&n[c]&&l.push(n[c])}return l},[]).join(" ")}),r}function U9(t){return typeof t=="string"}function S4(t,e,n){return t===void 0||U9(t)?e:me({},e,{ownerState:me({},e.ownerState,n)})}function ps(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function HR(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function M4(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:i,className:l}=t;if(!e){const M=co(n?.className,l,i?.className,r?.className),I=me({},n?.style,i?.style,r?.style),D=me({},n,i,r);return M.length>0&&(D.className=M),Object.keys(I).length>0&&(D.style=I),{props:D,internalRef:void 0}}const c=ps(me({},i,r)),s=HR(r),p=HR(i),y=e(c),_=co(y?.className,n?.className,l,i?.className,r?.className),w=me({},y?.style,n?.style,i?.style,r?.style),S=me({},y,n,p,s);return _.length>0&&(S.className=_),Object.keys(w).length>0&&(S.style=w),{props:S,internalRef:y.ref}}function C4(t,e,n){return typeof t=="function"?t(e,n):t}const $9=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function E4(t){var e;const{elementType:n,externalSlotProps:r,ownerState:i,skipResolvingSlotProps:l=!1}=t,c=rr(t,$9),s=l?{}:C4(r,i),{props:p,internalRef:y}=M4(me({},c,{externalSlotProps:s})),_=mi(y,s?.ref,(e=t.additionalProps)==null?void 0:e.ref);return S4(n,me({},p,{ref:_}),i)}function Rw(t){if(parseInt(G.version,10)>=19){var e;return(t==null||(e=t.props)==null?void 0:e.ref)||null}return t?.ref||null}const T4=G.createContext(null);function UP(){return G.useContext(T4)}const V9=typeof Symbol=="function"&&Symbol.for,j9=V9?Symbol.for("mui.nested"):"__THEME_NESTED__";function H9(t,e){return typeof e=="function"?e(t):me({},t,e)}function G9(t){const{children:e,theme:n}=t,r=UP(),i=G.useMemo(()=>{const l=r===null?n:H9(r,n);return l!=null&&(l[j9]=r!==null),l},[n,r]);return ie.jsx(T4.Provider,{value:i,children:e})}const W9=["value"],q9=G.createContext();function X9(t){let{value:e}=t,n=rr(t,W9);return ie.jsx(q9.Provider,me({value:e??!0},n))}const Z9=G.createContext(void 0);function Y9({value:t,children:e}){return ie.jsx(Z9.Provider,{value:t,children:e})}const GR={};function WR(t,e,n,r=!1){return G.useMemo(()=>{const i=t&&e[t]||e;if(typeof n=="function"){const l=n(i),c=t?me({},e,{[t]:l}):l;return r?()=>c:c}return t?me({},e,{[t]:n}):me({},e,n)},[t,e,n,r])}function K9(t){const{children:e,theme:n,themeId:r}=t,i=p4(GR),l=UP()||GR,c=WR(r,i,n),s=WR(r,l,n,!0),p=c.direction==="rtl";return ie.jsx(G9,{theme:s,children:ie.jsx(B_.Provider,{value:c,children:ie.jsx(X9,{value:p,children:ie.jsx(Y9,{value:c?.components,children:e})})})})}const $P="mode",VP="color-scheme",P4="data-color-scheme";function J9(t){const{defaultMode:e="light",defaultLightColorScheme:n="light",defaultDarkColorScheme:r="dark",modeStorageKey:i=$P,colorSchemeStorageKey:l=VP,attribute:c=P4,colorSchemeNode:s="document.documentElement",nonce:p}=t||{};return ie.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?p:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  var mode = localStorage.getItem('${i}') || '${e}';
  var colorScheme = '';
  if (mode === 'system') {
    // handle system mode
    var mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = localStorage.getItem('${l}-dark') || '${r}';
    } else {
      colorScheme = localStorage.getItem('${l}-light') || '${n}';
    }
  }
  if (mode === 'light') {
    colorScheme = localStorage.getItem('${l}-light') || '${n}';
  }
  if (mode === 'dark') {
    colorScheme = localStorage.getItem('${l}-dark') || '${r}';
  }
  if (colorScheme) {
    ${s}.setAttribute('${c}', colorScheme);
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function qR(t){if(typeof window<"u"&&t==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function A4(t,e){if(t.mode==="light"||t.mode==="system"&&t.systemMode==="light")return e("light");if(t.mode==="dark"||t.mode==="system"&&t.systemMode==="dark")return e("dark")}function Q9(t){return A4(t,e=>{if(e==="light")return t.lightColorScheme;if(e==="dark")return t.darkColorScheme})}function a2(t,e){if(typeof window>"u")return;let n;try{n=localStorage.getItem(t)||void 0,n||localStorage.setItem(t,e)}catch{}return n||e}function e7(t){const{defaultMode:e="light",defaultLightColorScheme:n,defaultDarkColorScheme:r,supportedColorSchemes:i=[],modeStorageKey:l=$P,colorSchemeStorageKey:c=VP,storageWindow:s=typeof window>"u"?void 0:window}=t,p=i.join(","),[y,_]=G.useState(()=>{const R=a2(l,e),L=a2(`${c}-light`,n),V=a2(`${c}-dark`,r);return{mode:R,systemMode:qR(R),lightColorScheme:L,darkColorScheme:V}}),w=Q9(y),S=G.useCallback(R=>{_(L=>{if(R===L.mode)return L;const V=R??e;try{localStorage.setItem(l,V)}catch{}return me({},L,{mode:V,systemMode:qR(V)})})},[l,e]),M=G.useCallback(R=>{R?typeof R=="string"?R&&!p.includes(R)?console.error(`\`${R}\` does not exist in \`theme.colorSchemes\`.`):_(L=>{const V=me({},L);return A4(L,B=>{try{localStorage.setItem(`${c}-${B}`,R)}catch{}B==="light"&&(V.lightColorScheme=R),B==="dark"&&(V.darkColorScheme=R)}),V}):_(L=>{const V=me({},L),B=R.light===null?n:R.light,H=R.dark===null?r:R.dark;if(B)if(!p.includes(B))console.error(`\`${B}\` does not exist in \`theme.colorSchemes\`.`);else{V.lightColorScheme=B;try{localStorage.setItem(`${c}-light`,B)}catch{}}if(H)if(!p.includes(H))console.error(`\`${H}\` does not exist in \`theme.colorSchemes\`.`);else{V.darkColorScheme=H;try{localStorage.setItem(`${c}-dark`,H)}catch{}}return V}):_(L=>{try{localStorage.setItem(`${c}-light`,n),localStorage.setItem(`${c}-dark`,r)}catch{}return me({},L,{lightColorScheme:n,darkColorScheme:r})})},[p,c,n,r]),I=G.useCallback(R=>{y.mode==="system"&&_(L=>{const V=R!=null&&R.matches?"dark":"light";return L.systemMode===V?L:me({},L,{systemMode:V})})},[y.mode]),D=G.useRef(I);return D.current=I,G.useEffect(()=>{const R=(...V)=>D.current(...V),L=window.matchMedia("(prefers-color-scheme: dark)");return L.addListener(R),R(L),()=>{L.removeListener(R)}},[]),G.useEffect(()=>{if(s){const R=L=>{const V=L.newValue;typeof L.key=="string"&&L.key.startsWith(c)&&(!V||p.match(V))&&(L.key.endsWith("light")&&M({light:V}),L.key.endsWith("dark")&&M({dark:V})),L.key===l&&(!V||["light","dark","system"].includes(V))&&S(V||e)};return s.addEventListener("storage",R),()=>{s.removeEventListener("storage",R)}}},[M,S,l,c,p,e,s]),me({},y,{colorScheme:w,setMode:S,setColorScheme:M})}const t7=["colorSchemes","components","generateCssVars","cssVarPrefix"],n7="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function r7(t){const{themeId:e,theme:n={},attribute:r=P4,modeStorageKey:i=$P,colorSchemeStorageKey:l=VP,defaultMode:c="light",defaultColorScheme:s,disableTransitionOnChange:p=!1,resolveTheme:y,excludeVariablesFromRoot:_}=t;(!n.colorSchemes||typeof s=="string"&&!n.colorSchemes[s]||typeof s=="object"&&!n.colorSchemes[s?.light]||typeof s=="object"&&!n.colorSchemes[s?.dark])&&console.error(`MUI: \`${s}\` does not exist in \`theme.colorSchemes\`.`);const w=G.createContext(void 0),S=()=>{const L=G.useContext(w);if(!L)throw new Error(f_(19));return L};function M(L){const{children:V,theme:B=n,modeStorageKey:H=i,colorSchemeStorageKey:q=l,attribute:X=r,defaultMode:ee=c,defaultColorScheme:se=s,disableTransitionOnChange:J=p,storageWindow:$=typeof window>"u"?void 0:window,documentNode:le=typeof document>"u"?void 0:document,colorSchemeNode:Ce=typeof document>"u"?void 0:document.documentElement,colorSchemeSelector:we=":root",disableNestedContext:We=!1,disableStyleSheetGeneration:Fe=!1}=L,Me=G.useRef(!1),Ee=UP(),Te=G.useContext(w),Ze=!!Te&&!We,rt=B[e],Re=rt||B,{colorSchemes:Qe={},components:Vt={},generateCssVars:je=()=>({vars:{},css:{}}),cssVarPrefix:ct}=Re,Ct=rr(Re,t7),ut=Object.keys(Qe),lt=typeof se=="string"?se:se.light,_t=typeof se=="string"?se:se.dark,{mode:wt,setMode:cn,systemMode:dn,lightColorScheme:tn,darkColorScheme:Je,colorScheme:Tn,setColorScheme:Kt}=e7({supportedColorSchemes:ut,defaultLightColorScheme:lt,defaultDarkColorScheme:_t,modeStorageKey:H,colorSchemeStorageKey:q,defaultMode:ee,storageWindow:$});let fn=wt,Ut=Tn;Ze&&(fn=Te.mode,Ut=Te.colorScheme);const On=fn||(ee==="system"?c:ee),vn=Ut||(On==="dark"?_t:lt),{css:Ue,vars:Se}=je(),yt=me({},Ct,{components:Vt,colorSchemes:Qe,cssVarPrefix:ct,vars:Se,getColorSchemeSelector:Zt=>`[${X}="${Zt}"] &`}),Nt={},Ht={};Object.entries(Qe).forEach(([Zt,Nn])=>{const{css:Yt,vars:Pe}=je(Zt);yt.vars=Hl(yt.vars,Pe),Zt===vn&&(Object.keys(Nn).forEach(ue=>{Nn[ue]&&typeof Nn[ue]=="object"?yt[ue]=me({},yt[ue],Nn[ue]):yt[ue]=Nn[ue]}),yt.palette&&(yt.palette.colorScheme=Zt));const ae=typeof se=="string"?se:ee==="dark"?se.dark:se.light;if(Zt===ae){if(_){const ue={};_(ct).forEach(ne=>{ue[ne]=Yt[ne],delete Yt[ne]}),Nt[`[${X}="${Zt}"]`]=ue}Nt[`${we}, [${X}="${Zt}"]`]=Yt}else Ht[`${we===":root"?"":we}[${X}="${Zt}"]`]=Yt}),yt.vars=Hl(yt.vars,Se),G.useEffect(()=>{Ut&&Ce&&Ce.setAttribute(X,Ut)},[Ut,X,Ce]),G.useEffect(()=>{let Zt;if(J&&Me.current&&le){const Nn=le.createElement("style");Nn.appendChild(le.createTextNode(n7)),le.head.appendChild(Nn),window.getComputedStyle(le.body),Zt=setTimeout(()=>{le.head.removeChild(Nn)},1)}return()=>{clearTimeout(Zt)}},[Ut,J,le]),G.useEffect(()=>(Me.current=!0,()=>{Me.current=!1}),[]);const Ot=G.useMemo(()=>({allColorSchemes:ut,colorScheme:Ut,darkColorScheme:Je,lightColorScheme:tn,mode:fn,setColorScheme:Kt,setMode:cn,systemMode:dn}),[ut,Ut,Je,tn,fn,Kt,cn,dn]);let un=!0;(Fe||Ze&&Ee?.cssVarPrefix===ct)&&(un=!1);const Gt=ie.jsxs(G.Fragment,{children:[un&&ie.jsxs(G.Fragment,{children:[ie.jsx(eb,{styles:{[we]:Ue}}),ie.jsx(eb,{styles:Nt}),ie.jsx(eb,{styles:Ht})]}),ie.jsx(K9,{themeId:rt?e:void 0,theme:y?y(yt):yt,children:V})]});return Ze?Gt:ie.jsx(w.Provider,{value:Ot,children:Gt})}const I=typeof s=="string"?s:s.light,D=typeof s=="string"?s:s.dark;return{CssVarsProvider:M,useColorScheme:S,getInitColorSchemeScript:L=>J9(me({attribute:r,colorSchemeStorageKey:l,defaultMode:c,defaultLightColorScheme:I,defaultDarkColorScheme:D,modeStorageKey:i},L))}}function jP(t=""){function e(...r){if(!r.length)return"";const i=r[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...r.slice(1))})`:`, ${i}`}return(r,...i)=>`var(--${t?`${t}-`:""}${r}${e(...i)})`}const XR=(t,e,n,r=[])=>{let i=t;e.forEach((l,c)=>{c===e.length-1?Array.isArray(i)?i[Number(l)]=n:i&&typeof i=="object"&&(i[l]=n):i&&typeof i=="object"&&(i[l]||(i[l]=r.includes(l)?[]:{}),i=i[l])})},i7=(t,e,n)=>{function r(i,l=[],c=[]){Object.entries(i).forEach(([s,p])=>{(!n||n&&!n([...l,s]))&&p!=null&&(typeof p=="object"&&Object.keys(p).length>0?r(p,[...l,s],Array.isArray(p)?[...c,s]:c):e([...l,s],p,c))})}r(t)},o7=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>t.includes(r))||t[t.length-1].toLowerCase().indexOf("opacity")>=0?e:`${e}px`:e;function l2(t,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},i={},l={},c={};return i7(t,(s,p,y)=>{if((typeof p=="string"||typeof p=="number")&&(!r||!r(s,p))){const _=`--${n?`${n}-`:""}${s.join("-")}`;Object.assign(i,{[_]:o7(s,p)}),XR(l,s,`var(${_})`,y),XR(c,s,`var(${_}, ${p})`,y)}},s=>s[0]==="vars"),{css:i,vars:l,varsWithDefaults:c}}function v_(t){"@babel/helpers - typeof";return v_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v_(t)}function s7(t,e){if(v_(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(v_(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function a7(t){var e=s7(t,"string");return v_(e)=="symbol"?e:e+""}const l7=["colorSchemes","components","defaultColorScheme"];function c7(t,e){const{colorSchemes:n={},defaultColorScheme:r="light"}=t,i=rr(t,l7),{vars:l,css:c,varsWithDefaults:s}=l2(i,e);let p=s;const y={},{[r]:_}=n,w=rr(n,[r].map(a7));if(Object.entries(w||{}).forEach(([M,I])=>{const{vars:D,css:R,varsWithDefaults:L}=l2(I,e);p=Hl(p,L),y[M]={css:R,vars:D}}),_){const{css:M,vars:I,varsWithDefaults:D}=l2(_,e);p=Hl(p,D),y[r]={css:M,vars:I}}return{vars:p,generateCssVars:M=>{var I;if(!M){var D;const L=me({},c);return{css:L,vars:l,selector:(e==null||(D=e.getSelector)==null?void 0:D.call(e,M,L))||":root"}}const R=me({},y[M].css);return{css:R,vars:y[M].vars,selector:(e==null||(I=e.getSelector)==null?void 0:I.call(e,M,R))||":root"}}}}const u7=["component","direction","spacing","divider","children","className","useFlexGap"],h7=OP(),d7=S9("div",{name:"MuiStack",slot:"Root",overridesResolver:(t,e)=>e.root});function f7(t){return b4({props:t,name:"MuiStack",defaultTheme:h7})}function p7(t,e){const n=G.Children.toArray(t).filter(Boolean);return n.reduce((r,i,l)=>(r.push(i),l<n.length-1&&r.push(G.cloneElement(e,{key:`separator-${l}`})),r),[])}const m7=t=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[t],g7=({ownerState:t,theme:e})=>{let n=me({display:"flex",flexDirection:"column"},wu({theme:e},i2({values:t.direction,breakpoints:e.breakpoints.values}),r=>({flexDirection:r})));if(t.spacing){const r=DP(e),i=Object.keys(e.breakpoints.values).reduce((p,y)=>((typeof t.spacing=="object"&&t.spacing[y]!=null||typeof t.direction=="object"&&t.direction[y]!=null)&&(p[y]=!0),p),{}),l=i2({values:t.direction,base:i}),c=i2({values:t.spacing,base:i});typeof l=="object"&&Object.keys(l).forEach((p,y,_)=>{if(!l[p]){const S=y>0?l[_[y-1]]:"column";l[p]=S}}),n=Hl(n,wu({theme:e},c,(p,y)=>t.useFlexGap?{gap:Bm(r,p)}:{"& > :not(style):not(style)":{margin:0},"& > :not(style) ~ :not(style)":{[`margin${m7(y?l[y]:t.direction)}`]:Bm(r,p)}}))}return n=_j(e.breakpoints,n),n};function v7(t={}){const{createStyledComponent:e=d7,useThemeProps:n=f7,componentName:r="MuiStack"}=t,i=()=>Vr({root:["root"]},p=>NP(r,p),{}),l=e(g7);return G.forwardRef(function(p,y){const _=n(p),w=Tw(_),{component:S="div",direction:M="column",spacing:I=0,divider:D,children:R,className:L,useFlexGap:V=!1}=w,B=rr(w,u7),H={direction:M,spacing:I,useFlexGap:V},q=i();return ie.jsx(l,me({as:S,ownerState:H,ref:y,className:co(q.root,L)},B,{children:D?p7(R,D):R}))})}const y7=me({},Ew,{borderRadius:{themeKey:"radius"},boxShadow:{themeKey:"shadow"},fontFamily:{themeKey:"fontFamily"},fontSize:{themeKey:"fontSize"},fontWeight:{themeKey:"fontWeight"},letterSpacing:{themeKey:"letterSpacing"},lineHeight:{themeKey:"lineHeight"}});function _7(t){var e;return!!t[0].match(/^(typography|variants|breakpoints)$/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!((e=t[1])!=null&&e.match(/^(mode)$/))||t[0]==="focus"&&t[1]!=="thickness"}const qr=(t,e)=>NP(t,e,"Mui"),$r=(t,e)=>y4(t,e,"Mui"),x7=t=>t&&typeof t=="object"&&Object.keys(t).some(e=>{var n;return(n=e.match)==null?void 0:n.call(e,/^(plain(Hover|Active|Disabled)?(Color|Bg)|outlined(Hover|Active|Disabled)?(Color|Border|Bg)|soft(Hover|Active|Disabled)?(Color|Bg)|solid(Hover|Active|Disabled)?(Color|Bg))$/)}),ZR=(t,e,n)=>{e.includes("Color")&&(t.color=n),e.includes("Bg")&&(t.backgroundColor=n),e.includes("Border")&&(t.borderColor=n)},YR=(t,e,n)=>{const r={};return Object.entries(e||{}).forEach(([i,l])=>{if(i.match(new RegExp(`${t}(color|bg|border)`,"i"))&&l){const c=n?n(i):l;i.includes("Disabled")&&(r.pointerEvents="none",r.cursor="default",r["--Icon-color"]="currentColor"),i.match(/(Hover|Active|Disabled)/)||(r["--variant-borderWidth"]||(r["--variant-borderWidth"]="0px"),i.includes("Border")&&(r["--variant-borderWidth"]="1px",r.border="var(--variant-borderWidth) solid")),ZR(r,i,c)}}),r},ia=(t,e)=>{let n={};if(e){const{getCssVar:r,palette:i}=e;Object.entries(i).forEach(l=>{const[c,s]=l;x7(s)&&typeof s=="object"&&(n=me({},n,{[c]:YR(t,s,p=>`var(--variant-${p}, ${r(`palette-${c}-${p}`,i[c][p])})`)}))})}return n.context=YR(t,{plainColor:"var(--variant-plainColor)",plainHoverColor:"var(--variant-plainHoverColor)",plainHoverBg:"var(--variant-plainHoverBg)",plainActiveBg:"var(--variant-plainActiveBg)",plainDisabledColor:"var(--variant-plainDisabledColor)",outlinedColor:"var(--variant-outlinedColor)",outlinedBorder:"var(--variant-outlinedBorder)",outlinedHoverColor:"var(--variant-outlinedHoverColor)",outlinedHoverBorder:"var(--variant-outlinedHoverBorder)",outlinedHoverBg:"var(--variant-outlinedHoverBg)",outlinedActiveBg:"var(--variant-outlinedActiveBg)",outlinedDisabledColor:"var(--variant-outlinedDisabledColor)",outlinedDisabledBorder:"var(--variant-outlinedDisabledBorder)",softColor:"var(--variant-softColor)",softBg:"var(--variant-softBg)",softHoverColor:"var(--variant-softHoverColor)",softHoverBg:"var(--variant-softHoverBg)",softActiveBg:"var(--variant-softActiveBg)",softDisabledColor:"var(--variant-softDisabledColor)",softDisabledBg:"var(--variant-softDisabledBg)",solidColor:"var(--variant-solidColor)",solidBg:"var(--variant-solidBg)",solidHoverBg:"var(--variant-solidHoverBg)",solidActiveBg:"var(--variant-solidActiveBg)",solidDisabledColor:"var(--variant-solidDisabledColor)",solidDisabledBg:"var(--variant-solidDisabledBg)"}),n},b7=["cssVarPrefix","breakpoints","spacing","components","variants","shouldSkipGeneratingVar"],w7=["colorSchemes"],S7=(t="joy")=>jP(t);function I4(t){var e,n,r,i,l,c,s,p,y,_;const w=t||{},{cssVarPrefix:S="joy",breakpoints:M,spacing:I,components:D,variants:R,shouldSkipGeneratingVar:L=_7}=w,V=rr(w,b7),B=S7(S),H={primary:o0.blue,neutral:o0.grey,danger:o0.red,success:o0.green,warning:o0.yellow,common:{white:"#FFF",black:"#000"}},q=lt=>{var _t;const wt=lt.split("-"),cn=wt[1],dn=wt[2];return B(lt,(_t=H[cn])==null?void 0:_t[dn])},X=lt=>({plainColor:q(`palette-${lt}-500`),plainHoverBg:q(`palette-${lt}-100`),plainActiveBg:q(`palette-${lt}-200`),plainDisabledColor:q("palette-neutral-400"),outlinedColor:q(`palette-${lt}-500`),outlinedBorder:q(`palette-${lt}-300`),outlinedHoverBg:q(`palette-${lt}-100`),outlinedActiveBg:q(`palette-${lt}-200`),outlinedDisabledColor:q("palette-neutral-400"),outlinedDisabledBorder:q("palette-neutral-200"),softColor:q(`palette-${lt}-700`),softBg:q(`palette-${lt}-100`),softHoverBg:q(`palette-${lt}-200`),softActiveColor:q(`palette-${lt}-800`),softActiveBg:q(`palette-${lt}-300`),softDisabledColor:q("palette-neutral-400"),softDisabledBg:q("palette-neutral-50"),solidColor:q("palette-common-white"),solidBg:q(`palette-${lt}-500`),solidHoverBg:q(`palette-${lt}-600`),solidActiveBg:q(`palette-${lt}-700`),solidDisabledColor:q("palette-neutral-400"),solidDisabledBg:q("palette-neutral-100")}),ee=lt=>({plainColor:q(`palette-${lt}-300`),plainHoverBg:q(`palette-${lt}-800`),plainActiveBg:q(`palette-${lt}-700`),plainDisabledColor:q("palette-neutral-500"),outlinedColor:q(`palette-${lt}-200`),outlinedBorder:q(`palette-${lt}-700`),outlinedHoverBg:q(`palette-${lt}-800`),outlinedActiveBg:q(`palette-${lt}-700`),outlinedDisabledColor:q("palette-neutral-500"),outlinedDisabledBorder:q("palette-neutral-800"),softColor:q(`palette-${lt}-200`),softBg:q(`palette-${lt}-800`),softHoverBg:q(`palette-${lt}-700`),softActiveColor:q(`palette-${lt}-100`),softActiveBg:q(`palette-${lt}-600`),softDisabledColor:q("palette-neutral-500"),softDisabledBg:q("palette-neutral-800"),solidColor:q("palette-common-white"),solidBg:q(`palette-${lt}-500`),solidHoverBg:q(`palette-${lt}-600`),solidActiveBg:q(`palette-${lt}-700`),solidDisabledColor:q("palette-neutral-500"),solidDisabledBg:q("palette-neutral-800")}),se={palette:{mode:"light",primary:me({},H.primary,X("primary")),neutral:me({},H.neutral,X("neutral"),{plainColor:q("palette-neutral-700"),plainHoverColor:q("palette-neutral-900"),outlinedColor:q("palette-neutral-700")}),danger:me({},H.danger,X("danger")),success:me({},H.success,X("success")),warning:me({},H.warning,X("warning")),common:{white:"#FFF",black:"#000"},text:{primary:q("palette-neutral-800"),secondary:q("palette-neutral-700"),tertiary:q("palette-neutral-600"),icon:q("palette-neutral-500")},background:{body:q("palette-common-white"),surface:q("palette-neutral-50"),popup:q("palette-common-white"),level1:q("palette-neutral-100"),level2:q("palette-neutral-200"),level3:q("palette-neutral-300"),tooltip:q("palette-neutral-500"),backdrop:`rgba(${B("palette-neutral-darkChannel",mm(H.neutral[900]))} / 0.25)`},divider:`rgba(${B("palette-neutral-mainChannel",mm(H.neutral[500]))} / 0.2)`,focusVisible:q("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"21 21 21",shadowOpacity:"0.08"},J={palette:{mode:"dark",primary:me({},H.primary,ee("primary")),neutral:me({},H.neutral,ee("neutral"),{plainColor:q("palette-neutral-300"),plainHoverColor:q("palette-neutral-300")}),danger:me({},H.danger,ee("danger")),success:me({},H.success,ee("success")),warning:me({},H.warning,ee("warning")),common:{white:"#FFF",black:"#000"},text:{primary:q("palette-neutral-100"),secondary:q("palette-neutral-300"),tertiary:q("palette-neutral-400"),icon:q("palette-neutral-400")},background:{body:q("palette-common-black"),surface:q("palette-neutral-900"),popup:q("palette-common-black"),level1:q("palette-neutral-800"),level2:q("palette-neutral-700"),level3:q("palette-neutral-600"),tooltip:q("palette-neutral-600"),backdrop:`rgba(${B("palette-neutral-darkChannel",mm(H.neutral[50]))} / 0.25)`},divider:`rgba(${B("palette-neutral-mainChannel",mm(H.neutral[500]))} / 0.16)`,focusVisible:q("palette-primary-500")},shadowRing:"0 0 #000",shadowChannel:"0 0 0",shadowOpacity:"0.6"},$='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',le=me({body:`"Inter", ${B(`fontFamily-fallback, ${$}`)}`,display:`"Inter", ${B(`fontFamily-fallback, ${$}`)}`,code:"Source Code Pro,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace",fallback:$},V.fontFamily),Ce=me({sm:300,md:500,lg:600,xl:700},V.fontWeight),we=me({xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem",xl2:"1.5rem",xl3:"1.875rem",xl4:"2.25rem"},V.fontSize),We=me({xs:"1.33334",sm:"1.42858",md:"1.5",lg:"1.55556",xl:"1.66667"},V.lineHeight),Fe=(e=(n=V.colorSchemes)==null||(n=n.light)==null?void 0:n.shadowRing)!=null?e:se.shadowRing,Me=(r=(i=V.colorSchemes)==null||(i=i.light)==null?void 0:i.shadowChannel)!=null?r:se.shadowChannel,Ee=(l=(c=V.colorSchemes)==null||(c=c.light)==null?void 0:c.shadowOpacity)!=null?l:se.shadowOpacity,Te={colorSchemes:{light:se,dark:J},fontSize:we,fontFamily:le,fontWeight:Ce,focus:{thickness:"2px",selector:`&.${qr("","focusVisible")}, &:focus-visible`,default:{outlineOffset:`var(--focus-outline-offset, ${B("focus-thickness",(s=(p=V.focus)==null?void 0:p.thickness)!=null?s:"2px")})`,outline:`${B("focus-thickness",(y=(_=V.focus)==null?void 0:_.thickness)!=null?y:"2px")} solid ${B("palette-focusVisible",H.primary[500])}`}},lineHeight:We,radius:{xs:"2px",sm:"6px",md:"8px",lg:"12px",xl:"16px"},shadow:{xs:`${B("shadowRing",Fe)}, 0px 1px 2px 0px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)})`,sm:`${B("shadowRing",Fe)}, 0px 1px 2px 0px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)}), 0px 2px 4px 0px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)})`,md:`${B("shadowRing",Fe)}, 0px 2px 8px -2px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)}), 0px 6px 12px -2px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)})`,lg:`${B("shadowRing",Fe)}, 0px 2px 8px -2px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)}), 0px 12px 16px -4px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)})`,xl:`${B("shadowRing",Fe)}, 0px 2px 8px -2px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)}), 0px 20px 24px -4px rgba(${B("shadowChannel",Me)} / ${B("shadowOpacity",Ee)})`},zIndex:{badge:1,table:10,popup:1e3,modal:1300,snackbar:1400,tooltip:1500},typography:{h1:{fontFamily:B(`fontFamily-display, ${le.display}`),fontWeight:B(`fontWeight-xl, ${Ce.xl}`),fontSize:B(`fontSize-xl4, ${we.xl4}`),lineHeight:B(`lineHeight-xs, ${We.xs}`),letterSpacing:"-0.025em",color:B(`palette-text-primary, ${se.palette.text.primary}`)},h2:{fontFamily:B(`fontFamily-display, ${le.display}`),fontWeight:B(`fontWeight-xl, ${Ce.xl}`),fontSize:B(`fontSize-xl3, ${we.xl3}`),lineHeight:B(`lineHeight-xs, ${We.xs}`),letterSpacing:"-0.025em",color:B(`palette-text-primary, ${se.palette.text.primary}`)},h3:{fontFamily:B(`fontFamily-display, ${le.display}`),fontWeight:B(`fontWeight-lg, ${Ce.lg}`),fontSize:B(`fontSize-xl2, ${we.xl2}`),lineHeight:B(`lineHeight-xs, ${We.xs}`),letterSpacing:"-0.025em",color:B(`palette-text-primary, ${se.palette.text.primary}`)},h4:{fontFamily:B(`fontFamily-display, ${le.display}`),fontWeight:B(`fontWeight-lg, ${Ce.lg}`),fontSize:B(`fontSize-xl, ${we.xl}`),lineHeight:B(`lineHeight-md, ${We.md}`),letterSpacing:"-0.025em",color:B(`palette-text-primary, ${se.palette.text.primary}`)},"title-lg":{fontFamily:B(`fontFamily-body, ${le.body}`),fontWeight:B(`fontWeight-lg, ${Ce.lg}`),fontSize:B(`fontSize-lg, ${we.lg}`),lineHeight:B(`lineHeight-xs, ${We.xs}`),color:B(`palette-text-primary, ${se.palette.text.primary}`)},"title-md":{fontFamily:B(`fontFamily-body, ${le.body}`),fontWeight:B(`fontWeight-md, ${Ce.md}`),fontSize:B(`fontSize-md, ${we.md}`),lineHeight:B(`lineHeight-md, ${We.md}`),color:B(`palette-text-primary, ${se.palette.text.primary}`)},"title-sm":{fontFamily:B(`fontFamily-body, ${le.body}`),fontWeight:B(`fontWeight-md, ${Ce.md}`),fontSize:B(`fontSize-sm, ${we.sm}`),lineHeight:B(`lineHeight-sm, ${We.sm}`),color:B(`palette-text-primary, ${se.palette.text.primary}`)},"body-lg":{fontFamily:B(`fontFamily-body, ${le.body}`),fontSize:B(`fontSize-lg, ${we.lg}`),lineHeight:B(`lineHeight-md, ${We.md}`),color:B(`palette-text-secondary, ${se.palette.text.secondary}`)},"body-md":{fontFamily:B(`fontFamily-body, ${le.body}`),fontSize:B(`fontSize-md, ${we.md}`),lineHeight:B(`lineHeight-md, ${We.md}`),color:B(`palette-text-secondary, ${se.palette.text.secondary}`)},"body-sm":{fontFamily:B(`fontFamily-body, ${le.body}`),fontSize:B(`fontSize-sm, ${we.sm}`),lineHeight:B(`lineHeight-md, ${We.md}`),color:B(`palette-text-tertiary, ${se.palette.text.tertiary}`)},"body-xs":{fontFamily:B(`fontFamily-body, ${le.body}`),fontWeight:B(`fontWeight-md, ${Ce.md}`),fontSize:B(`fontSize-xs, ${we.xs}`),lineHeight:B(`lineHeight-md, ${We.md}`),color:B(`palette-text-tertiary, ${se.palette.text.tertiary}`)}}},Ze=V?Hl(Te,V):Te,{colorSchemes:rt}=Ze,Re=rr(Ze,w7),Qe=me({colorSchemes:rt},Re,{breakpoints:l4(M??{}),components:Hl({MuiSvgIcon:{defaultProps:{fontSize:"xl2"},styleOverrides:{root:({ownerState:lt,theme:_t})=>{var wt;const cn=lt.instanceFontSize;return me({margin:"var(--Icon-margin)"},lt.fontSize&&lt.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${_t.vars.fontSize[lt.fontSize]})`},!lt.htmlColor&&me({color:`var(--Icon-color, ${Qe.vars.palette.text.icon})`},lt.color&&lt.color!=="inherit"&&_t.vars.palette[lt.color]&&{color:`rgba(${(wt=_t.vars.palette[lt.color])==null?void 0:wt.mainChannel} / 1)`}),cn&&cn!=="inherit"&&{"--Icon-fontSize":_t.vars.fontSize[cn]})}}}},D),cssVarPrefix:S,getCssVar:B,spacing:d4(I)});function Vt(lt,_t){Object.keys(_t).forEach(wt=>{const cn={main:"500",light:"200",dark:"700"};lt==="dark"&&(cn.main=400),!_t[wt].mainChannel&&_t[wt][cn.main]&&(_t[wt].mainChannel=mm(_t[wt][cn.main])),!_t[wt].lightChannel&&_t[wt][cn.light]&&(_t[wt].lightChannel=mm(_t[wt][cn.light])),!_t[wt].darkChannel&&_t[wt][cn.dark]&&(_t[wt].darkChannel=mm(_t[wt][cn.dark]))})}Object.entries(Qe.colorSchemes).forEach(([lt,_t])=>{Vt(lt,_t.palette)});const je={prefix:S,shouldSkipGeneratingVar:L},{vars:ct,generateCssVars:Ct}=c7(me({colorSchemes:rt},Re),je);Qe.vars=ct,Qe.generateCssVars=Ct,Qe.unstable_sxConfig=me({},y7,t?.unstable_sxConfig),Qe.unstable_sx=function(_t){return $_({sx:_t,theme:this})},Qe.getColorSchemeSelector=lt=>lt==="light"?"&":`&[data-joy-color-scheme="${lt}"], [data-joy-color-scheme="${lt}"] &`;const ut={getCssVar:B,palette:Qe.colorSchemes.light.palette};return Qe.variants=Hl({plain:ia("plain",ut),plainHover:ia("plainHover",ut),plainActive:ia("plainActive",ut),plainDisabled:ia("plainDisabled",ut),outlined:ia("outlined",ut),outlinedHover:ia("outlinedHover",ut),outlinedActive:ia("outlinedActive",ut),outlinedDisabled:ia("outlinedDisabled",ut),soft:ia("soft",ut),softHover:ia("softHover",ut),softActive:ia("softActive",ut),softDisabled:ia("softDisabled",ut),solid:ia("solid",ut),solidHover:ia("solidHover",ut),solidActive:ia("solidActive",ut),solidDisabled:ia("solidDisabled",ut)},R),Qe.palette=me({},Qe.colorSchemes.light.palette,{colorScheme:"light"}),Qe.shouldSkipGeneratingVar=L,Qe.applyStyles=f4,Qe}const dy=I4(),a0={attribute:"data-joy-color-scheme",colorSchemeStorageKey:"joy-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"joy-mode"},{CssVarsProvider:M7,useColorScheme:Lw}=r7({themeId:O_,theme:dy,attribute:a0.attribute,modeStorageKey:a0.modeStorageKey,colorSchemeStorageKey:a0.colorSchemeStorageKey,defaultColorScheme:{light:a0.defaultLightColorScheme,dark:a0.defaultDarkColorScheme}}),_n=_4({defaultTheme:dy,themeId:O_});function Xr({props:t,name:e}){return b4({props:t,name:e,defaultTheme:me({},dy,{components:{}}),themeId:O_})}function C7(t){return ie.jsx(c9,me({},t,{defaultTheme:dy,themeId:O_}))}function KR(t,e,n=(r,i)=>r===i){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}const E7={disableDefaultClasses:!1},T7=G.createContext(E7);function P7(t){const{disableDefaultClasses:e}=G.useContext(T7);return n=>e?"":t(n)}function A7(t){const{rootElementName:e=""}=t,[n,r]=G.useState(e.toUpperCase()),i=G.useCallback(l=>{var c;r((c=l?.tagName)!=null?c:"")},[]);return[n,i]}const R4="base";function I7(t){return`${R4}--${t}`}function R7(t,e){return`${R4}-${t}-${e}`}function L7(t,e){const n=v4[e];return n?I7(n):R7(t,e)}function kh(t={}){const{disabled:e=!1,focusableWhenDisabled:n,href:r,rootRef:i,tabIndex:l,to:c,type:s,rootElementName:p}=t,y=G.useRef(null),[_,w]=G.useState(!1),{isFocusVisibleRef:S,onFocus:M,onBlur:I,ref:D}=Iw(),[R,L]=G.useState(!1);e&&!n&&R&&L(!1),G.useEffect(()=>{S.current=R},[R,S]);const[V,B]=A7({rootElementName:p??(r||c?"a":void 0)}),H=Fe=>Me=>{var Ee;R&&Me.preventDefault(),(Ee=Fe.onMouseLeave)==null||Ee.call(Fe,Me)},q=Fe=>Me=>{var Ee;I(Me),S.current===!1&&L(!1),(Ee=Fe.onBlur)==null||Ee.call(Fe,Me)},X=Fe=>Me=>{var Ee;if(y.current||(y.current=Me.currentTarget),M(Me),S.current===!0){var Te;L(!0),(Te=Fe.onFocusVisible)==null||Te.call(Fe,Me)}(Ee=Fe.onFocus)==null||Ee.call(Fe,Me)},ee=()=>{const Fe=y.current;return V==="BUTTON"||V==="INPUT"&&["button","submit","reset"].includes(Fe?.type)||V==="A"&&Fe?.href},se=Fe=>Me=>{if(!e){var Ee;(Ee=Fe.onClick)==null||Ee.call(Fe,Me)}},J=Fe=>Me=>{var Ee;e||(w(!0),document.addEventListener("mouseup",()=>{w(!1)},{once:!0})),(Ee=Fe.onMouseDown)==null||Ee.call(Fe,Me)},$=Fe=>Me=>{var Ee;if((Ee=Fe.onKeyDown)==null||Ee.call(Fe,Me),!Me.defaultMuiPrevented&&(Me.target===Me.currentTarget&&!ee()&&Me.key===" "&&Me.preventDefault(),Me.target===Me.currentTarget&&Me.key===" "&&!e&&w(!0),Me.target===Me.currentTarget&&!ee()&&Me.key==="Enter"&&!e)){var Te;(Te=Fe.onClick)==null||Te.call(Fe,Me),Me.preventDefault()}},le=Fe=>Me=>{var Ee;if(Me.target===Me.currentTarget&&w(!1),(Ee=Fe.onKeyUp)==null||Ee.call(Fe,Me),Me.target===Me.currentTarget&&!ee()&&!e&&Me.key===" "&&!Me.defaultMuiPrevented){var Te;(Te=Fe.onClick)==null||Te.call(Fe,Me)}},Ce=mi(B,i,D,y),we={};return l!==void 0&&(we.tabIndex=l),V==="BUTTON"?(we.type=s??"button",n?we["aria-disabled"]=e:we.disabled=e):V==="INPUT"?s&&["button","submit","reset"].includes(s)&&(n?we["aria-disabled"]=e:we.disabled=e):V!==""&&(!r&&!c&&(we.role="button",we.tabIndex=l??0),e&&(we["aria-disabled"]=e,we.tabIndex=n?l??0:-1)),{getRootProps:(Fe={})=>{const Me=me({},ps(t),ps(Fe)),Ee=me({type:s},Me,we,Fe,{onBlur:q(Me),onClick:se(Me),onFocus:X(Me),onKeyDown:$(Me),onKeyUp:le(Me),onMouseDown:J(Me),onMouseLeave:H(Me),ref:Ce});return delete Ee.onFocusVisible,Ee},focusVisible:R,setFocusVisible:L,active:_,rootRef:Ce}}function JR(t){return t.substring(2).toLowerCase()}function k7(t,e){return e.documentElement.clientWidth<t.clientX||e.documentElement.clientHeight<t.clientY}function D7(t){const{children:e,disableReactTree:n=!1,mouseEvent:r="onClick",onClickAway:i,touchEvent:l="onTouchEnd"}=t,c=G.useRef(!1),s=G.useRef(null),p=G.useRef(!1),y=G.useRef(!1);G.useEffect(()=>(setTimeout(()=>{p.current=!0},0),()=>{p.current=!1}),[]);const _=mi(Rw(e),s),w=yu(I=>{const D=y.current;y.current=!1;const R=Gl(s.current);if(!p.current||!s.current||"clientX"in I&&k7(I,R))return;if(c.current){c.current=!1;return}let L;I.composedPath?L=I.composedPath().indexOf(s.current)>-1:L=!R.documentElement.contains(I.target)||s.current.contains(I.target),!L&&(n||!D)&&i(I)}),S=I=>D=>{y.current=!0;const R=e.props[I];R&&R(D)},M={ref:_};return l!==!1&&(M[l]=S(l)),G.useEffect(()=>{if(l!==!1){const I=JR(l),D=Gl(s.current),R=()=>{c.current=!0};return D.addEventListener(I,w),D.addEventListener("touchmove",R),()=>{D.removeEventListener(I,w),D.removeEventListener("touchmove",R)}}},[w,l]),r!==!1&&(M[r]=S(r)),G.useEffect(()=>{if(r!==!1){const I=JR(r),D=Gl(s.current);return D.addEventListener(I,w),()=>{D.removeEventListener(I,w)}}},[w,r]),ie.jsx(G.Fragment,{children:G.cloneElement(e,M)})}const kw=G.createContext(null);function z7(t,e){return t===e}const c2={},QR=()=>{};function UE(t,e){const n=me({},t);return Object.keys(e).forEach(r=>{e[r]!==void 0&&(n[r]=e[r])}),n}function O7(t){const{nextState:e,initialState:n,stateComparers:r,onStateChange:i,controlledProps:l,lastActionRef:c}=t,s=G.useRef(n);G.useEffect(()=>{if(c.current===null)return;const p=UE(s.current,l);Object.keys(e).forEach(y=>{var _;const w=(_=r[y])!=null?_:z7,S=e[y],M=p[y];if(M==null&&S!=null||M!=null&&S==null||M!=null&&S!=null&&!w(S,M)){var I,D;i?.((I=c.current.event)!=null?I:null,y,S,(D=c.current.type)!=null?D:"",e)}}),s.current=e,c.current=null},[s,e,c,i,r,l])}function L4(t){const e=G.useRef(null),{reducer:n,initialState:r,controlledProps:i=c2,stateComparers:l=c2,onStateChange:c=QR,actionContext:s,componentName:p=""}=t;G.useRef(i);const y=G.useCallback((M,I)=>{e.current=I;const D=UE(M,i);return n(D,I)},[i,n]),[_,w]=G.useReducer(y,r),S=G.useCallback(M=>{w(me({},M,{context:s}))},[s]);return O7({nextState:_,initialState:r,stateComparers:l??c2,onStateChange:c??QR,controlledProps:i,lastActionRef:e}),[UE(_,i),S]}const gu={blur:"dropdown:blur",escapeKeyDown:"dropdown:escapeKeyDown",toggle:"dropdown:toggle",open:"dropdown:open",close:"dropdown:close"};function F7(t,e){switch(e.type){case gu.blur:return{open:!1,changeReason:e.event};case gu.escapeKeyDown:return{open:!1,changeReason:e.event};case gu.toggle:return{open:!t.open,changeReason:e.event};case gu.open:return{open:!0,changeReason:e.event};case gu.close:return{open:!1,changeReason:e.event};default:throw new Error("Unhandled action")}}function N7(t={}){const{defaultOpen:e,onOpenChange:n,open:r,componentName:i="useDropdown"}=t,[l,c]=G.useState(""),[s,p]=G.useState(null),y=G.useRef(null),_=G.useCallback((D,R,L,V)=>{R==="open"&&n?.(D,L),y.current=V},[n]),w=G.useMemo(()=>r!==void 0?{open:r}:{},[r]),[S,M]=L4({controlledProps:w,initialState:e?{open:!0,changeReason:null}:{open:!1,changeReason:null},onStateChange:_,reducer:F7,componentName:i});return G.useEffect(()=>{!S.open&&y.current!==null&&y.current!==gu.blur&&s?.focus()},[S.open,s]),{contextValue:{state:S,dispatch:M,popupId:l,registerPopup:c,registerTrigger:p,triggerElement:s},open:S.open}}function B7(t){const{children:e,open:n,defaultOpen:r,onOpenChange:i}=t,{contextValue:l}=N7({defaultOpen:r,onOpenChange:i,open:n});return ie.jsx(kw.Provider,{value:l,children:e})}const U7=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function $7(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function V7(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function j7(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||V7(t))}function H7(t){const e=[],n=[];return Array.from(t.querySelectorAll(U7)).forEach((r,i)=>{const l=$7(r);l===-1||!j7(r)||(l===0?e.push(r):n.push({documentOrder:i,tabIndex:l,node:r}))}),n.sort((r,i)=>r.tabIndex===i.tabIndex?r.documentOrder-i.documentOrder:r.tabIndex-i.tabIndex).map(r=>r.node).concat(e)}function G7(){return!0}function W7(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:i=!1,getTabbable:l=H7,isEnabled:c=G7,open:s}=t,p=G.useRef(!1),y=G.useRef(null),_=G.useRef(null),w=G.useRef(null),S=G.useRef(null),M=G.useRef(!1),I=G.useRef(null),D=mi(Rw(e),I),R=G.useRef(null);G.useEffect(()=>{!s||!I.current||(M.current=!n)},[n,s]),G.useEffect(()=>{if(!s||!I.current)return;const B=Gl(I.current);return I.current.contains(B.activeElement)||(I.current.hasAttribute("tabIndex")||I.current.setAttribute("tabIndex","-1"),M.current&&I.current.focus()),()=>{i||(w.current&&w.current.focus&&(p.current=!0,w.current.focus()),w.current=null)}},[s]),G.useEffect(()=>{if(!s||!I.current)return;const B=Gl(I.current),H=ee=>{R.current=ee,!(r||!c()||ee.key!=="Tab")&&B.activeElement===I.current&&ee.shiftKey&&(p.current=!0,_.current&&_.current.focus())},q=()=>{const ee=I.current;if(ee===null)return;if(!B.hasFocus()||!c()||p.current){p.current=!1;return}if(ee.contains(B.activeElement)||r&&B.activeElement!==y.current&&B.activeElement!==_.current)return;if(B.activeElement!==S.current)S.current=null;else if(S.current!==null)return;if(!M.current)return;let se=[];if((B.activeElement===y.current||B.activeElement===_.current)&&(se=l(I.current)),se.length>0){var J,$;const le=!!((J=R.current)!=null&&J.shiftKey&&(($=R.current)==null?void 0:$.key)==="Tab"),Ce=se[0],we=se[se.length-1];typeof Ce!="string"&&typeof we!="string"&&(le?we.focus():Ce.focus())}else ee.focus()};B.addEventListener("focusin",q),B.addEventListener("keydown",H,!0);const X=setInterval(()=>{B.activeElement&&B.activeElement.tagName==="BODY"&&q()},50);return()=>{clearInterval(X),B.removeEventListener("focusin",q),B.removeEventListener("keydown",H,!0)}},[n,r,i,c,s,l]);const L=B=>{w.current===null&&(w.current=B.relatedTarget),M.current=!0,S.current=B.target;const H=e.props.onFocus;H&&H(B)},V=B=>{w.current===null&&(w.current=B.relatedTarget),M.current=!0};return ie.jsxs(G.Fragment,{children:[ie.jsx("div",{tabIndex:s?0:-1,onFocus:V,ref:y,"data-testid":"sentinelStart"}),G.cloneElement(e,{ref:D,onFocus:L}),ie.jsx("div",{tabIndex:s?0:-1,onFocus:V,ref:_,"data-testid":"sentinelEnd"})]})}const q7=G.createContext(void 0);function X7(){return G.useContext(q7)}function Z7(t={}){const{defaultValue:e,disabled:n=!1,error:r=!1,onBlur:i,onChange:l,onFocus:c,required:s=!1,value:p,inputRef:y}=t,_=X7();let w,S,M,I,D;if(_){var R,L,V;w=void 0,S=(R=_.disabled)!=null?R:!1,M=(L=_.error)!=null?L:!1,I=(V=_.required)!=null?V:!1,D=_.value}else w=e,S=n,M=r,I=s,D=p;const{current:B}=G.useRef(D!=null),H=G.useCallback(Fe=>{},[]),q=G.useRef(null),X=mi(q,y,H),[ee,se]=G.useState(!1);G.useEffect(()=>{!_&&S&&ee&&(se(!1),i?.())},[_,S,ee,i]);const J=Fe=>Me=>{var Ee;if(_!=null&&_.disabled){Me.stopPropagation();return}if((Ee=Fe.onFocus)==null||Ee.call(Fe,Me),_&&_.onFocus){var Te;_==null||(Te=_.onFocus)==null||Te.call(_)}else se(!0)},$=Fe=>Me=>{var Ee;(Ee=Fe.onBlur)==null||Ee.call(Fe,Me),_&&_.onBlur?_.onBlur():se(!1)},le=Fe=>(Me,...Ee)=>{var Te,Ze;if(!B&&(Me.target||q.current)==null)throw new Error(f_(17));_==null||(Te=_.onChange)==null||Te.call(_,Me),(Ze=Fe.onChange)==null||Ze.call(Fe,Me,...Ee)},Ce=Fe=>Me=>{var Ee;q.current&&Me.currentTarget===Me.target&&q.current.focus(),(Ee=Fe.onClick)==null||Ee.call(Fe,Me)};return{disabled:S,error:M,focused:ee,formControlContext:_,getInputProps:(Fe={})=>{const Ee=me({},{onBlur:i,onChange:l,onFocus:c},ps(Fe)),Te=me({},Ee,{onBlur:$(Ee),onChange:le(Ee),onFocus:J(Ee)});return me({},Te,{"aria-invalid":M||void 0,defaultValue:w,value:D,required:I,disabled:S},Fe,{ref:X},Te)},getRootProps:(Fe={})=>{const Me=ps(t,["onBlur","onChange","onFocus"]),Ee=me({},Me,ps(Fe));return me({},Fe,Ee,{onClick:Ce(Ee)})},inputRef:X,required:I,value:D}}const ki={blur:"list:blur",itemClick:"list:itemClick",itemHover:"list:itemHover",itemsChange:"list:itemsChange",keyDown:"list:keyDown",resetHighlight:"list:resetHighlight",highlightLast:"list:highlightLast",textNavigation:"list:textNavigation",clearSelection:"list:clearSelection"};function Y7(t,e,n,r,i,l){if(n.length===0||!r&&n.every((s,p)=>i(s,p)))return-1;let c=t;for(;;){if(!l&&e==="next"&&c===n.length||!l&&e==="previous"&&c===-1)return-1;if(r?!1:i(n[c],c))c+=e==="next"?1:-1,l&&(c=(c+n.length)%n.length);else return c}}function Ps(t,e,n){var r;const{items:i,isItemDisabled:l,disableListWrap:c,disabledItemsFocusable:s,itemComparer:p,focusManagement:y}=n,_=y==="DOM"?0:-1,w=i.length-1,S=t==null?-1:i.findIndex(L=>p(L,t));let M,I,D=!c;switch(e){case"reset":if(_===-1)return null;M=0,I="next",D=!1;break;case"start":M=0,I="next",D=!1;break;case"end":M=w,I="previous",D=!1;break;default:{const L=S+e;L<0?!D&&S!==-1||Math.abs(e)>1?(M=0,I="next"):(M=w,I="previous"):L>w?!D||Math.abs(e)>1?(M=w,I="previous"):(M=0,I="next"):(M=L,I=e>=0?"next":"previous")}}const R=Y7(M,I,i,s,l,D);return R===-1&&t!==null&&!l(t,S)?t:(r=i[R])!=null?r:null}function K7(t,e,n,r){return n==="none"?[]:n==="single"?r(e[0],t)?e:[t]:e.some(i=>r(i,t))?e.filter(i=>!r(i,t)):[...e,t]}function HP(t,e,n){const{itemComparer:r,isItemDisabled:i,selectionMode:l,items:c}=n,{selectedValues:s}=e,p=c.findIndex(_=>r(t,_));if(i(t,p))return e;const y=K7(t,s,l,r);return me({},e,{selectedValues:y,highlightedValue:t})}function J7(t,e,n){const r=e.highlightedValue,{orientation:i,pageSize:l}=n;switch(t){case"Home":return me({},e,{highlightedValue:Ps(r,"start",n)});case"End":return me({},e,{highlightedValue:Ps(r,"end",n)});case"PageUp":return me({},e,{highlightedValue:Ps(r,-l,n)});case"PageDown":return me({},e,{highlightedValue:Ps(r,l,n)});case"ArrowUp":if(i!=="vertical")break;return me({},e,{highlightedValue:Ps(r,-1,n)});case"ArrowDown":if(i!=="vertical")break;return me({},e,{highlightedValue:Ps(r,1,n)});case"ArrowLeft":{if(i==="vertical")break;return me({},e,{highlightedValue:Ps(r,i==="horizontal-ltr"?-1:1,n)})}case"ArrowRight":{if(i==="vertical")break;return me({},e,{highlightedValue:Ps(r,i==="horizontal-ltr"?1:-1,n)})}case"Enter":case" ":return e.highlightedValue===null?e:HP(e.highlightedValue,e,n)}return e}function Q7(t,e){return e.focusManagement==="DOM"?t:me({},t,{highlightedValue:null})}function eH(t,e,n){var r;const i=(r=n(t))==null?void 0:r.trim().toLowerCase();return!i||i.length===0?!1:i.indexOf(e)===0}function tH(t,e,n){const{items:r,isItemDisabled:i,disabledItemsFocusable:l,getItemAsString:c}=n,s=e.length>1;let p=s?t.highlightedValue:Ps(t.highlightedValue,1,n);for(let y=0;y<r.length;y+=1){if(!p||!s&&t.highlightedValue===p)return t;if(eH(p,e,c)&&(!i(p,r.indexOf(p))||l))return me({},t,{highlightedValue:p});p=Ps(p,1,n)}return t}function nH(t,e,n,r){var i;const{itemComparer:l,focusManagement:c}=r;let s=null;if(n.highlightedValue!=null){var p;s=(p=t.find(w=>l(w,n.highlightedValue)))!=null?p:null}else c==="DOM"&&e.length===0&&(s=Ps(null,"reset",r));const _=((i=n.selectedValues)!=null?i:[]).filter(w=>t.some(S=>l(S,w)));return me({},n,{highlightedValue:s,selectedValues:_})}function rH(t,e){return me({},t,{highlightedValue:Ps(null,"reset",e)})}function iH(t,e){return me({},t,{highlightedValue:Ps(null,"end",e)})}function oH(t,e){return me({},t,{selectedValues:[],highlightedValue:Ps(null,"reset",e)})}function Dw(t,e){const{type:n,context:r}=e;switch(n){case ki.keyDown:return J7(e.key,t,r);case ki.itemClick:return HP(e.item,t,r);case ki.blur:return Q7(t,r);case ki.textNavigation:return tH(t,e.searchString,r);case ki.itemsChange:return nH(e.items,e.previousItems,t,r);case ki.resetHighlight:return rH(t,r);case ki.highlightLast:return iH(t,r);case ki.clearSelection:return oH(t,r);default:return t}}const sH=500;function aH(t){const e=G.useRef({searchString:"",lastTime:null});return G.useCallback(n=>{if(n.key.length===1&&n.key!==" "){const r=e.current,i=n.key.toLowerCase(),l=performance.now();r.searchString.length>0&&r.lastTime&&l-r.lastTime>sH?r.searchString=i:(r.searchString.length!==1||i!==r.searchString)&&(r.searchString+=i),r.lastTime=l,t(r.searchString,n)}},[t])}const e3={},lH=()=>{},cH=(t,e)=>t===e,uH=()=>!1,hH=t=>typeof t=="string"?t:String(t),dH=()=>({highlightedValue:null,selectedValues:[]});function GP(t){const{controlledProps:e=e3,disabledItemsFocusable:n=!1,disableListWrap:r=!1,focusManagement:i="activeDescendant",getInitialState:l=dH,getItemDomElement:c,getItemId:s,isItemDisabled:p=uH,rootRef:y,onStateChange:_=lH,items:w,itemComparer:S=cH,getItemAsString:M=hH,onChange:I,onHighlightChange:D,onItemsChange:R,orientation:L="vertical",pageSize:V=5,reducerActionContext:B=e3,selectionMode:H="single",stateReducer:q,componentName:X="useList"}=t,ee=G.useRef(null),se=mi(y,ee),J=G.useCallback((ut,lt,_t)=>{if(D?.(ut,lt,_t),i==="DOM"&&lt!=null&&(_t===ki.itemClick||_t===ki.keyDown||_t===ki.textNavigation)){var wt;c==null||(wt=c(lt))==null||wt.focus()}},[c,D,i]),$=G.useMemo(()=>({highlightedValue:S,selectedValues:(ut,lt)=>KR(ut,lt,S)}),[S]),le=G.useCallback((ut,lt,_t,wt,cn)=>{switch(_?.(ut,lt,_t,wt,cn),lt){case"highlightedValue":J(ut,_t,wt);break;case"selectedValues":I?.(ut,_t,wt);break}},[J,I,_]),Ce=G.useMemo(()=>({disabledItemsFocusable:n,disableListWrap:r,focusManagement:i,isItemDisabled:p,itemComparer:S,items:w,getItemAsString:M,onHighlightChange:J,orientation:L,pageSize:V,selectionMode:H,stateComparers:$}),[n,r,i,p,S,w,M,J,L,V,H,$]),we=l(),We=q??Dw,Fe=G.useMemo(()=>me({},B,Ce),[B,Ce]),[Me,Ee]=L4({reducer:We,actionContext:Fe,initialState:we,controlledProps:e,stateComparers:$,onStateChange:le,componentName:X}),{highlightedValue:Te,selectedValues:Ze}=Me,rt=aH((ut,lt)=>Ee({type:ki.textNavigation,event:lt,searchString:ut})),Re=G.useRef([]);G.useEffect(()=>{KR(Re.current,w,S)||(Ee({type:ki.itemsChange,event:null,items:w,previousItems:Re.current}),Re.current=w,R?.(w))},[w,S,Ee,R]);const Qe=ut=>lt=>{var _t;if((_t=ut.onKeyDown)==null||_t.call(ut,lt),lt.defaultMuiPrevented)return;const wt=["Home","End","PageUp","PageDown"];L==="vertical"?wt.push("ArrowUp","ArrowDown"):wt.push("ArrowLeft","ArrowRight"),i==="activeDescendant"&&wt.push(" ","Enter"),wt.includes(lt.key)&&lt.preventDefault(),Ee({type:ki.keyDown,key:lt.key,event:lt}),rt(lt)},Vt=ut=>lt=>{var _t,wt;(_t=ut.onBlur)==null||_t.call(ut,lt),!lt.defaultMuiPrevented&&((wt=ee.current)!=null&&wt.contains(lt.relatedTarget)||Ee({type:ki.blur,event:lt}))},je=(ut={})=>{const lt=ps(ut);return me({},ut,{"aria-activedescendant":i==="activeDescendant"&&Te!=null?s(Te):void 0,tabIndex:i==="DOM"?-1:0,ref:se},lt,{onBlur:Vt(lt),onKeyDown:Qe(lt)})},ct=G.useCallback(ut=>{const lt=(Ze??[]).some(cn=>cn!=null&&S(ut,cn)),_t=Te!=null&&S(ut,Te);return{focusable:i==="DOM",highlighted:_t,selected:lt}},[S,Ze,Te,i]),Ct=G.useMemo(()=>({dispatch:Ee,getItemState:ct}),[Ee,ct]);return G.useDebugValue({state:Me}),{contextValue:Ct,dispatch:Ee,getRootProps:je,rootRef:se,state:Me}}const pp=G.createContext(null);function WP(t){const{handlePointerOverEvents:e=!1,item:n}=t,r=G.useContext(pp);if(!r)throw new Error("useListItem must be used within a ListProvider");const{dispatch:i,getItemState:l}=r,{highlighted:c,selected:s,focusable:p}=l(n),y=G.useCallback(M=>I=>{var D;(D=M.onClick)==null||D.call(M,I),!I.defaultPrevented&&i({type:ki.itemClick,item:n,event:I})},[i,n]),_=G.useCallback(M=>I=>{var D;(D=M.onMouseOver)==null||D.call(M,I),!I.defaultPrevented&&i({type:ki.itemHover,item:n,event:I})},[i,n]);let w;return p&&(w=c?0:-1),{getRootProps:(M={})=>{const I=ps(M);return me({},M,{onClick:y(I),onPointerOver:e?_(I):void 0,tabIndex:w})},highlighted:c,selected:s}}function fH(t,e){if(e.type===ki.itemHover)return me({},t,{highlightedValue:e.item});const n=Dw(t,e);if(n.highlightedValue===null&&e.context.items.length>0)return me({},n,{highlightedValue:e.context.items[0]});if(e.type===ki.keyDown&&e.event.key==="Escape")return me({},n,{open:!1});if(e.type===ki.blur){var r;if(!((r=e.context.listboxRef.current)!=null&&r.contains(e.event.relatedTarget))){var i,l;const c=(i=e.context.listboxRef.current)==null?void 0:i.getAttribute("id"),s=(l=e.event.relatedTarget)==null?void 0:l.getAttribute("aria-controls");return c&&s&&c===s?n:me({},n,{open:!1,highlightedValue:e.context.items[0]})}}return n}const j_=G.createContext(null);function pH(t){const e=Array.from(t.keys()).map(n=>{const r=t.get(n);return{key:n,subitem:r}});return e.sort((n,r)=>{const i=n.subitem.ref.current,l=r.subitem.ref.current;return i===null||l===null||i===l?0:i.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_PRECEDING?1:-1}),new Map(e.map(n=>[n.key,n.subitem]))}function zw(){const[t,e]=G.useState(new Map),n=G.useRef(new Set),r=G.useCallback(function(y){n.current.delete(y),e(_=>{const w=new Map(_);return w.delete(y),w})},[]),i=G.useCallback(function(y,_){let w;return typeof y=="function"?w=y(n.current):w=y,n.current.add(w),e(S=>{const M=new Map(S);return M.set(w,_),M}),{id:w,deregister:()=>r(w)}},[r]),l=G.useMemo(()=>pH(t),[t]),c=G.useCallback(function(y){return Array.from(l.keys()).indexOf(y)},[l]);return{contextValue:G.useMemo(()=>({getItemIndex:c,registerItem:i,totalSubitemCount:t.size}),[c,i,t.size]),subitems:l}}function Ow(t,e){const n=G.useContext(j_);if(n===null)throw new Error("useCompoundItem must be used within a useCompoundParent");const{registerItem:r}=n,[i,l]=G.useState(typeof t=="function"?void 0:t);return Hd(()=>{const{id:c,deregister:s}=r(t,e);return l(c),s},[r,e,t]),{id:i,index:i!==void 0?n.getItemIndex(i):-1,totalItemCount:n.totalSubitemCount}}function Gd(t,e){return function(r={}){const i=me({},r,t(r));return me({},i,e(i))}}const mH={dispatch:()=>{},registerPopup:()=>{},state:{open:!0,changeReason:null},triggerElement:null};function gH(t={}){var e,n;const{listboxRef:r,onItemsChange:i,id:l,disabledItemsFocusable:c=!0,disableListWrap:s=!1,autoFocus:p=!0,componentName:y="useMenu"}=t,_=G.useRef(null),w=mi(_,r),S=(e=il(l))!=null?e:"",{state:{open:M,changeReason:I},dispatch:D,triggerElement:R,registerPopup:L}=(n=G.useContext(kw))!=null?n:mH,V=G.useRef(M),{subitems:B,contextValue:H}=zw(),q=G.useMemo(()=>Array.from(B.keys()),[B]),X=G.useCallback(Ze=>{var rt,Re;return Ze==null?null:(rt=(Re=B.get(Ze))==null?void 0:Re.ref.current)!=null?rt:null},[B]),ee=G.useCallback(Ze=>{var rt;return(B==null||(rt=B.get(Ze))==null?void 0:rt.disabled)||!1},[B]),se=G.useCallback(Ze=>{var rt,Re;return((rt=B.get(Ze))==null?void 0:rt.label)||((Re=B.get(Ze))==null||(Re=Re.ref.current)==null?void 0:Re.innerText)},[B]),J=G.useMemo(()=>({listboxRef:_}),[_]),{dispatch:$,getRootProps:le,contextValue:Ce,state:{highlightedValue:we},rootRef:We}=GP({disabledItemsFocusable:c,disableListWrap:s,focusManagement:"DOM",getItemDomElement:X,getInitialState:()=>({selectedValues:[],highlightedValue:null}),isItemDisabled:ee,items:q,getItemAsString:se,rootRef:w,onItemsChange:i,reducerActionContext:J,selectionMode:"none",stateReducer:fH,componentName:y});Hd(()=>{L(S)},[S,L]),Hd(()=>{M&&I?.type==="keydown"&&I.key==="ArrowUp"&&$({type:ki.highlightLast,event:I})},[M,I,$]),G.useEffect(()=>{if(M&&p&&we&&!V.current){var Ze;(Ze=B.get(we))==null||(Ze=Ze.ref)==null||(Ze=Ze.current)==null||Ze.focus()}},[M,p,we,B,q]),G.useEffect(()=>{var Ze;if((Ze=_.current)!=null&&Ze.contains(document.activeElement)&&we!==null){var rt;B==null||(rt=B.get(we))==null||(rt=rt.ref.current)==null||rt.focus()}},[we,B]);const Fe=Ze=>rt=>{var Re,Qe;(Re=Ze.onBlur)==null||Re.call(Ze,rt),!rt.defaultMuiPrevented&&((Qe=_.current)!=null&&Qe.contains(rt.relatedTarget)||rt.relatedTarget===R||D({type:gu.blur,event:rt}))},Me=Ze=>rt=>{var Re;(Re=Ze.onKeyDown)==null||Re.call(Ze,rt),!rt.defaultMuiPrevented&&rt.key==="Escape"&&D({type:gu.escapeKeyDown,event:rt})},Ee=(Ze={})=>({onBlur:Fe(Ze),onKeyDown:Me(Ze)}),Te=(Ze={})=>{const rt=Gd(Ee,le),Re=ps(Ze);return me({},Ze,Re,rt(Re),{id:S,role:"menu"})};return G.useDebugValue({subitems:B,highlightedValue:we}),{contextValue:me({},H,Ce),dispatch:$,getListboxProps:Te,highlightedValue:we,listboxRef:We,menuItems:B,open:M,triggerElement:R}}function vH(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:i,getItemState:l,registerItem:c,totalSubitemCount:s}=e,p=G.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:i}),[r,i,l]),y=G.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:s}),[c,i,s]);return ie.jsx(j_.Provider,{value:y,children:ie.jsx(pp.Provider,{value:p,children:n})})}var u2={exports:{}},Wa={},h2={exports:{}},d2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t3;function yH(){return t3||(t3=1,function(t){function e(Te,Ze){var rt=Te.length;Te.push(Ze);e:for(;0<rt;){var Re=rt-1>>>1,Qe=Te[Re];if(0<i(Qe,Ze))Te[Re]=Ze,Te[rt]=Qe,rt=Re;else break e}}function n(Te){return Te.length===0?null:Te[0]}function r(Te){if(Te.length===0)return null;var Ze=Te[0],rt=Te.pop();if(rt!==Ze){Te[0]=rt;e:for(var Re=0,Qe=Te.length,Vt=Qe>>>1;Re<Vt;){var je=2*(Re+1)-1,ct=Te[je],Ct=je+1,ut=Te[Ct];if(0>i(ct,rt))Ct<Qe&&0>i(ut,ct)?(Te[Re]=ut,Te[Ct]=rt,Re=Ct):(Te[Re]=ct,Te[je]=rt,Re=je);else if(Ct<Qe&&0>i(ut,rt))Te[Re]=ut,Te[Ct]=rt,Re=Ct;else break e}}return Ze}function i(Te,Ze){var rt=Te.sortIndex-Ze.sortIndex;return rt!==0?rt:Te.id-Ze.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,s=c.now();t.unstable_now=function(){return c.now()-s}}var p=[],y=[],_=1,w=null,S=3,M=!1,I=!1,D=!1,R=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(Te){for(var Ze=n(y);Ze!==null;){if(Ze.callback===null)r(y);else if(Ze.startTime<=Te)r(y),Ze.sortIndex=Ze.expirationTime,e(p,Ze);else break;Ze=n(y)}}function H(Te){if(D=!1,B(Te),!I)if(n(p)!==null)I=!0,Me(q);else{var Ze=n(y);Ze!==null&&Ee(H,Ze.startTime-Te)}}function q(Te,Ze){I=!1,D&&(D=!1,L(se),se=-1),M=!0;var rt=S;try{for(B(Ze),w=n(p);w!==null&&(!(w.expirationTime>Ze)||Te&&!le());){var Re=w.callback;if(typeof Re=="function"){w.callback=null,S=w.priorityLevel;var Qe=Re(w.expirationTime<=Ze);Ze=t.unstable_now(),typeof Qe=="function"?w.callback=Qe:w===n(p)&&r(p),B(Ze)}else r(p);w=n(p)}if(w!==null)var Vt=!0;else{var je=n(y);je!==null&&Ee(H,je.startTime-Ze),Vt=!1}return Vt}finally{w=null,S=rt,M=!1}}var X=!1,ee=null,se=-1,J=5,$=-1;function le(){return!(t.unstable_now()-$<J)}function Ce(){if(ee!==null){var Te=t.unstable_now();$=Te;var Ze=!0;try{Ze=ee(!0,Te)}finally{Ze?we():(X=!1,ee=null)}}else X=!1}var we;if(typeof V=="function")we=function(){V(Ce)};else if(typeof MessageChannel<"u"){var We=new MessageChannel,Fe=We.port2;We.port1.onmessage=Ce,we=function(){Fe.postMessage(null)}}else we=function(){R(Ce,0)};function Me(Te){ee=Te,X||(X=!0,we())}function Ee(Te,Ze){se=R(function(){Te(t.unstable_now())},Ze)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Te){Te.callback=null},t.unstable_continueExecution=function(){I||M||(I=!0,Me(q))},t.unstable_forceFrameRate=function(Te){0>Te||125<Te?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<Te?Math.floor(1e3/Te):5},t.unstable_getCurrentPriorityLevel=function(){return S},t.unstable_getFirstCallbackNode=function(){return n(p)},t.unstable_next=function(Te){switch(S){case 1:case 2:case 3:var Ze=3;break;default:Ze=S}var rt=S;S=Ze;try{return Te()}finally{S=rt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Te,Ze){switch(Te){case 1:case 2:case 3:case 4:case 5:break;default:Te=3}var rt=S;S=Te;try{return Ze()}finally{S=rt}},t.unstable_scheduleCallback=function(Te,Ze,rt){var Re=t.unstable_now();switch(typeof rt=="object"&&rt!==null?(rt=rt.delay,rt=typeof rt=="number"&&0<rt?Re+rt:Re):rt=Re,Te){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=rt+Qe,Te={id:_++,callback:Ze,priorityLevel:Te,startTime:rt,expirationTime:Qe,sortIndex:-1},rt>Re?(Te.sortIndex=rt,e(y,Te),n(p)===null&&Te===n(y)&&(D?(L(se),se=-1):D=!0,Ee(H,rt-Re))):(Te.sortIndex=Qe,e(p,Te),I||M||(I=!0,Me(q))),Te},t.unstable_shouldYield=le,t.unstable_wrapCallback=function(Te){var Ze=S;return function(){var rt=S;S=Ze;try{return Te.apply(this,arguments)}finally{S=rt}}}}(d2)),d2}var n3;function _H(){return n3||(n3=1,h2.exports=yH()),h2.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r3;function xH(){if(r3)return Wa;r3=1;var t=wP(),e=_H();function n(f){for(var v="https://reactjs.org/docs/error-decoder.html?invariant="+f,P=1;P<arguments.length;P++)v+="&args[]="+encodeURIComponent(arguments[P]);return"Minified React error #"+f+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function l(f,v){c(f,v),c(f+"Capture",v)}function c(f,v){for(i[f]=v,f=0;f<v.length;f++)r.add(v[f])}var s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_={},w={};function S(f){return p.call(w,f)?!0:p.call(_,f)?!1:y.test(f)?w[f]=!0:(_[f]=!0,!1)}function M(f,v,P,O){if(P!==null&&P.type===0)return!1;switch(typeof v){case"function":case"symbol":return!0;case"boolean":return O?!1:P!==null?!P.acceptsBooleans:(f=f.toLowerCase().slice(0,5),f!=="data-"&&f!=="aria-");default:return!1}}function I(f,v,P,O){if(v===null||typeof v>"u"||M(f,v,P,O))return!0;if(O)return!1;if(P!==null)switch(P.type){case 3:return!v;case 4:return v===!1;case 5:return isNaN(v);case 6:return isNaN(v)||1>v}return!1}function D(f,v,P,O,W,Q,be){this.acceptsBooleans=v===2||v===3||v===4,this.attributeName=O,this.attributeNamespace=W,this.mustUseProperty=P,this.propertyName=f,this.type=v,this.sanitizeURL=Q,this.removeEmptyString=be}var R={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(f){R[f]=new D(f,0,!1,f,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(f){var v=f[0];R[v]=new D(v,1,!1,f[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(f){R[f]=new D(f,2,!1,f.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(f){R[f]=new D(f,2,!1,f,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(f){R[f]=new D(f,3,!1,f.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(f){R[f]=new D(f,3,!0,f,null,!1,!1)}),["capture","download"].forEach(function(f){R[f]=new D(f,4,!1,f,null,!1,!1)}),["cols","rows","size","span"].forEach(function(f){R[f]=new D(f,6,!1,f,null,!1,!1)}),["rowSpan","start"].forEach(function(f){R[f]=new D(f,5,!1,f.toLowerCase(),null,!1,!1)});var L=/[\-:]([a-z])/g;function V(f){return f[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(f){var v=f.replace(L,V);R[v]=new D(v,1,!1,f,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(f){var v=f.replace(L,V);R[v]=new D(v,1,!1,f,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(f){var v=f.replace(L,V);R[v]=new D(v,1,!1,f,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(f){R[f]=new D(f,1,!1,f.toLowerCase(),null,!1,!1)}),R.xlinkHref=new D("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(f){R[f]=new D(f,1,!1,f.toLowerCase(),null,!0,!0)});function B(f,v,P,O){var W=R.hasOwnProperty(v)?R[v]:null;(W!==null?W.type!==0:O||!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(I(v,P,W,O)&&(P=null),O||W===null?S(v)&&(P===null?f.removeAttribute(v):f.setAttribute(v,""+P)):W.mustUseProperty?f[W.propertyName]=P===null?W.type===3?!1:"":P:(v=W.attributeName,O=W.attributeNamespace,P===null?f.removeAttribute(v):(W=W.type,P=W===3||W===4&&P===!0?"":""+P,O?f.setAttributeNS(O,v,P):f.setAttribute(v,P))))}var H=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,q=Symbol.for("react.element"),X=Symbol.for("react.portal"),ee=Symbol.for("react.fragment"),se=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),$=Symbol.for("react.provider"),le=Symbol.for("react.context"),Ce=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),We=Symbol.for("react.suspense_list"),Fe=Symbol.for("react.memo"),Me=Symbol.for("react.lazy"),Ee=Symbol.for("react.offscreen"),Te=Symbol.iterator;function Ze(f){return f===null||typeof f!="object"?null:(f=Te&&f[Te]||f["@@iterator"],typeof f=="function"?f:null)}var rt=Object.assign,Re;function Qe(f){if(Re===void 0)try{throw Error()}catch(P){var v=P.stack.trim().match(/\n( *(at )?)/);Re=v&&v[1]||""}return`
`+Re+f}var Vt=!1;function je(f,v){if(!f||Vt)return"";Vt=!0;var P=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(v)if(v=function(){throw Error()},Object.defineProperty(v.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(v,[])}catch(Bt){var O=Bt}Reflect.construct(f,[],v)}else{try{v.call()}catch(Bt){O=Bt}f.call(v.prototype)}else{try{throw Error()}catch(Bt){O=Bt}f()}}catch(Bt){if(Bt&&O&&typeof Bt.stack=="string"){for(var W=Bt.stack.split(`
`),Q=O.stack.split(`
`),be=W.length-1,st=Q.length-1;1<=be&&0<=st&&W[be]!==Q[st];)st--;for(;1<=be&&0<=st;be--,st--)if(W[be]!==Q[st]){if(be!==1||st!==1)do if(be--,st--,0>st||W[be]!==Q[st]){var gt=`
`+W[be].replace(" at new "," at ");return f.displayName&&gt.includes("<anonymous>")&&(gt=gt.replace("<anonymous>",f.displayName)),gt}while(1<=be&&0<=st);break}}}finally{Vt=!1,Error.prepareStackTrace=P}return(f=f?f.displayName||f.name:"")?Qe(f):""}function ct(f){switch(f.tag){case 5:return Qe(f.type);case 16:return Qe("Lazy");case 13:return Qe("Suspense");case 19:return Qe("SuspenseList");case 0:case 2:case 15:return f=je(f.type,!1),f;case 11:return f=je(f.type.render,!1),f;case 1:return f=je(f.type,!0),f;default:return""}}function Ct(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case ee:return"Fragment";case X:return"Portal";case J:return"Profiler";case se:return"StrictMode";case we:return"Suspense";case We:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case le:return(f.displayName||"Context")+".Consumer";case $:return(f._context.displayName||"Context")+".Provider";case Ce:var v=f.render;return f=f.displayName,f||(f=v.displayName||v.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case Fe:return v=f.displayName||null,v!==null?v:Ct(f.type)||"Memo";case Me:v=f._payload,f=f._init;try{return Ct(f(v))}catch{}}return null}function ut(f){var v=f.type;switch(f.tag){case 24:return"Cache";case 9:return(v.displayName||"Context")+".Consumer";case 10:return(v._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=v.render,f=f.displayName||f.name||"",v.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return v;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ct(v);case 8:return v===se?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof v=="function")return v.displayName||v.name||null;if(typeof v=="string")return v}return null}function lt(f){switch(typeof f){case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function _t(f){var v=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(v==="checkbox"||v==="radio")}function wt(f){var v=_t(f)?"checked":"value",P=Object.getOwnPropertyDescriptor(f.constructor.prototype,v),O=""+f[v];if(!f.hasOwnProperty(v)&&typeof P<"u"&&typeof P.get=="function"&&typeof P.set=="function"){var W=P.get,Q=P.set;return Object.defineProperty(f,v,{configurable:!0,get:function(){return W.call(this)},set:function(be){O=""+be,Q.call(this,be)}}),Object.defineProperty(f,v,{enumerable:P.enumerable}),{getValue:function(){return O},setValue:function(be){O=""+be},stopTracking:function(){f._valueTracker=null,delete f[v]}}}}function cn(f){f._valueTracker||(f._valueTracker=wt(f))}function dn(f){if(!f)return!1;var v=f._valueTracker;if(!v)return!0;var P=v.getValue(),O="";return f&&(O=_t(f)?f.checked?"true":"false":f.value),f=O,f!==P?(v.setValue(f),!0):!1}function tn(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}function Je(f,v){var P=v.checked;return rt({},v,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:P??f._wrapperState.initialChecked})}function Tn(f,v){var P=v.defaultValue==null?"":v.defaultValue,O=v.checked!=null?v.checked:v.defaultChecked;P=lt(v.value!=null?v.value:P),f._wrapperState={initialChecked:O,initialValue:P,controlled:v.type==="checkbox"||v.type==="radio"?v.checked!=null:v.value!=null}}function Kt(f,v){v=v.checked,v!=null&&B(f,"checked",v,!1)}function fn(f,v){Kt(f,v);var P=lt(v.value),O=v.type;if(P!=null)O==="number"?(P===0&&f.value===""||f.value!=P)&&(f.value=""+P):f.value!==""+P&&(f.value=""+P);else if(O==="submit"||O==="reset"){f.removeAttribute("value");return}v.hasOwnProperty("value")?On(f,v.type,P):v.hasOwnProperty("defaultValue")&&On(f,v.type,lt(v.defaultValue)),v.checked==null&&v.defaultChecked!=null&&(f.defaultChecked=!!v.defaultChecked)}function Ut(f,v,P){if(v.hasOwnProperty("value")||v.hasOwnProperty("defaultValue")){var O=v.type;if(!(O!=="submit"&&O!=="reset"||v.value!==void 0&&v.value!==null))return;v=""+f._wrapperState.initialValue,P||v===f.value||(f.value=v),f.defaultValue=v}P=f.name,P!==""&&(f.name=""),f.defaultChecked=!!f._wrapperState.initialChecked,P!==""&&(f.name=P)}function On(f,v,P){(v!=="number"||tn(f.ownerDocument)!==f)&&(P==null?f.defaultValue=""+f._wrapperState.initialValue:f.defaultValue!==""+P&&(f.defaultValue=""+P))}var vn=Array.isArray;function Ue(f,v,P,O){if(f=f.options,v){v={};for(var W=0;W<P.length;W++)v["$"+P[W]]=!0;for(P=0;P<f.length;P++)W=v.hasOwnProperty("$"+f[P].value),f[P].selected!==W&&(f[P].selected=W),W&&O&&(f[P].defaultSelected=!0)}else{for(P=""+lt(P),v=null,W=0;W<f.length;W++){if(f[W].value===P){f[W].selected=!0,O&&(f[W].defaultSelected=!0);return}v!==null||f[W].disabled||(v=f[W])}v!==null&&(v.selected=!0)}}function Se(f,v){if(v.dangerouslySetInnerHTML!=null)throw Error(n(91));return rt({},v,{value:void 0,defaultValue:void 0,children:""+f._wrapperState.initialValue})}function yt(f,v){var P=v.value;if(P==null){if(P=v.children,v=v.defaultValue,P!=null){if(v!=null)throw Error(n(92));if(vn(P)){if(1<P.length)throw Error(n(93));P=P[0]}v=P}v==null&&(v=""),P=v}f._wrapperState={initialValue:lt(P)}}function Nt(f,v){var P=lt(v.value),O=lt(v.defaultValue);P!=null&&(P=""+P,P!==f.value&&(f.value=P),v.defaultValue==null&&f.defaultValue!==P&&(f.defaultValue=P)),O!=null&&(f.defaultValue=""+O)}function Ht(f){var v=f.textContent;v===f._wrapperState.initialValue&&v!==""&&v!==null&&(f.value=v)}function Ot(f){switch(f){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function un(f,v){return f==null||f==="http://www.w3.org/1999/xhtml"?Ot(v):f==="http://www.w3.org/2000/svg"&&v==="foreignObject"?"http://www.w3.org/1999/xhtml":f}var Gt,Zt=function(f){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(v,P,O,W){MSApp.execUnsafeLocalFunction(function(){return f(v,P,O,W)})}:f}(function(f,v){if(f.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in f)f.innerHTML=v;else{for(Gt=Gt||document.createElement("div"),Gt.innerHTML="<svg>"+v.valueOf().toString()+"</svg>",v=Gt.firstChild;f.firstChild;)f.removeChild(f.firstChild);for(;v.firstChild;)f.appendChild(v.firstChild)}});function Nn(f,v){if(v){var P=f.firstChild;if(P&&P===f.lastChild&&P.nodeType===3){P.nodeValue=v;return}}f.textContent=v}var Yt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pe=["Webkit","ms","Moz","O"];Object.keys(Yt).forEach(function(f){Pe.forEach(function(v){v=v+f.charAt(0).toUpperCase()+f.substring(1),Yt[v]=Yt[f]})});function ae(f,v,P){return v==null||typeof v=="boolean"||v===""?"":P||typeof v!="number"||v===0||Yt.hasOwnProperty(f)&&Yt[f]?(""+v).trim():v+"px"}function ue(f,v){f=f.style;for(var P in v)if(v.hasOwnProperty(P)){var O=P.indexOf("--")===0,W=ae(P,v[P],O);P==="float"&&(P="cssFloat"),O?f.setProperty(P,W):f[P]=W}}var ne=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fe(f,v){if(v){if(ne[f]&&(v.children!=null||v.dangerouslySetInnerHTML!=null))throw Error(n(137,f));if(v.dangerouslySetInnerHTML!=null){if(v.children!=null)throw Error(n(60));if(typeof v.dangerouslySetInnerHTML!="object"||!("__html"in v.dangerouslySetInnerHTML))throw Error(n(61))}if(v.style!=null&&typeof v.style!="object")throw Error(n(62))}}function Oe(f,v){if(f.indexOf("-")===-1)return typeof v.is=="string";switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ke=null;function ye(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var Ae=null,Be=null,$e=null;function He(f){if(f=Xc(f)){if(typeof Ae!="function")throw Error(n(280));var v=f.stateNode;v&&(v=Bu(v),Ae(f.stateNode,f.type,v))}}function dt(f){Be?$e?$e.push(f):$e=[f]:Be=f}function qe(){if(Be){var f=Be,v=$e;if($e=Be=null,He(f),v)for(f=0;f<v.length;f++)He(v[f])}}function $t(f,v){return f(v)}function Jt(){}var Ie=!1;function ot(f,v,P){if(Ie)return f(v,P);Ie=!0;try{return $t(f,v,P)}finally{Ie=!1,(Be!==null||$e!==null)&&(Jt(),qe())}}function mt(f,v){var P=f.stateNode;if(P===null)return null;var O=Bu(P);if(O===null)return null;P=O[v];e:switch(v){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(O=!O.disabled)||(f=f.type,O=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!O;break e;default:f=!1}if(f)return null;if(P&&typeof P!="function")throw Error(n(231,v,typeof P));return P}var Wt=!1;if(s)try{var nn={};Object.defineProperty(nn,"passive",{get:function(){Wt=!0}}),window.addEventListener("test",nn,nn),window.removeEventListener("test",nn,nn)}catch{Wt=!1}function mn(f,v,P,O,W,Q,be,st,gt){var Bt=Array.prototype.slice.call(arguments,3);try{v.apply(P,Bt)}catch(wn){this.onError(wn)}}var on=!1,sn=null,Dn=!1,Et=null,Gn={onError:function(f){on=!0,sn=f}};function Fn(f,v,P,O,W,Q,be,st,gt){on=!1,sn=null,mn.apply(Gn,arguments)}function or(f,v,P,O,W,Q,be,st,gt){if(Fn.apply(this,arguments),on){if(on){var Bt=sn;on=!1,sn=null}else throw Error(n(198));Dn||(Dn=!0,Et=Bt)}}function It(f){var v=f,P=f;if(f.alternate)for(;v.return;)v=v.return;else{f=v;do v=f,(v.flags&4098)!==0&&(P=v.return),f=v.return;while(f)}return v.tag===3?P:null}function nt(f){if(f.tag===13){var v=f.memoizedState;if(v===null&&(f=f.alternate,f!==null&&(v=f.memoizedState)),v!==null)return v.dehydrated}return null}function qt(f){if(It(f)!==f)throw Error(n(188))}function hn(f){var v=f.alternate;if(!v){if(v=It(f),v===null)throw Error(n(188));return v!==f?null:f}for(var P=f,O=v;;){var W=P.return;if(W===null)break;var Q=W.alternate;if(Q===null){if(O=W.return,O!==null){P=O;continue}break}if(W.child===Q.child){for(Q=W.child;Q;){if(Q===P)return qt(W),f;if(Q===O)return qt(W),v;Q=Q.sibling}throw Error(n(188))}if(P.return!==O.return)P=W,O=Q;else{for(var be=!1,st=W.child;st;){if(st===P){be=!0,P=W,O=Q;break}if(st===O){be=!0,O=W,P=Q;break}st=st.sibling}if(!be){for(st=Q.child;st;){if(st===P){be=!0,P=Q,O=W;break}if(st===O){be=!0,O=Q,P=W;break}st=st.sibling}if(!be)throw Error(n(189))}}if(P.alternate!==O)throw Error(n(190))}if(P.tag!==3)throw Error(n(188));return P.stateNode.current===P?f:v}function kn(f){return f=hn(f),f!==null?Ir(f):null}function Ir(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var v=Ir(f);if(v!==null)return v;f=f.sibling}return null}var xr=e.unstable_scheduleCallback,xe=e.unstable_cancelCallback,vt=e.unstable_shouldYield,Dt=e.unstable_requestPaint,bt=e.unstable_now,St=e.unstable_getCurrentPriorityLevel,pn=e.unstable_ImmediatePriority,An=e.unstable_UserBlockingPriority,gn=e.unstable_NormalPriority,Pn=e.unstable_LowPriority,Qt=e.unstable_IdlePriority,Zn=null,In=null;function Wn(f){if(In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(Zn,f,void 0,(f.current.flags&128)===128)}catch{}}var tr=Math.clz32?Math.clz32:wr,Or=Math.log,Fr=Math.LN2;function wr(f){return f>>>=0,f===0?32:31-(Or(f)/Fr|0)|0}var ur=64,ui=4194304;function kr(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Eo(f,v){var P=f.pendingLanes;if(P===0)return 0;var O=0,W=f.suspendedLanes,Q=f.pingedLanes,be=P&268435455;if(be!==0){var st=be&~W;st!==0?O=kr(st):(Q&=be,Q!==0&&(O=kr(Q)))}else be=P&~W,be!==0?O=kr(be):Q!==0&&(O=kr(Q));if(O===0)return 0;if(v!==0&&v!==O&&(v&W)===0&&(W=O&-O,Q=v&-v,W>=Q||W===16&&(Q&4194240)!==0))return v;if((O&4)!==0&&(O|=P&16),v=f.entangledLanes,v!==0)for(f=f.entanglements,v&=O;0<v;)P=31-tr(v),W=1<<P,O|=f[P],v&=~W;return O}function Ys(f,v){switch(f){case 1:case 2:case 4:return v+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return v+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jo(f,v){for(var P=f.suspendedLanes,O=f.pingedLanes,W=f.expirationTimes,Q=f.pendingLanes;0<Q;){var be=31-tr(Q),st=1<<be,gt=W[be];gt===-1?((st&P)===0||(st&O)!==0)&&(W[be]=Ys(st,v)):gt<=v&&(f.expiredLanes|=st),Q&=~st}}function Ra(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Zr(){var f=ur;return ur<<=1,(ur&4194240)===0&&(ur=64),f}function uo(f){for(var v=[],P=0;31>P;P++)v.push(f);return v}function Xi(f,v,P){f.pendingLanes|=v,v!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,v=31-tr(v),f[v]=P}function ho(f,v){var P=f.pendingLanes&~v;f.pendingLanes=v,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=v,f.mutableReadLanes&=v,f.entangledLanes&=v,v=f.entanglements;var O=f.eventTimes;for(f=f.expirationTimes;0<P;){var W=31-tr(P),Q=1<<W;v[W]=0,O[W]=-1,f[W]=-1,P&=~Q}}function Vi(f,v){var P=f.entangledLanes|=v;for(f=f.entanglements;P;){var O=31-tr(P),W=1<<O;W&v|f[O]&v&&(f[O]|=v),P&=~W}}var Nr=0;function io(f){return f&=-f,1<f?4<f?(f&268435455)!==0?16:536870912:4:1}var Er,ha,La,Zl,nf,Oh=!1,Qo=[],No=null,yr=null,Ks=null,Yl=new Map,Oc=new Map,Di=[],Zi="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function To(f,v){switch(f){case"focusin":case"focusout":No=null;break;case"dragenter":case"dragleave":yr=null;break;case"mouseover":case"mouseout":Ks=null;break;case"pointerover":case"pointerout":Yl.delete(v.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oc.delete(v.pointerId)}}function Ni(f,v,P,O,W,Q){return f===null||f.nativeEvent!==Q?(f={blockedOn:v,domEventName:P,eventSystemFlags:O,nativeEvent:Q,targetContainers:[W]},v!==null&&(v=Xc(v),v!==null&&ha(v)),f):(f.eventSystemFlags|=O,v=f.targetContainers,W!==null&&v.indexOf(W)===-1&&v.push(W),f)}function Ai(f,v,P,O,W){switch(v){case"focusin":return No=Ni(No,f,v,P,O,W),!0;case"dragenter":return yr=Ni(yr,f,v,P,O,W),!0;case"mouseover":return Ks=Ni(Ks,f,v,P,O,W),!0;case"pointerover":var Q=W.pointerId;return Yl.set(Q,Ni(Yl.get(Q)||null,f,v,P,O,W)),!0;case"gotpointercapture":return Q=W.pointerId,Oc.set(Q,Ni(Oc.get(Q)||null,f,v,P,O,W)),!0}return!1}function Fh(f){var v=ta(f.target);if(v!==null){var P=It(v);if(P!==null){if(v=P.tag,v===13){if(v=nt(P),v!==null){f.blockedOn=v,nf(f.priority,function(){La(P)});return}}else if(v===3&&P.stateNode.current.memoizedState.isDehydrated){f.blockedOn=P.tag===3?P.stateNode.containerInfo:null;return}}}f.blockedOn=null}function Tr(f){if(f.blockedOn!==null)return!1;for(var v=f.targetContainers;0<v.length;){var P=Js(f.domEventName,f.eventSystemFlags,v[0],f.nativeEvent);if(P===null){P=f.nativeEvent;var O=new P.constructor(P.type,P);Ke=O,P.target.dispatchEvent(O),Ke=null}else return v=Xc(P),v!==null&&ha(v),f.blockedOn=P,!1;v.shift()}return!0}function es(f,v,P){Tr(f)&&P.delete(v)}function _r(){Oh=!1,No!==null&&Tr(No)&&(No=null),yr!==null&&Tr(yr)&&(yr=null),Ks!==null&&Tr(Ks)&&(Ks=null),Yl.forEach(es),Oc.forEach(es)}function vr(f,v){f.blockedOn===v&&(f.blockedOn=null,Oh||(Oh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,_r)))}function da(f){function v(W){return vr(W,f)}if(0<Qo.length){vr(Qo[0],f);for(var P=1;P<Qo.length;P++){var O=Qo[P];O.blockedOn===f&&(O.blockedOn=null)}}for(No!==null&&vr(No,f),yr!==null&&vr(yr,f),Ks!==null&&vr(Ks,f),Yl.forEach(v),Oc.forEach(v),P=0;P<Di.length;P++)O=Di[P],O.blockedOn===f&&(O.blockedOn=null);for(;0<Di.length&&(P=Di[0],P.blockedOn===null);)Fh(P),P.blockedOn===null&&Di.shift()}var sr=H.ReactCurrentBatchConfig,ka=!0;function ts(f,v,P,O){var W=Nr,Q=sr.transition;sr.transition=null;try{Nr=1,Bo(f,v,P,O)}finally{Nr=W,sr.transition=Q}}function Cu(f,v,P,O){var W=Nr,Q=sr.transition;sr.transition=null;try{Nr=4,Bo(f,v,P,O)}finally{Nr=W,sr.transition=Q}}function Bo(f,v,P,O){if(ka){var W=Js(f,v,P,O);if(W===null)Ou(f,v,O,Eu,P),To(f,O);else if(Ai(W,f,v,P,O))O.stopPropagation();else if(To(f,O),v&4&&-1<Zi.indexOf(f)){for(;W!==null;){var Q=Xc(W);if(Q!==null&&Er(Q),Q=Js(f,v,P,O),Q===null&&Ou(f,v,O,Eu,P),Q===W)break;W=Q}W!==null&&O.stopPropagation()}else Ou(f,v,O,null,P)}}var Eu=null;function Js(f,v,P,O){if(Eu=null,f=ye(O),f=ta(f),f!==null)if(v=It(f),v===null)f=null;else if(P=v.tag,P===13){if(f=nt(v),f!==null)return f;f=null}else if(P===3){if(v.stateNode.current.memoizedState.isDehydrated)return v.tag===3?v.stateNode.containerInfo:null;f=null}else v!==f&&(f=null);return Eu=f,null}function Cp(f){switch(f){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(St()){case pn:return 1;case An:return 4;case gn:case Pn:return 16;case Qt:return 536870912;default:return 16}default:return 16}}var cl=null,Fc=null,Kl=null;function Qs(){if(Kl)return Kl;var f,v=Fc,P=v.length,O,W="value"in cl?cl.value:cl.textContent,Q=W.length;for(f=0;f<P&&v[f]===W[f];f++);var be=P-f;for(O=1;O<=be&&v[P-O]===W[Q-O];O++);return Kl=W.slice(f,1<O?1-O:void 0)}function ji(f){var v=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&v===13&&(f=13)):f=v,f===10&&(f=13),32<=f||f===13?f:0}function ul(){return!0}function Tu(){return!1}function fo(f){function v(P,O,W,Q,be){this._reactName=P,this._targetInst=W,this.type=O,this.nativeEvent=Q,this.target=be,this.currentTarget=null;for(var st in f)f.hasOwnProperty(st)&&(P=f[st],this[st]=P?P(Q):Q[st]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?ul:Tu,this.isPropagationStopped=Tu,this}return rt(v.prototype,{preventDefault:function(){this.defaultPrevented=!0;var P=this.nativeEvent;P&&(P.preventDefault?P.preventDefault():typeof P.returnValue!="unknown"&&(P.returnValue=!1),this.isDefaultPrevented=ul)},stopPropagation:function(){var P=this.nativeEvent;P&&(P.stopPropagation?P.stopPropagation():typeof P.cancelBubble!="unknown"&&(P.cancelBubble=!0),this.isPropagationStopped=ul)},persist:function(){},isPersistent:ul}),v}var Si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=fo(Si),Da=rt({},Si,{view:0,detail:0}),Pu=fo(Da),Ep,za,hl,Au=rt({},Da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lu,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==hl&&(hl&&f.type==="mousemove"?(Ep=f.screenX-hl.screenX,za=f.screenY-hl.screenY):za=Ep=0,hl=f),Ep)},movementY:function(f){return"movementY"in f?f.movementY:za}}),rg=fo(Au),ns=rt({},Au,{dataTransfer:0}),Iu=fo(ns),Ls=rt({},Da,{relatedTarget:0}),Uo=fo(Ls),Tp=rt({},Si,{animationName:0,elapsedTime:0,pseudoElement:0}),Nh=fo(Tp),Ru=rt({},Si,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),Pp=fo(Ru),wy=rt({},Si,{data:0}),ig=fo(wy),Sy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},My={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function of(f){var v=this.nativeEvent;return v.getModifierState?v.getModifierState(f):(f=rf[f])?!!v[f]:!1}function Lu(){return of}var Bh=rt({},Da,{key:function(f){if(f.key){var v=Sy[f.key]||f.key;if(v!=="Unidentified")return v}return f.type==="keypress"?(f=ji(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?My[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lu,charCode:function(f){return f.type==="keypress"?ji(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?ji(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),Ap=fo(Bh),sf=rt({},Au,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fa=fo(sf),Cy=rt({},Da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lu}),Ip=fo(Cy),Uh=rt({},Si,{propertyName:0,elapsedTime:0,pseudoElement:0}),$h=fo(Uh),og=rt({},Au,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),Vh=fo(og),sg=[9,13,27,32],Jl=s&&"CompositionEvent"in window,jh=null;s&&"documentMode"in document&&(jh=document.documentMode);var ag=s&&"TextEvent"in window&&!jh,lg=s&&(!Jl||jh&&8<jh&&11>=jh),Hh=" ",af=!1;function Rp(f,v){switch(f){case"keyup":return sg.indexOf(v.keyCode)!==-1;case"keydown":return v.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lp(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Ql=!1;function kp(f,v){switch(f){case"compositionend":return Lp(v);case"keypress":return v.which!==32?null:(af=!0,Hh);case"textInput":return f=v.data,f===Hh&&af?null:f;default:return null}}function Bc(f,v){if(Ql)return f==="compositionend"||!Jl&&Rp(f,v)?(f=Qs(),Kl=Fc=cl=null,Ql=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(v.ctrlKey||v.altKey||v.metaKey)||v.ctrlKey&&v.altKey){if(v.char&&1<v.char.length)return v.char;if(v.which)return String.fromCharCode(v.which)}return null;case"compositionend":return lg&&v.locale!=="ko"?null:v.data;default:return null}}var cg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lf(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v==="input"?!!cg[f.type]:v==="textarea"}function Uc(f,v,P,O){dt(O),v=Hc(v,"onChange"),0<v.length&&(P=new Nc("onChange","change",null,P,O),f.push({event:P,listeners:v}))}var Gh=null,ec=null;function Ey(f){jp(f,0)}function Wh(f){var v=Ba(f);if(dn(v))return f}function ug(f,v){if(f==="change")return v}var Dp=!1;if(s){var cf;if(s){var qh="oninput"in document;if(!qh){var jr=document.createElement("div");jr.setAttribute("oninput","return;"),qh=typeof jr.oninput=="function"}cf=qh}else cf=!1;Dp=cf&&(!document.documentMode||9<document.documentMode)}function Xh(){Gh&&(Gh.detachEvent("onpropertychange",Oa),ec=Gh=null)}function Oa(f){if(f.propertyName==="value"&&Wh(ec)){var v=[];Uc(v,ec,f,ye(f)),ot(Ey,v)}}function zp(f,v,P){f==="focusin"?(Xh(),Gh=v,ec=P,Gh.attachEvent("onpropertychange",Oa)):f==="focusout"&&Xh()}function Op(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return Wh(ec)}function Fp(f,v){if(f==="click")return Wh(v)}function hg(f,v){if(f==="input"||f==="change")return Wh(v)}function Np(f,v){return f===v&&(f!==0||1/f===1/v)||f!==f&&v!==v}var Po=typeof Object.is=="function"?Object.is:Np;function $c(f,v){if(Po(f,v))return!0;if(typeof f!="object"||f===null||typeof v!="object"||v===null)return!1;var P=Object.keys(f),O=Object.keys(v);if(P.length!==O.length)return!1;for(O=0;O<P.length;O++){var W=P[O];if(!p.call(v,W)||!Po(f[W],v[W]))return!1}return!0}function dg(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function fg(f,v){var P=dg(f);f=0;for(var O;P;){if(P.nodeType===3){if(O=f+P.textContent.length,f<=v&&O>=v)return{node:P,offset:v-f};f=O}e:{for(;P;){if(P.nextSibling){P=P.nextSibling;break e}P=P.parentNode}P=void 0}P=dg(P)}}function pg(f,v){return f&&v?f===v?!0:f&&f.nodeType===3?!1:v&&v.nodeType===3?pg(f,v.parentNode):"contains"in f?f.contains(v):f.compareDocumentPosition?!!(f.compareDocumentPosition(v)&16):!1:!1}function mg(){for(var f=window,v=tn();v instanceof f.HTMLIFrameElement;){try{var P=typeof v.contentWindow.location.href=="string"}catch{P=!1}if(P)f=v.contentWindow;else break;v=tn(f.document)}return v}function uf(f){var v=f&&f.nodeName&&f.nodeName.toLowerCase();return v&&(v==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||v==="textarea"||f.contentEditable==="true")}function Ty(f){var v=mg(),P=f.focusedElem,O=f.selectionRange;if(v!==P&&P&&P.ownerDocument&&pg(P.ownerDocument.documentElement,P)){if(O!==null&&uf(P)){if(v=O.start,f=O.end,f===void 0&&(f=v),"selectionStart"in P)P.selectionStart=v,P.selectionEnd=Math.min(f,P.value.length);else if(f=(v=P.ownerDocument||document)&&v.defaultView||window,f.getSelection){f=f.getSelection();var W=P.textContent.length,Q=Math.min(O.start,W);O=O.end===void 0?Q:Math.min(O.end,W),!f.extend&&Q>O&&(W=O,O=Q,Q=W),W=fg(P,Q);var be=fg(P,O);W&&be&&(f.rangeCount!==1||f.anchorNode!==W.node||f.anchorOffset!==W.offset||f.focusNode!==be.node||f.focusOffset!==be.offset)&&(v=v.createRange(),v.setStart(W.node,W.offset),f.removeAllRanges(),Q>O?(f.addRange(v),f.extend(be.node,be.offset)):(v.setEnd(be.node,be.offset),f.addRange(v)))}}for(v=[],f=P;f=f.parentNode;)f.nodeType===1&&v.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<v.length;P++)f=v[P],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var gg=s&&"documentMode"in document&&11>=document.documentMode,dl=null,ku=null,tc=null,Zh=!1;function nc(f,v,P){var O=P.window===P?P.document:P.nodeType===9?P:P.ownerDocument;Zh||dl==null||dl!==tn(O)||(O=dl,"selectionStart"in O&&uf(O)?O={start:O.selectionStart,end:O.selectionEnd}:(O=(O.ownerDocument&&O.ownerDocument.defaultView||window).getSelection(),O={anchorNode:O.anchorNode,anchorOffset:O.anchorOffset,focusNode:O.focusNode,focusOffset:O.focusOffset}),tc&&$c(tc,O)||(tc=O,O=Hc(ku,"onSelect"),0<O.length&&(v=new Nc("onSelect","select",null,v,P),f.push({event:v,listeners:O}),v.target=dl)))}function rc(f,v){var P={};return P[f.toLowerCase()]=v.toLowerCase(),P["Webkit"+f]="webkit"+v,P["Moz"+f]="moz"+v,P}var pa={animationend:rc("Animation","AnimationEnd"),animationiteration:rc("Animation","AnimationIteration"),animationstart:rc("Animation","AnimationStart"),transitionend:rc("Transition","TransitionEnd")},vs={},Bp={};s&&(Bp=document.createElement("div").style,"AnimationEvent"in window||(delete pa.animationend.animation,delete pa.animationiteration.animation,delete pa.animationstart.animation),"TransitionEvent"in window||delete pa.transitionend.transition);function Yh(f){if(vs[f])return vs[f];if(!pa[f])return f;var v=pa[f],P;for(P in v)if(v.hasOwnProperty(P)&&P in Bp)return vs[f]=v[P];return f}var hf=Yh("animationend"),ic=Yh("animationiteration"),Kh=Yh("animationstart"),Jh=Yh("transitionend"),Du=new Map,Vc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fl(f,v){Du.set(f,v),l(v,[f])}for(var oc=0;oc<Vc.length;oc++){var sc=Vc[oc],Up=sc.toLowerCase(),$p=sc[0].toUpperCase()+sc.slice(1);fl(Up,"on"+$p)}fl(hf,"onAnimationEnd"),fl(ic,"onAnimationIteration"),fl(Kh,"onAnimationStart"),fl("dblclick","onDoubleClick"),fl("focusin","onFocus"),fl("focusout","onBlur"),fl(Jh,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jc=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sr));function Vp(f,v,P){var O=f.type||"unknown-event";f.currentTarget=P,or(O,v,void 0,f),f.currentTarget=null}function jp(f,v){v=(v&4)!==0;for(var P=0;P<f.length;P++){var O=f[P],W=O.event;O=O.listeners;e:{var Q=void 0;if(v)for(var be=O.length-1;0<=be;be--){var st=O[be],gt=st.instance,Bt=st.currentTarget;if(st=st.listener,gt!==Q&&W.isPropagationStopped())break e;Vp(W,st,Bt),Q=gt}else for(be=0;be<O.length;be++){if(st=O[be],gt=st.instance,Bt=st.currentTarget,st=st.listener,gt!==Q&&W.isPropagationStopped())break e;Vp(W,st,Bt),Q=gt}}}if(Dn)throw f=Et,Dn=!1,Et=null,f}function oi(f,v){var P=v[Fu];P===void 0&&(P=v[Fu]=new Set);var O=f+"__bubble";P.has(O)||(Gp(v,f,2,!1),P.add(O))}function Hp(f,v,P){var O=0;v&&(O|=4),Gp(P,f,O,v)}var df="_reactListening"+Math.random().toString(36).slice(2);function zu(f){if(!f[df]){f[df]=!0,r.forEach(function(P){P!=="selectionchange"&&(jc.has(P)||Hp(P,!1,f),Hp(P,!0,f))});var v=f.nodeType===9?f:f.ownerDocument;v===null||v[df]||(v[df]=!0,Hp("selectionchange",!1,v))}}function Gp(f,v,P,O){switch(Cp(v)){case 1:var W=ts;break;case 4:W=Cu;break;default:W=Bo}P=W.bind(null,v,P,f),W=void 0,!Wt||v!=="touchstart"&&v!=="touchmove"&&v!=="wheel"||(W=!0),O?W!==void 0?f.addEventListener(v,P,{capture:!0,passive:W}):f.addEventListener(v,P,!0):W!==void 0?f.addEventListener(v,P,{passive:W}):f.addEventListener(v,P,!1)}function Ou(f,v,P,O,W){var Q=O;if((v&1)===0&&(v&2)===0&&O!==null)e:for(;;){if(O===null)return;var be=O.tag;if(be===3||be===4){var st=O.stateNode.containerInfo;if(st===W||st.nodeType===8&&st.parentNode===W)break;if(be===4)for(be=O.return;be!==null;){var gt=be.tag;if((gt===3||gt===4)&&(gt=be.stateNode.containerInfo,gt===W||gt.nodeType===8&&gt.parentNode===W))return;be=be.return}for(;st!==null;){if(be=ta(st),be===null)return;if(gt=be.tag,gt===5||gt===6){O=Q=be;continue e}st=st.parentNode}}O=O.return}ot(function(){var Bt=Q,wn=ye(P),Cn=[];e:{var xn=Du.get(f);if(xn!==void 0){var Un=Nc,Yn=f;switch(f){case"keypress":if(ji(P)===0)break e;case"keydown":case"keyup":Un=Ap;break;case"focusin":Yn="focus",Un=Uo;break;case"focusout":Yn="blur",Un=Uo;break;case"beforeblur":case"afterblur":Un=Uo;break;case"click":if(P.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Un=rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Un=Iu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Un=Ip;break;case hf:case ic:case Kh:Un=Nh;break;case Jh:Un=$h;break;case"scroll":Un=Pu;break;case"wheel":Un=Vh;break;case"copy":case"cut":case"paste":Un=Pp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Un=fa}var ir=(v&4)!==0,Wi=!ir&&f==="scroll",Lt=ir?xn!==null?xn+"Capture":null:xn;ir=[];for(var xt=Bt,zt;xt!==null;){zt=xt;var Ln=zt.stateNode;if(zt.tag===5&&Ln!==null&&(zt=Ln,Lt!==null&&(Ln=mt(xt,Lt),Ln!=null&&ir.push(ac(xt,Ln,zt)))),Wi)break;xt=xt.return}0<ir.length&&(xn=new Un(xn,Yn,null,P,wn),Cn.push({event:xn,listeners:ir}))}}if((v&7)===0){e:{if(xn=f==="mouseover"||f==="pointerover",Un=f==="mouseout"||f==="pointerout",xn&&P!==Ke&&(Yn=P.relatedTarget||P.fromElement)&&(ta(Yn)||Yn[Yi]))break e;if((Un||xn)&&(xn=wn.window===wn?wn:(xn=wn.ownerDocument)?xn.defaultView||xn.parentWindow:window,Un?(Yn=P.relatedTarget||P.toElement,Un=Bt,Yn=Yn?ta(Yn):null,Yn!==null&&(Wi=It(Yn),Yn!==Wi||Yn.tag!==5&&Yn.tag!==6)&&(Yn=null)):(Un=null,Yn=Bt),Un!==Yn)){if(ir=rg,Ln="onMouseLeave",Lt="onMouseEnter",xt="mouse",(f==="pointerout"||f==="pointerover")&&(ir=fa,Ln="onPointerLeave",Lt="onPointerEnter",xt="pointer"),Wi=Un==null?xn:Ba(Un),zt=Yn==null?xn:Ba(Yn),xn=new ir(Ln,xt+"leave",Un,P,wn),xn.target=Wi,xn.relatedTarget=zt,Ln=null,ta(wn)===Bt&&(ir=new ir(Lt,xt+"enter",Yn,P,wn),ir.target=zt,ir.relatedTarget=Wi,Ln=ir),Wi=Ln,Un&&Yn)t:{for(ir=Un,Lt=Yn,xt=0,zt=ir;zt;zt=Fa(zt))xt++;for(zt=0,Ln=Lt;Ln;Ln=Fa(Ln))zt++;for(;0<xt-zt;)ir=Fa(ir),xt--;for(;0<zt-xt;)Lt=Fa(Lt),zt--;for(;xt--;){if(ir===Lt||Lt!==null&&ir===Lt.alternate)break t;ir=Fa(ir),Lt=Fa(Lt)}ir=null}else ir=null;Un!==null&&Qh(Cn,xn,Un,ir,!1),Yn!==null&&Wi!==null&&Qh(Cn,Wi,Yn,ir,!0)}}e:{if(xn=Bt?Ba(Bt):window,Un=xn.nodeName&&xn.nodeName.toLowerCase(),Un==="select"||Un==="input"&&xn.type==="file")var cr=ug;else if(lf(xn))if(Dp)cr=hg;else{cr=Op;var fr=zp}else(Un=xn.nodeName)&&Un.toLowerCase()==="input"&&(xn.type==="checkbox"||xn.type==="radio")&&(cr=Fp);if(cr&&(cr=cr(f,Bt))){Uc(Cn,cr,P,wn);break e}fr&&fr(f,xn,Bt),f==="focusout"&&(fr=xn._wrapperState)&&fr.controlled&&xn.type==="number"&&On(xn,"number",xn.value)}switch(fr=Bt?Ba(Bt):window,f){case"focusin":(lf(fr)||fr.contentEditable==="true")&&(dl=fr,ku=Bt,tc=null);break;case"focusout":tc=ku=dl=null;break;case"mousedown":Zh=!0;break;case"contextmenu":case"mouseup":case"dragend":Zh=!1,nc(Cn,P,wn);break;case"selectionchange":if(gg)break;case"keydown":case"keyup":nc(Cn,P,wn)}var pr;if(Jl)e:{switch(f){case"compositionstart":var gr="onCompositionStart";break e;case"compositionend":gr="onCompositionEnd";break e;case"compositionupdate":gr="onCompositionUpdate";break e}gr=void 0}else Ql?Rp(f,P)&&(gr="onCompositionEnd"):f==="keydown"&&P.keyCode===229&&(gr="onCompositionStart");gr&&(lg&&P.locale!=="ko"&&(Ql||gr!=="onCompositionStart"?gr==="onCompositionEnd"&&Ql&&(pr=Qs()):(cl=wn,Fc="value"in cl?cl.value:cl.textContent,Ql=!0)),fr=Hc(Bt,gr),0<fr.length&&(gr=new ig(gr,f,null,P,wn),Cn.push({event:gr,listeners:fr}),pr?gr.data=pr:(pr=Lp(P),pr!==null&&(gr.data=pr)))),(pr=ag?kp(f,P):Bc(f,P))&&(Bt=Hc(Bt,"onBeforeInput"),0<Bt.length&&(wn=new ig("onBeforeInput","beforeinput",null,P,wn),Cn.push({event:wn,listeners:Bt}),wn.data=pr))}jp(Cn,v)})}function ac(f,v,P){return{instance:f,listener:v,currentTarget:P}}function Hc(f,v){for(var P=v+"Capture",O=[];f!==null;){var W=f,Q=W.stateNode;W.tag===5&&Q!==null&&(W=Q,Q=mt(f,P),Q!=null&&O.unshift(ac(f,Q,W)),Q=mt(f,v),Q!=null&&O.push(ac(f,Q,W))),f=f.return}return O}function Fa(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5);return f||null}function Qh(f,v,P,O,W){for(var Q=v._reactName,be=[];P!==null&&P!==O;){var st=P,gt=st.alternate,Bt=st.stateNode;if(gt!==null&&gt===O)break;st.tag===5&&Bt!==null&&(st=Bt,W?(gt=mt(P,Q),gt!=null&&be.unshift(ac(P,gt,st))):W||(gt=mt(P,Q),gt!=null&&be.push(ac(P,gt,st)))),P=P.return}be.length!==0&&f.push({event:v,listeners:be})}var Wp=/\r\n?/g,ed=/\u0000|\uFFFD/g;function Gc(f){return(typeof f=="string"?f:""+f).replace(Wp,`
`).replace(ed,"")}function pl(f,v,P){if(v=Gc(v),Gc(f)!==v&&P)throw Error(n(425))}function lc(){}var td=null,Na=null;function qp(f,v){return f==="textarea"||f==="noscript"||typeof v.children=="string"||typeof v.children=="number"||typeof v.dangerouslySetInnerHTML=="object"&&v.dangerouslySetInnerHTML!==null&&v.dangerouslySetInnerHTML.__html!=null}var ff=typeof setTimeout=="function"?setTimeout:void 0,pf=typeof clearTimeout=="function"?clearTimeout:void 0,mf=typeof Promise=="function"?Promise:void 0,vg=typeof queueMicrotask=="function"?queueMicrotask:typeof mf<"u"?function(f){return mf.resolve(null).then(f).catch(yg)}:ff;function yg(f){setTimeout(function(){throw f})}function Wc(f,v){var P=v,O=0;do{var W=P.nextSibling;if(f.removeChild(P),W&&W.nodeType===8)if(P=W.data,P==="/$"){if(O===0){f.removeChild(W),da(v);return}O--}else P!=="$"&&P!=="$?"&&P!=="$!"||O++;P=W}while(P);da(v)}function ma(f){for(;f!=null;f=f.nextSibling){var v=f.nodeType;if(v===1||v===3)break;if(v===8){if(v=f.data,v==="$"||v==="$!"||v==="$?")break;if(v==="/$")return null}}return f}function nd(f){f=f.previousSibling;for(var v=0;f;){if(f.nodeType===8){var P=f.data;if(P==="$"||P==="$!"||P==="$?"){if(v===0)return f;v--}else P==="/$"&&v++}f=f.previousSibling}return null}var qc=Math.random().toString(36).slice(2),Yr="__reactFiber$"+qc,ea="__reactProps$"+qc,Yi="__reactContainer$"+qc,Fu="__reactEvents$"+qc,rd="__reactListeners$"+qc,Nu="__reactHandles$"+qc;function ta(f){var v=f[Yr];if(v)return v;for(var P=f.parentNode;P;){if(v=P[Yi]||P[Yr]){if(P=v.alternate,v.child!==null||P!==null&&P.child!==null)for(f=nd(f);f!==null;){if(P=f[Yr])return P;f=nd(f)}return v}f=P,P=f.parentNode}return null}function Xc(f){return f=f[Yr]||f[Yi],!f||f.tag!==5&&f.tag!==6&&f.tag!==13&&f.tag!==3?null:f}function Ba(f){if(f.tag===5||f.tag===6)return f.stateNode;throw Error(n(33))}function Bu(f){return f[ea]||null}var gf=[],Zc=-1;function ks(f){return{current:f}}function ri(f){0>Zc||(f.current=gf[Zc],gf[Zc]=null,Zc--)}function Pr(f,v){Zc++,gf[Zc]=f.current,f.current=v}var po={},mo=ks(po),rs=ks(!1),cc=po;function ga(f,v){var P=f.type.contextTypes;if(!P)return po;var O=f.stateNode;if(O&&O.__reactInternalMemoizedUnmaskedChildContext===v)return O.__reactInternalMemoizedMaskedChildContext;var W={},Q;for(Q in P)W[Q]=v[Q];return O&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=v,f.__reactInternalMemoizedMaskedChildContext=W),W}function $o(f){return f=f.childContextTypes,f!=null}function Yc(){ri(rs),ri(mo)}function Xp(f,v,P){if(mo.current!==po)throw Error(n(168));Pr(mo,v),Pr(rs,P)}function id(f,v,P){var O=f.stateNode;if(v=v.childContextTypes,typeof O.getChildContext!="function")return P;O=O.getChildContext();for(var W in O)if(!(W in v))throw Error(n(108,ut(f)||"Unknown",W));return rt({},P,O)}function Kc(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||po,cc=mo.current,Pr(mo,f),Pr(rs,rs.current),!0}function Jc(f,v,P){var O=f.stateNode;if(!O)throw Error(n(169));P?(f=id(f,v,cc),O.__reactInternalMemoizedMergedChildContext=f,ri(rs),ri(mo),Pr(mo,f)):ri(rs),Pr(rs,P)}var Ki=null,ys=!1,vf=!1;function Vo(f){Ki===null?Ki=[f]:Ki.push(f)}function Uu(f){ys=!0,Vo(f)}function uc(){if(!vf&&Ki!==null){vf=!0;var f=0,v=Nr;try{var P=Ki;for(Nr=1;f<P.length;f++){var O=P[f];do O=O(!0);while(O!==null)}Ki=null,ys=!1}catch(W){throw Ki!==null&&(Ki=Ki.slice(f+1)),xr(pn,uc),W}finally{Nr=v,vf=!1}}return null}var ml=[],$u=0,Vu=null,hc=0,Ao=[],Hi=0,zn=null,va=1,Ds="";function gl(f,v){ml[$u++]=hc,ml[$u++]=Vu,Vu=f,hc=v}function ju(f,v,P){Ao[Hi++]=va,Ao[Hi++]=Ds,Ao[Hi++]=zn,zn=f;var O=va;f=Ds;var W=32-tr(O)-1;O&=~(1<<W),P+=1;var Q=32-tr(v)+W;if(30<Q){var be=W-W%5;Q=(O&(1<<be)-1).toString(32),O>>=be,W-=be,va=1<<32-tr(v)+W|P<<W|O,Ds=Q+f}else va=1<<Q|P<<W|O,Ds=f}function dc(f){f.return!==null&&(gl(f,1),ju(f,1,0))}function od(f){for(;f===Vu;)Vu=ml[--$u],ml[$u]=null,hc=ml[--$u],ml[$u]=null;for(;f===zn;)zn=Ao[--Hi],Ao[Hi]=null,Ds=Ao[--Hi],Ao[Hi]=null,va=Ao[--Hi],Ao[Hi]=null}var dr=null,is=null,Mi=!1,_s=null;function _g(f,v){var P=Ga(5,null,null,0);P.elementType="DELETED",P.stateNode=v,P.return=f,v=f.deletions,v===null?(f.deletions=[P],f.flags|=16):v.push(P)}function xg(f,v){switch(f.tag){case 5:var P=f.type;return v=v.nodeType!==1||P.toLowerCase()!==v.nodeName.toLowerCase()?null:v,v!==null?(f.stateNode=v,dr=f,is=ma(v.firstChild),!0):!1;case 6:return v=f.pendingProps===""||v.nodeType!==3?null:v,v!==null?(f.stateNode=v,dr=f,is=null,!0):!1;case 13:return v=v.nodeType!==8?null:v,v!==null?(P=zn!==null?{id:va,overflow:Ds}:null,f.memoizedState={dehydrated:v,treeContext:P,retryLane:1073741824},P=Ga(18,null,null,0),P.stateNode=v,P.return=f,f.child=P,dr=f,is=null,!0):!1;default:return!1}}function sd(f){return(f.mode&1)!==0&&(f.flags&128)===0}function Hu(f){if(Mi){var v=is;if(v){var P=v;if(!xg(f,v)){if(sd(f))throw Error(n(418));v=ma(P.nextSibling);var O=dr;v&&xg(f,v)?_g(O,P):(f.flags=f.flags&-4097|2,Mi=!1,dr=f)}}else{if(sd(f))throw Error(n(418));f.flags=f.flags&-4097|2,Mi=!1,dr=f}}}function yf(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;dr=f}function ad(f){if(f!==dr)return!1;if(!Mi)return yf(f),Mi=!0,!1;var v;if((v=f.tag!==3)&&!(v=f.tag!==5)&&(v=f.type,v=v!=="head"&&v!=="body"&&!qp(f.type,f.memoizedProps)),v&&(v=is)){if(sd(f))throw Gu(),Error(n(418));for(;v;)_g(f,v),v=ma(v.nextSibling)}if(yf(f),f.tag===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(n(317));e:{for(f=f.nextSibling,v=0;f;){if(f.nodeType===8){var P=f.data;if(P==="/$"){if(v===0){is=ma(f.nextSibling);break e}v--}else P!=="$"&&P!=="$!"&&P!=="$?"||v++}f=f.nextSibling}is=null}}else is=dr?ma(f.stateNode.nextSibling):null;return!0}function Gu(){for(var f=is;f;)f=ma(f.nextSibling)}function Wu(){is=dr=null,Mi=!1}function ld(f){_s===null?_s=[f]:_s.push(f)}var fc=H.ReactCurrentBatchConfig;function si(f,v,P){if(f=P.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(P._owner){if(P=P._owner,P){if(P.tag!==1)throw Error(n(309));var O=P.stateNode}if(!O)throw Error(n(147,f));var W=O,Q=""+f;return v!==null&&v.ref!==null&&typeof v.ref=="function"&&v.ref._stringRef===Q?v.ref:(v=function(be){var st=W.refs;be===null?delete st[Q]:st[Q]=be},v._stringRef=Q,v)}if(typeof f!="string")throw Error(n(284));if(!P._owner)throw Error(n(290,f))}return f}function pc(f,v){throw f=Object.prototype.toString.call(v),Error(n(31,f==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":f))}function cd(f){var v=f._init;return v(f._payload)}function _f(f){function v(Lt,xt){if(f){var zt=Lt.deletions;zt===null?(Lt.deletions=[xt],Lt.flags|=16):zt.push(xt)}}function P(Lt,xt){if(!f)return null;for(;xt!==null;)v(Lt,xt),xt=xt.sibling;return null}function O(Lt,xt){for(Lt=new Map;xt!==null;)xt.key!==null?Lt.set(xt.key,xt):Lt.set(xt.index,xt),xt=xt.sibling;return Lt}function W(Lt,xt){return Lt=iu(Lt,xt),Lt.index=0,Lt.sibling=null,Lt}function Q(Lt,xt,zt){return Lt.index=zt,f?(zt=Lt.alternate,zt!==null?(zt=zt.index,zt<xt?(Lt.flags|=2,xt):zt):(Lt.flags|=2,xt)):(Lt.flags|=1048576,xt)}function be(Lt){return f&&Lt.alternate===null&&(Lt.flags|=2),Lt}function st(Lt,xt,zt,Ln){return xt===null||xt.tag!==6?(xt=Fg(zt,Lt.mode,Ln),xt.return=Lt,xt):(xt=W(xt,zt),xt.return=Lt,xt)}function gt(Lt,xt,zt,Ln){var cr=zt.type;return cr===ee?wn(Lt,xt,zt.props.children,Ln,zt.key):xt!==null&&(xt.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Me&&cd(cr)===xt.type)?(Ln=W(xt,zt.props),Ln.ref=si(Lt,xt,zt),Ln.return=Lt,Ln):(Ln=Og(zt.type,zt.key,zt.props,null,Lt.mode,Ln),Ln.ref=si(Lt,xt,zt),Ln.return=Lt,Ln)}function Bt(Lt,xt,zt,Ln){return xt===null||xt.tag!==4||xt.stateNode.containerInfo!==zt.containerInfo||xt.stateNode.implementation!==zt.implementation?(xt=am(zt,Lt.mode,Ln),xt.return=Lt,xt):(xt=W(xt,zt.children||[]),xt.return=Lt,xt)}function wn(Lt,xt,zt,Ln,cr){return xt===null||xt.tag!==7?(xt=Ed(zt,Lt.mode,Ln,cr),xt.return=Lt,xt):(xt=W(xt,zt),xt.return=Lt,xt)}function Cn(Lt,xt,zt){if(typeof xt=="string"&&xt!==""||typeof xt=="number")return xt=Fg(""+xt,Lt.mode,zt),xt.return=Lt,xt;if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case q:return zt=Og(xt.type,xt.key,xt.props,null,Lt.mode,zt),zt.ref=si(Lt,null,xt),zt.return=Lt,zt;case X:return xt=am(xt,Lt.mode,zt),xt.return=Lt,xt;case Me:var Ln=xt._init;return Cn(Lt,Ln(xt._payload),zt)}if(vn(xt)||Ze(xt))return xt=Ed(xt,Lt.mode,zt,null),xt.return=Lt,xt;pc(Lt,xt)}return null}function xn(Lt,xt,zt,Ln){var cr=xt!==null?xt.key:null;if(typeof zt=="string"&&zt!==""||typeof zt=="number")return cr!==null?null:st(Lt,xt,""+zt,Ln);if(typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case q:return zt.key===cr?gt(Lt,xt,zt,Ln):null;case X:return zt.key===cr?Bt(Lt,xt,zt,Ln):null;case Me:return cr=zt._init,xn(Lt,xt,cr(zt._payload),Ln)}if(vn(zt)||Ze(zt))return cr!==null?null:wn(Lt,xt,zt,Ln,null);pc(Lt,zt)}return null}function Un(Lt,xt,zt,Ln,cr){if(typeof Ln=="string"&&Ln!==""||typeof Ln=="number")return Lt=Lt.get(zt)||null,st(xt,Lt,""+Ln,cr);if(typeof Ln=="object"&&Ln!==null){switch(Ln.$$typeof){case q:return Lt=Lt.get(Ln.key===null?zt:Ln.key)||null,gt(xt,Lt,Ln,cr);case X:return Lt=Lt.get(Ln.key===null?zt:Ln.key)||null,Bt(xt,Lt,Ln,cr);case Me:var fr=Ln._init;return Un(Lt,xt,zt,fr(Ln._payload),cr)}if(vn(Ln)||Ze(Ln))return Lt=Lt.get(zt)||null,wn(xt,Lt,Ln,cr,null);pc(xt,Ln)}return null}function Yn(Lt,xt,zt,Ln){for(var cr=null,fr=null,pr=xt,gr=xt=0,Io=null;pr!==null&&gr<zt.length;gr++){pr.index>gr?(Io=pr,pr=null):Io=pr.sibling;var ni=xn(Lt,pr,zt[gr],Ln);if(ni===null){pr===null&&(pr=Io);break}f&&pr&&ni.alternate===null&&v(Lt,pr),xt=Q(ni,xt,gr),fr===null?cr=ni:fr.sibling=ni,fr=ni,pr=Io}if(gr===zt.length)return P(Lt,pr),Mi&&gl(Lt,gr),cr;if(pr===null){for(;gr<zt.length;gr++)pr=Cn(Lt,zt[gr],Ln),pr!==null&&(xt=Q(pr,xt,gr),fr===null?cr=pr:fr.sibling=pr,fr=pr);return Mi&&gl(Lt,gr),cr}for(pr=O(Lt,pr);gr<zt.length;gr++)Io=Un(pr,Lt,gr,zt[gr],Ln),Io!==null&&(f&&Io.alternate!==null&&pr.delete(Io.key===null?gr:Io.key),xt=Q(Io,xt,gr),fr===null?cr=Io:fr.sibling=Io,fr=Io);return f&&pr.forEach(function(bc){return v(Lt,bc)}),Mi&&gl(Lt,gr),cr}function ir(Lt,xt,zt,Ln){var cr=Ze(zt);if(typeof cr!="function")throw Error(n(150));if(zt=cr.call(zt),zt==null)throw Error(n(151));for(var fr=cr=null,pr=xt,gr=xt=0,Io=null,ni=zt.next();pr!==null&&!ni.done;gr++,ni=zt.next()){pr.index>gr?(Io=pr,pr=null):Io=pr.sibling;var bc=xn(Lt,pr,ni.value,Ln);if(bc===null){pr===null&&(pr=Io);break}f&&pr&&bc.alternate===null&&v(Lt,pr),xt=Q(bc,xt,gr),fr===null?cr=bc:fr.sibling=bc,fr=bc,pr=Io}if(ni.done)return P(Lt,pr),Mi&&gl(Lt,gr),cr;if(pr===null){for(;!ni.done;gr++,ni=zt.next())ni=Cn(Lt,ni.value,Ln),ni!==null&&(xt=Q(ni,xt,gr),fr===null?cr=ni:fr.sibling=ni,fr=ni);return Mi&&gl(Lt,gr),cr}for(pr=O(Lt,pr);!ni.done;gr++,ni=zt.next())ni=Un(pr,Lt,gr,ni.value,Ln),ni!==null&&(f&&ni.alternate!==null&&pr.delete(ni.key===null?gr:ni.key),xt=Q(ni,xt,gr),fr===null?cr=ni:fr.sibling=ni,fr=ni);return f&&pr.forEach(function(Yx){return v(Lt,Yx)}),Mi&&gl(Lt,gr),cr}function Wi(Lt,xt,zt,Ln){if(typeof zt=="object"&&zt!==null&&zt.type===ee&&zt.key===null&&(zt=zt.props.children),typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case q:e:{for(var cr=zt.key,fr=xt;fr!==null;){if(fr.key===cr){if(cr=zt.type,cr===ee){if(fr.tag===7){P(Lt,fr.sibling),xt=W(fr,zt.props.children),xt.return=Lt,Lt=xt;break e}}else if(fr.elementType===cr||typeof cr=="object"&&cr!==null&&cr.$$typeof===Me&&cd(cr)===fr.type){P(Lt,fr.sibling),xt=W(fr,zt.props),xt.ref=si(Lt,fr,zt),xt.return=Lt,Lt=xt;break e}P(Lt,fr);break}else v(Lt,fr);fr=fr.sibling}zt.type===ee?(xt=Ed(zt.props.children,Lt.mode,Ln,zt.key),xt.return=Lt,Lt=xt):(Ln=Og(zt.type,zt.key,zt.props,null,Lt.mode,Ln),Ln.ref=si(Lt,xt,zt),Ln.return=Lt,Lt=Ln)}return be(Lt);case X:e:{for(fr=zt.key;xt!==null;){if(xt.key===fr)if(xt.tag===4&&xt.stateNode.containerInfo===zt.containerInfo&&xt.stateNode.implementation===zt.implementation){P(Lt,xt.sibling),xt=W(xt,zt.children||[]),xt.return=Lt,Lt=xt;break e}else{P(Lt,xt);break}else v(Lt,xt);xt=xt.sibling}xt=am(zt,Lt.mode,Ln),xt.return=Lt,Lt=xt}return be(Lt);case Me:return fr=zt._init,Wi(Lt,xt,fr(zt._payload),Ln)}if(vn(zt))return Yn(Lt,xt,zt,Ln);if(Ze(zt))return ir(Lt,xt,zt,Ln);pc(Lt,zt)}return typeof zt=="string"&&zt!==""||typeof zt=="number"?(zt=""+zt,xt!==null&&xt.tag===6?(P(Lt,xt.sibling),xt=W(xt,zt),xt.return=Lt,Lt=xt):(P(Lt,xt),xt=Fg(zt,Lt.mode,Ln),xt.return=Lt,Lt=xt),be(Lt)):P(Lt,xt)}return Wi}var Qc=_f(!0),Zp=_f(!1),xf=ks(null),zs=null,vl=null,$n=null;function ar(){$n=vl=zs=null}function qu(f){var v=xf.current;ri(xf),f._currentValue=v}function ud(f,v,P){for(;f!==null;){var O=f.alternate;if((f.childLanes&v)!==v?(f.childLanes|=v,O!==null&&(O.childLanes|=v)):O!==null&&(O.childLanes&v)!==v&&(O.childLanes|=v),f===P)break;f=f.return}}function Ua(f,v){zs=f,$n=vl=null,f=f.dependencies,f!==null&&f.firstContext!==null&&((f.lanes&v)!==0&&(Bs=!0),f.firstContext=null)}function vi(f){var v=f._currentValue;if($n!==f)if(f={context:f,memoizedValue:v,next:null},vl===null){if(zs===null)throw Error(n(308));vl=f,zs.dependencies={lanes:0,firstContext:f}}else vl=vl.next=f;return v}var mc=null;function oo(f){mc===null?mc=[f]:mc.push(f)}function Yp(f,v,P,O){var W=v.interleaved;return W===null?(P.next=P,oo(v)):(P.next=W.next,W.next=P),v.interleaved=P,os(f,O)}function os(f,v){f.lanes|=v;var P=f.alternate;for(P!==null&&(P.lanes|=v),P=f,f=f.return;f!==null;)f.childLanes|=v,P=f.alternate,P!==null&&(P.childLanes|=v),P=f,f=f.return;return P.tag===3?P.stateNode:null}var ei=!1;function Ci(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Kp(f,v){f=f.updateQueue,v.updateQueue===f&&(v.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function jo(f,v){return{eventTime:f,lane:v,tag:0,payload:null,callback:null,next:null}}function ss(f,v,P){var O=f.updateQueue;if(O===null)return null;if(O=O.shared,(Jr&2)!==0){var W=O.pending;return W===null?v.next=v:(v.next=W.next,W.next=v),O.pending=v,os(f,P)}return W=O.interleaved,W===null?(v.next=v,oo(O)):(v.next=W.next,W.next=v),O.interleaved=v,os(f,P)}function Xu(f,v,P){if(v=v.updateQueue,v!==null&&(v=v.shared,(P&4194240)!==0)){var O=v.lanes;O&=f.pendingLanes,P|=O,v.lanes=P,Vi(f,P)}}function hd(f,v){var P=f.updateQueue,O=f.alternate;if(O!==null&&(O=O.updateQueue,P===O)){var W=null,Q=null;if(P=P.firstBaseUpdate,P!==null){do{var be={eventTime:P.eventTime,lane:P.lane,tag:P.tag,payload:P.payload,callback:P.callback,next:null};Q===null?W=Q=be:Q=Q.next=be,P=P.next}while(P!==null);Q===null?W=Q=v:Q=Q.next=v}else W=Q=v;P={baseState:O.baseState,firstBaseUpdate:W,lastBaseUpdate:Q,shared:O.shared,effects:O.effects},f.updateQueue=P;return}f=P.lastBaseUpdate,f===null?P.firstBaseUpdate=v:f.next=v,P.lastBaseUpdate=v}function $a(f,v,P,O){var W=f.updateQueue;ei=!1;var Q=W.firstBaseUpdate,be=W.lastBaseUpdate,st=W.shared.pending;if(st!==null){W.shared.pending=null;var gt=st,Bt=gt.next;gt.next=null,be===null?Q=Bt:be.next=Bt,be=gt;var wn=f.alternate;wn!==null&&(wn=wn.updateQueue,st=wn.lastBaseUpdate,st!==be&&(st===null?wn.firstBaseUpdate=Bt:st.next=Bt,wn.lastBaseUpdate=gt))}if(Q!==null){var Cn=W.baseState;be=0,wn=Bt=gt=null,st=Q;do{var xn=st.lane,Un=st.eventTime;if((O&xn)===xn){wn!==null&&(wn=wn.next={eventTime:Un,lane:0,tag:st.tag,payload:st.payload,callback:st.callback,next:null});e:{var Yn=f,ir=st;switch(xn=v,Un=P,ir.tag){case 1:if(Yn=ir.payload,typeof Yn=="function"){Cn=Yn.call(Un,Cn,xn);break e}Cn=Yn;break e;case 3:Yn.flags=Yn.flags&-65537|128;case 0:if(Yn=ir.payload,xn=typeof Yn=="function"?Yn.call(Un,Cn,xn):Yn,xn==null)break e;Cn=rt({},Cn,xn);break e;case 2:ei=!0}}st.callback!==null&&st.lane!==0&&(f.flags|=64,xn=W.effects,xn===null?W.effects=[st]:xn.push(st))}else Un={eventTime:Un,lane:xn,tag:st.tag,payload:st.payload,callback:st.callback,next:null},wn===null?(Bt=wn=Un,gt=Cn):wn=wn.next=Un,be|=xn;if(st=st.next,st===null){if(st=W.shared.pending,st===null)break;xn=st,st=xn.next,xn.next=null,W.lastBaseUpdate=xn,W.shared.pending=null}}while(!0);if(wn===null&&(gt=Cn),W.baseState=gt,W.firstBaseUpdate=Bt,W.lastBaseUpdate=wn,v=W.shared.interleaved,v!==null){W=v;do be|=W.lane,W=W.next;while(W!==v)}else Q===null&&(W.shared.lanes=0);ih|=be,f.lanes=be,f.memoizedState=Cn}}function Zu(f,v,P){if(f=v.effects,v.effects=null,f!==null)for(v=0;v<f.length;v++){var O=f[v],W=O.callback;if(W!==null){if(O.callback=null,O=P,typeof W!="function")throw Error(n(191,W));W.call(O)}}}var eu={},Os=ks(eu),tu=ks(eu),C=ks(eu);function o(f){if(f===eu)throw Error(n(174));return f}function u(f,v){switch(Pr(C,v),Pr(tu,f),Pr(Os,eu),f=v.nodeType,f){case 9:case 11:v=(v=v.documentElement)?v.namespaceURI:un(null,"");break;default:f=f===8?v.parentNode:v,v=f.namespaceURI||null,f=f.tagName,v=un(v,f)}ri(Os),Pr(Os,v)}function g(){ri(Os),ri(tu),ri(C)}function x(f){o(C.current);var v=o(Os.current),P=un(v,f.type);v!==P&&(Pr(tu,f),Pr(Os,P))}function E(f){tu.current===f&&(ri(Os),ri(tu))}var k=ks(0);function F(f){for(var v=f;v!==null;){if(v.tag===13){var P=v.memoizedState;if(P!==null&&(P=P.dehydrated,P===null||P.data==="$?"||P.data==="$!"))return v}else if(v.tag===19&&v.memoizedProps.revealOrder!==void 0){if((v.flags&128)!==0)return v}else if(v.child!==null){v.child.return=v,v=v.child;continue}if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return null;v=v.return}v.sibling.return=v.return,v=v.sibling}return null}var U=[];function Z(){for(var f=0;f<U.length;f++)U[f]._workInProgressVersionPrimary=null;U.length=0}var K=H.ReactCurrentDispatcher,oe=H.ReactCurrentBatchConfig,re=0,ce=null,ve=null,Le=null,ze=!1,Ne=!1,Ge=0,et=0;function Xe(){throw Error(n(321))}function at(f,v){if(v===null)return!1;for(var P=0;P<v.length&&P<f.length;P++)if(!Po(f[P],v[P]))return!1;return!0}function ht(f,v,P,O,W,Q){if(re=Q,ce=v,v.memoizedState=null,v.updateQueue=null,v.lanes=0,K.current=f===null||f.memoizedState===null?ao:bg,f=P(O,W),Ne){Q=0;do{if(Ne=!1,Ge=0,25<=Q)throw Error(n(301));Q+=1,Le=ve=null,v.updateQueue=null,K.current=Py,f=P(O,W)}while(Ne)}if(K.current=yo,v=ve!==null&&ve.next!==null,re=0,Le=ve=ce=null,ze=!1,v)throw Error(n(300));return f}function Ye(){var f=Ge!==0;return Ge=0,f}function pt(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Le===null?ce.memoizedState=Le=f:Le=Le.next=f,Le}function Pt(){if(ve===null){var f=ce.alternate;f=f!==null?f.memoizedState:null}else f=ve.next;var v=Le===null?ce.memoizedState:Le.next;if(v!==null)Le=v,ve=f;else{if(f===null)throw Error(n(310));ve=f,f={memoizedState:ve.memoizedState,baseState:ve.baseState,baseQueue:ve.baseQueue,queue:ve.queue,next:null},Le===null?ce.memoizedState=Le=f:Le=Le.next=f}return Le}function Mt(f,v){return typeof v=="function"?v(f):v}function Tt(f){var v=Pt(),P=v.queue;if(P===null)throw Error(n(311));P.lastRenderedReducer=f;var O=ve,W=O.baseQueue,Q=P.pending;if(Q!==null){if(W!==null){var be=W.next;W.next=Q.next,Q.next=be}O.baseQueue=W=Q,P.pending=null}if(W!==null){Q=W.next,O=O.baseState;var st=be=null,gt=null,Bt=Q;do{var wn=Bt.lane;if((re&wn)===wn)gt!==null&&(gt=gt.next={lane:0,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null}),O=Bt.hasEagerState?Bt.eagerState:f(O,Bt.action);else{var Cn={lane:wn,action:Bt.action,hasEagerState:Bt.hasEagerState,eagerState:Bt.eagerState,next:null};gt===null?(st=gt=Cn,be=O):gt=gt.next=Cn,ce.lanes|=wn,ih|=wn}Bt=Bt.next}while(Bt!==null&&Bt!==Q);gt===null?be=O:gt.next=st,Po(O,v.memoizedState)||(Bs=!0),v.memoizedState=O,v.baseState=be,v.baseQueue=gt,P.lastRenderedState=O}if(f=P.interleaved,f!==null){W=f;do Q=W.lane,ce.lanes|=Q,ih|=Q,W=W.next;while(W!==f)}else W===null&&(P.lanes=0);return[v.memoizedState,P.dispatch]}function kt(f){var v=Pt(),P=v.queue;if(P===null)throw Error(n(311));P.lastRenderedReducer=f;var O=P.dispatch,W=P.pending,Q=v.memoizedState;if(W!==null){P.pending=null;var be=W=W.next;do Q=f(Q,be.action),be=be.next;while(be!==W);Po(Q,v.memoizedState)||(Bs=!0),v.memoizedState=Q,v.baseQueue===null&&(v.baseState=Q),P.lastRenderedState=Q}return[Q,O]}function Mn(){}function Sn(f,v){var P=ce,O=Pt(),W=v(),Q=!Po(O.memoizedState,W);if(Q&&(O.memoizedState=W,Bs=!0),O=O.queue,Ar(br.bind(null,P,O,f),[f]),O.getSnapshot!==v||Q||Le!==null&&Le.memoizedState.tag&1){if(P.flags|=2048,ci(9,Vn.bind(null,P,O,W,v),void 0,null),Ji===null)throw Error(n(349));(re&30)!==0||rn(P,v,W)}return W}function rn(f,v,P){f.flags|=16384,f={getSnapshot:v,value:P},v=ce.updateQueue,v===null?(v={lastEffect:null,stores:null},ce.updateQueue=v,v.stores=[f]):(P=v.stores,P===null?v.stores=[f]:P.push(f))}function Vn(f,v,P,O){v.value=P,v.getSnapshot=O,Hr(v)&&Ei(f)}function br(f,v,P){return P(function(){Hr(v)&&Ei(f)})}function Hr(f){var v=f.getSnapshot;f=f.value;try{var P=v();return!Po(f,P)}catch{return!0}}function Ei(f){var v=os(f,1);v!==null&&na(v,f,1,-1)}function ii(f){var v=pt();return typeof f=="function"&&(f=f()),v.memoizedState=v.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mt,lastRenderedState:f},v.queue=f,f=f.dispatch=gc.bind(null,ce,f),[v.memoizedState,f]}function ci(f,v,P,O){return f={tag:f,create:v,destroy:P,deps:O,next:null},v=ce.updateQueue,v===null?(v={lastEffect:null,stores:null},ce.updateQueue=v,v.lastEffect=f.next=f):(P=v.lastEffect,P===null?v.lastEffect=f.next=f:(O=P.next,P.next=f,f.next=O,v.lastEffect=f)),f}function ai(){return Pt().memoizedState}function Kr(f,v,P,O){var W=pt();ce.flags|=f,W.memoizedState=ci(1|v,P,void 0,O===void 0?null:O)}function ti(f,v,P,O){var W=Pt();O=O===void 0?null:O;var Q=void 0;if(ve!==null){var be=ve.memoizedState;if(Q=be.destroy,O!==null&&at(O,be.deps)){W.memoizedState=ci(v,P,Q,O);return}}ce.flags|=f,W.memoizedState=ci(1|v,P,Q,O)}function go(f,v){return Kr(8390656,8,f,v)}function Ar(f,v){return ti(2048,8,f,v)}function so(f,v){return ti(4,2,f,v)}function vo(f,v){return ti(4,4,f,v)}function yl(f,v){if(typeof v=="function")return f=f(),v(f),function(){v(null)};if(v!=null)return f=f(),v.current=f,function(){v.current=null}}function _l(f,v,P){return P=P!=null?P.concat([f]):null,ti(4,4,yl.bind(null,v,f),P)}function Va(){}function ya(f,v){var P=Pt();v=v===void 0?null:v;var O=P.memoizedState;return O!==null&&v!==null&&at(v,O[1])?O[0]:(P.memoizedState=[f,v],f)}function Yu(f,v){var P=Pt();v=v===void 0?null:v;var O=P.memoizedState;return O!==null&&v!==null&&at(v,O[1])?O[0]:(f=f(),P.memoizedState=[f,v],f)}function Ku(f,v,P){return(re&21)===0?(f.baseState&&(f.baseState=!1,Bs=!0),f.memoizedState=P):(Po(P,v)||(P=Zr(),ce.lanes|=P,ih|=P,f.baseState=!0),v)}function Ju(f,v){var P=Nr;Nr=P!==0&&4>P?P:4,f(!0);var O=oe.transition;oe.transition={};try{f(!1),v()}finally{Nr=P,oe.transition=O}}function as(){return Pt().memoizedState}function _a(f,v,P){var O=ru(f);if(P={lane:O,action:P,hasEagerState:!1,eagerState:null,next:null},vc(f))zi(v,P);else if(P=Yp(f,v,P,O),P!==null){var W=Ss();na(P,f,O,W),hi(P,v,O)}}function gc(f,v,P){var O=ru(f),W={lane:O,action:P,hasEagerState:!1,eagerState:null,next:null};if(vc(f))zi(v,W);else{var Q=f.alternate;if(f.lanes===0&&(Q===null||Q.lanes===0)&&(Q=v.lastRenderedReducer,Q!==null))try{var be=v.lastRenderedState,st=Q(be,P);if(W.hasEagerState=!0,W.eagerState=st,Po(st,be)){var gt=v.interleaved;gt===null?(W.next=W,oo(v)):(W.next=gt.next,gt.next=W),v.interleaved=W;return}}catch{}finally{}P=Yp(f,v,W,O),P!==null&&(W=Ss(),na(P,f,O,W),hi(P,v,O))}}function vc(f){var v=f.alternate;return f===ce||v!==null&&v===ce}function zi(f,v){Ne=ze=!0;var P=f.pending;P===null?v.next=v:(v.next=P.next,P.next=v),f.pending=v}function hi(f,v,P){if((P&4194240)!==0){var O=v.lanes;O&=f.pendingLanes,P|=O,v.lanes=P,Vi(f,P)}}var yo={readContext:vi,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useInsertionEffect:Xe,useLayoutEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useMutableSource:Xe,useSyncExternalStore:Xe,useId:Xe,unstable_isNewReconciler:!1},ao={readContext:vi,useCallback:function(f,v){return pt().memoizedState=[f,v===void 0?null:v],f},useContext:vi,useEffect:go,useImperativeHandle:function(f,v,P){return P=P!=null?P.concat([f]):null,Kr(4194308,4,yl.bind(null,v,f),P)},useLayoutEffect:function(f,v){return Kr(4194308,4,f,v)},useInsertionEffect:function(f,v){return Kr(4,2,f,v)},useMemo:function(f,v){var P=pt();return v=v===void 0?null:v,f=f(),P.memoizedState=[f,v],f},useReducer:function(f,v,P){var O=pt();return v=P!==void 0?P(v):v,O.memoizedState=O.baseState=v,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:v},O.queue=f,f=f.dispatch=_a.bind(null,ce,f),[O.memoizedState,f]},useRef:function(f){var v=pt();return f={current:f},v.memoizedState=f},useState:ii,useDebugValue:Va,useDeferredValue:function(f){return pt().memoizedState=f},useTransition:function(){var f=ii(!1),v=f[0];return f=Ju.bind(null,f[1]),pt().memoizedState=f,[v,f]},useMutableSource:function(){},useSyncExternalStore:function(f,v,P){var O=ce,W=pt();if(Mi){if(P===void 0)throw Error(n(407));P=P()}else{if(P=v(),Ji===null)throw Error(n(349));(re&30)!==0||rn(O,v,P)}W.memoizedState=P;var Q={value:P,getSnapshot:v};return W.queue=Q,go(br.bind(null,O,Q,f),[f]),O.flags|=2048,ci(9,Vn.bind(null,O,Q,P,v),void 0,null),P},useId:function(){var f=pt(),v=Ji.identifierPrefix;if(Mi){var P=Ds,O=va;P=(O&~(1<<32-tr(O)-1)).toString(32)+P,v=":"+v+"R"+P,P=Ge++,0<P&&(v+="H"+P.toString(32)),v+=":"}else P=et++,v=":"+v+"r"+P.toString(32)+":";return f.memoizedState=v},unstable_isNewReconciler:!1},bg={readContext:vi,useCallback:ya,useContext:vi,useEffect:Ar,useImperativeHandle:_l,useInsertionEffect:so,useLayoutEffect:vo,useMemo:Yu,useReducer:Tt,useRef:ai,useState:function(){return Tt(Mt)},useDebugValue:Va,useDeferredValue:function(f){var v=Pt();return Ku(v,ve.memoizedState,f)},useTransition:function(){var f=Tt(Mt)[0],v=Pt().memoizedState;return[f,v]},useMutableSource:Mn,useSyncExternalStore:Sn,useId:as,unstable_isNewReconciler:!1},Py={readContext:vi,useCallback:ya,useContext:vi,useEffect:Ar,useImperativeHandle:_l,useInsertionEffect:so,useLayoutEffect:vo,useMemo:Yu,useReducer:kt,useRef:ai,useState:function(){return kt(Mt)},useDebugValue:Va,useDeferredValue:function(f){var v=Pt();return ve===null?v.memoizedState=f:Ku(v,ve.memoizedState,f)},useTransition:function(){var f=kt(Mt)[0],v=Pt().memoizedState;return[f,v]},useMutableSource:Mn,useSyncExternalStore:Sn,useId:as,unstable_isNewReconciler:!1};function Fs(f,v){if(f&&f.defaultProps){v=rt({},v),f=f.defaultProps;for(var P in f)v[P]===void 0&&(v[P]=f[P]);return v}return v}function nu(f,v,P,O){v=f.memoizedState,P=P(O,v),P=P==null?v:rt({},v,P),f.memoizedState=P,f.lanes===0&&(f.updateQueue.baseState=P)}var xl={isMounted:function(f){return(f=f._reactInternals)?It(f)===f:!1},enqueueSetState:function(f,v,P){f=f._reactInternals;var O=Ss(),W=ru(f),Q=jo(O,W);Q.payload=v,P!=null&&(Q.callback=P),v=ss(f,Q,W),v!==null&&(na(v,f,W,O),Xu(v,f,W))},enqueueReplaceState:function(f,v,P){f=f._reactInternals;var O=Ss(),W=ru(f),Q=jo(O,W);Q.tag=1,Q.payload=v,P!=null&&(Q.callback=P),v=ss(f,Q,W),v!==null&&(na(v,f,W,O),Xu(v,f,W))},enqueueForceUpdate:function(f,v){f=f._reactInternals;var P=Ss(),O=ru(f),W=jo(P,O);W.tag=2,v!=null&&(W.callback=v),v=ss(f,W,O),v!==null&&(na(v,f,O,P),Xu(v,f,O))}};function ja(f,v,P,O,W,Q,be){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(O,Q,be):v.prototype&&v.prototype.isPureReactComponent?!$c(P,O)||!$c(W,Q):!0}function _o(f,v,P){var O=!1,W=po,Q=v.contextType;return typeof Q=="object"&&Q!==null?Q=vi(Q):(W=$o(v)?cc:mo.current,O=v.contextTypes,Q=(O=O!=null)?ga(f,W):po),v=new v(P,Q),f.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=xl,f.stateNode=v,v._reactInternals=f,O&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=W,f.__reactInternalMemoizedMaskedChildContext=Q),v}function Ha(f,v,P,O){f=v.state,typeof v.componentWillReceiveProps=="function"&&v.componentWillReceiveProps(P,O),typeof v.UNSAFE_componentWillReceiveProps=="function"&&v.UNSAFE_componentWillReceiveProps(P,O),v.state!==f&&xl.enqueueReplaceState(v,v.state,null)}function dd(f,v,P,O){var W=f.stateNode;W.props=P,W.state=f.memoizedState,W.refs={},Ci(f);var Q=v.contextType;typeof Q=="object"&&Q!==null?W.context=vi(Q):(Q=$o(v)?cc:mo.current,W.context=ga(f,Q)),W.state=f.memoizedState,Q=v.getDerivedStateFromProps,typeof Q=="function"&&(nu(f,v,Q,P),W.state=f.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof W.getSnapshotBeforeUpdate=="function"||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(v=W.state,typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount(),v!==W.state&&xl.enqueueReplaceState(W,W.state,null),$a(f,P,W,O),W.state=f.memoizedState),typeof W.componentDidMount=="function"&&(f.flags|=4194308)}function Ns(f,v){try{var P="",O=v;do P+=ct(O),O=O.return;while(O);var W=P}catch(Q){W=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:f,source:v,stack:W,digest:null}}function fd(f,v,P){return{value:f,source:null,stack:P??null,digest:v??null}}function pd(f,v){try{console.error(v.value)}catch(P){setTimeout(function(){throw P})}}var md=typeof WeakMap=="function"?WeakMap:Map;function Ay(f,v,P){P=jo(-1,P),P.tag=3,P.payload={element:null};var O=v.value;return P.callback=function(){kg||(kg=!0,jy=O),pd(f,v)},P}function Qu(f,v,P){P=jo(-1,P),P.tag=3;var O=f.type.getDerivedStateFromError;if(typeof O=="function"){var W=v.value;P.payload=function(){return O(W)},P.callback=function(){pd(f,v)}}var Q=f.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(P.callback=function(){pd(f,v),typeof O!="function"&&(oh===null?oh=new Set([this]):oh.add(this));var be=v.stack;this.componentDidCatch(v.value,{componentStack:be!==null?be:""})}),P}function eh(f,v,P){var O=f.pingCache;if(O===null){O=f.pingCache=new md;var W=new Set;O.set(v,W)}else W=O.get(v),W===void 0&&(W=new Set,O.set(v,W));W.has(P)||(W.add(P),f=Vx.bind(null,f,v,P),v.then(f,f))}function Iy(f){do{var v;if((v=f.tag===13)&&(v=f.memoizedState,v=v!==null?v.dehydrated!==null:!0),v)return f;f=f.return}while(f!==null);return null}function Tx(f,v,P,O,W){return(f.mode&1)===0?(f===v?f.flags|=65536:(f.flags|=128,P.flags|=131072,P.flags&=-52805,P.tag===1&&(P.alternate===null?P.tag=17:(v=jo(-1,1),v.tag=2,ss(P,v,1))),P.lanes|=1),f):(f.flags|=65536,f.lanes=W,f)}var Ry=H.ReactCurrentOwner,Bs=!1;function Us(f,v,P,O){v.child=f===null?Zp(v,null,P,O):Qc(v,f.child,P,O)}function Ly(f,v,P,O,W){P=P.render;var Q=v.ref;return Ua(v,W),O=ht(f,v,P,O,Q,W),P=Ye(),f!==null&&!Bs?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~W,bl(f,v,W)):(Mi&&P&&dc(v),v.flags|=1,Us(f,v,O,W),v.child)}function Px(f,v,P,O,W){if(f===null){var Q=P.type;return typeof Q=="function"&&!Yy(Q)&&Q.defaultProps===void 0&&P.compare===null&&P.defaultProps===void 0?(v.tag=15,v.type=Q,wg(f,v,Q,O,W)):(f=Og(P.type,null,O,v,v.mode,W),f.ref=v.ref,f.return=v,v.child=f)}if(Q=f.child,(f.lanes&W)===0){var be=Q.memoizedProps;if(P=P.compare,P=P!==null?P:$c,P(be,O)&&f.ref===v.ref)return bl(f,v,W)}return v.flags|=1,f=iu(Q,O),f.ref=v.ref,f.return=v,v.child=f}function wg(f,v,P,O,W){if(f!==null){var Q=f.memoizedProps;if($c(Q,O)&&f.ref===v.ref)if(Bs=!1,v.pendingProps=O=Q,(f.lanes&W)!==0)(f.flags&131072)!==0&&(Bs=!0);else return v.lanes=f.lanes,bl(f,v,W)}return Mg(f,v,P,O,W)}function Ax(f,v,P){var O=v.pendingProps,W=O.children,Q=f!==null?f.memoizedState:null;if(O.mode==="hidden")if((v.mode&1)===0)v.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pr(Ml,ws),ws|=P;else{if((P&1073741824)===0)return f=Q!==null?Q.baseLanes|P:P,v.lanes=v.childLanes=1073741824,v.memoizedState={baseLanes:f,cachePool:null,transitions:null},v.updateQueue=null,Pr(Ml,ws),ws|=f,null;v.memoizedState={baseLanes:0,cachePool:null,transitions:null},O=Q!==null?Q.baseLanes:P,Pr(Ml,ws),ws|=O}else Q!==null?(O=Q.baseLanes|P,v.memoizedState=null):O=P,Pr(Ml,ws),ws|=O;return Us(f,v,W,P),v.child}function Sg(f,v){var P=v.ref;(f===null&&P!==null||f!==null&&f.ref!==P)&&(v.flags|=512,v.flags|=2097152)}function Mg(f,v,P,O,W){var Q=$o(P)?cc:mo.current;return Q=ga(v,Q),Ua(v,W),P=ht(f,v,P,O,Q,W),O=Ye(),f!==null&&!Bs?(v.updateQueue=f.updateQueue,v.flags&=-2053,f.lanes&=~W,bl(f,v,W)):(Mi&&O&&dc(v),v.flags|=1,Us(f,v,P,W),v.child)}function ky(f,v,P,O,W){if($o(P)){var Q=!0;Kc(v)}else Q=!1;if(Ua(v,W),v.stateNode===null)Pg(f,v),_o(v,P,O),dd(v,P,O,W),O=!0;else if(f===null){var be=v.stateNode,st=v.memoizedProps;be.props=st;var gt=be.context,Bt=P.contextType;typeof Bt=="object"&&Bt!==null?Bt=vi(Bt):(Bt=$o(P)?cc:mo.current,Bt=ga(v,Bt));var wn=P.getDerivedStateFromProps,Cn=typeof wn=="function"||typeof be.getSnapshotBeforeUpdate=="function";Cn||typeof be.UNSAFE_componentWillReceiveProps!="function"&&typeof be.componentWillReceiveProps!="function"||(st!==O||gt!==Bt)&&Ha(v,be,O,Bt),ei=!1;var xn=v.memoizedState;be.state=xn,$a(v,O,be,W),gt=v.memoizedState,st!==O||xn!==gt||rs.current||ei?(typeof wn=="function"&&(nu(v,P,wn,O),gt=v.memoizedState),(st=ei||ja(v,P,st,O,xn,gt,Bt))?(Cn||typeof be.UNSAFE_componentWillMount!="function"&&typeof be.componentWillMount!="function"||(typeof be.componentWillMount=="function"&&be.componentWillMount(),typeof be.UNSAFE_componentWillMount=="function"&&be.UNSAFE_componentWillMount()),typeof be.componentDidMount=="function"&&(v.flags|=4194308)):(typeof be.componentDidMount=="function"&&(v.flags|=4194308),v.memoizedProps=O,v.memoizedState=gt),be.props=O,be.state=gt,be.context=Bt,O=st):(typeof be.componentDidMount=="function"&&(v.flags|=4194308),O=!1)}else{be=v.stateNode,Kp(f,v),st=v.memoizedProps,Bt=v.type===v.elementType?st:Fs(v.type,st),be.props=Bt,Cn=v.pendingProps,xn=be.context,gt=P.contextType,typeof gt=="object"&&gt!==null?gt=vi(gt):(gt=$o(P)?cc:mo.current,gt=ga(v,gt));var Un=P.getDerivedStateFromProps;(wn=typeof Un=="function"||typeof be.getSnapshotBeforeUpdate=="function")||typeof be.UNSAFE_componentWillReceiveProps!="function"&&typeof be.componentWillReceiveProps!="function"||(st!==Cn||xn!==gt)&&Ha(v,be,O,gt),ei=!1,xn=v.memoizedState,be.state=xn,$a(v,O,be,W);var Yn=v.memoizedState;st!==Cn||xn!==Yn||rs.current||ei?(typeof Un=="function"&&(nu(v,P,Un,O),Yn=v.memoizedState),(Bt=ei||ja(v,P,Bt,O,xn,Yn,gt)||!1)?(wn||typeof be.UNSAFE_componentWillUpdate!="function"&&typeof be.componentWillUpdate!="function"||(typeof be.componentWillUpdate=="function"&&be.componentWillUpdate(O,Yn,gt),typeof be.UNSAFE_componentWillUpdate=="function"&&be.UNSAFE_componentWillUpdate(O,Yn,gt)),typeof be.componentDidUpdate=="function"&&(v.flags|=4),typeof be.getSnapshotBeforeUpdate=="function"&&(v.flags|=1024)):(typeof be.componentDidUpdate!="function"||st===f.memoizedProps&&xn===f.memoizedState||(v.flags|=4),typeof be.getSnapshotBeforeUpdate!="function"||st===f.memoizedProps&&xn===f.memoizedState||(v.flags|=1024),v.memoizedProps=O,v.memoizedState=Yn),be.props=O,be.state=Yn,be.context=gt,O=Bt):(typeof be.componentDidUpdate!="function"||st===f.memoizedProps&&xn===f.memoizedState||(v.flags|=4),typeof be.getSnapshotBeforeUpdate!="function"||st===f.memoizedProps&&xn===f.memoizedState||(v.flags|=1024),O=!1)}return th(f,v,P,O,Q,W)}function th(f,v,P,O,W,Q){Sg(f,v);var be=(v.flags&128)!==0;if(!O&&!be)return W&&Jc(v,P,!1),bl(f,v,Q);O=v.stateNode,Ry.current=v;var st=be&&typeof P.getDerivedStateFromError!="function"?null:O.render();return v.flags|=1,f!==null&&be?(v.child=Qc(v,f.child,null,Q),v.child=Qc(v,null,st,Q)):Us(f,v,st,Q),v.memoizedState=O.state,W&&Jc(v,P,!0),v.child}function Ix(f){var v=f.stateNode;v.pendingContext?Xp(f,v.pendingContext,v.pendingContext!==v.context):v.context&&Xp(f,v.context,!1),u(f,v.containerInfo)}function bf(f,v,P,O,W){return Wu(),ld(W),v.flags|=256,Us(f,v,P,O),v.child}var wf={dehydrated:null,treeContext:null,retryLane:0};function Sf(f){return{baseLanes:f,cachePool:null,transitions:null}}function Dy(f,v,P){var O=v.pendingProps,W=k.current,Q=!1,be=(v.flags&128)!==0,st;if((st=be)||(st=f!==null&&f.memoizedState===null?!1:(W&2)!==0),st?(Q=!0,v.flags&=-129):(f===null||f.memoizedState!==null)&&(W|=1),Pr(k,W&1),f===null)return Hu(v),f=v.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?((v.mode&1)===0?v.lanes=1:f.data==="$!"?v.lanes=8:v.lanes=1073741824,null):(be=O.children,f=O.fallback,Q?(O=v.mode,Q=v.child,be={mode:"hidden",children:be},(O&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=be):Q=ch(be,O,0,null),f=Ed(f,O,P,null),Q.return=v,f.return=v,Q.sibling=f,v.child=Q,v.child.memoizedState=Sf(P),v.memoizedState=wf,f):Cg(v,be));if(W=f.memoizedState,W!==null&&(st=W.dehydrated,st!==null))return PS(f,v,be,O,st,W,P);if(Q){Q=O.fallback,be=v.mode,W=f.child,st=W.sibling;var gt={mode:"hidden",children:O.children};return(be&1)===0&&v.child!==W?(O=v.child,O.childLanes=0,O.pendingProps=gt,v.deletions=null):(O=iu(W,gt),O.subtreeFlags=W.subtreeFlags&14680064),st!==null?Q=iu(st,Q):(Q=Ed(Q,be,P,null),Q.flags|=2),Q.return=v,O.return=v,O.sibling=Q,v.child=O,O=Q,Q=v.child,be=f.child.memoizedState,be=be===null?Sf(P):{baseLanes:be.baseLanes|P,cachePool:null,transitions:be.transitions},Q.memoizedState=be,Q.childLanes=f.childLanes&~P,v.memoizedState=wf,O}return Q=f.child,f=Q.sibling,O=iu(Q,{mode:"visible",children:O.children}),(v.mode&1)===0&&(O.lanes=P),O.return=v,O.sibling=null,f!==null&&(P=v.deletions,P===null?(v.deletions=[f],v.flags|=16):P.push(f)),v.child=O,v.memoizedState=null,O}function Cg(f,v){return v=ch({mode:"visible",children:v},f.mode,0,null),v.return=f,f.child=v}function Eg(f,v,P,O){return O!==null&&ld(O),Qc(v,f.child,null,P),f=Cg(v,v.pendingProps.children),f.flags|=2,v.memoizedState=null,f}function PS(f,v,P,O,W,Q,be){if(P)return v.flags&256?(v.flags&=-257,O=fd(Error(n(422))),Eg(f,v,be,O)):v.memoizedState!==null?(v.child=f.child,v.flags|=128,null):(Q=O.fallback,W=v.mode,O=ch({mode:"visible",children:O.children},W,0,null),Q=Ed(Q,W,be,null),Q.flags|=2,O.return=v,Q.return=v,O.sibling=Q,v.child=O,(v.mode&1)!==0&&Qc(v,f.child,null,be),v.child.memoizedState=Sf(be),v.memoizedState=wf,Q);if((v.mode&1)===0)return Eg(f,v,be,null);if(W.data==="$!"){if(O=W.nextSibling&&W.nextSibling.dataset,O)var st=O.dgst;return O=st,Q=Error(n(419)),O=fd(Q,O,void 0),Eg(f,v,be,O)}if(st=(be&f.childLanes)!==0,Bs||st){if(O=Ji,O!==null){switch(be&-be){case 4:W=2;break;case 16:W=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:W=32;break;case 536870912:W=268435456;break;default:W=0}W=(W&(O.suspendedLanes|be))!==0?0:W,W!==0&&W!==Q.retryLane&&(Q.retryLane=W,os(f,W),na(O,f,W,-1))}return qy(),O=fd(Error(n(421))),Eg(f,v,be,O)}return W.data==="$?"?(v.flags|=128,v.child=f.child,v=jx.bind(null,f),W._reactRetry=v,null):(f=Q.treeContext,is=ma(W.nextSibling),dr=v,Mi=!0,_s=null,f!==null&&(Ao[Hi++]=va,Ao[Hi++]=Ds,Ao[Hi++]=zn,va=f.id,Ds=f.overflow,zn=v),v=Cg(v,O.children),v.flags|=4096,v)}function zy(f,v,P){f.lanes|=v;var O=f.alternate;O!==null&&(O.lanes|=v),ud(f.return,v,P)}function Tg(f,v,P,O,W){var Q=f.memoizedState;Q===null?f.memoizedState={isBackwards:v,rendering:null,renderingStartTime:0,last:O,tail:P,tailMode:W}:(Q.isBackwards=v,Q.rendering=null,Q.renderingStartTime=0,Q.last=O,Q.tail=P,Q.tailMode=W)}function Oy(f,v,P){var O=v.pendingProps,W=O.revealOrder,Q=O.tail;if(Us(f,v,O.children,P),O=k.current,(O&2)!==0)O=O&1|2,v.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=v.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&zy(f,P,v);else if(f.tag===19)zy(f,P,v);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===v)break e;for(;f.sibling===null;){if(f.return===null||f.return===v)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}O&=1}if(Pr(k,O),(v.mode&1)===0)v.memoizedState=null;else switch(W){case"forwards":for(P=v.child,W=null;P!==null;)f=P.alternate,f!==null&&F(f)===null&&(W=P),P=P.sibling;P=W,P===null?(W=v.child,v.child=null):(W=P.sibling,P.sibling=null),Tg(v,!1,W,P,Q);break;case"backwards":for(P=null,W=v.child,v.child=null;W!==null;){if(f=W.alternate,f!==null&&F(f)===null){v.child=W;break}f=W.sibling,W.sibling=P,P=W,W=f}Tg(v,!0,P,null,Q);break;case"together":Tg(v,!1,null,null,void 0);break;default:v.memoizedState=null}return v.child}function Pg(f,v){(v.mode&1)===0&&f!==null&&(f.alternate=null,v.alternate=null,v.flags|=2)}function bl(f,v,P){if(f!==null&&(v.dependencies=f.dependencies),ih|=v.lanes,(P&v.childLanes)===0)return null;if(f!==null&&v.child!==f.child)throw Error(n(153));if(v.child!==null){for(f=v.child,P=iu(f,f.pendingProps),v.child=P,P.return=v;f.sibling!==null;)f=f.sibling,P=P.sibling=iu(f,f.pendingProps),P.return=v;P.sibling=null}return v.child}function Rx(f,v,P){switch(v.tag){case 3:Ix(v),Wu();break;case 5:x(v);break;case 1:$o(v.type)&&Kc(v);break;case 4:u(v,v.stateNode.containerInfo);break;case 10:var O=v.type._context,W=v.memoizedProps.value;Pr(xf,O._currentValue),O._currentValue=W;break;case 13:if(O=v.memoizedState,O!==null)return O.dehydrated!==null?(Pr(k,k.current&1),v.flags|=128,null):(P&v.child.childLanes)!==0?Dy(f,v,P):(Pr(k,k.current&1),f=bl(f,v,P),f!==null?f.sibling:null);Pr(k,k.current&1);break;case 19:if(O=(P&v.childLanes)!==0,(f.flags&128)!==0){if(O)return Oy(f,v,P);v.flags|=128}if(W=v.memoizedState,W!==null&&(W.rendering=null,W.tail=null,W.lastEffect=null),Pr(k,k.current),O)break;return null;case 22:case 23:return v.lanes=0,Ax(f,v,P)}return bl(f,v,P)}var Ag,gd,xs,Fy;Ag=function(f,v){for(var P=v.child;P!==null;){if(P.tag===5||P.tag===6)f.appendChild(P.stateNode);else if(P.tag!==4&&P.child!==null){P.child.return=P,P=P.child;continue}if(P===v)break;for(;P.sibling===null;){if(P.return===null||P.return===v)return;P=P.return}P.sibling.return=P.return,P=P.sibling}},gd=function(){},xs=function(f,v,P,O){var W=f.memoizedProps;if(W!==O){f=v.stateNode,o(Os.current);var Q=null;switch(P){case"input":W=Je(f,W),O=Je(f,O),Q=[];break;case"select":W=rt({},W,{value:void 0}),O=rt({},O,{value:void 0}),Q=[];break;case"textarea":W=Se(f,W),O=Se(f,O),Q=[];break;default:typeof W.onClick!="function"&&typeof O.onClick=="function"&&(f.onclick=lc)}fe(P,O);var be;P=null;for(Bt in W)if(!O.hasOwnProperty(Bt)&&W.hasOwnProperty(Bt)&&W[Bt]!=null)if(Bt==="style"){var st=W[Bt];for(be in st)st.hasOwnProperty(be)&&(P||(P={}),P[be]="")}else Bt!=="dangerouslySetInnerHTML"&&Bt!=="children"&&Bt!=="suppressContentEditableWarning"&&Bt!=="suppressHydrationWarning"&&Bt!=="autoFocus"&&(i.hasOwnProperty(Bt)?Q||(Q=[]):(Q=Q||[]).push(Bt,null));for(Bt in O){var gt=O[Bt];if(st=W?.[Bt],O.hasOwnProperty(Bt)&&gt!==st&&(gt!=null||st!=null))if(Bt==="style")if(st){for(be in st)!st.hasOwnProperty(be)||gt&&gt.hasOwnProperty(be)||(P||(P={}),P[be]="");for(be in gt)gt.hasOwnProperty(be)&&st[be]!==gt[be]&&(P||(P={}),P[be]=gt[be])}else P||(Q||(Q=[]),Q.push(Bt,P)),P=gt;else Bt==="dangerouslySetInnerHTML"?(gt=gt?gt.__html:void 0,st=st?st.__html:void 0,gt!=null&&st!==gt&&(Q=Q||[]).push(Bt,gt)):Bt==="children"?typeof gt!="string"&&typeof gt!="number"||(Q=Q||[]).push(Bt,""+gt):Bt!=="suppressContentEditableWarning"&&Bt!=="suppressHydrationWarning"&&(i.hasOwnProperty(Bt)?(gt!=null&&Bt==="onScroll"&&oi("scroll",f),Q||st===gt||(Q=[])):(Q=Q||[]).push(Bt,gt))}P&&(Q=Q||[]).push("style",P);var Bt=Q;(v.updateQueue=Bt)&&(v.flags|=4)}},Fy=function(f,v,P,O){P!==O&&(v.flags|=4)};function vd(f,v){if(!Mi)switch(f.tailMode){case"hidden":v=f.tail;for(var P=null;v!==null;)v.alternate!==null&&(P=v),v=v.sibling;P===null?f.tail=null:P.sibling=null;break;case"collapsed":P=f.tail;for(var O=null;P!==null;)P.alternate!==null&&(O=P),P=P.sibling;O===null?v||f.tail===null?f.tail=null:f.tail.sibling=null:O.sibling=null}}function bs(f){var v=f.alternate!==null&&f.alternate.child===f.child,P=0,O=0;if(v)for(var W=f.child;W!==null;)P|=W.lanes|W.childLanes,O|=W.subtreeFlags&14680064,O|=W.flags&14680064,W.return=f,W=W.sibling;else for(W=f.child;W!==null;)P|=W.lanes|W.childLanes,O|=W.subtreeFlags,O|=W.flags,W.return=f,W=W.sibling;return f.subtreeFlags|=O,f.childLanes=P,v}function Lx(f,v,P){var O=v.pendingProps;switch(od(v),v.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bs(v),null;case 1:return $o(v.type)&&Yc(),bs(v),null;case 3:return O=v.stateNode,g(),ri(rs),ri(mo),Z(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(f===null||f.child===null)&&(ad(v)?v.flags|=4:f===null||f.memoizedState.isDehydrated&&(v.flags&256)===0||(v.flags|=1024,_s!==null&&(Sd(_s),_s=null))),gd(f,v),bs(v),null;case 5:E(v);var W=o(C.current);if(P=v.type,f!==null&&v.stateNode!=null)xs(f,v,P,O,W),f.ref!==v.ref&&(v.flags|=512,v.flags|=2097152);else{if(!O){if(v.stateNode===null)throw Error(n(166));return bs(v),null}if(f=o(Os.current),ad(v)){O=v.stateNode,P=v.type;var Q=v.memoizedProps;switch(O[Yr]=v,O[ea]=Q,f=(v.mode&1)!==0,P){case"dialog":oi("cancel",O),oi("close",O);break;case"iframe":case"object":case"embed":oi("load",O);break;case"video":case"audio":for(W=0;W<Sr.length;W++)oi(Sr[W],O);break;case"source":oi("error",O);break;case"img":case"image":case"link":oi("error",O),oi("load",O);break;case"details":oi("toggle",O);break;case"input":Tn(O,Q),oi("invalid",O);break;case"select":O._wrapperState={wasMultiple:!!Q.multiple},oi("invalid",O);break;case"textarea":yt(O,Q),oi("invalid",O)}fe(P,Q),W=null;for(var be in Q)if(Q.hasOwnProperty(be)){var st=Q[be];be==="children"?typeof st=="string"?O.textContent!==st&&(Q.suppressHydrationWarning!==!0&&pl(O.textContent,st,f),W=["children",st]):typeof st=="number"&&O.textContent!==""+st&&(Q.suppressHydrationWarning!==!0&&pl(O.textContent,st,f),W=["children",""+st]):i.hasOwnProperty(be)&&st!=null&&be==="onScroll"&&oi("scroll",O)}switch(P){case"input":cn(O),Ut(O,Q,!0);break;case"textarea":cn(O),Ht(O);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(O.onclick=lc)}O=W,v.updateQueue=O,O!==null&&(v.flags|=4)}else{be=W.nodeType===9?W:W.ownerDocument,f==="http://www.w3.org/1999/xhtml"&&(f=Ot(P)),f==="http://www.w3.org/1999/xhtml"?P==="script"?(f=be.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild)):typeof O.is=="string"?f=be.createElement(P,{is:O.is}):(f=be.createElement(P),P==="select"&&(be=f,O.multiple?be.multiple=!0:O.size&&(be.size=O.size))):f=be.createElementNS(f,P),f[Yr]=v,f[ea]=O,Ag(f,v,!1,!1),v.stateNode=f;e:{switch(be=Oe(P,O),P){case"dialog":oi("cancel",f),oi("close",f),W=O;break;case"iframe":case"object":case"embed":oi("load",f),W=O;break;case"video":case"audio":for(W=0;W<Sr.length;W++)oi(Sr[W],f);W=O;break;case"source":oi("error",f),W=O;break;case"img":case"image":case"link":oi("error",f),oi("load",f),W=O;break;case"details":oi("toggle",f),W=O;break;case"input":Tn(f,O),W=Je(f,O),oi("invalid",f);break;case"option":W=O;break;case"select":f._wrapperState={wasMultiple:!!O.multiple},W=rt({},O,{value:void 0}),oi("invalid",f);break;case"textarea":yt(f,O),W=Se(f,O),oi("invalid",f);break;default:W=O}fe(P,W),st=W;for(Q in st)if(st.hasOwnProperty(Q)){var gt=st[Q];Q==="style"?ue(f,gt):Q==="dangerouslySetInnerHTML"?(gt=gt?gt.__html:void 0,gt!=null&&Zt(f,gt)):Q==="children"?typeof gt=="string"?(P!=="textarea"||gt!=="")&&Nn(f,gt):typeof gt=="number"&&Nn(f,""+gt):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(i.hasOwnProperty(Q)?gt!=null&&Q==="onScroll"&&oi("scroll",f):gt!=null&&B(f,Q,gt,be))}switch(P){case"input":cn(f),Ut(f,O,!1);break;case"textarea":cn(f),Ht(f);break;case"option":O.value!=null&&f.setAttribute("value",""+lt(O.value));break;case"select":f.multiple=!!O.multiple,Q=O.value,Q!=null?Ue(f,!!O.multiple,Q,!1):O.defaultValue!=null&&Ue(f,!!O.multiple,O.defaultValue,!0);break;default:typeof W.onClick=="function"&&(f.onclick=lc)}switch(P){case"button":case"input":case"select":case"textarea":O=!!O.autoFocus;break e;case"img":O=!0;break e;default:O=!1}}O&&(v.flags|=4)}v.ref!==null&&(v.flags|=512,v.flags|=2097152)}return bs(v),null;case 6:if(f&&v.stateNode!=null)Fy(f,v,f.memoizedProps,O);else{if(typeof O!="string"&&v.stateNode===null)throw Error(n(166));if(P=o(C.current),o(Os.current),ad(v)){if(O=v.stateNode,P=v.memoizedProps,O[Yr]=v,(Q=O.nodeValue!==P)&&(f=dr,f!==null))switch(f.tag){case 3:pl(O.nodeValue,P,(f.mode&1)!==0);break;case 5:f.memoizedProps.suppressHydrationWarning!==!0&&pl(O.nodeValue,P,(f.mode&1)!==0)}Q&&(v.flags|=4)}else O=(P.nodeType===9?P:P.ownerDocument).createTextNode(O),O[Yr]=v,v.stateNode=O}return bs(v),null;case 13:if(ri(k),O=v.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(Mi&&is!==null&&(v.mode&1)!==0&&(v.flags&128)===0)Gu(),Wu(),v.flags|=98560,Q=!1;else if(Q=ad(v),O!==null&&O.dehydrated!==null){if(f===null){if(!Q)throw Error(n(318));if(Q=v.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(n(317));Q[Yr]=v}else Wu(),(v.flags&128)===0&&(v.memoizedState=null),v.flags|=4;bs(v),Q=!1}else _s!==null&&(Sd(_s),_s=null),Q=!0;if(!Q)return v.flags&65536?v:null}return(v.flags&128)!==0?(v.lanes=P,v):(O=O!==null,O!==(f!==null&&f.memoizedState!==null)&&O&&(v.child.flags|=8192,(v.mode&1)!==0&&(f===null||(k.current&1)!==0?Gi===0&&(Gi=3):qy())),v.updateQueue!==null&&(v.flags|=4),bs(v),null);case 4:return g(),gd(f,v),f===null&&zu(v.stateNode.containerInfo),bs(v),null;case 10:return qu(v.type._context),bs(v),null;case 17:return $o(v.type)&&Yc(),bs(v),null;case 19:if(ri(k),Q=v.memoizedState,Q===null)return bs(v),null;if(O=(v.flags&128)!==0,be=Q.rendering,be===null)if(O)vd(Q,!1);else{if(Gi!==0||f!==null&&(f.flags&128)!==0)for(f=v.child;f!==null;){if(be=F(f),be!==null){for(v.flags|=128,vd(Q,!1),O=be.updateQueue,O!==null&&(v.updateQueue=O,v.flags|=4),v.subtreeFlags=0,O=P,P=v.child;P!==null;)Q=P,f=O,Q.flags&=14680066,be=Q.alternate,be===null?(Q.childLanes=0,Q.lanes=f,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=be.childLanes,Q.lanes=be.lanes,Q.child=be.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=be.memoizedProps,Q.memoizedState=be.memoizedState,Q.updateQueue=be.updateQueue,Q.type=be.type,f=be.dependencies,Q.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),P=P.sibling;return Pr(k,k.current&1|2),v.child}f=f.sibling}Q.tail!==null&&bt()>wd&&(v.flags|=128,O=!0,vd(Q,!1),v.lanes=4194304)}else{if(!O)if(f=F(be),f!==null){if(v.flags|=128,O=!0,P=f.updateQueue,P!==null&&(v.updateQueue=P,v.flags|=4),vd(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!be.alternate&&!Mi)return bs(v),null}else 2*bt()-Q.renderingStartTime>wd&&P!==1073741824&&(v.flags|=128,O=!0,vd(Q,!1),v.lanes=4194304);Q.isBackwards?(be.sibling=v.child,v.child=be):(P=Q.last,P!==null?P.sibling=be:v.child=be,Q.last=be)}return Q.tail!==null?(v=Q.tail,Q.rendering=v,Q.tail=v.sibling,Q.renderingStartTime=bt(),v.sibling=null,P=k.current,Pr(k,O?P&1|2:P&1),v):(bs(v),null);case 22:case 23:return Gy(),O=v.memoizedState!==null,f!==null&&f.memoizedState!==null!==O&&(v.flags|=8192),O&&(v.mode&1)!==0?(ws&1073741824)!==0&&(bs(v),v.subtreeFlags&6&&(v.flags|=8192)):bs(v),null;case 24:return null;case 25:return null}throw Error(n(156,v.tag))}function AS(f,v){switch(od(v),v.tag){case 1:return $o(v.type)&&Yc(),f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 3:return g(),ri(rs),ri(mo),Z(),f=v.flags,(f&65536)!==0&&(f&128)===0?(v.flags=f&-65537|128,v):null;case 5:return E(v),null;case 13:if(ri(k),f=v.memoizedState,f!==null&&f.dehydrated!==null){if(v.alternate===null)throw Error(n(340));Wu()}return f=v.flags,f&65536?(v.flags=f&-65537|128,v):null;case 19:return ri(k),null;case 4:return g(),null;case 10:return qu(v.type._context),null;case 22:case 23:return Gy(),null;case 24:return null;default:return null}}var Ig=!1,ls=!1,IS=typeof WeakSet=="function"?WeakSet:Set,er=null;function yd(f,v){var P=f.ref;if(P!==null)if(typeof P=="function")try{P(null)}catch(O){Ui(f,v,O)}else P.current=null}function Rg(f,v,P){try{P()}catch(O){Ui(f,v,O)}}var kx=!1;function RS(f,v){if(td=ka,f=mg(),uf(f)){if("selectionStart"in f)var P={start:f.selectionStart,end:f.selectionEnd};else e:{P=(P=f.ownerDocument)&&P.defaultView||window;var O=P.getSelection&&P.getSelection();if(O&&O.rangeCount!==0){P=O.anchorNode;var W=O.anchorOffset,Q=O.focusNode;O=O.focusOffset;try{P.nodeType,Q.nodeType}catch{P=null;break e}var be=0,st=-1,gt=-1,Bt=0,wn=0,Cn=f,xn=null;t:for(;;){for(var Un;Cn!==P||W!==0&&Cn.nodeType!==3||(st=be+W),Cn!==Q||O!==0&&Cn.nodeType!==3||(gt=be+O),Cn.nodeType===3&&(be+=Cn.nodeValue.length),(Un=Cn.firstChild)!==null;)xn=Cn,Cn=Un;for(;;){if(Cn===f)break t;if(xn===P&&++Bt===W&&(st=be),xn===Q&&++wn===O&&(gt=be),(Un=Cn.nextSibling)!==null)break;Cn=xn,xn=Cn.parentNode}Cn=Un}P=st===-1||gt===-1?null:{start:st,end:gt}}else P=null}P=P||{start:0,end:0}}else P=null;for(Na={focusedElem:f,selectionRange:P},ka=!1,er=v;er!==null;)if(v=er,f=v.child,(v.subtreeFlags&1028)!==0&&f!==null)f.return=v,er=f;else for(;er!==null;){v=er;try{var Yn=v.alternate;if((v.flags&1024)!==0)switch(v.tag){case 0:case 11:case 15:break;case 1:if(Yn!==null){var ir=Yn.memoizedProps,Wi=Yn.memoizedState,Lt=v.stateNode,xt=Lt.getSnapshotBeforeUpdate(v.elementType===v.type?ir:Fs(v.type,ir),Wi);Lt.__reactInternalSnapshotBeforeUpdate=xt}break;case 3:var zt=v.stateNode.containerInfo;zt.nodeType===1?zt.textContent="":zt.nodeType===9&&zt.documentElement&&zt.removeChild(zt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Ln){Ui(v,v.return,Ln)}if(f=v.sibling,f!==null){f.return=v.return,er=f;break}er=v.return}return Yn=kx,kx=!1,Yn}function Jp(f,v,P){var O=v.updateQueue;if(O=O!==null?O.lastEffect:null,O!==null){var W=O=O.next;do{if((W.tag&f)===f){var Q=W.destroy;W.destroy=void 0,Q!==void 0&&Rg(v,P,Q)}W=W.next}while(W!==O)}}function Mf(f,v){if(v=v.updateQueue,v=v!==null?v.lastEffect:null,v!==null){var P=v=v.next;do{if((P.tag&f)===f){var O=P.create;P.destroy=O()}P=P.next}while(P!==v)}}function Qp(f){var v=f.ref;if(v!==null){var P=f.stateNode;switch(f.tag){case 5:f=P;break;default:f=P}typeof v=="function"?v(f):v.current=f}}function Ny(f){var v=f.alternate;v!==null&&(f.alternate=null,Ny(v)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(v=f.stateNode,v!==null&&(delete v[Yr],delete v[ea],delete v[Fu],delete v[rd],delete v[Nu])),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function nh(f){return f.tag===5||f.tag===3||f.tag===4}function Cf(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||nh(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function By(f,v,P){var O=f.tag;if(O===5||O===6)f=f.stateNode,v?P.nodeType===8?P.parentNode.insertBefore(f,v):P.insertBefore(f,v):(P.nodeType===8?(v=P.parentNode,v.insertBefore(f,P)):(v=P,v.appendChild(f)),P=P._reactRootContainer,P!=null||v.onclick!==null||(v.onclick=lc));else if(O!==4&&(f=f.child,f!==null))for(By(f,v,P),f=f.sibling;f!==null;)By(f,v,P),f=f.sibling}function Uy(f,v,P){var O=f.tag;if(O===5||O===6)f=f.stateNode,v?P.insertBefore(f,v):P.appendChild(f);else if(O!==4&&(f=f.child,f!==null))for(Uy(f,v,P),f=f.sibling;f!==null;)Uy(f,v,P),f=f.sibling}var cs=null,wl=!1;function rh(f,v,P){for(P=P.child;P!==null;)Dx(f,v,P),P=P.sibling}function Dx(f,v,P){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(Zn,P)}catch{}switch(P.tag){case 5:ls||yd(P,v);case 6:var O=cs,W=wl;cs=null,rh(f,v,P),cs=O,wl=W,cs!==null&&(wl?(f=cs,P=P.stateNode,f.nodeType===8?f.parentNode.removeChild(P):f.removeChild(P)):cs.removeChild(P.stateNode));break;case 18:cs!==null&&(wl?(f=cs,P=P.stateNode,f.nodeType===8?Wc(f.parentNode,P):f.nodeType===1&&Wc(f,P),da(f)):Wc(cs,P.stateNode));break;case 4:O=cs,W=wl,cs=P.stateNode.containerInfo,wl=!0,rh(f,v,P),cs=O,wl=W;break;case 0:case 11:case 14:case 15:if(!ls&&(O=P.updateQueue,O!==null&&(O=O.lastEffect,O!==null))){W=O=O.next;do{var Q=W,be=Q.destroy;Q=Q.tag,be!==void 0&&((Q&2)!==0||(Q&4)!==0)&&Rg(P,v,be),W=W.next}while(W!==O)}rh(f,v,P);break;case 1:if(!ls&&(yd(P,v),O=P.stateNode,typeof O.componentWillUnmount=="function"))try{O.props=P.memoizedProps,O.state=P.memoizedState,O.componentWillUnmount()}catch(st){Ui(P,v,st)}rh(f,v,P);break;case 21:rh(f,v,P);break;case 22:P.mode&1?(ls=(O=ls)||P.memoizedState!==null,rh(f,v,P),ls=O):rh(f,v,P);break;default:rh(f,v,P)}}function zx(f){var v=f.updateQueue;if(v!==null){f.updateQueue=null;var P=f.stateNode;P===null&&(P=f.stateNode=new IS),v.forEach(function(O){var W=zS.bind(null,f,O);P.has(O)||(P.add(O),O.then(W,W))})}}function xa(f,v){var P=v.deletions;if(P!==null)for(var O=0;O<P.length;O++){var W=P[O];try{var Q=f,be=v,st=be;e:for(;st!==null;){switch(st.tag){case 5:cs=st.stateNode,wl=!1;break e;case 3:cs=st.stateNode.containerInfo,wl=!0;break e;case 4:cs=st.stateNode.containerInfo,wl=!0;break e}st=st.return}if(cs===null)throw Error(n(160));Dx(Q,be,W),cs=null,wl=!1;var gt=W.alternate;gt!==null&&(gt.return=null),W.return=null}catch(Bt){Ui(W,v,Bt)}}if(v.subtreeFlags&12854)for(v=v.child;v!==null;)Ox(v,f),v=v.sibling}function Ox(f,v){var P=f.alternate,O=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(xa(v,f),Sl(f),O&4){try{Jp(3,f,f.return),Mf(3,f)}catch(ir){Ui(f,f.return,ir)}try{Jp(5,f,f.return)}catch(ir){Ui(f,f.return,ir)}}break;case 1:xa(v,f),Sl(f),O&512&&P!==null&&yd(P,P.return);break;case 5:if(xa(v,f),Sl(f),O&512&&P!==null&&yd(P,P.return),f.flags&32){var W=f.stateNode;try{Nn(W,"")}catch(ir){Ui(f,f.return,ir)}}if(O&4&&(W=f.stateNode,W!=null)){var Q=f.memoizedProps,be=P!==null?P.memoizedProps:Q,st=f.type,gt=f.updateQueue;if(f.updateQueue=null,gt!==null)try{st==="input"&&Q.type==="radio"&&Q.name!=null&&Kt(W,Q),Oe(st,be);var Bt=Oe(st,Q);for(be=0;be<gt.length;be+=2){var wn=gt[be],Cn=gt[be+1];wn==="style"?ue(W,Cn):wn==="dangerouslySetInnerHTML"?Zt(W,Cn):wn==="children"?Nn(W,Cn):B(W,wn,Cn,Bt)}switch(st){case"input":fn(W,Q);break;case"textarea":Nt(W,Q);break;case"select":var xn=W._wrapperState.wasMultiple;W._wrapperState.wasMultiple=!!Q.multiple;var Un=Q.value;Un!=null?Ue(W,!!Q.multiple,Un,!1):xn!==!!Q.multiple&&(Q.defaultValue!=null?Ue(W,!!Q.multiple,Q.defaultValue,!0):Ue(W,!!Q.multiple,Q.multiple?[]:"",!1))}W[ea]=Q}catch(ir){Ui(f,f.return,ir)}}break;case 6:if(xa(v,f),Sl(f),O&4){if(f.stateNode===null)throw Error(n(162));W=f.stateNode,Q=f.memoizedProps;try{W.nodeValue=Q}catch(ir){Ui(f,f.return,ir)}}break;case 3:if(xa(v,f),Sl(f),O&4&&P!==null&&P.memoizedState.isDehydrated)try{da(v.containerInfo)}catch(ir){Ui(f,f.return,ir)}break;case 4:xa(v,f),Sl(f);break;case 13:xa(v,f),Sl(f),W=f.child,W.flags&8192&&(Q=W.memoizedState!==null,W.stateNode.isHidden=Q,!Q||W.alternate!==null&&W.alternate.memoizedState!==null||(nm=bt())),O&4&&zx(f);break;case 22:if(wn=P!==null&&P.memoizedState!==null,f.mode&1?(ls=(Bt=ls)||wn,xa(v,f),ls=Bt):xa(v,f),Sl(f),O&8192){if(Bt=f.memoizedState!==null,(f.stateNode.isHidden=Bt)&&!wn&&(f.mode&1)!==0)for(er=f,wn=f.child;wn!==null;){for(Cn=er=wn;er!==null;){switch(xn=er,Un=xn.child,xn.tag){case 0:case 11:case 14:case 15:Jp(4,xn,xn.return);break;case 1:yd(xn,xn.return);var Yn=xn.stateNode;if(typeof Yn.componentWillUnmount=="function"){O=xn,P=xn.return;try{v=O,Yn.props=v.memoizedProps,Yn.state=v.memoizedState,Yn.componentWillUnmount()}catch(ir){Ui(O,P,ir)}}break;case 5:yd(xn,xn.return);break;case 22:if(xn.memoizedState!==null){_d(Cn);continue}}Un!==null?(Un.return=xn,er=Un):_d(Cn)}wn=wn.sibling}e:for(wn=null,Cn=f;;){if(Cn.tag===5){if(wn===null){wn=Cn;try{W=Cn.stateNode,Bt?(Q=W.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(st=Cn.stateNode,gt=Cn.memoizedProps.style,be=gt!=null&&gt.hasOwnProperty("display")?gt.display:null,st.style.display=ae("display",be))}catch(ir){Ui(f,f.return,ir)}}}else if(Cn.tag===6){if(wn===null)try{Cn.stateNode.nodeValue=Bt?"":Cn.memoizedProps}catch(ir){Ui(f,f.return,ir)}}else if((Cn.tag!==22&&Cn.tag!==23||Cn.memoizedState===null||Cn===f)&&Cn.child!==null){Cn.child.return=Cn,Cn=Cn.child;continue}if(Cn===f)break e;for(;Cn.sibling===null;){if(Cn.return===null||Cn.return===f)break e;wn===Cn&&(wn=null),Cn=Cn.return}wn===Cn&&(wn=null),Cn.sibling.return=Cn.return,Cn=Cn.sibling}}break;case 19:xa(v,f),Sl(f),O&4&&zx(f);break;case 21:break;default:xa(v,f),Sl(f)}}function Sl(f){var v=f.flags;if(v&2){try{e:{for(var P=f.return;P!==null;){if(nh(P)){var O=P;break e}P=P.return}throw Error(n(160))}switch(O.tag){case 5:var W=O.stateNode;O.flags&32&&(Nn(W,""),O.flags&=-33);var Q=Cf(f);Uy(f,Q,W);break;case 3:case 4:var be=O.stateNode.containerInfo,st=Cf(f);By(f,st,be);break;default:throw Error(n(161))}}catch(gt){Ui(f,f.return,gt)}f.flags&=-3}v&4096&&(f.flags&=-4097)}function em(f,v,P){er=f,Fx(f)}function Fx(f,v,P){for(var O=(f.mode&1)!==0;er!==null;){var W=er,Q=W.child;if(W.tag===22&&O){var be=W.memoizedState!==null||Ig;if(!be){var st=W.alternate,gt=st!==null&&st.memoizedState!==null||ls;st=Ig;var Bt=ls;if(Ig=be,(ls=gt)&&!Bt)for(er=W;er!==null;)be=er,gt=be.child,be.tag===22&&be.memoizedState!==null?$y(W):gt!==null?(gt.return=be,er=gt):$y(W);for(;Q!==null;)er=Q,Fx(Q),Q=Q.sibling;er=W,Ig=st,ls=Bt}Bi(f)}else(W.subtreeFlags&8772)!==0&&Q!==null?(Q.return=W,er=Q):Bi(f)}}function Bi(f){for(;er!==null;){var v=er;if((v.flags&8772)!==0){var P=v.alternate;try{if((v.flags&8772)!==0)switch(v.tag){case 0:case 11:case 15:ls||Mf(5,v);break;case 1:var O=v.stateNode;if(v.flags&4&&!ls)if(P===null)O.componentDidMount();else{var W=v.elementType===v.type?P.memoizedProps:Fs(v.type,P.memoizedProps);O.componentDidUpdate(W,P.memoizedState,O.__reactInternalSnapshotBeforeUpdate)}var Q=v.updateQueue;Q!==null&&Zu(v,Q,O);break;case 3:var be=v.updateQueue;if(be!==null){if(P=null,v.child!==null)switch(v.child.tag){case 5:P=v.child.stateNode;break;case 1:P=v.child.stateNode}Zu(v,be,P)}break;case 5:var st=v.stateNode;if(P===null&&v.flags&4){P=st;var gt=v.memoizedProps;switch(v.type){case"button":case"input":case"select":case"textarea":gt.autoFocus&&P.focus();break;case"img":gt.src&&(P.src=gt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(v.memoizedState===null){var Bt=v.alternate;if(Bt!==null){var wn=Bt.memoizedState;if(wn!==null){var Cn=wn.dehydrated;Cn!==null&&da(Cn)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ls||v.flags&512&&Qp(v)}catch(xn){Ui(v,v.return,xn)}}if(v===f){er=null;break}if(P=v.sibling,P!==null){P.return=v.return,er=P;break}er=v.return}}function _d(f){for(;er!==null;){var v=er;if(v===f){er=null;break}var P=v.sibling;if(P!==null){P.return=v.return,er=P;break}er=v.return}}function $y(f){for(;er!==null;){var v=er;try{switch(v.tag){case 0:case 11:case 15:var P=v.return;try{Mf(4,v)}catch(gt){Ui(v,P,gt)}break;case 1:var O=v.stateNode;if(typeof O.componentDidMount=="function"){var W=v.return;try{O.componentDidMount()}catch(gt){Ui(v,W,gt)}}var Q=v.return;try{Qp(v)}catch(gt){Ui(v,Q,gt)}break;case 5:var be=v.return;try{Qp(v)}catch(gt){Ui(v,be,gt)}}}catch(gt){Ui(v,v.return,gt)}if(v===f){er=null;break}var st=v.sibling;if(st!==null){st.return=v.return,er=st;break}er=v.return}}var Lg=Math.ceil,xd=H.ReactCurrentDispatcher,bd=H.ReactCurrentOwner,ba=H.ReactCurrentBatchConfig,Jr=0,Ji=null,Qi=null,eo=0,ws=0,Ml=ks(0),Gi=0,tm=null,ih=0,yc=0,Vy=0,Ef=null,Ho=null,nm=0,wd=1/0,_c=null,kg=!1,jy=null,oh=null,Dg=!1,sh=null,Tf=0,Pf=0,rm=null,im=-1,Af=0;function Ss(){return(Jr&6)!==0?bt():im!==-1?im:im=bt()}function ru(f){return(f.mode&1)===0?1:(Jr&2)!==0&&eo!==0?eo&-eo:fc.transition!==null?(Af===0&&(Af=Zr()),Af):(f=Nr,f!==0||(f=window.event,f=f===void 0?16:Cp(f.type)),f)}function na(f,v,P,O){if(50<Pf)throw Pf=0,rm=null,Error(n(185));Xi(f,P,O),((Jr&2)===0||f!==Ji)&&(f===Ji&&((Jr&2)===0&&(yc|=P),Gi===4&&xc(f,eo)),$s(f,O),P===1&&Jr===0&&(v.mode&1)===0&&(wd=bt()+500,ys&&uc()))}function $s(f,v){var P=f.callbackNode;Jo(f,v);var O=Eo(f,f===Ji?eo:0);if(O===0)P!==null&&xe(P),f.callbackNode=null,f.callbackPriority=0;else if(v=O&-O,f.callbackPriority!==v){if(P!=null&&xe(P),v===1)f.tag===0?Uu(If.bind(null,f)):Vo(If.bind(null,f)),vg(function(){(Jr&6)===0&&uc()}),P=null;else{switch(io(O)){case 1:P=pn;break;case 4:P=An;break;case 16:P=gn;break;case 536870912:P=Qt;break;default:P=gn}P=Hx(P,Hy.bind(null,f))}f.callbackPriority=v,f.callbackNode=P}}function Hy(f,v){if(im=-1,Af=0,(Jr&6)!==0)throw Error(n(327));var P=f.callbackNode;if(Rf()&&f.callbackNode!==P)return null;var O=Eo(f,f===Ji?eo:0);if(O===0)return null;if((O&30)!==0||(O&f.expiredLanes)!==0||v)v=lh(f,O);else{v=O;var W=Jr;Jr|=2;var Q=Nx();(Ji!==f||eo!==v)&&(_c=null,wd=bt()+500,ah(f,v));do try{kS();break}catch(st){Wy(f,st)}while(!0);ar(),xd.current=Q,Jr=W,Qi!==null?v=0:(Ji=null,eo=0,v=Gi)}if(v!==0){if(v===2&&(W=Ra(f),W!==0&&(O=W,v=zg(f,W))),v===1)throw P=tm,ah(f,0),xc(f,O),$s(f,bt()),P;if(v===6)xc(f,O);else{if(W=f.current.alternate,(O&30)===0&&!LS(W)&&(v=lh(f,O),v===2&&(Q=Ra(f),Q!==0&&(O=Q,v=zg(f,Q))),v===1))throw P=tm,ah(f,0),xc(f,O),$s(f,bt()),P;switch(f.finishedWork=W,f.finishedLanes=O,v){case 0:case 1:throw Error(n(345));case 2:Cd(f,Ho,_c);break;case 3:if(xc(f,O),(O&130023424)===O&&(v=nm+500-bt(),10<v)){if(Eo(f,0)!==0)break;if(W=f.suspendedLanes,(W&O)!==O){Ss(),f.pingedLanes|=f.suspendedLanes&W;break}f.timeoutHandle=ff(Cd.bind(null,f,Ho,_c),v);break}Cd(f,Ho,_c);break;case 4:if(xc(f,O),(O&4194240)===O)break;for(v=f.eventTimes,W=-1;0<O;){var be=31-tr(O);Q=1<<be,be=v[be],be>W&&(W=be),O&=~Q}if(O=W,O=bt()-O,O=(120>O?120:480>O?480:1080>O?1080:1920>O?1920:3e3>O?3e3:4320>O?4320:1960*Lg(O/1960))-O,10<O){f.timeoutHandle=ff(Cd.bind(null,f,Ho,_c),O);break}Cd(f,Ho,_c);break;case 5:Cd(f,Ho,_c);break;default:throw Error(n(329))}}}return $s(f,bt()),f.callbackNode===P?Hy.bind(null,f):null}function zg(f,v){var P=Ef;return f.current.memoizedState.isDehydrated&&(ah(f,v).flags|=256),f=lh(f,v),f!==2&&(v=Ho,Ho=P,v!==null&&Sd(v)),f}function Sd(f){Ho===null?Ho=f:Ho.push.apply(Ho,f)}function LS(f){for(var v=f;;){if(v.flags&16384){var P=v.updateQueue;if(P!==null&&(P=P.stores,P!==null))for(var O=0;O<P.length;O++){var W=P[O],Q=W.getSnapshot;W=W.value;try{if(!Po(Q(),W))return!1}catch{return!1}}}if(P=v.child,v.subtreeFlags&16384&&P!==null)P.return=v,v=P;else{if(v===f)break;for(;v.sibling===null;){if(v.return===null||v.return===f)return!0;v=v.return}v.sibling.return=v.return,v=v.sibling}}return!0}function xc(f,v){for(v&=~Vy,v&=~yc,f.suspendedLanes|=v,f.pingedLanes&=~v,f=f.expirationTimes;0<v;){var P=31-tr(v),O=1<<P;f[P]=-1,v&=~O}}function If(f){if((Jr&6)!==0)throw Error(n(327));Rf();var v=Eo(f,0);if((v&1)===0)return $s(f,bt()),null;var P=lh(f,v);if(f.tag!==0&&P===2){var O=Ra(f);O!==0&&(v=O,P=zg(f,O))}if(P===1)throw P=tm,ah(f,0),xc(f,v),$s(f,bt()),P;if(P===6)throw Error(n(345));return f.finishedWork=f.current.alternate,f.finishedLanes=v,Cd(f,Ho,_c),$s(f,bt()),null}function om(f,v){var P=Jr;Jr|=1;try{return f(v)}finally{Jr=P,Jr===0&&(wd=bt()+500,ys&&uc())}}function Md(f){sh!==null&&sh.tag===0&&(Jr&6)===0&&Rf();var v=Jr;Jr|=1;var P=ba.transition,O=Nr;try{if(ba.transition=null,Nr=1,f)return f()}finally{Nr=O,ba.transition=P,Jr=v,(Jr&6)===0&&uc()}}function Gy(){ws=Ml.current,ri(Ml)}function ah(f,v){f.finishedWork=null,f.finishedLanes=0;var P=f.timeoutHandle;if(P!==-1&&(f.timeoutHandle=-1,pf(P)),Qi!==null)for(P=Qi.return;P!==null;){var O=P;switch(od(O),O.tag){case 1:O=O.type.childContextTypes,O!=null&&Yc();break;case 3:g(),ri(rs),ri(mo),Z();break;case 5:E(O);break;case 4:g();break;case 13:ri(k);break;case 19:ri(k);break;case 10:qu(O.type._context);break;case 22:case 23:Gy()}P=P.return}if(Ji=f,Qi=f=iu(f.current,null),eo=ws=v,Gi=0,tm=null,Vy=yc=ih=0,Ho=Ef=null,mc!==null){for(v=0;v<mc.length;v++)if(P=mc[v],O=P.interleaved,O!==null){P.interleaved=null;var W=O.next,Q=P.pending;if(Q!==null){var be=Q.next;Q.next=W,O.next=be}P.pending=O}mc=null}return f}function Wy(f,v){do{var P=Qi;try{if(ar(),K.current=yo,ze){for(var O=ce.memoizedState;O!==null;){var W=O.queue;W!==null&&(W.pending=null),O=O.next}ze=!1}if(re=0,Le=ve=ce=null,Ne=!1,Ge=0,bd.current=null,P===null||P.return===null){Gi=1,tm=v,Qi=null;break}e:{var Q=f,be=P.return,st=P,gt=v;if(v=eo,st.flags|=32768,gt!==null&&typeof gt=="object"&&typeof gt.then=="function"){var Bt=gt,wn=st,Cn=wn.tag;if((wn.mode&1)===0&&(Cn===0||Cn===11||Cn===15)){var xn=wn.alternate;xn?(wn.updateQueue=xn.updateQueue,wn.memoizedState=xn.memoizedState,wn.lanes=xn.lanes):(wn.updateQueue=null,wn.memoizedState=null)}var Un=Iy(be);if(Un!==null){Un.flags&=-257,Tx(Un,be,st,Q,v),Un.mode&1&&eh(Q,Bt,v),v=Un,gt=Bt;var Yn=v.updateQueue;if(Yn===null){var ir=new Set;ir.add(gt),v.updateQueue=ir}else Yn.add(gt);break e}else{if((v&1)===0){eh(Q,Bt,v),qy();break e}gt=Error(n(426))}}else if(Mi&&st.mode&1){var Wi=Iy(be);if(Wi!==null){(Wi.flags&65536)===0&&(Wi.flags|=256),Tx(Wi,be,st,Q,v),ld(Ns(gt,st));break e}}Q=gt=Ns(gt,st),Gi!==4&&(Gi=2),Ef===null?Ef=[Q]:Ef.push(Q),Q=be;do{switch(Q.tag){case 3:Q.flags|=65536,v&=-v,Q.lanes|=v;var Lt=Ay(Q,gt,v);hd(Q,Lt);break e;case 1:st=gt;var xt=Q.type,zt=Q.stateNode;if((Q.flags&128)===0&&(typeof xt.getDerivedStateFromError=="function"||zt!==null&&typeof zt.componentDidCatch=="function"&&(oh===null||!oh.has(zt)))){Q.flags|=65536,v&=-v,Q.lanes|=v;var Ln=Qu(Q,st,v);hd(Q,Ln);break e}}Q=Q.return}while(Q!==null)}$x(P)}catch(cr){v=cr,Qi===P&&P!==null&&(Qi=P=P.return);continue}break}while(!0)}function Nx(){var f=xd.current;return xd.current=yo,f===null?yo:f}function qy(){(Gi===0||Gi===3||Gi===2)&&(Gi=4),Ji===null||(ih&268435455)===0&&(yc&268435455)===0||xc(Ji,eo)}function lh(f,v){var P=Jr;Jr|=2;var O=Nx();(Ji!==f||eo!==v)&&(_c=null,ah(f,v));do try{Bx();break}catch(W){Wy(f,W)}while(!0);if(ar(),Jr=P,xd.current=O,Qi!==null)throw Error(n(261));return Ji=null,eo=0,Gi}function Bx(){for(;Qi!==null;)Ux(Qi)}function kS(){for(;Qi!==null&&!vt();)Ux(Qi)}function Ux(f){var v=sm(f.alternate,f,ws);f.memoizedProps=f.pendingProps,v===null?$x(f):Qi=v,bd.current=null}function $x(f){var v=f;do{var P=v.alternate;if(f=v.return,(v.flags&32768)===0){if(P=Lx(P,v,ws),P!==null){Qi=P;return}}else{if(P=AS(P,v),P!==null){P.flags&=32767,Qi=P;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{Gi=6,Qi=null;return}}if(v=v.sibling,v!==null){Qi=v;return}Qi=v=f}while(v!==null);Gi===0&&(Gi=5)}function Cd(f,v,P){var O=Nr,W=ba.transition;try{ba.transition=null,Nr=1,DS(f,v,P,O)}finally{ba.transition=W,Nr=O}return null}function DS(f,v,P,O){do Rf();while(sh!==null);if((Jr&6)!==0)throw Error(n(327));P=f.finishedWork;var W=f.finishedLanes;if(P===null)return null;if(f.finishedWork=null,f.finishedLanes=0,P===f.current)throw Error(n(177));f.callbackNode=null,f.callbackPriority=0;var Q=P.lanes|P.childLanes;if(ho(f,Q),f===Ji&&(Qi=Ji=null,eo=0),(P.subtreeFlags&2064)===0&&(P.flags&2064)===0||Dg||(Dg=!0,Hx(gn,function(){return Rf(),null})),Q=(P.flags&15990)!==0,(P.subtreeFlags&15990)!==0||Q){Q=ba.transition,ba.transition=null;var be=Nr;Nr=1;var st=Jr;Jr|=4,bd.current=null,RS(f,P),Ox(P,f),Ty(Na),ka=!!td,Na=td=null,f.current=P,em(P),Dt(),Jr=st,Nr=be,ba.transition=Q}else f.current=P;if(Dg&&(Dg=!1,sh=f,Tf=W),Q=f.pendingLanes,Q===0&&(oh=null),Wn(P.stateNode),$s(f,bt()),v!==null)for(O=f.onRecoverableError,P=0;P<v.length;P++)W=v[P],O(W.value,{componentStack:W.stack,digest:W.digest});if(kg)throw kg=!1,f=jy,jy=null,f;return(Tf&1)!==0&&f.tag!==0&&Rf(),Q=f.pendingLanes,(Q&1)!==0?f===rm?Pf++:(Pf=0,rm=f):Pf=0,uc(),null}function Rf(){if(sh!==null){var f=io(Tf),v=ba.transition,P=Nr;try{if(ba.transition=null,Nr=16>f?16:f,sh===null)var O=!1;else{if(f=sh,sh=null,Tf=0,(Jr&6)!==0)throw Error(n(331));var W=Jr;for(Jr|=4,er=f.current;er!==null;){var Q=er,be=Q.child;if((er.flags&16)!==0){var st=Q.deletions;if(st!==null){for(var gt=0;gt<st.length;gt++){var Bt=st[gt];for(er=Bt;er!==null;){var wn=er;switch(wn.tag){case 0:case 11:case 15:Jp(8,wn,Q)}var Cn=wn.child;if(Cn!==null)Cn.return=wn,er=Cn;else for(;er!==null;){wn=er;var xn=wn.sibling,Un=wn.return;if(Ny(wn),wn===Bt){er=null;break}if(xn!==null){xn.return=Un,er=xn;break}er=Un}}}var Yn=Q.alternate;if(Yn!==null){var ir=Yn.child;if(ir!==null){Yn.child=null;do{var Wi=ir.sibling;ir.sibling=null,ir=Wi}while(ir!==null)}}er=Q}}if((Q.subtreeFlags&2064)!==0&&be!==null)be.return=Q,er=be;else e:for(;er!==null;){if(Q=er,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:Jp(9,Q,Q.return)}var Lt=Q.sibling;if(Lt!==null){Lt.return=Q.return,er=Lt;break e}er=Q.return}}var xt=f.current;for(er=xt;er!==null;){be=er;var zt=be.child;if((be.subtreeFlags&2064)!==0&&zt!==null)zt.return=be,er=zt;else e:for(be=xt;er!==null;){if(st=er,(st.flags&2048)!==0)try{switch(st.tag){case 0:case 11:case 15:Mf(9,st)}}catch(cr){Ui(st,st.return,cr)}if(st===be){er=null;break e}var Ln=st.sibling;if(Ln!==null){Ln.return=st.return,er=Ln;break e}er=st.return}}if(Jr=W,uc(),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(Zn,f)}catch{}O=!0}return O}finally{Nr=P,ba.transition=v}}return!1}function Xy(f,v,P){v=Ns(P,v),v=Ay(f,v,1),f=ss(f,v,1),v=Ss(),f!==null&&(Xi(f,1,v),$s(f,v))}function Ui(f,v,P){if(f.tag===3)Xy(f,f,P);else for(;v!==null;){if(v.tag===3){Xy(v,f,P);break}else if(v.tag===1){var O=v.stateNode;if(typeof v.type.getDerivedStateFromError=="function"||typeof O.componentDidCatch=="function"&&(oh===null||!oh.has(O))){f=Ns(P,f),f=Qu(v,f,1),v=ss(v,f,1),f=Ss(),v!==null&&(Xi(v,1,f),$s(v,f));break}}v=v.return}}function Vx(f,v,P){var O=f.pingCache;O!==null&&O.delete(v),v=Ss(),f.pingedLanes|=f.suspendedLanes&P,Ji===f&&(eo&P)===P&&(Gi===4||Gi===3&&(eo&130023424)===eo&&500>bt()-nm?ah(f,0):Vy|=P),$s(f,v)}function Zy(f,v){v===0&&((f.mode&1)===0?v=1:(v=ui,ui<<=1,(ui&130023424)===0&&(ui=4194304)));var P=Ss();f=os(f,v),f!==null&&(Xi(f,v,P),$s(f,P))}function jx(f){var v=f.memoizedState,P=0;v!==null&&(P=v.retryLane),Zy(f,P)}function zS(f,v){var P=0;switch(f.tag){case 13:var O=f.stateNode,W=f.memoizedState;W!==null&&(P=W.retryLane);break;case 19:O=f.stateNode;break;default:throw Error(n(314))}O!==null&&O.delete(v),Zy(f,P)}var sm;sm=function(f,v,P){if(f!==null)if(f.memoizedProps!==v.pendingProps||rs.current)Bs=!0;else{if((f.lanes&P)===0&&(v.flags&128)===0)return Bs=!1,Rx(f,v,P);Bs=(f.flags&131072)!==0}else Bs=!1,Mi&&(v.flags&1048576)!==0&&ju(v,hc,v.index);switch(v.lanes=0,v.tag){case 2:var O=v.type;Pg(f,v),f=v.pendingProps;var W=ga(v,mo.current);Ua(v,P),W=ht(null,v,O,f,W,P);var Q=Ye();return v.flags|=1,typeof W=="object"&&W!==null&&typeof W.render=="function"&&W.$$typeof===void 0?(v.tag=1,v.memoizedState=null,v.updateQueue=null,$o(O)?(Q=!0,Kc(v)):Q=!1,v.memoizedState=W.state!==null&&W.state!==void 0?W.state:null,Ci(v),W.updater=xl,v.stateNode=W,W._reactInternals=v,dd(v,O,f,P),v=th(null,v,O,!0,Q,P)):(v.tag=0,Mi&&Q&&dc(v),Us(null,v,W,P),v=v.child),v;case 16:O=v.elementType;e:{switch(Pg(f,v),f=v.pendingProps,W=O._init,O=W(O._payload),v.type=O,W=v.tag=OS(O),f=Fs(O,f),W){case 0:v=Mg(null,v,O,f,P);break e;case 1:v=ky(null,v,O,f,P);break e;case 11:v=Ly(null,v,O,f,P);break e;case 14:v=Px(null,v,O,Fs(O.type,f),P);break e}throw Error(n(306,O,""))}return v;case 0:return O=v.type,W=v.pendingProps,W=v.elementType===O?W:Fs(O,W),Mg(f,v,O,W,P);case 1:return O=v.type,W=v.pendingProps,W=v.elementType===O?W:Fs(O,W),ky(f,v,O,W,P);case 3:e:{if(Ix(v),f===null)throw Error(n(387));O=v.pendingProps,Q=v.memoizedState,W=Q.element,Kp(f,v),$a(v,O,null,P);var be=v.memoizedState;if(O=be.element,Q.isDehydrated)if(Q={element:O,isDehydrated:!1,cache:be.cache,pendingSuspenseBoundaries:be.pendingSuspenseBoundaries,transitions:be.transitions},v.updateQueue.baseState=Q,v.memoizedState=Q,v.flags&256){W=Ns(Error(n(423)),v),v=bf(f,v,O,P,W);break e}else if(O!==W){W=Ns(Error(n(424)),v),v=bf(f,v,O,P,W);break e}else for(is=ma(v.stateNode.containerInfo.firstChild),dr=v,Mi=!0,_s=null,P=Zp(v,null,O,P),v.child=P;P;)P.flags=P.flags&-3|4096,P=P.sibling;else{if(Wu(),O===W){v=bl(f,v,P);break e}Us(f,v,O,P)}v=v.child}return v;case 5:return x(v),f===null&&Hu(v),O=v.type,W=v.pendingProps,Q=f!==null?f.memoizedProps:null,be=W.children,qp(O,W)?be=null:Q!==null&&qp(O,Q)&&(v.flags|=32),Sg(f,v),Us(f,v,be,P),v.child;case 6:return f===null&&Hu(v),null;case 13:return Dy(f,v,P);case 4:return u(v,v.stateNode.containerInfo),O=v.pendingProps,f===null?v.child=Qc(v,null,O,P):Us(f,v,O,P),v.child;case 11:return O=v.type,W=v.pendingProps,W=v.elementType===O?W:Fs(O,W),Ly(f,v,O,W,P);case 7:return Us(f,v,v.pendingProps,P),v.child;case 8:return Us(f,v,v.pendingProps.children,P),v.child;case 12:return Us(f,v,v.pendingProps.children,P),v.child;case 10:e:{if(O=v.type._context,W=v.pendingProps,Q=v.memoizedProps,be=W.value,Pr(xf,O._currentValue),O._currentValue=be,Q!==null)if(Po(Q.value,be)){if(Q.children===W.children&&!rs.current){v=bl(f,v,P);break e}}else for(Q=v.child,Q!==null&&(Q.return=v);Q!==null;){var st=Q.dependencies;if(st!==null){be=Q.child;for(var gt=st.firstContext;gt!==null;){if(gt.context===O){if(Q.tag===1){gt=jo(-1,P&-P),gt.tag=2;var Bt=Q.updateQueue;if(Bt!==null){Bt=Bt.shared;var wn=Bt.pending;wn===null?gt.next=gt:(gt.next=wn.next,wn.next=gt),Bt.pending=gt}}Q.lanes|=P,gt=Q.alternate,gt!==null&&(gt.lanes|=P),ud(Q.return,P,v),st.lanes|=P;break}gt=gt.next}}else if(Q.tag===10)be=Q.type===v.type?null:Q.child;else if(Q.tag===18){if(be=Q.return,be===null)throw Error(n(341));be.lanes|=P,st=be.alternate,st!==null&&(st.lanes|=P),ud(be,P,v),be=Q.sibling}else be=Q.child;if(be!==null)be.return=Q;else for(be=Q;be!==null;){if(be===v){be=null;break}if(Q=be.sibling,Q!==null){Q.return=be.return,be=Q;break}be=be.return}Q=be}Us(f,v,W.children,P),v=v.child}return v;case 9:return W=v.type,O=v.pendingProps.children,Ua(v,P),W=vi(W),O=O(W),v.flags|=1,Us(f,v,O,P),v.child;case 14:return O=v.type,W=Fs(O,v.pendingProps),W=Fs(O.type,W),Px(f,v,O,W,P);case 15:return wg(f,v,v.type,v.pendingProps,P);case 17:return O=v.type,W=v.pendingProps,W=v.elementType===O?W:Fs(O,W),Pg(f,v),v.tag=1,$o(O)?(f=!0,Kc(v)):f=!1,Ua(v,P),_o(v,O,W),dd(v,O,W,P),th(null,v,O,!0,f,P);case 19:return Oy(f,v,P);case 22:return Ax(f,v,P)}throw Error(n(156,v.tag))};function Hx(f,v){return xr(f,v)}function Gx(f,v,P,O){this.tag=f,this.key=P,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=v,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=O,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ga(f,v,P,O){return new Gx(f,v,P,O)}function Yy(f){return f=f.prototype,!(!f||!f.isReactComponent)}function OS(f){if(typeof f=="function")return Yy(f)?1:0;if(f!=null){if(f=f.$$typeof,f===Ce)return 11;if(f===Fe)return 14}return 2}function iu(f,v){var P=f.alternate;return P===null?(P=Ga(f.tag,v,f.key,f.mode),P.elementType=f.elementType,P.type=f.type,P.stateNode=f.stateNode,P.alternate=f,f.alternate=P):(P.pendingProps=v,P.type=f.type,P.flags=0,P.subtreeFlags=0,P.deletions=null),P.flags=f.flags&14680064,P.childLanes=f.childLanes,P.lanes=f.lanes,P.child=f.child,P.memoizedProps=f.memoizedProps,P.memoizedState=f.memoizedState,P.updateQueue=f.updateQueue,v=f.dependencies,P.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext},P.sibling=f.sibling,P.index=f.index,P.ref=f.ref,P}function Og(f,v,P,O,W,Q){var be=2;if(O=f,typeof f=="function")Yy(f)&&(be=1);else if(typeof f=="string")be=5;else e:switch(f){case ee:return Ed(P.children,W,Q,v);case se:be=8,W|=8;break;case J:return f=Ga(12,P,v,W|2),f.elementType=J,f.lanes=Q,f;case we:return f=Ga(13,P,v,W),f.elementType=we,f.lanes=Q,f;case We:return f=Ga(19,P,v,W),f.elementType=We,f.lanes=Q,f;case Ee:return ch(P,W,Q,v);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case $:be=10;break e;case le:be=9;break e;case Ce:be=11;break e;case Fe:be=14;break e;case Me:be=16,O=null;break e}throw Error(n(130,f==null?f:typeof f,""))}return v=Ga(be,P,v,W),v.elementType=f,v.type=O,v.lanes=Q,v}function Ed(f,v,P,O){return f=Ga(7,f,O,v),f.lanes=P,f}function ch(f,v,P,O){return f=Ga(22,f,O,v),f.elementType=Ee,f.lanes=P,f.stateNode={isHidden:!1},f}function Fg(f,v,P){return f=Ga(6,f,null,v),f.lanes=P,f}function am(f,v,P){return v=Ga(4,f.children!==null?f.children:[],f.key,v),v.lanes=P,v.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},v}function Wx(f,v,P,O,W){this.tag=v,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uo(0),this.expirationTimes=uo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uo(0),this.identifierPrefix=O,this.onRecoverableError=W,this.mutableSourceEagerHydrationData=null}function to(f,v,P,O,W,Q,be,st,gt){return f=new Wx(f,v,P,st,gt),v===1?(v=1,Q===!0&&(v|=8)):v=0,Q=Ga(3,null,null,v),f.current=Q,Q.stateNode=f,Q.memoizedState={element:O,isDehydrated:P,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ci(Q),f}function Ky(f,v,P){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:X,key:O==null?null:""+O,children:f,containerInfo:v,implementation:P}}function qx(f){if(!f)return po;f=f._reactInternals;e:{if(It(f)!==f||f.tag!==1)throw Error(n(170));var v=f;do{switch(v.tag){case 3:v=v.stateNode.context;break e;case 1:if($o(v.type)){v=v.stateNode.__reactInternalMemoizedMergedChildContext;break e}}v=v.return}while(v!==null);throw Error(n(171))}if(f.tag===1){var P=f.type;if($o(P))return id(f,P,v)}return v}function Jy(f,v,P,O,W,Q,be,st,gt){return f=to(P,O,!0,f,W,Q,be,st,gt),f.context=qx(null),P=f.current,O=Ss(),W=ru(P),Q=jo(O,W),Q.callback=v??null,ss(P,Q,W),f.current.lanes=W,Xi(f,W,O),$s(f,O),f}function Cl(f,v,P,O){var W=v.current,Q=Ss(),be=ru(W);return P=qx(P),v.context===null?v.context=P:v.pendingContext=P,v=jo(Q,be),v.payload={element:f},O=O===void 0?null:O,O!==null&&(v.callback=O),f=ss(W,v,be),f!==null&&(na(f,W,be,Q),Xu(f,W,be)),be}function Lf(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return f.child.stateNode;default:return f.child.stateNode}}function Xx(f,v){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var P=f.retryLane;f.retryLane=P!==0&&P<v?P:v}}function Qy(f,v){Xx(f,v),(f=f.alternate)&&Xx(f,v)}function FS(){return null}var e0=typeof reportError=="function"?reportError:function(f){console.error(f)};function lm(f){this._internalRoot=f}cm.prototype.render=lm.prototype.render=function(f){var v=this._internalRoot;if(v===null)throw Error(n(409));Cl(f,v,null,null)},cm.prototype.unmount=lm.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var v=f.containerInfo;Md(function(){Cl(null,f,null,null)}),v[Yi]=null}};function cm(f){this._internalRoot=f}cm.prototype.unstable_scheduleHydration=function(f){if(f){var v=Zl();f={blockedOn:null,target:f,priority:v};for(var P=0;P<Di.length&&v!==0&&v<Di[P].priority;P++);Di.splice(P,0,f),P===0&&Fh(f)}};function Td(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function ou(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11&&(f.nodeType!==8||f.nodeValue!==" react-mount-point-unstable "))}function um(){}function Ng(f,v,P,O,W){if(W){if(typeof O=="function"){var Q=O;O=function(){var Bt=Lf(be);Q.call(Bt)}}var be=Jy(v,O,f,0,null,!1,!1,"",um);return f._reactRootContainer=be,f[Yi]=be.current,zu(f.nodeType===8?f.parentNode:f),Md(),be}for(;W=f.lastChild;)f.removeChild(W);if(typeof O=="function"){var st=O;O=function(){var Bt=Lf(gt);st.call(Bt)}}var gt=to(f,0,!1,null,null,!1,!1,"",um);return f._reactRootContainer=gt,f[Yi]=gt.current,zu(f.nodeType===8?f.parentNode:f),Md(function(){Cl(v,gt,P,O)}),gt}function Bg(f,v,P,O,W){var Q=P._reactRootContainer;if(Q){var be=Q;if(typeof W=="function"){var st=W;W=function(){var gt=Lf(be);st.call(gt)}}Cl(v,be,f,W)}else be=Ng(P,v,f,W,O);return Lf(be)}Er=function(f){switch(f.tag){case 3:var v=f.stateNode;if(v.current.memoizedState.isDehydrated){var P=kr(v.pendingLanes);P!==0&&(Vi(v,P|1),$s(v,bt()),(Jr&6)===0&&(wd=bt()+500,uc()))}break;case 13:Md(function(){var O=os(f,1);if(O!==null){var W=Ss();na(O,f,1,W)}}),Qy(f,1)}},ha=function(f){if(f.tag===13){var v=os(f,134217728);if(v!==null){var P=Ss();na(v,f,134217728,P)}Qy(f,134217728)}},La=function(f){if(f.tag===13){var v=ru(f),P=os(f,v);if(P!==null){var O=Ss();na(P,f,v,O)}Qy(f,v)}},Zl=function(){return Nr},nf=function(f,v){var P=Nr;try{return Nr=f,v()}finally{Nr=P}},Ae=function(f,v,P){switch(v){case"input":if(fn(f,P),v=P.name,P.type==="radio"&&v!=null){for(P=f;P.parentNode;)P=P.parentNode;for(P=P.querySelectorAll("input[name="+JSON.stringify(""+v)+'][type="radio"]'),v=0;v<P.length;v++){var O=P[v];if(O!==f&&O.form===f.form){var W=Bu(O);if(!W)throw Error(n(90));dn(O),fn(O,W)}}}break;case"textarea":Nt(f,P);break;case"select":v=P.value,v!=null&&Ue(f,!!P.multiple,v,!1)}},$t=om,Jt=Md;var NS={usingClientEntryPoint:!1,Events:[Xc,Ba,Bu,dt,qe,om]},kf={findFiberByHostInstance:ta,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Zx={bundleType:kf.bundleType,version:kf.version,rendererPackageName:kf.rendererPackageName,rendererConfig:kf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(f){return f=kn(f),f===null?null:f.stateNode},findFiberByHostInstance:kf.findFiberByHostInstance||FS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ug=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ug.isDisabled&&Ug.supportsFiber)try{Zn=Ug.inject(Zx),In=Ug}catch{}}return Wa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NS,Wa.createPortal=function(f,v){var P=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Td(v))throw Error(n(200));return Ky(f,v,null,P)},Wa.createRoot=function(f,v){if(!Td(f))throw Error(n(299));var P=!1,O="",W=e0;return v!=null&&(v.unstable_strictMode===!0&&(P=!0),v.identifierPrefix!==void 0&&(O=v.identifierPrefix),v.onRecoverableError!==void 0&&(W=v.onRecoverableError)),v=to(f,1,!1,null,null,P,!1,O,W),f[Yi]=v.current,zu(f.nodeType===8?f.parentNode:f),new lm(v)},Wa.findDOMNode=function(f){if(f==null)return null;if(f.nodeType===1)return f;var v=f._reactInternals;if(v===void 0)throw typeof f.render=="function"?Error(n(188)):(f=Object.keys(f).join(","),Error(n(268,f)));return f=kn(v),f=f===null?null:f.stateNode,f},Wa.flushSync=function(f){return Md(f)},Wa.hydrate=function(f,v,P){if(!ou(v))throw Error(n(200));return Bg(null,f,v,!0,P)},Wa.hydrateRoot=function(f,v,P){if(!Td(f))throw Error(n(405));var O=P!=null&&P.hydratedSources||null,W=!1,Q="",be=e0;if(P!=null&&(P.unstable_strictMode===!0&&(W=!0),P.identifierPrefix!==void 0&&(Q=P.identifierPrefix),P.onRecoverableError!==void 0&&(be=P.onRecoverableError)),v=Jy(v,null,f,1,P??null,W,!1,Q,be),f[Yi]=v.current,zu(f),O)for(f=0;f<O.length;f++)P=O[f],W=P._getVersion,W=W(P._source),v.mutableSourceEagerHydrationData==null?v.mutableSourceEagerHydrationData=[P,W]:v.mutableSourceEagerHydrationData.push(P,W);return new cm(v)},Wa.render=function(f,v,P){if(!ou(v))throw Error(n(200));return Bg(null,f,v,!1,P)},Wa.unmountComponentAtNode=function(f){if(!ou(f))throw Error(n(40));return f._reactRootContainer?(Md(function(){Bg(null,null,f,!1,function(){f._reactRootContainer=null,f[Yi]=null})}),!0):!1},Wa.unstable_batchedUpdates=om,Wa.unstable_renderSubtreeIntoContainer=function(f,v,P,O){if(!ou(P))throw Error(n(200));if(f==null||f._reactInternals===void 0)throw Error(n(38));return Bg(f,v,P,!1,O)},Wa.version="18.3.1-next-f1338f8080-20240426",Wa}var i3;function k4(){if(i3)return u2.exports;i3=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),u2.exports=xH(),u2.exports}var Fw=k4();function bH(t){return typeof t=="function"?t():t}const D4=G.forwardRef(function(e,n){const{children:r,container:i,disablePortal:l=!1}=e,[c,s]=G.useState(null),p=mi(G.isValidElement(r)?Rw(r):null,n);if(Hd(()=>{l||s(bH(i)||document.body)},[i,l]),Hd(()=>{if(c&&!l)return Tb(n,c),()=>{Tb(n,null)}},[n,c,l]),l){if(G.isValidElement(r)){const y={ref:p};return G.cloneElement(r,y)}return ie.jsx(G.Fragment,{children:r})}return ie.jsx(G.Fragment,{children:c&&Fw.createPortal(r,c)})});function wH(t={}){const{disabled:e=!1,focusableWhenDisabled:n,rootRef:r}=t,i=G.useContext(kw);if(i===null)throw new Error("useMenuButton: no menu context available.");const{state:l,dispatch:c,registerTrigger:s,popupId:p}=i,{getRootProps:y,rootRef:_,active:w}=kh({disabled:e,focusableWhenDisabled:n,rootRef:r}),S=mi(_,s),M=L=>V=>{var B;(B=L.onClick)==null||B.call(L,V),!V.defaultMuiPrevented&&c({type:gu.toggle,event:V})},I=L=>V=>{var B;(B=L.onKeyDown)==null||B.call(L,V),!V.defaultMuiPrevented&&(V.key==="ArrowDown"||V.key==="ArrowUp")&&(V.preventDefault(),c({type:gu.open,event:V}))},D=(L={})=>({onClick:M(L),onKeyDown:I(L)});return{active:w,getRootProps:(L={})=>{const V=ps(L),B=Gd(D,y);return me({"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":p},L,V,B(V),{tabIndex:0,ref:S})},open:l.open,rootRef:S}}function SH(t){return`menu-item-${t.size}`}const MH={dispatch:()=>{}};function CH(t){var e;const{disabled:n=!1,id:r,rootRef:i,label:l,disableFocusOnHover:c=!1}=t,s=il(r),p=G.useRef(null),y=G.useMemo(()=>({disabled:n,id:s??"",label:l,ref:p}),[n,s,l]),{dispatch:_}=(e=G.useContext(kw))!=null?e:MH,{getRootProps:w,highlighted:S}=WP({item:s,handlePointerOverEvents:!c}),{index:M,totalItemCount:I}=Ow(s??SH,y),{getRootProps:D,focusVisible:R,rootRef:L}=kh({disabled:n,focusableWhenDisabled:!0}),V=mi(L,i,p);G.useDebugValue({id:s,highlighted:S,disabled:n,label:l});const B=X=>ee=>{var se;(se=X.onClick)==null||se.call(X,ee),!ee.defaultMuiPrevented&&_({type:gu.close,event:ee})},H=(X={})=>me({},X,{onClick:B(X)});function q(X={}){const ee=ps(X),se=Gd(H,Gd(D,w));return me({},X,ee,se(ee),{id:s,ref:V,role:"menuitem"})}return s===void 0?{getRootProps:q,disabled:!1,focusVisible:R,highlighted:!1,index:-1,totalItemCount:0,rootRef:V}:{getRootProps:q,disabled:n,focusVisible:R,highlighted:S,index:M,totalItemCount:I,rootRef:V}}function EH(t){const e=G.useContext(pp);if(!e)throw new Error("MenuItem: ListContext was not found.");const n=il(t),{getItemState:r,dispatch:i}=e;let l;n!=null?l=r(n):l={focusable:!0,highlighted:!1,selected:!1};const{highlighted:c,selected:s,focusable:p}=l,y=G.useCallback(w=>{if(w!==n)throw new Error(["Base UI MenuItem: Tried to access the state of another MenuItem.",`itemValue: ${w} | id: ${n}`,"This is unsupported when the MenuItem uses the MenuItemContextStabilizer as a performance optimization."].join("/n"));return{highlighted:c,selected:s,focusable:p}},[c,s,p,n]);return{contextValue:G.useMemo(()=>({dispatch:i,getItemState:y}),[i,y]),id:n}}function TH(t){const e=Gl(t);return e.body===t?BP(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function $0(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function o3(t){return parseInt(BP(t).getComputedStyle(t).paddingRight,10)||0}function PH(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function s3(t,e,n,r,i){const l=[e,n,...r];[].forEach.call(t.children,c=>{const s=l.indexOf(c)===-1,p=!PH(c);s&&p&&$0(c,i)})}function f2(t,e){let n=-1;return t.some((r,i)=>e(r)?(n=i,!0):!1),n}function AH(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(TH(r)){const c=F9(Gl(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${o3(r)+c}px`;const s=Gl(r).querySelectorAll(".mui-fixed");[].forEach.call(s,p=>{n.push({value:p.style.paddingRight,property:"padding-right",el:p}),p.style.paddingRight=`${o3(p)+c}px`})}let l;if(r.parentNode instanceof DocumentFragment)l=Gl(r).body;else{const c=r.parentElement,s=BP(r);l=c?.nodeName==="HTML"&&s.getComputedStyle(c).overflowY==="scroll"?c:r}n.push({value:l.style.overflow,property:"overflow",el:l},{value:l.style.overflowX,property:"overflow-x",el:l},{value:l.style.overflowY,property:"overflow-y",el:l}),l.style.overflow="hidden"}return()=>{n.forEach(({value:l,el:c,property:s})=>{l?c.style.setProperty(s,l):c.style.removeProperty(s)})}}function IH(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class RH{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&$0(e.modalRef,!1);const i=IH(n);s3(n,e.mount,e.modalRef,i,!0);const l=f2(this.containers,c=>c.container===n);return l!==-1?(this.containers[l].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:i}),r)}mount(e,n){const r=f2(this.containers,l=>l.modals.indexOf(e)!==-1),i=this.containers[r];i.restore||(i.restore=AH(i,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const i=f2(this.containers,c=>c.modals.indexOf(e)!==-1),l=this.containers[i];if(l.modals.splice(l.modals.indexOf(e),1),this.modals.splice(r,1),l.modals.length===0)l.restore&&l.restore(),e.modalRef&&$0(e.modalRef,n),s3(l.container,e.mount,e.modalRef,l.hiddenSiblings,!1),this.containers.splice(i,1);else{const c=l.modals[l.modals.length-1];c.modalRef&&$0(c.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function LH(t){return typeof t=="function"?t():t}function kH(t){return t?t.props.hasOwnProperty("in"):!1}const DH=new RH;function zH(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,manager:i=DH,closeAfterTransition:l=!1,onTransitionEnter:c,onTransitionExited:s,children:p,onClose:y,open:_,rootRef:w}=t,S=G.useRef({}),M=G.useRef(null),I=G.useRef(null),D=mi(I,w),[R,L]=G.useState(!_),V=kH(p);let B=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(B=!1);const H=()=>Gl(M.current),q=()=>(S.current.modalRef=I.current,S.current.mount=M.current,S.current),X=()=>{i.mount(q(),{disableScrollLock:r}),I.current&&(I.current.scrollTop=0)},ee=yu(()=>{const Me=LH(e)||H().body;i.add(q(),Me),I.current&&X()}),se=G.useCallback(()=>i.isTopModal(q()),[i]),J=yu(Me=>{M.current=Me,Me&&(_&&se()?X():I.current&&$0(I.current,B))}),$=G.useCallback(()=>{i.remove(q(),B)},[B,i]);G.useEffect(()=>()=>{$()},[$]),G.useEffect(()=>{_?ee():(!V||!l)&&$()},[_,$,V,l,ee]);const le=Me=>Ee=>{var Te;(Te=Me.onKeyDown)==null||Te.call(Me,Ee),!(Ee.key!=="Escape"||Ee.which===229||!se())&&(n||(Ee.stopPropagation(),y&&y(Ee,"escapeKeyDown")))},Ce=Me=>Ee=>{var Te;(Te=Me.onClick)==null||Te.call(Me,Ee),Ee.target===Ee.currentTarget&&y&&y(Ee,"backdropClick")};return{getRootProps:(Me={})=>{const Ee=ps(t);delete Ee.onTransitionEnter,delete Ee.onTransitionExited;const Te=me({},Ee,Me);return me({role:"presentation"},Te,{onKeyDown:le(Te),ref:D})},getBackdropProps:(Me={})=>{const Ee=Me;return me({"aria-hidden":!0},Ee,{onClick:Ce(Ee),open:_})},getTransitionProps:()=>{const Me=()=>{L(!1),c&&c()},Ee=()=>{L(!0),s&&s(),l&&$()};return{onEnter:UR(Me,p?.props.onEnter),onExited:UR(Ee,p?.props.onExited)}},rootRef:D,portalRef:J,isTopModal:se,exited:R,hasTransition:V}}function OH(t){const{value:e,label:n,disabled:r,rootRef:i,id:l}=t,{getRootProps:c,highlighted:s,selected:p}=WP({item:e}),{getRootProps:y,rootRef:_}=kh({disabled:r,focusableWhenDisabled:!0}),w=il(l),S=G.useRef(null),M=G.useMemo(()=>({disabled:r,label:n,value:e,ref:S,id:w}),[r,n,e,w]),{index:I}=Ow(e,M),D=mi(i,S,_),R=V=>B=>{var H;(H=V.onKeyDown)==null||H.call(V,B),!B.defaultMuiPrevented&&[" ","Enter"].includes(B.key)&&(B.defaultMuiPrevented=!0)},L=(V={})=>({onKeyDown:R(V)});return{getRootProps:(V={})=>{const B=ps(V),H=Gd(c,Gd(y,L));return me({},V,B,H(B),{id:w,ref:D,role:"option","aria-selected":p})},highlighted:s,index:I,selected:p,rootRef:D}}function FH(t){const e=G.useContext(pp);if(!e)throw new Error("Option: ListContext was not found.");const{getItemState:n,dispatch:r}=e,{highlighted:i,selected:l,focusable:c}=n(t),s=G.useCallback(y=>{if(y!==t)throw new Error(["Base UI Option: Tried to access the state of another Option.","This is unsupported when the Option uses the OptionContextStabilizer as a performance optimization."].join("/n"));return{highlighted:i,selected:l,focusable:c}},[i,l,c,t]);return{contextValue:G.useMemo(()=>({dispatch:r,getItemState:s}),[r,s])}}var Qa="top",Ic="bottom",Rc="right",el="left",qP="auto",H_=[Qa,Ic,Rc,el],Zv="start",y_="end",NH="clippingParents",z4="viewport",l0="popper",BH="reference",a3=H_.reduce(function(t,e){return t.concat([e+"-"+Zv,e+"-"+y_])},[]),O4=[].concat(H_,[qP]).reduce(function(t,e){return t.concat([e,e+"-"+Zv,e+"-"+y_])},[]),UH="beforeRead",$H="read",VH="afterRead",jH="beforeMain",HH="main",GH="afterMain",WH="beforeWrite",qH="write",XH="afterWrite",ZH=[UH,$H,VH,jH,HH,GH,WH,qH,XH];function Ah(t){return t?(t.nodeName||"").toLowerCase():null}function Xl(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Um(t){var e=Xl(t).Element;return t instanceof e||t instanceof Element}function Ac(t){var e=Xl(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function XP(t){if(typeof ShadowRoot>"u")return!1;var e=Xl(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function YH(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},l=e.elements[n];!Ac(l)||!Ah(l)||(Object.assign(l.style,r),Object.keys(i).forEach(function(c){var s=i[c];s===!1?l.removeAttribute(c):l.setAttribute(c,s===!0?"":s)}))})}function KH(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],l=e.attributes[r]||{},c=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),s=c.reduce(function(p,y){return p[y]="",p},{});!Ac(i)||!Ah(i)||(Object.assign(i.style,s),Object.keys(l).forEach(function(p){i.removeAttribute(p)}))})}}const JH={name:"applyStyles",enabled:!0,phase:"write",fn:YH,effect:KH,requires:["computeStyles"]};function Ch(t){return t.split("-")[0]}var Om=Math.max,Pb=Math.min,Yv=Math.round;function $E(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function F4(){return!/^((?!chrome|android).)*safari/i.test($E())}function Kv(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,l=1;e&&Ac(t)&&(i=t.offsetWidth>0&&Yv(r.width)/t.offsetWidth||1,l=t.offsetHeight>0&&Yv(r.height)/t.offsetHeight||1);var c=Um(t)?Xl(t):window,s=c.visualViewport,p=!F4()&&n,y=(r.left+(p&&s?s.offsetLeft:0))/i,_=(r.top+(p&&s?s.offsetTop:0))/l,w=r.width/i,S=r.height/l;return{width:w,height:S,top:_,right:y+w,bottom:_+S,left:y,x:y,y:_}}function ZP(t){var e=Kv(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function N4(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&XP(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Wd(t){return Xl(t).getComputedStyle(t)}function QH(t){return["table","td","th"].indexOf(Ah(t))>=0}function mp(t){return((Um(t)?t.ownerDocument:t.document)||window.document).documentElement}function Nw(t){return Ah(t)==="html"?t:t.assignedSlot||t.parentNode||(XP(t)?t.host:null)||mp(t)}function l3(t){return!Ac(t)||Wd(t).position==="fixed"?null:t.offsetParent}function eG(t){var e=/firefox/i.test($E()),n=/Trident/i.test($E());if(n&&Ac(t)){var r=Wd(t);if(r.position==="fixed")return null}var i=Nw(t);for(XP(i)&&(i=i.host);Ac(i)&&["html","body"].indexOf(Ah(i))<0;){var l=Wd(i);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return i;i=i.parentNode}return null}function G_(t){for(var e=Xl(t),n=l3(t);n&&QH(n)&&Wd(n).position==="static";)n=l3(n);return n&&(Ah(n)==="html"||Ah(n)==="body"&&Wd(n).position==="static")?e:n||eG(t)||e}function YP(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function V0(t,e,n){return Om(t,Pb(e,n))}function tG(t,e,n){var r=V0(t,e,n);return r>n?n:r}function B4(){return{top:0,right:0,bottom:0,left:0}}function U4(t){return Object.assign({},B4(),t)}function $4(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var nG=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,U4(typeof e!="number"?e:$4(e,H_))};function rG(t){var e,n=t.state,r=t.name,i=t.options,l=n.elements.arrow,c=n.modifiersData.popperOffsets,s=Ch(n.placement),p=YP(s),y=[el,Rc].indexOf(s)>=0,_=y?"height":"width";if(!(!l||!c)){var w=nG(i.padding,n),S=ZP(l),M=p==="y"?Qa:el,I=p==="y"?Ic:Rc,D=n.rects.reference[_]+n.rects.reference[p]-c[p]-n.rects.popper[_],R=c[p]-n.rects.reference[p],L=G_(l),V=L?p==="y"?L.clientHeight||0:L.clientWidth||0:0,B=D/2-R/2,H=w[M],q=V-S[_]-w[I],X=V/2-S[_]/2+B,ee=V0(H,X,q),se=p;n.modifiersData[r]=(e={},e[se]=ee,e.centerOffset=ee-X,e)}}function iG(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||N4(e.elements.popper,i)&&(e.elements.arrow=i))}const oG={name:"arrow",enabled:!0,phase:"main",fn:rG,effect:iG,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Jv(t){return t.split("-")[1]}var sG={top:"auto",right:"auto",bottom:"auto",left:"auto"};function aG(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:Yv(n*i)/i||0,y:Yv(r*i)/i||0}}function c3(t){var e,n=t.popper,r=t.popperRect,i=t.placement,l=t.variation,c=t.offsets,s=t.position,p=t.gpuAcceleration,y=t.adaptive,_=t.roundOffsets,w=t.isFixed,S=c.x,M=S===void 0?0:S,I=c.y,D=I===void 0?0:I,R=typeof _=="function"?_({x:M,y:D}):{x:M,y:D};M=R.x,D=R.y;var L=c.hasOwnProperty("x"),V=c.hasOwnProperty("y"),B=el,H=Qa,q=window;if(y){var X=G_(n),ee="clientHeight",se="clientWidth";if(X===Xl(n)&&(X=mp(n),Wd(X).position!=="static"&&s==="absolute"&&(ee="scrollHeight",se="scrollWidth")),X=X,i===Qa||(i===el||i===Rc)&&l===y_){H=Ic;var J=w&&X===q&&q.visualViewport?q.visualViewport.height:X[ee];D-=J-r.height,D*=p?1:-1}if(i===el||(i===Qa||i===Ic)&&l===y_){B=Rc;var $=w&&X===q&&q.visualViewport?q.visualViewport.width:X[se];M-=$-r.width,M*=p?1:-1}}var le=Object.assign({position:s},y&&sG),Ce=_===!0?aG({x:M,y:D},Xl(n)):{x:M,y:D};if(M=Ce.x,D=Ce.y,p){var we;return Object.assign({},le,(we={},we[H]=V?"0":"",we[B]=L?"0":"",we.transform=(q.devicePixelRatio||1)<=1?"translate("+M+"px, "+D+"px)":"translate3d("+M+"px, "+D+"px, 0)",we))}return Object.assign({},le,(e={},e[H]=V?D+"px":"",e[B]=L?M+"px":"",e.transform="",e))}function lG(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,l=n.adaptive,c=l===void 0?!0:l,s=n.roundOffsets,p=s===void 0?!0:s,y={placement:Ch(e.placement),variation:Jv(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,c3(Object.assign({},y,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,c3(Object.assign({},y,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const cG={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:lG,data:{}};var s1={passive:!0};function uG(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,l=i===void 0?!0:i,c=r.resize,s=c===void 0?!0:c,p=Xl(e.elements.popper),y=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&y.forEach(function(_){_.addEventListener("scroll",n.update,s1)}),s&&p.addEventListener("resize",n.update,s1),function(){l&&y.forEach(function(_){_.removeEventListener("scroll",n.update,s1)}),s&&p.removeEventListener("resize",n.update,s1)}}const hG={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:uG,data:{}};var dG={left:"right",right:"left",bottom:"top",top:"bottom"};function nb(t){return t.replace(/left|right|bottom|top/g,function(e){return dG[e]})}var fG={start:"end",end:"start"};function u3(t){return t.replace(/start|end/g,function(e){return fG[e]})}function KP(t){var e=Xl(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function JP(t){return Kv(mp(t)).left+KP(t).scrollLeft}function pG(t,e){var n=Xl(t),r=mp(t),i=n.visualViewport,l=r.clientWidth,c=r.clientHeight,s=0,p=0;if(i){l=i.width,c=i.height;var y=F4();(y||!y&&e==="fixed")&&(s=i.offsetLeft,p=i.offsetTop)}return{width:l,height:c,x:s+JP(t),y:p}}function mG(t){var e,n=mp(t),r=KP(t),i=(e=t.ownerDocument)==null?void 0:e.body,l=Om(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=Om(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),s=-r.scrollLeft+JP(t),p=-r.scrollTop;return Wd(i||n).direction==="rtl"&&(s+=Om(n.clientWidth,i?i.clientWidth:0)-l),{width:l,height:c,x:s,y:p}}function QP(t){var e=Wd(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function V4(t){return["html","body","#document"].indexOf(Ah(t))>=0?t.ownerDocument.body:Ac(t)&&QP(t)?t:V4(Nw(t))}function j0(t,e){var n;e===void 0&&(e=[]);var r=V4(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),l=Xl(r),c=i?[l].concat(l.visualViewport||[],QP(r)?r:[]):r,s=e.concat(c);return i?s:s.concat(j0(Nw(c)))}function VE(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function gG(t,e){var n=Kv(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function h3(t,e,n){return e===z4?VE(pG(t,n)):Um(e)?gG(e,n):VE(mG(mp(t)))}function vG(t){var e=j0(Nw(t)),n=["absolute","fixed"].indexOf(Wd(t).position)>=0,r=n&&Ac(t)?G_(t):t;return Um(r)?e.filter(function(i){return Um(i)&&N4(i,r)&&Ah(i)!=="body"}):[]}function yG(t,e,n,r){var i=e==="clippingParents"?vG(t):[].concat(e),l=[].concat(i,[n]),c=l[0],s=l.reduce(function(p,y){var _=h3(t,y,r);return p.top=Om(_.top,p.top),p.right=Pb(_.right,p.right),p.bottom=Pb(_.bottom,p.bottom),p.left=Om(_.left,p.left),p},h3(t,c,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function j4(t){var e=t.reference,n=t.element,r=t.placement,i=r?Ch(r):null,l=r?Jv(r):null,c=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2,p;switch(i){case Qa:p={x:c,y:e.y-n.height};break;case Ic:p={x:c,y:e.y+e.height};break;case Rc:p={x:e.x+e.width,y:s};break;case el:p={x:e.x-n.width,y:s};break;default:p={x:e.x,y:e.y}}var y=i?YP(i):null;if(y!=null){var _=y==="y"?"height":"width";switch(l){case Zv:p[y]=p[y]-(e[_]/2-n[_]/2);break;case y_:p[y]=p[y]+(e[_]/2-n[_]/2);break}}return p}function __(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,l=n.strategy,c=l===void 0?t.strategy:l,s=n.boundary,p=s===void 0?NH:s,y=n.rootBoundary,_=y===void 0?z4:y,w=n.elementContext,S=w===void 0?l0:w,M=n.altBoundary,I=M===void 0?!1:M,D=n.padding,R=D===void 0?0:D,L=U4(typeof R!="number"?R:$4(R,H_)),V=S===l0?BH:l0,B=t.rects.popper,H=t.elements[I?V:S],q=yG(Um(H)?H:H.contextElement||mp(t.elements.popper),p,_,c),X=Kv(t.elements.reference),ee=j4({reference:X,element:B,placement:i}),se=VE(Object.assign({},B,ee)),J=S===l0?se:X,$={top:q.top-J.top+L.top,bottom:J.bottom-q.bottom+L.bottom,left:q.left-J.left+L.left,right:J.right-q.right+L.right},le=t.modifiersData.offset;if(S===l0&&le){var Ce=le[i];Object.keys($).forEach(function(we){var We=[Rc,Ic].indexOf(we)>=0?1:-1,Fe=[Qa,Ic].indexOf(we)>=0?"y":"x";$[we]+=Ce[Fe]*We})}return $}function _G(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,l=n.rootBoundary,c=n.padding,s=n.flipVariations,p=n.allowedAutoPlacements,y=p===void 0?O4:p,_=Jv(r),w=_?s?a3:a3.filter(function(I){return Jv(I)===_}):H_,S=w.filter(function(I){return y.indexOf(I)>=0});S.length===0&&(S=w);var M=S.reduce(function(I,D){return I[D]=__(t,{placement:D,boundary:i,rootBoundary:l,padding:c})[Ch(D)],I},{});return Object.keys(M).sort(function(I,D){return M[I]-M[D]})}function xG(t){if(Ch(t)===qP)return[];var e=nb(t);return[u3(t),e,u3(e)]}function bG(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,l=i===void 0?!0:i,c=n.altAxis,s=c===void 0?!0:c,p=n.fallbackPlacements,y=n.padding,_=n.boundary,w=n.rootBoundary,S=n.altBoundary,M=n.flipVariations,I=M===void 0?!0:M,D=n.allowedAutoPlacements,R=e.options.placement,L=Ch(R),V=L===R,B=p||(V||!I?[nb(R)]:xG(R)),H=[R].concat(B).reduce(function(je,ct){return je.concat(Ch(ct)===qP?_G(e,{placement:ct,boundary:_,rootBoundary:w,padding:y,flipVariations:I,allowedAutoPlacements:D}):ct)},[]),q=e.rects.reference,X=e.rects.popper,ee=new Map,se=!0,J=H[0],$=0;$<H.length;$++){var le=H[$],Ce=Ch(le),we=Jv(le)===Zv,We=[Qa,Ic].indexOf(Ce)>=0,Fe=We?"width":"height",Me=__(e,{placement:le,boundary:_,rootBoundary:w,altBoundary:S,padding:y}),Ee=We?we?Rc:el:we?Ic:Qa;q[Fe]>X[Fe]&&(Ee=nb(Ee));var Te=nb(Ee),Ze=[];if(l&&Ze.push(Me[Ce]<=0),s&&Ze.push(Me[Ee]<=0,Me[Te]<=0),Ze.every(function(je){return je})){J=le,se=!1;break}ee.set(le,Ze)}if(se)for(var rt=I?3:1,Re=function(ct){var Ct=H.find(function(ut){var lt=ee.get(ut);if(lt)return lt.slice(0,ct).every(function(_t){return _t})});if(Ct)return J=Ct,"break"},Qe=rt;Qe>0;Qe--){var Vt=Re(Qe);if(Vt==="break")break}e.placement!==J&&(e.modifiersData[r]._skip=!0,e.placement=J,e.reset=!0)}}const wG={name:"flip",enabled:!0,phase:"main",fn:bG,requiresIfExists:["offset"],data:{_skip:!1}};function d3(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function f3(t){return[Qa,Rc,Ic,el].some(function(e){return t[e]>=0})}function SG(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,l=e.modifiersData.preventOverflow,c=__(e,{elementContext:"reference"}),s=__(e,{altBoundary:!0}),p=d3(c,r),y=d3(s,i,l),_=f3(p),w=f3(y);e.modifiersData[n]={referenceClippingOffsets:p,popperEscapeOffsets:y,isReferenceHidden:_,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":_,"data-popper-escaped":w})}const MG={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:SG};function CG(t,e,n){var r=Ch(t),i=[el,Qa].indexOf(r)>=0?-1:1,l=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,c=l[0],s=l[1];return c=c||0,s=(s||0)*i,[el,Rc].indexOf(r)>=0?{x:s,y:c}:{x:c,y:s}}function EG(t){var e=t.state,n=t.options,r=t.name,i=n.offset,l=i===void 0?[0,0]:i,c=O4.reduce(function(_,w){return _[w]=CG(w,e.rects,l),_},{}),s=c[e.placement],p=s.x,y=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=y),e.modifiersData[r]=c}const TG={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:EG};function PG(t){var e=t.state,n=t.name;e.modifiersData[n]=j4({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const AG={name:"popperOffsets",enabled:!0,phase:"read",fn:PG,data:{}};function IG(t){return t==="x"?"y":"x"}function RG(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,l=i===void 0?!0:i,c=n.altAxis,s=c===void 0?!1:c,p=n.boundary,y=n.rootBoundary,_=n.altBoundary,w=n.padding,S=n.tether,M=S===void 0?!0:S,I=n.tetherOffset,D=I===void 0?0:I,R=__(e,{boundary:p,rootBoundary:y,padding:w,altBoundary:_}),L=Ch(e.placement),V=Jv(e.placement),B=!V,H=YP(L),q=IG(H),X=e.modifiersData.popperOffsets,ee=e.rects.reference,se=e.rects.popper,J=typeof D=="function"?D(Object.assign({},e.rects,{placement:e.placement})):D,$=typeof J=="number"?{mainAxis:J,altAxis:J}:Object.assign({mainAxis:0,altAxis:0},J),le=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ce={x:0,y:0};if(X){if(l){var we,We=H==="y"?Qa:el,Fe=H==="y"?Ic:Rc,Me=H==="y"?"height":"width",Ee=X[H],Te=Ee+R[We],Ze=Ee-R[Fe],rt=M?-se[Me]/2:0,Re=V===Zv?ee[Me]:se[Me],Qe=V===Zv?-se[Me]:-ee[Me],Vt=e.elements.arrow,je=M&&Vt?ZP(Vt):{width:0,height:0},ct=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:B4(),Ct=ct[We],ut=ct[Fe],lt=V0(0,ee[Me],je[Me]),_t=B?ee[Me]/2-rt-lt-Ct-$.mainAxis:Re-lt-Ct-$.mainAxis,wt=B?-ee[Me]/2+rt+lt+ut+$.mainAxis:Qe+lt+ut+$.mainAxis,cn=e.elements.arrow&&G_(e.elements.arrow),dn=cn?H==="y"?cn.clientTop||0:cn.clientLeft||0:0,tn=(we=le?.[H])!=null?we:0,Je=Ee+_t-tn-dn,Tn=Ee+wt-tn,Kt=V0(M?Pb(Te,Je):Te,Ee,M?Om(Ze,Tn):Ze);X[H]=Kt,Ce[H]=Kt-Ee}if(s){var fn,Ut=H==="x"?Qa:el,On=H==="x"?Ic:Rc,vn=X[q],Ue=q==="y"?"height":"width",Se=vn+R[Ut],yt=vn-R[On],Nt=[Qa,el].indexOf(L)!==-1,Ht=(fn=le?.[q])!=null?fn:0,Ot=Nt?Se:vn-ee[Ue]-se[Ue]-Ht+$.altAxis,un=Nt?vn+ee[Ue]+se[Ue]-Ht-$.altAxis:yt,Gt=M&&Nt?tG(Ot,vn,un):V0(M?Ot:Se,vn,M?un:yt);X[q]=Gt,Ce[q]=Gt-vn}e.modifiersData[r]=Ce}}const LG={name:"preventOverflow",enabled:!0,phase:"main",fn:RG,requiresIfExists:["offset"]};function kG(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function DG(t){return t===Xl(t)||!Ac(t)?KP(t):kG(t)}function zG(t){var e=t.getBoundingClientRect(),n=Yv(e.width)/t.offsetWidth||1,r=Yv(e.height)/t.offsetHeight||1;return n!==1||r!==1}function OG(t,e,n){n===void 0&&(n=!1);var r=Ac(e),i=Ac(e)&&zG(e),l=mp(e),c=Kv(t,i,n),s={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(r||!r&&!n)&&((Ah(e)!=="body"||QP(l))&&(s=DG(e)),Ac(e)?(p=Kv(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):l&&(p.x=JP(l))),{x:c.left+s.scrollLeft-p.x,y:c.top+s.scrollTop-p.y,width:c.width,height:c.height}}function FG(t){var e=new Map,n=new Set,r=[];t.forEach(function(l){e.set(l.name,l)});function i(l){n.add(l.name);var c=[].concat(l.requires||[],l.requiresIfExists||[]);c.forEach(function(s){if(!n.has(s)){var p=e.get(s);p&&i(p)}}),r.push(l)}return t.forEach(function(l){n.has(l.name)||i(l)}),r}function NG(t){var e=FG(t);return ZH.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function BG(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function UG(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var p3={placement:"bottom",modifiers:[],strategy:"absolute"};function m3(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function $G(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,l=i===void 0?p3:i;return function(s,p,y){y===void 0&&(y=l);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},p3,l),modifiersData:{},elements:{reference:s,popper:p},attributes:{},styles:{}},w=[],S=!1,M={state:_,setOptions:function(L){var V=typeof L=="function"?L(_.options):L;D(),_.options=Object.assign({},l,_.options,V),_.scrollParents={reference:Um(s)?j0(s):s.contextElement?j0(s.contextElement):[],popper:j0(p)};var B=NG(UG([].concat(r,_.options.modifiers)));return _.orderedModifiers=B.filter(function(H){return H.enabled}),I(),M.update()},forceUpdate:function(){if(!S){var L=_.elements,V=L.reference,B=L.popper;if(m3(V,B)){_.rects={reference:OG(V,G_(B),_.options.strategy==="fixed"),popper:ZP(B)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function($){return _.modifiersData[$.name]=Object.assign({},$.data)});for(var H=0;H<_.orderedModifiers.length;H++){if(_.reset===!0){_.reset=!1,H=-1;continue}var q=_.orderedModifiers[H],X=q.fn,ee=q.options,se=ee===void 0?{}:ee,J=q.name;typeof X=="function"&&(_=X({state:_,options:se,name:J,instance:M})||_)}}}},update:BG(function(){return new Promise(function(R){M.forceUpdate(),R(_)})}),destroy:function(){D(),S=!0}};if(!m3(s,p))return M;M.setOptions(y).then(function(R){!S&&y.onFirstUpdate&&y.onFirstUpdate(R)});function I(){_.orderedModifiers.forEach(function(R){var L=R.name,V=R.options,B=V===void 0?{}:V,H=R.effect;if(typeof H=="function"){var q=H({state:_,name:L,instance:M,options:B}),X=function(){};w.push(q||X)}})}function D(){w.forEach(function(R){return R()}),w=[]}return M}}var VG=[hG,AG,cG,JH,TG,wG,LG,oG,MG],jG=$G({defaultModifiers:VG});const HG="Popper";function GG(t){return L7(HG,t)}const WG=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],qG=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function XG(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function jE(t){return typeof t=="function"?t():t}function ZG(t){return t.nodeType!==void 0}const YG=()=>Vr({root:["root"]},P7(GG)),KG={},JG=G.forwardRef(function(e,n){var r;const{anchorEl:i,children:l,direction:c,disablePortal:s,modifiers:p,open:y,placement:_,popperOptions:w,popperRef:S,slotProps:M={},slots:I={},TransitionProps:D}=e,R=rr(e,WG),L=G.useRef(null),V=mi(L,n),B=G.useRef(null),H=mi(B,S),q=G.useRef(H);Hd(()=>{q.current=H},[H]),G.useImperativeHandle(S,()=>B.current,[]);const X=XG(_,c),[ee,se]=G.useState(X),[J,$]=G.useState(jE(i));G.useEffect(()=>{B.current&&B.current.forceUpdate()}),G.useEffect(()=>{i&&$(jE(i))},[i]),Hd(()=>{if(!J||!y)return;const Fe=Te=>{se(Te.placement)};let Me=[{name:"preventOverflow",options:{altBoundary:s}},{name:"flip",options:{altBoundary:s}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:Te})=>{Fe(Te)}}];p!=null&&(Me=Me.concat(p)),w&&w.modifiers!=null&&(Me=Me.concat(w.modifiers));const Ee=jG(J,L.current,me({placement:X},w,{modifiers:Me}));return q.current(Ee),()=>{Ee.destroy(),q.current(null)}},[J,s,p,y,w,X]);const le={placement:ee};D!==null&&(le.TransitionProps=D);const Ce=YG(),we=(r=I.root)!=null?r:"div",We=E4({elementType:we,externalSlotProps:M.root,externalForwardedProps:R,additionalProps:{role:"tooltip",ref:V},ownerState:e,className:Ce.root});return ie.jsx(we,me({},We,{children:typeof l=="function"?l(le):l}))}),Bw=G.forwardRef(function(e,n){const{anchorEl:r,children:i,container:l,direction:c="ltr",disablePortal:s=!1,keepMounted:p=!1,modifiers:y,open:_,placement:w="bottom",popperOptions:S=KG,popperRef:M,style:I,transition:D=!1,slotProps:R={},slots:L={}}=e,V=rr(e,qG),[B,H]=G.useState(!0),q=()=>{H(!1)},X=()=>{H(!0)};if(!p&&!_&&(!D||B))return null;let ee;if(l)ee=l;else if(r){const $=jE(r);ee=$&&ZG($)?Gl($).body:Gl(null).body}const se=!_&&p&&(!D||B)?"none":void 0,J=D?{in:_,onEnter:q,onExited:X}:void 0;return ie.jsx(D4,{disablePortal:s,container:ee,children:ie.jsx(JG,me({anchorEl:r,direction:c,disablePortal:s,modifiers:y,ref:n,open:D?!B:_,placement:w,popperOptions:S,popperRef:M,slotProps:R,slots:L},V,{style:me({position:"fixed",top:0,left:0,display:se},I),TransitionProps:J,children:i}))})}),Ab={buttonClick:"buttonClick",browserAutoFill:"browserAutoFill"},QG=t=>{const{label:e,value:n}=t;return typeof e=="string"?e:typeof n=="string"?n:String(t)};function eW(t,e){const{open:n}=t,{context:{selectionMode:r}}=e;if(e.type===Ab.buttonClick){var i;const p=(i=t.selectedValues[0])!=null?i:Ps(null,"start",e.context);return me({},t,{open:!n,highlightedValue:n?null:p})}if(e.type===Ab.browserAutoFill)return HP(e.item,t,e.context);const l=Dw(t,e);switch(e.type){case ki.keyDown:if(t.open){if(e.event.key==="Escape")return me({},l,{open:!1})}else{if(e.event.key==="ArrowDown"){var c;return me({},t,{open:!0,highlightedValue:(c=t.selectedValues[0])!=null?c:Ps(null,"start",e.context)})}if(e.event.key==="ArrowUp"){var s;return me({},t,{open:!0,highlightedValue:(s=t.selectedValues[0])!=null?s:Ps(null,"end",e.context)})}}break;case ki.itemClick:if(r==="single")return me({},l,{open:!1});break;case ki.blur:return me({},l,{open:!1});default:return l}return l}function tW(t){return Array.isArray(t)?t.length===0?"":JSON.stringify(t.map(e=>e.value)):t?.value==null?"":typeof t.value=="string"||typeof t.value=="number"?t.value:JSON.stringify(t.value)}function nW(t){const{areOptionsEqual:e,buttonRef:n,defaultOpen:r=!1,defaultValue:i,disabled:l=!1,listboxId:c,listboxRef:s,multiple:p=!1,name:y,required:_,onChange:w,onHighlightChange:S,onOpenChange:M,open:I,options:D,getOptionAsString:R=QG,getSerializedValue:L=tW,value:V,componentName:B="useSelect"}=t,H=G.useRef(null),q=mi(n,H),X=G.useRef(null),ee=il(c);let se;V===void 0&&i===void 0?se=[]:i!==void 0&&(p?se=i:se=i==null?[]:[i]);const J=G.useMemo(()=>{if(V!==void 0)return p?V:V==null?[]:[V]},[V,p]),{subitems:$,contextValue:le}=zw(),Ce=G.useMemo(()=>D!=null?new Map(D.map((Pe,ae)=>[Pe.value,{value:Pe.value,label:Pe.label,disabled:Pe.disabled,ref:G.createRef(),id:`${ee}_${ae}`}])):$,[D,$,ee]),we=mi(s,X),{getRootProps:We,active:Fe,focusVisible:Me,rootRef:Ee}=kh({disabled:l,rootRef:q}),Te=G.useMemo(()=>Array.from(Ce.keys()),[Ce]),Ze=G.useCallback(Pe=>{if(e!==void 0){const ae=Te.find(ue=>e(ue,Pe));return Ce.get(ae)}return Ce.get(Pe)},[Ce,e,Te]),rt=G.useCallback(Pe=>{var ae;const ue=Ze(Pe);return(ae=ue?.disabled)!=null?ae:!1},[Ze]),Re=G.useCallback(Pe=>{const ae=Ze(Pe);return ae?R(ae):""},[Ze,R]),Qe=G.useMemo(()=>({selectedValues:J,open:I}),[J,I]),Vt=G.useCallback(Pe=>{var ae;return(ae=Ce.get(Pe))==null?void 0:ae.id},[Ce]),je=G.useCallback((Pe,ae)=>{if(p)w?.(Pe,ae);else{var ue;w?.(Pe,(ue=ae[0])!=null?ue:null)}},[p,w]),ct=G.useCallback((Pe,ae)=>{S?.(Pe,ae??null)},[S]),Ct=G.useCallback((Pe,ae,ue)=>{if(ae==="open"&&(M?.(ue),ue===!1&&Pe?.type!=="blur")){var ne;(ne=H.current)==null||ne.focus()}},[M]),ut=G.useCallback(Pe=>{var ae,ue;return Pe==null?null:(ae=(ue=$.get(Pe))==null?void 0:ue.ref.current)!=null?ae:null},[$]),lt={getInitialState:()=>{var Pe;return{highlightedValue:null,selectedValues:(Pe=se)!=null?Pe:[],open:r}},getItemId:Vt,controlledProps:Qe,focusManagement:"DOM",getItemDomElement:ut,itemComparer:e,isItemDisabled:rt,rootRef:we,onChange:je,onHighlightChange:ct,onStateChange:Ct,reducerActionContext:G.useMemo(()=>({multiple:p}),[p]),items:Te,getItemAsString:Re,selectionMode:p?"multiple":"single",stateReducer:eW,componentName:B},{dispatch:_t,getRootProps:wt,contextValue:cn,state:{open:dn,highlightedValue:tn,selectedValues:Je},rootRef:Tn}=GP(lt),Kt=G.useRef(dn);Hd(()=>{if(dn&&tn!==null){var Pe;const ae=(Pe=Ze(tn))==null?void 0:Pe.ref;if(!X.current||!(ae!=null&&ae.current))return;Kt.current||ae.current.focus({preventScroll:!0});const ue=X.current.getBoundingClientRect(),ne=ae.current.getBoundingClientRect();ne.top<ue.top?X.current.scrollTop-=ue.top-ne.top:ne.bottom>ue.bottom&&(X.current.scrollTop+=ne.bottom-ue.bottom)}},[dn,tn,Ze]);const fn=G.useCallback(Pe=>Ze(Pe),[Ze]),Ut=Pe=>ae=>{var ue;if(Pe==null||(ue=Pe.onClick)==null||ue.call(Pe,ae),!ae.defaultMuiPrevented){const ne={type:Ab.buttonClick,event:ae};_t(ne)}},On=Pe=>ae=>{var ue;(ue=Pe.onKeyDown)==null||ue.call(Pe,ae),!ae.defaultMuiPrevented&&(ae.key==="ArrowDown"||ae.key==="ArrowUp")&&(ae.preventDefault(),_t({type:ki.keyDown,key:ae.key,event:ae}))},vn=(Pe={})=>({onClick:Ut(Pe),onKeyDown:On(Pe)}),Ue=(Pe={})=>me({},Pe,vn(Pe),{role:"combobox","aria-expanded":dn,"aria-controls":ee}),Se=(Pe={})=>{const ae=ps(Pe),ue=Gd(Ue,We);return me({},Pe,ue(ae))},yt=Pe=>ae=>{var ue,ne;(ue=Pe.onBlur)==null||ue.call(Pe,ae),!ae.defaultMuiPrevented&&((ne=X.current)!=null&&ne.contains(ae.relatedTarget)||ae.relatedTarget===H.current)&&(ae.defaultMuiPrevented=!0)},Nt=(Pe={})=>({onBlur:yt(Pe)}),Ht=(Pe={})=>{const ae=ps(Pe),ue=Gd(Nt,wt);return me({id:ee,role:"listbox","aria-multiselectable":p?"true":void 0},Pe,ue(ae))};G.useDebugValue({selectedOptions:Je,highlightedOption:tn,open:dn});const Ot=G.useMemo(()=>me({},cn,le),[cn,le]);let un;t.multiple?un=Je:un=Je.length>0?Je[0]:null;let Gt;if(p)Gt=un.map(Pe=>fn(Pe)).filter(Pe=>Pe!==void 0);else{var Zt;Gt=(Zt=fn(un))!=null?Zt:null}const Nn=Pe=>ae=>{var ue;if(Pe==null||(ue=Pe.onChange)==null||ue.call(Pe,ae),ae.defaultMuiPrevented)return;const ne=Ce.get(ae.target.value);ae.target.value===""?_t({type:ki.clearSelection}):ne!==void 0&&_t({type:Ab.browserAutoFill,item:ne.value,event:ae})};return{buttonActive:Fe,buttonFocusVisible:Me,buttonRef:Ee,contextValue:Ot,disabled:l,dispatch:_t,getButtonProps:Se,getHiddenInputProps:(Pe={})=>{const ae=ps(Pe);return me({name:y,tabIndex:-1,"aria-hidden":!0,required:_?!0:void 0,value:L(Gt),style:B9},Pe,{onChange:Nn(ae)})},getListboxProps:Ht,getOptionMetadata:fn,listboxRef:Tn,open:dn,options:Te,value:un,highlightedOption:tn}}function rW(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:i,getItemState:l,registerItem:c,totalSubitemCount:s}=e,p=G.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:i}),[r,i,l]),y=G.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:s}),[c,i,s]);return ie.jsx(j_.Provider,{value:y,children:ie.jsx(pp.Provider,{value:p,children:n})})}function iW(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:n=!1,onClose:r,open:i,resumeHideDuration:l}=t,c=T0();G.useEffect(()=>{if(!i)return;function L(V){V.defaultPrevented||(V.key==="Escape"||V.key==="Esc")&&r?.(V,"escapeKeyDown")}return document.addEventListener("keydown",L),()=>{document.removeEventListener("keydown",L)}},[i,r]);const s=yu((L,V)=>{r?.(L,V)}),p=yu(L=>{!r||L==null||c.start(L,()=>{s(null,"timeout")})});G.useEffect(()=>(i&&p(e),c.clear),[i,e,p,c]);const y=L=>{r?.(L,"clickaway")},_=c.clear,w=G.useCallback(()=>{e!=null&&p(l??e*.5)},[e,l,p]),S=L=>V=>{const B=L.onBlur;B?.(V),w()},M=L=>V=>{const B=L.onFocus;B?.(V),_()},I=L=>V=>{const B=L.onMouseEnter;B?.(V),_()},D=L=>V=>{const B=L.onMouseLeave;B?.(V),w()};return G.useEffect(()=>{if(!n&&i)return window.addEventListener("focus",w),window.addEventListener("blur",_),()=>{window.removeEventListener("focus",w),window.removeEventListener("blur",_)}},[n,i,w,_]),{getRootProps:(L={})=>{const V=me({},ps(t),ps(L));return me({role:"presentation"},L,V,{onBlur:S(V),onFocus:M(V),onMouseEnter:I(V),onMouseLeave:D(V)})},onClickAway:y}}function oW(t){const{checked:e,defaultChecked:n,disabled:r,onBlur:i,onChange:l,onFocus:c,onFocusVisible:s,readOnly:p,required:y}=t,[_,w]=Fv({controlled:e,default:!!n,name:"Switch",state:"checked"}),S=se=>J=>{var $;J.nativeEvent.defaultPrevented||(w(J.target.checked),l?.(J),($=se.onChange)==null||$.call(se,J))},{isFocusVisibleRef:M,onBlur:I,onFocus:D,ref:R}=Iw(),[L,V]=G.useState(!1);r&&L&&V(!1),G.useEffect(()=>{M.current=L},[L,M]);const B=G.useRef(null),H=se=>J=>{var $;B.current||(B.current=J.currentTarget),D(J),M.current===!0&&(V(!0),s?.(J)),c?.(J),($=se.onFocus)==null||$.call(se,J)},q=se=>J=>{var $;I(J),M.current===!1&&V(!1),i?.(J),($=se.onBlur)==null||$.call(se,J)},X=mi(R,B);return{checked:_,disabled:!!r,focusVisible:L,getInputProps:(se={})=>me({checked:e,defaultChecked:n,disabled:r,readOnly:p,ref:X,required:y,type:"checkbox",role:"switch","aria-checked":e},se,{onChange:S(se),onFocus:H(se),onBlur:q(se)}),inputRef:X,readOnly:!!p}}function sW(t){const{value:e,defaultValue:n,onChange:r,orientation:i="horizontal",direction:l="ltr",selectionFollowsFocus:c=!1}=t,[s,p]=Fv({controlled:e,default:n,name:"Tabs",state:"value"}),y=G.useCallback((R,L)=>{p(L),r?.(R,L)},[r,p]),{subitems:_,contextValue:w}=zw(),S=G.useRef(()=>{}),M=G.useCallback(R=>{var L;return(L=_.get(R))==null?void 0:L.id},[_]),I=G.useCallback(R=>S.current(R),[]),D=G.useCallback(R=>{S.current=R},[]);return{contextValue:me({direction:l,getTabId:I,getTabPanelId:M,onSelected:y,orientation:i,registerTabIdLookup:D,selectionFollowsFocus:c,value:s},w)}}const H4=G.createContext(null);function Uw(){const t=G.useContext(H4);if(t==null)throw new Error("No TabsContext provided");return t}function aW(t){const{value:e,children:n}=t,{direction:r,getItemIndex:i,onSelected:l,orientation:c,registerItem:s,registerTabIdLookup:p,selectionFollowsFocus:y,totalSubitemCount:_,value:w,getTabId:S,getTabPanelId:M}=e,I=G.useMemo(()=>({getItemIndex:i,registerItem:s,totalSubitemCount:_}),[s,i,_]),D=G.useMemo(()=>({direction:r,getTabId:S,getTabPanelId:M,onSelected:l,orientation:c,registerTabIdLookup:p,selectionFollowsFocus:y,value:w}),[r,S,M,l,c,p,y,w]);return ie.jsx(j_.Provider,{value:I,children:ie.jsx(H4.Provider,{value:D,children:n})})}function lW(t){return t.size}function cW(t){const{value:e,id:n,rootRef:r}=t,i=Uw();if(i===null)throw new Error("No TabContext provided");const{value:l,getTabId:c}=i,s=il(n),p=G.useRef(null),y=mi(p,r),_=G.useMemo(()=>({id:s,ref:p}),[s]),{id:w}=Ow(e??lW,_),S=w!==l,M=w!==void 0?c(w):void 0;return{hidden:S,getRootProps:(D={})=>me({"aria-labelledby":M??void 0,hidden:S,id:s??void 0},D,{ref:y}),rootRef:y}}const G4={valueChange:"valueChange"};function uW(t,e){if(e.type===G4.valueChange)return me({},t,{highlightedValue:e.value});const n=Dw(t,e),{context:{selectionFollowsFocus:r}}=e;if(e.type===ki.itemsChange){if(n.selectedValues.length>0)return me({},n,{highlightedValue:n.selectedValues[0]});Ps(null,"reset",e.context)}return r&&n.highlightedValue!=null?me({},n,{selectedValues:[n.highlightedValue]}):n}function hW(t){var e;const{rootRef:n}=t,{direction:r="ltr",onSelected:i,orientation:l="horizontal",value:c,registerTabIdLookup:s,selectionFollowsFocus:p}=Uw(),{subitems:y,contextValue:_}=zw(),w=G.useCallback(le=>{var Ce;return(Ce=y.get(le))==null?void 0:Ce.id},[y]);s(w);const S=G.useMemo(()=>Array.from(y.keys()),[y]),M=G.useCallback(le=>{var Ce,we;return le==null?null:(Ce=(we=y.get(le))==null?void 0:we.ref.current)!=null?Ce:null},[y]),I=r==="rtl";let D;l==="vertical"?D="vertical":D=I?"horizontal-rtl":"horizontal-ltr";const R=G.useCallback((le,Ce)=>{var we;i(le,(we=Ce[0])!=null?we:null)},[i]),L=G.useMemo(()=>c===void 0?{}:c!=null?{selectedValues:[c]}:{selectedValues:[]},[c]),V=G.useCallback(le=>{var Ce,we;return(Ce=(we=y.get(le))==null?void 0:we.disabled)!=null?Ce:!1},[y]),{contextValue:B,dispatch:H,getRootProps:q,state:{highlightedValue:X,selectedValues:ee},rootRef:se}=GP({controlledProps:L,disabledItemsFocusable:!p,focusManagement:"DOM",getItemDomElement:M,isItemDisabled:V,items:S,rootRef:n,onChange:R,orientation:D,reducerActionContext:G.useMemo(()=>({selectionFollowsFocus:p||!1}),[p]),selectionMode:"single",stateReducer:uW});G.useEffect(()=>{c!==void 0&&c!=null&&H({type:G4.valueChange,value:c})},[H,c]);const J=(le={})=>me({},le,q(le),{"aria-orientation":l==="vertical"?"vertical":void 0,role:"tablist"});return{contextValue:G.useMemo(()=>me({},_,B),[_,B]),dispatch:H,getRootProps:J,highlightedValue:X,isRtl:I,orientation:l,rootRef:se,selectedValue:(e=ee[0])!=null?e:null}}function dW(t){const{value:e,children:n}=t,{dispatch:r,getItemIndex:i,getItemState:l,registerItem:c,totalSubitemCount:s}=e,p=G.useMemo(()=>({dispatch:r,getItemState:l,getItemIndex:i}),[r,i,l]),y=G.useMemo(()=>({getItemIndex:i,registerItem:c,totalSubitemCount:s}),[c,i,s]);return ie.jsx(j_.Provider,{value:y,children:ie.jsx(pp.Provider,{value:p,children:n})})}function fW(t){return t.size}function pW(t){const{value:e,rootRef:n,disabled:r=!1,id:i}=t,l=G.useRef(null),c=il(i),{value:s,selectionFollowsFocus:p,getTabPanelId:y}=Uw(),_=G.useMemo(()=>({disabled:r,ref:l,id:c}),[r,l,c]),{id:w,index:S,totalItemCount:M}=Ow(e??fW,_),{getRootProps:I,highlighted:D,selected:R}=WP({item:w}),{getRootProps:L,rootRef:V,active:B,focusVisible:H,setFocusVisible:q}=kh({disabled:r,focusableWhenDisabled:!p,type:"button"}),X=mi(l,n,V),ee=w!==void 0?y(w):void 0;return{getRootProps:(J={})=>{const $=ps(J),le=Gd(I,L);return me({},J,le($),{role:"tab","aria-controls":ee,"aria-selected":R,id:c,ref:X})},active:B,focusVisible:H,highlighted:D,index:S,rootRef:X,selected:R||w===s,setFocusVisible:q,totalTabsCount:M}}function g3(t){return typeof t.normalize<"u"?t.normalize("NFD").replace(/[\u0300-\u036f]/g,""):t}function W4(t={}){const{ignoreAccents:e=!0,ignoreCase:n=!0,limit:r,matchFrom:i="any",stringify:l,trim:c=!1}=t;return(s,{inputValue:p,getOptionLabel:y})=>{let _=c?p.trim():p;n&&(_=_.toLowerCase()),e&&(_=g3(_));const w=_?s.filter(S=>{let M=(l||y)(S);return n&&(M=M.toLowerCase()),e&&(M=g3(M)),i==="start"?M.indexOf(_)===0:M.indexOf(_)>-1}):s;return typeof r=="number"?w.slice(0,r):w}}function a1(t,e){for(let n=0;n<t.length;n+=1)if(e(t[n]))return n;return-1}const mW=W4(),v3=5,gW=t=>{var e;return t.current!==null&&((e=t.current.parentElement)==null?void 0:e.contains(document.activeElement))},vW=[];function yW(t){const{unstable_isActiveElementInListbox:e=gW,unstable_classNamePrefix:n="Mui",autoComplete:r=!1,autoHighlight:i=!1,autoSelect:l=!1,blurOnSelect:c=!1,clearOnBlur:s=!t.freeSolo,clearOnEscape:p=!1,componentName:y="useAutocomplete",defaultValue:_=t.multiple?vW:null,disableClearable:w=!1,disableCloseOnSelect:S=!1,disabled:M,disabledItemsFocusable:I=!1,disableListWrap:D=!1,filterOptions:R=mW,filterSelectedOptions:L=!1,freeSolo:V=!1,getOptionDisabled:B,getOptionKey:H,getOptionLabel:q=It=>{var nt;return(nt=It.label)!=null?nt:It},groupBy:X,handleHomeEndKeys:ee=!t.freeSolo,id:se,includeInputInList:J=!1,inputValue:$,isOptionEqualToValue:le=(It,nt)=>It===nt,multiple:Ce=!1,onChange:we,onClose:We,onHighlightChange:Fe,onInputChange:Me,onOpen:Ee,open:Te,openOnFocus:Ze=!1,options:rt,readOnly:Re=!1,selectOnFocus:Qe=!t.freeSolo,value:Vt}=t,je=il(se);let ct=q;ct=It=>{const nt=q(It);return typeof nt!="string"?String(nt):nt};const Ct=G.useRef(!1),ut=G.useRef(!0),lt=G.useRef(null),_t=G.useRef(null),[wt,cn]=G.useState(null),[dn,tn]=G.useState(-1),Je=i?0:-1,Tn=G.useRef(Je),[Kt,fn]=Fv({controlled:Vt,default:_,name:y}),[Ut,On]=Fv({controlled:$,default:"",name:y,state:"inputValue"}),[vn,Ue]=G.useState(!1),Se=G.useCallback((It,nt)=>{if(!(Ce?Kt.length<nt.length:nt!==null)&&!s)return;let hn;if(Ce)hn="";else if(nt==null)hn="";else{const kn=ct(nt);hn=typeof kn=="string"?kn:""}Ut!==hn&&(On(hn),Me&&Me(It,hn,"reset"))},[ct,Ut,Ce,Me,On,s,Kt]),[yt,Nt]=Fv({controlled:Te,default:!1,name:y,state:"open"}),[Ht,Ot]=G.useState(!0),un=!Ce&&Kt!=null&&Ut===ct(Kt),Gt=yt&&!Re,Zt=Gt?R(rt.filter(It=>!(L&&(Ce?Kt:[Kt]).some(nt=>nt!==null&&le(It,nt)))),{inputValue:un&&Ht?"":Ut,getOptionLabel:ct}):[],Nn=N9({filteredOptions:Zt,value:Kt,inputValue:Ut});G.useEffect(()=>{const It=Kt!==Nn.value;vn&&!It||V&&!It||Se(null,Kt)},[Kt,Se,vn,Nn.value,V]);const Yt=yt&&Zt.length>0&&!Re,Pe=yu(It=>{It===-1?lt.current.focus():wt.querySelector(`[data-tag-index="${It}"]`).focus()});G.useEffect(()=>{Ce&&dn>Kt.length-1&&(tn(-1),Pe(-1))},[Kt,Ce,dn,Pe]);function ae(It,nt){if(!_t.current||It<0||It>=Zt.length)return-1;let qt=It;for(;;){const hn=_t.current.querySelector(`[data-option-index="${qt}"]`),kn=I?!1:!hn||hn.disabled||hn.getAttribute("aria-disabled")==="true";if(hn&&hn.hasAttribute("tabindex")&&!kn)return qt;if(nt==="next"?qt=(qt+1)%Zt.length:qt=(qt-1+Zt.length)%Zt.length,qt===It)return-1}}const ue=yu(({event:It,index:nt,reason:qt="auto"})=>{if(Tn.current=nt,nt===-1?lt.current.removeAttribute("aria-activedescendant"):lt.current.setAttribute("aria-activedescendant",`${je}-option-${nt}`),Fe&&Fe(It,nt===-1?null:Zt[nt],qt),!_t.current)return;const hn=_t.current.querySelector(`[role="option"].${n}-focused`);hn&&(hn.classList.remove(`${n}-focused`),hn.classList.remove(`${n}-focusVisible`));let kn=_t.current;if(_t.current.getAttribute("role")!=="listbox"&&(kn=_t.current.parentElement.querySelector('[role="listbox"]')),!kn)return;if(nt===-1){kn.scrollTop=0;return}const Ir=_t.current.querySelector(`[data-option-index="${nt}"]`);if(Ir&&(Ir.classList.add(`${n}-focused`),qt==="keyboard"&&Ir.classList.add(`${n}-focusVisible`),kn.scrollHeight>kn.clientHeight&&qt!=="mouse"&&qt!=="touch")){const xr=Ir,xe=kn.clientHeight+kn.scrollTop,vt=xr.offsetTop+xr.offsetHeight;vt>xe?kn.scrollTop=vt-kn.clientHeight:xr.offsetTop-xr.offsetHeight*(X?1.3:0)<kn.scrollTop&&(kn.scrollTop=xr.offsetTop-xr.offsetHeight*(X?1.3:0))}}),ne=yu(({event:It,diff:nt,direction:qt="next",reason:hn="auto"})=>{if(!Gt)return;const Ir=ae((()=>{const xr=Zt.length-1;if(nt==="reset")return Je;if(nt==="start")return 0;if(nt==="end")return xr;const xe=Tn.current+nt;return xe<0?xe===-1&&J?-1:D&&Tn.current!==-1||Math.abs(nt)>1?0:xr:xe>xr?xe===xr+1&&J?-1:D||Math.abs(nt)>1?xr:0:xe})(),qt);if(ue({index:Ir,reason:hn,event:It}),r&&nt!=="reset")if(Ir===-1)lt.current.value=Ut;else{const xr=ct(Zt[Ir]);lt.current.value=xr,xr.toLowerCase().indexOf(Ut.toLowerCase())===0&&Ut.length>0&&lt.current.setSelectionRange(Ut.length,xr.length)}}),fe=()=>{const It=(nt,qt)=>{const hn=nt?ct(nt):"",kn=qt?ct(qt):"";return hn===kn};if(Tn.current!==-1&&Nn.filteredOptions&&Nn.filteredOptions.length!==Zt.length&&Nn.inputValue===Ut&&(Ce?Kt.length===Nn.value.length&&Nn.value.every((nt,qt)=>ct(Kt[qt])===ct(nt)):It(Nn.value,Kt))){const nt=Nn.filteredOptions[Tn.current];if(nt)return a1(Zt,qt=>ct(qt)===ct(nt))}return-1},Oe=G.useCallback(()=>{if(!Gt)return;const It=fe();if(It!==-1){Tn.current=It;return}const nt=Ce?Kt[0]:Kt;if(Zt.length===0||nt==null){ne({diff:"reset"});return}if(_t.current){if(nt!=null){const qt=Zt[Tn.current];if(Ce&&qt&&a1(Kt,kn=>le(qt,kn))!==-1)return;const hn=a1(Zt,kn=>le(kn,nt));hn===-1?ne({diff:"reset"}):ue({index:hn});return}if(Tn.current>=Zt.length-1){ue({index:Zt.length-1});return}ue({index:Tn.current})}},[Zt.length,Ce?!1:Kt,L,ne,ue,Gt,Ut,Ce]),Ke=yu(It=>{Tb(_t,It),It&&Oe()});G.useEffect(()=>{Oe()},[Oe]);const ye=It=>{yt||(Nt(!0),Ot(!0),Ee&&Ee(It))},Ae=(It,nt)=>{yt&&(Nt(!1),We&&We(It,nt))},Be=(It,nt,qt,hn)=>{if(Ce){if(Kt.length===nt.length&&Kt.every((kn,Ir)=>kn===nt[Ir]))return}else if(Kt===nt)return;we&&we(It,nt,qt,hn),fn(nt)},$e=G.useRef(!1),He=(It,nt,qt="selectOption",hn="options")=>{let kn=qt,Ir=nt;if(Ce){Ir=Array.isArray(Kt)?Kt.slice():[];const xr=a1(Ir,xe=>le(nt,xe));xr===-1?Ir.push(nt):hn!=="freeSolo"&&(Ir.splice(xr,1),kn="removeOption")}Se(It,Ir),Be(It,Ir,kn,{option:nt}),!S&&(!It||!It.ctrlKey&&!It.metaKey)&&Ae(It,kn),(c===!0||c==="touch"&&$e.current||c==="mouse"&&!$e.current)&&lt.current.blur()};function dt(It,nt){if(It===-1)return-1;let qt=It;for(;;){if(nt==="next"&&qt===Kt.length||nt==="previous"&&qt===-1)return-1;const hn=wt.querySelector(`[data-tag-index="${qt}"]`);if(!hn||!hn.hasAttribute("tabindex")||hn.disabled||hn.getAttribute("aria-disabled")==="true")qt+=nt==="next"?1:-1;else return qt}}const qe=(It,nt)=>{if(!Ce)return;Ut===""&&Ae(It,"toggleInput");let qt=dn;dn===-1?Ut===""&&nt==="previous"&&(qt=Kt.length-1):(qt+=nt==="next"?1:-1,qt<0&&(qt=0),qt===Kt.length&&(qt=-1)),qt=dt(qt,nt),tn(qt),Pe(qt)},$t=It=>{Ct.current=!0,On(""),Me&&Me(It,"","clear"),Be(It,Ce?[]:null,"clear")},Jt=It=>nt=>{if(It.onKeyDown&&It.onKeyDown(nt),!nt.defaultMuiPrevented&&(dn!==-1&&["ArrowLeft","ArrowRight"].indexOf(nt.key)===-1&&(tn(-1),Pe(-1)),nt.which!==229))switch(nt.key){case"Home":Gt&&ee&&(nt.preventDefault(),ne({diff:"start",direction:"next",reason:"keyboard",event:nt}));break;case"End":Gt&&ee&&(nt.preventDefault(),ne({diff:"end",direction:"previous",reason:"keyboard",event:nt}));break;case"PageUp":nt.preventDefault(),ne({diff:-v3,direction:"previous",reason:"keyboard",event:nt}),ye(nt);break;case"PageDown":nt.preventDefault(),ne({diff:v3,direction:"next",reason:"keyboard",event:nt}),ye(nt);break;case"ArrowDown":nt.preventDefault(),ne({diff:1,direction:"next",reason:"keyboard",event:nt}),ye(nt);break;case"ArrowUp":nt.preventDefault(),ne({diff:-1,direction:"previous",reason:"keyboard",event:nt}),ye(nt);break;case"ArrowLeft":qe(nt,"previous");break;case"ArrowRight":qe(nt,"next");break;case"Enter":if(Tn.current!==-1&&Gt){const qt=Zt[Tn.current],hn=B?B(qt):!1;if(nt.preventDefault(),hn)return;He(nt,qt,"selectOption"),r&&lt.current.setSelectionRange(lt.current.value.length,lt.current.value.length)}else V&&Ut!==""&&un===!1&&(Ce&&nt.preventDefault(),He(nt,Ut,"createOption","freeSolo"));break;case"Escape":Gt?(nt.preventDefault(),nt.stopPropagation(),Ae(nt,"escape")):p&&(Ut!==""||Ce&&Kt.length>0)&&(nt.preventDefault(),nt.stopPropagation(),$t(nt));break;case"Backspace":if(Ce&&!Re&&Ut===""&&Kt.length>0){const qt=dn===-1?Kt.length-1:dn,hn=Kt.slice();hn.splice(qt,1),Be(nt,hn,"removeOption",{option:Kt[qt]})}break;case"Delete":if(Ce&&!Re&&Ut===""&&Kt.length>0&&dn!==-1){const qt=dn,hn=Kt.slice();hn.splice(qt,1),Be(nt,hn,"removeOption",{option:Kt[qt]})}break}},Ie=It=>{Ue(!0),Ze&&!Ct.current&&ye(It)},ot=It=>{if(e(_t)){lt.current.focus();return}Ue(!1),ut.current=!0,Ct.current=!1,l&&Tn.current!==-1&&Gt?He(It,Zt[Tn.current],"blur"):l&&V&&Ut!==""?He(It,Ut,"blur","freeSolo"):s&&Se(It,Kt),Ae(It,"blur")},mt=It=>{const nt=It.target.value;Ut!==nt&&(On(nt),Ot(!1),Me&&Me(It,nt,"input")),nt===""?!w&&!Ce&&Be(It,null,"clear"):ye(It)},Wt=It=>{const nt=Number(It.currentTarget.getAttribute("data-option-index"));Tn.current!==nt&&ue({event:It,index:nt,reason:"mouse"})},nn=It=>{ue({event:It,index:Number(It.currentTarget.getAttribute("data-option-index")),reason:"touch"}),$e.current=!0},mn=It=>{const nt=Number(It.currentTarget.getAttribute("data-option-index"));He(It,Zt[nt],"selectOption"),$e.current=!1},on=It=>nt=>{const qt=Kt.slice();qt.splice(It,1),Be(nt,qt,"removeOption",{option:Kt[It]})},sn=It=>{yt?Ae(It,"toggleInput"):ye(It)},Dn=It=>{It.currentTarget.contains(It.target)&&It.target.getAttribute("id")!==je&&It.preventDefault()},Et=It=>{It.currentTarget.contains(It.target)&&(lt.current.focus(),Qe&&ut.current&&lt.current.selectionEnd-lt.current.selectionStart===0&&lt.current.select(),ut.current=!1)},Gn=It=>{!M&&(Ut===""||!yt)&&sn(It)};let Fn=V&&Ut.length>0;Fn=Fn||(Ce?Kt.length>0:Kt!==null);let or=Zt;return X&&(or=Zt.reduce((It,nt,qt)=>{const hn=X(nt);return It.length>0&&It[It.length-1].group===hn?It[It.length-1].options.push(nt):It.push({key:qt,index:qt,group:hn,options:[nt]}),It},[])),M&&vn&&ot(),{getRootProps:(It={})=>me({"aria-owns":Yt?`${je}-listbox`:null},It,{onKeyDown:Jt(It),onMouseDown:Dn,onClick:Et}),getInputLabelProps:()=>({id:`${je}-label`,htmlFor:je}),getInputProps:()=>({id:je,value:Ut,onBlur:ot,onFocus:Ie,onChange:mt,onMouseDown:Gn,"aria-activedescendant":Gt?"":null,"aria-autocomplete":r?"both":"list","aria-controls":Yt?`${je}-listbox`:void 0,"aria-expanded":Yt,autoComplete:"off",ref:lt,autoCapitalize:"none",spellCheck:"false",role:"combobox",disabled:M}),getClearProps:()=>({tabIndex:-1,type:"button",onClick:$t}),getPopupIndicatorProps:()=>({tabIndex:-1,type:"button",onClick:sn}),getTagProps:({index:It})=>me({key:It,"data-tag-index":It,tabIndex:-1},!Re&&{onDelete:on(It)}),getListboxProps:()=>({role:"listbox",id:`${je}-listbox`,"aria-labelledby":`${je}-label`,ref:Ke,onMouseDown:It=>{It.preventDefault()}}),getOptionProps:({index:It,option:nt})=>{var qt;const hn=(Ce?Kt:[Kt]).some(Ir=>Ir!=null&&le(nt,Ir)),kn=B?B(nt):!1;return{key:(qt=H?.(nt))!=null?qt:ct(nt),tabIndex:-1,role:"option",id:`${je}-option-${It}`,onMouseMove:Wt,onClick:mn,onTouchStart:nn,"data-option-index":It,"aria-disabled":kn,"aria-selected":hn}},id:je,inputValue:Ut,value:Kt,dirty:Fn,expanded:Gt&&wt,popupOpen:Gt,focused:vn||dn!==-1,anchorEl:wt,setAnchorEl:cn,focusedTag:dn,groupedOptions:or}}const _W=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],xW=["component","slots","slotProps"],bW=["component"];function Bn(t,e){const{className:n,elementType:r,ownerState:i,externalForwardedProps:l,getSlotOwnerState:c,internalForwardedProps:s}=e,p=rr(e,_W),{component:y,slots:_={[t]:void 0},slotProps:w={[t]:void 0}}=l,S=rr(l,xW),M=_[t]||r,I=C4(w[t],i),D=M4(me({className:n},p,{externalForwardedProps:t==="root"?S:void 0,externalSlotProps:I})),{props:{component:R},internalRef:L}=D,V=rr(D.props,bW),B=mi(L,I?.ref,e.ref),H=c?c(V):{},q=me({},i,H),X=t==="root"?R||y:R,ee=S4(M,me({},t==="root"&&!y&&!_[t]&&s,t!=="root"&&!_[t]&&s,V,X&&{as:X},{ref:B}),q);return Object.keys(H).forEach(se=>{delete ee[se]}),[M,ee]}function wW(t){return qr("MuiListItem",t)}const Ib=$r("MuiListItem",["root","startAction","endAction","nested","nesting","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]),Rb=G.createContext(!1),fy=G.createContext(!1),q4=G.createContext(!1),eA=G.createContext(void 0),X4=G.createContext(void 0),$w=G.createContext(void 0),SW=["component","className","children","nested","sticky","variant","color","startAction","endAction","role","slots","slotProps"],MW=t=>{const{sticky:e,nested:n,nesting:r,variant:i,color:l}=t,c={root:["root",n&&"nested",r&&"nesting",e&&"sticky",l&&`color${Rn(l)}`,i&&`variant${Rn(i)}`],startAction:["startAction"],endAction:["endAction"]};return Vr(c,wW,{})},CW=_n("li")(({theme:t,ownerState:e})=>{var n;return[!e.nested&&{"--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItemButton-marginBlock":"calc(-1 * var(--ListItem-paddingY))",alignItems:"center",gap:"var(--ListItem-gap)",marginInline:"var(--ListItem-marginInline)"},e.nested&&{"--NestedList-marginRight":"calc(-1 * var(--ListItem-paddingRight))","--NestedList-marginLeft":"calc(-1 * var(--ListItem-paddingLeft))","--NestedListItem-paddingLeft":"calc(var(--ListItem-paddingLeft) + var(--List-nestedInsetStart))","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))","--ListItem-marginInline":"calc(-1 * var(--ListItem-paddingLeft)) calc(-1 * var(--ListItem-paddingRight))",flexDirection:"column"},me({"--unstable_actionRadius":"calc(var(--ListItem-radius) - var(--variant-borderWidth, 0px))"},e.startAction&&{"--unstable_startActionWidth":"2rem"},e.endAction&&{"--unstable_endActionWidth":"2.5rem"},{boxSizing:"border-box",borderRadius:"var(--ListItem-radius)",display:"var(--_ListItem-display)","&:not([hidden])":{"--_ListItem-display":"var(--_List-markerDisplay, flex)"},flex:"none",listStyleType:"var(--_List-markerType, disc)",position:"relative",paddingBlockStart:e.nested?0:"var(--ListItem-paddingY)",paddingBlockEnd:e.nested?0:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)"},e["data-first-child"]===void 0&&me({},e.row?{marginInlineStart:"var(--List-gap)"}:{marginBlockStart:"var(--List-gap)"}),e.row&&e.wrap&&{marginInlineStart:"var(--List-gap)",marginBlockStart:"var(--List-gap)"},{minBlockSize:"var(--ListItem-minHeight)"},e.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:`var(--ListItem-stickyBackground, ${t.vars.palette.background.body})`},{[`.${Ib.nested} > &`]:{"--_ListItem-display":"flex"}}),(n=t.variants[e.variant])==null?void 0:n[e.color]]}),EW=_n(CW,{name:"JoyListItem",slot:"Root",overridesResolver:(t,e)=>e.root})({}),TW=_n("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(t,e)=>e.startAction})(({ownerState:t})=>({display:"inherit",position:"absolute",top:t.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",left:0,transform:"translate(var(--ListItem-startActionTranslateX), -50%)",zIndex:1})),PW=_n("div",{name:"JoyListItem",slot:"StartAction",overridesResolver:(t,e)=>e.startAction})(({ownerState:t})=>({display:"inherit",position:"absolute",top:t.nested?"calc(var(--ListItem-minHeight) / 2)":"50%",right:0,transform:"translate(var(--ListItem-endActionTranslateX), -50%)"})),gp=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListItem"}),i=G.useContext($w),l=G.useContext(eA),c=G.useContext(fy),s=G.useContext(q4),p=G.useContext(Rb),{component:y,className:_,children:w,nested:S=!1,sticky:M=!1,variant:I="plain",color:D="neutral",startAction:R,endAction:L,role:V,slots:B={},slotProps:H={}}=r,q=rr(r,SW),[X,ee]=G.useState(""),[se,J]=l?.split(":")||["",""],$=y||(se&&!se.match(/^(ul|ol|menu)$/)?"div":void 0);let le=i==="menu"?"none":void 0;l&&(le={menu:"none",menubar:"none",group:"presentation"}[J]),V&&(le=V);const Ce=me({},r,{sticky:M,startAction:R,endAction:L,row:c,wrap:s,variant:I,color:D,nesting:p,nested:S,component:$,role:le}),we=MW(Ce),We=me({},q,{component:$,slots:B,slotProps:H}),[Fe,Me]=Bn("root",{additionalProps:{role:le},ref:n,className:co(we.root,_),elementType:EW,externalForwardedProps:We,ownerState:Ce}),[Ee,Te]=Bn("startAction",{className:we.startAction,elementType:TW,externalForwardedProps:We,ownerState:Ce}),[Ze,rt]=Bn("endAction",{className:we.endAction,elementType:PW,externalForwardedProps:We,ownerState:Ce});return ie.jsx(X4.Provider,{value:ee,children:ie.jsx(Rb.Provider,{value:S?X||!0:!1,children:ie.jsxs(Fe,me({},Me,{children:[R&&ie.jsx(Ee,me({},Te,{children:R})),G.Children.map(w,(Re,Qe)=>{var Vt;return G.isValidElement(Re)?G.cloneElement(Re,me({},Qe===0&&{"data-first-child":""},Pw(Re,["ListItem"])&&{component:((Vt=Re.props)==null?void 0:Vt.component)||"div"})):Re}),L&&ie.jsx(Ze,me({},rt,{children:L}))]}))})})});gp.muiName="ListItem";const Vw={"--NestedList-marginRight":"0px","--NestedList-marginLeft":"0px","--NestedListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px"};function W_(t){const{children:e,nested:n,row:r=!1,wrap:i=!1}=t,l=ie.jsx(fy.Provider,{value:r,children:ie.jsx(q4.Provider,{value:i,children:G.Children.map(e,(c,s)=>G.isValidElement(c)?G.cloneElement(c,me({},s===0&&{"data-first-child":""},s===G.Children.count(e)-1&&{"data-last-child":""})):c)})});return n===void 0?l:ie.jsx(Rb.Provider,{value:n,children:l})}const Km=({theme:t,ownerState:e},n)=>{let r={};function i(l){if(typeof l=="function"){const c=l(t);i(c)}else Array.isArray(l)?l.forEach(c=>{typeof c!="boolean"&&i(c)}):typeof l=="object"&&(r=me({},r,l))}return e.sx&&(i(e.sx),n.forEach(l=>{const c=r[l];if(typeof c=="string"||typeof c=="number")if(l==="borderRadius")if(typeof c=="number")r[l]=`${c}px`;else{var s;r[l]=((s=t.vars)==null?void 0:s.radius[c])||c}else["p","padding","m","margin"].indexOf(l)!==-1&&typeof c=="number"?r[l]=t.spacing(c):r[l]=c;else typeof c=="function"?r[l]=c(t):r[l]=void 0})),r};function AW(t){return qr("MuiList",t)}const IW=$r("MuiList",["root","nesting","scoped","sizeSm","sizeMd","sizeLg","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","horizontal","vertical"]),RW=G.createContext(void 0),LW=["component","className","children","size","orientation","wrap","variant","color","role","slots","slotProps"],kW=t=>{const{variant:e,color:n,size:r,nesting:i,orientation:l,instanceSize:c}=t,s={root:["root",l,e&&`variant${Rn(e)}`,n&&`color${Rn(n)}`,!c&&!i&&r&&`size${Rn(r)}`,c&&`size${Rn(c)}`,i&&"nesting"]};return Vr(s,AW,{})},q_=_n("ul")(({theme:t,ownerState:e})=>{var n;const{p:r,padding:i,borderRadius:l}=Km({theme:t,ownerState:e},["p","padding","borderRadius"]);function c(s){return s==="sm"?{"--ListDivider-gap":"0.25rem","--ListItem-minHeight":"2rem","--ListItem-paddingY":"3px","--ListItem-paddingX":e.marker?"3px":"0.5rem","--ListItem-gap":"0.5rem","--ListItemDecorator-size":e.orientation==="horizontal"?"1.5rem":"2rem","--Icon-fontSize":t.vars.fontSize.lg}:s==="md"?{"--ListDivider-gap":"0.375rem","--ListItem-minHeight":"2.25rem","--ListItem-paddingY":"0.25rem","--ListItem-paddingX":e.marker?"0.25rem":"0.75rem","--ListItem-gap":"0.625rem","--ListItemDecorator-size":e.orientation==="horizontal"?"1.75rem":"2.5rem","--Icon-fontSize":t.vars.fontSize.xl}:s==="lg"?{"--ListDivider-gap":"0.5rem","--ListItem-minHeight":"2.75rem","--ListItem-paddingY":"0.375rem","--ListItem-paddingX":e.marker?"0.5rem":"1rem","--ListItem-gap":"0.75rem","--ListItemDecorator-size":e.orientation==="horizontal"?"2.25rem":"3rem","--Icon-fontSize":t.vars.fontSize.xl2}:{}}return[e.nesting&&me({},c(e.instanceSize),{"--ListItem-paddingRight":"var(--ListItem-paddingX)","--ListItem-paddingLeft":"var(--NestedListItem-paddingLeft)","--ListItemButton-marginBlock":"0px","--ListItemButton-marginInline":"0px","--ListItem-marginBlock":"0px","--ListItem-marginInline":"0px",padding:0},e.marker&&{paddingInlineStart:"calc(3ch - var(--_List-markerDeduct, 0px))"},{marginInlineStart:"var(--NestedList-marginLeft)",marginInlineEnd:"var(--NestedList-marginRight)",marginBlockStart:"var(--List-gap)",marginBlockEnd:"initial"}),!e.nesting&&me({},c(e.size),{"--List-gap":"0px","--List-nestedInsetStart":"0px","--ListItem-paddingLeft":"var(--ListItem-paddingX)","--ListItem-paddingRight":"var(--ListItem-paddingX)"},e.marker&&{"--_List-markerDeduct":"1ch"},{"--unstable_List-childRadius":"calc(max(var(--List-radius) - var(--List-padding), min(var(--List-padding) / 2, var(--List-radius) / 2)) - var(--variant-borderWidth, 0px))","--ListItem-radius":"var(--unstable_List-childRadius)","--ListItem-startActionTranslateX":"calc(0.5 * var(--ListItem-paddingLeft))","--ListItem-endActionTranslateX":"calc(-0.5 * var(--ListItem-paddingRight))",margin:"initial"},t.typography[`body-${e.size}`],e.orientation==="horizontal"?me({},e.wrap?{padding:"var(--List-padding)",marginInlineStart:"calc(-1 * var(--List-gap))",marginBlockStart:"calc(-1 * var(--List-gap))"}:{paddingInline:"var(--List-padding, var(--ListDivider-gap))",paddingBlock:"var(--List-padding)"}):{paddingBlock:"var(--List-padding, var(--ListDivider-gap))",paddingInline:"var(--List-padding)"},e.marker&&{paddingInlineStart:"3ch"}),me({boxSizing:"border-box",borderRadius:"var(--List-radius)",listStyle:"none",display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column"},e.wrap&&{flexWrap:"wrap"},e.marker&&{"--_List-markerDisplay":"list-item","--_List-markerType":e.marker,lineHeight:"calc(var(--ListItem-minHeight) - 2 * var(--ListItem-paddingY))"},{flexGrow:1,position:"relative"},(n=t.variants[e.variant])==null?void 0:n[e.color],{"--unstable_List-borderWidth":"var(--variant-borderWidth, 0px)"},l!==void 0&&{"--List-radius":l},r!==void 0&&{"--List-padding":r},i!==void 0&&{"--List-padding":i})]}),DW=_n(q_,{name:"JoyList",slot:"Root",overridesResolver:(t,e)=>e.root})({}),jw=G.forwardRef(function(e,n){var r;const i=G.useContext(Rb),l=G.useContext($w),c=G.useContext(RW),s=Xr({props:e,name:"JoyList"}),{component:p,className:y,children:_,size:w,orientation:S="vertical",wrap:M=!1,variant:I="plain",color:D="neutral",role:R,slots:L={},slotProps:V={}}=s,B=rr(s,LW),H=w||((r=e.size)!=null?r:"md");let q;l&&(q="group"),c&&(q="presentation"),R&&(q=R);const X=me({},s,{instanceSize:e.size,size:H,nesting:i,orientation:S,wrap:M,variant:I,color:D,role:q}),ee=kW(X),se=me({},B,{component:p,slots:L,slotProps:V}),[J,$]=Bn("root",{ref:n,className:co(ee.root,y),elementType:DW,externalForwardedProps:se,ownerState:X,additionalProps:{as:p,role:q,"aria-labelledby":typeof i=="string"?i:void 0}});return ie.jsx(J,me({},$,{children:ie.jsx(eA.Provider,{value:`${typeof p=="string"?p:""}:${q||""}`,children:ie.jsx(W_,{row:S==="horizontal",wrap:M,children:_})})}))}),rb=$r("MuiListItemButton",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","variantPlain","variantSoft","variantOutlined","variantSolid"]),tA=G.createContext("horizontal"),X_=_n("div")(({theme:t,ownerState:e})=>{var n,r,i,l,c,s;return me({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,WebkitTapHighlightColor:"transparent",boxSizing:"border-box",position:"relative",font:"inherit",display:"flex",flexDirection:"row",alignItems:"center",alignSelf:"stretch",gap:"var(--ListItem-gap)"},e.orientation==="vertical"&&{flexDirection:"column",justifyContent:"center"},{textAlign:"initial",textDecoration:"initial",backgroundColor:"initial",cursor:"pointer",marginInline:"var(--ListItemButton-marginInline)",marginBlock:"var(--ListItemButton-marginBlock)"},e["data-first-child"]===void 0&&{marginInlineStart:e.row?"var(--List-gap)":void 0,marginBlockStart:e.row?void 0:"var(--List-gap)"},{paddingBlock:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px))",paddingInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItem-startActionWidth, var(--unstable_startActionWidth, 0px)))",paddingInlineEnd:"calc(var(--ListItem-paddingRight) + var(--ListItem-endActionWidth, var(--unstable_endActionWidth, 0px)))",minBlockSize:"var(--ListItem-minHeight)",border:"1px solid transparent",borderRadius:"var(--ListItem-radius)",flex:"var(--unstable_ListItem-flex, none)",fontSize:"inherit",lineHeight:"inherit",minInlineSize:0,[t.focus.selector]:me({},t.focus.default,{zIndex:1})},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:active":(r=t.variants[`${e.variant}Active`])==null?void 0:r[e.color],[`.${Ib.root} > &`]:{"--unstable_ListItem-flex":"1 0 0%"},[`&.${rb.selected}`]:me({},(i=t.variants[`${e.variant}Active`])==null?void 0:i[e.color],{"--Icon-color":"currentColor"}),[`&:not(.${rb.selected}, [aria-selected="true"])`]:{"&:hover":(l=t.variants[`${e.variant}Hover`])==null?void 0:l[e.color],"&:active":(c=t.variants[`${e.variant}Active`])==null?void 0:c[e.color]},[`&.${rb.disabled}`]:me({},(s=t.variants[`${e.variant}Disabled`])==null?void 0:s[e.color])})});_n(X_,{name:"JoyListItemButton",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>me({},!t.row&&{[`&.${rb.selected}`]:{fontWeight:e.vars.fontWeight.md}}));function zW(t){return qr("MuiSvgIcon",t)}$r("MuiSvgIcon",["root","colorInherit","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","fontSizeInherit","fontSizeXs","fontSizeSm","fontSizeMd","fontSizeLg","fontSizeXl","fontSizeXl2","fontSizeXl3","fontSizeXl4","sizeSm","sizeMd","sizeLg"]);const OW=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox","size","slots","slotProps"],FW=t=>{const{color:e,size:n,fontSize:r}=t,i={root:["root",e&&e!=="inherit"&&`color${Rn(e)}`,n&&`size${Rn(n)}`,r&&`fontSize${Rn(r)}`]};return Vr(i,zW,{})},y3={sm:"xl",md:"xl2",lg:"xl3"},NW=_n("svg",{name:"JoySvgIcon",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return me({},e.instanceSize&&{"--Icon-fontSize":t.vars.fontSize[y3[e.instanceSize]]},e.instanceFontSize&&e.instanceFontSize!=="inherit"&&{"--Icon-fontSize":t.vars.fontSize[e.instanceFontSize]},{userSelect:"none",margin:"var(--Icon-margin)",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,fontSize:`var(--Icon-fontSize, ${t.vars.fontSize[y3[e.size]]||"unset"})`},e.fontSize&&e.fontSize!=="inherit"&&{fontSize:`var(--Icon-fontSize, ${t.fontSize[e.fontSize]})`},!e.htmlColor&&me({color:`var(--Icon-color, ${t.vars.palette.text.icon})`},e.color==="inherit"&&{color:"inherit"},e.color!=="inherit"&&t.vars.palette[e.color]&&{color:`rgba(${(n=t.vars.palette[e.color])==null?void 0:n.mainChannel} / 1)`}))}),_3=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoySvgIcon"}),{children:i,className:l,color:c,component:s="svg",fontSize:p,htmlColor:y,inheritViewBox:_=!1,titleAccess:w,viewBox:S="0 0 24 24",size:M="md",slots:I={},slotProps:D={}}=r,R=rr(r,OW),L=G.isValidElement(i)&&i.type==="svg",V=me({},r,{color:c,component:s,size:M,instanceSize:e.size,fontSize:p,instanceFontSize:e.fontSize,inheritViewBox:_,viewBox:S,hasSvgAsChild:L}),B=FW(V),H=me({},R,{component:s,slots:I,slotProps:D}),[q,X]=Bn("root",{ref:n,className:co(B.root,l),elementType:NW,externalForwardedProps:H,ownerState:V,additionalProps:me({color:y,focusable:!1},w&&{role:"img"},!w&&{"aria-hidden":!0},!_&&{viewBox:S},L&&i.props)});return ie.jsxs(q,me({},X,{children:[L?i.props.children:i,w?ie.jsx("title",{children:w}):null]}))});function Jm(t,e){function n(r,i){return ie.jsx(_3,me({"data-testid":`${e}Icon`,ref:i},r,{children:t}))}return n.muiName=_3.muiName,G.memo(G.forwardRef(n))}const nA=t=>e=>`--${t?`${t}-`:""}${e.replace(/^--/,"")}`,Qv="data-skip-inverted-colors",Z4=`& :not([${Qv}], [${Qv}] *)`,Y4=t=>{var e,n,r,i,l,c,s,p,y,_,w,S,M,I,D,R,L,V,B,H,q,X;const ee=nA(t.cssVarPrefix);return{"--variant-plainColor":"var(--variant-plainColor) !important","--variant-plainHoverColor":"var(--variant-plainHoverColor) !important","--variant-plainHoverBg":"var(--variant-plainHoverBg) !important","--variant-plainActiveBg":"var(--variant-plainActiveBg) !important","--variant-plainDisabledColor":"var(--variant-plainDisabledColor) !important","--variant-outlinedColor":"var(--variant-outlinedColor) !important","--variant-outlinedBorder":"var(--variant-outlinedBorder) !important","--variant-outlinedHoverColor":"var(--variant-outlinedHoverColor) !important","--variant-outlinedHoverBorder":"var(--variant-outlinedHoverBorder) !important","--variant-outlinedHoverBg":"var(--variant-outlinedHoverBg) !important","--variant-outlinedActiveBg":"var(--variant-outlinedActiveBg) !important","--variant-outlinedDisabledColor":"var(--variant-outlinedDisabledColor) !important","--variant-outlinedDisabledBorder":"var(--variant-outlinedDisabledBorder) !important","--variant-softColor":"var(--variant-softColor) !important","--variant-softHoverColor":"var(--variant-softHoverColor) !important","--variant-softBg":"var(--variant-softBg) !important","--variant-softHoverBg":"var(--variant-softHoverBg) !important","--variant-softActiveBg":"var(--variant-softActiveBg) !important","--variant-softActiveColor":"var(--variant-softActiveColor) !important","--variant-softDisabledColor":"var(--variant-softDisabledColor) !important","--variant-softDisabledBg":"var(--variant-softDisabledBg) !important","--variant-solidColor":"var(--variant-solidColor) !important","--variant-solidBg":"var(--variant-solidBg) !important","--variant-solidHoverBg":"var(--variant-solidHoverBg) !important","--variant-solidActiveBg":"var(--variant-solidActiveBg) !important","--variant-solidDisabledColor":"var(--variant-solidDisabledColor) !important","--variant-solidDisabledBg":"var(--variant-solidDisabledBg) !important","--Badge-ringColor":"var(--Badge-ringColor) !important",colorScheme:"unset",[t.getColorSchemeSelector("light")]:{[ee("--palette-focusVisible")]:`${(e=t.colorSchemes.light)==null?void 0:e.palette.focusVisible} !important`,[ee("--palette-background-body")]:`${(n=t.colorSchemes.light)==null?void 0:n.palette.background.body} !important`,[ee("--palette-background-surface")]:`${(r=t.colorSchemes.light)==null?void 0:r.palette.background.surface} !important`,[ee("--palette-background-popup")]:`${(i=t.colorSchemes.light)==null?void 0:i.palette.background.popup} !important`,[ee("--palette-background-level1")]:`${(l=t.colorSchemes.light)==null?void 0:l.palette.background.level1} !important`,[ee("--palette-background-level2")]:`${(c=t.colorSchemes.light)==null?void 0:c.palette.background.level2} !important`,[ee("--palette-background-level3")]:`${(s=t.colorSchemes.light)==null?void 0:s.palette.background.level3} !important`,[ee("--palette-text-primary")]:`${(p=t.colorSchemes.light)==null?void 0:p.palette.text.primary} !important`,[ee("--palette-text-secondary")]:`${(y=t.colorSchemes.light)==null?void 0:y.palette.text.secondary} !important`,[ee("--palette-text-tertiary")]:`${(_=t.colorSchemes.light)==null?void 0:_.palette.text.tertiary} !important`,[ee("--palette-divider")]:`${(w=t.colorSchemes.light)==null?void 0:w.palette.divider} !important`},[t.getColorSchemeSelector("dark")]:{[ee("--palette-focusVisible")]:`${(S=t.colorSchemes.dark)==null?void 0:S.palette.focusVisible} !important`,[ee("--palette-background-body")]:`${(M=t.colorSchemes.dark)==null?void 0:M.palette.background.body} !important`,[ee("--palette-background-surface")]:`${(I=t.colorSchemes.dark)==null?void 0:I.palette.background.surface} !important`,[ee("--palette-background-popup")]:`${(D=t.colorSchemes.dark)==null?void 0:D.palette.background.popup} !important`,[ee("--palette-background-level1")]:`${(R=t.colorSchemes.dark)==null?void 0:R.palette.background.level1} !important`,[ee("--palette-background-level2")]:`${(L=t.colorSchemes.dark)==null?void 0:L.palette.background.level2} !important`,[ee("--palette-background-level3")]:`${(V=t.colorSchemes.dark)==null?void 0:V.palette.background.level3} !important`,[ee("--palette-text-primary")]:`${(B=t.colorSchemes.dark)==null?void 0:B.palette.text.primary} !important`,[ee("--palette-text-secondary")]:`${(H=t.colorSchemes.dark)==null?void 0:H.palette.text.secondary} !important`,[ee("--palette-text-tertiary")]:`${(q=t.colorSchemes.dark)==null?void 0:q.palette.text.tertiary} !important`,[ee("--palette-divider")]:`${(X=t.colorSchemes.dark)==null?void 0:X.palette.divider} !important`}}};function BW(t){return t.theme!==void 0}const Z_=t=>e=>{const n=BW(e)?e.theme:e,r=jP(n.cssVarPrefix),i=nA(n.cssVarPrefix),l=c=>{const s=c.split("-");return r(c,n.palette[s[1]][s[2]])};return{[Z4]:{"--Badge-ringColor":l(`palette-${t}-solidBg`),"--Icon-color":"currentColor",[`${n.getColorSchemeSelector("light")}, ${n.getColorSchemeSelector("dark")}`]:{colorScheme:"dark",[i("--palette-focusVisible")]:l(`palette-${t}-200`),[i("--palette-background-body")]:"rgba(0 0 0 / 0.1)",[i("--palette-background-surface")]:"rgba(0 0 0 / 0.06)",[i("--palette-background-popup")]:l(`palette-${t}-700`),[i("--palette-background-level1")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.36)`,[i("--palette-background-level3")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.6)`,[i("--palette-text-primary")]:l("palette-common-white"),[i("--palette-text-secondary")]:l(`palette-${t}-200`),[i("--palette-text-tertiary")]:l(`palette-${t}-300`),[i("--palette-text-icon")]:l(`palette-${t}-200`),[i("--palette-divider")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-plainColor":l(`palette-${t}-50`),"--variant-plainHoverColor":"#fff","--variant-plainHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-outlinedColor":l(`palette-${t}-50`),"--variant-outlinedBorder":`rgba(${l(`palette-${t}-lightChannel`)} / 0.5)`,"--variant-outlinedHoverColor":"#fff","--variant-outlinedHoverBorder":l(`palette-${t}-300`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":"rgba(255 255 255 / 0.2)","--variant-softColor":l("palette-common-white"),"--variant-softHoverColor":l("palette-common-white"),"--variant-softBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.24)`,"--variant-softHoverBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.36)`,"--variant-softActiveBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.16)`,"--variant-softActiveColor":"#fff","--variant-softDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.1)`,"--variant-solidColor":l(`palette-${t}-${t==="neutral"?"600":"500"}`),"--variant-solidBg":l("palette-common-white"),"--variant-solidHoverBg":l("palette-common-white"),"--variant-solidActiveBg":l(`palette-${t}-100`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.1)`}},[`&, & [${Qv}]`]:Y4(n)}},Y_=t=>e=>{const{theme:n=e}=e,r=jP(n.cssVarPrefix),i=nA(n.cssVarPrefix),l=c=>{const s=c.split("-");return r(c,n.palette[s[1]][s[2]])};return{[Z4]:{"--Badge-ringColor":l(`palette-${t}-softBg`),"--Icon-color":"currentColor",[n.getColorSchemeSelector("dark")]:{[i("--palette-focusVisible")]:l(`palette-${t}-300`),[i("--palette-background-body")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.1)`,[i("--palette-background-surface")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,[i("--palette-background-level1")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,[i("--palette-background-level3")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,[i("--palette-text-primary")]:l(`palette-${t}-100`),[i("--palette-text-secondary")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.72)`,[i("--palette-text-tertiary")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.6)`,[i("--palette-text-icon")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.6)`,[i("--palette-divider")]:`rgba(${l(`palette-${t}-lightChannel`)} / 0.2)`,"--variant-plainColor":`rgba(${l(`palette-${t}-lightChannel`)} / 1)`,"--variant-plainHoverColor":l(`palette-${t}-50`),"--variant-plainHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.16)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-outlinedColor":`rgba(${l(`palette-${t}-lightChannel`)} / 1)`,"--variant-outlinedHoverColor":l(`palette-${t}-50`),"--variant-outlinedBg":"initial","--variant-outlinedBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverBorder":l(`palette-${t}-600`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.16)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-outlinedDisabledBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,"--variant-softColor":l(`palette-${t}-200`),"--variant-softBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-softHoverColor":"#fff","--variant-softHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-softActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.48)`,"--variant-softDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-solidColor":"#fff","--variant-solidBg":l(`palette-${t}-500`),"--variant-solidHoverColor":"#fff","--variant-solidHoverBg":l(`palette-${t}-600`),"--variant-solidActiveBg":l(`palette-${t}-600`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.72)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`},[n.getColorSchemeSelector("light")]:{[i("--palette-focusVisible")]:l(`palette-${t}-500`),[i("--palette-background-body")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.1)`,[i("--palette-background-surface")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,[i("--palette-background-level1")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.2)`,[i("--palette-background-level2")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,[i("--palette-background-level3")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.48)`,[i("--palette-text-primary")]:l(`palette-${t}-700`),[i("--palette-text-secondary")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.8)`,[i("--palette-text-tertiary")]:`rgba(${l(`palette-${t}-darkChannel`)} / 0.68)`,[i("--palette-text-icon")]:l(`palette-${t}-500`),[i("--palette-divider")]:`rgba(${l(`palette-${t}-mainChannel`)} / 0.32)`,"--variant-plainColor":`rgba(${l(`palette-${t}-darkChannel`)} / 0.8)`,"--variant-plainHoverColor":`rgba(${l(`palette-${t}-darkChannel`)} / 1)`,"--variant-plainHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-plainActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-plainDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-outlinedColor":`rgba(${l(`palette-${t}-mainChannel`)} / 1)`,"--variant-outlinedBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.4)`,"--variant-outlinedHoverColor":l(`palette-${t}-600`),"--variant-outlinedHoverBorder":l(`palette-${t}-300`),"--variant-outlinedHoverBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-outlinedActiveBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.24)`,"--variant-outlinedDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-outlinedDisabledBorder":`rgba(${l(`palette-${t}-mainChannel`)} / 0.12)`,"--variant-softColor":l(`palette-${t}-600`),"--variant-softBg":`rgba(${l(`palette-${t}-lightChannel`)} / 0.8)`,"--variant-softHoverColor":l(`palette-${t}-700`),"--variant-softHoverBg":l(`palette-${t}-200`),"--variant-softActiveBg":l(`palette-${t}-300`),"--variant-softDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-softDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`,"--variant-solidColor":l("palette-common-white"),"--variant-solidBg":l(`palette-${t}-${t==="neutral"?"700":"500"}`),"--variant-solidHoverColor":l("palette-common-white"),"--variant-solidHoverBg":l(`palette-${t}-600`),"--variant-solidActiveBg":l(`palette-${t}-600`),"--variant-solidDisabledColor":`rgba(${l(`palette-${t}-mainChannel`)} / 0.6)`,"--variant-solidDisabledBg":`rgba(${l(`palette-${t}-mainChannel`)} / 0.08)`}},[`&, & [${Qv}]`]:Y4(n)}},K4=Jm(ie.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),UW=Jm(ie.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),J4=G.createContext(void 0);function Mm(t,e){let n=e,r=t;return t==="outlined"&&(n="neutral",r="plain"),t==="plain"&&(n="neutral"),{variant:r,color:n}}function Hw(t,e,n=!1){const r=G.useContext(J4),[i,l]=typeof r=="string"?r.split(":"):[],c=Mm(i||void 0,l||void 0);return c.variant=t||c.variant,c.color=e||(n?l:c.color),c}function Gw({children:t,color:e,variant:n}){return ie.jsx(J4.Provider,{value:`${n||""}:${e||""}`,children:t})}function $W(t){return qr("MuiIconButton",t)}$r("MuiIconButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","loading","loadingIndicator"]);const rA=G.createContext({}),Q4=G.createContext(void 0);function VW(t){return qr("MuiCircularProgress",t)}$r("MuiCircularProgress",["root","determinate","svg","track","progress","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);let jW=t=>t,x3;const HW=["color","backgroundColor"],GW=["children","className","color","size","variant","thickness","determinate","value","component","slots","slotProps"],WW=IP({"0%":{transform:"rotate(-90deg)"},"100%":{transform:"rotate(270deg)"}}),qW=t=>{const{determinate:e,color:n,variant:r,size:i}=t,l={root:["root",e&&"determinate",n&&`color${Rn(n)}`,r&&`variant${Rn(r)}`,i&&`size${Rn(i)}`],svg:["svg"],track:["track"],progress:["progress"]};return Vr(l,VW,{})};function Xg(t,e){return`var(--CircularProgress-${t}Thickness, var(--CircularProgress-thickness, ${e}))`}const XW=_n("span",{name:"JoyCircularProgress",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,i,l;const c=((n=e.variants[t.variant])==null?void 0:n[t.color])||{},{color:s,backgroundColor:p}=c,y=rr(c,HW);return me({"--Icon-fontSize":"calc(0.4 * var(--_root-size))","--CircularProgress-trackColor":p,"--CircularProgress-progressColor":s,"--CircularProgress-percent":t.value,"--CircularProgress-linecap":"round"},t.size==="sm"&&{"--_root-size":"var(--CircularProgress-size, 24px)","--_track-thickness":Xg("track","3px"),"--_progress-thickness":Xg("progress","3px")},t.instanceSize==="sm"&&{"--CircularProgress-size":"24px"},t.size==="md"&&{"--_track-thickness":Xg("track","6px"),"--_progress-thickness":Xg("progress","6px"),"--_root-size":"var(--CircularProgress-size, 40px)"},t.instanceSize==="md"&&{"--CircularProgress-size":"40px"},t.size==="lg"&&{"--_track-thickness":Xg("track","8px"),"--_progress-thickness":Xg("progress","8px"),"--_root-size":"var(--CircularProgress-size, 64px)"},t.instanceSize==="lg"&&{"--CircularProgress-size":"64px"},t.thickness&&{"--_track-thickness":`${t.thickness}px`,"--_progress-thickness":`${t.thickness}px`},{"--_thickness-diff":"calc(var(--_track-thickness) - var(--_progress-thickness))","--_inner-size":"calc(var(--_root-size) - 2 * var(--variant-borderWidth, 0px))","--_outlined-inset":"max(var(--_track-thickness), var(--_progress-thickness))",width:"var(--_root-size)",height:"var(--_root-size)",borderRadius:"var(--_root-size)",margin:"var(--CircularProgress-margin)",boxSizing:"border-box",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0,position:"relative",color:s},t.children&&{fontFamily:e.vars.fontFamily.body,fontWeight:e.vars.fontWeight.md,fontSize:"calc(0.2 * var(--_root-size))"},y,t.variant==="outlined"&&{"&::before":me({content:'""',display:"block",position:"absolute",borderRadius:"inherit",top:"var(--_outlined-inset)",left:"var(--_outlined-inset)",right:"var(--_outlined-inset)",bottom:"var(--_outlined-inset)"},y)},t.variant==="soft"&&{"--CircularProgress-trackColor":e.variants.soft.neutral.backgroundColor,"--CircularProgress-progressColor":(r=e.variants.solid)==null?void 0:r[t.color].backgroundColor},t.variant==="solid"&&{"--CircularProgress-trackColor":(i=e.variants.softHover)==null?void 0:i[t.color].backgroundColor,"--CircularProgress-progressColor":(l=e.variants.solid)==null?void 0:l[t.color].backgroundColor})}),ZW=_n("svg",{name:"JoyCircularProgress",slot:"Svg",overridesResolver:(t,e)=>e.svg})({width:"inherit",height:"inherit",display:"inherit",boxSizing:"inherit",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))"}),YW=_n("circle",{name:"JoyCircularProgress",slot:"track",overridesResolver:(t,e)=>e.track})({cx:"50%",cy:"50%",r:"calc(var(--_inner-size) / 2 - var(--_track-thickness) / 2 + min(0px, var(--_thickness-diff) / 2))",fill:"transparent",strokeWidth:"var(--_track-thickness)",stroke:"var(--CircularProgress-trackColor)"}),KW=_n("circle",{name:"JoyCircularProgress",slot:"progress",overridesResolver:(t,e)=>e.progress})({"--_progress-radius":"calc(var(--_inner-size) / 2 - var(--_progress-thickness) / 2 - max(0px, var(--_thickness-diff) / 2))","--_progress-length":"calc(2 * 3.1415926535 * var(--_progress-radius))",cx:"50%",cy:"50%",r:"var(--_progress-radius)",fill:"transparent",strokeWidth:"var(--_progress-thickness)",stroke:"var(--CircularProgress-progressColor)",strokeLinecap:"var(--CircularProgress-linecap, round)",strokeDasharray:"var(--_progress-length)",strokeDashoffset:"calc(var(--_progress-length) - var(--CircularProgress-percent) * var(--_progress-length) / 100)",transformOrigin:"center",transform:"rotate(-90deg)"},({ownerState:t})=>!t.determinate&&o4(x3||(x3=jW`
      animation: var(--CircularProgress-circulation, 0.8s linear 0s infinite normal none running)
        ${0};
    `),WW)),iA=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyCircularProgress"}),{children:i,className:l,color:c="primary",size:s="md",variant:p="soft",thickness:y,determinate:_=!1,value:w=_?0:25,component:S,slots:M={},slotProps:I={}}=r,D=rr(r,GW),R=me({},r,{color:c,size:s,variant:p,thickness:y,value:w,determinate:_,instanceSize:e.size}),L=qW(R),V=me({},D,{component:S,slots:M,slotProps:I}),[B,H]=Bn("root",{ref:n,className:co(L.root,l),elementType:XW,externalForwardedProps:V,ownerState:R,additionalProps:me({role:"progressbar",style:{"--CircularProgress-percent":w}},w&&_&&{"aria-valuenow":Math.round(typeof w=="number"?w:Number(w||0))})}),[q,X]=Bn("svg",{className:L.svg,elementType:ZW,externalForwardedProps:V,ownerState:R}),[ee,se]=Bn("track",{className:L.track,elementType:YW,externalForwardedProps:V,ownerState:R}),[J,$]=Bn("progress",{className:L.progress,elementType:KW,externalForwardedProps:V,ownerState:R});return ie.jsxs(B,me({},H,{children:[ie.jsxs(q,me({},X,{children:[ie.jsx(ee,me({},se)),ie.jsx(J,me({},$))]})),i]}))}),JW=["children","action","component","color","disabled","variant","loading","loadingIndicator","size","slots","slotProps"],QW=t=>{const{color:e,disabled:n,focusVisible:r,focusVisibleClassName:i,size:l,variant:c,loading:s}=t,p={root:["root",n&&"disabled",r&&"focusVisible",c&&`variant${Rn(c)}`,e&&`color${Rn(e)}`,l&&`size${Rn(l)}`,s&&"loading"],loadingIndicator:["loadingIndicator"]},y=Vr(p,$W,{});return r&&i&&(y.root+=` ${i}`),y},K_=_n("button")(({theme:t,ownerState:e})=>{var n,r,i,l;return[me({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},e.instanceSize&&{"--IconButton-size":{sm:"2rem",md:"2.25rem",lg:"2.75rem"}[e.instanceSize]},e.size==="sm"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.6)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:t.vars.fontSize.sm,paddingInline:"2px"},e.size==="md"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.25rem) / 1.5)","--CircularProgress-size":"20px","--CircularProgress-thickness":"2px",minWidth:"var(--IconButton-size, 2.25rem)",minHeight:"var(--IconButton-size, 2.25rem)",fontSize:t.vars.fontSize.md,paddingInline:"0.25rem"},e.size==="lg"&&{"--Icon-fontSize":"calc(var(--IconButton-size, 2.75rem) / 1.571)","--CircularProgress-size":"28px","--CircularProgress-thickness":"4px",minWidth:"var(--IconButton-size, 2.75rem)",minHeight:"var(--IconButton-size, 2.75rem)",fontSize:t.vars.fontSize.lg,paddingInline:"0.375rem"},{WebkitTapHighlightColor:"transparent",paddingBlock:0,fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.md,margin:"var(--IconButton-margin)",borderRadius:`var(--IconButton-radius, ${t.vars.radius.sm})`,border:"none",boxSizing:"border-box",backgroundColor:"transparent",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",[t.focus.selector]:me({"--Icon-color":"currentColor"},t.focus.default)}),me({},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":{"@media (hover: hover)":me({"--Icon-color":"currentColor"},(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color])},'&:active, &[aria-pressed="true"]':me({"--Icon-color":"currentColor"},(i=t.variants[`${e.variant}Active`])==null?void 0:i[e.color]),"&:disabled":(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]})]}),eq=_n(K_,{name:"JoyIconButton",slot:"Root",overridesResolver:(t,e)=>e.root})({}),tq=_n("span",{name:"JoyIconButton",slot:"LoadingIndicator",overridesResolver:(t,e)=>e.loadingIndicator})(({theme:t,ownerState:e})=>{var n,r;return me({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),Ih=G.forwardRef(function(e,n){var r;const i=Xr({props:e,name:"JoyIconButton"}),{children:l,action:c,component:s="button",color:p="neutral",disabled:y,variant:_="plain",loading:w=!1,loadingIndicator:S,size:M="md",slots:I={},slotProps:D={}}=i,R=rr(i,JW),L=G.useContext(rA),V=G.useContext(Q4),B=e.variant||L.variant||_,H=e.size||L.size||M,q=e.color||L.color||p,X=(r=e.loading||e.disabled)!=null?r:L.disabled||w||y,ee=G.useRef(null),se=mi(ee,n),{focusVisible:J,setFocusVisible:$,getRootProps:le}=kh(me({},i,{disabled:X,rootRef:se})),Ce=S??ie.jsx(iA,{color:q,thickness:{sm:2,md:3,lg:4}[H]||3});G.useImperativeHandle(c,()=>({focusVisible:()=>{var Qe;$(!0),(Qe=ee.current)==null||Qe.focus()}}),[$]);const we=me({},i,{component:s,color:q,disabled:X,variant:B,loading:w,size:H,focusVisible:J,instanceSize:e.size}),We=QW(we),Fe=Qe=>{var Vt;let je=i.onClick;if(typeof D.root=="function"?je=D.root(we).onClick:D.root&&(je=D.root.onClick),(Vt=je)==null||Vt(Qe),V){var ct;(ct=V.onClick)==null||ct.call(V,Qe,i.value)}};let Me=i["aria-pressed"];typeof D.root=="function"?Me=D.root(we)["aria-pressed"]:D.root&&(Me=D.root["aria-pressed"]),V!=null&&V.value&&(Array.isArray(V.value)?Me=V.value.indexOf(i.value)!==-1:Me=V.value===i.value);const Ee=me({},R,{component:s,slots:I,slotProps:D}),[Te,Ze]=Bn("root",{ref:n,className:We.root,elementType:eq,getSlotProps:le,externalForwardedProps:Ee,ownerState:we,additionalProps:{onClick:Fe,"aria-pressed":Me}}),[rt,Re]=Bn("loadingIndicator",{className:We.loadingIndicator,elementType:tq,externalForwardedProps:Ee,ownerState:we});return ie.jsx(Te,me({},Ze,{children:w?ie.jsx(rt,me({},Re,{children:Ce})):l}))});Ih.muiName="IconButton";function nq(t){return qr("MuiChip",t)}const HE=$r("MuiChip",["root","clickable","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","disabled","endDecorator","focusVisible","label","labelSm","labelMd","labelLg","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantSolid","variantSoft","variantOutlined"]),eF=G.createContext({disabled:void 0,variant:void 0,color:void 0}),rq=["children","className","color","onClick","disabled","size","variant","startDecorator","endDecorator","component","slots","slotProps"],iq=t=>{const{disabled:e,size:n,color:r,clickable:i,variant:l,focusVisible:c}=t,s={root:["root",e&&"disabled",r&&`color${Rn(r)}`,n&&`size${Rn(n)}`,l&&`variant${Rn(l)}`,i&&"clickable"],action:["action",e&&"disabled",c&&"focusVisible"],label:["label",n&&`label${Rn(n)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Vr(s,nq,{})},oq=_n("div",{name:"JoyChip",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,i;const l=(n=t.variants[e.variant])==null?void 0:n[e.color],{borderRadius:c}=Km({theme:t,ownerState:e},["borderRadius"]);return[me({"--Chip-decoratorChildOffset":"min(calc(var(--Chip-paddingInline) - (var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2), var(--Chip-paddingInline))","--Chip-decoratorChildRadius":"max(var(--_Chip-radius) - var(--variant-borderWidth, 0px) - var(--_Chip-paddingBlock), min(var(--_Chip-paddingBlock) + var(--variant-borderWidth, 0px), var(--_Chip-radius) / 2))","--Chip-deleteRadius":"var(--Chip-decoratorChildRadius)","--Chip-deleteSize":"var(--Chip-decoratorChildHeight)","--Avatar-radius":"var(--Chip-decoratorChildRadius)","--Avatar-size":"var(--Chip-decoratorChildHeight)","--Icon-margin":"initial","--Icon-color":"currentColor","--unstable_actionRadius":"var(--_Chip-radius)"},e.size==="sm"&&{"--Chip-paddingInline":"0.375rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.sm,"--_Chip-minHeight":"var(--Chip-minHeight, 1.25rem)",gap:"3px"},e.size==="md"&&{"--Chip-paddingInline":"0.5rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.25rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.md,"--_Chip-minHeight":"var(--Chip-minHeight, 1.5rem)",gap:"0.25rem"},e.size==="lg"&&{"--Chip-paddingInline":"0.75rem","--Chip-decoratorChildHeight":"calc(var(--_Chip-minHeight) - 0.375rem - 2 * var(--variant-borderWidth))","--Icon-fontSize":t.vars.fontSize.lg,"--_Chip-minHeight":"var(--Chip-minHeight, 1.75rem)",gap:"0.375rem"},{"--_Chip-radius":"var(--Chip-radius, 1.5rem)","--_Chip-paddingBlock":"max((var(--_Chip-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Chip-decoratorChildHeight)) / 2, 0px)",minHeight:"var(--_Chip-minHeight)",maxWidth:"max-content",paddingInline:"var(--Chip-paddingInline)",borderRadius:"var(--_Chip-radius)",position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",textDecoration:"none",verticalAlign:"middle",boxSizing:"border-box"},t.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],{fontWeight:t.vars.fontWeight.md,[`&.${HE.disabled}`]:{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color}}),...e.clickable?[{"--variant-borderWidth":"0px",color:l?.color}]:[me({backgroundColor:t.vars.palette.background.surface},l,{[`&.${HE.disabled}`]:(i=t.variants[`${e.variant}Disabled`])==null?void 0:i[e.color]})],c!==void 0&&{"--_Chip-radius":c}]}),sq=_n("span",{name:"JoyChip",slot:"Label",overridesResolver:(t,e)=>e.label})(({ownerState:t})=>me({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",order:1,minInlineSize:0,flexGrow:1},t.clickable&&{zIndex:1,pointerEvents:"none"})),aq=_n("button",{name:"JoyChip",slot:"Action",overridesResolver:(t,e)=>e.action})(({theme:t,ownerState:e})=>{var n,r,i,l;return[{"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,position:"absolute",zIndex:0,top:0,left:0,bottom:0,right:0,width:"100%",border:"none",cursor:"pointer",padding:"initial",margin:"initial",backgroundColor:"initial",textDecoration:"none",borderRadius:"inherit",[t.focus.selector]:t.focus.default},me({backgroundColor:t.vars.palette.background.surface},(n=t.variants[e.variant])==null?void 0:n[e.color]),{"&:hover":{"@media (hover: hover)":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]}},{"&:active":(i=t.variants[`${e.variant}Active`])==null?void 0:i[e.color]},{[`&.${HE.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]}]}),lq=_n("span",{name:"JoyChip",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Avatar-marginInlineStart":"calc(var(--Chip-decoratorChildOffset) * -1)","--IconButton-margin":"0 calc(-1 * var(--Chip-paddingInline) / 3) 0 calc(var(--Chip-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Chip-paddingInline) / -4)",display:"inherit",order:0,zIndex:1,pointerEvents:"none"}),cq=_n("span",{name:"JoyChip",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--IconButton-margin":"0 calc(var(--Chip-decoratorChildOffset) * -1) 0 calc(-1 * var(--Chip-paddingInline) / 3)","--Icon-margin":"0 calc(var(--Chip-paddingInline) / -4) 0 0",display:"inherit",order:2,zIndex:1,pointerEvents:"none"}),tF=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyChip"}),{children:i,className:l,color:c="neutral",onClick:s,disabled:p=!1,size:y="md",variant:_="soft",startDecorator:w,endDecorator:S,component:M,slots:I={},slotProps:D={}}=r,R=rr(r,rq),L=!!s||!!D.action,V=me({},r,{disabled:p,size:y,color:c,variant:_,clickable:L,focusVisible:!1}),B=typeof D.action=="function"?D.action(V):D.action,H=G.useRef(null),{focusVisible:q,getRootProps:X}=kh(me({},B,{disabled:p,rootRef:H}));V.focusVisible=q;const ee=iq(V),se=me({},R,{component:M,slots:I,slotProps:D}),[J,$]=Bn("root",{ref:n,className:co(ee.root,l),elementType:oq,externalForwardedProps:se,ownerState:V}),[le,Ce]=Bn("label",{className:ee.label,elementType:sq,externalForwardedProps:se,ownerState:V}),we=il(Ce.id),[We,Fe]=Bn("action",{className:ee.action,elementType:aq,externalForwardedProps:se,ownerState:V,getSlotProps:X,additionalProps:{"aria-labelledby":we,as:B?.component,onClick:s}}),[Me,Ee]=Bn("startDecorator",{className:ee.startDecorator,elementType:lq,externalForwardedProps:se,ownerState:V}),[Te,Ze]=Bn("endDecorator",{className:ee.endDecorator,elementType:cq,externalForwardedProps:se,ownerState:V}),rt=G.useMemo(()=>({disabled:p}),[p]);return ie.jsx(eF.Provider,{value:rt,children:ie.jsx(Gw,{variant:_,color:c,children:ie.jsxs(J,me({},$,{children:[L&&ie.jsx(We,me({},Fe)),ie.jsx(le,me({},Ce,{id:we,children:i})),w&&ie.jsx(Me,me({},Ee,{children:w})),S&&ie.jsx(Te,me({},Ze,{children:S}))]}))})})}),uq=Jm(ie.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Cancel");function hq(t){return qr("MuiChipDelete",t)}$r("MuiChipDelete",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSolid","variantSoft","variantOutlined"]);var b3;const dq=["children","variant","color","disabled","onKeyDown","onDelete","onClick","component","slots","slotProps"],fq=["onDelete"],pq=t=>{const{focusVisible:e,variant:n,color:r,disabled:i}=t,l={root:["root",i&&"disabled",e&&"focusVisible",n&&`variant${Rn(n)}`,r&&`color${Rn(r)}`]};return Vr(l,hq,{})},mq=_n(K_,{name:"JoyChipDelete",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({"--IconButton-size":"var(--Chip-deleteSize, 2rem)","--Icon-fontSize":"calc(var(--IconButton-size, 2rem) / 1.3)",minWidth:"var(--IconButton-size, 2rem)",minHeight:"var(--IconButton-size, 2rem)",fontSize:t.vars.fontSize.sm,paddingInline:"2px",pointerEvents:"visible",borderRadius:"var(--Chip-deleteRadius, 50%)",zIndex:1,padding:0})),gq=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyChipDelete"}),{children:i,variant:l="plain",color:c="neutral",disabled:s,onKeyDown:p,onDelete:y,onClick:_,component:w,slots:S={},slotProps:M={}}=r,I=rr(r,dq),D=G.useContext(eF),{variant:R=l,color:L=c}=Hw(e.variant,e.color,!0),V=e.color||L,B=s??D.disabled,H=G.useRef(null),q=mi(H,n),{focusVisible:X,getRootProps:ee}=kh(me({},r,{disabled:B,rootRef:q})),se=me({},r,{disabled:B,variant:R,color:V,focusVisible:X}),J=pq(se),$=me({},I,{component:w,slots:S,slotProps:M}),le=Me=>{!B&&y&&y(Me),_&&_(Me)},Ce=Me=>{["Backspace","Enter","Delete"].includes(Me.key)&&(Me.preventDefault(),!B&&y&&y(Me)),p&&p(Me)},[we,We]=Bn("root",{ref:n,elementType:mq,getSlotProps:ee,externalForwardedProps:$,ownerState:se,additionalProps:{as:w,onKeyDown:Ce,onClick:le},className:J.root}),Fe=rr(We,fq);return ie.jsx(we,me({},Fe,{children:i??(b3||(b3=ie.jsx(uq,{})))}))});function vq(t){return qr("MuiInput",t)}const nF=$r("MuiInput",["root","input","formControl","focused","disabled","error","adornedStart","adornedEnd","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid","fullWidth","startDecorator","endDecorator"]),Ww=G.createContext(void 0),yq=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoFocus","className","defaultValue","disabled","disabledInProp","error","id","name","onClick","onChange","onKeyDown","onKeyUp","onFocus","onBlur","placeholder","readOnly","required","type","value"];function _q(t,e){var n;const r=G.useContext(Ww),{"aria-describedby":i,"aria-label":l,"aria-labelledby":c,autoComplete:s,autoFocus:p,className:y,defaultValue:_,disabled:w,disabledInProp:S,error:M,id:I,name:D,onClick:R,onChange:L,onKeyDown:V,onKeyUp:B,onFocus:H,onBlur:q,placeholder:X,readOnly:ee,required:se,type:J,value:$}=t,le=rr(t,yq),{getRootProps:Ce,getInputProps:we,focused:We,error:Fe,disabled:Me}=Z7({disabled:(n=S??r?.disabled)!=null?n:w,defaultValue:_,error:M,onBlur:q,onClick:R,onChange:L,onFocus:H,required:se??r?.required,value:$}),Ee={[e.disabled]:Me,[e.error]:Fe,[e.focused]:We,[e.formControl]:!!r,[y]:y},Te={[e.disabled]:Me};return me({formControl:r,propsToForward:{"aria-describedby":i,"aria-label":l,"aria-labelledby":c,autoComplete:s,autoFocus:p,disabled:Me,id:I,onKeyDown:V,onKeyUp:B,name:D,placeholder:X,readOnly:ee,type:J},rootStateClasses:Ee,inputStateClasses:Te,getRootProps:Ce,getInputProps:we,focused:We,error:Fe,disabled:Me},le)}const xq=["propsToForward","rootStateClasses","inputStateClasses","getRootProps","getInputProps","formControl","focused","error","disabled","fullWidth","size","color","variant","startDecorator","endDecorator","component","slots","slotProps"],bq=t=>{const{disabled:e,fullWidth:n,variant:r,color:i,size:l}=t,c={root:["root",e&&"disabled",n&&"fullWidth",r&&`variant${Rn(r)}`,i&&`color${Rn(i)}`,l&&`size${Rn(l)}`],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Vr(c,vq,{})},rF=_n("div")(({theme:t,ownerState:e})=>{var n,r,i,l,c,s;const p=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color];return[me({"--Input-radius":t.vars.radius.sm,"--Input-gap":"0.5rem","--Input-placeholderColor":"inherit","--Input-placeholderOpacity":.64,"--Input-decoratorColor":t.vars.palette.text.icon,"--Input-focused":"0","--Input-focusedThickness":t.vars.focus.thickness,"--Input-focusedHighlight":(r=t.vars.palette[e.color==="neutral"?"primary":e.color])==null?void 0:r[500],[`&:not([${Qv}])`]:me({},e.instanceColor&&{"--_Input-focusedHighlight":(i=t.vars.palette[e.instanceColor==="neutral"?"primary":e.instanceColor])==null?void 0:i[500]},{"--Input-focusedHighlight":`var(--_Input-focusedHighlight, ${t.vars.palette.focusVisible})`})},e.size==="sm"&&{"--Input-minHeight":"2rem","--Input-paddingInline":"0.5rem","--Input-decoratorChildHeight":"min(1.5rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl},e.size==="md"&&{"--Input-minHeight":"2.25rem","--Input-paddingInline":"0.75rem","--Input-decoratorChildHeight":"min(1.75rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},e.size==="lg"&&{"--Input-minHeight":"2.75rem","--Input-paddingInline":"1rem","--Input-gap":"0.75rem","--Input-decoratorChildHeight":"min(2.25rem, var(--Input-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},{"--Input-decoratorChildOffset":"min(calc(var(--Input-paddingInline) - (var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2), var(--Input-paddingInline))","--_Input-paddingBlock":"max((var(--Input-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Input-decoratorChildHeight)) / 2, 0px)","--Input-decoratorChildRadius":"max(var(--Input-radius) - var(--variant-borderWidth, 0px) - var(--_Input-paddingBlock), min(var(--_Input-paddingBlock) + var(--variant-borderWidth, 0px), var(--Input-radius) / 2))","--Button-minHeight":"var(--Input-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Input-decoratorChildHeight)","--Button-radius":"var(--Input-decoratorChildRadius)","--IconButton-radius":"var(--Input-decoratorChildRadius)",boxSizing:"border-box"},e.variant!=="plain"&&{boxShadow:t.shadow.xs},{minWidth:0,minHeight:"var(--Input-minHeight)"},e.fullWidth&&{width:"100%"},{cursor:"text",position:"relative",display:"flex",paddingInline:"var(--Input-paddingInline)",borderRadius:"var(--Input-radius)"},t.typography[`body-${e.size}`],p,{backgroundColor:(l=p?.backgroundColor)!=null?l:t.vars.palette.background.surface,"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)",boxShadow:"var(--Input-focusedInset, inset) 0 0 0 calc(var(--Input-focused) * var(--Input-focusedThickness)) var(--Input-focusedHighlight)"}}),{"&:hover":me({},(c=t.variants[`${e.variant}Hover`])==null?void 0:c[e.color],{backgroundColor:null}),[`&.${nF.disabled}`]:(s=t.variants[`${e.variant}Disabled`])==null?void 0:s[e.color],"&:focus-within::before":{"--Input-focused":"1"}}]}),iF=_n("input")(({ownerState:t})=>({border:"none",minWidth:0,outline:0,padding:0,flex:1,color:"inherit",backgroundColor:"transparent",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontWeight:"inherit",lineHeight:"inherit",textOverflow:"ellipsis","&:-webkit-autofill":me({paddingInline:"var(--Input-paddingInline)"},!t.startDecorator&&{marginInlineStart:"calc(-1 * var(--Input-paddingInline))",paddingInlineStart:"var(--Input-paddingInline)",borderTopLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomLeftRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"},!t.endDecorator&&{marginInlineEnd:"calc(-1 * var(--Input-paddingInline))",paddingInlineEnd:"var(--Input-paddingInline)",borderTopRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))",borderBottomRightRadius:"calc(var(--Input-radius) - var(--variant-borderWidth, 0px))"}),"&::-webkit-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-moz-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&:-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"},"&::-ms-input-placeholder":{color:"var(--Input-placeholderColor)",opacity:"var(--Input-placeholderOpacity)"}})),oF=_n("div")({"--Button-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Input-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Input-paddingInline) / -4)",display:"inherit",alignItems:"center",paddingBlock:"var(--unstable_InputPaddingBlock)",flexWrap:"wrap",marginInlineEnd:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),sF=_n("div")({"--Button-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Input-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Input-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",marginInlineStart:"var(--Input-gap)",color:"var(--Input-decoratorColor)",cursor:"initial"}),wq=_n(rF,{name:"JoyInput",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Sq=_n(iF,{name:"JoyInput",slot:"Input",overridesResolver:(t,e)=>e.input})({}),Mq=_n(oF,{name:"JoyInput",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({}),Cq=_n(sF,{name:"JoyInput",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({}),Eq=G.forwardRef(function(e,n){var r,i,l,c,s,p;const y=Xr({props:e,name:"JoyInput"}),_=_q(me({},y,{disabledInProp:e.disabled}),nF),{propsToForward:w,rootStateClasses:S,inputStateClasses:M,getRootProps:I,getInputProps:D,formControl:R,focused:L,error:V=!1,disabled:B,fullWidth:H=!1,size:q="md",color:X="neutral",variant:ee="outlined",startDecorator:se,endDecorator:J,component:$,slots:le={},slotProps:Ce={}}=_,we=rr(_,xq),We=(r=(i=e.error)!=null?i:R?.error)!=null?r:V,Fe=(l=(c=e.size)!=null?c:R?.size)!=null?l:q,Me=(s=e.color)!=null?s:We?"danger":(p=R?.color)!=null?p:X,Ee=me({instanceColor:We?"danger":e.color},y,{fullWidth:H,color:Me,disabled:B,error:We,focused:L,size:Fe,variant:ee}),Te=bq(Ee),Ze=me({},we,{component:$,slots:le,slotProps:Ce}),[rt,Re]=Bn("root",{ref:n,className:[Te.root,S],elementType:wq,getSlotProps:I,externalForwardedProps:Ze,ownerState:Ee}),[Qe,Vt]=Bn("input",me({},R&&{additionalProps:{id:R.htmlFor,"aria-describedby":R["aria-describedby"]}},{className:[Te.input,M],elementType:Sq,getSlotProps:D,internalForwardedProps:w,externalForwardedProps:Ze,ownerState:Ee})),[je,ct]=Bn("startDecorator",{className:Te.startDecorator,elementType:Mq,externalForwardedProps:Ze,ownerState:Ee}),[Ct,ut]=Bn("endDecorator",{className:Te.endDecorator,elementType:Cq,externalForwardedProps:Ze,ownerState:Ee});return ie.jsxs(rt,me({},Re,{children:[se&&ie.jsx(je,me({},ct,{children:se})),ie.jsx(Qe,me({},Vt)),J&&ie.jsx(Ct,me({},ut,{children:J}))]}))});function Tq(t){return qr("MuiListSubheader",t)}$r("MuiListSubheader",["root","sticky","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const Pq=["component","className","children","id","sticky","variant","color","slots","slotProps"],Aq=t=>{const{variant:e,color:n,sticky:r}=t,i={root:["root",r&&"sticky",n&&`color${Rn(n)}`,e&&`variant${Rn(e)}`]};return Vr(i,Tq,{})},Iq=_n("div",{name:"JoyListSubheader",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;return me({boxSizing:"border-box",display:"flex",alignItems:"center",marginInline:"var(--ListItem-marginInline)",paddingBlock:"var(--ListItem-paddingY)",paddingInlineStart:"var(--ListItem-paddingLeft)",paddingInlineEnd:"var(--ListItem-paddingRight)",minBlockSize:"var(--ListItem-minHeight)"},t.typography["body-xs"],{fontSize:"max(0.75em, 0.625rem)",textTransform:"uppercase",letterSpacing:"0.1em"},e.sticky&&{position:"sticky",top:"var(--ListItem-stickyTop, 0px)",zIndex:1,background:"var(--ListItem-stickyBackground)"},{color:e.color?`var(--_Link-color, rgba(${(n=t.vars.palette[e.color])==null?void 0:n.mainChannel} / 1))`:t.vars.palette.text.tertiary},e.instanceColor&&{[`&:not([${Qv}])`]:{"--_Link-color":t.vars.palette.text.secondary}},(r=t.variants[e.variant])==null?void 0:r[e.color])}),Rq=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListSubheader"}),{component:i,className:l,children:c,id:s,sticky:p=!1,variant:y,color:_,slots:w={},slotProps:S={}}=r,M=rr(r,Pq),I=il(s),D=G.useContext(X4);G.useEffect(()=>{D&&D(I||"")},[D,I]);const R=me({instanceColor:e.color},r,{id:I,sticky:p,variant:y,color:y?_??"neutral":_}),L=Aq(R),V=me({},M,{component:i,slots:w,slotProps:S}),[B,H]=Bn("root",{ref:n,className:co(L.root,l),elementType:Iq,externalForwardedProps:V,ownerState:R,additionalProps:{as:i,id:I}});return ie.jsx(B,me({},H,{children:c}))});function Lq(t){return qr("MuiAutocomplete",t)}const Wf=$r("MuiAutocomplete",["root","wrapper","input","startDecorator","endDecorator","formControl","focused","disabled","error","multiple","limitTag","hasPopupIcon","hasClearIcon","clearIndicator","popupIndicator","popupIndicatorOpen","listbox","option","loading","noOptions","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]),aF=_n(q_)(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return me({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":r?.backgroundColor||r?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},Vw,{boxShadow:t.shadow.md,borderRadius:`var(--List-radius, ${t.vars.radius.sm})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup},{zIndex:t.vars.zIndex.popup,overflow:"auto",maxHeight:"40vh",position:"relative","&:empty":{visibility:"hidden"},[`& .${Ib.nested}, & .${Ib.nested} .${IW.root}`]:{position:"initial"}})});_n(aF,{name:"JoyAutocompleteListbox",slot:"Root",overridesResolver:(t,e)=>e.root})({});function kq(t){return qr("MuiAutocompleteOption",t)}$r("MuiAutocompleteOption",["root","focused","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const Dq=["children","component","color","variant","className","slots","slotProps"],zq=t=>{const{color:e,variant:n}=t,r={root:["root",e&&`color${Rn(e)}`,n&&`variant${Rn(n)}`]};return Vr(r,kq,{})},lF=_n(X_)(({theme:t,ownerState:e})=>{var n,r;return{'&[aria-disabled="true"]':(n=t.variants[`${e.variant}Disabled`])==null?void 0:n[e.color],'&[aria-selected="true"]':me({},(r=t.variants[`${e.variant}Active`])==null?void 0:r[e.color],{fontWeight:t.vars.fontWeight.md})}}),Oq=_n(lF,{name:"JoyAutocompleteOption",slot:"Root",overridesResolver:(t,e)=>e.root})({}),cF=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyAutocompleteOption"}),{children:i,component:l="li",color:c="neutral",variant:s="plain",className:p,slots:y={},slotProps:_={}}=r,w=rr(r,Dq),{variant:S=s,color:M=c}=Hw(e.variant,e.color),I=me({},r,{component:l,color:M,variant:S}),D=zq(I),R=me({},w,{component:l,slots:y,slotProps:_}),[L,V]=Bn("root",{ref:n,className:co(D.root,p),elementType:Oq,externalForwardedProps:R,ownerState:I,additionalProps:{as:l,role:"option"}});return ie.jsx(L,me({},V,{children:i}))});var w3,S3;const Fq=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoHighlight","autoSelect","autoFocus","blurOnSelect","clearIcon","clearOnBlur","clearOnEscape","clearText","closeText","defaultValue","disableCloseOnSelect","disabledItemsFocusable","disableListWrap","disableClearable","disabled","endDecorator","error","filterOptions","filterSelectedOptions","forcePopupIcon","freeSolo","getLimitTagsText","getOptionDisabled","getOptionKey","getOptionLabel","handleHomeEndKeys","includeInputInList","isOptionEqualToValue","groupBy","id","inputValue","limitTags","loading","loadingText","multiple","name","noOptionsText","onChange","onClose","onHighlightChange","onInputChange","onOpen","open","openOnFocus","openText","options","placeholder","popupIcon","readOnly","renderGroup","renderOption","renderTags","required","type","startDecorator","size","color","variant","value","component","selectOnFocus","slots","slotProps"],Nq=["onDelete"],Bq=["key"],Uq=["onBlur","onFocus","onMouseDown"],$q=["key"],Vq=t=>t.current!==null&&t.current.contains(document.activeElement),jq=t=>{var e;return(e=t.label)!=null?e:t},Hq=t=>`+${t}`,Gq=t=>ie.jsxs(gp,{nested:!0,children:[ie.jsx(Rq,{sticky:!0,children:t.group}),ie.jsx(jw,{children:t.children})]},t.key),Wq=t=>{const{disabled:e,focused:n,hasClearIcon:r,hasPopupIcon:i,popupOpen:l,variant:c,color:s,size:p,multiple:y}=t,_={root:["root",n&&"focused",r&&"hasClearIcon",i&&"hasPopupIcon",c&&`variant${Rn(c)}`,s&&`color${Rn(s)}`,p&&`size${Rn(p)}`],wrapper:["wrapper",y&&"multiple"],input:["input"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],clearIndicator:["clearIndicator"],popupIndicator:["popupIndicator",l&&"popupIndicatorOpen",e&&"disabled"],listbox:["listbox"],option:["option"],loading:["loading"],noOptions:["noOptions"],limitTag:["limitTag"]};return Vr(_,Lq,{})},qq=_n(rF,{name:"JoyAutocomplete",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>me({},t.size==="sm"&&{"--Autocomplete-wrapperGap":"3px"},t.size==="md"&&{"--Autocomplete-wrapperGap":"3px"},t.size==="lg"&&{"--Autocomplete-wrapperGap":"4px"},{"@media (pointer: fine)":{[`&:hover .${Wf.clearIndicator}`]:{visibility:"visible"}}},t.multiple&&!t.startDecorator&&{paddingInlineStart:0})),Xq=_n("div",{name:"JoyAutocomplete",slot:"Wrapper",overridesResolver:(t,e)=>e.wrapper})(({ownerState:t})=>({flex:1,minWidth:0,display:"flex",alignItems:"center",flexWrap:"wrap",gap:"var(--Autocomplete-wrapperGap)",[`&.${Wf.multiple}`]:me({paddingBlock:"var(--Autocomplete-wrapperGap)"},!t.startDecorator&&{paddingInlineStart:"var(--Autocomplete-wrapperGap)"},!t.endDecorator&&{paddingInlineEnd:"var(--Autocomplete-wrapperGap)"})})),Zq=_n(iF,{name:"JoyAutocomplete",slot:"Input",overridesResolver:(t,e)=>e.input})(({ownerState:t})=>me({minWidth:30,minHeight:"var(--Chip-minHeight)"},t.multiple&&{marginInlineStart:"calc(var(--Autocomplete-wrapperGap) * 2.5)"})),Yq=_n(oF,{name:"JoyAutocomplete",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({}),Kq=_n(sF,{name:"JoyAutocomplete",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})(({ownerState:t})=>me({},(t.hasClearIcon||t.hasPopupIcon)&&{"--Button-margin":"0px","--IconButton-margin":"0px","--Icon-margin":"0px"})),Jq=_n(K_,{name:"JoyAutocomplete",slot:"ClearIndicator",overridesResolver:(t,e)=>e.clearIndicator})(({ownerState:t})=>me({alignSelf:"center"},!t.hasPopupIcon&&{marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)"},{marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",visibility:t.focused?"visible":"hidden"})),Qq=_n(K_,{name:"JoyAutocomplete",slot:"PopupIndicator",overridesResolver:(t,e)=>e.popupIndicator})({alignSelf:"center",marginInlineStart:"calc(var(--_Input-paddingBlock) / 2)",marginInlineEnd:"calc(var(--Input-decoratorChildOffset) * -1)",[`&.${Wf.popupIndicatorOpen}`]:{transform:"rotate(180deg)","--Icon-color":"currentColor"}}),eX=_n(aF,{name:"JoyAutocomplete",slot:"Listbox",overridesResolver:(t,e)=>e.listbox})(({theme:t})=>({zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`})),tX=_n(lF,{name:"JoyAutocomplete",slot:"Option",overridesResolver:(t,e)=>e.option})({}),nX=_n(gp,{name:"JoyAutocomplete",slot:"Loading",overridesResolver:(t,e)=>e.loading})(({theme:t})=>({color:(t.vars||t).palette.text.secondary})),rX=_n(gp,{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(t,e)=>e.noOptions})(({theme:t})=>({color:(t.vars||t).palette.text.secondary})),iX=_n("div",{name:"JoyAutocomplete",slot:"NoOptions",overridesResolver:(t,e)=>e.noOptions})({marginInlineStart:"calc(var(--Input-paddingInline) / 2)",marginBlockStart:"var(--_Input-paddingBlock)"}),Lb=G.forwardRef(function(e,n){var r,i,l,c,s,p,y;const _=Xr({props:e,name:"JoyAutocomplete"}),{"aria-describedby":w,"aria-label":S,"aria-labelledby":M,autoFocus:I,clearIcon:D=w3||(w3=ie.jsx(K4,{fontSize:"md"})),clearText:R="Clear",closeText:L="Close",disableClearable:V=!1,disabled:B,endDecorator:H,error:q=!1,forcePopupIcon:X="auto",freeSolo:ee=!1,getLimitTagsText:se=Hq,getOptionLabel:J=jq,groupBy:$,id:le,limitTags:Ce=-1,loading:we=!1,loadingText:We="Loading…",multiple:Fe=!1,name:Me,noOptionsText:Ee="No options",openText:Te="Open",placeholder:Ze,popupIcon:rt=S3||(S3=ie.jsx(UW,{})),readOnly:Re=!1,renderGroup:Qe=Gq,renderOption:Vt,renderTags:je,required:ct,type:Ct,startDecorator:ut,size:lt="md",color:_t="neutral",variant:wt="outlined",component:cn,slots:dn={},slotProps:tn={}}=_,Je=rr(_,Fq),Tn=G.useContext(Ww),Kt=(r=(i=e.error)!=null?i:Tn?.error)!=null?r:q,fn=(l=(c=e.size)!=null?c:Tn?.size)!=null?l:lt,Ut=(s=e.color)!=null?s:Kt?"danger":(p=Tn?.color)!=null?p:_t,On=(y=B??Tn?.disabled)!=null?y:!1,{getRootProps:vn,getInputProps:Ue,getPopupIndicatorProps:Se,getClearProps:yt,getTagProps:Nt,getListboxProps:Ht,getOptionProps:Ot,value:un,dirty:Gt,popupOpen:Zt,focused:Nn,focusedTag:Yt,anchorEl:Pe,setAnchorEl:ae,inputValue:ue,groupedOptions:ne}=yW(me({},_,{id:le??Tn?.htmlFor,componentName:"Autocomplete",unstable_classNamePrefix:"Mui",unstable_isActiveElementInListbox:Vq})),{onMouseDown:fe}=Ue(),{onClick:Oe}=vn(),Ke=!V&&!On&&Gt&&!Re,ye=(!ee||X===!0)&&X!==!1,Ae=me({instanceColor:e.color},_,{value:un,disabled:On,focused:Nn,getOptionLabel:J,hasOptions:!!ne.length,hasClearIcon:Ke,hasPopupIcon:ye,inputFocused:Yt===-1,popupOpen:Zt,size:fn,color:Ut,variant:wt}),Be=Wq(Ae),$e=me({},Je,{component:cn,slots:dn,slotProps:tn});let He;if(Fe&&un.length>0){const Qt=Zn=>{const In=Nt(Zn),{onDelete:Wn}=In,tr=rr(In,Nq);return me({disabled:On,size:fn,onClick:Wn},tr)};je?He=je(un,Qt,Ae):He=un.map((Zn,In)=>{const Wn=Qt({index:In}),{key:tr}=Wn,Or=rr(Wn,Bq);return ie.jsx(tF,{size:fn,variant:"soft",color:"neutral",endDecorator:ie.jsx(gq,me({},Or),tr),sx:{minWidth:0},children:J(Zn)},In)})}const dt=mi(n,ae),qe={[Wf.disabled]:On,[Wf.error]:Kt,[Wf.focused]:Nn,[Wf.formControl]:!!Tn},[$t,Jt]=Bn("root",{ref:dt,className:[Be.root,qe],elementType:qq,externalForwardedProps:$e,ownerState:Ae,getSlotProps:vn,additionalProps:{onClick:Qt=>{Oe&&Oe(Qt),Qt.currentTarget===Qt.target&&fe&&fe(Qt)}}}),[Ie,ot]=Bn("wrapper",{className:Be.wrapper,elementType:Xq,externalForwardedProps:$e,ownerState:Ae}),mt={[Wf.disabled]:On},[Wt,nn]=Bn("input",{className:[Be.input,mt],elementType:Zq,getSlotProps:Qt=>{const Zn=Ue(),{onBlur:In,onFocus:Wn,onMouseDown:tr}=Zn,Or=rr(Zn,Uq);return me({},Or,{onBlur:Fr=>{var wr;In?.(Fr),(wr=Qt.onBlur)==null||wr.call(Qt,Fr)},onFocus:Fr=>{var wr;Wn?.(Fr),(wr=Qt.onFocus)==null||wr.call(Qt,Fr)},onMouseDown:Fr=>{var wr;tr?.(Fr),(wr=Qt.onMouseDown)==null||wr.call(Qt,Fr)}})},externalForwardedProps:$e,ownerState:Ae,additionalProps:{autoFocus:I,placeholder:Ze,name:Me,readOnly:Re,disabled:On,required:ct??Tn?.required,type:Ct,"aria-invalid":Kt||void 0,"aria-label":S,"aria-labelledby":M,"aria-describedby":w??Tn?.["aria-describedby"]}}),[mn,on]=Bn("startDecorator",{className:Be.startDecorator,elementType:Yq,externalForwardedProps:$e,ownerState:Ae}),[sn,Dn]=Bn("endDecorator",{className:Be.endDecorator,elementType:Kq,externalForwardedProps:$e,ownerState:Ae}),[Et,Gn]=Bn("clearIndicator",{className:Be.clearIndicator,elementType:Jq,getSlotProps:yt,externalForwardedProps:$e,ownerState:Ae,getSlotOwnerState:Qt=>({size:Qt.size||fn,variant:Qt.variant||Mm(wt,Ut).variant||"plain",color:Qt.color||Mm(wt,Ut).color||"neutral",disableColorInversion:!!e.color}),additionalProps:{"aria-label":R,title:R}}),[Fn,or]=Bn("popupIndicator",{className:Be.popupIndicator,elementType:Qq,getSlotProps:Se,externalForwardedProps:$e,ownerState:Ae,getSlotOwnerState:Qt=>({size:Qt.size||fn,variant:Qt.variant||Mm(wt,Ut).variant||"plain",color:Qt.color||Mm(wt,Ut).color||"neutral",disableColorInversion:!!e.color}),additionalProps:{disabled:On,"aria-label":Zt?L:Te,title:Zt?L:Te,type:"button"}}),[It,nt]=Bn("listbox",{className:Be.listbox,elementType:eX,getSlotProps:Ht,externalForwardedProps:$e,ownerState:Ae,getSlotOwnerState:Qt=>({size:Qt.size||fn,variant:Qt.variant||wt,color:Qt.color||Ut,disableColorInversion:!Qt.disablePortal}),additionalProps:{anchorEl:Pe,open:Zt,style:Pe?{width:Pe.clientWidth}:{}}}),[qt,hn]=Bn("loading",{className:Be.loading,elementType:nX,externalForwardedProps:$e,ownerState:Ae}),[kn,Ir]=Bn("noOptions",{className:Be.noOptions,elementType:rX,externalForwardedProps:$e,ownerState:Ae,additionalProps:{role:"presentation",onMouseDown:Qt=>{Qt.preventDefault()}}}),[xr,xe]=Bn("limitTag",{className:Be.limitTag,elementType:iX,externalForwardedProps:$e,ownerState:Ae});if(Ce>-1&&Array.isArray(He)){const Qt=He.length-Ce;!Nn&&Qt>0&&(He=He.splice(0,Ce),He.push(ie.jsx(xr,me({},xe,{children:se(Qt)}),He.length)))}const[vt,Dt]=Bn("option",{className:Be.option,elementType:tX,externalForwardedProps:$e,ownerState:Ae,getSlotOwnerState:Qt=>({variant:Qt.variant||Mm(wt,Ut).variant||"plain",color:Qt.color||Mm(wt,Ut).color||"neutral",disableColorInversion:!nt.disablePortal}),additionalProps:{as:"li"}}),St=Vt||((Qt,Zn)=>{const{key:In}=Qt,Wn=rr(Qt,$q);return ie.jsx(vt,me({},Wn,{children:J(Zn)}),In)}),pn=(Qt,Zn)=>{const In=Ot({option:Qt,index:Zn});return St(me({},Dt,In),Qt,{selected:!!In["aria-selected"],inputValue:ue,ownerState:Ae})},An=G.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...nt.modifiers||[]],[nt.modifiers]);let gn=null;if(Pe){var Pn;gn=ie.jsx(Gw,{variant:wt,color:Ut,children:ie.jsx(W_,{nested:!0,children:ie.jsxs(It,me({},nt,{className:co(nt.className),modifiers:An},!((Pn=_.slots)!=null&&Pn.listbox)&&{as:Bw,slots:{root:nt.as||"ul"}},{children:[ne.map((Qt,Zn)=>{if($){const In=Qt;return Qe({key:String(In.key),group:In.group,children:In.options.map((Wn,tr)=>pn(Wn,In.index+tr))})}return pn(Qt,Zn)}),we&&ne.length===0?ie.jsx(qt,me({},hn,{children:We})):null,ne.length===0&&!ee&&!we?ie.jsx(kn,me({},Ir,{children:Ee})):null]}))})})}return ie.jsxs(G.Fragment,{children:[ie.jsxs($t,me({},Jt,{children:[ut&&ie.jsx(mn,me({},on,{children:ut})),ie.jsxs(Ie,me({},ot,{children:[He,ie.jsx(Wt,me({},nn))]})),H&&ie.jsx(sn,me({},Dn,{children:H})),Ke?ie.jsx(Et,me({},Gn,{children:D})):null,ye?ie.jsx(Fn,me({},or,{children:rt})):null]})),gn]})}),oX=Jm(ie.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function sX(t){return qr("MuiAvatar",t)}$r("MuiAvatar",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","fallback","sizeSm","sizeMd","sizeLg","img","variantOutlined","variantSoft","variantSolid"]);const aX=G.createContext(void 0);_n("div",{name:"JoyAvatarGroup",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>me({},t.size==="sm"&&{"--AvatarGroup-gap":"-0.375rem","--Avatar-ringSize":"2px"},t.size==="md"&&{"--AvatarGroup-gap":"-0.5rem","--Avatar-ringSize":"2px"},t.size==="lg"&&{"--AvatarGroup-gap":"-0.625rem","--Avatar-ringSize":"4px"},{"--Avatar-ring":`0 0 0 var(--Avatar-ringSize) var(--Avatar-ringColor, ${e.vars.palette.background.surface})`,"--Avatar-marginInlineStart":"var(--AvatarGroup-gap)",display:"flex",marginInlineStart:"calc(-1 * var(--AvatarGroup-gap))"}));const lX=["alt","color","size","variant","src","srcSet","children","component","slots","slotProps"],cX=t=>{const{size:e,variant:n,color:r,src:i,srcSet:l}=t,c={root:["root",n&&`variant${Rn(n)}`,r&&`color${Rn(r)}`,e&&`size${Rn(e)}`],img:[(i||l)&&"img"],fallback:["fallback"]};return Vr(c,sX,{})},uX=_n("div",{name:"JoyAvatar",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return me({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},t.typography[`title-${e.size}`],e.size==="sm"&&{width:"var(--Avatar-size, 2rem)",height:"var(--Avatar-size, 2rem)",fontSize:"calc(var(--Avatar-size, 2rem) * 0.4375)"},e.size==="md"&&{width:"var(--Avatar-size, 2.5rem)",height:"var(--Avatar-size, 2.5rem)",fontSize:"calc(var(--Avatar-size, 2.5rem) * 0.4)"},e.size==="lg"&&{width:"var(--Avatar-size, 3rem)",height:"var(--Avatar-size, 3rem)",fontSize:"calc(var(--Avatar-size, 3rem) * 0.375)"},{marginInlineStart:"var(--Avatar-marginInlineStart)",boxShadow:"var(--Avatar-ring)",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,lineHeight:1,overflow:"hidden",borderRadius:"var(--Avatar-radius, 50%)",userSelect:"none"},(n=t.variants[e.variant])==null?void 0:n[e.color])}),hX=_n("img",{name:"JoyAvatar",slot:"Img",overridesResolver:(t,e)=>e.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),dX=_n(oX,{name:"JoyAvatar",slot:"Fallback",overridesResolver:(t,e)=>e.fallback})({width:"64%",height:"64%"});function fX({crossOrigin:t,referrerPolicy:e,src:n,srcSet:r}){const[i,l]=G.useState(!1);return G.useEffect(()=>{if(!n&&!r)return;l(!1);let c=!0;const s=new Image;return s.onload=()=>{c&&l("loaded")},s.onerror=()=>{c&&l("error")},s.crossOrigin=t,s.referrerPolicy=e,n&&(s.src=n),r&&(s.srcset=r),()=>{c=!1}},[t,e,n,r]),i}const pX=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyAvatar"}),i=G.useContext(aX),{alt:l,color:c="neutral",size:s="md",variant:p="soft",src:y,srcSet:_,children:w,component:S,slots:M={},slotProps:I={}}=r,D=rr(r,lX),R=e.variant||i?.variant||p,L=e.color||i?.color||c,V=e.size||i?.size||s;let B=null;const H=me({},r,{color:L,size:V,variant:R,grouped:!!i}),q=cX(H),X=me({},D,{component:S,slots:M,slotProps:I}),[ee,se]=Bn("root",{ref:n,className:q.root,elementType:uX,externalForwardedProps:X,ownerState:H}),[J,$]=Bn("img",{additionalProps:{alt:l,src:y,srcSet:_},className:q.img,elementType:hX,externalForwardedProps:X,ownerState:H}),[le,Ce]=Bn("fallback",{className:q.fallback,elementType:dX,externalForwardedProps:X,ownerState:H}),we=fX(me({},$,{src:y,srcSet:_}));return(y||_)&&we!=="error"?B=ie.jsx(J,me({},$)):w!=null?B=w:l?B=l[0]:B=ie.jsx(le,me({},Ce)),ie.jsx(ee,me({},se,{children:B}))}),mX=y4("MuiBox",["root"]),qw=p9({themeId:O_,defaultTheme:dy,defaultClassName:mX.root,generateClassName:m4.generate});function gX(t){return qr("MuiTypography",t)}$r("MuiTypography",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","noWrap","gutterBottom","startDecorator","endDecorator","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const vX=["color","textColor"],yX=["component","gutterBottom","noWrap","level","levelMapping","children","endDecorator","startDecorator","variant","slots","slotProps"],x_=G.createContext(!1),uF=G.createContext(!1),_X=t=>{const{gutterBottom:e,noWrap:n,level:r,color:i,variant:l}=t,c={root:["root",r,e&&"gutterBottom",n&&"noWrap",i&&`color${Rn(i)}`,l&&`variant${Rn(l)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Vr(c,gX,{})},xX=_n("span",{name:"JoyTypography",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),bX=_n("span",{name:"JoyTypography",slot:"endDecorator",overridesResolver:(t,e)=>e.endDecorator})({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Typography-gap, 0.375em), 0.75rem)"}),wX=_n("span",{name:"JoyTypography",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,i,l,c;const s=e.level!=="inherit"?(n=t.typography[e.level])==null?void 0:n.lineHeight:"1";return me({"--Icon-fontSize":`calc(1em * ${s})`},e.color&&{"--Icon-color":"currentColor"},{margin:"var(--Typography-margin, 0px)"},e.nesting?{display:"inline"}:me({display:"block"},e.unstable_hasSkeleton&&{position:"relative"}),(e.startDecorator||e.endDecorator)&&me({display:"flex",alignItems:"center"},e.nesting&&me({display:"inline-flex"},e.startDecorator&&{verticalAlign:"bottom"})),e.level&&e.level!=="inherit"&&t.typography[e.level],{fontSize:`var(--Typography-fontSize, ${e.level&&e.level!=="inherit"&&(r=(i=t.typography[e.level])==null?void 0:i.fontSize)!=null?r:"inherit"})`},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.color&&{color:`var(--variant-plainColor, rgba(${(l=t.vars.palette[e.color])==null?void 0:l.mainChannel} / 1))`},e.variant&&me({borderRadius:t.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!e.nesting&&{marginInline:"-0.25em"},(c=t.variants[e.variant])==null?void 0:c[e.color]))}),M3={h1:"h1",h2:"h2",h3:"h3",h4:"h4","title-lg":"p","title-md":"p","title-sm":"p","body-lg":"p","body-md":"p","body-sm":"p","body-xs":"span",inherit:"p"},Ti=G.forwardRef(function(e,n){var r;const i=Xr({props:e,name:"JoyTypography"}),{color:l,textColor:c}=i,s=rr(i,vX),p=G.useContext(x_),y=G.useContext(uF),_=Tw(me({},s,{color:c})),{component:w,gutterBottom:S=!1,noWrap:M=!1,level:I="body-md",levelMapping:D=M3,children:R,endDecorator:L,startDecorator:V,variant:B,slots:H={},slotProps:q={}}=_,X=rr(_,yX),ee=(r=e.color)!=null?r:B?l??"neutral":l,se=p||y?e.level||"inherit":I,J=Pw(R,["Skeleton"]),$=w||(p?"span":D[se]||M3[se]||"span"),le=me({},_,{level:se,component:$,color:ee,gutterBottom:S,noWrap:M,nesting:p,variant:B,unstable_hasSkeleton:J}),Ce=_X(le),we=me({},X,{component:$,slots:H,slotProps:q}),[We,Fe]=Bn("root",{ref:n,className:Ce.root,elementType:wX,externalForwardedProps:we,ownerState:le}),[Me,Ee]=Bn("startDecorator",{className:Ce.startDecorator,elementType:xX,externalForwardedProps:we,ownerState:le}),[Te,Ze]=Bn("endDecorator",{className:Ce.endDecorator,elementType:bX,externalForwardedProps:we,ownerState:le});return ie.jsx(x_.Provider,{value:!0,children:ie.jsxs(We,me({},Fe,{children:[V&&ie.jsx(Me,me({},Ee,{children:V})),J?G.cloneElement(R,{variant:R.props.variant||"inline"}):R,L&&ie.jsx(Te,me({},Ze,{children:L}))]}))})});Ti.muiName="Typography";function SX(t){return qr("MuiButton",t)}const C3=$r("MuiButton",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","focusVisible","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]),MX=["children","action","color","variant","size","fullWidth","startDecorator","endDecorator","loading","loadingPosition","loadingIndicator","disabled","component","slots","slotProps"],CX=t=>{const{color:e,disabled:n,focusVisible:r,focusVisibleClassName:i,fullWidth:l,size:c,variant:s,loading:p}=t,y={root:["root",n&&"disabled",r&&"focusVisible",l&&"fullWidth",s&&`variant${Rn(s)}`,e&&`color${Rn(e)}`,c&&`size${Rn(c)}`,p&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]},_=Vr(y,SX,{});return r&&i&&(_.root+=` ${i}`),_},EX=_n("span",{name:"JoyButton",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),TX=_n("span",{name:"JoyButton",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),PX=_n("span",{name:"JoyButton",slot:"LoadingCenter",overridesResolver:(t,e)=>e.loadingIndicatorCenter})(({theme:t,ownerState:e})=>{var n,r;return me({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),hF=({theme:t,ownerState:e})=>{var n,r,i,l;return[me({"--Icon-margin":"initial","--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon},e.size==="sm"&&{"--Icon-fontSize":t.vars.fontSize.lg,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.375rem",minHeight:"var(--Button-minHeight, 2rem)",fontSize:t.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.25rem)",paddingInline:"0.75rem"},e.size==="md"&&{"--Icon-fontSize":t.vars.fontSize.xl,"--CircularProgress-size":"20px","--CircularProgress-thickness":"2px","--Button-gap":"0.5rem",minHeight:"var(--Button-minHeight, 2.25rem)",fontSize:t.vars.fontSize.sm,paddingBlock:"var(--Button-paddingBlock, 0.375rem)",paddingInline:"1rem"},e.size==="lg"&&{"--Icon-fontSize":t.vars.fontSize.xl2,"--CircularProgress-size":"28px","--CircularProgress-thickness":"4px","--Button-gap":"0.75rem",minHeight:"var(--Button-minHeight, 2.75rem)",fontSize:t.vars.fontSize.md,paddingBlock:"var(--Button-paddingBlock, 0.5rem)",paddingInline:"1.5rem"},{WebkitTapHighlightColor:"transparent",boxSizing:"border-box",borderRadius:`var(--Button-radius, ${t.vars.radius.sm})`,margin:"var(--Button-margin)",border:"none",backgroundColor:"transparent",cursor:"pointer",userSelect:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",textDecoration:"none",fontFamily:t.vars.fontFamily.body,fontWeight:t.vars.fontWeight.lg,lineHeight:t.vars.lineHeight.md},e.fullWidth&&{width:"100%"},{[t.focus.selector]:t.focus.default}),me({},(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":{"@media (hover: hover)":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]},'&:active, &[aria-pressed="true"]':(i=t.variants[`${e.variant}Active`])==null?void 0:i[e.color],[`&.${C3.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]},e.loadingPosition==="center"&&{[`&.${C3.loading}`]:{color:"transparent"}})]},AX=_n("button",{name:"JoyButton",slot:"Root",overridesResolver:(t,e)=>e.root})(hF),dF=G.forwardRef(function(e,n){var r;const i=Xr({props:e,name:"JoyButton"}),{children:l,action:c,color:s="primary",variant:p="solid",size:y="md",fullWidth:_=!1,startDecorator:w,endDecorator:S,loading:M=!1,loadingPosition:I="center",loadingIndicator:D,disabled:R,component:L,slots:V={},slotProps:B={}}=i,H=rr(i,MX),q=G.useContext(rA),X=G.useContext(Q4),ee=e.variant||q.variant||p,se=e.size||q.size||y,J=e.color||q.color||s,$=(r=e.loading||e.disabled)!=null?r:q.disabled||M||R,le=G.useRef(null),Ce=mi(le,n),{focusVisible:we,setFocusVisible:We,getRootProps:Fe}=kh(me({},i,{disabled:$,rootRef:Ce})),Me=D??ie.jsx(iA,{color:J,thickness:{sm:2,md:3,lg:4}[se]||3});G.useImperativeHandle(c,()=>({focusVisible:()=>{var wt;We(!0),(wt=le.current)==null||wt.focus()}}),[We]);const Ee=me({},i,{color:J,fullWidth:_,variant:ee,size:se,focusVisible:we,loading:M,loadingPosition:I,disabled:$}),Te=CX(Ee),Ze=wt=>{var cn;let dn=i.onClick;if(typeof B.root=="function"?dn=B.root(Ee).onClick:B.root&&(dn=B.root.onClick),(cn=dn)==null||cn(wt),X){var tn;(tn=X.onClick)==null||tn.call(X,wt,i.value)}};let rt=i["aria-pressed"];typeof B.root=="function"?rt=B.root(Ee)["aria-pressed"]:B.root&&(rt=B.root["aria-pressed"]),X!=null&&X.value&&(Array.isArray(X.value)?rt=X.value.indexOf(i.value)!==-1:rt=X.value===i.value);const Re=me({},H,{component:L,slots:V,slotProps:B}),[Qe,Vt]=Bn("root",{ref:n,className:Te.root,elementType:AX,externalForwardedProps:Re,getSlotProps:Fe,ownerState:Ee,additionalProps:{onClick:Ze,"aria-pressed":rt}}),[je,ct]=Bn("startDecorator",{className:Te.startDecorator,elementType:EX,externalForwardedProps:Re,ownerState:Ee}),[Ct,ut]=Bn("endDecorator",{className:Te.endDecorator,elementType:TX,externalForwardedProps:Re,ownerState:Ee}),[lt,_t]=Bn("loadingIndicatorCenter",{className:Te.loadingIndicatorCenter,elementType:PX,externalForwardedProps:Re,ownerState:Ee});return ie.jsxs(Qe,me({},Vt,{children:[(w||M&&I==="start")&&ie.jsx(je,me({},ct,{children:M&&I==="start"?Me:w})),l,M&&I==="center"&&ie.jsx(lt,me({},_t,{children:Me})),(S||M&&I==="end")&&ie.jsx(Ct,me({},ut,{children:M&&I==="end"?Me:S}))]}))});dF.muiName="Button";function IX(t){return qr("MuiCard",t)}$r("MuiCard",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","horizontal","vertical"]);const RX=["className","color","component","invertedColors","size","variant","children","orientation","slots","slotProps"],LX=t=>{const{size:e,variant:n,color:r,orientation:i}=t,l={root:["root",i,n&&`variant${Rn(n)}`,r&&`color${Rn(r)}`,e&&`size${Rn(e)}`]};return Vr(l,IX,{})},kX=_n("div")(({theme:t,ownerState:e})=>{var n;const{p:r,padding:i,borderRadius:l}=Km({theme:t,ownerState:e},["p","padding","borderRadius"]);return[me({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,"--Card-childRadius":"max((var(--Card-radius) - var(--variant-borderWidth, 0px)) - var(--Card-padding), min(var(--Card-padding) / 2, (var(--Card-radius) - var(--variant-borderWidth, 0px)) / 2))","--AspectRatio-radius":"var(--Card-childRadius)","--unstable_actionMargin":"calc(-1 * var(--variant-borderWidth, 0px))","--unstable_actionRadius":"var(--Card-radius)","--CardCover-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--CardOverflow-offset":"calc(-1 * var(--Card-padding))","--CardOverflow-radius":"calc(var(--Card-radius) - var(--variant-borderWidth, 0px))","--Divider-inset":"calc(-1 * var(--Card-padding))"},e.size==="sm"&&{"--Card-radius":t.vars.radius.sm,"--Card-padding":"0.625rem",gap:"0.5rem"},e.size==="md"&&{"--Card-radius":t.vars.radius.md,"--Card-padding":"1rem",gap:"0.75rem 1rem"},e.size==="lg"&&{"--Card-radius":t.vars.radius.lg,"--Card-padding":"1.5rem",gap:"1rem 1.5rem"},{padding:"var(--Card-padding)",borderRadius:"var(--Card-radius)",backgroundColor:t.vars.palette.background.surface,position:"relative",display:"flex",flexDirection:e.orientation==="horizontal"?"row":"column"},t.typography[`body-${e.size}`],e.variant==="solid"&&e.color&&e.invertedColors&&Z_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Y_(e.color)(t),(n=t.variants[e.variant])==null?void 0:n[e.color]),r!==void 0&&{"--Card-padding":r},i!==void 0&&{"--Card-padding":i},l!==void 0&&{"--Card-radius":l}]}),DX=_n(kX,{name:"JoyCard",slot:"Root",overridesResolver:(t,e)=>e.root})({}),GE=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyCard"}),{className:i,color:l="neutral",component:c="div",invertedColors:s=!1,size:p="md",variant:y="outlined",children:_,orientation:w="vertical",slots:S={},slotProps:M={}}=r,I=rr(r,RX),D=me({},r,{color:l,component:c,orientation:w,size:p,variant:y,invertedColors:s}),R=LX(D),L=me({},I,{component:c,slots:S,slotProps:M}),[V,B]=Bn("root",{ref:n,className:co(R.root,i),elementType:DX,externalForwardedProps:L,ownerState:D});return ie.jsx(V,me({},B,{children:G.Children.map(_,(H,q)=>{if(!G.isValidElement(H))return H;const X={};if(Pw(H,["Divider"])){var ee,se;const J=H.props;X.inset=(ee=J?.inset)!=null?ee:"context";const $=w==="vertical"?"horizontal":"vertical";X.orientation=(se=J?.orientation)!=null?se:$}return q===0&&(X["data-first-child"]=""),q===G.Children.count(_)-1&&(X["data-last-child"]=""),G.cloneElement(H,X)})}))}),fF=$r("MuiCardOverflow",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);function zX(t){return qr("MuiDivider",t)}$r("MuiDivider",["root","horizontal","vertical","insetContext","insetNone"]);const pF=_n("div")(({ownerState:t})=>({display:"flex",flexDirection:t.orientation==="horizontal"?"row":"column",flex:9999,zIndex:1,columnGap:"var(--Card-padding)",rowGap:"max(2px, calc(0.1875 * var(--Card-padding)))",padding:"var(--unstable_padding)",[`.${fF.root} > &`]:{"--unstable_padding":"calc(var(--Card-padding) * 0.75) 0px"}}));_n(pF,{name:"JoyCardContent",slot:"Root",overridesResolver:(t,e)=>e.root})({});const OX=$r("MuiModalDialog",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","layoutCenter","layoutFullscreen"]);function FX(t){return qr("MuiCheckbox",t)}const Fm=$r("MuiCheckbox",["root","checkbox","action","input","label","checked","disabled","focusVisible","indeterminate","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantOutlined","variantSoft","variantSolid"]),NX=Jm(ie.jsx("path",{d:"M9 16.17 5.53 12.7a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L9 16.17z"}),"Check"),BX=Jm(ie.jsx("path",{d:"M19 13H5c-.55 0-1-.45-1-1s.45-1 1-1h14c.55 0 1 .45 1 1s-.45 1-1 1z"}),"HorizontalRule"),UX=["checked","uncheckedIcon","checkedIcon","label","defaultChecked","disabled","disableIcon","overlay","id","indeterminate","indeterminateIcon","name","onBlur","onChange","onFocus","onFocusVisible","readOnly","required","value","color","variant","size","component","slots","slotProps"],$X=t=>{const{checked:e,disabled:n,disableIcon:r,focusVisible:i,color:l,variant:c,size:s,indeterminate:p}=t,y={root:["root",e&&"checked",n&&"disabled",i&&"focusVisible",c&&`variant${Rn(c)}`,l&&`color${Rn(l)}`,s&&`size${Rn(s)}`],checkbox:["checkbox",e&&"checked",p&&"indeterminate",n&&"disabled"],action:["action",e&&"checked",r&&n&&"disabled",i&&"focusVisible"],input:["input"],label:["label"]};return Vr(y,FX,{})},VX=_n("span",{name:"JoyCheckbox",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,i;return me({"--Icon-fontSize":"var(--Checkbox-size)"},t.size==="sm"&&{"--Checkbox-size":"1rem","& ~ *":{"--FormHelperText-margin":"0 0 0 1.5rem"},fontSize:e.vars.fontSize.sm,gap:"var(--Checkbox-gap, 0.5rem)"},t.size==="md"&&{"--Checkbox-size":"1.25rem","& ~ *":{"--FormHelperText-margin":"0.25rem 0 0 1.875rem"},fontSize:e.vars.fontSize.md,gap:"var(--Checkbox-gap, 0.625rem)"},t.size==="lg"&&{"--Checkbox-size":"1.5rem","& ~ *":{"--FormHelperText-margin":"0.375rem 0 0 2.25rem"},fontSize:e.vars.fontSize.lg,gap:"var(--Checkbox-gap, 0.75rem)"},{position:t.overlay?"initial":"relative",display:"inline-flex",fontFamily:e.vars.fontFamily.body,lineHeight:"var(--Checkbox-size)",color:e.vars.palette.text.primary,[`&.${Fm.disabled}`]:{color:(n=e.variants.plainDisabled)==null||(n=n[t.color])==null?void 0:n.color}},t.disableIcon&&{color:(r=e.variants[t.variant])==null||(r=r[t.color])==null?void 0:r.color,[`&.${Fm.disabled}`]:{color:(i=e.variants[`${t.variant}Disabled`])==null||(i=i[t.color])==null?void 0:i.color}})}),jX=_n("span",{name:"JoyCheckbox",slot:"Checkbox",overridesResolver:(t,e)=>e.checkbox})(({theme:t,ownerState:e})=>{var n,r,i,l,c;const s=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color];return[me({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,boxSizing:"border-box",borderRadius:`min(${t.vars.radius.sm}, 0.25rem)`,width:"var(--Checkbox-size)",height:"var(--Checkbox-size)",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},e.disableIcon&&{display:"contents"},{[`&.${Fm.checked}, &.${Fm.indeterminate}`]:{"--Icon-color":"currentColor"}}),...e.disableIcon?[]:[me({},s,{backgroundColor:(r=s?.backgroundColor)!=null?r:t.vars.palette.background.surface}),{"&:hover":{"@media (hover: hover)":(i=t.variants[`${e.variant}Hover`])==null?void 0:i[e.color]}},{"&:active":(l=t.variants[`${e.variant}Active`])==null?void 0:l[e.color]},{[`&.${Fm.disabled}`]:(c=t.variants[`${e.variant}Disabled`])==null?void 0:c[e.color]}]]}),HX=_n("span",{name:"JoyCheckbox",slot:"Action",overridesResolver:(t,e)=>e.action})(({theme:t,ownerState:e})=>{var n,r,i,l;return[{borderRadius:`var(--Checkbox-actionRadius, ${e.overlay?"var(--unstable_actionRadius, inherit)":"inherit"})`,textAlign:"left",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",zIndex:1,[t.focus.selector]:t.focus.default},...e.disableIcon?[(n=t.variants[e.variant])==null?void 0:n[e.color],{"&:hover":(r=t.variants[`${e.variant}Hover`])==null?void 0:r[e.color]},{"&:active":(i=t.variants[`${e.variant}Active`])==null?void 0:i[e.color]},{[`&.${Fm.disabled}`]:(l=t.variants[`${e.variant}Disabled`])==null?void 0:l[e.color]}]:[]]}),GX=_n("input",{name:"JoyCheckbox",slot:"Input",overridesResolver:(t,e)=>e.input})(()=>({margin:0,opacity:0,position:"absolute",width:"100%",height:"100%",cursor:"pointer"})),WX=_n("label",{name:"JoyCheckbox",slot:"Label",overridesResolver:(t,e)=>e.label})(({ownerState:t})=>me({flex:1,minWidth:0},t.disableIcon&&{zIndex:1,pointerEvents:"none"})),qX=ie.jsx(NX,{}),XX=ie.jsx(BX,{}),$m=G.forwardRef(function(e,n){var r,i,l,c,s;const p=Xr({props:e,name:"JoyCheckbox"}),{checked:y,uncheckedIcon:_,checkedIcon:w=qX,label:S,defaultChecked:M,disabled:I,disableIcon:D=!1,overlay:R,id:L,indeterminate:V=!1,indeterminateIcon:B=XX,name:H,onBlur:q,onChange:X,onFocus:ee,onFocusVisible:se,readOnly:J,required:$,value:le,color:Ce,variant:we,size:We="md",component:Fe,slots:Me={},slotProps:Ee={}}=p,Te=rr(p,UX),Ze=G.useContext(Ww),rt=(r=(i=e.disabled)!=null?i:Ze?.disabled)!=null?r:I,Re=(l=(c=e.size)!=null?c:Ze?.size)!=null?l:We,Qe=il(L??Ze?.htmlFor),Vt={checked:y,defaultChecked:M,disabled:rt,onBlur:q,onChange:X,onFocus:ee,onFocusVisible:se},{getInputProps:je,checked:ct,disabled:Ct,focusVisible:ut}=oW(Vt),lt=ct||V,cn=lt?we||"solid":we||"outlined",dn=e.color||(Ze!=null&&Ze.error?"danger":(s=Ze?.color)!=null?s:Ce),Tn=me({},p,{checked:ct,disabled:Ct,disableIcon:D,overlay:R,focusVisible:ut,color:lt?dn||"primary":dn||"neutral",variant:cn,size:Re}),Kt=$X(Tn),fn=me({},Te,{component:Fe,slots:Me,slotProps:Ee}),[Ut,On]=Bn("root",{ref:n,className:Kt.root,elementType:VX,externalForwardedProps:fn,ownerState:Tn}),[vn,Ue]=Bn("checkbox",{className:Kt.checkbox,elementType:jX,externalForwardedProps:fn,ownerState:Tn}),[Se,yt]=Bn("action",{className:Kt.action,elementType:HX,externalForwardedProps:fn,ownerState:Tn}),[Nt,Ht]=Bn("input",{additionalProps:me({id:Qe,name:H,value:le,readOnly:J,role:void 0,required:$??Ze?.required,"aria-describedby":Ze?.["aria-describedby"]},V&&{"aria-checked":"mixed"}),className:Kt.input,elementType:GX,externalForwardedProps:fn,getSlotProps:je,ownerState:Tn}),[Ot,un]=Bn("label",{additionalProps:{htmlFor:Qe},className:Kt.label,elementType:WX,externalForwardedProps:fn,ownerState:Tn});let Gt=_;return D?Gt=null:V?Gt=B:ct&&(Gt=w),ie.jsxs(Ut,me({},On,{children:[ie.jsxs(vn,me({},Ue,{children:[ie.jsx(Se,me({},yt,{children:ie.jsx(Nt,me({},Ht))})),Gt]})),S&&ie.jsx(x_.Provider,{value:!0,children:ie.jsx(Ot,me({},un,{children:S}))})]}))});function ZX(t){const{children:e,disableColorScheme:n=!1}=t;return ie.jsxs(G.Fragment,{children:[ie.jsx(C7,{styles:r=>{var i,l;const c={};n||Object.entries(r.colorSchemes).forEach(([p,y])=>{var _;c[r.getColorSchemeSelector(p).replace(/\s*&/,"")]={colorScheme:(_=y.palette)==null?void 0:_.mode}});const s=(i=(l=r.components)==null||(l=l.JoyTypography)==null||(l=l.defaultProps)==null?void 0:l.level)!=null?i:"body-md";return me({html:{WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:r.vars.fontWeight.lg},body:me({margin:0,color:r.vars.palette.text.primary,fontFamily:r.vars.fontFamily.body},r.typography[s],{backgroundColor:r.vars.palette.background.body,"@media print":{backgroundColor:r.vars.palette.common.white},"&::backdrop":{backgroundColor:r.vars.palette.background.backdrop}})},c)},defaultTheme:dy}),e]})}function YX(t){return qr("MuiDialogContent",t)}$r("MuiDialogContent",["root"]);const Xw=G.createContext(void 0);function KX(t){return qr("MuiDialogTitle",t)}const mF=$r("MuiDialogTitle",["root","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),JX=["component","children","orientation","slots","slotProps"],QX=()=>Vr({root:["root"]},YX,{}),eZ=_n(pF,{name:"JoyDialogContent",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t})=>({color:`var(--DialogContent-color, ${t.vars.palette.text.tertiary})`,overflow:"auto",margin:"var(--unstable_DialogContent-margin)",[`.${OX.root} > .${mF.root} + &`]:{"--unstable_DialogContent-margin":"-0.375em 0 0 0"}})),gF=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyDialogContent"}),i=G.useContext(Xw),{component:l="div",children:c,orientation:s="vertical",slots:p={},slotProps:y={}}=r,_=rr(r,JX),w=me({},_,{component:l,slots:p,slotProps:y}),S=me({},r,{component:l,orientation:s}),M=QX(),[I,D]=Bn("root",{ref:n,className:M.root,elementType:eZ,externalForwardedProps:w,ownerState:S,additionalProps:{id:i?.describedBy}});return ie.jsx(I,me({},D,{children:c}))}),oA=G.createContext(void 0),tZ=["component","children","variant","color","level","slots","slotProps"],nZ=t=>{const{level:e,color:n,variant:r}=t,i={root:["root",e,n&&`color${Rn(n)}`,r&&`variant${Rn(r)}`]};return Vr(i,KX,{})},rZ=_n("h2",{name:"JoyDialogTitle",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const i=e.level!=="inherit"?(n=t.typography[e.level])==null?void 0:n.lineHeight:"1";return me({"--Icon-fontSize":`calc(1em * ${i})`},e.color&&{"--Icon-color":"currentColor"},{display:"flex",gap:"clamp(4px, 0.375em, 0.75rem)",margin:"var(--unstable_DialogTitle-margin, 0px)"},e.level&&e.level!=="inherit"&&t.typography[e.level],{color:"inherit"},e.variant&&me({borderRadius:t.vars.radius.xs,paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},(r=t.variants[e.variant])==null?void 0:r[e.color]),{[`.${fF.root} > &`]:{"--unstable_DialogTitle-margin":"var(--Card-padding) 0"}})}),iZ={sm:"title-md",md:"title-lg",lg:"h4"},vF=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyDialogTitle"}),i=G.useContext(oA),l=G.useContext(Xw),{component:c="h2",children:s,variant:p,color:y,level:_=iZ[i||"md"],slots:w={},slotProps:S={}}=r,M=rr(r,tZ),I=e.color||(p?y??"neutral":y),D=me({},M,{component:c,slots:w,slotProps:S}),R=me({},r,{component:c,color:I,variant:p,level:_}),L=nZ(R),[V,B]=Bn("root",{ref:n,className:L.root,elementType:rZ,externalForwardedProps:D,ownerState:R,additionalProps:{id:l?.labelledBy}});return ie.jsx(V,me({},B,{children:s}))}),oZ=["className","children","component","inset","orientation","role","slots","slotProps"],sZ=t=>{const{orientation:e,inset:n}=t,r={root:["root",e,n&&`inset${Rn(n)}`]};return Vr(r,zX,{})},yF=_n("hr",{name:"JoyDivider",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>me({"--Divider-thickness":"1px","--Divider-lineColor":t.vars.palette.divider},e.inset==="none"&&{"--_Divider-inset":"0px"},e.inset==="context"&&{"--_Divider-inset":"var(--Divider-inset, 0px)"},{margin:"initial",marginInline:e.orientation==="vertical"?"initial":"var(--_Divider-inset)",marginBlock:e.orientation==="vertical"?"var(--_Divider-inset)":"initial",position:"relative",alignSelf:"stretch",flexShrink:0},e.children?me({"--Divider-gap":t.spacing(1),"--Divider-childPosition":"50%",display:"flex",flexDirection:e.orientation==="vertical"?"column":"row",alignItems:"center",whiteSpace:"nowrap",textAlign:"center",border:0},t.typography["body-sm"],{"&::before, &::after":{position:"relative",inlineSize:e.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:e.orientation==="vertical"?"initial":"var(--Divider-thickness)",backgroundColor:"var(--Divider-lineColor)",content:'""'},"&::before":{marginInlineEnd:e.orientation==="vertical"?"initial":"min(var(--Divider-childPosition) * 999, var(--Divider-gap))",marginBlockEnd:e.orientation==="vertical"?"min(var(--Divider-childPosition) * 999, var(--Divider-gap))":"initial",flexBasis:"var(--Divider-childPosition)"},"&::after":{marginInlineStart:e.orientation==="vertical"?"initial":"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))",marginBlockStart:e.orientation==="vertical"?"min((100% - var(--Divider-childPosition)) * 999, var(--Divider-gap))":"initial",flexBasis:"calc(100% - var(--Divider-childPosition))"}}):{border:"none",listStyle:"none",backgroundColor:"var(--Divider-lineColor)",inlineSize:e.orientation==="vertical"?"var(--Divider-thickness)":"initial",blockSize:e.orientation==="vertical"?"initial":"var(--Divider-thickness)"})),J_=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyDivider"}),{className:i,children:l,component:c=l!=null?"div":"hr",inset:s,orientation:p="horizontal",role:y=c!=="hr"?"separator":void 0,slots:_={},slotProps:w={}}=r,S=rr(r,oZ),M=me({},r,{inset:s,role:y,orientation:p,component:c}),I=sZ(M),D=me({},S,{component:c,slots:_,slotProps:w}),[R,L]=Bn("root",{ref:n,className:co(I.root,i),elementType:yF,externalForwardedProps:D,ownerState:M,additionalProps:me({as:c,role:y},y==="separator"&&p==="vertical"&&{"aria-orientation":"vertical"})});return ie.jsx(R,me({},L,{children:l}))});J_.muiName="Divider";const _F=G.createContext(void 0),xF=_n("div")(({ownerState:t,theme:e})=>me({"--unstable_popup-zIndex":`calc(${e.vars.zIndex.modal} + 1)`,'& ~ [role="listbox"]':{"--unstable_popup-zIndex":`calc(${e.vars.zIndex.modal} + 1)`},position:"fixed",zIndex:e.vars.zIndex.modal,right:0,bottom:0,top:0,left:0},!t.open&&{visibility:"hidden"}));_n(xF,{name:"JoyModal",slot:"Root",overridesResolver:(t,e)=>e.root})({});const bF=_n("div")(({theme:t})=>({zIndex:-1,position:"fixed",right:0,bottom:0,top:0,left:0,backgroundColor:t.vars.palette.background.backdrop,WebkitTapHighlightColor:"transparent",backdropFilter:"blur(8px)"}));_n(bF,{name:"JoyModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({});function aZ(t){return qr("MuiDrawer",t)}$r("MuiDrawer",["root","hidden","backdrop","content","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const lZ=["children","anchor","container","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","color","variant","invertedColors","size","onClose","onKeyDown","open","component","slots","slotProps"],cZ=t=>{const{open:e,variant:n,color:r,size:i}=t,l={root:["root",!e&&"hidden",n&&`variant${Rn(n)}`,r&&`color${Rn(r)}`,i&&`size${Rn(i)}`],backdrop:["backdrop"],content:["content"]};return Vr(l,aZ,{})},uZ=_n(xF,{name:"JoyDrawer",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>me({"--Drawer-transitionDuration":"0.3s","--Drawer-transitionFunction":"ease","--ModalClose-radius":"max((var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) - var(--ModalClose-inset), min(var(--ModalClose-inset) / 2, (var(--Drawer-contentRadius) - var(--variant-borderWidth, 0px)) / 2))"},t.size==="sm"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(350px, 30%, 100%)","--Drawer-horizontalSize":"clamp(256px, 20%, 100%)","--Drawer-titleMargin":"0.625rem 0.75rem calc(0.625rem / 2)"},t.size==="md"&&{"--ModalClose-inset":"0.5rem","--Drawer-verticalSize":"clamp(400px, 45%, 100%)","--Drawer-horizontalSize":"clamp(300px, 30%, 100%)","--Drawer-titleMargin":"0.75rem 0.75rem calc(0.75rem / 2)"},t.size==="lg"&&{"--ModalClose-inset":"0.75rem","--Drawer-verticalSize":"clamp(500px, 60%, 100%)","--Drawer-horizontalSize":"clamp(440px, 60%, 100%)","--Drawer-titleMargin":"1rem 1rem calc(1rem / 2)"},{transitionProperty:"visibility",transitionDelay:t.open?"0s":"var(--Drawer-transitionDuration)"},!t.open&&{visibility:"hidden"})),hZ=_n(bF,{name:"JoyDrawer",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})(({ownerState:t})=>({opacity:t.open?1:0,transition:"opacity var(--Drawer-transitionDuration) ease-in-out"})),dZ=_n("div",{name:"JoyDrawer",slot:"Content",overridesResolver:(t,e)=>e.content})(({theme:t,ownerState:e})=>{var n;return me({},t.typography[`body-${e.size}`],{boxShadow:t.shadow.md,backgroundColor:t.vars.palette.background.surface,outline:0,display:"flex",flexDirection:"column",position:"fixed",boxSizing:"border-box",overflow:"auto"},e.anchor==="left"&&{top:0,left:0,transform:e.open?"translateX(0)":"translateX(-100%)"},e.anchor==="right"&&{top:0,right:0,transform:e.open?"translateX(0)":"translateX(100%)"},e.anchor==="top"&&{top:0,transform:e.open?"translateY(0)":"translateY(-100%)"},e.anchor==="bottom"&&{bottom:0,transform:e.open?"translateY(0)":"translateY(100%)"},{height:e.anchor.match(/(left|right)/)?"100%":"min(100vh, var(--Drawer-verticalSize))",width:e.anchor.match(/(top|bottom)/)?"100vw":"min(100vw, var(--Drawer-horizontalSize))",transition:"transform var(--Drawer-transitionDuration) var(--Drawer-transitionFunction)"},e.variant==="solid"&&e.color&&e.invertedColors&&Z_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Y_(e.color)(t),(n=t.variants[e.variant])==null?void 0:n[e.color],{[`& > .${mF.root}`]:{"--unstable_DialogTitle-margin":"var(--Drawer-titleMargin)"}})}),wF=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyDrawer"}),{children:i,anchor:l="left",container:c,disableAutoFocus:s=!1,disableEnforceFocus:p=!1,disableEscapeKeyDown:y=!1,disablePortal:_=!1,disableRestoreFocus:w=!1,disableScrollLock:S=!1,hideBackdrop:M=!1,color:I="neutral",variant:D="plain",invertedColors:R=!1,size:L="md",onClose:V,open:B,component:H,slots:q={},slotProps:X={}}=r,ee=rr(r,lZ),se=me({},r,{anchor:l,disableAutoFocus:s,disableEnforceFocus:p,disableEscapeKeyDown:y,disablePortal:_,disableRestoreFocus:w,disableScrollLock:S,hideBackdrop:M,invertedColors:R,color:I,variant:D,size:L}),{getRootProps:J,getBackdropProps:$,rootRef:le,portalRef:Ce,isTopModal:we}=zH(me({},se,{rootRef:n,children:null})),We=cZ(se),Fe=me({},ee,{component:H,slots:q,slotProps:X}),Me=il(),Ee=il(),Te=G.useMemo(()=>({variant:D,color:I,labelledBy:Me,describedBy:Ee}),[I,D,Me,Ee]),[Ze,rt]=Bn("root",{ref:le,className:We.root,elementType:uZ,externalForwardedProps:Fe,getSlotProps:J,ownerState:se}),[Re,Qe]=Bn("backdrop",{className:We.backdrop,elementType:hZ,externalForwardedProps:Fe,getSlotProps:$,ownerState:se}),[Vt,je]=Bn("content",{className:We.content,elementType:dZ,additionalProps:{tabIndex:-1,role:"dialog","aria-modal":"true","aria-labelledby":Me,"aria-describedby":Ee},externalForwardedProps:Fe,ownerState:se});return ie.jsx(_F.Provider,{value:V,children:ie.jsx(oA.Provider,{value:L,children:ie.jsx(Xw.Provider,{value:Te,children:ie.jsx(D4,{ref:Ce,container:c,disablePortal:_,children:ie.jsxs(Ze,me({},rt,{children:[M?null:ie.jsx(Re,me({},Qe)),ie.jsx(W7,{disableEnforceFocus:p,disableAutoFocus:s,disableRestoreFocus:w,isEnabled:we,open:B,children:ie.jsx(Vt,me({},je,{children:i}))})]}))})})})})});function fZ(t){return qr("MuiLink",t)}const E3=$r("MuiLink",["root","disabled","focusVisible","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","variantPlain","variantOutlined","variantSoft","variantSolid","underlineNone","underlineHover","underlineAlways","h1","h2","h3","h4","title-lg","title-md","title-sm","body-lg","body-md","body-sm","body-xs","startDecorator","endDecorator"]),pZ=["color","textColor","variant"],mZ=["children","disabled","onBlur","onFocus","level","overlay","underline","endDecorator","startDecorator","component","slots","slotProps"],gZ=t=>{const{level:e,color:n,variant:r,underline:i,focusVisible:l,disabled:c}=t,s={root:["root",n&&`color${Rn(n)}`,c&&"disabled",l&&"focusVisible",e,i&&`underline${Rn(i)}`,r&&`variant${Rn(r)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Vr(s,fZ,{})},vZ=_n("span",{name:"JoyLink",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})(({ownerState:t})=>{var e;return me({display:"inline-flex",marginInlineEnd:"clamp(4px, var(--Link-gap, 0.375em), 0.75rem)"},typeof t.startDecorator!="string"&&(t.alignItems==="flex-start"||((e=t.sx)==null?void 0:e.alignItems)==="flex-start")&&{marginTop:"2px"})}),yZ=_n("span",{name:"JoyLink",slot:"endDecorator",overridesResolver:(t,e)=>e.endDecorator})(({ownerState:t})=>{var e;return me({display:"inline-flex",marginInlineStart:"clamp(4px, var(--Link-gap, 0.25em), 0.5rem)"},typeof t.startDecorator!="string"&&(t.alignItems==="flex-start"||((e=t.sx)==null?void 0:e.alignItems)==="flex-start")&&{marginTop:"2px"})}),_Z=_n("a",{name:"JoyLink",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,i,l,c,s,p;return[me({"--Icon-fontSize":"1.25em","--Icon-color":"currentColor","--CircularProgress-size":"1.25em","--CircularProgress-thickness":"3px"},e.level&&e.level!=="inherit"&&t.typography[e.level],e.level==="inherit"&&{font:"inherit"},e.underline==="none"&&{textDecoration:"none"},e.underline==="hover"&&{textDecoration:"none","&:hover":{"@media (hover: hover)":{textDecorationLine:"underline"}}},e.underline==="always"&&{textDecoration:"underline"},e.startDecorator&&{verticalAlign:"bottom"},{textDecorationThickness:"max(0.08em, 1px)",textUnderlineOffset:"0.15em",display:"inline-flex",alignItems:"center",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:t.vars.radius.xs,padding:0,cursor:"pointer",textDecorationColor:`var(--variant-outlinedBorder, rgba(${(n=t.vars.palette[e.color])==null?void 0:n.mainChannel} / var(--Link-underlineOpacity, 0.72)))`},e.variant?me({paddingBlock:"min(0.1em, 4px)",paddingInline:"0.25em"},!e.nesting&&{marginInline:"-0.25em"}):{color:`var(--variant-plainColor, rgba(${(r=t.vars.palette[e.color])==null?void 0:r.mainChannel} / 1))`,[`&.${E3.disabled}`]:{pointerEvents:"none",color:`var(--variant-plainDisabledColor, rgba(${(i=t.vars.palette[e.color])==null?void 0:i.mainChannel} / 0.6))`}},{userSelect:e.component==="button"?"none":void 0,MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"}},e.overlay?{position:"initial","&::after":{content:'""',display:"block",position:"absolute",top:0,left:0,bottom:0,right:0,borderRadius:"var(--unstable_actionRadius, inherit)",margin:"var(--unstable_actionMargin)"},[`${t.focus.selector}`]:{"&::after":t.focus.default}}:{position:"relative",[t.focus.selector]:t.focus.default}),e.variant&&me({},(l=t.variants[e.variant])==null?void 0:l[e.color],{"&:hover":{"@media (hover: hover)":(c=t.variants[`${e.variant}Hover`])==null?void 0:c[e.color]},"&:active":(s=t.variants[`${e.variant}Active`])==null?void 0:s[e.color],[`&.${E3.disabled}`]:(p=t.variants[`${e.variant}Disabled`])==null?void 0:p[e.color]})]}),SF=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyLink"}),{color:i="primary",textColor:l,variant:c}=r,s=rr(r,pZ),p=G.useContext(x_),y=G.useContext(uF),_=Tw(me({},s,{color:l})),{children:w,disabled:S=!1,onBlur:M,onFocus:I,level:D="body-md",overlay:R=!1,underline:L="hover",endDecorator:V,startDecorator:B,component:H,slots:q={},slotProps:X={}}=_,ee=rr(_,mZ),se=p||y?e.level||"inherit":D,{isFocusVisibleRef:J,onBlur:$,onFocus:le,ref:Ce}=Iw(),[we,We]=G.useState(!1),Fe=mi(n,Ce),Me=ut=>{$(ut),J.current===!1&&We(!1),M&&M(ut)},Ee=ut=>{le(ut),J.current===!0&&We(!0),I&&I(ut)},Te=me({},_,{color:i,disabled:S,focusVisible:we,underline:L,variant:c,level:se,overlay:R,nesting:p}),Ze=gZ(Te),rt=me({},ee,{component:H,slots:q,slotProps:X}),[Re,Qe]=Bn("root",{additionalProps:{onBlur:Me,onFocus:Ee},ref:Fe,className:Ze.root,elementType:_Z,externalForwardedProps:rt,ownerState:Te}),[Vt,je]=Bn("startDecorator",{className:Ze.startDecorator,elementType:vZ,externalForwardedProps:rt,ownerState:Te}),[ct,Ct]=Bn("endDecorator",{className:Ze.endDecorator,elementType:yZ,externalForwardedProps:rt,ownerState:Te});return ie.jsx(x_.Provider,{value:!0,children:ie.jsxs(Re,me({},Qe,{children:[B&&ie.jsx(Vt,me({},je,{children:B})),Pw(w,["Skeleton"])?G.cloneElement(w,{variant:w.props.variant||"inline"}):w,V&&ie.jsx(ct,me({},Ct,{children:V}))]}))})});function xZ(t){return qr("MuiListDivider",t)}$r("MuiListDivider",["root","insetGutter","insetStartDecorator","insetStartContent","horizontal","vertical"]);const bZ=["component","role","className","children","inset","orientation","slots","slotProps"],wZ=t=>{const{orientation:e,inset:n}=t,r={root:["root",e,n&&n!=="context"&&`inset${Rn(n)}`]};return Vr(r,xZ,{})},SZ=_n(yF,{name:"JoyListDivider",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>me({},t.inset==="context"&&{"--Divider-inset":"calc(-1 * var(--List-padding))"},t.row&&me({marginInline:"var(--ListDivider-gap)"},t.inset==="gutter"&&{marginBlock:"var(--ListItem-paddingY)"},t["data-first-child"]===void 0&&{marginInlineStart:"calc(var(--List-gap) + var(--ListDivider-gap))"}),!t.row&&me({},t["data-first-child"]===void 0&&{marginBlockStart:"calc(var(--List-gap) + var(--ListDivider-gap))"},{marginBlockEnd:"var(--ListDivider-gap)"},t.inset==="gutter"&&{marginInlineStart:"var(--ListItem-paddingLeft)",marginInlineEnd:"var(--ListItem-paddingRight)"},t.inset==="startDecorator"&&{marginInlineStart:"var(--ListItem-paddingLeft)"},t.inset==="startContent"&&{marginInlineStart:"calc(var(--ListItem-paddingLeft) + var(--ListItemDecorator-size))"}))),WE=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListDivider"}),i=G.useContext(fy),l=G.useContext(eA),{component:c,role:s,className:p,children:y,inset:_="context",orientation:w,slots:S={},slotProps:M={}}=r,I=rr(r,bZ),[D]=l?.split(":")||["",""],R=c||(D&&!D.match(/^(ul|ol|menu)$/)?"div":"li"),L=s||(R==="li"?"separator":void 0),V=w||(i?"vertical":"horizontal"),B=me({},r,{inset:_,row:i,orientation:V,component:R,role:L}),H=wZ(B),q=me({},I,{component:R,slots:S,slotProps:M}),[X,ee]=Bn("root",{ref:n,className:co(H.root,p),elementType:SZ,externalForwardedProps:q,ownerState:B,additionalProps:me({as:R,role:L},L==="separator"&&V==="vertical"&&{"aria-orientation":"vertical"})});return ie.jsx(X,me({},ee,{children:y}))});function MZ(t){return qr("MuiListItemContent",t)}$r("MuiListItemContent",["root"]);const CZ=["component","className","children","slots","slotProps"],EZ=()=>Vr({root:["root"]},MZ,{}),TZ=_n("div",{name:"JoyListItemContent",slot:"Root",overridesResolver:(t,e)=>e.root})({flex:"1 1 auto",minWidth:0}),b_=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListItemContent"}),{component:i,className:l,children:c,slots:s={},slotProps:p={}}=r,y=rr(r,CZ),_=me({},r),w=EZ(),S=me({},y,{component:i,slots:s,slotProps:p}),[M,I]=Bn("root",{ref:n,className:co(w.root,l),elementType:TZ,externalForwardedProps:S,ownerState:_});return ie.jsx(M,me({},I,{children:c}))});function PZ(t){return qr("MuiListItemDecorator",t)}$r("MuiListItemDecorator",["root"]);const AZ=["component","className","children","slots","slotProps"],IZ=()=>Vr({root:["root"]},PZ,{}),RZ=_n("span",{name:"JoyListItemDecorator",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>me({boxSizing:"border-box",display:"inline-flex",alignItems:`var(--unstable_ListItemDecorator-alignItems, ${t.parentOrientation==="horizontal"?"center":"initial"})`},t.parentOrientation==="horizontal"?{minInlineSize:"var(--ListItemDecorator-size)",marginInlineEnd:"calc(-1 * var(--ListItem-gap))"}:{minBlockSize:"var(--ListItemDecorator-size)",justifyContent:"center",marginBlockEnd:"calc(-1 * var(--ListItem-gap))"})),Nv=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyListItemDecorator"}),{component:i,className:l,children:c,slots:s={},slotProps:p={}}=r,y=rr(r,AZ),_=G.useContext(tA),w=me({parentOrientation:_},r),S=IZ(),M=me({},y,{component:i,slots:s,slotProps:p}),[I,D]=Bn("root",{ref:n,className:co(S.root,l),elementType:RZ,externalForwardedProps:M,ownerState:w});return ie.jsx(I,me({},D,{children:c}))});function LZ(t){return qr("MuiMenu",t)}$r("MuiMenu",["root","listbox","expanded","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const kZ=["actions","children","color","component","disablePortal","keepMounted","id","invertedColors","onItemsChange","modifiers","variant","size","slots","slotProps"],DZ=t=>{const{open:e,variant:n,color:r,size:i}=t,l={root:["root",e&&"expanded",n&&`variant${Rn(n)}`,r&&`color${Rn(r)}`,i&&`size${Rn(i)}`],listbox:["listbox"]};return Vr(l,LZ,{})},T3=_n(q_,{name:"JoyMenu",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const i=(n=t.variants[e.variant])==null?void 0:n[e.color];return[me({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":i?.backgroundColor||i?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},Vw,{borderRadius:`var(--List-radius, ${t.vars.radius.sm})`,boxShadow:t.shadow.md,overflow:"auto",zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`},!(i!=null&&i.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup},e.variant==="solid"&&e.color&&e.invertedColors&&Z_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Y_(e.color)(t),(r=t.variants[e.variant])==null?void 0:r[e.color])]}),MF=G.forwardRef(function(e,n){var r;const i=Xr({props:e,name:"JoyMenu"}),{actions:l,children:c,color:s="neutral",component:p,disablePortal:y=!1,keepMounted:_=!1,id:w,invertedColors:S=!1,onItemsChange:M,modifiers:I,variant:D="outlined",size:R="md",slots:L={},slotProps:V={}}=i,B=rr(i,kZ),{contextValue:H,getListboxProps:q,dispatch:X,open:ee,triggerElement:se}=gH({onItemsChange:M,id:w,listboxRef:n});G.useImperativeHandle(l,()=>({dispatch:X,resetHighlight:()=>X({type:ki.resetHighlight,event:null})}),[X]);const J=me({},i,{disablePortal:y,invertedColors:S,color:s,variant:D,size:R,open:ee,nesting:!1,row:!1}),$=DZ(J),le=me({},B,{component:p,slots:L,slotProps:V}),Ce=G.useMemo(()=>[{name:"offset",options:{offset:[0,4]}},...I||[]],[I]),we=E4({elementType:T3,getSlotProps:q,externalForwardedProps:le,externalSlotProps:{},ownerState:J,additionalProps:{anchorEl:se,open:ee&&se!==null,disablePortal:y,keepMounted:_,modifiers:Ce},className:$.root});return ie.jsx(T3,me({},we,!((r=i.slots)!=null&&r.root)&&{as:Bw,slots:{root:p||"ul"}},{children:ie.jsx(vH,{value:H,children:ie.jsx(Gw,{variant:S?void 0:D,color:s,children:ie.jsx($w.Provider,{value:"menu",children:ie.jsx(W_,{nested:!0,children:c})})})})}))});function zZ(t){return qr("MuiMenuButton",t)}$r("MuiMenuButton",["root","colorPrimary","colorNeutral","colorDanger","colorInfo","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","disabled","sizeSm","sizeMd","sizeLg","fullWidth","startDecorator","endDecorator","loading","loadingIndicatorCenter"]);const OZ=["children","color","component","disabled","endDecorator","loading","loadingPosition","loadingIndicator","size","slotProps","slots","startDecorator","variant"],FZ=t=>{const{color:e,disabled:n,fullWidth:r,size:i,variant:l,loading:c}=t,s={root:["root",n&&"disabled",r&&"fullWidth",l&&`variant${Rn(l)}`,e&&`color${Rn(e)}`,i&&`size${Rn(i)}`,c&&"loading"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],loadingIndicatorCenter:["loadingIndicatorCenter"]};return Vr(s,zZ,{})},NZ=_n("button",{name:"JoyMenuButton",slot:"Root",overridesResolver:(t,e)=>e.root})(hF),BZ=_n("span",{name:"JoyMenuButton",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Icon-margin":"0 0 0 calc(var(--Button-gap) / -2)","--CircularProgress-margin":"0 0 0 calc(var(--Button-gap) / -2)",display:"inherit",marginRight:"var(--Button-gap)"}),UZ=_n("span",{name:"JoyMenuButton",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Icon-margin":"0 calc(var(--Button-gap) / -2) 0 0","--CircularProgress-margin":"0 calc(var(--Button-gap) / -2) 0 0",display:"inherit",marginLeft:"var(--Button-gap)"}),$Z=_n("span",{name:"JoyMenuButton",slot:"LoadingCenter",overridesResolver:(t,e)=>e.loadingIndicatorCenter})(({theme:t,ownerState:e})=>{var n,r;return me({display:"inherit",position:"absolute",left:"50%",transform:"translateX(-50%)",color:(n=t.variants[e.variant])==null||(n=n[e.color])==null?void 0:n.color},e.disabled&&{color:(r=t.variants[`${e.variant}Disabled`])==null||(r=r[e.color])==null?void 0:r.color})}),VZ=G.forwardRef(function(e,n){var r;const i=Xr({props:e,name:"JoyMenuButton"}),{children:l,color:c="neutral",component:s,disabled:p=!1,endDecorator:y,loading:_=!1,loadingPosition:w="center",loadingIndicator:S,size:M="md",slotProps:I={},slots:D={},startDecorator:R,variant:L="outlined"}=i,V=rr(i,OZ),B=G.useContext(rA),H=e.variant||B.variant||L,q=e.size||B.size||M,X=(r=e.disabled)!=null?r:B.disabled||p||_,{getRootProps:ee,open:se,active:J}=wH({rootRef:n,disabled:X}),$=S??ie.jsx(iA,{color:c,thickness:{sm:2,md:3,lg:4}[q]||3}),le=me({},i,{active:J,color:c,disabled:X,open:se,size:q,variant:H}),Ce=FZ(le),we=me({},V,{component:s,slots:D,slotProps:I}),[We,Fe]=Bn("root",{elementType:NZ,getSlotProps:ee,externalForwardedProps:we,ref:n,ownerState:le,className:Ce.root}),[Me,Ee]=Bn("startDecorator",{className:Ce.startDecorator,elementType:BZ,externalForwardedProps:we,ownerState:le}),[Te,Ze]=Bn("endDecorator",{className:Ce.endDecorator,elementType:UZ,externalForwardedProps:we,ownerState:le}),[rt,Re]=Bn("loadingIndicatorCenter",{className:Ce.loadingIndicatorCenter,elementType:$Z,externalForwardedProps:we,ownerState:le});return ie.jsxs(We,me({},Fe,{children:[(R||_&&w==="start")&&ie.jsx(Me,me({},Ee,{children:_&&w==="start"?$:R})),l,_&&w==="center"&&ie.jsx(rt,me({},Re,{children:$})),(y||_&&w==="end")&&ie.jsx(Te,me({},Ze,{children:_&&w==="end"?$:y}))]}))});function jZ(t){return qr("MuiMenuItem",t)}$r("MuiMenuItem",["root","focusVisible","disabled","selected","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantSoft","variantOutlined","variantSolid"]);const HZ=["children","disabled","component","selected","color","orientation","variant","slots","slotProps","id"],GZ=t=>{const{focusVisible:e,disabled:n,selected:r,color:i,variant:l}=t,c={root:["root",e&&"focusVisible",n&&"disabled",r&&"selected",i&&`color${Rn(i)}`,l&&`variant${Rn(l)}`]};return Vr(c,jZ,{})},WZ=_n(X_,{name:"JoyMenuItem",slot:"Root",overridesResolver:(t,e)=>e.root})({}),qZ=G.memo(G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyMenuItem"}),i=G.useContext(fy),{children:l,disabled:c=!1,component:s="li",selected:p=!1,color:y="neutral",orientation:_="horizontal",variant:w="plain",slots:S={},slotProps:M={},id:I}=r,D=rr(r,HZ),{variant:R=w,color:L=y}=Hw(e.variant,e.color),{getRootProps:V,disabled:B,focusVisible:H}=CH({id:I,disabled:c,rootRef:n}),q=me({},r,{component:s,color:L,disabled:B,focusVisible:H,orientation:_,selected:p,row:i,variant:R}),X=GZ(q),ee=me({},D,{component:s,slots:S,slotProps:M}),[se,J]=Bn("root",{ref:n,elementType:WZ,getSlotProps:V,externalForwardedProps:ee,className:X.root,ownerState:q});return ie.jsx(tA.Provider,{value:_,children:ie.jsx(se,me({},J,{children:l}))})})),Lm=G.forwardRef(function(e,n){const{contextValue:r,id:i}=EH(e.id);return ie.jsx(pp.Provider,{value:r,children:ie.jsx(qZ,me({},e,{id:i,ref:n}))})});function XZ(t){return qr("MuiModalClose",t)}$r("MuiModalClose",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);var P3;const ZZ=["component","color","variant","size","onClick","slots","slotProps"],YZ=t=>{const{variant:e,color:n,disabled:r,focusVisible:i,size:l}=t,c={root:["root",r&&"disabled",i&&"focusVisible",e&&`variant${Rn(e)}`,n&&`color${Rn(n)}`,l&&`size${Rn(l)}`]};return Vr(c,XZ,{})},KZ=_n(K_,{name:"JoyModalClose",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n;return me({},t.size==="sm"&&{"--IconButton-size":"1.75rem"},t.size==="md"&&{"--IconButton-size":"2rem"},t.size==="lg"&&{"--IconButton-size":"2.25rem"},{position:"absolute",zIndex:1,top:"var(--ModalClose-inset, 0.625rem)",right:"var(--ModalClose-inset, 0.625rem)",borderRadius:`var(--ModalClose-radius, ${e.vars.radius.sm})`},!((n=e.variants[t.variant])!=null&&(n=n[t.color])!=null&&n.backgroundColor)&&{color:e.vars.palette.text.secondary})}),JZ={plain:"plain",outlined:"plain",soft:"soft",solid:"solid"},CF=G.forwardRef(function(e,n){var r,i,l,c,s,p;const y=Xr({props:e,name:"JoyModalClose"}),{component:_="button",color:w="neutral",variant:S="plain",size:M="md",onClick:I,slots:D={},slotProps:R={}}=y,L=rr(y,ZZ),V=G.useContext(_F),B=G.useContext(Xw),H=(r=(i=e.variant)!=null?i:JZ[B?.variant])!=null?r:S,q=(l=(c=e.color)!=null?c:B?.color)!=null?l:w,X=G.useContext(oA),ee=(s=(p=e.size)!=null?p:X)!=null?s:M,{focusVisible:se,getRootProps:J}=kh(me({},y,{rootRef:n})),$=me({},y,{color:q,component:_,variant:H,size:ee,focusVisible:se}),le=YZ($),[Ce,we]=Bn("root",{ref:n,elementType:KZ,getSlotProps:J,externalForwardedProps:me({onClick:We=>{V?.(We,"closeClick"),I?.(We)}},L,{component:_,slots:D,slotProps:R}),className:le.root,ownerState:$});return ie.jsx(Ce,me({},we,{children:P3||(P3=ie.jsx(K4,{}))}))});function QZ(t){return qr("MuiOption",t)}const eY=$r("MuiOption",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","focusVisible","disabled","selected","highlighted","variantPlain","variantSoft","variantOutlined","variantSolid"]),tY=["component","children","disabled","value","label","variant","color","slots","slotProps"],nY=t=>{const{disabled:e,highlighted:n,selected:r}=t;return Vr({root:["root",e&&"disabled",n&&"highlighted",r&&"selected"]},QZ,{})},rY=_n(X_,{name:"JoyOption",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[`${e.variant}Hover`])==null?void 0:n[e.color];return{[`&.${eY.highlighted}:not([aria-selected="true"])`]:{backgroundColor:r?.backgroundColor}}}),iY=G.memo(G.forwardRef(function(e,n){var r;const i=Xr({props:e,name:"JoyOption"}),{component:l="li",children:c,disabled:s=!1,value:p,label:y,variant:_="plain",color:w="neutral",slots:S={},slotProps:M={}}=i,I=rr(i,tY),D=G.useContext(fy),{variant:R=_,color:L=w}=Hw(e.variant,e.color),V=G.useRef(null),B=mi(V,n),H=y??(typeof c=="string"?c:(r=V.current)==null?void 0:r.innerText),{getRootProps:q,selected:X,highlighted:ee,index:se}=OH({disabled:s,label:H,value:p,rootRef:B}),J=me({},i,{disabled:s,selected:X,highlighted:ee,index:se,component:l,variant:R,color:L,row:D}),$=nY(J),le=me({},I,{component:l,slots:S,slotProps:M}),[Ce,we]=Bn("root",{ref:n,getSlotProps:q,elementType:rY,externalForwardedProps:le,className:$.root,ownerState:J});return ie.jsx(Ce,me({},we,{children:c}))})),oY=G.forwardRef(function(e,n){const{contextValue:r}=FH(e.value);return ie.jsx(pp.Provider,{value:r,children:ie.jsx(iY,me({},e,{ref:n}))})}),sY=Jm(ie.jsx("path",{d:"m12 5.83 2.46 2.46c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 3.7a.9959.9959 0 0 0-1.41 0L8.12 6.88c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 5.83zm0 12.34-2.46-2.46a.9959.9959 0 0 0-1.41 0c-.39.39-.39 1.02 0 1.41l3.17 3.18c.39.39 1.02.39 1.41 0l3.17-3.17c.39-.39.39-1.02 0-1.41a.9959.9959 0 0 0-1.41 0L12 18.17z"}),"Unfold");function aY(t){return qr("MuiSelect",t)}const Bv=$r("MuiSelect",["root","button","indicator","startDecorator","endDecorator","popper","listbox","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg","focusVisible","disabled","expanded","multiple"]);var A3;const lY=["action","autoFocus","children","defaultValue","defaultListboxOpen","disabled","getSerializedValue","placeholder","listboxId","listboxOpen","onChange","onListboxOpenChange","onClose","renderValue","required","value","size","variant","color","startDecorator","endDecorator","indicator","aria-describedby","aria-label","aria-labelledby","id","name","multiple","slots","slotProps"];function cY(t){var e;return Array.isArray(t)?ie.jsx(G.Fragment,{children:t.map(n=>n.label).join(", ")}):(e=t?.label)!=null?e:""}const uY=[{name:"offset",options:{offset:[0,4]}},{name:"equalWidth",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:({state:t})=>{t.styles.popper.width=`${t.rects.reference.width}px`}}],hY=t=>{const{color:e,disabled:n,focusVisible:r,size:i,variant:l,open:c,multiple:s}=t,p={root:["root",n&&"disabled",r&&"focusVisible",c&&"expanded",l&&`variant${Rn(l)}`,e&&`color${Rn(e)}`,i&&`size${Rn(i)}`,s&&"multiple"],button:["button"],startDecorator:["startDecorator"],endDecorator:["endDecorator"],indicator:["indicator",c&&"expanded"],listbox:["listbox",c&&"expanded",n&&"disabled"]};return Vr(p,aY,{})},dY=_n("div",{name:"JoySelect",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,i,l,c;const s=(n=t.variants[`${e.variant}`])==null?void 0:n[e.color],{borderRadius:p}=Km({theme:t,ownerState:e},["borderRadius"]);return[me({"--Select-radius":t.vars.radius.sm,"--Select-gap":"0.5rem","--Select-placeholderOpacity":.64,"--Select-decoratorColor":t.vars.palette.text.icon,"--Select-focusedThickness":t.vars.focus.thickness,"--Select-focusedHighlight":(r=t.vars.palette[e.color==="neutral"?"primary":e.color])==null?void 0:r[500],'&:not([data-inverted-colors="false"])':me({},e.instanceColor&&{"--_Select-focusedHighlight":(i=t.vars.palette[e.instanceColor==="neutral"?"primary":e.instanceColor])==null?void 0:i[500]},{"--Select-focusedHighlight":t.vars.palette.focusVisible}),"--Select-indicatorColor":s!=null&&s.backgroundColor?s?.color:t.vars.palette.text.tertiary},e.size==="sm"&&{"--Select-minHeight":"2rem","--Select-paddingInline":"0.5rem","--Select-decoratorChildHeight":"min(1.5rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl},e.size==="md"&&{"--Select-minHeight":"2.25rem","--Select-paddingInline":"0.75rem","--Select-decoratorChildHeight":"min(1.75rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},e.size==="lg"&&{"--Select-minHeight":"2.75rem","--Select-paddingInline":"1rem","--Select-decoratorChildHeight":"min(2.375rem, var(--Select-minHeight))","--Icon-fontSize":t.vars.fontSize.xl2},{"--Select-decoratorChildOffset":"min(calc(var(--Select-paddingInline) - (var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2), var(--Select-paddingInline))","--_Select-paddingBlock":"max((var(--Select-minHeight) - 2 * var(--variant-borderWidth, 0px) - var(--Select-decoratorChildHeight)) / 2, 0px)","--Select-decoratorChildRadius":"max(var(--Select-radius) - var(--variant-borderWidth, 0px) - var(--_Select-paddingBlock), min(var(--_Select-paddingBlock) + var(--variant-borderWidth, 0px), var(--Select-radius) / 2))","--Button-minHeight":"var(--Select-decoratorChildHeight)","--Button-paddingBlock":"0px","--IconButton-size":"var(--Select-decoratorChildHeight)","--Button-radius":"var(--Select-decoratorChildRadius)","--IconButton-radius":"var(--Select-decoratorChildRadius)",boxSizing:"border-box"},e.variant!=="plain"&&{boxShadow:t.shadow.xs},{minWidth:0,minHeight:"var(--Select-minHeight)",position:"relative",display:"flex",alignItems:"center",borderRadius:"var(--Select-radius)",cursor:"pointer"},!(s!=null&&s.backgroundColor)&&{backgroundColor:t.vars.palette.background.surface},e.size&&{paddingBlock:{sm:2,md:3,lg:4}[e.size]},{paddingInline:"var(--Select-paddingInline)"},t.typography[`body-${e.size}`],s,{"&::before":{boxSizing:"border-box",content:'""',display:"block",position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,zIndex:1,borderRadius:"inherit",margin:"calc(var(--variant-borderWidth, 0px) * -1)"},[`&.${Bv.focusVisible}`]:{"--Select-indicatorColor":s?.color,"&::before":{boxShadow:"inset 0 0 0 var(--Select-focusedThickness) var(--Select-focusedHighlight)"}},[`&.${Bv.disabled}`]:{"--Select-indicatorColor":"inherit"}}),{"&:hover":(l=t.variants[`${e.variant}Hover`])==null?void 0:l[e.color],[`&.${Bv.disabled}`]:(c=t.variants[`${e.variant}Disabled`])==null?void 0:c[e.color]},p!==void 0&&{"--Select-radius":p}]}),fY=_n("button",{name:"JoySelect",slot:"Button",overridesResolver:(t,e)=>e.button})(({ownerState:t})=>me({border:0,outline:0,background:"none",padding:0,fontSize:"inherit",color:"inherit",alignSelf:"stretch",display:"flex",alignItems:"center",flex:1,fontFamily:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden"},(t.value===null||t.value===void 0)&&{opacity:"var(--Select-placeholderOpacity)"},{"&::before":{content:'""',display:"block",position:"absolute",top:"calc(-1 * var(--variant-borderWidth, 0px))",left:"calc(-1 * var(--variant-borderWidth, 0px))",right:"calc(-1 * var(--variant-borderWidth, 0px))",bottom:"calc(-1 * var(--variant-borderWidth, 0px))",borderRadius:"var(--Select-radius)"}})),pY=_n(q_,{name:"JoySelect",slot:"Listbox",overridesResolver:(t,e)=>e.listbox})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return me({"--focus-outline-offset":`calc(${t.vars.focus.thickness} * -1)`,"--ListItem-stickyBackground":r?.backgroundColor||r?.background||t.vars.palette.background.popup,"--ListItem-stickyTop":"calc(var(--List-padding, var(--ListDivider-gap)) * -1)"},Vw,{minWidth:"max-content",maxHeight:"44vh",overflow:"auto",outline:0,boxShadow:t.shadow.md,borderRadius:`var(--List-radius, ${t.vars.radius.sm})`,zIndex:`var(--unstable_popup-zIndex, ${t.vars.zIndex.popup})`},!(r!=null&&r.backgroundColor)&&{backgroundColor:t.vars.palette.background.popup})}),mY=_n("span",{name:"JoySelect",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({"--Button-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--IconButton-margin":"0 0 0 calc(var(--Select-decoratorChildOffset) * -1)","--Icon-margin":"0 0 0 calc(var(--Select-paddingInline) / -4)",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineEnd:"var(--Select-gap)"}),gY=_n("span",{name:"JoySelect",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({"--Button-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--IconButton-margin":"0 calc(var(--Select-decoratorChildOffset) * -1) 0 0","--Icon-margin":"0 calc(var(--Select-paddingInline) / -4) 0 0",display:"inherit",alignItems:"center",color:"var(--Select-decoratorColor)",marginInlineStart:"var(--Select-gap)"}),vY=_n("span",{name:"JoySelect",slot:"Indicator"})(({ownerState:t,theme:e})=>me({},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.lg},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.xl},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl2},{"--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,display:"inherit",alignItems:"center",marginInlineStart:"var(--Select-gap)",marginInlineEnd:"calc(var(--Select-paddingInline) / -4)",[`.${Bv.endDecorator} + &`]:{marginInlineStart:"calc(var(--Select-gap) / 2)"},[`&.${Bv.expanded}, .${Bv.disabled} > &`]:{"--Icon-color":"currentColor"}})),yY=G.forwardRef(function(e,n){var r,i,l,c,s,p,y;const _=Xr({props:e,name:"JoySelect"}),w=_,{action:S,autoFocus:M,children:I,defaultValue:D,defaultListboxOpen:R=!1,disabled:L,getSerializedValue:V,placeholder:B,listboxId:H,listboxOpen:q,onChange:X,onListboxOpenChange:ee,onClose:se,renderValue:J,required:$=!1,value:le,size:Ce="md",variant:we="outlined",color:We="neutral",startDecorator:Fe,endDecorator:Me,indicator:Ee=A3||(A3=ie.jsx(sY,{})),"aria-describedby":Te,"aria-label":Ze,"aria-labelledby":rt,id:Re,name:Qe,multiple:Vt=!1,slots:je={},slotProps:ct={}}=w,Ct=rr(w,lY),ut=G.useContext(Ww),lt=(r=(i=e.disabled)!=null?i:ut?.disabled)!=null?r:L,_t=(l=(c=e.size)!=null?c:ut?.size)!=null?l:Ce,wt=(s=e.color)!=null?s:ut!=null&&ut.error?"danger":(p=ut?.color)!=null?p:We,cn=J??cY,[dn,tn]=G.useState(null),Je=G.useRef(null),Tn=G.useRef(null),Kt=mi(n,Je);G.useImperativeHandle(S,()=>({focusVisible:()=>{var $t;($t=Tn.current)==null||$t.focus()}}),[]),G.useEffect(()=>{tn(Je.current)},[]),G.useEffect(()=>{M&&Tn.current.focus()},[M]);const fn=G.useCallback($t=>{ee?.($t),$t||se?.()},[se,ee]),{buttonActive:Ut,buttonFocusVisible:On,contextValue:vn,disabled:Ue,getButtonProps:Se,getListboxProps:yt,getHiddenInputProps:Nt,getOptionMetadata:Ht,open:Ot,value:un}=nW({buttonRef:Tn,defaultOpen:R,defaultValue:D,disabled:lt,getSerializedValue:V,listboxId:H,multiple:Vt,name:Qe,required:$,onChange:X,onOpenChange:fn,open:q,value:le}),Gt=me({},_,{active:Ut,defaultListboxOpen:R,disabled:Ue,focusVisible:On,open:Ot,renderValue:cn,value:un,size:_t,variant:we,color:wt}),Zt=hY(Gt),Nn=me({},Ct,{slots:je,slotProps:ct}),Yt=G.useMemo(()=>{let $t;if(Vt)$t=un.map(Ie=>Ht(Ie)).filter(Ie=>Ie!==void 0);else{var Jt;$t=(Jt=Ht(un))!=null?Jt:null}return $t},[Ht,un,Vt]),[Pe,ae]=Bn("root",{ref:Kt,className:Zt.root,elementType:dY,externalForwardedProps:Nn,ownerState:Gt}),[ue,ne]=Bn("button",{additionalProps:{"aria-describedby":Te??ut?.["aria-describedby"],"aria-label":Ze,"aria-labelledby":rt??ut?.labelId,"aria-required":$?"true":void 0,id:Re??ut?.htmlFor,name:Qe},className:Zt.button,elementType:fY,externalForwardedProps:Nn,getSlotProps:Se,ownerState:Gt}),[fe,Oe]=Bn("listbox",{additionalProps:{anchorEl:dn,open:Ot,placement:"bottom",keepMounted:!0},className:Zt.listbox,elementType:pY,externalForwardedProps:Nn,getSlotProps:yt,ownerState:me({},Gt,{nesting:!1,row:!1,wrap:!1}),getSlotOwnerState:$t=>({size:$t.size||_t,variant:$t.variant||we,color:$t.color||($t.disablePortal?wt:We),disableColorInversion:!$t.disablePortal})}),[Ke,ye]=Bn("startDecorator",{className:Zt.startDecorator,elementType:mY,externalForwardedProps:Nn,ownerState:Gt}),[Ae,Be]=Bn("endDecorator",{className:Zt.endDecorator,elementType:gY,externalForwardedProps:Nn,ownerState:Gt}),[$e,He]=Bn("indicator",{className:Zt.indicator,elementType:vY,externalForwardedProps:Nn,ownerState:Gt}),dt=G.useMemo(()=>[...uY,...Oe.modifiers||[]],[Oe.modifiers]);let qe=B;return(Array.isArray(Yt)&&Yt.length>0||!Array.isArray(Yt)&&Yt)&&(qe=cn(Yt)),ie.jsxs(G.Fragment,{children:[ie.jsxs(Pe,me({},ae,{children:[Fe&&ie.jsx(Ke,me({},ye,{children:Fe})),ie.jsx(ue,me({},ne,{children:qe})),Me&&ie.jsx(Ae,me({},Be,{children:Me})),Ee&&ie.jsx($e,me({},He,{children:Ee})),ie.jsx("input",me({},Nt()))]})),dn&&ie.jsx(fe,me({},Oe,{className:co(Oe.className),modifiers:dt},!((y=_.slots)!=null&&y.listbox)&&{as:Bw,slots:{root:Oe.as||"ul"}},{children:ie.jsx(rW,{value:vn,children:ie.jsx(Gw,{variant:we,color:We,children:ie.jsx($w.Provider,{value:"select",children:ie.jsx(W_,{nested:!0,children:I})})})})}))]})});function _Y(t){return qr("MuiSheet",t)}$r("MuiSheet",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const xY=["className","color","component","variant","invertedColors","slots","slotProps"],bY=t=>{const{variant:e,color:n}=t,r={root:["root",e&&`variant${Rn(e)}`,n&&`color${Rn(n)}`]};return Vr(r,_Y,{})},wY=_n("div",{name:"JoySheet",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r;const i=(n=t.variants[e.variant])==null?void 0:n[e.color],{borderRadius:l,bgcolor:c,backgroundColor:s,background:p}=Km({theme:t,ownerState:e},["borderRadius","bgcolor","backgroundColor","background"]),y=ip(t,`palette.${c}`)||c||ip(t,`palette.${s}`)||s||p||i?.backgroundColor||i?.background||t.vars.palette.background.surface;return[me({"--Icon-color":e.color!=="neutral"||e.variant==="solid"?"currentColor":t.vars.palette.text.icon,"--ListItem-stickyBackground":y==="transparent"?"initial":y,"--Sheet-background":y==="transparent"?"initial":y},l!==void 0&&{"--List-radius":`calc(${l} - var(--variant-borderWidth, 0px))`,"--unstable_actionRadius":`calc(${l} - var(--variant-borderWidth, 0px))`},{backgroundColor:t.vars.palette.background.surface,position:"relative"}),me({},t.typography["body-md"],e.variant==="solid"&&e.color&&e.invertedColors&&Z_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Y_(e.color)(t),(r=t.variants[e.variant])==null?void 0:r[e.color],i)]}),EF=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoySheet"}),{className:i,color:l="neutral",component:c="div",variant:s="plain",invertedColors:p=!1,slots:y={},slotProps:_={}}=r,w=rr(r,xY),S=me({},r,{color:l,component:c,invertedColors:p,variant:s}),M=bY(S),I=me({},w,{component:c,slots:y,slotProps:_}),[D,R]=Bn("root",{ref:n,className:co(M.root,i),elementType:wY,externalForwardedProps:I,ownerState:S});return ie.jsx(D,me({},R))});function SY(t){return qr("MuiSnackbar",t)}$r("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","endDecorator","sizeSm","sizeMd","sizeLg","startDecorator","variantPlain","variantOutlined","variantSoft","variantSolid"]);const MY=["anchorOrigin","animationDuration","autoHideDuration","color","children","className","component","disableWindowBlurListener","endDecorator","invertedColors","onBlur","onClose","onFocus","onMouseEnter","onMouseLeave","onUnmount","open","resumeHideDuration","size","slots","slotProps","startDecorator","variant"];let TF=t=>t,I3,R3;const CY=t=>{const{variant:e,color:n,size:r,anchorOrigin:i}=t,l={root:["root",r&&`size${Rn(r)}`,n&&`color${Rn(n)}`,e&&`variant${Rn(e)}`,`anchorOrigin${Rn(i.vertical)}${Rn(i.horizontal)}`],startDecorator:["startDecorator"],endDecorator:["endDecorator"]};return Vr(l,SY,{})},EY=IP(I3||(I3=TF`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
  }
`)),TY=IP(R3||(R3=TF`
  0% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(0);
    opacity: 1;
  }
  100% {
    transform: translateX(var(--Snackbar-translateX, 0px)) translateY(calc(var(--_Snackbar-anchorBottom, 1) * 100%));
    opacity: 0;
  }
`)),PY=_n("div",{name:"JoySnackbar",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n,r,i,l,c,s,p;const{p:y,padding:_,borderRadius:w}=Km({theme:t,ownerState:e},["p","padding","borderRadius"]);return[me({"--Snackbar-radius":t.vars.radius.sm,"--Snackbar-decoratorChildRadius":"max((var(--Snackbar-radius) - var(--variant-borderWidth, 0px)) - var(--Snackbar-padding), min(var(--Snackbar-padding) + var(--variant-borderWidth, 0px), var(--Snackbar-radius) / 2))","--Button-minHeight":"var(--Snackbar-decoratorChildHeight)","--IconButton-size":"var(--Snackbar-decoratorChildHeight)","--Button-radius":"var(--Snackbar-decoratorChildRadius)","--IconButton-radius":"var(--Snackbar-decoratorChildRadius)","--Icon-color":"currentColor"},e.size==="sm"&&{"--Snackbar-padding":"0.75rem","--Snackbar-inset":"0.5rem","--Snackbar-decoratorChildHeight":"1.5rem","--Icon-fontSize":t.vars.fontSize.xl,gap:"0.5rem"},e.size==="md"&&{"--Snackbar-padding":"1rem","--Snackbar-inset":"0.75rem","--Snackbar-decoratorChildHeight":"2rem","--Icon-fontSize":t.vars.fontSize.xl,gap:"0.625rem"},e.size==="lg"&&{"--Snackbar-padding":"1.25rem","--Snackbar-inset":"1rem","--Snackbar-decoratorChildHeight":"2.375rem","--Icon-fontSize":t.vars.fontSize.xl2,gap:"0.875rem"},{zIndex:t.vars.zIndex.snackbar,position:"fixed",display:"flex",alignItems:"center",minWidth:300,top:((n=e.anchorOrigin)==null?void 0:n.vertical)==="top"?"var(--Snackbar-inset)":void 0,left:((r=e.anchorOrigin)==null?void 0:r.horizontal)==="left"?"var(--Snackbar-inset)":void 0,bottom:((i=e.anchorOrigin)==null?void 0:i.vertical)==="bottom"?"var(--Snackbar-inset)":void 0,right:((l=e.anchorOrigin)==null?void 0:l.horizontal)==="right"?"var(--Snackbar-inset)":void 0},((c=e.anchorOrigin)==null?void 0:c.horizontal)==="center"&&{"--Snackbar-translateX":"-50%",left:"50%",transform:"translateX(var(--Snackbar-translateX))"},((s=e.anchorOrigin)==null?void 0:s.vertical)==="top"&&{"--_Snackbar-anchorBottom":"-1"},{animation:`${EY} ${e.animationDuration}ms forwards`},!e.open&&{animationName:TY},{boxShadow:t.vars.shadow.lg,backgroundColor:t.vars.palette.background.surface,padding:"var(--Snackbar-padding)",borderRadius:"var(--Snackbar-radius)"},t.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[e.size]}`],e.variant==="solid"&&e.color&&e.invertedColors&&Z_(e.color)(t),e.variant==="soft"&&e.color&&e.invertedColors&&Y_(e.color)(t),(p=t.variants[e.variant])==null?void 0:p[e.color]),y!==void 0&&{"--Snackbar-padding":y},_!==void 0&&{"--Snackbar-padding":_},w!==void 0&&{"--Snackbar-radius":w}]}),AY=_n("span",{name:"JoySnackbar",slot:"StartDecorator",overridesResolver:(t,e)=>e.startDecorator})({display:"inherit",flex:"none"}),IY=_n("span",{name:"JoySnackbar",slot:"EndDecorator",overridesResolver:(t,e)=>e.endDecorator})({display:"inherit",flex:"none",marginLeft:"auto"}),RY={vertical:"bottom",horizontal:"right"},sA=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoySnackbar"}),{anchorOrigin:i=RY,animationDuration:l=300,autoHideDuration:c=null,color:s="neutral",children:p,className:y,component:_,disableWindowBlurListener:w=!1,endDecorator:S,invertedColors:M=!1,onUnmount:I,open:D,size:R="md",slots:L={},slotProps:V,startDecorator:B,variant:H="outlined"}=r,q=rr(r,MY),[X,ee]=G.useState(!0),[se,J]=G.useState(!1),$=G.useRef(I);$.current=I,G.useEffect(()=>{if(D)J(!1),ee(!1);else{J(!0);const je=setTimeout(()=>{var ct;ee(!0),J(!1),(ct=$.current)==null||ct.call($)},l);return()=>{clearTimeout(je)}}},[D,l]);const le=me({},r,{anchorOrigin:i,autoHideDuration:c,color:s,animationDuration:l,disableWindowBlurListener:w,invertedColors:M,size:R,variant:H});delete le.onUnmount;const Ce=CY(le),{getRootProps:we,onClickAway:We}=iW(le),Fe=je=>{se||We(je)},Me=me({},q,{component:_,slots:L,slotProps:V}),[Ee,Te]=Bn("root",{ref:n,className:co(Ce.root,y),elementType:PY,externalForwardedProps:Me,getSlotProps:we,ownerState:le}),[Ze,rt]=Bn("startDecorator",{className:Ce.startDecorator,elementType:AY,externalForwardedProps:Me,ownerState:le}),[Re,Qe]=Bn("endDecorator",{className:Ce.endDecorator,elementType:IY,externalForwardedProps:Me,ownerState:le}),Vt=L.clickAway||D7;return!D&&X?null:ie.jsx(Vt,me({onClickAway:Fe},typeof V?.clickAway=="function"?V.clickAway(le):V?.clickAway,{children:ie.jsxs(Ee,me({},Te,{children:[B&&ie.jsx(Ze,me({},rt,{children:B})),p,S&&ie.jsx(Re,me({},Qe,{children:S}))]}))}))}),ca=v7({createStyledComponent:_n("div",{name:"JoyStack",slot:"Root",overridesResolver:(t,e)=>e.root}),useThemeProps:t=>Xr({props:t,name:"JoyStack"})});function LY(t){return qr("MuiTab",t)}const kY=$r("MuiTab",["root","disabled","focusVisible","selected","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]),DY=["action","children","value","disabled","onChange","onClick","onFocus","component","orientation","variant","color","disableIndicator","indicatorPlacement","indicatorInset","slots","slotProps"],zY=t=>{const{selected:e,disabled:n,focusVisible:r,variant:i,color:l,orientation:c}=t,s={root:["root",c,n&&"disabled",r&&"focusVisible",e&&"selected",i&&`variant${Rn(i)}`,l&&`color${Rn(l)}`]};return Vr(s,LY,{})},OY=_n(X_,{name:"JoyTab",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>[{flex:"initial",justifyContent:t.row?"center":"initial","--unstable_ListItemDecorator-alignItems":"center","--unstable_offset":"min(calc(-1 * var(--variant-borderWidth, 0px)), -1px)"},!t.disableIndicator&&{'&[aria-selected="true"]':{"--Tab-indicatorColor":"currentColor",zIndex:1},"&::after":{content:'""',display:"block",position:"absolute",margin:"auto",background:"var(--Tab-indicatorColor)",borderRadius:"var(--Tab-indicatorRadius)"}},!t.disableIndicator&&t.indicatorPlacement==="bottom"&&{paddingBottom:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:t.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:t.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",bottom:"calc(-1px - var(--unstable_TabList-underlineBottom, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="top"&&{paddingTop:"calc(var(--ListItem-paddingY) - var(--variant-borderWidth, 0px) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorThickness)",width:"var(--Tab-indicatorSize)",left:t.indicatorInset?"var(--ListItem-paddingLeft)":"var(--unstable_offset)",right:t.indicatorInset?"var(--ListItem-paddingRight)":"var(--unstable_offset)",top:"calc(-1px - var(--unstable_TabList-underlineTop, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="right"&&{paddingRight:"calc(var(--ListItem-paddingRight) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",right:"calc(-1px - var(--unstable_TabList-underlineRight, 0px))"}},!t.disableIndicator&&t.indicatorPlacement==="left"&&{paddingLeft:"calc(var(--ListItem-paddingLeft) + var(--Tab-indicatorThickness) - 1px)","&::after":{height:"var(--Tab-indicatorSize)",width:"var(--Tab-indicatorThickness)",top:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",bottom:t.indicatorInset?"var(--ListItem-paddingY)":"var(--unstable_offset)",left:"calc(-1px - var(--unstable_TabList-underlineLeft, 0px))"}}]),p2=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyTab"}),i=G.useContext(fy),{action:l,children:c,disabled:s=!1,component:p="button",orientation:y="horizontal",variant:_="plain",color:w="neutral",disableIndicator:S=!1,indicatorPlacement:M=i?"bottom":"right",indicatorInset:I=!1,slots:D={},slotProps:R={}}=r,L=rr(r,DY),V=G.useRef(null),B=mi(V,n),{active:H,focusVisible:q,setFocusVisible:X,selected:ee,getRootProps:se}=pW(me({},r,{rootRef:B}));G.useImperativeHandle(l,()=>({focusVisible:()=>{X(!0),V.current.focus()}}),[X]);const J=me({},r,{disableIndicator:S,indicatorPlacement:M,indicatorInset:I,orientation:y,row:i,active:H,focusVisible:q,disabled:s,selected:ee,variant:_,color:w}),$=zY(J),le=me({},L,{component:p,slots:D,slotProps:R}),[Ce,we]=Bn("root",{ref:n,elementType:OY,getSlotProps:se,externalForwardedProps:le,ownerState:J,className:$.root});return ie.jsx(tA.Provider,{value:y,children:ie.jsx(Ce,me({},we,{children:c}))})}),aA=G.createContext("md");function FY(t){return qr("MuiTabList",t)}$r("MuiTabList",["root","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const NY=["component","children","variant","color","size","disableUnderline","underlinePlacement","tabFlex","sticky","slots","slotProps"],BY=t=>{const{orientation:e,size:n,variant:r,color:i}=t,l={root:["root",e,r&&`variant${Rn(r)}`,i&&`color${Rn(i)}`,n&&`size${Rn(n)}`]};return Vr(l,FY,{})},UY=_n(q_,{name:"JoyTabList",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;const r=(n=t.variants[e.variant])==null?void 0:n[e.color];return me({"--List-gap":"0px","--ListDivider-gap":"0px","--ListItem-paddingX":"var(--Tabs-spacing)","--ListItem-gap":"0.375rem","--unstable_TabList-hasUnderline":e.disableUnderline?"var(--unknown,)":"initial"},Vw,{flexGrow:"initial",flexDirection:e.orientation==="vertical"?"column":"row",borderRadius:"var(--List-radius, 0px)",padding:"var(--List-padding, 0px)",zIndex:1},e.sticky&&{position:"sticky",top:e.sticky==="top"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",bottom:e.sticky==="bottom"?"calc(-1 * var(--Tabs-padding, 0px))":"initial",backgroundColor:r?.backgroundColor||`var(--TabList-stickyBackground, ${t.vars.palette.background.body})`},!e.disableUnderline&&me({},e.underlinePlacement==="bottom"&&{"--unstable_TabList-underlineBottom":"1px",paddingBottom:1,boxShadow:`inset 0 -1px ${t.vars.palette.divider}`},e.underlinePlacement==="top"&&{"--unstable_TabList-underlineTop":"1px",paddingTop:1,boxShadow:`inset 0 1px ${t.vars.palette.divider}`},e.underlinePlacement==="right"&&{"--unstable_TabList-underlineRight":"1px",paddingRight:1,boxShadow:`inset -1px 0 ${t.vars.palette.divider}`},e.underlinePlacement==="left"&&{"--unstable_TabList-underlineLeft":"1px",paddingLeft:1,boxShadow:`inset 1px 0 ${t.vars.palette.divider}`}),e.tabFlex&&{[`& .${kY.root}`]:{flex:e.tabFlex}})}),$Y=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyTabList"}),i=G.useContext(aA),{isRtl:l,orientation:c,getRootProps:s,contextValue:p}=hW({rootRef:n}),{component:y="div",children:_,variant:w="plain",color:S="neutral",size:M,disableUnderline:I=!1,underlinePlacement:D=c==="horizontal"?"bottom":"right",tabFlex:R,sticky:L,slots:V={},slotProps:B={}}=r,H=rr(r,NY),X=me({},r,{isRtl:l,orientation:c,variant:w,color:S,size:M??i,sticky:L,tabFlex:R,nesting:!1,disableUnderline:I,underlinePlacement:D}),ee=BY(X),se=me({},H,{component:y,slots:V,slotProps:B}),[J,$]=Bn("root",{ref:n,elementType:UY,getSlotProps:s,externalForwardedProps:se,ownerState:X,className:ee.root});return ie.jsx(J,me({},$,{children:ie.jsx(dW,{value:p,children:ie.jsx(W_,{row:c==="horizontal",nested:!0,children:_})})}))});function VY(t){return qr("MuiTabPanel",t)}$r("MuiTabPanel",["root","hidden","sizeSm","sizeMd","sizeLg","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid"]);const jY=["children","value","component","color","variant","size","slots","slotProps","keepMounted"],HY=t=>{const{hidden:e,size:n,variant:r,color:i,orientation:l}=t,c={root:["root",e&&"hidden",n&&`size${Rn(n)}`,l,r&&`variant${Rn(r)}`,i&&`color${Rn(i)}`,n&&`size${Rn(n)}`]};return Vr(c,VY,{})},GY=_n("div",{name:"JoyTabPanel",slot:"Root",overridesResolver:(t,e)=>e.root})(({theme:t,ownerState:e})=>{var n;return me({display:e.hidden?"none":"block",padding:"var(--Tabs-spacing)",flexGrow:1,fontFamily:t.vars.fontFamily.body},t.typography[`body-${e.size}`],(n=t.variants[e.variant])==null?void 0:n[e.color])}),m2=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyTabPanel"}),{orientation:i}=Uw()||{orientation:"horizontal"},l=G.useContext(aA),{children:c,value:s=0,component:p,color:y="neutral",variant:_="plain",size:w,slots:S={},slotProps:M={},keepMounted:I=!1}=r,D=rr(r,jY),{hidden:R,getRootProps:L}=cW(me({},r,{value:s})),B=me({},r,{orientation:i,hidden:R,size:w??l,color:y,variant:_}),H=HY(B),q=me({},D,{component:p,slots:S,slotProps:M}),[X,ee]=Bn("root",{ref:n,elementType:GY,getSlotProps:L,externalForwardedProps:q,additionalProps:{role:"tabpanel",ref:n,as:p},ownerState:B,className:H.root});return I?ie.jsx(X,me({},ee,{children:c})):ie.jsx(X,me({},ee,{children:!R&&c}))});function WY(t){return qr("MuiTabs",t)}$r("MuiTabs",["root","horizontal","vertical","colorPrimary","colorNeutral","colorDanger","colorSuccess","colorWarning","colorContext","variantPlain","variantOutlined","variantSoft","variantSolid","sizeSm","sizeMd","sizeLg"]);const qY=["children","value","defaultValue","orientation","direction","component","onChange","selectionFollowsFocus","variant","color","size","slots","slotProps"],XY=t=>{const{orientation:e,variant:n,color:r,size:i}=t,l={root:["root",e,n&&`variant${Rn(n)}`,r&&`color${Rn(r)}`,i&&`size${Rn(i)}`]};return Vr(l,WY,{})},ZY=_n("div",{name:"JoyTabs",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r;const i=(n=e.variants[t.variant])==null?void 0:n[t.color],{bgcolor:l,backgroundColor:c,background:s,p,padding:y}=Km({theme:e,ownerState:t},["bgcolor","backgroundColor","background","p","padding"]),_=ip(e,`palette.${l}`)||l||ip(e,`palette.${c}`)||c||s||i?.backgroundColor||i?.background||e.vars.palette.background.surface;return me({},t.size==="sm"&&{"--Tabs-spacing":"0.75rem"},t.size==="md"&&{"--Tabs-spacing":"1rem"},t.size==="lg"&&{"--Tabs-spacing":"1.25rem"},{"--Tab-indicatorThickness":"2px","--Icon-color":t.color!=="neutral"||t.variant==="solid"?"currentColor":e.vars.palette.text.icon,"--TabList-stickyBackground":_==="transparent"?"initial":_,display:"flex",flexDirection:"column"},t.orientation==="vertical"&&{flexDirection:"row"},{backgroundColor:e.vars.palette.background.surface,position:"relative"},e.typography[`body-${t.size}`],(r=e.variants[t.variant])==null?void 0:r[t.color],p!==void 0&&{"--Tabs-padding":p},y!==void 0&&{"--Tabs-padding":y})}),L3=G.forwardRef(function(e,n){const r=Xr({props:e,name:"JoyTabs"}),{children:i,value:l,defaultValue:c,orientation:s="horizontal",direction:p="ltr",component:y,variant:_="plain",color:w="neutral",size:S="md",slots:M={},slotProps:I={}}=r,D=rr(r,qY),R=c||(l===void 0?0:void 0),{contextValue:L}=sW(me({},r,{orientation:s,defaultValue:R})),V=me({},r,{orientation:s,direction:p,variant:_,color:w,size:S}),B=XY(V),H=me({},D,{component:y,slots:M,slotProps:I}),[q,X]=Bn("root",{ref:n,elementType:ZY,externalForwardedProps:H,additionalProps:{ref:n,as:y},ownerState:V,className:B.root});return ie.jsx(q,me({},X,{children:ie.jsx(aW,{value:L,children:ie.jsx(aA.Provider,{value:S,children:i})})}))});function YY(t){return qr("MuiTooltip",t)}$r("MuiTooltip",["root","tooltipArrow","arrow","touch","placementLeft","placementRight","placementTop","placementBottom","colorPrimary","colorDanger","colorNeutral","colorSuccess","colorWarning","colorContext","sizeSm","sizeMd","sizeLg","variantPlain","variantOutlined","variantSoft","variantSolid"]);const KY=["children","className","component","arrow","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","disablePortal","direction","keepMounted","modifiers","placement","title","color","variant","size","slots","slotProps"],JY=t=>{const{arrow:e,variant:n,color:r,size:i,placement:l,touch:c}=t,s={root:["root",e&&"tooltipArrow",c&&"touch",i&&`size${Rn(i)}`,r&&`color${Rn(r)}`,n&&`variant${Rn(n)}`,`tooltipPlacement${Rn(l.split("-")[0])}`],arrow:["arrow"]};return Vr(s,YY,{})},QY=_n("div",{name:"JoyTooltip",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>{var n,r,i;const l=(n=e.variants[t.variant])==null?void 0:n[t.color];return me({},t.size==="sm"&&{"--Icon-fontSize":e.vars.fontSize.md,"--Tooltip-arrowSize":"8px",padding:e.spacing(.25,.625)},t.size==="md"&&{"--Icon-fontSize":e.vars.fontSize.lg,"--Tooltip-arrowSize":"10px",padding:e.spacing(.5,.75)},t.size==="lg"&&{"--Icon-fontSize":e.vars.fontSize.xl,"--Tooltip-arrowSize":"12px",padding:e.spacing(.75,1)},{zIndex:e.vars.zIndex.tooltip,borderRadius:e.vars.radius.sm,boxShadow:e.shadow.sm,wordWrap:"break-word",position:"relative"},t.disableInteractive&&{pointerEvents:"none"},e.typography[`body-${{sm:"xs",md:"sm",lg:"md"}[t.size]}`],l,!l.backgroundColor&&{backgroundColor:e.vars.palette.background.surface},{"&::before":{content:'""',display:"block",position:"absolute",width:(r=t.placement)!=null&&r.match(/(top|bottom)/)?"100%":"calc(10px + var(--variant-borderWidth, 0px))",height:(i=t.placement)!=null&&i.match(/(top|bottom)/)?"calc(10px + var(--variant-borderWidth, 0px))":"100%"},'&[data-popper-placement*="bottom"]::before':{top:0,left:0,transform:"translateY(-100%)"},'&[data-popper-placement*="left"]::before':{top:0,right:0,transform:"translateX(100%)"},'&[data-popper-placement*="right"]::before':{top:0,left:0,transform:"translateX(-100%)"},'&[data-popper-placement*="top"]::before':{bottom:0,left:0,transform:"translateY(100%)"}})}),eK=_n("span",{name:"JoyTooltip",slot:"Arrow",overridesResolver:(t,e)=>e.arrow})(({theme:t,ownerState:e})=>{var n,r,i;const l=(n=t.variants[e.variant])==null?void 0:n[e.color];return{"--unstable_Tooltip-arrowRotation":0,width:"var(--Tooltip-arrowSize)",height:"var(--Tooltip-arrowSize)",boxSizing:"border-box","&::before":{content:'""',display:"block",position:"absolute",width:0,height:0,border:"calc(var(--Tooltip-arrowSize) / 2) solid",borderLeftColor:"transparent",borderBottomColor:"transparent",borderTopColor:(r=l?.backgroundColor)!=null?r:t.vars.palette.background.surface,borderRightColor:(i=l?.backgroundColor)!=null?i:t.vars.palette.background.surface,borderRadius:"0px 2px 0px 0px",boxShadow:`var(--variant-borderWidth, 0px) calc(-1 * var(--variant-borderWidth, 0px)) 0px 0px ${l.borderColor}`,transformOrigin:"center center",transform:"rotate(calc(-45deg + 90deg * var(--unstable_Tooltip-arrowRotation)))"},'[data-popper-placement*="bottom"] &':{top:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="top"] &':{"--unstable_Tooltip-arrowRotation":2,bottom:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="left"] &':{"--unstable_Tooltip-arrowRotation":1,right:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"},'[data-popper-placement*="right"] &':{"--unstable_Tooltip-arrowRotation":3,left:"calc(0.5px + var(--Tooltip-arrowSize) * -1 / 2)"}}});let l1=!1;const k3=new V_;let c0={x:0,y:0};function D3(t,e){return n=>{e&&e(n),t(n)}}function z3(t,e){return(n,...r)=>{e&&e(n,...r),t(n,...r)}}const PF=G.forwardRef(function(e,n){var r;const i=Xr({props:e,name:"JoyTooltip"}),{children:l,className:c,component:s,arrow:p=!1,describeChild:y=!1,disableFocusListener:_=!1,disableHoverListener:w=!1,disableInteractive:S=!1,disableTouchListener:M=!1,enterDelay:I=100,enterNextDelay:D=0,enterTouchDelay:R=700,followCursor:L=!1,id:V,leaveDelay:B=0,leaveTouchDelay:H=1500,onClose:q,onOpen:X,open:ee,disablePortal:se,direction:J,keepMounted:$,modifiers:le,placement:Ce="bottom",title:we,color:We="neutral",variant:Fe="solid",size:Me="md",slots:Ee={},slotProps:Te={}}=i,Ze=rr(i,KY),[rt,Re]=G.useState(),[Qe,Vt]=G.useState(null),je=G.useRef(!1),ct=S||L,Ct=T0(),ut=T0(),lt=T0(),_t=T0(),[wt,cn]=Fv({controlled:ee,default:!1,name:"Tooltip",state:"open"});let dn=wt;const tn=il(V),Je=G.useRef(void 0),Tn=yu(()=>{Je.current!==void 0&&(document.body.style.WebkitUserSelect=Je.current,Je.current=void 0),_t.clear()});G.useEffect(()=>Tn,[Tn]);const Kt=Jt=>{k3.clear(),l1=!0,cn(!0),X&&!dn&&X(Jt)},fn=yu(Jt=>{k3.start(800+B,()=>{l1=!1}),cn(!1),q&&dn&&q(Jt),Ct.start(150,()=>{je.current=!1})}),Ut=Jt=>{je.current&&Jt.type!=="touchstart"||(rt&&rt.removeAttribute("title"),ut.clear(),lt.clear(),I||l1&&D?ut.start(l1?D:I,()=>{Kt(Jt)}):Kt(Jt))},On=Jt=>{ut.clear(),lt.start(B,()=>{fn(Jt)})},{isFocusVisibleRef:vn,onBlur:Ue,onFocus:Se,ref:yt}=Iw(),[,Nt]=G.useState(!1),Ht=Jt=>{Ue(Jt),vn.current===!1&&(Nt(!1),On(Jt))},Ot=Jt=>{rt||Re(Jt.currentTarget),Se(Jt),vn.current===!0&&(Nt(!0),Ut(Jt))},un=Jt=>{je.current=!0;const Ie=l.props;Ie.onTouchStart&&Ie.onTouchStart(Jt)},Gt=Jt=>{un(Jt),lt.clear(),Ct.clear(),Tn(),Je.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",_t.start(R,()=>{document.body.style.WebkitUserSelect=Je.current,Ut(Jt)})},Zt=Jt=>{l.props.onTouchEnd&&l.props.onTouchEnd(Jt),Tn(),lt.start(H,()=>{fn(Jt)})};G.useEffect(()=>{if(!dn)return;function Jt(Ie){(Ie.key==="Escape"||Ie.key==="Esc")&&fn(Ie)}return document.addEventListener("keydown",Jt),()=>{document.removeEventListener("keydown",Jt)}},[fn,dn]);const Nn=mi(Re,n),Yt=mi(yt,Nn),Pe=mi(Rw(l),Yt);typeof we!="number"&&!we&&(dn=!1);const ae=G.useRef(null),ue=Jt=>{const Ie=l.props;Ie.onMouseMove&&Ie.onMouseMove(Jt),c0={x:Jt.clientX,y:Jt.clientY},ae.current&&ae.current.update()},ne={},fe=typeof we=="string";y?(ne.title=!dn&&fe&&!w?we:null,ne["aria-describedby"]=dn?tn:null):(ne["aria-label"]=fe?we:null,ne["aria-labelledby"]=dn&&!fe?tn:null);const Oe=me({},ne,Ze,{component:s},l.props,{className:co(c,l.props.className),onTouchStart:un,ref:Pe},L?{onMouseMove:ue}:{}),Ke={};M||(Oe.onTouchStart=Gt,Oe.onTouchEnd=Zt),w||(Oe.onMouseOver=D3(Ut,Oe.onMouseOver),Oe.onMouseLeave=D3(On,Oe.onMouseLeave),ct||(Ke.onMouseOver=Ut,Ke.onMouseLeave=On)),_||(Oe.onFocus=z3(Ot,Oe.onFocus),Oe.onBlur=z3(Ht,Oe.onBlur),ct||(Ke.onFocus=Ot,Ke.onBlur=Ht));const ye=me({},i,{arrow:p,disableInteractive:ct,placement:Ce,touch:je.current,color:We,variant:Fe,size:Me}),Ae=JY(ye),Be=me({},Ze,{component:s,slots:Ee,slotProps:Te}),$e=G.useMemo(()=>[{name:"arrow",enabled:!!Qe,options:{element:Qe,padding:6}},{name:"offset",options:{offset:[0,10]}},...le||[]],[Qe,le]),[He,dt]=Bn("root",{additionalProps:me({id:tn,popperRef:ae,placement:Ce,anchorEl:L?{getBoundingClientRect:()=>({top:c0.y,left:c0.x,right:c0.x,bottom:c0.y,width:0,height:0})}:rt,open:rt?dn:!1,disablePortal:se,keepMounted:$,direction:J,modifiers:$e},Ke),ref:null,className:Ae.root,elementType:QY,externalForwardedProps:Be,ownerState:ye}),[qe,$t]=Bn("arrow",{ref:Vt,className:Ae.arrow,elementType:eK,externalForwardedProps:Be,ownerState:ye});return ie.jsxs(G.Fragment,{children:[G.isValidElement(l)&&G.cloneElement(l,Oe),ie.jsxs(He,me({},dt,!((r=i.slots)!=null&&r.root)&&{as:Bw,slots:{root:s||"div"}},{children:[we,p?ie.jsx(qe,me({},$t)):null]}))]})});var c1={},O3;function tK(){if(O3)return c1;O3=1;var t=k4();return c1.createRoot=t.createRoot,c1.hydrateRoot=t.hydrateRoot,c1}var nK=tK(),u0={},F3;function rK(){if(F3)return u0;F3=1,Object.defineProperty(u0,"__esModule",{value:!0}),u0.parse=c,u0.serialize=y;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,l=(()=>{const S=function(){};return S.prototype=Object.create(null),S})();function c(S,M){const I=new l,D=S.length;if(D<2)return I;const R=M?.decode||_;let L=0;do{const V=S.indexOf("=",L);if(V===-1)break;const B=S.indexOf(";",L),H=B===-1?D:B;if(V>H){L=S.lastIndexOf(";",V-1)+1;continue}const q=s(S,L,V),X=p(S,V,q),ee=S.slice(q,X);if(I[ee]===void 0){let se=s(S,V+1,H),J=p(S,H,se);const $=R(S.slice(se,J));I[ee]=$}L=H+1}while(L<D);return I}function s(S,M,I){do{const D=S.charCodeAt(M);if(D!==32&&D!==9)return M}while(++M<I);return I}function p(S,M,I){for(;M>I;){const D=S.charCodeAt(--M);if(D!==32&&D!==9)return M+1}return I}function y(S,M,I){const D=I?.encode||encodeURIComponent;if(!t.test(S))throw new TypeError(`argument name is invalid: ${S}`);const R=D(M);if(!e.test(R))throw new TypeError(`argument val is invalid: ${M}`);let L=S+"="+R;if(!I)return L;if(I.maxAge!==void 0){if(!Number.isInteger(I.maxAge))throw new TypeError(`option maxAge is invalid: ${I.maxAge}`);L+="; Max-Age="+I.maxAge}if(I.domain){if(!n.test(I.domain))throw new TypeError(`option domain is invalid: ${I.domain}`);L+="; Domain="+I.domain}if(I.path){if(!r.test(I.path))throw new TypeError(`option path is invalid: ${I.path}`);L+="; Path="+I.path}if(I.expires){if(!w(I.expires)||!Number.isFinite(I.expires.valueOf()))throw new TypeError(`option expires is invalid: ${I.expires}`);L+="; Expires="+I.expires.toUTCString()}if(I.httpOnly&&(L+="; HttpOnly"),I.secure&&(L+="; Secure"),I.partitioned&&(L+="; Partitioned"),I.priority)switch(typeof I.priority=="string"?I.priority.toLowerCase():void 0){case"low":L+="; Priority=Low";break;case"medium":L+="; Priority=Medium";break;case"high":L+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${I.priority}`)}if(I.sameSite)switch(typeof I.sameSite=="string"?I.sameSite.toLowerCase():I.sameSite){case!0:case"strict":L+="; SameSite=Strict";break;case"lax":L+="; SameSite=Lax";break;case"none":L+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${I.sameSite}`)}return L}function _(S){if(S.indexOf("%")===-1)return S;try{return decodeURIComponent(S)}catch{return S}}function w(S){return i.call(S)==="[object Date]"}return u0}rK();/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var AF=t=>{throw TypeError(t)},iK=(t,e,n)=>e.has(t)||AF("Cannot "+n),g2=(t,e,n)=>(iK(t,e,"read from private field"),n?n.call(t):e.get(t)),oK=(t,e,n)=>e.has(t)?AF("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),N3="popstate";function sK(t={}){function e(r,i){let{pathname:l,search:c,hash:s}=r.location;return w_("",{pathname:l,search:c,hash:s},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:op(i)}return lK(e,n,null,t)}function Ur(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zo(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aK(){return Math.random().toString(36).substring(2,10)}function B3(t,e){return{usr:t.state,key:t.key,idx:e}}function w_(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?vp(e):e,state:n,key:e&&e.key||r||aK()}}function op({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function vp(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function lK(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:l=!1}=r,c=i.history,s="POP",p=null,y=_();y==null&&(y=0,c.replaceState({...c.state,idx:y},""));function _(){return(c.state||{idx:null}).idx}function w(){s="POP";let R=_(),L=R==null?null:R-y;y=R,p&&p({action:s,location:D.location,delta:L})}function S(R,L){s="PUSH";let V=w_(D.location,R,L);y=_()+1;let B=B3(V,y),H=D.createHref(V);try{c.pushState(B,"",H)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;i.location.assign(H)}l&&p&&p({action:s,location:D.location,delta:1})}function M(R,L){s="REPLACE";let V=w_(D.location,R,L);y=_();let B=B3(V,y),H=D.createHref(V);c.replaceState(B,"",H),l&&p&&p({action:s,location:D.location,delta:0})}function I(R){return IF(R)}let D={get action(){return s},get location(){return t(i,c)},listen(R){if(p)throw new Error("A history only accepts one active listener");return i.addEventListener(N3,w),p=R,()=>{i.removeEventListener(N3,w),p=null}},createHref(R){return e(i,R)},createURL:I,encodeLocation(R){let L=I(R);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:S,replace:M,go(R){return c.go(R)}};return D}function IF(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ur(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:op(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}var P0,U3=class{constructor(t){if(oK(this,P0,new Map),t)for(let[e,n]of t)this.set(e,n)}get(t){if(g2(this,P0).has(t))return g2(this,P0).get(t);if(t.defaultValue!==void 0)return t.defaultValue;throw new Error("No value found for context")}set(t,e){g2(this,P0).set(t,e)}};P0=new WeakMap;var cK=new Set(["lazy","caseSensitive","path","id","index","children"]);function uK(t){return cK.has(t)}var hK=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function dK(t){return hK.has(t)}function fK(t){return t.index===!0}function kb(t,e,n=[],r={}){return t.map((i,l)=>{let c=[...n,String(l)],s=typeof i.id=="string"?i.id:c.join("-");if(Ur(i.index!==!0||!i.children,"Cannot specify children on an index route"),Ur(!r[s],`Found a route id collision on id "${s}".  Route id's must be globally unique within Data Router usages`),fK(i)){let p={...i,...e(i),id:s};return r[s]=p,p}else{let p={...i,...e(i),id:s,children:void 0};return r[s]=p,i.children&&(p.children=kb(i.children,e,c,r)),p}})}function qf(t,e,n="/"){return ib(t,e,n,!1)}function ib(t,e,n,r){let i=typeof e=="string"?vp(e):e,l=Lc(i.pathname||"/",n);if(l==null)return null;let c=RF(t);mK(c);let s=null;for(let p=0;s==null&&p<c.length;++p){let y=EK(l);s=MK(c[p],y,r)}return s}function pK(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function RF(t,e=[],n=[],r=""){let i=(l,c,s)=>{let p={relativePath:s===void 0?l.path||"":s,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};p.relativePath.startsWith("/")&&(Ur(p.relativePath.startsWith(r),`Absolute route path "${p.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(r.length));let y=Eh([r,p.relativePath]),_=n.concat(p);l.children&&l.children.length>0&&(Ur(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),RF(l.children,e,_,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:wK(y,l.index),routesMeta:_})};return t.forEach((l,c)=>{if(l.path===""||!l.path?.includes("?"))i(l,c);else for(let s of LF(l.path))i(l,c,s)}),e}function LF(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),l=n.replace(/\?$/,"");if(r.length===0)return i?[l,""]:[l];let c=LF(r.join("/")),s=[];return s.push(...c.map(p=>p===""?l:[l,p].join("/"))),i&&s.push(...c),s.map(p=>t.startsWith("/")&&p===""?"/":p)}function mK(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:SK(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var gK=/^:[\w-]+$/,vK=3,yK=2,_K=1,xK=10,bK=-2,$3=t=>t==="*";function wK(t,e){let n=t.split("/"),r=n.length;return n.some($3)&&(r+=bK),e&&(r+=yK),n.filter(i=>!$3(i)).reduce((i,l)=>i+(gK.test(l)?vK:l===""?_K:xK),r)}function SK(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function MK(t,e,n=!1){let{routesMeta:r}=t,i={},l="/",c=[];for(let s=0;s<r.length;++s){let p=r[s],y=s===r.length-1,_=l==="/"?e:e.slice(l.length)||"/",w=Db({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},_),S=p.route;if(!w&&y&&n&&!r[r.length-1].route.index&&(w=Db({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},_)),!w)return null;Object.assign(i,w.params),c.push({params:i,pathname:Eh([l,w.pathname]),pathnameBase:AK(Eh([l,w.pathnameBase])),route:S}),w.pathnameBase!=="/"&&(l=Eh([l,w.pathnameBase]))}return c}function Db(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=CK(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let l=i[0],c=l.replace(/(.)\/+$/,"$1"),s=i.slice(1);return{params:r.reduce((y,{paramName:_,isOptional:w},S)=>{if(_==="*"){let I=s[S]||"";c=l.slice(0,l.length-I.length).replace(/(.)\/+$/,"$1")}const M=s[S];return w&&!M?y[_]=void 0:y[_]=(M||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:c,pattern:t}}function CK(t,e=!1,n=!0){zo(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,s,p)=>(r.push({paramName:s,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function EK(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zo(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Lc(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function TK(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?vp(t):t;return{pathname:n?n.startsWith("/")?n:PK(n,e):e,search:IK(r),hash:RK(i)}}function PK(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function v2(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function kF(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function lA(t){let e=kF(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function cA(t,e,n,r=!1){let i;typeof t=="string"?i=vp(t):(i={...t},Ur(!i.pathname||!i.pathname.includes("?"),v2("?","pathname","search",i)),Ur(!i.pathname||!i.pathname.includes("#"),v2("#","pathname","hash",i)),Ur(!i.search||!i.search.includes("#"),v2("#","search","hash",i)));let l=t===""||i.pathname==="",c=l?"/":i.pathname,s;if(c==null)s=n;else{let w=e.length-1;if(!r&&c.startsWith("..")){let S=c.split("/");for(;S[0]==="..";)S.shift(),w-=1;i.pathname=S.join("/")}s=w>=0?e[w]:"/"}let p=TK(i,s),y=c&&c!=="/"&&c.endsWith("/"),_=(l||c===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(y||_)&&(p.pathname+="/"),p}var Eh=t=>t.join("/").replace(/\/\/+/g,"/"),AK=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),IK=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,RK=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,zb=class{constructor(t,e,n,r=!1){this.status=t,this.statusText=e||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function S_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var DF=["POST","PUT","PATCH","DELETE"],LK=new Set(DF),kK=["GET",...DF],DK=new Set(kK),zK=new Set([301,302,303,307,308]),OK=new Set([307,308]),y2={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},FK={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},h0={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},uA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,NK=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),zF="remix-router-transitions",OF=Symbol("ResetLoaderData");function BK(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";Ur(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=t.hydrationRouteProperties||[],i=t.mapRouteProperties||NK,l={},c=kb(t.routes,i,void 0,l),s,p=t.basename||"/",y=t.dataStrategy||HK,_={unstable_middleware:!1,...t.future},w=null,S=new Set,M=null,I=null,D=null,R=t.hydrationData!=null,L=qf(c,t.history.location,p),V=!1,B=null,H;if(L==null&&!t.patchRoutesOnNavigation){let Ie=Cc(404,{pathname:t.history.location.pathname}),{matches:ot,route:mt}=Q3(c);H=!0,L=ot,B={[mt.id]:Ie}}else if(L&&!t.hydrationData&&dt(L,c,t.history.location.pathname).active&&(L=null),L)if(L.some(Ie=>Ie.route.lazy))H=!1;else if(!L.some(Ie=>Ie.route.loader))H=!0;else{let Ie=t.hydrationData?t.hydrationData.loaderData:null,ot=t.hydrationData?t.hydrationData.errors:null;if(ot){let mt=L.findIndex(Wt=>ot[Wt.route.id]!==void 0);H=L.slice(0,mt+1).every(Wt=>!XE(Wt.route,Ie,ot))}else H=L.every(mt=>!XE(mt.route,Ie,ot))}else{H=!1,L=[];let Ie=dt(null,c,t.history.location.pathname);Ie.active&&Ie.matches&&(V=!0,L=Ie.matches)}let q,X={historyAction:t.history.action,location:t.history.location,matches:L,initialized:H,navigation:y2,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||B,fetchers:new Map,blockers:new Map},ee="POP",se=!1,J,$=!1,le=new Map,Ce=null,we=!1,We=!1,Fe=new Set,Me=new Map,Ee=0,Te=-1,Ze=new Map,rt=new Set,Re=new Map,Qe=new Map,Vt=new Set,je=new Map,ct,Ct=null;function ut(){if(w=t.history.listen(({action:Ie,location:ot,delta:mt})=>{if(ct){ct(),ct=void 0;return}zo(je.size===0||mt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Wt=Ke({currentLocation:X.location,nextLocation:ot,historyAction:Ie});if(Wt&&mt!=null){let nn=new Promise(mn=>{ct=mn});t.history.go(mt*-1),Oe(Wt,{state:"blocked",location:ot,proceed(){Oe(Wt,{state:"proceeding",proceed:void 0,reset:void 0,location:ot}),nn.then(()=>t.history.go(mt))},reset(){let mn=new Map(X.blockers);mn.set(Wt,h0),wt({blockers:mn})}});return}return Je(Ie,ot)}),n){tJ(e,le);let Ie=()=>nJ(e,le);e.addEventListener("pagehide",Ie),Ce=()=>e.removeEventListener("pagehide",Ie)}return X.initialized||Je("POP",X.location,{initialHydration:!0}),q}function lt(){w&&w(),Ce&&Ce(),S.clear(),J&&J.abort(),X.fetchers.forEach((Ie,ot)=>Zt(ot)),X.blockers.forEach((Ie,ot)=>fe(ot))}function _t(Ie){return S.add(Ie),()=>S.delete(Ie)}function wt(Ie,ot={}){X={...X,...Ie};let mt=[],Wt=[];X.fetchers.forEach((nn,mn)=>{nn.state==="idle"&&(Vt.has(mn)?mt.push(mn):Wt.push(mn))}),Vt.forEach(nn=>{!X.fetchers.has(nn)&&!Me.has(nn)&&mt.push(nn)}),[...S].forEach(nn=>nn(X,{deletedFetchers:mt,viewTransitionOpts:ot.viewTransitionOpts,flushSync:ot.flushSync===!0})),mt.forEach(nn=>Zt(nn)),Wt.forEach(nn=>X.fetchers.delete(nn))}function cn(Ie,ot,{flushSync:mt}={}){let Wt=X.actionData!=null&&X.navigation.formMethod!=null&&Ol(X.navigation.formMethod)&&X.navigation.state==="loading"&&Ie.state?._isRedirect!==!0,nn;ot.actionData?Object.keys(ot.actionData).length>0?nn=ot.actionData:nn=null:Wt?nn=X.actionData:nn=null;let mn=ot.loaderData?K3(X.loaderData,ot.loaderData,ot.matches||[],ot.errors):X.loaderData,on=X.blockers;on.size>0&&(on=new Map(on),on.forEach((Et,Gn)=>on.set(Gn,h0)));let sn=se===!0||X.navigation.formMethod!=null&&Ol(X.navigation.formMethod)&&Ie.state?._isRedirect!==!0;s&&(c=s,s=void 0),we||ee==="POP"||(ee==="PUSH"?t.history.push(Ie,Ie.state):ee==="REPLACE"&&t.history.replace(Ie,Ie.state));let Dn;if(ee==="POP"){let Et=le.get(X.location.pathname);Et&&Et.has(Ie.pathname)?Dn={currentLocation:X.location,nextLocation:Ie}:le.has(Ie.pathname)&&(Dn={currentLocation:Ie,nextLocation:X.location})}else if($){let Et=le.get(X.location.pathname);Et?Et.add(Ie.pathname):(Et=new Set([Ie.pathname]),le.set(X.location.pathname,Et)),Dn={currentLocation:X.location,nextLocation:Ie}}wt({...ot,actionData:nn,loaderData:mn,historyAction:ee,location:Ie,initialized:!0,navigation:y2,revalidation:"idle",restoreScrollPosition:He(Ie,ot.matches||X.matches),preventScrollReset:sn,blockers:on},{viewTransitionOpts:Dn,flushSync:mt===!0}),ee="POP",se=!1,$=!1,we=!1,We=!1,Ct?.resolve(),Ct=null}async function dn(Ie,ot){if(typeof Ie=="number"){t.history.go(Ie);return}let mt=qE(X.location,X.matches,p,Ie,ot?.fromRouteId,ot?.relative),{path:Wt,submission:nn,error:mn}=V3(!1,mt,ot),on=X.location,sn=w_(X.location,Wt,ot&&ot.state);sn={...sn,...t.history.encodeLocation(sn)};let Dn=ot&&ot.replace!=null?ot.replace:void 0,Et="PUSH";Dn===!0?Et="REPLACE":Dn===!1||nn!=null&&Ol(nn.formMethod)&&nn.formAction===X.location.pathname+X.location.search&&(Et="REPLACE");let Gn=ot&&"preventScrollReset"in ot?ot.preventScrollReset===!0:void 0,Fn=(ot&&ot.flushSync)===!0,or=Ke({currentLocation:on,nextLocation:sn,historyAction:Et});if(or){Oe(or,{state:"blocked",location:sn,proceed(){Oe(or,{state:"proceeding",proceed:void 0,reset:void 0,location:sn}),dn(Ie,ot)},reset(){let It=new Map(X.blockers);It.set(or,h0),wt({blockers:It})}});return}await Je(Et,sn,{submission:nn,pendingError:mn,preventScrollReset:Gn,replace:ot&&ot.replace,enableViewTransition:ot&&ot.viewTransition,flushSync:Fn})}function tn(){Ct||(Ct=rJ()),Ht(),wt({revalidation:"loading"});let Ie=Ct.promise;return X.navigation.state==="submitting"?Ie:X.navigation.state==="idle"?(Je(X.historyAction,X.location,{startUninterruptedRevalidation:!0}),Ie):(Je(ee||X.historyAction,X.navigation.location,{overrideNavigation:X.navigation,enableViewTransition:$===!0}),Ie)}async function Je(Ie,ot,mt){J&&J.abort(),J=null,ee=Ie,we=(mt&&mt.startUninterruptedRevalidation)===!0,$e(X.location,X.matches),se=(mt&&mt.preventScrollReset)===!0,$=(mt&&mt.enableViewTransition)===!0;let Wt=s||c,nn=mt&&mt.overrideNavigation,mn=mt?.initialHydration&&X.matches&&X.matches.length>0&&!V?X.matches:qf(Wt,ot,p),on=(mt&&mt.flushSync)===!0;if(mn&&X.initialized&&!We&&YK(X.location,ot)&&!(mt&&mt.submission&&Ol(mt.submission.formMethod))){cn(ot,{matches:mn},{flushSync:on});return}let sn=dt(mn,Wt,ot.pathname);if(sn.active&&sn.matches&&(mn=sn.matches),!mn){let{error:qt,notFoundMatches:hn,route:kn}=ye(ot.pathname);cn(ot,{matches:hn,loaderData:{},errors:{[kn.id]:qt}},{flushSync:on});return}J=new AbortController;let Dn=yv(t.history,ot,J.signal,mt&&mt.submission),Et=new U3(t.unstable_getContext?await t.unstable_getContext():void 0),Gn;if(mt&&mt.pendingError)Gn=[Pm(mn).route.id,{type:"error",error:mt.pendingError}];else if(mt&&mt.submission&&Ol(mt.submission.formMethod)){let qt=await Tn(Dn,ot,mt.submission,mn,Et,sn.active,mt&&mt.initialHydration===!0,{replace:mt.replace,flushSync:on});if(qt.shortCircuited)return;if(qt.pendingActionResult){let[hn,kn]=qt.pendingActionResult;if(zl(kn)&&S_(kn.error)&&kn.error.status===404){J=null,cn(ot,{matches:qt.matches,loaderData:{},errors:{[hn]:kn.error}});return}}mn=qt.matches||mn,Gn=qt.pendingActionResult,nn=_2(ot,mt.submission),on=!1,sn.active=!1,Dn=yv(t.history,Dn.url,Dn.signal)}let{shortCircuited:Fn,matches:or,loaderData:It,errors:nt}=await Kt(Dn,ot,mn,Et,sn.active,nn,mt&&mt.submission,mt&&mt.fetcherSubmission,mt&&mt.replace,mt&&mt.initialHydration===!0,on,Gn);Fn||(J=null,cn(ot,{matches:or||mn,...J3(Gn),loaderData:It,errors:nt}))}async function Tn(Ie,ot,mt,Wt,nn,mn,on,sn={}){Ht();let Dn=QK(ot,mt);if(wt({navigation:Dn},{flushSync:sn.flushSync===!0}),mn){let Fn=await qe(Wt,ot.pathname,Ie.signal);if(Fn.type==="aborted")return{shortCircuited:!0};if(Fn.type==="error"){let or=Pm(Fn.partialMatches).route.id;return{matches:Fn.partialMatches,pendingActionResult:[or,{type:"error",error:Fn.error}]}}else if(Fn.matches)Wt=Fn.matches;else{let{notFoundMatches:or,error:It,route:nt}=ye(ot.pathname);return{matches:or,pendingActionResult:[nt.id,{type:"error",error:It}]}}}let Et,Gn=A0(Wt,ot);if(!Gn.route.action&&!Gn.route.lazy)Et={type:"error",error:Cc(405,{method:Ie.method,pathname:ot.pathname,routeId:Gn.route.id})};else{let Fn=Uv(i,l,Ie,Wt,Gn,on?[]:r,nn),or=await yt(Ie,Fn,nn,null);if(Et=or[Gn.route.id],!Et){for(let It of Wt)if(or[It.route.id]){Et=or[It.route.id];break}}if(Ie.signal.aborted)return{shortCircuited:!0}}if(km(Et)){let Fn;return sn&&sn.replace!=null?Fn=sn.replace:Fn=X3(Et.response.headers.get("Location"),new URL(Ie.url),p)===X.location.pathname+X.location.search,await Se(Ie,Et,!0,{submission:mt,replace:Fn}),{shortCircuited:!0}}if(zl(Et)){let Fn=Pm(Wt,Gn.route.id);return(sn&&sn.replace)!==!0&&(ee="PUSH"),{matches:Wt,pendingActionResult:[Fn.route.id,Et,Gn.route.id]}}return{matches:Wt,pendingActionResult:[Gn.route.id,Et]}}async function Kt(Ie,ot,mt,Wt,nn,mn,on,sn,Dn,Et,Gn,Fn){let or=mn||_2(ot,on),It=on||sn||tL(or),nt=!we&&!Et;if(nn){if(nt){let Pn=fn(Fn);wt({navigation:or,...Pn!==void 0?{actionData:Pn}:{}},{flushSync:Gn})}let gn=await qe(mt,ot.pathname,Ie.signal);if(gn.type==="aborted")return{shortCircuited:!0};if(gn.type==="error"){let Pn=Pm(gn.partialMatches).route.id;return{matches:gn.partialMatches,loaderData:{},errors:{[Pn]:gn.error}}}else if(gn.matches)mt=gn.matches;else{let{error:Pn,notFoundMatches:Qt,route:Zn}=ye(ot.pathname);return{matches:Qt,loaderData:{},errors:{[Zn.id]:Pn}}}}let qt=s||c,{dsMatches:hn,revalidatingFetchers:kn}=j3(Ie,Wt,i,l,t.history,X,mt,It,ot,Et?[]:r,Et===!0,We,Fe,Vt,Re,rt,qt,p,t.patchRoutesOnNavigation!=null,Fn);if(Te=++Ee,!t.dataStrategy&&!hn.some(gn=>gn.shouldLoad)&&kn.length===0){let gn=ae();return cn(ot,{matches:mt,loaderData:{},errors:Fn&&zl(Fn[1])?{[Fn[0]]:Fn[1].error}:null,...J3(Fn),...gn?{fetchers:new Map(X.fetchers)}:{}},{flushSync:Gn}),{shortCircuited:!0}}if(nt){let gn={};if(!nn){gn.navigation=or;let Pn=fn(Fn);Pn!==void 0&&(gn.actionData=Pn)}kn.length>0&&(gn.fetchers=Ut(kn)),wt(gn,{flushSync:Gn})}kn.forEach(gn=>{Yt(gn.key),gn.controller&&Me.set(gn.key,gn.controller)});let Ir=()=>kn.forEach(gn=>Yt(gn.key));J&&J.signal.addEventListener("abort",Ir);let{loaderResults:xr,fetcherResults:xe}=await Nt(hn,kn,Ie,Wt);if(Ie.signal.aborted)return{shortCircuited:!0};J&&J.signal.removeEventListener("abort",Ir),kn.forEach(gn=>Me.delete(gn.key));let vt=u1(xr);if(vt)return await Se(Ie,vt.result,!0,{replace:Dn}),{shortCircuited:!0};if(vt=u1(xe),vt)return rt.add(vt.key),await Se(Ie,vt.result,!0,{replace:Dn}),{shortCircuited:!0};let{loaderData:Dt,errors:bt}=Y3(X,mt,xr,Fn,kn,xe);Et&&X.errors&&(bt={...X.errors,...bt});let St=ae(),pn=ue(Te),An=St||pn||kn.length>0;return{matches:mt,loaderData:Dt,errors:bt,...An?{fetchers:new Map(X.fetchers)}:{}}}function fn(Ie){if(Ie&&!zl(Ie[1]))return{[Ie[0]]:Ie[1].data};if(X.actionData)return Object.keys(X.actionData).length===0?null:X.actionData}function Ut(Ie){return Ie.forEach(ot=>{let mt=X.fetchers.get(ot.key),Wt=d0(void 0,mt?mt.data:void 0);X.fetchers.set(ot.key,Wt)}),new Map(X.fetchers)}async function On(Ie,ot,mt,Wt){Yt(Ie);let nn=(Wt&&Wt.flushSync)===!0,mn=s||c,on=qE(X.location,X.matches,p,mt,ot,Wt?.relative),sn=qf(mn,on,p),Dn=dt(sn,mn,on);if(Dn.active&&Dn.matches&&(sn=Dn.matches),!sn){un(Ie,ot,Cc(404,{pathname:on}),{flushSync:nn});return}let{path:Et,submission:Gn,error:Fn}=V3(!0,on,Wt);if(Fn){un(Ie,ot,Fn,{flushSync:nn});return}let or=A0(sn,Et),It=new U3(t.unstable_getContext?await t.unstable_getContext():void 0),nt=(Wt&&Wt.preventScrollReset)===!0;if(Gn&&Ol(Gn.formMethod)){await vn(Ie,ot,Et,or,sn,It,Dn.active,nn,nt,Gn);return}Re.set(Ie,{routeId:ot,path:Et}),await Ue(Ie,ot,Et,or,sn,It,Dn.active,nn,nt,Gn)}async function vn(Ie,ot,mt,Wt,nn,mn,on,sn,Dn,Et){Ht(),Re.delete(Ie);function Gn(Wn){if(!Wn.route.action&&!Wn.route.lazy){let tr=Cc(405,{method:Et.formMethod,pathname:mt,routeId:ot});return un(Ie,ot,tr,{flushSync:sn}),!0}return!1}if(!on&&Gn(Wt))return;let Fn=X.fetchers.get(Ie);Ot(Ie,eJ(Et,Fn),{flushSync:sn});let or=new AbortController,It=yv(t.history,mt,or.signal,Et);if(on){let Wn=await qe(nn,mt,It.signal,Ie);if(Wn.type==="aborted")return;if(Wn.type==="error"){un(Ie,ot,Wn.error,{flushSync:sn});return}else if(Wn.matches){if(nn=Wn.matches,Wt=A0(nn,mt),Gn(Wt))return}else{un(Ie,ot,Cc(404,{pathname:mt}),{flushSync:sn});return}}Me.set(Ie,or);let nt=Ee,qt=Uv(i,l,It,nn,Wt,r,mn),kn=(await yt(It,qt,mn,Ie))[Wt.route.id];if(It.signal.aborted){Me.get(Ie)===or&&Me.delete(Ie);return}if(Vt.has(Ie)){if(km(kn)||zl(kn)){Ot(Ie,jf(void 0));return}}else{if(km(kn))if(Me.delete(Ie),Te>nt){Ot(Ie,jf(void 0));return}else return rt.add(Ie),Ot(Ie,d0(Et)),Se(It,kn,!1,{fetcherSubmission:Et,preventScrollReset:Dn});if(zl(kn)){un(Ie,ot,kn.error);return}}let Ir=X.navigation.location||X.location,xr=yv(t.history,Ir,or.signal),xe=s||c,vt=X.navigation.state!=="idle"?qf(xe,X.navigation.location,p):X.matches;Ur(vt,"Didn't find any matches after fetcher action");let Dt=++Ee;Ze.set(Ie,Dt);let bt=d0(Et,kn.data);X.fetchers.set(Ie,bt);let{dsMatches:St,revalidatingFetchers:pn}=j3(xr,mn,i,l,t.history,X,vt,Et,Ir,r,!1,We,Fe,Vt,Re,rt,xe,p,t.patchRoutesOnNavigation!=null,[Wt.route.id,kn]);pn.filter(Wn=>Wn.key!==Ie).forEach(Wn=>{let tr=Wn.key,Or=X.fetchers.get(tr),Fr=d0(void 0,Or?Or.data:void 0);X.fetchers.set(tr,Fr),Yt(tr),Wn.controller&&Me.set(tr,Wn.controller)}),wt({fetchers:new Map(X.fetchers)});let An=()=>pn.forEach(Wn=>Yt(Wn.key));or.signal.addEventListener("abort",An);let{loaderResults:gn,fetcherResults:Pn}=await Nt(St,pn,xr,mn);if(or.signal.aborted)return;if(or.signal.removeEventListener("abort",An),Ze.delete(Ie),Me.delete(Ie),pn.forEach(Wn=>Me.delete(Wn.key)),X.fetchers.has(Ie)){let Wn=jf(kn.data);X.fetchers.set(Ie,Wn)}let Qt=u1(gn);if(Qt)return Se(xr,Qt.result,!1,{preventScrollReset:Dn});if(Qt=u1(Pn),Qt)return rt.add(Qt.key),Se(xr,Qt.result,!1,{preventScrollReset:Dn});let{loaderData:Zn,errors:In}=Y3(X,vt,gn,void 0,pn,Pn);ue(Dt),X.navigation.state==="loading"&&Dt>Te?(Ur(ee,"Expected pending action"),J&&J.abort(),cn(X.navigation.location,{matches:vt,loaderData:Zn,errors:In,fetchers:new Map(X.fetchers)})):(wt({errors:In,loaderData:K3(X.loaderData,Zn,vt,In),fetchers:new Map(X.fetchers)}),We=!1)}async function Ue(Ie,ot,mt,Wt,nn,mn,on,sn,Dn,Et){let Gn=X.fetchers.get(Ie);Ot(Ie,d0(Et,Gn?Gn.data:void 0),{flushSync:sn});let Fn=new AbortController,or=yv(t.history,mt,Fn.signal);if(on){let kn=await qe(nn,mt,or.signal,Ie);if(kn.type==="aborted")return;if(kn.type==="error"){un(Ie,ot,kn.error,{flushSync:sn});return}else if(kn.matches)nn=kn.matches,Wt=A0(nn,mt);else{un(Ie,ot,Cc(404,{pathname:mt}),{flushSync:sn});return}}Me.set(Ie,Fn);let It=Ee,nt=Uv(i,l,or,nn,Wt,r,mn),hn=(await yt(or,nt,mn,Ie))[Wt.route.id];if(Me.get(Ie)===Fn&&Me.delete(Ie),!or.signal.aborted){if(Vt.has(Ie)){Ot(Ie,jf(void 0));return}if(km(hn))if(Te>It){Ot(Ie,jf(void 0));return}else{rt.add(Ie),await Se(or,hn,!1,{preventScrollReset:Dn});return}if(zl(hn)){un(Ie,ot,hn.error);return}Ot(Ie,jf(hn.data))}}async function Se(Ie,ot,mt,{submission:Wt,fetcherSubmission:nn,preventScrollReset:mn,replace:on}={}){ot.response.headers.has("X-Remix-Revalidate")&&(We=!0);let sn=ot.response.headers.get("Location");Ur(sn,"Expected a Location header on the redirect Response"),sn=X3(sn,new URL(Ie.url),p);let Dn=w_(X.location,sn,{_isRedirect:!0});if(n){let nt=!1;if(ot.response.headers.has("X-Remix-Reload-Document"))nt=!0;else if(uA.test(sn)){const qt=IF(sn,!0);nt=qt.origin!==e.location.origin||Lc(qt.pathname,p)==null}if(nt){on?e.location.replace(sn):e.location.assign(sn);return}}J=null;let Et=on===!0||ot.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:Gn,formAction:Fn,formEncType:or}=X.navigation;!Wt&&!nn&&Gn&&Fn&&or&&(Wt=tL(X.navigation));let It=Wt||nn;if(OK.has(ot.response.status)&&It&&Ol(It.formMethod))await Je(Et,Dn,{submission:{...It,formAction:sn},preventScrollReset:mn||se,enableViewTransition:mt?$:void 0});else{let nt=_2(Dn,Wt);await Je(Et,Dn,{overrideNavigation:nt,fetcherSubmission:nn,preventScrollReset:mn||se,enableViewTransition:mt?$:void 0})}}async function yt(Ie,ot,mt,Wt){let nn,mn={};try{nn=await GK(y,Ie,ot,Wt,mt,!1)}catch(on){return ot.filter(sn=>sn.shouldLoad).forEach(sn=>{mn[sn.route.id]={type:"error",error:on}}),mn}if(Ie.signal.aborted)return mn;for(let[on,sn]of Object.entries(nn))if(KK(sn)){let Dn=sn.result;mn[on]={type:"redirect",response:XK(Dn,Ie,on,ot,p)}}else mn[on]=await qK(sn);return mn}async function Nt(Ie,ot,mt,Wt){let nn=yt(mt,Ie,Wt,null),mn=Promise.all(ot.map(async Dn=>{if(Dn.matches&&Dn.match&&Dn.request&&Dn.controller){let Gn=(await yt(Dn.request,Dn.matches,Wt,Dn.key))[Dn.match.route.id];return{[Dn.key]:Gn}}else return Promise.resolve({[Dn.key]:{type:"error",error:Cc(404,{pathname:Dn.path})}})})),on=await nn,sn=(await mn).reduce((Dn,Et)=>Object.assign(Dn,Et),{});return{loaderResults:on,fetcherResults:sn}}function Ht(){We=!0,Re.forEach((Ie,ot)=>{Me.has(ot)&&Fe.add(ot),Yt(ot)})}function Ot(Ie,ot,mt={}){X.fetchers.set(Ie,ot),wt({fetchers:new Map(X.fetchers)},{flushSync:(mt&&mt.flushSync)===!0})}function un(Ie,ot,mt,Wt={}){let nn=Pm(X.matches,ot);Zt(Ie),wt({errors:{[nn.route.id]:mt},fetchers:new Map(X.fetchers)},{flushSync:(Wt&&Wt.flushSync)===!0})}function Gt(Ie){return Qe.set(Ie,(Qe.get(Ie)||0)+1),Vt.has(Ie)&&Vt.delete(Ie),X.fetchers.get(Ie)||FK}function Zt(Ie){let ot=X.fetchers.get(Ie);Me.has(Ie)&&!(ot&&ot.state==="loading"&&Ze.has(Ie))&&Yt(Ie),Re.delete(Ie),Ze.delete(Ie),rt.delete(Ie),Vt.delete(Ie),Fe.delete(Ie),X.fetchers.delete(Ie)}function Nn(Ie){let ot=(Qe.get(Ie)||0)-1;ot<=0?(Qe.delete(Ie),Vt.add(Ie)):Qe.set(Ie,ot),wt({fetchers:new Map(X.fetchers)})}function Yt(Ie){let ot=Me.get(Ie);ot&&(ot.abort(),Me.delete(Ie))}function Pe(Ie){for(let ot of Ie){let mt=Gt(ot),Wt=jf(mt.data);X.fetchers.set(ot,Wt)}}function ae(){let Ie=[],ot=!1;for(let mt of rt){let Wt=X.fetchers.get(mt);Ur(Wt,`Expected fetcher: ${mt}`),Wt.state==="loading"&&(rt.delete(mt),Ie.push(mt),ot=!0)}return Pe(Ie),ot}function ue(Ie){let ot=[];for(let[mt,Wt]of Ze)if(Wt<Ie){let nn=X.fetchers.get(mt);Ur(nn,`Expected fetcher: ${mt}`),nn.state==="loading"&&(Yt(mt),Ze.delete(mt),ot.push(mt))}return Pe(ot),ot.length>0}function ne(Ie,ot){let mt=X.blockers.get(Ie)||h0;return je.get(Ie)!==ot&&je.set(Ie,ot),mt}function fe(Ie){X.blockers.delete(Ie),je.delete(Ie)}function Oe(Ie,ot){let mt=X.blockers.get(Ie)||h0;Ur(mt.state==="unblocked"&&ot.state==="blocked"||mt.state==="blocked"&&ot.state==="blocked"||mt.state==="blocked"&&ot.state==="proceeding"||mt.state==="blocked"&&ot.state==="unblocked"||mt.state==="proceeding"&&ot.state==="unblocked",`Invalid blocker state transition: ${mt.state} -> ${ot.state}`);let Wt=new Map(X.blockers);Wt.set(Ie,ot),wt({blockers:Wt})}function Ke({currentLocation:Ie,nextLocation:ot,historyAction:mt}){if(je.size===0)return;je.size>1&&zo(!1,"A router only supports one blocker at a time");let Wt=Array.from(je.entries()),[nn,mn]=Wt[Wt.length-1],on=X.blockers.get(nn);if(!(on&&on.state==="proceeding")&&mn({currentLocation:Ie,nextLocation:ot,historyAction:mt}))return nn}function ye(Ie){let ot=Cc(404,{pathname:Ie}),mt=s||c,{matches:Wt,route:nn}=Q3(mt);return{notFoundMatches:Wt,route:nn,error:ot}}function Ae(Ie,ot,mt){if(M=Ie,D=ot,I=mt||null,!R&&X.navigation===y2){R=!0;let Wt=He(X.location,X.matches);Wt!=null&&wt({restoreScrollPosition:Wt})}return()=>{M=null,D=null,I=null}}function Be(Ie,ot){return I&&I(Ie,ot.map(Wt=>pK(Wt,X.loaderData)))||Ie.key}function $e(Ie,ot){if(M&&D){let mt=Be(Ie,ot);M[mt]=D()}}function He(Ie,ot){if(M){let mt=Be(Ie,ot),Wt=M[mt];if(typeof Wt=="number")return Wt}return null}function dt(Ie,ot,mt){if(t.patchRoutesOnNavigation)if(Ie){if(Object.keys(Ie[0].params).length>0)return{active:!0,matches:ib(ot,mt,p,!0)}}else return{active:!0,matches:ib(ot,mt,p,!0)||[]};return{active:!1,matches:null}}async function qe(Ie,ot,mt,Wt){if(!t.patchRoutesOnNavigation)return{type:"success",matches:Ie};let nn=Ie;for(;;){let mn=s==null,on=s||c,sn=l;try{await t.patchRoutesOnNavigation({signal:mt,path:ot,matches:nn,fetcherKey:Wt,patch:(Gn,Fn)=>{mt.aborted||H3(Gn,Fn,on,sn,i)}})}catch(Gn){return{type:"error",error:Gn,partialMatches:nn}}finally{mn&&!mt.aborted&&(c=[...c])}if(mt.aborted)return{type:"aborted"};let Dn=qf(on,ot,p);if(Dn)return{type:"success",matches:Dn};let Et=ib(on,ot,p,!0);if(!Et||nn.length===Et.length&&nn.every((Gn,Fn)=>Gn.route.id===Et[Fn].route.id))return{type:"success",matches:null};nn=Et}}function $t(Ie){l={},s=kb(Ie,i,void 0,l)}function Jt(Ie,ot){let mt=s==null;H3(Ie,ot,s||c,l,i),mt&&(c=[...c],wt({}))}return q={get basename(){return p},get future(){return _},get state(){return X},get routes(){return c},get window(){return e},initialize:ut,subscribe:_t,enableScrollRestoration:Ae,navigate:dn,fetch:On,revalidate:tn,createHref:Ie=>t.history.createHref(Ie),encodeLocation:Ie=>t.history.encodeLocation(Ie),getFetcher:Gt,deleteFetcher:Nn,dispose:lt,getBlocker:ne,deleteBlocker:fe,patchRoutes:Jt,_internalFetchControllers:Me,_internalSetRoutes:$t},q}function UK(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function qE(t,e,n,r,i,l){let c,s;if(i){c=[];for(let y of e)if(c.push(y),y.route.id===i){s=y;break}}else c=e,s=e[e.length-1];let p=cA(r||".",lA(c),Lc(t.pathname,n)||t.pathname,l==="path");if(r==null&&(p.search=t.search,p.hash=t.hash),(r==null||r===""||r===".")&&s){let y=hA(p.search);if(s.route.index&&!y)p.search=p.search?p.search.replace(/^\?/,"?index&"):"?index";else if(!s.route.index&&y){let _=new URLSearchParams(p.search),w=_.getAll("index");_.delete("index"),w.filter(M=>M).forEach(M=>_.append("index",M));let S=_.toString();p.search=S?`?${S}`:""}}return n!=="/"&&(p.pathname=p.pathname==="/"?n:Eh([n,p.pathname])),op(p)}function V3(t,e,n){if(!n||!UK(n))return{path:e};if(n.formMethod&&!JK(n.formMethod))return{path:e,error:Cc(405,{method:n.formMethod})};let r=()=>({path:e,error:Cc(400,{type:"invalid-body"})}),l=(n.formMethod||"get").toUpperCase(),c=VF(e);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Ol(l))return r();let w=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((S,[M,I])=>`${S}${M}=${I}
`,""):String(n.body);return{path:e,submission:{formMethod:l,formAction:c,formEncType:n.formEncType,formData:void 0,json:void 0,text:w}}}else if(n.formEncType==="application/json"){if(!Ol(l))return r();try{let w=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:e,submission:{formMethod:l,formAction:c,formEncType:n.formEncType,formData:void 0,json:w,text:void 0}}}catch{return r()}}}Ur(typeof FormData=="function","FormData is not available in this environment");let s,p;if(n.formData)s=YE(n.formData),p=n.formData;else if(n.body instanceof FormData)s=YE(n.body),p=n.body;else if(n.body instanceof URLSearchParams)s=n.body,p=Z3(s);else if(n.body==null)s=new URLSearchParams,p=new FormData;else try{s=new URLSearchParams(n.body),p=Z3(s)}catch{return r()}let y={formMethod:l,formAction:c,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:p,json:void 0,text:void 0};if(Ol(y.formMethod))return{path:e,submission:y};let _=vp(e);return t&&_.search&&hA(_.search)&&s.append("index",""),_.search=`?${s}`,{path:op(_),submission:y}}function j3(t,e,n,r,i,l,c,s,p,y,_,w,S,M,I,D,R,L,V,B){let H=B?zl(B[1])?B[1].error:B[1].data:void 0,q=i.createURL(l.location),X=i.createURL(p),ee;if(_&&l.errors){let we=Object.keys(l.errors)[0];ee=c.findIndex(We=>We.route.id===we)}else if(B&&zl(B[1])){let we=B[0];ee=c.findIndex(We=>We.route.id===we)-1}let se=B?B[1].statusCode:void 0,J=se&&se>=400,$={currentUrl:q,currentParams:l.matches[0]?.params||{},nextUrl:X,nextParams:c[0].params,...s,actionResult:H,actionStatus:se},le=c.map((we,We)=>{let{route:Fe}=we,Me=null;if(ee!=null&&We>ee?Me=!1:Fe.lazy?Me=!0:Fe.loader==null?Me=!1:_?Me=XE(Fe,l.loaderData,l.errors):$K(l.loaderData,l.matches[We],we)&&(Me=!0),Me!==null)return ZE(n,r,t,we,y,e,Me);let Ee=J?!1:w||q.pathname+q.search===X.pathname+X.search||q.search!==X.search||VK(l.matches[We],we),Te={...$,defaultShouldRevalidate:Ee},Ze=Ob(we,Te);return ZE(n,r,t,we,y,e,Ze,Te)}),Ce=[];return I.forEach((we,We)=>{if(_||!c.some(Qe=>Qe.route.id===we.routeId)||M.has(We))return;let Fe=l.fetchers.get(We),Me=Fe&&Fe.state!=="idle"&&Fe.data===void 0,Ee=qf(R,we.path,L);if(!Ee){if(V&&Me)return;Ce.push({key:We,routeId:we.routeId,path:we.path,matches:null,match:null,request:null,controller:null});return}if(D.has(We))return;let Te=A0(Ee,we.path),Ze=new AbortController,rt=yv(i,we.path,Ze.signal),Re=null;if(S.has(We))S.delete(We),Re=Uv(n,r,rt,Ee,Te,y,e);else if(Me)w&&(Re=Uv(n,r,rt,Ee,Te,y,e));else{let Qe={...$,defaultShouldRevalidate:J?!1:w};Ob(Te,Qe)&&(Re=Uv(n,r,rt,Ee,Te,y,e,Qe))}Re&&Ce.push({key:We,routeId:we.routeId,path:we.path,matches:Re,match:Te,request:rt,controller:Ze})}),{dsMatches:le,revalidatingFetchers:Ce}}function XE(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&t.id in e,i=n!=null&&n[t.id]!==void 0;return!r&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!i}function $K(t,e,n){let r=!e||n.route.id!==e.route.id,i=!t.hasOwnProperty(n.route.id);return r||i}function VK(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Ob(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function H3(t,e,n,r,i){let l;if(t){let p=r[t];Ur(p,`No route found to patch children into: routeId = ${t}`),p.children||(p.children=[]),l=p.children}else l=n;let c=e.filter(p=>!l.some(y=>FF(p,y))),s=kb(c,i,[t||"_","patch",String(l?.length||"0")],r);l.push(...s)}function FF(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>e.children?.some(i=>FF(n,i))):!1}var G3=new WeakMap,NF=({key:t,route:e,manifest:n,mapRouteProperties:r})=>{let i=n[e.id];if(Ur(i,"No route found in manifest"),!i.lazy||typeof i.lazy!="object")return;let l=i.lazy[t];if(!l)return;let c=G3.get(i);c||(c={},G3.set(i,c));let s=c[t];if(s)return s;let p=(async()=>{let y=uK(t),w=i[t]!==void 0&&t!=="hasErrorBoundary";if(y)zo(!y,"Route property "+t+" is not a supported lazy route property. This property will be ignored."),c[t]=Promise.resolve();else if(w)zo(!1,`Route "${i.id}" has a static property "${t}" defined. The lazy property will be ignored.`);else{let S=await l();S!=null&&(Object.assign(i,{[t]:S}),Object.assign(i,r(i)))}typeof i.lazy=="object"&&(i.lazy[t]=void 0,Object.values(i.lazy).every(S=>S===void 0)&&(i.lazy=void 0))})();return c[t]=p,p},W3=new WeakMap;function jK(t,e,n,r,i){let l=n[t.id];if(Ur(l,"No route found in manifest"),!t.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof t.lazy=="function"){let _=W3.get(l);if(_)return{lazyRoutePromise:_,lazyHandlerPromise:_};let w=(async()=>{Ur(typeof t.lazy=="function","No lazy route function found");let S=await t.lazy(),M={};for(let I in S){let D=S[I];if(D===void 0)continue;let R=dK(I),V=l[I]!==void 0&&I!=="hasErrorBoundary";R?zo(!R,"Route property "+I+" is not a supported property to be returned from a lazy route function. This property will be ignored."):V?zo(!V,`Route "${l.id}" has a static property "${I}" defined but its lazy function is also returning a value for this property. The lazy route property "${I}" will be ignored.`):M[I]=D}Object.assign(l,M),Object.assign(l,{...r(l),lazy:void 0})})();return W3.set(l,w),w.catch(()=>{}),{lazyRoutePromise:w,lazyHandlerPromise:w}}let c=Object.keys(t.lazy),s=[],p;for(let _ of c){if(i&&i.includes(_))continue;let w=NF({key:_,route:t,manifest:n,mapRouteProperties:r});w&&(s.push(w),_===e&&(p=w))}let y=s.length>0?Promise.all(s).then(()=>{}):void 0;return y?.catch(()=>{}),p?.catch(()=>{}),{lazyRoutePromise:y,lazyHandlerPromise:p}}async function q3(t){let e=t.matches.filter(i=>i.shouldLoad),n={};return(await Promise.all(e.map(i=>i.resolve()))).forEach((i,l)=>{n[e[l].route.id]=i}),n}async function HK(t){return t.matches.some(e=>e.route.unstable_middleware)?BF(t,!1,()=>q3(t),(e,n)=>({[n]:{type:"error",result:e}})):q3(t)}async function BF(t,e,n,r){let{matches:i,request:l,params:c,context:s}=t,p={handlerResult:void 0};try{let y=i.flatMap(w=>w.route.unstable_middleware?w.route.unstable_middleware.map(S=>[w.route.id,S]):[]),_=await UF({request:l,params:c,context:s},y,e,p,n);return e?_:p.handlerResult}catch(y){if(!p.middlewareError)throw y;let _=await r(p.middlewareError.error,p.middlewareError.routeId);return p.handlerResult?Object.assign(p.handlerResult,_):_}}async function UF(t,e,n,r,i,l=0){let{request:c}=t;if(c.signal.aborted)throw c.signal.reason?c.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${c.method} ${c.url}`);let s=e[l];if(!s)return r.handlerResult=await i(),r.handlerResult;let[p,y]=s,_=!1,w,S=async()=>{if(_)throw new Error("You may only call `next()` once per middleware");_=!0,await UF(t,e,n,r,i,l+1)};try{let M=await y({request:t.request,params:t.params,context:t.context},S);return _?M===void 0?w:M:S()}catch(M){throw r.middlewareError?r.middlewareError.error!==M&&(r.middlewareError={routeId:p,error:M}):r.middlewareError={routeId:p,error:M},M}}function $F(t,e,n,r,i){let l=NF({key:"unstable_middleware",route:r.route,manifest:e,mapRouteProperties:t}),c=jK(r.route,Ol(n.method)?"action":"loader",e,t,i);return{middleware:l,route:c.lazyRoutePromise,handler:c.lazyHandlerPromise}}function ZE(t,e,n,r,i,l,c,s=null){let p=!1,y=$F(t,e,n,r,i);return{...r,_lazyPromises:y,shouldLoad:c,unstable_shouldRevalidateArgs:s,unstable_shouldCallHandler(_){return p=!0,s?typeof _=="boolean"?Ob(r,{...s,defaultShouldRevalidate:_}):Ob(r,s):c},resolve(_){return p||c||_&&n.method==="GET"&&(r.route.lazy||r.route.loader)?WK({request:n,match:r,lazyHandlerPromise:y?.handler,lazyRoutePromise:y?.route,handlerOverride:_,scopedContext:l}):Promise.resolve({type:"data",result:void 0})}}}function Uv(t,e,n,r,i,l,c,s=null){return r.map(p=>p.route.id!==i.route.id?{...p,shouldLoad:!1,unstable_shouldRevalidateArgs:s,unstable_shouldCallHandler:()=>!1,_lazyPromises:$F(t,e,n,p,l),resolve:()=>Promise.resolve({type:"data",result:void 0})}:ZE(t,e,n,p,l,c,!0,s))}async function GK(t,e,n,r,i,l){n.some(y=>y._lazyPromises?.middleware)&&await Promise.all(n.map(y=>y._lazyPromises?.middleware));let c={request:e,params:n[0].params,context:i,matches:n},p=await t({...c,fetcherKey:r,unstable_runClientMiddleware:y=>{let _=c;return BF(_,!1,()=>y({..._,fetcherKey:r,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}}),(w,S)=>({[S]:{type:"error",result:w}}))}});try{await Promise.all(n.flatMap(y=>[y._lazyPromises?.handler,y._lazyPromises?.route]))}catch{}return p}async function WK({request:t,match:e,lazyHandlerPromise:n,lazyRoutePromise:r,handlerOverride:i,scopedContext:l}){let c,s,p=Ol(t.method),y=p?"action":"loader",_=w=>{let S,M=new Promise((R,L)=>S=L);s=()=>S(),t.signal.addEventListener("abort",s);let I=R=>typeof w!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${y}" [routeId: ${e.route.id}]`)):w({request:t,params:e.params,context:l},...R!==void 0?[R]:[]),D=(async()=>{try{return{type:"data",result:await(i?i(L=>I(L)):I())}}catch(R){return{type:"error",result:R}}})();return Promise.race([D,M])};try{let w=p?e.route.action:e.route.loader;if(n||r)if(w){let S,[M]=await Promise.all([_(w).catch(I=>{S=I}),n,r]);if(S!==void 0)throw S;c=M}else{await n;let S=p?e.route.action:e.route.loader;if(S)[c]=await Promise.all([_(S),r]);else if(y==="action"){let M=new URL(t.url),I=M.pathname+M.search;throw Cc(405,{method:t.method,pathname:I,routeId:e.route.id})}else return{type:"data",result:void 0}}else if(w)c=await _(w);else{let S=new URL(t.url),M=S.pathname+S.search;throw Cc(404,{pathname:M})}}catch(w){return{type:"error",result:w}}finally{s&&t.signal.removeEventListener("abort",s)}return c}async function qK(t){let{result:e,type:n}=t;if(jF(e)){let r;try{let i=e.headers.get("Content-Type");i&&/\bapplication\/json\b/.test(i)?e.body==null?r=null:r=await e.json():r=await e.text()}catch(i){return{type:"error",error:i}}return n==="error"?{type:"error",error:new zb(e.status,e.statusText,r),statusCode:e.status,headers:e.headers}:{type:"data",data:r,statusCode:e.status,headers:e.headers}}return n==="error"?eL(e)?e.data instanceof Error?{type:"error",error:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:new zb(e.init?.status||500,void 0,e.data),statusCode:S_(e)?e.status:void 0,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:e,statusCode:S_(e)?e.status:void 0}:eL(e)?{type:"data",data:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function XK(t,e,n,r,i){let l=t.headers.get("Location");if(Ur(l,"Redirects returned/thrown from loaders/actions must have a Location header"),!uA.test(l)){let c=r.slice(0,r.findIndex(s=>s.route.id===n)+1);l=qE(new URL(e.url),c,i,l),t.headers.set("Location",l)}return t}function X3(t,e,n){if(uA.test(t)){let r=t,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),l=Lc(i.pathname,n)!=null;if(i.origin===e.origin&&l)return i.pathname+i.search+i.hash}return t}function yv(t,e,n,r){let i=t.createURL(VF(e)).toString(),l={signal:n};if(r&&Ol(r.formMethod)){let{formMethod:c,formEncType:s}=r;l.method=c.toUpperCase(),s==="application/json"?(l.headers=new Headers({"Content-Type":s}),l.body=JSON.stringify(r.json)):s==="text/plain"?l.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?l.body=YE(r.formData):l.body=r.formData}return new Request(i,l)}function YE(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function Z3(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function ZK(t,e,n,r=!1,i=!1){let l={},c=null,s,p=!1,y={},_=n&&zl(n[1])?n[1].error:void 0;return t.forEach(w=>{if(!(w.route.id in e))return;let S=w.route.id,M=e[S];if(Ur(!km(M),"Cannot handle redirect results in processLoaderData"),zl(M)){let I=M.error;if(_!==void 0&&(I=_,_=void 0),c=c||{},i)c[S]=I;else{let D=Pm(t,S);c[D.route.id]==null&&(c[D.route.id]=I)}r||(l[S]=OF),p||(p=!0,s=S_(M.error)?M.error.status:500),M.headers&&(y[S]=M.headers)}else l[S]=M.data,M.statusCode&&M.statusCode!==200&&!p&&(s=M.statusCode),M.headers&&(y[S]=M.headers)}),_!==void 0&&n&&(c={[n[0]]:_},n[2]&&(l[n[2]]=void 0)),{loaderData:l,errors:c,statusCode:s||200,loaderHeaders:y}}function Y3(t,e,n,r,i,l){let{loaderData:c,errors:s}=ZK(e,n,r);return i.filter(p=>!p.matches||p.matches.some(y=>y.shouldLoad)).forEach(p=>{let{key:y,match:_,controller:w}=p,S=l[y];if(Ur(S,"Did not find corresponding fetcher result"),!(w&&w.signal.aborted))if(zl(S)){let M=Pm(t.matches,_?.route.id);s&&s[M.route.id]||(s={...s,[M.route.id]:S.error}),t.fetchers.delete(y)}else if(km(S))Ur(!1,"Unhandled fetcher revalidation redirect");else{let M=jf(S.data);t.fetchers.set(y,M)}}),{loaderData:c,errors:s}}function K3(t,e,n,r){let i=Object.entries(e).filter(([,l])=>l!==OF).reduce((l,[c,s])=>(l[c]=s,l),{});for(let l of n){let c=l.route.id;if(!e.hasOwnProperty(c)&&t.hasOwnProperty(c)&&l.route.loader&&(i[c]=t[c]),r&&r.hasOwnProperty(c))break}return i}function J3(t){return t?zl(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function Pm(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function Q3(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Cc(t,{pathname:e,routeId:n,method:r,type:i,message:l}={}){let c="Unknown Server Error",s="Unknown @remix-run/router error";return t===400?(c="Bad Request",r&&e&&n?s=`You made a ${r} request to "${e}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:i==="invalid-body"&&(s="Unable to encode submission body")):t===403?(c="Forbidden",s=`Route "${n}" does not match URL "${e}"`):t===404?(c="Not Found",s=`No route matches URL "${e}"`):t===405&&(c="Method Not Allowed",r&&e&&n?s=`You made a ${r.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(s=`Invalid request method "${r.toUpperCase()}"`)),new zb(t||500,c,new Error(s),!0)}function u1(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,i]=e[n];if(km(i))return{key:r,result:i}}}function VF(t){let e=typeof t=="string"?vp(t):t;return op({...e,hash:""})}function YK(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function KK(t){return jF(t.result)&&zK.has(t.result.status)}function zl(t){return t.type==="error"}function km(t){return(t&&t.type)==="redirect"}function eL(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function jF(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function JK(t){return DK.has(t.toUpperCase())}function Ol(t){return LK.has(t.toUpperCase())}function hA(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function A0(t,e){let n=typeof e=="string"?vp(e).search:e.search;if(t[t.length-1].route.index&&hA(n||""))return t[t.length-1];let r=kF(t);return r[r.length-1]}function tL(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:l,json:c}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(l!=null)return{formMethod:e,formAction:n,formEncType:r,formData:l,json:void 0,text:void 0};if(c!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:c,text:void 0}}}function _2(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function QK(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function d0(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function eJ(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function jf(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function tJ(t,e){try{let n=t.sessionStorage.getItem(zF);if(n){let r=JSON.parse(n);for(let[i,l]of Object.entries(r||{}))l&&Array.isArray(l)&&e.set(i,new Set(l||[]))}}catch{}}function nJ(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(zF,JSON.stringify(n))}catch(r){zo(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function rJ(){let t,e,n=new Promise((r,i)=>{t=async l=>{r(l);try{await n}catch{}},e=async l=>{i(l);try{await n}catch{}}});return{promise:n,resolve:t,reject:e}}var Qm=G.createContext(null);Qm.displayName="DataRouter";var Q_=G.createContext(null);Q_.displayName="DataRouterState";var dA=G.createContext({isTransitioning:!1});dA.displayName="ViewTransition";var HF=G.createContext(new Map);HF.displayName="Fetchers";var iJ=G.createContext(null);iJ.displayName="Await";var Dh=G.createContext(null);Dh.displayName="Navigation";var Zw=G.createContext(null);Zw.displayName="Location";var Jd=G.createContext({outlet:null,matches:[],isDataRoute:!1});Jd.displayName="Route";var fA=G.createContext(null);fA.displayName="RouteError";function oJ(t,{relative:e}={}){Ur(ex(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=G.useContext(Dh),{hash:i,pathname:l,search:c}=tx(t,{relative:e}),s=l;return n!=="/"&&(s=l==="/"?n:Eh([n,l])),r.createHref({pathname:s,search:c,hash:i})}function ex(){return G.useContext(Zw)!=null}function yp(){return Ur(ex(),"useLocation() may be used only in the context of a <Router> component."),G.useContext(Zw).location}var GF="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function WF(t){G.useContext(Dh).static||G.useLayoutEffect(t)}function qF(){let{isDataRoute:t}=G.useContext(Jd);return t?yJ():sJ()}function sJ(){Ur(ex(),"useNavigate() may be used only in the context of a <Router> component.");let t=G.useContext(Qm),{basename:e,navigator:n}=G.useContext(Dh),{matches:r}=G.useContext(Jd),{pathname:i}=yp(),l=JSON.stringify(lA(r)),c=G.useRef(!1);return WF(()=>{c.current=!0}),G.useCallback((p,y={})=>{if(zo(c.current,GF),!c.current)return;if(typeof p=="number"){n.go(p);return}let _=cA(p,JSON.parse(l),i,y.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Eh([e,_.pathname])),(y.replace?n.replace:n.push)(_,y.state,y)},[e,n,l,i,t])}G.createContext(null);function tx(t,{relative:e}={}){let{matches:n}=G.useContext(Jd),{pathname:r}=yp(),i=JSON.stringify(lA(n));return G.useMemo(()=>cA(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function aJ(t,e,n,r){Ur(ex(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=G.useContext(Dh),{matches:l}=G.useContext(Jd),c=l[l.length-1],s=c?c.params:{},p=c?c.pathname:"/",y=c?c.pathnameBase:"/",_=c&&c.route;{let L=_&&_.path||"";XF(p,!_||L.endsWith("*")||L.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${L}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${L}"> to <Route path="${L==="/"?"*":`${L}/*`}">.`)}let w=yp(),S;S=w;let M=S.pathname||"/",I=M;if(y!=="/"){let L=y.replace(/^\//,"").split("/");I="/"+M.replace(/^\//,"").split("/").slice(L.length).join("/")}let D=qf(t,{pathname:I});return zo(_||D!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),zo(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),dJ(D&&D.map(L=>Object.assign({},L,{params:Object.assign({},s,L.params),pathname:Eh([y,i.encodeLocation?i.encodeLocation(L.pathname).pathname:L.pathname]),pathnameBase:L.pathnameBase==="/"?y:Eh([y,i.encodeLocation?i.encodeLocation(L.pathnameBase).pathname:L.pathnameBase])})),l,n,r)}function lJ(){let t=vJ(),e=S_(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},l={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=G.createElement(G.Fragment,null,G.createElement("p",null,"💿 Hey developer 👋"),G.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",G.createElement("code",{style:l},"ErrorBoundary")," or"," ",G.createElement("code",{style:l},"errorElement")," prop on your route.")),G.createElement(G.Fragment,null,G.createElement("h2",null,"Unexpected Application Error!"),G.createElement("h3",{style:{fontStyle:"italic"}},e),n?G.createElement("pre",{style:i},n):null,c)}var cJ=G.createElement(lJ,null),uJ=class extends G.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?G.createElement(Jd.Provider,{value:this.props.routeContext},G.createElement(fA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function hJ({routeContext:t,match:e,children:n}){let r=G.useContext(Qm);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),G.createElement(Jd.Provider,{value:t},n)}function dJ(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,l=n?.errors;if(l!=null){let p=i.findIndex(y=>y.route.id&&l?.[y.route.id]!==void 0);Ur(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),i=i.slice(0,Math.min(i.length,p+1))}let c=!1,s=-1;if(n)for(let p=0;p<i.length;p++){let y=i[p];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(s=p),y.route.id){let{loaderData:_,errors:w}=n,S=y.route.loader&&!_.hasOwnProperty(y.route.id)&&(!w||w[y.route.id]===void 0);if(y.route.lazy||S){c=!0,s>=0?i=i.slice(0,s+1):i=[i[0]];break}}}return i.reduceRight((p,y,_)=>{let w,S=!1,M=null,I=null;n&&(w=l&&y.route.id?l[y.route.id]:void 0,M=y.route.errorElement||cJ,c&&(s<0&&_===0?(XF("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),S=!0,I=null):s===_&&(S=!0,I=y.route.hydrateFallbackElement||null)));let D=e.concat(i.slice(0,_+1)),R=()=>{let L;return w?L=M:S?L=I:y.route.Component?L=G.createElement(y.route.Component,null):y.route.element?L=y.route.element:L=p,G.createElement(hJ,{match:y,routeContext:{outlet:p,matches:D,isDataRoute:n!=null},children:L})};return n&&(y.route.ErrorBoundary||y.route.errorElement||_===0)?G.createElement(uJ,{location:n.location,revalidation:n.revalidation,component:M,error:w,children:R(),routeContext:{outlet:null,matches:D,isDataRoute:!0}}):R()},null)}function pA(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fJ(t){let e=G.useContext(Qm);return Ur(e,pA(t)),e}function pJ(t){let e=G.useContext(Q_);return Ur(e,pA(t)),e}function mJ(t){let e=G.useContext(Jd);return Ur(e,pA(t)),e}function mA(t){let e=mJ(t),n=e.matches[e.matches.length-1];return Ur(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function gJ(){return mA("useRouteId")}function vJ(){let t=G.useContext(fA),e=pJ("useRouteError"),n=mA("useRouteError");return t!==void 0?t:e.errors?.[n]}function yJ(){let{router:t}=fJ("useNavigate"),e=mA("useNavigate"),n=G.useRef(!1);return WF(()=>{n.current=!0}),G.useCallback(async(i,l={})=>{zo(n.current,GF),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...l}))},[t,e])}var nL={};function XF(t,e,n){!e&&!nL[t]&&(nL[t]=!0,zo(!1,n))}var rL={};function iL(t,e){!t&&!rL[e]&&(rL[e]=!0,console.warn(e))}function _J(t){let e={hasErrorBoundary:t.hasErrorBoundary||t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&(t.element&&zo(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:G.createElement(t.Component),Component:void 0})),t.HydrateFallback&&(t.hydrateFallbackElement&&zo(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:G.createElement(t.HydrateFallback),HydrateFallback:void 0})),t.ErrorBoundary&&(t.errorElement&&zo(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:G.createElement(t.ErrorBoundary),ErrorBoundary:void 0})),e}var xJ=["HydrateFallback","hydrateFallbackElement"],bJ=class{constructor(){this.status="pending",this.promise=new Promise((t,e)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",t(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",e(n))}})}};function wJ({router:t,flushSync:e}){let[n,r]=G.useState(t.state),[i,l]=G.useState(),[c,s]=G.useState({isTransitioning:!1}),[p,y]=G.useState(),[_,w]=G.useState(),[S,M]=G.useState(),I=G.useRef(new Map),D=G.useCallback((B,{deletedFetchers:H,flushSync:q,viewTransitionOpts:X})=>{B.fetchers.forEach((se,J)=>{se.data!==void 0&&I.current.set(J,se.data)}),H.forEach(se=>I.current.delete(se)),iL(q===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let ee=t.window!=null&&t.window.document!=null&&typeof t.window.document.startViewTransition=="function";if(iL(X==null||ee,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!X||!ee){e&&q?e(()=>r(B)):G.startTransition(()=>r(B));return}if(e&&q){e(()=>{_&&(p&&p.resolve(),_.skipTransition()),s({isTransitioning:!0,flushSync:!0,currentLocation:X.currentLocation,nextLocation:X.nextLocation})});let se=t.window.document.startViewTransition(()=>{e(()=>r(B))});se.finished.finally(()=>{e(()=>{y(void 0),w(void 0),l(void 0),s({isTransitioning:!1})})}),e(()=>w(se));return}_?(p&&p.resolve(),_.skipTransition(),M({state:B,currentLocation:X.currentLocation,nextLocation:X.nextLocation})):(l(B),s({isTransitioning:!0,flushSync:!1,currentLocation:X.currentLocation,nextLocation:X.nextLocation}))},[t.window,e,_,p]);G.useLayoutEffect(()=>t.subscribe(D),[t,D]),G.useEffect(()=>{c.isTransitioning&&!c.flushSync&&y(new bJ)},[c]),G.useEffect(()=>{if(p&&i&&t.window){let B=i,H=p.promise,q=t.window.document.startViewTransition(async()=>{G.startTransition(()=>r(B)),await H});q.finished.finally(()=>{y(void 0),w(void 0),l(void 0),s({isTransitioning:!1})}),w(q)}},[i,p,t.window]),G.useEffect(()=>{p&&i&&n.location.key===i.location.key&&p.resolve()},[p,_,n.location,i]),G.useEffect(()=>{!c.isTransitioning&&S&&(l(S.state),s({isTransitioning:!0,flushSync:!1,currentLocation:S.currentLocation,nextLocation:S.nextLocation}),M(void 0))},[c.isTransitioning,S]);let R=G.useMemo(()=>({createHref:t.createHref,encodeLocation:t.encodeLocation,go:B=>t.navigate(B),push:(B,H,q)=>t.navigate(B,{state:H,preventScrollReset:q?.preventScrollReset}),replace:(B,H,q)=>t.navigate(B,{replace:!0,state:H,preventScrollReset:q?.preventScrollReset})}),[t]),L=t.basename||"/",V=G.useMemo(()=>({router:t,navigator:R,static:!1,basename:L}),[t,R,L]);return G.createElement(G.Fragment,null,G.createElement(Qm.Provider,{value:V},G.createElement(Q_.Provider,{value:n},G.createElement(HF.Provider,{value:I.current},G.createElement(dA.Provider,{value:c},G.createElement(CJ,{basename:L,location:n.location,navigationType:n.historyAction,navigator:R},G.createElement(SJ,{routes:t.routes,future:t.future,state:n})))))),null)}var SJ=G.memo(MJ);function MJ({routes:t,future:e,state:n}){return aJ(t,void 0,n,e)}function I0(t){Ur(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function CJ({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:l=!1}){Ur(!ex(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),s=G.useMemo(()=>({basename:c,navigator:i,static:l,future:{}}),[c,i,l]);typeof n=="string"&&(n=vp(n));let{pathname:p="/",search:y="",hash:_="",state:w=null,key:S="default"}=n,M=G.useMemo(()=>{let I=Lc(p,c);return I==null?null:{location:{pathname:I,search:y,hash:_,state:w,key:S},navigationType:r}},[c,p,y,_,w,S,r]);return zo(M!=null,`<Router basename="${c}"> is not able to match the URL "${p}${y}${_}" because it does not start with the basename, so the <Router> won't render anything.`),M==null?null:G.createElement(Dh.Provider,{value:s},G.createElement(Zw.Provider,{children:e,value:M}))}function KE(t,e=[]){let n=[];return G.Children.forEach(t,(r,i)=>{if(!G.isValidElement(r))return;let l=[...e,i];if(r.type===G.Fragment){n.push.apply(n,KE(r.props.children,l));return}Ur(r.type===I0,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ur(!r.props.index||!r.props.children,"An index route cannot have child routes.");let c={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=KE(r.props.children,l)),n.push(c)}),n}var EJ=KE,ob="get",sb="application/x-www-form-urlencoded";function Yw(t){return t!=null&&typeof t.tagName=="string"}function TJ(t){return Yw(t)&&t.tagName.toLowerCase()==="button"}function PJ(t){return Yw(t)&&t.tagName.toLowerCase()==="form"}function AJ(t){return Yw(t)&&t.tagName.toLowerCase()==="input"}function IJ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function RJ(t,e){return t.button===0&&(!e||e==="_self")&&!IJ(t)}function JE(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function LJ(t,e){let n=JE(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(l=>{n.append(i,l)})}),n}var h1=null;function kJ(){if(h1===null)try{new FormData(document.createElement("form"),0),h1=!1}catch{h1=!0}return h1}var DJ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function x2(t){return t!=null&&!DJ.has(t)?(zo(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${sb}"`),null):t}function zJ(t,e){let n,r,i,l,c;if(PJ(t)){let s=t.getAttribute("action");r=s?Lc(s,e):null,n=t.getAttribute("method")||ob,i=x2(t.getAttribute("enctype"))||sb,l=new FormData(t)}else if(TJ(t)||AJ(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=t.getAttribute("formaction")||s.getAttribute("action");if(r=p?Lc(p,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||ob,i=x2(t.getAttribute("formenctype"))||x2(s.getAttribute("enctype"))||sb,l=new FormData(s,t),!kJ()){let{name:y,type:_,value:w}=t;if(_==="image"){let S=y?`${y}.`:"";l.append(`${S}x`,"0"),l.append(`${S}y`,"0")}else y&&l.append(y,w)}}else{if(Yw(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ob,r=null,i=sb,c=t}return l&&i==="text/plain"&&(c=l,l=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:l,body:c}}function gA(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function OJ(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function FJ(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function NJ(t,e,n){let r=await Promise.all(t.map(async i=>{let l=e.routes[i.route.id];if(l){let c=await OJ(l,n);return c.links?c.links():[]}return[]}));return VJ(r.flat(1).filter(FJ).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function oL(t,e,n,r,i,l){let c=(p,y)=>n[y]?p.route.id!==n[y].route.id:!0,s=(p,y)=>n[y].pathname!==p.pathname||n[y].route.path?.endsWith("*")&&n[y].params["*"]!==p.params["*"];return l==="assets"?e.filter((p,y)=>c(p,y)||s(p,y)):l==="data"?e.filter((p,y)=>{let _=r.routes[p.route.id];if(!_||!_.hasLoader)return!1;if(c(p,y)||s(p,y))return!0;if(p.route.shouldRevalidate){let w=p.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function BJ(t,e,{includeHydrateFallback:n}={}){return UJ(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let l=[i.module];return i.clientActionModule&&(l=l.concat(i.clientActionModule)),i.clientLoaderModule&&(l=l.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(l=l.concat(i.hydrateFallbackModule)),i.imports&&(l=l.concat(i.imports)),l}).flat(1))}function UJ(t){return[...new Set(t)]}function $J(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function VJ(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let l=JSON.stringify($J(i));return n.has(l)||(n.add(l),r.push({key:l,link:i})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var jJ=new Set([100,101,204,205]);function HJ(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Lc(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function ZF(){let t=G.useContext(Qm);return gA(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function GJ(){let t=G.useContext(Q_);return gA(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var vA=G.createContext(void 0);vA.displayName="FrameworkContext";function YF(){let t=G.useContext(vA);return gA(t,"You must render this element inside a <HydratedRouter> element"),t}function WJ(t,e){let n=G.useContext(vA),[r,i]=G.useState(!1),[l,c]=G.useState(!1),{onFocus:s,onBlur:p,onMouseEnter:y,onMouseLeave:_,onTouchStart:w}=e,S=G.useRef(null);G.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let D=L=>{L.forEach(V=>{c(V.isIntersecting)})},R=new IntersectionObserver(D,{threshold:.5});return S.current&&R.observe(S.current),()=>{R.disconnect()}}},[t]),G.useEffect(()=>{if(r){let D=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(D)}}},[r]);let M=()=>{i(!0)},I=()=>{i(!1),c(!1)};return n?t!=="intent"?[l,S,{}]:[l,S,{onFocus:f0(s,M),onBlur:f0(p,I),onMouseEnter:f0(y,M),onMouseLeave:f0(_,I),onTouchStart:f0(w,M)}]:[!1,S,{}]}function f0(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function qJ({page:t,...e}){let{router:n}=ZF(),r=G.useMemo(()=>qf(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?G.createElement(ZJ,{page:t,matches:r,...e}):null}function XJ(t){let{manifest:e,routeModules:n}=YF(),[r,i]=G.useState([]);return G.useEffect(()=>{let l=!1;return NJ(t,e,n).then(c=>{l||i(c)}),()=>{l=!0}},[t,e,n]),r}function ZJ({page:t,matches:e,...n}){let r=yp(),{manifest:i,routeModules:l}=YF(),{basename:c}=ZF(),{loaderData:s,matches:p}=GJ(),y=G.useMemo(()=>oL(t,e,p,i,r,"data"),[t,e,p,i,r]),_=G.useMemo(()=>oL(t,e,p,i,r,"assets"),[t,e,p,i,r]),w=G.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let I=new Set,D=!1;if(e.forEach(L=>{let V=i.routes[L.route.id];!V||!V.hasLoader||(!y.some(B=>B.route.id===L.route.id)&&L.route.id in s&&l[L.route.id]?.shouldRevalidate||V.hasClientLoader?D=!0:I.add(L.route.id))}),I.size===0)return[];let R=HJ(t,c);return D&&I.size>0&&R.searchParams.set("_routes",e.filter(L=>I.has(L.route.id)).map(L=>L.route.id).join(",")),[R.pathname+R.search]},[c,s,r,i,y,e,t,l]),S=G.useMemo(()=>BJ(_,i),[_,i]),M=XJ(_);return G.createElement(G.Fragment,null,w.map(I=>G.createElement("link",{key:I,rel:"prefetch",as:"fetch",href:I,...n})),S.map(I=>G.createElement("link",{key:I,rel:"modulepreload",href:I,...n})),M.map(({key:I,link:D})=>G.createElement("link",{key:I,...D})))}function YJ(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var KF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{KF&&(window.__reactRouterVersion="7.6.3")}catch{}function KJ(t,e){return BK({basename:e?.basename,unstable_getContext:e?.unstable_getContext,future:e?.future,history:sK({window:e?.window}),hydrationData:JJ(),routes:t,mapRouteProperties:_J,hydrationRouteProperties:xJ,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function JJ(){let t=window?.__staticRouterHydrationData;return t&&t.errors&&(t={...t,errors:QJ(t.errors)}),t}function QJ(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new zb(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let l=window[i.__subType];if(typeof l=="function")try{let c=new l(i.message);c.stack="",n[r]=c}catch{}}if(n[r]==null){let l=new Error(i.message);l.stack="",n[r]=l}}else n[r]=i;return n}var JF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,QF=G.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:l,replace:c,state:s,target:p,to:y,preventScrollReset:_,viewTransition:w,...S},M){let{basename:I}=G.useContext(Dh),D=typeof y=="string"&&JF.test(y),R,L=!1;if(typeof y=="string"&&D&&(R=y,KF))try{let J=new URL(window.location.href),$=y.startsWith("//")?new URL(J.protocol+y):new URL(y),le=Lc($.pathname,I);$.origin===J.origin&&le!=null?y=le+$.search+$.hash:L=!0}catch{zo(!1,`<Link to="${y}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let V=oJ(y,{relative:i}),[B,H,q]=WJ(r,S),X=rQ(y,{replace:c,state:s,target:p,preventScrollReset:_,relative:i,viewTransition:w});function ee(J){e&&e(J),J.defaultPrevented||X(J)}let se=G.createElement("a",{...S,...q,href:R||V,onClick:L||l?e:ee,ref:YJ(M,H),target:p,"data-discover":!D&&n==="render"?"true":void 0});return B&&!D?G.createElement(G.Fragment,null,se,G.createElement(qJ,{page:V})):se});QF.displayName="Link";var eQ=G.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:l,to:c,viewTransition:s,children:p,...y},_){let w=tx(c,{relative:y.relative}),S=yp(),M=G.useContext(Q_),{navigator:I,basename:D}=G.useContext(Dh),R=M!=null&&cQ(w)&&s===!0,L=I.encodeLocation?I.encodeLocation(w).pathname:w.pathname,V=S.pathname,B=M&&M.navigation&&M.navigation.location?M.navigation.location.pathname:null;n||(V=V.toLowerCase(),B=B?B.toLowerCase():null,L=L.toLowerCase()),B&&D&&(B=Lc(B,D)||B);const H=L!=="/"&&L.endsWith("/")?L.length-1:L.length;let q=V===L||!i&&V.startsWith(L)&&V.charAt(H)==="/",X=B!=null&&(B===L||!i&&B.startsWith(L)&&B.charAt(L.length)==="/"),ee={isActive:q,isPending:X,isTransitioning:R},se=q?e:void 0,J;typeof r=="function"?J=r(ee):J=[r,q?"active":null,X?"pending":null,R?"transitioning":null].filter(Boolean).join(" ");let $=typeof l=="function"?l(ee):l;return G.createElement(QF,{...y,"aria-current":se,className:J,ref:_,style:$,to:c,viewTransition:s},typeof p=="function"?p(ee):p)});eQ.displayName="NavLink";var tQ=G.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:l,method:c=ob,action:s,onSubmit:p,relative:y,preventScrollReset:_,viewTransition:w,...S},M)=>{let I=aQ(),D=lQ(s,{relative:y}),R=c.toLowerCase()==="get"?"get":"post",L=typeof s=="string"&&JF.test(s),V=B=>{if(p&&p(B),B.defaultPrevented)return;B.preventDefault();let H=B.nativeEvent.submitter,q=H?.getAttribute("formmethod")||c;I(H||B.currentTarget,{fetcherKey:e,method:q,navigate:n,replace:i,state:l,relative:y,preventScrollReset:_,viewTransition:w})};return G.createElement("form",{ref:M,method:R,action:D,onSubmit:r?p:V,...S,"data-discover":!L&&t==="render"?"true":void 0})});tQ.displayName="Form";function nQ(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function eN(t){let e=G.useContext(Qm);return Ur(e,nQ(t)),e}function rQ(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:l,viewTransition:c}={}){let s=qF(),p=yp(),y=tx(t,{relative:l});return G.useCallback(_=>{if(RJ(_,e)){_.preventDefault();let w=n!==void 0?n:op(p)===op(y);s(t,{replace:w,state:r,preventScrollReset:i,relative:l,viewTransition:c})}},[p,s,y,n,r,e,t,i,l,c])}function iQ(t){zo(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=G.useRef(JE(t)),n=G.useRef(!1),r=yp(),i=G.useMemo(()=>LJ(r.search,n.current?null:e.current),[r.search]),l=qF(),c=G.useCallback((s,p)=>{const y=JE(typeof s=="function"?s(i):s);n.current=!0,l("?"+y,p)},[l,i]);return[i,c]}var oQ=0,sQ=()=>`__${String(++oQ)}__`;function aQ(){let{router:t}=eN("useSubmit"),{basename:e}=G.useContext(Dh),n=gJ();return G.useCallback(async(r,i={})=>{let{action:l,method:c,encType:s,formData:p,body:y}=zJ(r,e);if(i.navigate===!1){let _=i.fetcherKey||sQ();await t.fetch(_,n,i.action||l,{preventScrollReset:i.preventScrollReset,formData:p,body:y,formMethod:i.method||c,formEncType:i.encType||s,flushSync:i.flushSync})}else await t.navigate(i.action||l,{preventScrollReset:i.preventScrollReset,formData:p,body:y,formMethod:i.method||c,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function lQ(t,{relative:e}={}){let{basename:n}=G.useContext(Dh),r=G.useContext(Jd);Ur(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),l={...tx(t||".",{relative:e})},c=yp();if(t==null){l.search=c.search;let s=new URLSearchParams(l.search),p=s.getAll("index");if(p.some(_=>_==="")){s.delete("index"),p.filter(w=>w).forEach(w=>s.append("index",w));let _=s.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&i.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Eh([n,l.pathname])),op(l)}function cQ(t,e={}){let n=G.useContext(dA);Ur(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=eN("useViewTransitionState"),i=tx(t,{relative:e.relative});if(!n.isTransitioning)return!1;let l=Lc(n.currentLocation.pathname,r)||n.currentLocation.pathname,c=Lc(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Db(i.pathname,c)!=null||Db(i.pathname,l)!=null}[...jJ];/**
 * react-router v7.6.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function uQ(t){return G.createElement(wJ,{flushSync:Fw.flushSync,...t})}const sL=t=>t,hQ=()=>{let t=sL;return{configure(e){t=e},generate(e){return t(e)},reset(){t=sL}}},dQ=hQ();function Vm(t,...e){const n=new URL(`https://mui.com/production-error/?code=${t}`);return e.forEach(r=>n.searchParams.append("args[]",r)),`Minified MUI error #${t}; visit ${n} for the full message.`}function ey(t){if(typeof t!="string")throw new Error(Vm(7));return t.charAt(0).toUpperCase()+t.slice(1)}function fQ(t,e,n=void 0){const r={};for(const i in t){const l=t[i];let c="",s=!0;for(let p=0;p<l.length;p+=1){const y=l[p];y&&(c+=(s===!0?"":" ")+e(y),s=!1,n&&n[y]&&(c+=" "+n[y]))}r[i]=c}return r}var b2={exports:{}},Ri={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aL;function pQ(){if(aL)return Ri;aL=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),S=Symbol.for("react.view_transition"),M=Symbol.for("react.client.reference");function I(D){if(typeof D=="object"&&D!==null){var R=D.$$typeof;switch(R){case t:switch(D=D.type,D){case n:case i:case r:case p:case y:case S:return D;default:switch(D=D&&D.$$typeof,D){case c:case s:case w:case _:return D;case l:return D;default:return R}}case e:return R}}}return Ri.ContextConsumer=l,Ri.ContextProvider=c,Ri.Element=t,Ri.ForwardRef=s,Ri.Fragment=n,Ri.Lazy=w,Ri.Memo=_,Ri.Portal=e,Ri.Profiler=i,Ri.StrictMode=r,Ri.Suspense=p,Ri.SuspenseList=y,Ri.isContextConsumer=function(D){return I(D)===l},Ri.isContextProvider=function(D){return I(D)===c},Ri.isElement=function(D){return typeof D=="object"&&D!==null&&D.$$typeof===t},Ri.isForwardRef=function(D){return I(D)===s},Ri.isFragment=function(D){return I(D)===n},Ri.isLazy=function(D){return I(D)===w},Ri.isMemo=function(D){return I(D)===_},Ri.isPortal=function(D){return I(D)===e},Ri.isProfiler=function(D){return I(D)===i},Ri.isStrictMode=function(D){return I(D)===r},Ri.isSuspense=function(D){return I(D)===p},Ri.isSuspenseList=function(D){return I(D)===y},Ri.isValidElementType=function(D){return typeof D=="string"||typeof D=="function"||D===n||D===i||D===r||D===p||D===y||typeof D=="object"&&D!==null&&(D.$$typeof===w||D.$$typeof===_||D.$$typeof===c||D.$$typeof===l||D.$$typeof===s||D.$$typeof===M||D.getModuleId!==void 0)},Ri.typeOf=I,Ri}var lL;function mQ(){return lL||(lL=1,b2.exports=pQ()),b2.exports}var tN=mQ();function Nd(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function nN(t){if(G.isValidElement(t)||tN.isValidElementType(t)||!Nd(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=nN(t[n])}),e}function Wl(t,e,n={clone:!0}){const r=n.clone?{...t}:t;return Nd(t)&&Nd(e)&&Object.keys(e).forEach(i=>{G.isValidElement(e[i])||tN.isValidElementType(e[i])?r[i]=e[i]:Nd(e[i])&&Object.prototype.hasOwnProperty.call(t,i)&&Nd(t[i])?r[i]=Wl(t[i],e[i],n):n.clone?r[i]=Nd(e[i])?nN(e[i]):e[i]:r[i]=e[i]}),r}function H0(t,e){return e?Wl(t,e,{clone:!1}):t}function cL(t,e){if(!t.containerQueries)return e;const n=Object.keys(e).filter(r=>r.startsWith("@container")).sort((r,i)=>{const l=/min-width:\s*([0-9.]+)/;return+(r.match(l)?.[1]||0)-+(i.match(l)?.[1]||0)});return n.length?n.reduce((r,i)=>{const l=e[i];return delete r[i],r[i]=l,r},{...e}):e}function gQ(t,e){return e==="@"||e.startsWith("@")&&(t.some(n=>e.startsWith(`@${n}`))||!!e.match(/^@\d/))}function vQ(t,e){const n=e.match(/^@([^/]+)?\/?(.+)?$/);if(!n)return null;const[,r,i]=n,l=Number.isNaN(+r)?r||0:+r;return t.containerQueries(i).up(l)}function yQ(t){const e=(l,c)=>l.replace("@media",c?`@container ${c}`:"@container");function n(l,c){l.up=(...s)=>e(t.breakpoints.up(...s),c),l.down=(...s)=>e(t.breakpoints.down(...s),c),l.between=(...s)=>e(t.breakpoints.between(...s),c),l.only=(...s)=>e(t.breakpoints.only(...s),c),l.not=(...s)=>{const p=e(t.breakpoints.not(...s),c);return p.includes("not all and")?p.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):p}}const r={},i=l=>(n(r,l),r);return n(i),{...t,containerQueries:i}}const Kw={xs:0,sm:600,md:900,lg:1200,xl:1536},uL={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${Kw[t]}px)`},_Q={containerQueries:t=>({up:e=>{let n=typeof e=="number"?e:Kw[e]||e;return typeof n=="number"&&(n=`${n}px`),t?`@container ${t} (min-width:${n})`:`@container (min-width:${n})`}})};function qd(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const l=r.breakpoints||uL;return e.reduce((c,s,p)=>(c[l.up(l.keys[p])]=n(e[p]),c),{})}if(typeof e=="object"){const l=r.breakpoints||uL;return Object.keys(e).reduce((c,s)=>{if(gQ(l.keys,s)){const p=vQ(r.containerQueries?r:_Q,s);p&&(c[p]=n(e[s],s))}else if(Object.keys(l.values||Kw).includes(s)){const p=l.up(s);c[p]=n(e[s],s)}else{const p=s;c[p]=e[p]}return c},{})}return n(e)}function xQ(t={}){return t.keys?.reduce((n,r)=>{const i=t.up(r);return n[i]={},n},{})||{}}function hL(t,e){return t.reduce((n,r)=>{const i=n[r];return(!i||Object.keys(i).length===0)&&delete n[r],n},e)}function Jw(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((i,l)=>i&&i[l]?i[l]:null,t);if(r!=null)return r}return e.split(".").reduce((r,i)=>r&&r[i]!=null?r[i]:null,t)}function Fb(t,e,n,r=n){let i;return typeof t=="function"?i=t(n):Array.isArray(t)?i=t[n]||r:i=Jw(t,n)||r,e&&(i=e(i,r,t)),i}function Fo(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:i}=t,l=c=>{if(c[e]==null)return null;const s=c[e],p=c.theme,y=Jw(p,r)||{};return qd(c,s,w=>{let S=Fb(y,i,w);return w===S&&typeof w=="string"&&(S=Fb(y,i,`${e}${w==="default"?"":ey(w)}`,w)),n===!1?S:{[n]:S}})};return l.propTypes={},l.filterProps=[e],l}function bQ(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const wQ={m:"margin",p:"padding"},SQ={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},dL={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},MQ=bQ(t=>{if(t.length>2)if(dL[t])t=dL[t];else return[t];const[e,n]=t.split(""),r=wQ[e],i=SQ[n]||"";return Array.isArray(i)?i.map(l=>r+l):[r+i]}),yA=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],_A=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...yA,..._A];function nx(t,e,n,r){const i=Jw(t,e,!0)??n;return typeof i=="number"||typeof i=="string"?l=>typeof l=="string"?l:typeof i=="string"?i.startsWith("var(")&&l===0?0:i.startsWith("var(")&&l===1?i:`calc(${l} * ${i})`:i*l:Array.isArray(i)?l=>{if(typeof l=="string")return l;const c=Math.abs(l),s=i[c];return l>=0?s:typeof s=="number"?-s:typeof s=="string"&&s.startsWith("var(")?`calc(-1 * ${s})`:`-${s}`}:typeof i=="function"?i:()=>{}}function xA(t){return nx(t,"spacing",8)}function rx(t,e){return typeof e=="string"||e==null?e:t(e)}function CQ(t,e){return n=>t.reduce((r,i)=>(r[i]=rx(e,n),r),{})}function EQ(t,e,n,r){if(!e.includes(n))return null;const i=MQ(n),l=CQ(i,r),c=t[n];return qd(t,c,l)}function rN(t,e){const n=xA(t.theme);return Object.keys(t).map(r=>EQ(t,e,r,n)).reduce(H0,{})}function So(t){return rN(t,yA)}So.propTypes={};So.filterProps=yA;function Mo(t){return rN(t,_A)}Mo.propTypes={};Mo.filterProps=_A;function Qw(...t){const e=t.reduce((r,i)=>(i.filterProps.forEach(l=>{r[l]=i}),r),{}),n=r=>Object.keys(r).reduce((i,l)=>e[l]?H0(i,e[l](r)):i,{});return n.propTypes={},n.filterProps=t.reduce((r,i)=>r.concat(i.filterProps),[]),n}function Pc(t){return typeof t!="number"?t:`${t}px solid`}function Dc(t,e){return Fo({prop:t,themeKey:"borders",transform:e})}const TQ=Dc("border",Pc),PQ=Dc("borderTop",Pc),AQ=Dc("borderRight",Pc),IQ=Dc("borderBottom",Pc),RQ=Dc("borderLeft",Pc),LQ=Dc("borderColor"),kQ=Dc("borderTopColor"),DQ=Dc("borderRightColor"),zQ=Dc("borderBottomColor"),OQ=Dc("borderLeftColor"),FQ=Dc("outline",Pc),NQ=Dc("outlineColor"),eS=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=nx(t.theme,"shape.borderRadius",4),n=r=>({borderRadius:rx(e,r)});return qd(t,t.borderRadius,n)}return null};eS.propTypes={};eS.filterProps=["borderRadius"];Qw(TQ,PQ,AQ,IQ,RQ,LQ,kQ,DQ,zQ,OQ,eS,FQ,NQ);const tS=t=>{if(t.gap!==void 0&&t.gap!==null){const e=nx(t.theme,"spacing",8),n=r=>({gap:rx(e,r)});return qd(t,t.gap,n)}return null};tS.propTypes={};tS.filterProps=["gap"];const nS=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=nx(t.theme,"spacing",8),n=r=>({columnGap:rx(e,r)});return qd(t,t.columnGap,n)}return null};nS.propTypes={};nS.filterProps=["columnGap"];const rS=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=nx(t.theme,"spacing",8),n=r=>({rowGap:rx(e,r)});return qd(t,t.rowGap,n)}return null};rS.propTypes={};rS.filterProps=["rowGap"];const BQ=Fo({prop:"gridColumn"}),UQ=Fo({prop:"gridRow"}),$Q=Fo({prop:"gridAutoFlow"}),VQ=Fo({prop:"gridAutoColumns"}),jQ=Fo({prop:"gridAutoRows"}),HQ=Fo({prop:"gridTemplateColumns"}),GQ=Fo({prop:"gridTemplateRows"}),WQ=Fo({prop:"gridTemplateAreas"}),qQ=Fo({prop:"gridArea"});Qw(tS,nS,rS,BQ,UQ,$Q,VQ,jQ,HQ,GQ,WQ,qQ);function $v(t,e){return e==="grey"?e:t}const XQ=Fo({prop:"color",themeKey:"palette",transform:$v}),ZQ=Fo({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:$v}),YQ=Fo({prop:"backgroundColor",themeKey:"palette",transform:$v});Qw(XQ,ZQ,YQ);function Ul(t){return t<=1&&t!==0?`${t*100}%`:t}const KQ=Fo({prop:"width",transform:Ul}),bA=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{const r=t.theme?.breakpoints?.values?.[n]||Kw[n];return r?t.theme?.breakpoints?.unit!=="px"?{maxWidth:`${r}${t.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:Ul(n)}};return qd(t,t.maxWidth,e)}return null};bA.filterProps=["maxWidth"];const JQ=Fo({prop:"minWidth",transform:Ul}),QQ=Fo({prop:"height",transform:Ul}),eee=Fo({prop:"maxHeight",transform:Ul}),tee=Fo({prop:"minHeight",transform:Ul});Fo({prop:"size",cssProperty:"width",transform:Ul});Fo({prop:"size",cssProperty:"height",transform:Ul});const nee=Fo({prop:"boxSizing"});Qw(KQ,bA,JQ,QQ,eee,tee,nee);const iS={border:{themeKey:"borders",transform:Pc},borderTop:{themeKey:"borders",transform:Pc},borderRight:{themeKey:"borders",transform:Pc},borderBottom:{themeKey:"borders",transform:Pc},borderLeft:{themeKey:"borders",transform:Pc},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Pc},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:eS},color:{themeKey:"palette",transform:$v},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:$v},backgroundColor:{themeKey:"palette",transform:$v},p:{style:Mo},pt:{style:Mo},pr:{style:Mo},pb:{style:Mo},pl:{style:Mo},px:{style:Mo},py:{style:Mo},padding:{style:Mo},paddingTop:{style:Mo},paddingRight:{style:Mo},paddingBottom:{style:Mo},paddingLeft:{style:Mo},paddingX:{style:Mo},paddingY:{style:Mo},paddingInline:{style:Mo},paddingInlineStart:{style:Mo},paddingInlineEnd:{style:Mo},paddingBlock:{style:Mo},paddingBlockStart:{style:Mo},paddingBlockEnd:{style:Mo},m:{style:So},mt:{style:So},mr:{style:So},mb:{style:So},ml:{style:So},mx:{style:So},my:{style:So},margin:{style:So},marginTop:{style:So},marginRight:{style:So},marginBottom:{style:So},marginLeft:{style:So},marginX:{style:So},marginY:{style:So},marginInline:{style:So},marginInlineStart:{style:So},marginInlineEnd:{style:So},marginBlock:{style:So},marginBlockStart:{style:So},marginBlockEnd:{style:So},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:tS},rowGap:{style:rS},columnGap:{style:nS},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ul},maxWidth:{style:bA},minWidth:{transform:Ul},height:{transform:Ul},maxHeight:{transform:Ul},minHeight:{transform:Ul},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function ree(...t){const e=t.reduce((r,i)=>r.concat(Object.keys(i)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function iee(t,e){return typeof t=="function"?t(e):t}function oee(){function t(n,r,i,l){const c={[n]:r,theme:i},s=l[n];if(!s)return{[n]:r};const{cssProperty:p=n,themeKey:y,transform:_,style:w}=s;if(r==null)return null;if(y==="typography"&&r==="inherit")return{[n]:r};const S=Jw(i,y)||{};return w?w(c):qd(c,r,I=>{let D=Fb(S,_,I);return I===D&&typeof I=="string"&&(D=Fb(S,_,`${n}${I==="default"?"":ey(I)}`,I)),p===!1?D:{[p]:D}})}function e(n){const{sx:r,theme:i={},nested:l}=n||{};if(!r)return null;const c=i.unstable_sxConfig??iS;function s(p){let y=p;if(typeof p=="function")y=p(i);else if(typeof p!="object")return p;if(!y)return null;const _=xQ(i.breakpoints),w=Object.keys(_);let S=_;return Object.keys(y).forEach(M=>{const I=iee(y[M],i);if(I!=null)if(typeof I=="object")if(c[M])S=H0(S,t(M,I,i,c));else{const D=qd({theme:i},I,R=>({[M]:R}));ree(D,I)?S[M]=e({sx:I,theme:i,nested:!0}):S=H0(S,D)}else S=H0(S,t(M,I,i,c))}),!l&&i.modularCssLayers?{"@layer sx":cL(i,hL(w,S))}:cL(i,hL(w,S))}return Array.isArray(r)?r.map(s):s(r)}return e}const ty=oee();ty.filterProps=["sx"];function see(t,e){return Cb(t,e)}function aee(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const fL=[];function Nm(t){return fL[0]=t,N_(fL)}const lee=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>({...n,[r.key]:r.val}),{})};function cee(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...i}=t,l=lee(e),c=Object.keys(l);function s(S){return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${n})`}function p(S){return`@media (max-width:${(typeof e[S]=="number"?e[S]:S)-r/100}${n})`}function y(S,M){const I=c.indexOf(M);return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${n}) and (max-width:${(I!==-1&&typeof e[c[I]]=="number"?e[c[I]]:M)-r/100}${n})`}function _(S){return c.indexOf(S)+1<c.length?y(S,c[c.indexOf(S)+1]):s(S)}function w(S){const M=c.indexOf(S);return M===0?s(c[1]):M===c.length-1?p(c[M]):y(S,c[c.indexOf(S)+1]).replace("@media","@media not all and")}return{keys:c,values:l,up:s,down:p,between:y,only:_,not:w,unit:n,...i}}const uee={borderRadius:4};function iN(t=8,e=xA({spacing:t})){if(t.mui)return t;const n=(...r)=>(r.length===0?[1]:r).map(l=>{const c=e(l);return typeof c=="number"?`${c}px`:c}).join(" ");return n.mui=!0,n}function hee(t,e){const n=this;if(n.vars){if(!n.colorSchemes?.[t]||typeof n.getColorSchemeSelector!="function")return{};let r=n.getColorSchemeSelector(t);return r==="&"?e:((r.includes("data-")||r.includes("."))&&(r=`*:where(${r.replace(/\s*&$/,"")}) &`),{[r]:e})}return n.palette.mode===t?e:{}}function oN(t={},...e){const{breakpoints:n={},palette:r={},spacing:i,shape:l={},...c}=t,s=cee(n),p=iN(i);let y=Wl({breakpoints:s,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:p,shape:{...uee,...l}},c);return y=yQ(y),y.applyStyles=hee,y=e.reduce((_,w)=>Wl(_,w),y),y.unstable_sxConfig={...iS,...c?.unstable_sxConfig},y.unstable_sx=function(w){return ty({sx:w,theme:this})},y}const dee={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function sN(t,e,n="Mui"){const r=dee[e];return r?`${n}-${r}`:`${dQ.generate(t)}-${e}`}function fee(t,e,n="Mui"){const r={};return e.forEach(i=>{r[i]=sN(t,i,n)}),r}function aN(t){const{variants:e,...n}=t,r={variants:e,style:Nm(n),isProcessed:!0};return r.style===n||e&&e.forEach(i=>{typeof i.style!="function"&&(i.style=Nm(i.style))}),r}const pee=oN();function w2(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function Dm(t,e){return e&&t&&typeof t=="object"&&t.styles&&!t.styles.startsWith("@layer")&&(t.styles=`@layer ${e}{${String(t.styles)}}`),t}function mee(t){return t?(e,n)=>n[t]:null}function gee(t,e,n){t.theme=_ee(t.theme)?n:t.theme[e]||t.theme}function ab(t,e,n){const r=typeof e=="function"?e(t):e;if(Array.isArray(r))return r.flatMap(i=>ab(t,i,n));if(Array.isArray(r?.variants)){let i;if(r.isProcessed)i=n?Dm(r.style,n):r.style;else{const{variants:l,...c}=r;i=n?Dm(Nm(c),n):c}return lN(t,r.variants,[i],n)}return r?.isProcessed?n?Dm(Nm(r.style),n):r.style:n?Dm(Nm(r),n):r}function lN(t,e,n=[],r=void 0){let i;e:for(let l=0;l<e.length;l+=1){const c=e[l];if(typeof c.props=="function"){if(i??={...t,...t.ownerState,ownerState:t.ownerState},!c.props(i))continue}else for(const s in c.props)if(t[s]!==c.props[s]&&t.ownerState?.[s]!==c.props[s])continue e;typeof c.style=="function"?(i??={...t,...t.ownerState,ownerState:t.ownerState},n.push(r?Dm(Nm(c.style(i)),r):c.style(i))):n.push(r?Dm(Nm(c.style),r):c.style)}return n}function vee(t={}){const{themeId:e,defaultTheme:n=pee,rootShouldForwardProp:r=w2,slotShouldForwardProp:i=w2}=t;function l(s){gee(s,e,n)}return(s,p={})=>{aee(s,X=>X.filter(ee=>ee!==ty));const{name:y,slot:_,skipVariantsResolver:w,skipSx:S,overridesResolver:M=mee(bee(_)),...I}=p,D=y&&y.startsWith("Mui")||_?"components":"custom",R=w!==void 0?w:_&&_!=="Root"&&_!=="root"||!1,L=S||!1;let V=w2;_==="Root"||_==="root"?V=r:_?V=i:xee(s)&&(V=void 0);const B=see(s,{shouldForwardProp:V,label:yee(),...I}),H=X=>{if(X.__emotion_real===X)return X;if(typeof X=="function")return function(se){return ab(se,X,se.theme.modularCssLayers?D:void 0)};if(Nd(X)){const ee=aN(X);return function(J){return ee.variants?ab(J,ee,J.theme.modularCssLayers?D:void 0):J.theme.modularCssLayers?Dm(ee.style,D):ee.style}}return X},q=(...X)=>{const ee=[],se=X.map(H),J=[];if(ee.push(l),y&&M&&J.push(function(we){const Fe=we.theme.components?.[y]?.styleOverrides;if(!Fe)return null;const Me={};for(const Ee in Fe)Me[Ee]=ab(we,Fe[Ee],we.theme.modularCssLayers?"theme":void 0);return M(we,Me)}),y&&!R&&J.push(function(we){const Fe=we.theme?.components?.[y]?.variants;return Fe?lN(we,Fe,[],we.theme.modularCssLayers?"theme":void 0):null}),L||J.push(ty),Array.isArray(se[0])){const Ce=se.shift(),we=new Array(ee.length).fill(""),We=new Array(J.length).fill("");let Fe;Fe=[...we,...Ce,...We],Fe.raw=[...we,...Ce.raw,...We],ee.unshift(Fe)}const $=[...ee,...se,...J],le=B(...$);return s.muiName&&(le.muiName=s.muiName),le};return B.withConfig&&(q.withConfig=B.withConfig),q}}function yee(t,e){return void 0}function _ee(t){for(const e in t)return!1;return!0}function xee(t){return typeof t=="string"&&t.charCodeAt(0)>96}function bee(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function QE(t,e,n=!1){const r={...e};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const l=i;if(l==="components"||l==="slots")r[l]={...t[l],...r[l]};else if(l==="componentsProps"||l==="slotProps"){const c=t[l],s=e[l];if(!s)r[l]=c||{};else if(!c)r[l]=s;else{r[l]={...s};for(const p in c)if(Object.prototype.hasOwnProperty.call(c,p)){const y=p;r[l][y]=QE(c[y],s[y],n)}}}else l==="className"&&n&&e.className?r.className=co(t?.className,e?.className):l==="style"&&n&&e.style?r.style={...t?.style,...e?.style}:r[l]===void 0&&(r[l]=t[l])}return r}function wee(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}function wA(t,e=0,n=1){return wee(t,e,n)}function See(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),n?`rgb${n.length===4?"a":""}(${n.map((r,i)=>i<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function sp(t){if(t.type)return t;if(t.charAt(0)==="#")return sp(See(t));const e=t.indexOf("("),n=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(Vm(9,t));let r=t.substring(e+1,t.length-1),i;if(n==="color"){if(r=r.split(" "),i=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(i))throw new Error(Vm(10,i))}else r=r.split(",");return r=r.map(l=>parseFloat(l)),{type:n,values:r,colorSpace:i}}const Mee=t=>{const e=sp(t);return e.values.slice(0,3).map((n,r)=>e.type.includes("hsl")&&r!==0?`${n}%`:n).join(" ")},R0=(t,e)=>{try{return Mee(t)}catch{return t}};function oS(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.includes("rgb")?r=r.map((i,l)=>l<3?parseInt(i,10):i):e.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.includes("color")?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function cN(t){t=sp(t);const{values:e}=t,n=e[0],r=e[1]/100,i=e[2]/100,l=r*Math.min(i,1-i),c=(y,_=(y+n/30)%12)=>i-l*Math.max(Math.min(_-3,9-_,1),-1);let s="rgb";const p=[Math.round(c(0)*255),Math.round(c(8)*255),Math.round(c(4)*255)];return t.type==="hsla"&&(s+="a",p.push(e[3])),oS({type:s,values:p})}function eT(t){t=sp(t);let e=t.type==="hsl"||t.type==="hsla"?sp(cN(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Cee(t,e){const n=eT(t),r=eT(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Eee(t,e){return t=sp(t),e=wA(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,oS(t)}function d1(t,e,n){try{return Eee(t,e)}catch{return t}}function SA(t,e){if(t=sp(t),e=wA(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]*=1-e;return oS(t)}function Oi(t,e,n){try{return SA(t,e)}catch{return t}}function MA(t,e){if(t=sp(t),e=wA(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return oS(t)}function Fi(t,e,n){try{return MA(t,e)}catch{return t}}function Tee(t,e=.15){return eT(t)>.5?SA(t,e):MA(t,e)}function f1(t,e,n){try{return Tee(t,e)}catch{return t}}const Pee=G.createContext(void 0);function Aee(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const i=e.components[n];return i.defaultProps?QE(i.defaultProps,r,e.components.mergeClassNameAndStyle):!i.styleOverrides&&!i.variants?QE(i,r,e.components.mergeClassNameAndStyle):r}function Iee({props:t,name:e}){const n=G.useContext(Pee);return Aee({props:t,name:e,theme:{components:n}})}const pL={theme:void 0};function Ree(t){let e,n;return function(i){let l=e;return(l===void 0||i.theme!==n)&&(pL.theme=i.theme,l=aN(t(pL)),e=l,n=i.theme),l}}function Lee(t=""){function e(...r){if(!r.length)return"";const i=r[0];return typeof i=="string"&&!i.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${i}${e(...r.slice(1))})`:`, ${i}`}return(r,...i)=>`var(--${t?`${t}-`:""}${r}${e(...i)})`}const mL=(t,e,n,r=[])=>{let i=t;e.forEach((l,c)=>{c===e.length-1?Array.isArray(i)?i[Number(l)]=n:i&&typeof i=="object"&&(i[l]=n):i&&typeof i=="object"&&(i[l]||(i[l]=r.includes(l)?[]:{}),i=i[l])})},kee=(t,e,n)=>{function r(i,l=[],c=[]){Object.entries(i).forEach(([s,p])=>{(!n||n&&!n([...l,s]))&&p!=null&&(typeof p=="object"&&Object.keys(p).length>0?r(p,[...l,s],Array.isArray(p)?[...c,s]:c):e([...l,s],p,c))})}r(t)},Dee=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>t.includes(r))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function S2(t,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},i={},l={},c={};return kee(t,(s,p,y)=>{if((typeof p=="string"||typeof p=="number")&&(!r||!r(s,p))){const _=`--${n?`${n}-`:""}${s.join("-")}`,w=Dee(s,p);Object.assign(i,{[_]:w}),mL(l,s,`var(${_})`,y),mL(c,s,`var(${_}, ${w})`,y)}},s=>s[0]==="vars"),{css:i,vars:l,varsWithDefaults:c}}function zee(t,e={}){const{getSelector:n=R,disableCssColorScheme:r,colorSchemeSelector:i}=e,{colorSchemes:l={},components:c,defaultColorScheme:s="light",...p}=t,{vars:y,css:_,varsWithDefaults:w}=S2(p,e);let S=w;const M={},{[s]:I,...D}=l;if(Object.entries(D||{}).forEach(([B,H])=>{const{vars:q,css:X,varsWithDefaults:ee}=S2(H,e);S=Wl(S,ee),M[B]={css:X,vars:q}}),I){const{css:B,vars:H,varsWithDefaults:q}=S2(I,e);S=Wl(S,q),M[s]={css:B,vars:H}}function R(B,H){let q=i;if(i==="class"&&(q=".%s"),i==="data"&&(q="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(q=`[${i}="%s"]`),B){if(q==="media")return t.defaultColorScheme===B?":root":{[`@media (prefers-color-scheme: ${l[B]?.palette?.mode||B})`]:{":root":H}};if(q)return t.defaultColorScheme===B?`:root, ${q.replace("%s",String(B))}`:q.replace("%s",String(B))}return":root"}return{vars:S,generateThemeVars:()=>{let B={...y};return Object.entries(M).forEach(([,{vars:H}])=>{B=Wl(B,H)}),B},generateStyleSheets:()=>{const B=[],H=t.defaultColorScheme||"light";function q(se,J){Object.keys(J).length&&B.push(typeof se=="string"?{[se]:{...J}}:se)}q(n(void 0,{..._}),_);const{[H]:X,...ee}=M;if(X){const{css:se}=X,J=l[H]?.palette?.mode,$=!r&&J?{colorScheme:J,...se}:{...se};q(n(H,{...$}),$)}return Object.entries(ee).forEach(([se,{css:J}])=>{const $=l[se]?.palette?.mode,le=!r&&$?{colorScheme:$,...J}:{...J};q(n(se,{...le}),le)}),B}}}function Oee(t){return function(n){return t==="media"?`@media (prefers-color-scheme: ${n})`:t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${n}"] &`:t==="class"?`.${n} &`:t==="data"?`[data-${n}] &`:`${t.replace("%s",n)} &`:"&"}}const M_={black:"#000",white:"#fff"},Fee={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Zg={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Yg={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},p0={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Kg={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Jg={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},Qg={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function uN(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:M_.white,default:M_.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const Nee=uN();function hN(){return{text:{primary:M_.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:M_.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const gL=hN();function vL(t,e,n,r){const i=r.light||r,l=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=MA(t.main,i):e==="dark"&&(t.dark=SA(t.main,l)))}function Bee(t="light"){return t==="dark"?{main:Kg[200],light:Kg[50],dark:Kg[400]}:{main:Kg[700],light:Kg[400],dark:Kg[800]}}function Uee(t="light"){return t==="dark"?{main:Zg[200],light:Zg[50],dark:Zg[400]}:{main:Zg[500],light:Zg[300],dark:Zg[700]}}function $ee(t="light"){return t==="dark"?{main:Yg[500],light:Yg[300],dark:Yg[700]}:{main:Yg[700],light:Yg[400],dark:Yg[800]}}function Vee(t="light"){return t==="dark"?{main:Jg[400],light:Jg[300],dark:Jg[700]}:{main:Jg[700],light:Jg[500],dark:Jg[900]}}function jee(t="light"){return t==="dark"?{main:Qg[400],light:Qg[300],dark:Qg[700]}:{main:Qg[800],light:Qg[500],dark:Qg[900]}}function Hee(t="light"){return t==="dark"?{main:p0[400],light:p0[300],dark:p0[700]}:{main:"#ed6c02",light:p0[500],dark:p0[900]}}function CA(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2,...i}=t,l=t.primary||Bee(e),c=t.secondary||Uee(e),s=t.error||$ee(e),p=t.info||Vee(e),y=t.success||jee(e),_=t.warning||Hee(e);function w(D){return Cee(D,gL.text.primary)>=n?gL.text.primary:Nee.text.primary}const S=({color:D,name:R,mainShade:L=500,lightShade:V=300,darkShade:B=700})=>{if(D={...D},!D.main&&D[L]&&(D.main=D[L]),!D.hasOwnProperty("main"))throw new Error(Vm(11,R?` (${R})`:"",L));if(typeof D.main!="string")throw new Error(Vm(12,R?` (${R})`:"",JSON.stringify(D.main)));return vL(D,"light",V,r),vL(D,"dark",B,r),D.contrastText||(D.contrastText=w(D.main)),D};let M;return e==="light"?M=uN():e==="dark"&&(M=hN()),Wl({common:{...M_},mode:e,primary:S({color:l,name:"primary"}),secondary:S({color:c,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:S({color:s,name:"error"}),warning:S({color:_,name:"warning"}),info:S({color:p,name:"info"}),success:S({color:y,name:"success"}),grey:Fee,contrastThreshold:n,getContrastText:w,augmentColor:S,tonalOffset:r,...M},i)}function Gee(t){const e={};return Object.entries(t).forEach(r=>{const[i,l]=r;typeof l=="object"&&(e[i]=`${l.fontStyle?`${l.fontStyle} `:""}${l.fontVariant?`${l.fontVariant} `:""}${l.fontWeight?`${l.fontWeight} `:""}${l.fontStretch?`${l.fontStretch} `:""}${l.fontSize||""}${l.lineHeight?`/${l.lineHeight} `:""}${l.fontFamily||""}`)}),e}function Wee(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function qee(t){return Math.round(t*1e5)/1e5}const yL={textTransform:"uppercase"},_L='"Roboto", "Helvetica", "Arial", sans-serif';function Xee(t,e){const{fontFamily:n=_L,fontSize:r=14,fontWeightLight:i=300,fontWeightRegular:l=400,fontWeightMedium:c=500,fontWeightBold:s=700,htmlFontSize:p=16,allVariants:y,pxToRem:_,...w}=typeof e=="function"?e(t):e,S=r/14,M=_||(R=>`${R/p*S}rem`),I=(R,L,V,B,H)=>({fontFamily:n,fontWeight:R,fontSize:M(L),lineHeight:V,...n===_L?{letterSpacing:`${qee(B/L)}em`}:{},...H,...y}),D={h1:I(i,96,1.167,-1.5),h2:I(i,60,1.2,-.5),h3:I(l,48,1.167,0),h4:I(l,34,1.235,.25),h5:I(l,24,1.334,0),h6:I(c,20,1.6,.15),subtitle1:I(l,16,1.75,.15),subtitle2:I(c,14,1.57,.1),body1:I(l,16,1.5,.15),body2:I(l,14,1.43,.15),button:I(c,14,1.75,.4,yL),caption:I(l,12,1.66,.4),overline:I(l,12,2.66,1,yL),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Wl({htmlFontSize:p,pxToRem:M,fontFamily:n,fontSize:r,fontWeightLight:i,fontWeightRegular:l,fontWeightMedium:c,fontWeightBold:s,...D},w,{clone:!1})}const Zee=.2,Yee=.14,Kee=.12;function no(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Zee})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Yee})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Kee})`].join(",")}const Jee=["none",no(0,2,1,-1,0,1,1,0,0,1,3,0),no(0,3,1,-2,0,2,2,0,0,1,5,0),no(0,3,3,-2,0,3,4,0,0,1,8,0),no(0,2,4,-1,0,4,5,0,0,1,10,0),no(0,3,5,-1,0,5,8,0,0,1,14,0),no(0,3,5,-1,0,6,10,0,0,1,18,0),no(0,4,5,-2,0,7,10,1,0,2,16,1),no(0,5,5,-3,0,8,10,1,0,3,14,2),no(0,5,6,-3,0,9,12,1,0,3,16,2),no(0,6,6,-3,0,10,14,1,0,4,18,3),no(0,6,7,-4,0,11,15,1,0,4,20,3),no(0,7,8,-4,0,12,17,2,0,5,22,4),no(0,7,8,-4,0,13,19,2,0,5,24,4),no(0,7,9,-4,0,14,21,2,0,5,26,4),no(0,8,9,-5,0,15,22,2,0,6,28,5),no(0,8,10,-5,0,16,24,2,0,6,30,5),no(0,8,11,-5,0,17,26,2,0,6,32,5),no(0,9,11,-5,0,18,28,2,0,7,34,6),no(0,9,12,-6,0,19,29,2,0,7,36,6),no(0,10,13,-6,0,20,31,3,0,8,38,7),no(0,10,13,-6,0,21,33,3,0,8,40,7),no(0,10,14,-6,0,22,35,3,0,8,42,7),no(0,11,14,-7,0,23,36,3,0,9,44,8),no(0,11,15,-7,0,24,38,3,0,9,46,8)],Qee={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},ete={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function xL(t){return`${Math.round(t)}ms`}function tte(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function nte(t){const e={...Qee,...t.easing},n={...ete,...t.duration};return{getAutoHeightDuration:tte,create:(i=["all"],l={})=>{const{duration:c=n.standard,easing:s=e.easeInOut,delay:p=0,...y}=l;return(Array.isArray(i)?i:[i]).map(_=>`${_} ${typeof c=="string"?c:xL(c)} ${s} ${typeof p=="string"?p:xL(p)}`).join(",")},...t,easing:e,duration:n}}const rte={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function ite(t){return Nd(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function dN(t={}){const e={...t};function n(r){const i=Object.entries(r);for(let l=0;l<i.length;l++){const[c,s]=i[l];!ite(s)||c.startsWith("unstable_")?delete r[c]:Nd(s)&&(r[c]={...s},n(r[c]))}}return n(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function tT(t={},...e){const{breakpoints:n,mixins:r={},spacing:i,palette:l={},transitions:c={},typography:s={},shape:p,...y}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error(Vm(20));const _=CA(l),w=oN(t);let S=Wl(w,{mixins:Wee(w.breakpoints,r),palette:_,shadows:Jee.slice(),typography:Xee(_,s),transitions:nte(c),zIndex:{...rte}});return S=Wl(S,y),S=e.reduce((M,I)=>Wl(M,I),S),S.unstable_sxConfig={...iS,...y?.unstable_sxConfig},S.unstable_sx=function(I){return ty({sx:I,theme:this})},S.toRuntimeSource=dN,S}function ote(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const ste=[...Array(25)].map((t,e)=>{if(e===0)return"none";const n=ote(e);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function fN(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function pN(t){return t==="dark"?ste:[]}function ate(t){const{palette:e={mode:"light"},opacity:n,overlays:r,...i}=t,l=CA(e);return{palette:l,opacity:{...fN(l.mode),...n},overlays:r||pN(l.mode),...i}}function lte(t){return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!t[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const cte=t=>[...[...Array(25)].map((e,n)=>`--${t?`${t}-`:""}overlays-${n}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],ute=t=>(e,n)=>{const r=t.rootSelector||":root",i=t.colorSchemeSelector;let l=i;if(i==="class"&&(l=".%s"),i==="data"&&(l="[data-%s]"),i?.startsWith("data-")&&!i.includes("%s")&&(l=`[${i}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const c={};return cte(t.cssVarPrefix).forEach(s=>{c[s]=n[s],delete n[s]}),l==="media"?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:c}}:l?{[l.replace("%s",e)]:c,[`${r}, ${l.replace("%s",e)}`]:n}:{[r]:{...n,...c}}}if(l&&l!=="media")return`${r}, ${l.replace("%s",String(e))}`}else if(e){if(l==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[r]:n}};if(l)return l.replace("%s",String(e))}return r};function hte(t,e){e.forEach(n=>{t[n]||(t[n]={})})}function en(t,e,n){!t[e]&&n&&(t[e]=n)}function L0(t){return typeof t!="string"||!t.startsWith("hsl")?t:cN(t)}function Ad(t,e){`${e}Channel`in t||(t[`${e}Channel`]=R0(L0(t[e])))}function dte(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const hh=t=>{try{return t()}catch{}},fte=(t="mui")=>Lee(t);function M2(t,e,n,r){if(!e)return;e=e===!0?{}:e;const i=r==="dark"?"dark":"light";if(!n){t[r]=ate({...e,palette:{mode:i,...e?.palette}});return}const{palette:l,...c}=tT({...n,palette:{mode:i,...e?.palette}});return t[r]={...e,palette:l,opacity:{...fN(i),...e?.opacity},overlays:e?.overlays||pN(i)},c}function pte(t={},...e){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:i=!1,cssVarPrefix:l="mui",shouldSkipGeneratingVar:c=lte,colorSchemeSelector:s=n.light&&n.dark?"media":void 0,rootSelector:p=":root",...y}=t,_=Object.keys(n)[0],w=r||(n.light&&_!=="light"?"light":_),S=fte(l),{[w]:M,light:I,dark:D,...R}=n,L={...R};let V=M;if((w==="dark"&&!("dark"in n)||w==="light"&&!("light"in n))&&(V=!0),!V)throw new Error(Vm(21,w));const B=M2(L,V,y,w);I&&!L.light&&M2(L,I,void 0,"light"),D&&!L.dark&&M2(L,D,void 0,"dark");let H={defaultColorScheme:w,...B,cssVarPrefix:l,colorSchemeSelector:s,rootSelector:p,getCssVar:S,colorSchemes:L,font:{...Gee(B.typography),...B.font},spacing:dte(y.spacing)};Object.keys(H.colorSchemes).forEach(J=>{const $=H.colorSchemes[J].palette,le=Ce=>{const we=Ce.split("-"),We=we[1],Fe=we[2];return S(Ce,$[We][Fe])};if($.mode==="light"&&(en($.common,"background","#fff"),en($.common,"onBackground","#000")),$.mode==="dark"&&(en($.common,"background","#000"),en($.common,"onBackground","#fff")),hte($,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),$.mode==="light"){en($.Alert,"errorColor",Oi($.error.light,.6)),en($.Alert,"infoColor",Oi($.info.light,.6)),en($.Alert,"successColor",Oi($.success.light,.6)),en($.Alert,"warningColor",Oi($.warning.light,.6)),en($.Alert,"errorFilledBg",le("palette-error-main")),en($.Alert,"infoFilledBg",le("palette-info-main")),en($.Alert,"successFilledBg",le("palette-success-main")),en($.Alert,"warningFilledBg",le("palette-warning-main")),en($.Alert,"errorFilledColor",hh(()=>$.getContrastText($.error.main))),en($.Alert,"infoFilledColor",hh(()=>$.getContrastText($.info.main))),en($.Alert,"successFilledColor",hh(()=>$.getContrastText($.success.main))),en($.Alert,"warningFilledColor",hh(()=>$.getContrastText($.warning.main))),en($.Alert,"errorStandardBg",Fi($.error.light,.9)),en($.Alert,"infoStandardBg",Fi($.info.light,.9)),en($.Alert,"successStandardBg",Fi($.success.light,.9)),en($.Alert,"warningStandardBg",Fi($.warning.light,.9)),en($.Alert,"errorIconColor",le("palette-error-main")),en($.Alert,"infoIconColor",le("palette-info-main")),en($.Alert,"successIconColor",le("palette-success-main")),en($.Alert,"warningIconColor",le("palette-warning-main")),en($.AppBar,"defaultBg",le("palette-grey-100")),en($.Avatar,"defaultBg",le("palette-grey-400")),en($.Button,"inheritContainedBg",le("palette-grey-300")),en($.Button,"inheritContainedHoverBg",le("palette-grey-A100")),en($.Chip,"defaultBorder",le("palette-grey-400")),en($.Chip,"defaultAvatarColor",le("palette-grey-700")),en($.Chip,"defaultIconColor",le("palette-grey-700")),en($.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),en($.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),en($.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),en($.LinearProgress,"primaryBg",Fi($.primary.main,.62)),en($.LinearProgress,"secondaryBg",Fi($.secondary.main,.62)),en($.LinearProgress,"errorBg",Fi($.error.main,.62)),en($.LinearProgress,"infoBg",Fi($.info.main,.62)),en($.LinearProgress,"successBg",Fi($.success.main,.62)),en($.LinearProgress,"warningBg",Fi($.warning.main,.62)),en($.Skeleton,"bg",`rgba(${le("palette-text-primaryChannel")} / 0.11)`),en($.Slider,"primaryTrack",Fi($.primary.main,.62)),en($.Slider,"secondaryTrack",Fi($.secondary.main,.62)),en($.Slider,"errorTrack",Fi($.error.main,.62)),en($.Slider,"infoTrack",Fi($.info.main,.62)),en($.Slider,"successTrack",Fi($.success.main,.62)),en($.Slider,"warningTrack",Fi($.warning.main,.62));const Ce=f1($.background.default,.8);en($.SnackbarContent,"bg",Ce),en($.SnackbarContent,"color",hh(()=>$.getContrastText(Ce))),en($.SpeedDialAction,"fabHoverBg",f1($.background.paper,.15)),en($.StepConnector,"border",le("palette-grey-400")),en($.StepContent,"border",le("palette-grey-400")),en($.Switch,"defaultColor",le("palette-common-white")),en($.Switch,"defaultDisabledColor",le("palette-grey-100")),en($.Switch,"primaryDisabledColor",Fi($.primary.main,.62)),en($.Switch,"secondaryDisabledColor",Fi($.secondary.main,.62)),en($.Switch,"errorDisabledColor",Fi($.error.main,.62)),en($.Switch,"infoDisabledColor",Fi($.info.main,.62)),en($.Switch,"successDisabledColor",Fi($.success.main,.62)),en($.Switch,"warningDisabledColor",Fi($.warning.main,.62)),en($.TableCell,"border",Fi(d1($.divider,1),.88)),en($.Tooltip,"bg",d1($.grey[700],.92))}if($.mode==="dark"){en($.Alert,"errorColor",Fi($.error.light,.6)),en($.Alert,"infoColor",Fi($.info.light,.6)),en($.Alert,"successColor",Fi($.success.light,.6)),en($.Alert,"warningColor",Fi($.warning.light,.6)),en($.Alert,"errorFilledBg",le("palette-error-dark")),en($.Alert,"infoFilledBg",le("palette-info-dark")),en($.Alert,"successFilledBg",le("palette-success-dark")),en($.Alert,"warningFilledBg",le("palette-warning-dark")),en($.Alert,"errorFilledColor",hh(()=>$.getContrastText($.error.dark))),en($.Alert,"infoFilledColor",hh(()=>$.getContrastText($.info.dark))),en($.Alert,"successFilledColor",hh(()=>$.getContrastText($.success.dark))),en($.Alert,"warningFilledColor",hh(()=>$.getContrastText($.warning.dark))),en($.Alert,"errorStandardBg",Oi($.error.light,.9)),en($.Alert,"infoStandardBg",Oi($.info.light,.9)),en($.Alert,"successStandardBg",Oi($.success.light,.9)),en($.Alert,"warningStandardBg",Oi($.warning.light,.9)),en($.Alert,"errorIconColor",le("palette-error-main")),en($.Alert,"infoIconColor",le("palette-info-main")),en($.Alert,"successIconColor",le("palette-success-main")),en($.Alert,"warningIconColor",le("palette-warning-main")),en($.AppBar,"defaultBg",le("palette-grey-900")),en($.AppBar,"darkBg",le("palette-background-paper")),en($.AppBar,"darkColor",le("palette-text-primary")),en($.Avatar,"defaultBg",le("palette-grey-600")),en($.Button,"inheritContainedBg",le("palette-grey-800")),en($.Button,"inheritContainedHoverBg",le("palette-grey-700")),en($.Chip,"defaultBorder",le("palette-grey-700")),en($.Chip,"defaultAvatarColor",le("palette-grey-300")),en($.Chip,"defaultIconColor",le("palette-grey-300")),en($.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),en($.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),en($.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),en($.LinearProgress,"primaryBg",Oi($.primary.main,.5)),en($.LinearProgress,"secondaryBg",Oi($.secondary.main,.5)),en($.LinearProgress,"errorBg",Oi($.error.main,.5)),en($.LinearProgress,"infoBg",Oi($.info.main,.5)),en($.LinearProgress,"successBg",Oi($.success.main,.5)),en($.LinearProgress,"warningBg",Oi($.warning.main,.5)),en($.Skeleton,"bg",`rgba(${le("palette-text-primaryChannel")} / 0.13)`),en($.Slider,"primaryTrack",Oi($.primary.main,.5)),en($.Slider,"secondaryTrack",Oi($.secondary.main,.5)),en($.Slider,"errorTrack",Oi($.error.main,.5)),en($.Slider,"infoTrack",Oi($.info.main,.5)),en($.Slider,"successTrack",Oi($.success.main,.5)),en($.Slider,"warningTrack",Oi($.warning.main,.5));const Ce=f1($.background.default,.98);en($.SnackbarContent,"bg",Ce),en($.SnackbarContent,"color",hh(()=>$.getContrastText(Ce))),en($.SpeedDialAction,"fabHoverBg",f1($.background.paper,.15)),en($.StepConnector,"border",le("palette-grey-600")),en($.StepContent,"border",le("palette-grey-600")),en($.Switch,"defaultColor",le("palette-grey-300")),en($.Switch,"defaultDisabledColor",le("palette-grey-600")),en($.Switch,"primaryDisabledColor",Oi($.primary.main,.55)),en($.Switch,"secondaryDisabledColor",Oi($.secondary.main,.55)),en($.Switch,"errorDisabledColor",Oi($.error.main,.55)),en($.Switch,"infoDisabledColor",Oi($.info.main,.55)),en($.Switch,"successDisabledColor",Oi($.success.main,.55)),en($.Switch,"warningDisabledColor",Oi($.warning.main,.55)),en($.TableCell,"border",Oi(d1($.divider,1),.68)),en($.Tooltip,"bg",d1($.grey[700],.92))}Ad($.background,"default"),Ad($.background,"paper"),Ad($.common,"background"),Ad($.common,"onBackground"),Ad($,"divider"),Object.keys($).forEach(Ce=>{const we=$[Ce];Ce!=="tonalOffset"&&we&&typeof we=="object"&&(we.main&&en($[Ce],"mainChannel",R0(L0(we.main))),we.light&&en($[Ce],"lightChannel",R0(L0(we.light))),we.dark&&en($[Ce],"darkChannel",R0(L0(we.dark))),we.contrastText&&en($[Ce],"contrastTextChannel",R0(L0(we.contrastText))),Ce==="text"&&(Ad($[Ce],"primary"),Ad($[Ce],"secondary")),Ce==="action"&&(we.active&&Ad($[Ce],"active"),we.selected&&Ad($[Ce],"selected")))})}),H=e.reduce((J,$)=>Wl(J,$),H);const q={prefix:l,disableCssColorScheme:i,shouldSkipGeneratingVar:c,getSelector:ute(H)},{vars:X,generateThemeVars:ee,generateStyleSheets:se}=zee(H,q);return H.vars=X,Object.entries(H.colorSchemes[H.defaultColorScheme]).forEach(([J,$])=>{H[J]=$}),H.generateThemeVars=ee,H.generateStyleSheets=se,H.generateSpacing=function(){return iN(y.spacing,xA(this))},H.getColorSchemeSelector=Oee(s),H.spacing=H.generateSpacing(),H.shouldSkipGeneratingVar=c,H.unstable_sxConfig={...iS,...y?.unstable_sxConfig},H.unstable_sx=function($){return ty({sx:$,theme:this})},H.toRuntimeSource=dN,H}function bL(t,e,n){t.colorSchemes&&n&&(t.colorSchemes[e]={...n!==!0&&n,palette:CA({...n===!0?{}:n.palette,mode:e})})}function mte(t={},...e){const{palette:n,cssVariables:r=!1,colorSchemes:i=n?void 0:{light:!0},defaultColorScheme:l=n?.mode,...c}=t,s=l||"light",p=i?.[s],y={...i,...n?{[s]:{...typeof p!="boolean"&&p,palette:n}}:void 0};if(r===!1){if(!("colorSchemes"in t))return tT(t,...e);let _=n;"palette"in t||y[s]&&(y[s]!==!0?_=y[s].palette:s==="dark"&&(_={mode:"dark"}));const w=tT({...t,palette:_},...e);return w.defaultColorScheme=s,w.colorSchemes=y,w.palette.mode==="light"&&(w.colorSchemes.light={...y.light!==!0&&y.light,palette:w.palette},bL(w,"dark",y.dark)),w.palette.mode==="dark"&&(w.colorSchemes.dark={...y.dark!==!0&&y.dark,palette:w.palette},bL(w,"light",y.light)),w}return!n&&!("light"in y)&&s==="light"&&(y.light=!0),pte({...c,colorSchemes:y,defaultColorScheme:s,...typeof r!="boolean"&&r},...e)}const gte=mte(),vte="$$material";function yte(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const _te=t=>yte(t)&&t!=="classes",xte=vee({themeId:vte,defaultTheme:gte,rootShouldForwardProp:_te}),bte=Ree;function wte(t){return Iee(t)}function Ste(t){return sN("MuiSvgIcon",t)}fee("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Mte=t=>{const{color:e,fontSize:n,classes:r}=t,i={root:["root",e!=="inherit"&&`color${ey(e)}`,`fontSize${ey(n)}`]};return fQ(i,Ste,r)},Cte=xte("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${ey(n.color)}`],e[`fontSize${ey(n.fontSize)}`]]}})(bte(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:t.transitions?.create?.("fill",{duration:(t.vars??t).transitions?.duration?.shorter}),variants:[{props:e=>!e.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:t.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:t.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,e])=>e&&e.main).map(([e])=>({props:{color:e},style:{color:(t.vars??t).palette?.[e]?.main}})),{props:{color:"action"},style:{color:(t.vars??t).palette?.action?.active}},{props:{color:"disabled"},style:{color:(t.vars??t).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),nT=G.forwardRef(function(e,n){const r=wte({props:e,name:"MuiSvgIcon"}),{children:i,className:l,color:c="inherit",component:s="svg",fontSize:p="medium",htmlColor:y,inheritViewBox:_=!1,titleAccess:w,viewBox:S="0 0 24 24",...M}=r,I=G.isValidElement(i)&&i.type==="svg",D={...r,color:c,component:s,fontSize:p,instanceFontSize:e.fontSize,inheritViewBox:_,viewBox:S,hasSvgAsChild:I},R={};_||(R.viewBox=S);const L=Mte(D);return ie.jsxs(Cte,{as:s,className:co(L.root,l),focusable:"false",color:y,"aria-hidden":w?void 0:!0,role:w?"img":void 0,ref:n,...R,...M,...I&&i.props,ownerState:D,children:[I?i.props.children:i,w?ie.jsx("title",{children:w}):null]})});nT.muiName="SvgIcon";function Rs(t,e){function n(r,i){return ie.jsx(nT,{"data-testid":void 0,ref:i,...r,children:t})}return n.muiName=nT.muiName,G.memo(G.forwardRef(n))}const EA=Rs(ie.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}));function mr(t,e){if(t==null)throw new Error(e);return t}function mN(t,e){if(!t)throw new Error(`assertion failed: ${e}`);return t}class Su extends Error{constructor(e){super("unreachable value "+JSON.stringify(e))}}class jm{static checkArgument(e,n){if(!e)throw new Error(n)}static checkState(e,n){if(!e)throw new Error(n)}static checkExists(e,n){return mr(e,n)}}function Nb(t,e){return vN(t,e,(n,r,i,l)=>Math.sqrt(Math.pow(i-n,2)+Math.pow(l-r,2)))}function Ete(t,e){return vN(t,e,(n,r,i,l)=>[(n+i)/2,(r+l)/2])}function wL([t,e,n,r]){return Ete([t,e],[n,r])}function gN(t){let e=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY;for(const l of t)Array.isArray(l)?(e=Math.min(e,l[0]),r=Math.max(r,l[0]),n=Math.min(n,l[1]),i=Math.max(i,l[1])):(e=Math.min(e,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y));return[e,n,r,i]}function p1(t,e){const[n,r,i,l]=t,[c,s]=Array.isArray(e)?e:[e.x,e.y];return n<=c&&c<=i&&r<=s&&s<=l}function TA(t){const e=Math.PI*2;let n=t%e;return n=(n+e)%e,n<=Math.PI?n:n-e}function Bb(t){return TA(t*Math.PI/180)}function SL(t){return TA(t)*180/Math.PI}function ML(t,e){let n,r;return Array.isArray(t)?(jm.checkArgument(t.length>=2),n=t[0],r=t[1]):(n=t.x,r=t.y),e(n,r)}function vN(t,e,n){const[r,i]=ML(t,(s,p)=>[s,p]),[l,c]=ML(e,(s,p)=>[s,p]);return n(r,i,l,c)}var Ts=(t=>(t[t.Arizona=0]="Arizona",t[t.Arkansas=1]="Arkansas",t[t.Colorado=2]="Colorado",t[t.Idaho=3]="Idaho",t[t.Iowa=4]="Iowa",t[t.Kansas=5]="Kansas",t[t.Missouri=6]="Missouri",t[t.Montana=7]="Montana",t[t.Nebraska=8]="Nebraska",t[t.Nevada=9]="Nevada",t[t.NewMexico=10]="NewMexico",t[t.Oklahoma=11]="Oklahoma",t[t.Oregon=12]="Oregon",t[t.Texas=13]="Texas",t[t.Utah=14]="Utah",t[t.Washington=15]="Washington",t[t.Wyoming=16]="Wyoming",t))(Ts||{});const Hm=new Set([9,0,10,12,15,14,3,2,16,7,13,11,5,8,1,6,4]),Tte={9:"Nevada",0:"Arizona",10:"New Mexico",12:"Oregon",15:"Washington",14:"Utah",3:"Idaho",2:"Colorado",16:"Wyoming",7:"Montana",13:"Texas",11:"Oklahoma",5:"Kansas",8:"Nebraska",1:"Arkansas",6:"Missouri",4:"Iowa"},yN={0:new Set,1:new Set([9]),2:new Set([0]),3:new Set([10]),4:new Set([12]),5:new Set([15]),6:new Set([15,12]),7:new Set([14]),8:new Set([14,10]),9:new Set([3]),10:new Set([3,12]),11:new Set([3,14]),12:new Set([3,15]),13:new Set([2]),14:new Set([2,10]),15:new Set([2,14]),16:new Set([16]),17:new Set([16,2]),18:new Set([16,3]),19:new Set([16,14]),20:new Set([13]),21:new Set([13,10]),22:new Set([7]),23:new Set([7,3]),24:new Set([7,16]),25:new Set([11]),26:new Set([11,2]),27:new Set([11,10]),28:new Set([11,13]),29:new Set([5]),30:new Set([5,2]),31:new Set([5,11]),32:new Set([8]),33:new Set([8,2]),34:new Set([8,5]),35:new Set([8,16]),36:new Set([1]),37:new Set([1,11]),38:new Set([1,13]),39:new Set([6]),40:new Set([6,1]),41:new Set([6,5]),42:new Set([6,8]),43:new Set([6,11]),44:new Set([4]),45:new Set([4,6]),46:new Set([4,8])},Pte={1:0,2:1,3:2,7:13,13:9,31:3,37:4,43:20,44:7,47:5,17:29,27:22,36:25,50:16,18:32,19:36,26:39,21:44};for(const t of Object.values(Pte))t!==0&&mN(yN[t].size===1);function ix(t){const e=new Set;for(const[n,r]of Object.entries(yN))[...r].every(i=>t.has(i))&&e.add(Number(n));return e}const Ate=new Set([0,1,2,3,4,5,6,7,11]),Ite={0:new Set,1:new Set([0]),2:new Set([1]),3:new Set([2]),4:new Set([3]),5:new Set([3,2]),6:new Set([4]),7:new Set([4,0]),8:new Set([4,1]),9:new Set([5]),10:new Set([5,0]),11:new Set([6]),12:new Set([6,2]),16:new Set([7]),17:new Set([7,0]),18:new Set([7,4]),20:new Set([11]),21:new Set([11,0]),22:new Set([11,7])};function Rte(t){const e=new Set;for(const[n,r]of Object.entries(Ite))[...r].every(i=>t.has(i))&&e.add(Number(n));return e}var _N=(t=>(t[t.Road=0]="Road",t[t.Light=1]="Light",t[t.Dark=2]="Dark",t[t.Green=3]="Green",t[t.NavRed=4]="NavRed",t[t.NavGreen=5]="NavGreen",t[t.NavBlue=6]="NavBlue",t[t.NavYellow=7]="NavYellow",t[t.NavPurple=8]="NavPurple",t))(_N||{});const Lte="modulepreload",kte=function(t){return"/"+t},CL={},Dte=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let y=function(_){return Promise.all(_.map(w=>Promise.resolve(w).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};var c=y;document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),p=s?.nonce||s?.getAttribute("nonce");i=y(n.map(_=>{if(_=kte(_),_ in CL)return;CL[_]=!0;const w=_.endsWith(".css"),S=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_}"]${S}`))return;const M=document.createElement("link");if(M.rel=w?"stylesheet":Lte,w||(M.as="script"),M.crossOrigin="",M.href=_,p&&M.setAttribute("nonce",p),document.head.appendChild(M),w)return new Promise((I,D)=>{M.addEventListener("load",I),M.addEventListener("error",()=>D(new Error(`Unable to preload CSS for ${_}`)))})}))}function l(s){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=s,window.dispatchEvent(p),!p.defaultPrevented)throw s}return i.then(s=>{for(const p of s||[])p.status==="rejected"&&l(p.reason);return e().catch(l)})},xN=G.createContext(null);function ox(){const t=G.useContext(xN)?.maps,e=G.useContext(eg);return G.useMemo(()=>({...t,current:e?.map}),[t,e])}function zte(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,l=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===l}function Ya(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Ya(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!Ya(t[i],e[i]))return!1;return!0}return!1}function EL(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function TL(t,e){const n=e.viewState||e,r={};if("longitude"in n&&"latitude"in n&&(n.longitude!==t.center.lng||n.latitude!==t.center.lat)){const i=t.center.constructor;r.center=new i(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==t.zoom&&(r.zoom=n.zoom),"bearing"in n&&n.bearing!==t.bearing&&(r.bearing=n.bearing),"pitch"in n&&n.pitch!==t.pitch&&(r.pitch=n.pitch),n.padding&&t.padding&&!Ya(n.padding,t.padding)&&(r.padding=n.padding),r}const Ote=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function PL(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const l=e[r.ref];if(l){i=i||Object.assign({},r),delete i.ref;for(const c of Ote)c in l&&(i[c]=l[c])}return i||r});return{...t,layers:n}}const AL={version:8,sources:{},layers:[]},IL={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},RL={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},LL={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Fte=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Nte=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class ny{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=i=>{const l=this.props[LL[i.type]];l?l(i):i.type==="error"&&console.error(i.error)},this._onCameraEvent=i=>{if(this._internalUpdate)return;i.viewState=this._propsedCameraUpdate||EL(this._map.transform);const l=this.props[RL[i.type]];l&&l(i)},this._onCameraUpdate=i=>this._internalUpdate?i:(this._propsedCameraUpdate=EL(i),TL(i,this.props)),this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const l=this.props[IL[i.type]];l&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),l(i),delete i.features)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n),i=this._updateSize(e),l=this._updateViewState(e);this._updateStyle(e,n),this._updateStyleComponents(e),this._updateHandlers(e,n),(r||i||l&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=ny.savedMaps.pop();if(!r)return null;const i=r.map,l=i.getContainer();for(n.className=l.className;l.childNodes.length>0;)n.appendChild(l.childNodes[0]);i._container=n;const c=i._resizeObserver;c&&(c.disconnect(),c.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:s}=e;return s&&(s.bounds?i.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):r._updateViewState(s)),i.isStyleLoaded()?i.fire("load"):i.once("style.load",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=AL}=n,i={...n,...n.initialViewState,container:e,style:PL(r)},l=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[l.longitude||0,l.latitude||0],zoom:l.zoom||0,pitch:l.pitch||0,bearing:l.bearing||0}),n.gl){const s=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=s,n.gl)}const c=new this._MapClass(i);l.padding&&c.setPadding(l.padding),n.cursor&&(c.getCanvas().style.cursor=n.cursor),c.transformCameraUpdate=this._onCameraUpdate,c.on("style.load",()=>{this._styleComponents={light:c.getLight(),sky:c.getSky(),projection:c.getProjection?.(),terrain:c.getTerrain()},this._updateStyleComponents(this.props)}),c.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const s in IL)c.on(s,this._onPointerEvent);for(const s in RL)c.on(s,this._onCameraEvent);for(const s in LL)c.on(s,this._onEvent);this._map=c}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),ny.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e){const n=this._map,r=n.transform;if(!n.isMoving()){const l=TL(r,e);if(Object.keys(l).length>0)return this._internalUpdate=!0,n.jumpTo(l),this._internalUpdate=!1,!0}return!1}_updateSettings(e,n){const r=this._map;let i=!1;for(const l of Fte)l in e&&!Ya(e[l],n[l])&&(i=!0,r[`set${l[0].toUpperCase()}${l.slice(1)}`]?.call(r,e[l]));return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=AL,styleDiffing:i=!0}=e,l={diff:i};"localIdeographFontFamily"in e&&(l.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(PL(r),l)}}_updateStyleComponents({light:e,projection:n,sky:r,terrain:i}){const l=this._map,c=this._styleComponents;l.style._loaded&&(e&&!Ya(e,c.light)&&(c.light=e,l.setLight(e)),n&&!Ya(n,c.projection)&&n!==c.projection?.type&&(c.projection=typeof n=="string"?{type:n}:n,l.setProjection?.(c.projection)),r&&!Ya(r,c.sky)&&(c.sky=r,l.setSky(r)),i!==void 0&&!Ya(i,c.terrain)&&(!i||l.getSource(i.source))&&(c.terrain=i,l.setTerrain(i)))}_updateHandlers(e,n){const r=this._map;for(const i of Nte){const l=e[i]??!0,c=n[i]??!0;Ya(l,c)||(l?r[i].enable(l):r[i].disable())}}_queryRenderedFeatures(e){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const i=e.type,l=this._hoveredFeatures?.length>0,c=this._queryRenderedFeatures(e.point),s=c.length>0;!s&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=c,s&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=i}else this._hoveredFeatures=null}}ny.savedMaps=[];const Bte=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Ute(t){if(!t)return null;const e=t.map,n={getMap:()=>e};for(const r of $te(e))!(r in n)&&!Bte.includes(r)&&(n[r]=e[r].bind(e));return n}function $te(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const Vte=typeof document<"u"?G.useLayoutEffect:G.useEffect;function jte(t,e){const{RTLTextPlugin:n,maxParallelImageRequests:r,workerCount:i,workerUrl:l}=e;if(n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:c,lazy:s=!0}=typeof n=="string"?{pluginUrl:n}:n;t.setRTLTextPlugin(c,p=>{p&&console.error(p)},s)}r!==void 0&&t.setMaxParallelImageRequests(r),i!==void 0&&t.setWorkerCount(i),l!==void 0&&t.setWorkerUrl(l)}const eg=G.createContext(null);function Hte(t,e){const n=G.useContext(xN),[r,i]=G.useState(null),l=G.useRef(),{current:c}=G.useRef({mapLib:null,map:null});G.useEffect(()=>{const y=t.mapLib;let _=!0,w;return Promise.resolve(y||Dte(()=>Promise.resolve().then(()=>dne),[])).then(S=>{if(!_)return;if(!S)throw new Error("Invalid mapLib");const M="Map"in S?S:S.default;if(!M.Map)throw new Error("Invalid mapLib");jte(M,t),t.reuseMaps&&(w=ny.reuse(t,l.current)),w||(w=new ny(M.Map,t,l.current)),c.map=Ute(w),c.mapLib=M,i(w),n?.onMapMount(c.map,t.id)}).catch(S=>{const{onError:M}=t;M?M({type:"error",target:null,originalEvent:null,error:S}):console.error(S)}),()=>{_=!1,w&&(n?.onMapUnmount(t.id),t.reuseMaps?w.recycle():w.destroy())}},[]),Vte(()=>{r&&r.setProps(t)}),G.useImperativeHandle(e,()=>c.map,[r]);const s=G.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),p={height:"100%"};return G.createElement("div",{id:t.id,ref:l,style:s},r&&G.createElement(eg.Provider,{value:c},G.createElement("div",{"mapboxgl-children":"",style:p},t.children)))}const sx=G.forwardRef(Hte),Gte=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Qd(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!Gte.test(r)?n[r]=`${i}px`:n[r]=i}}function bN(t,e){if(t===e)return null;const n=kL(t),r=kL(e),i=[];for(const l of r)n.has(l)||i.push(l);for(const l of n)r.has(l)||i.push(l);return i.length===0?null:i}function kL(t){return new Set(t?t.trim().split(/\s+/):[])}const PA=G.memo(G.forwardRef((t,e)=>{const{map:n,mapLib:r}=G.useContext(eg),i=G.useRef({props:t}),l=G.useMemo(()=>{let L=!1;G.Children.forEach(t.children,H=>{H&&(L=!0)});const V={...t,element:L?document.createElement("div"):void 0},B=new r.Marker(V);return B.setLngLat([t.longitude,t.latitude]),B.getElement().addEventListener("click",H=>{i.current.props.onClick?.({type:"click",target:B,originalEvent:H})}),B.on("dragstart",H=>{const q=H;q.lngLat=l.getLngLat(),i.current.props.onDragStart?.(q)}),B.on("drag",H=>{const q=H;q.lngLat=l.getLngLat(),i.current.props.onDrag?.(q)}),B.on("dragend",H=>{const q=H;q.lngLat=l.getLngLat(),i.current.props.onDragEnd?.(q)}),B},[]);G.useEffect(()=>(l.addTo(n.getMap()),()=>{l.remove()}),[]);const{longitude:c,latitude:s,offset:p,style:y,draggable:_=!1,popup:w=null,rotation:S=0,rotationAlignment:M="auto",pitchAlignment:I="auto"}=t;G.useEffect(()=>{Qd(l.getElement(),y)},[y]),G.useImperativeHandle(e,()=>l,[]);const D=i.current.props;(l.getLngLat().lng!==c||l.getLngLat().lat!==s)&&l.setLngLat([c,s]),p&&!zte(l.getOffset(),p)&&l.setOffset(p),l.isDraggable()!==_&&l.setDraggable(_),l.getRotation()!==S&&l.setRotation(S),l.getRotationAlignment()!==M&&l.setRotationAlignment(M),l.getPitchAlignment()!==I&&l.setPitchAlignment(I),l.getPopup()!==w&&l.setPopup(w);const R=bN(D.className,t.className);if(R)for(const L of R)l.toggleClassName(L);return i.current.props=t,Fw.createPortal(t.children,l.getElement())})),Wte=G.memo(G.forwardRef((t,e)=>{const{map:n,mapLib:r}=G.useContext(eg),i=G.useMemo(()=>document.createElement("div"),[]),l=G.useRef({props:t}),c=G.useMemo(()=>{const s={...t},p=new r.Popup(s);return p.setLngLat([t.longitude,t.latitude]),p.once("open",y=>{l.current.props.onOpen?.(y)}),p},[]);if(G.useEffect(()=>{const s=p=>{l.current.props.onClose?.(p)};return c.on("close",s),c.setDOMContent(i).addTo(n.getMap()),()=>{c.off("close",s),c.isOpen()&&c.remove()}},[]),G.useEffect(()=>{Qd(c.getElement(),t.style)},[t.style]),G.useImperativeHandle(e,()=>c,[]),c.isOpen()){const s=l.current.props;(c.getLngLat().lng!==t.longitude||c.getLngLat().lat!==t.latitude)&&c.setLngLat([t.longitude,t.latitude]),t.offset&&!Ya(s.offset,t.offset)&&c.setOffset(t.offset),(s.anchor!==t.anchor||s.maxWidth!==t.maxWidth)&&(c.options.anchor=t.anchor,c.setMaxWidth(t.maxWidth));const p=bN(s.className,t.className);if(p)for(const y of p)c.toggleClassName(y);l.current.props=t}return Fw.createPortal(t.children,i)}));function sl(t,e,n,r){const i=G.useContext(eg),l=G.useMemo(()=>t(i),[]);return G.useEffect(()=>{const c=e,s=null,p=typeof e=="function"?e:null,{map:y}=i;return y.hasControl(l)||(y.addControl(l,c?.position),s&&s(i)),()=>{p&&p(i),y.hasControl(l)&&y.removeControl(l)}},[]),l}function qte(t){const e=sl(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return G.useEffect(()=>{Qd(e._container,t.style)},[t.style]),null}const wN=G.memo(qte);function Xte(t){const e=sl(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return G.useEffect(()=>{Qd(e._controlContainer,t.style)},[t.style]),null}const AA=G.memo(Xte);function Zte(t,e){const n=G.useRef({props:t}),r=sl(({mapLib:i})=>{const l=new i.GeolocateControl(t),c=l._setupUI;return l._setupUI=()=>{l._container.hasChildNodes()||c()},l.on("geolocate",s=>{n.current.props.onGeolocate?.(s)}),l.on("error",s=>{n.current.props.onError?.(s)}),l.on("outofmaxbounds",s=>{n.current.props.onOutOfMaxBounds?.(s)}),l.on("trackuserlocationstart",s=>{n.current.props.onTrackUserLocationStart?.(s)}),l.on("trackuserlocationend",s=>{n.current.props.onTrackUserLocationEnd?.(s)}),l},{position:t.position});return n.current.props=t,G.useImperativeHandle(e,()=>r,[]),G.useEffect(()=>{Qd(r._container,t.style)},[t.style]),null}G.memo(G.forwardRef(Zte));function Yte(t){const e=sl(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return G.useEffect(()=>{Qd(e._container,t.style)},[t.style]),null}const IA=G.memo(Yte);function Kte(t){const e=sl(({mapLib:l})=>new l.ScaleControl(t),{position:t.position}),n=G.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),G.useEffect(()=>{Qd(e._container,i)},[i]),null}G.memo(Kte);function Jte(t){const e=sl(({mapLib:n})=>new n.TerrainControl(t),{position:t.position});return G.useEffect(()=>{Qd(e._container,t.style)},[t.style]),null}G.memo(Jte);function Qte(t){const e=sl(({mapLib:n})=>new n.LogoControl(t),{position:t.position});return G.useEffect(()=>{Qd(e._container,t.style)},[t.style]),null}G.memo(Qte);function Ub(t,e){if(!t)throw new Error(e)}let ene=0;function tne(t,e,n){if(t.style&&t.style._loaded){const r={...n};return delete r.id,delete r.children,t.addSource(e,r),t.getSource(e)}return null}function nne(t,e,n){Ub(e.id===n.id,"source id changed"),Ub(e.type===n.type,"source type changed");let r="",i=0;for(const c in e)c!=="children"&&c!=="id"&&!Ya(n[c],e[c])&&(r=c,i++);if(!i)return;const l=e.type;if(l==="geojson")t.setData(e.data);else if(l==="image")t.updateImage({url:e.url,coordinates:e.coordinates});else switch(r){case"coordinates":t.setCoordinates?.(e.coordinates);break;case"url":t.setUrl?.(e.url);break;case"tiles":t.setTiles?.(e.tiles);break;default:console.warn(`Unable to update <Source> prop: ${r}`)}}function ap(t){const e=G.useContext(eg).map.getMap(),n=G.useRef(t),[,r]=G.useState(0),i=G.useMemo(()=>t.id||`jsx-source-${ene++}`,[]);G.useEffect(()=>{if(e){const c=()=>setTimeout(()=>r(s=>s+1),0);return e.on("styledata",c),c(),()=>{if(e.off("styledata",c),e.style&&e.style._loaded&&e.getSource(i)){const s=e.getStyle()?.layers;if(s)for(const p of s)p.source===i&&e.removeLayer(p.id);e.removeSource(i)}}}},[e]);let l=e&&e.style&&e.getSource(i);return l?nne(l,t,n.current):l=tne(e,i,t),n.current=t,l&&G.Children.map(t.children,c=>c&&G.cloneElement(c,{source:i}))||null}function rne(t,e,n,r){if(Ub(n.id===r.id,"layer id changed"),Ub(n.type===r.type,"layer type changed"),n.type==="custom"||r.type==="custom")return;const{layout:i={},paint:l={},filter:c,minzoom:s,maxzoom:p,beforeId:y}=n;if(y!==r.beforeId&&t.moveLayer(e,y),i!==r.layout){const _=r.layout||{};for(const w in i)Ya(i[w],_[w])||t.setLayoutProperty(e,w,i[w]);for(const w in _)i.hasOwnProperty(w)||t.setLayoutProperty(e,w,void 0)}if(l!==r.paint){const _=r.paint||{};for(const w in l)Ya(l[w],_[w])||t.setPaintProperty(e,w,l[w]);for(const w in _)l.hasOwnProperty(w)||t.setPaintProperty(e,w,void 0)}Ya(c,r.filter)||t.setFilter(e,c),(s!==r.minzoom||p!==r.maxzoom)&&t.setLayerZoomRange(e,s,p)}function ine(t,e,n){if(t.style&&t.style._loaded&&(!("source"in n)||t.getSource(n.source))){const r={...n,id:e};delete r.beforeId,t.addLayer(r,n.beforeId)}}let one=0;function Rr(t){const e=G.useContext(eg).map.getMap(),n=G.useRef(t),[,r]=G.useState(0),i=G.useMemo(()=>t.id||`jsx-layer-${one++}`,[]);if(G.useEffect(()=>{if(e){const c=()=>r(s=>s+1);return e.on("styledata",c),c(),()=>{e.off("styledata",c),e.style&&e.style._loaded&&e.getLayer(i)&&e.removeLayer(i)}}},[e]),e&&e.style&&e.getLayer(i))try{rne(e,i,t,n.current)}catch(c){console.warn(c)}else ine(e,i,t);return n.current=t,null}const sne={"text-color":"hsl(42, 10%, 14%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},ane={"text-color":"hsl(42, 10%, 24%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 100%)"},lne={"text-color":"hsl(42, 10%, 86%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},cne={"text-color":"hsl(42, 10%, 76%)","text-halo-width":2,"text-halo-color":"hsl(42, 10%, 0%)"},sS={light:{water:"#b2cdfb",land:"#f8f8f8",stateBorder:"#aaa",countryBorder:"#ccc",primaryTextPaint:sne,secondaryTextPaint:ane,hiddenRoad:"#e9e9e8",footprint:"#e9e9e8",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#eeeeffcc",trainLine:"#aaa",trainLabel:"#555c",trainHalo:"#eefc",mapAreaOutline:"#999a"},dark:{water:"#36415d",land:"#1a1a1a",stateBorder:"#555",countryBorder:"#333",primaryTextPaint:lne,secondaryTextPaint:cne,hiddenRoad:"#404038",footprint:"#30302f88",ferryLine:"#6c90ff88",ferryLabel:"#6c80ff",ferryHalo:"#303028cc",trainLine:"#888",trainLabel:"#eeec",trainHalo:"#303028cc",mapAreaOutline:"#777a"}};var lb={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.6.1/LICENSE.txt
 */var une=lb.exports,DL;function hne(){return DL||(DL=1,function(t,e){(function(n,r){t.exports=r()})(une,function(){var n={},r={};function i(c,s,p){if(r[c]=p,c==="index"){var y="var sharedModule = {}; ("+r.shared+")(sharedModule); ("+r.worker+")(sharedModule);",_={};return r.shared(_),r.index(n,_),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([y],{type:"text/javascript"}))),n}}i("shared",["exports"],function(c){function s(d,a,h,m){return new(h||(h=Promise))(function(b,T){function A(j){try{N(m.next(j))}catch(Y){T(Y)}}function z(j){try{N(m.throw(j))}catch(Y){T(Y)}}function N(j){var Y;j.done?b(j.value):(Y=j.value,Y instanceof h?Y:new h(function(te){te(Y)})).then(A,z)}N((m=m.apply(d,a||[])).next())})}function p(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var y,_;function w(){if(_)return y;function d(a,h){this.x=a,this.y=h}return _=1,y=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,h){return this.clone()._rotateAround(a,h)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var h=a.x-this.x,m=a.y-this.y;return h*h+m*m},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,h){return Math.atan2(this.x*h-this.y*a,this.x*a+this.y*h)},_matMult:function(a){var h=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=h,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var h=Math.cos(a),m=Math.sin(a),b=m*this.x+h*this.y;return this.x=h*this.x-m*this.y,this.y=b,this},_rotateAround:function(a,h){var m=Math.cos(a),b=Math.sin(a),T=h.y+b*(this.x-h.x)+m*(this.y-h.y);return this.x=h.x+m*(this.x-h.x)-b*(this.y-h.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(a){return a instanceof d?a:Array.isArray(a)?new d(a[0],a[1]):a},y}typeof SuppressedError=="function"&&SuppressedError;var S,M,I=p(w()),D=function(){if(M)return S;function d(a,h,m,b){this.cx=3*a,this.bx=3*(m-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(b-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=h,this.p2x=m,this.p2y=b}return M=1,S=d,d.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,h){if(h===void 0&&(h=1e-6),a<0)return 0;if(a>1)return 1;for(var m=a,b=0;b<8;b++){var T=this.sampleCurveX(m)-a;if(Math.abs(T)<h)return m;var A=this.sampleCurveDerivativeX(m);if(Math.abs(A)<1e-6)break;m-=T/A}var z=0,N=1;for(m=a,b=0;b<20&&(T=this.sampleCurveX(m),!(Math.abs(T-a)<h));b++)a>T?z=m:N=m,m=.5*(N-z)+z;return m},solve:function(a,h){return this.sampleCurveY(this.solveCurveX(a,h))}},S}(),R=p(D);let L,V;function B(){return L==null&&(L=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),L}function H(){if(V==null&&(V=!1,B())){const a=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(a){for(let m=0;m<5*5;m++){const b=4*m;a.fillStyle=`rgb(${b},${b+1},${b+2})`,a.fillRect(m%5,Math.floor(m/5),1,1)}const h=a.getImageData(0,0,5,5).data;for(let m=0;m<5*5*4;m++)if(m%4!=3&&h[m]!==m){V=!0;break}}}return V||!1}var q=1e-6,X=typeof Float32Array<"u"?Float32Array:Array;function ee(){var d=new X(9);return X!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d}function se(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}function J(){var d=new X(3);return X!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d}function $(d){return Math.hypot(d[0],d[1],d[2])}function le(d,a,h){var m=new X(3);return m[0]=d,m[1]=a,m[2]=h,m}function Ce(d,a,h){return d[0]=a[0]+h[0],d[1]=a[1]+h[1],d[2]=a[2]+h[2],d}function we(d,a,h){return d[0]=a[0]*h,d[1]=a[1]*h,d[2]=a[2]*h,d}function We(d,a,h){var m=a[0],b=a[1],T=a[2],A=h[0],z=h[1],N=h[2];return d[0]=b*N-T*z,d[1]=T*A-m*N,d[2]=m*z-b*A,d}Math.hypot||(Math.hypot=function(){for(var d=0,a=arguments.length;a--;)d+=arguments[a]*arguments[a];return Math.sqrt(d)});var Fe,Me=$;function Ee(d,a,h){var m=a[0],b=a[1],T=a[2],A=a[3];return d[0]=h[0]*m+h[4]*b+h[8]*T+h[12]*A,d[1]=h[1]*m+h[5]*b+h[9]*T+h[13]*A,d[2]=h[2]*m+h[6]*b+h[10]*T+h[14]*A,d[3]=h[3]*m+h[7]*b+h[11]*T+h[15]*A,d}function Te(){var d=new X(4);return X!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d[3]=1,d}function Ze(d,a,h,m){var b=.5*Math.PI/180;a*=b,h*=b,m*=b;var T=Math.sin(a),A=Math.cos(a),z=Math.sin(h),N=Math.cos(h),j=Math.sin(m),Y=Math.cos(m);return d[0]=T*N*Y-A*z*j,d[1]=A*z*Y+T*N*j,d[2]=A*N*j-T*z*Y,d[3]=A*N*Y+T*z*j,d}function rt(){var d=new X(2);return X!=Float32Array&&(d[0]=0,d[1]=0),d}function Re(d,a){var h=new X(2);return h[0]=d,h[1]=a,h}J(),Fe=new X(4),X!=Float32Array&&(Fe[0]=0,Fe[1]=0,Fe[2]=0,Fe[3]=0),J(),le(1,0,0),le(0,1,0),Te(),Te(),ee(),rt();const Qe=8192;function Vt(d,a,h){return a*(Qe/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}function je(d,a){return(d%a+a)%a}function ct(d,a,h){return d*(1-h)+a*h}function Ct(d){if(d<=0)return 0;if(d>=1)return 1;const a=d*d,h=a*d;return 4*(d<.5?h:3*(d-a)+h-.75)}function ut(d,a,h,m){const b=new R(d,a,h,m);return T=>b.solve(T)}const lt=ut(.25,.1,.25,1);function _t(d,a,h){return Math.min(h,Math.max(a,d))}function wt(d,a,h){const m=h-a,b=((d-a)%m+m)%m+a;return b===a?h:b}function cn(d,...a){for(const h of a)for(const m in h)d[m]=h[m];return d}let dn=1;function tn(d,a,h){const m={};for(const b in d)m[b]=a.call(this,d[b],b,d);return m}function Je(d,a,h){const m={};for(const b in d)a.call(this,d[b],b,d)&&(m[b]=d[b]);return m}function Tn(d){return Array.isArray(d)?d.map(Tn):typeof d=="object"&&d?tn(d,Tn):d}const Kt={};function fn(d){Kt[d]||(typeof console<"u"&&console.warn(d),Kt[d]=!0)}function Ut(d,a,h){return(h.y-d.y)*(a.x-d.x)>(a.y-d.y)*(h.x-d.x)}function On(d){return typeof WorkerGlobalScope<"u"&&d!==void 0&&d instanceof WorkerGlobalScope}let vn=null;function Ue(d){return typeof ImageBitmap<"u"&&d instanceof ImageBitmap}const Se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function yt(d,a,h,m,b){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(d,{timestamp:0});try{const A=T?.format;if(!A||!A.startsWith("BGR")&&!A.startsWith("RGB"))throw new Error(`Unrecognized format ${A}`);const z=A.startsWith("BGR"),N=new Uint8ClampedArray(m*b*4);if(yield T.copyTo(N,function(j,Y,te,he,pe){const ge=4*Math.max(-Y,0),_e=(Math.max(0,te)-te)*he*4+ge,De=4*he,Ve=Math.max(0,Y),ft=Math.max(0,te);return{rect:{x:Ve,y:ft,width:Math.min(j.width,Y+he)-Ve,height:Math.min(j.height,te+pe)-ft},layout:[{offset:_e,stride:De}]}}(d,a,h,m,b)),z)for(let j=0;j<N.length;j+=4){const Y=N[j];N[j]=N[j+2],N[j+2]=Y}return N}finally{T.close()}})}let Nt,Ht;function Ot(d,a,h,m){return d.addEventListener(a,h,m),{unsubscribe:()=>{d.removeEventListener(a,h,m)}}}function un(d){return d*Math.PI/180}function Gt(d){return d/Math.PI*180}const Zt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Nn={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Yt="AbortError";function Pe(){return new Error(Yt)}const ae={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ue(d){return ae.REGISTERED_PROTOCOLS[d.substring(0,d.indexOf("://"))]}const ne="global-dispatcher";class fe extends Error{constructor(a,h,m,b){super(`AJAXError: ${h} (${a}): ${m}`),this.status=a,this.statusText=h,this.url=m,this.body=b}}const Oe=()=>On(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ke=function(d,a){if(/:\/\//.test(d.url)&&!/^https?:|^file:/.test(d.url)){const m=ue(d.url);if(m)return m(d,a);if(On(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,targetMapId:ne},a)}if(!(/^file:/.test(h=d.url)||/^file:/.test(Oe())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(m,b){return s(this,void 0,void 0,function*(){const T=new Request(m.url,{method:m.method||"GET",body:m.body,credentials:m.credentials,headers:m.headers,cache:m.cache,referrer:Oe(),signal:b.signal});let A,z;m.type!=="json"||T.headers.has("Accept")||T.headers.set("Accept","application/json");try{A=yield fetch(T)}catch(j){throw new fe(0,j.message,m.url,new Blob)}if(!A.ok){const j=yield A.blob();throw new fe(A.status,A.statusText,m.url,j)}z=m.type==="arrayBuffer"||m.type==="image"?A.arrayBuffer():m.type==="json"?A.json():A.text();const N=yield z;if(b.signal.aborted)throw Pe();return{data:N,cacheControl:A.headers.get("Cache-Control"),expires:A.headers.get("Expires")}})}(d,a);if(On(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:d,mustQueue:!0,targetMapId:ne},a)}var h;return function(m,b){return new Promise((T,A)=>{var z;const N=new XMLHttpRequest;N.open(m.method||"GET",m.url,!0),m.type!=="arrayBuffer"&&m.type!=="image"||(N.responseType="arraybuffer");for(const j in m.headers)N.setRequestHeader(j,m.headers[j]);m.type==="json"&&(N.responseType="text",!((z=m.headers)===null||z===void 0)&&z.Accept||N.setRequestHeader("Accept","application/json")),N.withCredentials=m.credentials==="include",N.onerror=()=>{A(new Error(N.statusText))},N.onload=()=>{if(!b.signal.aborted)if((N.status>=200&&N.status<300||N.status===0)&&N.response!==null){let j=N.response;if(m.type==="json")try{j=JSON.parse(N.response)}catch(Y){return void A(Y)}T({data:j,cacheControl:N.getResponseHeader("Cache-Control"),expires:N.getResponseHeader("Expires")})}else{const j=new Blob([N.response],{type:N.getResponseHeader("Content-Type")});A(new fe(N.status,N.statusText,m.url,j))}},b.signal.addEventListener("abort",()=>{N.abort(),A(Pe())}),N.send(m.body)})}(d,a)};function ye(d){if(!d||d.indexOf("://")<=0||d.indexOf("data:image/")===0||d.indexOf("blob:")===0)return!0;const a=new URL(d),h=window.location;return a.protocol===h.protocol&&a.host===h.host}function Ae(d,a,h){h[d]&&h[d].indexOf(a)!==-1||(h[d]=h[d]||[],h[d].push(a))}function Be(d,a,h){if(h&&h[d]){const m=h[d].indexOf(a);m!==-1&&h[d].splice(m,1)}}class $e{constructor(a,h={}){cn(this,h),this.type=a}}class He extends $e{constructor(a,h={}){super("error",cn({error:a},h))}}class dt{on(a,h){return this._listeners=this._listeners||{},Ae(a,h,this._listeners),{unsubscribe:()=>{this.off(a,h)}}}off(a,h){return Be(a,h,this._listeners),Be(a,h,this._oneTimeListeners),this}once(a,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Ae(a,h,this._oneTimeListeners),this):new Promise(m=>this.once(a,m))}fire(a,h){typeof a=="string"&&(a=new $e(a,h||{}));const m=a.type;if(this.listens(m)){a.target=this;const b=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const z of b)z.call(this,a);const T=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const z of T)Be(m,z,this._oneTimeListeners),z.call(this,a);const A=this._eventedParent;A&&(cn(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),A.fire(a))}else a instanceof He&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,h){return this._eventedParent=a,this._eventedParentData=h,this}}var qe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const $t=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Jt(d,a){const h={};for(const m in d)m!=="ref"&&(h[m]=d[m]);return $t.forEach(m=>{m in a&&(h[m]=a[m])}),h}function Ie(d,a){if(Array.isArray(d)){if(!Array.isArray(a)||d.length!==a.length)return!1;for(let h=0;h<d.length;h++)if(!Ie(d[h],a[h]))return!1;return!0}if(typeof d=="object"&&d!==null&&a!==null){if(typeof a!="object"||Object.keys(d).length!==Object.keys(a).length)return!1;for(const h in d)if(!Ie(d[h],a[h]))return!1;return!0}return d===a}function ot(d,a){d.push(a)}function mt(d,a,h){ot(h,{command:"addSource",args:[d,a[d]]})}function Wt(d,a,h){ot(a,{command:"removeSource",args:[d]}),h[d]=!0}function nn(d,a,h,m){Wt(d,h,m),mt(d,a,h)}function mn(d,a,h){let m;for(m in d[h])if(Object.prototype.hasOwnProperty.call(d[h],m)&&m!=="data"&&!Ie(d[h][m],a[h][m]))return!1;for(m in a[h])if(Object.prototype.hasOwnProperty.call(a[h],m)&&m!=="data"&&!Ie(d[h][m],a[h][m]))return!1;return!0}function on(d,a,h,m,b,T){d=d||{},a=a||{};for(const A in d)Object.prototype.hasOwnProperty.call(d,A)&&(Ie(d[A],a[A])||h.push({command:T,args:[m,A,a[A],b]}));for(const A in a)Object.prototype.hasOwnProperty.call(a,A)&&!Object.prototype.hasOwnProperty.call(d,A)&&(Ie(d[A],a[A])||h.push({command:T,args:[m,A,a[A],b]}))}function sn(d){return d.id}function Dn(d,a){return d[a.id]=a,d}class Et{constructor(a,h,m,b){this.message=(a?`${a}: `:"")+m,b&&(this.identifier=b),h!=null&&h.__line__&&(this.line=h.__line__)}}function Gn(d,...a){for(const h of a)for(const m in h)d[m]=h[m];return d}class Fn extends Error{constructor(a,h){super(h),this.message=h,this.key=a}}class or{constructor(a,h=[]){this.parent=a,this.bindings={};for(const[m,b]of h)this.bindings[m]=b}concat(a){return new or(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const It={kind:"null"},nt={kind:"number"},qt={kind:"string"},hn={kind:"boolean"},kn={kind:"color"},Ir={kind:"projectionDefinition"},xr={kind:"object"},xe={kind:"value"},vt={kind:"collator"},Dt={kind:"formatted"},bt={kind:"padding"},St={kind:"colorArray"},pn={kind:"numberArray"},An={kind:"resolvedImage"},gn={kind:"variableAnchorOffsetCollection"};function Pn(d,a){return{kind:"array",itemType:d,N:a}}function Qt(d){if(d.kind==="array"){const a=Qt(d.itemType);return typeof d.N=="number"?`array<${a}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${a}>`}return d.kind}const Zn=[It,nt,qt,hn,kn,Ir,Dt,xr,Pn(xe),bt,pn,St,An,gn];function In(d,a){if(a.kind==="error")return null;if(d.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!In(d.itemType,a.itemType))&&(typeof d.N!="number"||d.N===a.N))return null}else{if(d.kind===a.kind)return null;if(d.kind==="value"){for(const h of Zn)if(!In(h,a))return null}}return`Expected ${Qt(d)} but found ${Qt(a)} instead.`}function Wn(d,a){return a.some(h=>h.kind===d.kind)}function tr(d,a){return a.some(h=>h==="null"?d===null:h==="array"?Array.isArray(d):h==="object"?d&&!Array.isArray(d)&&typeof d=="object":h===typeof d)}function Or(d,a){return d.kind==="array"&&a.kind==="array"?d.itemType.kind===a.itemType.kind&&typeof d.N=="number":d.kind===a.kind}const Fr=.96422,wr=.82521,ur=4/29,ui=6/29,kr=3*ui*ui,Eo=ui*ui*ui,Ys=Math.PI/180,Jo=180/Math.PI;function Ra(d){return(d%=360)<0&&(d+=360),d}function Zr([d,a,h,m]){let b,T;const A=Xi((.2225045*(d=uo(d))+.7168786*(a=uo(a))+.0606169*(h=uo(h)))/1);d===a&&a===h?b=T=A:(b=Xi((.4360747*d+.3850649*a+.1430804*h)/Fr),T=Xi((.0139322*d+.0971045*a+.7141733*h)/wr));const z=116*A-16;return[z<0?0:z,500*(b-A),200*(A-T),m]}function uo(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function Xi(d){return d>Eo?Math.pow(d,1/3):d/kr+ur}function ho([d,a,h,m]){let b=(d+16)/116,T=isNaN(a)?b:b+a/500,A=isNaN(h)?b:b-h/200;return b=1*Nr(b),T=Fr*Nr(T),A=wr*Nr(A),[Vi(3.1338561*T-1.6168667*b-.4906146*A),Vi(-.9787684*T+1.9161415*b+.033454*A),Vi(.0719453*T-.2289914*b+1.4052427*A),m]}function Vi(d){return(d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055)<0?0:d>1?1:d}function Nr(d){return d>ui?d*d*d:kr*(d-ur)}const io=Object.hasOwn||function(d,a){return Object.prototype.hasOwnProperty.call(d,a)};function Er(d,a){return io(d,a)?d[a]:void 0}function ha(d){return parseInt(d.padEnd(2,d),16)/255}function La(d,a){return Zl(a?d/100:d,0,1)}function Zl(d,a,h){return Math.min(Math.max(a,d),h)}function nf(d){return!d.some(Number.isNaN)}const Oh={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Qo(d,a,h){return d+h*(a-d)}function No(d,a,h){return d.map((m,b)=>Qo(m,a[b],h))}class yr{constructor(a,h,m,b=1,T=!0){this.r=a,this.g=h,this.b=m,this.a=b,T||(this.r*=b,this.g*=b,this.b*=b,b||this.overwriteGetter("rgb",[a,h,m,b]))}static parse(a){if(a instanceof yr)return a;if(typeof a!="string")return;const h=function(m){if((m=m.toLowerCase().trim())==="transparent")return[0,0,0,0];const b=Er(Oh,m);if(b){const[A,z,N]=b;return[A/255,z/255,N/255,1]}if(m.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(m)){const A=m.length<6?1:2;let z=1;return[ha(m.slice(z,z+=A)),ha(m.slice(z,z+=A)),ha(m.slice(z,z+=A)),ha(m.slice(z,z+A)||"ff")]}if(m.startsWith("rgb")){const A=m.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(A){const[z,N,j,Y,te,he,pe,ge,_e,De,Ve,ft]=A,tt=[Y||" ",pe||" ",De].join("");if(tt==="  "||tt==="  /"||tt===",,"||tt===",,,"){const de=[j,he,_e].join(""),ke=de==="%%%"?100:de===""?255:0;if(ke){const it=[Zl(+N/ke,0,1),Zl(+te/ke,0,1),Zl(+ge/ke,0,1),Ve?La(+Ve,ft):1];if(nf(it))return it}}return}}const T=m.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[A,z,N,j,Y,te,he,pe,ge]=T,_e=[N||" ",Y||" ",he].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const De=[+z,Zl(+j,0,100),Zl(+te,0,100),pe?La(+pe,ge):1];if(nf(De))return function([Ve,ft,tt,de]){function ke(it){const Rt=(it+Ve/30)%12,an=ft*Math.min(tt,1-tt);return tt-an*Math.max(-1,Math.min(Rt-3,9-Rt,1))}return Ve=Ra(Ve),ft/=100,tt/=100,[ke(0),ke(8),ke(4),de]}(De)}}}(a);return h?new yr(...h,!1):void 0}get rgb(){const{r:a,g:h,b:m,a:b}=this,T=b||1/0;return this.overwriteGetter("rgb",[a/T,h/T,m/T,b])}get hcl(){return this.overwriteGetter("hcl",function(a){const[h,m,b,T]=Zr(a),A=Math.sqrt(m*m+b*b);return[Math.round(1e4*A)?Ra(Math.atan2(b,m)*Jo):NaN,A,h,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Zr(this.rgb))}overwriteGetter(a,h){return Object.defineProperty(this,a,{value:h}),h}toString(){const[a,h,m,b]=this.rgb;return`rgba(${[a,h,m].map(T=>Math.round(255*T)).join(",")},${b})`}static interpolate(a,h,m,b="rgb"){switch(b){case"rgb":{const[T,A,z,N]=No(a.rgb,h.rgb,m);return new yr(T,A,z,N,!1)}case"hcl":{const[T,A,z,N]=a.hcl,[j,Y,te,he]=h.hcl;let pe,ge;if(isNaN(T)||isNaN(j))isNaN(T)?isNaN(j)?pe=NaN:(pe=j,z!==1&&z!==0||(ge=Y)):(pe=T,te!==1&&te!==0||(ge=A));else{let tt=j-T;j>T&&tt>180?tt-=360:j<T&&T-j>180&&(tt+=360),pe=T+m*tt}const[_e,De,Ve,ft]=function([tt,de,ke,it]){return tt=isNaN(tt)?0:tt*Ys,ho([ke,Math.cos(tt)*de,Math.sin(tt)*de,it])}([pe,ge??Qo(A,Y,m),Qo(z,te,m),Qo(N,he,m)]);return new yr(_e,De,Ve,ft,!1)}case"lab":{const[T,A,z,N]=ho(No(a.lab,h.lab,m));return new yr(T,A,z,N,!1)}}}}yr.black=new yr(0,0,0,1),yr.white=new yr(1,1,1,1),yr.transparent=new yr(0,0,0,0),yr.red=new yr(1,0,0,1);class Ks{constructor(a,h,m){this.sensitivity=a?h?"variant":"case":h?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,h){return this.collator.compare(a,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Yl=["bottom","center","top"];class Oc{constructor(a,h,m,b,T,A){this.text=a,this.image=h,this.scale=m,this.fontStack=b,this.textColor=T,this.verticalAlign=A}}class Di{constructor(a){this.sections=a}static fromString(a){return new Di([new Oc(a,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof Di?a:Di.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class Zi{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Zi)return a;if(typeof a=="number")return new Zi([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const h of a)if(typeof h!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new Zi(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,m){return new Zi(No(a.values,h.values,m))}}class To{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof To)return a;if(typeof a=="number")return new To([a]);if(Array.isArray(a)){for(const h of a)if(typeof h!="number")return;return new To(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,m){return new To(No(a.values,h.values,m))}}class Ni{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Ni)return a;if(typeof a=="string"){const m=yr.parse(a);return m?new Ni([m]):void 0}if(!Array.isArray(a))return;const h=[];for(const m of a){if(typeof m!="string")return;const b=yr.parse(m);if(!b)return;h.push(b)}return new Ni(h)}toString(){return JSON.stringify(this.values)}static interpolate(a,h,m,b="rgb"){const T=[];if(a.values.length!=h.values.length)throw new Error(`colorArray: Arrays have mismatched length (${a.values.length} vs. ${h.values.length}), cannot interpolate.`);for(let A=0;A<a.values.length;A++)T.push(yr.interpolate(a.values[A],h.values[A],m,b));return new Ni(T)}}class Ai extends Error{constructor(a){super(a),this.name="RuntimeError"}toJSON(){return this.message}}const Fh=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Tr{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof Tr)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let h=0;h<a.length;h+=2){const m=a[h],b=a[h+1];if(typeof m!="string"||!Fh.has(m)||!Array.isArray(b)||b.length!==2||typeof b[0]!="number"||typeof b[1]!="number")return}return new Tr(a)}}toString(){return JSON.stringify(this.values)}static interpolate(a,h,m){const b=a.values,T=h.values;if(b.length!==T.length)throw new Ai(`Cannot interpolate values of different length. from: ${a.toString()}, to: ${h.toString()}`);const A=[];for(let z=0;z<b.length;z+=2){if(b[z]!==T[z])throw new Ai(`Cannot interpolate values containing mismatched anchors. from[${z}]: ${b[z]}, to[${z}]: ${T[z]}`);A.push(b[z]);const[N,j]=b[z+1],[Y,te]=T[z+1];A.push([Qo(N,Y,m),Qo(j,te,m)])}return new Tr(A)}}class es{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new es({name:a,available:!1}):null}}class _r{constructor(a,h,m){this.from=a,this.to=h,this.transition=m}static interpolate(a,h,m){return new _r(a,h,m)}static parse(a){return a instanceof _r?a:Array.isArray(a)&&a.length===3&&typeof a[0]=="string"&&typeof a[1]=="string"&&typeof a[2]=="number"?new _r(a[0],a[1],a[2]):typeof a=="object"&&typeof a.from=="string"&&typeof a.to=="string"&&typeof a.transition=="number"?new _r(a.from,a.to,a.transition):typeof a=="string"?new _r(a,a,1):void 0}}function vr(d,a,h,m){return typeof d=="number"&&d>=0&&d<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof h=="number"&&h>=0&&h<=255?m===void 0||typeof m=="number"&&m>=0&&m<=1?null:`Invalid rgba value [${[d,a,h,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof m=="number"?[d,a,h,m]:[d,a,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function da(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof _r||d instanceof yr||d instanceof Ks||d instanceof Di||d instanceof Zi||d instanceof To||d instanceof Ni||d instanceof Tr||d instanceof es)return!0;if(Array.isArray(d)){for(const a of d)if(!da(a))return!1;return!0}if(typeof d=="object"){for(const a in d)if(!da(d[a]))return!1;return!0}return!1}function sr(d){if(d===null)return It;if(typeof d=="string")return qt;if(typeof d=="boolean")return hn;if(typeof d=="number")return nt;if(d instanceof yr)return kn;if(d instanceof _r)return Ir;if(d instanceof Ks)return vt;if(d instanceof Di)return Dt;if(d instanceof Zi)return bt;if(d instanceof To)return pn;if(d instanceof Ni)return St;if(d instanceof Tr)return gn;if(d instanceof es)return An;if(Array.isArray(d)){const a=d.length;let h;for(const m of d){const b=sr(m);if(h){if(h===b)continue;h=xe;break}h=b}return Pn(h||xe,a)}return xr}function ka(d){const a=typeof d;return d===null?"":a==="string"||a==="number"||a==="boolean"?String(d):d instanceof yr||d instanceof _r||d instanceof Di||d instanceof Zi||d instanceof To||d instanceof Ni||d instanceof Tr||d instanceof es?d.toString():JSON.stringify(d)}class ts{constructor(a,h){this.type=a,this.value=h}static parse(a,h){if(a.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!da(a[1]))return h.error("invalid value");const m=a[1];let b=sr(m);const T=h.expectedType;return b.kind!=="array"||b.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(b=T),new ts(b,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Cu={string:qt,number:nt,boolean:hn,object:xr};class Bo{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let m,b=1;const T=a[0];if(T==="array"){let z,N;if(a.length>2){const j=a[1];if(typeof j!="string"||!(j in Cu)||j==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);z=Cu[j],b++}else z=xe;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return h.error('The length argument to "array" must be a positive integer literal',2);N=a[2],b++}m=Pn(z,N)}else{if(!Cu[T])throw new Error(`Types doesn't contain name = ${T}`);m=Cu[T]}const A=[];for(;b<a.length;b++){const z=h.parse(a[b],b,xe);if(!z)return null;A.push(z)}return new Bo(m,A)}evaluate(a){for(let h=0;h<this.args.length;h++){const m=this.args[h].evaluate(a);if(!In(this.type,sr(m)))return m;if(h===this.args.length-1)throw new Ai(`Expected value to be of type ${Qt(this.type)}, but found ${Qt(sr(m))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Eu={"to-boolean":hn,"to-color":kn,"to-number":nt,"to-string":qt};class Js{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const m=a[0];if(!Eu[m])throw new Error(`Can't parse ${m} as it is not part of the known types`);if((m==="to-boolean"||m==="to-string")&&a.length!==2)return h.error("Expected one argument.");const b=Eu[m],T=[];for(let A=1;A<a.length;A++){const z=h.parse(a[A],A,xe);if(!z)return null;T.push(z)}return new Js(b,T)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let h,m;for(const b of this.args){if(h=b.evaluate(a),m=null,h instanceof yr)return h;if(typeof h=="string"){const T=a.parseColor(h);if(T)return T}else if(Array.isArray(h)&&(m=h.length<3||h.length>4?`Invalid rgba value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:vr(h[0],h[1],h[2],h[3]),!m))return new yr(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Ai(m||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(const m of this.args){h=m.evaluate(a);const b=Zi.parse(h);if(b)return b}throw new Ai(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"numberArray":{let h;for(const m of this.args){h=m.evaluate(a);const b=To.parse(h);if(b)return b}throw new Ai(`Could not parse numberArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"colorArray":{let h;for(const m of this.args){h=m.evaluate(a);const b=Ni.parse(h);if(b)return b}throw new Ai(`Could not parse colorArray from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(const m of this.args){h=m.evaluate(a);const b=Tr.parse(h);if(b)return b}throw new Ai(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(const m of this.args){if(h=m.evaluate(a),h===null)return 0;const b=Number(h);if(!isNaN(b))return b}throw new Ai(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return Di.fromString(ka(this.args[0].evaluate(a)));case"resolvedImage":return es.fromString(ka(this.args[0].evaluate(a)));case"projectionDefinition":return this.args[0].evaluate(a);default:return ka(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Cp=["Unknown","Point","LineString","Polygon"];class cl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Cp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let h=this._parseColorCache.get(a);return h||(h=yr.parse(a),this._parseColorCache.set(a,h)),h}}class Fc{constructor(a,h,m=[],b,T=new or,A=[]){this.registry=a,this.path=m,this.key=m.map(z=>`[${z}]`).join(""),this.scope=T,this.errors=A,this.expectedType=b,this._isConstant=h}parse(a,h,m,b,T={}){return h?this.concat(h,m,b)._parse(a,T):this._parse(a,T)}_parse(a,h){function m(b,T,A){return A==="assert"?new Bo(T,[b]):A==="coerce"?new Js(T,[b]):b}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const b=a[0];if(typeof b!="string")return this.error(`Expression name must be a string, but found ${typeof b} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[b];if(T){let A=T.parse(a,this);if(!A)return null;if(this.expectedType){const z=this.expectedType,N=A.type;if(z.kind!=="string"&&z.kind!=="number"&&z.kind!=="boolean"&&z.kind!=="object"&&z.kind!=="array"||N.kind!=="value"){if(z.kind==="projectionDefinition"&&["string","array"].includes(N.kind)||["color","formatted","resolvedImage"].includes(z.kind)&&["value","string"].includes(N.kind)||["padding","numberArray"].includes(z.kind)&&["value","number","array"].includes(N.kind)||z.kind==="colorArray"&&["value","string","array"].includes(N.kind)||z.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(N.kind))A=m(A,z,h.typeAnnotation||"coerce");else if(this.checkSubtype(z,N))return null}else A=m(A,z,h.typeAnnotation||"assert")}if(!(A instanceof ts)&&A.type.kind!=="resolvedImage"&&this._isConstant(A)){const z=new cl;try{A=new ts(A.type,A.evaluate(z))}catch(N){return this.error(N.message),null}}return A}return this.error(`Unknown expression "${b}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,h,m){const b=typeof a=="number"?this.path.concat(a):this.path,T=m?this.scope.concat(m):this.scope;return new Fc(this.registry,this._isConstant,b,h||null,T,this.errors)}error(a,...h){const m=`${this.key}${h.map(b=>`[${b}]`).join("")}`;this.errors.push(new Fn(m,a))}checkSubtype(a,h){const m=In(a,h);return m&&this.error(m),m}}class Kl{constructor(a,h){this.type=h.type,this.bindings=[].concat(a),this.result=h}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const h of this.bindings)a(h[1]);a(this.result)}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const m=[];for(let T=1;T<a.length-1;T+=2){const A=a[T];if(typeof A!="string")return h.error(`Expected string, but found ${typeof A} instead.`,T);if(/[^a-zA-Z0-9_]/.test(A))return h.error("Variable names must contain only alphanumeric characters or '_'.",T);const z=h.parse(a[T+1],T+1);if(!z)return null;m.push([A,z])}const b=h.parse(a[a.length-1],a.length-1,h.expectedType,m);return b?new Kl(m,b):null}outputDefined(){return this.result.outputDefined()}}class Qs{constructor(a,h){this.type=h.type,this.name=a,this.boundExpression=h}static parse(a,h){if(a.length!==2||typeof a[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");const m=a[1];return h.scope.has(m)?new Qs(m,h.scope.get(m)):h.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class ji{constructor(a,h,m){this.type=a,this.index=h,this.input=m}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const m=h.parse(a[1],1,nt),b=h.parse(a[2],2,Pn(h.expectedType||xe));return m&&b?new ji(b.type.itemType,m,b):null}evaluate(a){const h=this.index.evaluate(a),m=this.input.evaluate(a);if(h<0)throw new Ai(`Array index out of bounds: ${h} < 0.`);if(h>=m.length)throw new Ai(`Array index out of bounds: ${h} > ${m.length-1}.`);if(h!==Math.floor(h))throw new Ai(`Array index must be an integer, but found ${h} instead.`);return m[h]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class ul{constructor(a,h){this.type=hn,this.needle=a,this.haystack=h}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const m=h.parse(a[1],1,xe),b=h.parse(a[2],2,xe);return m&&b?Wn(m.type,[hn,qt,nt,It,xe])?new ul(m,b):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qt(m.type)} instead`):null}evaluate(a){const h=this.needle.evaluate(a),m=this.haystack.evaluate(a);if(!m)return!1;if(!tr(h,["boolean","string","number","null"]))throw new Ai(`Expected first argument to be of type boolean, string, number or null, but found ${Qt(sr(h))} instead.`);if(!tr(m,["string","array"]))throw new Ai(`Expected second argument to be of type array or string, but found ${Qt(sr(m))} instead.`);return m.indexOf(h)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class Tu{constructor(a,h,m){this.type=nt,this.needle=a,this.haystack=h,this.fromIndex=m}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const m=h.parse(a[1],1,xe),b=h.parse(a[2],2,xe);if(!m||!b)return null;if(!Wn(m.type,[hn,qt,nt,It,xe]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qt(m.type)} instead`);if(a.length===4){const T=h.parse(a[3],3,nt);return T?new Tu(m,b,T):null}return new Tu(m,b)}evaluate(a){const h=this.needle.evaluate(a),m=this.haystack.evaluate(a);if(!tr(h,["boolean","string","number","null"]))throw new Ai(`Expected first argument to be of type boolean, string, number or null, but found ${Qt(sr(h))} instead.`);let b;if(this.fromIndex&&(b=this.fromIndex.evaluate(a)),tr(m,["string"])){const T=m.indexOf(h,b);return T===-1?-1:[...m.slice(0,T)].length}if(tr(m,["array"]))return m.indexOf(h,b);throw new Ai(`Expected second argument to be of type array or string, but found ${Qt(sr(m))} instead.`)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class fo{constructor(a,h,m,b,T,A){this.inputType=a,this.type=h,this.input=m,this.cases=b,this.outputs=T,this.otherwise=A}static parse(a,h){if(a.length<5)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return h.error("Expected an even number of arguments.");let m,b;h.expectedType&&h.expectedType.kind!=="value"&&(b=h.expectedType);const T={},A=[];for(let j=2;j<a.length-1;j+=2){let Y=a[j];const te=a[j+1];Array.isArray(Y)||(Y=[Y]);const he=h.concat(j);if(Y.length===0)return he.error("Expected at least one branch label.");for(const ge of Y){if(typeof ge!="number"&&typeof ge!="string")return he.error("Branch labels must be numbers or strings.");if(typeof ge=="number"&&Math.abs(ge)>Number.MAX_SAFE_INTEGER)return he.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ge=="number"&&Math.floor(ge)!==ge)return he.error("Numeric branch labels must be integer values.");if(m){if(he.checkSubtype(m,sr(ge)))return null}else m=sr(ge);if(T[String(ge)]!==void 0)return he.error("Branch labels must be unique.");T[String(ge)]=A.length}const pe=h.parse(te,j,b);if(!pe)return null;b=b||pe.type,A.push(pe)}const z=h.parse(a[1],1,xe);if(!z)return null;const N=h.parse(a[a.length-1],a.length-1,b);return N?z.type.kind!=="value"&&h.concat(1).checkSubtype(m,z.type)?null:new fo(m,b,z,T,A,N):null}evaluate(a){const h=this.input.evaluate(a);return(sr(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class Si{constructor(a,h,m){this.type=a,this.branches=h,this.otherwise=m}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return h.error("Expected an odd number of arguments.");let m;h.expectedType&&h.expectedType.kind!=="value"&&(m=h.expectedType);const b=[];for(let A=1;A<a.length-1;A+=2){const z=h.parse(a[A],A,hn);if(!z)return null;const N=h.parse(a[A+1],A+1,m);if(!N)return null;b.push([z,N]),m=m||N.type}const T=h.parse(a[a.length-1],a.length-1,m);if(!T)return null;if(!m)throw new Error("Can't infer output type");return new Si(m,b,T)}evaluate(a){for(const[h,m]of this.branches)if(h.evaluate(a))return m.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[h,m]of this.branches)a(h),a(m);a(this.otherwise)}outputDefined(){return this.branches.every(([a,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class Nc{constructor(a,h,m,b){this.type=a,this.input=h,this.beginIndex=m,this.endIndex=b}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const m=h.parse(a[1],1,xe),b=h.parse(a[2],2,nt);if(!m||!b)return null;if(!Wn(m.type,[Pn(xe),qt,xe]))return h.error(`Expected first argument to be of type array or string, but found ${Qt(m.type)} instead`);if(a.length===4){const T=h.parse(a[3],3,nt);return T?new Nc(m.type,m,b,T):null}return new Nc(m.type,m,b)}evaluate(a){const h=this.input.evaluate(a),m=this.beginIndex.evaluate(a);let b;if(this.endIndex&&(b=this.endIndex.evaluate(a)),tr(h,["string"]))return[...h].slice(m,b).join("");if(tr(h,["array"]))return h.slice(m,b);throw new Ai(`Expected first argument to be of type array or string, but found ${Qt(sr(h))} instead.`)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function Da(d,a){const h=d.length-1;let m,b,T=0,A=h,z=0;for(;T<=A;)if(z=Math.floor((T+A)/2),m=d[z],b=d[z+1],m<=a){if(z===h||a<b)return z;T=z+1}else{if(!(m>a))throw new Ai("Input is not a number.");A=z-1}return 0}class Pu{constructor(a,h,m){this.type=a,this.input=h,this.labels=[],this.outputs=[];for(const[b,T]of m)this.labels.push(b),this.outputs.push(T)}static parse(a,h){if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");const m=h.parse(a[1],1,nt);if(!m)return null;const b=[];let T=null;h.expectedType&&h.expectedType.kind!=="value"&&(T=h.expectedType);for(let A=1;A<a.length;A+=2){const z=A===1?-1/0:a[A],N=a[A+1],j=A,Y=A+1;if(typeof z!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(b.length&&b[b.length-1][0]>=z)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const te=h.parse(N,Y,T);if(!te)return null;T=T||te.type,b.push([z,te])}return new Pu(T,m,b)}evaluate(a){const h=this.labels,m=this.outputs;if(h.length===1)return m[0].evaluate(a);const b=this.input.evaluate(a);if(b<=h[0])return m[0].evaluate(a);const T=h.length;return b>=h[T-1]?m[T-1].evaluate(a):m[Da(h,b)].evaluate(a)}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Ep(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var za,hl,Au=function(){if(hl)return za;function d(a,h,m,b){this.cx=3*a,this.bx=3*(m-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*h,this.by=3*(b-h)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=h,this.p2x=m,this.p2y=b}return hl=1,za=d,d.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,h){if(h===void 0&&(h=1e-6),a<0)return 0;if(a>1)return 1;for(var m=a,b=0;b<8;b++){var T=this.sampleCurveX(m)-a;if(Math.abs(T)<h)return m;var A=this.sampleCurveDerivativeX(m);if(Math.abs(A)<1e-6)break;m-=T/A}var z=0,N=1;for(m=a,b=0;b<20&&(T=this.sampleCurveX(m),!(Math.abs(T-a)<h));b++)a>T?z=m:N=m,m=.5*(N-z)+z;return m},solve:function(a,h){return this.sampleCurveY(this.solveCurveX(a,h))}},za}(),rg=Ep(Au);class ns{constructor(a,h,m,b,T){this.type=a,this.operator=h,this.interpolation=m,this.input=b,this.labels=[],this.outputs=[];for(const[A,z]of T)this.labels.push(A),this.outputs.push(z)}static interpolationFactor(a,h,m,b){let T=0;if(a.name==="exponential")T=Iu(h,a.base,m,b);else if(a.name==="linear")T=Iu(h,1,m,b);else if(a.name==="cubic-bezier"){const A=a.controlPoints;T=new rg(A[0],A[1],A[2],A[3]).solve(Iu(h,1,m,b))}return T}static parse(a,h){let[m,b,T,...A]=a;if(!Array.isArray(b)||b.length===0)return h.error("Expected an interpolation type expression.",1);if(b[0]==="linear")b={name:"linear"};else if(b[0]==="exponential"){const j=b[1];if(typeof j!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);b={name:"exponential",base:j}}else{if(b[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(b[0])}`,1,0);{const j=b.slice(1);if(j.length!==4||j.some(Y=>typeof Y!="number"||Y<0||Y>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);b={name:"cubic-bezier",controlPoints:j}}}if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(T=h.parse(T,2,nt),!T)return null;const z=[];let N=null;m!=="interpolate-hcl"&&m!=="interpolate-lab"||h.expectedType==St?h.expectedType&&h.expectedType.kind!=="value"&&(N=h.expectedType):N=kn;for(let j=0;j<A.length;j+=2){const Y=A[j],te=A[j+1],he=j+3,pe=j+4;if(typeof Y!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',he);if(z.length&&z[z.length-1][0]>=Y)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',he);const ge=h.parse(te,pe,N);if(!ge)return null;N=N||ge.type,z.push([Y,ge])}return Or(N,nt)||Or(N,Ir)||Or(N,kn)||Or(N,bt)||Or(N,pn)||Or(N,St)||Or(N,gn)||Or(N,Pn(nt))?new ns(N,m,b,T,z):h.error(`Type ${Qt(N)} is not interpolatable.`)}evaluate(a){const h=this.labels,m=this.outputs;if(h.length===1)return m[0].evaluate(a);const b=this.input.evaluate(a);if(b<=h[0])return m[0].evaluate(a);const T=h.length;if(b>=h[T-1])return m[T-1].evaluate(a);const A=Da(h,b),z=ns.interpolationFactor(this.interpolation,b,h[A],h[A+1]),N=m[A].evaluate(a),j=m[A+1].evaluate(a);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Qo(N,j,z);case"color":return yr.interpolate(N,j,z);case"padding":return Zi.interpolate(N,j,z);case"colorArray":return Ni.interpolate(N,j,z);case"numberArray":return To.interpolate(N,j,z);case"variableAnchorOffsetCollection":return Tr.interpolate(N,j,z);case"array":return No(N,j,z);case"projectionDefinition":return _r.interpolate(N,j,z)}case"interpolate-hcl":switch(this.type.kind){case"color":return yr.interpolate(N,j,z,"hcl");case"colorArray":return Ni.interpolate(N,j,z,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return yr.interpolate(N,j,z,"lab");case"colorArray":return Ni.interpolate(N,j,z,"lab")}}}eachChild(a){a(this.input);for(const h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Iu(d,a,h,m){const b=m-h,T=d-h;return b===0?0:a===1?T/b:(Math.pow(a,T)-1)/(Math.pow(a,b)-1)}const Ls={color:yr.interpolate,number:Qo,padding:Zi.interpolate,numberArray:To.interpolate,colorArray:Ni.interpolate,variableAnchorOffsetCollection:Tr.interpolate,array:No};class Uo{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let m=null;const b=h.expectedType;b&&b.kind!=="value"&&(m=b);const T=[];for(const z of a.slice(1)){const N=h.parse(z,1+T.length,m,void 0,{typeAnnotation:"omit"});if(!N)return null;m=m||N.type,T.push(N)}if(!m)throw new Error("No output type");const A=b&&T.some(z=>In(b,z.type));return new Uo(A?xe:m,T)}evaluate(a){let h,m=null,b=0;for(const T of this.args)if(b++,m=T.evaluate(a),m&&m instanceof es&&!m.available&&(h||(h=m.name),m=null,b===this.args.length&&(m=h)),m!==null)break;return m}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}function Tp(d,a){return d==="=="||d==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function Nh(d,a,h,m){return m.compare(a,h)===0}function Ru(d,a,h){const m=d!=="=="&&d!=="!=";return class SN{constructor(T,A,z){this.type=hn,this.lhs=T,this.rhs=A,this.collator=z,this.hasUntypedArgument=T.type.kind==="value"||A.type.kind==="value"}static parse(T,A){if(T.length!==3&&T.length!==4)return A.error("Expected two or three arguments.");const z=T[0];let N=A.parse(T[1],1,xe);if(!N)return null;if(!Tp(z,N.type))return A.concat(1).error(`"${z}" comparisons are not supported for type '${Qt(N.type)}'.`);let j=A.parse(T[2],2,xe);if(!j)return null;if(!Tp(z,j.type))return A.concat(2).error(`"${z}" comparisons are not supported for type '${Qt(j.type)}'.`);if(N.type.kind!==j.type.kind&&N.type.kind!=="value"&&j.type.kind!=="value")return A.error(`Cannot compare types '${Qt(N.type)}' and '${Qt(j.type)}'.`);m&&(N.type.kind==="value"&&j.type.kind!=="value"?N=new Bo(j.type,[N]):N.type.kind!=="value"&&j.type.kind==="value"&&(j=new Bo(N.type,[j])));let Y=null;if(T.length===4){if(N.type.kind!=="string"&&j.type.kind!=="string"&&N.type.kind!=="value"&&j.type.kind!=="value")return A.error("Cannot use collator to compare non-string types.");if(Y=A.parse(T[3],3,vt),!Y)return null}return new SN(N,j,Y)}evaluate(T){const A=this.lhs.evaluate(T),z=this.rhs.evaluate(T);if(m&&this.hasUntypedArgument){const N=sr(A),j=sr(z);if(N.kind!==j.kind||N.kind!=="string"&&N.kind!=="number")throw new Ai(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${N.kind}, ${j.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const N=sr(A),j=sr(z);if(N.kind!=="string"||j.kind!=="string")return a(T,A,z)}return this.collator?h(T,A,z,this.collator.evaluate(T)):a(T,A,z)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const Pp=Ru("==",function(d,a,h){return a===h},Nh),wy=Ru("!=",function(d,a,h){return a!==h},function(d,a,h,m){return!Nh(0,a,h,m)}),ig=Ru("<",function(d,a,h){return a<h},function(d,a,h,m){return m.compare(a,h)<0}),Sy=Ru(">",function(d,a,h){return a>h},function(d,a,h,m){return m.compare(a,h)>0}),My=Ru("<=",function(d,a,h){return a<=h},function(d,a,h,m){return m.compare(a,h)<=0}),rf=Ru(">=",function(d,a,h){return a>=h},function(d,a,h,m){return m.compare(a,h)>=0});class of{constructor(a,h,m){this.type=vt,this.locale=m,this.caseSensitive=a,this.diacriticSensitive=h}static parse(a,h){if(a.length!==2)return h.error("Expected one argument.");const m=a[1];if(typeof m!="object"||Array.isArray(m))return h.error("Collator options argument must be an object.");const b=h.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,hn);if(!b)return null;const T=h.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,hn);if(!T)return null;let A=null;return m.locale&&(A=h.parse(m.locale,1,qt),!A)?null:new of(b,T,A)}evaluate(a){return new Ks(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}class Lu{constructor(a,h,m,b,T){this.type=qt,this.number=a,this.locale=h,this.currency=m,this.minFractionDigits=b,this.maxFractionDigits=T}static parse(a,h){if(a.length!==3)return h.error("Expected two arguments.");const m=h.parse(a[1],1,nt);if(!m)return null;const b=a[2];if(typeof b!="object"||Array.isArray(b))return h.error("NumberFormat options argument must be an object.");let T=null;if(b.locale&&(T=h.parse(b.locale,1,qt),!T))return null;let A=null;if(b.currency&&(A=h.parse(b.currency,1,qt),!A))return null;let z=null;if(b["min-fraction-digits"]&&(z=h.parse(b["min-fraction-digits"],1,nt),!z))return null;let N=null;return b["max-fraction-digits"]&&(N=h.parse(b["max-fraction-digits"],1,nt),!N)?null:new Lu(m,T,A,z,N)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class Bh{constructor(a){this.type=Dt,this.sections=a}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");const m=a[1];if(!Array.isArray(m)&&typeof m=="object")return h.error("First argument must be an image or text section.");const b=[];let T=!1;for(let A=1;A<=a.length-1;++A){const z=a[A];if(T&&typeof z=="object"&&!Array.isArray(z)){T=!1;let N=null;if(z["font-scale"]&&(N=h.parse(z["font-scale"],1,nt),!N))return null;let j=null;if(z["text-font"]&&(j=h.parse(z["text-font"],1,Pn(qt)),!j))return null;let Y=null;if(z["text-color"]&&(Y=h.parse(z["text-color"],1,kn),!Y))return null;let te=null;if(z["vertical-align"]){if(typeof z["vertical-align"]=="string"&&!Yl.includes(z["vertical-align"]))return h.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${z["vertical-align"]}' instead.`);if(te=h.parse(z["vertical-align"],1,qt),!te)return null}const he=b[b.length-1];he.scale=N,he.font=j,he.textColor=Y,he.verticalAlign=te}else{const N=h.parse(a[A],1,xe);if(!N)return null;const j=N.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,b.push({content:N,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Bh(b)}evaluate(a){return new Di(this.sections.map(h=>{const m=h.content.evaluate(a);return sr(m)===An?new Oc("",m,null,null,null,h.verticalAlign?h.verticalAlign.evaluate(a):null):new Oc(ka(m),null,h.scale?h.scale.evaluate(a):null,h.font?h.font.evaluate(a).join(","):null,h.textColor?h.textColor.evaluate(a):null,h.verticalAlign?h.verticalAlign.evaluate(a):null)}))}eachChild(a){for(const h of this.sections)a(h.content),h.scale&&a(h.scale),h.font&&a(h.font),h.textColor&&a(h.textColor),h.verticalAlign&&a(h.verticalAlign)}outputDefined(){return!1}}class Ap{constructor(a){this.type=An,this.input=a}static parse(a,h){if(a.length!==2)return h.error("Expected two arguments.");const m=h.parse(a[1],1,qt);return m?new Ap(m):h.error("No image name provided.")}evaluate(a){const h=this.input.evaluate(a),m=es.fromString(h);return m&&a.availableImages&&(m.available=a.availableImages.indexOf(h)>-1),m}eachChild(a){a(this.input)}outputDefined(){return!1}}class sf{constructor(a){this.type=nt,this.input=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const m=h.parse(a[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Qt(m.type)} instead.`):new sf(m):null}evaluate(a){const h=this.input.evaluate(a);if(typeof h=="string")return[...h].length;if(Array.isArray(h))return h.length;throw new Ai(`Expected value to be of type string or array, but found ${Qt(sr(h))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const fa=8192;function Cy(d,a){const h=(180+d[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,b=Math.pow(2,a.z);return[Math.round(h*b*fa),Math.round(m*b*fa)]}function Ip(d,a){const h=Math.pow(2,a.z);return[(b=(d[0]/fa+a.x)/h,360*b-180),(m=(d[1]/fa+a.y)/h,360/Math.PI*Math.atan(Math.exp((180-360*m)*Math.PI/180))-90)];var m,b}function Uh(d,a){d[0]=Math.min(d[0],a[0]),d[1]=Math.min(d[1],a[1]),d[2]=Math.max(d[2],a[0]),d[3]=Math.max(d[3],a[1])}function $h(d,a){return!(d[0]<=a[0]||d[2]>=a[2]||d[1]<=a[1]||d[3]>=a[3])}function og(d,a,h){const m=d[0]-a[0],b=d[1]-a[1],T=d[0]-h[0],A=d[1]-h[1];return m*A-T*b==0&&m*T<=0&&b*A<=0}function Vh(d,a,h,m){return(b=[m[0]-h[0],m[1]-h[1]])[0]*(T=[a[0]-d[0],a[1]-d[1]])[1]-b[1]*T[0]!=0&&!(!Hh(d,a,h,m)||!Hh(h,m,d,a));var b,T}function sg(d,a,h){for(const m of h)for(let b=0;b<m.length-1;++b)if(Vh(d,a,m[b],m[b+1]))return!0;return!1}function Jl(d,a,h=!1){let m=!1;for(const z of a)for(let N=0;N<z.length-1;N++){if(og(d,z[N],z[N+1]))return h;(T=z[N])[1]>(b=d)[1]!=(A=z[N+1])[1]>b[1]&&b[0]<(A[0]-T[0])*(b[1]-T[1])/(A[1]-T[1])+T[0]&&(m=!m)}var b,T,A;return m}function jh(d,a){for(const h of a)if(Jl(d,h))return!0;return!1}function ag(d,a){for(const h of d)if(!Jl(h,a))return!1;for(let h=0;h<d.length-1;++h)if(sg(d[h],d[h+1],a))return!1;return!0}function lg(d,a){for(const h of a)if(ag(d,h))return!0;return!1}function Hh(d,a,h,m){const b=m[0]-h[0],T=m[1]-h[1],A=(d[0]-h[0])*T-b*(d[1]-h[1]),z=(a[0]-h[0])*T-b*(a[1]-h[1]);return A>0&&z<0||A<0&&z>0}function af(d,a,h){const m=[];for(let b=0;b<d.length;b++){const T=[];for(let A=0;A<d[b].length;A++){const z=Cy(d[b][A],h);Uh(a,z),T.push(z)}m.push(T)}return m}function Rp(d,a,h){const m=[];for(let b=0;b<d.length;b++){const T=af(d[b],a,h);m.push(T)}return m}function Lp(d,a,h,m){if(d[0]<h[0]||d[0]>h[2]){const b=.5*m;let T=d[0]-h[0]>b?-m:h[0]-d[0]>b?m:0;T===0&&(T=d[0]-h[2]>b?-m:h[2]-d[0]>b?m:0),d[0]+=T}Uh(a,d)}function Ql(d,a,h,m){const b=Math.pow(2,m.z)*fa,T=[m.x*fa,m.y*fa],A=[];for(const z of d)for(const N of z){const j=[N.x+T[0],N.y+T[1]];Lp(j,a,h,b),A.push(j)}return A}function kp(d,a,h,m){const b=Math.pow(2,m.z)*fa,T=[m.x*fa,m.y*fa],A=[];for(const N of d){const j=[];for(const Y of N){const te=[Y.x+T[0],Y.y+T[1]];Uh(a,te),j.push(te)}A.push(j)}if(a[2]-a[0]<=b/2){(z=a)[0]=z[1]=1/0,z[2]=z[3]=-1/0;for(const N of A)for(const j of N)Lp(j,a,h,b)}var z;return A}class Bc{constructor(a,h){this.type=hn,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(da(a[1])){const m=a[1];if(m.type==="FeatureCollection"){const b=[];for(const T of m.features){const{type:A,coordinates:z}=T.geometry;A==="Polygon"&&b.push(z),A==="MultiPolygon"&&b.push(...z)}if(b.length)return new Bc(m,{type:"MultiPolygon",coordinates:b})}else if(m.type==="Feature"){const b=m.geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Bc(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new Bc(m,m)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,m){const b=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],A=h.canonicalID();if(m.type==="Polygon"){const z=af(m.coordinates,T,A),N=Ql(h.geometry(),b,T,A);if(!$h(b,T))return!1;for(const j of N)if(!Jl(j,z))return!1}if(m.type==="MultiPolygon"){const z=Rp(m.coordinates,T,A),N=Ql(h.geometry(),b,T,A);if(!$h(b,T))return!1;for(const j of N)if(!jh(j,z))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,m){const b=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],A=h.canonicalID();if(m.type==="Polygon"){const z=af(m.coordinates,T,A),N=kp(h.geometry(),b,T,A);if(!$h(b,T))return!1;for(const j of N)if(!ag(j,z))return!1}if(m.type==="MultiPolygon"){const z=Rp(m.coordinates,T,A),N=kp(h.geometry(),b,T,A);if(!$h(b,T))return!1;for(const j of N)if(!lg(j,z))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let cg=class{constructor(d=[],a=(h,m)=>h<m?-1:h>m?1:0){if(this.data=d,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(d){this.data.push(d),this._up(this.length++)}pop(){if(this.length===0)return;const d=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),d}peek(){return this.data[0]}_up(d){const{data:a,compare:h}=this,m=a[d];for(;d>0;){const b=d-1>>1,T=a[b];if(h(m,T)>=0)break;a[d]=T,d=b}a[d]=m}_down(d){const{data:a,compare:h}=this,m=this.length>>1,b=a[d];for(;d<m;){let T=1+(d<<1);const A=T+1;if(A<this.length&&h(a[A],a[T])<0&&(T=A),h(a[T],b)>=0)break;a[d]=a[T],d=T}a[d]=b}};function lf(d,a,h=0,m=d.length-1,b=Gh){for(;m>h;){if(m-h>600){const N=m-h+1,j=a-h+1,Y=Math.log(N),te=.5*Math.exp(2*Y/3),he=.5*Math.sqrt(Y*te*(N-te)/N)*(j-N/2<0?-1:1);lf(d,a,Math.max(h,Math.floor(a-j*te/N+he)),Math.min(m,Math.floor(a+(N-j)*te/N+he)),b)}const T=d[a];let A=h,z=m;for(Uc(d,h,a),b(d[m],T)>0&&Uc(d,h,m);A<z;){for(Uc(d,A,z),A++,z--;b(d[A],T)<0;)A++;for(;b(d[z],T)>0;)z--}b(d[h],T)===0?Uc(d,h,z):(z++,Uc(d,z,m)),z<=a&&(h=z+1),a<=z&&(m=z-1)}}function Uc(d,a,h){const m=d[a];d[a]=d[h],d[h]=m}function Gh(d,a){return d<a?-1:d>a?1:0}function ec(d,a){if(d.length<=1)return[d];const h=[];let m,b;for(const T of d){const A=Wh(T);A!==0&&(T.area=Math.abs(A),b===void 0&&(b=A<0),b===A<0?(m&&h.push(m),m=[T]):m.push(T))}if(m&&h.push(m),a>1)for(let T=0;T<h.length;T++)h[T].length<=a||(lf(h[T],a,1,h[T].length-1,Ey),h[T]=h[T].slice(0,a));return h}function Ey(d,a){return a.area-d.area}function Wh(d){let a=0;for(let h,m,b=0,T=d.length,A=T-1;b<T;A=b++)h=d[b],m=d[A],a+=(m.x-h.x)*(h.y+m.y);return a}const ug=1/298.257223563,Dp=ug*(2-ug),cf=Math.PI/180;class qh{constructor(a){const h=6378.137*cf*1e3,m=Math.cos(a*cf),b=1/(1-Dp*(1-m*m)),T=Math.sqrt(b);this.kx=h*T*m,this.ky=h*T*b*(1-Dp)}distance(a,h){const m=this.wrap(a[0]-h[0])*this.kx,b=(a[1]-h[1])*this.ky;return Math.sqrt(m*m+b*b)}pointOnLine(a,h){let m,b,T,A,z=1/0;for(let N=0;N<a.length-1;N++){let j=a[N][0],Y=a[N][1],te=this.wrap(a[N+1][0]-j)*this.kx,he=(a[N+1][1]-Y)*this.ky,pe=0;te===0&&he===0||(pe=(this.wrap(h[0]-j)*this.kx*te+(h[1]-Y)*this.ky*he)/(te*te+he*he),pe>1?(j=a[N+1][0],Y=a[N+1][1]):pe>0&&(j+=te/this.kx*pe,Y+=he/this.ky*pe)),te=this.wrap(h[0]-j)*this.kx,he=(h[1]-Y)*this.ky;const ge=te*te+he*he;ge<z&&(z=ge,m=j,b=Y,T=N,A=pe)}return{point:[m,b],index:T,t:Math.max(0,Math.min(1,A))}}wrap(a){for(;a<-180;)a+=360;for(;a>180;)a-=360;return a}}function jr(d,a){return a[0]-d[0]}function Xh(d){return d[1]-d[0]+1}function Oa(d,a){return d[1]>=d[0]&&d[1]<a}function zp(d,a){if(d[0]>d[1])return[null,null];const h=Xh(d);if(a){if(h===2)return[d,null];const b=Math.floor(h/2);return[[d[0],d[0]+b],[d[0]+b,d[1]]]}if(h===1)return[d,null];const m=Math.floor(h/2)-1;return[[d[0],d[0]+m],[d[0]+m+1,d[1]]]}function Op(d,a){if(!Oa(a,d.length))return[1/0,1/0,-1/0,-1/0];const h=[1/0,1/0,-1/0,-1/0];for(let m=a[0];m<=a[1];++m)Uh(h,d[m]);return h}function Fp(d){const a=[1/0,1/0,-1/0,-1/0];for(const h of d)for(const m of h)Uh(a,m);return a}function hg(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function Np(d,a,h){if(!hg(d)||!hg(a))return NaN;let m=0,b=0;return d[2]<a[0]&&(m=a[0]-d[2]),d[0]>a[2]&&(m=d[0]-a[2]),d[1]>a[3]&&(b=d[1]-a[3]),d[3]<a[1]&&(b=a[1]-d[3]),h.distance([0,0],[m,b])}function Po(d,a,h){const m=h.pointOnLine(a,d);return h.distance(d,m.point)}function $c(d,a,h,m,b){const T=Math.min(Po(d,[h,m],b),Po(a,[h,m],b)),A=Math.min(Po(h,[d,a],b),Po(m,[d,a],b));return Math.min(T,A)}function dg(d,a,h,m,b){if(!Oa(a,d.length)||!Oa(m,h.length))return 1/0;let T=1/0;for(let A=a[0];A<a[1];++A){const z=d[A],N=d[A+1];for(let j=m[0];j<m[1];++j){const Y=h[j],te=h[j+1];if(Vh(z,N,Y,te))return 0;T=Math.min(T,$c(z,N,Y,te,b))}}return T}function fg(d,a,h,m,b){if(!Oa(a,d.length)||!Oa(m,h.length))return NaN;let T=1/0;for(let A=a[0];A<=a[1];++A)for(let z=m[0];z<=m[1];++z)if(T=Math.min(T,b.distance(d[A],h[z])),T===0)return T;return T}function pg(d,a,h){if(Jl(d,a,!0))return 0;let m=1/0;for(const b of a){const T=b[0],A=b[b.length-1];if(T!==A&&(m=Math.min(m,Po(d,[A,T],h)),m===0))return m;const z=h.pointOnLine(b,d);if(m=Math.min(m,h.distance(d,z.point)),m===0)return m}return m}function mg(d,a,h,m){if(!Oa(a,d.length))return NaN;for(let T=a[0];T<=a[1];++T)if(Jl(d[T],h,!0))return 0;let b=1/0;for(let T=a[0];T<a[1];++T){const A=d[T],z=d[T+1];for(const N of h)for(let j=0,Y=N.length,te=Y-1;j<Y;te=j++){const he=N[te],pe=N[j];if(Vh(A,z,he,pe))return 0;b=Math.min(b,$c(A,z,he,pe,m))}}return b}function uf(d,a){for(const h of d)for(const m of h)if(Jl(m,a,!0))return!0;return!1}function Ty(d,a,h,m=1/0){const b=Fp(d),T=Fp(a);if(m!==1/0&&Np(b,T,h)>=m)return m;if($h(b,T)){if(uf(d,a))return 0}else if(uf(a,d))return 0;let A=1/0;for(const z of d)for(let N=0,j=z.length,Y=j-1;N<j;Y=N++){const te=z[Y],he=z[N];for(const pe of a)for(let ge=0,_e=pe.length,De=_e-1;ge<_e;De=ge++){const Ve=pe[De],ft=pe[ge];if(Vh(te,he,Ve,ft))return 0;A=Math.min(A,$c(te,he,Ve,ft,h))}}return A}function gg(d,a,h,m,b,T){if(!T)return;const A=Np(Op(m,T),b,h);A<a&&d.push([A,T,[0,0]])}function dl(d,a,h,m,b,T,A){if(!T||!A)return;const z=Np(Op(m,T),Op(b,A),h);z<a&&d.push([z,T,A])}function ku(d,a,h,m,b=1/0){let T=Math.min(m.distance(d[0],h[0][0]),b);if(T===0)return T;const A=new cg([[0,[0,d.length-1],[0,0]]],jr),z=Fp(h);for(;A.length>0;){const N=A.pop();if(N[0]>=T)continue;const j=N[1],Y=a?50:100;if(Xh(j)<=Y){if(!Oa(j,d.length))return NaN;if(a){const te=mg(d,j,h,m);if(isNaN(te)||te===0)return te;T=Math.min(T,te)}else for(let te=j[0];te<=j[1];++te){const he=pg(d[te],h,m);if(T=Math.min(T,he),T===0)return 0}}else{const te=zp(j,a);gg(A,T,m,d,z,te[0]),gg(A,T,m,d,z,te[1])}}return T}function tc(d,a,h,m,b,T=1/0){let A=Math.min(T,b.distance(d[0],h[0]));if(A===0)return A;const z=new cg([[0,[0,d.length-1],[0,h.length-1]]],jr);for(;z.length>0;){const N=z.pop();if(N[0]>=A)continue;const j=N[1],Y=N[2],te=a?50:100,he=m?50:100;if(Xh(j)<=te&&Xh(Y)<=he){if(!Oa(j,d.length)&&Oa(Y,h.length))return NaN;let pe;if(a&&m)pe=dg(d,j,h,Y,b),A=Math.min(A,pe);else if(a&&!m){const ge=d.slice(j[0],j[1]+1);for(let _e=Y[0];_e<=Y[1];++_e)if(pe=Po(h[_e],ge,b),A=Math.min(A,pe),A===0)return A}else if(!a&&m){const ge=h.slice(Y[0],Y[1]+1);for(let _e=j[0];_e<=j[1];++_e)if(pe=Po(d[_e],ge,b),A=Math.min(A,pe),A===0)return A}else pe=fg(d,j,h,Y,b),A=Math.min(A,pe)}else{const pe=zp(j,a),ge=zp(Y,m);dl(z,A,b,d,h,pe[0],ge[0]),dl(z,A,b,d,h,pe[0],ge[1]),dl(z,A,b,d,h,pe[1],ge[0]),dl(z,A,b,d,h,pe[1],ge[1])}}return A}function Zh(d){return d.type==="MultiPolygon"?d.coordinates.map(a=>({type:"Polygon",coordinates:a})):d.type==="MultiLineString"?d.coordinates.map(a=>({type:"LineString",coordinates:a})):d.type==="MultiPoint"?d.coordinates.map(a=>({type:"Point",coordinates:a})):[d]}class nc{constructor(a,h){this.type=nt,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'distance' expression requires exactly one argument, but found ${a.length-1} instead.`);if(da(a[1])){const m=a[1];if(m.type==="FeatureCollection")return new nc(m,m.features.map(b=>Zh(b.geometry)).flat());if(m.type==="Feature")return new nc(m,Zh(m.geometry));if("type"in m&&"coordinates"in m)return new nc(m,Zh(m))}return h.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,m){const b=h.geometry(),T=b.flat().map(N=>Ip([N.x,N.y],h.canonical));if(b.length===0)return NaN;const A=new qh(T[0][1]);let z=1/0;for(const N of m){switch(N.type){case"Point":z=Math.min(z,tc(T,!1,[N.coordinates],!1,A,z));break;case"LineString":z=Math.min(z,tc(T,!1,N.coordinates,!0,A,z));break;case"Polygon":z=Math.min(z,ku(T,!1,N.coordinates,A,z))}if(z===0)return z}return z}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,m){const b=h.geometry(),T=b.flat().map(N=>Ip([N.x,N.y],h.canonical));if(b.length===0)return NaN;const A=new qh(T[0][1]);let z=1/0;for(const N of m){switch(N.type){case"Point":z=Math.min(z,tc(T,!0,[N.coordinates],!1,A,z));break;case"LineString":z=Math.min(z,tc(T,!0,N.coordinates,!0,A,z));break;case"Polygon":z=Math.min(z,ku(T,!0,N.coordinates,A,z))}if(z===0)return z}return z}(a,this.geometries);if(a.geometryType()==="Polygon")return function(h,m){const b=h.geometry();if(b.length===0||b[0].length===0)return NaN;const T=ec(b,0).map(N=>N.map(j=>j.map(Y=>Ip([Y.x,Y.y],h.canonical)))),A=new qh(T[0][0][0][1]);let z=1/0;for(const N of m)for(const j of T){switch(N.type){case"Point":z=Math.min(z,ku([N.coordinates],!1,j,A,z));break;case"LineString":z=Math.min(z,ku(N.coordinates,!0,j,A,z));break;case"Polygon":z=Math.min(z,Ty(j,N.coordinates,A,z))}if(z===0)return z}return z}(a,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class rc{constructor(a){this.type=xe,this.key=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);const m=a[1];return m==null?h.error("Global state property must be defined."):typeof m!="string"?h.error(`Global state property must be string, but found ${typeof a[1]} instead.`):new rc(m)}evaluate(a){var h;const m=(h=a.globals)===null||h===void 0?void 0:h.globalState;return m&&Object.keys(m).length!==0?Er(m,this.key):null}eachChild(){}outputDefined(){return!1}}const pa={"==":Pp,"!=":wy,">":Sy,"<":ig,">=":rf,"<=":My,array:Bo,at:ji,boolean:Bo,case:Si,coalesce:Uo,collator:of,format:Bh,image:Ap,in:ul,"index-of":Tu,interpolate:ns,"interpolate-hcl":ns,"interpolate-lab":ns,length:sf,let:Kl,literal:ts,match:fo,number:Bo,"number-format":Lu,object:Bo,slice:Nc,step:Pu,string:Bo,"to-boolean":Js,"to-color":Js,"to-number":Js,"to-string":Js,var:Qs,within:Bc,distance:nc,"global-state":rc};class vs{constructor(a,h,m,b){this.name=a,this.type=h,this._evaluate=m,this.args=b}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,h){const m=a[0],b=vs.definitions[m];if(!b)return h.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(b)?b[0]:b.type,A=Array.isArray(b)?[[b[1],b[2]]]:b.overloads,z=A.filter(([j])=>!Array.isArray(j)||j.length===a.length-1);let N=null;for(const[j,Y]of z){N=new Fc(h.registry,Kh,h.path,null,h.scope);const te=[];let he=!1;for(let pe=1;pe<a.length;pe++){const ge=a[pe],_e=Array.isArray(j)?j[pe-1]:j.type,De=N.parse(ge,1+te.length,_e);if(!De){he=!0;break}te.push(De)}if(!he)if(Array.isArray(j)&&j.length!==te.length)N.error(`Expected ${j.length} arguments, but found ${te.length} instead.`);else{for(let pe=0;pe<te.length;pe++){const ge=Array.isArray(j)?j[pe]:j.type,_e=te[pe];N.concat(pe+1).checkSubtype(ge,_e.type)}if(N.errors.length===0)return new vs(m,T,Y,te)}}if(z.length===1)h.errors.push(...N.errors);else{const j=(z.length?z:A).map(([te])=>{return he=te,Array.isArray(he)?`(${he.map(Qt).join(", ")})`:`(${Qt(he.type)}...)`;var he}).join(" | "),Y=[];for(let te=1;te<a.length;te++){const he=h.parse(a[te],1+Y.length);if(!he)return null;Y.push(Qt(he.type))}h.error(`Expected arguments of type ${j}, but found (${Y.join(", ")}) instead.`)}return null}static register(a,h){vs.definitions=h;for(const m in h)a[m]=vs}}function Bp(d,[a,h,m,b]){a=a.evaluate(d),h=h.evaluate(d),m=m.evaluate(d);const T=b?b.evaluate(d):1,A=vr(a,h,m,T);if(A)throw new Ai(A);return new yr(a/255,h/255,m/255,T,!1)}function Yh(d,a){return d in a}function hf(d,a){const h=a[d];return h===void 0?null:h}function ic(d){return{type:d}}function Kh(d){if(d instanceof Qs)return Kh(d.boundExpression);if(d instanceof vs&&d.name==="error"||d instanceof of||d instanceof Bc||d instanceof nc||d instanceof rc)return!1;const a=d instanceof Js||d instanceof Bo;let h=!0;return d.eachChild(m=>{h=a?h&&Kh(m):h&&m instanceof ts}),!!h&&Jh(d)&&Vc(d,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Jh(d){if(d instanceof vs&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Bc||d instanceof nc)return!1;let a=!0;return d.eachChild(h=>{a&&!Jh(h)&&(a=!1)}),a}function Du(d){if(d instanceof vs&&d.name==="feature-state")return!1;let a=!0;return d.eachChild(h=>{a&&!Du(h)&&(a=!1)}),a}function Vc(d,a){if(d instanceof vs&&a.indexOf(d.name)>=0)return!1;let h=!0;return d.eachChild(m=>{h&&!Vc(m,a)&&(h=!1)}),h}function fl(d){return{result:"success",value:d}}function oc(d){return{result:"error",value:d}}function sc(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function Up(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function $p(d){return!!d.expression&&d.expression.interpolated}function Sr(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function jc(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)&&sr(d)===xr}function Vp(d){return d}function jp(d,a){const h=d.stops&&typeof d.stops[0][0]=="object",m=h||!(h||d.property!==void 0),b=d.type||($p(a)?"exponential":"interval"),T=function(Y){switch(Y.type){case"color":return yr.parse;case"padding":return Zi.parse;case"numberArray":return To.parse;case"colorArray":return Ni.parse;default:return null}}(a);if(T&&((d=Gn({},d)).stops&&(d.stops=d.stops.map(Y=>[Y[0],T(Y[1])])),d.default=T(d.default?d.default:a.default)),d.colorSpace&&(A=d.colorSpace)!=="rgb"&&A!=="hcl"&&A!=="lab")throw new Error(`Unknown color space: "${d.colorSpace}"`);var A;const z=function(Y){switch(Y){case"exponential":return zu;case"interval":return df;case"categorical":return Hp;case"identity":return Gp;default:throw new Error(`Unknown function type "${Y}"`)}}(b);let N,j;if(b==="categorical"){N=Object.create(null);for(const Y of d.stops)N[Y[0]]=Y[1];j=typeof d.stops[0][0]}if(h){const Y={},te=[];for(let ge=0;ge<d.stops.length;ge++){const _e=d.stops[ge],De=_e[0].zoom;Y[De]===void 0&&(Y[De]={zoom:De,type:d.type,property:d.property,default:d.default,stops:[]},te.push(De)),Y[De].stops.push([_e[0].value,_e[1]])}const he=[];for(const ge of te)he.push([Y[ge].zoom,jp(Y[ge],a)]);const pe={name:"linear"};return{kind:"composite",interpolationType:pe,interpolationFactor:ns.interpolationFactor.bind(void 0,pe),zoomStops:he.map(ge=>ge[0]),evaluate:({zoom:ge},_e)=>zu({stops:he,base:d.base},a,ge).evaluate(ge,_e)}}if(m){const Y=b==="exponential"?{name:"exponential",base:d.base!==void 0?d.base:1}:null;return{kind:"camera",interpolationType:Y,interpolationFactor:ns.interpolationFactor.bind(void 0,Y),zoomStops:d.stops.map(te=>te[0]),evaluate:({zoom:te})=>z(d,a,te,N,j)}}return{kind:"source",evaluate(Y,te){const he=te&&te.properties?te.properties[d.property]:void 0;return he===void 0?oi(d.default,a.default):z(d,a,he,N,j)}}}function oi(d,a,h){return d!==void 0?d:a!==void 0?a:h!==void 0?h:void 0}function Hp(d,a,h,m,b){return oi(typeof h===b?m[h]:void 0,d.default,a.default)}function df(d,a,h){if(Sr(h)!=="number")return oi(d.default,a.default);const m=d.stops.length;if(m===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[m-1][0])return d.stops[m-1][1];const b=Da(d.stops.map(T=>T[0]),h);return d.stops[b][1]}function zu(d,a,h){const m=d.base!==void 0?d.base:1;if(Sr(h)!=="number")return oi(d.default,a.default);const b=d.stops.length;if(b===1||h<=d.stops[0][0])return d.stops[0][1];if(h>=d.stops[b-1][0])return d.stops[b-1][1];const T=Da(d.stops.map(Y=>Y[0]),h),A=function(Y,te,he,pe){const ge=pe-he,_e=Y-he;return ge===0?0:te===1?_e/ge:(Math.pow(te,_e)-1)/(Math.pow(te,ge)-1)}(h,m,d.stops[T][0],d.stops[T+1][0]),z=d.stops[T][1],N=d.stops[T+1][1],j=Ls[a.type]||Vp;return typeof z.evaluate=="function"?{evaluate(...Y){const te=z.evaluate.apply(void 0,Y),he=N.evaluate.apply(void 0,Y);if(te!==void 0&&he!==void 0)return j(te,he,A,d.colorSpace)}}:j(z,N,A,d.colorSpace)}function Gp(d,a,h){switch(a.type){case"color":h=yr.parse(h);break;case"formatted":h=Di.fromString(h.toString());break;case"resolvedImage":h=es.fromString(h.toString());break;case"padding":h=Zi.parse(h);break;case"colorArray":h=Ni.parse(h);break;case"numberArray":h=To.parse(h);break;default:Sr(h)===a.type||a.type==="enum"&&a.values[h]||(h=void 0)}return oi(h,d.default,a.default)}vs.register(pa,{error:[{kind:"error"},[qt],(d,[a])=>{throw new Ai(a.evaluate(d))}],typeof:[qt,[xe],(d,[a])=>Qt(sr(a.evaluate(d)))],"to-rgba":[Pn(nt,4),[kn],(d,[a])=>{const[h,m,b,T]=a.evaluate(d).rgb;return[255*h,255*m,255*b,T]}],rgb:[kn,[nt,nt,nt],Bp],rgba:[kn,[nt,nt,nt,nt],Bp],has:{type:hn,overloads:[[[qt],(d,[a])=>Yh(a.evaluate(d),d.properties())],[[qt,xr],(d,[a,h])=>Yh(a.evaluate(d),h.evaluate(d))]]},get:{type:xe,overloads:[[[qt],(d,[a])=>hf(a.evaluate(d),d.properties())],[[qt,xr],(d,[a,h])=>hf(a.evaluate(d),h.evaluate(d))]]},"feature-state":[xe,[qt],(d,[a])=>hf(a.evaluate(d),d.featureState||{})],properties:[xr,[],d=>d.properties()],"geometry-type":[qt,[],d=>d.geometryType()],id:[xe,[],d=>d.id()],zoom:[nt,[],d=>d.globals.zoom],"heatmap-density":[nt,[],d=>d.globals.heatmapDensity||0],elevation:[nt,[],d=>d.globals.elevation||0],"line-progress":[nt,[],d=>d.globals.lineProgress||0],accumulated:[xe,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[nt,ic(nt),(d,a)=>{let h=0;for(const m of a)h+=m.evaluate(d);return h}],"*":[nt,ic(nt),(d,a)=>{let h=1;for(const m of a)h*=m.evaluate(d);return h}],"-":{type:nt,overloads:[[[nt,nt],(d,[a,h])=>a.evaluate(d)-h.evaluate(d)],[[nt],(d,[a])=>-a.evaluate(d)]]},"/":[nt,[nt,nt],(d,[a,h])=>a.evaluate(d)/h.evaluate(d)],"%":[nt,[nt,nt],(d,[a,h])=>a.evaluate(d)%h.evaluate(d)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(d,[a,h])=>Math.pow(a.evaluate(d),h.evaluate(d))],sqrt:[nt,[nt],(d,[a])=>Math.sqrt(a.evaluate(d))],log10:[nt,[nt],(d,[a])=>Math.log(a.evaluate(d))/Math.LN10],ln:[nt,[nt],(d,[a])=>Math.log(a.evaluate(d))],log2:[nt,[nt],(d,[a])=>Math.log(a.evaluate(d))/Math.LN2],sin:[nt,[nt],(d,[a])=>Math.sin(a.evaluate(d))],cos:[nt,[nt],(d,[a])=>Math.cos(a.evaluate(d))],tan:[nt,[nt],(d,[a])=>Math.tan(a.evaluate(d))],asin:[nt,[nt],(d,[a])=>Math.asin(a.evaluate(d))],acos:[nt,[nt],(d,[a])=>Math.acos(a.evaluate(d))],atan:[nt,[nt],(d,[a])=>Math.atan(a.evaluate(d))],min:[nt,ic(nt),(d,a)=>Math.min(...a.map(h=>h.evaluate(d)))],max:[nt,ic(nt),(d,a)=>Math.max(...a.map(h=>h.evaluate(d)))],abs:[nt,[nt],(d,[a])=>Math.abs(a.evaluate(d))],round:[nt,[nt],(d,[a])=>{const h=a.evaluate(d);return h<0?-Math.round(-h):Math.round(h)}],floor:[nt,[nt],(d,[a])=>Math.floor(a.evaluate(d))],ceil:[nt,[nt],(d,[a])=>Math.ceil(a.evaluate(d))],"filter-==":[hn,[qt,xe],(d,[a,h])=>d.properties()[a.value]===h.value],"filter-id-==":[hn,[xe],(d,[a])=>d.id()===a.value],"filter-type-==":[hn,[qt],(d,[a])=>d.geometryType()===a.value],"filter-<":[hn,[qt,xe],(d,[a,h])=>{const m=d.properties()[a.value],b=h.value;return typeof m==typeof b&&m<b}],"filter-id-<":[hn,[xe],(d,[a])=>{const h=d.id(),m=a.value;return typeof h==typeof m&&h<m}],"filter->":[hn,[qt,xe],(d,[a,h])=>{const m=d.properties()[a.value],b=h.value;return typeof m==typeof b&&m>b}],"filter-id->":[hn,[xe],(d,[a])=>{const h=d.id(),m=a.value;return typeof h==typeof m&&h>m}],"filter-<=":[hn,[qt,xe],(d,[a,h])=>{const m=d.properties()[a.value],b=h.value;return typeof m==typeof b&&m<=b}],"filter-id-<=":[hn,[xe],(d,[a])=>{const h=d.id(),m=a.value;return typeof h==typeof m&&h<=m}],"filter->=":[hn,[qt,xe],(d,[a,h])=>{const m=d.properties()[a.value],b=h.value;return typeof m==typeof b&&m>=b}],"filter-id->=":[hn,[xe],(d,[a])=>{const h=d.id(),m=a.value;return typeof h==typeof m&&h>=m}],"filter-has":[hn,[xe],(d,[a])=>a.value in d.properties()],"filter-has-id":[hn,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[hn,[Pn(qt)],(d,[a])=>a.value.indexOf(d.geometryType())>=0],"filter-id-in":[hn,[Pn(xe)],(d,[a])=>a.value.indexOf(d.id())>=0],"filter-in-small":[hn,[qt,Pn(xe)],(d,[a,h])=>h.value.indexOf(d.properties()[a.value])>=0],"filter-in-large":[hn,[qt,Pn(xe)],(d,[a,h])=>function(m,b,T,A){for(;T<=A;){const z=T+A>>1;if(b[z]===m)return!0;b[z]>m?A=z-1:T=z+1}return!1}(d.properties()[a.value],h.value,0,h.value.length-1)],all:{type:hn,overloads:[[[hn,hn],(d,[a,h])=>a.evaluate(d)&&h.evaluate(d)],[ic(hn),(d,a)=>{for(const h of a)if(!h.evaluate(d))return!1;return!0}]]},any:{type:hn,overloads:[[[hn,hn],(d,[a,h])=>a.evaluate(d)||h.evaluate(d)],[ic(hn),(d,a)=>{for(const h of a)if(h.evaluate(d))return!0;return!1}]]},"!":[hn,[hn],(d,[a])=>!a.evaluate(d)],"is-supported-script":[hn,[qt],(d,[a])=>{const h=d.globals&&d.globals.isSupportedScript;return!h||h(a.evaluate(d))}],upcase:[qt,[qt],(d,[a])=>a.evaluate(d).toUpperCase()],downcase:[qt,[qt],(d,[a])=>a.evaluate(d).toLowerCase()],concat:[qt,ic(xe),(d,a)=>a.map(h=>ka(h.evaluate(d))).join("")],"resolved-locale":[qt,[vt],(d,[a])=>a.evaluate(d).resolvedLocale()]});class Ou{constructor(a,h){this.expression=a,this._warningHistory={},this._evaluator=new cl,this._defaultValue=h?function(m){if(m.type==="color"&&jc(m.default))return new yr(0,0,0,0);switch(m.type){case"color":return yr.parse(m.default)||null;case"padding":return Zi.parse(m.default)||null;case"numberArray":return To.parse(m.default)||null;case"colorArray":return Ni.parse(m.default)||null;case"variableAnchorOffsetCollection":return Tr.parse(m.default)||null;case"projectionDefinition":return _r.parse(m.default)||null;default:return m.default===void 0?null:m.default}}(h):null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(a,h,m,b,T,A){return this._evaluator.globals=a,this._evaluator.feature=h,this._evaluator.featureState=m,this._evaluator.canonical=b,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=A,this.expression.evaluate(this._evaluator)}evaluate(a,h,m,b,T,A){this._evaluator.globals=a,this._evaluator.feature=h||null,this._evaluator.featureState=m||null,this._evaluator.canonical=b,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=A||null;try{const z=this.expression.evaluate(this._evaluator);if(z==null||typeof z=="number"&&z!=z)return this._defaultValue;if(this._enumValues&&!(z in this._enumValues))throw new Ai(`Expected value to be one of ${Object.keys(this._enumValues).map(N=>JSON.stringify(N)).join(", ")}, but found ${JSON.stringify(z)} instead.`);return z}catch(z){return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console<"u"&&console.warn(z.message)),this._defaultValue}}}function ac(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in pa}function Hc(d,a){const h=new Fc(pa,Kh,[],a?function(b){const T={color:kn,string:qt,number:nt,enum:qt,boolean:hn,formatted:Dt,padding:bt,numberArray:pn,colorArray:St,projectionDefinition:Ir,resolvedImage:An,variableAnchorOffsetCollection:gn};return b.type==="array"?Pn(T[b.value]||xe,b.length):T[b.type]}(a):void 0),m=h.parse(d,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?fl(new Ou(m,a)):oc(h.errors)}class Fa{constructor(a,h){this.kind=a,this._styleExpression=h,this.isStateDependent=a!=="constant"&&!Du(h.expression),this.globalStateRefs=pl(h.expression)}evaluateWithoutErrorHandling(a,h,m,b,T,A){return this._styleExpression.evaluateWithoutErrorHandling(a,h,m,b,T,A)}evaluate(a,h,m,b,T,A){return this._styleExpression.evaluate(a,h,m,b,T,A)}}class Qh{constructor(a,h,m,b){this.kind=a,this.zoomStops=m,this._styleExpression=h,this.isStateDependent=a!=="camera"&&!Du(h.expression),this.globalStateRefs=pl(h.expression),this.interpolationType=b}evaluateWithoutErrorHandling(a,h,m,b,T,A){return this._styleExpression.evaluateWithoutErrorHandling(a,h,m,b,T,A)}evaluate(a,h,m,b,T,A){return this._styleExpression.evaluate(a,h,m,b,T,A)}interpolationFactor(a,h,m){return this.interpolationType?ns.interpolationFactor(this.interpolationType,a,h,m):0}}function Wp(d,a){const h=Hc(d,a);if(h.result==="error")return h;const m=h.value.expression,b=Jh(m);if(!b&&!sc(a))return oc([new Fn("","data expressions not supported")]);const T=Vc(m,["zoom"]);if(!T&&!Up(a))return oc([new Fn("","zoom expressions not supported")]);const A=Gc(m);return A||T?A instanceof Fn?oc([A]):A instanceof ns&&!$p(a)?oc([new Fn("",'"interpolate" expressions cannot be used with this property')]):fl(A?new Qh(b?"camera":"composite",h.value,A.labels,A instanceof ns?A.interpolation:void 0):new Fa(b?"constant":"source",h.value)):oc([new Fn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ed{constructor(a,h){this._parameters=a,this._specification=h,Gn(this,jp(this._parameters,this._specification))}static deserialize(a){return new ed(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Gc(d){let a=null;if(d instanceof Kl)a=Gc(d.result);else if(d instanceof Uo){for(const h of d.args)if(a=Gc(h),a)break}else(d instanceof Pu||d instanceof ns)&&d.input instanceof vs&&d.input.name==="zoom"&&(a=d);return a instanceof Fn||d.eachChild(h=>{const m=Gc(h);m instanceof Fn?a=m:!a&&m?a=new Fn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&m&&a!==m&&(a=new Fn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function pl(d,a=new Set){return d instanceof rc&&a.add(d.key),d.eachChild(h=>{pl(h,a)}),a}function lc(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const a of d.slice(1))if(!lc(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}const td={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Na(d){if(d==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};lc(d)||(d=pf(d));const a=Hc(d,td);if(a.result==="error")throw new Error(a.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,m,b)=>a.value.evaluate(h,m,{},b),needGeometry:ff(d),getGlobalStateRefs:()=>pl(a.value.expression)}}function qp(d,a){return d<a?-1:d>a?1:0}function ff(d){if(!Array.isArray(d))return!1;if(d[0]==="within"||d[0]==="distance")return!0;for(let a=1;a<d.length;a++)if(ff(d[a]))return!0;return!1}function pf(d){if(!d)return!0;const a=d[0];return d.length<=1?a!=="any":a==="=="?mf(d[1],d[2],"=="):a==="!="?Wc(mf(d[1],d[2],"==")):a==="<"||a===">"||a==="<="||a===">="?mf(d[1],d[2],a):a==="any"?(h=d.slice(1),["any"].concat(h.map(pf))):a==="all"?["all"].concat(d.slice(1).map(pf)):a==="none"?["all"].concat(d.slice(1).map(pf).map(Wc)):a==="in"?vg(d[1],d.slice(2)):a==="!in"?Wc(vg(d[1],d.slice(2))):a==="has"?yg(d[1]):a!=="!has"||Wc(yg(d[1]));var h}function mf(d,a,h){switch(d){case"$type":return[`filter-type-${h}`,a];case"$id":return[`filter-id-${h}`,a];default:return[`filter-${h}`,d,a]}}function vg(d,a){if(a.length===0)return!1;switch(d){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(h=>typeof h!=typeof a[0])?["filter-in-large",d,["literal",a.sort(qp)]]:["filter-in-small",d,["literal",a]]}}function yg(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function Wc(d){return["!",d]}function ma(d){const a=typeof d;if(a==="number"||a==="boolean"||a==="string"||d==null)return JSON.stringify(d);if(Array.isArray(d)){let b="[";for(const T of d)b+=`${ma(T)},`;return`${b}]`}const h=Object.keys(d).sort();let m="{";for(let b=0;b<h.length;b++)m+=`${JSON.stringify(h[b])}:${ma(d[h[b]])},`;return`${m}}`}function nd(d){let a="";for(const h of $t)a+=`/${ma(d[h])}`;return a}function qc(d){const a=d.value;return a?[new Et(d.key,a,"constants have been deprecated as of v8")]:[]}function Yr(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function ea(d){if(Array.isArray(d))return d.map(ea);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const a={};for(const h in d)a[h]=ea(d[h]);return a}return Yr(d)}function Yi(d){const a=d.key,h=d.value,m=d.valueSpec||{},b=d.objectElementValidators||{},T=d.style,A=d.styleSpec,z=d.validateSpec;let N=[];const j=Sr(h);if(j!=="object")return[new Et(a,h,`object expected, ${j} found`)];for(const Y in h){const te=Y.split(".")[0],he=Er(m,te)||m["*"];let pe;if(Er(b,te))pe=b[te];else if(Er(m,te))pe=z;else if(b["*"])pe=b["*"];else{if(!m["*"]){N.push(new Et(a,h[Y],`unknown property "${Y}"`));continue}pe=z}N=N.concat(pe({key:(a&&`${a}.`)+Y,value:h[Y],valueSpec:he,style:T,styleSpec:A,object:h,objectKey:Y,validateSpec:z},h))}for(const Y in m)b[Y]||m[Y].required&&m[Y].default===void 0&&h[Y]===void 0&&N.push(new Et(a,h,`missing required property "${Y}"`));return N}function Fu(d){const a=d.value,h=d.valueSpec,m=d.style,b=d.styleSpec,T=d.key,A=d.arrayElementValidator||d.validateSpec;if(Sr(a)!=="array")return[new Et(T,a,`array expected, ${Sr(a)} found`)];if(h.length&&a.length!==h.length)return[new Et(T,a,`array length ${h.length} expected, length ${a.length} found`)];if(h["min-length"]&&a.length<h["min-length"])return[new Et(T,a,`array length at least ${h["min-length"]} expected, length ${a.length} found`)];let z={type:h.value,values:h.values};b.$version<7&&(z.function=h.function),Sr(h.value)==="object"&&(z=h.value);let N=[];for(let j=0;j<a.length;j++)N=N.concat(A({array:a,arrayIndex:j,value:a[j],valueSpec:z,validateSpec:d.validateSpec,style:m,styleSpec:b,key:`${T}[${j}]`}));return N}function rd(d){const a=d.key,h=d.value,m=d.valueSpec;let b=Sr(h);return b==="number"&&h!=h&&(b="NaN"),b!=="number"?[new Et(a,h,`number expected, ${b} found`)]:"minimum"in m&&h<m.minimum?[new Et(a,h,`${h} is less than the minimum value ${m.minimum}`)]:"maximum"in m&&h>m.maximum?[new Et(a,h,`${h} is greater than the maximum value ${m.maximum}`)]:[]}function Nu(d){const a=d.valueSpec,h=Yr(d.value.type);let m,b,T,A={};const z=h!=="categorical"&&d.value.property===void 0,N=!z,j=Sr(d.value.stops)==="array"&&Sr(d.value.stops[0])==="array"&&Sr(d.value.stops[0][0])==="object",Y=Yi({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:function(pe){if(h==="identity")return[new Et(pe.key,pe.value,'identity function may not have a "stops" property')];let ge=[];const _e=pe.value;return ge=ge.concat(Fu({key:pe.key,value:_e,valueSpec:pe.valueSpec,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec,arrayElementValidator:te})),Sr(_e)==="array"&&_e.length===0&&ge.push(new Et(pe.key,_e,"array must have at least one stop")),ge},default:function(pe){return pe.validateSpec({key:pe.key,value:pe.value,valueSpec:a,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec})}}});return h==="identity"&&z&&Y.push(new Et(d.key,d.value,'missing required property "property"')),h==="identity"||d.value.stops||Y.push(new Et(d.key,d.value,'missing required property "stops"')),h==="exponential"&&d.valueSpec.expression&&!$p(d.valueSpec)&&Y.push(new Et(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(N&&!sc(d.valueSpec)?Y.push(new Et(d.key,d.value,"property functions not supported")):z&&!Up(d.valueSpec)&&Y.push(new Et(d.key,d.value,"zoom functions not supported"))),h!=="categorical"&&!j||d.value.property!==void 0||Y.push(new Et(d.key,d.value,'"property" property is required')),Y;function te(pe){let ge=[];const _e=pe.value,De=pe.key;if(Sr(_e)!=="array")return[new Et(De,_e,`array expected, ${Sr(_e)} found`)];if(_e.length!==2)return[new Et(De,_e,`array length 2 expected, length ${_e.length} found`)];if(j){if(Sr(_e[0])!=="object")return[new Et(De,_e,`object expected, ${Sr(_e[0])} found`)];if(_e[0].zoom===void 0)return[new Et(De,_e,"object stop key must have zoom")];if(_e[0].value===void 0)return[new Et(De,_e,"object stop key must have value")];if(T&&T>Yr(_e[0].zoom))return[new Et(De,_e[0].zoom,"stop zoom values must appear in ascending order")];Yr(_e[0].zoom)!==T&&(T=Yr(_e[0].zoom),b=void 0,A={}),ge=ge.concat(Yi({key:`${De}[0]`,value:_e[0],valueSpec:{zoom:{}},validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec,objectElementValidators:{zoom:rd,value:he}}))}else ge=ge.concat(he({key:`${De}[0]`,value:_e[0],validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec},_e));return ac(ea(_e[1]))?ge.concat([new Et(`${De}[1]`,_e[1],"expressions are not allowed in function stops.")]):ge.concat(pe.validateSpec({key:`${De}[1]`,value:_e[1],valueSpec:a,validateSpec:pe.validateSpec,style:pe.style,styleSpec:pe.styleSpec}))}function he(pe,ge){const _e=Sr(pe.value),De=Yr(pe.value),Ve=pe.value!==null?pe.value:ge;if(m){if(_e!==m)return[new Et(pe.key,Ve,`${_e} stop domain type must match previous stop domain type ${m}`)]}else m=_e;if(_e!=="number"&&_e!=="string"&&_e!=="boolean")return[new Et(pe.key,Ve,"stop domain value must be a number, string, or boolean")];if(_e!=="number"&&h!=="categorical"){let ft=`number expected, ${_e} found`;return sc(a)&&h===void 0&&(ft+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Et(pe.key,Ve,ft)]}return h!=="categorical"||_e!=="number"||isFinite(De)&&Math.floor(De)===De?h!=="categorical"&&_e==="number"&&b!==void 0&&De<b?[new Et(pe.key,Ve,"stop domain values must appear in ascending order")]:(b=De,h==="categorical"&&De in A?[new Et(pe.key,Ve,"stop domain values must be unique")]:(A[De]=!0,[])):[new Et(pe.key,Ve,`integer expected, found ${De}`)]}}function ta(d){const a=(d.expressionContext==="property"?Wp:Hc)(ea(d.value),d.valueSpec);if(a.result==="error")return a.value.map(m=>new Et(`${d.key}${m.key}`,d.value,m.message));const h=a.value.expression||a.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!h.outputDefined())return[new Et(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!Du(h))return[new Et(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!Du(h))return[new Et(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!Vc(h,["zoom","feature-state"]))return[new Et(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!Jh(h))return[new Et(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xc(d){const a=d.key,h=d.value,m=Sr(h);return m!=="string"?[new Et(a,h,`color expected, ${m} found`)]:yr.parse(String(h))?[]:[new Et(a,h,`color expected, "${h}" found`)]}function Ba(d){const a=d.key,h=d.value,m=d.valueSpec,b=[];return Array.isArray(m.values)?m.values.indexOf(Yr(h))===-1&&b.push(new Et(a,h,`expected one of [${m.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(m.values).indexOf(Yr(h))===-1&&b.push(new Et(a,h,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(h)} found`)),b}function Bu(d){return lc(ea(d.value))?ta(Gn({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):gf(d)}function gf(d){const a=d.value,h=d.key;if(Sr(a)!=="array")return[new Et(h,a,`array expected, ${Sr(a)} found`)];const m=d.styleSpec;let b,T=[];if(a.length<1)return[new Et(h,a,"filter array must have at least 1 element")];switch(T=T.concat(Ba({key:`${h}[0]`,value:a[0],valueSpec:m.filter_operator,style:d.style,styleSpec:d.styleSpec})),Yr(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&Yr(a[1])==="$type"&&T.push(new Et(h,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&T.push(new Et(h,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(b=Sr(a[1]),b!=="string"&&T.push(new Et(`${h}[1]`,a[1],`string expected, ${b} found`)));for(let A=2;A<a.length;A++)b=Sr(a[A]),Yr(a[1])==="$type"?T=T.concat(Ba({key:`${h}[${A}]`,value:a[A],valueSpec:m.geometry_type,style:d.style,styleSpec:d.styleSpec})):b!=="string"&&b!=="number"&&b!=="boolean"&&T.push(new Et(`${h}[${A}]`,a[A],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let A=1;A<a.length;A++)T=T.concat(gf({key:`${h}[${A}]`,value:a[A],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":b=Sr(a[1]),a.length!==2?T.push(new Et(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):b!=="string"&&T.push(new Et(`${h}[1]`,a[1],`string expected, ${b} found`))}return T}function Zc(d,a){const h=d.key,m=d.validateSpec,b=d.style,T=d.styleSpec,A=d.value,z=d.objectKey,N=T[`${a}_${d.layerType}`];if(!N)return[];const j=z.match(/^(.*)-transition$/);if(a==="paint"&&j&&N[j[1]]&&N[j[1]].transition)return m({key:h,value:A,valueSpec:T.transition,style:b,styleSpec:T});const Y=d.valueSpec||N[z];if(!Y)return[new Et(h,A,`unknown property "${z}"`)];let te;if(Sr(A)==="string"&&sc(Y)&&!Y.tokens&&(te=/^{([^}]+)}$/.exec(A)))return[new Et(h,A,`"${z}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(te[1])} }\`.`)];const he=[];return d.layerType==="symbol"&&(z==="text-field"&&b&&!b.glyphs&&he.push(new Et(h,A,'use of "text-field" requires a style "glyphs" property')),z==="text-font"&&jc(ea(A))&&Yr(A.type)==="identity"&&he.push(new Et(h,A,'"text-font" does not support identity functions'))),he.concat(m({key:d.key,value:A,valueSpec:Y,style:b,styleSpec:T,expressionContext:"property",propertyType:a,propertyKey:z}))}function ks(d){return Zc(d,"paint")}function ri(d){return Zc(d,"layout")}function Pr(d){let a=[];const h=d.value,m=d.key,b=d.style,T=d.styleSpec;if(Sr(h)!=="object")return[new Et(m,h,`object expected, ${Sr(h)} found`)];h.type||h.ref||a.push(new Et(m,h,'either "type" or "ref" is required'));let A=Yr(h.type);const z=Yr(h.ref);if(h.id){const N=Yr(h.id);for(let j=0;j<d.arrayIndex;j++){const Y=b.layers[j];Yr(Y.id)===N&&a.push(new Et(m,h.id,`duplicate layer id "${h.id}", previously used at line ${Y.id.__line__}`))}}if("ref"in h){let N;["type","source","source-layer","filter","layout"].forEach(j=>{j in h&&a.push(new Et(m,h[j],`"${j}" is prohibited for ref layers`))}),b.layers.forEach(j=>{Yr(j.id)===z&&(N=j)}),N?N.ref?a.push(new Et(m,h.ref,"ref cannot reference another ref layer")):A=Yr(N.type):a.push(new Et(m,h.ref,`ref layer "${z}" not found`))}else if(A!=="background")if(h.source){const N=b.sources&&b.sources[h.source],j=N&&Yr(N.type);N?j==="vector"&&A==="raster"?a.push(new Et(m,h.source,`layer "${h.id}" requires a raster source`)):j!=="raster-dem"&&A==="hillshade"||j!=="raster-dem"&&A==="color-relief"?a.push(new Et(m,h.source,`layer "${h.id}" requires a raster-dem source`)):j==="raster"&&A!=="raster"?a.push(new Et(m,h.source,`layer "${h.id}" requires a vector source`)):j!=="vector"||h["source-layer"]?j==="raster-dem"&&A!=="hillshade"&&A!=="color-relief"?a.push(new Et(m,h.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):A!=="line"||!h.paint||!h.paint["line-gradient"]||j==="geojson"&&N.lineMetrics||a.push(new Et(m,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Et(m,h,`layer "${h.id}" must specify a "source-layer"`)):a.push(new Et(m,h.source,`source "${h.source}" not found`))}else a.push(new Et(m,h,'missing required property "source"'));return a=a.concat(Yi({key:m,value:h,valueSpec:T.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*":()=>[],type:()=>d.validateSpec({key:`${m}.type`,value:h.type,valueSpec:T.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:h,objectKey:"type"}),filter:Bu,layout:N=>Yi({layer:h,key:N.key,value:N.value,style:N.style,styleSpec:N.styleSpec,validateSpec:N.validateSpec,objectElementValidators:{"*":j=>ri(Gn({layerType:A},j))}}),paint:N=>Yi({layer:h,key:N.key,value:N.value,style:N.style,styleSpec:N.styleSpec,validateSpec:N.validateSpec,objectElementValidators:{"*":j=>ks(Gn({layerType:A},j))}})}})),a}function po(d){const a=d.value,h=d.key,m=Sr(a);return m!=="string"?[new Et(h,a,`string expected, ${m} found`)]:[]}const mo={promoteId:function({key:d,value:a}){if(Sr(a)==="string")return po({key:d,value:a});{const h=[];for(const m in a)h.push(...po({key:`${d}.${m}`,value:a[m]}));return h}}};function rs(d){const a=d.value,h=d.key,m=d.styleSpec,b=d.style,T=d.validateSpec;if(!a.type)return[new Et(h,a,'"type" is required')];const A=Yr(a.type);let z;switch(A){case"vector":case"raster":return z=Yi({key:h,value:a,valueSpec:m[`source_${A.replace("-","_")}`],style:d.style,styleSpec:m,objectElementValidators:mo,validateSpec:T}),z;case"raster-dem":return z=function(N){var j;const Y=(j=N.sourceName)!==null&&j!==void 0?j:"",te=N.value,he=N.styleSpec,pe=he.source_raster_dem,ge=N.style;let _e=[];const De=Sr(te);if(te===void 0)return _e;if(De!=="object")return _e.push(new Et("source_raster_dem",te,`object expected, ${De} found`)),_e;const Ve=Yr(te.encoding)==="custom",ft=["redFactor","greenFactor","blueFactor","baseShift"],tt=N.value.encoding?`"${N.value.encoding}"`:"Default";for(const de in te)!Ve&&ft.includes(de)?_e.push(new Et(de,te[de],`In "${Y}": "${de}" is only valid when "encoding" is set to "custom". ${tt} encoding found`)):pe[de]?_e=_e.concat(N.validateSpec({key:de,value:te[de],valueSpec:pe[de],validateSpec:N.validateSpec,style:ge,styleSpec:he})):_e.push(new Et(de,te[de],`unknown property "${de}"`));return _e}({sourceName:h,value:a,style:d.style,styleSpec:m,validateSpec:T}),z;case"geojson":if(z=Yi({key:h,value:a,valueSpec:m.source_geojson,style:b,styleSpec:m,validateSpec:T,objectElementValidators:mo}),a.cluster)for(const N in a.clusterProperties){const[j,Y]=a.clusterProperties[N],te=typeof j=="string"?[j,["accumulated"],["get",N]]:j;z.push(...ta({key:`${h}.${N}.map`,value:Y,expressionContext:"cluster-map"})),z.push(...ta({key:`${h}.${N}.reduce`,value:te,expressionContext:"cluster-reduce"}))}return z;case"video":return Yi({key:h,value:a,valueSpec:m.source_video,style:b,validateSpec:T,styleSpec:m});case"image":return Yi({key:h,value:a,valueSpec:m.source_image,style:b,validateSpec:T,styleSpec:m});case"canvas":return[new Et(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ba({key:`${h}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function cc(d){const a=d.value,h=d.styleSpec,m=h.light,b=d.style;let T=[];const A=Sr(a);if(a===void 0)return T;if(A!=="object")return T=T.concat([new Et("light",a,`object expected, ${A} found`)]),T;for(const z in a){const N=z.match(/^(.*)-transition$/);T=T.concat(N&&m[N[1]]&&m[N[1]].transition?d.validateSpec({key:z,value:a[z],valueSpec:h.transition,validateSpec:d.validateSpec,style:b,styleSpec:h}):m[z]?d.validateSpec({key:z,value:a[z],valueSpec:m[z],validateSpec:d.validateSpec,style:b,styleSpec:h}):[new Et(z,a[z],`unknown property "${z}"`)])}return T}function ga(d){const a=d.value,h=d.styleSpec,m=h.sky,b=d.style,T=Sr(a);if(a===void 0)return[];if(T!=="object")return[new Et("sky",a,`object expected, ${T} found`)];let A=[];for(const z in a)A=A.concat(m[z]?d.validateSpec({key:z,value:a[z],valueSpec:m[z],style:b,styleSpec:h}):[new Et(z,a[z],`unknown property "${z}"`)]);return A}function $o(d){const a=d.value,h=d.styleSpec,m=h.terrain,b=d.style;let T=[];const A=Sr(a);if(a===void 0)return T;if(A!=="object")return T=T.concat([new Et("terrain",a,`object expected, ${A} found`)]),T;for(const z in a)T=T.concat(m[z]?d.validateSpec({key:z,value:a[z],valueSpec:m[z],validateSpec:d.validateSpec,style:b,styleSpec:h}):[new Et(z,a[z],`unknown property "${z}"`)]);return T}function Yc(d){let a=[];const h=d.value,m=d.key;if(Array.isArray(h)){const b=[],T=[];for(const A in h)h[A].id&&b.includes(h[A].id)&&a.push(new Et(m,h,`all the sprites' ids must be unique, but ${h[A].id} is duplicated`)),b.push(h[A].id),h[A].url&&T.includes(h[A].url)&&a.push(new Et(m,h,`all the sprites' URLs must be unique, but ${h[A].url} is duplicated`)),T.push(h[A].url),a=a.concat(Yi({key:`${m}[${A}]`,value:h[A],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:d.validateSpec}));return a}return po({key:m,value:h})}function Xp(d){return a=d.value,a&&a.constructor===Object?[]:[new Et(d.key,d.value,`object expected, ${Sr(d.value)} found`)];var a}const id={"*":()=>[],array:Fu,boolean:function(d){const a=d.value,h=d.key,m=Sr(a);return m!=="boolean"?[new Et(h,a,`boolean expected, ${m} found`)]:[]},number:rd,color:Xc,constants:qc,enum:Ba,filter:Bu,function:Nu,layer:Pr,object:Yi,source:rs,light:cc,sky:ga,terrain:$o,projection:function(d){const a=d.value,h=d.styleSpec,m=h.projection,b=d.style,T=Sr(a);if(a===void 0)return[];if(T!=="object")return[new Et("projection",a,`object expected, ${T} found`)];let A=[];for(const z in a)A=A.concat(m[z]?d.validateSpec({key:z,value:a[z],valueSpec:m[z],style:b,styleSpec:h}):[new Et(z,a[z],`unknown property "${z}"`)]);return A},projectionDefinition:function(d){const a=d.key;let h=d.value;h=h instanceof String?h.valueOf():h;const m=Sr(h);return m!=="array"||function(b){return Array.isArray(b)&&b.length===3&&typeof b[0]=="string"&&typeof b[1]=="string"&&typeof b[2]=="number"}(h)||function(b){return!!["interpolate","step","literal"].includes(b[0])}(h)?["array","string"].includes(m)?[]:[new Et(a,h,`projection expected, invalid type "${m}" found`)]:[new Et(a,h,`projection expected, invalid array ${JSON.stringify(h)} found`)]},string:po,formatted:function(d){return po(d).length===0?[]:ta(d)},resolvedImage:function(d){return po(d).length===0?[]:ta(d)},padding:function(d){const a=d.key,h=d.value;if(Sr(h)==="array"){if(h.length<1||h.length>4)return[new Et(a,h,`padding requires 1 to 4 values; ${h.length} values found`)];const m={type:"number"};let b=[];for(let T=0;T<h.length;T++)b=b.concat(d.validateSpec({key:`${a}[${T}]`,value:h[T],validateSpec:d.validateSpec,valueSpec:m}));return b}return rd({key:a,value:h,valueSpec:{}})},numberArray:function(d){const a=d.key,h=d.value;if(Sr(h)==="array"){const m={type:"number"};if(h.length<1)return[new Et(a,h,"array length at least 1 expected, length 0 found")];let b=[];for(let T=0;T<h.length;T++)b=b.concat(d.validateSpec({key:`${a}[${T}]`,value:h[T],validateSpec:d.validateSpec,valueSpec:m}));return b}return rd({key:a,value:h,valueSpec:{}})},colorArray:function(d){const a=d.key,h=d.value;if(Sr(h)==="array"){if(h.length<1)return[new Et(a,h,"array length at least 1 expected, length 0 found")];let m=[];for(let b=0;b<h.length;b++)m=m.concat(Xc({key:`${a}[${b}]`,value:h[b]}));return m}return Xc({key:a,value:h})},variableAnchorOffsetCollection:function(d){const a=d.key,h=d.value,m=Sr(h),b=d.styleSpec;if(m!=="array"||h.length<1||h.length%2!=0)return[new Et(a,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let A=0;A<h.length;A+=2)T=T.concat(Ba({key:`${a}[${A}]`,value:h[A],valueSpec:b.layout_symbol["text-anchor"]})),T=T.concat(Fu({key:`${a}[${A+1}]`,value:h[A+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:b}));return T},sprite:Yc,state:Xp};function Kc(d){const a=d.value,h=d.valueSpec,m=d.styleSpec;return d.validateSpec=Kc,h.expression&&jc(Yr(a))?Nu(d):h.expression&&ac(ea(a))?ta(d):h.type&&id[h.type]?id[h.type](d):Yi(Gn({},d,{valueSpec:h.type?m[h.type]:h}))}function Jc(d){const a=d.value,h=d.key,m=po(d);return m.length||(a.indexOf("{fontstack}")===-1&&m.push(new Et(h,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&m.push(new Et(h,a,'"glyphs" url must include a "{range}" token'))),m}function Ki(d,a=qe){let h=[];return h=h.concat(Kc({key:"",value:d,valueSpec:a.$root,styleSpec:a,style:d,validateSpec:Kc,objectElementValidators:{glyphs:Jc,"*":()=>[]}})),d.constants&&(h=h.concat(qc({key:"constants",value:d.constants}))),vf(h)}function ys(d){return function(a){return d({...a,validateSpec:Kc})}}function vf(d){return[].concat(d).sort((a,h)=>a.line-h.line)}function Vo(d){return function(...a){return vf(d.apply(this,a))}}Ki.source=Vo(ys(rs)),Ki.sprite=Vo(ys(Yc)),Ki.glyphs=Vo(ys(Jc)),Ki.light=Vo(ys(cc)),Ki.sky=Vo(ys(ga)),Ki.terrain=Vo(ys($o)),Ki.state=Vo(ys(Xp)),Ki.layer=Vo(ys(Pr)),Ki.filter=Vo(ys(Bu)),Ki.paintProperty=Vo(ys(ks)),Ki.layoutProperty=Vo(ys(ri));const Uu=Ki,uc=Uu.light,ml=Uu.sky,$u=Uu.paintProperty,Vu=Uu.layoutProperty;function hc(d,a){let h=!1;if(a&&a.length)for(const m of a)d.fire(new He(new Error(m.message))),h=!0;return h}class Ao{constructor(a,h,m){const b=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;const A=new Int32Array(this.arrayBuffer);a=A[0],this.d=(h=A[1])+2*(m=A[2]);for(let N=0;N<this.d*this.d;N++){const j=A[3+N],Y=A[3+N+1];b.push(j===Y?null:A.subarray(j,Y))}const z=A[3+b.length+1];this.keys=A.subarray(A[3+b.length],z),this.bboxes=A.subarray(z),this.insert=this._insertReadonly}else{this.d=h+2*m;for(let A=0;A<this.d*this.d;A++)b.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=a,this.padding=m,this.scale=h/a,this.uid=0;const T=m/h*a;this.min=-T,this.max=a+T}insert(a,h,m,b,T){this._forEachCell(h,m,b,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(b),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,h,m,b,T,A){this.cells[T].push(A)}query(a,h,m,b,T){const A=this.min,z=this.max;if(a<=A&&h<=A&&z<=m&&z<=b&&!T)return Array.prototype.slice.call(this.keys);{const N=[];return this._forEachCell(a,h,m,b,this._queryCell,N,{},T),N}}_queryCell(a,h,m,b,T,A,z,N){const j=this.cells[T];if(j!==null){const Y=this.keys,te=this.bboxes;for(let he=0;he<j.length;he++){const pe=j[he];if(z[pe]===void 0){const ge=4*pe;(N?N(te[ge+0],te[ge+1],te[ge+2],te[ge+3]):a<=te[ge+2]&&h<=te[ge+3]&&m>=te[ge+0]&&b>=te[ge+1])?(z[pe]=!0,A.push(Y[pe])):z[pe]=!1}}}}_forEachCell(a,h,m,b,T,A,z,N){const j=this._convertToCellCoord(a),Y=this._convertToCellCoord(h),te=this._convertToCellCoord(m),he=this._convertToCellCoord(b);for(let pe=j;pe<=te;pe++)for(let ge=Y;ge<=he;ge++){const _e=this.d*ge+pe;if((!N||N(this._convertFromCellCoord(pe),this._convertFromCellCoord(ge),this._convertFromCellCoord(pe+1),this._convertFromCellCoord(ge+1)))&&T.call(this,a,h,m,b,_e,A,z,N))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const a=this.cells,h=3+this.cells.length+1+1;let m=0;for(let A=0;A<this.cells.length;A++)m+=this.cells[A].length;const b=new Int32Array(h+m+this.keys.length+this.bboxes.length);b[0]=this.extent,b[1]=this.n,b[2]=this.padding;let T=h;for(let A=0;A<a.length;A++){const z=a[A];b[3+A]=T,b.set(z,T),T+=z.length}return b[3+a.length]=T,b.set(this.keys,T),T+=this.keys.length,b[3+a.length+1]=T,b.set(this.bboxes,T),T+=this.bboxes.length,b.buffer}static serialize(a,h){const m=a.toArrayBuffer();return h&&h.push(m),{buffer:m}}static deserialize(a){return new Ao(a.buffer)}}const Hi={};function zn(d,a,h={}){if(Hi[d])throw new Error(`${d} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:d,writeable:!1}),Hi[d]={klass:a,omit:h.omit||[],shallow:h.shallow||[]}}zn("Object",Object),zn("Set",Set),zn("TransferableGridIndex",Ao),zn("Color",yr),zn("Error",Error),zn("AJAXError",fe),zn("ResolvedImage",es),zn("StylePropertyFunction",ed),zn("StyleExpression",Ou,{omit:["_evaluator"]}),zn("ZoomDependentExpression",Qh),zn("ZoomConstantExpression",Fa),zn("CompoundExpression",vs,{omit:["_evaluate"]});for(const d in pa)pa[d]._classRegistryKey||zn(`Expression_${d}`,pa[d]);function va(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&d.constructor.name==="ArrayBuffer")}function Ds(d){return d.$name||d.constructor._classRegistryKey}function gl(d){return!function(a){if(a===null||typeof a!="object")return!1;const h=Ds(a);return!(!h||h==="Object")}(d)&&(d==null||typeof d=="boolean"||typeof d=="number"||typeof d=="string"||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||d instanceof Blob||d instanceof Error||va(d)||Ue(d)||ArrayBuffer.isView(d)||d instanceof ImageData)}function ju(d,a){if(gl(d))return(va(d)||Ue(d))&&a&&a.push(d),ArrayBuffer.isView(d)&&a&&a.push(d.buffer),d instanceof ImageData&&a&&a.push(d.data.buffer),d;if(Array.isArray(d)){const T=[];for(const A of d)T.push(ju(A,a));return T}if(typeof d!="object")throw new Error("can't serialize object of type "+typeof d);const h=Ds(d);if(!h)throw new Error(`can't serialize object of unregistered class ${d.constructor.name}`);if(!Hi[h])throw new Error(`${h} is not registered.`);const{klass:m}=Hi[h],b=m.serialize?m.serialize(d,a):{};if(m.serialize){if(a&&b===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in d){if(!d.hasOwnProperty(T)||Hi[h].omit.indexOf(T)>=0)continue;const A=d[T];b[T]=Hi[h].shallow.indexOf(T)>=0?A:ju(A,a)}d instanceof Error&&(b.message=d.message)}if(b.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(b.$name=h),b}function dc(d){if(gl(d))return d;if(Array.isArray(d))return d.map(dc);if(typeof d!="object")throw new Error("can't deserialize object of type "+typeof d);const a=Ds(d)||"Object";if(!Hi[a])throw new Error(`can't deserialize unregistered class ${a}`);const{klass:h}=Hi[a];if(!h)throw new Error(`can't deserialize unregistered class ${a}`);if(h.deserialize)return h.deserialize(d);const m=Object.create(h.prototype);for(const b of Object.keys(d)){if(b==="$name")continue;const T=d[b];m[b]=Hi[a].shallow.indexOf(b)>=0?T:dc(T)}return m}class od{constructor(){this.first=!0}update(a,h){const m=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=h),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=m,!0))}}const dr={"Latin-1 Supplement":d=>d>=128&&d<=255,"Hangul Jamo":d=>d>=4352&&d<=4607,Khmer:d=>d>=6016&&d<=6143,"General Punctuation":d=>d>=8192&&d<=8303,"Letterlike Symbols":d=>d>=8448&&d<=8527,"Number Forms":d=>d>=8528&&d<=8591,"Miscellaneous Technical":d=>d>=8960&&d<=9215,"Control Pictures":d=>d>=9216&&d<=9279,"Optical Character Recognition":d=>d>=9280&&d<=9311,"Enclosed Alphanumerics":d=>d>=9312&&d<=9471,"Geometric Shapes":d=>d>=9632&&d<=9727,"Miscellaneous Symbols":d=>d>=9728&&d<=9983,"Miscellaneous Symbols and Arrows":d=>d>=11008&&d<=11263,"Ideographic Description Characters":d=>d>=12272&&d<=12287,"CJK Symbols and Punctuation":d=>d>=12288&&d<=12351,Hiragana:d=>d>=12352&&d<=12447,Katakana:d=>d>=12448&&d<=12543,Kanbun:d=>d>=12688&&d<=12703,"CJK Strokes":d=>d>=12736&&d<=12783,"Enclosed CJK Letters and Months":d=>d>=12800&&d<=13055,"CJK Compatibility":d=>d>=13056&&d<=13311,"Yijing Hexagram Symbols":d=>d>=19904&&d<=19967,"CJK Unified Ideographs":d=>d>=19968&&d<=40959,"Hangul Syllables":d=>d>=44032&&d<=55215,"Private Use Area":d=>d>=57344&&d<=63743,"Vertical Forms":d=>d>=65040&&d<=65055,"CJK Compatibility Forms":d=>d>=65072&&d<=65103,"Small Form Variants":d=>d>=65104&&d<=65135,"Halfwidth and Fullwidth Forms":d=>d>=65280&&d<=65519};function is(d){for(const a of d)if(Hu(a.charCodeAt(0)))return!0;return!1}function Mi(d){for(const a of d)if(!xg(a.charCodeAt(0)))return!1;return!0}function _s(d){const a=d.map(h=>{try{return new RegExp(`\\p{sc=${h}}`,"u").source}catch{return null}}).filter(h=>h);return new RegExp(a.join("|"),"u")}const _g=_s(["Arab","Dupl","Mong","Ougr","Syrc"]);function xg(d){return!_g.test(String.fromCodePoint(d))}const sd=_s(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Hu(d){return!(d!==746&&d!==747&&(d<4352||!(dr["CJK Compatibility Forms"](d)&&!(d>=65097&&d<=65103)||dr["CJK Compatibility"](d)||dr["CJK Strokes"](d)||!(!dr["CJK Symbols and Punctuation"](d)||d>=12296&&d<=12305||d>=12308&&d<=12319||d===12336)||dr["Enclosed CJK Letters and Months"](d)||dr["Ideographic Description Characters"](d)||dr.Kanbun(d)||dr.Katakana(d)&&d!==12540||!(!dr["Halfwidth and Fullwidth Forms"](d)||d===65288||d===65289||d===65293||d>=65306&&d<=65310||d===65339||d===65341||d===65343||d>=65371&&d<=65503||d===65507||d>=65512&&d<=65519)||!(!dr["Small Form Variants"](d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||dr["Vertical Forms"](d)||dr["Yijing Hexagram Symbols"](d)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(d))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(d))||sd.test(String.fromCodePoint(d)))))}function yf(d){return!(Hu(d)||function(a){return!!(dr["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||dr["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||dr["Letterlike Symbols"](a)||dr["Number Forms"](a)||dr["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||dr["Control Pictures"](a)&&a!==9251||dr["Optical Character Recognition"](a)||dr["Enclosed Alphanumerics"](a)||dr["Geometric Shapes"](a)||dr["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||dr["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||dr["CJK Symbols and Punctuation"](a)||dr.Katakana(a)||dr["Private Use Area"](a)||dr["CJK Compatibility Forms"](a)||dr["Small Form Variants"](a)||dr["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(d))}const ad=_s(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Gu(d){return ad.test(String.fromCodePoint(d))}function Wu(d,a){return!(!a&&Gu(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||dr.Khmer(d))}function ld(d){for(const a of d)if(Gu(a.charCodeAt(0)))return!0;return!1}const fc=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(d){this.pluginStatus=d.pluginStatus,this.pluginURL=d.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(d){if(fc.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=d.applyArabicShaping,this.processBidirectionalText=d.processBidirectionalText,this.processStyledBidirectionalText=d.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(d,a){return s(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(d.pluginStatus!=="loading")return this.setState(d),d;const h=d.pluginURL,m=new Promise(T=>{this.loadScriptResolve=T});a(h);const b=new Promise(T=>setTimeout(()=>T(),this.TIMEOUT));if(yield Promise.race([m,b]),this.isParsed()){const T={pluginStatus:"loaded",pluginURL:h};return this.setState(T),T}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${h}`)})}};class si{constructor(a,h){this.zoom=a,h?(this.now=h.now||0,this.fadeDuration=h.fadeDuration||0,this.zoomHistory=h.zoomHistory||new od,this.transition=h.transition||{},this.globalState=h.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new od,this.transition={},this.globalState={})}isSupportedScript(a){return function(h,m){for(const b of h)if(!Wu(b.charCodeAt(0),m))return!1;return!0}(a,fc.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,h=a-Math.floor(a),m=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*h}}}class pc{constructor(a,h){this.property=a,this.value=h,this.expression=function(m,b){if(jc(m))return new ed(m,b);if(ac(m)){const T=Wp(m,b);if(T.result==="error")throw new Error(T.value.map(A=>`${A.key}: ${A.message}`).join(", "));return T.value}{let T=m;return b.type==="color"&&typeof m=="string"?T=yr.parse(m):b.type!=="padding"||typeof m!="number"&&!Array.isArray(m)?b.type!=="numberArray"||typeof m!="number"&&!Array.isArray(m)?b.type!=="colorArray"||typeof m!="string"&&!Array.isArray(m)?b.type==="variableAnchorOffsetCollection"&&Array.isArray(m)?T=Tr.parse(m):b.type==="projectionDefinition"&&typeof m=="string"&&(T=_r.parse(m)):T=Ni.parse(m):T=To.parse(m):T=Zi.parse(m),{globalStateRefs:new Set,kind:"constant",evaluate:()=>T}}}(h===void 0?a.specification.default:h,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(a,h,m){return this.property.possiblyEvaluate(this,a,h,m)}}class cd{constructor(a){this.property=a,this.value=new pc(a,void 0)}transitioned(a,h){return new Qc(this.property,this.value,h,cn({},a.transition,this.transition),a.now)}untransitioned(){return new Qc(this.property,this.value,null,{},0)}}class _f{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Tn(this._values[a].value.value)}setValue(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new cd(this._values[a].property)),this._values[a].value=new pc(this._values[a].property,h===null?void 0:Tn(h))}getTransition(a){return Tn(this._values[a].transition)}setTransition(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new cd(this._values[a].property)),this._values[a].transition=Tn(h)||void 0}serialize(){const a={};for(const h of Object.keys(this._values)){const m=this.getValue(h);m!==void 0&&(a[h]=m);const b=this.getTransition(h);b!==void 0&&(a[`${h}-transition`]=b)}return a}transitioned(a,h){const m=new Zp(this._properties);for(const b of Object.keys(this._values))m._values[b]=this._values[b].transitioned(a,h._values[b]);return m}untransitioned(){const a=new Zp(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].untransitioned();return a}}class Qc{constructor(a,h,m,b,T){this.property=a,this.value=h,this.begin=T+b.delay||0,this.end=this.begin+b.duration||0,a.specification.transition&&(b.delay||b.duration)&&(this.prior=m)}possiblyEvaluate(a,h,m){const b=a.now||0,T=this.value.possiblyEvaluate(a,h,m),A=this.prior;if(A){if(b>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(b<this.begin)return A.possiblyEvaluate(a,h,m);{const z=(b-this.begin)/(this.end-this.begin);return this.property.interpolate(A.possiblyEvaluate(a,h,m),T,Ct(z))}}return T}}class Zp{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,h,m){const b=new vl(this._properties);for(const T of Object.keys(this._values))b._values[T]=this._values[T].possiblyEvaluate(a,h,m);return b}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class xf{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}hasValue(a){return this._values[a].value!==void 0}getValue(a){return Tn(this._values[a].value)}setValue(a,h){this._values[a]=new pc(this._values[a].property,h===null?void 0:Tn(h))}serialize(){const a={};for(const h of Object.keys(this._values)){const m=this.getValue(h);m!==void 0&&(a[h]=m)}return a}possiblyEvaluate(a,h,m){const b=new vl(this._properties);for(const T of Object.keys(this._values))b._values[T]=this._values[T].possiblyEvaluate(a,h,m);return b}}class zs{constructor(a,h,m){this.property=a,this.value=h,this.parameters=m}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,h,m,b){return this.property.evaluate(this.value,this.parameters,a,h,m,b)}}class vl{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class $n{constructor(a){this.specification=a}possiblyEvaluate(a,h){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(h)}interpolate(a,h,m){const b=Ls[this.specification.type];return b?b(a,h,m):a}}class ar{constructor(a,h){this.specification=a,this.overrides=h}possiblyEvaluate(a,h,m,b){return new zs(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(h,null,{},m,b)}:a.expression,h)}interpolate(a,h,m){if(a.value.kind!=="constant"||h.value.kind!=="constant")return a;if(a.value.value===void 0||h.value.value===void 0)return new zs(this,{kind:"constant",value:void 0},a.parameters);const b=Ls[this.specification.type];if(b){const T=b(a.value.value,h.value.value,m);return new zs(this,{kind:"constant",value:T},a.parameters)}return a}evaluate(a,h,m,b,T,A){return a.kind==="constant"?a.value:a.evaluate(h,m,b,T,A)}}class qu extends ar{possiblyEvaluate(a,h,m,b){if(a.value===void 0)return new zs(this,{kind:"constant",value:void 0},h);if(a.expression.kind==="constant"){const T=a.expression.evaluate(h,null,{},m,b),A=a.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,z=this._calculate(A,A,A,h);return new zs(this,{kind:"constant",value:z},h)}if(a.expression.kind==="camera"){const T=this._calculate(a.expression.evaluate({zoom:h.zoom-1}),a.expression.evaluate({zoom:h.zoom}),a.expression.evaluate({zoom:h.zoom+1}),h);return new zs(this,{kind:"constant",value:T},h)}return new zs(this,a.expression,h)}evaluate(a,h,m,b,T,A){if(a.kind==="source"){const z=a.evaluate(h,m,b,T,A);return this._calculate(z,z,z,h)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(h.zoom)-1},m,b),a.evaluate({zoom:Math.floor(h.zoom)},m,b),a.evaluate({zoom:Math.floor(h.zoom)+1},m,b),h):a.value}_calculate(a,h,m,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:m,to:h}}interpolate(a){return a}}class ud{constructor(a){this.specification=a}possiblyEvaluate(a,h,m,b){if(a.value!==void 0){if(a.expression.kind==="constant"){const T=a.expression.evaluate(h,null,{},m,b);return this._calculate(T,T,T,h)}return this._calculate(a.expression.evaluate(new si(Math.floor(h.zoom-1),h)),a.expression.evaluate(new si(Math.floor(h.zoom),h)),a.expression.evaluate(new si(Math.floor(h.zoom+1),h)),h)}}_calculate(a,h,m,b){return b.zoom>b.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:m,to:h}}interpolate(a){return a}}class Ua{constructor(a){this.specification=a}possiblyEvaluate(a,h,m,b){return!!a.expression.evaluate(h,null,{},m,b)}interpolate(){return!1}}class vi{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const h in a){const m=a[h];m.specification.overridable&&this.overridableProperties.push(h);const b=this.defaultPropertyValues[h]=new pc(m,void 0),T=this.defaultTransitionablePropertyValues[h]=new cd(m);this.defaultTransitioningPropertyValues[h]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=b.possiblyEvaluate({})}}}zn("DataDrivenProperty",ar),zn("DataConstantProperty",$n),zn("CrossFadedDataDrivenProperty",qu),zn("CrossFadedProperty",ud),zn("ColorRampProperty",Ua);const mc="-transition";class oo extends dt{constructor(a,h){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter,this._featureFilter=Na(a.filter)),h.layout&&(this._unevaluatedLayout=new xf(h.layout)),h.paint)){this._transitionablePaint=new _f(h.paint);for(const m in a.paint)this.setPaintProperty(m,a.paint[m],{validate:!1});for(const m in a.layout)this.setLayoutProperty(m,a.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vl(h.paint)}}setFilter(a){this.filter=a,this._featureFilter=Na(a)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}getLayoutAffectingGlobalStateRefs(){const a=new Set;if(this._unevaluatedLayout)for(const h in this._unevaluatedLayout._values){const m=this._unevaluatedLayout._values[h];for(const b of m.getGlobalStateRefs())a.add(b)}for(const h of this._featureFilter.getGlobalStateRefs())a.add(h);return a}setLayoutProperty(a,h,m={}){h!=null&&this._validate(Vu,`layers.${this.id}.layout.${a}`,a,h,m)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,h):this.visibility=h)}getPaintProperty(a){return a.endsWith(mc)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,h,m={}){if(h!=null&&this._validate($u,`layers.${this.id}.paint.${a}`,a,h,m))return!1;if(a.endsWith(mc))return this._transitionablePaint.setTransition(a.slice(0,-11),h||void 0),!1;{const b=this._transitionablePaint._values[a],T=b.property.specification["property-type"]==="cross-faded-data-driven",A=b.value.isDataDriven(),z=b.value;this._transitionablePaint.setValue(a,h),this._handleSpecialPaintPropertyUpdate(a);const N=this._transitionablePaint._values[a].value;return N.isDataDriven()||A||T||this._handleOverridablePaintPropertyUpdate(a,z,N)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,h,m){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,h){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,h)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),Je(a,(h,m)=>!(h===void 0||m==="layout"&&!Object.keys(h).length||m==="paint"&&!Object.keys(h).length))}_validate(a,h,m,b,T={}){return(!T||T.validate!==!1)&&hc(this,a.call(Uu,{key:h,layerType:this.type,objectKey:m,value:b,styleSpec:qe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const h=this.paint.get(a);if(h instanceof zs&&sc(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}const Yp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class os{constructor(a,h){this._structArray=a,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ei{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,h){return a._trim(),h&&(a.isTransferred=!0,h.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const h=Object.create(this.prototype);return h.arrayBuffer=a.arrayBuffer,h.length=a.length,h.capacity=a.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ci(d,a=1){let h=0,m=0;return{members:d.map(b=>{const T=Yp[b.type].BYTES_PER_ELEMENT,A=h=Kp(h,Math.max(a,T)),z=b.components||1;return m=Math.max(m,T),h+=T*z,{name:b.name,type:b.type,components:z,offset:A}}),size:Kp(h,Math.max(m,a)),alignment:a}}function Kp(d,a){return Math.ceil(d/a)*a}class jo extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h){const m=this.length;return this.resize(m+1),this.emplace(m,a,h)}emplace(a,h,m){const b=2*a;return this.int16[b+0]=h,this.int16[b+1]=m,a}}jo.prototype.bytesPerElement=4,zn("StructArrayLayout2i4",jo);class ss extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,m)}emplace(a,h,m,b){const T=3*a;return this.int16[T+0]=h,this.int16[T+1]=m,this.int16[T+2]=b,a}}ss.prototype.bytesPerElement=6,zn("StructArrayLayout3i6",ss);class Xu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,h,m,b)}emplace(a,h,m,b,T){const A=4*a;return this.int16[A+0]=h,this.int16[A+1]=m,this.int16[A+2]=b,this.int16[A+3]=T,a}}Xu.prototype.bytesPerElement=8,zn("StructArrayLayout4i8",Xu);class hd extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A){const z=this.length;return this.resize(z+1),this.emplace(z,a,h,m,b,T,A)}emplace(a,h,m,b,T,A,z){const N=6*a;return this.int16[N+0]=h,this.int16[N+1]=m,this.int16[N+2]=b,this.int16[N+3]=T,this.int16[N+4]=A,this.int16[N+5]=z,a}}hd.prototype.bytesPerElement=12,zn("StructArrayLayout2i4i12",hd);class $a extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A){const z=this.length;return this.resize(z+1),this.emplace(z,a,h,m,b,T,A)}emplace(a,h,m,b,T,A,z){const N=4*a,j=8*a;return this.int16[N+0]=h,this.int16[N+1]=m,this.uint8[j+4]=b,this.uint8[j+5]=T,this.uint8[j+6]=A,this.uint8[j+7]=z,a}}$a.prototype.bytesPerElement=8,zn("StructArrayLayout2i4ub8",$a);class Zu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h){const m=this.length;return this.resize(m+1),this.emplace(m,a,h)}emplace(a,h,m){const b=2*a;return this.float32[b+0]=h,this.float32[b+1]=m,a}}Zu.prototype.bytesPerElement=8,zn("StructArrayLayout2f8",Zu);class eu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A,z,N,j,Y){const te=this.length;return this.resize(te+1),this.emplace(te,a,h,m,b,T,A,z,N,j,Y)}emplace(a,h,m,b,T,A,z,N,j,Y,te){const he=10*a;return this.uint16[he+0]=h,this.uint16[he+1]=m,this.uint16[he+2]=b,this.uint16[he+3]=T,this.uint16[he+4]=A,this.uint16[he+5]=z,this.uint16[he+6]=N,this.uint16[he+7]=j,this.uint16[he+8]=Y,this.uint16[he+9]=te,a}}eu.prototype.bytesPerElement=20,zn("StructArrayLayout10ui20",eu);class Os extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A,z,N,j,Y,te,he){const pe=this.length;return this.resize(pe+1),this.emplace(pe,a,h,m,b,T,A,z,N,j,Y,te,he)}emplace(a,h,m,b,T,A,z,N,j,Y,te,he,pe){const ge=12*a;return this.int16[ge+0]=h,this.int16[ge+1]=m,this.int16[ge+2]=b,this.int16[ge+3]=T,this.uint16[ge+4]=A,this.uint16[ge+5]=z,this.uint16[ge+6]=N,this.uint16[ge+7]=j,this.int16[ge+8]=Y,this.int16[ge+9]=te,this.int16[ge+10]=he,this.int16[ge+11]=pe,a}}Os.prototype.bytesPerElement=24,zn("StructArrayLayout4i4ui4i24",Os);class tu extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,m)}emplace(a,h,m,b){const T=3*a;return this.float32[T+0]=h,this.float32[T+1]=m,this.float32[T+2]=b,a}}tu.prototype.bytesPerElement=12,zn("StructArrayLayout3f12",tu);class C extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint32[1*a+0]=h,a}}C.prototype.bytesPerElement=4,zn("StructArrayLayout1ul4",C);class o extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A,z,N,j){const Y=this.length;return this.resize(Y+1),this.emplace(Y,a,h,m,b,T,A,z,N,j)}emplace(a,h,m,b,T,A,z,N,j,Y){const te=10*a,he=5*a;return this.int16[te+0]=h,this.int16[te+1]=m,this.int16[te+2]=b,this.int16[te+3]=T,this.int16[te+4]=A,this.int16[te+5]=z,this.uint32[he+3]=N,this.uint16[te+8]=j,this.uint16[te+9]=Y,a}}o.prototype.bytesPerElement=20,zn("StructArrayLayout6i1ul2ui20",o);class u extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A){const z=this.length;return this.resize(z+1),this.emplace(z,a,h,m,b,T,A)}emplace(a,h,m,b,T,A,z){const N=6*a;return this.int16[N+0]=h,this.int16[N+1]=m,this.int16[N+2]=b,this.int16[N+3]=T,this.int16[N+4]=A,this.int16[N+5]=z,a}}u.prototype.bytesPerElement=12,zn("StructArrayLayout2i2i2i12",u);class g extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T){const A=this.length;return this.resize(A+1),this.emplace(A,a,h,m,b,T)}emplace(a,h,m,b,T,A){const z=4*a,N=8*a;return this.float32[z+0]=h,this.float32[z+1]=m,this.float32[z+2]=b,this.int16[N+6]=T,this.int16[N+7]=A,a}}g.prototype.bytesPerElement=16,zn("StructArrayLayout2f1f2i16",g);class x extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A){const z=this.length;return this.resize(z+1),this.emplace(z,a,h,m,b,T,A)}emplace(a,h,m,b,T,A,z){const N=16*a,j=4*a,Y=8*a;return this.uint8[N+0]=h,this.uint8[N+1]=m,this.float32[j+1]=b,this.float32[j+2]=T,this.int16[Y+6]=A,this.int16[Y+7]=z,a}}x.prototype.bytesPerElement=16,zn("StructArrayLayout2ub2f2i16",x);class E extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,m)}emplace(a,h,m,b){const T=3*a;return this.uint16[T+0]=h,this.uint16[T+1]=m,this.uint16[T+2]=b,a}}E.prototype.bytesPerElement=6,zn("StructArrayLayout3ui6",E);class k extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A,z,N,j,Y,te,he,pe,ge,_e,De,Ve){const ft=this.length;return this.resize(ft+1),this.emplace(ft,a,h,m,b,T,A,z,N,j,Y,te,he,pe,ge,_e,De,Ve)}emplace(a,h,m,b,T,A,z,N,j,Y,te,he,pe,ge,_e,De,Ve,ft){const tt=24*a,de=12*a,ke=48*a;return this.int16[tt+0]=h,this.int16[tt+1]=m,this.uint16[tt+2]=b,this.uint16[tt+3]=T,this.uint32[de+2]=A,this.uint32[de+3]=z,this.uint32[de+4]=N,this.uint16[tt+10]=j,this.uint16[tt+11]=Y,this.uint16[tt+12]=te,this.float32[de+7]=he,this.float32[de+8]=pe,this.uint8[ke+36]=ge,this.uint8[ke+37]=_e,this.uint8[ke+38]=De,this.uint32[de+10]=Ve,this.int16[tt+22]=ft,a}}k.prototype.bytesPerElement=48,zn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",k);class F extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,b,T,A,z,N,j,Y,te,he,pe,ge,_e,De,Ve,ft,tt,de,ke,it,Rt,an,Ft,jt,yn,ln){const bn=this.length;return this.resize(bn+1),this.emplace(bn,a,h,m,b,T,A,z,N,j,Y,te,he,pe,ge,_e,De,Ve,ft,tt,de,ke,it,Rt,an,Ft,jt,yn,ln)}emplace(a,h,m,b,T,A,z,N,j,Y,te,he,pe,ge,_e,De,Ve,ft,tt,de,ke,it,Rt,an,Ft,jt,yn,ln,bn){const Xt=32*a,Hn=16*a;return this.int16[Xt+0]=h,this.int16[Xt+1]=m,this.int16[Xt+2]=b,this.int16[Xt+3]=T,this.int16[Xt+4]=A,this.int16[Xt+5]=z,this.int16[Xt+6]=N,this.int16[Xt+7]=j,this.uint16[Xt+8]=Y,this.uint16[Xt+9]=te,this.uint16[Xt+10]=he,this.uint16[Xt+11]=pe,this.uint16[Xt+12]=ge,this.uint16[Xt+13]=_e,this.uint16[Xt+14]=De,this.uint16[Xt+15]=Ve,this.uint16[Xt+16]=ft,this.uint16[Xt+17]=tt,this.uint16[Xt+18]=de,this.uint16[Xt+19]=ke,this.uint16[Xt+20]=it,this.uint16[Xt+21]=Rt,this.uint16[Xt+22]=an,this.uint32[Hn+12]=Ft,this.float32[Hn+13]=jt,this.float32[Hn+14]=yn,this.uint16[Xt+30]=ln,this.uint16[Xt+31]=bn,a}}F.prototype.bytesPerElement=64,zn("StructArrayLayout8i15ui1ul2f2ui64",F);class U extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.float32[1*a+0]=h,a}}U.prototype.bytesPerElement=4,zn("StructArrayLayout1f4",U);class Z extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,m)}emplace(a,h,m,b){const T=3*a;return this.uint16[6*a+0]=h,this.float32[T+1]=m,this.float32[T+2]=b,a}}Z.prototype.bytesPerElement=12,zn("StructArrayLayout1ui2f12",Z);class K extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,m){const b=this.length;return this.resize(b+1),this.emplace(b,a,h,m)}emplace(a,h,m,b){const T=4*a;return this.uint32[2*a+0]=h,this.uint16[T+2]=m,this.uint16[T+3]=b,a}}K.prototype.bytesPerElement=8,zn("StructArrayLayout1ul2ui8",K);class oe extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h){const m=this.length;return this.resize(m+1),this.emplace(m,a,h)}emplace(a,h,m){const b=2*a;return this.uint16[b+0]=h,this.uint16[b+1]=m,a}}oe.prototype.bytesPerElement=4,zn("StructArrayLayout2ui4",oe);class re extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint16[1*a+0]=h,a}}re.prototype.bytesPerElement=2,zn("StructArrayLayout1ui2",re);class ce extends ei{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,m,b){const T=this.length;return this.resize(T+1),this.emplace(T,a,h,m,b)}emplace(a,h,m,b,T){const A=4*a;return this.float32[A+0]=h,this.float32[A+1]=m,this.float32[A+2]=b,this.float32[A+3]=T,a}}ce.prototype.bytesPerElement=16,zn("StructArrayLayout4f16",ce);class ve extends os{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new I(this.anchorPointX,this.anchorPointY)}}ve.prototype.size=20;class Le extends o{get(a){return new ve(this,a)}}zn("CollisionBoxArray",Le);class ze extends os{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ze.prototype.size=48;class Ne extends k{get(a){return new ze(this,a)}}zn("PlacedSymbolArray",Ne);class Ge extends os{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ge.prototype.size=64;class et extends F{get(a){return new Ge(this,a)}}zn("SymbolInstanceArray",et);class Xe extends U{getoffsetX(a){return this.float32[1*a+0]}}zn("GlyphOffsetArray",Xe);class at extends ss{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}zn("SymbolLineVertexArray",at);class ht extends os{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ht.prototype.size=12;class Ye extends Z{get(a){return new ht(this,a)}}zn("TextAnchorOffsetArray",Ye);class pt extends os{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}pt.prototype.size=8;class Pt extends K{get(a){return new pt(this,a)}}zn("FeatureIndexArray",Pt);class Mt extends jo{}class Tt extends jo{}class kt extends jo{}class Mn extends hd{}class Sn extends $a{}class rn extends Zu{}class Vn extends eu{}class br extends Os{}class Hr extends tu{}class Ei extends C{}class ii extends u{}class ci extends x{}class ai extends E{}class Kr extends oe{}const ti=Ci([{name:"a_pos",components:2,type:"Int16"}],4),{members:go}=ti;class Ar{constructor(a=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=a}prepareSegment(a,h,m,b){const T=this.segments[this.segments.length-1];return a>Ar.MAX_VERTEX_ARRAY_LENGTH&&fn(`Max vertices per segment is ${Ar.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ar.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!T||T.vertexLength+a>Ar.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==b?this.createNewSegment(h,m,b):T}createNewSegment(a,h,m){const b={vertexOffset:a.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0,vaos:{}};return m!==void 0&&(b.sortKey=m),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(b),b}getOrCreateLatestSegment(a,h,m){return this.prepareSegment(0,a,h,m)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const a of this.segments)for(const h in a.vaos)a.vaos[h].destroy()}static simpleSegment(a,h,m,b){return new Ar([{vertexOffset:a,primitiveOffset:h,vertexLength:m,primitiveLength:b,vaos:{},sortKey:0}])}}function so(d,a){return 256*(d=_t(Math.floor(d),0,255))+_t(Math.floor(a),0,255)}Ar.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,zn("SegmentVector",Ar);const vo=Ci([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var yl,_l,Va,ya={exports:{}},Yu={exports:{}},Ku={exports:{}},Ju=function(){if(Va)return ya.exports;Va=1;var d=(yl||(yl=1,Yu.exports=function(h,m){var b,T,A,z,N,j,Y,te;for(T=h.length-(b=3&h.length),A=m,N=3432918353,j=461845907,te=0;te<T;)Y=255&h.charCodeAt(te)|(255&h.charCodeAt(++te))<<8|(255&h.charCodeAt(++te))<<16|(255&h.charCodeAt(++te))<<24,++te,A=27492+(65535&(z=5*(65535&(A=(A^=Y=(65535&(Y=(Y=(65535&Y)*N+(((Y>>>16)*N&65535)<<16)&4294967295)<<15|Y>>>17))*j+(((Y>>>16)*j&65535)<<16)&4294967295)<<13|A>>>19))+((5*(A>>>16)&65535)<<16)&4294967295))+((58964+(z>>>16)&65535)<<16);switch(Y=0,b){case 3:Y^=(255&h.charCodeAt(te+2))<<16;case 2:Y^=(255&h.charCodeAt(te+1))<<8;case 1:A^=Y=(65535&(Y=(Y=(65535&(Y^=255&h.charCodeAt(te)))*N+(((Y>>>16)*N&65535)<<16)&4294967295)<<15|Y>>>17))*j+(((Y>>>16)*j&65535)<<16)&4294967295}return A^=h.length,A=2246822507*(65535&(A^=A>>>16))+((2246822507*(A>>>16)&65535)<<16)&4294967295,A=3266489909*(65535&(A^=A>>>13))+((3266489909*(A>>>16)&65535)<<16)&4294967295,(A^=A>>>16)>>>0}),Yu.exports),a=(_l||(_l=1,Ku.exports=function(h,m){for(var b,T=h.length,A=m^T,z=0;T>=4;)b=1540483477*(65535&(b=255&h.charCodeAt(z)|(255&h.charCodeAt(++z))<<8|(255&h.charCodeAt(++z))<<16|(255&h.charCodeAt(++z))<<24))+((1540483477*(b>>>16)&65535)<<16),A=1540483477*(65535&A)+((1540483477*(A>>>16)&65535)<<16)^(b=1540483477*(65535&(b^=b>>>24))+((1540483477*(b>>>16)&65535)<<16)),T-=4,++z;switch(T){case 3:A^=(255&h.charCodeAt(z+2))<<16;case 2:A^=(255&h.charCodeAt(z+1))<<8;case 1:A=1540483477*(65535&(A^=255&h.charCodeAt(z)))+((1540483477*(A>>>16)&65535)<<16)}return A=1540483477*(65535&(A^=A>>>13))+((1540483477*(A>>>16)&65535)<<16),(A^=A>>>15)>>>0}),Ku.exports);return ya.exports=d,ya.exports.murmur3=d,ya.exports.murmur2=a,ya.exports}(),as=p(Ju);class _a{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,h,m,b){this.ids.push(gc(a)),this.positions.push(h,m,b)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const h=gc(a);let m=0,b=this.ids.length-1;for(;m<b;){const A=m+b>>1;this.ids[A]>=h?b=A:m=A+1}const T=[];for(;this.ids[m]===h;)T.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return T}static serialize(a,h){const m=new Float64Array(a.ids),b=new Uint32Array(a.positions);return vc(m,b,0,m.length-1),h&&h.push(m.buffer,b.buffer),{ids:m,positions:b}}static deserialize(a){const h=new _a;return h.ids=a.ids,h.positions=a.positions,h.indexed=!0,h}}function gc(d){const a=+d;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:as(String(d))}function vc(d,a,h,m){for(;h<m;){const b=d[h+m>>1];let T=h-1,A=m+1;for(;;){do T++;while(d[T]<b);do A--;while(d[A]>b);if(T>=A)break;zi(d,T,A),zi(a,3*T,3*A),zi(a,3*T+1,3*A+1),zi(a,3*T+2,3*A+2)}A-h<m-A?(vc(d,a,h,A),h=A+1):(vc(d,a,A+1,m),m=A)}}function zi(d,a,h){const m=d[a];d[a]=d[h],d[h]=m}zn("FeaturePositionMap",_a);class hi{constructor(a,h){this.gl=a.gl,this.location=h}}class yo extends hi{constructor(a,h){super(a,h),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class ao extends hi{constructor(a,h){super(a,h),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class bg extends hi{constructor(a,h){super(a,h),this.current=yr.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const Py=new Float32Array(16);function Fs(d){return[so(255*d.r,255*d.g),so(255*d.b,255*d.a)]}class nu{constructor(a,h,m){this.value=a,this.uniformNames=h.map(b=>`u_${b}`),this.type=m}setUniform(a,h,m){a.set(m.constantOr(this.value))}getBinding(a,h,m){return this.type==="color"?new bg(a,h):new yo(a,h)}}class xl{constructor(a,h){this.uniformNames=h.map(m=>`u_${m}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=a.tlbr}setUniform(a,h,m,b){const T=b==="u_pattern_to"?this.patternTo:b==="u_pattern_from"?this.patternFrom:b==="u_pixel_ratio_to"?this.pixelRatioTo:b==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&a.set(T)}getBinding(a,h,m){return m.substr(0,9)==="u_pattern"?new ao(a,h):new yo(a,h)}}class ja{constructor(a,h,m,b){this.expression=a,this.type=m,this.maxValue=0,this.paintVertexAttributes=h.map(T=>({name:`a_${T}`,type:"Float32",components:m==="color"?2:1,offset:0})),this.paintVertexArray=new b}populatePaintArray(a,h,m,b,T){const A=this.paintVertexArray.length,z=this.expression.evaluate(new si(0),h,{},b,[],T);this.paintVertexArray.resize(a),this._setPaintValue(A,a,z)}updatePaintArray(a,h,m,b){const T=this.expression.evaluate({zoom:0},m,b);this._setPaintValue(a,h,T)}_setPaintValue(a,h,m){if(this.type==="color"){const b=Fs(m);for(let T=a;T<h;T++)this.paintVertexArray.emplace(T,b[0],b[1])}else{for(let b=a;b<h;b++)this.paintVertexArray.emplace(b,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _o{constructor(a,h,m,b,T,A){this.expression=a,this.uniformNames=h.map(z=>`u_${z}_t`),this.type=m,this.useIntegerZoom=b,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=h.map(z=>({name:`a_${z}`,type:"Float32",components:m==="color"?4:2,offset:0})),this.paintVertexArray=new A}populatePaintArray(a,h,m,b,T){const A=this.expression.evaluate(new si(this.zoom),h,{},b,[],T),z=this.expression.evaluate(new si(this.zoom+1),h,{},b,[],T),N=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(N,a,A,z)}updatePaintArray(a,h,m,b){const T=this.expression.evaluate({zoom:this.zoom},m,b),A=this.expression.evaluate({zoom:this.zoom+1},m,b);this._setPaintValue(a,h,T,A)}_setPaintValue(a,h,m,b){if(this.type==="color"){const T=Fs(m),A=Fs(b);for(let z=a;z<h;z++)this.paintVertexArray.emplace(z,T[0],T[1],A[0],A[1])}else{for(let T=a;T<h;T++)this.paintVertexArray.emplace(T,m,b);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(b))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,h){const m=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,b=_t(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);a.set(b)}getBinding(a,h,m){return new yo(a,h)}}class Ha{constructor(a,h,m,b,T,A){this.expression=a,this.type=h,this.useIntegerZoom=m,this.zoom=b,this.layerId=A,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(a,h,m){const b=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(b,a,h.patterns&&h.patterns[this.layerId],m)}updatePaintArray(a,h,m,b,T){this._setPaintValues(a,h,m.patterns&&m.patterns[this.layerId],T)}_setPaintValues(a,h,m,b){if(!b||!m)return;const{min:T,mid:A,max:z}=m,N=b[T],j=b[A],Y=b[z];if(N&&j&&Y)for(let te=a;te<h;te++)this.zoomInPaintVertexArray.emplace(te,j.tl[0],j.tl[1],j.br[0],j.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],j.pixelRatio,N.pixelRatio),this.zoomOutPaintVertexArray.emplace(te,j.tl[0],j.tl[1],j.br[0],j.br[1],Y.tl[0],Y.tl[1],Y.br[0],Y.br[1],j.pixelRatio,Y.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,vo.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,vo.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class dd{constructor(a,h,m){this.binders={},this._buffers=[];const b=[];for(const T in a.paint._values){if(!m(T))continue;const A=a.paint.get(T);if(!(A instanceof zs&&sc(A.property.specification)))continue;const z=fd(T,a.type),N=A.value,j=A.property.specification.type,Y=A.property.useIntegerZoom,te=A.property.specification["property-type"],he=te==="cross-faded"||te==="cross-faded-data-driven";if(N.kind==="constant")this.binders[T]=he?new xl(N.value,z):new nu(N.value,z,j),b.push(`/u_${T}`);else if(N.kind==="source"||he){const pe=pd(T,j,"source");this.binders[T]=he?new Ha(N,j,Y,h,pe,a.id):new ja(N,z,j,pe),b.push(`/a_${T}`)}else{const pe=pd(T,j,"composite");this.binders[T]=new _o(N,z,j,Y,h,pe),b.push(`/z_${T}`)}}this.cacheKey=b.sort().join("")}getMaxValue(a){const h=this.binders[a];return h instanceof ja||h instanceof _o?h.maxValue:0}populatePaintArrays(a,h,m,b,T){for(const A in this.binders){const z=this.binders[A];(z instanceof ja||z instanceof _o||z instanceof Ha)&&z.populatePaintArray(a,h,m,b,T)}}setConstantPatternPositions(a,h){for(const m in this.binders){const b=this.binders[m];b instanceof xl&&b.setConstantPatternPositions(a,h)}}updatePaintArrays(a,h,m,b,T){let A=!1;for(const z in a){const N=h.getPositions(z);for(const j of N){const Y=m.feature(j.index);for(const te in this.binders){const he=this.binders[te];if((he instanceof ja||he instanceof _o||he instanceof Ha)&&he.expression.isStateDependent===!0){const pe=b.paint.get(te);he.expression=pe.value,he.updatePaintArray(j.start,j.end,Y,a[z],T),A=!0}}}}return A}defines(){const a=[];for(const h in this.binders){const m=this.binders[h];(m instanceof nu||m instanceof xl)&&a.push(...m.uniformNames.map(b=>`#define HAS_UNIFORM_${b}`))}return a}getBinderAttributes(){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof ja||m instanceof _o)for(let b=0;b<m.paintVertexAttributes.length;b++)a.push(m.paintVertexAttributes[b].name);else if(m instanceof Ha)for(let b=0;b<vo.members.length;b++)a.push(vo.members[b].name)}return a}getBinderUniforms(){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof nu||m instanceof xl||m instanceof _o)for(const b of m.uniformNames)a.push(b)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,h){const m=[];for(const b in this.binders){const T=this.binders[b];if(T instanceof nu||T instanceof xl||T instanceof _o){for(const A of T.uniformNames)if(h[A]){const z=T.getBinding(a,h[A],A);m.push({name:A,property:b,binding:z})}}}return m}setUniforms(a,h,m,b){for(const{name:T,property:A,binding:z}of h)this.binders[A].setUniform(z,b,m.get(A),T)}updatePaintBuffers(a){this._buffers=[];for(const h in this.binders){const m=this.binders[h];if(a&&m instanceof Ha){const b=a.fromScale===2?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;b&&this._buffers.push(b)}else(m instanceof ja||m instanceof _o)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}}upload(a){for(const h in this.binders){const m=this.binders[h];(m instanceof ja||m instanceof _o||m instanceof Ha)&&m.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const h=this.binders[a];(h instanceof ja||h instanceof _o||h instanceof Ha)&&h.destroy()}}}class Ns{constructor(a,h,m=()=>!0){this.programConfigurations={};for(const b of a)this.programConfigurations[b.id]=new dd(b,h,m);this.needsUpload=!1,this._featureMap=new _a,this._bufferOffset=0}populatePaintArrays(a,h,m,b,T,A){for(const z in this.programConfigurations)this.programConfigurations[z].populatePaintArrays(a,h,b,T,A);h.id!==void 0&&this._featureMap.add(h.id,m,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,h,m,b){for(const T of m)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(a,this._featureMap,h,T,b)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const h in this.programConfigurations)this.programConfigurations[h].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}function fd(d,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[d]||[d.replace(`${a}-`,"").replace(/-/g,"_")]}function pd(d,a,h){const m={color:{source:Zu,composite:ce},number:{source:U,composite:Zu}},b=function(T){return{"line-pattern":{source:Vn,composite:Vn},"fill-pattern":{source:Vn,composite:Vn},"fill-extrusion-pattern":{source:Vn,composite:Vn}}[T]}(d);return b&&b[h]||m[a][h]}zn("ConstantBinder",nu),zn("CrossFadedConstantBinder",xl),zn("SourceExpressionBinder",ja),zn("CrossFadedCompositeBinder",Ha),zn("CompositeExpressionBinder",_o),zn("ProgramConfiguration",dd,{omit:["_buffers"]}),zn("ProgramConfigurationSet",Ns);const md=Math.pow(2,14)-1,Ay=-md-1;function Qu(d){const a=Qe/d.extent,h=d.loadGeometry();for(let m=0;m<h.length;m++){const b=h[m];for(let T=0;T<b.length;T++){const A=b[T],z=Math.round(A.x*a),N=Math.round(A.y*a);A.x=_t(z,Ay,md),A.y=_t(N,Ay,md),(z<A.x||z>A.x+1||N<A.y||N>A.y+1)&&fn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function eh(d,a){return{type:d.type,id:d.id,properties:d.properties,geometry:a?Qu(d):[]}}const Iy=-32768;function Tx(d,a,h,m,b){d.emplaceBack(Iy+8*a+m,Iy+8*h+b)}class Ry{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Tt,this.indexArray=new ai,this.segments=new Ar,this.programConfigurations=new Ns(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,m){const b=this.layers[0],T=[];let A=null,z=!1,N=b.type==="heatmap";if(b.type==="circle"){const Y=b;A=Y.layout.get("circle-sort-key"),z=!A.isConstant(),N=N||Y.paint.get("circle-pitch-alignment")==="map"}const j=N?h.subdivisionGranularity.circle:1;for(const{feature:Y,id:te,index:he,sourceLayerIndex:pe}of a){const ge=this.layers[0]._featureFilter.needGeometry,_e=eh(Y,ge);if(!this.layers[0]._featureFilter.filter(new si(this.zoom,{globalState:this.globalState}),_e,m))continue;const De=z?A.evaluate(_e,{},m):void 0,Ve={id:te,properties:Y.properties,type:Y.type,sourceLayerIndex:pe,index:he,geometry:ge?_e.geometry:Qu(Y),patterns:{},sortKey:De};T.push(Ve)}z&&T.sort((Y,te)=>Y.sortKey-te.sortKey);for(const Y of T){const{geometry:te,index:he,sourceLayerIndex:pe}=Y,ge=a[he].feature;this.addFeature(Y,te,he,m,j),h.featureIndex.insert(ge,te,he,pe,this.index)}}update(a,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,go),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,h,m,b,T=1){let A;switch(T){case 1:A=[0,7];break;case 3:A=[0,2,5,7];break;case 5:A=[0,1,3,4,6,7];break;case 7:A=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${T}; valid values are 1, 3, 5, 7.`)}const z=A.length;for(const N of h)for(const j of N){const Y=j.x,te=j.y;if(Y<0||Y>=Qe||te<0||te>=Qe)continue;const he=this.segments.prepareSegment(z*z,this.layoutVertexArray,this.indexArray,a.sortKey),pe=he.vertexLength;for(let ge=0;ge<z;ge++)for(let _e=0;_e<z;_e++)Tx(this.layoutVertexArray,Y,te,A[_e],A[ge]);for(let ge=0;ge<z-1;ge++)for(let _e=0;_e<z-1;_e++){const De=pe+ge*z+_e,Ve=pe+(ge+1)*z+_e;this.indexArray.emplaceBack(De,Ve+1,De+1),this.indexArray.emplaceBack(De,Ve,Ve+1)}he.vertexLength+=z*z,he.primitiveLength+=(z-1)*(z-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,{},b)}}function Bs(d,a){for(let h=0;h<d.length;h++)if(th(a,d[h]))return!0;for(let h=0;h<a.length;h++)if(th(d,a[h]))return!0;return!!wg(d,a)}function Us(d,a,h){return!!th(d,a)||!!Sg(a,d,h)}function Ly(d,a){if(d.length===1)return ky(a,d[0]);for(let h=0;h<a.length;h++){const m=a[h];for(let b=0;b<m.length;b++)if(th(d,m[b]))return!0}for(let h=0;h<d.length;h++)if(ky(a,d[h]))return!0;for(let h=0;h<a.length;h++)if(wg(d,a[h]))return!0;return!1}function Px(d,a,h){if(d.length>1){if(wg(d,a))return!0;for(let m=0;m<a.length;m++)if(Sg(a[m],d,h))return!0}for(let m=0;m<d.length;m++)if(Sg(d[m],a,h))return!0;return!1}function wg(d,a){if(d.length===0||a.length===0)return!1;for(let h=0;h<d.length-1;h++){const m=d[h],b=d[h+1];for(let T=0;T<a.length-1;T++)if(Ax(m,b,a[T],a[T+1]))return!0}return!1}function Ax(d,a,h,m){return Ut(d,h,m)!==Ut(a,h,m)&&Ut(d,a,h)!==Ut(d,a,m)}function Sg(d,a,h){const m=h*h;if(a.length===1)return d.distSqr(a[0])<m;for(let b=1;b<a.length;b++)if(Mg(d,a[b-1],a[b])<m)return!0;return!1}function Mg(d,a,h){const m=a.distSqr(h);if(m===0)return d.distSqr(a);const b=((d.x-a.x)*(h.x-a.x)+(d.y-a.y)*(h.y-a.y))/m;return d.distSqr(b<0?a:b>1?h:h.sub(a)._mult(b)._add(a))}function ky(d,a){let h,m,b,T=!1;for(let A=0;A<d.length;A++){h=d[A];for(let z=0,N=h.length-1;z<h.length;N=z++)m=h[z],b=h[N],m.y>a.y!=b.y>a.y&&a.x<(b.x-m.x)*(a.y-m.y)/(b.y-m.y)+m.x&&(T=!T)}return T}function th(d,a){let h=!1;for(let m=0,b=d.length-1;m<d.length;b=m++){const T=d[m],A=d[b];T.y>a.y!=A.y>a.y&&a.x<(A.x-T.x)*(a.y-T.y)/(A.y-T.y)+T.x&&(h=!h)}return h}function Ix(d,a,h){const m=h[0],b=h[2];if(d.x<m.x&&a.x<m.x||d.x>b.x&&a.x>b.x||d.y<m.y&&a.y<m.y||d.y>b.y&&a.y>b.y)return!1;const T=Ut(d,a,h[0]);return T!==Ut(d,a,h[1])||T!==Ut(d,a,h[2])||T!==Ut(d,a,h[3])}function bf(d,a,h){const m=a.paint.get(d).value;return m.kind==="constant"?m.value:h.programConfigurations.get(a.id).getMaxValue(d)}function wf(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function Sf(d,a,h,m,b){if(!a[0]&&!a[1])return d;const T=I.convert(a)._mult(b);h==="viewport"&&T._rotate(-m);const A=[];for(let z=0;z<d.length;z++)A.push(d[z].sub(T));return A}let Dy,Cg;zn("CircleBucket",Ry,{omit:["layers"]});var Eg={get paint(){return Cg=Cg||new vi({"circle-radius":new ar(qe.paint_circle["circle-radius"]),"circle-color":new ar(qe.paint_circle["circle-color"]),"circle-blur":new ar(qe.paint_circle["circle-blur"]),"circle-opacity":new ar(qe.paint_circle["circle-opacity"]),"circle-translate":new $n(qe.paint_circle["circle-translate"]),"circle-translate-anchor":new $n(qe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new $n(qe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new $n(qe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ar(qe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ar(qe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ar(qe.paint_circle["circle-stroke-opacity"])})},get layout(){return Dy=Dy||new vi({"circle-sort-key":new ar(qe.layout_circle["circle-sort-key"])})}};class PS extends oo{constructor(a){super(a,Eg)}createBucket(a){return new Ry(a)}queryRadius(a){const h=a;return bf("circle-radius",this,h)+bf("circle-stroke-width",this,h)+wf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:a,feature:h,featureState:m,geometry:b,transform:T,pixelsToTileUnits:A,unwrappedTileID:z,getElevation:N}){const j=Sf(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-T.bearingInRadians,A),Y=this.paint.get("circle-radius").evaluate(h,m)+this.paint.get("circle-stroke-width").evaluate(h,m),te=this.paint.get("circle-pitch-alignment")==="map",he=te?j:function(ge,_e,De,Ve){return ge.map(ft=>zy(ft,_e,De,Ve))}(j,T,z,N),pe=te?Y*A:Y;for(const ge of b)for(const _e of ge){const De=te?_e:zy(_e,T,z,N);let Ve=pe;const ft=T.projectTileCoordinates(_e.x,_e.y,z,N).signedDistanceFromCamera;if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ve*=ft/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ve*=T.cameraToCenterDistance/ft),Us(he,De,Ve))return!0}return!1}}function zy(d,a,h,m){const b=a.projectTileCoordinates(d.x,d.y,h,m).point;return new I((.5*b.x+.5)*a.width,(.5*-b.y+.5)*a.height)}class Tg extends Ry{}let Oy;zn("HeatmapBucket",Tg,{omit:["layers"]});var Pg={get paint(){return Oy=Oy||new vi({"heatmap-radius":new ar(qe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ar(qe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new $n(qe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ua(qe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new $n(qe.paint_heatmap["heatmap-opacity"])})}};function bl(d,{width:a,height:h},m,b){if(b){if(b instanceof Uint8ClampedArray)b=new Uint8Array(b.buffer);else if(b.length!==a*h*m)throw new RangeError(`mismatched image size. expected: ${b.length} but got: ${a*h*m}`)}else b=new Uint8Array(a*h*m);return d.width=a,d.height=h,d.data=b,d}function Rx(d,{width:a,height:h},m){if(a===d.width&&h===d.height)return;const b=bl({},{width:a,height:h},m);Ag(d,b,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,a),height:Math.min(d.height,h)},m),d.width=a,d.height=h,d.data=b.data}function Ag(d,a,h,m,b,T){if(b.width===0||b.height===0)return a;if(b.width>d.width||b.height>d.height||h.x>d.width-b.width||h.y>d.height-b.height)throw new RangeError("out of range source coordinates for image copy");if(b.width>a.width||b.height>a.height||m.x>a.width-b.width||m.y>a.height-b.height)throw new RangeError("out of range destination coordinates for image copy");const A=d.data,z=a.data;if(A===z)throw new Error("srcData equals dstData, so image is already copied");for(let N=0;N<b.height;N++){const j=((h.y+N)*d.width+h.x)*T,Y=((m.y+N)*a.width+m.x)*T;for(let te=0;te<b.width*T;te++)z[Y+te]=A[j+te]}return a}class gd{constructor(a,h){bl(this,a,1,h)}resize(a){Rx(this,a,1)}clone(){return new gd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,m,b,T){Ag(a,h,m,b,T,1)}}class xs{constructor(a,h){bl(this,a,4,h)}resize(a){Rx(this,a,4)}replace(a,h){h?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new xs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,m,b,T){Ag(a,h,m,b,T,4)}setPixel(a,h,m){const b=4*(a*this.width+h);this.data[b+0]=Math.round(255*m.r/m.a),this.data[b+1]=Math.round(255*m.g/m.a),this.data[b+2]=Math.round(255*m.b/m.a),this.data[b+3]=Math.round(255*m.a)}}function Fy(d){const a={},h=d.resolution||256,m=d.clips?d.clips.length:1,b=d.image||new xs({width:h,height:m});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);const T=(A,z,N)=>{a[d.evaluationKey]=N;const j=d.expression.evaluate(a);b.setPixel(A/4/h,z/4,j)};if(d.clips)for(let A=0,z=0;A<m;++A,z+=4*h)for(let N=0,j=0;N<h;N++,j+=4){const Y=N/(h-1),{start:te,end:he}=d.clips[A];T(z,j,te*(1-Y)+he*Y)}else for(let A=0,z=0;A<h;A++,z+=4)T(0,z,A/(h-1));return b}zn("AlphaImage",gd),zn("RGBAImage",xs);const vd="big-fb";class bs extends oo{createBucket(a){return new Tg(a)}constructor(a){super(a,Pg),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Fy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(vd)&&this.heatmapFbos.delete(vd)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Lx;var AS={get paint(){return Lx=Lx||new vi({"hillshade-illumination-direction":new $n(qe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new $n(qe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new $n(qe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new $n(qe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new $n(qe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new $n(qe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new $n(qe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new $n(qe.paint_hillshade["hillshade-method"])})}};class Ig extends oo{constructor(a){super(a,AS),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let a=this.paint.get("hillshade-illumination-direction").values,h=this.paint.get("hillshade-illumination-altitude").values,m=this.paint.get("hillshade-highlight-color").values,b=this.paint.get("hillshade-shadow-color").values;const T=Math.max(a.length,h.length,m.length,b.length);a=a.concat(Array(T-a.length).fill(a.at(-1))),h=h.concat(Array(T-h.length).fill(h.at(-1))),m=m.concat(Array(T-m.length).fill(m.at(-1))),b=b.concat(Array(T-b.length).fill(b.at(-1)));const A=h.map(un);return{directionRadians:a.map(un),altitudeRadians:A,shadowColor:b,highlightColor:m}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let ls;var IS={get paint(){return ls=ls||new vi({"color-relief-opacity":new $n(qe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new Ua(qe["paint_color-relief"]["color-relief-color"])})}};class er{constructor(a,h,m,b){this.context=a,this.format=m,this.texture=a.gl.createTexture(),this.update(h,b)}update(a,h,m){const{width:b,height:T}=a,A=!(this.size&&this.size[0]===b&&this.size[1]===T||m),{context:z}=this,{gl:N}=z;if(this.useMipmap=!!(h&&h.useMipmap),N.bindTexture(N.TEXTURE_2D,this.texture),z.pixelStoreUnpackFlipY.set(!1),z.pixelStoreUnpack.set(1),z.pixelStoreUnpackPremultiplyAlpha.set(this.format===N.RGBA&&(!h||h.premultiply!==!1)),A)this.size=[b,T],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||Ue(a)?N.texImage2D(N.TEXTURE_2D,0,this.format,this.format,N.UNSIGNED_BYTE,a):N.texImage2D(N.TEXTURE_2D,0,this.format,b,T,0,this.format,N.UNSIGNED_BYTE,a.data);else{const{x:j,y:Y}=m||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||Ue(a)?N.texSubImage2D(N.TEXTURE_2D,0,j,Y,N.RGBA,N.UNSIGNED_BYTE,a):N.texSubImage2D(N.TEXTURE_2D,0,j,Y,b,T,N.RGBA,N.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&N.generateMipmap(N.TEXTURE_2D),z.pixelStoreUnpackFlipY.setDefault(),z.pixelStoreUnpack.setDefault(),z.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(a,h,m){const{context:b}=this,{gl:T}=b;T.bindTexture(T.TEXTURE_2D,this.texture),m!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=T.LINEAR),a!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,a),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,m||a),this.filter=a),h!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,h),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class yd{constructor(a,h,m,b=1,T=1,A=1,z=0){if(this.uid=a,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(m&&!["mapbox","terrarium","custom"].includes(m))return void fn(`"${m}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;const N=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),m){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=b,this.greenFactor=T,this.blueFactor=A,this.baseShift=z;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let j=0;j<N;j++)this.data[this._idx(-1,j)]=this.data[this._idx(0,j)],this.data[this._idx(N,j)]=this.data[this._idx(N-1,j)],this.data[this._idx(j,-1)]=this.data[this._idx(j,0)],this.data[this._idx(j,N)]=this.data[this._idx(j,N-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(N,-1)]=this.data[this._idx(N-1,0)],this.data[this._idx(-1,N)]=this.data[this._idx(0,N-1)],this.data[this._idx(N,N)]=this.data[this._idx(N-1,N-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let j=0;j<N;j++)for(let Y=0;Y<N;Y++){const te=this.get(j,Y);te>this.max&&(this.max=te),te<this.min&&(this.min=te)}}get(a,h){const m=new Uint8Array(this.data.buffer),b=4*this._idx(a,h);return this.unpack(m[b],m[b+1],m[b+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,h){if(a<-1||a>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(a+1)}unpack(a,h,m){return a*this.redFactor+h*this.greenFactor+m*this.blueFactor-this.baseShift}pack(a){return Rg(a,this.getUnpackVector())}getPixels(){return new xs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,h,m){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let b=h*this.dim,T=h*this.dim+this.dim,A=m*this.dim,z=m*this.dim+this.dim;switch(h){case-1:b=T-1;break;case 1:T=b+1}switch(m){case-1:A=z-1;break;case 1:z=A+1}const N=-h*this.dim,j=-m*this.dim;for(let Y=A;Y<z;Y++)for(let te=b;te<T;te++)this.data[this._idx(te,Y)]=a.data[this._idx(te+N,Y+j)]}}function Rg(d,a){const h=a[0],m=a[1],b=a[2],T=a[3],A=Math.min(h,m,b),z=Math.round((d+T)/A);return{r:Math.floor(z*A/h)%256,g:Math.floor(z*A/m)%256,b:Math.floor(z*A/b)%256}}zn("DEMData",yd);class kx extends oo{constructor(a){super(a,IS)}_createColorRamp(a){const h={elevationStops:[],colorStops:[]},m=this._transitionablePaint._values["color-relief-color"].value.expression;if(m instanceof Fa&&m._styleExpression.expression instanceof ns){this.colorRampExpression=m;const A=m._styleExpression.expression;h.elevationStops=A.labels,h.colorStops=[];for(const z of h.elevationStops)h.colorStops.push(A.evaluate({globals:{elevation:z}}))}if(h.elevationStops.length<1&&(h.elevationStops=[0],h.colorStops=[yr.transparent]),h.elevationStops.length<2&&(h.elevationStops.push(h.elevationStops[0]+1),h.colorStops.push(h.colorStops[0])),h.elevationStops.length<=a)return h;const b={elevationStops:[],colorStops:[]},T=(h.elevationStops.length-1)/(a-1);for(let A=0;A<h.elevationStops.length-.5;A+=T)b.elevationStops.push(h.elevationStops[Math.round(A)]),b.colorStops.push(h.colorStops[Math.round(A)]);return fn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),b}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(a,h,m){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const b=this._createColorRamp(h),T=new xs({width:b.colorStops.length,height:1}),A=new xs({width:b.colorStops.length,height:1});for(let z=0;z<b.elevationStops.length;z++){const N=Rg(b.elevationStops[z],m);A.setPixel(0,z,new yr(N.r/255,N.g/255,N.b/255,1)),T.setPixel(0,z,b.colorStops[z])}return this.colorRampTextures={elevationTexture:new er(a,A,a.gl.RGBA),colorTexture:new er(a,T,a.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const RS=Ci([{name:"a_pos",components:2,type:"Int16"}],4),{members:Jp}=RS;function Mf(d,a,h){const m=h.patternDependencies;let b=!1;for(const T of a){const A=T.paint.get(`${d}-pattern`);A.isConstant()||(b=!0);const z=A.constantOr(null);z&&(b=!0,m[z.to]=!0,m[z.from]=!0)}return b}function Qp(d,a,h,m,b){const T=b.patternDependencies;for(const A of a){const z=A.paint.get(`${d}-pattern`).value;if(z.kind!=="constant"){let N=z.evaluate({zoom:m-1},h,{},b.availableImages),j=z.evaluate({zoom:m},h,{},b.availableImages),Y=z.evaluate({zoom:m+1},h,{},b.availableImages);N=N&&N.name?N.name:N,j=j&&j.name?j.name:j,Y=Y&&Y.name?Y.name:Y,T[N]=!0,T[j]=!0,T[Y]=!0,h.patterns[A.id]={min:N,mid:j,max:Y}}}return h}function Ny(d,a,h,m,b){let T;if(b===function(A,z,N,j){let Y=0;for(let te=z,he=N-j;te<N;te+=j)Y+=(A[he]-A[te])*(A[te+1]+A[he+1]),he=te;return Y}(d,a,h,m)>0)for(let A=a;A<h;A+=m)T=Jr(A/m|0,d[A],d[A+1],T);else for(let A=h-m;A>=a;A-=m)T=Jr(A/m|0,d[A],d[A+1],T);return T&&_d(T,T.next)&&(Ji(T),T=T.next),T}function nh(d,a){if(!d)return d;a||(a=d);let h,m=d;do if(h=!1,m.steiner||!_d(m,m.next)&&Bi(m.prev,m,m.next)!==0)m=m.next;else{if(Ji(m),m=a=m.prev,m===m.next)break;h=!0}while(h||m!==a);return a}function Cf(d,a,h,m,b,T,A){if(!d)return;!A&&T&&function(N,j,Y,te){let he=N;do he.z===0&&(he.z=xa(he.x,he.y,j,Y,te)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==N);he.prevZ.nextZ=null,he.prevZ=null,function(pe){let ge,_e=1;do{let De,Ve=pe;pe=null;let ft=null;for(ge=0;Ve;){ge++;let tt=Ve,de=0;for(let it=0;it<_e&&(de++,tt=tt.nextZ,tt);it++);let ke=_e;for(;de>0||ke>0&&tt;)de!==0&&(ke===0||!tt||Ve.z<=tt.z)?(De=Ve,Ve=Ve.nextZ,de--):(De=tt,tt=tt.nextZ,ke--),ft?ft.nextZ=De:pe=De,De.prevZ=ft,ft=De;Ve=tt}ft.nextZ=null,_e*=2}while(ge>1)}(he)}(d,m,b,T);let z=d;for(;d.prev!==d.next;){const N=d.prev,j=d.next;if(T?Uy(d,m,b,T):By(d))a.push(N.i,d.i,j.i),Ji(d),d=j.next,z=j.next;else if((d=j)===z){A?A===1?Cf(d=cs(nh(d),a),a,h,m,b,T,2):A===2&&wl(d,a,h,m,b,T):Cf(nh(d),a,h,m,b,T,1);break}}}function By(d){const a=d.prev,h=d,m=d.next;if(Bi(a,h,m)>=0)return!1;const b=a.x,T=h.x,A=m.x,z=a.y,N=h.y,j=m.y,Y=Math.min(b,T,A),te=Math.min(z,N,j),he=Math.max(b,T,A),pe=Math.max(z,N,j);let ge=m.next;for(;ge!==a;){if(ge.x>=Y&&ge.x<=he&&ge.y>=te&&ge.y<=pe&&em(b,z,T,N,A,j,ge.x,ge.y)&&Bi(ge.prev,ge,ge.next)>=0)return!1;ge=ge.next}return!0}function Uy(d,a,h,m){const b=d.prev,T=d,A=d.next;if(Bi(b,T,A)>=0)return!1;const z=b.x,N=T.x,j=A.x,Y=b.y,te=T.y,he=A.y,pe=Math.min(z,N,j),ge=Math.min(Y,te,he),_e=Math.max(z,N,j),De=Math.max(Y,te,he),Ve=xa(pe,ge,a,h,m),ft=xa(_e,De,a,h,m);let tt=d.prevZ,de=d.nextZ;for(;tt&&tt.z>=Ve&&de&&de.z<=ft;){if(tt.x>=pe&&tt.x<=_e&&tt.y>=ge&&tt.y<=De&&tt!==b&&tt!==A&&em(z,Y,N,te,j,he,tt.x,tt.y)&&Bi(tt.prev,tt,tt.next)>=0||(tt=tt.prevZ,de.x>=pe&&de.x<=_e&&de.y>=ge&&de.y<=De&&de!==b&&de!==A&&em(z,Y,N,te,j,he,de.x,de.y)&&Bi(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;tt&&tt.z>=Ve;){if(tt.x>=pe&&tt.x<=_e&&tt.y>=ge&&tt.y<=De&&tt!==b&&tt!==A&&em(z,Y,N,te,j,he,tt.x,tt.y)&&Bi(tt.prev,tt,tt.next)>=0)return!1;tt=tt.prevZ}for(;de&&de.z<=ft;){if(de.x>=pe&&de.x<=_e&&de.y>=ge&&de.y<=De&&de!==b&&de!==A&&em(z,Y,N,te,j,he,de.x,de.y)&&Bi(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function cs(d,a){let h=d;do{const m=h.prev,b=h.next.next;!_d(m,b)&&$y(m,h,h.next,b)&&bd(m,b)&&bd(b,m)&&(a.push(m.i,h.i,b.i),Ji(h),Ji(h.next),h=d=b),h=h.next}while(h!==d);return nh(h)}function wl(d,a,h,m,b,T){let A=d;do{let z=A.next.next;for(;z!==A.prev;){if(A.i!==z.i&&Fx(A,z)){let N=ba(A,z);return A=nh(A,A.next),N=nh(N,N.next),Cf(A,a,h,m,b,T,0),void Cf(N,a,h,m,b,T,0)}z=z.next}A=A.next}while(A!==d)}function rh(d,a){let h=d.x-a.x;return h===0&&(h=d.y-a.y,h===0)&&(h=(d.next.y-d.y)/(d.next.x-d.x)-(a.next.y-a.y)/(a.next.x-a.x)),h}function Dx(d,a){const h=function(b,T){let A=T;const z=b.x,N=b.y;let j,Y=-1/0;if(_d(b,A))return A;do{if(_d(b,A.next))return A.next;if(N<=A.y&&N>=A.next.y&&A.next.y!==A.y){const _e=A.x+(N-A.y)*(A.next.x-A.x)/(A.next.y-A.y);if(_e<=z&&_e>Y&&(Y=_e,j=A.x<A.next.x?A:A.next,_e===z))return j}A=A.next}while(A!==T);if(!j)return null;const te=j,he=j.x,pe=j.y;let ge=1/0;A=j;do{if(z>=A.x&&A.x>=he&&z!==A.x&&Sl(N<pe?z:Y,N,he,pe,N<pe?Y:z,N,A.x,A.y)){const _e=Math.abs(N-A.y)/(z-A.x);bd(A,b)&&(_e<ge||_e===ge&&(A.x>j.x||A.x===j.x&&zx(j,A)))&&(j=A,ge=_e)}A=A.next}while(A!==te);return j}(d,a);if(!h)return a;const m=ba(h,d);return nh(m,m.next),nh(h,h.next)}function zx(d,a){return Bi(d.prev,d,a.prev)<0&&Bi(a.next,d,d.next)<0}function xa(d,a,h,m,b){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-h)*b|0)|d<<8))|d<<4))|d<<2))|d<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-m)*b|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function Ox(d){let a=d,h=d;do(a.x<h.x||a.x===h.x&&a.y<h.y)&&(h=a),a=a.next;while(a!==d);return h}function Sl(d,a,h,m,b,T,A,z){return(b-A)*(a-z)>=(d-A)*(T-z)&&(d-A)*(m-z)>=(h-A)*(a-z)&&(h-A)*(T-z)>=(b-A)*(m-z)}function em(d,a,h,m,b,T,A,z){return!(d===A&&a===z)&&Sl(d,a,h,m,b,T,A,z)}function Fx(d,a){return d.next.i!==a.i&&d.prev.i!==a.i&&!function(h,m){let b=h;do{if(b.i!==h.i&&b.next.i!==h.i&&b.i!==m.i&&b.next.i!==m.i&&$y(b,b.next,h,m))return!0;b=b.next}while(b!==h);return!1}(d,a)&&(bd(d,a)&&bd(a,d)&&function(h,m){let b=h,T=!1;const A=(h.x+m.x)/2,z=(h.y+m.y)/2;do b.y>z!=b.next.y>z&&b.next.y!==b.y&&A<(b.next.x-b.x)*(z-b.y)/(b.next.y-b.y)+b.x&&(T=!T),b=b.next;while(b!==h);return T}(d,a)&&(Bi(d.prev,d,a.prev)||Bi(d,a.prev,a))||_d(d,a)&&Bi(d.prev,d,d.next)>0&&Bi(a.prev,a,a.next)>0)}function Bi(d,a,h){return(a.y-d.y)*(h.x-a.x)-(a.x-d.x)*(h.y-a.y)}function _d(d,a){return d.x===a.x&&d.y===a.y}function $y(d,a,h,m){const b=xd(Bi(d,a,h)),T=xd(Bi(d,a,m)),A=xd(Bi(h,m,d)),z=xd(Bi(h,m,a));return b!==T&&A!==z||!(b!==0||!Lg(d,h,a))||!(T!==0||!Lg(d,m,a))||!(A!==0||!Lg(h,d,m))||!(z!==0||!Lg(h,a,m))}function Lg(d,a,h){return a.x<=Math.max(d.x,h.x)&&a.x>=Math.min(d.x,h.x)&&a.y<=Math.max(d.y,h.y)&&a.y>=Math.min(d.y,h.y)}function xd(d){return d>0?1:d<0?-1:0}function bd(d,a){return Bi(d.prev,d,d.next)<0?Bi(d,a,d.next)>=0&&Bi(d,d.prev,a)>=0:Bi(d,a,d.prev)<0||Bi(d,d.next,a)<0}function ba(d,a){const h=Qi(d.i,d.x,d.y),m=Qi(a.i,a.x,a.y),b=d.next,T=a.prev;return d.next=a,a.prev=d,h.next=b,b.prev=h,m.next=h,h.prev=m,T.next=m,m.prev=T,m}function Jr(d,a,h,m){const b=Qi(d,a,h);return m?(b.next=m.next,b.prev=m,m.next.prev=b,m.next=b):(b.prev=b,b.next=b),b}function Ji(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function Qi(d,a,h){return{i:d,x:a,y:h,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class eo{constructor(a,h){if(h>a)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=a,this._minGranularity=h}getGranularityForZoomLevel(a){return Math.max(Math.floor(this._baseZoomGranularity/(1<<a)),this._minGranularity,1)}}class ws{constructor(a){this.fill=a.fill,this.line=a.line,this.tile=a.tile,this.stencil=a.stencil,this.circle=a.circle}}ws.noSubdivision=new ws({fill:new eo(0,0),line:new eo(0,0),tile:new eo(0,0),stencil:new eo(0,0),circle:1}),zn("SubdivisionGranularityExpression",eo),zn("SubdivisionGranularitySetting",ws);const Ml=-32768,Gi=32767;class tm{constructor(a,h){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=a,this._granularityCellSize=Qe/a,this._canonical=h}_getKey(a,h){return(a+=32768)<<16|h+32768}_vertexToIndex(a,h){if(a<-32768||h<-32768||a>32767||h>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const m=0|Math.round(a),b=0|Math.round(h),T=this._getKey(m,b);if(this._vertexDictionary.has(T))return this._vertexDictionary.get(T);const A=this._vertexBuffer.length/2;return this._vertexDictionary.set(T,A),this._vertexBuffer.push(m,b),A}_subdivideTrianglesScanline(a){if(this._granularity<2)return function(b,T){const A=[];for(let z=0;z<T.length;z+=3){const N=T[z],j=T[z+1],Y=T[z+2],te=b[2*N],he=b[2*N+1];(b[2*j]-te)*(b[2*Y+1]-he)-(b[2*j+1]-he)*(b[2*Y]-te)>0?(A.push(N),A.push(Y),A.push(j)):(A.push(N),A.push(j),A.push(Y))}return A}(this._vertexBuffer,a);const h=[],m=a.length;for(let b=0;b<m;b+=3){const T=[a[b+0],a[b+1],a[b+2]],A=[this._vertexBuffer[2*a[b+0]+0],this._vertexBuffer[2*a[b+0]+1],this._vertexBuffer[2*a[b+1]+0],this._vertexBuffer[2*a[b+1]+1],this._vertexBuffer[2*a[b+2]+0],this._vertexBuffer[2*a[b+2]+1]];let z=1/0,N=1/0,j=-1/0,Y=-1/0;for(let _e=0;_e<3;_e++){const De=A[2*_e],Ve=A[2*_e+1];z=Math.min(z,De),j=Math.max(j,De),N=Math.min(N,Ve),Y=Math.max(Y,Ve)}if(z===j||N===Y)continue;const te=Math.floor(z/this._granularityCellSize),he=Math.ceil(j/this._granularityCellSize),pe=Math.floor(N/this._granularityCellSize),ge=Math.ceil(Y/this._granularityCellSize);if(te!==he||pe!==ge)for(let _e=pe;_e<ge;_e++){const De=this._scanlineGenerateVertexRingForCellRow(_e,A,T);Vy(this._vertexBuffer,De,h)}else h.push(...T)}return h}_scanlineGenerateVertexRingForCellRow(a,h,m){const b=a*this._granularityCellSize,T=b+this._granularityCellSize,A=[];for(let z=0;z<3;z++){const N=h[2*z],j=h[2*z+1],Y=h[2*(z+1)%6],te=h[(2*(z+1)+1)%6],he=h[2*(z+2)%6],pe=h[(2*(z+2)+1)%6],ge=Y-N,_e=te-j,De=ge===0,Ve=_e===0,ft=(b-j)/_e,tt=(T-j)/_e,de=Math.min(ft,tt),ke=Math.max(ft,tt);if(!Ve&&(de>=1||ke<=0)||Ve&&(j<b||j>T)){te>=b&&te<=T&&A.push(m[(z+1)%3]);continue}!Ve&&de>0&&A.push(this._vertexToIndex(N+ge*de,j+_e*de));const it=N+ge*Math.max(de,0),Rt=N+ge*Math.min(ke,1);De||this._generateIntraEdgeVertices(A,N,j,Y,te,it,Rt),!Ve&&ke<1&&A.push(this._vertexToIndex(N+ge*ke,j+_e*ke)),(Ve||te>=b&&te<=T)&&A.push(m[(z+1)%3]),!Ve&&(te<=b||te>=T)&&this._generateInterEdgeVertices(A,N,j,Y,te,he,pe,Rt,b,T)}return A}_generateIntraEdgeVertices(a,h,m,b,T,A,z){const N=b-h,j=T-m,Y=j===0,te=Y?Math.min(h,b):Math.min(A,z),he=Y?Math.max(h,b):Math.max(A,z),pe=Math.floor(te/this._granularityCellSize)+1,ge=Math.ceil(he/this._granularityCellSize)-1;if(Y?h<b:A<z)for(let _e=pe;_e<=ge;_e++){const De=_e*this._granularityCellSize;a.push(this._vertexToIndex(De,m+j*(De-h)/N))}else for(let _e=ge;_e>=pe;_e--){const De=_e*this._granularityCellSize;a.push(this._vertexToIndex(De,m+j*(De-h)/N))}}_generateInterEdgeVertices(a,h,m,b,T,A,z,N,j,Y){const te=T-m,he=A-b,pe=z-T,ge=(j-T)/pe,_e=(Y-T)/pe,De=Math.min(ge,_e),Ve=Math.max(ge,_e),ft=b+he*De;let tt=Math.floor(Math.min(ft,N)/this._granularityCellSize)+1,de=Math.ceil(Math.max(ft,N)/this._granularityCellSize)-1,ke=N<ft;const it=pe===0;if(it&&(z===j||z===Y))return;if(it||De>=1||Ve<=0){const an=m-z,Ft=A+(h-A)*Math.min((j-z)/an,(Y-z)/an);tt=Math.floor(Math.min(Ft,N)/this._granularityCellSize)+1,de=Math.ceil(Math.max(Ft,N)/this._granularityCellSize)-1,ke=N<Ft}const Rt=te>0?Y:j;if(ke)for(let an=tt;an<=de;an++)a.push(this._vertexToIndex(an*this._granularityCellSize,Rt));else for(let an=de;an>=tt;an--)a.push(this._vertexToIndex(an*this._granularityCellSize,Rt))}_generateOutline(a){const h=[];for(const m of a){const b=yc(m,this._granularity,!0),T=this._pointArrayToIndices(b),A=[];for(let z=1;z<T.length;z++)A.push(T[z-1]),A.push(T[z]);h.push(A)}return h}_handlePoles(a){let h=!1,m=!1;this._canonical&&(this._canonical.y===0&&(h=!0),this._canonical.y===(1<<this._canonical.z)-1&&(m=!0)),(h||m)&&this._fillPoles(a,h,m)}_ensureNoPoleVertices(){const a=this._vertexBuffer;for(let h=0;h<a.length;h+=2){const m=a[h+1];m===Ml&&(a[h+1]=-32767),m===Gi&&(a[h+1]=32766)}}_generatePoleQuad(a,h,m,b,T,A){b>T!=(A===Ml)?(a.push(h),a.push(m),a.push(this._vertexToIndex(b,A)),a.push(m),a.push(this._vertexToIndex(T,A)),a.push(this._vertexToIndex(b,A))):(a.push(m),a.push(h),a.push(this._vertexToIndex(b,A)),a.push(this._vertexToIndex(T,A)),a.push(m),a.push(this._vertexToIndex(b,A)))}_fillPoles(a,h,m){const b=this._vertexBuffer,T=Qe,A=a.length;for(let z=2;z<A;z+=3){const N=a[z-2],j=a[z-1],Y=a[z],te=b[2*N],he=b[2*N+1],pe=b[2*j],ge=b[2*j+1],_e=b[2*Y],De=b[2*Y+1];h&&(he===0&&ge===0&&this._generatePoleQuad(a,N,j,te,pe,Ml),ge===0&&De===0&&this._generatePoleQuad(a,j,Y,pe,_e,Ml),De===0&&he===0&&this._generatePoleQuad(a,Y,N,_e,te,Ml)),m&&(he===T&&ge===T&&this._generatePoleQuad(a,N,j,te,pe,Gi),ge===T&&De===T&&this._generatePoleQuad(a,j,Y,pe,_e,Gi),De===T&&he===T&&this._generatePoleQuad(a,Y,N,_e,te,Gi))}}_initializeVertices(a){for(let h=0;h<a.length;h+=2)this._vertexToIndex(a[h],a[h+1])}subdividePolygonInternal(a,h){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:m,holeIndices:b}=function(z){const N=[],j=[];for(const Y of z)if(Y.length!==0){Y!==z[0]&&N.push(j.length/2);for(let te=0;te<Y.length;te++)j.push(Y[te].x),j.push(Y[te].y)}return{flattened:j,holeIndices:N}}(a);let T;this._initializeVertices(m);try{const z=function(j,Y,te=2){const he=Y&&Y.length,pe=he?Y[0]*te:j.length;let ge=Ny(j,0,pe,te,!0);const _e=[];if(!ge||ge.next===ge.prev)return _e;let De,Ve,ft;if(he&&(ge=function(tt,de,ke,it){const Rt=[];for(let an=0,Ft=de.length;an<Ft;an++){const jt=Ny(tt,de[an]*it,an<Ft-1?de[an+1]*it:tt.length,it,!1);jt===jt.next&&(jt.steiner=!0),Rt.push(Ox(jt))}Rt.sort(rh);for(let an=0;an<Rt.length;an++)ke=Dx(Rt[an],ke);return ke}(j,Y,ge,te)),j.length>80*te){De=1/0,Ve=1/0;let tt=-1/0,de=-1/0;for(let ke=te;ke<pe;ke+=te){const it=j[ke],Rt=j[ke+1];it<De&&(De=it),Rt<Ve&&(Ve=Rt),it>tt&&(tt=it),Rt>de&&(de=Rt)}ft=Math.max(tt-De,de-Ve),ft=ft!==0?32767/ft:0}return Cf(ge,_e,te,De,Ve,ft,0),_e}(m,b),N=this._convertIndices(m,z);T=this._subdivideTrianglesScanline(N)}catch(z){console.error(z)}let A=[];return h&&(A=this._generateOutline(a)),this._ensureNoPoleVertices(),this._handlePoles(T),{verticesFlattened:this._vertexBuffer,indicesTriangles:T,indicesLineList:A}}_convertIndices(a,h){const m=[];for(let b=0;b<h.length;b++)m.push(this._vertexToIndex(a[2*h[b]],a[2*h[b]+1]));return m}_pointArrayToIndices(a){const h=[];for(let m=0;m<a.length;m++){const b=a[m];h.push(this._vertexToIndex(b.x,b.y))}return h}}function ih(d,a,h,m=!0){return new tm(h,a).subdividePolygonInternal(d,m)}function yc(d,a,h=!1){if(!d||d.length<1)return[];if(d.length<2)return[];const m=d[0],b=d[d.length-1],T=h&&(m.x!==b.x||m.y!==b.y);if(a<2)return T?[...d,d[0]]:[...d];const A=Math.floor(Qe/a),z=[];z.push(new I(d[0].x,d[0].y));const N=d.length,j=T?N:N-1;for(let Y=0;Y<j;Y++){const te=d[Y],he=Y<N-1?d[Y+1]:d[0],pe=te.x,ge=te.y,_e=he.x,De=he.y,Ve=pe!==_e,ft=ge!==De;if(!Ve&&!ft)continue;const tt=_e-pe,de=De-ge,ke=Math.abs(tt),it=Math.abs(de);let Rt=pe,an=ge;for(;;){const jt=tt>0?(Math.floor(Rt/A)+1)*A:(Math.ceil(Rt/A)-1)*A,yn=de>0?(Math.floor(an/A)+1)*A:(Math.ceil(an/A)-1)*A,ln=Math.abs(Rt-jt),bn=Math.abs(an-yn),Xt=Math.abs(Rt-_e),Hn=Math.abs(an-De),hr=Ve?ln/ke:Number.POSITIVE_INFINITY,lr=ft?bn/it:Number.POSITIVE_INFINITY;if((Xt<=ln||!Ve)&&(Hn<=bn||!ft))break;if(hr<lr&&Ve||!ft){Rt=jt,an+=de*hr;const Jn=new I(Rt,Math.round(an));z[z.length-1].x===Jn.x&&z[z.length-1].y===Jn.y||z.push(Jn)}else{Rt+=tt*lr,an=yn;const Jn=new I(Math.round(Rt),an);z[z.length-1].x===Jn.x&&z[z.length-1].y===Jn.y||z.push(Jn)}}const Ft=new I(_e,De);z[z.length-1].x===Ft.x&&z[z.length-1].y===Ft.y||z.push(Ft)}return z}function Vy(d,a,h){if(a.length===0)throw new Error("Subdivision vertex ring is empty.");let m=0,b=d[2*a[0]];for(let N=1;N<a.length;N++){const j=d[2*a[N]];j<b&&(b=j,m=N)}const T=a.length;let A=m,z=(A+1)%T;for(;;){const N=A-1>=0?A-1:T-1,j=(z+1)%T,Y=d[2*a[N]],te=d[2*a[j]],he=d[2*a[A]],pe=d[2*a[A]+1],ge=d[2*a[z]+1];let _e=!1;if(Y<te)_e=!0;else if(Y>te)_e=!1;else{const De=ge-pe,Ve=-(d[2*a[z]]-he),ft=pe<ge?1:-1;((Y-he)*De+(d[2*a[N]+1]-pe)*Ve)*ft>((te-he)*De+(d[2*a[j]+1]-pe)*Ve)*ft&&(_e=!0)}if(_e){const De=a[N],Ve=a[A],ft=a[z];De!==Ve&&De!==ft&&Ve!==ft&&h.push(ft,Ve,De),A--,A<0&&(A=T-1)}else{const De=a[j],Ve=a[A],ft=a[z];De!==Ve&&De!==ft&&Ve!==ft&&h.push(ft,Ve,De),z++,z>=T&&(z=0)}if(N===j)break}}function Ef(d,a,h,m,b,T,A,z,N){const j=b.length/2,Y=A&&z&&N;if(j<Ar.MAX_VERTEX_ARRAY_LENGTH){const te=a.prepareSegment(j,h,m),he=te.vertexLength;for(let _e=0;_e<T.length;_e+=3)m.emplaceBack(he+T[_e],he+T[_e+1],he+T[_e+2]);let pe,ge;te.vertexLength+=j,te.primitiveLength+=T.length/3,Y&&(ge=A.prepareSegment(j,h,z),pe=ge.vertexLength,ge.vertexLength+=j);for(let _e=0;_e<b.length;_e+=2)d(b[_e],b[_e+1]);if(Y)for(let _e=0;_e<N.length;_e++){const De=N[_e];for(let Ve=1;Ve<De.length;Ve+=2)z.emplaceBack(pe+De[Ve-1],pe+De[Ve]);ge.primitiveLength+=De.length/2}}else(function(te,he,pe,ge,_e,De){const Ve=[];for(let it=0;it<ge.length/2;it++)Ve.push(-1);const ft={count:0};let tt=0,de=te.getOrCreateLatestSegment(he,pe),ke=de.vertexLength;for(let it=2;it<_e.length;it+=3){const Rt=_e[it-2],an=_e[it-1],Ft=_e[it];let jt=Ve[Rt]<tt,yn=Ve[an]<tt,ln=Ve[Ft]<tt;de.vertexLength+((jt?1:0)+(yn?1:0)+(ln?1:0))>Ar.MAX_VERTEX_ARRAY_LENGTH&&(de=te.createNewSegment(he,pe),tt=ft.count,jt=!0,yn=!0,ln=!0,ke=0);const bn=Ho(Ve,ge,De,ft,Rt,jt,de),Xt=Ho(Ve,ge,De,ft,an,yn,de),Hn=Ho(Ve,ge,De,ft,Ft,ln,de);pe.emplaceBack(ke+bn-tt,ke+Xt-tt,ke+Hn-tt),de.primitiveLength++}})(a,h,m,b,T,d),Y&&function(te,he,pe,ge,_e,De){const Ve=[];for(let it=0;it<ge.length/2;it++)Ve.push(-1);const ft={count:0};let tt=0,de=te.getOrCreateLatestSegment(he,pe),ke=de.vertexLength;for(let it=0;it<_e.length;it++){const Rt=_e[it];for(let an=1;an<_e[it].length;an+=2){const Ft=Rt[an-1],jt=Rt[an];let yn=Ve[Ft]<tt,ln=Ve[jt]<tt;de.vertexLength+((yn?1:0)+(ln?1:0))>Ar.MAX_VERTEX_ARRAY_LENGTH&&(de=te.createNewSegment(he,pe),tt=ft.count,yn=!0,ln=!0,ke=0);const bn=Ho(Ve,ge,De,ft,Ft,yn,de),Xt=Ho(Ve,ge,De,ft,jt,ln,de);pe.emplaceBack(ke+bn-tt,ke+Xt-tt),de.primitiveLength++}}}(A,h,z,b,N,d),a.forceNewSegmentOnNextPrepare(),A?.forceNewSegmentOnNextPrepare()}function Ho(d,a,h,m,b,T,A){if(T){const z=m.count;return h(a[2*b],a[2*b+1]),d[b]=m.count,m.count++,A.vertexLength++,z}return d[b]}class nm{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new kt,this.indexArray=new ai,this.indexArray2=new Kr,this.programConfigurations=new Ns(a.layers,a.zoom),this.segments=new Ar,this.segments2=new Ar,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,m){this.hasPattern=Mf("fill",this.layers,h);const b=this.layers[0].layout.get("fill-sort-key"),T=!b.isConstant(),A=[];for(const{feature:z,id:N,index:j,sourceLayerIndex:Y}of a){const te=this.layers[0]._featureFilter.needGeometry,he=eh(z,te);if(!this.layers[0]._featureFilter.filter(new si(this.zoom,{globalState:this.globalState}),he,m))continue;const pe=T?b.evaluate(he,{},m,h.availableImages):void 0,ge={id:N,properties:z.properties,type:z.type,sourceLayerIndex:Y,index:j,geometry:te?he.geometry:Qu(z),patterns:{},sortKey:pe};A.push(ge)}T&&A.sort((z,N)=>z.sortKey-N.sortKey);for(const z of A){const{geometry:N,index:j,sourceLayerIndex:Y}=z;if(this.hasPattern){const te=Qp("fill",this.layers,z,this.zoom,h);this.patternFeatures.push(te)}else this.addFeature(z,N,j,m,{},h.subdivisionGranularity);h.featureIndex.insert(a[j].feature,N,j,Y,this.index)}}update(a,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,m)}addFeatures(a,h,m){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,h,m,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Jp),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,h,m,b,T,A){for(const z of ec(h,500)){const N=ih(z,b,A.fill.getGranularityForZoomLevel(b.z)),j=this.layoutVertexArray;Ef((Y,te)=>{j.emplaceBack(Y,te)},this.segments,this.layoutVertexArray,this.indexArray,N.verticesFlattened,N.indicesTriangles,this.segments2,this.indexArray2,N.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,T,b)}}let wd,_c;zn("FillBucket",nm,{omit:["layers","patternFeatures"]});var kg={get paint(){return _c=_c||new vi({"fill-antialias":new $n(qe.paint_fill["fill-antialias"]),"fill-opacity":new ar(qe.paint_fill["fill-opacity"]),"fill-color":new ar(qe.paint_fill["fill-color"]),"fill-outline-color":new ar(qe.paint_fill["fill-outline-color"]),"fill-translate":new $n(qe.paint_fill["fill-translate"]),"fill-translate-anchor":new $n(qe.paint_fill["fill-translate-anchor"]),"fill-pattern":new qu(qe.paint_fill["fill-pattern"])})},get layout(){return wd=wd||new vi({"fill-sort-key":new ar(qe.layout_fill["fill-sort-key"])})}};class jy extends oo{constructor(a){super(a,kg)}recalculate(a,h){super.recalculate(a,h);const m=this.paint._values["fill-outline-color"];m.value.kind==="constant"&&m.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new nm(a)}queryRadius(){return wf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:a,geometry:h,transform:m,pixelsToTileUnits:b}){return Ly(Sf(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-m.bearingInRadians,b),h)}isTileClipped(){return!0}}const oh=Ci([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Dg=Ci([{name:"a_centroid",components:2,type:"Int16"}],4),{members:sh}=oh;var Tf,Pf,rm,im,Af,Ss,ru,na={};function $s(){if(Pf)return Tf;Pf=1;var d=w();function a(b,T,A,z,N){this.properties={},this.extent=A,this.type=0,this._pbf=b,this._geometry=-1,this._keys=z,this._values=N,b.readFields(h,this,T)}function h(b,T,A){b==1?T.id=A.readVarint():b==2?function(z,N){for(var j=z.readVarint()+z.pos;z.pos<j;){var Y=N._keys[z.readVarint()],te=N._values[z.readVarint()];N.properties[Y]=te}}(A,T):b==3?T.type=A.readVarint():b==4&&(T._geometry=A.pos)}function m(b){for(var T,A,z=0,N=0,j=b.length,Y=j-1;N<j;Y=N++)z+=((A=b[Y]).x-(T=b[N]).x)*(T.y+A.y);return z}return Tf=a,a.types=["Unknown","Point","LineString","Polygon"],a.prototype.loadGeometry=function(){var b=this._pbf;b.pos=this._geometry;for(var T,A=b.readVarint()+b.pos,z=1,N=0,j=0,Y=0,te=[];b.pos<A;){if(N<=0){var he=b.readVarint();z=7&he,N=he>>3}if(N--,z===1||z===2)j+=b.readSVarint(),Y+=b.readSVarint(),z===1&&(T&&te.push(T),T=[]),T.push(new d(j,Y));else{if(z!==7)throw new Error("unknown command "+z);T&&T.push(T[0].clone())}}return T&&te.push(T),te},a.prototype.bbox=function(){var b=this._pbf;b.pos=this._geometry;for(var T=b.readVarint()+b.pos,A=1,z=0,N=0,j=0,Y=1/0,te=-1/0,he=1/0,pe=-1/0;b.pos<T;){if(z<=0){var ge=b.readVarint();A=7&ge,z=ge>>3}if(z--,A===1||A===2)(N+=b.readSVarint())<Y&&(Y=N),N>te&&(te=N),(j+=b.readSVarint())<he&&(he=j),j>pe&&(pe=j);else if(A!==7)throw new Error("unknown command "+A)}return[Y,he,te,pe]},a.prototype.toGeoJSON=function(b,T,A){var z,N,j=this.extent*Math.pow(2,A),Y=this.extent*b,te=this.extent*T,he=this.loadGeometry(),pe=a.types[this.type];function ge(Ve){for(var ft=0;ft<Ve.length;ft++){var tt=Ve[ft];Ve[ft]=[360*(tt.x+Y)/j-180,360/Math.PI*Math.atan(Math.exp((180-360*(tt.y+te)/j)*Math.PI/180))-90]}}switch(this.type){case 1:var _e=[];for(z=0;z<he.length;z++)_e[z]=he[z][0];ge(he=_e);break;case 2:for(z=0;z<he.length;z++)ge(he[z]);break;case 3:for(he=function(Ve){var ft=Ve.length;if(ft<=1)return[Ve];for(var tt,de,ke=[],it=0;it<ft;it++){var Rt=m(Ve[it]);Rt!==0&&(de===void 0&&(de=Rt<0),de===Rt<0?(tt&&ke.push(tt),tt=[Ve[it]]):tt.push(Ve[it]))}return tt&&ke.push(tt),ke}(he),z=0;z<he.length;z++)for(N=0;N<he[z].length;N++)ge(he[z][N])}he.length===1?he=he[0]:pe="Multi"+pe;var De={type:"Feature",geometry:{type:pe,coordinates:he},properties:this.properties};return"id"in this&&(De.id=this.id),De},Tf}function Hy(){if(im)return rm;im=1;var d=$s();function a(m,b){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=m,this._keys=[],this._values=[],this._features=[],m.readFields(h,this,b),this.length=this._features.length}function h(m,b,T){m===15?b.version=T.readVarint():m===1?b.name=T.readString():m===5?b.extent=T.readVarint():m===2?b._features.push(T.pos):m===3?b._keys.push(T.readString()):m===4&&b._values.push(function(A){for(var z=null,N=A.readVarint()+A.pos;A.pos<N;){var j=A.readVarint()>>3;z=j===1?A.readString():j===2?A.readFloat():j===3?A.readDouble():j===4?A.readVarint64():j===5?A.readVarint():j===6?A.readSVarint():j===7?A.readBoolean():null}return z}(T))}return rm=a,a.prototype.feature=function(m){if(m<0||m>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[m];var b=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,b,this.extent,this._keys,this._values)},rm}function zg(){return ru||(ru=1,na.VectorTile=function(){if(Ss)return Af;Ss=1;var d=Hy();function a(h,m,b){if(h===3){var T=new d(b,b.readVarint()+b.pos);T.length&&(m[T.name]=T)}}return Af=function(h,m){this.layers=h.readFields(a,{},m)},Af}(),na.VectorTileFeature=$s(),na.VectorTileLayer=Hy()),na}var Sd=p(zg());const LS=Sd.VectorTileFeature.types,xc=Math.pow(2,13);function If(d,a,h,m,b,T,A,z){d.emplaceBack(a,h,2*Math.floor(m*xc)+A,b*xc*2,T*xc*2,Math.round(z))}class om{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Mn,this.centroidVertexArray=new Mt,this.indexArray=new ai,this.programConfigurations=new Ns(a.layers,a.zoom),this.segments=new Ar,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,m){this.features=[],this.hasPattern=Mf("fill-extrusion",this.layers,h);for(const{feature:b,id:T,index:A,sourceLayerIndex:z}of a){const N=this.layers[0]._featureFilter.needGeometry,j=eh(b,N);if(!this.layers[0]._featureFilter.filter(new si(this.zoom,{globalState:this.globalState}),j,m))continue;const Y={id:T,sourceLayerIndex:z,index:A,geometry:N?j.geometry:Qu(b),properties:b.properties,type:b.type,patterns:{}};this.hasPattern?this.features.push(Qp("fill-extrusion",this.layers,Y,this.zoom,h)):this.addFeature(Y,Y.geometry,A,m,{},h.subdivisionGranularity),h.featureIndex.insert(b,Y.geometry,A,z,this.index,!0)}}addFeatures(a,h,m){for(const b of this.features){const{geometry:T}=b;this.addFeature(b,T,b.index,h,m,a.subdivisionGranularity)}}update(a,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,sh),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,Dg.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,h,m,b,T,A){for(const z of ec(h,500)){const N={x:0,y:0,sampleCount:0},j=this.layoutVertexArray.length;this.processPolygon(N,b,a,z,A);const Y=this.layoutVertexArray.length-j,te=Math.floor(N.x/N.sampleCount),he=Math.floor(N.y/N.sampleCount);for(let pe=0;pe<Y;pe++)this.centroidVertexArray.emplaceBack(te,he)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,T,b)}processPolygon(a,h,m,b,T){if(b.length<1||ah(b[0]))return;for(const te of b)te.length!==0&&Md(a,te);const A={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},z=T.fill.getGranularityForZoomLevel(h.z),N=LS[m.type]==="Polygon";for(const te of b){if(te.length===0||ah(te))continue;const he=yc(te,z,N);this._generateSideFaces(he,A)}if(!N)return;const j=ih(b,h,z,!1),Y=this.layoutVertexArray;Ef((te,he)=>{If(Y,te,he,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,j.verticesFlattened,j.indicesTriangles)}_generateSideFaces(a,h){let m=0;for(let b=1;b<a.length;b++){const T=a[b],A=a[b-1];if(Gy(T,A))continue;h.segment.vertexLength+4>Ar.MAX_VERTEX_ARRAY_LENGTH&&(h.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const z=T.sub(A)._perp()._unit(),N=A.dist(T);m+N>32768&&(m=0),If(this.layoutVertexArray,T.x,T.y,z.x,z.y,0,0,m),If(this.layoutVertexArray,T.x,T.y,z.x,z.y,0,1,m),m+=N,If(this.layoutVertexArray,A.x,A.y,z.x,z.y,0,0,m),If(this.layoutVertexArray,A.x,A.y,z.x,z.y,0,1,m);const j=h.segment.vertexLength;this.indexArray.emplaceBack(j,j+2,j+1),this.indexArray.emplaceBack(j+1,j+2,j+3),h.segment.vertexLength+=4,h.segment.primitiveLength+=2}}}function Md(d,a){for(let h=0;h<a.length;h++){const m=a[h];h===a.length-1&&a[0].x===m.x&&a[0].y===m.y||(d.x+=m.x,d.y+=m.y,d.sampleCount++)}}function Gy(d,a){return d.x===a.x&&(d.x<0||d.x>Qe)||d.y===a.y&&(d.y<0||d.y>Qe)}function ah(d){return d.every(a=>a.x<0)||d.every(a=>a.x>Qe)||d.every(a=>a.y<0)||d.every(a=>a.y>Qe)}let Wy;zn("FillExtrusionBucket",om,{omit:["layers","features"]});var Nx={get paint(){return Wy=Wy||new vi({"fill-extrusion-opacity":new $n(qe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ar(qe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new $n(qe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new $n(qe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qu(qe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ar(qe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ar(qe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new $n(qe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class qy extends oo{constructor(a){super(a,Nx)}createBucket(a){return new om(a)}queryRadius(){return wf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:a,feature:h,featureState:m,geometry:b,transform:T,pixelsToTileUnits:A,pixelPosMatrix:z}){const N=Sf(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-T.bearingInRadians,A),j=this.paint.get("fill-extrusion-height").evaluate(h,m),Y=this.paint.get("fill-extrusion-base").evaluate(h,m),te=function(pe,ge){const _e=[];for(const De of pe){const Ve=[De.x,De.y,0,1];Ee(Ve,Ve,ge),_e.push(new I(Ve[0]/Ve[3],Ve[1]/Ve[3]))}return _e}(N,z),he=function(pe,ge,_e,De){const Ve=[],ft=[],tt=De[8]*ge,de=De[9]*ge,ke=De[10]*ge,it=De[11]*ge,Rt=De[8]*_e,an=De[9]*_e,Ft=De[10]*_e,jt=De[11]*_e;for(const yn of pe){const ln=[],bn=[];for(const Xt of yn){const Hn=Xt.x,hr=Xt.y,lr=De[0]*Hn+De[4]*hr+De[12],Jn=De[1]*Hn+De[5]*hr+De[13],Dr=De[2]*Hn+De[6]*hr+De[14],qi=De[3]*Hn+De[7]*hr+De[15],Ro=Dr+ke,Cs=qi+it,Tl=lr+Rt,wa=Jn+an,us=Dr+Ft,$i=qi+jt,Go=new I((lr+tt)/Cs,(Jn+de)/Cs);Go.z=Ro/Cs,ln.push(Go);const hs=new I(Tl/$i,wa/$i);hs.z=us/$i,bn.push(hs)}Ve.push(ln),ft.push(bn)}return[Ve,ft]}(b,Y,j,z);return function(pe,ge,_e){let De=1/0;Ly(_e,ge)&&(De=Bx(_e,ge[0]));for(let Ve=0;Ve<ge.length;Ve++){const ft=ge[Ve],tt=pe[Ve];for(let de=0;de<ft.length-1;de++){const ke=ft[de],it=[ke,ft[de+1],tt[de+1],tt[de],ke];Bs(_e,it)&&(De=Math.min(De,Bx(_e,it)))}}return De!==1/0&&De}(he[0],he[1],te)}}function lh(d,a){return d.x*a.x+d.y*a.y}function Bx(d,a){if(d.length===1){let h=0;const m=a[h++];let b;for(;!b||m.equals(b);)if(b=a[h++],!b)return 1/0;for(;h<a.length;h++){const T=a[h],A=d[0],z=b.sub(m),N=T.sub(m),j=A.sub(m),Y=lh(z,z),te=lh(z,N),he=lh(N,N),pe=lh(j,z),ge=lh(j,N),_e=Y*he-te*te,De=(he*pe-te*ge)/_e,Ve=(Y*ge-te*pe)/_e,ft=m.z*(1-De-Ve)+b.z*De+T.z*Ve;if(isFinite(ft))return ft}return 1/0}{let h=1/0;for(const m of a)h=Math.min(h,m.z);return h}}const kS=Ci([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ux}=kS,$x=Ci([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Cd}=$x,DS=Sd.VectorTileFeature.types,Rf=Math.cos(Math.PI/180*37.5),Xy=Math.pow(2,14)/.5;class Ui{constructor(a){this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new Sn,this.layoutVertexArray2=new rn,this.indexArray=new ai,this.programConfigurations=new Ns(a.layers,a.zoom),this.segments=new Ar,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,m){this.hasPattern=Mf("line",this.layers,h);const b=this.layers[0].layout.get("line-sort-key"),T=!b.isConstant(),A=[];for(const{feature:z,id:N,index:j,sourceLayerIndex:Y}of a){const te=this.layers[0]._featureFilter.needGeometry,he=eh(z,te);if(!this.layers[0]._featureFilter.filter(new si(this.zoom,{globalState:this.globalState}),he,m))continue;const pe=T?b.evaluate(he,{},m):void 0,ge={id:N,properties:z.properties,type:z.type,sourceLayerIndex:Y,index:j,geometry:te?he.geometry:Qu(z),patterns:{},sortKey:pe};A.push(ge)}T&&A.sort((z,N)=>z.sortKey-N.sortKey);for(const z of A){const{geometry:N,index:j,sourceLayerIndex:Y}=z;if(this.hasPattern){const te=Qp("line",this.layers,z,this.zoom,h);this.patternFeatures.push(te)}else this.addFeature(z,N,j,m,{},h.subdivisionGranularity);h.featureIndex.insert(a[j].feature,N,j,Y,this.index)}}update(a,h,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,m)}addFeatures(a,h,m){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,h,m,a.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,Cd)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ux),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,h,m,b,T,A){const z=this.layers[0].layout,N=z.get("line-join").evaluate(a,{}),j=z.get("line-cap"),Y=z.get("line-miter-limit"),te=z.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const he of h)this.addLine(he,a,N,j,Y,te,b,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,T,b)}addLine(a,h,m,b,T,A,z,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,a=yc(a,z?N.line.getGranularityForZoomLevel(z.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let tt=0;tt<a.length-1;tt++)this.totalDistance+=a[tt].dist(a[tt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const j=DS[h.type]==="Polygon";let Y=a.length;for(;Y>=2&&a[Y-1].equals(a[Y-2]);)Y--;let te=0;for(;te<Y-1&&a[te].equals(a[te+1]);)te++;if(Y<(j?3:2))return;m==="bevel"&&(T=1.05);const he=this.overscaling<=16?122880/(512*this.overscaling):0,pe=this.segments.prepareSegment(10*Y,this.layoutVertexArray,this.indexArray);let ge,_e,De,Ve,ft;this.e1=this.e2=-1,j&&(ge=a[Y-2],ft=a[te].sub(ge)._unit()._perp());for(let tt=te;tt<Y;tt++){if(De=tt===Y-1?j?a[te+1]:void 0:a[tt+1],De&&a[tt].equals(De))continue;ft&&(Ve=ft),ge&&(_e=ge),ge=a[tt],ft=De?De.sub(ge)._unit()._perp():Ve,Ve=Ve||ft;let de=Ve.add(ft);de.x===0&&de.y===0||de._unit();const ke=Ve.x*ft.x+Ve.y*ft.y,it=de.x*ft.x+de.y*ft.y,Rt=it!==0?1/it:1/0,an=2*Math.sqrt(2-2*it),Ft=it<Rf&&_e&&De,jt=Ve.x*ft.y-Ve.y*ft.x>0;if(Ft&&tt>te){const bn=ge.dist(_e);if(bn>2*he){const Xt=ge.sub(ge.sub(_e)._mult(he/bn)._round());this.updateDistance(_e,Xt),this.addCurrentVertex(Xt,Ve,0,0,pe),_e=Xt}}const yn=_e&&De;let ln=yn?m:j?"butt":b;if(yn&&ln==="round"&&(Rt<A?ln="miter":Rt<=2&&(ln="fakeround")),ln==="miter"&&Rt>T&&(ln="bevel"),ln==="bevel"&&(Rt>2&&(ln="flipbevel"),Rt<T&&(ln="miter")),_e&&this.updateDistance(_e,ge),ln==="miter")de._mult(Rt),this.addCurrentVertex(ge,de,0,0,pe);else if(ln==="flipbevel"){if(Rt>100)de=ft.mult(-1);else{const bn=Rt*Ve.add(ft).mag()/Ve.sub(ft).mag();de._perp()._mult(bn*(jt?-1:1))}this.addCurrentVertex(ge,de,0,0,pe),this.addCurrentVertex(ge,de.mult(-1),0,0,pe)}else if(ln==="bevel"||ln==="fakeround"){const bn=-Math.sqrt(Rt*Rt-1),Xt=jt?bn:0,Hn=jt?0:bn;if(_e&&this.addCurrentVertex(ge,Ve,Xt,Hn,pe),ln==="fakeround"){const hr=Math.round(180*an/Math.PI/20);for(let lr=1;lr<hr;lr++){let Jn=lr/hr;if(Jn!==.5){const qi=Jn-.5;Jn+=Jn*qi*(Jn-1)*((1.0904+ke*(ke*(3.55645-1.43519*ke)-3.2452))*qi*qi+(.848013+ke*(.215638*ke-1.06021)))}const Dr=ft.sub(Ve)._mult(Jn)._add(Ve)._unit()._mult(jt?-1:1);this.addHalfVertex(ge,Dr.x,Dr.y,!1,jt,0,pe)}}De&&this.addCurrentVertex(ge,ft,-Xt,-Hn,pe)}else if(ln==="butt")this.addCurrentVertex(ge,de,0,0,pe);else if(ln==="square"){const bn=_e?1:-1;this.addCurrentVertex(ge,de,bn,bn,pe)}else ln==="round"&&(_e&&(this.addCurrentVertex(ge,Ve,0,0,pe),this.addCurrentVertex(ge,Ve,1,1,pe,!0)),De&&(this.addCurrentVertex(ge,ft,-1,-1,pe,!0),this.addCurrentVertex(ge,ft,0,0,pe)));if(Ft&&tt<Y-1){const bn=ge.dist(De);if(bn>2*he){const Xt=ge.add(De.sub(ge)._mult(he/bn)._round());this.updateDistance(ge,Xt),this.addCurrentVertex(Xt,ft,0,0,pe),ge=Xt}}}}addCurrentVertex(a,h,m,b,T,A=!1){const z=h.y*b-h.x,N=-h.y-h.x*b;this.addHalfVertex(a,h.x+h.y*m,h.y-h.x*m,A,!1,m,T),this.addHalfVertex(a,z,N,A,!0,-b,T),this.distance>Xy/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,h,m,b,T,A))}addHalfVertex({x:a,y:h},m,b,T,A,z,N){const j=.5*(this.lineClips?this.scaledDistance*(Xy-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(T?1:0),(h<<1)+(A?1:0),Math.round(63*m)+128,Math.round(63*b)+128,1+(z===0?0:z<0?-1:1)|(63&j)<<2,j>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Y=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,Y,this.e2),N.primitiveLength++),A?this.e2=Y:this.e1=Y}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,h){this.distance+=a.dist(h),this.updateScaledDistance()}}let Vx,Zy;zn("LineBucket",Ui,{omit:["layers","patternFeatures"]});var jx={get paint(){return Zy=Zy||new vi({"line-opacity":new ar(qe.paint_line["line-opacity"]),"line-color":new ar(qe.paint_line["line-color"]),"line-translate":new $n(qe.paint_line["line-translate"]),"line-translate-anchor":new $n(qe.paint_line["line-translate-anchor"]),"line-width":new ar(qe.paint_line["line-width"]),"line-gap-width":new ar(qe.paint_line["line-gap-width"]),"line-offset":new ar(qe.paint_line["line-offset"]),"line-blur":new ar(qe.paint_line["line-blur"]),"line-dasharray":new ud(qe.paint_line["line-dasharray"]),"line-pattern":new qu(qe.paint_line["line-pattern"]),"line-gradient":new Ua(qe.paint_line["line-gradient"])})},get layout(){return Vx=Vx||new vi({"line-cap":new $n(qe.layout_line["line-cap"]),"line-join":new ar(qe.layout_line["line-join"]),"line-miter-limit":new $n(qe.layout_line["line-miter-limit"]),"line-round-limit":new $n(qe.layout_line["line-round-limit"]),"line-sort-key":new ar(qe.layout_line["line-sort-key"])})}};class zS extends ar{possiblyEvaluate(a,h){return h=new si(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(a,h)}evaluate(a,h,m,b){return h=cn({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(a,h,m,b)}}let sm;class Hx extends oo{constructor(a){super(a,jx),this.gradientVersion=0,sm||(sm=new zS(jx.paint.properties["line-width"].specification),sm.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const h=this.gradientExpression();this.stepInterpolant=!!function(m){return m._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof Pu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,h){super.recalculate(a,h),this.paint._values["line-floorwidth"]=sm.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Ui(a)}queryRadius(a){const h=a,m=Gx(bf("line-width",this,h),bf("line-gap-width",this,h)),b=bf("line-offset",this,h);return m/2+Math.abs(b)+wf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:a,feature:h,featureState:m,geometry:b,transform:T,pixelsToTileUnits:A}){const z=Sf(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-T.bearingInRadians,A),N=A/2*Gx(this.paint.get("line-width").evaluate(h,m),this.paint.get("line-gap-width").evaluate(h,m)),j=this.paint.get("line-offset").evaluate(h,m);return j&&(b=function(Y,te){const he=[];for(let pe=0;pe<Y.length;pe++){const ge=Y[pe],_e=[];for(let De=0;De<ge.length;De++){const Ve=ge[De-1],ft=ge[De],tt=ge[De+1],de=De===0?new I(0,0):ft.sub(Ve)._unit()._perp(),ke=De===ge.length-1?new I(0,0):tt.sub(ft)._unit()._perp(),it=de._add(ke)._unit(),Rt=it.x*ke.x+it.y*ke.y;Rt!==0&&it._mult(1/Rt),_e.push(it._mult(te)._add(ft))}he.push(_e)}return he}(b,j*A)),function(Y,te,he){for(let pe=0;pe<te.length;pe++){const ge=te[pe];if(Y.length>=3){for(let _e=0;_e<ge.length;_e++)if(th(Y,ge[_e]))return!0}if(Px(Y,ge,he))return!0}return!1}(z,b,N)}isTileClipped(){return!0}}function Gx(d,a){return a>0?a+2*d:d}const Ga=Ci([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Yy=Ci([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ci([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const OS=Ci([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ci([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const iu=Ci([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Og=Ci([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ed(d,a,h){return d.sections.forEach(m=>{m.text=function(b,T,A){const z=T.layout.get("text-transform").evaluate(A,{});return z==="uppercase"?b=b.toLocaleUpperCase():z==="lowercase"&&(b=b.toLocaleLowerCase()),fc.applyArabicShaping&&(b=fc.applyArabicShaping(b)),b}(m.text,a,h)}),d}Ci([{name:"triangle",components:3,type:"Uint16"}]),Ci([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ci([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ci([{type:"Float32",name:"offsetX"}]),Ci([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ci([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const ch={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Fg,am,Wx,to=24,Ky={};function qx(){return Fg||(Fg=1,Ky.read=function(d,a,h,m,b){var T,A,z=8*b-m-1,N=(1<<z)-1,j=N>>1,Y=-7,te=h?b-1:0,he=h?-1:1,pe=d[a+te];for(te+=he,T=pe&(1<<-Y)-1,pe>>=-Y,Y+=z;Y>0;T=256*T+d[a+te],te+=he,Y-=8);for(A=T&(1<<-Y)-1,T>>=-Y,Y+=m;Y>0;A=256*A+d[a+te],te+=he,Y-=8);if(T===0)T=1-j;else{if(T===N)return A?NaN:1/0*(pe?-1:1);A+=Math.pow(2,m),T-=j}return(pe?-1:1)*A*Math.pow(2,T-m)},Ky.write=function(d,a,h,m,b,T){var A,z,N,j=8*T-b-1,Y=(1<<j)-1,te=Y>>1,he=b===23?Math.pow(2,-24)-Math.pow(2,-77):0,pe=m?0:T-1,ge=m?1:-1,_e=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(z=isNaN(a)?1:0,A=Y):(A=Math.floor(Math.log(a)/Math.LN2),a*(N=Math.pow(2,-A))<1&&(A--,N*=2),(a+=A+te>=1?he/N:he*Math.pow(2,1-te))*N>=2&&(A++,N/=2),A+te>=Y?(z=0,A=Y):A+te>=1?(z=(a*N-1)*Math.pow(2,b),A+=te):(z=a*Math.pow(2,te-1)*Math.pow(2,b),A=0));b>=8;d[h+pe]=255&z,pe+=ge,z/=256,b-=8);for(A=A<<b|z,j+=b;j>0;d[h+pe]=255&A,pe+=ge,A/=256,j-=8);d[h+pe-ge]|=128*_e}),Ky}function Jy(){if(Wx)return am;Wx=1,am=a;var d=qx();function a(de){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(de)?de:new Uint8Array(de||0),this.pos=0,this.type=0,this.length=this.buf.length}a.Varint=0,a.Fixed64=1,a.Bytes=2,a.Fixed32=5;var h=4294967296,m=1/h,b=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function T(de){return de.type===a.Bytes?de.readVarint()+de.pos:de.pos+1}function A(de,ke,it){return it?4294967296*ke+(de>>>0):4294967296*(ke>>>0)+(de>>>0)}function z(de,ke,it){var Rt=ke<=16383?1:ke<=2097151?2:ke<=268435455?3:Math.floor(Math.log(ke)/(7*Math.LN2));it.realloc(Rt);for(var an=it.pos-1;an>=de;an--)it.buf[an+Rt]=it.buf[an]}function N(de,ke){for(var it=0;it<de.length;it++)ke.writeVarint(de[it])}function j(de,ke){for(var it=0;it<de.length;it++)ke.writeSVarint(de[it])}function Y(de,ke){for(var it=0;it<de.length;it++)ke.writeFloat(de[it])}function te(de,ke){for(var it=0;it<de.length;it++)ke.writeDouble(de[it])}function he(de,ke){for(var it=0;it<de.length;it++)ke.writeBoolean(de[it])}function pe(de,ke){for(var it=0;it<de.length;it++)ke.writeFixed32(de[it])}function ge(de,ke){for(var it=0;it<de.length;it++)ke.writeSFixed32(de[it])}function _e(de,ke){for(var it=0;it<de.length;it++)ke.writeFixed64(de[it])}function De(de,ke){for(var it=0;it<de.length;it++)ke.writeSFixed64(de[it])}function Ve(de,ke){return(de[ke]|de[ke+1]<<8|de[ke+2]<<16)+16777216*de[ke+3]}function ft(de,ke,it){de[it]=ke,de[it+1]=ke>>>8,de[it+2]=ke>>>16,de[it+3]=ke>>>24}function tt(de,ke){return(de[ke]|de[ke+1]<<8|de[ke+2]<<16)+(de[ke+3]<<24)}return a.prototype={destroy:function(){this.buf=null},readFields:function(de,ke,it){for(it=it||this.length;this.pos<it;){var Rt=this.readVarint(),an=Rt>>3,Ft=this.pos;this.type=7&Rt,de(an,ke,this),this.pos===Ft&&this.skip(Rt)}return ke},readMessage:function(de,ke){return this.readFields(de,ke,this.readVarint()+this.pos)},readFixed32:function(){var de=Ve(this.buf,this.pos);return this.pos+=4,de},readSFixed32:function(){var de=tt(this.buf,this.pos);return this.pos+=4,de},readFixed64:function(){var de=Ve(this.buf,this.pos)+Ve(this.buf,this.pos+4)*h;return this.pos+=8,de},readSFixed64:function(){var de=Ve(this.buf,this.pos)+tt(this.buf,this.pos+4)*h;return this.pos+=8,de},readFloat:function(){var de=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,de},readDouble:function(){var de=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,de},readVarint:function(de){var ke,it,Rt=this.buf;return ke=127&(it=Rt[this.pos++]),it<128?ke:(ke|=(127&(it=Rt[this.pos++]))<<7,it<128?ke:(ke|=(127&(it=Rt[this.pos++]))<<14,it<128?ke:(ke|=(127&(it=Rt[this.pos++]))<<21,it<128?ke:function(an,Ft,jt){var yn,ln,bn=jt.buf;if(yn=(112&(ln=bn[jt.pos++]))>>4,ln<128||(yn|=(127&(ln=bn[jt.pos++]))<<3,ln<128)||(yn|=(127&(ln=bn[jt.pos++]))<<10,ln<128)||(yn|=(127&(ln=bn[jt.pos++]))<<17,ln<128)||(yn|=(127&(ln=bn[jt.pos++]))<<24,ln<128)||(yn|=(1&(ln=bn[jt.pos++]))<<31,ln<128))return A(an,yn,Ft);throw new Error("Expected varint not more than 10 bytes")}(ke|=(15&(it=Rt[this.pos]))<<28,de,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var de=this.readVarint();return de%2==1?(de+1)/-2:de/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var de=this.readVarint()+this.pos,ke=this.pos;return this.pos=de,de-ke>=12&&b?function(it,Rt,an){return b.decode(it.subarray(Rt,an))}(this.buf,ke,de):function(it,Rt,an){for(var Ft="",jt=Rt;jt<an;){var yn,ln,bn,Xt=it[jt],Hn=null,hr=Xt>239?4:Xt>223?3:Xt>191?2:1;if(jt+hr>an)break;hr===1?Xt<128&&(Hn=Xt):hr===2?(192&(yn=it[jt+1]))==128&&(Hn=(31&Xt)<<6|63&yn)<=127&&(Hn=null):hr===3?(ln=it[jt+2],(192&(yn=it[jt+1]))==128&&(192&ln)==128&&((Hn=(15&Xt)<<12|(63&yn)<<6|63&ln)<=2047||Hn>=55296&&Hn<=57343)&&(Hn=null)):hr===4&&(ln=it[jt+2],bn=it[jt+3],(192&(yn=it[jt+1]))==128&&(192&ln)==128&&(192&bn)==128&&((Hn=(15&Xt)<<18|(63&yn)<<12|(63&ln)<<6|63&bn)<=65535||Hn>=1114112)&&(Hn=null)),Hn===null?(Hn=65533,hr=1):Hn>65535&&(Hn-=65536,Ft+=String.fromCharCode(Hn>>>10&1023|55296),Hn=56320|1023&Hn),Ft+=String.fromCharCode(Hn),jt+=hr}return Ft}(this.buf,ke,de)},readBytes:function(){var de=this.readVarint()+this.pos,ke=this.buf.subarray(this.pos,de);return this.pos=de,ke},readPackedVarint:function(de,ke){if(this.type!==a.Bytes)return de.push(this.readVarint(ke));var it=T(this);for(de=de||[];this.pos<it;)de.push(this.readVarint(ke));return de},readPackedSVarint:function(de){if(this.type!==a.Bytes)return de.push(this.readSVarint());var ke=T(this);for(de=de||[];this.pos<ke;)de.push(this.readSVarint());return de},readPackedBoolean:function(de){if(this.type!==a.Bytes)return de.push(this.readBoolean());var ke=T(this);for(de=de||[];this.pos<ke;)de.push(this.readBoolean());return de},readPackedFloat:function(de){if(this.type!==a.Bytes)return de.push(this.readFloat());var ke=T(this);for(de=de||[];this.pos<ke;)de.push(this.readFloat());return de},readPackedDouble:function(de){if(this.type!==a.Bytes)return de.push(this.readDouble());var ke=T(this);for(de=de||[];this.pos<ke;)de.push(this.readDouble());return de},readPackedFixed32:function(de){if(this.type!==a.Bytes)return de.push(this.readFixed32());var ke=T(this);for(de=de||[];this.pos<ke;)de.push(this.readFixed32());return de},readPackedSFixed32:function(de){if(this.type!==a.Bytes)return de.push(this.readSFixed32());var ke=T(this);for(de=de||[];this.pos<ke;)de.push(this.readSFixed32());return de},readPackedFixed64:function(de){if(this.type!==a.Bytes)return de.push(this.readFixed64());var ke=T(this);for(de=de||[];this.pos<ke;)de.push(this.readFixed64());return de},readPackedSFixed64:function(de){if(this.type!==a.Bytes)return de.push(this.readSFixed64());var ke=T(this);for(de=de||[];this.pos<ke;)de.push(this.readSFixed64());return de},skip:function(de){var ke=7&de;if(ke===a.Varint)for(;this.buf[this.pos++]>127;);else if(ke===a.Bytes)this.pos=this.readVarint()+this.pos;else if(ke===a.Fixed32)this.pos+=4;else{if(ke!==a.Fixed64)throw new Error("Unimplemented type: "+ke);this.pos+=8}},writeTag:function(de,ke){this.writeVarint(de<<3|ke)},realloc:function(de){for(var ke=this.length||16;ke<this.pos+de;)ke*=2;if(ke!==this.length){var it=new Uint8Array(ke);it.set(this.buf),this.buf=it,this.length=ke}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(de){this.realloc(4),ft(this.buf,de,this.pos),this.pos+=4},writeSFixed32:function(de){this.realloc(4),ft(this.buf,de,this.pos),this.pos+=4},writeFixed64:function(de){this.realloc(8),ft(this.buf,-1&de,this.pos),ft(this.buf,Math.floor(de*m),this.pos+4),this.pos+=8},writeSFixed64:function(de){this.realloc(8),ft(this.buf,-1&de,this.pos),ft(this.buf,Math.floor(de*m),this.pos+4),this.pos+=8},writeVarint:function(de){(de=+de||0)>268435455||de<0?function(ke,it){var Rt,an;if(ke>=0?(Rt=ke%4294967296|0,an=ke/4294967296|0):(an=~(-ke/4294967296),4294967295^(Rt=~(-ke%4294967296))?Rt=Rt+1|0:(Rt=0,an=an+1|0)),ke>=18446744073709552e3||ke<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");it.realloc(10),function(Ft,jt,yn){yn.buf[yn.pos++]=127&Ft|128,Ft>>>=7,yn.buf[yn.pos++]=127&Ft|128,Ft>>>=7,yn.buf[yn.pos++]=127&Ft|128,Ft>>>=7,yn.buf[yn.pos++]=127&Ft|128,yn.buf[yn.pos]=127&(Ft>>>=7)}(Rt,0,it),function(Ft,jt){var yn=(7&Ft)<<4;jt.buf[jt.pos++]|=yn|((Ft>>>=3)?128:0),Ft&&(jt.buf[jt.pos++]=127&Ft|((Ft>>>=7)?128:0),Ft&&(jt.buf[jt.pos++]=127&Ft|((Ft>>>=7)?128:0),Ft&&(jt.buf[jt.pos++]=127&Ft|((Ft>>>=7)?128:0),Ft&&(jt.buf[jt.pos++]=127&Ft|((Ft>>>=7)?128:0),Ft&&(jt.buf[jt.pos++]=127&Ft)))))}(an,it)}(de,this):(this.realloc(4),this.buf[this.pos++]=127&de|(de>127?128:0),de<=127||(this.buf[this.pos++]=127&(de>>>=7)|(de>127?128:0),de<=127||(this.buf[this.pos++]=127&(de>>>=7)|(de>127?128:0),de<=127||(this.buf[this.pos++]=de>>>7&127))))},writeSVarint:function(de){this.writeVarint(de<0?2*-de-1:2*de)},writeBoolean:function(de){this.writeVarint(!!de)},writeString:function(de){de=String(de),this.realloc(4*de.length),this.pos++;var ke=this.pos;this.pos=function(Rt,an,Ft){for(var jt,yn,ln=0;ln<an.length;ln++){if((jt=an.charCodeAt(ln))>55295&&jt<57344){if(!yn){jt>56319||ln+1===an.length?(Rt[Ft++]=239,Rt[Ft++]=191,Rt[Ft++]=189):yn=jt;continue}if(jt<56320){Rt[Ft++]=239,Rt[Ft++]=191,Rt[Ft++]=189,yn=jt;continue}jt=yn-55296<<10|jt-56320|65536,yn=null}else yn&&(Rt[Ft++]=239,Rt[Ft++]=191,Rt[Ft++]=189,yn=null);jt<128?Rt[Ft++]=jt:(jt<2048?Rt[Ft++]=jt>>6|192:(jt<65536?Rt[Ft++]=jt>>12|224:(Rt[Ft++]=jt>>18|240,Rt[Ft++]=jt>>12&63|128),Rt[Ft++]=jt>>6&63|128),Rt[Ft++]=63&jt|128)}return Ft}(this.buf,de,this.pos);var it=this.pos-ke;it>=128&&z(ke,it,this),this.pos=ke-1,this.writeVarint(it),this.pos+=it},writeFloat:function(de){this.realloc(4),d.write(this.buf,de,this.pos,!0,23,4),this.pos+=4},writeDouble:function(de){this.realloc(8),d.write(this.buf,de,this.pos,!0,52,8),this.pos+=8},writeBytes:function(de){var ke=de.length;this.writeVarint(ke),this.realloc(ke);for(var it=0;it<ke;it++)this.buf[this.pos++]=de[it]},writeRawMessage:function(de,ke){this.pos++;var it=this.pos;de(ke,this);var Rt=this.pos-it;Rt>=128&&z(it,Rt,this),this.pos=it-1,this.writeVarint(Rt),this.pos+=Rt},writeMessage:function(de,ke,it){this.writeTag(de,a.Bytes),this.writeRawMessage(ke,it)},writePackedVarint:function(de,ke){ke.length&&this.writeMessage(de,N,ke)},writePackedSVarint:function(de,ke){ke.length&&this.writeMessage(de,j,ke)},writePackedBoolean:function(de,ke){ke.length&&this.writeMessage(de,he,ke)},writePackedFloat:function(de,ke){ke.length&&this.writeMessage(de,Y,ke)},writePackedDouble:function(de,ke){ke.length&&this.writeMessage(de,te,ke)},writePackedFixed32:function(de,ke){ke.length&&this.writeMessage(de,pe,ke)},writePackedSFixed32:function(de,ke){ke.length&&this.writeMessage(de,ge,ke)},writePackedFixed64:function(de,ke){ke.length&&this.writeMessage(de,_e,ke)},writePackedSFixed64:function(de,ke){ke.length&&this.writeMessage(de,De,ke)},writeBytesField:function(de,ke){this.writeTag(de,a.Bytes),this.writeBytes(ke)},writeFixed32Field:function(de,ke){this.writeTag(de,a.Fixed32),this.writeFixed32(ke)},writeSFixed32Field:function(de,ke){this.writeTag(de,a.Fixed32),this.writeSFixed32(ke)},writeFixed64Field:function(de,ke){this.writeTag(de,a.Fixed64),this.writeFixed64(ke)},writeSFixed64Field:function(de,ke){this.writeTag(de,a.Fixed64),this.writeSFixed64(ke)},writeVarintField:function(de,ke){this.writeTag(de,a.Varint),this.writeVarint(ke)},writeSVarintField:function(de,ke){this.writeTag(de,a.Varint),this.writeSVarint(ke)},writeStringField:function(de,ke){this.writeTag(de,a.Bytes),this.writeString(ke)},writeFloatField:function(de,ke){this.writeTag(de,a.Fixed32),this.writeFloat(ke)},writeDoubleField:function(de,ke){this.writeTag(de,a.Fixed64),this.writeDouble(ke)},writeBooleanField:function(de,ke){this.writeVarintField(de,!!ke)}},am}var Cl,Lf=p(Jy());function Xx(d,a,h){d===1&&h.readMessage(Qy,a)}function Qy(d,a,h){if(d===3){const{id:m,bitmap:b,width:T,height:A,left:z,top:N,advance:j}=h.readMessage(FS,{});a.push({id:m,bitmap:new gd({width:T+6,height:A+6},b),metrics:{width:T,height:A,left:z,top:N,advance:j}})}}function FS(d,a,h){d===1?a.id=h.readVarint():d===2?a.bitmap=h.readBytes():d===3?a.width=h.readVarint():d===4?a.height=h.readVarint():d===5?a.left=h.readSVarint():d===6?a.top=h.readSVarint():d===7&&(a.advance=h.readVarint())}function e0(d){let a=0,h=0;for(const A of d)a+=A.w*A.h,h=Math.max(h,A.w);d.sort((A,z)=>z.h-A.h);const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),h),h:1/0}];let b=0,T=0;for(const A of d)for(let z=m.length-1;z>=0;z--){const N=m[z];if(!(A.w>N.w||A.h>N.h)){if(A.x=N.x,A.y=N.y,T=Math.max(T,A.y+A.h),b=Math.max(b,A.x+A.w),A.w===N.w&&A.h===N.h){const j=m.pop();z<m.length&&(m[z]=j)}else A.h===N.h?(N.x+=A.w,N.w-=A.w):A.w===N.w?(N.y+=A.h,N.h-=A.h):(m.push({x:N.x+A.w,y:N.y,w:N.w-A.w,h:A.h}),N.y+=A.h,N.h-=A.h);break}}return{w:b,h:T,fill:a/(b*T)||0}}class lm{constructor(a,{pixelRatio:h,version:m,stretchX:b,stretchY:T,content:A,textFitWidth:z,textFitHeight:N}){this.paddedRect=a,this.pixelRatio=h,this.stretchX=b,this.stretchY=T,this.content=A,this.version=m,this.textFitWidth=z,this.textFitHeight=N}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class cm{constructor(a,h){const m={},b={};this.haveRenderCallbacks=[];const T=[];this.addImages(a,m,T),this.addImages(h,b,T);const{w:A,h:z}=e0(T),N=new xs({width:A||1,height:z||1});for(const j in a){const Y=a[j],te=m[j].paddedRect;xs.copy(Y.data,N,{x:0,y:0},{x:te.x+1,y:te.y+1},Y.data)}for(const j in h){const Y=h[j],te=b[j].paddedRect,he=te.x+1,pe=te.y+1,ge=Y.data.width,_e=Y.data.height;xs.copy(Y.data,N,{x:0,y:0},{x:he,y:pe},Y.data),xs.copy(Y.data,N,{x:0,y:_e-1},{x:he,y:pe-1},{width:ge,height:1}),xs.copy(Y.data,N,{x:0,y:0},{x:he,y:pe+_e},{width:ge,height:1}),xs.copy(Y.data,N,{x:ge-1,y:0},{x:he-1,y:pe},{width:1,height:_e}),xs.copy(Y.data,N,{x:0,y:0},{x:he+ge,y:pe},{width:1,height:_e})}this.image=N,this.iconPositions=m,this.patternPositions=b}addImages(a,h,m){for(const b in a){const T=a[b],A={x:0,y:0,w:T.data.width+2,h:T.data.height+2};m.push(A),h[b]=new lm(A,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(b)}}patchUpdatedImages(a,h){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in a.updatedImages)this.patchUpdatedImage(this.iconPositions[m],a.getImage(m),h),this.patchUpdatedImage(this.patternPositions[m],a.getImage(m),h)}patchUpdatedImage(a,h,m){if(!a||!h||a.version===h.version)return;a.version=h.version;const[b,T]=a.tl;m.update(h.data,void 0,{x:b,y:T})}}zn("ImagePosition",lm),zn("ImageAtlas",cm),c.an=void 0,(Cl=c.an||(c.an={}))[Cl.none=0]="none",Cl[Cl.horizontal=1]="horizontal",Cl[Cl.vertical=2]="vertical",Cl[Cl.horizontalOnly=3]="horizontalOnly";class Td{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(a,h,m){const b=new Td;return b.scale=a||1,b.fontStack=h,b.verticalAlign=m||"bottom",b}static forImage(a,h){const m=new Td;return m.imageName=a,m.verticalAlign=h||"bottom",m}}class ou{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,h){const m=new ou;for(let b=0;b<a.sections.length;b++){const T=a.sections[b];T.image?m.addImageSection(T):m.addTextSection(T,h)}return m}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let h="";for(let m=0;m<a.length;m++){const b=a.charCodeAt(m+1)||null,T=a.charCodeAt(m-1)||null;h+=b&&yf(b)&&!ch[a[m+1]]||T&&yf(T)&&!ch[a[m-1]]||!ch[a[m]]?a[m]:ch[a[m]]}return h}(this.text)}trim(){let a=0;for(let m=0;m<this.text.length&&Ng[this.text.charCodeAt(m)];m++)a++;let h=this.text.length;for(let m=this.text.length-1;m>=0&&m>=a&&Ng[this.text.charCodeAt(m)];m--)h--;this.text=this.text.substring(a,h),this.sectionIndex=this.sectionIndex.slice(a,h)}substring(a,h){const m=new ou;return m.text=this.text.substring(a,h),m.sectionIndex=this.sectionIndex.slice(a,h),m.sections=this.sections,m}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,h)=>Math.max(a,this.sections[h].scale),0)}getMaxImageSize(a){let h=0,m=0;for(let b=0;b<this.length();b++){const T=this.getSection(b);if(T.imageName){const A=a[T.imageName];if(!A)continue;const z=A.displaySize;h=Math.max(h,z[0]),m=Math.max(m,z[1])}}return{maxImageWidth:h,maxImageHeight:m}}addTextSection(a,h){this.text+=a.text,this.sections.push(Td.forText(a.scale,a.fontStack||h,a.verticalAlign));const m=this.sections.length-1;for(let b=0;b<a.text.length;++b)this.sectionIndex.push(m)}addImageSection(a){const h=a.image?a.image.name:"";if(h.length===0)return void fn("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(Td.forImage(h,a.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):fn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function um(d,a,h,m,b,T,A,z,N,j,Y,te,he,pe,ge){const _e=ou.fromFeature(d,b);let De;te===c.an.vertical&&_e.verticalizePunctuation();const{processBidirectionalText:Ve,processStyledBidirectionalText:ft}=fc;if(Ve&&_e.sections.length===1){De=[];const ke=Ve(_e.toString(),P(_e,j,T,a,m,pe));for(const it of ke){const Rt=new ou;Rt.text=it,Rt.sections=_e.sections;for(let an=0;an<it.length;an++)Rt.sectionIndex.push(0);De.push(Rt)}}else if(ft){De=[];const ke=ft(_e.text,_e.sectionIndex,P(_e,j,T,a,m,pe));for(const it of ke){const Rt=new ou;Rt.text=it[0],Rt.sectionIndex=it[1],Rt.sections=_e.sections,De.push(Rt)}}else De=function(ke,it){const Rt=[],an=ke.text;let Ft=0;for(const jt of it)Rt.push(ke.substring(Ft,jt)),Ft=jt;return Ft<an.length&&Rt.push(ke.substring(Ft,an.length)),Rt}(_e,P(_e,j,T,a,m,pe));const tt=[],de={positionedLines:tt,text:_e.toString(),top:Y[1],bottom:Y[1],left:Y[0],right:Y[0],writingMode:te,iconsInText:!1,verticalizable:!1};return function(ke,it,Rt,an,Ft,jt,yn,ln,bn,Xt,Hn,hr){let lr=0,Jn=0,Dr=0,qi=0;const Ro=ln==="right"?1:ln==="left"?0:.5,Cs=to/hr;let Tl=0;for(const $i of Ft){$i.trim();const Go=$i.getMaxScale(),hs={positionedGlyphs:[],lineOffset:0};ke.positionedLines[Tl]=hs;const ds=hs.positionedGlyphs;let ra=0;if(!$i.length()){Jn+=jt,++Tl;continue}const Pl=W(an,$i,Cs);for(let Sa=0;Sa<$i.length();Sa++){const Lo=$i.getSection(Sa),qo=$i.getSectionIndex(Sa),Xo=$i.getCharCode(Sa),xo=be(bn,Hn,Xo);let Ii;if(Lo.imageName){if(ke.iconsInText=!0,Lo.scale=Lo.scale*Cs,Ii=gt(Lo,xo,Go,Pl,an),!Ii)continue;ra=Math.max(ra,Ii.imageOffset)}else if(Ii=st(Lo,Xo,xo,Pl,it,Rt),!Ii)continue;const{rect:su,metrics:jg,baselineOffset:au}=Ii;ds.push({glyph:Xo,imageName:Lo.imageName,x:lr,y:Jn+au+-17,vertical:xo,scale:Lo.scale,fontStack:Lo.fontStack,sectionIndex:qo,metrics:jg,rect:su}),xo?(ke.verticalizable=!0,lr+=(Lo.imageName?jg.advance:to)*Lo.scale+Xt):lr+=jg.advance*Lo.scale+Xt}ds.length!==0&&(Dr=Math.max(lr-Xt,Dr),Bt(ds,0,ds.length-1,Ro)),lr=0,hs.lineOffset=Math.max(ra,(Go-1)*to);const Wo=jt*Go+ra;Jn+=Wo,qi=Math.max(Wo,qi),++Tl}const{horizontalAlign:wa,verticalAlign:us}=O(yn);(function($i,Go,hs,ds,ra,Pl,Wo,Sa,Lo){const qo=(Go-hs)*ra;let Xo=0;Xo=Pl!==Wo?-Sa*ds- -17:-ds*Lo*Wo+.5*Wo;for(const xo of $i)for(const Ii of xo.positionedGlyphs)Ii.x+=qo,Ii.y+=Xo})(ke.positionedLines,Ro,wa,us,Dr,qi,jt,Jn,Ft.length),ke.top+=-us*Jn,ke.bottom=ke.top+Jn,ke.left+=-wa*Dr,ke.right=ke.left+Dr}(de,a,h,m,De,A,z,N,te,j,he,ge),!function(ke){for(const it of ke)if(it.positionedGlyphs.length!==0)return!1;return!0}(tt)&&de}const Ng={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Bg={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},NS={40:!0};function kf(d,a,h,m,b,T){if(a.imageName){const A=m[a.imageName];return A?A.displaySize[0]*a.scale*to/T+b:0}{const A=h[a.fontStack],z=A&&A[d];return z?z.metrics.advance*a.scale+b:0}}function Zx(d,a,h,m){const b=Math.pow(d-a,2);return m?d<a?b/2:2*b:b+Math.abs(h)*h}function Ug(d,a,h){let m=0;return d===10&&(m-=1e4),h&&(m+=150),d!==40&&d!==65288||(m+=50),a!==41&&a!==65289||(m+=50),m}function f(d,a,h,m,b,T){let A=null,z=Zx(a,h,b,T);for(const N of m){const j=Zx(a-N.x,h,b,T)+N.badness;j<=z&&(A=N,z=j)}return{index:d,x:a,priorBreak:A,badness:z}}function v(d){return d?v(d.priorBreak).concat(d.index):[]}function P(d,a,h,m,b,T){if(!d)return[];const A=[],z=function(te,he,pe,ge,_e,De){let Ve=0;for(let ft=0;ft<te.length();ft++){const tt=te.getSection(ft);Ve+=kf(te.getCharCode(ft),tt,ge,_e,he,De)}return Ve/Math.max(1,Math.ceil(Ve/pe))}(d,a,h,m,b,T),N=d.text.indexOf("​")>=0;let j=0;for(let te=0;te<d.length();te++){const he=d.getSection(te),pe=d.getCharCode(te);if(Ng[pe]||(j+=kf(pe,he,m,b,a,T)),te<d.length()-1){const ge=!((Y=pe)<11904)&&(!!dr["CJK Compatibility Forms"](Y)||!!dr["CJK Compatibility"](Y)||!!dr["CJK Strokes"](Y)||!!dr["CJK Symbols and Punctuation"](Y)||!!dr["Enclosed CJK Letters and Months"](Y)||!!dr["Halfwidth and Fullwidth Forms"](Y)||!!dr["Ideographic Description Characters"](Y)||!!dr["Vertical Forms"](Y)||sd.test(String.fromCodePoint(Y)));(Bg[pe]||ge||he.imageName||te!==d.length()-2&&NS[d.getCharCode(te+1)])&&A.push(f(te+1,j,z,A,Ug(pe,d.getCharCode(te+1),ge&&N),!1))}}var Y;return v(f(d.length(),j,z,A,0,!0))}function O(d){let a=.5,h=.5;switch(d){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:a,verticalAlign:h}}function W(d,a,h){const m=a.getMaxScale()*to,{maxImageWidth:b,maxImageHeight:T}=a.getMaxImageSize(d),A=Math.max(m,T*h);return{verticalLineContentWidth:Math.max(m,b*h),horizontalLineContentHeight:A}}function Q(d){switch(d){case"top":return 0;case"center":return .5;default:return 1}}function be(d,a,h){return!(d===c.an.horizontal||!a&&!Hu(h)||a&&(Ng[h]||(m=h,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(m)))));var m}function st(d,a,h,m,b,T){const A=T[d.fontStack],z=function(j,Y,te,he){if(j&&j.rect)return j;const pe=Y[te.fontStack],ge=pe&&pe[he];return ge?{rect:null,metrics:ge.metrics}:null}(A&&A[a],b,d,a);if(z===null)return null;let N;if(h)N=m.verticalLineContentWidth-d.scale*to;else{const j=Q(d.verticalAlign);N=(m.horizontalLineContentHeight-d.scale*to)*j}return{rect:z.rect,metrics:z.metrics,baselineOffset:N}}function gt(d,a,h,m,b){const T=b[d.imageName];if(!T)return null;const A=T.paddedRect,z=T.displaySize,N={width:z[0],height:z[1],left:1,top:-3,advance:a?z[1]:z[0]};let j;if(a)j=m.verticalLineContentWidth-z[1]*d.scale;else{const Y=Q(d.verticalAlign);j=(m.horizontalLineContentHeight-z[1]*d.scale)*Y}return{rect:A,metrics:N,baselineOffset:j,imageOffset:(a?z[0]:z[1])*d.scale-to*h}}function Bt(d,a,h,m){if(m===0)return;const b=d[h],T=(d[h].x+b.metrics.advance*b.scale)*m;for(let A=a;A<=h;A++)d[A].x-=T}function wn(d,a,h){const{horizontalAlign:m,verticalAlign:b}=O(h),T=a[0]-d.displaySize[0]*m,A=a[1]-d.displaySize[1]*b;return{image:d,top:A,bottom:A+d.displaySize[1],left:T,right:T+d.displaySize[0]}}function Cn(d){var a,h;let m=d.left,b=d.top,T=d.right-m,A=d.bottom-b;const z=(a=d.image.textFitWidth)!==null&&a!==void 0?a:"stretchOrShrink",N=(h=d.image.textFitHeight)!==null&&h!==void 0?h:"stretchOrShrink",j=(d.image.content[2]-d.image.content[0])/(d.image.content[3]-d.image.content[1]);if(N==="proportional"){if(z==="stretchOnly"&&T/A<j||z==="proportional"){const Y=Math.ceil(A*j);m*=Y/T,T=Y}}else if(z==="proportional"&&N==="stretchOnly"&&j!==0&&T/A>j){const Y=Math.ceil(T/j);b*=Y/A,A=Y}return{x1:m,y1:b,x2:m+T,y2:b+A}}function xn(d,a,h,m,b,T){const A=d.image;let z;if(A.content){const De=A.content,Ve=A.pixelRatio||1;z=[De[0]/Ve,De[1]/Ve,A.displaySize[0]-De[2]/Ve,A.displaySize[1]-De[3]/Ve]}const N=a.left*T,j=a.right*T;let Y,te,he,pe;h==="width"||h==="both"?(pe=b[0]+N-m[3],te=b[0]+j+m[1]):(pe=b[0]+(N+j-A.displaySize[0])/2,te=pe+A.displaySize[0]);const ge=a.top*T,_e=a.bottom*T;return h==="height"||h==="both"?(Y=b[1]+ge-m[0],he=b[1]+_e+m[2]):(Y=b[1]+(ge+_e-A.displaySize[1])/2,he=Y+A.displaySize[1]),{image:A,top:Y,right:te,bottom:he,left:pe,collisionPadding:z}}const Un=128,Yn=32640;function ir(d,a){const{expression:h}=a;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new si(d+1))};if(h.kind==="source")return{kind:"source"};{const{zoomStops:m,interpolationType:b}=h;let T=0;for(;T<m.length&&m[T]<=d;)T++;T=Math.max(0,T-1);let A=T;for(;A<m.length&&m[A]<d+1;)A++;A=Math.min(m.length-1,A);const z=m[T],N=m[A];return h.kind==="composite"?{kind:"composite",minZoom:z,maxZoom:N,interpolationType:b}:{kind:"camera",minZoom:z,maxZoom:N,minSize:h.evaluate(new si(z)),maxSize:h.evaluate(new si(N)),interpolationType:b}}}function Wi(d,a,h){let m="never";const b=d.get(a);return b?m=b:d.get(h)&&(m="always"),m}const Lt=Sd.VectorTileFeature.types,xt=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function zt(d,a,h,m,b,T,A,z,N,j,Y,te,he){const pe=z?Math.min(Yn,Math.round(z[0])):0,ge=z?Math.min(Yn,Math.round(z[1])):0;d.emplaceBack(a,h,Math.round(32*m),Math.round(32*b),T,A,(pe<<1)+(N?1:0),ge,16*j,16*Y,256*te,256*he)}function Ln(d,a,h){d.emplaceBack(a.x,a.y,h),d.emplaceBack(a.x,a.y,h),d.emplaceBack(a.x,a.y,h),d.emplaceBack(a.x,a.y,h)}function cr(d){for(const a of d.sections)if(ld(a.text))return!0;return!1}class fr{constructor(a){this.layoutVertexArray=new br,this.indexArray=new ai,this.programConfigurations=a,this.segments=new Ar,this.dynamicLayoutVertexArray=new Hr,this.opacityVertexArray=new Ei,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ne}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,h,m,b){this.isEmpty()||(m&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ga.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Yy.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,xt,!0),this.opacityVertexBuffer.itemSize=1),(m||b)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}zn("SymbolBuffers",fr);class pr{constructor(a,h,m){this.layoutVertexArray=new a,this.layoutAttributes=h,this.indexArray=new m,this.segments=new Ar,this.collisionVertexArray=new ci}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,OS.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}zn("CollisionBuffers",pr);class gr{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.globalState=a.globalState,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(A=>A.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=ir(this.zoom,h["text-size"]),this.iconSizeData=ir(this.zoom,h["icon-size"]);const m=this.layers[0].layout,b=m.get("symbol-sort-key"),T=m.get("symbol-z-order");this.canOverlap=Wi(m,"text-overlap","text-allow-overlap")!=="never"||Wi(m,"icon-overlap","icon-allow-overlap")!=="never"||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!b.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,m.get("symbol-placement")==="point"&&(this.writingModes=m.get("text-writing-mode").map(A=>c.an[A])),this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id),this.sourceID=a.sourceID}createArrays(){this.text=new fr(new Ns(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new fr(new Ns(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new Xe,this.lineVertexArray=new at,this.symbolInstances=new et,this.textAnchorOffsets=new Ye}calculateGlyphDependencies(a,h,m,b,T){for(let A=0;A<a.length;A++)if(h[a.charCodeAt(A)]=!0,(m||b)&&T){const z=ch[a.charAt(A)];z&&(h[z.charCodeAt(0)]=!0)}}populate(a,h,m){const b=this.layers[0],T=b.layout,A=T.get("text-font"),z=T.get("text-field"),N=T.get("icon-image"),j=(z.value.kind!=="constant"||z.value.value instanceof Di&&!z.value.value.isEmpty()||z.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),Y=N.value.kind!=="constant"||!!N.value.value||Object.keys(N.parameters).length>0,te=T.get("symbol-sort-key");if(this.features=[],!j&&!Y)return;const he=h.iconDependencies,pe=h.glyphDependencies,ge=h.availableImages,_e=new si(this.zoom,{globalState:this.globalState});for(const{feature:De,id:Ve,index:ft,sourceLayerIndex:tt}of a){const de=b._featureFilter.needGeometry,ke=eh(De,de);if(!b._featureFilter.filter(_e,ke,m))continue;let it,Rt;if(de||(ke.geometry=Qu(De)),j){const Ft=b.getValueAndResolveTokens("text-field",ke,m,ge),jt=Di.factory(Ft),yn=this.hasRTLText=this.hasRTLText||cr(jt);(!yn||fc.getRTLTextPluginStatus()==="unavailable"||yn&&fc.isParsed())&&(it=Ed(jt,b,ke))}if(Y){const Ft=b.getValueAndResolveTokens("icon-image",ke,m,ge);Rt=Ft instanceof es?Ft:es.fromString(Ft)}if(!it&&!Rt)continue;const an=this.sortFeaturesByKey?te.evaluate(ke,{},m):void 0;if(this.features.push({id:Ve,text:it,icon:Rt,index:ft,sourceLayerIndex:tt,geometry:ke.geometry,properties:De.properties,type:Lt[De.type],sortKey:an}),Rt&&(he[Rt.name]=!0),it){const Ft=A.evaluate(ke,{},m).join(","),jt=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.an.vertical)>=0;for(const yn of it.sections)if(yn.image)he[yn.image.name]=!0;else{const ln=is(it.toString()),bn=yn.fontStack||Ft,Xt=pe[bn]=pe[bn]||{};this.calculateGlyphDependencies(yn.text,Xt,jt,this.allowVerticalPlacement,ln)}}}T.get("symbol-placement")==="line"&&(this.features=function(De){const Ve={},ft={},tt=[];let de=0;function ke(Ft){tt.push(De[Ft]),de++}function it(Ft,jt,yn){const ln=ft[Ft];return delete ft[Ft],ft[jt]=ln,tt[ln].geometry[0].pop(),tt[ln].geometry[0]=tt[ln].geometry[0].concat(yn[0]),ln}function Rt(Ft,jt,yn){const ln=Ve[jt];return delete Ve[jt],Ve[Ft]=ln,tt[ln].geometry[0].shift(),tt[ln].geometry[0]=yn[0].concat(tt[ln].geometry[0]),ln}function an(Ft,jt,yn){const ln=yn?jt[0][jt[0].length-1]:jt[0][0];return`${Ft}:${ln.x}:${ln.y}`}for(let Ft=0;Ft<De.length;Ft++){const jt=De[Ft],yn=jt.geometry,ln=jt.text?jt.text.toString():null;if(!ln){ke(Ft);continue}const bn=an(ln,yn),Xt=an(ln,yn,!0);if(bn in ft&&Xt in Ve&&ft[bn]!==Ve[Xt]){const Hn=Rt(bn,Xt,yn),hr=it(bn,Xt,tt[Hn].geometry);delete Ve[bn],delete ft[Xt],ft[an(ln,tt[hr].geometry,!0)]=hr,tt[Hn].geometry=null}else bn in ft?it(bn,Xt,yn):Xt in Ve?Rt(bn,Xt,yn):(ke(Ft),Ve[bn]=de-1,ft[Xt]=de-1)}return tt.filter(Ft=>Ft.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((De,Ve)=>De.sortKey-Ve.sortKey)}update(a,h,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,h,this.layers,m),this.icon.programConfigurations.updatePaintArrays(a,h,this.layers,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,h){const m=this.lineVertexArray.length;if(a.segment!==void 0){let b=a.dist(h[a.segment+1]),T=a.dist(h[a.segment]);const A={};for(let z=a.segment+1;z<h.length;z++)A[z]={x:h[z].x,y:h[z].y,tileUnitDistanceFromAnchor:b},z<h.length-1&&(b+=h[z+1].dist(h[z]));for(let z=a.segment||0;z>=0;z--)A[z]={x:h[z].x,y:h[z].y,tileUnitDistanceFromAnchor:T},z>0&&(T+=h[z-1].dist(h[z]));for(let z=0;z<h.length;z++){const N=A[z];this.lineVertexArray.emplaceBack(N.x,N.y,N.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(a,h,m,b,T,A,z,N,j,Y,te,he){const pe=a.indexArray,ge=a.layoutVertexArray,_e=a.segments.prepareSegment(4*h.length,ge,pe,this.canOverlap?A.sortKey:void 0),De=this.glyphOffsetArray.length,Ve=_e.vertexLength,ft=this.allowVerticalPlacement&&z===c.an.vertical?Math.PI/2:0,tt=A.text&&A.text.sections;for(let de=0;de<h.length;de++){const{tl:ke,tr:it,bl:Rt,br:an,tex:Ft,pixelOffsetTL:jt,pixelOffsetBR:yn,minFontScaleX:ln,minFontScaleY:bn,glyphOffset:Xt,isSDF:Hn,sectionIndex:hr}=h[de],lr=_e.vertexLength,Jn=Xt[1];zt(ge,N.x,N.y,ke.x,Jn+ke.y,Ft.x,Ft.y,m,Hn,jt.x,jt.y,ln,bn),zt(ge,N.x,N.y,it.x,Jn+it.y,Ft.x+Ft.w,Ft.y,m,Hn,yn.x,jt.y,ln,bn),zt(ge,N.x,N.y,Rt.x,Jn+Rt.y,Ft.x,Ft.y+Ft.h,m,Hn,jt.x,yn.y,ln,bn),zt(ge,N.x,N.y,an.x,Jn+an.y,Ft.x+Ft.w,Ft.y+Ft.h,m,Hn,yn.x,yn.y,ln,bn),Ln(a.dynamicLayoutVertexArray,N,ft),pe.emplaceBack(lr,lr+2,lr+1),pe.emplaceBack(lr+1,lr+2,lr+3),_e.vertexLength+=4,_e.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Xt[0]),de!==h.length-1&&hr===h[de+1].sectionIndex||a.programConfigurations.populatePaintArrays(ge.length,A,A.index,{},he,tt&&tt[hr])}a.placedSymbolArray.emplaceBack(N.x,N.y,De,this.glyphOffsetArray.length-De,Ve,j,Y,N.segment,m?m[0]:0,m?m[1]:0,b[0],b[1],z,0,!1,0,te)}_addCollisionDebugVertex(a,h,m,b,T,A){return h.emplaceBack(0,0),a.emplaceBack(m.x,m.y,b,T,Math.round(A.x),Math.round(A.y))}addCollisionDebugVertices(a,h,m,b,T,A,z){const N=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),j=N.vertexLength,Y=T.layoutVertexArray,te=T.collisionVertexArray,he=z.anchorX,pe=z.anchorY;this._addCollisionDebugVertex(Y,te,A,he,pe,new I(a,h)),this._addCollisionDebugVertex(Y,te,A,he,pe,new I(m,h)),this._addCollisionDebugVertex(Y,te,A,he,pe,new I(m,b)),this._addCollisionDebugVertex(Y,te,A,he,pe,new I(a,b)),N.vertexLength+=4;const ge=T.indexArray;ge.emplaceBack(j,j+1),ge.emplaceBack(j+1,j+2),ge.emplaceBack(j+2,j+3),ge.emplaceBack(j+3,j),N.primitiveLength+=4}addDebugCollisionBoxes(a,h,m,b){for(let T=a;T<h;T++){const A=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(A.x1,A.y1,A.x2,A.y2,b?this.textCollisionBox:this.iconCollisionBox,A.anchorPoint,m)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pr(ii,iu.members,Kr),this.iconCollisionBox=new pr(ii,iu.members,Kr);for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(a,h,m,b,T,A,z,N,j){const Y={};for(let te=h;te<m;te++){const he=a.get(te);Y.textBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Y.textFeatureIndex=he.featureIndex;break}for(let te=b;te<T;te++){const he=a.get(te);Y.verticalTextBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Y.verticalTextFeatureIndex=he.featureIndex;break}for(let te=A;te<z;te++){const he=a.get(te);Y.iconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Y.iconFeatureIndex=he.featureIndex;break}for(let te=N;te<j;te++){const he=a.get(te);Y.verticalIconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Y.verticalIconFeatureIndex=he.featureIndex;break}return Y}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,h){const m=a.placedSymbolArray.get(h),b=m.vertexStartIndex+4*m.numGlyphs;for(let T=m.vertexStartIndex;T<b;T+=4)a.indexArray.emplaceBack(T,T+2,T+1),a.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const h=Math.sin(a),m=Math.cos(a),b=[],T=[],A=[];for(let z=0;z<this.symbolInstances.length;++z){A.push(z);const N=this.symbolInstances.get(z);b.push(0|Math.round(h*N.anchorX+m*N.anchorY)),T.push(N.featureIndex)}return A.sort((z,N)=>b[z]-b[N]||T[N]-T[z]),A}addToSortKeyRanges(a,h){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===h?m.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const h of this.symbolInstanceIndexes){const m=this.symbolInstances.get(h);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach((b,T,A)=>{b>=0&&A.indexOf(b)===T&&this.addIndicesForPlacedSymbol(this.text,b)}),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Io,ni;zn("SymbolBucket",gr,{omit:["layers","collisionBoxArray","features","compareText"]}),gr.MAX_GLYPHS=65535,gr.addDynamicAttributes=Ln;var bc={get paint(){return ni=ni||new vi({"icon-opacity":new ar(qe.paint_symbol["icon-opacity"]),"icon-color":new ar(qe.paint_symbol["icon-color"]),"icon-halo-color":new ar(qe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ar(qe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ar(qe.paint_symbol["icon-halo-blur"]),"icon-translate":new $n(qe.paint_symbol["icon-translate"]),"icon-translate-anchor":new $n(qe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ar(qe.paint_symbol["text-opacity"]),"text-color":new ar(qe.paint_symbol["text-color"],{runtimeType:kn,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new ar(qe.paint_symbol["text-halo-color"]),"text-halo-width":new ar(qe.paint_symbol["text-halo-width"]),"text-halo-blur":new ar(qe.paint_symbol["text-halo-blur"]),"text-translate":new $n(qe.paint_symbol["text-translate"]),"text-translate-anchor":new $n(qe.paint_symbol["text-translate-anchor"])})},get layout(){return Io=Io||new vi({"symbol-placement":new $n(qe.layout_symbol["symbol-placement"]),"symbol-spacing":new $n(qe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new $n(qe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ar(qe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new $n(qe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new $n(qe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new $n(qe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new $n(qe.layout_symbol["icon-ignore-placement"]),"icon-optional":new $n(qe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new $n(qe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ar(qe.layout_symbol["icon-size"]),"icon-text-fit":new $n(qe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $n(qe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ar(qe.layout_symbol["icon-image"]),"icon-rotate":new ar(qe.layout_symbol["icon-rotate"]),"icon-padding":new ar(qe.layout_symbol["icon-padding"]),"icon-keep-upright":new $n(qe.layout_symbol["icon-keep-upright"]),"icon-offset":new ar(qe.layout_symbol["icon-offset"]),"icon-anchor":new ar(qe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new $n(qe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new $n(qe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new $n(qe.layout_symbol["text-rotation-alignment"]),"text-field":new ar(qe.layout_symbol["text-field"]),"text-font":new ar(qe.layout_symbol["text-font"]),"text-size":new ar(qe.layout_symbol["text-size"]),"text-max-width":new ar(qe.layout_symbol["text-max-width"]),"text-line-height":new $n(qe.layout_symbol["text-line-height"]),"text-letter-spacing":new ar(qe.layout_symbol["text-letter-spacing"]),"text-justify":new ar(qe.layout_symbol["text-justify"]),"text-radial-offset":new ar(qe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new $n(qe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ar(qe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ar(qe.layout_symbol["text-anchor"]),"text-max-angle":new $n(qe.layout_symbol["text-max-angle"]),"text-writing-mode":new $n(qe.layout_symbol["text-writing-mode"]),"text-rotate":new ar(qe.layout_symbol["text-rotate"]),"text-padding":new $n(qe.layout_symbol["text-padding"]),"text-keep-upright":new $n(qe.layout_symbol["text-keep-upright"]),"text-transform":new ar(qe.layout_symbol["text-transform"]),"text-offset":new ar(qe.layout_symbol["text-offset"]),"text-allow-overlap":new $n(qe.layout_symbol["text-allow-overlap"]),"text-overlap":new $n(qe.layout_symbol["text-overlap"]),"text-ignore-placement":new $n(qe.layout_symbol["text-ignore-placement"]),"text-optional":new $n(qe.layout_symbol["text-optional"])})}};class Yx{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:It,this.defaultValue=a}evaluate(a){if(a.formattedSection){const h=this.defaultValue.property.overrides;if(h&&h.hasOverride(a.formattedSection))return h.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}zn("FormatSectionOverride",Yx,{omit:["defaultValue"]});class Kx extends oo{constructor(a){super(a,bc)}recalculate(a,h){if(super.recalculate(a,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const m=this.layout.get("text-writing-mode");if(m){const b=[];for(const T of m)b.indexOf(T)<0&&b.push(T);this.layout._values["text-writing-mode"]=b}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,h,m,b){const T=this.layout.get(a).evaluate(h,{},m,b),A=this._unevaluatedLayout._values[a];return A.isDataDriven()||ac(A.value)||!T?T:function(z,N){return N.replace(/{([^{}]+)}/g,(j,Y)=>z&&Y in z?String(z[Y]):"")}(h.properties,T)}createBucket(a){return new gr(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const a of bc.paint.overridableProperties){if(!Kx.hasPaintOverride(this.layout,a))continue;const h=this.paint.get(a),m=new Yx(h),b=new Ou(m,h.property.specification);let T=null;T=h.value.kind==="constant"||h.value.kind==="source"?new Fa("source",b):new Qh("composite",b,h.value.zoomStops),this.paint._values[a]=new zs(h.property,T,h.parameters)}}_handleOverridablePaintPropertyUpdate(a,h,m){return!(!this.layout||h.isDataDriven()||m.isDataDriven())&&Kx.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,h){const m=a.get("text-field"),b=bc.paint.properties[h];let T=!1;const A=z=>{for(const N of z)if(b.overrides&&b.overrides.hasOverride(N))return void(T=!0)};if(m.value.kind==="constant"&&m.value.value instanceof Di)A(m.value.value.sections);else if(m.value.kind==="source"){const z=j=>{T||(j instanceof ts&&sr(j.value)===Dt?A(j.value.sections):j instanceof Bh?A(j.sections):j.eachChild(z))},N=m.value;N._styleExpression&&z(N._styleExpression.expression)}return T}}let FI;var N8={get paint(){return FI=FI||new vi({"background-color":new $n(qe.paint_background["background-color"]),"background-pattern":new ud(qe.paint_background["background-pattern"]),"background-opacity":new $n(qe.paint_background["background-opacity"])})}};class B8 extends oo{constructor(a){super(a,N8)}}let NI;var U8={get paint(){return NI=NI||new vi({"raster-opacity":new $n(qe.paint_raster["raster-opacity"]),"raster-hue-rotate":new $n(qe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new $n(qe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new $n(qe.paint_raster["raster-brightness-max"]),"raster-saturation":new $n(qe.paint_raster["raster-saturation"]),"raster-contrast":new $n(qe.paint_raster["raster-contrast"]),"raster-resampling":new $n(qe.paint_raster["raster-resampling"]),"raster-fade-duration":new $n(qe.paint_raster["raster-fade-duration"])})}};class $8 extends oo{constructor(a){super(a,U8)}}class V8 extends oo{constructor(a){super(a,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class j8{constructor(a){this._methodToThrottle=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const H8={once:!0},BS=63710088e-1;class Df{constructor(a,h){if(isNaN(a)||isNaN(h))throw new Error(`Invalid LngLat object: (${a}, ${h})`);if(this.lng=+a,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Df(wt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const h=Math.PI/180,m=this.lat*h,b=a.lat*h,T=Math.sin(m)*Math.sin(b)+Math.cos(m)*Math.cos(b)*Math.cos((a.lng-this.lng)*h);return BS*Math.acos(Math.min(T,1))}static convert(a){if(a instanceof Df)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Df(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Df(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const BI=2*Math.PI*BS;function UI(d){return BI*Math.cos(d*Math.PI/180)}function $I(d){return(180+d)/360}function VI(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function jI(d,a){return d/UI(a)}function US(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function HI(d,a){return d*UI(US(a))}class t0{constructor(a,h,m=0){this.x=+a,this.y=+h,this.z=+m}static fromLngLat(a,h=0){const m=Df.convert(a);return new t0($I(m.lng),VI(m.lat),jI(h,m.lat))}toLngLat(){return new Df(360*this.x-180,US(this.y))}toAltitude(){return HI(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/BI*(a=US(this.y),1/Math.cos(a*Math.PI/180));var a}}function GI(d,a,h){var m=2*Math.PI*6378137/256/Math.pow(2,h);return[d*m-2*Math.PI*6378137/2,a*m-2*Math.PI*6378137/2]}class $S{constructor(a,h,m){if(!function(b,T,A){return!(b<0||b>25||A<0||A>=Math.pow(2,b)||T<0||T>=Math.pow(2,b))}(a,h,m))throw new Error(`x=${h}, y=${m}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=h,this.y=m,this.key=$g(0,a,a,h,m)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,h,m){const b=(A=this.y,z=this.z,N=GI(256*(T=this.x),256*(A=Math.pow(2,z)-A-1),z),j=GI(256*(T+1),256*(A+1),z),N[0]+","+N[1]+","+j[0]+","+j[1]);var T,A,z,N,j;const Y=function(te,he,pe){let ge,_e="";for(let De=te;De>0;De--)ge=1<<De-1,_e+=(he&ge?1:0)+(pe&ge?2:0);return _e}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(m==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,Y).replace(/{bbox-epsg-3857}/g,b)}isChildOf(a){const h=this.z-a.z;return h>0&&a.x===this.x>>h&&a.y===this.y>>h}getTilePoint(a){const h=Math.pow(2,this.z);return new I((a.x*h-this.x)*Qe,(a.y*h-this.y)*Qe)}toString(){return`${this.z}/${this.x}/${this.y}`}}class WI{constructor(a,h){this.wrap=a,this.canonical=h,this.key=$g(a,h.z,h.z,h.x,h.y)}}class El{constructor(a,h,m,b,T){if(this.terrainRttPosMatrix32f=null,a<m)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${m}`);this.overscaledZ=a,this.wrap=h,this.canonical=new $S(m,+b,+T),this.key=$g(h,a,m,b,T)}clone(){return new El(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-a;return a>this.canonical.z?new El(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new El(a,this.wrap,a,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(a,h){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const m=this.canonical.z-a;return a>this.canonical.z?$g(this.wrap*+h,a,this.canonical.z,this.canonical.x,this.canonical.y):$g(this.wrap*+h,a,a,this.canonical.x>>m,this.canonical.y>>m)}isChildOf(a){if(a.wrap!==this.wrap)return!1;const h=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>h&&a.canonical.y===this.canonical.y>>h}children(a){if(this.overscaledZ>=a)return[new El(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const h=this.canonical.z+1,m=2*this.canonical.x,b=2*this.canonical.y;return[new El(h,this.wrap,h,m,b),new El(h,this.wrap,h,m+1,b),new El(h,this.wrap,h,m,b+1),new El(h,this.wrap,h,m+1,b+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new El(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new El(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new WI(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new t0(a.x-this.wrap,a.y))}}function $g(d,a,h,m,b){(d*=2)<0&&(d=-1*d-1);const T=1<<h;return(T*T*d+T*b+m).toString(36)+h.toString(36)+a.toString(36)}zn("CanonicalTileID",$S),zn("OverscaledTileID",El,{omit:["terrainRttPosMatrix32f"]});class hm{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(a){return this.minX=Math.min(this.minX,a.x),this.minY=Math.min(this.minY,a.y),this.maxX=Math.max(this.maxX,a.x),this.maxY=Math.max(this.maxY,a.y),this}expandBy(a){return this.minX-=a,this.minY-=a,this.maxX+=a,this.maxY+=a,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(a){return this.expandBy(-a)}map(a){const h=new hm;return h.extend(a(new I(this.minX,this.minY))),h.extend(a(new I(this.maxX,this.minY))),h.extend(a(new I(this.minX,this.maxY))),h.extend(a(new I(this.maxX,this.maxY))),h}static fromPoints(a){const h=new hm;for(const m of a)h.extend(m);return h}contains(a){return a.x>=this.minX&&a.x<=this.maxX&&a.y>=this.minY&&a.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(a){return!this.empty()&&!a.empty()&&a.minX>=this.minX&&a.maxX<=this.maxX&&a.minY>=this.minY&&a.maxY<=this.maxY}intersects(a){return!this.empty()&&!a.empty()&&a.minX<=this.maxX&&a.maxX>=this.minX&&a.minY<=this.maxY&&a.maxY>=this.minY}}class qI{constructor(a){this._stringToNumber={},this._numberToString=[];for(let h=0;h<a.length;h++){const m=a[h];this._stringToNumber[m]=h,this._numberToString[h]=m}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class XI{constructor(a,h,m,b,T){this.type="Feature",this._vectorTileFeature=a,a._z=h,a._x=m,a._y=b,this.properties=a.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(a[h]=this[h]);return a}}class ZI{constructor(a,h){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Ao(Qe,16,0),this.grid3D=new Ao(Qe,16,0),this.featureIndexArray=new Pt,this.promoteId=h}insert(a,h,m,b,T,A){const z=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,b,T);const N=A?this.grid3D:this.grid;for(let j=0;j<h.length;j++){const Y=h[j],te=[1/0,1/0,-1/0,-1/0];for(let he=0;he<Y.length;he++){const pe=Y[he];te[0]=Math.min(te[0],pe.x),te[1]=Math.min(te[1],pe.y),te[2]=Math.max(te[2],pe.x),te[3]=Math.max(te[3],pe.y)}te[0]<Qe&&te[1]<Qe&&te[2]>=0&&te[3]>=0&&N.insert(z,te[0],te[1],te[2],te[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Sd.VectorTile(new Lf(this.rawTileData)).layers,this.sourceLayerCoder=new qI(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,h,m,b){this.loadVTLayers();const T=a.params,A=Qe/a.tileSize/a.scale,z=Na(T.filter),N=a.queryGeometry,j=a.queryPadding*A,Y=hm.fromPoints(N),te=this.grid.query(Y.minX-j,Y.minY-j,Y.maxX+j,Y.maxY+j),he=hm.fromPoints(a.cameraQueryGeometry).expandBy(j),pe=this.grid3D.query(he.minX,he.minY,he.maxX,he.maxY,(De,Ve,ft,tt)=>function(de,ke,it,Rt,an){for(const jt of de)if(ke<=jt.x&&it<=jt.y&&Rt>=jt.x&&an>=jt.y)return!0;const Ft=[new I(ke,it),new I(ke,an),new I(Rt,an),new I(Rt,it)];if(de.length>2){for(const jt of Ft)if(th(de,jt))return!0}for(let jt=0;jt<de.length-1;jt++)if(Ix(de[jt],de[jt+1],Ft))return!0;return!1}(a.cameraQueryGeometry,De-j,Ve-j,ft+j,tt+j));for(const De of pe)te.push(De);te.sort(G8);const ge={};let _e;for(let De=0;De<te.length;De++){const Ve=te[De];if(Ve===_e)continue;_e=Ve;const ft=this.featureIndexArray.get(Ve);let tt=null;this.loadMatchingFeature(ge,ft.bucketIndex,ft.sourceLayerIndex,ft.featureIndex,z,T.layers,T.availableImages,h,m,b,(de,ke,it)=>(tt||(tt=Qu(de)),ke.queryIntersectsFeature({queryGeometry:N,feature:de,featureState:it,geometry:tt,zoom:this.z,transform:a.transform,pixelsToTileUnits:A,pixelPosMatrix:a.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:a.getElevation})))}return ge}loadMatchingFeature(a,h,m,b,T,A,z,N,j,Y,te){const he=this.bucketLayerIDs[h];if(A&&!he.some(De=>A.has(De)))return;const pe=this.sourceLayerCoder.decode(m),ge=this.vtLayers[pe].feature(b);if(T.needGeometry){const De=eh(ge,!0);if(!T.filter(new si(this.tileID.overscaledZ),De,this.tileID.canonical))return}else if(!T.filter(new si(this.tileID.overscaledZ),ge))return;const _e=this.getId(ge,pe);for(let De=0;De<he.length;De++){const Ve=he[De];if(A&&!A.has(Ve))continue;const ft=N[Ve];if(!ft)continue;let tt={};_e&&Y&&(tt=Y.getState(ft.sourceLayer||"_geojsonTileLayer",_e));const de=cn({},j[Ve]);de.paint=YI(de.paint,ft.paint,ge,tt,z),de.layout=YI(de.layout,ft.layout,ge,tt,z);const ke=!te||te(ge,ft,tt);if(!ke)continue;const it=new XI(ge,this.z,this.x,this.y,_e);it.layer=de;let Rt=a[Ve];Rt===void 0&&(Rt=a[Ve]=[]),Rt.push({featureIndex:b,feature:it,intersectionZ:ke})}}lookupSymbolFeatures(a,h,m,b,T,A,z,N){const j={};this.loadVTLayers();const Y=Na(T);for(const te of a)this.loadMatchingFeature(j,m,b,te,Y,A,z,N,h);return j}hasLayer(a){for(const h of this.bucketLayerIDs)for(const m of h)if(a===m)return!0;return!1}getId(a,h){var m;let b=a.id;return this.promoteId&&(b=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof b=="boolean"&&(b=Number(b)),b===void 0&&(!((m=a.properties)===null||m===void 0)&&m.cluster)&&this.promoteId&&(b=Number(a.properties.cluster_id))),b}}function YI(d,a,h,m,b){return tn(d,(T,A)=>{const z=a instanceof vl?a.get(A):null;return z&&z.evaluate?z.evaluate(h,m,b):z})}function G8(d,a){return a-d}function KI(d,a,h,m,b){const T=[];for(let A=0;A<d.length;A++){const z=d[A];let N;for(let j=0;j<z.length-1;j++){let Y=z[j],te=z[j+1];Y.x<a&&te.x<a||(Y.x<a?Y=new I(a,Y.y+(a-Y.x)/(te.x-Y.x)*(te.y-Y.y))._round():te.x<a&&(te=new I(a,Y.y+(a-Y.x)/(te.x-Y.x)*(te.y-Y.y))._round()),Y.y<h&&te.y<h||(Y.y<h?Y=new I(Y.x+(h-Y.y)/(te.y-Y.y)*(te.x-Y.x),h)._round():te.y<h&&(te=new I(Y.x+(h-Y.y)/(te.y-Y.y)*(te.x-Y.x),h)._round()),Y.x>=m&&te.x>=m||(Y.x>=m?Y=new I(m,Y.y+(m-Y.x)/(te.x-Y.x)*(te.y-Y.y))._round():te.x>=m&&(te=new I(m,Y.y+(m-Y.x)/(te.x-Y.x)*(te.y-Y.y))._round()),Y.y>=b&&te.y>=b||(Y.y>=b?Y=new I(Y.x+(b-Y.y)/(te.y-Y.y)*(te.x-Y.x),b)._round():te.y>=b&&(te=new I(Y.x+(b-Y.y)/(te.y-Y.y)*(te.x-Y.x),b)._round()),N&&Y.equals(N[N.length-1])||(N=[Y],T.push(N)),N.push(te)))))}}return T}zn("FeatureIndex",ZI,{omit:["rawTileData","sourceLayerCoder"]});class zf extends I{constructor(a,h,m,b){super(a,h),this.angle=m,b!==void 0&&(this.segment=b)}clone(){return new zf(this.x,this.y,this.angle,this.segment)}}function JI(d,a,h,m,b){if(a.segment===void 0||h===0)return!0;let T=a,A=a.segment+1,z=0;for(;z>-h/2;){if(A--,A<0)return!1;z-=d[A].dist(T),T=d[A]}z+=d[A].dist(d[A+1]),A++;const N=[];let j=0;for(;z<h/2;){const Y=d[A],te=d[A+1];if(!te)return!1;let he=d[A-1].angleTo(Y)-Y.angleTo(te);for(he=Math.abs((he+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:z,angleDelta:he}),j+=he;z-N[0].distance>m;)j-=N.shift().angleDelta;if(j>b)return!1;A++,z+=Y.dist(te)}return!0}function QI(d){let a=0;for(let h=0;h<d.length-1;h++)a+=d[h].dist(d[h+1]);return a}function eR(d,a,h){return d?.6*a*h:0}function tR(d,a){return Math.max(d?d.right-d.left:0,a?a.right-a.left:0)}function W8(d,a,h,m,b,T){const A=eR(h,b,T),z=tR(h,m)*T;let N=0;const j=QI(d)/2;for(let Y=0;Y<d.length-1;Y++){const te=d[Y],he=d[Y+1],pe=te.dist(he);if(N+pe>j){const ge=(j-N)/pe,_e=Ls.number(te.x,he.x,ge),De=Ls.number(te.y,he.y,ge),Ve=new zf(_e,De,he.angleTo(te),Y);return Ve._round(),!A||JI(d,Ve,z,A,a)?Ve:void 0}N+=pe}}function q8(d,a,h,m,b,T,A,z,N){const j=eR(m,T,A),Y=tR(m,b),te=Y*A,he=d[0].x===0||d[0].x===N||d[0].y===0||d[0].y===N;return a-te<a/4&&(a=te+a/4),nR(d,he?a/2*z%a:(Y/2+2*T)*A*z%a,a,j,h,te,he,!1,N)}function nR(d,a,h,m,b,T,A,z,N){const j=T/2,Y=QI(d);let te=0,he=a-h,pe=[];for(let ge=0;ge<d.length-1;ge++){const _e=d[ge],De=d[ge+1],Ve=_e.dist(De),ft=De.angleTo(_e);for(;he+h<te+Ve;){he+=h;const tt=(he-te)/Ve,de=Ls.number(_e.x,De.x,tt),ke=Ls.number(_e.y,De.y,tt);if(de>=0&&de<N&&ke>=0&&ke<N&&he-j>=0&&he+j<=Y){const it=new zf(de,ke,ft,ge);it._round(),m&&!JI(d,it,T,m,b)||pe.push(it)}}te+=Ve}return z||pe.length||A||(pe=nR(d,te/2,h,m,b,T,A,!0,N)),pe}function rR(d,a,h,m){const b=[],T=d.image,A=T.pixelRatio,z=T.paddedRect.w-2,N=T.paddedRect.h-2;let j={x1:d.left,y1:d.top,x2:d.right,y2:d.bottom};const Y=T.stretchX||[[0,z]],te=T.stretchY||[[0,N]],he=(Xt,Hn)=>Xt+Hn[1]-Hn[0],pe=Y.reduce(he,0),ge=te.reduce(he,0),_e=z-pe,De=N-ge;let Ve=0,ft=pe,tt=0,de=ge,ke=0,it=_e,Rt=0,an=De;if(T.content&&m){const Xt=T.content,Hn=Xt[2]-Xt[0],hr=Xt[3]-Xt[1];(T.textFitWidth||T.textFitHeight)&&(j=Cn(d)),Ve=Jx(Y,0,Xt[0]),tt=Jx(te,0,Xt[1]),ft=Jx(Y,Xt[0],Xt[2]),de=Jx(te,Xt[1],Xt[3]),ke=Xt[0]-Ve,Rt=Xt[1]-tt,it=Hn-ft,an=hr-de}const Ft=j.x1,jt=j.y1,yn=j.x2-Ft,ln=j.y2-jt,bn=(Xt,Hn,hr,lr)=>{const Jn=Qx(Xt.stretch-Ve,ft,yn,Ft),Dr=e1(Xt.fixed-ke,it,Xt.stretch,pe),qi=Qx(Hn.stretch-tt,de,ln,jt),Ro=e1(Hn.fixed-Rt,an,Hn.stretch,ge),Cs=Qx(hr.stretch-Ve,ft,yn,Ft),Tl=e1(hr.fixed-ke,it,hr.stretch,pe),wa=Qx(lr.stretch-tt,de,ln,jt),us=e1(lr.fixed-Rt,an,lr.stretch,ge),$i=new I(Jn,qi),Go=new I(Cs,qi),hs=new I(Cs,wa),ds=new I(Jn,wa),ra=new I(Dr/A,Ro/A),Pl=new I(Tl/A,us/A),Wo=a*Math.PI/180;if(Wo){const qo=Math.sin(Wo),Xo=Math.cos(Wo),xo=[Xo,-qo,qo,Xo];$i._matMult(xo),Go._matMult(xo),ds._matMult(xo),hs._matMult(xo)}const Sa=Xt.stretch+Xt.fixed,Lo=Hn.stretch+Hn.fixed;return{tl:$i,tr:Go,bl:ds,br:hs,tex:{x:T.paddedRect.x+1+Sa,y:T.paddedRect.y+1+Lo,w:hr.stretch+hr.fixed-Sa,h:lr.stretch+lr.fixed-Lo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ra,pixelOffsetBR:Pl,minFontScaleX:it/A/yn,minFontScaleY:an/A/ln,isSDF:h}};if(m&&(T.stretchX||T.stretchY)){const Xt=iR(Y,_e,pe),Hn=iR(te,De,ge);for(let hr=0;hr<Xt.length-1;hr++){const lr=Xt[hr],Jn=Xt[hr+1];for(let Dr=0;Dr<Hn.length-1;Dr++)b.push(bn(lr,Hn[Dr],Jn,Hn[Dr+1]))}}else b.push(bn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:z+1},{fixed:0,stretch:N+1}));return b}function Jx(d,a,h){let m=0;for(const b of d)m+=Math.max(a,Math.min(h,b[1]))-Math.max(a,Math.min(h,b[0]));return m}function iR(d,a,h){const m=[{fixed:-1,stretch:0}];for(const[b,T]of d){const A=m[m.length-1];m.push({fixed:b-A.stretch,stretch:A.stretch}),m.push({fixed:b-A.stretch,stretch:A.stretch+(T-b)})}return m.push({fixed:a+1,stretch:h}),m}function Qx(d,a,h,m){return d/a*h+m}function e1(d,a,h,m){return d-a*h/m}zn("Anchor",zf);class t1{constructor(a,h,m,b,T,A,z,N,j,Y){var te;if(this.boxStartIndex=a.length,j){let he=A.top,pe=A.bottom;const ge=A.collisionPadding;ge&&(he-=ge[1],pe+=ge[3]);let _e=pe-he;_e>0&&(_e=Math.max(10,_e),this.circleDiameter=_e)}else{const he=!((te=A.image)===null||te===void 0)&&te.content&&(A.image.textFitWidth||A.image.textFitHeight)?Cn(A):{x1:A.left,y1:A.top,x2:A.right,y2:A.bottom};he.y1=he.y1*z-N[0],he.y2=he.y2*z+N[2],he.x1=he.x1*z-N[3],he.x2=he.x2*z+N[1];const pe=A.collisionPadding;if(pe&&(he.x1-=pe[0]*z,he.y1-=pe[1]*z,he.x2+=pe[2]*z,he.y2+=pe[3]*z),Y){const ge=new I(he.x1,he.y1),_e=new I(he.x2,he.y1),De=new I(he.x1,he.y2),Ve=new I(he.x2,he.y2),ft=Y*Math.PI/180;ge._rotate(ft),_e._rotate(ft),De._rotate(ft),Ve._rotate(ft),he.x1=Math.min(ge.x,_e.x,De.x,Ve.x),he.x2=Math.max(ge.x,_e.x,De.x,Ve.x),he.y1=Math.min(ge.y,_e.y,De.y,Ve.y),he.y2=Math.max(ge.y,_e.y,De.y,Ve.y)}a.emplaceBack(h.x,h.y,he.x1,he.y1,he.x2,he.y2,m,b,T)}this.boxEndIndex=a.length}}class X8{constructor(a=[],h=(m,b)=>m<b?-1:m>b?1:0){if(this.data=a,this.length=this.data.length,this.compare=h,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],h=this.data.pop();return--this.length>0&&(this.data[0]=h,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:h,compare:m}=this,b=h[a];for(;a>0;){const T=a-1>>1,A=h[T];if(m(b,A)>=0)break;h[a]=A,a=T}h[a]=b}_down(a){const{data:h,compare:m}=this,b=this.length>>1,T=h[a];for(;a<b;){let A=1+(a<<1);const z=A+1;if(z<this.length&&m(h[z],h[A])<0&&(A=z),m(h[A],T)>=0)break;h[a]=h[A],a=A}h[a]=T}}function Z8(d,a=1,h=!1){const m=hm.fromPoints(d[0]),b=Math.min(m.width(),m.height());let T=b/2;const A=new X8([],Y8),{minX:z,minY:N,maxX:j,maxY:Y}=m;if(b===0)return new I(z,N);for(let pe=z;pe<j;pe+=b)for(let ge=N;ge<Y;ge+=b)A.push(new Vg(pe+T,ge+T,T,d));let te=function(pe){let ge=0,_e=0,De=0;const Ve=pe[0];for(let ft=0,tt=Ve.length,de=tt-1;ft<tt;de=ft++){const ke=Ve[ft],it=Ve[de],Rt=ke.x*it.y-it.x*ke.y;_e+=(ke.x+it.x)*Rt,De+=(ke.y+it.y)*Rt,ge+=3*Rt}return new Vg(_e/ge,De/ge,0,pe)}(d),he=A.length;for(;A.length;){const pe=A.pop();(pe.d>te.d||!te.d)&&(te=pe,h&&console.log("found best %d after %d probes",Math.round(1e4*pe.d)/1e4,he)),pe.max-te.d<=a||(T=pe.h/2,A.push(new Vg(pe.p.x-T,pe.p.y-T,T,d)),A.push(new Vg(pe.p.x+T,pe.p.y-T,T,d)),A.push(new Vg(pe.p.x-T,pe.p.y+T,T,d)),A.push(new Vg(pe.p.x+T,pe.p.y+T,T,d)),he+=4)}return h&&(console.log(`num probes: ${he}`),console.log(`best distance: ${te.d}`)),te.p}function Y8(d,a){return a.max-d.max}function Vg(d,a,h,m){this.p=new I(d,a),this.h=h,this.d=function(b,T){let A=!1,z=1/0;for(let N=0;N<T.length;N++){const j=T[N];for(let Y=0,te=j.length,he=te-1;Y<te;he=Y++){const pe=j[Y],ge=j[he];pe.y>b.y!=ge.y>b.y&&b.x<(ge.x-pe.x)*(b.y-pe.y)/(ge.y-pe.y)+pe.x&&(A=!A),z=Math.min(z,Mg(b,pe,ge))}}return(A?1:-1)*Math.sqrt(z)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}var Ms;c.aD=void 0,(Ms=c.aD||(c.aD={}))[Ms.center=1]="center",Ms[Ms.left=2]="left",Ms[Ms.right=3]="right",Ms[Ms.top=4]="top",Ms[Ms.bottom=5]="bottom",Ms[Ms["top-left"]=6]="top-left",Ms[Ms["top-right"]=7]="top-right",Ms[Ms["bottom-left"]=8]="bottom-left",Ms[Ms["bottom-right"]=9]="bottom-right";const VS=Number.POSITIVE_INFINITY;function oR(d,a){return a[1]!==VS?function(h,m,b){let T=0,A=0;switch(m=Math.abs(m),b=Math.abs(b),h){case"top-right":case"top-left":case"top":A=b-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-b}switch(h){case"top-right":case"bottom-right":case"right":T=-m;break;case"top-left":case"bottom-left":case"left":T=m}return[T,A]}(d,a[0],a[1]):function(h,m){let b=0,T=0;m<0&&(m=0);const A=m/Math.SQRT2;switch(h){case"top-right":case"top-left":T=A-7;break;case"bottom-right":case"bottom-left":T=7-A;break;case"bottom":T=7-m;break;case"top":T=m-7}switch(h){case"top-right":case"bottom-right":b=-A;break;case"top-left":case"bottom-left":b=A;break;case"left":b=m;break;case"right":b=-m}return[b,T]}(d,a[0])}function sR(d,a,h){var m;const b=d.layout,T=(m=b.get("text-variable-anchor-offset"))===null||m===void 0?void 0:m.evaluate(a,{},h);if(T){const z=T.values,N=[];for(let j=0;j<z.length;j+=2){const Y=N[j]=z[j],te=z[j+1].map(he=>he*to);Y.startsWith("top")?te[1]-=7:Y.startsWith("bottom")&&(te[1]+=7),N[j+1]=te}return new Tr(N)}const A=b.get("text-variable-anchor");if(A){let z;z=d._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[b.get("text-radial-offset").evaluate(a,{},h)*to,VS]:b.get("text-offset").evaluate(a,{},h).map(j=>j*to);const N=[];for(const j of A)N.push(j,oR(j,z));return new Tr(N)}return null}function jS(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function K8(d,a,h,m,b,T,A,z,N,j,Y,te){let he=T.textMaxSize.evaluate(a,{});he===void 0&&(he=A);const pe=d.layers[0].layout,ge=pe.get("icon-offset").evaluate(a,{},Y),_e=lR(h.horizontal),De=A/24,Ve=d.tilePixelRatio*De,ft=d.tilePixelRatio*he/24,tt=d.tilePixelRatio*z,de=d.tilePixelRatio*pe.get("symbol-spacing"),ke=pe.get("text-padding")*d.tilePixelRatio,it=function(hr,lr,Jn,Dr=1){const qi=hr.get("icon-padding").evaluate(lr,{},Jn),Ro=qi&&qi.values;return[Ro[0]*Dr,Ro[1]*Dr,Ro[2]*Dr,Ro[3]*Dr]}(pe,a,Y,d.tilePixelRatio),Rt=pe.get("text-max-angle")/180*Math.PI,an=pe.get("text-rotation-alignment")!=="viewport"&&pe.get("symbol-placement")!=="point",Ft=pe.get("icon-rotation-alignment")==="map"&&pe.get("symbol-placement")!=="point",jt=pe.get("symbol-placement"),yn=de/2,ln=pe.get("icon-text-fit");let bn;m&&ln!=="none"&&(d.allowVerticalPlacement&&h.vertical&&(bn=xn(m,h.vertical,ln,pe.get("icon-text-fit-padding"),ge,De)),_e&&(m=xn(m,_e,ln,pe.get("icon-text-fit-padding"),ge,De)));const Xt=Y?te.line.getGranularityForZoomLevel(Y.z):1,Hn=(hr,lr)=>{lr.x<0||lr.x>=Qe||lr.y<0||lr.y>=Qe||function(Jn,Dr,qi,Ro,Cs,Tl,wa,us,$i,Go,hs,ds,ra,Pl,Wo,Sa,Lo,qo,Xo,xo,Ii,su,jg,au,eV){const Hg=Jn.addToLineVertexArray(Dr,qi);let dm,Gg,Wg,qg,dR=0,fR=0,pR=0,mR=0,KS=-1,JS=-1;const Pd={};let gR=as("");if(Jn.allowVerticalPlacement&&Ro.vertical){const Vs=us.layout.get("text-rotate").evaluate(Ii,{},au)+90;Wg=new t1($i,Dr,Go,hs,ds,Ro.vertical,ra,Pl,Wo,Vs),wa&&(qg=new t1($i,Dr,Go,hs,ds,wa,Lo,qo,Wo,Vs))}if(Cs){const Vs=us.layout.get("icon-rotate").evaluate(Ii,{}),Al=us.layout.get("icon-text-fit")!=="none",fm=rR(Cs,Vs,jg,Al),cu=wa?rR(wa,Vs,jg,Al):void 0;Gg=new t1($i,Dr,Go,hs,ds,Cs,Lo,qo,!1,Vs),dR=4*fm.length;const pm=Jn.iconSizeData;let uh=null;pm.kind==="source"?(uh=[Un*us.layout.get("icon-size").evaluate(Ii,{})],uh[0]>Yn&&fn(`${Jn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):pm.kind==="composite"&&(uh=[Un*su.compositeIconSizes[0].evaluate(Ii,{},au),Un*su.compositeIconSizes[1].evaluate(Ii,{},au)],(uh[0]>Yn||uh[1]>Yn)&&fn(`${Jn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Jn.addSymbols(Jn.icon,fm,uh,xo,Xo,Ii,c.an.none,Dr,Hg.lineStartIndex,Hg.lineLength,-1,au),KS=Jn.icon.placedSymbolArray.length-1,cu&&(fR=4*cu.length,Jn.addSymbols(Jn.icon,cu,uh,xo,Xo,Ii,c.an.vertical,Dr,Hg.lineStartIndex,Hg.lineLength,-1,au),JS=Jn.icon.placedSymbolArray.length-1)}const vR=Object.keys(Ro.horizontal);for(const Vs of vR){const Al=Ro.horizontal[Vs];if(!dm){gR=as(Al.text);const cu=us.layout.get("text-rotate").evaluate(Ii,{},au);dm=new t1($i,Dr,Go,hs,ds,Al,ra,Pl,Wo,cu)}const fm=Al.positionedLines.length===1;if(pR+=aR(Jn,Dr,Al,Tl,us,Wo,Ii,Sa,Hg,Ro.vertical?c.an.horizontal:c.an.horizontalOnly,fm?vR:[Vs],Pd,KS,su,au),fm)break}Ro.vertical&&(mR+=aR(Jn,Dr,Ro.vertical,Tl,us,Wo,Ii,Sa,Hg,c.an.vertical,["vertical"],Pd,JS,su,au));const tV=dm?dm.boxStartIndex:Jn.collisionBoxArray.length,nV=dm?dm.boxEndIndex:Jn.collisionBoxArray.length,rV=Wg?Wg.boxStartIndex:Jn.collisionBoxArray.length,iV=Wg?Wg.boxEndIndex:Jn.collisionBoxArray.length,oV=Gg?Gg.boxStartIndex:Jn.collisionBoxArray.length,sV=Gg?Gg.boxEndIndex:Jn.collisionBoxArray.length,aV=qg?qg.boxStartIndex:Jn.collisionBoxArray.length,lV=qg?qg.boxEndIndex:Jn.collisionBoxArray.length;let lu=-1;const r1=(Vs,Al)=>Vs&&Vs.circleDiameter?Math.max(Vs.circleDiameter,Al):Al;lu=r1(dm,lu),lu=r1(Wg,lu),lu=r1(Gg,lu),lu=r1(qg,lu);const yR=lu>-1?1:0;yR&&(lu*=eV/to),Jn.glyphOffsetArray.length>=gr.MAX_GLYPHS&&fn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ii.sortKey!==void 0&&Jn.addToSortKeyRanges(Jn.symbolInstances.length,Ii.sortKey);const cV=sR(us,Ii,au),[uV,hV]=function(Vs,Al){const fm=Vs.length,cu=Al?.values;if(cu?.length>0)for(let pm=0;pm<cu.length;pm+=2){const uh=cu[pm+1];Vs.emplaceBack(c.aD[cu[pm]],uh[0],uh[1])}return[fm,Vs.length]}(Jn.textAnchorOffsets,cV);Jn.symbolInstances.emplaceBack(Dr.x,Dr.y,Pd.right>=0?Pd.right:-1,Pd.center>=0?Pd.center:-1,Pd.left>=0?Pd.left:-1,Pd.vertical||-1,KS,JS,gR,tV,nV,rV,iV,oV,sV,aV,lV,Go,pR,mR,dR,fR,yR,0,ra,lu,uV,hV)}(d,lr,hr,h,m,b,bn,d.layers[0],d.collisionBoxArray,a.index,a.sourceLayerIndex,d.index,Ve,[ke,ke,ke,ke],an,N,tt,it,Ft,ge,a,T,j,Y,A)};if(jt==="line")for(const hr of KI(a.geometry,0,0,Qe,Qe)){const lr=yc(hr,Xt),Jn=q8(lr,de,Rt,h.vertical||_e,m,24,ft,d.overscaling,Qe);for(const Dr of Jn)_e&&J8(d,_e.text,yn,Dr)||Hn(lr,Dr)}else if(jt==="line-center"){for(const hr of a.geometry)if(hr.length>1){const lr=yc(hr,Xt),Jn=W8(lr,Rt,h.vertical||_e,m,24,ft);Jn&&Hn(lr,Jn)}}else if(a.type==="Polygon")for(const hr of ec(a.geometry,0)){const lr=Z8(hr,16);Hn(yc(hr[0],Xt,!0),new zf(lr.x,lr.y,0))}else if(a.type==="LineString")for(const hr of a.geometry){const lr=yc(hr,Xt);Hn(lr,new zf(lr[0].x,lr[0].y,0))}else if(a.type==="Point")for(const hr of a.geometry)for(const lr of hr)Hn([lr],new zf(lr.x,lr.y,0))}function aR(d,a,h,m,b,T,A,z,N,j,Y,te,he,pe,ge){const _e=function(ft,tt,de,ke,it,Rt,an,Ft){const jt=ke.layout.get("text-rotate").evaluate(Rt,{})*Math.PI/180,yn=[];for(const ln of tt.positionedLines)for(const bn of ln.positionedGlyphs){if(!bn.rect)continue;const Xt=bn.rect||{};let Hn=4,hr=!0,lr=1,Jn=0;const Dr=(it||Ft)&&bn.vertical,qi=bn.metrics.advance*bn.scale/2;if(Ft&&tt.verticalizable&&(Jn=ln.lineOffset/2-(bn.imageName?-(to-bn.metrics.width*bn.scale)/2:(bn.scale-1)*to)),bn.imageName){const qo=an[bn.imageName];hr=qo.sdf,lr=qo.pixelRatio,Hn=1/lr}const Ro=it?[bn.x+qi,bn.y]:[0,0];let Cs=it?[0,0]:[bn.x+qi+de[0],bn.y+de[1]-Jn],Tl=[0,0];Dr&&(Tl=Cs,Cs=[0,0]);const wa=bn.metrics.isDoubleResolution?2:1,us=(bn.metrics.left-Hn)*bn.scale-qi+Cs[0],$i=(-bn.metrics.top-Hn)*bn.scale+Cs[1],Go=us+Xt.w/wa*bn.scale/lr,hs=$i+Xt.h/wa*bn.scale/lr,ds=new I(us,$i),ra=new I(Go,$i),Pl=new I(us,hs),Wo=new I(Go,hs);if(Dr){const qo=new I(-qi,qi- -17),Xo=-Math.PI/2,xo=12-qi,Ii=new I(22-xo,-(bn.imageName?xo:0)),su=new I(...Tl);ds._rotateAround(Xo,qo)._add(Ii)._add(su),ra._rotateAround(Xo,qo)._add(Ii)._add(su),Pl._rotateAround(Xo,qo)._add(Ii)._add(su),Wo._rotateAround(Xo,qo)._add(Ii)._add(su)}if(jt){const qo=Math.sin(jt),Xo=Math.cos(jt),xo=[Xo,-qo,qo,Xo];ds._matMult(xo),ra._matMult(xo),Pl._matMult(xo),Wo._matMult(xo)}const Sa=new I(0,0),Lo=new I(0,0);yn.push({tl:ds,tr:ra,bl:Pl,br:Wo,tex:Xt,writingMode:tt.writingMode,glyphOffset:Ro,sectionIndex:bn.sectionIndex,isSDF:hr,pixelOffsetTL:Sa,pixelOffsetBR:Lo,minFontScaleX:0,minFontScaleY:0})}return yn}(0,h,z,b,T,A,m,d.allowVerticalPlacement),De=d.textSizeData;let Ve=null;De.kind==="source"?(Ve=[Un*b.layout.get("text-size").evaluate(A,{})],Ve[0]>Yn&&fn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):De.kind==="composite"&&(Ve=[Un*pe.compositeTextSizes[0].evaluate(A,{},ge),Un*pe.compositeTextSizes[1].evaluate(A,{},ge)],(Ve[0]>Yn||Ve[1]>Yn)&&fn(`${d.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),d.addSymbols(d.text,_e,Ve,z,T,A,j,a,N.lineStartIndex,N.lineLength,he,ge);for(const ft of Y)te[ft]=d.text.placedSymbolArray.length-1;return 4*_e.length}function lR(d){for(const a in d)return d[a];return null}function J8(d,a,h,m){const b=d.compareText;if(a in b){const T=b[a];for(let A=T.length-1;A>=0;A--)if(m.dist(T[A])<h)return!0}else b[a]=[];return b[a].push(m),!1}const cR=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class HS{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[h,m]=new Uint8Array(a,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");const b=m>>4;if(b!==1)throw new Error(`Got v${b} data when expected v1.`);const T=cR[15&m];if(!T)throw new Error("Unrecognized array type.");const[A]=new Uint16Array(a,2,1),[z]=new Uint32Array(a,4,1);return new HS(z,A,T,a)}constructor(a,h=64,m=Float64Array,b){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=m,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;const T=cR.indexOf(this.ArrayType),A=2*a*this.ArrayType.BYTES_PER_ELEMENT,z=a*this.IndexArrayType.BYTES_PER_ELEMENT,N=(8-z%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${m}.`);b&&b instanceof ArrayBuffer?(this.data=b,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+z+N,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+A+z+N),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+z+N,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=a)}add(a,h){const m=this._pos>>1;return this.ids[m]=m,this.coords[this._pos++]=a,this.coords[this._pos++]=h,m}finish(){const a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return GS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,h,m,b){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:A,nodeSize:z}=this,N=[0,T.length-1,0],j=[];for(;N.length;){const Y=N.pop()||0,te=N.pop()||0,he=N.pop()||0;if(te-he<=z){for(let De=he;De<=te;De++){const Ve=A[2*De],ft=A[2*De+1];Ve>=a&&Ve<=m&&ft>=h&&ft<=b&&j.push(T[De])}continue}const pe=he+te>>1,ge=A[2*pe],_e=A[2*pe+1];ge>=a&&ge<=m&&_e>=h&&_e<=b&&j.push(T[pe]),(Y===0?a<=ge:h<=_e)&&(N.push(he),N.push(pe-1),N.push(1-Y)),(Y===0?m>=ge:b>=_e)&&(N.push(pe+1),N.push(te),N.push(1-Y))}return j}within(a,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:T,nodeSize:A}=this,z=[0,b.length-1,0],N=[],j=m*m;for(;z.length;){const Y=z.pop()||0,te=z.pop()||0,he=z.pop()||0;if(te-he<=A){for(let De=he;De<=te;De++)hR(T[2*De],T[2*De+1],a,h)<=j&&N.push(b[De]);continue}const pe=he+te>>1,ge=T[2*pe],_e=T[2*pe+1];hR(ge,_e,a,h)<=j&&N.push(b[pe]),(Y===0?a-m<=ge:h-m<=_e)&&(z.push(he),z.push(pe-1),z.push(1-Y)),(Y===0?a+m>=ge:h+m>=_e)&&(z.push(pe+1),z.push(te),z.push(1-Y))}return N}}function GS(d,a,h,m,b,T){if(b-m<=h)return;const A=m+b>>1;uR(d,a,A,m,b,T),GS(d,a,h,m,A-1,1-T),GS(d,a,h,A+1,b,1-T)}function uR(d,a,h,m,b,T){for(;b>m;){if(b-m>600){const j=b-m+1,Y=h-m+1,te=Math.log(j),he=.5*Math.exp(2*te/3),pe=.5*Math.sqrt(te*he*(j-he)/j)*(Y-j/2<0?-1:1);uR(d,a,h,Math.max(m,Math.floor(h-Y*he/j+pe)),Math.min(b,Math.floor(h+(j-Y)*he/j+pe)),T)}const A=a[2*h+T];let z=m,N=b;for(n0(d,a,m,h),a[2*b+T]>A&&n0(d,a,m,b);z<N;){for(n0(d,a,z,N),z++,N--;a[2*z+T]<A;)z++;for(;a[2*N+T]>A;)N--}a[2*m+T]===A?n0(d,a,m,N):(N++,n0(d,a,N,b)),N<=h&&(m=N+1),h<=N&&(b=N-1)}}function n0(d,a,h,m){WS(d,h,m),WS(a,2*h,2*m),WS(a,2*h+1,2*m+1)}function WS(d,a,h){const m=d[a];d[a]=d[h],d[h]=m}function hR(d,a,h,m){const b=d-h,T=a-m;return b*b+T*T}var qS;c.cw=void 0,(qS=c.cw||(c.cw={})).create="create",qS.load="load",qS.fullLoad="fullLoad";let n1=null,r0=[];const XS=1e3/60,ZS="loadTime",YS="fullLoadTime",Q8={mark(d){performance.mark(d)},frame(d){const a=d;n1!=null&&r0.push(a-n1),n1=a},clearMetrics(){n1=null,r0=[],performance.clearMeasures(ZS),performance.clearMeasures(YS);for(const d in c.cw)performance.clearMarks(c.cw[d])},getPerformanceMetrics(){performance.measure(ZS,c.cw.create,c.cw.load),performance.measure(YS,c.cw.create,c.cw.fullLoad);const d=performance.getEntriesByName(ZS)[0].duration,a=performance.getEntriesByName(YS)[0].duration,h=r0.length,m=1/(r0.reduce((T,A)=>T+A,0)/h/1e3),b=r0.filter(T=>T>XS).reduce((T,A)=>T+(A-XS)/XS,0);return{loadTime:d,fullLoadTime:a,fps:m,percentDroppedFrames:b/(h+b)*100,totalFrames:h}}};c.$=Qe,c.A=X,c.B=function([d,a,h]){return a+=90,a*=Math.PI/180,h*=Math.PI/180,{x:d*Math.cos(a)*Math.sin(h),y:d*Math.sin(a)*Math.sin(h),z:d*Math.cos(h)}},c.C=Ls,c.D=$n,c.E=dt,c.F=si,c.G=ml,c.H=function(d){if(vn==null){const a=d.navigator?d.navigator.userAgent:null;vn=!!d.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return vn},c.I=lm,c.J=class{constructor(d,a){this.target=d,this.mapId=a,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new j8(()=>this.process()),this.subscription=Ot(this.target,"message",h=>this.receive(h),!1),this.globalScope=On(self)?d:window}registerMessageHandler(d,a){this.messageHandlers[d]=a}sendAsync(d,a){return new Promise((h,m)=>{const b=Math.round(1e18*Math.random()).toString(36).substring(0,10),T=a?Ot(a.signal,"abort",()=>{T?.unsubscribe(),delete this.resolveRejects[b];const N={id:b,type:"<cancel>",origin:location.origin,targetMapId:d.targetMapId,sourceMapId:this.mapId};this.target.postMessage(N)},H8):null;this.resolveRejects[b]={resolve:N=>{T?.unsubscribe(),h(N)},reject:N=>{T?.unsubscribe(),m(N)}};const A=[],z=Object.assign(Object.assign({},d),{id:b,sourceMapId:this.mapId,origin:location.origin,data:ju(d.data,A)});this.target.postMessage(z,{transfer:A})})}receive(d){const a=d.data,h=a.id;if(!(a.origin!=="file://"&&location.origin!=="file://"&&a.origin!=="resource://android"&&location.origin!=="resource://android"&&a.origin!==location.origin||a.targetMapId&&this.mapId!==a.targetMapId)){if(a.type==="<cancel>"){delete this.tasks[h];const m=this.abortControllers[h];return delete this.abortControllers[h],void(m&&m.abort())}if(On(self)||a.mustQueue)return this.tasks[h]=a,this.taskQueue.push(h),void this.invoker.trigger();this.processTask(h,a)}}process(){if(this.taskQueue.length===0)return;const d=this.taskQueue.shift(),a=this.tasks[d];delete this.tasks[d],this.taskQueue.length>0&&this.invoker.trigger(),a&&this.processTask(d,a)}processTask(d,a){return s(this,void 0,void 0,function*(){if(a.type==="<response>"){const b=this.resolveRejects[d];return delete this.resolveRejects[d],b?void(a.error?b.reject(dc(a.error)):b.resolve(dc(a.data))):void 0}if(!this.messageHandlers[a.type])return void this.completeTask(d,new Error(`Could not find a registered handler for ${a.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const h=dc(a.data),m=new AbortController;this.abortControllers[d]=m;try{const b=yield this.messageHandlers[a.type](a.sourceMapId,h,m);this.completeTask(d,null,b)}catch(b){this.completeTask(d,b)}})}completeTask(d,a,h){const m=[];delete this.abortControllers[d];const b={id:d,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:a?ju(a):null,data:ju(h,m)};this.target.postMessage(b,{transfer:m})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},c.K=ne,c.L=function(){var d=new X(16);return X!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0),d[0]=1,d[5]=1,d[10]=1,d[15]=1,d},c.M=function(d,a,h){var m,b,T,A,z,N,j,Y,te,he,pe,ge,_e=h[0],De=h[1],Ve=h[2];return a===d?(d[12]=a[0]*_e+a[4]*De+a[8]*Ve+a[12],d[13]=a[1]*_e+a[5]*De+a[9]*Ve+a[13],d[14]=a[2]*_e+a[6]*De+a[10]*Ve+a[14],d[15]=a[3]*_e+a[7]*De+a[11]*Ve+a[15]):(b=a[1],T=a[2],A=a[3],z=a[4],N=a[5],j=a[6],Y=a[7],te=a[8],he=a[9],pe=a[10],ge=a[11],d[0]=m=a[0],d[1]=b,d[2]=T,d[3]=A,d[4]=z,d[5]=N,d[6]=j,d[7]=Y,d[8]=te,d[9]=he,d[10]=pe,d[11]=ge,d[12]=m*_e+z*De+te*Ve+a[12],d[13]=b*_e+N*De+he*Ve+a[13],d[14]=T*_e+j*De+pe*Ve+a[14],d[15]=A*_e+Y*De+ge*Ve+a[15]),d},c.N=function(d,a,h){var m=h[0],b=h[1],T=h[2];return d[0]=a[0]*m,d[1]=a[1]*m,d[2]=a[2]*m,d[3]=a[3]*m,d[4]=a[4]*b,d[5]=a[5]*b,d[6]=a[6]*b,d[7]=a[7]*b,d[8]=a[8]*T,d[9]=a[9]*T,d[10]=a[10]*T,d[11]=a[11]*T,d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15],d},c.O=function(d,a,h){var m=a[0],b=a[1],T=a[2],A=a[3],z=a[4],N=a[5],j=a[6],Y=a[7],te=a[8],he=a[9],pe=a[10],ge=a[11],_e=a[12],De=a[13],Ve=a[14],ft=a[15],tt=h[0],de=h[1],ke=h[2],it=h[3];return d[0]=tt*m+de*z+ke*te+it*_e,d[1]=tt*b+de*N+ke*he+it*De,d[2]=tt*T+de*j+ke*pe+it*Ve,d[3]=tt*A+de*Y+ke*ge+it*ft,d[4]=(tt=h[4])*m+(de=h[5])*z+(ke=h[6])*te+(it=h[7])*_e,d[5]=tt*b+de*N+ke*he+it*De,d[6]=tt*T+de*j+ke*pe+it*Ve,d[7]=tt*A+de*Y+ke*ge+it*ft,d[8]=(tt=h[8])*m+(de=h[9])*z+(ke=h[10])*te+(it=h[11])*_e,d[9]=tt*b+de*N+ke*he+it*De,d[10]=tt*T+de*j+ke*pe+it*Ve,d[11]=tt*A+de*Y+ke*ge+it*ft,d[12]=(tt=h[12])*m+(de=h[13])*z+(ke=h[14])*te+(it=h[15])*_e,d[13]=tt*b+de*N+ke*he+it*De,d[14]=tt*T+de*j+ke*pe+it*Ve,d[15]=tt*A+de*Y+ke*ge+it*ft,d},c.P=I,c.Q=function(d,a){const h={};for(let m=0;m<a.length;m++){const b=a[m];b in d&&(h[b]=d[b])}return h},c.R=xs,c.S=Df,c.T=er,c.U=VI,c.V=$I,c.W=B,c.X=H,c.Y=yt,c.Z=El,c._=s,c.a=ae,c.a$=function(d,a,h){return d[0]=a[0]*h,d[1]=a[1]*h,d[2]=a[2]*h,d[3]=a[3]*h,d},c.a0=t0,c.a1=hm,c.a2=25,c.a3=$S,c.a4=d=>{const a=window.document.createElement("video");return a.muted=!0,new Promise(h=>{a.onloadstart=()=>{h(a)};for(const m of d){const b=window.document.createElement("source");ye(m)||(a.crossOrigin="Anonymous"),b.src=m,a.appendChild(b)}})},c.a5=Et,c.a6=function(){return dn++},c.a7=Le,c.a8=gr,c.a9=Na,c.aA=to,c.aB=Vt,c.aC=function(d,a,h,m,b=!1){if(!h[0]&&!h[1])return[0,0];const T=b?m==="map"?-d.bearingInRadians:0:m==="viewport"?d.bearingInRadians:0;if(T){const A=Math.sin(T),z=Math.cos(T);h=[h[0]*z-h[1]*A,h[0]*A+h[1]*z]}return[b?h[0]:Vt(a,h[0],d.zoom),b?h[1]:Vt(a,h[1],d.zoom)]},c.aE=Wi,c.aF=jS,c.aG=O,c.aH=HS,c.aI=Ci,c.aJ=ws,c.aK=Mt,c.aL=Ar,c.aM=ai,c.aN=wt,c.aO=Gt,c.aP=HI,c.aQ=we,c.aR=Ce,c.aS=function(d){var a=new X(3);return a[0]=d[0],a[1]=d[1],a[2]=d[2],a},c.aT=function(d,a,h){return d[0]=a[0]-h[0],d[1]=a[1]-h[1],d[2]=a[2]-h[2],d},c.aU=function(d,a){var h=a[0],m=a[1],b=a[2],T=h*h+m*m+b*b;return T>0&&(T=1/Math.sqrt(T)),d[0]=a[0]*T,d[1]=a[1]*T,d[2]=a[2]*T,d},c.aV=We,c.aW=function(d,a){return d[0]*a[0]+d[1]*a[1]+d[2]*a[2]},c.aX=function(d,a,h){return d[0]=a[0]*h[0],d[1]=a[1]*h[1],d[2]=a[2]*h[2],d[3]=a[3]*h[3],d},c.aY=$,c.aZ=function(d,a,h){const m=a[0]*h[0]+a[1]*h[1]+a[2]*h[2];return m===0?null:(-(d[0]*h[0]+d[1]*h[1]+d[2]*h[2])-h[3])/m},c.a_=Me,c.aa=eh,c.ab=XI,c.ac=function(d){const a={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,m,b,T)=>{const A=b||T;return a[m]=!A||A.toLowerCase(),""}),a["max-age"]){const h=parseInt(a["max-age"],10);isNaN(h)?delete a["max-age"]:a["max-age"]=h}return a},c.ad=un,c.ae=function(d){return Math.pow(2,d)},c.af=se,c.ag=_t,c.ah=85.051129,c.ai=jI,c.aj=function(d){return Math.log(d)/Math.LN2},c.ak=function(d){var a=d[0],h=d[1];return a*a+h*h},c.al=function(d,a){const h=[];for(const m in d)m in a||h.push(m);return h},c.am=function(d,a){let h=0,m=0;if(d.kind==="constant")m=d.layoutSize;else if(d.kind!=="source"){const{interpolationType:b,minZoom:T,maxZoom:A}=d,z=b?_t(ns.interpolationFactor(b,a,T,A),0,1):0;d.kind==="camera"?m=Ls.number(d.minSize,d.maxSize,z):h=z}return{uSizeT:h,uSize:m}},c.ao=function(d,{uSize:a,uSizeT:h},{lowerSize:m,upperSize:b}){return d.kind==="source"?m/Un:d.kind==="composite"?Ls.number(m/Un,b/Un,h):a},c.ap=function(d,a){var h=a[0],m=a[1],b=a[2],T=a[3],A=a[4],z=a[5],N=a[6],j=a[7],Y=a[8],te=a[9],he=a[10],pe=a[11],ge=a[12],_e=a[13],De=a[14],Ve=a[15],ft=h*z-m*A,tt=h*N-b*A,de=h*j-T*A,ke=m*N-b*z,it=m*j-T*z,Rt=b*j-T*N,an=Y*_e-te*ge,Ft=Y*De-he*ge,jt=Y*Ve-pe*ge,yn=te*De-he*_e,ln=te*Ve-pe*_e,bn=he*Ve-pe*De,Xt=ft*bn-tt*ln+de*yn+ke*jt-it*Ft+Rt*an;return Xt?(d[0]=(z*bn-N*ln+j*yn)*(Xt=1/Xt),d[1]=(b*ln-m*bn-T*yn)*Xt,d[2]=(_e*Rt-De*it+Ve*ke)*Xt,d[3]=(he*it-te*Rt-pe*ke)*Xt,d[4]=(N*jt-A*bn-j*Ft)*Xt,d[5]=(h*bn-b*jt+T*Ft)*Xt,d[6]=(De*de-ge*Rt-Ve*tt)*Xt,d[7]=(Y*Rt-he*de+pe*tt)*Xt,d[8]=(A*ln-z*jt+j*an)*Xt,d[9]=(m*jt-h*ln-T*an)*Xt,d[10]=(ge*it-_e*de+Ve*ft)*Xt,d[11]=(te*de-Y*it-pe*ft)*Xt,d[12]=(z*Ft-A*yn-N*an)*Xt,d[13]=(h*yn-m*Ft+b*an)*Xt,d[14]=(_e*tt-ge*ke-De*ft)*Xt,d[15]=(Y*ke-te*tt+he*ft)*Xt,d):null},c.aq=rt,c.ar=function(d){return Math.hypot(d[0],d[1])},c.as=function(d){return d[0]=0,d[1]=0,d},c.at=function(d,a,h){return d[0]=a[0]*h,d[1]=a[1]*h,d},c.au=Ln,c.av=Ee,c.aw=function(d,a,h,m){const b=a.y-d.y,T=a.x-d.x,A=m.y-h.y,z=m.x-h.x,N=A*T-z*b;if(N===0)return null;const j=(z*(d.y-h.y)-A*(d.x-h.x))/N;return new I(d.x+j*T,d.y+j*b)},c.ax=KI,c.ay=Bs,c.az=function(d){let a=1/0,h=1/0,m=-1/0,b=-1/0;for(const T of d)a=Math.min(a,T.x),h=Math.min(h,T.y),m=Math.max(m,T.x),b=Math.max(b,T.y);return[a,h,m,b]},c.b=Ue,c.b$=Og,c.b0=function(d,a){return d[0]*a[0]+d[1]*a[1]+d[2]*a[2]+d[3]},c.b1=WI,c.b2=$g,c.b3=function(d,a,h,m,b){var T,A=1/Math.tan(a/2);return d[0]=A/h,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=A,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[11]=-1,d[12]=0,d[13]=0,d[15]=0,b!=null&&b!==1/0?(d[10]=(b+m)*(T=1/(m-b)),d[14]=2*b*m*T):(d[10]=-1,d[14]=-2*m),d},c.b4=function(d){var a=new X(16);return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],a},c.b5=function(d,a,h){var m=Math.sin(h),b=Math.cos(h),T=a[0],A=a[1],z=a[2],N=a[3],j=a[4],Y=a[5],te=a[6],he=a[7];return a!==d&&(d[8]=a[8],d[9]=a[9],d[10]=a[10],d[11]=a[11],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]),d[0]=T*b+j*m,d[1]=A*b+Y*m,d[2]=z*b+te*m,d[3]=N*b+he*m,d[4]=j*b-T*m,d[5]=Y*b-A*m,d[6]=te*b-z*m,d[7]=he*b-N*m,d},c.b6=function(d,a,h){var m=Math.sin(h),b=Math.cos(h),T=a[4],A=a[5],z=a[6],N=a[7],j=a[8],Y=a[9],te=a[10],he=a[11];return a!==d&&(d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]),d[4]=T*b+j*m,d[5]=A*b+Y*m,d[6]=z*b+te*m,d[7]=N*b+he*m,d[8]=j*b-T*m,d[9]=Y*b-A*m,d[10]=te*b-z*m,d[11]=he*b-N*m,d},c.b7=function(){const d=new Float32Array(16);return se(d),d},c.b8=function(){const d=new Float64Array(16);return se(d),d},c.b9=function(){return new Float64Array(16)},c.bA=function(d){return d[0]=0,d[1]=0,d[2]=0,d},c.bB=function(d,a,h,m){const b=Math.sqrt(d*d+a*a),T=Math.sqrt(h*h+m*m);d/=b,a/=b,h/=T,m/=T;const A=Math.acos(d*h+a*m);return-a*h+d*m>0?A:-A},c.bC=function(d,a){const h=je(d,2*Math.PI),m=je(a,2*Math.PI);return Math.min(Math.abs(h-m),Math.abs(h-m+2*Math.PI),Math.abs(h-m-2*Math.PI))},c.bD=function(){const d={},a=qe.$version;for(const h in qe.$root){const m=qe.$root[h];if(m.required){let b=null;b=h==="version"?a:m.type==="array"?[]:{},b!=null&&(d[h]=b)}}return d},c.bE=od,c.bF=Oe,c.bG=function d(a,h){if(Array.isArray(a)){if(!Array.isArray(h)||a.length!==h.length)return!1;for(let m=0;m<a.length;m++)if(!d(a[m],h[m]))return!1;return!0}if(typeof a=="object"&&a!==null&&h!==null){if(typeof h!="object"||Object.keys(a).length!==Object.keys(h).length)return!1;for(const m in a)if(!d(a[m],h[m]))return!1;return!0}return a===h},c.bH=function(d){d=d.slice();const a=Object.create(null);for(let h=0;h<d.length;h++)a[d[h].id]=d[h];for(let h=0;h<d.length;h++)"ref"in d[h]&&(d[h]=Jt(d[h],a[d[h].ref]));return d},c.bI=function(d){if(d.type==="custom")return new V8(d);switch(d.type){case"background":return new B8(d);case"circle":return new PS(d);case"color-relief":return new kx(d);case"fill":return new jy(d);case"fill-extrusion":return new qy(d);case"heatmap":return new bs(d);case"hillshade":return new Ig(d);case"line":return new Hx(d);case"raster":return new $8(d);case"symbol":return new Kx(d)}},c.bJ=Tn,c.bK=function(d,a){if(!d)return[{command:"setStyle",args:[a]}];let h=[];try{if(!Ie(d.version,a.version))return[{command:"setStyle",args:[a]}];Ie(d.center,a.center)||h.push({command:"setCenter",args:[a.center]}),Ie(d.state,a.state)||h.push({command:"setGlobalState",args:[a.state]}),Ie(d.centerAltitude,a.centerAltitude)||h.push({command:"setCenterAltitude",args:[a.centerAltitude]}),Ie(d.zoom,a.zoom)||h.push({command:"setZoom",args:[a.zoom]}),Ie(d.bearing,a.bearing)||h.push({command:"setBearing",args:[a.bearing]}),Ie(d.pitch,a.pitch)||h.push({command:"setPitch",args:[a.pitch]}),Ie(d.roll,a.roll)||h.push({command:"setRoll",args:[a.roll]}),Ie(d.sprite,a.sprite)||h.push({command:"setSprite",args:[a.sprite]}),Ie(d.glyphs,a.glyphs)||h.push({command:"setGlyphs",args:[a.glyphs]}),Ie(d.transition,a.transition)||h.push({command:"setTransition",args:[a.transition]}),Ie(d.light,a.light)||h.push({command:"setLight",args:[a.light]}),Ie(d.terrain,a.terrain)||h.push({command:"setTerrain",args:[a.terrain]}),Ie(d.sky,a.sky)||h.push({command:"setSky",args:[a.sky]}),Ie(d.projection,a.projection)||h.push({command:"setProjection",args:[a.projection]});const m={},b=[];(function(A,z,N,j){let Y;for(Y in z=z||{},A=A||{})Object.prototype.hasOwnProperty.call(A,Y)&&(Object.prototype.hasOwnProperty.call(z,Y)||Wt(Y,N,j));for(Y in z)Object.prototype.hasOwnProperty.call(z,Y)&&(Object.prototype.hasOwnProperty.call(A,Y)?Ie(A[Y],z[Y])||(A[Y].type==="geojson"&&z[Y].type==="geojson"&&mn(A,z,Y)?ot(N,{command:"setGeoJSONSourceData",args:[Y,z[Y].data]}):nn(Y,z,N,j)):mt(Y,z,N))})(d.sources,a.sources,b,m);const T=[];d.layers&&d.layers.forEach(A=>{"source"in A&&m[A.source]?h.push({command:"removeLayer",args:[A.id]}):T.push(A)}),h=h.concat(b),function(A,z,N){z=z||[];const j=(A=A||[]).map(sn),Y=z.map(sn),te=A.reduce(Dn,{}),he=z.reduce(Dn,{}),pe=j.slice(),ge=Object.create(null);let _e,De,Ve,ft,tt;for(let de=0,ke=0;de<j.length;de++)_e=j[de],Object.prototype.hasOwnProperty.call(he,_e)?ke++:(ot(N,{command:"removeLayer",args:[_e]}),pe.splice(pe.indexOf(_e,ke),1));for(let de=0,ke=0;de<Y.length;de++)_e=Y[Y.length-1-de],pe[pe.length-1-de]!==_e&&(Object.prototype.hasOwnProperty.call(te,_e)?(ot(N,{command:"removeLayer",args:[_e]}),pe.splice(pe.lastIndexOf(_e,pe.length-ke),1)):ke++,ft=pe[pe.length-de],ot(N,{command:"addLayer",args:[he[_e],ft]}),pe.splice(pe.length-de,0,_e),ge[_e]=!0);for(let de=0;de<Y.length;de++)if(_e=Y[de],De=te[_e],Ve=he[_e],!ge[_e]&&!Ie(De,Ve))if(Ie(De.source,Ve.source)&&Ie(De["source-layer"],Ve["source-layer"])&&Ie(De.type,Ve.type)){for(tt in on(De.layout,Ve.layout,N,_e,null,"setLayoutProperty"),on(De.paint,Ve.paint,N,_e,null,"setPaintProperty"),Ie(De.filter,Ve.filter)||ot(N,{command:"setFilter",args:[_e,Ve.filter]}),Ie(De.minzoom,Ve.minzoom)&&Ie(De.maxzoom,Ve.maxzoom)||ot(N,{command:"setLayerZoomRange",args:[_e,Ve.minzoom,Ve.maxzoom]}),De)Object.prototype.hasOwnProperty.call(De,tt)&&tt!=="layout"&&tt!=="paint"&&tt!=="filter"&&tt!=="metadata"&&tt!=="minzoom"&&tt!=="maxzoom"&&(tt.indexOf("paint.")===0?on(De[tt],Ve[tt],N,_e,tt.slice(6),"setPaintProperty"):Ie(De[tt],Ve[tt])||ot(N,{command:"setLayerProperty",args:[_e,tt,Ve[tt]]}));for(tt in Ve)Object.prototype.hasOwnProperty.call(Ve,tt)&&!Object.prototype.hasOwnProperty.call(De,tt)&&tt!=="layout"&&tt!=="paint"&&tt!=="filter"&&tt!=="metadata"&&tt!=="minzoom"&&tt!=="maxzoom"&&(tt.indexOf("paint.")===0?on(De[tt],Ve[tt],N,_e,tt.slice(6),"setPaintProperty"):Ie(De[tt],Ve[tt])||ot(N,{command:"setLayerProperty",args:[_e,tt,Ve[tt]]}))}else ot(N,{command:"removeLayer",args:[_e]}),ft=pe[pe.lastIndexOf(_e)+1],ot(N,{command:"addLayer",args:[Ve,ft]})}(T,a.layers,h)}catch(m){console.warn("Unable to compute style diff:",m),h=[{command:"setStyle",args:[a]}]}return h},c.bL=function(d){const a=[],h=d.id;return h===void 0&&a.push({message:`layers.${h}: missing required property "id"`}),d.render===void 0&&a.push({message:`layers.${h}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&a.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),a},c.bM=tn,c.bN=Je,c.bO=class extends hi{constructor(d,a){super(d,a),this.current=0}set(d){this.current!==d&&(this.current=d,this.gl.uniform1i(this.location,d))}},c.bP=bg,c.bQ=class extends hi{constructor(d,a){super(d,a),this.current=Py}set(d){if(d[12]!==this.current[12]||d[0]!==this.current[0])return this.current=d,void this.gl.uniformMatrix4fv(this.location,!1,d);for(let a=1;a<16;a++)if(d[a]!==this.current[a]){this.current=d,this.gl.uniformMatrix4fv(this.location,!1,d);break}}},c.bR=ao,c.bS=class extends hi{constructor(d,a){super(d,a),this.current=[0,0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]||(this.current=d,this.gl.uniform3f(this.location,d[0],d[1],d[2]))}},c.bT=class extends hi{constructor(d,a){super(d,a),this.current=[0,0]}set(d){d[0]===this.current[0]&&d[1]===this.current[1]||(this.current=d,this.gl.uniform2f(this.location,d[0],d[1]))}},c.bU=ee,c.bV=function(d,a){var h=Math.sin(a),m=Math.cos(a);return d[0]=m,d[1]=h,d[2]=0,d[3]=-h,d[4]=m,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},c.bW=function(d,a,h){var m=a[0],b=a[1],T=a[2];return d[0]=m*h[0]+b*h[3]+T*h[6],d[1]=m*h[1]+b*h[4]+T*h[7],d[2]=m*h[2]+b*h[5]+T*h[8],d},c.bX=function(d,a,h,m,b,T,A){var z=1/(a-h),N=1/(m-b),j=1/(T-A);return d[0]=-2*z,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*N,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*j,d[11]=0,d[12]=(a+h)*z,d[13]=(b+m)*N,d[14]=(A+T)*j,d[15]=1,d},c.bY=class extends hi{constructor(d,a){super(d,a),this.current=new Array}set(d){if(d!=this.current){this.current=d;const a=new Float32Array(4*d.length);for(let h=0;h<d.length;h++)a[4*h]=d[h].r,a[4*h+1]=d[h].g,a[4*h+2]=d[h].b,a[4*h+3]=d[h].a;this.gl.uniform4fv(this.location,a)}}},c.bZ=class extends hi{constructor(d,a){super(d,a),this.current=new Array}set(d){if(d!=this.current){this.current=d;const a=new Float32Array(d);this.gl.uniform1fv(this.location,a)}}},c.b_=class extends g{},c.ba=function(d,a,h){const m=new Float64Array(4);return Ze(m,d,a-90,h),m},c.bb=function(d,a,h,m){var b,T,A,z,N,j=a[0],Y=a[1],te=a[2],he=a[3],pe=h[0],ge=h[1],_e=h[2],De=h[3];return(T=j*pe+Y*ge+te*_e+he*De)<0&&(T=-T,pe=-pe,ge=-ge,_e=-_e,De=-De),1-T>q?(b=Math.acos(T),A=Math.sin(b),z=Math.sin((1-m)*b)/A,N=Math.sin(m*b)/A):(z=1-m,N=m),d[0]=z*j+N*pe,d[1]=z*Y+N*ge,d[2]=z*te+N*_e,d[3]=z*he+N*De,d},c.bc=function(d){const a=new Float64Array(9);var h,m,b,T,A,z,N,j,Y,te,he,pe,ge,_e,De,Ve,ft,tt;te=(b=(m=d)[0])*(N=b+b),he=(T=m[1])*N,ge=(A=m[2])*N,_e=A*(j=T+T),Ve=(z=m[3])*N,ft=z*j,tt=z*(Y=A+A),(h=a)[0]=1-(pe=T*j)-(De=A*Y),h[3]=he-tt,h[6]=ge+ft,h[1]=he+tt,h[4]=1-te-De,h[7]=_e-Ve,h[2]=ge-ft,h[5]=_e+Ve,h[8]=1-te-pe;const de=Gt(-Math.asin(_t(a[2],-1,1)));let ke,it;return Math.hypot(a[5],a[8])<.001?(ke=0,it=-Gt(Math.atan2(a[3],a[4]))):(ke=Gt(a[5]===0&&a[8]===0?0:Math.atan2(a[5],a[8])),it=Gt(a[1]===0&&a[0]===0?0:Math.atan2(a[1],a[0]))),{roll:ke,pitch:de+90,bearing:it}},c.bd=function(d,a){return d.roll==a.roll&&d.pitch==a.pitch&&d.bearing==a.bearing},c.be=yr,c.bf=yo,c.bg=Ml,c.bh=Gi,c.bi=eo,c.bj=ct,c.bk=Ct,c.bl=_r,c.bm=function(d,a,h,m,b){return ct(m,b,_t((d-a)/(h-a),0,1))},c.bn=je,c.bo=function(){return new Float64Array(3)},c.bp=function(d,a,h,m){return d[0]=a[0]+h[0]*m,d[1]=a[1]+h[1]*m,d[2]=a[2]+h[2]*m,d},c.bq=Ze,c.br=function(d,a,h){var m=h[0],b=h[1],T=h[2],A=a[0],z=a[1],N=a[2],j=b*N-T*z,Y=T*A-m*N,te=m*z-b*A,he=b*te-T*Y,pe=T*j-m*te,ge=m*Y-b*j,_e=2*h[3];return Y*=_e,te*=_e,pe*=2,ge*=2,d[0]=A+(j*=_e)+(he*=2),d[1]=z+Y+pe,d[2]=N+te+ge,d},c.bs=function(d,a,h){const m=(b=[d[0],d[1],d[2],a[0],a[1],a[2],h[0],h[1],h[2]])[0]*((Y=b[8])*(A=b[4])-(z=b[5])*(j=b[7]))+b[1]*(-Y*(T=b[3])+z*(N=b[6]))+b[2]*(j*T-A*N);var b,T,A,z,N,j,Y;if(m===0)return null;const te=We([],[a[0],a[1],a[2]],[h[0],h[1],h[2]]),he=We([],[h[0],h[1],h[2]],[d[0],d[1],d[2]]),pe=We([],[d[0],d[1],d[2]],[a[0],a[1],a[2]]),ge=we([],te,-d[3]);return Ce(ge,ge,we([],he,-a[3])),Ce(ge,ge,we([],pe,-h[3])),we(ge,ge,1/m),ge},c.bt=BS,c.bu=function(){return new Float64Array(4)},c.bv=function(d,a,h,m){var b=[],T=[];return b[0]=a[0]-h[0],b[1]=a[1]-h[1],b[2]=a[2]-h[2],T[0]=b[0]*Math.cos(m)-b[1]*Math.sin(m),T[1]=b[0]*Math.sin(m)+b[1]*Math.cos(m),T[2]=b[2],d[0]=T[0]+h[0],d[1]=T[1]+h[1],d[2]=T[2]+h[2],d},c.bw=function(d,a,h,m){var b=[],T=[];return b[0]=a[0]-h[0],b[1]=a[1]-h[1],b[2]=a[2]-h[2],T[0]=b[0],T[1]=b[1]*Math.cos(m)-b[2]*Math.sin(m),T[2]=b[1]*Math.sin(m)+b[2]*Math.cos(m),d[0]=T[0]+h[0],d[1]=T[1]+h[1],d[2]=T[2]+h[2],d},c.bx=function(d,a,h,m){var b=[],T=[];return b[0]=a[0]-h[0],b[1]=a[1]-h[1],b[2]=a[2]-h[2],T[0]=b[2]*Math.sin(m)+b[0]*Math.cos(m),T[1]=b[1],T[2]=b[2]*Math.cos(m)-b[0]*Math.sin(m),d[0]=T[0]+h[0],d[1]=T[1]+h[1],d[2]=T[2]+h[2],d},c.by=function(d,a,h){var m=Math.sin(h),b=Math.cos(h),T=a[0],A=a[1],z=a[2],N=a[3],j=a[8],Y=a[9],te=a[10],he=a[11];return a!==d&&(d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]),d[0]=T*b-j*m,d[1]=A*b-Y*m,d[2]=z*b-te*m,d[3]=N*b-he*m,d[8]=T*m+j*b,d[9]=A*m+Y*b,d[10]=z*m+te*b,d[11]=N*m+he*b,d},c.bz=function(d,a){const h=je(d,360),m=je(a,360),b=m-h,T=m>h?b-360:b+360;return Math.abs(b)<Math.abs(T)?b:T},c.c=Pe,c.c0=class extends E{},c.c1=vd,c.c2=function(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))},c.c3=Fy,c.c4=function(d,a,h){var m=a[0],b=a[1],T=a[2],A=h[3]*m+h[7]*b+h[11]*T+h[15];return d[0]=(h[0]*m+h[4]*b+h[8]*T+h[12])/(A=A||1),d[1]=(h[1]*m+h[5]*b+h[9]*T+h[13])/A,d[2]=(h[2]*m+h[6]*b+h[10]*T+h[14])/A,d},c.c5=class extends Xu{},c.c6=class extends re{},c.c7=function(d,a){return d[0]===a[0]&&d[1]===a[1]&&d[2]===a[2]&&d[3]===a[3]&&d[4]===a[4]&&d[5]===a[5]&&d[6]===a[6]&&d[7]===a[7]&&d[8]===a[8]&&d[9]===a[9]&&d[10]===a[10]&&d[11]===a[11]&&d[12]===a[12]&&d[13]===a[13]&&d[14]===a[14]&&d[15]===a[15]},c.c8=function(d,a){var h=d[0],m=d[1],b=d[2],T=d[3],A=d[4],z=d[5],N=d[6],j=d[7],Y=d[8],te=d[9],he=d[10],pe=d[11],ge=d[12],_e=d[13],De=d[14],Ve=d[15],ft=a[0],tt=a[1],de=a[2],ke=a[3],it=a[4],Rt=a[5],an=a[6],Ft=a[7],jt=a[8],yn=a[9],ln=a[10],bn=a[11],Xt=a[12],Hn=a[13],hr=a[14],lr=a[15];return Math.abs(h-ft)<=q*Math.max(1,Math.abs(h),Math.abs(ft))&&Math.abs(m-tt)<=q*Math.max(1,Math.abs(m),Math.abs(tt))&&Math.abs(b-de)<=q*Math.max(1,Math.abs(b),Math.abs(de))&&Math.abs(T-ke)<=q*Math.max(1,Math.abs(T),Math.abs(ke))&&Math.abs(A-it)<=q*Math.max(1,Math.abs(A),Math.abs(it))&&Math.abs(z-Rt)<=q*Math.max(1,Math.abs(z),Math.abs(Rt))&&Math.abs(N-an)<=q*Math.max(1,Math.abs(N),Math.abs(an))&&Math.abs(j-Ft)<=q*Math.max(1,Math.abs(j),Math.abs(Ft))&&Math.abs(Y-jt)<=q*Math.max(1,Math.abs(Y),Math.abs(jt))&&Math.abs(te-yn)<=q*Math.max(1,Math.abs(te),Math.abs(yn))&&Math.abs(he-ln)<=q*Math.max(1,Math.abs(he),Math.abs(ln))&&Math.abs(pe-bn)<=q*Math.max(1,Math.abs(pe),Math.abs(bn))&&Math.abs(ge-Xt)<=q*Math.max(1,Math.abs(ge),Math.abs(Xt))&&Math.abs(_e-Hn)<=q*Math.max(1,Math.abs(_e),Math.abs(Hn))&&Math.abs(De-hr)<=q*Math.max(1,Math.abs(De),Math.abs(hr))&&Math.abs(Ve-lr)<=q*Math.max(1,Math.abs(Ve),Math.abs(lr))},c.c9=function(d,a){return d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=a[3],d[4]=a[4],d[5]=a[5],d[6]=a[6],d[7]=a[7],d[8]=a[8],d[9]=a[9],d[10]=a[10],d[11]=a[11],d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15],d},c.cA=function(d){delete ae.REGISTERED_PROTOCOLS[d]},c.cB=function(d,a){const h={};for(let b=0;b<d.length;b++){const T=a&&a[d[b].id]||nd(d[b]);a&&(a[d[b].id]=T);let A=h[T];A||(A=h[T]=[]),A.push(d[b])}const m=[];for(const b in h)m.push(h[b]);return m},c.cC=zn,c.cD=qI,c.cE=ZI,c.cF=cm,c.cG=function(d){d.bucket.createArrays(),d.bucket.tilePixelRatio=Qe/(512*d.bucket.overscaling),d.bucket.compareText={},d.bucket.iconsNeedLinear=!1;const a=d.bucket.layers[0],h=a.layout,m=a._unevaluatedLayout._values,b={layoutIconSize:m["icon-size"].possiblyEvaluate(new si(d.bucket.zoom+1),d.canonical),layoutTextSize:m["text-size"].possiblyEvaluate(new si(d.bucket.zoom+1),d.canonical),textMaxSize:m["text-size"].possiblyEvaluate(new si(18))};if(d.bucket.textSizeData.kind==="composite"){const{minZoom:j,maxZoom:Y}=d.bucket.textSizeData;b.compositeTextSizes=[m["text-size"].possiblyEvaluate(new si(j),d.canonical),m["text-size"].possiblyEvaluate(new si(Y),d.canonical)]}if(d.bucket.iconSizeData.kind==="composite"){const{minZoom:j,maxZoom:Y}=d.bucket.iconSizeData;b.compositeIconSizes=[m["icon-size"].possiblyEvaluate(new si(j),d.canonical),m["icon-size"].possiblyEvaluate(new si(Y),d.canonical)]}const T=h.get("text-line-height")*to,A=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",z=h.get("text-keep-upright"),N=h.get("text-size");for(const j of d.bucket.features){const Y=h.get("text-font").evaluate(j,{},d.canonical).join(","),te=N.evaluate(j,{},d.canonical),he=b.layoutTextSize.evaluate(j,{},d.canonical),pe=b.layoutIconSize.evaluate(j,{},d.canonical),ge={horizontal:{},vertical:void 0},_e=j.text;let De,Ve=[0,0];if(_e){const de=_e.toString(),ke=h.get("text-letter-spacing").evaluate(j,{},d.canonical)*to,it=Mi(de)?ke:0,Rt=h.get("text-anchor").evaluate(j,{},d.canonical),an=sR(a,j,d.canonical);if(!an){const ln=h.get("text-radial-offset").evaluate(j,{},d.canonical);Ve=ln?oR(Rt,[ln*to,VS]):h.get("text-offset").evaluate(j,{},d.canonical).map(bn=>bn*to)}let Ft=A?"center":h.get("text-justify").evaluate(j,{},d.canonical);const jt=h.get("symbol-placement")==="point"?h.get("text-max-width").evaluate(j,{},d.canonical)*to:1/0,yn=()=>{d.bucket.allowVerticalPlacement&&is(de)&&(ge.vertical=um(_e,d.glyphMap,d.glyphPositions,d.imagePositions,Y,jt,T,Rt,"left",it,Ve,c.an.vertical,!0,he,te))};if(!A&&an){const ln=new Set;if(Ft==="auto")for(let Xt=0;Xt<an.values.length;Xt+=2)ln.add(jS(an.values[Xt]));else ln.add(Ft);let bn=!1;for(const Xt of ln)if(!ge.horizontal[Xt])if(bn)ge.horizontal[Xt]=ge.horizontal[0];else{const Hn=um(_e,d.glyphMap,d.glyphPositions,d.imagePositions,Y,jt,T,"center",Xt,it,Ve,c.an.horizontal,!1,he,te);Hn&&(ge.horizontal[Xt]=Hn,bn=Hn.positionedLines.length===1)}yn()}else{Ft==="auto"&&(Ft=jS(Rt));const ln=um(_e,d.glyphMap,d.glyphPositions,d.imagePositions,Y,jt,T,Rt,Ft,it,Ve,c.an.horizontal,!1,he,te);ln&&(ge.horizontal[Ft]=ln),yn(),is(de)&&A&&z&&(ge.vertical=um(_e,d.glyphMap,d.glyphPositions,d.imagePositions,Y,jt,T,Rt,Ft,it,Ve,c.an.vertical,!1,he,te))}}let ft=!1;if(j.icon&&j.icon.name){const de=d.imageMap[j.icon.name];de&&(De=wn(d.imagePositions[j.icon.name],h.get("icon-offset").evaluate(j,{},d.canonical),h.get("icon-anchor").evaluate(j,{},d.canonical)),ft=!!de.sdf,d.bucket.sdfIcons===void 0?d.bucket.sdfIcons=ft:d.bucket.sdfIcons!==ft&&fn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(de.pixelRatio!==d.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(d.bucket.iconsNeedLinear=!0))}const tt=lR(ge.horizontal)||ge.vertical;d.bucket.iconsInText=!!tt&&tt.iconsInText,(tt||De)&&K8(d.bucket,j,ge,De,d.imageMap,b,he,pe,Ve,ft,d.canonical,d.subdivisionGranularity)}d.showCollisionBoxes&&d.bucket.generateCollisionDebugBuffers()},c.cH=Ui,c.cI=nm,c.cJ=om,c.cK=Sd,c.cL=Lf,c.cM=class{constructor(d){this._marks={start:[d.url,"start"].join("#"),end:[d.url,"end"].join("#"),measure:d.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let d=performance.getEntriesByName(this._marks.measure);return d.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),d=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),d}},c.cN=function(d,a,h,m,b){return s(this,void 0,void 0,function*(){if(H())try{return yield yt(d,a,h,m,b)}catch{}return function(T,A,z,N,j){const Y=T.width,te=T.height;Nt&&Ht||(Nt=new OffscreenCanvas(Y,te),Ht=Nt.getContext("2d",{willReadFrequently:!0})),Nt.width=Y,Nt.height=te,Ht.drawImage(T,0,0,Y,te);const he=Ht.getImageData(A,z,N,j);return Ht.clearRect(0,0,Y,te),he.data}(d,a,h,m,b)})},c.cO=yd,c.cP=p,c.cQ=w,c.cR=zg,c.cS=Jy,c.cT=Hc,c.cU=fc,c.ca=d=>d.type==="symbol",c.cb=d=>d.type==="circle",c.cc=d=>d.type==="heatmap",c.cd=d=>d.type==="line",c.ce=d=>d.type==="fill",c.cf=d=>d.type==="fill-extrusion",c.cg=d=>d.type==="hillshade",c.ch=d=>d.type==="color-relief",c.ci=d=>d.type==="raster",c.cj=d=>d.type==="background",c.ck=d=>d.type==="custom",c.cl=ut,c.cm=function(d,a,h){const m=Re(a.x-h.x,a.y-h.y),b=Re(d.x-h.x,d.y-h.y);var T,A;return Gt(Math.atan2(m[0]*b[1]-m[1]*b[0],(T=m)[0]*(A=b)[0]+T[1]*A[1]))},c.cn=lt,c.co=function(d,a){return Nn[a]&&(d instanceof MouseEvent||d instanceof WheelEvent)},c.cp=function(d,a){return Zt[a]&&"touches"in d},c.cq=function(d){return Zt[d]||Nn[d]},c.cr=function(d,a,h){var m=a[0],b=a[1];return d[0]=h[0]*m+h[4]*b+h[12],d[1]=h[1]*m+h[5]*b+h[13],d},c.cs=function(d,a){const{x:h,y:m}=t0.fromLngLat(a);return!(d<0||d>25||m<0||m>=1||h<0||h>=1)},c.ct=function(d,a){return d[0]=a[0],d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=a[1],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=a[2],d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d},c.cu=class extends ss{},c.cv=Q8,c.cx=function(d){return d.message===Yt},c.cy=fe,c.cz=function(d,a){ae.REGISTERED_PROTOCOLS[d]=a},c.d=ye,c.e=cn,c.f=d=>s(void 0,void 0,void 0,function*(){if(d.byteLength===0)return createImageBitmap(new ImageData(1,1));const a=new Blob([new Uint8Array(d)],{type:"image/png"});try{return createImageBitmap(a)}catch(h){throw new Error(`Could not load image because of ${h.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),c.g=ue,c.h=d=>new Promise((a,h)=>{const m=new Image;m.onload=()=>{a(m),URL.revokeObjectURL(m.src),m.onload=null,window.requestAnimationFrame(()=>{m.src=Se})},m.onerror=()=>h(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const b=new Blob([new Uint8Array(d)],{type:"image/png"});m.src=d.byteLength?URL.createObjectURL(b):Se}),c.i=On,c.j=(d,a)=>Ke(cn(d,{type:"json"}),a),c.k=He,c.l=$e,c.m=Ke,c.n=(d,a)=>Ke(cn(d,{type:"arrayBuffer"}),a),c.o=function(d){return new Lf(d).readFields(Xx,[])},c.p=e0,c.q=gd,c.r=vi,c.s=Ot,c.t=_f,c.u=dr,c.v=qe,c.w=fn,c.x=uc,c.y=hc,c.z=Uu}),i("worker",["./shared"],function(c){class s{constructor(ae){this.keyCache={},ae&&this.replace(ae)}replace(ae){this._layerConfigs={},this._layers={},this.update(ae,[])}update(ae,ue){for(const fe of ae){this._layerConfigs[fe.id]=fe;const Oe=this._layers[fe.id]=c.bI(fe);Oe._featureFilter=c.a9(Oe.filter),this.keyCache[fe.id]&&delete this.keyCache[fe.id]}for(const fe of ue)delete this.keyCache[fe],delete this._layerConfigs[fe],delete this._layers[fe];this.familiesBySource={};const ne=c.cB(Object.values(this._layerConfigs),this.keyCache);for(const fe of ne){const Oe=fe.map(He=>this._layers[He.id]),Ke=Oe[0];if(Ke.visibility==="none")continue;const ye=Ke.source||"";let Ae=this.familiesBySource[ye];Ae||(Ae=this.familiesBySource[ye]={});const Be=Ke.sourceLayer||"_geojsonTileLayer";let $e=Ae[Be];$e||($e=Ae[Be]=[]),$e.push(Oe)}}}class p{constructor(ae){const ue={},ne=[];for(const ye in ae){const Ae=ae[ye],Be=ue[ye]={};for(const $e in Ae){const He=Ae[+$e];if(!He||He.bitmap.width===0||He.bitmap.height===0)continue;const dt={x:0,y:0,w:He.bitmap.width+2,h:He.bitmap.height+2};ne.push(dt),Be[$e]={rect:dt,metrics:He.metrics}}}const{w:fe,h:Oe}=c.p(ne),Ke=new c.q({width:fe||1,height:Oe||1});for(const ye in ae){const Ae=ae[ye];for(const Be in Ae){const $e=Ae[+Be];if(!$e||$e.bitmap.width===0||$e.bitmap.height===0)continue;const He=ue[ye][Be].rect;c.q.copy($e.bitmap,Ke,{x:0,y:0},{x:He.x+1,y:He.y+1},$e.bitmap)}}this.image=Ke,this.positions=ue}}c.cC("GlyphAtlas",p);class y{constructor(ae){this.tileID=new c.Z(ae.tileID.overscaledZ,ae.tileID.wrap,ae.tileID.canonical.z,ae.tileID.canonical.x,ae.tileID.canonical.y),this.uid=ae.uid,this.zoom=ae.zoom,this.pixelRatio=ae.pixelRatio,this.tileSize=ae.tileSize,this.source=ae.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ae.showCollisionBoxes,this.collectResourceTiming=!!ae.collectResourceTiming,this.returnDependencies=!!ae.returnDependencies,this.promoteId=ae.promoteId,this.inFlightDependencies=[],this.globalState=ae.globalState}parse(ae,ue,ne,fe,Oe){return c._(this,void 0,void 0,function*(){this.status="parsing",this.data=ae,this.collisionBoxArray=new c.a7;const Ke=new c.cD(Object.keys(ae.layers).sort()),ye=new c.cE(this.tileID,this.promoteId);ye.bucketLayerIDs=[];const Ae={},Be={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ne,subdivisionGranularity:Oe},$e=ue.familiesBySource[this.source];for(const on in $e){const sn=ae.layers[on];if(!sn)continue;sn.version===1&&c.w(`Vector tile source "${this.source}" layer "${on}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Dn=Ke.encode(on),Et=[];for(let Gn=0;Gn<sn.length;Gn++){const Fn=sn.feature(Gn),or=ye.getId(Fn,on);Et.push({feature:Fn,id:or,index:Gn,sourceLayerIndex:Dn})}for(const Gn of $e[on]){const Fn=Gn[0];Fn.source!==this.source&&c.w(`layer.source = ${Fn.source} does not equal this.source = ${this.source}`),Fn.minzoom&&this.zoom<Math.floor(Fn.minzoom)||Fn.maxzoom&&this.zoom>=Fn.maxzoom||Fn.visibility!=="none"&&(_(Gn,this.zoom,ne),(Ae[Fn.id]=Fn.createBucket({index:ye.bucketLayerIDs.length,layers:Gn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Dn,sourceID:this.source,globalState:this.globalState})).populate(Et,Be,this.tileID.canonical),ye.bucketLayerIDs.push(Gn.map(or=>or.id)))}}const He=c.bM(Be.glyphDependencies,on=>Object.keys(on).map(Number));this.inFlightDependencies.forEach(on=>on?.abort()),this.inFlightDependencies=[];let dt=Promise.resolve({});if(Object.keys(He).length){const on=new AbortController;this.inFlightDependencies.push(on),dt=fe.sendAsync({type:"GG",data:{stacks:He,source:this.source,tileID:this.tileID,type:"glyphs"}},on)}const qe=Object.keys(Be.iconDependencies);let $t=Promise.resolve({});if(qe.length){const on=new AbortController;this.inFlightDependencies.push(on),$t=fe.sendAsync({type:"GI",data:{icons:qe,source:this.source,tileID:this.tileID,type:"icons"}},on)}const Jt=Object.keys(Be.patternDependencies);let Ie=Promise.resolve({});if(Jt.length){const on=new AbortController;this.inFlightDependencies.push(on),Ie=fe.sendAsync({type:"GI",data:{icons:Jt,source:this.source,tileID:this.tileID,type:"patterns"}},on)}const[ot,mt,Wt]=yield Promise.all([dt,$t,Ie]),nn=new p(ot),mn=new c.cF(mt,Wt);for(const on in Ae){const sn=Ae[on];sn instanceof c.a8?(_(sn.layers,this.zoom,ne),c.cG({bucket:sn,glyphMap:ot,glyphPositions:nn.positions,imageMap:mt,imagePositions:mn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Be.subdivisionGranularity})):sn.hasPattern&&(sn instanceof c.cH||sn instanceof c.cI||sn instanceof c.cJ)&&(_(sn.layers,this.zoom,ne),sn.addFeatures(Be,this.tileID.canonical,mn.patternPositions))}return this.status="done",{buckets:Object.values(Ae).filter(on=>!on.isEmpty()),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:nn.image,imageAtlas:mn,glyphMap:this.returnDependencies?ot:null,iconMap:this.returnDependencies?mt:null,glyphPositions:this.returnDependencies?nn.positions:null}})}}function _(Pe,ae,ue){const ne=new c.F(ae);for(const fe of Pe)fe.recalculate(ne,ue)}class w{constructor(ae,ue,ne){this.actor=ae,this.layerIndex=ue,this.availableImages=ne,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ae,ue){return c._(this,void 0,void 0,function*(){const ne=yield c.n(ae.request,ue);try{return{vectorTile:new c.cK.VectorTile(new c.cL(ne.data)),rawData:ne.data,cacheControl:ne.cacheControl,expires:ne.expires}}catch(fe){const Oe=new Uint8Array(ne.data);let Ke=`Unable to parse the tile at ${ae.request.url}, `;throw Ke+=Oe[0]===31&&Oe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${fe.message}`,new Error(Ke)}})}loadTile(ae){return c._(this,void 0,void 0,function*(){const ue=ae.uid,ne=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new c.cM(ae.request),fe=new y(ae);this.loading[ue]=fe;const Oe=new AbortController;fe.abort=Oe;try{const Ke=yield this.loadVectorTile(ae,Oe);if(delete this.loading[ue],!Ke)return null;const ye=Ke.rawData,Ae={};Ke.expires&&(Ae.expires=Ke.expires),Ke.cacheControl&&(Ae.cacheControl=Ke.cacheControl);const Be={};if(ne){const He=ne.finish();He&&(Be.resourceTiming=JSON.parse(JSON.stringify(He)))}fe.vectorTile=Ke.vectorTile;const $e=fe.parse(Ke.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity);this.loaded[ue]=fe,this.fetching[ue]={rawTileData:ye,cacheControl:Ae,resourceTiming:Be};try{const He=yield $e;return c.e({rawTileData:ye.slice(0)},He,Ae,Be)}finally{delete this.fetching[ue]}}catch(Ke){throw delete this.loading[ue],fe.status="done",this.loaded[ue]=fe,Ke}})}reloadTile(ae){return c._(this,void 0,void 0,function*(){const ue=ae.uid;if(!this.loaded||!this.loaded[ue])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ne=this.loaded[ue];if(ne.showCollisionBoxes=ae.showCollisionBoxes,ne.globalState=ae.globalState,ne.status==="parsing"){const fe=yield ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity);let Oe;if(this.fetching[ue]){const{rawTileData:Ke,cacheControl:ye,resourceTiming:Ae}=this.fetching[ue];delete this.fetching[ue],Oe=c.e({rawTileData:Ke.slice(0)},fe,ye,Ae)}else Oe=fe;return Oe}if(ne.status==="done"&&ne.vectorTile)return ne.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,ae.subdivisionGranularity)})}abortTile(ae){return c._(this,void 0,void 0,function*(){const ue=this.loading,ne=ae.uid;ue&&ue[ne]&&ue[ne].abort&&(ue[ne].abort.abort(),delete ue[ne])})}removeTile(ae){return c._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ae.uid]&&delete this.loaded[ae.uid]})}}class S{constructor(){this.loaded={}}loadTile(ae){return c._(this,void 0,void 0,function*(){const{uid:ue,encoding:ne,rawImageData:fe,redFactor:Oe,greenFactor:Ke,blueFactor:ye,baseShift:Ae}=ae,Be=fe.width+2,$e=fe.height+2,He=c.b(fe)?new c.R({width:Be,height:$e},yield c.cN(fe,-1,-1,Be,$e)):fe,dt=new c.cO(ue,He,ne,Oe,Ke,ye,Ae);return this.loaded=this.loaded||{},this.loaded[ue]=dt,dt})}removeTile(ae){const ue=this.loaded,ne=ae.uid;ue&&ue[ne]&&delete ue[ne]}}var M,I,D=function(){if(I)return M;function Pe(ue,ne){if(ue.length!==0){ae(ue[0],ne);for(var fe=1;fe<ue.length;fe++)ae(ue[fe],!ne)}}function ae(ue,ne){for(var fe=0,Oe=0,Ke=0,ye=ue.length,Ae=ye-1;Ke<ye;Ae=Ke++){var Be=(ue[Ke][0]-ue[Ae][0])*(ue[Ae][1]+ue[Ke][1]),$e=fe+Be;Oe+=Math.abs(fe)>=Math.abs(Be)?fe-$e+Be:Be-$e+fe,fe=$e}fe+Oe>=0!=!!ne&&ue.reverse()}return I=1,M=function ue(ne,fe){var Oe,Ke=ne&&ne.type;if(Ke==="FeatureCollection")for(Oe=0;Oe<ne.features.length;Oe++)ue(ne.features[Oe],fe);else if(Ke==="GeometryCollection")for(Oe=0;Oe<ne.geometries.length;Oe++)ue(ne.geometries[Oe],fe);else if(Ke==="Feature")ue(ne.geometry,fe);else if(Ke==="Polygon")Pe(ne.coordinates,fe);else if(Ke==="MultiPolygon")for(Oe=0;Oe<ne.coordinates.length;Oe++)Pe(ne.coordinates[Oe],fe);return ne}}(),R=c.cP(D);const L=c.cK.VectorTileFeature.prototype.toGeoJSON;class V{constructor(ae){this._feature=ae,this.extent=c.$,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const ue of this._feature.geometry)ae.push([new c.P(ue[0],ue[1])]);return ae}{const ae=[];for(const ue of this._feature.geometry){const ne=[];for(const fe of ue)ne.push(new c.P(fe[0],fe[1]));ae.push(ne)}return ae}}toGeoJSON(ae,ue,ne){return L.call(this,ae,ue,ne)}}class B{constructor(ae){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.$,this.length=ae.length,this._features=ae}feature(ae){return new V(this._features[ae])}}var H,q,X,ee={exports:{}},se=function(){if(X)return ee.exports;X=1;var Pe=c.cS(),ae=function(){if(q)return H;q=1;var $e=c.cQ(),He=c.cR().VectorTileFeature;function dt($t,Jt){this.options=Jt||{},this.features=$t,this.length=$t.length}function qe($t,Jt){this.id=typeof $t.id=="number"?$t.id:void 0,this.type=$t.type,this.rawGeometry=$t.type===1?[$t.geometry]:$t.geometry,this.properties=$t.tags,this.extent=Jt||4096}return H=dt,dt.prototype.feature=function($t){return new qe(this.features[$t],this.options.extent)},qe.prototype.loadGeometry=function(){var $t=this.rawGeometry;this.geometry=[];for(var Jt=0;Jt<$t.length;Jt++){for(var Ie=$t[Jt],ot=[],mt=0;mt<Ie.length;mt++)ot.push(new $e(Ie[mt][0],Ie[mt][1]));this.geometry.push(ot)}return this.geometry},qe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $t=this.geometry,Jt=1/0,Ie=-1/0,ot=1/0,mt=-1/0,Wt=0;Wt<$t.length;Wt++)for(var nn=$t[Wt],mn=0;mn<nn.length;mn++){var on=nn[mn];Jt=Math.min(Jt,on.x),Ie=Math.max(Ie,on.x),ot=Math.min(ot,on.y),mt=Math.max(mt,on.y)}return[Jt,ot,Ie,mt]},qe.prototype.toGeoJSON=He.prototype.toGeoJSON,H}();function ue($e){var He=new Pe;return function(dt,qe){for(var $t in dt.layers)qe.writeMessage(3,ne,dt.layers[$t])}($e,He),He.finish()}function ne($e,He){var dt;He.writeVarintField(15,$e.version||1),He.writeStringField(1,$e.name||""),He.writeVarintField(5,$e.extent||4096);var qe={keys:[],values:[],keycache:{},valuecache:{}};for(dt=0;dt<$e.length;dt++)qe.feature=$e.feature(dt),He.writeMessage(2,fe,qe);var $t=qe.keys;for(dt=0;dt<$t.length;dt++)He.writeStringField(3,$t[dt]);var Jt=qe.values;for(dt=0;dt<Jt.length;dt++)He.writeMessage(4,Be,Jt[dt])}function fe($e,He){var dt=$e.feature;dt.id!==void 0&&He.writeVarintField(1,dt.id),He.writeMessage(2,Oe,$e),He.writeVarintField(3,dt.type),He.writeMessage(4,Ae,dt)}function Oe($e,He){var dt=$e.feature,qe=$e.keys,$t=$e.values,Jt=$e.keycache,Ie=$e.valuecache;for(var ot in dt.properties){var mt=dt.properties[ot],Wt=Jt[ot];if(mt!==null){Wt===void 0&&(qe.push(ot),Jt[ot]=Wt=qe.length-1),He.writeVarint(Wt);var nn=typeof mt;nn!=="string"&&nn!=="boolean"&&nn!=="number"&&(mt=JSON.stringify(mt));var mn=nn+":"+mt,on=Ie[mn];on===void 0&&($t.push(mt),Ie[mn]=on=$t.length-1),He.writeVarint(on)}}}function Ke($e,He){return(He<<3)+(7&$e)}function ye($e){return $e<<1^$e>>31}function Ae($e,He){for(var dt=$e.loadGeometry(),qe=$e.type,$t=0,Jt=0,Ie=dt.length,ot=0;ot<Ie;ot++){var mt=dt[ot],Wt=1;qe===1&&(Wt=mt.length),He.writeVarint(Ke(1,Wt));for(var nn=qe===3?mt.length-1:mt.length,mn=0;mn<nn;mn++){mn===1&&qe!==1&&He.writeVarint(Ke(2,nn-1));var on=mt[mn].x-$t,sn=mt[mn].y-Jt;He.writeVarint(ye(on)),He.writeVarint(ye(sn)),$t+=on,Jt+=sn}qe===3&&He.writeVarint(Ke(7,1))}}function Be($e,He){var dt=typeof $e;dt==="string"?He.writeStringField(1,$e):dt==="boolean"?He.writeBooleanField(7,$e):dt==="number"&&($e%1!=0?He.writeDoubleField(3,$e):$e<0?He.writeSVarintField(6,$e):He.writeVarintField(5,$e))}return ee.exports=ue,ee.exports.fromVectorTileJs=ue,ee.exports.fromGeojsonVt=function($e,He){He=He||{};var dt={};for(var qe in $e)dt[qe]=new ae($e[qe].features,He),dt[qe].name=qe,dt[qe].version=He.version,dt[qe].extent=He.extent;return ue({layers:dt})},ee.exports.GeoJSONWrapper=ae,ee.exports}(),J=c.cP(se);const $={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Pe=>Pe},le=Math.fround||(Ce=new Float32Array(1),Pe=>(Ce[0]=+Pe,Ce[0]));var Ce;class we{constructor(ae){this.options=Object.assign(Object.create($),ae),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ae){const{log:ue,minZoom:ne,maxZoom:fe}=this.options;ue&&console.time("total time");const Oe=`prepare ${ae.length} points`;ue&&console.time(Oe),this.points=ae;const Ke=[];for(let Ae=0;Ae<ae.length;Ae++){const Be=ae[Ae];if(!Be.geometry)continue;const[$e,He]=Be.geometry.coordinates,dt=le(Me($e)),qe=le(Ee(He));Ke.push(dt,qe,1/0,Ae,-1,1),this.options.reduce&&Ke.push(0)}let ye=this.trees[fe+1]=this._createTree(Ke);ue&&console.timeEnd(Oe);for(let Ae=fe;Ae>=ne;Ae--){const Be=+Date.now();ye=this.trees[Ae]=this._createTree(this._cluster(ye,Ae)),ue&&console.log("z%d: %d clusters in %dms",Ae,ye.numItems,+Date.now()-Be)}return ue&&console.timeEnd("total time"),this}getClusters(ae,ue){let ne=((ae[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,ae[1]));let Oe=ae[2]===180?180:((ae[2]+180)%360+360)%360-180;const Ke=Math.max(-90,Math.min(90,ae[3]));if(ae[2]-ae[0]>=360)ne=-180,Oe=180;else if(ne>Oe){const He=this.getClusters([ne,fe,180,Ke],ue),dt=this.getClusters([-180,fe,Oe,Ke],ue);return He.concat(dt)}const ye=this.trees[this._limitZoom(ue)],Ae=ye.range(Me(ne),Ee(Ke),Me(Oe),Ee(fe)),Be=ye.data,$e=[];for(const He of Ae){const dt=this.stride*He;$e.push(Be[dt+5]>1?We(Be,dt,this.clusterProps):this.points[Be[dt+3]])}return $e}getChildren(ae){const ue=this._getOriginId(ae),ne=this._getOriginZoom(ae),fe="No cluster with the specified id.",Oe=this.trees[ne];if(!Oe)throw new Error(fe);const Ke=Oe.data;if(ue*this.stride>=Ke.length)throw new Error(fe);const ye=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),Ae=Oe.within(Ke[ue*this.stride],Ke[ue*this.stride+1],ye),Be=[];for(const $e of Ae){const He=$e*this.stride;Ke[He+4]===ae&&Be.push(Ke[He+5]>1?We(Ke,He,this.clusterProps):this.points[Ke[He+3]])}if(Be.length===0)throw new Error(fe);return Be}getLeaves(ae,ue,ne){const fe=[];return this._appendLeaves(fe,ae,ue=ue||10,ne=ne||0,0),fe}getTile(ae,ue,ne){const fe=this.trees[this._limitZoom(ae)],Oe=Math.pow(2,ae),{extent:Ke,radius:ye}=this.options,Ae=ye/Ke,Be=(ne-Ae)/Oe,$e=(ne+1+Ae)/Oe,He={features:[]};return this._addTileFeatures(fe.range((ue-Ae)/Oe,Be,(ue+1+Ae)/Oe,$e),fe.data,ue,ne,Oe,He),ue===0&&this._addTileFeatures(fe.range(1-Ae/Oe,Be,1,$e),fe.data,Oe,ne,Oe,He),ue===Oe-1&&this._addTileFeatures(fe.range(0,Be,Ae/Oe,$e),fe.data,-1,ne,Oe,He),He.features.length?He:null}getClusterExpansionZoom(ae){let ue=this._getOriginZoom(ae)-1;for(;ue<=this.options.maxZoom;){const ne=this.getChildren(ae);if(ue++,ne.length!==1)break;ae=ne[0].properties.cluster_id}return ue}_appendLeaves(ae,ue,ne,fe,Oe){const Ke=this.getChildren(ue);for(const ye of Ke){const Ae=ye.properties;if(Ae&&Ae.cluster?Oe+Ae.point_count<=fe?Oe+=Ae.point_count:Oe=this._appendLeaves(ae,Ae.cluster_id,ne,fe,Oe):Oe<fe?Oe++:ae.push(ye),ae.length===ne)break}return Oe}_createTree(ae){const ue=new c.aH(ae.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ne=0;ne<ae.length;ne+=this.stride)ue.add(ae[ne],ae[ne+1]);return ue.finish(),ue.data=ae,ue}_addTileFeatures(ae,ue,ne,fe,Oe,Ke){for(const ye of ae){const Ae=ye*this.stride,Be=ue[Ae+5]>1;let $e,He,dt;if(Be)$e=Fe(ue,Ae,this.clusterProps),He=ue[Ae],dt=ue[Ae+1];else{const Jt=this.points[ue[Ae+3]];$e=Jt.properties;const[Ie,ot]=Jt.geometry.coordinates;He=Me(Ie),dt=Ee(ot)}const qe={type:1,geometry:[[Math.round(this.options.extent*(He*Oe-ne)),Math.round(this.options.extent*(dt*Oe-fe))]],tags:$e};let $t;$t=Be||this.options.generateId?ue[Ae+3]:this.points[ue[Ae+3]].id,$t!==void 0&&(qe.id=$t),Ke.features.push(qe)}}_limitZoom(ae){return Math.max(this.options.minZoom,Math.min(Math.floor(+ae),this.options.maxZoom+1))}_cluster(ae,ue){const{radius:ne,extent:fe,reduce:Oe,minPoints:Ke}=this.options,ye=ne/(fe*Math.pow(2,ue)),Ae=ae.data,Be=[],$e=this.stride;for(let He=0;He<Ae.length;He+=$e){if(Ae[He+2]<=ue)continue;Ae[He+2]=ue;const dt=Ae[He],qe=Ae[He+1],$t=ae.within(Ae[He],Ae[He+1],ye),Jt=Ae[He+5];let Ie=Jt;for(const ot of $t){const mt=ot*$e;Ae[mt+2]>ue&&(Ie+=Ae[mt+5])}if(Ie>Jt&&Ie>=Ke){let ot,mt=dt*Jt,Wt=qe*Jt,nn=-1;const mn=(He/$e<<5)+(ue+1)+this.points.length;for(const on of $t){const sn=on*$e;if(Ae[sn+2]<=ue)continue;Ae[sn+2]=ue;const Dn=Ae[sn+5];mt+=Ae[sn]*Dn,Wt+=Ae[sn+1]*Dn,Ae[sn+4]=mn,Oe&&(ot||(ot=this._map(Ae,He,!0),nn=this.clusterProps.length,this.clusterProps.push(ot)),Oe(ot,this._map(Ae,sn)))}Ae[He+4]=mn,Be.push(mt/Ie,Wt/Ie,1/0,mn,-1,Ie),Oe&&Be.push(nn)}else{for(let ot=0;ot<$e;ot++)Be.push(Ae[He+ot]);if(Ie>1)for(const ot of $t){const mt=ot*$e;if(!(Ae[mt+2]<=ue)){Ae[mt+2]=ue;for(let Wt=0;Wt<$e;Wt++)Be.push(Ae[mt+Wt])}}}}return Be}_getOriginId(ae){return ae-this.points.length>>5}_getOriginZoom(ae){return(ae-this.points.length)%32}_map(ae,ue,ne){if(ae[ue+5]>1){const Ke=this.clusterProps[ae[ue+6]];return ne?Object.assign({},Ke):Ke}const fe=this.points[ae[ue+3]].properties,Oe=this.options.map(fe);return ne&&Oe===fe?Object.assign({},Oe):Oe}}function We(Pe,ae,ue){return{type:"Feature",id:Pe[ae+3],properties:Fe(Pe,ae,ue),geometry:{type:"Point",coordinates:[(ne=Pe[ae],360*(ne-.5)),Te(Pe[ae+1])]}};var ne}function Fe(Pe,ae,ue){const ne=Pe[ae+5],fe=ne>=1e4?`${Math.round(ne/1e3)}k`:ne>=1e3?Math.round(ne/100)/10+"k":ne,Oe=Pe[ae+6],Ke=Oe===-1?{}:Object.assign({},ue[Oe]);return Object.assign(Ke,{cluster:!0,cluster_id:Pe[ae+3],point_count:ne,point_count_abbreviated:fe})}function Me(Pe){return Pe/360+.5}function Ee(Pe){const ae=Math.sin(Pe*Math.PI/180),ue=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return ue<0?0:ue>1?1:ue}function Te(Pe){const ae=(180-360*Pe)*Math.PI/180;return 360*Math.atan(Math.exp(ae))/Math.PI-90}function Ze(Pe,ae,ue,ne){let fe=ne;const Oe=ae+(ue-ae>>1);let Ke,ye=ue-ae;const Ae=Pe[ae],Be=Pe[ae+1],$e=Pe[ue],He=Pe[ue+1];for(let dt=ae+3;dt<ue;dt+=3){const qe=rt(Pe[dt],Pe[dt+1],Ae,Be,$e,He);if(qe>fe)Ke=dt,fe=qe;else if(qe===fe){const $t=Math.abs(dt-Oe);$t<ye&&(Ke=dt,ye=$t)}}fe>ne&&(Ke-ae>3&&Ze(Pe,ae,Ke,ne),Pe[Ke+2]=fe,ue-Ke>3&&Ze(Pe,Ke,ue,ne))}function rt(Pe,ae,ue,ne,fe,Oe){let Ke=fe-ue,ye=Oe-ne;if(Ke!==0||ye!==0){const Ae=((Pe-ue)*Ke+(ae-ne)*ye)/(Ke*Ke+ye*ye);Ae>1?(ue=fe,ne=Oe):Ae>0&&(ue+=Ke*Ae,ne+=ye*Ae)}return Ke=Pe-ue,ye=ae-ne,Ke*Ke+ye*ye}function Re(Pe,ae,ue,ne){const fe={id:Pe??null,type:ae,geometry:ue,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ae==="Point"||ae==="MultiPoint"||ae==="LineString")Qe(fe,ue);else if(ae==="Polygon")Qe(fe,ue[0]);else if(ae==="MultiLineString")for(const Oe of ue)Qe(fe,Oe);else if(ae==="MultiPolygon")for(const Oe of ue)Qe(fe,Oe[0]);return fe}function Qe(Pe,ae){for(let ue=0;ue<ae.length;ue+=3)Pe.minX=Math.min(Pe.minX,ae[ue]),Pe.minY=Math.min(Pe.minY,ae[ue+1]),Pe.maxX=Math.max(Pe.maxX,ae[ue]),Pe.maxY=Math.max(Pe.maxY,ae[ue+1])}function Vt(Pe,ae,ue,ne){if(!ae.geometry)return;const fe=ae.geometry.coordinates;if(fe&&fe.length===0)return;const Oe=ae.geometry.type,Ke=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2);let ye=[],Ae=ae.id;if(ue.promoteId?Ae=ae.properties[ue.promoteId]:ue.generateId&&(Ae=ne||0),Oe==="Point")je(fe,ye);else if(Oe==="MultiPoint")for(const Be of fe)je(Be,ye);else if(Oe==="LineString")ct(fe,ye,Ke,!1);else if(Oe==="MultiLineString"){if(ue.lineMetrics){for(const Be of fe)ye=[],ct(Be,ye,Ke,!1),Pe.push(Re(Ae,"LineString",ye,ae.properties));return}Ct(fe,ye,Ke,!1)}else if(Oe==="Polygon")Ct(fe,ye,Ke,!0);else{if(Oe!=="MultiPolygon"){if(Oe==="GeometryCollection"){for(const Be of ae.geometry.geometries)Vt(Pe,{id:Ae,geometry:Be,properties:ae.properties},ue,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Be of fe){const $e=[];Ct(Be,$e,Ke,!0),ye.push($e)}}Pe.push(Re(Ae,Oe,ye,ae.properties))}function je(Pe,ae){ae.push(ut(Pe[0]),lt(Pe[1]),0)}function ct(Pe,ae,ue,ne){let fe,Oe,Ke=0;for(let Ae=0;Ae<Pe.length;Ae++){const Be=ut(Pe[Ae][0]),$e=lt(Pe[Ae][1]);ae.push(Be,$e,0),Ae>0&&(Ke+=ne?(fe*$e-Be*Oe)/2:Math.sqrt(Math.pow(Be-fe,2)+Math.pow($e-Oe,2))),fe=Be,Oe=$e}const ye=ae.length-3;ae[2]=1,Ze(ae,0,ye,ue),ae[ye+2]=1,ae.size=Math.abs(Ke),ae.start=0,ae.end=ae.size}function Ct(Pe,ae,ue,ne){for(let fe=0;fe<Pe.length;fe++){const Oe=[];ct(Pe[fe],Oe,ue,ne),ae.push(Oe)}}function ut(Pe){return Pe/360+.5}function lt(Pe){const ae=Math.sin(Pe*Math.PI/180),ue=.5-.25*Math.log((1+ae)/(1-ae))/Math.PI;return ue<0?0:ue>1?1:ue}function _t(Pe,ae,ue,ne,fe,Oe,Ke,ye){if(ne/=ae,Oe>=(ue/=ae)&&Ke<ne)return Pe;if(Ke<ue||Oe>=ne)return null;const Ae=[];for(const Be of Pe){const $e=Be.geometry;let He=Be.type;const dt=fe===0?Be.minX:Be.minY,qe=fe===0?Be.maxX:Be.maxY;if(dt>=ue&&qe<ne){Ae.push(Be);continue}if(qe<ue||dt>=ne)continue;let $t=[];if(He==="Point"||He==="MultiPoint")wt($e,$t,ue,ne,fe);else if(He==="LineString")cn($e,$t,ue,ne,fe,!1,ye.lineMetrics);else if(He==="MultiLineString")tn($e,$t,ue,ne,fe,!1);else if(He==="Polygon")tn($e,$t,ue,ne,fe,!0);else if(He==="MultiPolygon")for(const Jt of $e){const Ie=[];tn(Jt,Ie,ue,ne,fe,!0),Ie.length&&$t.push(Ie)}if($t.length){if(ye.lineMetrics&&He==="LineString"){for(const Jt of $t)Ae.push(Re(Be.id,He,Jt,Be.tags));continue}He!=="LineString"&&He!=="MultiLineString"||($t.length===1?(He="LineString",$t=$t[0]):He="MultiLineString"),He!=="Point"&&He!=="MultiPoint"||(He=$t.length===3?"Point":"MultiPoint"),Ae.push(Re(Be.id,He,$t,Be.tags))}}return Ae.length?Ae:null}function wt(Pe,ae,ue,ne,fe){for(let Oe=0;Oe<Pe.length;Oe+=3){const Ke=Pe[Oe+fe];Ke>=ue&&Ke<=ne&&Je(ae,Pe[Oe],Pe[Oe+1],Pe[Oe+2])}}function cn(Pe,ae,ue,ne,fe,Oe,Ke){let ye=dn(Pe);const Ae=fe===0?Tn:Kt;let Be,$e,He=Pe.start;for(let Ie=0;Ie<Pe.length-3;Ie+=3){const ot=Pe[Ie],mt=Pe[Ie+1],Wt=Pe[Ie+2],nn=Pe[Ie+3],mn=Pe[Ie+4],on=fe===0?ot:mt,sn=fe===0?nn:mn;let Dn=!1;Ke&&(Be=Math.sqrt(Math.pow(ot-nn,2)+Math.pow(mt-mn,2))),on<ue?sn>ue&&($e=Ae(ye,ot,mt,nn,mn,ue),Ke&&(ye.start=He+Be*$e)):on>ne?sn<ne&&($e=Ae(ye,ot,mt,nn,mn,ne),Ke&&(ye.start=He+Be*$e)):Je(ye,ot,mt,Wt),sn<ue&&on>=ue&&($e=Ae(ye,ot,mt,nn,mn,ue),Dn=!0),sn>ne&&on<=ne&&($e=Ae(ye,ot,mt,nn,mn,ne),Dn=!0),!Oe&&Dn&&(Ke&&(ye.end=He+Be*$e),ae.push(ye),ye=dn(Pe)),Ke&&(He+=Be)}let dt=Pe.length-3;const qe=Pe[dt],$t=Pe[dt+1],Jt=fe===0?qe:$t;Jt>=ue&&Jt<=ne&&Je(ye,qe,$t,Pe[dt+2]),dt=ye.length-3,Oe&&dt>=3&&(ye[dt]!==ye[0]||ye[dt+1]!==ye[1])&&Je(ye,ye[0],ye[1],ye[2]),ye.length&&ae.push(ye)}function dn(Pe){const ae=[];return ae.size=Pe.size,ae.start=Pe.start,ae.end=Pe.end,ae}function tn(Pe,ae,ue,ne,fe,Oe){for(const Ke of Pe)cn(Ke,ae,ue,ne,fe,Oe,!1)}function Je(Pe,ae,ue,ne){Pe.push(ae,ue,ne)}function Tn(Pe,ae,ue,ne,fe,Oe){const Ke=(Oe-ae)/(ne-ae);return Je(Pe,Oe,ue+(fe-ue)*Ke,1),Ke}function Kt(Pe,ae,ue,ne,fe,Oe){const Ke=(Oe-ue)/(fe-ue);return Je(Pe,ae+(ne-ae)*Ke,Oe,1),Ke}function fn(Pe,ae){const ue=[];for(let ne=0;ne<Pe.length;ne++){const fe=Pe[ne],Oe=fe.type;let Ke;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")Ke=Ut(fe.geometry,ae);else if(Oe==="MultiLineString"||Oe==="Polygon"){Ke=[];for(const ye of fe.geometry)Ke.push(Ut(ye,ae))}else if(Oe==="MultiPolygon"){Ke=[];for(const ye of fe.geometry){const Ae=[];for(const Be of ye)Ae.push(Ut(Be,ae));Ke.push(Ae)}}ue.push(Re(fe.id,Oe,Ke,fe.tags))}return ue}function Ut(Pe,ae){const ue=[];ue.size=Pe.size,Pe.start!==void 0&&(ue.start=Pe.start,ue.end=Pe.end);for(let ne=0;ne<Pe.length;ne+=3)ue.push(Pe[ne]+ae,Pe[ne+1],Pe[ne+2]);return ue}function On(Pe,ae){if(Pe.transformed)return Pe;const ue=1<<Pe.z,ne=Pe.x,fe=Pe.y;for(const Oe of Pe.features){const Ke=Oe.geometry,ye=Oe.type;if(Oe.geometry=[],ye===1)for(let Ae=0;Ae<Ke.length;Ae+=2)Oe.geometry.push(vn(Ke[Ae],Ke[Ae+1],ae,ue,ne,fe));else for(let Ae=0;Ae<Ke.length;Ae++){const Be=[];for(let $e=0;$e<Ke[Ae].length;$e+=2)Be.push(vn(Ke[Ae][$e],Ke[Ae][$e+1],ae,ue,ne,fe));Oe.geometry.push(Be)}}return Pe.transformed=!0,Pe}function vn(Pe,ae,ue,ne,fe,Oe){return[Math.round(ue*(Pe*ne-fe)),Math.round(ue*(ae*ne-Oe))]}function Ue(Pe,ae,ue,ne,fe){const Oe=ae===fe.maxZoom?0:fe.tolerance/((1<<ae)*fe.extent),Ke={features:[],numPoints:0,numSimplified:0,numFeatures:Pe.length,source:null,x:ue,y:ne,z:ae,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ye of Pe)Se(Ke,ye,Oe,fe);return Ke}function Se(Pe,ae,ue,ne){const fe=ae.geometry,Oe=ae.type,Ke=[];if(Pe.minX=Math.min(Pe.minX,ae.minX),Pe.minY=Math.min(Pe.minY,ae.minY),Pe.maxX=Math.max(Pe.maxX,ae.maxX),Pe.maxY=Math.max(Pe.maxY,ae.maxY),Oe==="Point"||Oe==="MultiPoint")for(let ye=0;ye<fe.length;ye+=3)Ke.push(fe[ye],fe[ye+1]),Pe.numPoints++,Pe.numSimplified++;else if(Oe==="LineString")yt(Ke,fe,Pe,ue,!1,!1);else if(Oe==="MultiLineString"||Oe==="Polygon")for(let ye=0;ye<fe.length;ye++)yt(Ke,fe[ye],Pe,ue,Oe==="Polygon",ye===0);else if(Oe==="MultiPolygon")for(let ye=0;ye<fe.length;ye++){const Ae=fe[ye];for(let Be=0;Be<Ae.length;Be++)yt(Ke,Ae[Be],Pe,ue,!0,Be===0)}if(Ke.length){let ye=ae.tags||null;if(Oe==="LineString"&&ne.lineMetrics){ye={};for(const Be in ae.tags)ye[Be]=ae.tags[Be];ye.mapbox_clip_start=fe.start/fe.size,ye.mapbox_clip_end=fe.end/fe.size}const Ae={geometry:Ke,type:Oe==="Polygon"||Oe==="MultiPolygon"?3:Oe==="LineString"||Oe==="MultiLineString"?2:1,tags:ye};ae.id!==null&&(Ae.id=ae.id),Pe.features.push(Ae)}}function yt(Pe,ae,ue,ne,fe,Oe){const Ke=ne*ne;if(ne>0&&ae.size<(fe?Ke:ne))return void(ue.numPoints+=ae.length/3);const ye=[];for(let Ae=0;Ae<ae.length;Ae+=3)(ne===0||ae[Ae+2]>Ke)&&(ue.numSimplified++,ye.push(ae[Ae],ae[Ae+1])),ue.numPoints++;fe&&function(Ae,Be){let $e=0;for(let He=0,dt=Ae.length,qe=dt-2;He<dt;qe=He,He+=2)$e+=(Ae[He]-Ae[qe])*(Ae[He+1]+Ae[qe+1]);if($e>0===Be)for(let He=0,dt=Ae.length;He<dt/2;He+=2){const qe=Ae[He],$t=Ae[He+1];Ae[He]=Ae[dt-2-He],Ae[He+1]=Ae[dt-1-He],Ae[dt-2-He]=qe,Ae[dt-1-He]=$t}}(ye,Oe),Pe.push(ye)}const Nt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ht{constructor(ae,ue){const ne=(ue=this.options=function(Oe,Ke){for(const ye in Ke)Oe[ye]=Ke[ye];return Oe}(Object.create(Nt),ue)).debug;if(ne&&console.time("preprocess data"),ue.maxZoom<0||ue.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ue.promoteId&&ue.generateId)throw new Error("promoteId and generateId cannot be used together.");let fe=function(Oe,Ke){const ye=[];if(Oe.type==="FeatureCollection")for(let Ae=0;Ae<Oe.features.length;Ae++)Vt(ye,Oe.features[Ae],Ke,Ae);else Vt(ye,Oe.type==="Feature"?Oe:{geometry:Oe},Ke);return ye}(ae,ue);this.tiles={},this.tileCoords=[],ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ue.indexMaxZoom,ue.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=function(Oe,Ke){const ye=Ke.buffer/Ke.extent;let Ae=Oe;const Be=_t(Oe,1,-1-ye,ye,0,-1,2,Ke),$e=_t(Oe,1,1-ye,2+ye,0,-1,2,Ke);return(Be||$e)&&(Ae=_t(Oe,1,-ye,1+ye,0,-1,2,Ke)||[],Be&&(Ae=fn(Be,1).concat(Ae)),$e&&(Ae=Ae.concat(fn($e,-1)))),Ae}(fe,ue),fe.length&&this.splitTile(fe,0,0,0),ne&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ae,ue,ne,fe,Oe,Ke,ye){const Ae=[ae,ue,ne,fe],Be=this.options,$e=Be.debug;for(;Ae.length;){fe=Ae.pop(),ne=Ae.pop(),ue=Ae.pop(),ae=Ae.pop();const He=1<<ue,dt=Ot(ue,ne,fe);let qe=this.tiles[dt];if(!qe&&($e>1&&console.time("creation"),qe=this.tiles[dt]=Ue(ae,ue,ne,fe,Be),this.tileCoords.push({z:ue,x:ne,y:fe}),$e)){$e>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ue,ne,fe,qe.numFeatures,qe.numPoints,qe.numSimplified),console.timeEnd("creation"));const Dn=`z${ue}`;this.stats[Dn]=(this.stats[Dn]||0)+1,this.total++}if(qe.source=ae,Oe==null){if(ue===Be.indexMaxZoom||qe.numPoints<=Be.indexMaxPoints)continue}else{if(ue===Be.maxZoom||ue===Oe)continue;if(Oe!=null){const Dn=Oe-ue;if(ne!==Ke>>Dn||fe!==ye>>Dn)continue}}if(qe.source=null,ae.length===0)continue;$e>1&&console.time("clipping");const $t=.5*Be.buffer/Be.extent,Jt=.5-$t,Ie=.5+$t,ot=1+$t;let mt=null,Wt=null,nn=null,mn=null,on=_t(ae,He,ne-$t,ne+Ie,0,qe.minX,qe.maxX,Be),sn=_t(ae,He,ne+Jt,ne+ot,0,qe.minX,qe.maxX,Be);ae=null,on&&(mt=_t(on,He,fe-$t,fe+Ie,1,qe.minY,qe.maxY,Be),Wt=_t(on,He,fe+Jt,fe+ot,1,qe.minY,qe.maxY,Be),on=null),sn&&(nn=_t(sn,He,fe-$t,fe+Ie,1,qe.minY,qe.maxY,Be),mn=_t(sn,He,fe+Jt,fe+ot,1,qe.minY,qe.maxY,Be),sn=null),$e>1&&console.timeEnd("clipping"),Ae.push(mt||[],ue+1,2*ne,2*fe),Ae.push(Wt||[],ue+1,2*ne,2*fe+1),Ae.push(nn||[],ue+1,2*ne+1,2*fe),Ae.push(mn||[],ue+1,2*ne+1,2*fe+1)}}getTile(ae,ue,ne){ae=+ae,ue=+ue,ne=+ne;const fe=this.options,{extent:Oe,debug:Ke}=fe;if(ae<0||ae>24)return null;const ye=1<<ae,Ae=Ot(ae,ue=ue+ye&ye-1,ne);if(this.tiles[Ae])return On(this.tiles[Ae],Oe);Ke>1&&console.log("drilling down to z%d-%d-%d",ae,ue,ne);let Be,$e=ae,He=ue,dt=ne;for(;!Be&&$e>0;)$e--,He>>=1,dt>>=1,Be=this.tiles[Ot($e,He,dt)];return Be&&Be.source?(Ke>1&&(console.log("found parent tile z%d-%d-%d",$e,He,dt),console.time("drilling down")),this.splitTile(Be.source,$e,He,dt,ae,ue,ne),Ke>1&&console.timeEnd("drilling down"),this.tiles[Ae]?On(this.tiles[Ae],Oe):null):null}}function Ot(Pe,ae,ue){return 32*((1<<Pe)*ue+ae)+Pe}function un(Pe,ae){return ae?Pe.properties[ae]:Pe.id}function Gt(Pe,ae){if(Pe==null)return!0;if(Pe.type==="Feature")return un(Pe,ae)!=null;if(Pe.type==="FeatureCollection"){const ue=new Set;for(const ne of Pe.features){const fe=un(ne,ae);if(fe==null||ue.has(fe))return!1;ue.add(fe)}return!0}return!1}function Zt(Pe,ae){const ue=new Map;if(Pe!=null)if(Pe.type==="Feature")ue.set(un(Pe,ae),Pe);else for(const ne of Pe.features)ue.set(un(ne,ae),ne);return ue}class Nn extends w{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ae,ue){return c._(this,void 0,void 0,function*(){const ne=ae.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const fe=this._geoJSONIndex.getTile(ne.z,ne.x,ne.y);if(!fe)return null;const Oe=new B(fe.features);let Ke=J(Oe);return Ke.byteOffset===0&&Ke.byteLength===Ke.buffer.byteLength||(Ke=new Uint8Array(Ke)),{vectorTile:Oe,rawData:Ke.buffer}})}loadData(ae){return c._(this,void 0,void 0,function*(){var ue;(ue=this._pendingRequest)===null||ue===void 0||ue.abort();const ne=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new c.cM(ae.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ae,this._pendingRequest),this._geoJSONIndex=ae.cluster?new we(function({superclusterOptions:Ke,clusterProperties:ye}){if(!ye||!Ke)return Ke;const Ae={},Be={},$e={accumulated:null,zoom:0},He={properties:null},dt=Object.keys(ye);for(const qe of dt){const[$t,Jt]=ye[qe],Ie=c.cT(Jt),ot=c.cT(typeof $t=="string"?[$t,["accumulated"],["get",qe]]:$t);Ae[qe]=Ie.value,Be[qe]=ot.value}return Ke.map=qe=>{He.properties=qe;const $t={};for(const Jt of dt)$t[Jt]=Ae[Jt].evaluate($e,He);return $t},Ke.reduce=(qe,$t)=>{He.properties=$t;for(const Jt of dt)$e.accumulated=qe[Jt],qe[Jt]=Be[Jt].evaluate($e,He)},Ke}(ae)).load((yield this._pendingData).features):(fe=yield this._pendingData,new Ht(fe,ae.geojsonVtOptions)),this.loaded={};const Oe={};if(ne){const Ke=ne.finish();Ke&&(Oe.resourceTiming={},Oe.resourceTiming[ae.source]=JSON.parse(JSON.stringify(Ke)))}return Oe}catch(Oe){if(delete this._pendingRequest,c.cx(Oe))return{abandoned:!0};throw Oe}var fe})}getData(){return c._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ae){const ue=this.loaded;return ue&&ue[ae.uid]?super.reloadTile(ae):this.loadTile(ae)}loadAndProcessGeoJSON(ae,ue){return c._(this,void 0,void 0,function*(){let ne=yield this.loadGeoJSON(ae,ue);if(delete this._pendingRequest,typeof ne!="object")throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`);if(R(ne,!0),ae.filter){const fe=c.cT(ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(fe.result==="error")throw new Error(fe.value.map(Ke=>`${Ke.key}: ${Ke.message}`).join(", "));ne={type:"FeatureCollection",features:ne.features.filter(Ke=>fe.value.evaluate({zoom:0},Ke))}}return ne})}loadGeoJSON(ae,ue){return c._(this,void 0,void 0,function*(){const{promoteId:ne}=ae;if(ae.request){const fe=yield c.j(ae.request,ue);return this._dataUpdateable=Gt(fe.data,ne)?Zt(fe.data,ne):void 0,fe.data}if(typeof ae.data=="string")try{const fe=JSON.parse(ae.data);return this._dataUpdateable=Gt(fe,ne)?Zt(fe,ne):void 0,fe}catch{throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`)}if(!ae.dataDiff)throw new Error(`Input data given to '${ae.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ae.source}`);return function(fe,Oe,Ke){var ye,Ae,Be,$e;if(Oe.removeAll&&fe.clear(),Oe.remove)for(const He of Oe.remove)fe.delete(He);if(Oe.add)for(const He of Oe.add){const dt=un(He,Ke);dt!=null&&fe.set(dt,He)}if(Oe.update)for(const He of Oe.update){let dt=fe.get(He.id);if(dt==null)continue;const qe=!He.removeAllProperties&&(((ye=He.removeProperties)===null||ye===void 0?void 0:ye.length)>0||((Ae=He.addOrUpdateProperties)===null||Ae===void 0?void 0:Ae.length)>0);if((He.newGeometry||He.removeAllProperties||qe)&&(dt=Object.assign({},dt),fe.set(He.id,dt),qe&&(dt.properties=Object.assign({},dt.properties))),He.newGeometry&&(dt.geometry=He.newGeometry),He.removeAllProperties)dt.properties={};else if(((Be=He.removeProperties)===null||Be===void 0?void 0:Be.length)>0)for(const $t of He.removeProperties)Object.prototype.hasOwnProperty.call(dt.properties,$t)&&delete dt.properties[$t];if((($e=He.addOrUpdateProperties)===null||$e===void 0?void 0:$e.length)>0)for(const{key:$t,value:Jt}of He.addOrUpdateProperties)dt.properties[$t]=Jt}}(this._dataUpdateable,ae.dataDiff,ne),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ae){return c._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ae){return this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId)}getClusterChildren(ae){return this._geoJSONIndex.getChildren(ae.clusterId)}getClusterLeaves(ae){return this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset)}}class Yt{constructor(ae){this.self=ae,this.actor=new c.J(ae),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ue,ne)=>{if(this.externalWorkerSourceTypes[ue])throw new Error(`Worker source with name "${ue}" already registered.`);this.externalWorkerSourceTypes[ue]=ne},this.self.addProtocol=c.cz,this.self.removeProtocol=c.cA,this.self.registerRTLTextPlugin=ue=>{c.cU.setMethods(ue)},this.actor.registerMessageHandler("LDT",(ue,ne)=>this._getDEMWorkerSource(ue,ne.source).loadTile(ne)),this.actor.registerMessageHandler("RDT",(ue,ne)=>c._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ue,ne.source).removeTile(ne)})),this.actor.registerMessageHandler("GCEZ",(ue,ne)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ne.type,ne.source).getClusterExpansionZoom(ne)})),this.actor.registerMessageHandler("GCC",(ue,ne)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ne.type,ne.source).getClusterChildren(ne)})),this.actor.registerMessageHandler("GCL",(ue,ne)=>c._(this,void 0,void 0,function*(){return this._getWorkerSource(ue,ne.type,ne.source).getClusterLeaves(ne)})),this.actor.registerMessageHandler("LD",(ue,ne)=>this._getWorkerSource(ue,ne.type,ne.source).loadData(ne)),this.actor.registerMessageHandler("GD",(ue,ne)=>this._getWorkerSource(ue,ne.type,ne.source).getData()),this.actor.registerMessageHandler("LT",(ue,ne)=>this._getWorkerSource(ue,ne.type,ne.source).loadTile(ne)),this.actor.registerMessageHandler("RT",(ue,ne)=>this._getWorkerSource(ue,ne.type,ne.source).reloadTile(ne)),this.actor.registerMessageHandler("AT",(ue,ne)=>this._getWorkerSource(ue,ne.type,ne.source).abortTile(ne)),this.actor.registerMessageHandler("RMT",(ue,ne)=>this._getWorkerSource(ue,ne.type,ne.source).removeTile(ne)),this.actor.registerMessageHandler("RS",(ue,ne)=>c._(this,void 0,void 0,function*(){if(!this.workerSources[ue]||!this.workerSources[ue][ne.type]||!this.workerSources[ue][ne.type][ne.source])return;const fe=this.workerSources[ue][ne.type][ne.source];delete this.workerSources[ue][ne.type][ne.source],fe.removeSource!==void 0&&fe.removeSource(ne)})),this.actor.registerMessageHandler("RM",ue=>c._(this,void 0,void 0,function*(){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue]})),this.actor.registerMessageHandler("SR",(ue,ne)=>c._(this,void 0,void 0,function*(){this.referrer=ne})),this.actor.registerMessageHandler("SRPS",(ue,ne)=>this._syncRTLPluginState(ue,ne)),this.actor.registerMessageHandler("IS",(ue,ne)=>c._(this,void 0,void 0,function*(){this.self.importScripts(ne)})),this.actor.registerMessageHandler("SI",(ue,ne)=>this._setImages(ue,ne)),this.actor.registerMessageHandler("UL",(ue,ne)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(ue).update(ne.layers,ne.removedIds)})),this.actor.registerMessageHandler("SL",(ue,ne)=>c._(this,void 0,void 0,function*(){this._getLayerIndex(ue).replace(ne)}))}_setImages(ae,ue){return c._(this,void 0,void 0,function*(){this.availableImages[ae]=ue;for(const ne in this.workerSources[ae]){const fe=this.workerSources[ae][ne];for(const Oe in fe)fe[Oe].availableImages=ue}})}_syncRTLPluginState(ae,ue){return c._(this,void 0,void 0,function*(){return yield c.cU.syncState(ue,this.self.importScripts)})}_getAvailableImages(ae){let ue=this.availableImages[ae];return ue||(ue=[]),ue}_getLayerIndex(ae){let ue=this.layerIndexes[ae];return ue||(ue=this.layerIndexes[ae]=new s),ue}_getWorkerSource(ae,ue,ne){if(this.workerSources[ae]||(this.workerSources[ae]={}),this.workerSources[ae][ue]||(this.workerSources[ae][ue]={}),!this.workerSources[ae][ue][ne]){const fe={sendAsync:(Oe,Ke)=>(Oe.targetMapId=ae,this.actor.sendAsync(Oe,Ke))};switch(ue){case"vector":this.workerSources[ae][ue][ne]=new w(fe,this._getLayerIndex(ae),this._getAvailableImages(ae));break;case"geojson":this.workerSources[ae][ue][ne]=new Nn(fe,this._getLayerIndex(ae),this._getAvailableImages(ae));break;default:this.workerSources[ae][ue][ne]=new this.externalWorkerSourceTypes[ue](fe,this._getLayerIndex(ae),this._getAvailableImages(ae))}}return this.workerSources[ae][ue][ne]}_getDEMWorkerSource(ae,ue){return this.demWorkerSources[ae]||(this.demWorkerSources[ae]={}),this.demWorkerSources[ae][ue]||(this.demWorkerSources[ae][ue]=new S),this.demWorkerSources[ae][ue]}}return c.i(self)&&(self.worker=new Yt(self)),Yt}),i("index",["exports","./shared"],function(c,s){var p="5.6.1";function y(){var C=new s.A(4);return s.A!=Float32Array&&(C[1]=0,C[2]=0),C[0]=1,C[3]=1,C}let _,w;const S={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(C,o,u){const g=requestAnimationFrame(E=>{x(),o(E)}),{unsubscribe:x}=s.s(C.signal,"abort",()=>{x(),cancelAnimationFrame(g),u(s.c())},!1)},frameAsync(C){return new Promise((o,u)=>{this.frame(C,o,u)})},getImageData(C,o=0){return this.getImageCanvasContext(C).getImageData(-o,-o,C.width+2*o,C.height+2*o)},getImageCanvasContext(C){const o=window.document.createElement("canvas"),u=o.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return o.width=C.width,o.height=C.height,u.drawImage(C,0,0,C.width,C.height),u},resolveURL:C=>(_||(_=document.createElement("a")),_.href=C,_.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(w==null&&(w=matchMedia("(prefers-reduced-motion: reduce)")),w.matches)}};class M{static testProp(o){if(!M.docStyle)return o[0];for(let u=0;u<o.length;u++)if(o[u]in M.docStyle)return o[u];return o[0]}static create(o,u,g){const x=window.document.createElement(o);return u!==void 0&&(x.className=u),g&&g.appendChild(x),x}static createNS(o,u){return window.document.createElementNS(o,u)}static disableDrag(){M.docStyle&&M.selectProp&&(M.userSelect=M.docStyle[M.selectProp],M.docStyle[M.selectProp]="none")}static enableDrag(){M.docStyle&&M.selectProp&&(M.docStyle[M.selectProp]=M.userSelect)}static setTransform(o,u){o.style[M.transformProp]=u}static addEventListener(o,u,g,x={}){o.addEventListener(u,g,"passive"in x?x:x.capture)}static removeEventListener(o,u,g,x={}){o.removeEventListener(u,g,"passive"in x?x:x.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",M.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",M.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",M.suppressClickInternal,!0)},0)}static getScale(o){const u=o.getBoundingClientRect();return{x:u.width/o.offsetWidth||1,y:u.height/o.offsetHeight||1,boundingClientRect:u}}static getPoint(o,u,g){const x=u.boundingClientRect;return new s.P((g.clientX-x.left)/u.x-o.clientLeft,(g.clientY-x.top)/u.y-o.clientTop)}static mousePos(o,u){const g=M.getScale(o);return M.getPoint(o,g,u)}static touchPos(o,u){const g=[],x=M.getScale(o);for(let E=0;E<u.length;E++)g.push(M.getPoint(o,x,u[E]));return g}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}static sanitize(o){const u=new DOMParser().parseFromString(o,"text/html").body||document.createElement("body"),g=u.querySelectorAll("script");for(const x of g)x.remove();return M.clean(u),u.innerHTML}static isPossiblyDangerous(o,u){const g=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(o)||!g.includes("javascript:")&&!g.includes("data:"))||!!o.startsWith("on")||void 0}static clean(o){const u=o.children;for(const g of u)M.removeAttributes(g),M.clean(g)}static removeAttributes(o){for(const{name:u,value:g}of o.attributes)M.isPossiblyDangerous(u,g)&&o.removeAttribute(u)}}M.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,M.selectProp=M.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),M.transformProp=M.testProp(["transform","WebkitTransform"]);const I={supported:!1,testSupport:function(C){!L&&R&&(V?B(C):D=C)}};let D,R,L=!1,V=!1;function B(C){const o=C.createTexture();C.bindTexture(C.TEXTURE_2D,o);try{if(C.texImage2D(C.TEXTURE_2D,0,C.RGBA,C.RGBA,C.UNSIGNED_BYTE,R),C.isContextLost())return;I.supported=!0}catch{}C.deleteTexture(o),L=!0}var H;typeof document<"u"&&(R=document.createElement("img"),R.onload=()=>{D&&B(D),D=null,V=!0},R.onerror=()=>{L=!0,D=null},R.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(C){let o,u,g,x;C.resetRequestQueue=()=>{o=[],u=0,g=0,x={}},C.addThrottleControl=U=>{const Z=g++;return x[Z]=U,Z},C.removeThrottleControl=U=>{delete x[U],k()},C.getImage=(U,Z,K=!0)=>new Promise((oe,re)=>{I.supported&&(U.headers||(U.headers={}),U.headers.accept="image/webp,*/*"),s.e(U,{type:"image"}),o.push({abortController:Z,requestParameters:U,supportImageRefresh:K,state:"queued",onError:ce=>{re(ce)},onSuccess:ce=>{oe(ce)}}),k()});const E=U=>s._(this,void 0,void 0,function*(){U.state="running";const{requestParameters:Z,supportImageRefresh:K,onError:oe,onSuccess:re,abortController:ce}=U,ve=K===!1&&!s.i(self)&&!s.g(Z.url)&&(!Z.headers||Object.keys(Z.headers).reduce((Ne,Ge)=>Ne&&Ge==="accept",!0));u++;const Le=ve?F(Z,ce):s.m(Z,ce);try{const Ne=yield Le;delete U.abortController,U.state="completed",Ne.data instanceof HTMLImageElement||s.b(Ne.data)?re(Ne):Ne.data&&re({data:yield(ze=Ne.data,typeof createImageBitmap=="function"?s.f(ze):s.h(ze)),cacheControl:Ne.cacheControl,expires:Ne.expires})}catch(Ne){delete U.abortController,oe(Ne)}finally{u--,k()}var ze}),k=()=>{const U=(()=>{for(const Z of Object.keys(x))if(x[Z]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let Z=u;Z<U&&o.length>0;Z++){const K=o.shift();K.abortController.signal.aborted?Z--:E(K)}},F=(U,Z)=>new Promise((K,oe)=>{const re=new Image,ce=U.url,ve=U.credentials;ve&&ve==="include"?re.crossOrigin="use-credentials":(ve&&ve==="same-origin"||!s.d(ce))&&(re.crossOrigin="anonymous"),Z.signal.addEventListener("abort",()=>{re.src="",oe(s.c())}),re.fetchPriority="high",re.onload=()=>{re.onerror=re.onload=null,K({data:re})},re.onerror=()=>{re.onerror=re.onload=null,Z.signal.aborted||oe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},re.src=ce})}(H||(H={})),H.resetRequestQueue();class q{constructor(o){this._transformRequestFn=o}transformRequest(o,u){return this._transformRequestFn&&this._transformRequestFn(o,u)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function X(C){const o=[];if(typeof C=="string")o.push({id:"default",url:C});else if(C&&C.length>0){const u=[];for(const{id:g,url:x}of C){const E=`${g}${x}`;u.indexOf(E)===-1&&(u.push(E),o.push({id:g,url:x}))}}return o}function ee(C,o,u){try{const g=new URL(C);return g.pathname+=`${o}${u}`,g.toString()}catch{throw new Error(`Invalid sprite URL "${C}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function se(C){const{userImage:o}=C;return!!(o&&o.render&&o.render())&&(C.data.replace(new Uint8Array(o.data.buffer)),!0)}class J extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:u,promiseResolve:g}of this.requestors)g(this._getImagesForIds(u));this.requestors=[]}}getImage(o){const u=this.images[o];if(u&&!u.data&&u.spriteData){const g=u.spriteData;u.data=new s.R({width:g.width,height:g.height},g.context.getImageData(g.x,g.y,g.width,g.height).data),u.spriteData=null}return u}addImage(o,u){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,u)&&(this.images[o]=u)}_validate(o,u){let g=!0;const x=u.data||u.spriteData;return this._validateStretch(u.stretchX,x&&x.width)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "stretchX" value`))),g=!1),this._validateStretch(u.stretchY,x&&x.height)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "stretchY" value`))),g=!1),this._validateContent(u.content,u)||(this.fire(new s.k(new Error(`Image "${o}" has invalid "content" value`))),g=!1),g}_validateStretch(o,u){if(!o)return!0;let g=0;for(const x of o){if(x[0]<g||x[1]<x[0]||u<x[1])return!1;g=x[1]}return!0}_validateContent(o,u){if(!o)return!0;if(o.length!==4)return!1;const g=u.spriteData,x=g&&g.width||u.data.width,E=g&&g.height||u.data.height;return!(o[0]<0||x<o[0]||o[1]<0||E<o[1]||o[2]<0||x<o[2]||o[3]<0||E<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,u,g=!0){const x=this.getImage(o);if(g&&(x.data.width!==u.data.width||x.data.height!==u.data.height))throw new Error(`size mismatch between old image (${x.data.width}x${x.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=x.version+1,this.images[o]=u,this.updatedImages[o]=!0}removeImage(o){const u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((u,g)=>{let x=!0;if(!this.isLoaded())for(const E of o)this.images[E]||(x=!1);this.isLoaded()||x?u(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:u})})}_getImagesForIds(o){const u={};for(const g of o){let x=this.getImage(g);x||(this.fire(new s.l("styleimagemissing",{id:g})),x=this.getImage(g)),x?u[g]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,textFitWidth:x.textFitWidth,textFitHeight:x.textFitHeight,hasRenderCallback:!!(x.userImage&&x.userImage.render)}:s.w(`Image "${g}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:o,height:u}=this.atlasImage;return{width:o,height:u}}getPattern(o){const u=this.patterns[o],g=this.getImage(o);if(!g)return null;if(u&&u.position.version===g.version)return u.position;if(u)u.position.version=g.version;else{const x={w:g.data.width+2,h:g.data.height+2,x:0,y:0},E=new s.I(x,g);this.patterns[o]={bin:x,position:E}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.T(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const E in this.patterns)o.push(this.patterns[E].bin);const{w:u,h:g}=s.p(o),x=this.atlasImage;x.resize({width:u||1,height:g||1});for(const E in this.patterns){const{bin:k}=this.patterns[E],F=k.x+1,U=k.y+1,Z=this.getImage(E).data,K=Z.width,oe=Z.height;s.R.copy(Z,x,{x:0,y:0},{x:F,y:U},{width:K,height:oe}),s.R.copy(Z,x,{x:0,y:oe-1},{x:F,y:U-1},{width:K,height:1}),s.R.copy(Z,x,{x:0,y:0},{x:F,y:U+oe},{width:K,height:1}),s.R.copy(Z,x,{x:K-1,y:0},{x:F-1,y:U},{width:1,height:oe}),s.R.copy(Z,x,{x:0,y:0},{x:F+K,y:U},{width:1,height:oe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const u of o){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const g=this.getImage(u);g||s.w(`Image with ID: "${u}" was not found`),se(g)&&this.updateImage(u,g)}}}const $=1e20;function le(C,o,u,g,x,E,k,F,U){for(let Z=o;Z<o+g;Z++)Ce(C,u*E+Z,E,x,k,F,U);for(let Z=u;Z<u+x;Z++)Ce(C,Z*E+o,1,g,k,F,U)}function Ce(C,o,u,g,x,E,k){E[0]=0,k[0]=-$,k[1]=$,x[0]=C[o];for(let F=1,U=0,Z=0;F<g;F++){x[F]=C[o+F*u];const K=F*F;do{const oe=E[U];Z=(x[F]-x[oe]+K-oe*oe)/(F-oe)/2}while(Z<=k[U]&&--U>-1);U++,E[U]=F,k[U]=Z,k[U+1]=$}for(let F=0,U=0;F<g;F++){for(;k[U+1]<F;)U++;const Z=E[U],K=F-Z;C[o+F*u]=x[Z]+K*K}}class we{constructor(o,u){this.requestManager=o,this.localIdeographFontFamily=u,this.entries={}}setURL(o){this.url=o}getGlyphs(o){return s._(this,void 0,void 0,function*(){const u=[];for(const E in o)for(const k of o[E])u.push(this._getAndCacheGlyphsPromise(E,k));const g=yield Promise.all(u),x={};for(const{stack:E,id:k,glyph:F}of g)x[E]||(x[E]={}),x[E][k]=F&&{id:F.id,bitmap:F.bitmap.clone(),metrics:F.metrics};return x})}_getAndCacheGlyphsPromise(o,u){return s._(this,void 0,void 0,function*(){let g=this.entries[o];g||(g=this.entries[o]={glyphs:{},requests:{},ranges:{}});let x=g.glyphs[u];if(x!==void 0)return{stack:o,id:u,glyph:x};if(x=this._tinySDF(g,o,u),x)return g.glyphs[u]=x,{stack:o,id:u,glyph:x};const E=Math.floor(u/256);if(256*E>65535)throw new Error("glyphs > 65535 not supported");if(g.ranges[E])return{stack:o,id:u,glyph:x};if(!this.url)throw new Error("glyphsUrl is not set");if(!g.requests[E]){const F=we.loadGlyphRange(o,E,this.url,this.requestManager);g.requests[E]=F}const k=yield g.requests[E];for(const F in k)this._doesCharSupportLocalGlyph(+F)||(g.glyphs[+F]=k[+F]);return g.ranges[E]=!0,{stack:o,id:u,glyph:k[u]||null}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(o))||s.u["CJK Unified Ideographs"](o)||s.u["Hangul Syllables"](o)||s.u.Hiragana(o)||s.u.Katakana(o)||s.u["CJK Symbols and Punctuation"](o)||s.u["Halfwidth and Fullwidth Forms"](o))}_tinySDF(o,u,g){const x=this.localIdeographFontFamily;if(!x||!this._doesCharSupportLocalGlyph(g))return;let E=o.tinySDF;if(!E){let F="400";/bold/i.test(u)?F="900":/medium/i.test(u)?F="500":/light/i.test(u)&&(F="200"),E=o.tinySDF=new we.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:x,fontWeight:F})}const k=E.draw(String.fromCharCode(g));return{id:g,bitmap:new s.q({width:k.width||60,height:k.height||60},k.data),metrics:{width:k.glyphWidth/2||24,height:k.glyphHeight/2||24,left:k.glyphLeft/2+.5||0,top:k.glyphTop/2-27.5||-8,advance:k.glyphAdvance/2||24,isDoubleResolution:!0}}}}we.loadGlyphRange=function(C,o,u,g){return s._(this,void 0,void 0,function*(){const x=256*o,E=x+255,k=g.transformRequest(u.replace("{fontstack}",C).replace("{range}",`${x}-${E}`),"Glyphs"),F=yield s.n(k,new AbortController);if(!F||!F.data)throw new Error(`Could not load glyph range. range: ${o}, ${x}-${E}`);const U={};for(const Z of s.o(F.data))U[Z.id]=Z;return U})},we.TinySDF=class{constructor({fontSize:C=24,buffer:o=3,radius:u=8,cutoff:g=.25,fontFamily:x="sans-serif",fontWeight:E="normal",fontStyle:k="normal"}={}){this.buffer=o,this.cutoff=g,this.radius=u;const F=this.size=C+4*o,U=this._createCanvas(F),Z=this.ctx=U.getContext("2d",{willReadFrequently:!0});Z.font=`${k} ${E} ${C}px ${x}`,Z.textBaseline="alphabetic",Z.textAlign="left",Z.fillStyle="black",this.gridOuter=new Float64Array(F*F),this.gridInner=new Float64Array(F*F),this.f=new Float64Array(F),this.z=new Float64Array(F+1),this.v=new Uint16Array(F)}_createCanvas(C){const o=document.createElement("canvas");return o.width=o.height=C,o}draw(C){const{width:o,actualBoundingBoxAscent:u,actualBoundingBoxDescent:g,actualBoundingBoxLeft:x,actualBoundingBoxRight:E}=this.ctx.measureText(C),k=Math.ceil(u),F=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(E-x))),U=Math.min(this.size-this.buffer,k+Math.ceil(g)),Z=F+2*this.buffer,K=U+2*this.buffer,oe=Math.max(Z*K,0),re=new Uint8ClampedArray(oe),ce={data:re,width:Z,height:K,glyphWidth:F,glyphHeight:U,glyphTop:k,glyphLeft:0,glyphAdvance:o};if(F===0||U===0)return ce;const{ctx:ve,buffer:Le,gridInner:ze,gridOuter:Ne}=this;ve.clearRect(Le,Le,F,U),ve.fillText(C,Le,Le+k);const Ge=ve.getImageData(Le,Le,F,U);Ne.fill($,0,oe),ze.fill(0,0,oe);for(let et=0;et<U;et++)for(let Xe=0;Xe<F;Xe++){const at=Ge.data[4*(et*F+Xe)+3]/255;if(at===0)continue;const ht=(et+Le)*Z+Xe+Le;if(at===1)Ne[ht]=0,ze[ht]=$;else{const Ye=.5-at;Ne[ht]=Ye>0?Ye*Ye:0,ze[ht]=Ye<0?Ye*Ye:0}}le(Ne,0,0,Z,K,Z,this.f,this.v,this.z),le(ze,Le,Le,F,U,Z,this.f,this.v,this.z);for(let et=0;et<oe;et++){const Xe=Math.sqrt(Ne[et])-Math.sqrt(ze[et]);re[et]=Math.round(255-255*(Xe/this.radius+this.cutoff))}return ce}};class We{constructor(){this.specification=s.v.light.position}possiblyEvaluate(o,u){return s.B(o.expression.evaluate(u))}interpolate(o,u,g){return{x:s.C.number(o.x,u.x,g),y:s.C.number(o.y,u.y,g),z:s.C.number(o.z,u.z,g)}}}let Fe;class Me extends s.E{constructor(o){super(),Fe=Fe||new s.r({anchor:new s.D(s.v.light.anchor),position:new We,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.t(Fe),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u={}){if(!this._validate(s.x,o,u))for(const g in o){const x=o[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),x):this._transitionable.setValue(g,x)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,g){return(!g||g.validate!==!1)&&s.y(this,o.call(s.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}const Ee=new s.r({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class Te extends s.E{constructor(o){super(),this._transitionable=new s.t(Ee),this.setSky(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0))}setSky(o,u={}){if(!this._validate(s.G,o,u)){o||(o={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const g in o){const x=o[g];g.endsWith("-transition")?this._transitionable.setTransition(g.slice(0,-11),x):this._transitionable.setValue(g,x)}}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,g={}){return g?.validate!==!1&&s.y(this,o.call(s.z,s.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class Ze{constructor(o,u){this.width=o,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,u){const g=o.join(",")+String(u);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(o,u)),this.dashEntry[g]}getDashRanges(o,u,g){const x=[];let E=o.length%2==1?-o[o.length-1]*g:0,k=o[0]*g,F=!0;x.push({left:E,right:k,isDash:F,zeroLength:o[0]===0});let U=o[0];for(let Z=1;Z<o.length;Z++){F=!F;const K=o[Z];E=U*g,U+=K,k=U*g,x.push({left:E,right:k,isDash:F,zeroLength:K===0})}return x}addRoundDash(o,u,g){const x=u/2;for(let E=-g;E<=g;E++){const k=this.width*(this.nextRow+g+E);let F=0,U=o[F];for(let Z=0;Z<this.width;Z++){Z/U.right>1&&(U=o[++F]);const K=Math.abs(Z-U.left),oe=Math.abs(Z-U.right),re=Math.min(K,oe);let ce;const ve=E/g*(x+1);if(U.isDash){const Le=x-Math.abs(ve);ce=Math.sqrt(re*re+Le*Le)}else ce=x-Math.sqrt(re*re+ve*ve);this.data[k+Z]=Math.max(0,Math.min(255,ce+128))}}}addRegularDash(o){for(let F=o.length-1;F>=0;--F){const U=o[F],Z=o[F+1];U.zeroLength?o.splice(F,1):Z&&Z.isDash===U.isDash&&(Z.left=U.left,o.splice(F,1))}const u=o[0],g=o[o.length-1];u.isDash===g.isDash&&(u.left=g.left-this.width,g.right=u.right+this.width);const x=this.width*this.nextRow;let E=0,k=o[E];for(let F=0;F<this.width;F++){F/k.right>1&&(k=o[++E]);const U=Math.abs(F-k.left),Z=Math.abs(F-k.right),K=Math.min(U,Z);this.data[x+F]=Math.max(0,Math.min(255,(k.isDash?K:-K)+128))}}addDash(o,u){const g=u?7:0,x=2*g+1;if(this.nextRow+x>this.height)return s.w("LineAtlas out of space"),null;let E=0;for(let F=0;F<o.length;F++)E+=o[F];if(E!==0){const F=this.width/E,U=this.getDashRanges(o,this.width,F);u?this.addRoundDash(U,F,g):this.addRegularDash(U)}const k={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:E};return this.nextRow+=x,this.dirty=!0,k}bind(o){const u=o.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const rt="maplibre_preloaded_worker_pool";class Re{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Re.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[rt]}numActive(){return Object.keys(this.active).length}}const Qe=Math.floor(S.hardwareConcurrency/2);let Vt,je;function ct(){return Vt||(Vt=new Re),Vt}Re.workerCount=s.H(globalThis)?Math.max(Math.min(Qe,3),1):1;class Ct{constructor(o,u){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=u;const g=this.workerPool.acquire(u);for(let x=0;x<g.length;x++){const E=new s.J(g[x],u);E.name=`Worker ${x}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,u){const g=[];for(const x of this.actors)g.push(x.sendAsync({type:o,data:u}));return Promise.all(g)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,u){for(const g of this.actors)g.registerMessageHandler(o,u)}}function ut(){return je||(je=new Ct(ct(),s.K),je.registerMessageHandler("GR",(C,o,u)=>s.m(o,u))),je}function lt(C,o){const u=s.L();return s.M(u,u,[1,1,0]),s.N(u,u,[.5*C.width,.5*C.height,1]),C.calculatePosMatrix?s.O(u,u,C.calculatePosMatrix(o.toUnwrapped())):u}function _t(C,o,u,g,x,E,k){var F;const U=function(re,ce,ve){if(re)for(const Le of re){const ze=ce[Le];if(ze&&ze.source===ve&&ze.type==="fill-extrusion")return!0}else for(const Le in ce){const ze=ce[Le];if(ze.source===ve&&ze.type==="fill-extrusion")return!0}return!1}((F=x?.layers)!==null&&F!==void 0?F:null,o,C.id),Z=E.maxPitchScaleFactor(),K=C.tilesIn(g,Z,U);K.sort(wt);const oe=[];for(const re of K)oe.push({wrappedTileID:re.tileID.wrapped().key,queryResults:re.tile.queryRenderedFeatures(o,u,C._state,re.queryGeometry,re.cameraQueryGeometry,re.scale,x,E,Z,lt(C.transform,re.tileID),k?(ce,ve)=>k(re.tileID,ce,ve):void 0)});return function(re,ce){for(const ve in re)for(const Le of re[ve])cn(Le,ce);return re}(function(re){const ce={},ve={};for(const Le of re){const ze=Le.queryResults,Ne=Le.wrappedTileID,Ge=ve[Ne]=ve[Ne]||{};for(const et in ze){const Xe=ze[et],at=Ge[et]=Ge[et]||{},ht=ce[et]=ce[et]||[];for(const Ye of Xe)at[Ye.featureIndex]||(at[Ye.featureIndex]=!0,ht.push(Ye))}}return ce}(oe),C)}function wt(C,o){const u=C.tileID,g=o.tileID;return u.overscaledZ-g.overscaledZ||u.canonical.y-g.canonical.y||u.wrap-g.wrap||u.canonical.x-g.canonical.x}function cn(C,o){const u=C.feature,g=o.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=g}function dn(C,o,u){return s._(this,void 0,void 0,function*(){let g=C;if(C.url?g=(yield s.j(o.transformRequest(C.url,"Source"),u)).data:yield S.frameAsync(u),!g)return null;const x=s.Q(s.e(g,C),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in g&&g.vector_layers&&(x.vectorLayerIds=g.vector_layers.map(E=>E.id)),x})}class tn{constructor(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):Array.isArray(o)&&(o.length===4?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof s.S?new s.S(o.lng,o.lat):s.S.convert(o),this}setSouthWest(o){return this._sw=o instanceof s.S?new s.S(o.lng,o.lat):s.S.convert(o),this}extend(o){const u=this._sw,g=this._ne;let x,E;if(o instanceof s.S)x=o,E=o;else{if(!(o instanceof tn))return Array.isArray(o)?o.length===4||o.every(Array.isArray)?this.extend(tn.convert(o)):this.extend(s.S.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(s.S.convert(o)):this;if(x=o._sw,E=o._ne,!x||!E)return this}return u||g?(u.lng=Math.min(x.lng,u.lng),u.lat=Math.min(x.lat,u.lat),g.lng=Math.max(E.lng,g.lng),g.lat=Math.max(E.lat,g.lat)):(this._sw=new s.S(x.lng,x.lat),this._ne=new s.S(E.lng,E.lat)),this}getCenter(){return new s.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.S(this.getWest(),this.getNorth())}getSouthEast(){return new s.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:g}=s.S.convert(o);let x=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(x=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=g&&g<=this._ne.lat&&x}static convert(o){return o instanceof tn?o:o&&new tn(o)}static fromLngLat(o,u=0){const g=360*u/40075017,x=g/Math.cos(Math.PI/180*o.lat);return new tn(new s.S(o.lng-x,o.lat-g),new s.S(o.lng+x,o.lat+g))}adjustAntiMeridian(){const o=new s.S(this._sw.lng,this._sw.lat),u=new s.S(this._ne.lng,this._ne.lat);return new tn(o,o.lng>u.lng?new s.S(u.lng+360,u.lat):u)}}class Je{constructor(o,u,g){this.bounds=tn.convert(this.validateBounds(o)),this.minzoom=u||0,this.maxzoom=g||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const u=Math.pow(2,o.z),g=Math.floor(s.V(this.bounds.getWest())*u),x=Math.floor(s.U(this.bounds.getNorth())*u),E=Math.ceil(s.V(this.bounds.getEast())*u),k=Math.ceil(s.U(this.bounds.getSouth())*u);return o.x>=g&&o.x<E&&o.y>=x&&o.y<k}}class Tn extends s.E{constructor(o,u,g,x){if(super(),this.id=o,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.Q(u,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield dn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o&&(s.e(this,o),o.bounds&&(this.tileBounds=new Je(o.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new s.k(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(o){return s._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g={request:this.map._requestManager.transformRequest(u,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};g.request.collectResourceTiming=this._collectResourceTiming;let x="RT";if(o.actor&&o.state!=="expired"){if(o.state==="loading")return new Promise((E,k)=>{o.reloadPromise={resolve:E,reject:k}})}else o.actor=this.dispatcher.getActor(),x="LT";o.abortController=new AbortController;try{const E=yield o.actor.sendAsync({type:x,data:g},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,E)}catch(E){if(delete o.abortController,o.aborted)return;if(E&&E.status!==404)throw E;this._afterTileLoadWorkerResponse(o,null)}})}_afterTileLoadWorkerResponse(o,u){if(u&&u.resourceTiming&&(o.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&o.setExpiryData(u),o.loadVectorData(u,this.map.painter),o.reloadPromise){const g=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(g.resolve).catch(g.reject)}}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Kt extends s.E{constructor(o,u,g,x){super(),this.id=o,this.dispatcher=g,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},u),s.e(this,s.Q(u,["url","scheme","tileSize"]))}load(){return s._(this,arguments,void 0,function*(o=!1){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield dn(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(s.e(this,u),u.bounds&&(this.tileBounds=new Je(u.bounds,this.minzoom,this.maxzoom)),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:o})))}catch(u){this._tileJSONRequest=null,this.fire(new s.k(u))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load(!0)}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return s.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return s._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const g=yield H.getImage(this.map._requestManager.transformRequest(u,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(g&&g.data){this.map._refreshExpiredTiles&&(g.cacheControl||g.expires)&&o.setExpiryData({cacheControl:g.cacheControl,expires:g.expires});const x=this.map.painter.context,E=x.gl,k=g.data;o.texture=this.map.painter.getTileTexture(k.width),o.texture?o.texture.update(k,{useMipmap:!0}):(o.texture=new s.T(x,k,E.RGBA,{useMipmap:!0}),o.texture.bind(E.LINEAR,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(g){if(delete o.abortController,o.aborted)o.state="unloaded";else if(g)throw o.state="errored",g}})}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class fn extends Kt{constructor(o,u,g,x){super(o,u,g,x),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(o){return s._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),g=this.map._requestManager.transformRequest(u,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const x=yield H.getImage(g,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(x&&x.data){const E=x.data;this.map._refreshExpiredTiles&&(x.cacheControl||x.expires)&&o.setExpiryData({cacheControl:x.cacheControl,expires:x.expires});const k=s.b(E)&&s.W()?E:yield this.readImageNow(E),F={type:this.type,uid:o.uid,source:this.id,rawImageData:k,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||o.state==="expired"){o.actor=this.dispatcher.getActor();const U=yield o.actor.sendAsync({type:"LDT",data:F});o.dem=U,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(x){if(delete o.abortController,o.aborted)o.state="unloaded";else if(x)throw o.state="errored",x}})}readImageNow(o){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.X()){const u=o.width+2,g=o.height+2;try{return new s.R({width:u,height:g},yield s.Y(o,-1,-1,u,g))}catch{}}return S.getImageData(o,1)})}_getNeighboringTiles(o){const u=o.canonical,g=Math.pow(2,u.z),x=(u.x-1+g)%g,E=u.x===0?o.wrap-1:o.wrap,k=(u.x+1+g)%g,F=u.x+1===g?o.wrap+1:o.wrap,U={};return U[new s.Z(o.overscaledZ,E,u.z,x,u.y).key]={backfilled:!1},U[new s.Z(o.overscaledZ,F,u.z,k,u.y).key]={backfilled:!1},u.y>0&&(U[new s.Z(o.overscaledZ,E,u.z,x,u.y-1).key]={backfilled:!1},U[new s.Z(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},U[new s.Z(o.overscaledZ,F,u.z,k,u.y-1).key]={backfilled:!1}),u.y+1<g&&(U[new s.Z(o.overscaledZ,E,u.z,x,u.y+1).key]={backfilled:!1},U[new s.Z(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},U[new s.Z(o.overscaledZ,F,u.z,k,u.y+1).key]={backfilled:!1}),U}unloadTile(o){return s._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}class Ut extends s.E{constructor(o,u,g,x){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(x),this._data=u.data,this._options=s.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:s.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(o){return o*(s.$/this.tileSize)}_getClusterMaxZoom(o){const u=o?Math.round(o):this.maxzoom-1;return Number.isInteger(o)||o===void 0||s.w(`Integer expected for option 'clusterMaxZoom': provided value "${o}" rounded to "${u}"`),u}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._updateWorkerData(),this}updateData(o){return this._updateWorkerData(o),this}getData(){return s._(this,void 0,void 0,function*(){const o=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}getCoordinatesFromGeometry(o){return o.type==="GeometryCollection"?o.geometries.map(u=>u.coordinates).flat(1/0):o.coordinates.flat(1/0)}getBounds(){return s._(this,void 0,void 0,function*(){const o=new tn,u=yield this.getData();let g;switch(u.type){case"FeatureCollection":g=u.features.map(x=>this.getCoordinatesFromGeometry(x.geometry)).flat(1/0);break;case"Feature":g=this.getCoordinatesFromGeometry(u.geometry);break;default:g=this.getCoordinatesFromGeometry(u)}if(g.length==0)return o;for(let x=0;x<g.length-1;x+=2)o.extend([g[x],g[x+1]]);return o})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(o.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(o.clusterRadius)),o.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(o.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,u,g){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:u,offset:g}})}_updateWorkerData(o){return s._(this,void 0,void 0,function*(){const u=s.e({type:this.type},this.workerOptions);o?u.dataDiff=o:typeof this._data=="string"?(u.request=this.map._requestManager.transformRequest(S.resolveURL(this._data),"Source"),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new s.l("dataloading",{dataType:"source"}));try{const g=yield this.actor.sendAsync({type:"LD",data:u});if(this._pendingLoads--,this._removed||g.abandoned)return void this.fire(new s.l("dataabort",{dataType:"source"}));let x=null;g.resourceTiming&&g.resourceTiming[this.id]&&(x=g.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&s.e(E,{resourceTiming:x}),this.fire(new s.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new s.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(g){if(this._pendingLoads--,this._removed)return void this.fire(new s.l("dataabort",{dataType:"source"}));this.fire(new s.k(g))}})}loaded(){return this._pendingLoads===0}loadTile(o){return s._(this,void 0,void 0,function*(){const u=o.actor?"RT":"LT";o.actor=this.actor;const g={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};o.abortController=new AbortController;const x=yield this.actor.sendAsync({type:u,data:g},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(x,this.map.painter,u==="RT")})}abortTile(o){return s._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return s._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class On extends s.E{constructor(o,u,g,x){super(),this.flippedWindingOrder=!1,this.id=o,this.dispatcher=g,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=u}load(o){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield H.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,o&&(this.coordinates=o),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new s.k(u))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const u=o.map(s.a0.fromLngLat);var g;return this.tileID=function(x){const E=s.a1.fromPoints(x),k=E.width(),F=E.height(),U=Math.max(k,F),Z=Math.max(0,Math.floor(-Math.log(U)/Math.LN2)),K=Math.pow(2,Z);return new s.a3(Z,Math.floor((E.minX+E.maxX)/2*K),Math.floor((E.minY+E.maxY)/2*K))}(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map(x=>this.tileID.getTilePoint(x)._round()),this.flippedWindingOrder=((g=this.tileCoords)[1].x-g[0].x)*(g[2].y-g[0].y)-(g[1].y-g[0].y)*(g[2].x-g[0].x)<0,this.fire(new s.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,u=o.gl;this.texture||(this.texture=new s.T(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let g=!1;for(const x in this.tiles){const E=this.tiles[x];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,g=!0)}g&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(o){const{minX:u,minY:g,maxX:x,maxY:E}=s.a1.fromPoints(o),k={};for(let F=0;F<=s.a2;F++){const U=Math.pow(2,F),Z=Math.floor(u*U),K=Math.floor(g*U),oe=Math.floor(x*U),re=Math.floor(E*U);k[F]={minTileX:Z,minTileY:K,maxTileX:oe,maxTileY:re}}return k}}class vn extends On{constructor(o,u,g,x){super(o,u,g,x),this.roundZoom=!0,this.type="video",this.options=u}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const u of o.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield s.a4(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new s.k(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new s.k(new s.a5(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const o=this.map.painter.context,u=o.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let g=!1;for(const x in this.tiles){const E=this.tiles[x];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,g=!0)}g&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ue extends On{constructor(o,u,g,x){super(o,u,g,x),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(E=>!Array.isArray(E)||E.length!==2||E.some(k=>typeof k!="number"))||this.fire(new s.k(new s.a5(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.k(new s.a5(`sources.${o}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.k(new s.a5(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new s.k(new s.a5(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.k(new s.a5(`sources.${o}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,g=u.gl;this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(u,this.canvas,g.RGBA,{premultiply:!0});let x=!1;for(const E in this.tiles){const k=this.tiles[E];k.state!=="loaded"&&(k.state="loaded",k.texture=this.texture,x=!0)}x&&this.fire(new s.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Se={},yt=C=>{switch(C){case"geojson":return Ut;case"image":return On;case"raster":return Kt;case"raster-dem":return fn;case"vector":return Tn;case"video":return vn;case"canvas":return Ue}return Se[C]},Nt="RTLPluginLoaded";class Ht extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ut()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return s._(this,arguments,void 0,function*(u,g=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=S.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!g)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.l(Nt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ot=null;function un(){return Ot||(Ot=new Ht),Ot}class Gt{constructor(o,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=s.a6(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const u=o+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,u,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(x,E){const k={};if(!E)return k;for(const F of x){const U=F.layerIds.map(Z=>E.getLayer(Z)).filter(Boolean);if(U.length!==0){F.layers=U,F.stateDependentLayerIds&&(F.stateDependentLayers=F.stateDependentLayerIds.map(Z=>U.filter(K=>K.id===Z)[0]));for(const Z of U)k[Z.id]=F}}return k}(o.buckets,u?.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const E=this.buckets[x];if(E instanceof s.a8){if(this.hasSymbolBuckets=!0,!g)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const E=this.buckets[x];if(E instanceof s.a8&&E.hasRTLText){this.hasRTLText=!0,un().lazyLoad();break}}this.queryPadding=0;for(const x in this.buckets){const E=this.buckets[x];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(x).queryRadius(E))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new s.a7}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const g in this.buckets){const x=this.buckets[g];x.uploadPending()&&x.upload(o)}const u=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new s.T(o,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(o,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,u,g,x,E,k,F,U,Z,K,oe){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:x,cameraQueryGeometry:E,scale:k,tileSize:this.tileSize,pixelPosMatrix:K,transform:U,params:F,queryPadding:this.queryPadding*Z,getElevation:oe},o,u,g):{}}querySourceFeatures(o,u){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const x=g.loadVTLayers(),E=u&&u.sourceLayer?u.sourceLayer:"",k=x._geojsonTileLayer||x[E];if(!k)return;const F=s.a9(u&&u.filter),{z:U,x:Z,y:K}=this.tileID.canonical,oe={z:U,x:Z,y:K};for(let re=0;re<k.length;re++){const ce=k.feature(re);if(F.needGeometry){const ze=s.aa(ce,!0);if(!F.filter(new s.F(this.tileID.overscaledZ),ze,this.tileID.canonical))continue}else if(!F.filter(new s.F(this.tileID.overscaledZ),ce))continue;const ve=g.getId(ce,E),Le=new s.ab(ce,U,Z,K,ve);Le.tile=oe,o.push(Le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const u=this.expirationTime;if(o.cacheControl){const g=s.ac(o.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const g=Date.now();let x=!1;if(this.expirationTime>g)x=!1;else if(u)if(this.expirationTime<u)x=!0;else{const E=this.expirationTime-u;E?this.expirationTime=g+Math.max(E,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(o,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(o).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const x in this.buckets){if(!u.style.hasLayer(x))continue;const E=this.buckets[x],k=E.layers[0].sourceLayer||"_geojsonTileLayer",F=g[k],U=o[k];if(!F||!U||Object.keys(U).length===0)continue;E.update(U,F,this.imageAtlas&&this.imageAtlas.patternPositions||{});const Z=u&&u.style&&u.style.getLayer(x);Z&&(this.queryPadding=Math.max(this.queryPadding,Z.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<S.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=S.now()+o}setDependencies(o,u){const g={};for(const x of u)g[x]=!0;this.dependencies[o]=g}hasDependency(o,u){for(const g of o){const x=this.dependencies[g];if(x){for(const E of u)if(x[E])return!0}}return!1}}class Zt{constructor(o,u){this.max=o,this.onRemove=u,this.reset()}reset(){for(const o in this.data)for(const u of this.data[o])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(o,u,g){const x=o.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const E={value:u,timeout:void 0};if(g!==void 0&&(E.timeout=setTimeout(()=>{this.remove(o,E)},g)),this.data[x].push(E),this.order.push(x),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const u=this.data[o].shift();return u.timeout&&clearTimeout(u.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),u.value}getByKey(o){const u=this.data[o];return u?u[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,u){if(!this.has(o))return this;const g=o.wrapped().key,x=u===void 0?0:this.data[g].indexOf(u),E=this.data[g][x];return this.data[g].splice(x,1),E.timeout&&clearTimeout(E.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(E.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(o){const u=[];for(const g in this.data)for(const x of this.data[g])o(x.value)||u.push(x);for(const g of u)this.remove(g.value.tileID,g)}}class Nn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,u,g){const x=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][x]=this.stateChanges[o][x]||{},s.e(this.stateChanges[o][x],g),this.deletedStates[o]===null){this.deletedStates[o]={};for(const E in this.state[o])E!==x&&(this.deletedStates[o][E]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][x]===null){this.deletedStates[o][x]={};for(const E in this.state[o][x])g[E]||(this.deletedStates[o][x][E]=null)}else for(const E in g)this.deletedStates[o]&&this.deletedStates[o][x]&&this.deletedStates[o][x][E]===null&&delete this.deletedStates[o][x][E]}removeFeatureState(o,u,g){if(this.deletedStates[o]===null)return;const x=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},g&&u!==void 0)this.deletedStates[o][x]!==null&&(this.deletedStates[o][x]=this.deletedStates[o][x]||{},this.deletedStates[o][x][g]=null);else if(u!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][x])for(g in this.deletedStates[o][x]={},this.stateChanges[o][x])this.deletedStates[o][x][g]=null;else this.deletedStates[o][x]=null;else this.deletedStates[o]=null}getState(o,u){const g=String(u),x=s.e({},(this.state[o]||{})[g],(this.stateChanges[o]||{})[g]);if(this.deletedStates[o]===null)return{};if(this.deletedStates[o]){const E=this.deletedStates[o][u];if(E===null)return{};for(const k in E)delete x[k]}return x}initializeTileState(o,u){o.setFeatureState(this.state,u)}coalesceChanges(o,u){const g={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const E={};for(const k in this.stateChanges[x])this.state[x][k]||(this.state[x][k]={}),s.e(this.state[x][k],this.stateChanges[x][k]),E[k]=this.state[x][k];g[x]=E}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const E={};if(this.deletedStates[x]===null)for(const k in this.state[x])E[k]={},this.state[x][k]={};else for(const k in this.deletedStates[x]){if(this.deletedStates[x][k]===null)this.state[x][k]={};else for(const F of Object.keys(this.deletedStates[x][k]))delete this.state[x][k][F];E[k]=this.state[x][k]}g[x]=g[x]||{},s.e(g[x],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const x in o)o[x].setFeatureState(g,u)}}const Yt=89.25;function Pe(C,o){const u=s.ag(o.lat,-s.ah,s.ah);return new s.P(s.V(o.lng)*C,s.U(u)*C)}function ae(C,o){return new s.a0(o.x/C,o.y/C).toLngLat()}function ue(C){return C.cameraToCenterDistance*Math.min(.85*Math.tan(s.ad(90-C.pitch)),Math.tan(s.ad(Yt-C.pitch)))}function ne(C,o){const u=C.canonical,g=o/s.ae(u.z),x=u.x+Math.pow(2,u.z)*C.wrap,E=s.af(new Float64Array(16));return s.M(E,E,[x*g,u.y*g,0]),s.N(E,E,[g/s.$,g/s.$,1]),E}function fe(C,o,u,g,x){const E=s.a0.fromLngLat(C,o),k=x*s.ai(1,C.lat),F=k*Math.cos(s.ad(u)),U=Math.sqrt(k*k-F*F),Z=U*Math.sin(s.ad(-g)),K=U*Math.cos(s.ad(-g));return new s.a0(E.x+Z,E.y+K,E.z+F)}function Oe(C,o,u){const g=o.intersectsFrustum(C);if(!u||g===0)return g;const x=o.intersectsPlane(u);return x===0?0:g===2&&x===2?2:1}function Ke(C,o,u){let g=0;const x=(u-o)/10;for(let E=0;E<10;E++)g+=x*Math.pow(Math.cos(o+(E+.5)/10*(u-o)),C);return g}function ye(C,o){return function(u,g,x,E,k){const F=2*((C-1)/s.aj(Math.cos(s.ad(Yt-k))/Math.cos(s.ad(Yt)))-1),U=Math.acos(x/E),Z=2*Ke(F-1,0,s.ad(k/2)),K=Math.min(s.ad(Yt),U+s.ad(k/2)),oe=Ke(F-1,Math.min(K,U-s.ad(k/2)),K),re=Math.atan(g/x),ce=Math.hypot(g,x);let ve=u;return ve+=s.aj(E/ce/Math.max(.5,Math.cos(s.ad(k/2)))),ve+=F*s.aj(Math.cos(re))/2,ve-=s.aj(Math.max(1,oe/Z/o))/2,ve}}const Ae=ye(9.314,3);function Be(C,o){const u=(o.roundZoom?Math.round:Math.floor)(C.zoom+s.aj(C.tileSize/o.tileSize));return Math.max(0,u)}function $e(C,o){const u=C.getCameraFrustum(),g=C.getClippingPlane(),x=C.screenPointToMercatorCoordinate(C.getCameraPoint()),E=s.a0.fromLngLat(C.center,C.elevation);x.z=E.z+Math.cos(C.pitchInRadians)*C.cameraToCenterDistance/C.worldSize;const k=C.getCoveringTilesDetailsProvider(),F=k.allowVariableZoom(C,o),U=Be(C,o),Z=o.minzoom||0,K=o.maxzoom!==void 0?o.maxzoom:C.maxZoom,oe=Math.min(Math.max(0,U),K),re=Math.pow(2,oe),ce=[re*x.x,re*x.y,0],ve=[re*E.x,re*E.y,0],Le=Math.hypot(E.x-x.x,E.y-x.y),ze=Math.abs(E.z-x.z),Ne=Math.hypot(Le,ze),Ge=at=>({zoom:0,x:0,y:0,wrap:at,fullyVisible:!1}),et=[],Xe=[];if(C.renderWorldCopies&&k.allowWorldCopies())for(let at=1;at<=3;at++)et.push(Ge(-at)),et.push(Ge(at));for(et.push(Ge(0));et.length>0;){const at=et.pop(),ht=at.x,Ye=at.y;let pt=at.fullyVisible;const Pt={x:ht,y:Ye,z:at.zoom},Mt=k.getTileBoundingVolume(Pt,at.wrap,C.elevation,o);if(!pt){const Sn=Oe(u,Mt,g);if(Sn===0)continue;pt=Sn===2}const Tt=k.distanceToTile2d(x.x,x.y,Pt,Mt);let kt=U;F&&(kt=(o.calculateTileZoom||Ae)(C.zoom+s.aj(C.tileSize/o.tileSize),Tt,ze,Ne,C.fov)),kt=(o.roundZoom?Math.round:Math.floor)(kt),kt=Math.max(0,kt);const Mn=Math.min(kt,K);if(at.wrap=k.getWrap(E,Pt,at.wrap),at.zoom>=Mn){if(at.zoom<Z)continue;const Sn=oe-at.zoom,rn=ce[0]-.5-(ht<<Sn),Vn=ce[1]-.5-(Ye<<Sn),br=o.reparseOverscaled?Math.max(at.zoom,kt):at.zoom;Xe.push({tileID:new s.Z(at.zoom===K?br:at.zoom,at.wrap,at.zoom,ht,Ye),distanceSq:s.ak([ve[0]-.5-ht,ve[1]-.5-Ye]),tileDistanceToCamera:Math.sqrt(rn*rn+Vn*Vn)})}else for(let Sn=0;Sn<4;Sn++)et.push({zoom:at.zoom+1,x:(ht<<1)+Sn%2,y:(Ye<<1)+(Sn>>1),wrap:at.wrap,fullyVisible:pt})}return Xe.sort((at,ht)=>at.distanceSq-ht.distanceSq).map(at=>at.tileID)}const He=s.a1.fromPoints([new s.P(0,0),new s.P(s.$,s.$)]);class dt extends s.E{constructor(o,u,g){super(),this.id=o,this.dispatcher=g,this.on("data",x=>this._dataHandler(x)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((x,E,k,F)=>{const U=new(yt(E.type))(x,E,k,F);if(U.id!==x)throw new Error(`Expected Source id to be ${x} instead of ${U.id}`);return U})(o,u,g,this),this._tiles={},this._cache=new Zt(0,x=>this._unloadTile(x)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Nn,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const u=this._tiles[o];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,u,g){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,u,g)}catch(x){o.state="errored",x.status!==404?this._source.fire(new s.k(x,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new s.l("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const g=this._tiles[u];g.upload(o),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(qe).map(o=>o.key)}getRenderableIds(o){const u=[];for(const g in this._tiles)this._isIdRenderable(g,o)&&u.push(this._tiles[g]);return o?u.sort((g,x)=>{const E=g.tileID,k=x.tileID,F=new s.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians),U=new s.P(k.canonical.x,k.canonical.y)._rotate(-this.transform.bearingInRadians);return E.overscaledZ-k.overscaledZ||U.y-F.y||U.x-F.x}).map(g=>g.tileID.key):u.map(g=>g.tileID).sort(qe).map(g=>g.key)}hasRenderableParent(o){const u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())}reload(o){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)o?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(o,u){return s._(this,void 0,void 0,function*(){const g=this._tiles[o];g&&(g.state!=="loading"&&(g.state=u),yield this._loadTile(g,o,u))})}_tileLoaded(o,u,g){o.timeAdded=S.now(),g==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new s.l("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const u=this.getRenderableIds();for(let x=0;x<u.length;x++){const E=u[x];if(o.neighboringTiles&&o.neighboringTiles[E]){const k=this.getTileByID(E);g(o,k),g(k,o)}}function g(x,E){x.needsHillshadePrepare=!0,x.needsTerrainPrepare=!0;let k=E.tileID.canonical.x-x.tileID.canonical.x;const F=E.tileID.canonical.y-x.tileID.canonical.y,U=Math.pow(2,x.tileID.canonical.z),Z=E.tileID.key;k===0&&F===0||Math.abs(F)>1||(Math.abs(k)>1&&(Math.abs(k+U)===1?k+=U:Math.abs(k-U)===1&&(k-=U)),E.dem&&x.dem&&(x.dem.backfillBorder(E.dem,k,F),x.neighboringTiles&&x.neighboringTiles[Z]&&(x.neighboringTiles[Z].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,u,g,x){for(const E in this._tiles){let k=this._tiles[E];if(x[E]||!k.hasData()||k.tileID.overscaledZ<=u||k.tileID.overscaledZ>g)continue;let F=k.tileID;for(;k&&k.tileID.overscaledZ>u+1;){const Z=k.tileID.scaledTo(k.tileID.overscaledZ-1);k=this._tiles[Z.key],k&&k.hasData()&&(F=Z)}let U=F;for(;U.overscaledZ>u;)if(U=U.scaledTo(U.overscaledZ-1),o[U.key]||o[U.canonical.key]){x[F.key]=F;break}}}findLoadedParent(o,u){if(o.key in this._loadedParentTiles){const g=this._loadedParentTiles[o.key];return g&&g.tileID.overscaledZ>=u?g:null}for(let g=o.overscaledZ-1;g>=u;g--){const x=o.scaledTo(g),E=this._getLoadedTile(x);if(E)return E}}findLoadedSibling(o){return this._getLoadedTile(o)}_getLoadedTile(o){const u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const u=Math.ceil(o.width/this._source.tileSize)+1,g=Math.ceil(o.height/this._source.tileSize)+1,x=Math.floor(u*g*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(E)}handleWrapJump(o){const u=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,u){const g={};for(const x in this._tiles){const E=this._tiles[x];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+u),g[E.tileID.key]=E}this._tiles=g;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(x,this._tiles[x])}}_updateCoveredAndRetainedTiles(o,u,g,x,E,k){const F={},U={},Z=Object.keys(o),K=S.now();for(const oe of Z){const re=o[oe],ce=this._tiles[oe];if(!ce||ce.fadeEndTime!==0&&ce.fadeEndTime<=K)continue;const ve=this.findLoadedParent(re,u),Le=this.findLoadedSibling(re),ze=ve||Le||null;ze&&(this._addTile(ze.tileID),F[ze.tileID.key]=ze.tileID),U[oe]=re}this._retainLoadedChildren(U,x,g,o);for(const oe in F)o[oe]||(this._coveredTiles[oe]=!0,o[oe]=F[oe]);if(k){const oe={},re={};for(const ce of E)this._tiles[ce.key].hasData()?oe[ce.key]=ce:re[ce.key]=ce;for(const ce in re){const ve=re[ce].children(this._source.maxzoom);this._tiles[ve[0].key]&&this._tiles[ve[1].key]&&this._tiles[ve[2].key]&&this._tiles[ve[3].key]&&(oe[ve[0].key]=o[ve[0].key]=ve[0],oe[ve[1].key]=o[ve[1].key]=ve[1],oe[ve[2].key]=o[ve[2].key]=ve[2],oe[ve[3].key]=o[ve[3].key]=ve[3],delete re[ce])}for(const ce in re){const ve=re[ce],Le=this.findLoadedParent(ve,this._source.minzoom),ze=this.findLoadedSibling(ve),Ne=Le||ze||null;if(Ne){oe[Ne.tileID.key]=o[Ne.tileID.key]=Ne.tileID;for(const Ge in oe)oe[Ge].isChildOf(Ne.tileID)&&delete oe[Ge]}}for(const ce in this._tiles)oe[ce]||(this._coveredTiles[ce]=!0)}}update(o,u){if(!this._sourceLoaded||this._paused)return;let g;this.transform=o,this.terrain=u,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(K=>new s.Z(K.canonical.z,K.wrap,K.canonical.z,K.canonical.x,K.canonical.y)):(g=$e(o,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(g=g.filter(K=>this._source.hasTile(K)))):g=[];const x=Be(o,this._source),E=Math.max(x-dt.maxOverzooming,this._source.minzoom),k=Math.max(x+dt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const K={};for(const oe of g)if(oe.canonical.z>this._source.minzoom){const re=oe.scaledTo(oe.canonical.z-1);K[re.key]=re;const ce=oe.scaledTo(Math.max(this._source.minzoom,Math.min(oe.canonical.z,5)));K[ce.key]=ce}g=g.concat(Object.values(K))}const F=g.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,F&&this.fire(new s.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const U=this._updateRetainedTiles(g,x);$t(this._source.type)&&this._updateCoveredAndRetainedTiles(U,E,k,x,g,u);for(const K in U)this._tiles[K].clearFadeHold();const Z=s.al(this._tiles,U);for(const K of Z){const oe=this._tiles[K];oe.hasSymbolBuckets&&!oe.holdingForFade()?oe.setHoldDuration(this.map._fadeDuration):oe.hasSymbolBuckets&&!oe.symbolFadeFinished()||this._removeTile(K)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,u){var g;const x={},E={},k=Math.max(u-dt.maxOverzooming,this._source.minzoom),F=Math.max(u+dt.maxUnderzooming,this._source.minzoom),U={};for(const Z of o){const K=this._addTile(Z);x[Z.key]=Z,K.hasData()||u<this._source.maxzoom&&(U[Z.key]=Z)}this._retainLoadedChildren(U,u,F,x);for(const Z of o){let K=this._tiles[Z.key];if(K.hasData())continue;if(u+1>this._source.maxzoom){const re=Z.children(this._source.maxzoom)[0],ce=this.getTile(re);if(ce&&ce.hasData()){x[re.key]=re;continue}}else{const re=Z.children(this._source.maxzoom);if(x[re[0].key]&&x[re[1].key]&&x[re[2].key]&&x[re[3].key])continue}let oe=K.wasRequested();for(let re=Z.overscaledZ-1;re>=k;--re){const ce=Z.scaledTo(re);if(E[ce.key])break;if(E[ce.key]=!0,K=this.getTile(ce),!K&&oe&&(K=this._addTile(ce)),K){const ve=K.hasData();if((ve||!(!((g=this.map)===null||g===void 0)&&g.cancelPendingTileRequestsWhileZooming)||oe)&&(x[ce.key]=ce),oe=K.wasRequested(),ve)break}}}return x}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const u=[];let g,x=this._tiles[o].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){g=this._loadedParentTiles[x.key];break}u.push(x.key);const E=x.scaledTo(x.overscaledZ-1);if(g=this._getLoadedTile(E),g)break;x=E}for(const E of u)this._loadedParentTiles[E]=g}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const o in this._tiles){const u=this._tiles[o].tileID,g=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=g}}_addTile(o){let u=this._tiles[o.key];if(u)return u;u=this._cache.getAndRemove(o),u&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));const g=u;return u||(u=new Gt(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,o.key,u.state)),u.uses++,this._tiles[o.key]=u,g||this._source.fire(new s.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(o,u){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const g=u.getExpiryTimeout();g&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},g))}refreshTiles(o){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&o.some(g=>g.equals(this._tiles[u].tileID.canonical))&&this._reloadTile(u,"expired")}_removeTile(o){const u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(o){const u=o.sourceDataType;o.dataType==="source"&&u==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&o.dataType==="source"&&u==="content"&&(this.reload(o.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,u,g){const x=[],E=this.transform;if(!E)return x;const k=E.getCoveringTilesDetailsProvider().allowWorldCopies(),F=g?E.getCameraQueryGeometry(o):o,U=ce=>E.screenPointToMercatorCoordinate(ce,this.terrain),Z=this.transformBbox(o,U,!k),K=this.transformBbox(F,U,!k),oe=this.getIds(),re=s.a1.fromPoints(K);for(let ce=0;ce<oe.length;ce++){const ve=this._tiles[oe[ce]];if(ve.holdingForFade())continue;const Le=k?[ve.tileID]:[ve.tileID.unwrapTo(-1),ve.tileID.unwrapTo(0)],ze=Math.pow(2,E.zoom-ve.tileID.overscaledZ),Ne=u*ve.queryPadding*s.$/ve.tileSize/ze;for(const Ge of Le){const et=re.map(Xe=>Ge.getTilePoint(new s.a0(Xe.x,Xe.y)));if(et.expandBy(Ne),et.intersects(He)){const Xe=Z.map(ht=>Ge.getTilePoint(ht)),at=K.map(ht=>Ge.getTilePoint(ht));x.push({tile:ve,tileID:k?Ge:Ge.unwrapTo(0),queryGeometry:Xe,cameraQueryGeometry:at,scale:ze})}}}return x}transformBbox(o,u,g){let x=o.map(u);if(g){const E=s.a1.fromPoints(o);E.shrinkBy(.001*Math.min(E.width(),E.height()));const k=E.map(u);s.a1.fromPoints(x).covers(k)||(x=x.map(F=>F.x>.5?new s.a0(F.x-1,F.y,F.z):F))}return x}getVisibleCoordinates(o){const u=this.getRenderableIds(o).map(g=>this._tiles[g].tileID);return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if($t(this._source.type)){const o=S.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=o)return!0}return!1}setFeatureState(o,u,g){this._state.updateState(o=o||"_geojsonTileLayer",u,g)}removeFeatureState(o,u,g){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,g)}getFeatureState(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)}setDependencies(o,u,g){const x=this._tiles[o];x&&x.setDependencies(u,g)}reloadTilesForDependencies(o,u){for(const g in this._tiles)this._tiles[g].hasDependency(o,u)&&this._reloadTile(g,"reloading");this._cache.filter(g=>!g.hasDependency(o,u))}}function qe(C,o){const u=Math.abs(2*C.wrap)-+(C.wrap<0),g=Math.abs(2*o.wrap)-+(o.wrap<0);return C.overscaledZ-o.overscaledZ||g-u||o.canonical.y-C.canonical.y||o.canonical.x-C.canonical.x}function $t(C){return C==="raster"||C==="image"||C==="video"}dt.maxOverzooming=10,dt.maxUnderzooming=3;class Jt{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=s.ag(o,0,1);let u=1,g=this._distances[u];const x=o*this.paddedLength+this.padding;for(;g<x&&u<this._distances.length;)g=this._distances[++u];const E=u-1,k=this._distances[E],F=g-k,U=F>0?(x-k)/F:0;return this.points[E].mult(1-U).add(this.points[u].mult(U))}}function Ie(C,o){let u=!0;return C==="always"||C!=="never"&&o!=="never"||(u=!1),u}class ot{constructor(o,u,g){const x=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(o/g),this.yCellCount=Math.ceil(u/g);for(let k=0;k<this.xCellCount*this.yCellCount;k++)x.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,g,x,E){this._forEachCell(u,g,x,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(x),this.bboxes.push(E)}insertCircle(o,u,g,x){this._forEachCell(u-x,g-x,u+x,g+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(g),this.circles.push(x)}_insertBoxCell(o,u,g,x,E,k){this.boxCells[E].push(k)}_insertCircleCell(o,u,g,x,E,k){this.circleCells[E].push(k)}_query(o,u,g,x,E,k,F){if(g<0||o>this.width||x<0||u>this.height)return[];const U=[];if(o<=0&&u<=0&&this.width<=g&&this.height<=x){if(E)return[{key:null,x1:o,y1:u,x2:g,y2:x}];for(let Z=0;Z<this.boxKeys.length;Z++)U.push({key:this.boxKeys[Z],x1:this.bboxes[4*Z],y1:this.bboxes[4*Z+1],x2:this.bboxes[4*Z+2],y2:this.bboxes[4*Z+3]});for(let Z=0;Z<this.circleKeys.length;Z++){const K=this.circles[3*Z],oe=this.circles[3*Z+1],re=this.circles[3*Z+2];U.push({key:this.circleKeys[Z],x1:K-re,y1:oe-re,x2:K+re,y2:oe+re})}}else this._forEachCell(o,u,g,x,this._queryCell,U,{hitTest:E,overlapMode:k,seenUids:{box:{},circle:{}}},F);return U}query(o,u,g,x){return this._query(o,u,g,x,!1,null)}hitTest(o,u,g,x,E,k){return this._query(o,u,g,x,!0,E,k).length>0}hitTestCircle(o,u,g,x,E){const k=o-g,F=o+g,U=u-g,Z=u+g;if(F<0||k>this.width||Z<0||U>this.height)return!1;const K=[];return this._forEachCell(k,U,F,Z,this._queryCellCircle,K,{hitTest:!0,overlapMode:x,circle:{x:o,y:u,radius:g},seenUids:{box:{},circle:{}}},E),K.length>0}_queryCell(o,u,g,x,E,k,F,U){const{seenUids:Z,hitTest:K,overlapMode:oe}=F,re=this.boxCells[E];if(re!==null){const ve=this.bboxes;for(const Le of re)if(!Z.box[Le]){Z.box[Le]=!0;const ze=4*Le,Ne=this.boxKeys[Le];if(o<=ve[ze+2]&&u<=ve[ze+3]&&g>=ve[ze+0]&&x>=ve[ze+1]&&(!U||U(Ne))&&(!K||!Ie(oe,Ne.overlapMode))&&(k.push({key:Ne,x1:ve[ze],y1:ve[ze+1],x2:ve[ze+2],y2:ve[ze+3]}),K))return!0}}const ce=this.circleCells[E];if(ce!==null){const ve=this.circles;for(const Le of ce)if(!Z.circle[Le]){Z.circle[Le]=!0;const ze=3*Le,Ne=this.circleKeys[Le];if(this._circleAndRectCollide(ve[ze],ve[ze+1],ve[ze+2],o,u,g,x)&&(!U||U(Ne))&&(!K||!Ie(oe,Ne.overlapMode))){const Ge=ve[ze],et=ve[ze+1],Xe=ve[ze+2];if(k.push({key:Ne,x1:Ge-Xe,y1:et-Xe,x2:Ge+Xe,y2:et+Xe}),K)return!0}}}return!1}_queryCellCircle(o,u,g,x,E,k,F,U){const{circle:Z,seenUids:K,overlapMode:oe}=F,re=this.boxCells[E];if(re!==null){const ve=this.bboxes;for(const Le of re)if(!K.box[Le]){K.box[Le]=!0;const ze=4*Le,Ne=this.boxKeys[Le];if(this._circleAndRectCollide(Z.x,Z.y,Z.radius,ve[ze+0],ve[ze+1],ve[ze+2],ve[ze+3])&&(!U||U(Ne))&&!Ie(oe,Ne.overlapMode))return k.push(!0),!0}}const ce=this.circleCells[E];if(ce!==null){const ve=this.circles;for(const Le of ce)if(!K.circle[Le]){K.circle[Le]=!0;const ze=3*Le,Ne=this.circleKeys[Le];if(this._circlesCollide(ve[ze],ve[ze+1],ve[ze+2],Z.x,Z.y,Z.radius)&&(!U||U(Ne))&&!Ie(oe,Ne.overlapMode))return k.push(!0),!0}}}_forEachCell(o,u,g,x,E,k,F,U){const Z=this._convertToXCellCoord(o),K=this._convertToYCellCoord(u),oe=this._convertToXCellCoord(g),re=this._convertToYCellCoord(x);for(let ce=Z;ce<=oe;ce++)for(let ve=K;ve<=re;ve++)if(E.call(this,o,u,g,x,this.xCellCount*ve+ce,k,F,U))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,g,x,E,k){const F=x-o,U=E-u,Z=g+k;return Z*Z>F*F+U*U}_circleAndRectCollide(o,u,g,x,E,k,F){const U=(k-x)/2,Z=Math.abs(o-(x+U));if(Z>U+g)return!1;const K=(F-E)/2,oe=Math.abs(u-(E+K));if(oe>K+g)return!1;if(Z<=U||oe<=K)return!0;const re=Z-U,ce=oe-K;return re*re+ce*ce<=g*g}}function mt(C,o,u){const g=s.L();if(!C){const{vecSouth:oe,vecEast:re}=nn(o),ce=y();ce[0]=re[0],ce[1]=re[1],ce[2]=oe[0],ce[3]=oe[1],x=ce,(K=(k=(E=ce)[0])*(Z=E[3])-(U=E[2])*(F=E[1]))&&(x[0]=Z*(K=1/K),x[1]=-F*K,x[2]=-U*K,x[3]=k*K),g[0]=ce[0],g[1]=ce[1],g[4]=ce[2],g[5]=ce[3]}var x,E,k,F,U,Z,K;return s.N(g,g,[1/u,1/u,1]),g}function Wt(C,o,u,g){if(C){const x=s.L();if(!o){const{vecSouth:E,vecEast:k}=nn(u);x[0]=k[0],x[1]=k[1],x[4]=E[0],x[5]=E[1]}return s.N(x,x,[g,g,1]),x}return u.pixelsToClipSpaceMatrix}function nn(C){const o=Math.cos(C.rollInRadians),u=Math.sin(C.rollInRadians),g=Math.cos(C.pitchInRadians),x=Math.cos(C.bearingInRadians),E=Math.sin(C.bearingInRadians),k=s.aq();k[0]=-x*g*u-E*o,k[1]=-E*g*u+x*o;const F=s.ar(k);F<1e-9?s.as(k):s.at(k,k,1/F);const U=s.aq();U[0]=x*g*o-E*u,U[1]=E*g*o+x*u;const Z=s.ar(U);return Z<1e-9?s.as(U):s.at(U,U,1/Z),{vecEast:U,vecSouth:k}}function mn(C,o,u,g){let x;g?(x=[C,o,g(C,o),1],s.av(x,x,u)):(x=[C,o,0,1],Dt(x,x,u));const E=x[3];return{point:new s.P(x[0]/E,x[1]/E),signedDistanceFromCamera:E,isOccluded:!1}}function on(C,o){return .5+C/o*.5}function sn(C,o){return C.x>=-o[0]&&C.x<=o[0]&&C.y>=-o[1]&&C.y<=o[1]}function Dn(C,o,u,g,x,E,k,F,U,Z,K,oe,re){const ce=u?C.textSizeData:C.iconSizeData,ve=s.am(ce,o.transform.zoom),Le=[256/o.width*2+1,256/o.height*2+1],ze=u?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;ze.clear();const Ne=C.lineVertexArray,Ge=u?C.text.placedSymbolArray:C.icon.placedSymbolArray,et=o.transform.width/o.transform.height;let Xe=!1;for(let at=0;at<Ge.length;at++){const ht=Ge.get(at);if(ht.hidden||ht.writingMode===s.an.vertical&&!Xe){vt(ht.numGlyphs,ze);continue}Xe=!1;const Ye=new s.P(ht.anchorX,ht.anchorY),pt={getElevation:re,pitchedLabelPlaneMatrix:g,lineVertexArray:Ne,pitchWithMap:E,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:o.transform,tileAnchorPoint:Ye,unwrappedTileID:U,width:Z,height:K,translation:oe},Pt=hn(ht.anchorX,ht.anchorY,pt);if(!sn(Pt.point,Le)){vt(ht.numGlyphs,ze);continue}const Mt=on(o.transform.cameraToCenterDistance,Pt.signedDistanceFromCamera),Tt=s.ao(ce,ve,ht),kt=E?Tt*o.transform.getPitchedTextCorrection(ht.anchorX,ht.anchorY,U)/Mt:Tt*Mt,Mn=Fn({projectionContext:pt,pitchedLabelPlaneMatrixInverse:x,symbol:ht,fontSize:kt,flip:!1,keepUpright:k,glyphOffsetArray:C.glyphOffsetArray,dynamicLayoutVertexArray:ze,aspectRatio:et,rotateToLine:F});Xe=Mn.useVertical,(Mn.notEnoughRoom||Xe||Mn.needsFlipping&&Fn({projectionContext:pt,pitchedLabelPlaneMatrixInverse:x,symbol:ht,fontSize:kt,flip:!0,keepUpright:k,glyphOffsetArray:C.glyphOffsetArray,dynamicLayoutVertexArray:ze,aspectRatio:et,rotateToLine:F}).notEnoughRoom)&&vt(ht.numGlyphs,ze)}u?C.text.dynamicLayoutVertexBuffer.updateData(ze):C.icon.dynamicLayoutVertexBuffer.updateData(ze)}function Et(C,o,u,g,x,E,k,F){const U=E.glyphStartIndex+E.numGlyphs,Z=E.lineStartIndex,K=E.lineStartIndex+E.lineLength,oe=o.getoffsetX(E.glyphStartIndex),re=o.getoffsetX(U-1),ce=xr(C*oe,u,g,x,E.segment,Z,K,F,k);if(!ce)return null;const ve=xr(C*re,u,g,x,E.segment,Z,K,F,k);return ve?F.projectionCache.anyProjectionOccluded?null:{first:ce,last:ve}:null}function Gn(C,o,u,g){return C===s.an.horizontal&&Math.abs(u.y-o.y)>Math.abs(u.x-o.x)*g?{useVertical:!0}:(C===s.an.vertical?o.y<u.y:o.x>u.x)?{needsFlipping:!0}:null}function Fn(C){const{projectionContext:o,pitchedLabelPlaneMatrixInverse:u,symbol:g,fontSize:x,flip:E,keepUpright:k,glyphOffsetArray:F,dynamicLayoutVertexArray:U,aspectRatio:Z,rotateToLine:K}=C,oe=x/24,re=g.lineOffsetX*oe,ce=g.lineOffsetY*oe;let ve;if(g.numGlyphs>1){const Le=g.glyphStartIndex+g.numGlyphs,ze=g.lineStartIndex,Ne=g.lineStartIndex+g.lineLength,Ge=Et(oe,F,re,ce,E,g,K,o);if(!Ge)return{notEnoughRoom:!0};const et=qt(Ge.first.point.x,Ge.first.point.y,o,u),Xe=qt(Ge.last.point.x,Ge.last.point.y,o,u);if(k&&!E){const at=Gn(g.writingMode,et,Xe,Z);if(at)return at}ve=[Ge.first];for(let at=g.glyphStartIndex+1;at<Le-1;at++){const ht=xr(oe*F.getoffsetX(at),re,ce,E,g.segment,ze,Ne,o,K);if(!ht)return{notEnoughRoom:!0};ve.push(ht)}ve.push(Ge.last)}else{if(k&&!E){const ze=nt(o.tileAnchorPoint.x,o.tileAnchorPoint.y,o).point,Ne=g.lineStartIndex+g.segment+1,Ge=new s.P(o.lineVertexArray.getx(Ne),o.lineVertexArray.gety(Ne)),et=nt(Ge.x,Ge.y,o),Xe=et.signedDistanceFromCamera>0?et.point:or(o.tileAnchorPoint,Ge,ze,1,o),at=qt(ze.x,ze.y,o,u),ht=qt(Xe.x,Xe.y,o,u),Ye=Gn(g.writingMode,at,ht,Z);if(Ye)return Ye}const Le=xr(oe*F.getoffsetX(g.glyphStartIndex),re,ce,E,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,o,K);if(!Le||o.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ve=[Le]}for(const Le of ve)s.au(U,Le.point,Le.angle);return{}}function or(C,o,u,g,x){const E=C.add(C.sub(o)._unit()),k=nt(E.x,E.y,x).point,F=u.sub(k);return u.add(F._mult(g/F.mag()))}function It(C,o,u){const g=o.projectionCache;if(g.projections[C])return g.projections[C];const x=new s.P(o.lineVertexArray.getx(C),o.lineVertexArray.gety(C)),E=nt(x.x,x.y,o);if(E.signedDistanceFromCamera>0)return g.projections[C]=E.point,g.anyProjectionOccluded=g.anyProjectionOccluded||E.isOccluded,E.point;const k=C-u.direction;return or(u.distanceFromAnchor===0?o.tileAnchorPoint:new s.P(o.lineVertexArray.getx(k),o.lineVertexArray.gety(k)),x,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,o)}function nt(C,o,u){const g=C+u.translation[0],x=o+u.translation[1];let E;return u.pitchWithMap?(E=mn(g,x,u.pitchedLabelPlaneMatrix,u.getElevation),E.isOccluded=!1):(E=u.transform.projectTileCoordinates(g,x,u.unwrappedTileID,u.getElevation),E.point.x=(.5*E.point.x+.5)*u.width,E.point.y=(.5*-E.point.y+.5)*u.height),E}function qt(C,o,u,g){if(u.pitchWithMap){const x=[C,o,0,1];return s.av(x,x,g),u.transform.projectTileCoordinates(x[0]/x[3],x[1]/x[3],u.unwrappedTileID,u.getElevation).point}return{x:C/u.width*2-1,y:1-o/u.height*2}}function hn(C,o,u){return u.transform.projectTileCoordinates(C,o,u.unwrappedTileID,u.getElevation)}function kn(C,o,u){return C._unit()._perp()._mult(o*u)}function Ir(C,o,u,g,x,E,k,F,U){if(F.projectionCache.offsets[C])return F.projectionCache.offsets[C];const Z=u.add(o);if(C+U.direction<g||C+U.direction>=x)return F.projectionCache.offsets[C]=Z,Z;const K=It(C+U.direction,F,U),oe=kn(K.sub(u),k,U.direction),re=u.add(oe),ce=K.add(oe);return F.projectionCache.offsets[C]=s.aw(E,Z,re,ce)||Z,F.projectionCache.offsets[C]}function xr(C,o,u,g,x,E,k,F,U){const Z=g?C-o:C+o;let K=Z>0?1:-1,oe=0;g&&(K*=-1,oe=Math.PI),K<0&&(oe+=Math.PI);let re,ce=K>0?E+x:E+x+1;F.projectionCache.cachedAnchorPoint?re=F.projectionCache.cachedAnchorPoint:(re=nt(F.tileAnchorPoint.x,F.tileAnchorPoint.y,F).point,F.projectionCache.cachedAnchorPoint=re);let ve,Le,ze=re,Ne=re,Ge=0,et=0;const Xe=Math.abs(Z),at=[];let ht;for(;Ge+et<=Xe;){if(ce+=K,ce<E||ce>=k)return null;Ge+=et,Ne=ze,Le=ve;const Pt={absOffsetX:Xe,direction:K,distanceFromAnchor:Ge,previousVertex:Ne};if(ze=It(ce,F,Pt),u===0)at.push(Ne),ht=ze.sub(Ne);else{let Mt;const Tt=ze.sub(Ne);Mt=Tt.mag()===0?kn(It(ce+K,F,Pt).sub(ze),u,K):kn(Tt,u,K),Le||(Le=Ne.add(Mt)),ve=Ir(ce,Mt,ze,E,k,Le,u,F,Pt),at.push(Le),ht=ve.sub(Le)}et=ht.mag()}const Ye=ht._mult((Xe-Ge)/et)._add(Le||Ne),pt=oe+Math.atan2(ze.y-Ne.y,ze.x-Ne.x);return at.push(Ye),{point:Ye,angle:U?pt:0,path:at}}const xe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function vt(C,o){for(let u=0;u<C;u++){const g=o.length;o.resize(g+4),o.float32.set(xe,3*g)}}function Dt(C,o,u){const g=o[0],x=o[1];return C[0]=u[0]*g+u[4]*x+u[12],C[1]=u[1]*g+u[5]*x+u[13],C[3]=u[3]*g+u[7]*x+u[15],C}const bt=100;class St{constructor(o,u=new ot(o.width+200,o.height+200,25),g=new ot(o.width+200,o.height+200,25)){this.transform=o,this.grid=u,this.ignoredGrid=g,this.pitchFactor=Math.cos(o.pitch*Math.PI/180)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+bt,this.screenBottomBoundary=o.height+bt,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,u,g,x,E,k,F,U,Z,K,oe,re){const ce=this.projectAndGetPerspectiveRatio(o.anchorPointX+U[0],o.anchorPointY+U[1],E,K,re),ve=g*ce.perspectiveRatio;let Le;if(k||F)Le=this._projectCollisionBox(o,ve,x,E,k,F,U,ce,K,oe,re);else{const ht=ce.x+(oe?oe.x*ve:0),Ye=ce.y+(oe?oe.y*ve:0);Le={allPointsOccluded:!1,box:[ht+o.x1*ve,Ye+o.y1*ve,ht+o.x2*ve,Ye+o.y2*ve]}}const[ze,Ne,Ge,et]=Le.box,Xe=k?Le.allPointsOccluded:ce.isOccluded;let at=Xe;return at||(at=ce.perspectiveRatio<this.perspectiveRatioCutoff),at||(at=!this.isInsideGrid(ze,Ne,Ge,et)),at||u!=="always"&&this.grid.hitTest(ze,Ne,Ge,et,u,Z)?{box:[ze,Ne,Ge,et],placeable:!1,offscreen:!1,occluded:Xe}:{box:[ze,Ne,Ge,et],placeable:!0,offscreen:this.isOffscreen(ze,Ne,Ge,et),occluded:Xe}}placeCollisionCircles(o,u,g,x,E,k,F,U,Z,K,oe,re,ce,ve){const Le=[],ze=new s.P(u.anchorX,u.anchorY),Ne=this.getPerspectiveRatio(ze.x,ze.y,k,ve),Ge=(Z?E*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,k)/Ne:E*Ne)/s.aA,et={getElevation:ve,pitchedLabelPlaneMatrix:F,lineVertexArray:g,pitchWithMap:Z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ze,unwrappedTileID:k,width:this.transform.width,height:this.transform.height,translation:ce},Xe=Et(Ge,x,u.lineOffsetX*Ge,u.lineOffsetY*Ge,!1,u,!1,et);let at=!1,ht=!1,Ye=!0;if(Xe){const pt=.5*oe*Ne+re,Pt=new s.P(-100,-100),Mt=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Tt=new Jt,kt=Xe.first,Mn=Xe.last;let Sn=[];for(let br=kt.path.length-1;br>=1;br--)Sn.push(kt.path[br]);for(let br=1;br<Mn.path.length;br++)Sn.push(Mn.path[br]);const rn=2.5*pt;if(Z){const br=this.projectPathToScreenSpace(Sn,et);Sn=br.some(Hr=>Hr.signedDistanceFromCamera<=0)?[]:br.map(Hr=>Hr.point)}let Vn=[];if(Sn.length>0){const br=Sn[0].clone(),Hr=Sn[0].clone();for(let Ei=1;Ei<Sn.length;Ei++)br.x=Math.min(br.x,Sn[Ei].x),br.y=Math.min(br.y,Sn[Ei].y),Hr.x=Math.max(Hr.x,Sn[Ei].x),Hr.y=Math.max(Hr.y,Sn[Ei].y);Vn=br.x>=Pt.x&&Hr.x<=Mt.x&&br.y>=Pt.y&&Hr.y<=Mt.y?[Sn]:Hr.x<Pt.x||br.x>Mt.x||Hr.y<Pt.y||br.y>Mt.y?[]:s.ax([Sn],Pt.x,Pt.y,Mt.x,Mt.y)}for(const br of Vn){Tt.reset(br,.25*pt);let Hr=0;Hr=Tt.length<=.5*pt?1:Math.ceil(Tt.paddedLength/rn)+1;for(let Ei=0;Ei<Hr;Ei++){const ii=Ei/Math.max(Hr-1,1),ci=Tt.lerp(ii),ai=ci.x+bt,Kr=ci.y+bt;Le.push(ai,Kr,pt,0);const ti=ai-pt,go=Kr-pt,Ar=ai+pt,so=Kr+pt;if(Ye=Ye&&this.isOffscreen(ti,go,Ar,so),ht=ht||this.isInsideGrid(ti,go,Ar,so),o!=="always"&&this.grid.hitTestCircle(ai,Kr,pt,o,K)&&(at=!0,!U))return{circles:[],offscreen:!1,collisionDetected:at}}}}return{circles:!U&&at||!ht||Ne<this.perspectiveRatioCutoff?[]:Le,offscreen:Ye,collisionDetected:at}}projectPathToScreenSpace(o,u){const g=function(x,E){const k=s.L();return s.ap(k,E.pitchedLabelPlaneMatrix),x.map(F=>{const U=mn(F.x,F.y,k,E.getElevation),Z=E.transform.projectTileCoordinates(U.point.x,U.point.y,E.unwrappedTileID,E.getElevation);return Z.point.x=(.5*Z.point.x+.5)*E.width,Z.point.y=(.5*-Z.point.y+.5)*E.height,Z})}(o,u);return function(x){let E=0,k=0,F=0,U=0;for(let Z=0;Z<x.length;Z++)x[Z].isOccluded?(F=Z+1,U=0):(U++,U>k&&(k=U,E=F));return x.slice(E,E+k)}(g)}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],g=new s.a1;for(const oe of o){const re=new s.P(oe.x+bt,oe.y+bt);g.extend(re),u.push(re)}const{minX:x,minY:E,maxX:k,maxY:F}=g,U=this.grid.query(x,E,k,F).concat(this.ignoredGrid.query(x,E,k,F)),Z={},K={};for(const oe of U){const re=oe.key;if(Z[re.bucketInstanceId]===void 0&&(Z[re.bucketInstanceId]={}),Z[re.bucketInstanceId][re.featureIndex])continue;const ce=[new s.P(oe.x1,oe.y1),new s.P(oe.x2,oe.y1),new s.P(oe.x2,oe.y2),new s.P(oe.x1,oe.y2)];s.ay(u,ce)&&(Z[re.bucketInstanceId][re.featureIndex]=!0,K[re.bucketInstanceId]===void 0&&(K[re.bucketInstanceId]=[]),K[re.bucketInstanceId].push(re.featureIndex))}return K}insertCollisionBox(o,u,g,x,E,k){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:E,collisionGroupID:k,overlapMode:u},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,g,x,E,k){const F=g?this.ignoredGrid:this.grid,U={bucketInstanceId:x,featureIndex:E,collisionGroupID:k,overlapMode:u};for(let Z=0;Z<o.length;Z+=4)F.insertCircle(U,o[Z],o[Z+1],o[Z+2])}projectAndGetPerspectiveRatio(o,u,g,x,E){if(E){let k;x?(k=[o,u,x(o,u),1],s.av(k,k,E)):(k=[o,u,0,1],Dt(k,k,E));const F=k[3];return{x:(k[0]/F+1)/2*this.transform.width+bt,y:(-k[1]/F+1)/2*this.transform.height+bt,perspectiveRatio:.5+this.transform.cameraToCenterDistance/F*.5,isOccluded:!1,signedDistanceFromCamera:F}}{const k=this.transform.projectTileCoordinates(o,u,g,x);return{x:(k.point.x+1)/2*this.transform.width+bt,y:(1-k.point.y)/2*this.transform.height+bt,perspectiveRatio:.5+this.transform.cameraToCenterDistance/k.signedDistanceFromCamera*.5,isOccluded:k.isOccluded,signedDistanceFromCamera:k.signedDistanceFromCamera}}}getPerspectiveRatio(o,u,g,x){const E=this.transform.projectTileCoordinates(o,u,g,x);return .5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5}isOffscreen(o,u,g,x){return g<bt||o>=this.screenRightBoundary||x<bt||u>this.screenBottomBoundary}isInsideGrid(o,u,g,x){return g>=0&&o<this.gridRightBoundary&&x>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=s.af([]);return s.M(o,o,[-100,-100,0]),o}_projectCollisionBox(o,u,g,x,E,k,F,U,Z,K,oe){let re=1,ce=0,ve=0,Le=1;const ze=o.anchorPointX+F[0],Ne=o.anchorPointY+F[1];if(k&&!E){const Sn=this.projectAndGetPerspectiveRatio(ze+1,Ne,x,Z,oe),rn=Sn.x-U.x,Vn=Math.atan((Sn.y-U.y)/rn)+(rn<0?Math.PI:0),br=Math.sin(Vn),Hr=Math.cos(Vn);re=Hr,ce=br,ve=-br,Le=Hr}else if(!k&&E){const Sn=nn(this.transform);re=Sn.vecEast[0],ce=Sn.vecEast[1],ve=Sn.vecSouth[0],Le=Sn.vecSouth[1]}let Ge=U.x,et=U.y,Xe=u;E&&(Ge=ze,et=Ne,Xe=Math.pow(2,-(this.transform.zoom-g.overscaledZ)),Xe*=this.transform.getPitchedTextCorrection(ze,Ne,x),K||(Xe*=s.ag(.5+U.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),K&&(Ge+=re*K.x*Xe+ve*K.y*Xe,et+=ce*K.x*Xe+Le*K.y*Xe);const at=o.x1*Xe,ht=o.x2*Xe,Ye=(at+ht)/2,pt=o.y1*Xe,Pt=o.y2*Xe,Mt=(pt+Pt)/2,Tt=[{offsetX:at,offsetY:pt},{offsetX:Ye,offsetY:pt},{offsetX:ht,offsetY:pt},{offsetX:ht,offsetY:Mt},{offsetX:ht,offsetY:Pt},{offsetX:Ye,offsetY:Pt},{offsetX:at,offsetY:Pt},{offsetX:at,offsetY:Mt}];let kt=[];for(const{offsetX:Sn,offsetY:rn}of Tt)kt.push(new s.P(Ge+re*Sn+ve*rn,et+ce*Sn+Le*rn));let Mn=!1;if(E){const Sn=kt.map(rn=>this.projectAndGetPerspectiveRatio(rn.x,rn.y,x,Z,oe));Mn=Sn.some(rn=>!rn.isOccluded),kt=Sn.map(rn=>new s.P(rn.x,rn.y))}else Mn=!0;return{box:s.az(kt),allPointsOccluded:!Mn}}}class pn{constructor(o,u,g,x){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):x&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class An{constructor(o,u,g,x,E){this.text=new pn(o?o.text:null,u,g,E),this.icon=new pn(o?o.icon:null,u,x,E)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gn{constructor(o,u,g){this.text=o,this.icon=u,this.skipFade=g}}class Pn{constructor(o,u,g,x,E){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=g,this.bucketIndex=x,this.tileID=E}}class Qt{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:g=>g.collisionGroupID===u}}return this.collisionGroups[o]}}function Zn(C,o,u,g,x){const{horizontalAlign:E,verticalAlign:k}=s.aG(C);return new s.P(-(E-.5)*o+g[0]*x,-(k-.5)*u+g[1]*x)}class In{constructor(o,u,g,x,E){this.transform=o.clone(),this.terrain=u,this.collisionIndex=new St(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Qt(x),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const u=this.terrain;return u?(g,x)=>u.getElevation(o,g,x):null}getBucketParts(o,u,g,x){const E=g.getBucket(u),k=g.latestFeatureIndex;if(!E||!k||u.id!==E.layerIds[0])return;const F=g.collisionBoxArray,U=E.layers[0].layout,Z=E.layers[0].paint,K=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),oe=g.tileSize/s.$,re=g.tileID.toUnwrapped(),ce=U.get("text-rotation-alignment")==="map",ve=s.aB(g,1,this.transform.zoom),Le=s.aC(this.collisionIndex.transform,g,Z.get("text-translate"),Z.get("text-translate-anchor")),ze=s.aC(this.collisionIndex.transform,g,Z.get("icon-translate"),Z.get("icon-translate-anchor")),Ne=mt(ce,this.transform,ve);this.retainedQueryData[E.bucketInstanceId]=new Pn(E.bucketInstanceId,k,E.sourceLayerIndex,E.index,g.tileID);const Ge={bucket:E,layout:U,translationText:Le,translationIcon:ze,unwrappedTileID:re,pitchedLabelPlaneMatrix:Ne,scale:K,textPixelRatio:oe,holdingForFade:g.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:s.am(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(x)for(const et of E.sortKeyRanges){const{sortKey:Xe,symbolInstanceStart:at,symbolInstanceEnd:ht}=et;o.push({sortKey:Xe,symbolInstanceStart:at,symbolInstanceEnd:ht,parameters:Ge})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Ge})}attemptAnchorPlacement(o,u,g,x,E,k,F,U,Z,K,oe,re,ce,ve,Le,ze,Ne,Ge,et,Xe){const at=s.aD[o.textAnchor],ht=[o.textOffset0,o.textOffset1],Ye=Zn(at,g,x,ht,E),pt=this.collisionIndex.placeCollisionBox(u,re,U,Z,K,F,k,ze,oe.predicate,et,Ye,Xe);if((!Ge||this.collisionIndex.placeCollisionBox(Ge,re,U,Z,K,F,k,Ne,oe.predicate,et,Ye,Xe).placeable)&&pt.placeable){let Pt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID]&&this.prevPlacement.placements[ce.crossTileID].text&&(Pt=this.prevPlacement.variableOffsets[ce.crossTileID].anchor),ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ce.crossTileID]={textOffset:ht,width:g,height:x,anchor:at,textBoxScale:E,prevAnchor:Pt},this.markUsedJustification(ve,at,ce,Le),ve.allowVerticalPlacement&&(this.markUsedOrientation(ve,Le,ce),this.placedOrientations[ce.crossTileID]=Le),{shift:Ye,placedGlyphBoxes:pt}}}placeLayerBucketPart(o,u,g){const{bucket:x,layout:E,translationText:k,translationIcon:F,unwrappedTileID:U,pitchedLabelPlaneMatrix:Z,textPixelRatio:K,holdingForFade:oe,collisionBoxArray:re,partiallyEvaluatedTextSize:ce,collisionGroup:ve}=o.parameters,Le=E.get("text-optional"),ze=E.get("icon-optional"),Ne=s.aE(E,"text-overlap","text-allow-overlap"),Ge=Ne==="always",et=s.aE(E,"icon-overlap","icon-allow-overlap"),Xe=et==="always",at=E.get("text-rotation-alignment")==="map",ht=E.get("text-pitch-alignment")==="map",Ye=E.get("icon-text-fit")!=="none",pt=E.get("symbol-z-order")==="viewport-y",Pt=Ge&&(Xe||!x.hasIconData()||ze),Mt=Xe&&(Ge||!x.hasTextData()||Le);!x.collisionArrays&&re&&x.deserializeCollisionBoxes(re);const Tt=this.retainedQueryData[x.bucketInstanceId].tileID,kt=this._getTerrainElevationFunc(Tt),Mn=this.transform.getFastPathSimpleProjectionMatrix(Tt),Sn=(rn,Vn,br)=>{var Hr,Ei;if(u[rn.crossTileID])return;if(oe)return void(this.placements[rn.crossTileID]=new gn(!1,!1,!1));let ii=!1,ci=!1,ai=!0,Kr=null,ti={box:null,placeable:!1,offscreen:null,occluded:!1},go={placeable:!1},Ar=null,so=null,vo=null,yl=0,_l=0,Va=0;Vn.textFeatureIndex?yl=Vn.textFeatureIndex:rn.useRuntimeCollisionCircles&&(yl=rn.featureIndex),Vn.verticalTextFeatureIndex&&(_l=Vn.verticalTextFeatureIndex);const ya=Vn.textBox;if(ya){const as=zi=>{let hi=s.an.horizontal;if(x.allowVerticalPlacement&&!zi&&this.prevPlacement){const yo=this.prevPlacement.placedOrientations[rn.crossTileID];yo&&(this.placedOrientations[rn.crossTileID]=yo,hi=yo,this.markUsedOrientation(x,hi,rn))}return hi},_a=(zi,hi)=>{if(x.allowVerticalPlacement&&rn.numVerticalGlyphVertices>0&&Vn.verticalTextBox){for(const yo of x.writingModes)if(yo===s.an.vertical?(ti=hi(),go=ti):ti=zi(),ti&&ti.placeable)break}else ti=zi()},gc=rn.textAnchorOffsetStartIndex,vc=rn.textAnchorOffsetEndIndex;if(vc===gc){const zi=(hi,yo)=>{const ao=this.collisionIndex.placeCollisionBox(hi,Ne,K,Tt,U,ht,at,k,ve.predicate,kt,void 0,Mn);return ao&&ao.placeable&&(this.markUsedOrientation(x,yo,rn),this.placedOrientations[rn.crossTileID]=yo),ao};_a(()=>zi(ya,s.an.horizontal),()=>{const hi=Vn.verticalTextBox;return x.allowVerticalPlacement&&rn.numVerticalGlyphVertices>0&&hi?zi(hi,s.an.vertical):{box:null,offscreen:null}}),as(ti&&ti.placeable)}else{let zi=s.aD[(Ei=(Hr=this.prevPlacement)===null||Hr===void 0?void 0:Hr.variableOffsets[rn.crossTileID])===null||Ei===void 0?void 0:Ei.anchor];const hi=(ao,bg,Py)=>{const Fs=ao.x2-ao.x1,nu=ao.y2-ao.y1,xl=rn.textBoxScale,ja=Ye&&et==="never"?bg:null;let _o=null,Ha=Ne==="never"?1:2,dd="never";zi&&Ha++;for(let Ns=0;Ns<Ha;Ns++){for(let fd=gc;fd<vc;fd++){const pd=x.textAnchorOffsets.get(fd);if(zi&&pd.textAnchor!==zi)continue;const md=this.attemptAnchorPlacement(pd,ao,Fs,nu,xl,at,ht,K,Tt,U,ve,dd,rn,x,Py,k,F,ja,kt);if(md&&(_o=md.placedGlyphBoxes,_o&&_o.placeable))return ii=!0,Kr=md.shift,_o}zi?zi=null:dd=Ne}return g&&!_o&&(_o={box:this.collisionIndex.placeCollisionBox(ya,"always",K,Tt,U,ht,at,k,ve.predicate,kt,void 0,Mn).box,offscreen:!1,placeable:!1,occluded:!1}),_o};_a(()=>hi(ya,Vn.iconBox,s.an.horizontal),()=>{const ao=Vn.verticalTextBox;return x.allowVerticalPlacement&&(!ti||!ti.placeable)&&rn.numVerticalGlyphVertices>0&&ao?hi(ao,Vn.verticalIconBox,s.an.vertical):{box:null,occluded:!0,offscreen:null}}),ti&&(ii=ti.placeable,ai=ti.offscreen);const yo=as(ti&&ti.placeable);if(!ii&&this.prevPlacement){const ao=this.prevPlacement.variableOffsets[rn.crossTileID];ao&&(this.variableOffsets[rn.crossTileID]=ao,this.markUsedJustification(x,ao.anchor,rn,yo))}}}if(Ar=ti,ii=Ar&&Ar.placeable,ai=Ar&&Ar.offscreen,rn.useRuntimeCollisionCircles){const as=x.text.placedSymbolArray.get(rn.centerJustifiedTextSymbolIndex),_a=s.ao(x.textSizeData,ce,as),gc=E.get("text-padding");so=this.collisionIndex.placeCollisionCircles(Ne,as,x.lineVertexArray,x.glyphOffsetArray,_a,U,Z,g,ht,ve.predicate,rn.collisionCircleDiameter,gc,k,kt),so.circles.length&&so.collisionDetected&&!g&&s.w("Collisions detected, but collision boxes are not shown"),ii=Ge||so.circles.length>0&&!so.collisionDetected,ai=ai&&so.offscreen}if(Vn.iconFeatureIndex&&(Va=Vn.iconFeatureIndex),Vn.iconBox){const as=_a=>this.collisionIndex.placeCollisionBox(_a,et,K,Tt,U,ht,at,F,ve.predicate,kt,Ye&&Kr?Kr:void 0,Mn);go&&go.placeable&&Vn.verticalIconBox?(vo=as(Vn.verticalIconBox),ci=vo.placeable):(vo=as(Vn.iconBox),ci=vo.placeable),ai=ai&&vo.offscreen}const Yu=Le||rn.numHorizontalGlyphVertices===0&&rn.numVerticalGlyphVertices===0,Ku=ze||rn.numIconVertices===0;Yu||Ku?Ku?Yu||(ci=ci&&ii):ii=ci&&ii:ci=ii=ci&&ii;const Ju=ci&&vo.placeable;if(ii&&Ar.placeable&&this.collisionIndex.insertCollisionBox(Ar.box,Ne,E.get("text-ignore-placement"),x.bucketInstanceId,go&&go.placeable&&_l?_l:yl,ve.ID),Ju&&this.collisionIndex.insertCollisionBox(vo.box,et,E.get("icon-ignore-placement"),x.bucketInstanceId,Va,ve.ID),so&&ii&&this.collisionIndex.insertCollisionCircles(so.circles,Ne,E.get("text-ignore-placement"),x.bucketInstanceId,yl,ve.ID),g&&this.storeCollisionData(x.bucketInstanceId,br,Vn,Ar,vo,so),rn.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(x.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[rn.crossTileID]=new gn((ii||Pt)&&!Ar?.occluded,(ci||Mt)&&!vo?.occluded,ai||x.justReloaded),u[rn.crossTileID]=!0};if(pt){if(o.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const rn=x.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Vn=rn.length-1;Vn>=0;--Vn){const br=rn[Vn];Sn(x.symbolInstances.get(br),x.collisionArrays[br],br)}}else for(let rn=o.symbolInstanceStart;rn<o.symbolInstanceEnd;rn++)Sn(x.symbolInstances.get(rn),x.collisionArrays[rn],rn);x.justReloaded=!1}storeCollisionData(o,u,g,x,E,k){if(g.textBox||g.iconBox){let F,U;this.collisionBoxArrays.has(o)?F=this.collisionBoxArrays.get(o):(F=new Map,this.collisionBoxArrays.set(o,F)),F.has(u)?U=F.get(u):(U={text:null,icon:null},F.set(u,U)),g.textBox&&(U.text=x.box),g.iconBox&&(U.icon=E.box)}if(k){let F=this.collisionCircleArrays[o];F===void 0&&(F=this.collisionCircleArrays[o]=[]);for(let U=0;U<k.circles.length;U+=4)F.push(k.circles[U+0]-bt),F.push(k.circles[U+1]-bt),F.push(k.circles[U+2]),F.push(k.collisionDetected?1:0)}}markUsedJustification(o,u,g,x){let E;E=x===s.an.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[s.aF(u)];const k=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const F of k)F>=0&&(o.text.placedSymbolArray.get(F).crossTileID=E>=0&&F!==E?0:g.crossTileID)}markUsedOrientation(o,u,g){const x=u===s.an.horizontal||u===s.an.horizontalOnly?u:0,E=u===s.an.vertical?u:0,k=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const F of k)o.text.placedSymbolArray.get(F).placedOrientation=x;g.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=E)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let g=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const x=u?u.symbolFadeChange(o):1,E=u?u.opacities:{},k=u?u.variableOffsets:{},F=u?u.placedOrientations:{};for(const U in this.placements){const Z=this.placements[U],K=E[U];K?(this.opacities[U]=new An(K,x,Z.text,Z.icon),g=g||Z.text!==K.text.placed||Z.icon!==K.icon.placed):(this.opacities[U]=new An(null,x,Z.text,Z.icon,Z.skipFade),g=g||Z.text||Z.icon)}for(const U in E){const Z=E[U];if(!this.opacities[U]){const K=new An(Z,x,!1,!1);K.isHidden()||(this.opacities[U]=K,g=g||Z.text.placed||Z.icon.placed)}}for(const U in k)this.variableOffsets[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.variableOffsets[U]=k[U]);for(const U in F)this.placedOrientations[U]||!this.opacities[U]||this.opacities[U].isHidden()||(this.placedOrientations[U]=F[U]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u){const g={};for(const x of u){const E=x.getBucket(o);E&&x.latestFeatureIndex&&o.id===E.layerIds[0]&&this.updateBucketOpacities(E,x.tileID,g,x.collisionBoxArray)}}updateBucketOpacities(o,u,g,x){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const E=o.layers[0],k=E.layout,F=new An(null,0,!1,!1,!0),U=k.get("text-allow-overlap"),Z=k.get("icon-allow-overlap"),K=E._unevaluatedLayout.hasValue("text-variable-anchor")||E._unevaluatedLayout.hasValue("text-variable-anchor-offset"),oe=k.get("text-rotation-alignment")==="map",re=k.get("text-pitch-alignment")==="map",ce=k.get("icon-text-fit")!=="none",ve=new An(null,0,U&&(Z||!o.hasIconData()||k.get("icon-optional")),Z&&(U||!o.hasTextData()||k.get("text-optional")),!0);!o.collisionArrays&&x&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(x);const Le=(Ne,Ge,et)=>{for(let Xe=0;Xe<Ge/4;Xe++)Ne.opacityVertexArray.emplaceBack(et);Ne.hasVisibleVertices=Ne.hasVisibleVertices||et!==Ys},ze=this.collisionBoxArrays.get(o.bucketInstanceId);for(let Ne=0;Ne<o.symbolInstances.length;Ne++){const Ge=o.symbolInstances.get(Ne),{numHorizontalGlyphVertices:et,numVerticalGlyphVertices:Xe,crossTileID:at}=Ge;let ht=this.opacities[at];g[at]?ht=F:ht||(ht=ve,this.opacities[at]=ht),g[at]=!0;const Ye=Ge.numIconVertices>0,pt=this.placedOrientations[Ge.crossTileID],Pt=pt===s.an.vertical,Mt=pt===s.an.horizontal||pt===s.an.horizontalOnly;if(et>0||Xe>0){const kt=Eo(ht.text);Le(o.text,et,Pt?Ys:kt),Le(o.text,Xe,Mt?Ys:kt);const Mn=ht.text.isHidden();[Ge.rightJustifiedTextSymbolIndex,Ge.centerJustifiedTextSymbolIndex,Ge.leftJustifiedTextSymbolIndex].forEach(Vn=>{Vn>=0&&(o.text.placedSymbolArray.get(Vn).hidden=Mn||Pt?1:0)}),Ge.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(Ge.verticalPlacedTextSymbolIndex).hidden=Mn||Mt?1:0);const Sn=this.variableOffsets[Ge.crossTileID];Sn&&this.markUsedJustification(o,Sn.anchor,Ge,pt);const rn=this.placedOrientations[Ge.crossTileID];rn&&(this.markUsedJustification(o,"left",Ge,rn),this.markUsedOrientation(o,rn,Ge))}if(Ye){const kt=Eo(ht.icon),Mn=!(ce&&Ge.verticalPlacedIconSymbolIndex&&Pt);Ge.placedIconSymbolIndex>=0&&(Le(o.icon,Ge.numIconVertices,Mn?kt:Ys),o.icon.placedSymbolArray.get(Ge.placedIconSymbolIndex).hidden=ht.icon.isHidden()),Ge.verticalPlacedIconSymbolIndex>=0&&(Le(o.icon,Ge.numVerticalIconVertices,Mn?Ys:kt),o.icon.placedSymbolArray.get(Ge.verticalPlacedIconSymbolIndex).hidden=ht.icon.isHidden())}const Tt=ze&&ze.has(Ne)?ze.get(Ne):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const kt=o.collisionArrays[Ne];if(kt){let Mn=new s.P(0,0);if(kt.textBox||kt.verticalTextBox){let Sn=!0;if(K){const rn=this.variableOffsets[at];rn?(Mn=Zn(rn.anchor,rn.width,rn.height,rn.textOffset,rn.textBoxScale),oe&&Mn._rotate(re?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Sn=!1}if(kt.textBox||kt.verticalTextBox){let rn;kt.textBox&&(rn=Pt),kt.verticalTextBox&&(rn=Mt),Wn(o.textCollisionBox.collisionVertexArray,ht.text.placed,!Sn||rn,Tt.text,Mn.x,Mn.y)}}if(kt.iconBox||kt.verticalIconBox){const Sn=!!(!Mt&&kt.verticalIconBox);let rn;kt.iconBox&&(rn=Sn),kt.verticalIconBox&&(rn=!Sn),Wn(o.iconCollisionBox.collisionVertexArray,ht.icon.placed,rn,Tt.icon,ce?Mn.x:0,ce?Mn.y:0)}}}}if(o.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);o.bucketInstanceId in this.collisionCircleArrays&&(o.collisionCircleArray=this.collisionCircleArrays[o.bucketInstanceId],delete this.collisionCircleArrays[o.bucketInstanceId])}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const g=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*g>o}setStale(){this.stale=!0}}function Wn(C,o,u,g,x,E){g&&g.length!==0||(g=[0,0,0,0]);const k=g[0]-bt,F=g[1]-bt,U=g[2]-bt,Z=g[3]-bt;C.emplaceBack(o?1:0,u?1:0,x||0,E||0,k,F),C.emplaceBack(o?1:0,u?1:0,x||0,E||0,U,F),C.emplaceBack(o?1:0,u?1:0,x||0,E||0,U,Z),C.emplaceBack(o?1:0,u?1:0,x||0,E||0,k,Z)}const tr=Math.pow(2,25),Or=Math.pow(2,24),Fr=Math.pow(2,17),wr=Math.pow(2,16),ur=Math.pow(2,9),ui=Math.pow(2,8),kr=Math.pow(2,1);function Eo(C){if(C.opacity===0&&!C.placed)return 0;if(C.opacity===1&&C.placed)return 4294967295;const o=C.placed?1:0,u=Math.floor(127*C.opacity);return u*tr+o*Or+u*Fr+o*wr+u*ur+o*ui+u*kr+o}const Ys=0;class Jo{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,u,g,x,E){const k=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(k,x,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort((F,U)=>F.sortKey-U.sortKey));this._currentPartIndex<k.length;)if(u.placeLayerBucketPart(k[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,E())return!0;return!1}}class Ra{constructor(o,u,g,x,E,k,F,U){this.placement=new In(o,u,k,F,U),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(o,u,g){const x=S.now(),E=()=>!this._forceFullPlacement&&S.now()-x>2;for(;this._currentPlacementIndex>=0;){const k=u[o[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=F)&&(!k.maxzoom||k.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new Jo(k)),this._inProgressLayer.continuePlacement(g[k.source],this.placement,this._showCollisionBoxes,k,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Zr=512/s.$/2;class uo{constructor(o,u,g){this.tileID=o,this.bucketInstanceId=g,this._symbolsByKey={};const x=new Map;for(let E=0;E<u.length;E++){const k=u.get(E),F=k.key,U=x.get(F);U?U.push(k):x.set(F,[k])}for(const[E,k]of x){const F={positions:k.map(U=>({x:Math.floor(U.anchorX*Zr),y:Math.floor(U.anchorY*Zr)})),crossTileIDs:k.map(U=>U.crossTileID)};if(F.positions.length>128){const U=new s.aH(F.positions.length,16,Uint16Array);for(const{x:Z,y:K}of F.positions)U.add(Z,K);U.finish(),delete F.positions,F.index=U}this._symbolsByKey[E]=F}}getScaledCoordinates(o,u){const{x:g,y:x,z:E}=this.tileID.canonical,{x:k,y:F,z:U}=u.canonical,Z=Zr/Math.pow(2,U-E),K=(F*s.$+o.anchorY)*Z,oe=x*s.$*Zr;return{x:Math.floor((k*s.$+o.anchorX)*Z-g*s.$*Zr),y:Math.floor(K-oe)}}findMatches(o,u,g){const x=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let E=0;E<o.length;E++){const k=o.get(E);if(k.crossTileID)continue;const F=this._symbolsByKey[k.key];if(!F)continue;const U=this.getScaledCoordinates(k,u);if(F.index){const Z=F.index.range(U.x-x,U.y-x,U.x+x,U.y+x).sort();for(const K of Z){const oe=F.crossTileIDs[K];if(!g[oe]){g[oe]=!0,k.crossTileID=oe;break}}}else if(F.positions)for(let Z=0;Z<F.positions.length;Z++){const K=F.positions[Z],oe=F.crossTileIDs[Z];if(Math.abs(K.x-U.x)<=x&&Math.abs(K.y-U.y)<=x&&!g[oe]){g[oe]=!0,k.crossTileID=oe;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class Xi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ho{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(u!==0)for(const g in this.indexes){const x=this.indexes[g],E={};for(const k in x){const F=x[k];F.tileID=F.tileID.unwrapTo(F.tileID.wrap+u),E[F.tileID.key]=F}this.indexes[g]=E}this.lng=o}addBucket(o,u,g){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let E=0;E<u.symbolInstances.length;E++)u.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const x=this.usedCrossTileIDs[o.overscaledZ];for(const E in this.indexes){const k=this.indexes[E];if(Number(E)>o.overscaledZ)for(const F in k){const U=k[F];U.tileID.isChildOf(o)&&U.findMatches(u.symbolInstances,o,x)}else{const F=k[o.scaledTo(Number(E)).key];F&&F.findMatches(u.symbolInstances,o,x)}}for(let E=0;E<u.symbolInstances.length;E++){const k=u.symbolInstances.get(E);k.crossTileID||(k.crossTileID=g.generate(),x[k.crossTileID]=!0)}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new uo(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const g of u.getCrossTileIDsLists())for(const x of g)delete this.usedCrossTileIDs[o][x]}removeStaleBuckets(o){let u=!1;for(const g in this.indexes){const x=this.indexes[g];for(const E in x)o[x[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,x[E]),delete x[E],u=!0)}return u}}class Vi{constructor(){this.layerIndexes={},this.crossTileIDs=new Xi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,g){let x=this.layerIndexes[o.id];x===void 0&&(x=this.layerIndexes[o.id]=new ho);let E=!1;const k={};x.handleWrapJump(g);for(const F of u){const U=F.getBucket(o);U&&o.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(F.tileID,U,this.crossTileIDs)&&(E=!0),k[U.bucketInstanceId]=!0)}return x.removeStaleBuckets(k)&&(E=!0),E}pruneUnusedLayers(o){const u={};o.forEach(g=>{u[g]=!0});for(const g in this.layerIndexes)u[g]||delete this.layerIndexes[g]}}var Nr="void main() {fragColor=vec4(1.0);}";const io={prelude:Er(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Er("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Er("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Er(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Er(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Er(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Er(Nr,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Er(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Er(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Er("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Er("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Er("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Er(Nr,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Er(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Er(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Er(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Er(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Er(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Er(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Er(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Er(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Er(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Er(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Er(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Er(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Er(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Er("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Er("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Er("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Er("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Er(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Er("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Er(C,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=o.match(/in ([\w]+) ([\w]+)/g),x=C.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),k=E?E.concat(x):x,F={};return{fragmentSource:C=C.replace(u,(U,Z,K,oe,re)=>(F[re]=!0,Z==="define"?`
#ifndef HAS_UNIFORM_u_${re}
in ${K} ${oe} ${re};
#else
uniform ${K} ${oe} u_${re};
#endif
`:`
#ifdef HAS_UNIFORM_u_${re}
    ${K} ${oe} ${re} = u_${re};
#endif
`)),vertexSource:o=o.replace(u,(U,Z,K,oe,re)=>{const ce=oe==="float"?"vec2":"vec4",ve=re.match(/color/)?"color":ce;return F[re]?Z==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${K} ${ce} a_${re};
out ${K} ${oe} ${re};
#else
uniform ${K} ${oe} u_${re};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = a_${re};
#else
    ${K} ${oe} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${re} = unpack_mix_${ve}(a_${re}, u_${re}_t);
#else
    ${K} ${oe} ${re} = u_${re};
#endif
`:Z==="define"?`
#ifndef HAS_UNIFORM_u_${re}
uniform lowp float u_${re}_t;
in ${K} ${ce} a_${re};
#else
uniform ${K} ${oe} u_${re};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${re}
    ${K} ${oe} ${re} = a_${re};
#else
    ${K} ${oe} ${re} = u_${re};
#endif
`:`
#ifndef HAS_UNIFORM_u_${re}
    ${K} ${oe} ${re} = unpack_mix_${ve}(a_${re}, u_${re}_t);
#else
    ${K} ${oe} ${re} = u_${re};
#endif
`}),staticAttributes:g,staticUniforms:k}}class ha{constructor(o,u,g){this.vertexBuffer=o,this.indexBuffer=u,this.segments=g}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var La=s.aI([{name:"a_pos",type:"Int16",components:2}]);const Zl="#define PROJECTION_MERCATOR",nf="mercator";class Oh{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return nf}get shaderDefine(){return Zl}get shaderPreludeCode(){return io.projectionMercator}get vertexShaderPreludeCode(){return io.projectionMercator.vertexSource}get subdivisionGranularity(){return s.aJ.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(o){}getMeshFromTileID(o,u,g,x,E){if(this._cachedMesh)return this._cachedMesh;const k=new s.aK;k.emplaceBack(0,0),k.emplaceBack(s.$,0),k.emplaceBack(0,s.$),k.emplaceBack(s.$,s.$);const F=o.createVertexBuffer(k,La.members),U=s.aL.simpleSegment(0,0,4,2),Z=new s.aM;Z.emplaceBack(1,0,2),Z.emplaceBack(1,2,3);const K=o.createIndexBuffer(Z);return this._cachedMesh=new ha(F,K,U),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(o){}}class Qo{constructor(o=0,u=0,g=0,x=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(g)||g<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=g,this.right=x}interpolate(o,u,g){return u.top!=null&&o.top!=null&&(this.top=s.C.number(o.top,u.top,g)),u.bottom!=null&&o.bottom!=null&&(this.bottom=s.C.number(o.bottom,u.bottom,g)),u.left!=null&&o.left!=null&&(this.left=s.C.number(o.left,u.left,g)),u.right!=null&&o.right!=null&&(this.right=s.C.number(o.right,u.right,g)),this}getCenter(o,u){const g=s.ag((this.left+o-this.right)/2,0,o),x=s.ag((this.top+u-this.bottom)/2,0,u);return new s.P(g,x)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Qo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function No(C,o){if(!C.renderWorldCopies||C.lngRange)return;const u=o.lng-C.center.lng;o.lng+=u>180?-360:u<-180?360:0}function yr(C){return Math.max(0,Math.floor(C))}class Ks{constructor(o,u,g,x,E,k){this._callbacks=o,this._tileSize=512,this._renderWorldCopies=k===void 0||!!k,this._minZoom=u||0,this._maxZoom=g||22,this._minPitch=x??0,this._maxPitch=E??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new s.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=yr(this._zoom),this._scale=s.ae(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Qo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(o,u,g){this._latRange=o.latRange,this._lngRange=o.lngRange,this._width=o.width,this._height=o.height,this._center=o.center,this._elevation=o.elevation,this._minElevationForCurrentTile=o.minElevationForCurrentTile,this._zoom=o.zoom,this._tileZoom=yr(this._zoom),this._scale=s.ae(this._zoom),this._bearingInRadians=o.bearingInRadians,this._fovInRadians=o.fovInRadians,this._pitchInRadians=o.pitchInRadians,this._rollInRadians=o.rollInRadians,this._unmodified=o.unmodified,this._edgeInsets=new Qo(o.padding.top,o.padding.bottom,o.padding.left,o.padding.right),this._minZoom=o.minZoom,this._maxZoom=o.maxZoom,this._minPitch=o.minPitch,this._maxPitch=o.maxPitch,this._renderWorldCopies=o.renderWorldCopies,this._cameraToCenterDistance=o.cameraToCenterDistance,this._nearZ=o.nearZ,this._farZ=o.farZ,this._autoCalculateNearFarZ=!g&&o.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(o){this._minElevationForCurrentTile=o}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(o){this._minZoom!==o&&(this._minZoom=o,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(o){this._minPitch!==o&&(this._minPitch=o,this.setPitch(Math.max(this.pitch,o)))}get maxPitch(){return this._maxPitch}setMaxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.setPitch(Math.min(this.pitch,o)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(o){const u=s.aN(o,-180,180)*Math.PI/180;var g,x,E,k,F,U,Z,K,oe;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=y(),g=this._rotationMatrix,E=-this._bearingInRadians,k=(x=this._rotationMatrix)[0],F=x[1],U=x[2],Z=x[3],K=Math.sin(E),oe=Math.cos(E),g[0]=k*oe+U*K,g[1]=F*oe+Z*K,g[2]=k*-K+U*oe,g[3]=F*-K+Z*oe)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(o){const u=s.ag(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(o){const u=o/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return s.aO(this._fovInRadians)}setFov(o){o=s.ag(o,.1,150),this.fov!==o&&(this._unmodified=!1,this._fovInRadians=s.ad(o),this._calcMatrices())}get zoom(){return this._zoom}setZoom(o){const u=this.getConstrained(this._center,o).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=s.ae(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(o,u){this._autoCalculateNearFarZ=!1,this._nearZ=o,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,g){this._unmodified=!1,this._edgeInsets.interpolate(o,u,g),this._constrain(),this._calcMatrices()}resize(o,u,g=!0){this._width=o,this._height=u,g&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new tn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(o){o?(this._lngRange=[o.getWest(),o.getEast()],this._latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-s.ah,s.ah])}getConstrained(o,u){return this._callbacks.getConstrained(o,u)}getCameraQueryGeometry(o,u){if(u.length===1)return[u[0],o];{const{minX:g,minY:x,maxX:E,maxY:k}=s.a1.fromPoints(u).extend(o);return[new s.P(g,x),new s.P(E,x),new s.P(E,k),new s.P(g,k),new s.P(g,x)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:u,zoom:g}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(g),this._unmodified=o,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let o=s.af(new Float64Array(16));s.N(o,o,[this._width/2,-this._height/2,1]),s.M(o,o,[1,-1,0]),this._clipSpaceToPixelsMatrix=o,o=s.af(new Float64Array(16)),s.N(o,o,[1,-1,1]),s.M(o,o,[-1,-1,0]),s.N(o,o,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=o,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(o,u,g,x){const E=g!==void 0?g:this.bearing,k=x=x!==void 0?x:this.pitch,F=s.a0.fromLngLat(o,u),U=-Math.cos(s.ad(k)),Z=Math.sin(s.ad(k)),K=Z*Math.sin(s.ad(E)),oe=-Z*Math.cos(s.ad(E));let re=this.elevation;const ce=u-re;let ve;U*ce>=0||Math.abs(U)<.1?(ve=1e4,re=u+ve*U):ve=-ce/U;let Le,ze,Ne=s.aP(1,F.y),Ge=0;do{if(Ge+=1,Ge>10)break;ze=ve/Ne,Le=new s.a0(F.x+K*ze,F.y+oe*ze),Ne=1/Le.meterInMercatorCoordinateUnits()}while(Math.abs(ve-ze*Ne)>1e-12);return{center:Le.toLngLat(),elevation:re,zoom:s.aj(this.height/2/Math.tan(this.fovInRadians/2)/ze/this.tileSize)}}recalculateZoomAndCenter(o){if(this.elevation-o==0)return;const u=s.ai(1,this.center.lat)*this.worldSize,g=this.cameraToCenterDistance/u,x=s.a0.fromLngLat(this.center,this.elevation),E=fe(this.center,this.elevation,this.pitch,this.bearing,g);this._elevation=o;const k=this.calculateCenterFromCameraLngLatAlt(E.toLngLat(),s.aP(E.z,x.y),this.bearing,this.pitch);this._elevation=k.elevation,this._center=k.center,this.setZoom(k.zoom)}getCameraPoint(){const o=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(o*Math.sin(this.rollInRadians),o*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const o=s.ai(1,this.center.lat)*this.worldSize;return fe(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/o).toLngLat()}getMercatorTileCoordinates(o){if(!o)return[0,0,1,1];const u=o.canonical.z>=0?1<<o.canonical.z:Math.pow(2,o.canonical.z);return[o.canonical.x/u,o.canonical.y/u,1/u/s.$,1/u/s.$]}}class Yl{constructor(o,u){this.min=o,this.max=u,this.center=s.aQ([],s.aR([],this.min,this.max),.5)}quadrant(o){const u=[o%2==0,o<2],g=s.aS(this.min),x=s.aS(this.max);for(let E=0;E<u.length;E++)g[E]=u[E]?this.min[E]:this.center[E],x[E]=u[E]?this.center[E]:this.max[E];return x[2]=this.max[2],new Yl(g,x)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersectsFrustum(o){let u=!0;for(let g=0;g<o.planes.length;g++){const x=this.intersectsPlane(o.planes[g]);if(x===0)return 0;x===1&&(u=!1)}return u?2:o.aabb.min[0]>this.max[0]||o.aabb.min[1]>this.max[1]||o.aabb.min[2]>this.max[2]||o.aabb.max[0]<this.min[0]||o.aabb.max[1]<this.min[1]||o.aabb.max[2]<this.min[2]?0:1}intersectsPlane(o){let u=o[3],g=o[3];for(let x=0;x<3;x++)o[x]>0?(u+=o[x]*this.min[x],g+=o[x]*this.max[x]):(g+=o[x]*this.min[x],u+=o[x]*this.max[x]);return u>=0?2:g<0?0:1}}class Oc{distanceToTile2d(o,u,g,x){const E=x.distanceX([o,u]),k=x.distanceY([o,u]);return Math.hypot(E,k)}getWrap(o,u,g){return g}getTileBoundingVolume(o,u,g,x){var E,k;let F=g,U=g;if(x?.terrain){const K=new s.Z(o.z,u,o.z,o.x,o.y),oe=x.terrain.getMinMaxElevation(K);F=(E=oe.minElevation)!==null&&E!==void 0?E:g,U=(k=oe.maxElevation)!==null&&k!==void 0?k:g}const Z=1<<o.z;return new Yl([u+o.x/Z,o.y/Z,F],[u+(o.x+1)/Z,(o.y+1)/Z,U])}allowVariableZoom(o,u){const g=o.fov*(Math.abs(Math.cos(o.rollInRadians))*o.height+Math.abs(Math.sin(o.rollInRadians))*o.width)/o.height,x=s.ag(78.5-g/2,0,60);return!!u.terrain||o.pitch>x}allowWorldCopies(){return!0}prepareNextFrame(){}}class Di{constructor(o,u,g){this.points=o,this.planes=u,this.aabb=g}static fromInvProjectionMatrix(o,u=1,g=0,x,E){const k=E?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],F=Math.pow(2,g),U=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(re=>function(ce,ve,Le,ze){const Ne=s.av([],ce,ve),Ge=1/Ne[3]/Le*ze;return s.aX(Ne,Ne,[Ge,Ge,1/Ne[3],Ge])}(re,o,u,F));x&&function(re,ce,ve,Le){const ze=Le?4:0,Ne=Le?0:4;let Ge=0;const et=[],Xe=[];for(let Ye=0;Ye<4;Ye++){const pt=s.aT([],re[Ye+Ne],re[Ye+ze]),Pt=s.aY(pt);s.aQ(pt,pt,1/Pt),et.push(Pt),Xe.push(pt)}for(let Ye=0;Ye<4;Ye++){const pt=s.aZ(re[Ye+ze],Xe[Ye],ve);Ge=pt!==null&&pt>=0?Math.max(Ge,pt):Math.max(Ge,et[Ye])}const at=function(Ye,pt){const Pt=s.aT([],Ye[pt[0]],Ye[pt[1]]),Mt=s.aT([],Ye[pt[2]],Ye[pt[1]]),Tt=[0,0,0,0];return s.aU(Tt,s.aV([],Pt,Mt)),Tt[3]=-s.aW(Tt,Ye[pt[0]]),Tt}(re,ce),ht=function(Ye,pt){const Pt=s.a_(Ye),Mt=s.a$([],Ye,1/Pt),Tt=s.aT([],pt,s.aQ([],Mt,s.aW(pt,Mt))),kt=s.a_(Tt);if(kt>0){const Mn=Math.sqrt(1-Mt[3]*Mt[3]),Sn=s.aQ([],Mt,-Mt[3]),rn=s.aR([],Sn,s.aQ([],Tt,Mn/kt));return s.b0(pt,rn)}return null}(ve,at);if(ht!==null){const Ye=ht/s.aW(Xe[0],at);Ge=Math.min(Ge,Ye)}for(let Ye=0;Ye<4;Ye++){const pt=Math.min(Ge,et[Ye]);re[Ye+Ne]=[re[Ye+ze][0]+Xe[Ye][0]*pt,re[Ye+ze][1]+Xe[Ye][1]*pt,re[Ye+ze][2]+Xe[Ye][2]*pt,1]}}(U,k[0],x,E);const Z=k.map(re=>{const ce=s.aT([],U[re[0]],U[re[1]]),ve=s.aT([],U[re[2]],U[re[1]]),Le=s.aU([],s.aV([],ce,ve)),ze=-s.aW(Le,U[re[1]]);return Le.concat(ze)}),K=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],oe=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const re of U)for(let ce=0;ce<3;ce++)K[ce]=Math.min(K[ce],re[ce]),oe[ce]=Math.max(oe[ce],re[ce]);return new Di(U,Z,new Yl(K,oe))}}class Zi{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,g){return this._helper.interpolatePadding(o,u,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u,g=!0){this._helper.resize(o,u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o,u){}constructor(o,u,g,x,E){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ks({calcMatrices:()=>{this._calcMatrices()},getConstrained:(k,F)=>this.getConstrained(k,F)},o,u,g,x,E),this._coveringTilesDetailsProvider=new Oc}clone(){const o=new Zi;return o.apply(this),o}apply(o,u,g){this._helper.apply(o,u,g)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(o){const u=[new s.b1(0,o)];if(this._helper._renderWorldCopies){const g=this.screenPointToMercatorCoordinate(new s.P(0,0)),x=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,0)),E=this.screenPointToMercatorCoordinate(new s.P(this._helper._width,this._helper._height)),k=this.screenPointToMercatorCoordinate(new s.P(0,this._helper._height)),F=Math.floor(Math.min(g.x,x.x,E.x,k.x)),U=Math.floor(Math.max(g.x,x.x,E.x,k.x)),Z=1;for(let K=F-Z;K<=U+Z;K++)K!==0&&u.push(new s.b1(K,o))}return u}getCameraFrustum(){return Di.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){const u=this.screenPointToLocation(this.centerPoint,o),g=o?o.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(g)}setLocationAtPoint(o,u){const g=s.ai(this.elevation,this.center.lat),x=this.screenPointToMercatorCoordinateAtZ(u,g),E=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,g),k=s.a0.fromLngLat(o),F=new s.a0(k.x-(x.x-E.x),k.y-(x.y-E.y));this.setCenter(F?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(o,u){return u?this.coordinatePoint(s.a0.fromLngLat(o),u.getElevationForLngLatZoom(o,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(s.a0.fromLngLat(o))}screenPointToLocation(o,u){var g;return(g=this.screenPointToMercatorCoordinate(o,u))===null||g===void 0?void 0:g.toLngLat()}screenPointToMercatorCoordinate(o,u){if(u){const g=u.pointCoordinate(o);if(g!=null)return g}return this.screenPointToMercatorCoordinateAtZ(o)}screenPointToMercatorCoordinateAtZ(o,u){const g=u||0,x=[o.x,o.y,0,1],E=[o.x,o.y,1,1];s.av(x,x,this._pixelMatrixInverse),s.av(E,E,this._pixelMatrixInverse);const k=x[3],F=E[3],U=x[1]/k,Z=E[1]/F,K=x[2]/k,oe=E[2]/F,re=K===oe?0:(g-K)/(oe-K);return new s.a0(s.C.number(x[0]/k,E[0]/F,re)/this.worldSize,s.C.number(U,Z,re)/this.worldSize,g)}coordinatePoint(o,u=0,g=this._pixelMatrix){const x=[o.x*this.worldSize,o.y*this.worldSize,u,1];return s.av(x,x,g),new s.P(x[0]/x[3],x[1]/x[3])}getBounds(){const o=Math.max(0,this._helper._height/2-ue(this));return new tn().extend(this.screenPointToLocation(new s.P(0,o))).extend(this.screenPointToLocation(new s.P(this._helper._width,o))).extend(this.screenPointToLocation(new s.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new s.P(0,this._helper._height)))}isPointOnMapSurface(o,u){return u?u.pointCoordinate(o)!=null:o.y>this.height/2-ue(this)}calculatePosMatrix(o,u=!1,g){var x;const E=(x=o.key)!==null&&x!==void 0?x:s.b2(o.wrap,o.canonical.z,o.canonical.z,o.canonical.x,o.canonical.y),k=u?this._alignedPosMatrixCache:this._posMatrixCache;if(k.has(E)){const Z=k.get(E);return g?Z.f32:Z.f64}const F=ne(o,this.worldSize);s.O(F,u?this._alignedProjMatrix:this._viewProjMatrix,F);const U={f64:F,f32:new Float32Array(F)};return k.set(E,U),g?U.f32:U.f64}calculateFogMatrix(o){const u=o.key,g=this._fogMatrixCacheF32;if(g.has(u))return g.get(u);const x=ne(o,this.worldSize);return s.O(x,this._fogMatrix,x),g.set(u,new Float32Array(x)),g.get(u)}getConstrained(o,u){u=s.ag(+u,this.minZoom,this.maxZoom);const g={center:new s.S(o.lng,o.lat),zoom:u};let x=this._helper._lngRange;if(!this._helper._renderWorldCopies&&x===null){const et=179.9999999999;x=[-et,et]}const E=this.tileSize*s.ae(g.zoom);let k=0,F=E,U=0,Z=E,K=0,oe=0;const{x:re,y:ce}=this.size;if(this._helper._latRange){const et=this._helper._latRange;k=s.U(et[1])*E,F=s.U(et[0])*E,F-k<ce&&(K=ce/(F-k))}x&&(U=s.aN(s.V(x[0])*E,0,E),Z=s.aN(s.V(x[1])*E,0,E),Z<U&&(Z+=E),Z-U<re&&(oe=re/(Z-U)));const{x:ve,y:Le}=Pe(E,o);let ze,Ne;const Ge=Math.max(oe||0,K||0);if(Ge){const et=new s.P(oe?(Z+U)/2:ve,K?(F+k)/2:Le);return g.center=ae(E,et).wrap(),g.zoom+=s.aj(Ge),g}if(this._helper._latRange){const et=ce/2;Le-et<k&&(Ne=k+et),Le+et>F&&(Ne=F-et)}if(x){const et=(U+Z)/2;let Xe=ve;this._helper._renderWorldCopies&&(Xe=s.aN(ve,et-E/2,et+E/2));const at=re/2;Xe-at<U&&(ze=U+at),Xe+at>Z&&(ze=Z-at)}if(ze!==void 0||Ne!==void 0){const et=new s.P(ze??ve,Ne??Le);g.center=ae(E,et).wrap()}return g}calculateCenterFromCameraLngLatAlt(o,u,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,g,x)}_calculateNearFarZIfNeeded(o,u,g){if(!this._helper.autoCalculateNearFarZ)return;const x=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),E=o-x*this._helper._pixelPerMeter/Math.cos(u),k=x<0?E:o,F=Math.PI/2+this.pitchInRadians,U=s.ad(this.fov)*(Math.abs(Math.cos(s.ad(this.roll)))*this.height+Math.abs(Math.sin(s.ad(this.roll)))*this.width)/this.height*(.5+g.y/this.height),Z=Math.sin(U)*k/Math.sin(s.ag(Math.PI-F-U,.01,Math.PI-.01)),K=ue(this),oe=Math.atan(K/this._helper.cameraToCenterDistance),re=s.ad(.75),ce=oe>re?2*oe*(.5+g.y/(2*K)):re,ve=Math.sin(ce)*k/Math.sin(s.ag(Math.PI-F-ce,.01,Math.PI-.01)),Le=Math.min(Z,ve);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*Le+k),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const o=this.centerOffset,u=Pe(this.worldSize,this.center),g=u.x,x=u.y;this._helper._pixelPerMeter=s.ai(1,this.center.lat)*this.worldSize;const E=s.ad(Math.min(this.pitch,Yt)),k=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(E));let F;this._calculateNearFarZIfNeeded(k,E,o),F=new Float64Array(16),s.b3(F,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),s.ap(this._invProjMatrix,F),F[8]=2*-o.x/this._helper._width,F[9]=2*o.y/this._helper._height,this._projectionMatrix=s.b4(F),s.N(F,F,[1,-1,1]),s.M(F,F,[0,0,-this._helper.cameraToCenterDistance]),s.b5(F,F,-this.rollInRadians),s.b6(F,F,this.pitchInRadians),s.b5(F,F,-this.bearingInRadians),s.M(F,F,[-g,-x,0]),this._mercatorMatrix=s.N([],F,[this.worldSize,this.worldSize,this.worldSize]),s.N(F,F,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,F),s.M(F,F,[0,0,-this.elevation]),this._viewProjMatrix=F,this._invViewProjMatrix=s.ap([],F);const U=[0,0,-1,1];s.av(U,U,this._invViewProjMatrix),this._cameraPosition=[U[0]/U[3],U[1]/U[3],U[2]/U[3]],this._fogMatrix=new Float64Array(16),s.b3(this._fogMatrix,this.fovInRadians,this.width/this.height,k,this._helper._farZ),this._fogMatrix[8]=2*-o.x/this.width,this._fogMatrix[9]=2*o.y/this.height,s.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),s.b5(this._fogMatrix,this._fogMatrix,-this.rollInRadians),s.b6(this._fogMatrix,this._fogMatrix,this.pitchInRadians),s.b5(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),s.M(this._fogMatrix,this._fogMatrix,[-g,-x,0]),s.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),s.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=s.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,F);const Z=this._helper._width%2/2,K=this._helper._height%2/2,oe=Math.cos(this.bearingInRadians),re=Math.sin(-this.bearingInRadians),ce=g-Math.round(g)+oe*Z+re*K,ve=x-Math.round(x)+oe*K+re*Z,Le=new Float64Array(F);if(s.M(Le,Le,[ce>.5?ce-1:ce,ve>.5?ve-1:ve,0]),this._alignedProjMatrix=Le,F=s.ap(new Float64Array(16),this._pixelMatrix),!F)throw new Error("failed to invert matrix");this._pixelMatrixInverse=F,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const o=this.screenPointToMercatorCoordinate(new s.P(0,0)),u=[o.x*this.worldSize,o.y*this.worldSize,0,1];return s.av(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const o=s.ai(1,this.center.lat)*this.worldSize;return fe(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/o).toLngLat()}lngLatToCameraDepth(o,u){const g=s.a0.fromLngLat(o),x=[g.x*this.worldSize,g.y*this.worldSize,u,1];return s.av(x,x,this._viewProjMatrix),x[2]/x[3]}getProjectionData(o){const{overscaledTileID:u,aligned:g,applyTerrainMatrix:x}=o,E=this._helper.getMercatorTileCoordinates(u),k=u?this.calculatePosMatrix(u,g,!0):null;let F;return F=u&&u.terrainRttPosMatrix32f&&x?u.terrainRttPosMatrix32f:k||s.b7(),{mainMatrix:F,tileMercatorCoords:E,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:F}}isLocationOccluded(o){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(o,u,g){return 1}transformLightDirection(o){return s.aS(o)}getRayDirectionFromPixel(o){throw new Error("Not implemented.")}projectTileCoordinates(o,u,g,x){const E=this.calculatePosMatrix(g);let k;x?(k=[o,u,x(o,u),1],s.av(k,k,E)):(k=[o,u,0,1],Dt(k,k,E));const F=k[3];return{point:new s.P(k[0]/F,k[1]/F),signedDistanceFromCamera:F,isOccluded:!1}}populateCache(o){for(const u of o)this.calculatePosMatrix(u)}getMatrixForModel(o,u){const g=s.a0.fromLngLat(o,u),x=g.meterInMercatorCoordinateUnits(),E=s.b8();return s.M(E,E,[g.x,g.y,g.z]),s.b5(E,E,Math.PI),s.b6(E,E,Math.PI/2),s.N(E,E,[-x,x,x]),E}getProjectionDataForCustomLayer(o=!0){const u=new s.Z(0,0,0,0,0),g=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:o}),x=ne(u,this.worldSize);s.O(x,this._viewProjMatrix,x),g.tileMercatorCoords=[0,0,1,1];const E=[s.$,s.$,this.worldSize/this._helper.pixelsPerMeter],k=s.b9();return s.N(k,x,E),g.fallbackMatrix=k,g.mainMatrix=k,g}getFastPathSimpleProjectionMatrix(o){return this.calculatePosMatrix(o)}}function To(){s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ni(C){if(C.useSlerp)if(C.k<1){const o=s.ba(C.startEulerAngles.roll,C.startEulerAngles.pitch,C.startEulerAngles.bearing),u=s.ba(C.endEulerAngles.roll,C.endEulerAngles.pitch,C.endEulerAngles.bearing),g=new Float64Array(4);s.bb(g,o,u,C.k);const x=s.bc(g);C.tr.setRoll(x.roll),C.tr.setPitch(x.pitch),C.tr.setBearing(x.bearing)}else C.tr.setRoll(C.endEulerAngles.roll),C.tr.setPitch(C.endEulerAngles.pitch),C.tr.setBearing(C.endEulerAngles.bearing);else C.tr.setRoll(s.C.number(C.startEulerAngles.roll,C.endEulerAngles.roll,C.k)),C.tr.setPitch(s.C.number(C.startEulerAngles.pitch,C.endEulerAngles.pitch,C.k)),C.tr.setBearing(s.C.number(C.startEulerAngles.bearing,C.endEulerAngles.bearing,C.k))}function Ai(C,o,u,g,x){const E=x.padding,k=Pe(x.worldSize,u.getNorthWest()),F=Pe(x.worldSize,u.getNorthEast()),U=Pe(x.worldSize,u.getSouthEast()),Z=Pe(x.worldSize,u.getSouthWest()),K=s.ad(-g),oe=k.rotate(K),re=F.rotate(K),ce=U.rotate(K),ve=Z.rotate(K),Le=new s.P(Math.max(oe.x,re.x,ve.x,ce.x),Math.max(oe.y,re.y,ve.y,ce.y)),ze=new s.P(Math.min(oe.x,re.x,ve.x,ce.x),Math.min(oe.y,re.y,ve.y,ce.y)),Ne=Le.sub(ze),Ge=(x.width-(E.left+E.right+o.left+o.right))/Ne.x,et=(x.height-(E.top+E.bottom+o.top+o.bottom))/Ne.y;if(et<0||Ge<0)return void To();const Xe=Math.min(s.aj(x.scale*Math.min(Ge,et)),C.maxZoom),at=s.P.convert(C.offset),ht=new s.P((o.left-o.right)/2,(o.top-o.bottom)/2).rotate(s.ad(g)),Ye=at.add(ht).mult(x.scale/s.ae(Xe));return{center:ae(x.worldSize,k.add(U).div(2).sub(Ye)),zoom:Xe,bearing:g}}class Fh{get useGlobeControls(){return!1}handlePanInertia(o,u){return{easingOffset:o,easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(o,u){o.bearingDelta&&u.setBearing(u.bearing+o.bearingDelta),o.pitchDelta&&u.setPitch(u.pitch+o.pitchDelta),o.rollDelta&&u.setRoll(u.roll+o.rollDelta),o.zoomDelta&&u.setZoom(u.zoom+o.zoomDelta)}handleMapControlsPan(o,u,g){o.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(g,o.around)}cameraForBoxAndBearing(o,u,g,x,E){return Ai(o,u,g,x,E)}handleJumpToCenterZoom(o,u){o.zoom!==(u.zoom!==void 0?+u.zoom:o.zoom)&&o.setZoom(+u.zoom),u.center!==void 0&&o.setCenter(s.S.convert(u.center))}handleEaseTo(o,u){const g=o.zoom,x=o.padding,E={roll:o.roll,pitch:o.pitch,bearing:o.bearing},k={roll:u.roll===void 0?o.roll:u.roll,pitch:u.pitch===void 0?o.pitch:u.pitch,bearing:u.bearing===void 0?o.bearing:u.bearing},F=u.zoom!==void 0,U=!o.isPaddingEqual(u.padding);let Z=!1;const K=F?+u.zoom:o.zoom;let oe=o.centerPoint.add(u.offsetAsPoint);const re=o.screenPointToLocation(oe),{center:ce,zoom:ve}=o.getConstrained(s.S.convert(u.center||re),K??g);No(o,ce);const Le=Pe(o.worldSize,re),ze=Pe(o.worldSize,ce).sub(Le),Ne=s.ae(ve-g);return Z=ve!==g,{easeFunc:Ge=>{if(Z&&o.setZoom(s.C.number(g,ve,Ge)),s.bd(E,k)||Ni({startEulerAngles:E,endEulerAngles:k,tr:o,k:Ge,useSlerp:E.roll!=k.roll}),U&&(o.interpolatePadding(x,u.padding,Ge),oe=o.centerPoint.add(u.offsetAsPoint)),u.around)o.setLocationAtPoint(u.around,u.aroundPoint);else{const et=s.ae(o.zoom-g),Xe=ve>g?Math.min(2,Ne):Math.max(.5,Ne),at=Math.pow(Xe,1-Ge),ht=ae(o.worldSize,Le.add(ze.mult(Ge*at)).mult(et));o.setLocationAtPoint(o.renderWorldCopies?ht.wrap():ht,oe)}},isZooming:Z,elevationCenter:ce}}handleFlyTo(o,u){const g=u.zoom!==void 0,x=o.zoom,E=o.getConstrained(s.S.convert(u.center||u.locationAtOffset),g?+u.zoom:x),k=E.center,F=E.zoom;No(o,k);const U=Pe(o.worldSize,u.locationAtOffset),Z=Pe(o.worldSize,k).sub(U),K=Z.mag(),oe=s.ae(F-x);let re;if(u.minZoom!==void 0){const ce=Math.min(+u.minZoom,x,F),ve=o.getConstrained(k,ce).zoom;re=s.ae(ve-x)}return{easeFunc:(ce,ve,Le,ze)=>{o.setZoom(ce===1?F:x+s.aj(ve));const Ne=ce===1?k:ae(o.worldSize,U.add(Z.mult(Le)).mult(ve));o.setLocationAtPoint(o.renderWorldCopies?Ne.wrap():Ne,ze)},scaleOfZoom:oe,targetCenter:k,scaleOfMinZoom:re,pixelPathLength:K}}}class Tr{constructor(o,u,g){this.blendFunction=o,this.blendColor=u,this.mask=g}}Tr.Replace=[1,0],Tr.disabled=new Tr(Tr.Replace,s.be.transparent,[!1,!1,!1,!1]),Tr.unblended=new Tr(Tr.Replace,s.be.transparent,[!0,!0,!0,!0]),Tr.alphaBlended=new Tr([1,771],s.be.transparent,[!0,!0,!0,!0]);const es=2305;class _r{constructor(o,u,g){this.enable=o,this.mode=u,this.frontFace=g}}_r.disabled=new _r(!1,1029,es),_r.backCCW=new _r(!0,1029,es),_r.frontCCW=new _r(!0,1028,es);class vr{constructor(o,u,g){this.func=o,this.mask=u,this.range=g}}vr.ReadOnly=!1,vr.ReadWrite=!0,vr.disabled=new vr(519,vr.ReadOnly,[0,1]);const da=7680;class sr{constructor(o,u,g,x,E,k){this.test=o,this.ref=u,this.mask=g,this.fail=x,this.depthFail=E,this.pass=k}}sr.disabled=new sr({func:519,mask:0},0,0,da,da,da);const ka=new WeakMap;function ts(C){var o;if(ka.has(C))return ka.get(C);{const u=(o=C.getParameter(C.VERSION))===null||o===void 0?void 0:o.startsWith("WebGL 2.0");return ka.set(C,u),u}}class Cu{get awaitingQuery(){return!!this._readbackQueue}constructor(o){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=o;const u=o.context,g=u.gl;this._texFormat=g.RGBA,this._texType=g.UNSIGNED_BYTE;const x=new s.aK;x.emplaceBack(-1,-1),x.emplaceBack(2,-1),x.emplaceBack(-1,2);const E=new s.aM;E.emplaceBack(0,1,2),this._fullscreenTriangle=new ha(u.createVertexBuffer(x,La.members),u.createIndexBuffer(E),s.aL.simpleSegment(0,0,x.length,E.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(g.TEXTURE1);const k=g.createTexture();g.bindTexture(g.TEXTURE_2D,k),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST),g.texImage2D(g.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(k),ts(g)&&(this._pbo=g.createBuffer(),g.bindBuffer(g.PIXEL_PACK_BUFFER,this._pbo),g.bufferData(g.PIXEL_PACK_BUFFER,4,g.STREAM_READ),g.bindBuffer(g.PIXEL_PACK_BUFFER,null))}destroy(){const o=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),o.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(o,u){const g=this._updateCount;return this._readbackQueue?g>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():g>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(o,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const o=this._cachedRenderContext.context,u=o.gl;o.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),o.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(o,u){const g=this._cachedRenderContext.context,x=g.gl;if(this._bindFramebuffer(),g.viewport.set([0,0,this._texWidth,this._texHeight]),g.clear({color:s.be.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(g,x.TRIANGLES,vr.disabled,sr.disabled,Tr.unblended,_r.disabled,((E,k)=>({u_input:E,u_output_expected:k}))(o,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&ts(x)){x.bindBuffer(x.PIXEL_PACK_BUFFER,this._pbo),x.readBuffer(x.COLOR_ATTACHMENT0),x.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),x.bindBuffer(x.PIXEL_PACK_BUFFER,null);const E=x.fenceSync(x.SYNC_GPU_COMMANDS_COMPLETE,0);x.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:E}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const o=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&ts(o)){const u=o.clientWaitSync(this._readbackQueue.sync,0,0);if(u===o.WAIT_FAILED)return s.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===o.TIMEOUT_EXPIRED)return;o.bindBuffer(o.PIXEL_PACK_BUFFER,this._pbo),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),o.bindBuffer(o.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),o.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Cu._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(o){let u=0;return u+=o[0]/256,u+=o[1]/65536,u+=o[2]/16777216,o[3]<127&&(u=-u),u/128}}const Bo=s.$/128;function Eu(C,o){const u=C.granularity!==void 0?Math.max(C.granularity,1):1,g=u+(C.generateBorders?2:0),x=u+(C.extendToNorthPole||C.generateBorders?1:0)+(C.extendToSouthPole||C.generateBorders?1:0),E=g+1,k=x+1,F=C.generateBorders?-1:0,U=C.generateBorders||C.extendToNorthPole?-1:0,Z=u+(C.generateBorders?1:0),K=u+(C.generateBorders||C.extendToSouthPole?1:0),oe=E*k,re=g*x*6,ce=E*k>65536;if(ce&&o==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ve=ce||o==="32bit",Le=new Int16Array(2*oe);let ze=0;for(let et=U;et<=K;et++)for(let Xe=F;Xe<=Z;Xe++){let at=Xe/u*s.$;Xe===-1&&(at=-Bo),Xe===u+1&&(at=s.$+Bo);let ht=et/u*s.$;et===-1&&(ht=C.extendToNorthPole?s.bg:-Bo),et===u+1&&(ht=C.extendToSouthPole?s.bh:s.$+Bo),Le[ze++]=at,Le[ze++]=ht}const Ne=ve?new Uint32Array(re):new Uint16Array(re);let Ge=0;for(let et=0;et<x;et++)for(let Xe=0;Xe<g;Xe++){const at=Xe+1+et*E,ht=Xe+(et+1)*E,Ye=Xe+1+(et+1)*E;Ne[Ge++]=Xe+et*E,Ne[Ge++]=ht,Ne[Ge++]=at,Ne[Ge++]=at,Ne[Ge++]=ht,Ne[Ge++]=Ye}return{vertices:Le.buffer.slice(0),indices:Ne.buffer.slice(0),uses32bitIndices:ve}}const Js=new s.aJ({fill:new s.bi(128,2),line:new s.bi(512,0),tile:new s.bi(128,32),stencil:new s.bi(128,1),circle:3});class Cp{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return io.projectionGlobe}get vertexShaderPreludeCode(){return io.projectionMercator.vertexSource}get subdivisionGranularity(){return Js}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(o){this._errorMeasurement||(this._errorMeasurement=new Cu(o));const u=s.U(this._errorQueryLatitudeDegrees),g=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,x=this._errorMeasurement.updateErrorLoop(u,g),E=S.now();x!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=x,this._errorMeasurementLastChangeTime=E);const k=Math.min(Math.max((E-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=s.bj(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,s.bk(k))}_getMeshKey(o){return`${o.granularity.toString(36)}_${o.generateBorders?"b":""}${o.extendToNorthPole?"n":""}${o.extendToSouthPole?"s":""}`}getMeshFromTileID(o,u,g,x,E){const k=(E==="stencil"?Js.stencil:Js.tile).getGranularityForZoomLevel(u.z);return this._getMesh(o,{granularity:k,generateBorders:g,extendToNorthPole:u.y===0&&x,extendToSouthPole:u.y===(1<<u.z)-1&&x})}_getMesh(o,u){const g=this._getMeshKey(u);if(g in this._tileMeshCache)return this._tileMeshCache[g];const x=function(E,k){const F=Eu(k,"16bit"),U=s.aK.deserialize({arrayBuffer:F.vertices,length:F.vertices.byteLength/2/2}),Z=s.aM.deserialize({arrayBuffer:F.indices,length:F.indices.byteLength/2/3});return new ha(E.createVertexBuffer(U,La.members),E.createIndexBuffer(Z),s.aL.simpleSegment(0,0,U.length,Z.length))}(o,u);return this._tileMeshCache[g]=x,x}recalculate(o){}hasTransition(){const o=S.now();let u=!1;return u=u||(o-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(o){this._errorQueryLatitudeDegrees=o}}const cl=new s.r({type:new s.D(s.v.projection.type)});class Fc extends s.E{constructor(o){super(),this._transitionable=new s.t(cl),this.setProjection(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.F(0)),this._mercatorProjection=new Oh,this._verticalPerspectiveProjection=new Cp}get transitionState(){const o=this.properties.get("type");if(typeof o=="string"&&o==="mercator")return 0;if(typeof o=="string"&&o==="vertical-perspective")return 1;if(o instanceof s.bl){if(o.from==="vertical-perspective"&&o.to==="mercator")return 1-o.transition;if(o.from==="mercator"&&o.to==="vertical-perspective")return o.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(o){this._mercatorProjection.updateGPUdependent(o),this._verticalPerspectiveProjection.updateGPUdependent(o)}getMeshFromTileID(o,u,g,x,E){return this.currentProjection.getMeshFromTileID(o,u,g,x,E)}setProjection(o){this._transitionable.setValue("type",o?.type||"mercator")}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}setErrorQueryLatitudeDegrees(o){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(o),this._mercatorProjection.setErrorQueryLatitudeDegrees(o)}}function Kl(C){const o=ul(C.worldSize,C.center.lat);return 2*Math.PI*o}function Qs(C,o,u,g,x){const E=1/(1<<x),k=o/s.$*E+g*E,F=s.bn((C/s.$*E+u*E)*Math.PI*2+Math.PI,2*Math.PI),U=2*Math.atan(Math.exp(Math.PI-k*Math.PI*2))-.5*Math.PI,Z=Math.cos(U),K=new Float64Array(3);return K[0]=Math.sin(F)*Z,K[1]=Math.sin(U),K[2]=Math.cos(F)*Z,K}function ji(C){return function(o,u){const g=Math.cos(u),x=new Float64Array(3);return x[0]=Math.sin(o)*g,x[1]=Math.sin(u),x[2]=Math.cos(o)*g,x}(C.lng*Math.PI/180,C.lat*Math.PI/180)}function ul(C,o){return C/(2*Math.PI)/Math.cos(o*Math.PI/180)}function Tu(C){const o=Math.asin(C[1])/Math.PI*180,u=Math.sqrt(C[0]*C[0]+C[2]*C[2]);if(u>1e-6){const g=C[0]/u,x=Math.acos(C[2]/u),E=(g>0?x:-x)/Math.PI*180;return new s.S(s.aN(E,-180,180),o)}return new s.S(0,o)}function fo(C){return Math.cos(C*Math.PI/180)}function Si(C,o){const u=fo(C),g=fo(o);return s.aj(g/u)}function Nc(C,o){const u=C.rotate(o.bearingInRadians),g=o.zoom+Si(o.center.lat,0),x=s.bj(1/fo(o.center.lat),1/fo(Math.min(Math.abs(o.center.lat),60)),s.bm(g,7,3,0,1)),E=360/Kl({worldSize:o.worldSize,center:{lat:o.center.lat}});return new s.S(o.center.lng-u.x*E*x,s.ag(o.center.lat+u.y*E,-s.ah,s.ah))}function Da(C){const o=.5*C,u=Math.sin(o),g=Math.cos(o);return Math.log(u+g)-Math.log(g-u)}function Pu(C,o,u,g){const x=C.lat+u*g;if(Math.abs(u)>1){const E=(Math.sign(C.lat+u)!==Math.sign(C.lat)?-Math.abs(C.lat):Math.abs(C.lat))*Math.PI/180,k=Math.abs(C.lat+u)*Math.PI/180,F=Da(E+g*(k-E)),U=Da(E),Z=Da(k);return new s.S(C.lng+o*((F-U)/(Z-U)),x)}return new s.S(C.lng+o*g,x)}class Ep{constructor(o){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=o}swapBuffers(){if(!this._hadAnyChanges)return;const o=this._cachePrevious;this._cachePrevious=this._cache,this._cache=o,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(o,u,g,x){const E=`${o.z}_${o.x}_${o.y}_${x?.terrain?"t":""}`,k=this._cache.get(E);if(k)return k;const F=this._cachePrevious.get(E);if(F)return this._cache.set(E,F),F;const U=this._boundingVolumeFactory(o,u,g,x);return this._cache.set(E,U),this._hadAnyChanges=!0,U}}class za{constructor(o,u,g,x){this.min=g,this.max=x,this.points=o,this.planes=u}static fromAabb(o,u){const g=[];for(let x=0;x<8;x++)g.push([1&~x?o[0]:u[0],(x>>1&1)==1?u[1]:o[1],(x>>2&1)==1?u[2]:o[2]]);return new za(g,[[-1,0,0,u[0]],[1,0,0,-o[0]],[0,-1,0,u[1]],[0,1,0,-o[1]],[0,0,-1,u[2]],[0,0,1,-o[2]]],o,u)}static fromCenterSizeAngles(o,u,g){const x=s.bq([],g[0],g[1],g[2]),E=s.br([],[u[0],0,0],x),k=s.br([],[0,u[1],0],x),F=s.br([],[0,0,u[2]],x),U=[...o],Z=[...o];for(let oe=0;oe<8;oe++)for(let re=0;re<3;re++){const ce=o[re]+E[re]*(1&~oe?-1:1)+k[re]*((oe>>1&1)==1?1:-1)+F[re]*((oe>>2&1)==1?1:-1);U[re]=Math.min(U[re],ce),Z[re]=Math.max(Z[re],ce)}const K=[];for(let oe=0;oe<8;oe++){const re=[...o];s.aR(re,re,s.aQ([],E,1&~oe?-1:1)),s.aR(re,re,s.aQ([],k,(oe>>1&1)==1?1:-1)),s.aR(re,re,s.aQ([],F,(oe>>2&1)==1?1:-1)),K.push(re)}return new za(K,[[...E,-s.aW(E,K[0])],[...k,-s.aW(k,K[0])],[...F,-s.aW(F,K[0])],[-E[0],-E[1],-E[2],-s.aW(E,K[7])],[-k[0],-k[1],-k[2],-s.aW(k,K[7])],[-F[0],-F[1],-F[2],-s.aW(F,K[7])]],U,Z)}intersectsFrustum(o){let u=!0;const g=this.points.length,x=this.planes.length,E=o.planes.length,k=o.points.length;for(let F=0;F<E;F++){const U=o.planes[F];let Z=0;for(let K=0;K<g;K++){const oe=this.points[K];U[0]*oe[0]+U[1]*oe[1]+U[2]*oe[2]+U[3]>=0&&Z++}if(Z===0)return 0;Z<g&&(u=!1)}if(u)return 2;for(let F=0;F<x;F++){const U=this.planes[F];let Z=0;for(let K=0;K<k;K++){const oe=o.points[K];U[0]*oe[0]+U[1]*oe[1]+U[2]*oe[2]+U[3]>=0&&Z++}if(Z===0)return 0}return 1}intersectsPlane(o){const u=this.points.length;let g=0;for(let x=0;x<u;x++){const E=this.points[x];o[0]*E[0]+o[1]*E[1]+o[2]*E[2]+o[3]>=0&&g++}return g===u?2:g===0?0:1}}function hl(C,o,u){const g=C-o;return g<0?-g:Math.max(0,g-u)}function Au(C,o,u,g,x){const E=C-u;let k;return k=E<0?Math.min(-E,1+E-x):E>1?Math.min(Math.max(E-x,0),1-E):0,Math.max(k,hl(o,g,x))}class rg{constructor(){this._boundingVolumeCache=new Ep(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(o,u,g,x){const E=1<<g.z,k=1/E,F=g.x/E,U=g.y/E;let Z=2;return Z=Math.min(Z,Au(o,u,F,U,k)),Z=Math.min(Z,Au(o,u,F+.5,-U-k,k)),Z=Math.min(Z,Au(o,u,F+.5,2-U-k,k)),Z}getWrap(o,u,g){const x=1<<u.z,E=1/x,k=u.x/x,F=hl(o.x,k,E),U=hl(o.x,k-1,E),Z=hl(o.x,k+1,E),K=Math.min(F,U,Z);return K===Z?1:K===U?-1:0}allowVariableZoom(o,u){return Be(o,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(o,u,g,x){return this._boundingVolumeCache.getTileBoundingVolume(o,u,g,x)}_computeTileBoundingVolume(o,u,g,x){var E,k;let F=g,U=g;if(x?.terrain){const Z=new s.Z(o.z,u,o.z,o.x,o.y),K=x.terrain.getMinMaxElevation(Z);F=(E=K.minElevation)!==null&&E!==void 0?E:g,U=(k=K.maxElevation)!==null&&k!==void 0?k:g}if(F/=s.bt,U/=s.bt,F+=1,U+=1,o.z<=0)return za.fromAabb([-U,-U,-U],[U,U,U]);if(o.z===1)return za.fromAabb([o.x===0?-U:0,o.y===0?0:-U,-U],[o.x===0?0:U,o.y===0?U:0,U]);{const Z=[Qs(0,0,o.x,o.y,o.z),Qs(s.$,0,o.x,o.y,o.z),Qs(s.$,s.$,o.x,o.y,o.z),Qs(0,s.$,o.x,o.y,o.z)],K=[];for(const Tt of Z)K.push(s.aQ([],Tt,U));if(U!==F)for(const Tt of Z)K.push(s.aQ([],Tt,F));o.y===0&&K.push([0,1,0]),o.y===(1<<o.z)-1&&K.push([0,-1,0]);const oe=[1,1,1],re=[-1,-1,-1];for(const Tt of K)for(let kt=0;kt<3;kt++)oe[kt]=Math.min(oe[kt],Tt[kt]),re[kt]=Math.max(re[kt],Tt[kt]);const ce=Qs(s.$/2,s.$/2,o.x,o.y,o.z),ve=s.aV([],[0,1,0],ce);s.aU(ve,ve);const Le=s.aV([],ce,ve);s.aU(Le,Le);const ze=s.aV([],Z[2],Z[1]);s.aU(ze,ze);const Ne=s.aV([],Z[0],Z[3]);s.aU(Ne,Ne),K.push(s.aQ([],ce,U)),o.y>=(1<<o.z)/2&&K.push(s.aQ([],Qs(s.$/2,0,o.x,o.y,o.z),U)),o.y<(1<<o.z)/2&&K.push(s.aQ([],Qs(s.$/2,s.$,o.x,o.y,o.z),U));const Ge=ns(ce,K),et=ns(Le,K),Xe=[-ce[0],-ce[1],-ce[2],Ge.max],at=[ce[0],ce[1],ce[2],-Ge.min],ht=[-Le[0],-Le[1],-Le[2],et.max],Ye=[Le[0],Le[1],Le[2],-et.min],pt=[...ze,0],Pt=[...Ne,0],Mt=[];return o.y===0?Mt.push(s.bs(Pt,pt,Xe),s.bs(Pt,pt,at)):Mt.push(s.bs(ht,pt,Xe),s.bs(ht,pt,at),s.bs(ht,Pt,Xe),s.bs(ht,Pt,at)),o.y===(1<<o.z)-1?Mt.push(s.bs(Pt,pt,Xe),s.bs(Pt,pt,at)):Mt.push(s.bs(Ye,pt,Xe),s.bs(Ye,pt,at),s.bs(Ye,Pt,Xe),s.bs(Ye,Pt,at)),new za(Mt,[Xe,at,ht,Ye,pt,Pt],oe,re)}}}function ns(C,o){let u=1/0,g=-1/0;for(const x of o){const E=s.aW(C,x);u=Math.min(u,E),g=Math.max(g,E)}return{min:u,max:g}}class Iu{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,g){return this._helper.interpolatePadding(o,u,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u){this._helper.resize(o,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o){}constructor(){this._cachedClippingPlane=s.bu(),this._projectionMatrix=s.b8(),this._globeViewProjMatrix32f=s.b7(),this._globeViewProjMatrixNoCorrection=s.b8(),this._globeViewProjMatrixNoCorrectionInverted=s.b8(),this._globeProjMatrixInverted=s.b8(),this._cameraPosition=s.bo(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ks({calcMatrices:()=>{this._calcMatrices()},getConstrained:(o,u)=>this.getConstrained(o,u)}),this._coveringTilesDetailsProvider=new rg}clone(){const o=new Iu;return o.apply(this),o}apply(o,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(o)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const o=s.bo();return o[0]=this._cameraPosition[0],o[1]=this._cameraPosition[1],o[2]=this._cameraPosition[2],o}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(o){const{overscaledTileID:u,applyGlobeMatrix:g}=o,x=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:x,clippingPlane:this._cachedClippingPlane,projectionTransition:g?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(o){const u=this.pitchInRadians,g=this.cameraToCenterDistance/o,x=Math.sin(u)*g,E=Math.cos(u)*g+1,k=1/Math.sqrt(x*x+E*E)*1;let F=-x,U=E;const Z=Math.sqrt(F*F+U*U);F/=Z,U/=Z;const K=[0,F,U];s.bv(K,K,[0,0,0],-this.bearingInRadians),s.bw(K,K,[0,0,0],-1*this.center.lat*Math.PI/180),s.bx(K,K,[0,0,0],this.center.lng*Math.PI/180);const oe=1/s.aY(K);return s.aQ(K,K,oe),[...K,-k*oe]}isLocationOccluded(o){return!this.isSurfacePointVisible(ji(o))}transformLightDirection(o){const u=this._helper._center.lng*Math.PI/180,g=this._helper._center.lat*Math.PI/180,x=Math.cos(g),E=[Math.sin(u)*x,Math.sin(g),Math.cos(u)*x],k=[E[2],0,-E[0]],F=[0,0,0];s.aV(F,k,E),s.aU(k,k),s.aU(F,F);const U=[0,0,0];return s.aU(U,[k[0]*o[0]+F[0]*o[1]+E[0]*o[2],k[1]*o[0]+F[1]*o[1]+E[1]*o[2],k[2]*o[0]+F[2]*o[1]+E[2]*o[2]]),U}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(o,u,g){const x=function(F,U,Z){const K=1/(1<<Z.z);return new s.a0(F/s.$*K+Z.x*K,U/s.$*K+Z.y*K)}(o,u,g.canonical),E=(k=x.y,[s.bn(x.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-k*Math.PI*2))-.5*Math.PI]);var k;return this.getCircleRadiusCorrection()/Math.cos(E[1])}projectTileCoordinates(o,u,g,x){const E=g.canonical,k=Qs(o,u,E.x,E.y,E.z),F=1+(x?x(o,u):0)/s.bt,U=[k[0]*F,k[1]*F,k[2]*F,1];s.av(U,U,this._globeViewProjMatrixNoCorrection);const Z=this._cachedClippingPlane,K=Z[0]*k[0]+Z[1]*k[1]+Z[2]*k[2]+Z[3]<0;return{point:new s.P(U[0]/U[3],U[1]/U[3]),signedDistanceFromCamera:U[3],isOccluded:K}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const o=ul(this.worldSize,this.center.lat),u=s.b9(),g=s.b9();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*o),s.b3(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const x=this.centerOffset;u[8]=2*-x.x/this._helper._width,u[9]=2*x.y/this._helper._height,this._projectionMatrix=s.b4(u),this._globeProjMatrixInverted=s.b9(),s.ap(this._globeProjMatrixInverted,u),s.M(u,u,[0,0,-this.cameraToCenterDistance]),s.b5(u,u,this.rollInRadians),s.b6(u,u,-this.pitchInRadians),s.b5(u,u,this.bearingInRadians),s.M(u,u,[0,0,-o]);const E=s.bo();E[0]=o,E[1]=o,E[2]=o,s.b6(g,u,this.center.lat*Math.PI/180),s.by(g,g,-this.center.lng*Math.PI/180),s.N(g,g,E),this._globeViewProjMatrixNoCorrection=g,s.b6(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),s.by(u,u,-this.center.lng*Math.PI/180),s.N(u,u,E),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=s.b9(),s.ap(this._globeViewProjMatrixNoCorrectionInverted,g);const k=s.bo();this._cameraPosition=s.bo(),this._cameraPosition[2]=this.cameraToCenterDistance/o,s.bv(this._cameraPosition,this._cameraPosition,k,-this.rollInRadians),s.bw(this._cameraPosition,this._cameraPosition,k,this.pitchInRadians),s.bv(this._cameraPosition,this._cameraPosition,k,-this.bearingInRadians),s.aR(this._cameraPosition,this._cameraPosition,[0,0,1]),s.bw(this._cameraPosition,this._cameraPosition,k,-this.center.lat*Math.PI/180),s.bx(this._cameraPosition,this._cameraPosition,k,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(o);const F=s.b4(this._globeViewProjMatrixNoCorrectionInverted);s.N(F,F,[1,1,-1]),this._cachedFrustum=Di.fromInvProjectionMatrix(F,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(o){s.w("calculateFogMatrix is not supported on globe projection.");const u=s.b9();return s.af(u),u}getVisibleUnwrappedCoordinates(o){return[new s.b1(0,o)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){o&&s.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const g=ji(o);s.aQ(g,g,1+u/s.bt);const x=s.bu();return s.av(x,[g[0],g[1],g[2],1],this._globeViewProjMatrixNoCorrection),x[2]/x[3]}populateCache(o){}getBounds(){const o=.5*this.width,u=.5*this.height,g=[new s.P(0,0),new s.P(o,0),new s.P(this.width,0),new s.P(this.width,u),new s.P(this.width,this.height),new s.P(o,this.height),new s.P(0,this.height),new s.P(0,u)],x=[];for(const oe of g)x.push(this.unprojectScreenPoint(oe));let E=0,k=0,F=0,U=0;const Z=this.center;for(const oe of x){const re=s.bz(Z.lng,oe.lng),ce=s.bz(Z.lat,oe.lat);re<k&&(k=re),re>E&&(E=re),ce<U&&(U=ce),ce>F&&(F=ce)}const K=[Z.lng+k,Z.lat+U,Z.lng+E,Z.lat+F];return this.isSurfacePointOnScreen([0,1,0])&&(K[3]=90,K[0]=-180,K[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(K[1]=-90,K[0]=-180,K[2]=180),new tn(K)}getConstrained(o,u){const g=s.ag(o.lat,-s.ah,s.ah),x=s.ag(+u,this.minZoom+Si(0,g),this.maxZoom);return{center:new s.S(o.lng,g),zoom:x}}calculateCenterFromCameraLngLatAlt(o,u,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,g,x)}setLocationAtPoint(o,u){const g=ji(this.unprojectScreenPoint(u)),x=ji(o),E=s.bo();s.bA(E);const k=s.bo();s.bx(k,g,E,-this.center.lng*Math.PI/180),s.bw(k,k,E,this.center.lat*Math.PI/180);const F=x[0]*x[0]+x[2]*x[2],U=k[0]*k[0];if(F<U)return;const Z=Math.sqrt(F-U),K=-Z,oe=s.bB(x[0],x[2],k[0],Z),re=s.bB(x[0],x[2],k[0],K),ce=s.bo();s.bx(ce,x,E,-oe);const ve=s.bB(ce[1],ce[2],k[1],k[2]),Le=s.bo();s.bx(Le,x,E,-re);const ze=s.bB(Le[1],Le[2],k[1],k[2]),Ne=.5*Math.PI,Ge=ve>=-Ne&&ve<=Ne,et=ze>=-Ne&&ze<=Ne;let Xe,at;if(Ge&&et){const Pt=this.center.lng*Math.PI/180,Mt=this.center.lat*Math.PI/180;s.bC(oe,Pt)+s.bC(ve,Mt)<s.bC(re,Pt)+s.bC(ze,Mt)?(Xe=oe,at=ve):(Xe=re,at=ze)}else if(Ge)Xe=oe,at=ve;else{if(!et)return;Xe=re,at=ze}const ht=Xe/Math.PI*180,Ye=at/Math.PI*180,pt=this.center.lat;this.setCenter(new s.S(ht,s.ag(Ye,-90,90))),this.setZoom(this.zoom+Si(pt,this.center.lat))}locationToScreenPoint(o,u){const g=ji(o);if(u){const x=u.getElevationForLngLatZoom(o,this._helper._tileZoom);s.aQ(g,g,1+x/s.bt)}return this._projectSurfacePointToScreen(g)}_projectSurfacePointToScreen(o){const u=s.bu();return s.av(u,[...o,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new s.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(o,u){if(u){const g=u.pointCoordinate(o);if(g)return g}return s.a0.fromLngLat(this.unprojectScreenPoint(o))}screenPointToLocation(o,u){var g;return(g=this.screenPointToMercatorCoordinate(o,u))===null||g===void 0?void 0:g.toLngLat()}isPointOnMapSurface(o,u){const g=this._cameraPosition,x=this.getRayDirectionFromPixel(o);return!!this.rayPlanetIntersection(g,x)}getRayDirectionFromPixel(o){const u=s.bu();u[0]=o.x/this.width*2-1,u[1]=-1*(o.y/this.height*2-1),u[2]=1,u[3]=1,s.av(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const g=s.bo();g[0]=u[0]-this._cameraPosition[0],g[1]=u[1]-this._cameraPosition[1],g[2]=u[2]-this._cameraPosition[2];const x=s.bo();return s.aU(x,g),x}isSurfacePointVisible(o){const u=this._cachedClippingPlane;return u[0]*o[0]+u[1]*o[1]+u[2]*o[2]+u[3]>=0}isSurfacePointOnScreen(o){if(!this.isSurfacePointVisible(o))return!1;const u=s.bu();return s.av(u,[...o,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(o,u){const g=s.aW(o,u),x=s.bo(),E=s.bo();s.aQ(E,u,g),s.aT(x,o,E);const k=1-s.aW(x,x);if(k<0)return null;const F=s.aW(o,o)-1,U=-g+(g<0?1:-1)*Math.sqrt(k),Z=F/U,K=U;return{tMin:Math.min(Z,K),tMax:Math.max(Z,K)}}unprojectScreenPoint(o){const u=this._cameraPosition,g=this.getRayDirectionFromPixel(o),x=this.rayPlanetIntersection(u,g);if(x){const K=s.bo();s.aR(K,u,[g[0]*x.tMin,g[1]*x.tMin,g[2]*x.tMin]);const oe=s.bo();return s.aU(oe,K),Tu(oe)}const E=this._cachedClippingPlane,k=E[0]*g[0]+E[1]*g[1]+E[2]*g[2],F=-s.b0(E,u)/k,U=s.bo();if(F>0)s.aR(U,u,[g[0]*F,g[1]*F,g[2]*F]);else{const K=s.bo();s.aR(K,u,[2*g[0],2*g[1],2*g[2]]);const oe=s.b0(this._cachedClippingPlane,K);s.aT(U,K,[this._cachedClippingPlane[0]*oe,this._cachedClippingPlane[1]*oe,this._cachedClippingPlane[2]*oe])}const Z=function(K){const oe=s.bo();return oe[0]=K[0]*-K[3],oe[1]=K[1]*-K[3],oe[2]=K[2]*-K[3],{center:oe,radius:Math.sqrt(1-K[3]*K[3])}}(E);return Tu(function(K,oe,re){const ce=s.bo();s.aT(ce,re,K);const ve=s.bo();return s.bp(ve,K,ce,oe/s.a_(ce)),ve}(Z.center,Z.radius,U))}getMatrixForModel(o,u){const g=s.S.convert(o),x=1/s.bt,E=s.b8();return s.by(E,E,g.lng/180*Math.PI),s.b6(E,E,-g.lat/180*Math.PI),s.M(E,E,[0,0,1+u/s.bt]),s.b6(E,E,.5*Math.PI),s.N(E,E,[x,x,x]),E}getProjectionDataForCustomLayer(o=!0){const u=this.getProjectionData({overscaledTileID:new s.Z(0,0,0,0,0),applyGlobeMatrix:o});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(o){}}class Ls{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,g){return this._helper.interpolatePadding(o,u,g)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u,g=!0){this._helper.resize(o,u,g)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(o,u){this._globeness=o,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ks({calcMatrices:()=>{this._calcMatrices()},getConstrained:(o,u)=>this.getConstrained(o,u)}),this._globeness=1,this._mercatorTransform=new Zi,this._verticalPerspectiveTransform=new Iu}clone(){const o=new Ls;return o._globeness=this._globeness,o._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,o.apply(this),o}apply(o){this._helper.apply(o),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(o){const u=this._mercatorTransform.getProjectionData(o),g=this._verticalPerspectiveTransform.getProjectionData(o);return{mainMatrix:this.isGlobeRendering?g.mainMatrix:u.mainMatrix,clippingPlane:g.clippingPlane,tileMercatorCoords:g.tileMercatorCoords,projectionTransition:o.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(o){return this.currentTransform.isLocationOccluded(o)}transformLightDirection(o){return this.currentTransform.transformLightDirection(o)}getPixelScale(){return s.bj(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return s.bj(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(o,u,g){const x=this._mercatorTransform.getPitchedTextCorrection(o,u,g),E=this._verticalPerspectiveTransform.getPitchedTextCorrection(o,u,g);return s.bj(x,E,this._globeness)}projectTileCoordinates(o,u,g,x){return this.currentTransform.projectTileCoordinates(o,u,g,x)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(o){return this.currentTransform.calculateFogMatrix(o)}getVisibleUnwrappedCoordinates(o){return this.currentTransform.getVisibleUnwrappedCoordinates(o)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(o){this._mercatorTransform.recalculateZoomAndCenter(o),this._verticalPerspectiveTransform.recalculateZoomAndCenter(o)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,u){return this.currentTransform.lngLatToCameraDepth(o,u)}populateCache(o){this._mercatorTransform.populateCache(o),this._verticalPerspectiveTransform.populateCache(o)}getBounds(){return this.currentTransform.getBounds()}getConstrained(o,u){return this.currentTransform.getConstrained(o,u)}calculateCenterFromCameraLngLatAlt(o,u,g,x){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,g,x)}setLocationAtPoint(o,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(o,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(o,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(o,u){return this.currentTransform.locationToScreenPoint(o,u)}screenPointToMercatorCoordinate(o,u){return this.currentTransform.screenPointToMercatorCoordinate(o,u)}screenPointToLocation(o,u){return this.currentTransform.screenPointToLocation(o,u)}isPointOnMapSurface(o,u){return this.currentTransform.isPointOnMapSurface(o,u)}getRayDirectionFromPixel(o){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(o)}getMatrixForModel(o,u){return this.currentTransform.getMatrixForModel(o,u)}getProjectionDataForCustomLayer(o=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(o);if(!this.isGlobeRendering)return u;const g=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(o);return g.fallbackMatrix=u.mainMatrix,g}getFastPathSimpleProjectionMatrix(o){return this.currentTransform.getFastPathSimpleProjectionMatrix(o)}}class Uo{get useGlobeControls(){return!0}handlePanInertia(o,u){const g=Nc(o,u);return Math.abs(g.lng-u.center.lng)>180&&(g.lng=u.center.lng+179.5*Math.sign(g.lng-u.center.lng)),{easingCenter:g,easingOffset:new s.P(0,0)}}handleMapControlsRollPitchBearingZoom(o,u){const g=o.around,x=u.screenPointToLocation(g);o.bearingDelta&&u.setBearing(u.bearing+o.bearingDelta),o.pitchDelta&&u.setPitch(u.pitch+o.pitchDelta),o.rollDelta&&u.setRoll(u.roll+o.rollDelta);const E=u.zoom;o.zoomDelta&&u.setZoom(u.zoom+o.zoomDelta);const k=u.zoom-E;if(k===0)return;const F=s.bz(u.center.lng,x.lng),U=F/(Math.abs(F/180)+1),Z=s.bz(u.center.lat,x.lat),K=u.getRayDirectionFromPixel(g),oe=u.cameraPosition,re=-1*s.aW(oe,K),ce=s.bo();s.aR(ce,oe,[K[0]*re,K[1]*re,K[2]*re]);const ve=s.aY(ce)-1,Le=Math.exp(.5*-Math.max(ve-.3,0)),ze=ul(u.worldSize,u.center.lat)/Math.min(u.width,u.height),Ne=s.bm(ze,.9,.5,1,.25),Ge=(1-s.ae(-k))*Math.min(Le,Ne),et=u.center.lat,Xe=u.zoom,at=new s.S(u.center.lng+U*Ge,s.ag(u.center.lat+Z*Ge,-s.ah,s.ah));u.setLocationAtPoint(x,g);const ht=u.center,Ye=s.bm(Math.abs(F),45,85,0,1),pt=s.bm(ze,.75,.35,0,1),Pt=Math.pow(Math.max(Ye,pt),.25),Mt=s.bz(ht.lng,at.lng),Tt=s.bz(ht.lat,at.lat);u.setCenter(new s.S(ht.lng+Mt*Pt,ht.lat+Tt*Pt).wrap()),u.setZoom(Xe+Si(et,u.center.lat))}handleMapControlsPan(o,u,g){if(!o.panDelta)return;const x=u.center.lat,E=u.zoom;u.setCenter(Nc(o.panDelta,u).wrap()),u.setZoom(E+Si(x,u.center.lat))}cameraForBoxAndBearing(o,u,g,x,E){const k=Ai(o,u,g,x,E),F=u.left/E.width*2-1,U=(E.width-u.right)/E.width*2-1,Z=u.top/E.height*-2+1,K=(E.height-u.bottom)/E.height*-2+1,oe=s.bz(g.getWest(),g.getEast())<0,re=oe?g.getEast():g.getWest(),ce=oe?g.getWest():g.getEast(),ve=Math.max(g.getNorth(),g.getSouth()),Le=Math.min(g.getNorth(),g.getSouth()),ze=re+.5*s.bz(re,ce),Ne=ve+.5*s.bz(ve,Le),Ge=E.clone();Ge.setCenter(k.center),Ge.setBearing(k.bearing),Ge.setPitch(0),Ge.setRoll(0),Ge.setZoom(k.zoom);const et=Ge.modelViewProjectionMatrix,Xe=[ji(g.getNorthWest()),ji(g.getNorthEast()),ji(g.getSouthWest()),ji(g.getSouthEast()),ji(new s.S(ce,Ne)),ji(new s.S(re,Ne)),ji(new s.S(ze,ve)),ji(new s.S(ze,Le))],at=ji(k.center);let ht=Number.POSITIVE_INFINITY;for(const Ye of Xe)F<0&&(ht=Uo.getLesserNonNegativeNonNull(ht,Uo.solveVectorScale(Ye,at,et,"x",F))),U>0&&(ht=Uo.getLesserNonNegativeNonNull(ht,Uo.solveVectorScale(Ye,at,et,"x",U))),Z>0&&(ht=Uo.getLesserNonNegativeNonNull(ht,Uo.solveVectorScale(Ye,at,et,"y",Z))),K<0&&(ht=Uo.getLesserNonNegativeNonNull(ht,Uo.solveVectorScale(Ye,at,et,"y",K)));if(Number.isFinite(ht)&&ht!==0)return k.zoom=Ge.zoom+s.aj(ht),k;To()}handleJumpToCenterZoom(o,u){const g=o.center.lat,x=o.getConstrained(u.center?s.S.convert(u.center):o.center,o.zoom).center;o.setCenter(x.wrap());const E=u.zoom!==void 0?+u.zoom:o.zoom+Si(g,x.lat);o.zoom!==E&&o.setZoom(E)}handleEaseTo(o,u){const g=o.zoom,x=o.center,E=o.padding,k={roll:o.roll,pitch:o.pitch,bearing:o.bearing},F={roll:u.roll===void 0?o.roll:u.roll,pitch:u.pitch===void 0?o.pitch:u.pitch,bearing:u.bearing===void 0?o.bearing:u.bearing},U=u.zoom!==void 0,Z=!o.isPaddingEqual(u.padding);let K=!1;const oe=u.center?s.S.convert(u.center):x,re=o.getConstrained(oe,g).center;No(o,re);const ce=o.clone();ce.setCenter(re),ce.setZoom(U?+u.zoom:g+Si(x.lat,oe.lat)),ce.setBearing(u.bearing);const ve=new s.P(s.ag(o.centerPoint.x+u.offsetAsPoint.x,0,o.width),s.ag(o.centerPoint.y+u.offsetAsPoint.y,0,o.height));ce.setLocationAtPoint(re,ve);const Le=(u.offset&&u.offsetAsPoint.mag())>0?ce.center:re,ze=U?+u.zoom:g+Si(x.lat,Le.lat),Ne=g+Si(x.lat,0),Ge=ze+Si(Le.lat,0),et=s.bz(x.lng,Le.lng),Xe=s.bz(x.lat,Le.lat),at=s.ae(Ge-Ne);return K=ze!==g,{easeFunc:ht=>{if(s.bd(k,F)||Ni({startEulerAngles:k,endEulerAngles:F,tr:o,k:ht,useSlerp:k.roll!=F.roll}),Z&&o.interpolatePadding(E,u.padding,ht),u.around)s.w("Easing around a point is not supported under globe projection."),o.setLocationAtPoint(u.around,u.aroundPoint);else{const Ye=Ge>Ne?Math.min(2,at):Math.max(.5,at),pt=Math.pow(Ye,1-ht),Pt=Pu(x,et,Xe,ht*pt);o.setCenter(Pt.wrap())}if(K){const Ye=s.C.number(Ne,Ge,ht)+Si(0,o.center.lat);o.setZoom(Ye)}},isZooming:K,elevationCenter:Le}}handleFlyTo(o,u){const g=u.zoom!==void 0,x=o.center,E=o.zoom,k=o.padding,F=!o.isPaddingEqual(u.padding),U=o.getConstrained(s.S.convert(u.center||u.locationAtOffset),E).center,Z=g?+u.zoom:o.zoom+Si(o.center.lat,U.lat),K=o.clone();K.setCenter(U),K.setZoom(Z),K.setBearing(u.bearing);const oe=new s.P(s.ag(o.centerPoint.x+u.offsetAsPoint.x,0,o.width),s.ag(o.centerPoint.y+u.offsetAsPoint.y,0,o.height));K.setLocationAtPoint(U,oe);const re=K.center;No(o,re);const ce=function(Xe,at,ht){const Ye=ji(at),pt=ji(ht),Pt=s.aW(Ye,pt),Mt=Math.acos(Pt),Tt=Kl(Xe);return Mt/(2*Math.PI)*Tt}(o,x,re),ve=E+Si(x.lat,0),Le=Z+Si(re.lat,0),ze=s.ae(Le-ve);let Ne;if(typeof u.minZoom=="number"){const Xe=+u.minZoom+Si(re.lat,0),at=Math.min(Xe,ve,Le)+Si(0,re.lat),ht=o.getConstrained(re,at).zoom+Si(re.lat,0);Ne=s.ae(ht-ve)}const Ge=s.bz(x.lng,re.lng),et=s.bz(x.lat,re.lat);return{easeFunc:(Xe,at,ht,Ye)=>{const pt=Pu(x,Ge,et,ht);F&&o.interpolatePadding(k,u.padding,Xe);const Pt=Xe===1?re:pt;o.setCenter(Pt.wrap());const Mt=ve+s.aj(at);o.setZoom(Xe===1?Z:Mt+Si(0,Pt.lat))},scaleOfZoom:ze,targetCenter:re,scaleOfMinZoom:Ne,pixelPathLength:ce}}static solveVectorScale(o,u,g,x,E){const k=x==="x"?[g[0],g[4],g[8],g[12]]:[g[1],g[5],g[9],g[13]],F=[g[3],g[7],g[11],g[15]],U=o[0]*k[0]+o[1]*k[1]+o[2]*k[2],Z=o[0]*F[0]+o[1]*F[1]+o[2]*F[2],K=u[0]*k[0]+u[1]*k[1]+u[2]*k[2],oe=u[0]*F[0]+u[1]*F[1]+u[2]*F[2];return K+E*Z===U+E*oe||F[3]*(U-K)+k[3]*(oe-Z)+U*oe==K*Z?null:(K+k[3]-E*oe-E*F[3])/(K-U-E*oe+E*Z)}static getLesserNonNegativeNonNull(o,u){return u!==null&&u>=0&&u<o?u:o}}class Tp{constructor(o){this._globe=o,this._mercatorCameraHelper=new Fh,this._verticalPerspectiveCameraHelper=new Uo}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(o,u){return this.currentHelper.handlePanInertia(o,u)}handleMapControlsRollPitchBearingZoom(o,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(o,u)}handleMapControlsPan(o,u,g){this.currentHelper.handleMapControlsPan(o,u,g)}cameraForBoxAndBearing(o,u,g,x,E){return this.currentHelper.cameraForBoxAndBearing(o,u,g,x,E)}handleJumpToCenterZoom(o,u){this.currentHelper.handleJumpToCenterZoom(o,u)}handleEaseTo(o,u){return this.currentHelper.handleEaseTo(o,u)}handleFlyTo(o,u){return this.currentHelper.handleFlyTo(o,u)}}const Nh=(C,o)=>s.y(C,o&&o.filter(u=>u.identifier!=="source.canvas")),Ru=s.bD();class Pp extends s.E{constructor(o,u={}){super(),this._rtlPluginLoaded=()=>{for(const g in this.sourceCaches){const x=this.sourceCaches[g].getSource().type;x!=="vector"&&x!=="geojson"||this.sourceCaches[g].reload()}},this.map=o,this.dispatcher=new Ct(ct(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(g,x)=>this.getGlyphs(g,x)),this.dispatcher.registerMessageHandler("GI",(g,x)=>this.getImages(g,x)),this.imageManager=new J,this.imageManager.setEventedParent(this),this.glyphManager=new we(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new Ze(256,512),this.crossTileSymbolIndex=new Vi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.bE,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",s.bF()),un().on(Nt,this._rtlPluginLoaded),this.on("data",g=>{if(g.dataType!=="source"||g.sourceDataType!=="metadata")return;const x=this.sourceCaches[g.sourceId];if(!x)return;const E=x.getSource();if(E&&E.vectorLayerIds)for(const k in this._layers){const F=this._layers[k];F.source===E.id&&this._validateLayer(F)}})}setGlobalStateProperty(o,u){var g,x,E;this._checkLoaded();const k=u===null?(E=(x=(g=this.stylesheet.state)===null||g===void 0?void 0:g[o])===null||x===void 0?void 0:x.default)!==null&&E!==void 0?E:null:u;if(s.bG(k,this._globalState[o]))return this;this._globalState[o]=k;const F=this._findGlobalStateAffectedSources([o]);for(const U in this.sourceCaches)F.has(U)&&(this._reloadSource(U),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(o){this._checkLoaded();const u=[];for(const x in o)!s.bG(this._globalState[x],o[x].default)&&(u.push(x),this._globalState[x]=o[x].default);const g=this._findGlobalStateAffectedSources(u);for(const x in this.sourceCaches)g.has(x)&&(this._reloadSource(x),this._changed=!0)}_findGlobalStateAffectedSources(o){if(o.length===0)return new Set;const u=new Set;for(const g in this._layers){const x=this._layers[g],E=x.getLayoutAffectingGlobalStateRefs();for(const k of o)E.has(k)&&u.add(x.source)}return u}loadURL(o,u={},g){this.fire(new s.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const x=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const E=this._loadStyleRequest;s.j(x,this._loadStyleRequest).then(k=>{this._loadStyleRequest=null,this._load(k.data,u,g)}).catch(k=>{this._loadStyleRequest=null,k&&!E.signal.aborted&&this.fire(new s.k(k))})}loadJSON(o,u={},g){this.fire(new s.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,S.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(o,u,g)}).catch(()=>{})}loadEmpty(){this.fire(new s.l("dataloading",{dataType:"style"})),this._load(Ru,{validate:!1})}_load(o,u,g){var x,E,k;const F=u.transformStyle?u.transformStyle(g,o):o;if(!u.validate||!Nh(this,s.z(F))){this._loaded=!0,this.stylesheet=F;for(const U in F.sources)this.addSource(U,F.sources[U],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs),this._createLayers(),this.light=new Me(this.stylesheet.light),this._setProjectionInternal(((x=this.stylesheet.projection)===null||x===void 0?void 0:x.type)||"mercator"),this.sky=new Te(this.stylesheet.sky),this.map.setTerrain((E=this.stylesheet.terrain)!==null&&E!==void 0?E:null),this.setGlobalState((k=this.stylesheet.state)!==null&&k!==void 0?k:null),this.fire(new s.l("data",{dataType:"style"})),this.fire(new s.l("style.load"))}}_createLayers(){const o=s.bH(this.stylesheet.layers);this.dispatcher.broadcast("SL",o),this._order=o.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of o){const g=s.bI(u);g.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=g}}_loadSprite(o,u=!1,g=void 0){let x;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(E,k,F,U){return s._(this,void 0,void 0,function*(){const Z=X(E),K=F>1?"@2x":"",oe={},re={};for(const{id:ce,url:ve}of Z){const Le=k.transformRequest(ee(ve,K,".json"),"SpriteJSON");oe[ce]=s.j(Le,U);const ze=k.transformRequest(ee(ve,K,".png"),"SpriteImage");re[ce]=H.getImage(ze,U)}return yield Promise.all([...Object.values(oe),...Object.values(re)]),function(ce,ve){return s._(this,void 0,void 0,function*(){const Le={};for(const ze in ce){Le[ze]={};const Ne=S.getImageCanvasContext((yield ve[ze]).data),Ge=(yield ce[ze]).data;for(const et in Ge){const{width:Xe,height:at,x:ht,y:Ye,sdf:pt,pixelRatio:Pt,stretchX:Mt,stretchY:Tt,content:kt,textFitWidth:Mn,textFitHeight:Sn}=Ge[et];Le[ze][et]={data:null,pixelRatio:Pt,sdf:pt,stretchX:Mt,stretchY:Tt,content:kt,textFitWidth:Mn,textFitHeight:Sn,spriteData:{width:Xe,height:at,x:ht,y:Ye,context:Ne}}}}return Le})}(oe,re)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(E=>{if(this._spriteRequest=null,E)for(const k in E){this._spritesImagesIds[k]=[];const F=this._spritesImagesIds[k]?this._spritesImagesIds[k].filter(U=>!(U in E)):[];for(const U of F)this.imageManager.removeImage(U),this._changedImages[U]=!0;for(const U in E[k]){const Z=k==="default"?U:`${k}:${U}`;this._spritesImagesIds[k].push(Z),Z in this.imageManager.images?this.imageManager.updateImage(Z,E[k][U],!1):this.imageManager.addImage(Z,E[k][U]),u&&(this._changedImages[Z]=!0)}}}).catch(E=>{this._spriteRequest=null,x=E,this.fire(new s.k(x))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"})),g&&g(x)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}_validateLayer(o){const u=this.sourceCaches[o.source];if(!u)return;const g=o.sourceLayer;if(!g)return;const x=u.getSource();(x.type==="geojson"||x.vectorLayerIds&&x.vectorLayerIds.indexOf(g)===-1)&&this.fire(new s.k(new Error(`Source layer "${g}" does not exist on source "${x.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o,u=!1){const g=this._serializedAllLayers();if(!o||o.length===0)return Object.values(u?s.bJ(g):g);const x=[];for(const E of o)if(g[E]){const k=u?s.bJ(g[E]):g[E];x.push(k)}return x}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const u=Object.keys(this._layers);for(const g of u){const x=this._layers[g];x.type!=="custom"&&(o[g]=x.serialize())}return o}hasTransitions(){var o,u,g;if(!((o=this.light)===null||o===void 0)&&o.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((g=this.projection)===null||g===void 0)&&g.hasTransition())return!0;for(const x in this.sourceCaches)if(this.sourceCaches[x].hasTransition())return!0;for(const x in this._layers)if(this._layers[x].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const u=this._changed;if(u){const x=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(x.length||E.length)&&this._updateWorkerLayers(x,E);for(const k in this._updatedSources){const F=this._updatedSources[k];if(F==="reload")this._reloadSource(k);else{if(F!=="clear")throw new Error(`Invalid action ${F}`);this._clearSource(k)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const k in this._updatedPaintProps)this._layers[k].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const g={};for(const x in this.sourceCaches){const E=this.sourceCaches[x];g[x]=E.used,E.used=!1}for(const x of this._order){const E=this._layers[x];E.recalculate(o,this._availableImages),!E.isHidden(o.zoom)&&E.source&&(this.sourceCaches[E.source].used=!0)}for(const x in g){const E=this.sourceCaches[x];!!g[x]!=!!E.used&&E.fire(new s.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:x}))}this.light.recalculate(o),this.sky.recalculate(o),this.projection.recalculate(o),this.z=o.zoom,u&&this.fire(new s.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,u={}){var g;this._checkLoaded();const x=this.serialize();if(o=u.transformStyle?u.transformStyle(x,o):o,((g=u.validate)===null||g===void 0||g)&&Nh(this,s.z(o)))return!1;(o=s.bJ(o)).layers=s.bH(o.layers);const E=s.bK(x,o),k=this._getOperationsToPerform(E);if(k.unimplemented.length>0)throw new Error(`Unimplemented: ${k.unimplemented.join(", ")}.`);if(k.operations.length===0)return!1;for(const F of k.operations)F();return this.stylesheet=o,this._serializedLayers=null,!0}_getOperationsToPerform(o){const u=[],g=[];for(const x of o)switch(x.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,x.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,x.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,x.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,x.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,x.args));break;case"addSource":u.push(()=>this.addSource.apply(this,x.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,x.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,x.args));break;case"setLight":u.push(()=>this.setLight.apply(this,x.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,x.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,x.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,x.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,x.args));break;case"setSky":u.push(()=>this.setSky.apply(this,x.args));break;case"setProjection":this.setProjection.apply(this,x.args);break;case"setGlobalState":u.push(()=>this.setGlobalState.apply(this,x.args));break;case"setTransition":u.push(()=>{});break;default:g.push(x.command)}return{operations:u,unimplemented:g}}addImage(o,u){if(this.getImage(o))return this.fire(new s.k(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,u),this._afterImageUpdated(o)}updateImage(o,u){this.imageManager.updateImage(o,u)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new s.k(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,u,g={}){if(this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error(`Source "${o}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.z.source,`sources.${o}`,u,null,g))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const x=this.sourceCaches[o]=new dt(o,u,this.dispatcher);x.style=this,x.setEventedParent(this,()=>({isSourceLoaded:x.loaded(),source:x.serialize(),sourceId:o})),x.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===o)return this.fire(new s.k(new Error(`Source "${o}" cannot be removed while layer "${g}" is using it.`)));const u=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],u.fire(new s.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,u){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error(`There is no source with this ID=${o}`);const g=this.sourceCaches[o].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(u),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,u,g={}){this._checkLoaded();const x=o.id;if(this.getLayer(x))return void this.fire(new s.k(new Error(`Layer "${x}" already exists on this map.`)));let E;if(o.type==="custom"){if(Nh(this,s.bL(o)))return;E=s.bI(o)}else{if("source"in o&&typeof o.source=="object"&&(this.addSource(x,o.source),o=s.bJ(o),o=s.e(o,{source:x})),this._validate(s.z.layer,`layers.${x}`,o,{arrayIndex:-1},g))return;E=s.bI(o),this._validateLayer(E),E.setEventedParent(this,{layer:{id:x}})}const k=u?this._order.indexOf(u):this._order.length;if(u&&k===-1)this.fire(new s.k(new Error(`Cannot add layer "${x}" before non-existing layer "${u}".`)));else{if(this._order.splice(k,0,x),this._layerOrderChanged=!0,this._layers[x]=E,this._removedLayers[x]&&E.source&&E.type!=="custom"){const F=this._removedLayers[x];delete this._removedLayers[x],F.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",this.sourceCaches[E.source].pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map)}}moveLayer(o,u){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new s.k(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===u)return;const g=this._order.indexOf(o);this._order.splice(g,1);const x=u?this._order.indexOf(u):this._order.length;u&&x===-1?this.fire(new s.k(new Error(`Cannot move layer "${o}" before non-existing layer "${u}".`))):(this._order.splice(x,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const u=this._layers[o];if(!u)return void this.fire(new s.k(new Error(`Cannot remove non-existing layer "${o}".`)));u.setEventedParent(null);const g=this._order.indexOf(o);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,u,g){this._checkLoaded();const x=this.getLayer(o);x?x.minzoom===u&&x.maxzoom===g||(u!=null&&(x.minzoom=u),g!=null&&(x.maxzoom=g),this._updateLayer(x)):this.fire(new s.k(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,u,g={}){this._checkLoaded();const x=this.getLayer(o);if(x){if(!s.bG(x.filter,u))return u==null?(x.setFilter(void 0),void this._updateLayer(x)):void(this._validate(s.z.filter,`layers.${x.id}.filter`,u,null,g)||(x.setFilter(s.bJ(u)),this._updateLayer(x)))}else this.fire(new s.k(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return s.bJ(this.getLayer(o).filter)}setLayoutProperty(o,u,g,x={}){this._checkLoaded();const E=this.getLayer(o);E?s.bG(E.getLayoutProperty(u),g)||(E.setLayoutProperty(u,g,x),this._updateLayer(E)):this.fire(new s.k(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,u){const g=this.getLayer(o);if(g)return g.getLayoutProperty(u);this.fire(new s.k(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,u,g,x={}){this._checkLoaded();const E=this.getLayer(o);E?s.bG(E.getPaintProperty(u),g)||(E.setPaintProperty(u,g,x)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[o]=!0,this._serializedLayers=null):this.fire(new s.k(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,u){return this.getLayer(o).getPaintProperty(u)}setFeatureState(o,u){this._checkLoaded();const g=o.source,x=o.sourceLayer,E=this.sourceCaches[g];if(E===void 0)return void this.fire(new s.k(new Error(`The source '${g}' does not exist in the map's style.`)));const k=E.getSource().type;k==="geojson"&&x?this.fire(new s.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):k!=="vector"||x?(o.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),E.setFeatureState(x,o.id,u)):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,u){this._checkLoaded();const g=o.source,x=this.sourceCaches[g];if(x===void 0)return void this.fire(new s.k(new Error(`The source '${g}' does not exist in the map's style.`)));const E=x.getSource().type,k=E==="vector"?o.sourceLayer:void 0;E!=="vector"||k?u&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new s.k(new Error("A feature id is required to remove its specific state property."))):x.removeFeatureState(k,o.id,u):this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const u=o.source,g=o.sourceLayer,x=this.sourceCaches[u];if(x!==void 0)return x.getSource().type!=="vector"||g?(o.id===void 0&&this.fire(new s.k(new Error("The feature id parameter must be provided."))),x.getFeatureState(g,o.id)):void this.fire(new s.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=s.bM(this.sourceCaches,E=>E.serialize()),u=this._serializeByIds(this._order,!0),g=this.map.getTerrain()||void 0,x=this.stylesheet;return s.bN({version:x.version,name:x.name,metadata:x.metadata,light:x.light,sky:x.sky,center:x.center,zoom:x.zoom,bearing:x.bearing,pitch:x.pitch,sprite:x.sprite,glyphs:x.glyphs,transition:x.transition,projection:x.projection,sources:o,layers:u,terrain:g},E=>E!==void 0)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const u=k=>this._layers[k].type==="fill-extrusion",g={},x=[];for(let k=this._order.length-1;k>=0;k--){const F=this._order[k];if(u(F)){g[F]=k;for(const U of o){const Z=U[F];if(Z)for(const K of Z)x.push(K)}}}x.sort((k,F)=>F.intersectionZ-k.intersectionZ);const E=[];for(let k=this._order.length-1;k>=0;k--){const F=this._order[k];if(u(F))for(let U=x.length-1;U>=0;U--){const Z=x[U].feature;if(g[Z.layer.id]<k)break;E.push(Z),x.pop()}else for(const U of o){const Z=U[F];if(Z)for(const K of Z)E.push(K.feature)}}return E}queryRenderedFeatures(o,u,g){u&&u.filter&&this._validate(s.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const x={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new s.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const Z of u.layers){const K=this._layers[Z];if(!K)return this.fire(new s.k(new Error(`The layer '${Z}' does not exist in the map's style and cannot be queried for features.`))),[];x[K.source]=!0}}const E=[];u.availableImages=this._availableImages;const k=this._serializedAllLayers(),F=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,U=Object.assign(Object.assign({},u),{layers:F});for(const Z in this.sourceCaches)u.layers&&!x[Z]||E.push(_t(this.sourceCaches[Z],this._layers,k,o,U,g,this.map.terrain?(K,oe,re)=>this.map.terrain.getElevation(K,oe,re):void 0));return this.placement&&E.push(function(Z,K,oe,re,ce,ve,Le){const ze={},Ne=ve.queryRenderedSymbols(re),Ge=[];for(const et of Object.keys(Ne).map(Number))Ge.push(Le[et]);Ge.sort(wt);for(const et of Ge){const Xe=et.featureIndex.lookupSymbolFeatures(Ne[et.bucketInstanceId],K,et.bucketIndex,et.sourceLayerIndex,ce.filter,ce.layers,ce.availableImages,Z);for(const at in Xe){const ht=ze[at]=ze[at]||[],Ye=Xe[at];Ye.sort((pt,Pt)=>{const Mt=et.featureSortOrder;if(Mt){const Tt=Mt.indexOf(pt.featureIndex);return Mt.indexOf(Pt.featureIndex)-Tt}return Pt.featureIndex-pt.featureIndex});for(const pt of Ye)ht.push(pt)}}return function(et,Xe,at){for(const ht in et)for(const Ye of et[ht])cn(Ye,at[Xe[ht].source]);return et}(ze,Z,oe)}(this._layers,k,this.sourceCaches,o,U,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(o,u){u&&u.filter&&this._validate(s.z.filter,"querySourceFeatures.filter",u.filter,null,u);const g=this.sourceCaches[o];return g?function(x,E){const k=x.getRenderableIds().map(Z=>x.getTileByID(Z)),F=[],U={};for(let Z=0;Z<k.length;Z++){const K=k[Z],oe=K.tileID.canonical.key;U[oe]||(U[oe]=!0,K.querySourceFeatures(F,E))}return F}(g,u):[]}getLight(){return this.light.getLight()}setLight(o,u={}){this._checkLoaded();const g=this.light.getLight();let x=!1;for(const k in o)if(!s.bG(o[k],g[k])){x=!0;break}if(!x)return;const E={now:S.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(E)}getProjection(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.projection}setProjection(o){if(this._checkLoaded(),this.projection){if(this.projection.name===o.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=o,this._setProjectionInternal(o.type)}getSky(){var o;return(o=this.stylesheet)===null||o===void 0?void 0:o.sky}setSky(o,u={}){this._checkLoaded();const g=this.getSky();let x=!1;if(!o&&!g)return;if(o&&!g)x=!0;else if(!o&&g)x=!0;else for(const k in o)if(!s.bG(o[k],g[k])){x=!0;break}if(!x)return;const E={now:S.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,u),this.sky.updateTransitions(E)}_setProjectionInternal(o){const u=function(g){if(Array.isArray(g)){const x=new Fc({type:g});return{projection:x,transform:new Ls,cameraHelper:new Tp(x)}}switch(g){case"mercator":return{projection:new Oh,transform:new Zi,cameraHelper:new Fh};case"globe":{const x=new Fc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:x,transform:new Ls,cameraHelper:new Tp(x)}}case"vertical-perspective":return{projection:new Cp,transform:new Iu,cameraHelper:new Uo};default:return s.w(`Unknown projection name: ${g}. Falling back to mercator projection.`),{projection:new Oh,transform:new Zi,cameraHelper:new Fh}}}(o);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const g in this.sourceCaches)this.sourceCaches[g].reload()}_validate(o,u,g,x,E={}){return(!E||E.validate!==!1)&&Nh(this,o.call(s.z,s.e({key:u,style:this.serialize(),value:g,styleSpec:s.v},x)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),un().off(Nt,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const g=this.sourceCaches[u];g.setEventedParent(null),g.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const u in this.sourceCaches)this.sourceCaches[u].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,u,g,x,E=!1){let k=!1,F=!1;const U={};for(const Z of this._order){const K=this._layers[Z];if(K.type!=="symbol")continue;if(!U[K.source]){const re=this.sourceCaches[K.source];U[K.source]=re.getRenderableIds(!0).map(ce=>re.getTileByID(ce)).sort((ce,ve)=>ve.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(ve.tileID)?-1:1))}const oe=this.crossTileSymbolIndex.addLayer(K,U[K.source],o.center.lng);k=k||oe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((E=E||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(S.now(),o.zoom))&&(this.pauseablePlacement=new Ra(o,this.map.terrain,this._order,E,u,g,x,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,U),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(S.now()),F=!0),k&&this.pauseablePlacement.placement.setStale()),F||k)for(const Z of this._order){const K=this._layers[Z];K.type==="symbol"&&this.placement.updateLayerOpacities(K,U[K.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(S.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,u){return s._(this,void 0,void 0,function*(){const g=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const x=this.sourceCaches[u.source];return x&&x.setDependencies(u.tileID.key,u.type,u.icons),g})}getGlyphs(o,u){return s._(this,void 0,void 0,function*(){const g=yield this.glyphManager.getGlyphs(u.stacks),x=this.sourceCaches[u.source];return x&&x.setDependencies(u.tileID.key,u.type,[""]),g})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,u={}){this._checkLoaded(),o&&this._validate(s.z.glyphs,"glyphs",o,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,u,g={},x){this._checkLoaded();const E=[{id:o,url:u}],k=[...X(this.stylesheet.sprite),...E];this._validate(s.z.sprite,"sprite",k,null,g)||(this.stylesheet.sprite=k,this._loadSprite(E,!0,x))}removeSprite(o){this._checkLoaded();const u=X(this.stylesheet.sprite);if(u.find(g=>g.id===o)){if(this._spritesImagesIds[o])for(const g of this._spritesImagesIds[o])this.imageManager.removeImage(g),this._changedImages[g]=!0;u.splice(u.findIndex(g=>g.id===o),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.l("data",{dataType:"style"}))}else this.fire(new s.k(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return X(this.stylesheet.sprite)}setSprite(o,u={},g){this._checkLoaded(),o&&this._validate(s.z.sprite,"sprite",o,null,u)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,g):(this._unloadSprite(),g&&g(null)))}}var wy=s.aI([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ig{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,u,g,x,E,k,F,U,Z){this.context=o;let K=this.boundPaintVertexBuffers.length!==x.length;for(let oe=0;!K&&oe<x.length;oe++)this.boundPaintVertexBuffers[oe]!==x[oe]&&(K=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==g||K||this.boundIndexBuffer!==E||this.boundVertexOffset!==k||this.boundDynamicVertexBuffer!==F||this.boundDynamicVertexBuffer2!==U||this.boundDynamicVertexBuffer3!==Z?this.freshBind(u,g,x,E,k,F,U,Z):(o.bindVertexArray.set(this.vao),F&&F.bind(),E&&E.dynamicDraw&&E.bind(),U&&U.bind(),Z&&Z.bind())}freshBind(o,u,g,x,E,k,F,U){const Z=o.numAttributes,K=this.context,oe=K.gl;this.vao&&this.destroy(),this.vao=K.createVertexArray(),K.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=x,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=k,this.boundDynamicVertexBuffer2=F,this.boundDynamicVertexBuffer3=U,u.enableAttributes(oe,o);for(const re of g)re.enableAttributes(oe,o);k&&k.enableAttributes(oe,o),F&&F.enableAttributes(oe,o),U&&U.enableAttributes(oe,o),u.bind(),u.setVertexAttribPointers(oe,o,E);for(const re of g)re.bind(),re.setVertexAttribPointers(oe,o,E);k&&(k.bind(),k.setVertexAttribPointers(oe,o,E)),x&&x.bind(),F&&(F.bind(),F.setVertexAttribPointers(oe,o,E)),U&&(U.bind(),U.setVertexAttribPointers(oe,o,E)),K.currentNumAttributes=Z}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Sy=(C,o,u,g,x)=>({u_texture:0,u_ele_delta:C,u_fog_matrix:o,u_fog_color:u?u.properties.get("fog-color"):s.be.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:x?0:u?u.calculateFogBlendOpacity(g):0,u_horizon_color:u?u.properties.get("horizon-color"):s.be.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:x?1:0}),My={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function rf(C){const o=[];for(let u=0;u<C.length;u++){if(C[u]===null)continue;const g=C[u].split(" ");o.push(g.pop())}return o}class of{constructor(o,u,g,x,E,k,F,U,Z=[]){const K=o.gl;this.program=K.createProgram();const oe=rf(u.staticAttributes),re=g?g.getBinderAttributes():[],ce=oe.concat(re),ve=io.prelude.staticUniforms?rf(io.prelude.staticUniforms):[],Le=F.staticUniforms?rf(F.staticUniforms):[],ze=u.staticUniforms?rf(u.staticUniforms):[],Ne=g?g.getBinderUniforms():[],Ge=ve.concat(Le).concat(ze).concat(Ne),et=[];for(const Mt of Ge)et.indexOf(Mt)<0&&et.push(Mt);const Xe=g?g.defines():[];ts(K)&&Xe.unshift("#version 300 es"),E&&Xe.push("#define OVERDRAW_INSPECTOR;"),k&&Xe.push("#define TERRAIN3D;"),U&&Xe.push(U),Z&&Xe.push(...Z);let at=Xe.concat(io.prelude.fragmentSource,F.fragmentSource,u.fragmentSource).join(`
`),ht=Xe.concat(io.prelude.vertexSource,F.vertexSource,u.vertexSource).join(`
`);ts(K)||(at=function(Mt){return Mt.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(at),ht=function(Mt){return Mt.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(ht));const Ye=K.createShader(K.FRAGMENT_SHADER);if(K.isContextLost())return void(this.failedToCreate=!0);if(K.shaderSource(Ye,at),K.compileShader(Ye),!K.getShaderParameter(Ye,K.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${K.getShaderInfoLog(Ye)}`);K.attachShader(this.program,Ye);const pt=K.createShader(K.VERTEX_SHADER);if(K.isContextLost())return void(this.failedToCreate=!0);if(K.shaderSource(pt,ht),K.compileShader(pt),!K.getShaderParameter(pt,K.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${K.getShaderInfoLog(pt)}`);K.attachShader(this.program,pt),this.attributes={};const Pt={};this.numAttributes=ce.length;for(let Mt=0;Mt<this.numAttributes;Mt++)ce[Mt]&&(K.bindAttribLocation(this.program,Mt,ce[Mt]),this.attributes[ce[Mt]]=Mt);if(K.linkProgram(this.program),!K.getProgramParameter(this.program,K.LINK_STATUS))throw new Error(`Program failed to link: ${K.getProgramInfoLog(this.program)}`);K.deleteShader(pt),K.deleteShader(Ye);for(let Mt=0;Mt<et.length;Mt++){const Tt=et[Mt];if(Tt&&!Pt[Tt]){const kt=K.getUniformLocation(this.program,Tt);kt&&(Pt[Tt]=kt)}}this.fixedUniforms=x(o,Pt),this.terrainUniforms=((Mt,Tt)=>({u_depth:new s.bO(Mt,Tt.u_depth),u_terrain:new s.bO(Mt,Tt.u_terrain),u_terrain_dim:new s.bf(Mt,Tt.u_terrain_dim),u_terrain_matrix:new s.bQ(Mt,Tt.u_terrain_matrix),u_terrain_unpack:new s.bR(Mt,Tt.u_terrain_unpack),u_terrain_exaggeration:new s.bf(Mt,Tt.u_terrain_exaggeration)}))(o,Pt),this.projectionUniforms=((Mt,Tt)=>({u_projection_matrix:new s.bQ(Mt,Tt.u_projection_matrix),u_projection_tile_mercator_coords:new s.bR(Mt,Tt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new s.bR(Mt,Tt.u_projection_clipping_plane),u_projection_transition:new s.bf(Mt,Tt.u_projection_transition),u_projection_fallback_matrix:new s.bQ(Mt,Tt.u_projection_fallback_matrix)}))(o,Pt),this.binderUniforms=g?g.getUniforms(o,Pt):[]}draw(o,u,g,x,E,k,F,U,Z,K,oe,re,ce,ve,Le,ze,Ne,Ge,et){const Xe=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(g),o.setStencilMode(x),o.setColorMode(E),o.setCullFace(k),U){o.activeTexture.set(Xe.TEXTURE2),Xe.bindTexture(Xe.TEXTURE_2D,U.depthTexture),o.activeTexture.set(Xe.TEXTURE3),Xe.bindTexture(Xe.TEXTURE_2D,U.texture);for(const ht in this.terrainUniforms)this.terrainUniforms[ht].set(U[ht])}if(Z)for(const ht in Z)this.projectionUniforms[My[ht]].set(Z[ht]);if(F)for(const ht in this.fixedUniforms)this.fixedUniforms[ht].set(F[ht]);ze&&ze.setUniforms(o,this.binderUniforms,ve,{zoom:Le});let at=0;switch(u){case Xe.LINES:at=2;break;case Xe.TRIANGLES:at=3;break;case Xe.LINE_STRIP:at=1}for(const ht of ce.get()){const Ye=ht.vaos||(ht.vaos={});(Ye[K]||(Ye[K]=new ig)).bind(o,this,oe,ze?ze.getPaintVertexBuffers():[],re,ht.vertexOffset,Ne,Ge,et),Xe.drawElements(u,ht.primitiveLength*at,Xe.UNSIGNED_SHORT,ht.primitiveOffset*at*2)}}}function Lu(C,o,u){const g=1/s.aB(u,1,o.transform.tileZoom),x=Math.pow(2,u.tileID.overscaledZ),E=u.tileSize*Math.pow(2,o.transform.tileZoom)/x,k=E*(u.tileID.canonical.x+u.tileID.wrap*x),F=E*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[g,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[k>>16,F>>16],u_pixel_coord_lower:[65535&k,65535&F]}}const Bh=(C,o,u,g)=>{const x=C.style.light,E=x.properties.get("position"),k=[E.x,E.y,E.z],F=s.bU();x.properties.get("anchor")==="viewport"&&s.bV(F,C.transform.bearingInRadians),s.bW(k,k,F);const U=C.transform.transformLightDirection(k),Z=x.properties.get("color");return{u_lightpos:k,u_lightpos_globe:U,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+o,u_opacity:u,u_fill_translate:g}},Ap=(C,o,u,g,x,E,k)=>s.e(Bh(C,o,u,g),Lu(E,C,k),{u_height_factor:-Math.pow(2,x.overscaledZ)/k.tileSize/8}),sf=(C,o,u,g)=>s.e(Lu(o,C,u),{u_fill_translate:g}),fa=(C,o)=>({u_world:C,u_fill_translate:o}),Cy=(C,o,u,g,x)=>s.e(sf(C,o,u,x),{u_world:g}),Ip=(C,o,u,g,x)=>{const E=C.transform;let k,F,U=0;if(u.paint.get("circle-pitch-alignment")==="map"){const Z=s.aB(o,1,E.zoom);k=!0,F=[Z,Z],U=Z/(s.$*Math.pow(2,o.tileID.overscaledZ))*2*Math.PI*x}else k=!1,F=E.pixelsToGLUnits;return{u_camera_to_center_distance:E.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+k,u_device_pixel_ratio:C.pixelRatio,u_extrude_scale:F,u_globe_extrude_scale:U,u_translate:g}},Uh=C=>({u_pixel_extrude_scale:[1/C.width,1/C.height]}),$h=C=>({u_viewport_size:[C.width,C.height]}),og=(C,o=1)=>({u_color:C,u_overlay:0,u_overlay_scale:o}),Vh=(C,o,u,g)=>{const x=s.aB(C,1,o)/(s.$*Math.pow(2,C.tileID.overscaledZ))*2*Math.PI*g;return{u_extrude_scale:s.aB(C,1,o),u_intensity:u,u_globe_extrude_scale:x}},sg=(C,o,u,g)=>{const x=s.L();s.bX(x,0,C.width,C.height,0,0,1);const E=C.context.gl;return{u_matrix:x,u_world:[E.drawingBufferWidth,E.drawingBufferHeight],u_image:u,u_color_ramp:g,u_opacity:o.paint.get("heatmap-opacity")}},Jl=(C,o,u)=>{const g=u.paint.get("hillshade-accent-color");let x;switch(u.paint.get("hillshade-method")){case"basic":x=4;break;case"combined":x=1;break;case"igor":x=2;break;case"multidirectional":x=3;break;default:x=0}const E=u.getIlluminationProperties();for(let k=0;k<E.directionRadians.length;k++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(E.directionRadians[k]+=C.transform.bearingInRadians);return{u_image:0,u_latrange:ag(0,o.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:E.altitudeRadians,u_azimuths:E.directionRadians,u_accent:g,u_method:x,u_highlights:E.highlightColor,u_shadows:E.shadowColor}},jh=(C,o)=>{const u=o.stride,g=s.L();return s.bX(g,0,s.$,-s.$,0,0,1),s.M(g,g,[0,-s.$,0]),{u_matrix:g,u_image:1,u_dimension:[u,u],u_zoom:C.overscaledZ,u_unpack:o.getUnpackVector()}};function ag(C,o){const u=Math.pow(2,o.canonical.z),g=o.canonical.y;return[new s.a0(0,g/u).toLngLat().lat,new s.a0(0,(g+1)/u).toLngLat().lat]}const lg=(C,o,u=0)=>({u_image:0,u_unpack:o.getUnpackVector(),u_dimension:[o.stride,o.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:C.paint.get("color-relief-opacity")}),Hh=(C,o,u,g)=>{const x=C.transform;return{u_translation:kp(C,o,u),u_ratio:g/s.aB(o,1,x.zoom),u_device_pixel_ratio:C.pixelRatio,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},af=(C,o,u,g,x)=>s.e(Hh(C,o,u,g),{u_image:0,u_image_height:x}),Rp=(C,o,u,g,x)=>{const E=C.transform,k=Ql(o,E);return{u_translation:kp(C,o,u),u_texsize:o.imageAtlasTexture.size,u_ratio:g/s.aB(o,1,E.zoom),u_device_pixel_ratio:C.pixelRatio,u_image:0,u_scale:[k,x.fromScale,x.toScale],u_fade:x.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Lp=(C,o,u,g,x,E)=>{const k=C.lineAtlas,F=Ql(o,C.transform),U=u.layout.get("line-cap")==="round",Z=k.getDash(x.from,U),K=k.getDash(x.to,U),oe=Z.width*E.fromScale,re=K.width*E.toScale;return s.e(Hh(C,o,u,g),{u_patternscale_a:[F/oe,-Z.height/2],u_patternscale_b:[F/re,-K.height/2],u_sdfgamma:k.width/(256*Math.min(oe,re)*C.pixelRatio)/2,u_image:0,u_tex_y_a:Z.y,u_tex_y_b:K.y,u_mix:E.t})};function Ql(C,o){return 1/s.aB(C,1,o.tileZoom)}function kp(C,o,u){return s.aC(C.transform,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Bc=(C,o,u,g,x)=>{return{u_tl_parent:C,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*g.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:g.paint.get("raster-brightness-min"),u_brightness_high:g.paint.get("raster-brightness-max"),u_saturation_factor:(k=g.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(E=g.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:cg(g.paint.get("raster-hue-rotate")),u_coords_top:[x[0].x,x[0].y,x[1].x,x[1].y],u_coords_bottom:[x[3].x,x[3].y,x[2].x,x[2].y]};var E,k};function cg(C){C*=Math.PI/180;const o=Math.sin(C),u=Math.cos(C);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const lf=(C,o,u,g,x,E,k,F,U,Z,K,oe,re)=>{const ce=k.transform;return{u_is_size_zoom_constant:+(C==="constant"||C==="source"),u_is_size_feature_constant:+(C==="constant"||C==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_pitch:ce.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:ce.width/ce.height,u_fade_change:k.options.fadeDuration?k.symbolFadeChange:1,u_label_plane_matrix:F,u_coord_matrix:U,u_is_text:+K,u_pitch_with_map:+g,u_is_along_line:x,u_is_variable_anchor:E,u_texsize:oe,u_texture:0,u_translation:Z,u_pitched_scale:re}},Uc=(C,o,u,g,x,E,k,F,U,Z,K,oe,re,ce)=>{const ve=k.transform;return s.e(lf(C,o,u,g,x,E,k,F,U,Z,K,oe,ce),{u_gamma_scale:g?Math.cos(ve.pitch*Math.PI/180)*ve.cameraToCenterDistance:1,u_device_pixel_ratio:k.pixelRatio,u_is_halo:1})},Gh=(C,o,u,g,x,E,k,F,U,Z,K,oe,re)=>s.e(Uc(C,o,u,g,x,E,k,F,U,Z,!0,K,0,re),{u_texsize_icon:oe,u_texture_icon:1}),ec=(C,o)=>({u_opacity:C,u_color:o}),Ey=(C,o,u,g,x)=>s.e(function(E,k,F,U){const Z=F.imageManager.getPattern(E.from.toString()),K=F.imageManager.getPattern(E.to.toString()),{width:oe,height:re}=F.imageManager.getPixelSize(),ce=Math.pow(2,U.tileID.overscaledZ),ve=U.tileSize*Math.pow(2,F.transform.tileZoom)/ce,Le=ve*(U.tileID.canonical.x+U.tileID.wrap*ce),ze=ve*U.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Z.tl,u_pattern_br_a:Z.br,u_pattern_tl_b:K.tl,u_pattern_br_b:K.br,u_texsize:[oe,re],u_mix:k.t,u_pattern_size_a:Z.displaySize,u_pattern_size_b:K.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/s.aB(U,1,F.transform.tileZoom),u_pixel_coord_upper:[Le>>16,ze>>16],u_pixel_coord_lower:[65535&Le,65535&ze]}}(u,x,o,g),{u_opacity:C}),Wh=(C,o)=>{},ug={fillExtrusion:(C,o)=>({u_lightpos:new s.bS(C,o.u_lightpos),u_lightpos_globe:new s.bS(C,o.u_lightpos_globe),u_lightintensity:new s.bf(C,o.u_lightintensity),u_lightcolor:new s.bS(C,o.u_lightcolor),u_vertical_gradient:new s.bf(C,o.u_vertical_gradient),u_opacity:new s.bf(C,o.u_opacity),u_fill_translate:new s.bT(C,o.u_fill_translate)}),fillExtrusionPattern:(C,o)=>({u_lightpos:new s.bS(C,o.u_lightpos),u_lightpos_globe:new s.bS(C,o.u_lightpos_globe),u_lightintensity:new s.bf(C,o.u_lightintensity),u_lightcolor:new s.bS(C,o.u_lightcolor),u_vertical_gradient:new s.bf(C,o.u_vertical_gradient),u_height_factor:new s.bf(C,o.u_height_factor),u_opacity:new s.bf(C,o.u_opacity),u_fill_translate:new s.bT(C,o.u_fill_translate),u_image:new s.bO(C,o.u_image),u_texsize:new s.bT(C,o.u_texsize),u_pixel_coord_upper:new s.bT(C,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(C,o.u_pixel_coord_lower),u_scale:new s.bS(C,o.u_scale),u_fade:new s.bf(C,o.u_fade)}),fill:(C,o)=>({u_fill_translate:new s.bT(C,o.u_fill_translate)}),fillPattern:(C,o)=>({u_image:new s.bO(C,o.u_image),u_texsize:new s.bT(C,o.u_texsize),u_pixel_coord_upper:new s.bT(C,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(C,o.u_pixel_coord_lower),u_scale:new s.bS(C,o.u_scale),u_fade:new s.bf(C,o.u_fade),u_fill_translate:new s.bT(C,o.u_fill_translate)}),fillOutline:(C,o)=>({u_world:new s.bT(C,o.u_world),u_fill_translate:new s.bT(C,o.u_fill_translate)}),fillOutlinePattern:(C,o)=>({u_world:new s.bT(C,o.u_world),u_image:new s.bO(C,o.u_image),u_texsize:new s.bT(C,o.u_texsize),u_pixel_coord_upper:new s.bT(C,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(C,o.u_pixel_coord_lower),u_scale:new s.bS(C,o.u_scale),u_fade:new s.bf(C,o.u_fade),u_fill_translate:new s.bT(C,o.u_fill_translate)}),circle:(C,o)=>({u_camera_to_center_distance:new s.bf(C,o.u_camera_to_center_distance),u_scale_with_map:new s.bO(C,o.u_scale_with_map),u_pitch_with_map:new s.bO(C,o.u_pitch_with_map),u_extrude_scale:new s.bT(C,o.u_extrude_scale),u_device_pixel_ratio:new s.bf(C,o.u_device_pixel_ratio),u_globe_extrude_scale:new s.bf(C,o.u_globe_extrude_scale),u_translate:new s.bT(C,o.u_translate)}),collisionBox:(C,o)=>({u_pixel_extrude_scale:new s.bT(C,o.u_pixel_extrude_scale)}),collisionCircle:(C,o)=>({u_viewport_size:new s.bT(C,o.u_viewport_size)}),debug:(C,o)=>({u_color:new s.bP(C,o.u_color),u_overlay:new s.bO(C,o.u_overlay),u_overlay_scale:new s.bf(C,o.u_overlay_scale)}),depth:Wh,clippingMask:Wh,heatmap:(C,o)=>({u_extrude_scale:new s.bf(C,o.u_extrude_scale),u_intensity:new s.bf(C,o.u_intensity),u_globe_extrude_scale:new s.bf(C,o.u_globe_extrude_scale)}),heatmapTexture:(C,o)=>({u_matrix:new s.bQ(C,o.u_matrix),u_world:new s.bT(C,o.u_world),u_image:new s.bO(C,o.u_image),u_color_ramp:new s.bO(C,o.u_color_ramp),u_opacity:new s.bf(C,o.u_opacity)}),hillshade:(C,o)=>({u_image:new s.bO(C,o.u_image),u_latrange:new s.bT(C,o.u_latrange),u_exaggeration:new s.bf(C,o.u_exaggeration),u_altitudes:new s.bZ(C,o.u_altitudes),u_azimuths:new s.bZ(C,o.u_azimuths),u_accent:new s.bP(C,o.u_accent),u_method:new s.bO(C,o.u_method),u_shadows:new s.bY(C,o.u_shadows),u_highlights:new s.bY(C,o.u_highlights)}),hillshadePrepare:(C,o)=>({u_matrix:new s.bQ(C,o.u_matrix),u_image:new s.bO(C,o.u_image),u_dimension:new s.bT(C,o.u_dimension),u_zoom:new s.bf(C,o.u_zoom),u_unpack:new s.bR(C,o.u_unpack)}),colorRelief:(C,o)=>({u_image:new s.bO(C,o.u_image),u_unpack:new s.bR(C,o.u_unpack),u_dimension:new s.bT(C,o.u_dimension),u_elevation_stops:new s.bO(C,o.u_elevation_stops),u_color_stops:new s.bO(C,o.u_color_stops),u_color_ramp_size:new s.bO(C,o.u_color_ramp_size),u_opacity:new s.bf(C,o.u_opacity)}),line:(C,o)=>({u_translation:new s.bT(C,o.u_translation),u_ratio:new s.bf(C,o.u_ratio),u_device_pixel_ratio:new s.bf(C,o.u_device_pixel_ratio),u_units_to_pixels:new s.bT(C,o.u_units_to_pixels)}),lineGradient:(C,o)=>({u_translation:new s.bT(C,o.u_translation),u_ratio:new s.bf(C,o.u_ratio),u_device_pixel_ratio:new s.bf(C,o.u_device_pixel_ratio),u_units_to_pixels:new s.bT(C,o.u_units_to_pixels),u_image:new s.bO(C,o.u_image),u_image_height:new s.bf(C,o.u_image_height)}),linePattern:(C,o)=>({u_translation:new s.bT(C,o.u_translation),u_texsize:new s.bT(C,o.u_texsize),u_ratio:new s.bf(C,o.u_ratio),u_device_pixel_ratio:new s.bf(C,o.u_device_pixel_ratio),u_image:new s.bO(C,o.u_image),u_units_to_pixels:new s.bT(C,o.u_units_to_pixels),u_scale:new s.bS(C,o.u_scale),u_fade:new s.bf(C,o.u_fade)}),lineSDF:(C,o)=>({u_translation:new s.bT(C,o.u_translation),u_ratio:new s.bf(C,o.u_ratio),u_device_pixel_ratio:new s.bf(C,o.u_device_pixel_ratio),u_units_to_pixels:new s.bT(C,o.u_units_to_pixels),u_patternscale_a:new s.bT(C,o.u_patternscale_a),u_patternscale_b:new s.bT(C,o.u_patternscale_b),u_sdfgamma:new s.bf(C,o.u_sdfgamma),u_image:new s.bO(C,o.u_image),u_tex_y_a:new s.bf(C,o.u_tex_y_a),u_tex_y_b:new s.bf(C,o.u_tex_y_b),u_mix:new s.bf(C,o.u_mix)}),raster:(C,o)=>({u_tl_parent:new s.bT(C,o.u_tl_parent),u_scale_parent:new s.bf(C,o.u_scale_parent),u_buffer_scale:new s.bf(C,o.u_buffer_scale),u_fade_t:new s.bf(C,o.u_fade_t),u_opacity:new s.bf(C,o.u_opacity),u_image0:new s.bO(C,o.u_image0),u_image1:new s.bO(C,o.u_image1),u_brightness_low:new s.bf(C,o.u_brightness_low),u_brightness_high:new s.bf(C,o.u_brightness_high),u_saturation_factor:new s.bf(C,o.u_saturation_factor),u_contrast_factor:new s.bf(C,o.u_contrast_factor),u_spin_weights:new s.bS(C,o.u_spin_weights),u_coords_top:new s.bR(C,o.u_coords_top),u_coords_bottom:new s.bR(C,o.u_coords_bottom)}),symbolIcon:(C,o)=>({u_is_size_zoom_constant:new s.bO(C,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(C,o.u_is_size_feature_constant),u_size_t:new s.bf(C,o.u_size_t),u_size:new s.bf(C,o.u_size),u_camera_to_center_distance:new s.bf(C,o.u_camera_to_center_distance),u_pitch:new s.bf(C,o.u_pitch),u_rotate_symbol:new s.bO(C,o.u_rotate_symbol),u_aspect_ratio:new s.bf(C,o.u_aspect_ratio),u_fade_change:new s.bf(C,o.u_fade_change),u_label_plane_matrix:new s.bQ(C,o.u_label_plane_matrix),u_coord_matrix:new s.bQ(C,o.u_coord_matrix),u_is_text:new s.bO(C,o.u_is_text),u_pitch_with_map:new s.bO(C,o.u_pitch_with_map),u_is_along_line:new s.bO(C,o.u_is_along_line),u_is_variable_anchor:new s.bO(C,o.u_is_variable_anchor),u_texsize:new s.bT(C,o.u_texsize),u_texture:new s.bO(C,o.u_texture),u_translation:new s.bT(C,o.u_translation),u_pitched_scale:new s.bf(C,o.u_pitched_scale)}),symbolSDF:(C,o)=>({u_is_size_zoom_constant:new s.bO(C,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(C,o.u_is_size_feature_constant),u_size_t:new s.bf(C,o.u_size_t),u_size:new s.bf(C,o.u_size),u_camera_to_center_distance:new s.bf(C,o.u_camera_to_center_distance),u_pitch:new s.bf(C,o.u_pitch),u_rotate_symbol:new s.bO(C,o.u_rotate_symbol),u_aspect_ratio:new s.bf(C,o.u_aspect_ratio),u_fade_change:new s.bf(C,o.u_fade_change),u_label_plane_matrix:new s.bQ(C,o.u_label_plane_matrix),u_coord_matrix:new s.bQ(C,o.u_coord_matrix),u_is_text:new s.bO(C,o.u_is_text),u_pitch_with_map:new s.bO(C,o.u_pitch_with_map),u_is_along_line:new s.bO(C,o.u_is_along_line),u_is_variable_anchor:new s.bO(C,o.u_is_variable_anchor),u_texsize:new s.bT(C,o.u_texsize),u_texture:new s.bO(C,o.u_texture),u_gamma_scale:new s.bf(C,o.u_gamma_scale),u_device_pixel_ratio:new s.bf(C,o.u_device_pixel_ratio),u_is_halo:new s.bO(C,o.u_is_halo),u_translation:new s.bT(C,o.u_translation),u_pitched_scale:new s.bf(C,o.u_pitched_scale)}),symbolTextAndIcon:(C,o)=>({u_is_size_zoom_constant:new s.bO(C,o.u_is_size_zoom_constant),u_is_size_feature_constant:new s.bO(C,o.u_is_size_feature_constant),u_size_t:new s.bf(C,o.u_size_t),u_size:new s.bf(C,o.u_size),u_camera_to_center_distance:new s.bf(C,o.u_camera_to_center_distance),u_pitch:new s.bf(C,o.u_pitch),u_rotate_symbol:new s.bO(C,o.u_rotate_symbol),u_aspect_ratio:new s.bf(C,o.u_aspect_ratio),u_fade_change:new s.bf(C,o.u_fade_change),u_label_plane_matrix:new s.bQ(C,o.u_label_plane_matrix),u_coord_matrix:new s.bQ(C,o.u_coord_matrix),u_is_text:new s.bO(C,o.u_is_text),u_pitch_with_map:new s.bO(C,o.u_pitch_with_map),u_is_along_line:new s.bO(C,o.u_is_along_line),u_is_variable_anchor:new s.bO(C,o.u_is_variable_anchor),u_texsize:new s.bT(C,o.u_texsize),u_texsize_icon:new s.bT(C,o.u_texsize_icon),u_texture:new s.bO(C,o.u_texture),u_texture_icon:new s.bO(C,o.u_texture_icon),u_gamma_scale:new s.bf(C,o.u_gamma_scale),u_device_pixel_ratio:new s.bf(C,o.u_device_pixel_ratio),u_is_halo:new s.bO(C,o.u_is_halo),u_translation:new s.bT(C,o.u_translation),u_pitched_scale:new s.bf(C,o.u_pitched_scale)}),background:(C,o)=>({u_opacity:new s.bf(C,o.u_opacity),u_color:new s.bP(C,o.u_color)}),backgroundPattern:(C,o)=>({u_opacity:new s.bf(C,o.u_opacity),u_image:new s.bO(C,o.u_image),u_pattern_tl_a:new s.bT(C,o.u_pattern_tl_a),u_pattern_br_a:new s.bT(C,o.u_pattern_br_a),u_pattern_tl_b:new s.bT(C,o.u_pattern_tl_b),u_pattern_br_b:new s.bT(C,o.u_pattern_br_b),u_texsize:new s.bT(C,o.u_texsize),u_mix:new s.bf(C,o.u_mix),u_pattern_size_a:new s.bT(C,o.u_pattern_size_a),u_pattern_size_b:new s.bT(C,o.u_pattern_size_b),u_scale_a:new s.bf(C,o.u_scale_a),u_scale_b:new s.bf(C,o.u_scale_b),u_pixel_coord_upper:new s.bT(C,o.u_pixel_coord_upper),u_pixel_coord_lower:new s.bT(C,o.u_pixel_coord_lower),u_tile_units_to_pixels:new s.bf(C,o.u_tile_units_to_pixels)}),terrain:(C,o)=>({u_texture:new s.bO(C,o.u_texture),u_ele_delta:new s.bf(C,o.u_ele_delta),u_fog_matrix:new s.bQ(C,o.u_fog_matrix),u_fog_color:new s.bP(C,o.u_fog_color),u_fog_ground_blend:new s.bf(C,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.bf(C,o.u_fog_ground_blend_opacity),u_horizon_color:new s.bP(C,o.u_horizon_color),u_horizon_fog_blend:new s.bf(C,o.u_horizon_fog_blend),u_is_globe_mode:new s.bf(C,o.u_is_globe_mode)}),terrainDepth:(C,o)=>({u_ele_delta:new s.bf(C,o.u_ele_delta)}),terrainCoords:(C,o)=>({u_texture:new s.bO(C,o.u_texture),u_terrain_coords_id:new s.bf(C,o.u_terrain_coords_id),u_ele_delta:new s.bf(C,o.u_ele_delta)}),projectionErrorMeasurement:(C,o)=>({u_input:new s.bf(C,o.u_input),u_output_expected:new s.bf(C,o.u_output_expected)}),atmosphere:(C,o)=>({u_sun_pos:new s.bS(C,o.u_sun_pos),u_atmosphere_blend:new s.bf(C,o.u_atmosphere_blend),u_globe_position:new s.bS(C,o.u_globe_position),u_globe_radius:new s.bf(C,o.u_globe_radius),u_inv_proj_matrix:new s.bQ(C,o.u_inv_proj_matrix)}),sky:(C,o)=>({u_sky_color:new s.bP(C,o.u_sky_color),u_horizon_color:new s.bP(C,o.u_horizon_color),u_horizon:new s.bT(C,o.u_horizon),u_horizon_normal:new s.bT(C,o.u_horizon_normal),u_sky_horizon_blend:new s.bf(C,o.u_sky_horizon_blend),u_sky_blend:new s.bf(C,o.u_sky_blend)})};class Dp{constructor(o,u,g){this.context=o;const x=o.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const cf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class qh{constructor(o,u,g,x){this.length=u.length,this.attributes=g,this.itemSize=u.bytesPerElement,this.dynamicDraw=x,this.context=o;const E=o.gl;this.buffer=E.createBuffer(),o.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let g=0;g<this.attributes.length;g++){const x=u.attributes[this.attributes[g].name];x!==void 0&&o.enableVertexAttribArray(x)}}setVertexAttribPointers(o,u,g){for(let x=0;x<this.attributes.length;x++){const E=this.attributes[x],k=u.attributes[E.name];k!==void 0&&o.vertexAttribPointer(k,E.components,o[cf[E.type]],!1,this.itemSize,E.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class jr{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xh extends jr{getDefault(){return s.be.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Oa extends jr{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class zp extends jr{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Op extends jr{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Fp extends jr{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class hg extends jr{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Np extends jr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Po extends jr{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class $c extends jr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class dg extends jr{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class fg extends jr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class pg extends jr{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class mg extends jr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class uf extends jr{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Ty extends jr{getDefault(){return s.be.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class gg extends jr{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class dl extends jr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class ku extends jr{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class tc extends jr{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Zh extends jr{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class nc extends jr{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class rc extends jr{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class pa extends jr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class vs extends jr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Bp extends jr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Yh extends jr{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class hf extends jr{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ic extends jr{getDefault(){return null}set(o){var u;if(o===this.current&&!this.dirty)return;const g=this.gl;ts(g)?g.bindVertexArray(o):(u=g.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class Kh extends jr{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Jh extends jr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Du extends jr{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Vc extends jr{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class fl extends Vc{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class oc extends Vc{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class sc extends Vc{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}const Up="Framebuffer is not complete";class $p{constructor(o,u,g,x,E){this.context=o,this.width=u,this.height=g;const k=o.gl,F=this.framebuffer=k.createFramebuffer();if(this.colorAttachment=new fl(o,F),x)this.depthAttachment=E?new sc(o,F):new oc(o,F);else if(E)throw new Error("Stencil cannot be set without depth");if(k.checkFramebufferStatus(k.FRAMEBUFFER)!==k.FRAMEBUFFER_COMPLETE)throw new Error(Up)}destroy(){const o=this.context.gl,u=this.colorAttachment.get();if(u&&o.deleteTexture(u),this.depthAttachment){const g=this.depthAttachment.get();g&&o.deleteRenderbuffer(g)}o.deleteFramebuffer(this.framebuffer)}}class Sr{constructor(o){var u,g;if(this.gl=o,this.clearColor=new Xh(this),this.clearDepth=new Oa(this),this.clearStencil=new zp(this),this.colorMask=new Op(this),this.depthMask=new Fp(this),this.stencilMask=new hg(this),this.stencilFunc=new Np(this),this.stencilOp=new Po(this),this.stencilTest=new $c(this),this.depthRange=new dg(this),this.depthTest=new fg(this),this.depthFunc=new pg(this),this.blend=new mg(this),this.blendFunc=new uf(this),this.blendColor=new Ty(this),this.blendEquation=new gg(this),this.cullFace=new dl(this),this.cullFaceSide=new ku(this),this.frontFace=new tc(this),this.program=new Zh(this),this.activeTexture=new nc(this),this.viewport=new rc(this),this.bindFramebuffer=new pa(this),this.bindRenderbuffer=new vs(this),this.bindTexture=new Bp(this),this.bindVertexBuffer=new Yh(this),this.bindElementBuffer=new hf(this),this.bindVertexArray=new ic(this),this.pixelStoreUnpack=new Kh(this),this.pixelStoreUnpackPremultiplyAlpha=new Jh(this),this.pixelStoreUnpackFlipY=new Du(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),ts(o)){this.HALF_FLOAT=o.HALF_FLOAT;const x=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=o.RGBA16F)!==null&&u!==void 0?u:x?.RGBA16F_EXT,this.RGB16F=(g=o.RGB16F)!==null&&g!==void 0?g:x?.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const x=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=x?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u){return new Dp(this,o,u)}createVertexBuffer(o,u,g){return new qh(this,o,u,g)}createRenderbuffer(o,u,g){const x=this.gl,E=x.createRenderbuffer();return this.bindRenderbuffer.set(E),x.renderbufferStorage(x.RENDERBUFFER,o,u,g),this.bindRenderbuffer.set(null),E}createFramebuffer(o,u,g,x){return new $p(this,o,u,g,x)}clear({color:o,depth:u,stencil:g}){const x=this.gl;let E=0;o&&(E|=x.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(E|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),g!==void 0&&(E|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),x.clear(E)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){s.bG(o.blendFunction,Tr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return ts(this.gl)?this.gl.createVertexArray():(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var u;return ts(this.gl)?this.gl.deleteVertexArray(o):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}let jc;function Vp(C,o,u,g,x){const E=C.context,k=C.transform,F=E.gl,U=C.useProgram("collisionBox"),Z=[];let K=0,oe=0;for(let Ne=0;Ne<g.length;Ne++){const Ge=g[Ne],et=o.getTile(Ge).getBucket(u);if(!et)continue;const Xe=x?et.textCollisionBox:et.iconCollisionBox,at=et.collisionCircleArray;at.length>0&&(Z.push({circleArray:at,circleOffset:oe,coord:Ge}),K+=at.length/4,oe=K),Xe&&U.draw(E,F.LINES,vr.disabled,sr.disabled,C.colorModeForRenderPass(),_r.disabled,Uh(C.transform),C.style.map.terrain&&C.style.map.terrain.getTerrainData(Ge),k.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,null,C.transform.zoom,null,null,Xe.collisionVertexBuffer)}if(!x||!Z.length)return;const re=C.useProgram("collisionCircle"),ce=new s.b_;ce.resize(4*K),ce._trim();let ve=0;for(const Ne of Z)for(let Ge=0;Ge<Ne.circleArray.length/4;Ge++){const et=4*Ge,Xe=Ne.circleArray[et+0],at=Ne.circleArray[et+1],ht=Ne.circleArray[et+2],Ye=Ne.circleArray[et+3];ce.emplace(ve++,Xe,at,ht,Ye,0),ce.emplace(ve++,Xe,at,ht,Ye,1),ce.emplace(ve++,Xe,at,ht,Ye,2),ce.emplace(ve++,Xe,at,ht,Ye,3)}(!jc||jc.length<2*K)&&(jc=function(Ne){const Ge=2*Ne,et=new s.c0;et.resize(Ge),et._trim();for(let Xe=0;Xe<Ge;Xe++){const at=6*Xe;et.uint16[at+0]=4*Xe+0,et.uint16[at+1]=4*Xe+1,et.uint16[at+2]=4*Xe+2,et.uint16[at+3]=4*Xe+2,et.uint16[at+4]=4*Xe+3,et.uint16[at+5]=4*Xe+0}return et}(K));const Le=E.createIndexBuffer(jc,!0),ze=E.createVertexBuffer(ce,s.b$.members,!0);for(const Ne of Z){const Ge=$h(C.transform);re.draw(E,F.TRIANGLES,vr.disabled,sr.disabled,C.colorModeForRenderPass(),_r.disabled,Ge,C.style.map.terrain&&C.style.map.terrain.getTerrainData(Ne.coord),null,u.id,ze,Le,s.aL.simpleSegment(0,2*Ne.circleOffset,Ne.circleArray.length,Ne.circleArray.length/2),null,C.transform.zoom,null,null,null)}ze.destroy(),Le.destroy()}const jp=s.af(new Float32Array(16));function oi(C,o,u,g,x,E){const{horizontalAlign:k,verticalAlign:F}=s.aG(C);return new s.P((-(k-.5)*o/x+g[0])*E,(-(F-.5)*u/x+g[1])*E)}function Hp(C,o,u,g,x,E){const k=o.tileAnchorPoint.add(new s.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let F=g.mult(E);u||(F=F.rotate(-x));const U=k.add(F);return mn(U.x,U.y,o.pitchedLabelPlaneMatrix,o.getElevation).point}if(u){const F=nt(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub(C),U=Math.atan(F.y/F.x)+(F.x<0?Math.PI:0);return C.add(g.rotate(U))}return C.add(g)}function df(C,o,u,g,x,E,k,F,U,Z,K,oe){const re=C.text.placedSymbolArray,ce=C.text.dynamicLayoutVertexArray,ve=C.icon.dynamicLayoutVertexArray,Le={};ce.clear();for(let ze=0;ze<re.length;ze++){const Ne=re.get(ze),Ge=Ne.hidden||!Ne.crossTileID||C.allowVerticalPlacement&&!Ne.placedOrientation?null:g[Ne.crossTileID];if(Ge){const et=new s.P(Ne.anchorX,Ne.anchorY),Xe={getElevation:oe,width:x.width,height:x.height,pitchedLabelPlaneMatrix:E,pitchWithMap:u,transform:x,tileAnchorPoint:et,translation:Z,unwrappedTileID:K},at=u?hn(et.x,et.y,Xe):nt(et.x,et.y,Xe),ht=on(x.cameraToCenterDistance,at.signedDistanceFromCamera);let Ye=s.ao(C.textSizeData,F,Ne)*ht/s.aA;u&&(Ye*=C.tilePixelRatio/k);const{width:pt,height:Pt,anchor:Mt,textOffset:Tt,textBoxScale:kt}=Ge,Mn=oi(Mt,pt,Pt,Tt,kt,Ye),Sn=x.getPitchedTextCorrection(et.x+Z[0],et.y+Z[1],K),rn=Hp(at.point,Xe,o,Mn,-x.bearingInRadians,Sn),Vn=C.allowVerticalPlacement&&Ne.placedOrientation===s.an.vertical?Math.PI/2:0;for(let br=0;br<Ne.numGlyphs;br++)s.au(ce,rn,Vn);U&&Ne.associatedIconIndex>=0&&(Le[Ne.associatedIconIndex]={shiftedAnchor:rn,angle:Vn})}else vt(Ne.numGlyphs,ce)}if(U){ve.clear();const ze=C.icon.placedSymbolArray;for(let Ne=0;Ne<ze.length;Ne++){const Ge=ze.get(Ne);if(Ge.hidden)vt(Ge.numGlyphs,ve);else{const et=Le[Ne];if(et)for(let Xe=0;Xe<Ge.numGlyphs;Xe++)s.au(ve,et.shiftedAnchor,et.angle);else vt(Ge.numGlyphs,ve)}}C.icon.dynamicLayoutVertexBuffer.updateData(ve)}C.text.dynamicLayoutVertexBuffer.updateData(ce)}function zu(C,o,u){return u.iconsInText&&o?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function Gp(C,o,u,g,x,E,k,F,U,Z,K,oe,re){const ce=C.context,ve=ce.gl,Le=C.transform,ze=F==="map",Ne=U==="map",Ge=F!=="viewport"&&u.layout.get("symbol-placement")!=="point",et=ze&&!Ne&&!Ge,Xe=!u.layout.get("symbol-sort-key").isConstant();let at=!1;const ht=C.getDepthModeForSublayer(0,vr.ReadOnly),Ye=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),pt=[],Pt=Le.getCircleRadiusCorrection();for(const Mt of g){const Tt=o.getTile(Mt),kt=Tt.getBucket(u);if(!kt)continue;const Mn=x?kt.text:kt.icon;if(!Mn||!Mn.segments.get().length||!Mn.hasVisibleVertices)continue;const Sn=Mn.programConfigurations.get(u.id),rn=x||kt.sdfIcons,Vn=x?kt.textSizeData:kt.iconSizeData,br=Ne||Le.pitch!==0,Hr=C.useProgram(zu(rn,x,kt),Sn),Ei=s.am(Vn,Le.zoom),ii=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Mt);let ci,ai,Kr,ti,go=[0,0],Ar=null;if(x)ai=Tt.glyphAtlasTexture,Kr=ve.LINEAR,ci=Tt.glyphAtlasTexture.size,kt.iconsInText&&(go=Tt.imageAtlasTexture.size,Ar=Tt.imageAtlasTexture,ti=br||C.options.rotating||C.options.zooming||Vn.kind==="composite"||Vn.kind==="camera"?ve.LINEAR:ve.NEAREST);else{const zi=u.layout.get("icon-size").constantOr(0)!==1||kt.iconsNeedLinear;ai=Tt.imageAtlasTexture,Kr=rn||C.options.rotating||C.options.zooming||zi||br?ve.LINEAR:ve.NEAREST,ci=Tt.imageAtlasTexture.size}const so=s.aB(Tt,1,C.transform.zoom),vo=mt(ze,C.transform,so),yl=s.L();s.ap(yl,vo);const _l=Wt(Ne,ze,C.transform,so),Va=s.aC(Le,Tt,E,k),ya=Le.getProjectionData({overscaledTileID:Mt,applyGlobeMatrix:!re,applyTerrainMatrix:!0}),Yu=Ye&&kt.hasTextData(),Ku=u.layout.get("icon-text-fit")!=="none"&&Yu&&kt.hasIconData();if(Ge){const zi=C.style.map.terrain?(yo,ao)=>C.style.map.terrain.getElevation(Mt,yo,ao):null,hi=u.layout.get("text-rotation-alignment")==="map";Dn(kt,C,x,vo,yl,Ne,Z,hi,Mt.toUnwrapped(),Le.width,Le.height,Va,zi)}const Ju=x&&Ye||Ku,as=Ge||Ju?jp:Ne?vo:C.transform.clipSpaceToPixelsMatrix,_a=rn&&u.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let gc;gc=rn?kt.iconsInText?Gh(Vn.kind,Ei,et,Ne,Ge,Ju,C,as,_l,Va,ci,go,Pt):Uc(Vn.kind,Ei,et,Ne,Ge,Ju,C,as,_l,Va,x,ci,0,Pt):lf(Vn.kind,Ei,et,Ne,Ge,Ju,C,as,_l,Va,x,ci,Pt);const vc={program:Hr,buffers:Mn,uniformValues:gc,projectionData:ya,atlasTexture:ai,atlasTextureIcon:Ar,atlasInterpolation:Kr,atlasInterpolationIcon:ti,isSDF:rn,hasHalo:_a};if(Xe&&kt.canOverlap){at=!0;const zi=Mn.segments.get();for(const hi of zi)pt.push({segments:new s.aL([hi]),sortKey:hi.sortKey,state:vc,terrainData:ii})}else pt.push({segments:Mn.segments,sortKey:0,state:vc,terrainData:ii})}at&&pt.sort((Mt,Tt)=>Mt.sortKey-Tt.sortKey);for(const Mt of pt){const Tt=Mt.state;if(ce.activeTexture.set(ve.TEXTURE0),Tt.atlasTexture.bind(Tt.atlasInterpolation,ve.CLAMP_TO_EDGE),Tt.atlasTextureIcon&&(ce.activeTexture.set(ve.TEXTURE1),Tt.atlasTextureIcon&&Tt.atlasTextureIcon.bind(Tt.atlasInterpolationIcon,ve.CLAMP_TO_EDGE)),Tt.isSDF){const kt=Tt.uniformValues;Tt.hasHalo&&(kt.u_is_halo=1,Ou(Tt.buffers,Mt.segments,u,C,Tt.program,ht,K,oe,kt,Tt.projectionData,Mt.terrainData)),kt.u_is_halo=0}Ou(Tt.buffers,Mt.segments,u,C,Tt.program,ht,K,oe,Tt.uniformValues,Tt.projectionData,Mt.terrainData)}}function Ou(C,o,u,g,x,E,k,F,U,Z,K){const oe=g.context;x.draw(oe,oe.gl.TRIANGLES,E,k,F,_r.backCCW,U,K,Z,u.id,C.layoutVertexBuffer,C.indexBuffer,o,u.paint,g.transform.zoom,C.programConfigurations.get(u.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function ac(C,o,u,g,x){const E=C.context,k=E.gl,F=sr.disabled,U=new Tr([k.ONE,k.ONE],s.be.transparent,[!0,!0,!0,!0]),Z=o.getBucket(u);if(!Z)return;const K=g.key;let oe=u.heatmapFbos.get(K);oe||(oe=Fa(E,o.tileSize,o.tileSize),u.heatmapFbos.set(K,oe)),E.bindFramebuffer.set(oe.framebuffer),E.viewport.set([0,0,o.tileSize,o.tileSize]),E.clear({color:s.be.transparent});const re=Z.programConfigurations.get(u.id),ce=C.useProgram("heatmap",re,!x),ve=C.transform.getProjectionData({overscaledTileID:o.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Le=C.style.map.terrain.getTerrainData(g);ce.draw(E,k.TRIANGLES,vr.disabled,F,U,_r.disabled,Vh(o,C.transform.zoom,u.paint.get("heatmap-intensity"),1),Le,ve,u.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,u.paint,C.transform.zoom,re)}function Hc(C,o,u,g,x){const E=C.context,k=E.gl,F=C.transform;E.setColorMode(C.colorModeForRenderPass());const U=Qh(E,o),Z=u.key,K=o.heatmapFbos.get(Z);if(!K)return;E.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,K.colorAttachment.get()),E.activeTexture.set(k.TEXTURE1),U.bind(k.LINEAR,k.CLAMP_TO_EDGE);const oe=F.getProjectionData({overscaledTileID:u,applyTerrainMatrix:x,applyGlobeMatrix:!g});C.useProgram("heatmapTexture").draw(E,k.TRIANGLES,vr.disabled,sr.disabled,C.colorModeForRenderPass(),_r.disabled,sg(C,o,0,1),null,oe,o.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments,o.paint,F.zoom),K.destroy(),o.heatmapFbos.delete(Z)}function Fa(C,o,u){var g,x;const E=C.gl,k=E.createTexture();E.bindTexture(E.TEXTURE_2D,k),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,E.LINEAR);const F=(g=C.HALF_FLOAT)!==null&&g!==void 0?g:E.UNSIGNED_BYTE,U=(x=C.RGBA16F)!==null&&x!==void 0?x:E.RGBA;E.texImage2D(E.TEXTURE_2D,0,U,o,u,0,E.RGBA,F,null);const Z=C.createFramebuffer(o,u,!1,!1);return Z.colorAttachment.set(k),Z}function Qh(C,o){return o.colorRampTexture||(o.colorRampTexture=new s.T(C,o.colorRamp,C.gl.RGBA)),o.colorRampTexture}function Wp(C,o,u,g,x){if(!u||!g||!g.imageAtlas)return;const E=g.imageAtlas.patternPositions;let k=E[u.to.toString()],F=E[u.from.toString()];if(!k&&F&&(k=F),!F&&k&&(F=k),!k||!F){const U=x.getPaintProperty(o);k=E[U],F=E[U]}k&&F&&C.setConstantPatternPositions(k,F)}function ed(C,o,u,g,x,E,k,F){const U=C.context.gl,Z="fill-pattern",K=u.paint.get(Z),oe=K&&K.constantOr(1),re=u.getCrossfadeParameters();let ce,ve,Le,ze,Ne;const Ge=C.transform,et=u.paint.get("fill-translate"),Xe=u.paint.get("fill-translate-anchor");k?(ve=oe&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ce=U.LINES):(ve=oe?"fillPattern":"fill",ce=U.TRIANGLES);const at=K.constantOr(null);for(const ht of g){const Ye=o.getTile(ht);if(oe&&!Ye.patternsLoaded())continue;const pt=Ye.getBucket(u);if(!pt)continue;const Pt=pt.programConfigurations.get(u.id),Mt=C.useProgram(ve,Pt),Tt=C.style.map.terrain&&C.style.map.terrain.getTerrainData(ht);oe&&(C.context.activeTexture.set(U.TEXTURE0),Ye.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Pt.updatePaintBuffers(re)),Wp(Pt,Z,at,Ye,u);const kt=Ge.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),Mn=s.aC(Ge,Ye,et,Xe);if(k){ze=pt.indexBuffer2,Ne=pt.segments2;const rn=[U.drawingBufferWidth,U.drawingBufferHeight];Le=ve==="fillOutlinePattern"&&oe?Cy(C,re,Ye,rn,Mn):fa(rn,Mn)}else ze=pt.indexBuffer,Ne=pt.segments,Le=oe?sf(C,re,Ye,Mn):{u_fill_translate:Mn};const Sn=C.stencilModeForClipping(ht);Mt.draw(C.context,ce,x,Sn,E,_r.backCCW,Le,Tt,kt,u.id,pt.layoutVertexBuffer,ze,Ne,u.paint,C.transform.zoom,Pt)}}function Gc(C,o,u,g,x,E,k,F){const U=C.context,Z=U.gl,K="fill-extrusion-pattern",oe=u.paint.get(K),re=oe.constantOr(1),ce=u.getCrossfadeParameters(),ve=u.paint.get("fill-extrusion-opacity"),Le=oe.constantOr(null),ze=C.transform;for(const Ne of g){const Ge=o.getTile(Ne),et=Ge.getBucket(u);if(!et)continue;const Xe=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Ne),at=et.programConfigurations.get(u.id),ht=C.useProgram(re?"fillExtrusionPattern":"fillExtrusion",at);re&&(C.context.activeTexture.set(Z.TEXTURE0),Ge.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),at.updatePaintBuffers(ce));const Ye=ze.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!F,applyTerrainMatrix:!0});Wp(at,K,Le,Ge,u);const pt=s.aC(ze,Ge,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Pt=u.paint.get("fill-extrusion-vertical-gradient"),Mt=re?Ap(C,Pt,ve,pt,Ne,ce,Ge):Bh(C,Pt,ve,pt);ht.draw(U,U.gl.TRIANGLES,x,E,k,_r.backCCW,Mt,Xe,Ye,u.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,u.paint,C.transform.zoom,at,C.style.map.terrain&&et.centroidVertexBuffer)}}function pl(C,o,u,g,x,E,k,F,U){var Z;const K=C.style.projection,oe=C.context,re=C.transform,ce=oe.gl,ve=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],Le=C.useProgram("hillshade",null,!1,ve),ze=!C.options.moving;for(const Ne of g){const Ge=o.getTile(Ne),et=Ge.fbo;if(!et)continue;const Xe=K.getMeshFromTileID(oe,Ne.canonical,F,!0,"raster"),at=(Z=C.style.map.terrain)===null||Z===void 0?void 0:Z.getTerrainData(Ne);oe.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,et.colorAttachment.get());const ht=re.getProjectionData({overscaledTileID:Ne,aligned:ze,applyGlobeMatrix:!U,applyTerrainMatrix:!0});Le.draw(oe,ce.TRIANGLES,E,x[Ne.overscaledZ],k,_r.backCCW,Jl(C,Ge,u),at,ht,u.id,Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)}}function lc(C,o,u,g,x,E,k,F,U){var Z;const K=C.style.projection,oe=C.context,re=C.transform,ce=oe.gl,ve=C.useProgram("colorRelief"),Le=!C.options.moving;let ze=!0,Ne=0;for(const Ge of g){const et=o.getTile(Ge),Xe=et.dem;if(ze){const Mt=ce.getParameter(ce.MAX_TEXTURE_SIZE),{elevationTexture:Tt,colorTexture:kt}=u.getColorRampTextures(oe,Mt,Xe.getUnpackVector());oe.activeTexture.set(ce.TEXTURE1),Tt.bind(ce.NEAREST,ce.CLAMP_TO_EDGE),oe.activeTexture.set(ce.TEXTURE4),kt.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),ze=!1,Ne=Tt.size[0]}if(!Xe||!Xe.data)continue;const at=Xe.stride,ht=Xe.getPixels();if(oe.activeTexture.set(ce.TEXTURE0),oe.pixelStoreUnpackPremultiplyAlpha.set(!1),et.demTexture=et.demTexture||C.getTileTexture(at),et.demTexture){const Mt=et.demTexture;Mt.update(ht,{premultiply:!1}),Mt.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)}else et.demTexture=new s.T(oe,ht,ce.RGBA,{premultiply:!1}),et.demTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE);const Ye=K.getMeshFromTileID(oe,Ge.canonical,F,!0,"raster"),pt=(Z=C.style.map.terrain)===null||Z===void 0?void 0:Z.getTerrainData(Ge),Pt=re.getProjectionData({overscaledTileID:Ge,aligned:Le,applyGlobeMatrix:!U,applyTerrainMatrix:!0});ve.draw(oe,ce.TRIANGLES,E,x[Ge.overscaledZ],k,_r.backCCW,lg(u,et.dem,Ne),pt,Pt,u.id,Ye.vertexBuffer,Ye.indexBuffer,Ye.segments)}}const td=[new s.P(0,0),new s.P(s.$,0),new s.P(s.$,s.$),new s.P(0,s.$)];function Na(C,o,u,g,x,E,k,F,U=!1,Z=!1){const K=g[g.length-1].overscaledZ,oe=C.context,re=oe.gl,ce=C.useProgram("raster"),ve=C.transform,Le=C.style.projection,ze=C.colorModeForRenderPass(),Ne=!C.options.moving;for(const Ge of g){const et=C.getDepthModeForSublayer(Ge.overscaledZ-K,u.paint.get("raster-opacity")===1?vr.ReadWrite:vr.ReadOnly,re.LESS),Xe=o.getTile(Ge);Xe.registerFadeDuration(u.paint.get("raster-fade-duration"));const at=o.findLoadedParent(Ge,0),ht=o.findLoadedSibling(Ge),Ye=qp(Xe,at||ht||null,o,u,C.transform,C.style.map.terrain);let pt,Pt;const Mt=u.paint.get("raster-resampling")==="nearest"?re.NEAREST:re.LINEAR;oe.activeTexture.set(re.TEXTURE0),Xe.texture.bind(Mt,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),oe.activeTexture.set(re.TEXTURE1),at?(at.texture.bind(Mt,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),pt=Math.pow(2,at.tileID.overscaledZ-Xe.tileID.overscaledZ),Pt=[Xe.tileID.canonical.x*pt%1,Xe.tileID.canonical.y*pt%1]):Xe.texture.bind(Mt,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),Xe.texture.useMipmap&&oe.extTextureFilterAnisotropic&&C.transform.pitch>20&&re.texParameterf(re.TEXTURE_2D,oe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,oe.extTextureFilterAnisotropicMax);const Tt=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Ge),kt=ve.getProjectionData({overscaledTileID:Ge,aligned:Ne,applyGlobeMatrix:!Z,applyTerrainMatrix:!0}),Mn=Bc(Pt||[0,0],pt||1,Ye,u,F),Sn=Le.getMeshFromTileID(oe,Ge.canonical,E,k,"raster");ce.draw(oe,re.TRIANGLES,et,x?x[Ge.overscaledZ]:sr.disabled,ze,U?_r.frontCCW:_r.backCCW,Mn,Tt,kt,u.id,Sn.vertexBuffer,Sn.indexBuffer,Sn.segments)}}function qp(C,o,u,g,x,E){const k=g.paint.get("raster-fade-duration");if(!E&&k>0){const F=S.now(),U=(F-C.timeAdded)/k,Z=o?(F-o.timeAdded)/k:-1,K=u.getSource(),oe=Be(x,{tileSize:K.tileSize,roundZoom:K.roundZoom}),re=!o||Math.abs(o.tileID.overscaledZ-oe)>Math.abs(C.tileID.overscaledZ-oe),ce=re&&C.refreshedUponExpiration?1:s.ag(re?U:1-Z,0,1);return C.refreshedUponExpiration&&U>=1&&(C.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ce}:{opacity:ce,mix:0}}return{opacity:1,mix:0}}const ff=new s.be(1,0,0,1),pf=new s.be(0,1,0,1),mf=new s.be(0,0,1,1),vg=new s.be(1,0,1,1),yg=new s.be(0,1,1,1);function Wc(C,o,u,g){nd(C,0,o+u/2,C.transform.width,u,g)}function ma(C,o,u,g){nd(C,o-u/2,0,u,C.transform.height,g)}function nd(C,o,u,g,x,E){const k=C.context,F=k.gl;F.enable(F.SCISSOR_TEST),F.scissor(o*C.pixelRatio,u*C.pixelRatio,g*C.pixelRatio,x*C.pixelRatio),k.clear({color:E}),F.disable(F.SCISSOR_TEST)}function qc(C,o,u){const g=C.context,x=g.gl,E=C.useProgram("debug"),k=vr.disabled,F=sr.disabled,U=C.colorModeForRenderPass(),Z="$debug",K=C.style.map.terrain&&C.style.map.terrain.getTerrainData(u);g.activeTexture.set(x.TEXTURE0);const oe=o.getTileByID(u.key).latestRawTileData,re=Math.floor((oe&&oe.byteLength||0)/1024),ce=o.getTile(u).tileSize,ve=512/Math.min(ce,512)*(u.overscaledZ/C.transform.zoom)*.5;let Le=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Le+=` => ${u.overscaledZ}`),function(Ne,Ge){Ne.initDebugOverlayCanvas();const et=Ne.debugOverlayCanvas,Xe=Ne.context.gl,at=Ne.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,et.width,et.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(Ge,5,5),at.strokeText(Ge,5,5),Ne.debugOverlayTexture.update(et),Ne.debugOverlayTexture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE)}(C,`${Le} ${re}kB`);const ze=C.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});E.draw(g,x.TRIANGLES,k,F,Tr.alphaBlended,_r.disabled,og(s.be.transparent,ve),null,ze,Z,C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments),E.draw(g,x.LINE_STRIP,k,F,U,_r.disabled,og(s.be.red),K,ze,Z,C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments)}function Yr(C,o,u,g){const{isRenderingGlobe:x}=g,E=C.context,k=E.gl,F=C.transform,U=C.colorModeForRenderPass(),Z=C.getDepthModeFor3D(),K=C.useProgram("terrain");E.bindFramebuffer.set(null),E.viewport.set([0,0,C.width,C.height]);for(const oe of u){const re=o.getTerrainMesh(oe.tileID),ce=C.renderToTexture.getTexture(oe),ve=o.getTerrainData(oe.tileID);E.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,ce.texture);const Le=o.getMeshFrameDelta(F.zoom),ze=F.calculateFogMatrix(oe.tileID.toUnwrapped()),Ne=Sy(Le,ze,C.style.sky,F.pitch,x),Ge=F.getProjectionData({overscaledTileID:oe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});K.draw(E,k.TRIANGLES,Z,sr.disabled,U,_r.backCCW,Ne,ve,Ge,"terrain",re.vertexBuffer,re.indexBuffer,re.segments)}}function ea(C,o){if(!o.mesh){const u=new s.aK;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const g=new s.aM;g.emplaceBack(0,1,2),g.emplaceBack(0,2,3),o.mesh=new ha(C.createVertexBuffer(u,La.members),C.createIndexBuffer(g),s.aL.simpleSegment(0,0,u.length,g.length))}return o.mesh}class Yi{constructor(o,u){this.context=new Sr(o),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.af(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=dt.maxUnderzooming+dt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Vi}resize(o,u,g){if(this.width=Math.floor(o*g),this.height=Math.floor(u*g),this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style._order)this.style._layers[x].resize()}setup(){const o=this.context,u=new s.aK;u.emplaceBack(0,0),u.emplaceBack(s.$,0),u.emplaceBack(0,s.$),u.emplaceBack(s.$,s.$),this.tileExtentBuffer=o.createVertexBuffer(u,La.members),this.tileExtentSegments=s.aL.simpleSegment(0,0,4,2);const g=new s.aK;g.emplaceBack(0,0),g.emplaceBack(s.$,0),g.emplaceBack(0,s.$),g.emplaceBack(s.$,s.$),this.debugBuffer=o.createVertexBuffer(g,La.members),this.debugSegments=s.aL.simpleSegment(0,0,4,5);const x=new s.c5;x.emplaceBack(0,0,0,0),x.emplaceBack(s.$,0,s.$,0),x.emplaceBack(0,s.$,0,s.$),x.emplaceBack(s.$,s.$,s.$,s.$),this.rasterBoundsBuffer=o.createVertexBuffer(x,wy.members),this.rasterBoundsSegments=s.aL.simpleSegment(0,0,4,2);const E=new s.aK;E.emplaceBack(0,0),E.emplaceBack(s.$,0),E.emplaceBack(0,s.$),E.emplaceBack(s.$,s.$),this.rasterBoundsBufferPosOnly=o.createVertexBuffer(E,La.members),this.rasterBoundsSegmentsPosOnly=s.aL.simpleSegment(0,0,4,5);const k=new s.aK;k.emplaceBack(0,0),k.emplaceBack(1,0),k.emplaceBack(0,1),k.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(k,La.members),this.viewportSegments=s.aL.simpleSegment(0,0,4,2);const F=new s.c6;F.emplaceBack(0),F.emplaceBack(1),F.emplaceBack(3),F.emplaceBack(2),F.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(F);const U=new s.aM;U.emplaceBack(1,0,2),U.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(U);const Z=this.context.gl;this.stencilClearMode=new sr({func:Z.ALWAYS,mask:0},0,255,Z.ZERO,Z.ZERO,Z.ZERO),this.tileExtentMesh=new ha(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const o=this.context,u=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=s.L();s.bX(g,0,this.width,this.height,0,0,1),s.N(g,g,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const x={mainMatrix:g,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:g};this.useProgram("clippingMask",null,!0).draw(o,u.TRIANGLES,vr.disabled,this.stencilClearMode,Tr.disabled,_r.disabled,null,null,x,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,u,g){if(this.currentStencilSource===o.source||!o.isTileClipped()||!u||!u.length)return;this.currentStencilSource=o.source,this.nextStencilID+u.length>256&&this.clearStencil();const x=this.context;x.setColorMode(Tr.disabled),x.setDepthMode(vr.disabled);const E={};for(const k of u)E[k.key]=this.nextStencilID++;this._renderTileMasks(E,u,g,!0),this._renderTileMasks(E,u,g,!1),this._tileClippingMaskIDs=E}_renderTileMasks(o,u,g,x){const E=this.context,k=E.gl,F=this.style.projection,U=this.transform,Z=this.useProgram("clippingMask");for(const K of u){const oe=o[K.key],re=this.style.map.terrain&&this.style.map.terrain.getTerrainData(K),ce=F.getMeshFromTileID(this.context,K.canonical,x,!0,"stencil"),ve=U.getProjectionData({overscaledTileID:K,applyGlobeMatrix:!g,applyTerrainMatrix:!0});Z.draw(E,k.TRIANGLES,vr.disabled,new sr({func:k.ALWAYS,mask:0},oe,255,k.KEEP,k.KEEP,k.REPLACE),Tr.disabled,g?_r.disabled:_r.backCCW,null,re,ve,"$clipping",ce.vertexBuffer,ce.indexBuffer,ce.segments)}}_renderTilesDepthBuffer(){const o=this.context,u=o.gl,g=this.style.projection,x=this.transform,E=this.useProgram("depth"),k=this.getDepthModeFor3D(),F=$e(x,{tileSize:x.tileSize});for(const U of F){const Z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),K=g.getMeshFromTileID(this.context,U.canonical,!0,!0,"raster"),oe=x.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!0,applyTerrainMatrix:!0});E.draw(o,u.TRIANGLES,k,sr.disabled,Tr.disabled,_r.backCCW,null,Z,oe,"$clipping",K.vertexBuffer,K.indexBuffer,K.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new sr({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){const u=this.context.gl;return new sr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(o){const u=this.context.gl,g=o.sort((k,F)=>F.overscaledZ-k.overscaledZ),x=g[g.length-1].overscaledZ,E=g[0].overscaledZ-x+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const k={};for(let F=0;F<E;F++)k[F+x]=new sr({func:u.GEQUAL,mask:255},F+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=E,[k,g]}return[{[x]:sr.disabled},g]}stencilConfigForOverlapTwoPass(o){const u=this.context.gl,g=o.sort((k,F)=>F.overscaledZ-k.overscaledZ),x=g[g.length-1].overscaledZ,E=g[0].overscaledZ-x+1;if(this.clearStencil(),E>1){const k={},F={};for(let U=0;U<E;U++)k[U+x]=new sr({func:u.GREATER,mask:255},E+1+U,255,u.KEEP,u.KEEP,u.REPLACE),F[U+x]=new sr({func:u.GREATER,mask:255},1+U,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*E+1,[k,F,g]}return this.nextStencilID=3,[{[x]:new sr({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[x]:new sr({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},g]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Tr([o.CONSTANT_COLOR,o.ONE],new s.be(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Tr.unblended:Tr.alphaBlended}getDepthModeForSublayer(o,u,g){if(!this.opaquePassEnabledForLayer())return vr.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new vr(g||this.context.gl.LEQUAL,u,[x,x])}getDepthModeFor3D(){return new vr(this.context.gl.LEQUAL,vr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,u){var g,x;this.style=o,this.options=u,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(S.now()),this.imageManager.beginFrame();const E=this.style._order,k=this.style.sourceCaches,F={},U={},Z={},K={isRenderingToTexture:!1,isRenderingGlobe:((g=o.projection)===null||g===void 0?void 0:g.transitionState)>0};for(const re in k){const ce=k[re];ce.used&&ce.prepare(this.context),F[re]=ce.getVisibleCoordinates(!1),U[re]=F[re].slice().reverse(),Z[re]=ce.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let re=0;re<E.length;re++)if(this.style._layers[E[re]].is3D()){this.opaquePassCutoff=re;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const re of E){const ce=this.style._layers[re];if(!ce.hasOffscreenPass()||ce.isHidden(this.transform.zoom))continue;const ve=U[ce.source];(ce.type==="custom"||ve.length)&&this.renderLayer(this,k[ce.source],ce,ve,K)}if((x=this.style.projection)===null||x===void 0||x.updateGPUdependent({context:this.context,useProgram:re=>this.useProgram(re)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?s.be.black:s.be.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(re,ce){const ve=re.context,Le=ve.gl,ze=((ht,Ye,pt)=>{const Pt=Math.cos(Ye.rollInRadians),Mt=Math.sin(Ye.rollInRadians),Tt=ue(Ye),kt=Ye.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ht.properties.get("sky-color"),u_horizon_color:ht.properties.get("horizon-color"),u_horizon:[(Ye.width/2-Tt*Mt)*pt,(Ye.height/2+Tt*Pt)*pt],u_horizon_normal:[-Mt,Pt],u_sky_horizon_blend:ht.properties.get("sky-horizon-blend")*Ye.height/2*pt,u_sky_blend:kt}})(ce,re.style.map.transform,re.pixelRatio),Ne=new vr(Le.LEQUAL,vr.ReadWrite,[0,1]),Ge=sr.disabled,et=re.colorModeForRenderPass(),Xe=re.useProgram("sky"),at=ea(ve,ce);Xe.draw(ve,Le.TRIANGLES,Ne,Ge,et,_r.disabled,ze,null,void 0,"sky",at.vertexBuffer,at.indexBuffer,at.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=E.length-1;this.currentLayer>=0;this.currentLayer--){const re=this.style._layers[E[this.currentLayer]],ce=k[re.source],ve=F[re.source];this._renderTileClippingMasks(re,ve,!1),this.renderLayer(this,ce,re,ve,K)}this.renderPass="translucent";let oe=!1;for(this.currentLayer=0;this.currentLayer<E.length;this.currentLayer++){const re=this.style._layers[E[this.currentLayer]],ce=k[re.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(re,K))continue;this.opaquePassEnabledForLayer()||oe||(oe=!0,K.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ve=(re.type==="symbol"?Z:U)[re.source];this._renderTileClippingMasks(re,F[re.source],!!this.renderToTexture),this.renderLayer(this,ce,re,ve,K)}if(K.isRenderingGlobe&&function(re,ce,ve){const Le=re.context,ze=Le.gl,Ne=re.useProgram("atmosphere"),Ge=new vr(ze.LEQUAL,vr.ReadOnly,[0,1]),et=re.transform,Xe=function(kt,Mn){const Sn=kt.properties.get("position"),rn=[-Sn.x,-Sn.y,-Sn.z],Vn=s.af(new Float64Array(16));return kt.properties.get("anchor")==="map"&&(s.b5(Vn,Vn,Mn.rollInRadians),s.b6(Vn,Vn,-Mn.pitchInRadians),s.b5(Vn,Vn,Mn.bearingInRadians),s.b6(Vn,Vn,Mn.center.lat*Math.PI/180),s.by(Vn,Vn,-Mn.center.lng*Math.PI/180)),s.c4(rn,rn,Vn),rn}(ve,re.transform),at=et.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ht=ce.properties.get("atmosphere-blend")*at.projectionTransition;if(ht===0)return;const Ye=ul(et.worldSize,et.center.lat),pt=et.inverseProjectionMatrix,Pt=new Float64Array(4);Pt[3]=1,s.av(Pt,Pt,et.modelViewProjectionMatrix),Pt[0]/=Pt[3],Pt[1]/=Pt[3],Pt[2]/=Pt[3],Pt[3]=1,s.av(Pt,Pt,pt),Pt[0]/=Pt[3],Pt[1]/=Pt[3],Pt[2]/=Pt[3],Pt[3]=1;const Mt=((kt,Mn,Sn,rn,Vn)=>({u_sun_pos:kt,u_atmosphere_blend:Mn,u_globe_position:Sn,u_globe_radius:rn,u_inv_proj_matrix:Vn}))(Xe,ht,[Pt[0],Pt[1],Pt[2]],Ye,pt),Tt=ea(Le,ce);Ne.draw(Le,ze.TRIANGLES,Ge,sr.disabled,Tr.alphaBlended,_r.disabled,Mt,null,null,"atmosphere",Tt.vertexBuffer,Tt.indexBuffer,Tt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const re=function(ce,ve){let Le=null;const ze=Object.values(ce._layers).flatMap(Xe=>Xe.source&&!Xe.isHidden(ve)?[ce.sourceCaches[Xe.source]]:[]),Ne=ze.filter(Xe=>Xe.getSource().type==="vector"),Ge=ze.filter(Xe=>Xe.getSource().type!=="vector"),et=Xe=>{(!Le||Le.getSource().maxzoom<Xe.getSource().maxzoom)&&(Le=Xe)};return Ne.forEach(Xe=>et(Xe)),Le||Ge.forEach(Xe=>et(Xe)),Le}(this.style,this.transform.zoom);re&&function(ce,ve,Le){for(let ze=0;ze<Le.length;ze++)qc(ce,ve,Le[ze])}(this,re,re.getVisibleCoordinates())}this.options.showPadding&&function(re){const ce=re.transform.padding;Wc(re,re.transform.height-(ce.top||0),3,ff),Wc(re,ce.bottom||0,3,pf),ma(re,ce.left||0,3,mf),ma(re,re.transform.width-(ce.right||0),3,vg);const ve=re.transform.centerPoint;(function(Le,ze,Ne,Ge){nd(Le,ze-1,Ne-10,2,20,Ge),nd(Le,ze-10,Ne-1,20,2,Ge)})(re,ve.x,re.transform.height-ve.y,yg)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,g=this.transform.modelViewProjectionMatrix;let x=this.terrainFacilitator.dirty;x||(x=o?!s.c7(u,g):!s.c8(u,g)),x||(x=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),x&&(s.c9(u,g),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(E,k){const F=E.context,U=F.gl,Z=E.transform,K=Tr.unblended,oe=new vr(U.LEQUAL,vr.ReadWrite,[0,1]),re=k.sourceCache.getRenderableTiles(),ce=E.useProgram("terrainDepth");F.bindFramebuffer.set(k.getFramebuffer("depth").framebuffer),F.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),F.clear({color:s.be.transparent,depth:1});for(const ve of re){const Le=k.getTerrainMesh(ve.tileID),ze=k.getTerrainData(ve.tileID),Ne=Z.getProjectionData({overscaledTileID:ve.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Ge={u_ele_delta:k.getMeshFrameDelta(Z.zoom)};ce.draw(F,U.TRIANGLES,oe,sr.disabled,K,_r.backCCW,Ge,ze,Ne,"terrain",Le.vertexBuffer,Le.indexBuffer,Le.segments)}F.bindFramebuffer.set(null),F.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain),function(E,k){const F=E.context,U=F.gl,Z=E.transform,K=Tr.unblended,oe=new vr(U.LEQUAL,vr.ReadWrite,[0,1]),re=k.getCoordsTexture(),ce=k.sourceCache.getRenderableTiles(),ve=E.useProgram("terrainCoords");F.bindFramebuffer.set(k.getFramebuffer("coords").framebuffer),F.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),F.clear({color:s.be.transparent,depth:1}),k.coordsIndex=[];for(const Le of ce){const ze=k.getTerrainMesh(Le.tileID),Ne=k.getTerrainData(Le.tileID);F.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,re.texture);const Ge={u_terrain_coords_id:(255-k.coordsIndex.length)/255,u_texture:0,u_ele_delta:k.getMeshFrameDelta(Z.zoom)},et=Z.getProjectionData({overscaledTileID:Le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ve.draw(F,U.TRIANGLES,oe,sr.disabled,K,_r.backCCW,Ge,Ne,et,"terrain",ze.vertexBuffer,ze.indexBuffer,ze.segments),k.coordsIndex.push(Le.tileID.key)}F.bindFramebuffer.set(null),F.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain))}renderLayer(o,u,g,x,E){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="custom"||(x||[]).length)&&(this.id=g.id,s.ca(g)?function(k,F,U,Z,K,oe){if(k.renderPass!=="translucent")return;const{isRenderingToTexture:re}=oe,ce=sr.disabled,ve=k.colorModeForRenderPass();(U._unevaluatedLayout.hasValue("text-variable-anchor")||U._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Le,ze,Ne,Ge,et,Xe,at,ht,Ye){const pt=ze.transform,Pt=ze.style.map.terrain,Mt=et==="map",Tt=Xe==="map";for(const kt of Le){const Mn=Ge.getTile(kt),Sn=Mn.getBucket(Ne);if(!Sn||!Sn.text||!Sn.text.segments.get().length)continue;const rn=s.am(Sn.textSizeData,pt.zoom),Vn=s.aB(Mn,1,ze.transform.zoom),br=mt(Mt,ze.transform,Vn),Hr=Ne.layout.get("icon-text-fit")!=="none"&&Sn.hasIconData();if(rn){const Ei=Math.pow(2,pt.zoom-Mn.tileID.overscaledZ),ii=Pt?(ci,ai)=>Pt.getElevation(kt,ci,ai):null;df(Sn,Mt,Tt,Ye,pt,br,Ei,rn,Hr,s.aC(pt,Mn,at,ht),kt.toUnwrapped(),ii)}}}(Z,k,U,F,U.layout.get("text-rotation-alignment"),U.layout.get("text-pitch-alignment"),U.paint.get("text-translate"),U.paint.get("text-translate-anchor"),K),U.paint.get("icon-opacity").constantOr(1)!==0&&Gp(k,F,U,Z,!1,U.paint.get("icon-translate"),U.paint.get("icon-translate-anchor"),U.layout.get("icon-rotation-alignment"),U.layout.get("icon-pitch-alignment"),U.layout.get("icon-keep-upright"),ce,ve,re),U.paint.get("text-opacity").constantOr(1)!==0&&Gp(k,F,U,Z,!0,U.paint.get("text-translate"),U.paint.get("text-translate-anchor"),U.layout.get("text-rotation-alignment"),U.layout.get("text-pitch-alignment"),U.layout.get("text-keep-upright"),ce,ve,re),F.map.showCollisionBoxes&&(Vp(k,F,U,Z,!0),Vp(k,F,U,Z,!1))}(o,u,g,x,this.style.placement.variableOffsets,E):s.cb(g)?function(k,F,U,Z,K){if(k.renderPass!=="translucent")return;const{isRenderingToTexture:oe}=K,re=U.paint.get("circle-opacity"),ce=U.paint.get("circle-stroke-width"),ve=U.paint.get("circle-stroke-opacity"),Le=!U.layout.get("circle-sort-key").isConstant();if(re.constantOr(1)===0&&(ce.constantOr(1)===0||ve.constantOr(1)===0))return;const ze=k.context,Ne=ze.gl,Ge=k.transform,et=k.getDepthModeForSublayer(0,vr.ReadOnly),Xe=sr.disabled,at=k.colorModeForRenderPass(),ht=[],Ye=Ge.getCircleRadiusCorrection();for(let pt=0;pt<Z.length;pt++){const Pt=Z[pt],Mt=F.getTile(Pt),Tt=Mt.getBucket(U);if(!Tt)continue;const kt=U.paint.get("circle-translate"),Mn=U.paint.get("circle-translate-anchor"),Sn=s.aC(Ge,Mt,kt,Mn),rn=Tt.programConfigurations.get(U.id),Vn=k.useProgram("circle",rn),br=Tt.layoutVertexBuffer,Hr=Tt.indexBuffer,Ei=k.style.map.terrain&&k.style.map.terrain.getTerrainData(Pt),ii={programConfiguration:rn,program:Vn,layoutVertexBuffer:br,indexBuffer:Hr,uniformValues:Ip(k,Mt,U,Sn,Ye),terrainData:Ei,projectionData:Ge.getProjectionData({overscaledTileID:Pt,applyGlobeMatrix:!oe,applyTerrainMatrix:!0})};if(Le){const ci=Tt.segments.get();for(const ai of ci)ht.push({segments:new s.aL([ai]),sortKey:ai.sortKey,state:ii})}else ht.push({segments:Tt.segments,sortKey:0,state:ii})}Le&&ht.sort((pt,Pt)=>pt.sortKey-Pt.sortKey);for(const pt of ht){const{programConfiguration:Pt,program:Mt,layoutVertexBuffer:Tt,indexBuffer:kt,uniformValues:Mn,terrainData:Sn,projectionData:rn}=pt.state;Mt.draw(ze,Ne.TRIANGLES,et,Xe,at,_r.backCCW,Mn,Sn,rn,U.id,Tt,kt,pt.segments,U.paint,k.transform.zoom,Pt)}}(o,u,g,x,E):s.cc(g)?function(k,F,U,Z,K){if(U.paint.get("heatmap-opacity")===0)return;const oe=k.context,{isRenderingToTexture:re,isRenderingGlobe:ce}=K;if(k.style.map.terrain){for(const ve of Z){const Le=F.getTile(ve);F.hasRenderableParent(ve)||(k.renderPass==="offscreen"?ac(k,Le,U,ve,ce):k.renderPass==="translucent"&&Hc(k,U,ve,re,ce))}oe.viewport.set([0,0,k.width,k.height])}else k.renderPass==="offscreen"?function(ve,Le,ze,Ne){const Ge=ve.context,et=Ge.gl,Xe=ve.transform,at=sr.disabled,ht=new Tr([et.ONE,et.ONE],s.be.transparent,[!0,!0,!0,!0]);(function(Ye,pt,Pt){const Mt=Ye.gl;Ye.activeTexture.set(Mt.TEXTURE1),Ye.viewport.set([0,0,pt.width/4,pt.height/4]);let Tt=Pt.heatmapFbos.get(s.c1);Tt?(Mt.bindTexture(Mt.TEXTURE_2D,Tt.colorAttachment.get()),Ye.bindFramebuffer.set(Tt.framebuffer)):(Tt=Fa(Ye,pt.width/4,pt.height/4),Pt.heatmapFbos.set(s.c1,Tt))})(Ge,ve,ze),Ge.clear({color:s.be.transparent});for(let Ye=0;Ye<Ne.length;Ye++){const pt=Ne[Ye];if(Le.hasRenderableParent(pt))continue;const Pt=Le.getTile(pt),Mt=Pt.getBucket(ze);if(!Mt)continue;const Tt=Mt.programConfigurations.get(ze.id),kt=ve.useProgram("heatmap",Tt),Mn=Xe.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Sn=Xe.getCircleRadiusCorrection();kt.draw(Ge,et.TRIANGLES,vr.disabled,at,ht,_r.backCCW,Vh(Pt,Xe.zoom,ze.paint.get("heatmap-intensity"),Sn),null,Mn,ze.id,Mt.layoutVertexBuffer,Mt.indexBuffer,Mt.segments,ze.paint,Xe.zoom,Tt)}Ge.viewport.set([0,0,ve.width,ve.height])}(k,F,U,Z):k.renderPass==="translucent"&&function(ve,Le){const ze=ve.context,Ne=ze.gl;ze.setColorMode(ve.colorModeForRenderPass());const Ge=Le.heatmapFbos.get(s.c1);Ge&&(ze.activeTexture.set(Ne.TEXTURE0),Ne.bindTexture(Ne.TEXTURE_2D,Ge.colorAttachment.get()),ze.activeTexture.set(Ne.TEXTURE1),Qh(ze,Le).bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),ve.useProgram("heatmapTexture").draw(ze,Ne.TRIANGLES,vr.disabled,sr.disabled,ve.colorModeForRenderPass(),_r.disabled,sg(ve,Le,0,1),null,null,Le.id,ve.viewportBuffer,ve.quadTriangleIndexBuffer,ve.viewportSegments,Le.paint,ve.transform.zoom))}(k,U)}(o,u,g,x,E):s.cd(g)?function(k,F,U,Z,K){if(k.renderPass!=="translucent")return;const{isRenderingToTexture:oe}=K,re=U.paint.get("line-opacity"),ce=U.paint.get("line-width");if(re.constantOr(1)===0||ce.constantOr(1)===0)return;const ve=k.getDepthModeForSublayer(0,vr.ReadOnly),Le=k.colorModeForRenderPass(),ze=U.paint.get("line-dasharray"),Ne=U.paint.get("line-pattern"),Ge=Ne.constantOr(1),et=U.paint.get("line-gradient"),Xe=U.getCrossfadeParameters(),at=Ge?"linePattern":ze?"lineSDF":et?"lineGradient":"line",ht=k.context,Ye=ht.gl,pt=k.transform;let Pt=!0;for(const Mt of Z){const Tt=F.getTile(Mt);if(Ge&&!Tt.patternsLoaded())continue;const kt=Tt.getBucket(U);if(!kt)continue;const Mn=kt.programConfigurations.get(U.id),Sn=k.context.program.get(),rn=k.useProgram(at,Mn),Vn=Pt||rn.program!==Sn,br=k.style.map.terrain&&k.style.map.terrain.getTerrainData(Mt),Hr=Ne.constantOr(null);if(Hr&&Tt.imageAtlas){const Kr=Tt.imageAtlas,ti=Kr.patternPositions[Hr.to.toString()],go=Kr.patternPositions[Hr.from.toString()];ti&&go&&Mn.setConstantPatternPositions(ti,go)}const Ei=pt.getProjectionData({overscaledTileID:Mt,applyGlobeMatrix:!oe,applyTerrainMatrix:!0}),ii=pt.getPixelScale(),ci=Ge?Rp(k,Tt,U,ii,Xe):ze?Lp(k,Tt,U,ii,ze,Xe):et?af(k,Tt,U,ii,kt.lineClipsArray.length):Hh(k,Tt,U,ii);if(Ge)ht.activeTexture.set(Ye.TEXTURE0),Tt.imageAtlasTexture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE),Mn.updatePaintBuffers(Xe);else if(ze&&(Vn||k.lineAtlas.dirty))ht.activeTexture.set(Ye.TEXTURE0),k.lineAtlas.bind(ht);else if(et){const Kr=kt.gradients[U.id];let ti=Kr.texture;if(U.gradientVersion!==Kr.version){let go=256;if(U.stepInterpolant){const Ar=F.getSource().maxzoom,so=Mt.canonical.z===Ar?Math.ceil(1<<k.transform.maxZoom-Mt.canonical.z):1;go=s.ag(s.c2(kt.maxLineLength/s.$*1024*so),256,ht.maxTextureSize)}Kr.gradient=s.c3({expression:U.gradientExpression(),evaluationKey:"lineProgress",resolution:go,image:Kr.gradient||void 0,clips:kt.lineClipsArray}),Kr.texture?Kr.texture.update(Kr.gradient):Kr.texture=new s.T(ht,Kr.gradient,Ye.RGBA),Kr.version=U.gradientVersion,ti=Kr.texture}ht.activeTexture.set(Ye.TEXTURE0),ti.bind(U.stepInterpolant?Ye.NEAREST:Ye.LINEAR,Ye.CLAMP_TO_EDGE)}const ai=k.stencilModeForClipping(Mt);rn.draw(ht,Ye.TRIANGLES,ve,ai,Le,_r.disabled,ci,br,Ei,U.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,U.paint,k.transform.zoom,Mn,kt.layoutVertexBuffer2),Pt=!1}}(o,u,g,x,E):s.ce(g)?function(k,F,U,Z,K){const oe=U.paint.get("fill-color"),re=U.paint.get("fill-opacity");if(re.constantOr(1)===0)return;const{isRenderingToTexture:ce}=K,ve=k.colorModeForRenderPass(),Le=U.paint.get("fill-pattern"),ze=k.opaquePassEnabledForLayer()&&!Le.constantOr(1)&&oe.constantOr(s.be.transparent).a===1&&re.constantOr(0)===1?"opaque":"translucent";if(k.renderPass===ze){const Ne=k.getDepthModeForSublayer(1,k.renderPass==="opaque"?vr.ReadWrite:vr.ReadOnly);ed(k,F,U,Z,Ne,ve,!1,ce)}if(k.renderPass==="translucent"&&U.paint.get("fill-antialias")){const Ne=k.getDepthModeForSublayer(U.getPaintProperty("fill-outline-color")?2:0,vr.ReadOnly);ed(k,F,U,Z,Ne,ve,!0,ce)}}(o,u,g,x,E):s.cf(g)?function(k,F,U,Z,K){const oe=U.paint.get("fill-extrusion-opacity");if(oe===0)return;const{isRenderingToTexture:re}=K;if(k.renderPass==="translucent"){const ce=new vr(k.context.gl.LEQUAL,vr.ReadWrite,k.depthRangeFor3D);if(oe!==1||U.paint.get("fill-extrusion-pattern").constantOr(1))Gc(k,F,U,Z,ce,sr.disabled,Tr.disabled,re),Gc(k,F,U,Z,ce,k.stencilModeFor3D(),k.colorModeForRenderPass(),re);else{const ve=k.colorModeForRenderPass();Gc(k,F,U,Z,ce,sr.disabled,ve,re)}}}(o,u,g,x,E):s.cg(g)?function(k,F,U,Z,K){if(k.renderPass!=="offscreen"&&k.renderPass!=="translucent")return;const{isRenderingToTexture:oe}=K,re=k.context,ce=k.style.projection.useSubdivision,ve=k.getDepthModeForSublayer(0,vr.ReadOnly),Le=k.colorModeForRenderPass();if(k.renderPass==="offscreen")(function(ze,Ne,Ge,et,Xe,at,ht){const Ye=ze.context,pt=Ye.gl;for(const Pt of Ge){const Mt=Ne.getTile(Pt),Tt=Mt.dem;if(!Tt||!Tt.data||!Mt.needsHillshadePrepare)continue;const kt=Tt.dim,Mn=Tt.stride,Sn=Tt.getPixels();if(Ye.activeTexture.set(pt.TEXTURE1),Ye.pixelStoreUnpackPremultiplyAlpha.set(!1),Mt.demTexture=Mt.demTexture||ze.getTileTexture(Mn),Mt.demTexture){const Vn=Mt.demTexture;Vn.update(Sn,{premultiply:!1}),Vn.bind(pt.NEAREST,pt.CLAMP_TO_EDGE)}else Mt.demTexture=new s.T(Ye,Sn,pt.RGBA,{premultiply:!1}),Mt.demTexture.bind(pt.NEAREST,pt.CLAMP_TO_EDGE);Ye.activeTexture.set(pt.TEXTURE0);let rn=Mt.fbo;if(!rn){const Vn=new s.T(Ye,{width:kt,height:kt,data:null},pt.RGBA);Vn.bind(pt.LINEAR,pt.CLAMP_TO_EDGE),rn=Mt.fbo=Ye.createFramebuffer(kt,kt,!0,!1),rn.colorAttachment.set(Vn.texture)}Ye.bindFramebuffer.set(rn.framebuffer),Ye.viewport.set([0,0,kt,kt]),ze.useProgram("hillshadePrepare").draw(Ye,pt.TRIANGLES,Xe,at,ht,_r.disabled,jh(Mt.tileID,Tt),null,null,et.id,ze.rasterBoundsBuffer,ze.quadTriangleIndexBuffer,ze.rasterBoundsSegments),Mt.needsHillshadePrepare=!1}})(k,F,Z,U,ve,sr.disabled,Le),re.viewport.set([0,0,k.width,k.height]);else if(k.renderPass==="translucent")if(ce){const[ze,Ne,Ge]=k.stencilConfigForOverlapTwoPass(Z);pl(k,F,U,Ge,ze,ve,Le,!1,oe),pl(k,F,U,Ge,Ne,ve,Le,!0,oe)}else{const[ze,Ne]=k.getStencilConfigForOverlapAndUpdateStencilID(Z);pl(k,F,U,Ne,ze,ve,Le,!1,oe)}}(o,u,g,x,E):s.ch(g)?function(k,F,U,Z,K){if(k.renderPass!=="translucent"||!Z.length)return;const{isRenderingToTexture:oe}=K,re=k.style.projection.useSubdivision,ce=k.getDepthModeForSublayer(0,vr.ReadOnly),ve=k.colorModeForRenderPass();if(re){const[Le,ze,Ne]=k.stencilConfigForOverlapTwoPass(Z);lc(k,F,U,Ne,Le,ce,ve,!1,oe),lc(k,F,U,Ne,ze,ce,ve,!0,oe)}else{const[Le,ze]=k.getStencilConfigForOverlapAndUpdateStencilID(Z);lc(k,F,U,ze,Le,ce,ve,!1,oe)}}(o,u,g,x,E):s.ci(g)?function(k,F,U,Z,K){if(k.renderPass!=="translucent"||U.paint.get("raster-opacity")===0||!Z.length)return;const{isRenderingToTexture:oe}=K,re=F.getSource(),ce=k.style.projection.useSubdivision;if(re instanceof On)Na(k,F,U,Z,null,!1,!1,re.tileCoords,re.flippedWindingOrder,oe);else if(ce){const[ve,Le,ze]=k.stencilConfigForOverlapTwoPass(Z);Na(k,F,U,ze,ve,!1,!0,td,!1,oe),Na(k,F,U,ze,Le,!0,!0,td,!1,oe)}else{const[ve,Le]=k.getStencilConfigForOverlapAndUpdateStencilID(Z);Na(k,F,U,Le,ve,!1,!0,td,!1,oe)}}(o,u,g,x,E):s.cj(g)?function(k,F,U,Z,K){const oe=U.paint.get("background-color"),re=U.paint.get("background-opacity");if(re===0)return;const{isRenderingToTexture:ce}=K,ve=k.context,Le=ve.gl,ze=k.style.projection,Ne=k.transform,Ge=Ne.tileSize,et=U.paint.get("background-pattern");if(k.isPatternMissing(et))return;const Xe=!et&&oe.a===1&&re===1&&k.opaquePassEnabledForLayer()?"opaque":"translucent";if(k.renderPass!==Xe)return;const at=sr.disabled,ht=k.getDepthModeForSublayer(0,Xe==="opaque"?vr.ReadWrite:vr.ReadOnly),Ye=k.colorModeForRenderPass(),pt=k.useProgram(et?"backgroundPattern":"background"),Pt=Z||$e(Ne,{tileSize:Ge,terrain:k.style.map.terrain});et&&(ve.activeTexture.set(Le.TEXTURE0),k.imageManager.bind(k.context));const Mt=U.getCrossfadeParameters();for(const Tt of Pt){const kt=Ne.getProjectionData({overscaledTileID:Tt,applyGlobeMatrix:!ce,applyTerrainMatrix:!0}),Mn=et?Ey(re,k,et,{tileID:Tt,tileSize:Ge},Mt):ec(re,oe),Sn=k.style.map.terrain&&k.style.map.terrain.getTerrainData(Tt),rn=ze.getMeshFromTileID(ve,Tt.canonical,!1,!0,"raster");pt.draw(ve,Le.TRIANGLES,ht,at,Ye,_r.backCCW,Mn,Sn,kt,U.id,rn.vertexBuffer,rn.indexBuffer,rn.segments)}}(o,0,g,x,E):s.ck(g)&&function(k,F,U,Z){const{isRenderingGlobe:K}=Z,oe=k.context,re=U.implementation,ce=k.style.projection,ve=k.transform,Le=ve.getProjectionDataForCustomLayer(K),ze={farZ:ve.farZ,nearZ:ve.nearZ,fov:ve.fov*Math.PI/180,modelViewProjectionMatrix:ve.modelViewProjectionMatrix,projectionMatrix:ve.projectionMatrix,shaderData:{variantName:ce.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ce.shaderPreludeCode.vertexSource}`,define:ce.shaderDefine},defaultProjectionData:Le},Ne=re.renderingMode?re.renderingMode:"2d";if(k.renderPass==="offscreen"){const Ge=re.prerender;Ge&&(k.setCustomLayerDefaults(),oe.setColorMode(k.colorModeForRenderPass()),Ge.call(re,oe.gl,ze),oe.setDirty(),k.setBaseState())}else if(k.renderPass==="translucent"){k.setCustomLayerDefaults(),oe.setColorMode(k.colorModeForRenderPass()),oe.setStencilMode(sr.disabled);const Ge=Ne==="3d"?k.getDepthModeFor3D():k.getDepthModeForSublayer(0,vr.ReadOnly);oe.setDepthMode(Ge),re.render(oe.gl,ze),oe.setDirty(),k.setBaseState(),oe.bindFramebuffer.set(null)}}(o,0,g,E))}saveTileTexture(o){const u=this._tileTextures[o.size[0]];u?u.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const u=this.imageManager.getPattern(o.from.toString()),g=this.imageManager.getPattern(o.to.toString());return!u||!g}useProgram(o,u,g=!1,x=[]){this.cache=this.cache||{};const E=!!this.style.map.terrain,k=this.style.projection,F=g?io.projectionMercator:k.shaderPreludeCode,U=g?Zl:k.shaderDefine,Z=o+(u?u.cacheKey:"")+`/${g?nf:k.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(E?"/terrain":"")+(x?`/${x.join("/")}`:"");return this.cache[Z]||(this.cache[Z]=new of(this.context,io[o],u,ug[o],this._showOverdrawInspector,E,F,U,x)),this.cache[Z]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:u}=this.context.gl;return this.width!==o||this.height!==u}}function Fu(C,o){let u,g=!1,x=null,E=null;const k=()=>{x=null,g&&(C.apply(E,u),x=setTimeout(k,o),g=!1)};return(...F)=>(g=!0,E=this,u=F,x||k(),x)}class rd{constructor(o){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let g;return u.split("&").map(x=>x.split("=")).forEach(x=>{x[0]===this._hashName&&(g=x)}),(g&&g[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const g=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:g,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const g=u.join("/");let x=g;x.split("&").length>0&&(x=x.split("&")[0]),this._hashName&&(x=`${this._hashName}=${g}`);let E=window.location.hash.replace(x,"");E.startsWith("#&")?E=E.slice(0,1)+E.slice(2):E==="#"&&(E="");let k=window.location.href.replace(/(#.+)?$/,E);k=k.replace("&&","&"),window.history.replaceState(window.history.state,null,k)},this._updateHash=Fu(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const u=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,x=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,x),k=Math.round(u.lng*E)/E,F=Math.round(u.lat*E)/E,U=this._map.getBearing(),Z=this._map.getPitch();let K="";if(K+=o?`/${k}/${F}/${g}`:`${g}/${F}/${k}`,(U||Z)&&(K+="/"+Math.round(10*U)/10),Z&&(K+=`/${Math.round(Z)}`),this._hashName){const oe=this._hashName;let re=!1;const ce=window.location.hash.slice(1).split("&").map(ve=>{const Le=ve.split("=")[0];return Le===oe?(re=!0,`${Le}=${K}`):ve}).filter(ve=>ve);return re||ce.push(`${oe}=${K}`),`#${ce.join("&")}`}return`#${K}`}_isValidHash(o){if(o.length<3||o.some(isNaN))return!1;try{new s.S(+o[2],+o[1])}catch{return!1}const u=+o[0],g=+(o[3]||0),x=+(o[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&g>=-180&&g<=180&&x>=this._map.getMinPitch()&&x<=this._map.getMaxPitch()}}const Nu={linearity:.3,easing:s.cl(0,0,.3,1)},ta=s.e({deceleration:2500,maxSpeed:1400},Nu),Xc=s.e({deceleration:20,maxSpeed:1400},Nu),Ba=s.e({deceleration:1e3,maxSpeed:360},Nu),Bu=s.e({deceleration:1e3,maxSpeed:90},Nu),gf=s.e({deceleration:1e3,maxSpeed:360},Nu);class Zc{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:S.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=S.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)u.zoom+=E.zoomDelta||0,u.bearing+=E.bearingDelta||0,u.pitch+=E.pitchDelta||0,u.roll+=E.rollDelta||0,E.panDelta&&u.pan._add(E.panDelta),E.around&&(u.around=E.around),E.pinchAround&&(u.pinchAround=E.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(u.pan.mag()){const E=ri(u.pan.mag(),g,s.e({},ta,o||{})),k=u.pan.mult(E.amount/u.pan.mag()),F=this._map.cameraHelper.handlePanInertia(k,this._map.transform);x.center=F.easingCenter,x.offset=F.easingOffset,ks(x,E)}if(u.zoom){const E=ri(u.zoom,g,Xc);x.zoom=this._map.transform.zoom+E.amount,ks(x,E)}if(u.bearing){const E=ri(u.bearing,g,Ba);x.bearing=this._map.transform.bearing+s.ag(E.amount,-179,179),ks(x,E)}if(u.pitch){const E=ri(u.pitch,g,Bu);x.pitch=this._map.transform.pitch+E.amount,ks(x,E)}if(u.roll){const E=ri(u.roll,g,gf);x.roll=this._map.transform.roll+s.ag(E.amount,-179,179),ks(x,E)}if(x.zoom||x.bearing){const E=u.pinchAround===void 0?u.around:u.pinchAround;x.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),s.e(x,{noMoveStart:!0})}}function ks(C,o){(!C.duration||C.duration<o.duration)&&(C.duration=o.duration,C.easing=o.easing)}function ri(C,o,u){const{maxSpeed:g,linearity:x,deceleration:E}=u,k=s.ag(C*x/(o/1e3),-g,g),F=Math.abs(k)/(E*x);return{easing:u.easing,duration:1e3*F,amount:k*(F/2)}}class Pr extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,g,x={}){g=g instanceof MouseEvent?g:new MouseEvent(o,g);const E=M.mousePos(u.getCanvas(),g),k=u.unproject(E);super(o,s.e({point:E,lngLat:k,originalEvent:g},x)),this._defaultPrevented=!1,this.target=u}}class po extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,g){const x=o==="touchend"?g.changedTouches:g.touches,E=M.touchPos(u.getCanvasContainer(),x),k=E.map(U=>u.unproject(U)),F=E.reduce((U,Z,K,oe)=>U.add(Z.div(oe.length)),new s.P(0,0));super(o,{points:E,point:F,lngLats:k,lngLat:u.unproject(F),originalEvent:g}),this._defaultPrevented=!1}}class mo extends s.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,g){super(o,{originalEvent:g}),this._defaultPrevented=!1}}class rs{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new mo(o.type,this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new Pr(o.type,this._map,o))}mouseup(o){this._map.fire(new Pr(o.type,this._map,o))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Pr(o.type,this._map,o))}dblclick(o){return this._firePreventable(new Pr(o.type,this._map,o))}mouseover(o){this._map.fire(new Pr(o.type,this._map,o))}mouseout(o){this._map.fire(new Pr(o.type,this._map,o))}touchstart(o){return this._firePreventable(new po(o.type,this._map,o))}touchmove(o){this._map.fire(new po(o.type,this._map,o))}touchend(o){this._map.fire(new po(o.type,this._map,o))}touchcancel(o){this._map.fire(new po(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class cc{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new Pr(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new Pr(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ga{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.screenPointToLocation(s.P.convert(o),this._map.terrain)}}class $o{constructor(o,u){this._map=o,this._tr=new ga(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&o.button===0&&(M.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const g=u;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=g,this._box||(this._box=M.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const E=Math.min(x.x,g.x),k=Math.max(x.x,g.x),F=Math.min(x.y,g.y),U=Math.max(x.y,g.y);M.setTransform(this._box,`translate(${E}px,${F}px)`),this._box.style.width=k-E+"px",this._box.style.height=U-F+"px"}mouseupWindow(o,u){if(!this._active||o.button!==0)return;const g=this._startPos,x=u;if(this.reset(),M.suppressClick(),g.x!==x.x||g.y!==x.y)return this._map.fire(new s.l("boxzoomend",{originalEvent:o})),{cameraAnimation:E=>E.fitScreenCoordinates(g,x,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(M.remove(this._box),this._box=null),M.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new s.l(o,{originalEvent:u}))}}function Yc(C,o){if(C.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${C.length}, points ${o.length}`);const u={};for(let g=0;g<C.length;g++)u[C[g].identifier]=o[g];return u}class Xp{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,u,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=o.timeStamp),g.length===this.numTouches&&(this.centroid=function(x){const E=new s.P(0,0);for(const k of x)E._add(k);return E.div(x.length)}(u),this.touches=Yc(g,u)))}touchmove(o,u,g){if(this.aborted||!this.centroid)return;const x=Yc(g,u);for(const E in this.touches){const k=x[E];(!k||k.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(o,u,g){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class id{constructor(o){this.singleTap=new Xp(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,u,g){this.singleTap.touchstart(o,u,g)}touchmove(o,u,g){this.singleTap.touchmove(o,u,g)}touchend(o,u,g){const x=this.singleTap.touchend(o,u,g);if(x){const E=o.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(x)<30;if(E&&k||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Kc{constructor(o){this._tr=new ga(o),this._zoomIn=new id({numTouches:1,numTaps:2}),this._zoomOut=new id({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,g){this._zoomIn.touchstart(o,u,g),this._zoomOut.touchstart(o,u,g)}touchmove(o,u,g){this._zoomIn.touchmove(o,u,g),this._zoomOut.touchmove(o,u,g)}touchend(o,u,g){const x=this._zoomIn.touchend(o,u,g),E=this._zoomOut.touchend(o,u,g),k=this._tr;return x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:k.zoom+1,around:k.unproject(x)},{originalEvent:o})}):E?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:k.zoom-1,around:k.unproject(E)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jc{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const u=this._moveFunction(...o);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(o,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,u){if(!this.isEnabled())return;const g=this._lastPoint;if(!g)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const x=Array.isArray(u)?u[0]:u;return!this._moved&&x.dist(g)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=x,this._move(g,x))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&M.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ki=0,ys=2,vf={[Ki]:1,[ys]:2};class Vo{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const u=M.mouseButton(o);this._eventButton=u}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(u,g){const x=vf[g];return u.buttons===void 0||(u.buttons&x)!==x}(o,this._eventButton)}isValidEndEvent(o){return M.mouseButton(o)===this._eventButton}}class Uu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return o.targetTouches.length===1}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}class uc{constructor(o=new Vo({checkCorrectEvent:()=>!0}),u=new Uu){this.mouseMoveStateManager=o,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(o,u,g){return o instanceof MouseEvent?u(o):typeof TouchEvent<"u"&&o instanceof TouchEvent?g(o):void 0}startMove(o){this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.startMove(u),u=>this.oneFingerTouchMoveStateManager.startMove(u))}endMove(o){this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.endMove(u),u=>this.oneFingerTouchMoveStateManager.endMove(u))}isValidStartEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidStartEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u))}isValidMoveEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidMoveEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u))}isValidEndEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidEndEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u))}}const ml=C=>{C.mousedown=C.dragStart,C.mousemoveWindow=C.dragMove,C.mouseup=C.dragEnd,C.contextmenu=o=>{o.preventDefault()}};class $u{constructor(o,u){this._clickTolerance=o.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,u,g){return this._calculateTransform(o,u,g)}touchmove(o,u,g){if(this._active){if(!this._shouldBePrevented(g.length))return o.preventDefault(),this._calculateTransform(o,u,g);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,u,g){this._calculateTransform(o,u,g),this._active&&this._shouldBePrevented(g.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,g){g.length>0&&(this._active=!0);const x=Yc(g,u),E=new s.P(0,0),k=new s.P(0,0);let F=0;for(const Z in x){const K=x[Z],oe=this._touches[Z];oe&&(E._add(K),k._add(K.sub(oe)),F++,x[Z]=K)}if(this._touches=x,this._shouldBePrevented(F)||!k.mag())return;const U=k.div(F);return this._sum._add(U),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(F),panDelta:U}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,u,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,g){if(!this._firstTwoTouches)return;o.preventDefault();const[x,E]=this._firstTwoTouches,k=hc(g,u,x),F=hc(g,u,E);if(!k||!F)return;const U=this._aroundCenter?null:k.add(F).div(2);return this._move([k,F],U,o)}touchend(o,u,g){if(!this._firstTwoTouches)return;const[x,E]=this._firstTwoTouches,k=hc(g,u,x),F=hc(g,u,E);k&&F||(this._active&&M.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function hc(C,o,u){for(let g=0;g<C.length;g++)if(C[g].identifier===u)return o[g]}function Ao(C,o){return Math.log(C/o)/Math.LN2}class Hi extends Vu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const g=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Ao(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ao(this._distance,g),pinchAround:u}}}function zn(C,o){return 180*C.angleWith(o)/Math.PI}class va extends Vu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u,g){const x=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zn(this._vector,x),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,g=zn(o,this._startVector);return Math.abs(g)<u}}function Ds(C){return Math.abs(C.y)>Math.abs(C.x)}class gl extends Vu{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,u,g){super.touchstart(o,u,g),this._currentTouchCount=g.length}_start(o){this._lastPoints=o,Ds(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,g){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const x=o[0].sub(this._lastPoints[0]),E=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(x,E,g.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(x.y+E.y)/2*-.5}):void 0}gestureBeginsVertically(o,u,g){if(this._valid!==void 0)return this._valid;const x=o.mag()>=2,E=u.mag()>=2;if(!x&&!E)return;if(!x||!E)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const k=o.y>0==u.y>0;return Ds(o)&&Ds(u)&&k}}const ju={panStep:100,bearingStep:15,pitchStep:10};class dc{constructor(o){this._tr=new ga(o);const u=ju;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,g=0,x=0,E=0,k=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?g=-1:(o.preventDefault(),E=-1);break;case 39:o.shiftKey?g=1:(o.preventDefault(),E=1);break;case 38:o.shiftKey?x=1:(o.preventDefault(),k=-1);break;case 40:o.shiftKey?x=-1:(o.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(g=0,x=0),{cameraAnimation:F=>{const U=this._tr;F.easeTo({duration:300,easeId:"keyboardHandler",easing:od,zoom:u?Math.round(U.zoom)+u*(o.shiftKey?2:1):U.zoom,bearing:U.bearing+g*this._bearingStep,pitch:U.pitch+x*this._pitchStep,offset:[-E*this._panStep,-k*this._panStep],center:U.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function od(C){return C*(2-C)}const dr=4.000244140625,is=1/450;class Mi{constructor(o,u){this._onTimeout=g=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(g)},this._map=o,this._tr=new ga(o),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=is}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let u=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const g=S.now(),x=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,u!==0&&u%dr==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(x*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=M.mousePos(this._map.getCanvas(),o),g=this._tr;this._aroundPoint=this._aroundCenter?g.transform.locationToScreenPoint(s.S.convert(g.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const F=o.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=F),typeof this._targetZoom=="number"&&(this._targetZoom+=F)}if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>dr?this._wheelZoomRate:this._defaultZoomRate;let U=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&U!==0&&(U=1/U);const Z=typeof this._targetZoom!="number"?o.scale:s.ae(this._targetZoom);this._targetZoom=o.getConstrained(o.getCameraLngLat(),s.aj(Z*U)).zoom,this._type==="wheel"&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?o.zoom:this._targetZoom,g=this._startZoom,x=this._easing;let E,k=!1;if(this._type==="wheel"&&g&&x){const F=S.now()-this._lastWheelEventTime,U=Math.min((F+5)/200,1),Z=x(U);E=s.C.number(g,u,Z),U<1?this._frameId||(this._frameId=!0):k=!0}else E=u,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=E,{noInertia:!0,needsRenderFrame:!k,zoomDelta:E-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=s.cn;if(this._prevEase){const g=this._prevEase,x=(S.now()-g.start)/g.duration,E=g.easing(x+.01)-g.easing(x),k=.27/Math.sqrt(E*E+1e-4)*.01,F=Math.sqrt(.0729-k*k);u=s.cl(k,F,.25,1)}return this._prevEase={start:S.now(),duration:o,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class _s{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _g{constructor(o){this._tr=new ga(o),this.reset()}reset(){this._active=!1}dblclick(o,u){return o.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xg{constructor(){this._tap=new id({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,u,g){if(!this._swipePoint)if(this._tapTime){const x=u[0],E=o.timeStamp-this._tapTime<500,k=this._tapPoint.dist(x)<30;E&&k?g.length>0&&(this._swipePoint=x,this._swipeTouch=g[0].identifier):this.reset()}else this._tap.touchstart(o,u,g)}touchmove(o,u,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const x=u[0],E=x.y-this._swipePoint.y;return this._swipePoint=x,o.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(o,u,g)}touchend(o,u,g){if(this._tapTime)this._swipePoint&&g.length===0&&this.reset();else{const x=this._tap.touchend(o,u,g);x&&(this._tapTime=o.timeStamp,this._tapPoint=x)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sd{constructor(o,u,g){this._el=o,this._mousePan=u,this._touchPan=g}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Hu{constructor(o,u,g,x){this._pitchWithRotate=o.pitchWithRotate,this._rollEnabled=o.rollEnabled,this._mouseRotate=u,this._mousePitch=g,this._mouseRoll=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class yf{constructor(o,u,g,x){this._el=o,this._touchZoom=u,this._touchRotate=g,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ad{constructor(o,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=o,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=M.create("div","maplibregl-cooperative-gesture-screen",o);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const g=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),x=document.createElement("div");x.className="maplibregl-desktop-message",x.textContent=u,this._container.appendChild(x);const E=document.createElement("div");E.className="maplibregl-mobile-message",E.textContent=g,this._container.appendChild(E),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(M.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,u){this._enabled&&(this._map.fire(new s.l("cooperativegestureprevented",{gestureType:o,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Gu=C=>C.zoom||C.drag||C.roll||C.pitch||C.rotate;class Wu extends s.l{}function ld(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta||C.rollDelta}class fc{constructor(o,u){this.handleWindowEvent=x=>{this.handleEvent(x,`${x.type}Window`)},this.handleEvent=(x,E)=>{if(x.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const k=x.type==="renderFrame"?void 0:x,F={needsRenderFrame:!1},U={},Z={};for(const{handlerName:re,handler:ce,allowed:ve}of this._handlers){if(!ce.isEnabled())continue;let Le;if(this._blockedByActive(Z,ve,re))ce.reset();else if(ce[E||x.type]){if(s.co(x,E||x.type)){const ze=M.mousePos(this._map.getCanvas(),x);Le=ce[E||x.type](x,ze)}else if(s.cp(x,E||x.type)){const ze=this._getMapTouches(x.touches),Ne=M.touchPos(this._map.getCanvas(),ze);Le=ce[E||x.type](x,Ne,ze)}else s.cq(E||x.type)||(Le=ce[E||x.type](x));this.mergeHandlerResult(F,U,Le,re,k),Le&&Le.needsRenderFrame&&this._triggerRenderFrame()}(Le||ce.isActive())&&(Z[re]=ce)}const K={};for(const re in this._previousActiveHandlers)Z[re]||(K[re]=k);this._previousActiveHandlers=Z,(Object.keys(K).length||ld(F))&&(this._changes.push([F,U,K]),this._triggerRenderFrame()),(Object.keys(Z).length||ld(F))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:oe}=F;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Zc(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,E,k]of this._listeners)M.addEventListener(x,E,x===document?this.handleWindowEvent:this.handleEvent,k)}destroy(){for(const[o,u,g]of this._listeners)M.removeEventListener(o,u,o===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(o){const u=this._map,g=u.getCanvasContainer();this._add("mapEvent",new rs(u,o));const x=u.boxZoom=new $o(u,o);this._add("boxZoom",x),o.interactive&&o.boxZoom&&x.enable();const E=u.cooperativeGestures=new ad(u,o.cooperativeGestures);this._add("cooperativeGestures",E),o.cooperativeGestures&&E.enable();const k=new Kc(u),F=new _g(u);u.doubleClickZoom=new _s(F,k),this._add("tapZoom",k),this._add("clickZoom",F),o.interactive&&o.doubleClickZoom&&u.doubleClickZoom.enable();const U=new xg;this._add("tapDragZoom",U);const Z=u.touchPitch=new gl(u);this._add("touchPitch",Z),o.interactive&&o.touchPitch&&u.touchPitch.enable(o.touchPitch);const K=()=>u.project(u.getCenter()),oe=function({enable:Xe,clickTolerance:at,aroundCenter:ht=!0,minPixelCenterThreshold:Ye=100,rotateDegreesPerPixelMoved:pt=.8},Pt){const Mt=new Vo({checkCorrectEvent:Tt=>M.mouseButton(Tt)===0&&Tt.ctrlKey||M.mouseButton(Tt)===2&&!Tt.ctrlKey});return new Jc({clickTolerance:at,move:(Tt,kt)=>{const Mn=Pt();if(ht&&Math.abs(Mn.y-Tt.y)>Ye)return{bearingDelta:s.cm(new s.P(Tt.x,kt.y),kt,Mn)};let Sn=(kt.x-Tt.x)*pt;return ht&&kt.y<Mn.y&&(Sn=-Sn),{bearingDelta:Sn}},moveStateManager:Mt,enable:Xe,assignEvents:ml})}(o,K),re=function({enable:Xe,clickTolerance:at,pitchDegreesPerPixelMoved:ht=-.5}){const Ye=new Vo({checkCorrectEvent:pt=>M.mouseButton(pt)===0&&pt.ctrlKey||M.mouseButton(pt)===2});return new Jc({clickTolerance:at,move:(pt,Pt)=>({pitchDelta:(Pt.y-pt.y)*ht}),moveStateManager:Ye,enable:Xe,assignEvents:ml})}(o),ce=function({enable:Xe,clickTolerance:at,rollDegreesPerPixelMoved:ht=.3},Ye){const pt=new Vo({checkCorrectEvent:Pt=>M.mouseButton(Pt)===2&&Pt.ctrlKey});return new Jc({clickTolerance:at,move:(Pt,Mt)=>{const Tt=Ye();let kt=(Mt.x-Pt.x)*ht;return Mt.y<Tt.y&&(kt=-kt),{rollDelta:kt}},moveStateManager:pt,enable:Xe,assignEvents:ml})}(o,K);u.dragRotate=new Hu(o,oe,re,ce),this._add("mouseRotate",oe,["mousePitch"]),this._add("mousePitch",re,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ce,["mousePitch"]),o.interactive&&o.dragRotate&&u.dragRotate.enable();const ve=function({enable:Xe,clickTolerance:at}){const ht=new Vo({checkCorrectEvent:Ye=>M.mouseButton(Ye)===0&&!Ye.ctrlKey});return new Jc({clickTolerance:at,move:(Ye,pt)=>({around:pt,panDelta:pt.sub(Ye)}),activateOnStart:!0,moveStateManager:ht,enable:Xe,assignEvents:ml})}(o),Le=new $u(o,u);u.dragPan=new sd(g,ve,Le),this._add("mousePan",ve),this._add("touchPan",Le,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&u.dragPan.enable(o.dragPan);const ze=new va,Ne=new Hi;u.touchZoomRotate=new yf(g,Ne,ze,U),this._add("touchRotate",ze,["touchPan","touchZoom"]),this._add("touchZoom",Ne,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&u.touchZoomRotate.enable(o.touchZoomRotate);const Ge=u.scrollZoom=new Mi(u,()=>this._triggerRenderFrame());this._add("scrollZoom",Ge,["mousePan"]),o.interactive&&o.scrollZoom&&u.scrollZoom.enable(o.scrollZoom);const et=u.keyboard=new dc(u);this._add("keyboard",et),o.interactive&&o.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new cc(u))}_add(o,u,g){this._handlers.push({handlerName:o,handler:u,allowed:g}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Gu(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,u,g){for(const x in o)if(x!==g&&(!u||u.indexOf(x)<0))return!0;return!1}_getMapTouches(o){const u=[];for(const g of o)this._el.contains(g.target)&&u.push(g);return u}mergeHandlerResult(o,u,g,x,E){if(!g)return;s.e(o,g);const k={handlerName:x,originalEvent:g.originalEvent||E};g.zoomDelta!==void 0&&(u.zoom=k),g.panDelta!==void 0&&(u.drag=k),g.rollDelta!==void 0&&(u.roll=k),g.pitchDelta!==void 0&&(u.pitch=k),g.bearingDelta!==void 0&&(u.rotate=k)}_applyChanges(){const o={},u={},g={};for(const[x,E,k]of this._changes)x.panDelta&&(o.panDelta=(o.panDelta||new s.P(0,0))._add(x.panDelta)),x.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+x.pitchDelta),x.rollDelta&&(o.rollDelta=(o.rollDelta||0)+x.rollDelta),x.around!==void 0&&(o.around=x.around),x.pinchAround!==void 0&&(o.pinchAround=x.pinchAround),x.noInertia&&(o.noInertia=x.noInertia),s.e(u,E),s.e(g,k);this._updateMapTransform(o,u,g),this._changes=[]}_updateMapTransform(o,u,g){const x=this._map,E=x._getTransformForUpdate(),k=x.terrain;if(!(ld(o)||k&&this._terrainMovement))return this._fireEvents(u,g,!0);x._stop(!0);let{panDelta:F,zoomDelta:U,bearingDelta:Z,pitchDelta:K,rollDelta:oe,around:re,pinchAround:ce}=o;ce!==void 0&&(re=ce),re=re||x.transform.centerPoint,k&&!E.isPointOnMapSurface(re)&&(re=E.centerPoint);const ve={panDelta:F,zoomDelta:U,rollDelta:oe,pitchDelta:K,bearingDelta:Z,around:re};this._map.cameraHelper.useGlobeControls&&!E.isPointOnMapSurface(re)&&(re=E.centerPoint);const Le=re.distSqr(E.centerPoint)<.01?E.center:E.screenPointToLocation(F?re.sub(F):re);k?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ve,E),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?E.setCenter(E.screenPointToLocation(E.centerPoint.sub(F))):this._map.cameraHelper.handleMapControlsPan(ve,E,Le):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ve,E,Le))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ve,E),this._map.cameraHelper.handleMapControlsPan(ve,E,Le)),x._applyUpdatedTransform(E),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,g,!0)}_fireEvents(o,u,g){const x=Gu(this._eventsInProgress),E=Gu(o),k={};for(const oe in o){const{originalEvent:re}=o[oe];this._eventsInProgress[oe]||(k[`${oe}start`]=re),this._eventsInProgress[oe]=o[oe]}!x&&E&&this._fireEvent("movestart",E.originalEvent);for(const oe in k)this._fireEvent(oe,k[oe]);E&&this._fireEvent("move",E.originalEvent);for(const oe in o){const{originalEvent:re}=o[oe];this._fireEvent(oe,re)}const F={};let U;for(const oe in this._eventsInProgress){const{handlerName:re,originalEvent:ce}=this._eventsInProgress[oe];this._handlersById[re].isActive()||(delete this._eventsInProgress[oe],U=u[re]||ce,F[`${oe}end`]=U)}for(const oe in F)this._fireEvent(oe,F[oe]);const Z=Gu(this._eventsInProgress),K=(x||E)&&!Z;if(K&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const oe=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&oe.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(oe)}if(g&&K){this._updatingCamera=!0;const oe=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=ce=>ce!==0&&-this._bearingSnap<ce&&ce<this._bearingSnap;!oe||!oe.essential&&S.prefersReducedMotion?(this._map.fire(new s.l("moveend",{originalEvent:U})),re(this._map.getBearing())&&this._map.resetNorth()):(re(oe.bearing||this._map.getBearing())&&(oe.bearing=0),oe.freezeElevation=!0,this._map.easeTo(oe,{originalEvent:U})),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new s.l(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Wu("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class si extends s.E{constructor(o,u,g){super(),this._renderFrameCallback=()=>{const x=Math.min((S.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(x)),x<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=g.bearingSnap,this.cameraHelper=u,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(o,u){o.apply(this.transform),this.transform=o,this.cameraHelper=u}getCenter(){return new s.S(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(o,u){return this.jumpTo({elevation:o},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(o){this._centerClampedToGround=o}panBy(o,u,g){return o=s.P.convert(o).mult(-1),this.panTo(this.transform.center,s.e({offset:o},u),g)}panTo(o,u,g){return this.easeTo(s.e({center:o},u),g)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,g){return this.easeTo(s.e({zoom:o},u),g)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(o,u){return o!=this.transform.fov&&(this.transform.setFov(o),this.fire(new s.l("movestart",u)).fire(new s.l("move",u)).fire(new s.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,g){return this.easeTo(s.e({bearing:o},u),g)}resetNorth(o,u){return this.rotateTo(0,s.e({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(s.e({bearing:0,pitch:0,roll:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}getRoll(){return this.transform.roll}setRoll(o,u){return this.jumpTo({roll:o},u),this}cameraForBounds(o,u){o=tn.convert(o).adjustAntiMeridian();const g=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),g,u)}_cameraForBoxAndBearing(o,u,g,x){const E={top:0,bottom:0,right:0,left:0};if(typeof(x=s.e({padding:E,offset:[0,0],maxZoom:this.transform.maxZoom},x)).padding=="number"){const Z=x.padding;x.padding={top:Z,bottom:Z,right:Z,left:Z}}const k=s.e(E,x.padding);x.padding=k;const F=this.transform,U=new tn(o,u);return this.cameraHelper.cameraForBoxAndBearing(x,k,U,g,F)}fitBounds(o,u,g){return this._fitInternal(this.cameraForBounds(o,u),u,g)}fitScreenCoordinates(o,u,g,x,E){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(s.P.convert(o)),this.transform.screenPointToLocation(s.P.convert(u)),g,x),x,E)}_fitInternal(o,u,g){return o?(delete(u=s.e(o,u)).padding,u.linear?this.easeTo(u,g):this.flyTo(u,g)):this}jumpTo(o,u){this.stop();const g=this._getTransformForUpdate();let x=!1,E=!1,k=!1;const F=g.zoom;this.cameraHelper.handleJumpToCenterZoom(g,o);const U=g.zoom!==F;return"elevation"in o&&g.elevation!==+o.elevation&&g.setElevation(+o.elevation),"bearing"in o&&g.bearing!==+o.bearing&&(x=!0,g.setBearing(+o.bearing)),"pitch"in o&&g.pitch!==+o.pitch&&(E=!0,g.setPitch(+o.pitch)),"roll"in o&&g.roll!==+o.roll&&(k=!0,g.setRoll(+o.roll)),o.padding==null||g.isPaddingEqual(o.padding)||g.setPadding(o.padding),this._applyUpdatedTransform(g),this.fire(new s.l("movestart",u)).fire(new s.l("move",u)),U&&this.fire(new s.l("zoomstart",u)).fire(new s.l("zoom",u)).fire(new s.l("zoomend",u)),x&&this.fire(new s.l("rotatestart",u)).fire(new s.l("rotate",u)).fire(new s.l("rotateend",u)),E&&this.fire(new s.l("pitchstart",u)).fire(new s.l("pitch",u)).fire(new s.l("pitchend",u)),k&&this.fire(new s.l("rollstart",u)).fire(new s.l("roll",u)).fire(new s.l("rollend",u)),this.fire(new s.l("moveend",u))}calculateCameraOptionsFromTo(o,u,g,x=0){const E=s.a0.fromLngLat(o,u),k=s.a0.fromLngLat(g,x),F=k.x-E.x,U=k.y-E.y,Z=k.z-E.z,K=Math.hypot(F,U,Z);if(K===0)throw new Error("Can't calculate camera options with same From and To");const oe=Math.hypot(F,U),re=s.aj(this.transform.cameraToCenterDistance/K/this.transform.tileSize),ce=180*Math.atan2(F,-U)/Math.PI;let ve=180*Math.acos(oe/K)/Math.PI;return ve=Z<0?90-ve:90+ve,{center:k.toLngLat(),elevation:x,zoom:re,pitch:ve,bearing:ce}}calculateCameraOptionsFromCameraLngLatAltRotation(o,u,g,x,E){const k=this.transform.calculateCenterFromCameraLngLatAlt(o,u,g,x);return{center:k.center,elevation:k.elevation,zoom:k.zoom,bearing:g,pitch:x,roll:E}}easeTo(o,u){this._stop(!1,o.easeId),((o=s.e({offset:[0,0],duration:500,easing:s.cn},o)).animate===!1||!o.essential&&S.prefersReducedMotion)&&(o.duration=0);const g=this._getTransformForUpdate(),x=this.getBearing(),E=g.pitch,k=g.roll,F="bearing"in o?this._normalizeBearing(o.bearing,x):x,U="pitch"in o?+o.pitch:E,Z="roll"in o?this._normalizeBearing(o.roll,k):k,K="padding"in o?o.padding:g.padding,oe=s.P.convert(o.offset);let re,ce;o.around&&(re=s.S.convert(o.around),ce=g.locationToScreenPoint(re));const ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Le=this.cameraHelper.handleEaseTo(g,{bearing:F,pitch:U,roll:Z,padding:K,around:re,aroundPoint:ce,offsetAsPoint:oe,offset:o.offset,zoom:o.zoom,center:o.center});return this._rotating=this._rotating||x!==F,this._pitching=this._pitching||U!==E,this._rolling=this._rolling||Z!==k,this._padding=!g.isPaddingEqual(K),this._zooming=this._zooming||Le.isZooming,this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,ve),this.terrain&&this._prepareElevation(Le.elevationCenter),this._ease(ze=>{Le.easeFunc(ze),this.terrain&&!o.freezeElevation&&this._updateElevation(ze),this._applyUpdatedTransform(g),this._fireMoveEvents(u)},ze=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(u,ze)},o),this}_prepareEase(o,u,g={}){this._moving=!0,u||g.moving||this.fire(new s.l("movestart",o)),this._zooming&&!g.zooming&&this.fire(new s.l("zoomstart",o)),this._rotating&&!g.rotating&&this.fire(new s.l("rotatestart",o)),this._pitching&&!g.pitching&&this.fire(new s.l("pitchstart",o)),this._rolling&&!g.rolling&&this.fire(new s.l("rollstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&u!==this._elevationTarget){const g=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(g-(u-(g*o+this._elevationStart))/(1-o)),this._elevationTarget=u}this.transform.setElevation(s.C.number(this._elevationStart,this._elevationTarget,o))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){if(!this.terrain&&o.elevation>=0&&o.pitch<=90)return{};const u=o.getCameraLngLat(),g=o.getCameraAltitude(),x=this.terrain?this.terrain.getElevationForLngLatZoom(u,o.zoom):0;if(g<x){const E=this.calculateCameraOptionsFromTo(u,x,o.center,o.elevation);return{pitch:E.pitch,zoom:E.zoom}}return{}}_applyUpdatedTransform(o){const u=[];if(u.push(x=>this._elevateCameraIfInsideTerrain(x)),this.transformCameraUpdate&&u.push(x=>this.transformCameraUpdate(x)),!u.length)return;const g=o.clone();for(const x of u){const E=g.clone(),{center:k,zoom:F,roll:U,pitch:Z,bearing:K,elevation:oe}=x(E);k&&E.setCenter(k),oe!==void 0&&E.setElevation(oe),F!==void 0&&E.setZoom(F),U!==void 0&&E.setRoll(U),Z!==void 0&&E.setPitch(Z),K!==void 0&&E.setBearing(K),g.apply(E)}this.transform.apply(g)}_fireMoveEvents(o){this.fire(new s.l("move",o)),this._zooming&&this.fire(new s.l("zoom",o)),this._rotating&&this.fire(new s.l("rotate",o)),this._pitching&&this.fire(new s.l("pitch",o)),this._rolling&&this.fire(new s.l("roll",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const g=this._zooming,x=this._rotating,E=this._pitching,k=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,g&&this.fire(new s.l("zoomend",o)),x&&this.fire(new s.l("rotateend",o)),E&&this.fire(new s.l("pitchend",o)),k&&this.fire(new s.l("rollend",o)),this.fire(new s.l("moveend",o))}flyTo(o,u){if(!o.essential&&S.prefersReducedMotion){const kt=s.Q(o,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(kt,u)}this.stop(),o=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.cn},o);const g=this._getTransformForUpdate(),x=g.bearing,E=g.pitch,k=g.roll,F=g.padding,U="bearing"in o?this._normalizeBearing(o.bearing,x):x,Z="pitch"in o?+o.pitch:E,K="roll"in o?this._normalizeBearing(o.roll,k):k,oe="padding"in o?o.padding:g.padding,re=s.P.convert(o.offset);let ce=g.centerPoint.add(re);const ve=g.screenPointToLocation(ce),Le=this.cameraHelper.handleFlyTo(g,{bearing:U,pitch:Z,roll:K,padding:oe,locationAtOffset:ve,offsetAsPoint:re,center:o.center,minZoom:o.minZoom,zoom:o.zoom});let ze=o.curve;const Ne=Math.max(g.width,g.height),Ge=Ne/Le.scaleOfZoom,et=Le.pixelPathLength;typeof Le.scaleOfMinZoom=="number"&&(ze=Math.sqrt(Ne/Le.scaleOfMinZoom/et*2));const Xe=ze*ze;function at(kt){const Mn=(Ge*Ge-Ne*Ne+(kt?-1:1)*Xe*Xe*et*et)/(2*(kt?Ge:Ne)*Xe*et);return Math.log(Math.sqrt(Mn*Mn+1)-Mn)}function ht(kt){return(Math.exp(kt)-Math.exp(-kt))/2}function Ye(kt){return(Math.exp(kt)+Math.exp(-kt))/2}const pt=at(!1);let Pt=function(kt){return Ye(pt)/Ye(pt+ze*kt)},Mt=function(kt){return Ne*((Ye(pt)*(ht(Mn=pt+ze*kt)/Ye(Mn))-ht(pt))/Xe)/et;var Mn},Tt=(at(!0)-pt)/ze;if(Math.abs(et)<2e-6||!isFinite(Tt)){if(Math.abs(Ne-Ge)<1e-6)return this.easeTo(o,u);const kt=Ge<Ne?-1:1;Tt=Math.abs(Math.log(Ge/Ne))/ze,Mt=()=>0,Pt=Mn=>Math.exp(kt*ze*Mn)}return o.duration="duration"in o?+o.duration:1e3*Tt/("screenSpeed"in o?+o.screenSpeed/ze:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=x!==U,this._pitching=Z!==E,this._rolling=K!==k,this._padding=!g.isPaddingEqual(oe),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(Le.targetCenter),this._ease(kt=>{const Mn=kt*Tt,Sn=1/Pt(Mn),rn=Mt(Mn);this._rotating&&g.setBearing(s.C.number(x,U,kt)),this._pitching&&g.setPitch(s.C.number(E,Z,kt)),this._rolling&&g.setRoll(s.C.number(k,K,kt)),this._padding&&(g.interpolatePadding(F,oe,kt),ce=g.centerPoint.add(re)),Le.easeFunc(kt,Sn,rn,ce),this.terrain&&!o.freezeElevation&&this._updateElevation(kt),this._applyUpdatedTransform(g),this._fireMoveEvents(u)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,u){var g;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const x=this._onEaseEnd;delete this._onEaseEnd,x.call(this,u)}return o||(g=this.handlers)===null||g===void 0||g.stop(!1),this}_ease(o,u,g){g.animate===!1||g.duration===0?(o(1),u()):(this._easeStart=S.now(),this._easeOptions=g,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,u){o=s.aN(o,-180,180);const g=Math.abs(o-u);return Math.abs(o-360-u)<g&&(o-=360),Math.abs(o+360-u)<g&&(o+=360),o}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(s.S.convert(o),this.transform.tileZoom):null}}const pc={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class cd{constructor(o=pc){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=M.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=M.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=M.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){M.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,u){const g=this._map._getUIString(`AttributionControl.${u}`);o.title=g,o.setAttribute("aria-label",g)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(x=>typeof x!="string"?"":x)):typeof this.options.customAttribution=="string"&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const u=this._map.style.sourceCaches;for(const x in u){const E=u[x];if(E.used||E.usedForTerrain){const k=E.getSource();k.attribution&&o.indexOf(k.attribution)<0&&o.push(k.attribution)}}o=o.filter(x=>String(x).trim()),o.sort((x,E)=>x.length-E.length),o=o.filter((x,E)=>{for(let k=E+1;k<o.length;k++)if(o[k].indexOf(x)>=0)return!1;return!0});const g=o.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,o.length?(this._innerContainer.innerHTML=M.sanitize(g),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class _f{constructor(o={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const g=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&g.classList.add("maplibregl-compact"):g.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=M.create("div","maplibregl-ctrl");const u=M.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){M.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Qc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,g=u?this._queue.concat(u):this._queue;for(const x of g)if(x.id===o)return void(x.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const g of u)if(!g.cancelled&&(g.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Zp=s.aI([{name:"a_pos3d",type:"Int16",components:3}]);class xf extends s.E{constructor(o){super(),this._lastTilesetChange=S.now(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=o._source.tileSize*2**this.deltaZoom,o.usedForTerrain=!0,o.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,u){this.sourceCache.update(o,u),this._renderableTilesKeys=[];const g={};for(const x of $e(o,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))g[x.key]=!0,this._renderableTilesKeys.push(x.key),this._tiles[x.key]||(x.terrainRttPosMatrix32f=new Float64Array(16),s.bX(x.terrainRttPosMatrix32f,0,s.$,s.$,0,0,1),this._tiles[x.key]=new Gt(x,this.tileSize),this._lastTilesetChange=S.now());for(const x in this._tiles)g[x]||delete this._tiles[x]}freeRtt(o){for(const u in this._tiles){const g=this._tiles[u];(!o||g.tileID.equals(o)||g.tileID.isChildOf(o)||o.isChildOf(g.tileID))&&(g.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o,u){return u?this._getTerrainCoordsForTileRanges(o,u):this._getTerrainCoordsForRegularTile(o)}_getTerrainCoordsForRegularTile(o){const u={};for(const g of this._renderableTilesKeys){const x=this._tiles[g].tileID,E=o.clone(),k=s.b9();if(x.canonical.equals(o.canonical))s.bX(k,0,s.$,s.$,0,0,1);else if(x.canonical.isChildOf(o.canonical)){const F=x.canonical.z-o.canonical.z,U=x.canonical.x-(x.canonical.x>>F<<F),Z=x.canonical.y-(x.canonical.y>>F<<F),K=s.$>>F;s.bX(k,0,K,K,0,0,1),s.M(k,k,[-U*K,-Z*K,0])}else{if(!o.canonical.isChildOf(x.canonical))continue;{const F=o.canonical.z-x.canonical.z,U=o.canonical.x-(o.canonical.x>>F<<F),Z=o.canonical.y-(o.canonical.y>>F<<F),K=s.$>>F;s.bX(k,0,s.$,s.$,0,0,1),s.M(k,k,[U*K,Z*K,0]),s.N(k,k,[1/2**F,1/2**F,0])}}E.terrainRttPosMatrix32f=new Float32Array(k),u[g]=E}return u}_getTerrainCoordsForTileRanges(o,u){const g={};for(const x of this._renderableTilesKeys){const E=this._tiles[x].tileID;if(!this._isWithinTileRanges(E,u))continue;const k=o.clone(),F=s.b9();if(E.canonical.z===o.canonical.z){const U=o.canonical.x-E.canonical.x,Z=o.canonical.y-E.canonical.y;s.bX(F,0,s.$,s.$,0,0,1),s.M(F,F,[U*s.$,Z*s.$,0])}else if(E.canonical.z>o.canonical.z){const U=E.canonical.z-o.canonical.z,Z=E.canonical.x-(E.canonical.x>>U<<U),K=E.canonical.y-(E.canonical.y>>U<<U),oe=o.canonical.x-(E.canonical.x>>U),re=o.canonical.y-(E.canonical.y>>U),ce=s.$>>U;s.bX(F,0,ce,ce,0,0,1),s.M(F,F,[-Z*ce+oe*s.$,-K*ce+re*s.$,0])}else{const U=o.canonical.z-E.canonical.z,Z=o.canonical.x-(o.canonical.x>>U<<U),K=o.canonical.y-(o.canonical.y>>U<<U),oe=(o.canonical.x>>U)-E.canonical.x,re=(o.canonical.y>>U)-E.canonical.y,ce=s.$<<U;s.bX(F,0,ce,ce,0,0,1),s.M(F,F,[Z*s.$+oe*ce,K*s.$+re*ce,0])}k.terrainRttPosMatrix32f=new Float32Array(F),g[x]=k}return g}getSourceTile(o,u){const g=this.sourceCache._source;let x=o.overscaledZ-this.deltaZoom;if(x>g.maxzoom&&(x=g.maxzoom),x<g.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(x).key);let E=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!E||!E.dem)&&u)for(;x>=g.minzoom&&(!E||!E.dem);)E=this.sourceCache.getTileByID(o.scaledTo(x--).key);return E}anyTilesAfterTime(o=Date.now()){return this._lastTilesetChange>=o}_isWithinTileRanges(o,u){return u[o.canonical.z]&&o.canonical.x>=u[o.canonical.z].minTileX&&o.canonical.x<=u[o.canonical.z].maxTileX&&o.canonical.y>=u[o.canonical.z].minTileY&&o.canonical.y<=u[o.canonical.z].maxTileY}}class zs{constructor(o,u,g){this._meshCache={},this.painter=o,this.sourceCache=new xf(u),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,u,g,x=s.$){var E;if(!(u>=0&&u<x&&g>=0&&g<x))return 0;const k=this.getTerrainData(o),F=(E=k.tile)===null||E===void 0?void 0:E.dem;if(!F)return 0;const U=s.cr([],[u/x*s.$,g/x*s.$],k.u_terrain_matrix),Z=[U[0]*F.dim,U[1]*F.dim],K=Math.floor(Z[0]),oe=Math.floor(Z[1]),re=Z[0]-K,ce=Z[1]-oe;return F.get(K,oe)*(1-re)*(1-ce)+F.get(K+1,oe)*re*(1-ce)+F.get(K,oe+1)*(1-re)*ce+F.get(K+1,oe+1)*re*ce}getElevationForLngLatZoom(o,u){if(!s.cs(u,o.wrap()))return 0;const{tileID:g,mercatorX:x,mercatorY:E}=this._getOverscaledTileIDFromLngLatZoom(o,u);return this.getElevation(g,x%s.$,E%s.$,s.$)}getElevation(o,u,g,x=s.$){return this.getDEMElevation(o,u,g,x)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const x=this.painter.context,E=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new s.T(x,E,x.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new s.T(x,new s.R({width:1,height:1}),x.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.af([])}const u=this.sourceCache.getSourceTile(o,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const x=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new s.T(x,u.dem.getPixels(),x.gl.RGBA,{premultiply:!1}),u.demTexture.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const g=u&&u+u.tileID.key+o.key;if(g&&!this._demMatrixCache[g]){const x=this.sourceCache.sourceCache._source.maxzoom;let E=o.canonical.z-u.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=x?E=o.canonical.z-x:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const k=o.canonical.x-(o.canonical.x>>E<<E),F=o.canonical.y-(o.canonical.y>>E<<E),U=s.ct(new Float64Array(16),[1/(s.$<<E),1/(s.$<<E),0]);s.M(U,U,[k*s.$,F*s.$,0]),this._demMatrixCache[o.key]={matrix:U,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(o){const u=this.painter,g=u.width/devicePixelRatio,x=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===x||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new s.T(u.context,{width:g,height:x,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new s.T(u.context,{width:g,height:x,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(g,x,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,g,x))),this._fbo.colorAttachment.set(o==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let E=0,k=0;E<this._coordsTextureSize;E++)for(let F=0;F<this._coordsTextureSize;F++,k+=4)u[k+0]=255&F,u[k+1]=255&E,u[k+2]=F>>8<<4|E>>8,u[k+3]=0;const g=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),x=new s.T(o,g,o.gl.RGBA,{premultiply:!1});return x.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=x,x}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),g=this.painter.context,x=g.gl,E=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),k=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),F=Math.round(this.painter.height/devicePixelRatio);g.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),x.readPixels(E,F-k-1,1,1,x.RGBA,x.UNSIGNED_BYTE,u),g.bindFramebuffer.set(null);const U=u[0]+(u[2]>>4<<8),Z=u[1]+((15&u[2])<<8),K=this.coordsIndex[255-u[3]],oe=K&&this.sourceCache.getTileByID(K);if(!oe)return null;const re=this._coordsTextureSize,ce=(1<<oe.tileID.canonical.z)*re;return new s.a0((oe.tileID.canonical.x*re+U)/ce+oe.tileID.wrap,(oe.tileID.canonical.y*re+Z)/ce,this.getElevation(oe.tileID,U,Z,re))}depthAtPoint(o){const u=new Uint8Array(4),g=this.painter.context,x=g.gl;return g.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),x.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,x.RGBA,x.UNSIGNED_BYTE,u),g.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(o){var u;const g=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,x=g&&o.canonical.y===0,E=g&&o.canonical.y===(1<<o.canonical.z)-1,k=`m_${x?"n":""}_${E?"s":""}`;if(this._meshCache[k])return this._meshCache[k];const F=this.painter.context,U=new s.cu,Z=new s.aM,K=this.meshSize,oe=s.$/K,re=K*K;for(let Ye=0;Ye<=K;Ye++)for(let pt=0;pt<=K;pt++)U.emplaceBack(pt*oe,Ye*oe,0);for(let Ye=0;Ye<re;Ye+=K+1)for(let pt=0;pt<K;pt++)Z.emplaceBack(pt+Ye,K+pt+Ye+1,K+pt+Ye+2),Z.emplaceBack(pt+Ye,K+pt+Ye+2,pt+Ye+1);const ce=U.length,ve=ce+(K+1),Le=(K+1)*K,ze=x?s.bg:0,Ne=x?0:1,Ge=E?s.bh:s.$,et=E?0:1;for(let Ye=0;Ye<=K;Ye++)U.emplaceBack(Ye*oe,ze,Ne);for(let Ye=0;Ye<=K;Ye++)U.emplaceBack(Ye*oe,Ge,et);for(let Ye=0;Ye<K;Ye++)Z.emplaceBack(Le+Ye,ve+Ye,ve+Ye+1),Z.emplaceBack(Le+Ye,ve+Ye+1,Le+Ye+1),Z.emplaceBack(0+Ye,ce+Ye+1,ce+Ye),Z.emplaceBack(0+Ye,0+Ye+1,ce+Ye+1);const Xe=U.length,at=Xe+2*(K+1);for(const Ye of[0,1])for(let pt=0;pt<=K;pt++)for(const Pt of[0,1])U.emplaceBack(Ye*s.$,pt*oe,Pt);for(let Ye=0;Ye<2*K;Ye+=2)Z.emplaceBack(Xe+Ye,Xe+Ye+1,Xe+Ye+3),Z.emplaceBack(Xe+Ye,Xe+Ye+3,Xe+Ye+2),Z.emplaceBack(at+Ye,at+Ye+3,at+Ye+1),Z.emplaceBack(at+Ye,at+Ye+2,at+Ye+3);const ht=new ha(F.createVertexBuffer(U,Zp.members),F.createIndexBuffer(Z),s.aL.simpleSegment(0,0,U.length,Z.length));return this._meshCache[k]=ht,ht}getMeshFrameDelta(o){return 2*Math.PI*s.bt/Math.pow(2,Math.max(o,0))/5}getMinTileElevationForLngLatZoom(o,u){var g;const{tileID:x}=this._getOverscaledTileIDFromLngLatZoom(o,u);return(g=this.getMinMaxElevation(x).minElevation)!==null&&g!==void 0?g:0}getMinMaxElevation(o){const u=this.getTerrainData(o).tile,g={minElevation:null,maxElevation:null};return u&&u.dem&&(g.minElevation=u.dem.min*this.exaggeration,g.maxElevation=u.dem.max*this.exaggeration),g}_getOverscaledTileIDFromLngLatZoom(o,u){const g=s.a0.fromLngLat(o.wrap()),x=(1<<u)*s.$,E=g.x*x,k=g.y*x,F=Math.floor(E/s.$),U=Math.floor(k/s.$);return{tileID:new s.Z(u,0,u,F,U),mercatorX:E,mercatorY:k}}}class vl{constructor(o,u,g){this._context=o,this._size=u,this._tileSize=g,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),g=new s.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return g.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(g.texture),{id:o,fbo:u,texture:g,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>o.id!==u),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(o=>!o.inUse)===!1}}const $n={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class ar{constructor(o,u){this.painter=o,this.terrain=u,this.pool=new vl(o.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(g=>!o._layers[g].isHidden(u)),this._coordsAscending={};for(const g in o.sourceCaches){this._coordsAscending[g]={};const x=o.sourceCaches[g].getVisibleCoordinates(),E=o.sourceCaches[g].getSource(),k=E instanceof On?E.terrainTileRanges:null;for(const F of x){const U=this.terrain.sourceCache.getTerrainCoords(F,k);for(const Z in U)this._coordsAscending[g][Z]||(this._coordsAscending[g][Z]=[]),this._coordsAscending[g][Z].push(U[Z])}}this._coordsAscendingStr={};for(const g of o._order){const x=o._layers[g],E=x.source;if($n[x.type]&&!this._coordsAscendingStr[E]){this._coordsAscendingStr[E]={};for(const k in this._coordsAscending[E])this._coordsAscendingStr[E][k]=this._coordsAscending[E][k].map(F=>F.key).sort().join()}}for(const g of this._renderableTiles)for(const x in this._coordsAscendingStr){const E=this._coordsAscendingStr[x][g.tileID.key];E&&E!==g.rttCoords[x]&&(g.rtt=[])}}renderLayer(o,u){if(o.isHidden(this.painter.transform.zoom))return!1;const g=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),x=o.type,E=this.painter,k=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if($n[x]&&(this._prevType&&$n[this._prevType]||this._stacks.push([]),this._prevType=x,this._stacks[this._stacks.length-1].push(o.id),!k))return!0;if($n[this._prevType]||$n[x]&&k){this._prevType=x;const F=this._stacks.length-1,U=this._stacks[F]||[];for(const Z of this._renderableTiles){if(this.pool.isFull()&&(Yr(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(Z),Z.rtt[F]){const oe=this.pool.getObjectForId(Z.rtt[F].id);if(oe.stamp===Z.rtt[F].stamp){this.pool.useObject(oe);continue}}const K=this.pool.getOrCreateFreeObject();this.pool.useObject(K),this.pool.stampObject(K),Z.rtt[F]={id:K.id,stamp:K.stamp},E.context.bindFramebuffer.set(K.fbo.framebuffer),E.context.clear({color:s.be.transparent,stencil:0}),E.currentStencilSource=void 0;for(let oe=0;oe<U.length;oe++){const re=E.style._layers[U[oe]],ce=re.source?this._coordsAscending[re.source][Z.tileID.key]:[Z.tileID];E.context.viewport.set([0,0,K.fbo.width,K.fbo.height]),E._renderTileClippingMasks(re,ce,!0),E.renderLayer(E,E.style.sourceCaches[re.source],re,ce,g),re.source&&(Z.rttCoords[re.source]=this._coordsAscendingStr[re.source][Z.tileID.key])}}return Yr(this.painter,this.terrain,this._rttTiles,g),this._rttTiles=[],this.pool.freeAllObjects(),$n[x]}return!1}}const qu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ud=p,Ua={hash:!1,interactive:!0,bearingSnap:7,attributionControl:pc,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},vi={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class mc{constructor(o,u,g=!1){this.mousedown=E=>{this.startMove(E,M.mousePos(this.element,E)),M.addEventListener(window,"mousemove",this.mousemove),M.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=E=>{this.move(E,M.mousePos(this.element,E))},this.mouseup=E=>{this._rotatePitchHanlder.dragEnd(E),this.offTemp()},this.touchstart=E=>{E.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=M.touchPos(this.element,E.targetTouches)[0],this.startMove(E,this._startPos),M.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),M.addEventListener(window,"touchend",this.touchend))},this.touchmove=E=>{E.targetTouches.length!==1?this.reset():(this._lastPos=M.touchPos(this.element,E.targetTouches)[0],this.move(E,this._lastPos))},this.touchend=E=>{E.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const x=new uc;this._rotatePitchHanlder=new Jc({clickTolerance:3,move:(E,k)=>{const F=u.getBoundingClientRect(),U=new s.P((F.bottom-F.top)/2,(F.right-F.left)/2);return{bearingDelta:s.cm(new s.P(E.x,k.y),k,U),pitchDelta:g?-.5*(k.y-E.y):void 0}},moveStateManager:x,enable:!0,assignEvents:()=>{}}),this.map=o,M.addEventListener(u,"mousedown",this.mousedown),M.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),M.addEventListener(u,"touchcancel",this.reset)}startMove(o,u){this._rotatePitchHanlder.dragStart(o,u),M.disableDrag()}move(o,u){const g=this.map,{bearingDelta:x,pitchDelta:E}=this._rotatePitchHanlder.dragMove(o,u)||{};x&&g.setBearing(g.getBearing()+x),E&&g.setPitch(g.getPitch()+E)}off(){const o=this.element;M.removeEventListener(o,"mousedown",this.mousedown),M.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),M.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),M.removeEventListener(window,"touchend",this.touchend),M.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){M.enableDrag(),M.removeEventListener(window,"mousemove",this.mousemove),M.removeEventListener(window,"mouseup",this.mouseup),M.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),M.removeEventListener(window,"touchend",this.touchend)}}let oo;function Yp(C,o,u,g=!1){if(g||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return C?.wrap();const x=new s.S(C.lng,C.lat);if(C=new s.S(C.lng,C.lat),o){const E=new s.S(C.lng-360,C.lat),k=new s.S(C.lng+360,C.lat),F=u.locationToScreenPoint(C).distSqr(o);u.locationToScreenPoint(E).distSqr(o)<F?C=E:u.locationToScreenPoint(k).distSqr(o)<F&&(C=k)}for(;Math.abs(C.lng-u.center.lng)>180;){const E=u.locationToScreenPoint(C);if(E.x>=0&&E.y>=0&&E.x<=u.width&&E.y<=u.height)break;C.lng>u.center.lng?C.lng-=360:C.lng+=360}return C.lng!==x.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(C))?C:x}const os={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ei(C,o,u){const g=C.classList;for(const x in os)g.remove(`maplibregl-${u}-anchor-${x}`);g.add(`maplibregl-${u}-anchor-${o}`)}class Ci extends s.E{constructor(o){if(super(),this._onKeyPress=u=>{const g=u.code,x=u.charCode||u.keyCode;g!=="Space"&&g!=="Enter"&&x!==32&&x!==13||this.togglePopup()},this._onMapClick=u=>{const g=u.originalEvent.target,x=this._element;this._popup&&(g===x||x.contains(g))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const g=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!g)&&this._map.once("render",this._update),this._lngLat=Yp(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let E="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?E="rotateX(0deg)":this._pitchAlignment==="map"&&(E=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),M.setTransform(this._element,`${os[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${E} ${x}`),S.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&u.type==="moveend")}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const g=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=g}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.l("dragstart"))),this.fire(new s.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,this.setOpacity(o?.opacity,o?.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=s.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=M.create("div");const u=M.createNS("http://www.w3.org/2000/svg","svg"),g=41,x=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${g}px`),u.setAttributeNS(null,"width",`${x}px`),u.setAttributeNS(null,"viewBox",`0 0 ${x} ${g}`);const E=M.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");const k=M.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill-rule","nonzero");const F=M.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(3.0, 29.0)"),F.setAttributeNS(null,"fill","#000000");const U=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Ne of U){const Ge=M.createNS("http://www.w3.org/2000/svg","ellipse");Ge.setAttributeNS(null,"opacity","0.04"),Ge.setAttributeNS(null,"cx","10.5"),Ge.setAttributeNS(null,"cy","5.80029008"),Ge.setAttributeNS(null,"rx",Ne.rx),Ge.setAttributeNS(null,"ry",Ne.ry),F.appendChild(Ge)}const Z=M.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill",this._color);const K=M.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Z.appendChild(K);const oe=M.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"opacity","0.25"),oe.setAttributeNS(null,"fill","#000000");const re=M.createNS("http://www.w3.org/2000/svg","path");re.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),oe.appendChild(re);const ce=M.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ce.setAttributeNS(null,"fill","#FFFFFF");const ve=M.createNS("http://www.w3.org/2000/svg","g");ve.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Le=M.createNS("http://www.w3.org/2000/svg","circle");Le.setAttributeNS(null,"fill","#000000"),Le.setAttributeNS(null,"opacity","0.25"),Le.setAttributeNS(null,"cx","5.5"),Le.setAttributeNS(null,"cy","5.5"),Le.setAttributeNS(null,"r","5.4999962");const ze=M.createNS("http://www.w3.org/2000/svg","circle");ze.setAttributeNS(null,"fill","#FFFFFF"),ze.setAttributeNS(null,"cx","5.5"),ze.setAttributeNS(null,"cy","5.5"),ze.setAttributeNS(null,"r","5.4999962"),ve.appendChild(Le),ve.appendChild(ze),k.appendChild(F),k.appendChild(Z),k.appendChild(oe),k.appendChild(ce),k.appendChild(ve),u.appendChild(k),u.setAttributeNS(null,"height",g*this._scale+"px"),u.setAttributeNS(null,"width",x*this._scale+"px"),this._element.appendChild(u),this._offset=s.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),ei(this._element,this._anchor,"marker"),o&&o.className)for(const u of o.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),o.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),M.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.S.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const x=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var u,g;const x=(u=this._map)===null||u===void 0?void 0:u.terrain,E=this._map.transform.isLocationOccluded(this._lngLat);if(!x||E){const ce=E?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ce&&(this._element.style.opacity=ce))}if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const k=this._map,F=k.terrain.depthAtPoint(this._pos),U=k.terrain.getElevationForLngLatZoom(this._lngLat,k.transform.tileZoom);if(k.transform.lngLatToCameraDepth(this._lngLat,U)-F<.006)return void(this._element.style.opacity=this._opacity);const Z=-this._offset.y/k.transform.pixelsPerMeter,K=Math.sin(k.getPitch()*Math.PI/180)*Z,oe=k.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),re=k.transform.lngLatToCameraDepth(this._lngLat,U+K)-oe>.006;!((g=this._popup)===null||g===void 0)&&g.isOpen()&&re&&this._popup.remove(),this._element.style.opacity=re?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=s.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,u){return(this._opacity===void 0||o===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),o!==void 0&&(this._opacity=o),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Kp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let jo=0,ss=!1;const Xu={maxWidth:100,unit:"metric"};function hd(C,o,u){const g=u&&u.maxWidth||100,x=C._container.clientHeight/2,E=C._container.clientWidth/2,k=C.unproject([E-g/2,x]),F=C.unproject([E+g/2,x]),U=Math.round(C.project(F).x-C.project(k).x),Z=Math.min(g,U,C._container.clientWidth),K=k.distanceTo(F);if(u&&u.unit==="imperial"){const oe=3.2808*K;oe>5280?$a(o,Z,oe/5280,C._getUIString("ScaleControl.Miles")):$a(o,Z,oe,C._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?$a(o,Z,K/1852,C._getUIString("ScaleControl.NauticalMiles")):K>=1e3?$a(o,Z,K/1e3,C._getUIString("ScaleControl.Kilometers")):$a(o,Z,K,C._getUIString("ScaleControl.Meters"))}function $a(C,o,u,g){const x=function(E){const k=Math.pow(10,`${Math.floor(E)}`.length-1);let F=E/k;return F=F>=10?10:F>=5?5:F>=3?3:F>=2?2:F>=1?1:function(U){const Z=Math.pow(10,Math.ceil(-Math.log(U)/Math.LN10));return Math.round(U*Z)/Z}(F),k*F}(u);C.style.width=o*(x/u)+"px",C.innerHTML=`${x}&nbsp;${g}`}const Zu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},eu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Os(C){if(C){if(typeof C=="number"){const o=Math.round(Math.abs(C)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,C),"top-left":new s.P(o,o),"top-right":new s.P(-o,o),bottom:new s.P(0,-C),"bottom-left":new s.P(o,-o),"bottom-right":new s.P(-o,-o),left:new s.P(C,0),right:new s.P(-C,0)}}if(C instanceof s.P||Array.isArray(C)){const o=s.P.convert(C);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:s.P.convert(C.center||[0,0]),top:s.P.convert(C.top||[0,0]),"top-left":s.P.convert(C["top-left"]||[0,0]),"top-right":s.P.convert(C["top-right"]||[0,0]),bottom:s.P.convert(C.bottom||[0,0]),"bottom-left":s.P.convert(C["bottom-left"]||[0,0]),"bottom-right":s.P.convert(C["bottom-right"]||[0,0]),left:s.P.convert(C.left||[0,0]),right:s.P.convert(C.right||[0,0])}}return Os(new s.P(0,0))}const tu=p;c.AJAXError=s.cy,c.Event=s.l,c.Evented=s.E,c.LngLat=s.S,c.MercatorCoordinate=s.a0,c.Point=s.P,c.addProtocol=s.cz,c.config=s.a,c.removeProtocol=s.cA,c.AttributionControl=cd,c.BoxZoomHandler=$o,c.CanvasSource=Ue,c.CooperativeGesturesHandler=ad,c.DoubleClickZoomHandler=_s,c.DragPanHandler=sd,c.DragRotateHandler=Hu,c.EdgeInsets=Qo,c.FullscreenControl=class extends s.E{constructor(C={}){super(),this._onFullscreenChange=()=>{var o;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((o=u?.shadowRoot)===null||o===void 0)&&o.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,C&&C.container&&(C.container instanceof HTMLElement?this._container=C.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){M.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const C=this._fullscreenButton=M.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);M.create("span","maplibregl-ctrl-icon",C).setAttribute("aria-hidden","true"),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},c.GeoJSONSource=Ut,c.GeolocateControl=class extends s.E{constructor(C){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new s.l("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.l("geolocate",o)),this._finish()}},this._updateCamera=o=>{const u=new s.S(o.coords.longitude,o.coords.latitude),g=o.coords.accuracy,x=this._map.getBearing(),E=s.e({bearing:x},this.options.fitBoundsOptions),k=tn.fromLngLat(u,g);this._map.fitBounds(k,E,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const u=new s.S(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&ss)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.l("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=M.create("button","maplibregl-ctrl-geolocate",this._container),M.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(o===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=M.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ci({element:this._dotElement}),this._circleElement=M.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ci({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.l("trackuserlocationend")),this.fire(new s.l("userlocationlostfocus")))})}},this.options=s.e({},Kp,C)}onAdd(C){return this._map=C,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(o=!1){if(oo!==void 0&&!o)return oo;if(window.navigator.permissions===void 0)return oo=!!window.navigator.geolocation,oo;try{oo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{oo=!!window.navigator.geolocation}return oo})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),M.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,jo=0,ss=!1}_isOutOfMapMaxBounds(C){const o=this._map.getMaxBounds(),u=C.coords;return o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const C=this._map.getBounds(),o=C.getSouthEast(),u=C.getNorthEast(),g=o.distanceTo(u),x=Math.ceil(this._accuracy/(g/this._map._container.clientHeight)*2);this._circleElement.style.width=`${x}px`,this._circleElement.style.height=`${x}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":jo--,ss=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.l("trackuserlocationstart")),this.fire(new s.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let C;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),jo++,jo>1?(C={maximumAge:6e5,timeout:0},ss=!0):(C=this.options.positionOptions,ss=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,C)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},c.GlobeControl=class{constructor(){this._toggleProjection=()=>{var C;const o=(C=this._map.getProjection())===null||C===void 0?void 0:C.type;this._map.setProjection(o!=="mercator"&&o?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var C;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((C=this._map.getProjection())===null||C===void 0?void 0:C.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(C){return this._map=C,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=M.create("button","maplibregl-ctrl-globe",this._container),M.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){M.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},c.Hash=rd,c.ImageSource=On,c.KeyboardHandler=dc,c.LngLatBounds=tn,c.LogoControl=_f,c.Map=class extends si{constructor(C){var o,u;s.cv.mark(s.cw.create);const g=Object.assign(Object.assign(Object.assign({},Ua),C),{canvasContextAttributes:Object.assign(Object.assign({},Ua.canvasContextAttributes),C.canvasContextAttributes)});if(g.minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const x=new Zi,E=new Fh;if(g.minZoom!==void 0&&x.setMinZoom(g.minZoom),g.maxZoom!==void 0&&x.setMaxZoom(g.maxZoom),g.minPitch!==void 0&&x.setMinPitch(g.minPitch),g.maxPitch!==void 0&&x.setMaxPitch(g.maxPitch),g.renderWorldCopies!==void 0&&x.setRenderWorldCopies(g.renderWorldCopies),super(x,E,{bearingSnap:g.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Qc,this._controls=[],this._mapId=s.a6(),this._contextLost=F=>{F.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.l("webglcontextlost",{originalEvent:F}))},this._contextRestored=F=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.l("webglcontextrestored",{originalEvent:F}))},this._onMapScroll=F=>{if(F.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._maxTileCacheZoomLevels=g.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},g.canvasContextAttributes),this._trackResize=g.trackResize===!0,this._bearingSnap=g.bearingSnap,this._centerClampedToGround=g.centerClampedToGround,this._refreshExpiredTiles=g.refreshExpiredTiles===!0,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions===!0,this._collectResourceTiming=g.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},qu),g.locale),this._clickTolerance=g.clickTolerance,this._overridePixelRatio=g.pixelRatio,this._maxCanvasSize=g.maxCanvasSize,this.transformCameraUpdate=g.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=g.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=H.addThrottleControl(()=>this.isMoving()),this._requestManager=new q(g.transformRequest),typeof g.container=="string"){if(this._container=document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let F=!1;const U=Fu(Z=>{this._trackResize&&!this._removed&&(this.resize(Z),this.redraw())},50);this._resizeObserver=new ResizeObserver(Z=>{F?U(Z):F=!0}),this._resizeObserver.observe(this._container)}this.handlers=new fc(this,g),this._hash=g.hash&&new rd(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,elevation:g.elevation,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch,roll:g.roll}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,s.e({},g.fitBoundsOptions,{duration:0}))));const k=typeof g.style=="string"||((u=(o=g.style)===null||o===void 0?void 0:o.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,k),this._localIdeographFontFamily=g.localIdeographFontFamily,this._validateStyle=g.validateStyle,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new cd(typeof g.attributionControl=="boolean"?void 0:g.attributionControl)),g.maplibreLogo&&this.addControl(new _f,g.logoPosition),this.on("style.load",()=>{if(k||this._resizeTransform(),this.transform.unmodified){const F=s.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(F)}}),this.on("data",F=>{this._update(F.dataType==="style"),this.fire(new s.l(`${F.dataType}data`,F))}),this.on("dataloading",F=>{this.fire(new s.l(`${F.dataType}dataloading`,F))}),this.on("dataabort",F=>{this.fire(new s.l("sourcedataabort",F))})}_getMapId(){return this._mapId}setGlobalStateProperty(C,o){return this.style.setGlobalStateProperty(C,o),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(C,o){if(o===void 0&&(o=C.getDefaultPosition?C.getDefaultPosition():"top-right"),!C||!C.onAdd)return this.fire(new s.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=C.onAdd(this);this._controls.push(C);const g=this._controlPositions[o];return o.indexOf("bottom")!==-1?g.insertBefore(u,g.firstChild):g.appendChild(u),this}removeControl(C){if(!C||!C.onRemove)return this.fire(new s.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(C);return o>-1&&this._controls.splice(o,1),C.onRemove(this),this}hasControl(C){return this._controls.indexOf(C)>-1}calculateCameraOptionsFromTo(C,o,u,g){return g==null&&this.terrain&&(g=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(C,o,u,g)}resize(C,o=!0){const[u,g]=this._containerDimensions(),x=this._getClampedPixelRatio(u,g);if(this._resizeCanvas(u,g,x),this.painter.resize(u,g,x),this.painter.overLimit()){const k=this.painter.context.gl;this._maxCanvasSize=[k.drawingBufferWidth,k.drawingBufferHeight];const F=this._getClampedPixelRatio(u,g);this._resizeCanvas(u,g,F),this.painter.resize(u,g,F)}this._resizeTransform(o);const E=!this._moving;return E&&(this.stop(),this.fire(new s.l("movestart",C)).fire(new s.l("move",C))),this.fire(new s.l("resize",C)),E&&this.fire(new s.l("moveend",C)),this}_resizeTransform(C=!0){var o;const[u,g]=this._containerDimensions();this.transform.resize(u,g,C),(o=this._requestedCameraState)===null||o===void 0||o.resize(u,g,C)}_getClampedPixelRatio(C,o){const{0:u,1:g}=this._maxCanvasSize,x=this.getPixelRatio(),E=C*x,k=o*x;return Math.min(E>u?u/E:1,k>g?g/k:1)*x}getPixelRatio(){var C;return(C=this._overridePixelRatio)!==null&&C!==void 0?C:devicePixelRatio}setPixelRatio(C){this._overridePixelRatio=C,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(C){return this.transform.setMaxBounds(tn.convert(C)),this._update()}setMinZoom(C){if((C=C??-2)>=-2&&C<=this.transform.maxZoom)return this.transform.setMinZoom(C),this._update(),this.getZoom()<C&&this.setZoom(C),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(C){if((C=C??22)>=this.transform.minZoom)return this.transform.setMaxZoom(C),this._update(),this.getZoom()>C&&this.setZoom(C),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(C){if((C=C??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(C>=0&&C<=this.transform.maxPitch)return this.transform.setMinPitch(C),this._update(),this.getPitch()<C&&this.setPitch(C),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(C){if((C=C??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(C>=this.transform.minPitch)return this.transform.setMaxPitch(C),this._update(),this.getPitch()>C&&this.setPitch(C),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(C){return this.transform.setRenderWorldCopies(C),this._update()}project(C){return this.transform.locationToScreenPoint(s.S.convert(C),this.style&&this.terrain)}unproject(C){return this.transform.screenPointToLocation(s.P.convert(C),this.terrain)}isMoving(){var C;return this._moving||((C=this.handlers)===null||C===void 0?void 0:C.isMoving())}isZooming(){var C;return this._zooming||((C=this.handlers)===null||C===void 0?void 0:C.isZooming())}isRotating(){var C;return this._rotating||((C=this.handlers)===null||C===void 0?void 0:C.isRotating())}_createDelegatedListener(C,o,u){if(C==="mouseenter"||C==="mouseover"){let g=!1;return{layers:o,listener:u,delegates:{mousemove:E=>{const k=o.filter(U=>this.getLayer(U)),F=k.length!==0?this.queryRenderedFeatures(E.point,{layers:k}):[];F.length?g||(g=!0,u.call(this,new Pr(C,this,E.originalEvent,{features:F}))):g=!1},mouseout:()=>{g=!1}}}}if(C==="mouseleave"||C==="mouseout"){let g=!1;return{layers:o,listener:u,delegates:{mousemove:k=>{const F=o.filter(U=>this.getLayer(U));(F.length!==0?this.queryRenderedFeatures(k.point,{layers:F}):[]).length?g=!0:g&&(g=!1,u.call(this,new Pr(C,this,k.originalEvent)))},mouseout:k=>{g&&(g=!1,u.call(this,new Pr(C,this,k.originalEvent)))}}}}{const g=x=>{const E=o.filter(F=>this.getLayer(F)),k=E.length!==0?this.queryRenderedFeatures(x.point,{layers:E}):[];k.length&&(x.features=k,u.call(this,x),delete x.features)};return{layers:o,listener:u,delegates:{[C]:g}}}}_saveDelegatedListener(C,o){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[C]=this._delegatedListeners[C]||[],this._delegatedListeners[C].push(o)}_removeDelegatedListener(C,o,u){if(!this._delegatedListeners||!this._delegatedListeners[C])return;const g=this._delegatedListeners[C];for(let x=0;x<g.length;x++){const E=g[x];if(E.listener===u&&E.layers.length===o.length&&E.layers.every(k=>o.includes(k))){for(const k in E.delegates)this.off(k,E.delegates[k]);return void g.splice(x,1)}}}on(C,o,u){if(u===void 0)return super.on(C,o);const g=typeof o=="string"?[o]:o,x=this._createDelegatedListener(C,g,u);this._saveDelegatedListener(C,x);for(const E in x.delegates)this.on(E,x.delegates[E]);return{unsubscribe:()=>{this._removeDelegatedListener(C,g,u)}}}once(C,o,u){if(u===void 0)return super.once(C,o);const g=typeof o=="string"?[o]:o,x=this._createDelegatedListener(C,g,u);for(const E in x.delegates){const k=x.delegates[E];x.delegates[E]=(...F)=>{this._removeDelegatedListener(C,g,u),k(...F)}}this._saveDelegatedListener(C,x);for(const E in x.delegates)this.once(E,x.delegates[E]);return this}off(C,o,u){return u===void 0?super.off(C,o):(this._removeDelegatedListener(C,typeof o=="string"?[o]:o,u),this)}queryRenderedFeatures(C,o){if(!this.style)return[];let u;const g=C instanceof s.P||Array.isArray(C),x=g?C:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(g?{}:C)||{},x instanceof s.P||typeof x[0]=="number")u=[s.P.convert(x)];else{const E=s.P.convert(x[0]),k=s.P.convert(x[1]);u=[E,new s.P(k.x,E.y),k,new s.P(E.x,k.y),E]}return this.style.queryRenderedFeatures(u,o,this.transform)}querySourceFeatures(C,o){return this.style.querySourceFeatures(C,o)}setStyle(C,o){return(o=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&C?(this._diffStyle(C,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(C,o))}setTransformRequest(C){return this._requestManager.setTransformRequest(C),this}_getUIString(C){const o=this._locale[C];if(o==null)throw new Error(`Missing UI string '${C}'`);return o}_updateStyle(C,o){var u,g;if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(C,o));const x=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!C)),C?(this.style=new Pp(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof C=="string"?this.style.loadURL(C,o,x):this.style.loadJSON(C,o,x),this):((g=(u=this.style)===null||u===void 0?void 0:u.projection)===null||g===void 0||g.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Pp(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(C,o){if(typeof C=="string"){const u=this._requestManager.transformRequest(C,"Style");s.j(u,new AbortController).then(g=>{this._updateDiff(g.data,o)}).catch(g=>{g&&this.fire(new s.k(g))})}else typeof C=="object"&&this._updateDiff(C,o)}_updateDiff(C,o){try{this.style.setState(C,o)&&this._update(!0)}catch(u){s.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(C,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(C,o){return this._lazyInitEmptyStyle(),this.style.addSource(C,o),this._update(!0)}isSourceLoaded(C){const o=this.style&&this.style.sourceCaches[C];if(o!==void 0)return o.loaded();this.fire(new s.k(new Error(`There is no source with ID '${C}'`)))}setTerrain(C){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),C){const o=this.style.sourceCaches[C.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${C.source}`);this.terrain===null&&o.reload();for(const u in this.style._layers){const g=this.style._layers[u];g.type==="hillshade"&&g.source===C.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),g.type==="color-relief"&&g.source===C.source&&s.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new zs(this.painter,o,C),this.painter.renderToTexture=new ar(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var g;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==C.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((g=u.source)===null||g===void 0?void 0:g.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new s.l("terrain",{terrain:C})),this}getTerrain(){var C,o;return(o=(C=this.terrain)===null||C===void 0?void 0:C.options)!==null&&o!==void 0?o:null}areTilesLoaded(){const C=this.style&&this.style.sourceCaches;for(const o in C){const u=C[o]._tiles;for(const g in u){const x=u[g];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}removeSource(C){return this.style.removeSource(C),this._update(!0)}getSource(C){return this.style.getSource(C)}setSourceTileLodParams(C,o,u){if(u){const g=this.getSource(u);if(!g)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);g.calculateTileZoom=ye(Math.max(1,C),Math.max(1,o))}else for(const g in this.style.sourceCaches)this.style.sourceCaches[g].getSource().calculateTileZoom=ye(Math.max(1,C),Math.max(1,o));return this._update(!0),this}refreshTiles(C,o){const u=this.style.sourceCaches[C];if(!u)throw new Error(`There is no source cache with ID "${C}", cannot refresh tile`);o===void 0?u.reload(!0):u.refreshTiles(o.map(g=>new s.a3(g.z,g.x,g.y)))}addImage(C,o,u={}){const{pixelRatio:g=1,sdf:x=!1,stretchX:E,stretchY:k,content:F,textFitWidth:U,textFitHeight:Z}=u;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||s.b(o))){if(o.width===void 0||o.height===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:K,height:oe,data:re}=o,ce=o;return this.style.addImage(C,{data:new s.R({width:K,height:oe},new Uint8Array(re)),pixelRatio:g,stretchX:E,stretchY:k,content:F,textFitWidth:U,textFitHeight:Z,sdf:x,version:0,userImage:ce}),ce.onAdd&&ce.onAdd(this,C),this}}{const{width:K,height:oe,data:re}=S.getImageData(o);this.style.addImage(C,{data:new s.R({width:K,height:oe},re),pixelRatio:g,stretchX:E,stretchY:k,content:F,textFitWidth:U,textFitHeight:Z,sdf:x,version:0})}}updateImage(C,o){const u=this.style.getImage(C);if(!u)return this.fire(new s.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=o instanceof HTMLImageElement||s.b(o)?S.getImageData(o):o,{width:x,height:E,data:k}=g;if(x===void 0||E===void 0)return this.fire(new s.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(x!==u.data.width||E!==u.data.height)return this.fire(new s.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const F=!(o instanceof HTMLImageElement||s.b(o));return u.data.replace(k,F),this.style.updateImage(C,u),this}getImage(C){return this.style.getImage(C)}hasImage(C){return C?!!this.style.getImage(C):(this.fire(new s.k(new Error("Missing required image id"))),!1)}removeImage(C){this.style.removeImage(C)}loadImage(C){return H.getImage(this._requestManager.transformRequest(C,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(C,o){return this._lazyInitEmptyStyle(),this.style.addLayer(C,o),this._update(!0)}moveLayer(C,o){return this.style.moveLayer(C,o),this._update(!0)}removeLayer(C){return this.style.removeLayer(C),this._update(!0)}getLayer(C){return this.style.getLayer(C)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(C,o,u){return this.style.setLayerZoomRange(C,o,u),this._update(!0)}setFilter(C,o,u={}){return this.style.setFilter(C,o,u),this._update(!0)}getFilter(C){return this.style.getFilter(C)}setPaintProperty(C,o,u,g={}){return this.style.setPaintProperty(C,o,u,g),this._update(!0)}getPaintProperty(C,o){return this.style.getPaintProperty(C,o)}setLayoutProperty(C,o,u,g={}){return this.style.setLayoutProperty(C,o,u,g),this._update(!0)}getLayoutProperty(C,o){return this.style.getLayoutProperty(C,o)}setGlyphs(C,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(C,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(C,o,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(C,o,u,g=>{g||this._update(!0)}),this}removeSprite(C){return this._lazyInitEmptyStyle(),this.style.removeSprite(C),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(C,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(C,o,u=>{u||this._update(!0)}),this}setLight(C,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(C,o),this._update(!0)}getLight(){return this.style.getLight()}setSky(C,o={}){return this._lazyInitEmptyStyle(),this.style.setSky(C,o),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(C,o){return this.style.setFeatureState(C,o),this._update()}removeFeatureState(C,o){return this.style.removeFeatureState(C,o),this._update()}getFeatureState(C){return this.style.getFeatureState(C)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let C=0,o=0;return this._container&&(C=this._container.clientWidth||400,o=this._container.clientHeight||300),[C,o]}_setupContainer(){const C=this._container;C.classList.add("maplibregl-map");const o=this._canvasContainer=M.create("div","maplibregl-canvas-container",C);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=M.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),g=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],g);const x=this._controlContainer=M.create("div","maplibregl-control-container",C),E=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(k=>{E[k]=M.create("div",`maplibregl-ctrl-${k} `,x)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(C,o,u){this._canvas.width=Math.floor(u*C),this._canvas.height=Math.floor(u*o),this._canvas.style.width=`${C}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const C=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let o=null;this._canvas.addEventListener("webglcontextcreationerror",g=>{o={requestedAttributes:C},g&&(o.statusMessage=g.statusMessage,o.type=g.type)},{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,C):this._canvas.getContext("webgl2",C)||this._canvas.getContext("webgl",C),!u){const g="Failed to initialize WebGL";throw o?(o.message=g,new Error(JSON.stringify(o))):new Error(g)}this.painter=new Yi(u,this.transform),I.testSupport(u)}migrateProjection(C,o){super.migrateProjection(C,o),this.painter.transform=C,this.fire(new s.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(C){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||C,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(C){return this._update(),this._renderTaskQueue.add(C)}_cancelRenderFrame(C){this._renderTaskQueue.remove(C)}_render(C){var o,u,g,x,E;const k=this._idleTriggered?this._fadeDuration:0,F=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(C),this._removed)return;let U=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const oe=this.transform.zoom,re=S.now();this.style.zoomHistory.update(oe,re);const ce=new s.F(oe,{now:re,fadeDuration:k,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),ve=ce.crossFadingFactor();ve===1&&ve===this._crossFadingFactor||(U=!0,this._crossFadingFactor=ve),this.style.update(ce)}const Z=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==F;(g=this.style.projection)===null||g===void 0||g.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((x=this.style.projection)===null||x===void 0?void 0:x.transitionState,(E=this.style.projection)===null||E===void 0?void 0:E.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||Z)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,k,this._crossSourceCollisions,Z),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:k,showPadding:this.showPadding}),this.fire(new s.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.cv.mark(s.cw.load),this.fire(new s.l("load"))),this.style&&(this.style.hasTransitions()||U)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const K=this._sourcesDirty||this._styleDirty||this._placementDirty;return K||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.l("idle")),!this._loaded||this._fullyLoaded||K||(this._fullyLoaded=!0,s.cv.mark(s.cw.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var C;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),H.removeThrottleControl(this._imageQueueHandle),(C=this._resizeObserver)===null||C===void 0||C.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o?.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),M.remove(this._canvasContainer),M.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),s.cv.clearMetrics(),this._removed=!0,this.fire(new s.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,S.frame(this._frameRequest,C=>{s.cv.frame(C),this._frameRequest=null;try{this._render(C)}catch(o){if(!s.cx(o)&&!function(u){return u.message===Up}(o))throw o}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(C){this._showTileBoundaries!==C&&(this._showTileBoundaries=C,this._update())}get showPadding(){return!!this._showPadding}set showPadding(C){this._showPadding!==C&&(this._showPadding=C,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(C){this._showCollisionBoxes!==C&&(this._showCollisionBoxes=C,C?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(C){this._showOverdrawInspector!==C&&(this._showOverdrawInspector=C,this._update())}get repaint(){return!!this._repaint}set repaint(C){this._repaint!==C&&(this._repaint=C,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(C){this._vertices=C,this._update()}get version(){return ud}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(C){return this._lazyInitEmptyStyle(),this.style.setProjection(C),this._update(!0)}},c.MapMouseEvent=Pr,c.MapTouchEvent=po,c.MapWheelEvent=mo,c.Marker=Ci,c.NavigationControl=class{constructor(C){this._updateZoomButtons=()=>{const o=this._map.getZoom(),u=o===this._map.getMaxZoom(),g=o===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(o,u)=>{const g=this._map._getUIString(`NavigationControl.${u}`);o.title=g,o.setAttribute("aria-label",g)},this.options=s.e({},vi,C),this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),M.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),M.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=M.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new mc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){M.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(C,o){const u=M.create("button",C,this._container);return u.type="button",u.addEventListener("click",o),u}},c.Popup=class extends s.E{constructor(C){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&M.remove(this._content),this._container&&(M.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.l("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=M.create("div","maplibregl-popup",this._map.getContainer()),this._tip=M.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const k of this.options.className.split(" "))this._container.classList.add(k);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Yp(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!o)return;const u=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationToScreenPoint(this._lngLat));let g=this.options.anchor;const x=Os(this.options.offset);if(!g){const k=this._container.offsetWidth,F=this._container.offsetHeight;let U;U=u.y+x.bottom.y<F?["top"]:u.y>this._map.transform.height-F?["bottom"]:[],u.x<k/2?U.push("left"):u.x>this._map.transform.width-k/2&&U.push("right"),g=U.length===0?"bottom":U.join("-")}let E=u.add(x[g]);this.options.subpixelPositioning||(E=E.round()),M.setTransform(this._container,`${os[g]} translate(${E.x}px,${E.y}px)`),ei(this._container,g,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(Zu),C)}addTo(C){return this._map&&this.remove(),this._map=C,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(C){return this._lngLat=s.S.convert(C),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(C){return this.setDOMContent(document.createTextNode(C))}setHTML(C){const o=document.createDocumentFragment(),u=document.createElement("body");let g;for(u.innerHTML=C;g=u.firstChild,g;)o.appendChild(g);return this.setDOMContent(o)}getMaxWidth(){var C;return(C=this._container)===null||C===void 0?void 0:C.style.maxWidth}setMaxWidth(C){return this.options.maxWidth=C,this._update(),this}setDOMContent(C){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=M.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(C),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(C){return this._container&&this._container.classList.add(C),this}removeClassName(C){return this._container&&this._container.classList.remove(C),this}setOffset(C){return this.options.offset=C,this._update(),this}toggleClassName(C){if(this._container)return this._container.classList.toggle(C)}setSubpixelPositioning(C){this.options.subpixelPositioning=C}_createCloseButton(){this.options.closeButton&&(this._closeButton=M.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const C=this._container.querySelector(eu);C&&C.focus()}},c.RasterDEMTileSource=fn,c.RasterTileSource=Kt,c.ScaleControl=class{constructor(C){this._onMove=()=>{hd(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,hd(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Xu),C)}getDefaultPosition(){return"bottom-left"}onAdd(C){return this._map=C,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){M.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},c.ScrollZoomHandler=Mi,c.Style=Pp,c.TerrainControl=class{constructor(C){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=C}onAdd(C){return this._map=C,this._container=M.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=M.create("button","maplibregl-ctrl-terrain",this._container),M.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){M.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},c.TwoFingersTouchPitchHandler=gl,c.TwoFingersTouchRotateHandler=va,c.TwoFingersTouchZoomHandler=Hi,c.TwoFingersTouchZoomRotateHandler=yf,c.VectorTileSource=Tn,c.VideoSource=vn,c.addSourceType=(C,o)=>s._(void 0,void 0,void 0,function*(){if(yt(C))throw new Error(`A source type called "${C}" already exists.`);((u,g)=>{Se[u]=g})(C,o)}),c.clearPrewarmedResources=function(){const C=Vt;C&&(C.isPreloaded()&&C.numActive()===1?(C.release(rt),Vt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},c.createTileMesh=Eu,c.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},c.getRTLTextPluginStatus=function(){return un().getRTLTextPluginStatus()},c.getVersion=function(){return tu},c.getWorkerCount=function(){return Re.workerCount},c.getWorkerUrl=function(){return s.a.WORKER_URL},c.importScriptInWorkers=function(C){return ut().broadcast("IS",C)},c.prewarm=function(){ct().acquire(rt)},c.setMaxParallelImageRequests=function(C){s.a.MAX_PARALLEL_IMAGE_REQUESTS=C},c.setRTLTextPlugin=function(C,o){return un().setRTLTextPlugin(C,o)},c.setWorkerCount=function(C){Re.workerCount=C},c.setWorkerUrl=function(C){s.a.WORKER_URL=C}});var l=n;return l})}(lb)),lb.exports}var aS=hne();const MN=vw(aS),dne=GO({__proto__:null,default:MN},[aS]);var Vv=Math.pow,Gs=(t,e,n)=>new Promise((r,i)=>{var l=p=>{try{s(n.next(p))}catch(y){i(y)}},c=p=>{try{s(n.throw(p))}catch(y){i(y)}},s=p=>p.done?r(p.value):Promise.resolve(p.value).then(l,c);s((n=n.apply(t,e)).next())}),$l=Uint8Array,G0=Uint16Array,fne=Int32Array,CN=new $l([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),EN=new $l([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),pne=new $l([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),TN=function(t,e){for(var n=new G0(31),r=0;r<31;++r)n[r]=e+=1<<t[r-1];for(var i=new fne(n[30]),r=1;r<30;++r)for(var l=n[r];l<n[r+1];++l)i[l]=l-n[r]<<5|r;return{b:n,r:i}},PN=TN(CN,2),AN=PN.b,mne=PN.r;AN[28]=258,mne[258]=28;var gne=TN(EN,0),vne=gne.b,IN=new G0(32768);for(pi=0;pi<32768;++pi)Id=(pi&43690)>>1|(pi&21845)<<1,Id=(Id&52428)>>2|(Id&13107)<<2,Id=(Id&61680)>>4|(Id&3855)<<4,IN[pi]=((Id&65280)>>8|(Id&255)<<8)>>1;var Id,pi,W0=function(t,e,n){for(var r=t.length,i=0,l=new G0(e);i<r;++i)t[i]&&++l[t[i]-1];var c=new G0(e);for(i=1;i<e;++i)c[i]=c[i-1]+l[i-1]<<1;var s;{s=new G0(1<<e);var p=15-e;for(i=0;i<r;++i)if(t[i])for(var y=i<<4|t[i],_=e-t[i],w=c[t[i]-1]++<<_,S=w|(1<<_)-1;w<=S;++w)s[IN[w]>>p]=y}return s},ax=new $l(288);for(pi=0;pi<144;++pi)ax[pi]=8;var pi;for(pi=144;pi<256;++pi)ax[pi]=9;var pi;for(pi=256;pi<280;++pi)ax[pi]=7;var pi;for(pi=280;pi<288;++pi)ax[pi]=8;var pi,RN=new $l(32);for(pi=0;pi<32;++pi)RN[pi]=5;var pi,yne=W0(ax,9),_ne=W0(RN,5),C2=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},uu=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(e&7)&n},E2=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},xne=function(t){return(t+7)/8|0},bne=function(t,e,n){(n==null||n>t.length)&&(n=t.length);var r=new $l(n-e);return r.set(t.subarray(e,n)),r},wne=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Dl=function(t,e,n){var r=new Error(e||wne[t]);if(r.code=t,Error.captureStackTrace&&Error.captureStackTrace(r,Dl),!n)throw r;return r},RA=function(t,e,n,r){var i=t.length,l=0;if(!i||e.f&&!e.l)return n||new $l(0);var c=!n||e.i!=2,s=e.i;n||(n=new $l(i*3));var p=function(wt){var cn=n.length;if(wt>cn){var dn=new $l(Math.max(cn*2,wt));dn.set(n),n=dn}},y=e.f||0,_=e.p||0,w=e.b||0,S=e.l,M=e.d,I=e.m,D=e.n,R=i*8;do{if(!S){y=uu(t,_,1);var L=uu(t,_+1,3);if(_+=3,L)if(L==1)S=yne,M=_ne,I=9,D=5;else if(L==2){var q=uu(t,_,31)+257,X=uu(t,_+10,15)+4,ee=q+uu(t,_+5,31)+1;_+=14;for(var se=new $l(ee),J=new $l(19),$=0;$<X;++$)J[pne[$]]=uu(t,_+$*3,7);_+=X*3;for(var le=C2(J),Ce=(1<<le)-1,we=W0(J,le),$=0;$<ee;){var We=we[uu(t,_,Ce)];_+=We&15;var V=We>>4;if(V<16)se[$++]=V;else{var Fe=0,Me=0;for(V==16?(Me=3+uu(t,_,3),_+=2,Fe=se[$-1]):V==17?(Me=3+uu(t,_,7),_+=3):V==18&&(Me=11+uu(t,_,127),_+=7);Me--;)se[$++]=Fe}}var Ee=se.subarray(0,q),Te=se.subarray(q);I=C2(Ee),D=C2(Te),S=W0(Ee,I),M=W0(Te,D)}else Dl(1);else{var V=xne(_)+4,B=t[V-4]|t[V-3]<<8,H=V+B;if(H>i){s&&Dl(0);break}c&&p(w+B),n.set(t.subarray(V,H),w),e.b=w+=B,e.p=_=H*8,e.f=y;continue}if(_>R){s&&Dl(0);break}}c&&p(w+131072);for(var Ze=(1<<I)-1,rt=(1<<D)-1,Re=_;;Re=_){var Fe=S[E2(t,_)&Ze],Qe=Fe>>4;if(_+=Fe&15,_>R){s&&Dl(0);break}if(Fe||Dl(2),Qe<256)n[w++]=Qe;else if(Qe==256){Re=_,S=null;break}else{var Vt=Qe-254;if(Qe>264){var $=Qe-257,je=CN[$];Vt=uu(t,_,(1<<je)-1)+AN[$],_+=je}var ct=M[E2(t,_)&rt],Ct=ct>>4;ct||Dl(3),_+=ct&15;var Te=vne[Ct];if(Ct>3){var je=EN[Ct];Te+=E2(t,_)&(1<<je)-1,_+=je}if(_>R){s&&Dl(0);break}c&&p(w+131072);var ut=w+Vt;if(w<Te){var lt=l-Te,_t=Math.min(Te,ut);for(lt+w<0&&Dl(3);w<_t;++w)n[w]=r[lt+w]}for(;w<ut;w+=4)n[w]=n[w-Te],n[w+1]=n[w+1-Te],n[w+2]=n[w+2-Te],n[w+3]=n[w+3-Te];w=ut}}e.l=S,e.p=Re,e.b=w,e.f=y,S&&(y=1,e.m=I,e.d=M,e.n=D)}while(!y);return w==n.length?n:bne(n,0,w)},Sne=new $l(0),Mne=function(t){(t[0]!=31||t[1]!=139||t[2]!=8)&&Dl(6,"invalid gzip data");var e=t[3],n=10;e&4&&(n+=(t[10]|t[11]<<8)+2);for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(e&2)},Cne=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},Ene=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&Dl(6,"invalid zlib data"),(t[1]>>5&1)==1&&Dl(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Tne(t,e){return RA(t,{i:2},e,e)}function Pne(t,e){var n=Mne(t);return n+8>t.length&&Dl(6,"invalid gzip data"),RA(t.subarray(n,-8),{i:2},new $l(Cne(t)),e)}function Ane(t,e){return RA(t.subarray(Ene(t),-4),{i:2},e,e)}function rT(t,e){return t[0]==31&&t[1]==139&&t[2]==8?Pne(t,e):(t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31?Tne(t,e):Ane(t,e)}var Ine=typeof TextDecoder<"u"&&new TextDecoder,Rne=0;try{Ine.decode(Sne,{stream:!0}),Rne=1}catch{}var LN=(t,e)=>t*Vv(2,e),m0=(t,e)=>Math.floor(t/Vv(2,e)),$b=(t,e)=>LN(t.getUint16(e+1,!0),8)+t.getUint8(e),kN=(t,e)=>LN(t.getUint32(e+2,!0),16)+t.getUint16(e,!0),Lne=(t,e,n,r,i)=>{if(t!==r.getUint8(i))return t-r.getUint8(i);const l=$b(r,i+1);if(e!==l)return e-l;const c=$b(r,i+4);return n!==c?n-c:0},kne=(t,e,n,r)=>{const i=DN(t,e|128,n,r);return i?{z:e,x:n,y:r,offset:i[0],length:i[1],isDir:!0}:null},zL=(t,e,n,r)=>{const i=DN(t,e,n,r);return i?{z:e,x:n,y:r,offset:i[0],length:i[1],isDir:!1}:null},DN=(t,e,n,r)=>{let i=0,l=t.byteLength/17-1;for(;i<=l;){const c=l+i>>1,s=Lne(e,n,r,t,c*17);if(s>0)i=c+1;else if(s<0)l=c-1;else return[kN(t,c*17+7),t.getUint32(c*17+13,!0)]}return null},Dne=(t,e)=>t.isDir&&!e.isDir?1:!t.isDir&&e.isDir?-1:t.z!==e.z?t.z-e.z:t.x!==e.x?t.x-e.x:t.y-e.y,zN=(t,e)=>{const n=t.getUint8(e*17);return{z:n&127,x:$b(t,e*17+1),y:$b(t,e*17+4),offset:kN(t,e*17+7),length:t.getUint32(e*17+13,!0),isDir:n>>7===1}},OL=t=>{const e=[],n=new DataView(t);for(let r=0;r<n.byteLength/17;r++)e.push(zN(n,r));return zne(e)},zne=t=>{t.sort(Dne);const e=new ArrayBuffer(17*t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++){const i=t[r];let l=i.z;i.isDir&&(l=l|128),n[r*17]=l,n[r*17+1]=i.x&255,n[r*17+2]=i.x>>8&255,n[r*17+3]=i.x>>16&255,n[r*17+4]=i.y&255,n[r*17+5]=i.y>>8&255,n[r*17+6]=i.y>>16&255,n[r*17+7]=i.offset&255,n[r*17+8]=m0(i.offset,8)&255,n[r*17+9]=m0(i.offset,16)&255,n[r*17+10]=m0(i.offset,24)&255,n[r*17+11]=m0(i.offset,32)&255,n[r*17+12]=m0(i.offset,48)&255,n[r*17+13]=i.length&255,n[r*17+14]=i.length>>8&255,n[r*17+15]=i.length>>16&255,n[r*17+16]=i.length>>24&255}return e},One=(t,e)=>{if(t.byteLength<17)return null;const n=t.byteLength/17,r=zN(t,n-1);if(r.isDir){const i=r.z,l=e.z-i,c=Math.trunc(e.x/(1<<l)),s=Math.trunc(e.y/(1<<l));return{z:i,x:c,y:s}}return null};function Fne(t){return Gs(this,null,function*(){const e=yield t.getBytes(0,512e3),n=new DataView(e.data),r=n.getUint32(4,!0),i=n.getUint16(8,!0),l=new TextDecoder("utf-8"),c=JSON.parse(l.decode(new DataView(e.data,10,r)));let s=0;c.compression==="gzip"&&(s=2);let p=0;"minzoom"in c&&(p=+c.minzoom);let y=0;"maxzoom"in c&&(y=+c.maxzoom);let _=0,w=0,S=0,M=-180,I=-85,D=180,R=85;if(c.bounds){const V=c.bounds.split(",");M=+V[0],I=+V[1],D=+V[2],R=+V[3]}if(c.center){const V=c.center.split(",");_=+V[0],w=+V[1],S=+V[2]}return{specVersion:n.getUint16(2,!0),rootDirectoryOffset:10+r,rootDirectoryLength:i*17,jsonMetadataOffset:10,jsonMetadataLength:r,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:s,tileType:1,minZoom:p,maxZoom:y,minLon:M,minLat:I,maxLon:D,maxLat:R,centerZoom:S,centerLon:_,centerLat:w,etag:e.etag}})}function Nne(t,e,n,r,i,l,c){return Gs(this,null,function*(){let s=yield n.getArrayBuffer(e,t.rootDirectoryOffset,t.rootDirectoryLength,t);t.specVersion===1&&(s=OL(s));const p=zL(new DataView(s),r,i,l);if(p){let w=(yield e.getBytes(p.offset,p.length,c)).data;const S=new DataView(w);return S.getUint8(0)===31&&S.getUint8(1)===139&&(w=rT(new Uint8Array(w))),{data:w}}const y=One(new DataView(s),{z:r,x:i,y:l});if(y){const _=kne(new DataView(s),y.z,y.x,y.y);if(_){let w=yield n.getArrayBuffer(e,_.offset,_.length,t);t.specVersion===1&&(w=OL(w));const S=zL(new DataView(w),r,i,l);if(S){let I=(yield e.getBytes(S.offset,S.length,c)).data;const D=new DataView(I);return D.getUint8(0)===31&&D.getUint8(1)===139&&(I=rT(new Uint8Array(I))),{data:I}}}}})}var ON={getHeader:Fne,getZxy:Nne},Bne=t=>(e,n)=>{if(n instanceof AbortController)return t(e,n);const r=new AbortController;return t(e,r).then(i=>n(void 0,i.data,i.cacheControl||"",i.expires||""),i=>n(i)).catch(i=>n(i)),{cancel:()=>r.abort()}},Une=class{constructor(t){this.tilev4=(e,n)=>Gs(this,null,function*(){if(e.type==="json"){const S=e.url.substr(10);let M=this.tiles.get(S);if(M||(M=new FL(S),this.tiles.set(S,M)),this.metadata)return{data:yield M.getTileJson(e.url)};const I=yield M.getHeader();return{data:{tiles:[`${e.url}/{z}/{x}/{y}`],minzoom:I.minZoom,maxzoom:I.maxZoom,bounds:[I.minLon,I.minLat,I.maxLon,I.maxLat]}}}const r=new RegExp(/pmtiles:\/\/(.+)\/(\d+)\/(\d+)\/(\d+)/),i=e.url.match(r);if(!i)throw new Error("Invalid PMTiles protocol URL");const l=i[1];let c=this.tiles.get(l);c||(c=new FL(l),this.tiles.set(l,c));const s=i[2],p=i[3],y=i[4],_=yield c.getHeader(),w=yield c?.getZxy(+s,+p,+y,n.signal);return w?{data:new Uint8Array(w.data),cacheControl:w.cacheControl,expires:w.expires}:_.tileType===1?{data:new Uint8Array}:{data:null}}),this.tile=Bne(this.tilev4),this.tiles=new Map,this.metadata=t?.metadata||!1}add(t){this.tiles.set(t.source.getKey(),t)}get(t){return this.tiles.get(t)}};function ev(t,e){return(e>>>0)*4294967296+(t>>>0)}function $ne(t,e){const n=e.buf;let r=n[e.pos++],i=(r&112)>>4;if(r<128||(r=n[e.pos++],i|=(r&127)<<3,r<128)||(r=n[e.pos++],i|=(r&127)<<10,r<128)||(r=n[e.pos++],i|=(r&127)<<17,r<128)||(r=n[e.pos++],i|=(r&127)<<24,r<128)||(r=n[e.pos++],i|=(r&1)<<31,r<128))return ev(t,i);throw new Error("Expected varint not more than 10 bytes")}function g0(t){const e=t.buf;let n=e[t.pos++],r=n&127;return n<128||(n=e[t.pos++],r|=(n&127)<<7,n<128)||(n=e[t.pos++],r|=(n&127)<<14,n<128)||(n=e[t.pos++],r|=(n&127)<<21,n<128)?r:(n=e[t.pos],r|=(n&15)<<28,$ne(r,t))}function Vne(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}var jne=[0,1,5,21,85,341,1365,5461,21845,87381,349525,1398101,5592405,22369621,89478485,357913941,1431655765,5726623061,22906492245,91625968981,366503875925,1466015503701,5864062014805,23456248059221,93824992236885,375299968947541,0x5555555555555];function Hne(t,e,n){if(t>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Vv(2,t)-1||n>Vv(2,t)-1)throw Error("tile x/y outside zoom level bounds");const r=jne[t],i=Vv(2,t);let l=0,c=0,s=0;const p=[e,n];let y=i/2;for(;y>0;)l=(p[0]&y)>0?1:0,c=(p[1]&y)>0?1:0,s+=y*y*(3*l^c),Vne(y,p,l,c),y=y/2;return r+s}function FN(t,e){return Gs(this,null,function*(){if(e===1||e===0)return t;if(e===2){if(typeof globalThis.DecompressionStream>"u")return rT(new Uint8Array(t));const n=new Response(t).body;if(!n)throw Error("Failed to read response stream");const r=n.pipeThrough(new globalThis.DecompressionStream("gzip"));return new Response(r).arrayBuffer()}throw Error("Compression method not supported")})}function Gne(t){return t===1?".mvt":t===2?".png":t===3?".jpg":t===4?".webp":t===5?".avif":""}var Wne=127;function qne(t,e){let n=0,r=t.length-1;for(;n<=r;){const i=r+n>>1,l=e-t[i].tileId;if(l>0)n=i+1;else if(l<0)r=i-1;else return t[i]}return r>=0&&(t[r].runLength===0||e-t[r].tileId<t[r].runLength)?t[r]:null}var Xne=class{constructor(t,e=new Headers){this.url=t,this.customHeaders=e,this.mustReload=!1;let n="";"navigator"in globalThis&&(n=globalThis.navigator.userAgent||"");const r=n.indexOf("Windows")>-1,i=/Chrome|Chromium|Edg|OPR|Brave/.test(n);this.chromeWindowsNoCache=!1,r&&i&&(this.chromeWindowsNoCache=!0)}getKey(){return this.url}setHeaders(t){this.customHeaders=t}getBytes(t,e,n,r){return Gs(this,null,function*(){let i,l;n?l=n:(i=new AbortController,l=i.signal);const c=new Headers(this.customHeaders);c.set("range",`bytes=${t}-${t+e-1}`);let s;this.mustReload?s="reload":this.chromeWindowsNoCache&&(s="no-store");let p=yield fetch(this.url,{signal:l,cache:s,headers:c});if(t===0&&p.status===416){const S=p.headers.get("Content-Range");if(!S||!S.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const M=+S.substr(8);p=yield fetch(this.url,{signal:l,cache:"reload",headers:{range:`bytes=0-${M-1}`}})}let y=p.headers.get("Etag");if(y?.startsWith("W/")&&(y=null),p.status===416||r&&y&&y!==r)throw this.mustReload=!0,new iT(`Server returned non-matching ETag ${r} after one retry. Check browser extensions and servers for issues that may affect correct ETag headers.`);if(p.status>=300)throw Error(`Bad response code: ${p.status}`);const _=p.headers.get("Content-Length");if(p.status===200&&(!_||+_>e))throw i&&i.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield p.arrayBuffer(),etag:y||void 0,cacheControl:p.headers.get("Cache-Control")||void 0,expires:p.headers.get("Expires")||void 0}})}};function hu(t,e){const n=t.getUint32(e+4,!0),r=t.getUint32(e+0,!0);return n*Vv(2,32)+r}function Zne(t,e){const n=new DataView(t),r=n.getUint8(7);if(r>3)throw Error(`Archive is spec version ${r} but this library supports up to spec version 3`);return{specVersion:r,rootDirectoryOffset:hu(n,8),rootDirectoryLength:hu(n,16),jsonMetadataOffset:hu(n,24),jsonMetadataLength:hu(n,32),leafDirectoryOffset:hu(n,40),leafDirectoryLength:hu(n,48),tileDataOffset:hu(n,56),tileDataLength:hu(n,64),numAddressedTiles:hu(n,72),numTileEntries:hu(n,80),numTileContents:hu(n,88),clustered:n.getUint8(96)===1,internalCompression:n.getUint8(97),tileCompression:n.getUint8(98),tileType:n.getUint8(99),minZoom:n.getUint8(100),maxZoom:n.getUint8(101),minLon:n.getInt32(102,!0)/1e7,minLat:n.getInt32(106,!0)/1e7,maxLon:n.getInt32(110,!0)/1e7,maxLat:n.getInt32(114,!0)/1e7,centerZoom:n.getUint8(118),centerLon:n.getInt32(119,!0)/1e7,centerLat:n.getInt32(123,!0)/1e7,etag:e}}function NN(t){const e={buf:new Uint8Array(t),pos:0},n=g0(e),r=[];let i=0;for(let l=0;l<n;l++){const c=g0(e);r.push({tileId:i+c,offset:0,length:0,runLength:1}),i+=c}for(let l=0;l<n;l++)r[l].runLength=g0(e);for(let l=0;l<n;l++)r[l].length=g0(e);for(let l=0;l<n;l++){const c=g0(e);c===0&&l>0?r[l].offset=r[l-1].offset+r[l-1].length:r[l].offset=c-1}return r}function Yne(t){const e=new DataView(t);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var iT=class extends Error{};function Kne(t,e){return Gs(this,null,function*(){const n=yield t.getBytes(0,16384);if(new DataView(n.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(Yne(n.data)<3)return[yield ON.getHeader(t)];const i=n.data.slice(0,Wne),l=Zne(i,n.etag),c=n.data.slice(l.rootDirectoryOffset,l.rootDirectoryOffset+l.rootDirectoryLength),s=`${t.getKey()}|${l.etag||""}|${l.rootDirectoryOffset}|${l.rootDirectoryLength}`,p=NN(yield e(c,l.internalCompression));return[l,[s,p.length,p]]})}function Jne(t,e,n,r,i){return Gs(this,null,function*(){const l=yield t.getBytes(n,r,void 0,i.etag),c=yield e(l.data,i.internalCompression),s=NN(c);if(s.length===0)throw new Error("Empty directory is invalid");return s})}var Qne=class{constructor(t=100,e=!0,n=FN){this.cache=new Map,this.invalidations=new Map,this.maxCacheEntries=t,this.counter=1,this.decompress=n}getHeader(t){return Gs(this,null,function*(){const e=t.getKey(),n=this.cache.get(e);if(n)return n.lastUsed=this.counter++,yield n.data;const r=new Promise((i,l)=>{Kne(t,this.decompress).then(c=>{c[1]&&this.cache.set(c[1][0],{lastUsed:this.counter++,data:Promise.resolve(c[1][2])}),i(c[0]),this.prune()}).catch(c=>{l(c)})});return this.cache.set(e,{lastUsed:this.counter++,data:r}),r})}getDirectory(t,e,n,r){return Gs(this,null,function*(){const i=`${t.getKey()}|${r.etag||""}|${e}|${n}`,l=this.cache.get(i);if(l)return l.lastUsed=this.counter++,yield l.data;const c=new Promise((s,p)=>{Jne(t,this.decompress,e,n,r).then(y=>{s(y),this.prune()}).catch(y=>{p(y)})});return this.cache.set(i,{lastUsed:this.counter++,data:c}),c})}getArrayBuffer(t,e,n,r){return Gs(this,null,function*(){const i=`${t.getKey()}|${r.etag||""}|${e}|${n}`,l=this.cache.get(i);if(l)return l.lastUsed=this.counter++,yield l.data;const c=new Promise((s,p)=>{t.getBytes(e,n,void 0,r.etag).then(y=>{s(y.data),this.cache.has(i),this.prune()}).catch(y=>{p(y)})});return this.cache.set(i,{lastUsed:this.counter++,data:c}),c})}prune(){if(this.cache.size>=this.maxCacheEntries){let t=1/0,e;this.cache.forEach((n,r)=>{n.lastUsed<t&&(t=n.lastUsed,e=r)}),e&&this.cache.delete(e)}}invalidate(t){return Gs(this,null,function*(){const e=t.getKey();if(this.invalidations.get(e))return yield this.invalidations.get(e);this.cache.delete(t.getKey());const n=new Promise((r,i)=>{this.getHeader(t).then(l=>{r(),this.invalidations.delete(e)}).catch(l=>{i(l)})});this.invalidations.set(e,n)})}},FL=class{constructor(t,e,n){typeof t=="string"?this.source=new Xne(t):this.source=t,n?this.decompress=n:this.decompress=FN,e?this.cache=e:this.cache=new Qne}getHeader(){return Gs(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(t,e,n,r){return Gs(this,null,function*(){const i=Hne(t,e,n),l=yield this.cache.getHeader(this.source);if(l.specVersion<3)return ON.getZxy(l,this.source,this.cache,t,e,n,r);if(t<l.minZoom||t>l.maxZoom)return;let c=l.rootDirectoryOffset,s=l.rootDirectoryLength;for(let p=0;p<=3;p++){const y=yield this.cache.getDirectory(this.source,c,s,l),_=qne(y,i);if(_){if(_.runLength>0){const w=yield this.source.getBytes(l.tileDataOffset+_.offset,_.length,r,l.etag);return{data:yield this.decompress(w.data,l.tileCompression),cacheControl:w.cacheControl,expires:w.expires}}c=l.leafDirectoryOffset+_.offset,s=_.length}else return}throw Error("Maximum directory depth exceeded")})}getZxy(t,e,n,r){return Gs(this,null,function*(){try{return yield this.getZxyAttempt(t,e,n,r)}catch(i){if(i instanceof iT)return this.cache.invalidate(this.source),yield this.getZxyAttempt(t,e,n,r);throw i}})}getMetadataAttempt(){return Gs(this,null,function*(){const t=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(t.jsonMetadataOffset,t.jsonMetadataLength,void 0,t.etag),n=yield this.decompress(e.data,t.internalCompression),r=new TextDecoder("utf-8");return JSON.parse(r.decode(n))})}getMetadata(){return Gs(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(t){if(t instanceof iT)return this.cache.invalidate(this.source),yield this.getMetadataAttempt();throw t}})}getTileJson(t){return Gs(this,null,function*(){const e=yield this.getHeader(),n=yield this.getMetadata(),r=Gne(e.tileType);return{tilejson:"3.0.0",scheme:"xyz",tiles:[`${t}/{z}/{x}/{y}${r}`],vector_layers:n.vector_layers,attribution:n.attribution,description:n.description,name:n.name,version:n.version,bounds:[e.minLon,e.minLat,e.maxLon,e.maxLat],center:[e.centerLon,e.centerLat,e.centerZoom],minzoom:e.minZoom,maxzoom:e.maxZoom}})}};let NL=!1;function LA(){if(NL)return;const t=new Une;MN.addProtocol("pmtiles",t.tile),NL=!0}const lS=t=>{LA();const{mode:e="light",children:n,tileRootUrl:r}=t,i=sS[e];return ie.jsxs(ie.Fragment,{children:[ie.jsx(Rr,{id:"background",type:"background",paint:{"background-color":i.land}}),ie.jsxs(ap,{id:"world",type:"vector",url:`pmtiles://${r}/world.pmtiles`,children:[ie.jsx(Rr,{"source-layer":"water",type:"fill",paint:{"fill-color":i.water}}),n,ie.jsx(Rr,{"source-layer":"states",type:"line",paint:{"line-color":i.stateBorder,"line-width":1,"line-opacity":1,"line-dasharray":[2,2]}}),ie.jsx(Rr,{"source-layer":"countries",type:"line",filter:["!=",["get","name"],"Serbia-Kosovo"],paint:{"line-color":i.countryBorder,"line-width":2,"line-opacity":1}}),ie.jsx(Rr,{"source-layer":"countries",type:"line",filter:["==",["get","name"],"Serbia-Kosovo"],paint:{"line-color":i.countryBorder,"line-width":2,"line-opacity":1,"line-dasharray":[3,2]}})]})]})},oT=t=>(LA(),ie.jsx(ap,{type:"vector",url:`pmtiles://${t.tileRootUrl}/${t.game}-contours.pmtiles`,children:ie.jsx(Rr,{"source-layer":"contours",type:"fill",layout:{"fill-sort-key":["get","elevation"],visibility:t.showContours?"visible":"none"},paint:{"fill-color":["interpolate",["linear"],["get","elevation"],-200,"#77c571",0,"#77c571",100,"#afd35f",150,"#ece75b",200,"#decb4c",250,"#d2b446",300,"#bf9c4a",400,"#ba8839",500,"#ac792d"]}})}));var Co=(t=>(t[t.FuelStation=0]="FuelStation",t[t.Toll=1]="Toll",t[t.Parking=2]="Parking",t[t.RecruitmentAgency=3]="RecruitmentAgency",t[t.Service=4]="Service",t[t.TruckDealer=5]="TruckDealer",t[t.Port=6]="Port",t[t.Train=7]="Train",t[t.Viewpoint=8]="Viewpoint",t[t.PhotoSight=9]="PhotoSight",t[t.AgricultureCheck=10]="AgricultureCheck",t[t.BorderCheck=11]="BorderCheck",t[t.Garage=12]="Garage",t[t.WeighStation=13]="WeighStation",t[t.CityNames=14]="CityNames",t[t.Company=15]="Company",t[t.RoadNumber=16]="RoadNumber",t[t.Roadwork=17]="Roadwork",t[t.RailCrossing=18]="RailCrossing",t))(Co||{});const Gm=new Set(Array.from({length:19},(t,e)=>e)),ry=t=>{const{game:e,tileRootUrl:n,visibleIcons:r=Gm,enableIconAutoHide:i=!0,showSecrets:l=!0,mode:c="light",specialEvent:s}=t,p=s?!0:e==="ats"?$L(e,t.dlcs??Hm):$L(e,t.dlcs??Ate),y=l?!0:["==",["get","secret"],!1],_=sS[c];LA();const w=ox();return G.useEffect(()=>{if(!w.current)return;const S=w.current;S.on("styleimagemissing",M=>{if(M.id!=="exit-sign"||S.hasImage("exit-sign"))return;const I=64,D=4,R=new Uint8Array(I*I*D);for(let V=0;V<I;V++)for(let B=0;B<I;B++){const H=(B*I+V)*D;B===0||B===I-1||V===0||V===I-1?(R[H+0]=136,R[H+1]=136,R[H+2]=136,R[H+3]=255):V===1||V===2||V===I-2||V===I-3||B===1||B===2||B===I-2||B===I-3?(R[H+0]=255,R[H+1]=255,R[H+2]=255,R[H+3]=255):(R[H+0]=82,R[H+1]=177,R[H+2]=129,R[H+3]=255)}const L=8;S.addImage("exit-sign",{width:I,height:I,data:R},{stretchX:[[L,I-L]],stretchY:[[L,I-L]],content:[L,L,I-L,I-L],pixelRatio:2})})},[w.current]),ie.jsxs(ap,{id:e,type:"vector",url:`pmtiles://${n}/${s??e}.pmtiles`,children:[ie.jsx(Rr,{id:e+"mapAreas","source-layer":e,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"mapArea"],p,y],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":P2(c),"fill-outline-color":["case",["==",["get","color"],_N.Road],_.mapAreaOutline,P2(c)]}}),ie.jsx(Rr,{id:e+"prefabs","source-layer":e,type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"prefab"],p,y],layout:{"fill-sort-key":["get","zIndex"]},paint:{"fill-color":P2(c)}}),ie.jsx(ere,{game:e,specialEvent:s,tileRootUrl:n,mode:c,color:_.footprint}),ie.jsx(Rr,{id:e+"hidden-roads","source-layer":e,type:"line",minzoom:9,filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","hidden"],!0],p],paint:{"line-color":_.hiddenRoad,"line-width":1,"line-opacity":.7}}),ie.jsx(Rr,{id:e+"visible-roads-case","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],p,y],layout:VL,paint:{"line-color":sre(c),"line-gap-width":jL,"line-width":["interpolate",["exponential",1.5],["zoom"],10,1,14,2,16,3]}}),ie.jsx(Rr,{id:e+"visible-roads","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["!=",["get","roadType"],"train"],["==",["get","hidden"],!1],p,y],layout:VL,paint:{"line-color":ore(c),"line-width":jL}}),ie.jsx(Rr,{id:e+"ferries","source-layer":e,type:"line",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],paint:{"line-color":_.ferryLine,"line-width":1,"line-opacity":.8,"line-dasharray":[2,2]}}),ie.jsx(Rr,{id:e+"trains-a","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":_.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,-6]}}),ie.jsx(Rr,{id:e+"trains-b","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":_.trainLine,"line-width":2,"line-opacity":.8,"line-offset":["interpolate",["exponential",1.5],["zoom"],9,0,14,6]}}),ie.jsx(Rr,{id:e+"train-hatch","source-layer":e,type:"line",filter:["any",["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"road"],["==",["get","roadType"],"train"],["==",["get","hidden"],!1]]],paint:{"line-color":_.trainLine,"line-width":10,"line-opacity":.8,"line-dasharray":[.1,1]}}),ie.jsx(Rr,{id:e+"ferry-labels","source-layer":e,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"ferry"]],layout:{...mh,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":_.ferryHalo,"text-color":_.ferryLabel}}),ie.jsx(Rr,{id:e+"train-labels","source-layer":e,minzoom:7.5,type:"symbol",filter:["all",["==",["geometry-type"],"LineString"],["==",["get","type"],"train"]],layout:{...mh,"symbol-placement":"line-center","text-field":"{name}","text-size":12},paint:{"text-halo-width":2,"text-halo-color":_.trainHalo,"text-color":_.trainLabel}}),r.has(15)&&ie.jsx(Rr,{id:e+"company-icons","source-layer":e,type:"symbol",minzoom:i?8:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"company"],p,y],layout:Rd(i,1,1.25,3.5)}),e==="ets2"&&r.has(16)&&ie.jsx(Rr,{id:"euro-road-overlays","source-layer":e,minzoom:i?4.5:0,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["!",["in",["get","sprite"],["literal",BL]]],y],layout:Rd(i,.4*1.25,.75*1.25,1.25*1.25)}),e==="ats"&&r.has(16)&&ie.jsx(Rr,{id:e+"road-interstate-overlays","source-layer":e,type:"symbol",filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","is",["get","sprite"]],0],p,y],layout:Rd(i,.4,.75,1.25)}),e==="ats"&&r.has(16)&&ie.jsx(Rr,{id:e+"road-us-route-overlays","source-layer":e,type:"symbol",minzoom:i?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],["==",["index-of","us",["get","sprite"]],0],p,y],layout:Rd(i,.4,.75,1.25)}),e==="ats"&&r.has(16)&&ie.jsx(Rr,{id:e+"road-state-route-overlays","source-layer":e,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["==",["get","poiType"],"road"],p,y,["!",["any",["==",["index-of","is",["get","sprite"]],0],["==",["index-of","us",["get","sprite"]],0],["in",["get","sprite"],["literal",BL]]]]],layout:Rd(i,.4,.75,1.25)}),r.has(16)&&ie.jsx(Rr,{id:e+"exit-points","source-layer":e,type:"symbol",paint:{"text-color":"#fff"},minzoom:i?10:0,layout:{...Rd(i,.4,.75,1.25),...mh,"text-field":"{name}","text-size":["interpolate",["linear"],["zoom"],4,4,10,10],"icon-text-fit":"both","icon-text-fit-padding":[0,2,0,2],"icon-image":"exit-sign"},filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"exit"],p]}),r.has(14)&&ie.jsx(Rr,{id:e+"city-labels-small","source-layer":e,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],[">",["get","scaleRank"],6],p],layout:{...mh,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":_v,"text-size":12,"icon-image":T2,"icon-allow-overlap":!i,"icon-size":.6},paint:_.primaryTextPaint}),r.has(14)&&ie.jsx(Rr,{id:e+"city-labels-medium","source-layer":e,type:"symbol",minzoom:i?5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],6],[">",["get","scaleRank"],3],p],layout:{...mh,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":_v,"text-size":13,"icon-image":T2,"icon-allow-overlap":!i,"icon-size":.6},paint:_.primaryTextPaint}),r.has(14)&&ie.jsx(Rr,{id:e+"city-labels-big","source-layer":e,type:"symbol",minzoom:i?4:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"city"],["<=",["get","scaleRank"],3],p],layout:{...mh,"text-field":"{name}","text-allow-overlap":!i,"text-variable-anchor":_v,"text-size":14,"icon-image":T2,"icon-allow-overlap":!i,"icon-size":.8},paint:_.primaryTextPaint}),e==="ets2"&&r.has(14)&&ie.jsx(Rr,{id:e+"country-labels","source-layer":e,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...mh,"text-font":["Klokantech Noto Sans Bold"],"text-field":"{name}","text-variable-anchor":_v,"text-size":14},paint:_.primaryTextPaint}),e==="ats"&&r.has(14)&&ie.jsx(Rr,{id:e+"country-labels","source-layer":e,type:"symbol",minzoom:4,maxzoom:6.5,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"country"]],layout:{...mh,"text-font":["Open Sans Light"],"text-field":"{name}","text-transform":"uppercase","text-variable-anchor":_v,"text-size":["step",["zoom"],10,5,13]},paint:_.secondaryTextPaint}),sT(r)&&ie.jsx(Rr,{id:e+"poi-icons","source-layer":e,type:"symbol",minzoom:i?7:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],UL(r),p,y],layout:Rd(i,.6,1.25,2.5,{vertical:2,horizontal:2})}),sT(r)&&(r.has(8)||r.has(9)||r.has(5))&&ie.jsx(Rr,{id:e+"poi-icon-labels","source-layer":e,type:"symbol",minzoom:i?9.5:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"poi"],["any",["in",["get","poiType"],["literal",["viewpoint","landmark"]]],["all",["==",["get","poiType"],"facility"],["==",["get","sprite"],"dealer_ico"]]],UL(r),p,y],layout:{...Rd(i,.6,1.25,2.5,{vertical:2,horizontal:2}),...mh,"text-field":"{poiName}","text-allow-overlap":!i,"text-variable-anchor":["left","right","top","bottom"],"text-radial-offset":1.5,"text-size":10},paint:_.primaryTextPaint}),(r.has(17)||r.has(18))&&ie.jsx(Rr,{id:e+"traffic-icons","source-layer":e,type:"symbol",minzoom:i?6:0,filter:["all",["==",["geometry-type"],"Point"],["==",["get","type"],"traffic"],rre(r),p,y],layout:Rd(i,.6*.5,1.25*.5,2.5*.5,{vertical:2,horizontal:2})})]})},ere=({game:t,tileRootUrl:e,color:n,mode:r,specialEvent:i})=>ie.jsxs(ap,{id:t+"footprints",type:"vector",url:`pmtiles://${e}/${i??t}-footprints.pmtiles`,children:[ie.jsx(Rr,{id:t+"footprints","source-layer":"footprints",type:"fill",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-color":n,"fill-opacity":["step",["zoom"],1,9,.8]}}),ie.jsx(Rr,{id:t+"extrusions",minzoom:9,"source-layer":"footprints",type:"fill-extrusion",filter:["all",["==",["geometry-type"],"Polygon"],["==",["get","type"],"footprint"]],paint:{"fill-extrusion-color":n,"fill-extrusion-height":["interpolate",["exponential",1.5],["zoom"],9,["*",10,["get","height"]],13,["*",20,["get","height"]]],"fill-extrusion-opacity":r==="light"?.33:.67}})]});function Rd(t,e,n,r,i={vertical:10,horizontal:30}){const l=["literal",[i.vertical,i.horizontal]];return{"icon-image":"{sprite}","icon-allow-overlap":!t,"icon-padding":l,"icon-size":["interpolate",["exponential",1.5],["zoom"],4,e,9,n,13,r]}}const T2=["step",["zoom"],["case",["==",["get","capital"],2],"dotdot","dot"],8,""],tre=[9,8,6,7,2,0,4,5,12,3,13,1,10,11],BN=[17,18],BL=["weigh_ico","toll_ico","agri_check","border_ico"];function sT(t){return tre.some(e=>t.has(e))}function nre(t){return BN.some(e=>t.has(e))}function rre(t){jm.checkArgument(nre(t));const e=[];return t.has(17)&&e.push("roadwork"),t.has(18)&&e.push("railcrossing"),["any",e.length>0?["in",["get","sprite"],["literal",e]]:!1]}function UL(t){jm.checkArgument(sT(t));const e=[];t.has(9)&&e.push("landmark"),t.has(8)&&e.push("viewpoint"),t.has(6)&&e.push("ferry"),t.has(7)&&e.push("train");const n=[];t.has(0)&&n.push("gas_ico"),t.has(4)&&n.push("service_ico"),t.has(13)&&n.push("weigh_station_ico"),t.has(5)&&n.push("dealer_ico"),t.has(12)&&n.push("garage_large_ico"),t.has(3)&&n.push("recruitment_ico"),t.has(2)&&n.push("parking_ico");const r=[];t.has(13)&&r.push("weigh_ico"),t.has(1)&&r.push("toll_ico"),t.has(10)&&r.push("agri_check"),t.has(11)&&r.push("border_ico");const i=e.length>0?["in",["get","poiType"],["literal",e]]:!1,l=n.length>0?["all",["==",["get","poiType"],"facility"],["in",["get","sprite"],["literal",n]]]:!1,c=r.length>0?["all",["==",["get","poiType"],"road"],["in",["get","sprite"],["literal",r]]]:!1;return["any",i,l,c]}function $L(t,e){let n;return t==="ats"?n=ix(e):(n=Rte(e),n.add(null)),["in",["get","dlcGuard"],["literal",[...n]]]}const _v=["step",["zoom"],["literal",["top","bottom","right","left"]],7,["literal",["center"]]],mh={"text-radial-offset":.5,"text-justify":"auto","text-font":["Klokantech Noto Sans Regular"]},VL={"line-cap":"round","line-join":"bevel"},jL=["interpolate",["exponential",1.5],["zoom"],3,.8,14,30,16,150],UN={light:{freeway:["#fde293","#f8c248"],divided:["#ffffff","#dddddd"],no_vehicles:["#aaaaaa","#888888"],local:["#f1f3f4","#dddddd"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]},dark:{freeway:["#95813e","#372f21"],divided:["#3c4043","#4c5043"],no_vehicles:["#606166","#888888"],local:["#606166","#333"],train:["#ff0000","#f8c248"],tram:["#00ff00","#f8c248"],unknown:["#f0f","#f0f"]}},ire={light:{0:"hsl(200, 8%, 92%)",1:"hsl(38, 59%, 76%)",2:"hsl(38, 64%, 58%)",3:"hsl(92, 31%, 70%)",4:"hsl(0, 100%, 30%)",5:"hsl(107, 51%, 43%)",6:"hsl(201, 53%, 39%)",7:"hsl(53, 84%, 53%)",8:"hsl(267,46% ,45%)"},dark:{0:"hsl(200, 2%, 36%)",1:"hsl(38, 25%, 35%)",2:"hsl(38, 25%, 25%)",3:"hsl(143, 20%, 25%)",4:"hsl(0, 100%, 25%)",5:"hsl(107, 51%, 25%)",6:"hsl(201, 53%, 25%)",7:"hsl(53, 84%, 25%)",8:"hsl(267, 46%, 25%)"}},ore=t=>["match",["get","roadType"],...Object.entries(UN[t]).flatMap(([e,[n]])=>[e,n]),"#f0f"],sre=t=>["match",["get","roadType"],...Object.entries(UN[t]).flatMap(([e,[,n]])=>[e,n]),"#b0b"],P2=t=>["match",["get","color"],...Object.entries(ire[t]).flatMap(([e,n])=>[Number(e),n]),"#b0b"],are="/extra-labels.geojson",lre="/ets2-villages.geojson";var fs=(t=>(t.AR="AR",t.AZ="AZ",t.CA="CA",t.CO="CO",t.IA="IA",t.ID="ID",t.KS="KS",t.MO="MO",t.MT="MT",t.NE="NE",t.NM="NM",t.NV="NV",t.OK="OK",t.OR="OR",t.TX="TX",t.UT="UT",t.WA="WA",t.WY="WY",t))(fs||{});const cre={AR:void 0,AZ:void 0,CA:void 0,CO:void 0,IA:void 0,ID:void 0,KS:void 0,MO:void 0,MT:void 0,NE:void 0,NM:void 0,NV:void 0,OK:void 0,OR:void 0,TX:void 0,UT:void 0,WA:void 0,WY:void 0},ure=new Set(Object.keys(cre)),aT=t=>{const{game:e,enableAutoHide:n=!0,mode:r="light"}=t,i=e==="ats"?are:lre,l=e==="ats"?["all",["boolean",["get","show"],!0],["in",["slice",["get","country"],-2],["literal",[...t.enabledStates??ure]]]]:["boolean",!0],c=sS[r];return ie.jsx(ap,{id:`${e}-scenery-towns`,type:"geojson",data:i,children:ie.jsx(Rr,{id:`${e}-scenery-towns`,type:"symbol",minzoom:n?7:0,filter:l,layout:{...mh,"text-field":e==="ats"?"{text}":"{name}","text-allow-overlap":!n,"text-variable-anchor":_v,"text-size":10.5},paint:c.primaryTextPaint})})},kA={version:8,glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf",sources:{},layers:[]},DA={get(t,e,n){return e==="sprite"&&typeof t.sprite=="string"&&/^\/\w/.exec(t.sprite.toString())?window.location.origin+t.sprite:Reflect.get(t,e,n)}},cS=new Proxy({...kA,sprite:"/sprites"},DA),hre=new Proxy({...kA,sprite:"/halloween-sprites"},DA),dre=new Proxy({...kA,sprite:"/christmas-sprites"},DA);var Il=63710088e-1,fre={centimeters:Il*100,centimetres:Il*100,degrees:360/(2*Math.PI),feet:Il*3.28084,inches:Il*39.37,kilometers:Il/1e3,kilometres:Il/1e3,meters:Il,metres:Il,miles:Il/1609.344,millimeters:Il*1e3,millimetres:Il*1e3,nauticalmiles:Il/1852,radians:1,yards:Il*1.0936};function lT(t,e,n={}){const r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function m1(t,e,n={}){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!GL(t[0])||!GL(t[1]))throw new Error("coordinates must contain numbers");return lT({type:"Point",coordinates:t},e,n)}function pre(t,e="kilometers"){const n=fre[e];if(!n)throw new Error(e+" units is invalid");return t*n}function HL(t){return t%(2*Math.PI)*180/Math.PI}function Ev(t){return t%360*Math.PI/180}function GL(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function Tv(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return[...t.geometry.coordinates];if(t.type==="Point")return[...t.coordinates]}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return[...t];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function mre(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function xh(t,e,n={}){var r=Tv(t),i=Tv(e),l=Ev(i[1]-r[1]),c=Ev(i[0]-r[0]),s=Ev(r[1]),p=Ev(i[1]),y=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(c/2),2)*Math.cos(s)*Math.cos(p);return pre(2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y)),n.units)}function gre(t,e){var n,r,i,l,c,s,p,y,_,w,S=0,M=t.type==="FeatureCollection",I=t.type==="Feature",D=M?t.features.length:1;for(n=0;n<D;n++){for(s=M?t.features[n].geometry:I?t.geometry:t,y=M?t.features[n].properties:I?t.properties:{},_=M?t.features[n].bbox:I?t.bbox:void 0,w=M?t.features[n].id:I?t.id:void 0,p=s?s.type==="GeometryCollection":!1,c=p?s.geometries.length:1,i=0;i<c;i++){if(l=p?s.geometries[i]:s,l===null){if(e(null,S,y,_,w)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(l,S,y,_,w)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<l.geometries.length;r++)if(e(l.geometries[r],S,y,_,w)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}S++}}function vre(t,e){gre(t,function(n,r,i,l,c){var s=n===null?null:n.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(lT(n,i,{bbox:l,id:c}),r,0)===!1?!1:void 0}var p;switch(s){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon";break}for(var y=0;y<n.coordinates.length;y++){var _=n.coordinates[y],w={type:p,coordinates:_};if(e(lT(w,i),r,y)===!1)return!1}})}var yre=Object.defineProperty,_re=Object.defineProperties,xre=Object.getOwnPropertyDescriptors,WL=Object.getOwnPropertySymbols,bre=Object.prototype.hasOwnProperty,wre=Object.prototype.propertyIsEnumerable,qL=(t,e,n)=>e in t?yre(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,XL=(t,e)=>{for(var n in e||(e={}))bre.call(e,n)&&qL(t,n,e[n]);if(WL)for(var n of WL(e))wre.call(e,n)&&qL(t,n,e[n]);return t},ZL=(t,e)=>_re(t,xre(e));function Sre(t,e,n={}){if(!t||!e)throw new Error("lines and pt are required arguments");const r=Tv(e);let i=m1([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),l=0;return vre(t,function(c,s,p){const y=mre(c);for(let _=0;_<y.length-1;_++){const w=m1(y[_]);w.properties.dist=xh(e,w,n);const S=Tv(w),M=m1(y[_+1]);M.properties.dist=xh(e,M,n);const I=Tv(M),D=xh(w,M,n);let R,L;S[0]===r[0]&&S[1]===r[1]?[R,,L]=[S,void 0,!1]:I[0]===r[0]&&I[1]===r[1]?[R,,L]=[I,void 0,!0]:[R,,L]=Ere(w.geometry.coordinates,M.geometry.coordinates,Tv(e));let V;R&&(V=m1(R,{dist:xh(e,R,n),multiFeatureIndex:p,location:l+xh(w,R,n)})),V&&V.properties.dist<i.properties.dist&&(i=ZL(XL({},V),{properties:ZL(XL({},V.properties),{index:L?_+1:_})})),l+=D}}),i}function Mre(t,e){const[n,r,i]=t,[l,c,s]=e;return n*l+r*c+i*s}function Cre(t,e){const[n,r,i]=t,[l,c,s]=e;return[r*s-i*c,i*l-n*s,n*c-r*l]}function YL(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2))}function gm(t,e){const n=Mre(t,e)/(YL(t)*YL(e));return Math.acos(Math.min(Math.max(n,-1),1))}function A2(t){const e=Ev(t[1]),n=Ev(t[0]);return[Math.cos(e)*Math.cos(n),Math.cos(e)*Math.sin(n),Math.sin(e)]}function vm(t){const[e,n,r]=t,i=HL(Math.asin(r));return[HL(Math.atan2(n,e)),i]}function Ere(t,e,n){const r=A2(t),i=A2(e),l=A2(n),[c,s,p]=l,[y,_,w]=Cre(r,i),S=_*p-w*s,M=w*c-y*p,I=y*s-_*c,D=I*_-M*w,R=S*w-I*y,L=M*y-S*_,V=1/Math.sqrt(Math.pow(D,2)+Math.pow(R,2)+Math.pow(L,2)),B=[D*V,R*V,L*V],H=[-1*D*V,-1*R*V,-1*L*V],q=gm(r,i),X=gm(r,B),ee=gm(i,B),se=gm(r,H),J=gm(i,H);let $;return X<se&&X<J||ee<se&&ee<J?$=B:$=H,gm(r,$)>q||gm(i,$)>q?xh(vm($),vm(r))<=xh(vm($),vm(i))?[vm(r),!0,!1]:[vm(i),!1,!0]:[vm($),!1,!1]}var Tre=Sre;const Pre=Rs(ie.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"})),Are=Rs(ie.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6"})),Ire=Rs(ie.jsx("path",{d:"M10.85 12.65h2.3L12 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM14.3 16l-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9z"})),Rre=Rs(ie.jsx("path",{d:"M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6m0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4"})),Lre=Rs(ie.jsx("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6"})),KL=Rs(ie.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"})),kre=Rs(ie.jsx("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2M5 8V7h2v3.82C5.84 10.4 5 9.3 5 8m14 0c0 1.3-.84 2.4-2 2.82V7h2z"})),Dre=Rs(ie.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),zre=Rs(ie.jsx("path",{d:"m12 5.69 5 4.5V18h-2v-6H9v6H7v-7.81zM12 3 2 12h3v8h6v-6h2v6h6v-8h3z"})),Ore=Rs(ie.jsx("path",{d:"m16 5-1.42 1.42-1.59-1.59V16h-1.98V4.83L9.42 6.42 8 5l4-4zm4 5v11c0 1.1-.9 2-2 2H6c-1.11 0-2-.9-2-2V10c0-1.11.89-2 2-2h3v2H6v11h12V10h-3V8h3c1.1 0 2 .89 2 2"})),Fre=Rs(ie.jsx("path",{d:"M19 5v14H5V5zm1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9M11 7h6v2h-6zm0 4h6v2h-6zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z"})),Nre=Rs(ie.jsx("path",{d:"M15 11V5l-3-3-3 3v2H3v14h18V11zm-8 8H5v-2h2zm0-4H5v-2h2zm0-4H5V9h2zm6 8h-2v-2h2zm0-4h-2v-2h2zm0-4h-2V9h2zm0-4h-2V5h2zm6 12h-2v-2h2zm0-4h-2v-2h2z"})),Bre=Rs(ie.jsx("path",{d:"M2 18v4h3v-2h5.5v2h3v-2H19v2h3v-4zM18 2H6c-.55 0-1 .45-1 1v12c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1m-3 6H9V6h6z"})),Ure=Rs(ie.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),$N=Rs(ie.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39"})),VN=Rs(ie.jsx("path",{d:"m21.58 16.09-1.09-7.66C20.21 6.46 18.52 5 16.53 5H7.47C5.48 5 3.79 6.46 3.51 8.43l-1.09 7.66C2.2 17.63 3.39 19 4.94 19c.68 0 1.32-.27 1.8-.75L9 16h6l2.25 2.25c.48.48 1.13.75 1.8.75 1.56 0 2.75-1.37 2.53-2.91M11 11H9v2H8v-2H6v-1h2V8h1v2h2zm4-1c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1m2 3c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),$re=Rs(ie.jsx("path",{d:"M20.69 4.05C18.66 4.73 15.86 5.5 12 5.5c-3.89 0-6.95-.84-8.69-1.43-.64-.22-1.31.26-1.31.95V19c0 .68.66 1.17 1.31.95C5.36 19.26 8.1 18.5 12 18.5c3.87 0 6.66.76 8.69 1.45.65.21 1.31-.27 1.31-.95V5c0-.68-.66-1.16-1.31-.95M12 15c-2.34 0-4.52.15-6.52.41l3.69-4.42 2 2.4L14 10l4.51 5.4c-1.99-.25-4.21-.4-6.51-.4"}));function Vre(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var e=1;e<=60;++e)t("EPSG:"+(32600+e),"+proj=utm +zone="+e+" +datum=WGS84 +units=m"),t("EPSG:"+(32700+e),"+proj=utm +zone="+e+" +south +datum=WGS84 +units=m");t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}var Wm=1,qm=2,jv=3,jre=4,cT=5,JL=6378137,Hre=6356752314e-3,QL=.0066943799901413165,q0=484813681109536e-20,En=Math.PI/2,Gre=.16666666666666666,Wre=.04722222222222222,qre=.022156084656084655,Xn=1e-10,js=.017453292519943295,bh=57.29577951308232,_i=Math.PI/4,C_=Math.PI*2,ko=3.14159265359,al={};al.greenwich=0;al.lisbon=-9.131906111111;al.paris=2.337229166667;al.bogota=-74.080916666667;al.madrid=-3.687938888889;al.rome=12.452333333333;al.bern=7.439583333333;al.jakarta=106.807719444444;al.ferro=-17.666666666667;al.brussels=4.367975;al.stockholm=18.058277777778;al.athens=23.7163375;al.oslo=10.722916666667;const Xre={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.01},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var ek=/[\s_\-\/\(\)]/g;function lp(t,e){if(t[e])return t[e];for(var n=Object.keys(t),r=e.toLowerCase().replace(ek,""),i=-1,l,c;++i<n.length;)if(l=n[i],c=l.toLowerCase().replace(ek,""),c===r)return t[l]}function uT(t){var e={},n=t.split("+").map(function(s){return s.trim()}).filter(function(s){return s}).reduce(function(s,p){var y=p.split("=");return y.push(!0),s[y[0].toLowerCase()]=y[1],s},{}),r,i,l,c={proj:"projName",datum:"datumCode",rf:function(s){e.rf=parseFloat(s)},lat_0:function(s){e.lat0=s*js},lat_1:function(s){e.lat1=s*js},lat_2:function(s){e.lat2=s*js},lat_ts:function(s){e.lat_ts=s*js},lon_0:function(s){e.long0=s*js},lon_1:function(s){e.long1=s*js},lon_2:function(s){e.long2=s*js},alpha:function(s){e.alpha=parseFloat(s)*js},gamma:function(s){e.rectified_grid_angle=parseFloat(s)},lonc:function(s){e.longc=s*js},x_0:function(s){e.x0=parseFloat(s)},y_0:function(s){e.y0=parseFloat(s)},k_0:function(s){e.k0=parseFloat(s)},k:function(s){e.k0=parseFloat(s)},a:function(s){e.a=parseFloat(s)},b:function(s){e.b=parseFloat(s)},r:function(s){e.a=e.b=parseFloat(s)},r_a:function(){e.R_A=!0},zone:function(s){e.zone=parseInt(s,10)},south:function(){e.utmSouth=!0},towgs84:function(s){e.datum_params=s.split(",").map(function(p){return parseFloat(p)})},to_meter:function(s){e.to_meter=parseFloat(s)},units:function(s){e.units=s;var p=lp(Xre,s);p&&(e.to_meter=p.to_meter)},from_greenwich:function(s){e.from_greenwich=s*js},pm:function(s){var p=lp(al,s);e.from_greenwich=(p||parseFloat(s))*js},nadgrids:function(s){s==="@null"?e.datumCode="none":e.nadgrids=s},axis:function(s){var p="ewnsud";s.length===3&&p.indexOf(s.substr(0,1))!==-1&&p.indexOf(s.substr(1,1))!==-1&&p.indexOf(s.substr(2,1))!==-1&&(e.axis=s)},approx:function(){e.approx=!0}};for(r in n)i=n[r],r in c?(l=c[r],typeof l=="function"?l(i):e[l]=i):e[r]=i;return typeof e.datumCode=="string"&&e.datumCode!=="WGS84"&&(e.datumCode=e.datumCode.toLowerCase()),e}var E_=1,jN=2,HN=3,Vb=4,GN=5,zA=-1,Zre=/\s/,Yre=/[A-Za-z]/,Kre=/[A-Za-z84_]/,uS=/[,\]]/,WN=/[\d\.E\-\+]/;function ef(t){if(typeof t!="string")throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=E_}ef.prototype.readCharicter=function(){var t=this.text[this.place++];if(this.state!==Vb)for(;Zre.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case E_:return this.neutral(t);case jN:return this.keyword(t);case Vb:return this.quoted(t);case GN:return this.afterquote(t);case HN:return this.number(t);case zA:return}};ef.prototype.afterquote=function(t){if(t==='"'){this.word+='"',this.state=Vb;return}if(uS.test(t)){this.word=this.word.trim(),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in afterquote yet, index '+this.place)};ef.prototype.afterItem=function(t){if(t===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=E_;return}if(t==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=E_,this.currentObject=this.stack.pop(),this.currentObject||(this.state=zA);return}};ef.prototype.number=function(t){if(WN.test(t)){this.word+=t;return}if(uS.test(t)){this.word=parseFloat(this.word),this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in number yet, index '+this.place)};ef.prototype.quoted=function(t){if(t==='"'){this.state=GN;return}this.word+=t};ef.prototype.keyword=function(t){if(Kre.test(t)){this.word+=t;return}if(t==="["){var e=[];e.push(this.word),this.level++,this.root===null?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,this.state=E_;return}if(uS.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in keyword yet, index '+this.place)};ef.prototype.neutral=function(t){if(Yre.test(t)){this.word=t,this.state=jN;return}if(t==='"'){this.word="",this.state=Vb;return}if(WN.test(t)){this.word=t,this.state=HN;return}if(uS.test(t)){this.afterItem(t);return}throw new Error(`havn't handled "`+t+'" in neutral yet, index '+this.place)};ef.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===zA)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function Jre(t){var e=new ef(t);return e.output()}function I2(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var r=e?{}:t,i=n.reduce(function(l,c){return Pv(c,l),l},r);e&&(t[e]=i)}function Pv(t,e){if(!Array.isArray(t)){e[t]=!0;return}var n=t.shift();if(n==="PARAMETER"&&(n=t.shift()),t.length===1){if(Array.isArray(t[0])){e[n]={},Pv(t[0],e[n]);return}e[n]=t[0];return}if(!t.length){e[n]=!0;return}if(n==="TOWGS84"){e[n]=t;return}if(n==="AXIS"){n in e||(e[n]=[]),e[n].push(t);return}Array.isArray(n)||(e[n]={});var r;switch(n){case"UNIT":case"PRIMEM":case"VERT_DATUM":e[n]={name:t[0].toLowerCase(),convert:t[1]},t.length===3&&Pv(t[2],e[n]);return;case"SPHEROID":case"ELLIPSOID":e[n]={name:t[0],a:t[1],rf:t[2]},t.length===4&&Pv(t[3],e[n]);return;case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":t[0]=["name",t[0]],I2(e,n,t);return;case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":t[0]=["name",t[0]],I2(e,n,t),e[n].type=n;return;default:for(r=-1;++r<t.length;)if(!Array.isArray(t[r]))return Pv(t,e[n]);return I2(e,n,t)}}var Qre=.017453292519943295,eie=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function tie(t,e){var n=e[0],r=e[1];!(n in t)&&r in t&&(t[n]=t[r],e.length===3&&(t[n]=e[2](t[n])))}function dh(t){return t*Qre}function qN(t){for(var e=Object.keys(t),n=0,r=e.length;n<r;++n){var i=e[n];eie.indexOf(i)!==-1&&nie(t[i]),typeof t[i]=="object"&&qN(t[i])}}function nie(t){if(t.AUTHORITY){var e=Object.keys(t.AUTHORITY)[0];e&&e in t.AUTHORITY&&(t.title=e+":"+t.AUTHORITY[e])}if(t.type==="GEOGCS"?t.projName="longlat":t.type==="LOCAL_CS"?(t.projName="identity",t.local=!0):typeof t.PROJECTION=="object"?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.AXIS){for(var n="",r=0,i=t.AXIS.length;r<i;++r){var l=[t.AXIS[r][0].toLowerCase(),t.AXIS[r][1].toLowerCase()];l[0].indexOf("north")!==-1||(l[0]==="y"||l[0]==="lat")&&l[1]==="north"?n+="n":l[0].indexOf("south")!==-1||(l[0]==="y"||l[0]==="lat")&&l[1]==="south"?n+="s":l[0].indexOf("east")!==-1||(l[0]==="x"||l[0]==="lon")&&l[1]==="east"?n+="e":(l[0].indexOf("west")!==-1||(l[0]==="x"||l[0]==="lon")&&l[1]==="west")&&(n+="w")}n.length===2&&(n+="u"),n.length===3&&(t.axis=n)}t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),t.units==="metre"&&(t.units="meter"),t.UNIT.convert&&(t.type==="GEOGCS"?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var c=t.GEOGCS;t.type==="GEOGCS"&&(c=t),c&&(c.DATUM?t.datumCode=c.DATUM.name.toLowerCase():t.datumCode=c.name.toLowerCase(),t.datumCode.slice(0,2)==="d_"&&(t.datumCode=t.datumCode.slice(2)),t.datumCode==="new_zealand_1949"&&(t.datumCode="nzgd49"),(t.datumCode==="wgs_1984"||t.datumCode==="world_geodetic_system_1984")&&(t.PROJECTION==="Mercator_Auxiliary_Sphere"&&(t.sphere=!0),t.datumCode="wgs84"),t.datumCode==="belge_1972"&&(t.datumCode="rnb72"),c.DATUM&&c.DATUM.SPHEROID&&(t.ellps=c.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),t.ellps.toLowerCase().slice(0,13)==="international"&&(t.ellps="intl"),t.a=c.DATUM.SPHEROID.a,t.rf=parseFloat(c.DATUM.SPHEROID.rf,10)),c.DATUM&&c.DATUM.TOWGS84&&(t.datum_params=c.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),t.datumCode==="ch1903+"&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a);function s(_){var w=t.to_meter||1;return _*w}var p=function(_){return tie(t,_)},y=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",dh],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",dh],["x0","false_easting",s],["y0","false_northing",s],["long0","central_meridian",dh],["lat0","latitude_of_origin",dh],["lat0","standard_parallel_1",dh],["lat1","standard_parallel_1",dh],["lat2","standard_parallel_2",dh],["azimuth","Azimuth"],["alpha","azimuth",dh],["srsCode","name"]];y.forEach(p),!t.long0&&t.longc&&(t.projName==="Albers_Conic_Equal_Area"||t.projName==="Lambert_Azimuthal_Equal_Area")&&(t.long0=t.longc),!t.lat_ts&&t.lat1&&(t.projName==="Stereographic_South_Pole"||t.projName==="Polar Stereographic (variant B)")?(t.lat0=dh(t.lat1>0?90:-90),t.lat_ts=t.lat1):!t.lat_ts&&t.lat0&&t.projName==="Polar_Stereographic"&&(t.lat_ts=t.lat0,t.lat0=dh(t.lat0>0?90:-90))}function XN(t){var e=Jre(t),n=e[0],r={};return Pv(e,r),qN(r),r[n]}function Ea(t){var e=this;if(arguments.length===2){var n=arguments[1];typeof n=="string"?n.charAt(0)==="+"?Ea[t]=uT(arguments[1]):Ea[t]=XN(arguments[1]):Ea[t]=n}else if(arguments.length===1){if(Array.isArray(t))return t.map(function(r){Array.isArray(r)?Ea.apply(e,r):Ea(r)});if(typeof t=="string"){if(t in Ea)return Ea[t]}else"EPSG"in t?Ea["EPSG:"+t.EPSG]=t:"ESRI"in t?Ea["ESRI:"+t.ESRI]=t:"IAU2000"in t?Ea["IAU2000:"+t.IAU2000]=t:console.log(t);return}}Vre(Ea);function rie(t){return typeof t=="string"}function iie(t){return t in Ea}var oie=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function sie(t){return oie.some(function(e){return t.indexOf(e)>-1})}var aie=["3857","900913","3785","102113"];function lie(t){var e=lp(t,"authority");if(e){var n=lp(e,"epsg");return n&&aie.indexOf(n)>-1}}function cie(t){var e=lp(t,"extension");if(e)return lp(e,"proj4")}function uie(t){return t[0]==="+"}function hie(t){if(rie(t)){if(iie(t))return Ea[t];if(sie(t)){var e=XN(t);if(lie(e))return Ea["EPSG:3857"];var n=cie(e);return n?uT(n):e}if(uie(t))return uT(t)}else return t}function tk(t,e){t=t||{};var n,r;if(!e)return t;for(r in e)n=e[r],n!==void 0&&(t[r]=n);return t}function Rh(t,e,n){var r=t*e;return n/Math.sqrt(1-r*r)}function lx(t){return t<0?-1:1}function Kn(t){return Math.abs(t)<=ko?t:t-lx(t)*C_}function xu(t,e,n){var r=t*n,i=.5*t;return r=Math.pow((1-r)/(1+r),i),Math.tan(.5*(En-e))/r}function T_(t,e){for(var n=.5*t,r,i,l=En-2*Math.atan(e),c=0;c<=15;c++)if(r=t*Math.sin(l),i=En-2*Math.atan(e*Math.pow((1-r)/(1+r),n))-l,l+=i,Math.abs(i)<=1e-10)return l;return-9999}function die(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Rh(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function fie(t){var e=t.x,n=t.y;if(n*bh>90&&n*bh<-90&&e*bh>180&&e*bh<-180)return null;var r,i;if(Math.abs(Math.abs(n)-En)<=Xn)return null;if(this.sphere)r=this.x0+this.a*this.k0*Kn(e-this.long0),i=this.y0+this.a*this.k0*Math.log(Math.tan(_i+.5*n));else{var l=Math.sin(n),c=xu(this.e,n,l);r=this.x0+this.a*this.k0*Kn(e-this.long0),i=this.y0-this.a*this.k0*Math.log(c)}return t.x=r,t.y=i,t}function pie(t){var e=t.x-this.x0,n=t.y-this.y0,r,i;if(this.sphere)i=En-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var l=Math.exp(-n/(this.a*this.k0));if(i=T_(this.e,l),i===-9999)return null}return r=Kn(this.long0+e/(this.a*this.k0)),t.x=r,t.y=i,t}var mie=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];const gie={init:die,forward:fie,inverse:pie,names:mie};function vie(){}function nk(t){return t}var yie=["longlat","identity"];const _ie={init:vie,forward:nk,inverse:nk,names:yie};var xie=[gie,_ie],cb={},jb=[];function ZN(t,e){var n=jb.length;return t.names?(jb[n]=t,t.names.forEach(function(r){cb[r.toLowerCase()]=n}),this):(console.log(e),!0)}function bie(t){if(!t)return!1;var e=t.toLowerCase();if(typeof cb[e]<"u"&&jb[cb[e]])return jb[cb[e]]}function wie(){xie.forEach(ZN)}const Sie={start:wie,add:ZN,get:bie};var Cr={};Cr.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};Cr.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};Cr.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};Cr.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};Cr.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"};Cr.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};Cr.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};Cr.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"};Cr.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};Cr.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};Cr.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};Cr.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"};Cr.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};Cr.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"};Cr.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."};Cr.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"};Cr.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"};Cr.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};Cr.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};Cr.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"};Cr.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"};Cr.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"};Cr.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"};Cr.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"};Cr.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};Cr.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};Cr.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};Cr.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};Cr.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};Cr.hough={a:6378270,rf:297,ellipseName:"Hough"};Cr.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};Cr.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};Cr.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};Cr.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};Cr.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"};Cr.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};Cr.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};Cr.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"};Cr.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"};Cr.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};Cr.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};Cr.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Mie=Cr.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Cr.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Cie(t,e,n,r){var i=t*t,l=e*e,c=(i-l)/i,s=0;r?(t*=1-c*(Gre+c*(Wre+c*qre)),i=t*t,c=0):s=Math.sqrt(c);var p=(i-l)/l;return{es:c,e:s,ep2:p}}function Eie(t,e,n,r,i){if(!t){var l=lp(Cr,r);l||(l=Mie),t=l.a,e=l.b,n=l.rf}return n&&!e&&(e=(1-1/n)*t),(n===0||Math.abs(t-e)<Xn)&&(i=!0,e=t),{a:t,b:e,rf:n,sphere:i}}var ub={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}};for(var Tie in ub){var rk=ub[Tie];ub[rk.datumName]=rk}function Pie(t,e,n,r,i,l,c){var s={};return t===void 0||t==="none"?s.datum_type=cT:s.datum_type=jre,e&&(s.datum_params=e.map(parseFloat),(s.datum_params[0]!==0||s.datum_params[1]!==0||s.datum_params[2]!==0)&&(s.datum_type=Wm),s.datum_params.length>3&&(s.datum_params[3]!==0||s.datum_params[4]!==0||s.datum_params[5]!==0||s.datum_params[6]!==0)&&(s.datum_type=qm,s.datum_params[3]*=q0,s.datum_params[4]*=q0,s.datum_params[5]*=q0,s.datum_params[6]=s.datum_params[6]/1e6+1)),c&&(s.datum_type=jv,s.grids=c),s.a=n,s.b=r,s.es=i,s.ep2=l,s}var YN={};function Aie(t,e){var n=new DataView(e),r=Lie(n),i=kie(n,r),l=Die(n,i,r),c={header:i,subgrids:l};return YN[t]=c,c}function Iie(t){if(t===void 0)return null;var e=t.split(",");return e.map(Rie)}function Rie(t){if(t.length===0)return null;var e=t[0]==="@";return e&&(t=t.slice(1)),t==="null"?{name:"null",mandatory:!e,grid:null,isNull:!0}:{name:t,mandatory:!e,grid:YN[t]||null,isNull:!1}}function Av(t){return t/3600*Math.PI/180}function Lie(t){var e=t.getInt32(8,!1);return e===11?!1:(e=t.getInt32(8,!0),e!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function kie(t,e){return{nFields:t.getInt32(8,e),nSubgridFields:t.getInt32(24,e),nSubgrids:t.getInt32(40,e),shiftType:hT(t,56,64).trim(),fromSemiMajorAxis:t.getFloat64(120,e),fromSemiMinorAxis:t.getFloat64(136,e),toSemiMajorAxis:t.getFloat64(152,e),toSemiMinorAxis:t.getFloat64(168,e)}}function hT(t,e,n){return String.fromCharCode.apply(null,new Uint8Array(t.buffer.slice(e,n)))}function Die(t,e,n){for(var r=176,i=[],l=0;l<e.nSubgrids;l++){var c=Oie(t,r,n),s=Fie(t,r,c,n),p=Math.round(1+(c.upperLongitude-c.lowerLongitude)/c.longitudeInterval),y=Math.round(1+(c.upperLatitude-c.lowerLatitude)/c.latitudeInterval);i.push({ll:[Av(c.lowerLongitude),Av(c.lowerLatitude)],del:[Av(c.longitudeInterval),Av(c.latitudeInterval)],lim:[p,y],count:c.gridNodeCount,cvs:zie(s)}),r+=176+c.gridNodeCount*16}return i}function zie(t){return t.map(function(e){return[Av(e.longitudeShift),Av(e.latitudeShift)]})}function Oie(t,e,n){return{name:hT(t,e+8,e+16).trim(),parent:hT(t,e+24,e+24+8).trim(),lowerLatitude:t.getFloat64(e+72,n),upperLatitude:t.getFloat64(e+88,n),lowerLongitude:t.getFloat64(e+104,n),upperLongitude:t.getFloat64(e+120,n),latitudeInterval:t.getFloat64(e+136,n),longitudeInterval:t.getFloat64(e+152,n),gridNodeCount:t.getInt32(e+168,n)}}function Fie(t,e,n,r){for(var i=e+176,l=16,c=[],s=0;s<n.gridNodeCount;s++){var p={latitudeShift:t.getFloat32(i+s*l,r),longitudeShift:t.getFloat32(i+s*l+4,r),latitudeAccuracy:t.getFloat32(i+s*l+8,r),longitudeAccuracy:t.getFloat32(i+s*l+12,r)};c.push(p)}return c}function Th(t,e){if(!(this instanceof Th))return new Th(t);e=e||function(y){if(y)throw y};var n=hie(t);if(typeof n!="object"){e("Could not parse to valid json: "+t);return}var r=Th.projections.get(n.projName);if(!r){e("Could not get projection name from: "+t);return}if(n.datumCode&&n.datumCode!=="none"){var i=lp(ub,n.datumCode);i&&(n.datum_params=n.datum_params||(i.towgs84?i.towgs84.split(","):null),n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var l=Eie(n.a,n.b,n.rf,n.ellps,n.sphere),c=Cie(l.a,l.b,l.rf,n.R_A),s=Iie(n.nadgrids),p=n.datum||Pie(n.datumCode,n.datum_params,l.a,l.b,c.es,c.ep2,s);tk(this,n),tk(this,r),this.a=l.a,this.b=l.b,this.rf=l.rf,this.sphere=l.sphere,this.es=c.es,this.e=c.e,this.ep2=c.ep2,this.datum=p,this.init(),e(null,this)}Th.projections=Sie;Th.projections.start();function Nie(t,e){return t.datum_type!==e.datum_type||t.a!==e.a||Math.abs(t.es-e.es)>5e-11?!1:t.datum_type===Wm?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type===qm?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]:!0}function KN(t,e,n){var r=t.x,i=t.y,l=t.z?t.z:0,c,s,p,y;if(i<-En&&i>-1.001*En)i=-En;else if(i>En&&i<1.001*En)i=En;else{if(i<-En)return{x:-1/0,y:-1/0,z:t.z};if(i>En)return{x:1/0,y:1/0,z:t.z}}return r>Math.PI&&(r-=2*Math.PI),s=Math.sin(i),y=Math.cos(i),p=s*s,c=n/Math.sqrt(1-e*p),{x:(c+l)*y*Math.cos(r),y:(c+l)*y*Math.sin(r),z:(c*(1-e)+l)*s}}function JN(t,e,n,r){var i=1e-12,l=i*i,c=30,s,p,y,_,w,S,M,I,D,R,L,V,B,H=t.x,q=t.y,X=t.z?t.z:0,ee,se,J;if(s=Math.sqrt(H*H+q*q),p=Math.sqrt(H*H+q*q+X*X),s/n<i){if(ee=0,p/n<i)return se=En,J=-r,{x:t.x,y:t.y,z:t.z}}else ee=Math.atan2(q,H);y=X/p,_=s/p,w=1/Math.sqrt(1-e*(2-e)*_*_),I=_*(1-e)*w,D=y*w,B=0;do B++,M=n/Math.sqrt(1-e*D*D),J=s*I+X*D-M*(1-e*D*D),S=e*M/(M+J),w=1/Math.sqrt(1-S*(2-S)*_*_),R=_*(1-S)*w,L=y*w,V=L*I-R*D,I=R,D=L;while(V*V>l&&B<c);return se=Math.atan(L/Math.abs(R)),{x:ee,y:se,z:J}}function Bie(t,e,n){if(e===Wm)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===qm){var r=n[0],i=n[1],l=n[2],c=n[3],s=n[4],p=n[5],y=n[6];return{x:y*(t.x-p*t.y+s*t.z)+r,y:y*(p*t.x+t.y-c*t.z)+i,z:y*(-s*t.x+c*t.y+t.z)+l}}}function Uie(t,e,n){if(e===Wm)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===qm){var r=n[0],i=n[1],l=n[2],c=n[3],s=n[4],p=n[5],y=n[6],_=(t.x-r)/y,w=(t.y-i)/y,S=(t.z-l)/y;return{x:_+p*w-s*S,y:-p*_+w+c*S,z:s*_-c*w+S}}}function g1(t){return t===Wm||t===qm}function $ie(t,e,n){if(Nie(t,e)||t.datum_type===cT||e.datum_type===cT)return n;var r=t.a,i=t.es;if(t.datum_type===jv){var l=ik(t,!1,n);if(l!==0)return;r=JL,i=QL}var c=e.a,s=e.b,p=e.es;if(e.datum_type===jv&&(c=JL,s=Hre,p=QL),i===p&&r===c&&!g1(t.datum_type)&&!g1(e.datum_type))return n;if(n=KN(n,i,r),g1(t.datum_type)&&(n=Bie(n,t.datum_type,t.datum_params)),g1(e.datum_type)&&(n=Uie(n,e.datum_type,e.datum_params)),n=JN(n,p,c,s),e.datum_type===jv){var y=ik(e,!0,n);if(y!==0)return}return n}function ik(t,e,n){if(t.grids===null||t.grids.length===0)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},i={x:Number.NaN,y:Number.NaN},l=[];e:for(var c=0;c<t.grids.length;c++){var s=t.grids[c];if(l.push(s.name),s.isNull){i=r;break}if(s.mandatory,s.grid===null){if(s.mandatory)return console.log("Unable to find mandatory grid '"+s.name+"'"),-1;continue}for(var p=s.grid.subgrids,y=0,_=p.length;y<_;y++){var w=p[y],S=(Math.abs(w.del[1])+Math.abs(w.del[0]))/1e4,M=w.ll[0]-S,I=w.ll[1]-S,D=w.ll[0]+(w.lim[0]-1)*w.del[0]+S,R=w.ll[1]+(w.lim[1]-1)*w.del[1]+S;if(!(I>r.y||M>r.x||R<r.y||D<r.x)&&(i=Vie(r,e,w),!isNaN(i.x)))break e}}return isNaN(i.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*bh+" "+r.y*bh+" tried: '"+l+"'"),-1):(n.x=-i.x,n.y=i.y,0)}function Vie(t,e,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(t.x))return r;var i={x:t.x,y:t.y};i.x-=n.ll[0],i.y-=n.ll[1],i.x=Kn(i.x-Math.PI)+Math.PI;var l=ok(i,n);if(e){if(isNaN(l.x))return r;l.x=i.x-l.x,l.y=i.y-l.y;var c=9,s=1e-12,p,y;do{if(y=ok(l,n),isNaN(y.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}p={x:i.x-(y.x+l.x),y:i.y-(y.y+l.y)},l.x+=p.x,l.y+=p.y}while(c--&&Math.abs(p.x)>s&&Math.abs(p.y)>s);if(c<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=Kn(l.x+n.ll[0]),r.y=l.y+n.ll[1]}else isNaN(l.x)||(r.x=t.x+l.x,r.y=t.y+l.y);return r}function ok(t,e){var n={x:t.x/e.del[0],y:t.y/e.del[1]},r={x:Math.floor(n.x),y:Math.floor(n.y)},i={x:n.x-1*r.x,y:n.y-1*r.y},l={x:Number.NaN,y:Number.NaN},c;if(r.x<0||r.x>=e.lim[0]||r.y<0||r.y>=e.lim[1])return l;c=r.y*e.lim[0]+r.x;var s={x:e.cvs[c][0],y:e.cvs[c][1]};c++;var p={x:e.cvs[c][0],y:e.cvs[c][1]};c+=e.lim[0];var y={x:e.cvs[c][0],y:e.cvs[c][1]};c--;var _={x:e.cvs[c][0],y:e.cvs[c][1]},w=i.x*i.y,S=i.x*(1-i.y),M=(1-i.x)*(1-i.y),I=(1-i.x)*i.y;return l.x=M*s.x+S*p.x+I*_.x+w*y.x,l.y=M*s.y+S*p.y+I*_.y+w*y.y,l}function sk(t,e,n){var r=n.x,i=n.y,l=n.z||0,c,s,p,y={};for(p=0;p<3;p++)if(!(e&&p===2&&n.z===void 0))switch(p===0?(c=r,"ew".indexOf(t.axis[p])!==-1?s="x":s="y"):p===1?(c=i,"ns".indexOf(t.axis[p])!==-1?s="y":s="x"):(c=l,s="z"),t.axis[p]){case"e":y[s]=c;break;case"w":y[s]=-c;break;case"n":y[s]=c;break;case"s":y[s]=-c;break;case"u":n[s]!==void 0&&(y.z=c);break;case"d":n[s]!==void 0&&(y.z=-c);break;default:return null}return y}function QN(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}function jie(t){ak(t.x),ak(t.y)}function ak(t){if(typeof Number.isFinite=="function"){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if(typeof t!="number"||t!==t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}function Hie(t,e){return(t.datum.datum_type===Wm||t.datum.datum_type===qm||t.datum.datum_type===jv)&&e.datumCode!=="WGS84"||(e.datum.datum_type===Wm||e.datum.datum_type===qm||e.datum.datum_type===jv)&&t.datumCode!=="WGS84"}function Hb(t,e,n,r){var i;Array.isArray(n)?n=QN(n):n={x:n.x,y:n.y,z:n.z,m:n.m};var l=n.z!==void 0;if(jie(n),t.datum&&e.datum&&Hie(t,e)&&(i=new Th("WGS84"),n=Hb(t,i,n,r),t=i),r&&t.axis!=="enu"&&(n=sk(t,!1,n)),t.projName==="longlat")n={x:n.x*js,y:n.y*js,z:n.z||0};else if(t.to_meter&&(n={x:n.x*t.to_meter,y:n.y*t.to_meter,z:n.z||0}),n=t.inverse(n),!n)return;if(t.from_greenwich&&(n.x+=t.from_greenwich),n=$ie(t.datum,e.datum,n),!!n)return e.from_greenwich&&(n={x:n.x-e.from_greenwich,y:n.y,z:n.z||0}),e.projName==="longlat"?n={x:n.x*bh,y:n.y*bh,z:n.z||0}:(n=e.forward(n),e.to_meter&&(n={x:n.x/e.to_meter,y:n.y/e.to_meter,z:n.z||0})),r&&e.axis!=="enu"?sk(e,!0,n):(n&&!l&&delete n.z,n)}var lk=Th("WGS84");function R2(t,e,n,r){var i,l,c;return Array.isArray(n)?(i=Hb(t,e,n,r)||{x:NaN,y:NaN},n.length>2?typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"?typeof i.z=="number"?[i.x,i.y,i.z].concat(n.slice(3)):[i.x,i.y,n[2]].concat(n.slice(3)):[i.x,i.y].concat(n.slice(2)):[i.x,i.y]):(l=Hb(t,e,n,r),c=Object.keys(n),c.length===2||c.forEach(function(s){if(typeof t.name<"u"&&t.name==="geocent"||typeof e.name<"u"&&e.name==="geocent"){if(s==="x"||s==="y"||s==="z")return}else if(s==="x"||s==="y")return;l[s]=n[s]}),l)}function ck(t){return t instanceof Th?t:t.oProj?t.oProj:Th(t)}function ol(t,e,n){t=ck(t);var r=!1,i;return typeof e>"u"?(e=t,t=lk,r=!0):(typeof e.x<"u"||Array.isArray(e))&&(n=e,e=t,t=lk,r=!0),e=ck(e),n?R2(t,e,n):(i={forward:function(l,c){return R2(t,e,l,c)},inverse:function(l,c){return R2(e,t,l,c)}},r&&(i.oProj=e),i)}var uk=6,eB="AJSAJS",tB="AFAFAF",Iv=65,Za=73,Mc=79,k0=86,D0=90;const Gie={forward:nB,inverse:Wie,toPoint:rB};function nB(t,e){return e=e||5,Zie(qie({lat:t[1],lon:t[0]}),e)}function Wie(t){var e=OA(oB(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]}function rB(t){var e=OA(oB(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function L2(t){return t*(Math.PI/180)}function hk(t){return 180*(t/Math.PI)}function qie(t){var e=t.lat,n=t.lon,r=6378137,i=.00669438,l=.9996,c,s,p,y,_,w,S,M=L2(e),I=L2(n),D,R;R=Math.floor((n+180)/6)+1,n===180&&(R=60),e>=56&&e<64&&n>=3&&n<12&&(R=32),e>=72&&e<84&&(n>=0&&n<9?R=31:n>=9&&n<21?R=33:n>=21&&n<33?R=35:n>=33&&n<42&&(R=37)),c=(R-1)*6-180+3,D=L2(c),s=i/(1-i),p=r/Math.sqrt(1-i*Math.sin(M)*Math.sin(M)),y=Math.tan(M)*Math.tan(M),_=s*Math.cos(M)*Math.cos(M),w=Math.cos(M)*(I-D),S=r*((1-i/4-3*i*i/64-5*i*i*i/256)*M-(3*i/8+3*i*i/32+45*i*i*i/1024)*Math.sin(2*M)+(15*i*i/256+45*i*i*i/1024)*Math.sin(4*M)-35*i*i*i/3072*Math.sin(6*M));var L=l*p*(w+(1-y+_)*w*w*w/6+(5-18*y+y*y+72*_-58*s)*w*w*w*w*w/120)+5e5,V=l*(S+p*Math.tan(M)*(w*w/2+(5-y+9*_+4*_*_)*w*w*w*w/24+(61-58*y+y*y+600*_-330*s)*w*w*w*w*w*w/720));return e<0&&(V+=1e7),{northing:Math.round(V),easting:Math.round(L),zoneNumber:R,zoneLetter:Xie(e)}}function OA(t){var e=t.northing,n=t.easting,r=t.zoneLetter,i=t.zoneNumber;if(i<0||i>60)return null;var l=.9996,c=6378137,s=.00669438,p,y=(1-Math.sqrt(1-s))/(1+Math.sqrt(1-s)),_,w,S,M,I,D,R,L,V,B=n-5e5,H=e;r<"N"&&(H-=1e7),R=(i-1)*6-180+3,p=s/(1-s),D=H/l,L=D/(c*(1-s/4-3*s*s/64-5*s*s*s/256)),V=L+(3*y/2-27*y*y*y/32)*Math.sin(2*L)+(21*y*y/16-55*y*y*y*y/32)*Math.sin(4*L)+151*y*y*y/96*Math.sin(6*L),_=c/Math.sqrt(1-s*Math.sin(V)*Math.sin(V)),w=Math.tan(V)*Math.tan(V),S=p*Math.cos(V)*Math.cos(V),M=c*(1-s)/Math.pow(1-s*Math.sin(V)*Math.sin(V),1.5),I=B/(_*l);var q=V-_*Math.tan(V)/M*(I*I/2-(5+3*w+10*S-4*S*S-9*p)*I*I*I*I/24+(61+90*w+298*S+45*w*w-252*p-3*S*S)*I*I*I*I*I*I/720);q=hk(q);var X=(I-(1+2*w+S)*I*I*I/6+(5-2*S+28*w-3*S*S+8*p+24*w*w)*I*I*I*I*I/120)/Math.cos(V);X=R+hk(X);var ee;if(t.accuracy){var se=OA({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});ee={top:se.lat,right:se.lon,bottom:q,left:X}}else ee={lat:q,lon:X};return ee}function Xie(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function Zie(t,e){var n="00000"+t.easting,r="00000"+t.northing;return t.zoneNumber+t.zoneLetter+Yie(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+r.substr(r.length-5,e)}function Yie(t,e,n){var r=iB(n),i=Math.floor(t/1e5),l=Math.floor(e/1e5)%20;return Kie(i,l,r)}function iB(t){var e=t%uk;return e===0&&(e=uk),e}function Kie(t,e,n){var r=n-1,i=eB.charCodeAt(r),l=tB.charCodeAt(r),c=i+t-1,s=l+e,p=!1;c>D0&&(c=c-D0+Iv-1,p=!0),(c===Za||i<Za&&c>Za||(c>Za||i<Za)&&p)&&c++,(c===Mc||i<Mc&&c>Mc||(c>Mc||i<Mc)&&p)&&(c++,c===Za&&c++),c>D0&&(c=c-D0+Iv-1),s>k0?(s=s-k0+Iv-1,p=!0):p=!1,(s===Za||l<Za&&s>Za||(s>Za||l<Za)&&p)&&s++,(s===Mc||l<Mc&&s>Mc||(s>Mc||l<Mc)&&p)&&(s++,s===Za&&s++),s>k0&&(s=s-k0+Iv-1);var y=String.fromCharCode(c)+String.fromCharCode(s);return y}function oB(t){if(t&&t.length===0)throw"MGRSPoint coverting from nothing";for(var e=t.length,n=null,r="",i,l=0;!/[A-Z]/.test(i=t.charAt(l));){if(l>=2)throw"MGRSPoint bad conversion from: "+t;r+=i,l++}var c=parseInt(r,10);if(l===0||l+3>e)throw"MGRSPoint bad conversion from: "+t;var s=t.charAt(l++);if(s<="A"||s==="B"||s==="Y"||s>="Z"||s==="I"||s==="O")throw"MGRSPoint zone letter "+s+" not handled: "+t;n=t.substring(l,l+=2);for(var p=iB(c),y=Jie(n.charAt(0),p),_=Qie(n.charAt(1),p);_<eoe(s);)_+=2e6;var w=e-l;if(w%2!==0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+t;var S=w/2,M=0,I=0,D,R,L,V,B;return S>0&&(D=1e5/Math.pow(10,S),R=t.substring(l,l+S),M=parseFloat(R)*D,L=t.substring(l+S),I=parseFloat(L)*D),V=M+y,B=I+_,{easting:V,northing:B,zoneLetter:s,zoneNumber:c,accuracy:D}}function Jie(t,e){for(var n=eB.charCodeAt(e-1),r=1e5,i=!1;n!==t.charCodeAt(0);){if(n++,n===Za&&n++,n===Mc&&n++,n>D0){if(i)throw"Bad character: "+t;n=Iv,i=!0}r+=1e5}return r}function Qie(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var n=tB.charCodeAt(e-1),r=0,i=!1;n!==t.charCodeAt(0);){if(n++,n===Za&&n++,n===Mc&&n++,n>k0){if(i)throw"Bad character: "+t;n=Iv,i=!0}r+=1e5}return r}function eoe(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}function iy(t,e,n){if(!(this instanceof iy))return new iy(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if(typeof t=="object")this.x=t.x,this.y=t.y,this.z=t.z||0;else if(typeof t=="string"&&typeof e>"u"){var r=t.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}iy.fromMGRS=function(t){return new iy(rB(t))};iy.prototype.toMGRS=function(t){return nB([this.x,this.y],t)};var toe=1,noe=.25,dk=.046875,fk=.01953125,pk=.01068115234375,roe=.75,ioe=.46875,ooe=.013020833333333334,soe=.007120768229166667,aoe=.3645833333333333,loe=.005696614583333333,coe=.3076171875;function FA(t){var e=[];e[0]=toe-t*(noe+t*(dk+t*(fk+t*pk))),e[1]=t*(roe-t*(dk+t*(fk+t*pk)));var n=t*t;return e[2]=n*(ioe-t*(ooe+t*soe)),n*=t,e[3]=n*(aoe-t*loe),e[4]=n*t*coe,e}function py(t,e,n,r){return n*=e,e*=e,r[0]*t-n*(r[1]+e*(r[2]+e*(r[3]+e*r[4])))}var uoe=20;function NA(t,e,n){for(var r=1/(1-e),i=t,l=uoe;l;--l){var c=Math.sin(i),s=1-e*c*c;if(s=(py(i,c,Math.cos(i),n)-t)*(s*Math.sqrt(s))*r,i-=s,Math.abs(s)<Xn)return i}return i}function hoe(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=FA(this.es),this.ml0=py(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function doe(t){var e=t.x,n=t.y,r=Kn(e-this.long0),i,l,c,s=Math.sin(n),p=Math.cos(n);if(this.es){var _=p*r,w=Math.pow(_,2),S=this.ep2*Math.pow(p,2),M=Math.pow(S,2),I=Math.abs(p)>Xn?Math.tan(n):0,D=Math.pow(I,2),R=Math.pow(D,2);i=1-this.es*Math.pow(s,2),_=_/Math.sqrt(i);var L=py(n,s,p,this.en);l=this.a*(this.k0*_*(1+w/6*(1-D+S+w/20*(5-18*D+R+14*S-58*D*S+w/42*(61+179*R-R*D-479*D)))))+this.x0,c=this.a*(this.k0*(L-this.ml0+s*r*_/2*(1+w/12*(5-D+9*S+4*M+w/30*(61+R-58*D+270*S-330*D*S+w/56*(1385+543*R-R*D-3111*D))))))+this.y0}else{var y=p*Math.sin(r);if(Math.abs(Math.abs(y)-1)<Xn)return 93;if(l=.5*this.a*this.k0*Math.log((1+y)/(1-y))+this.x0,c=p*Math.cos(r)/Math.sqrt(1-Math.pow(y,2)),y=Math.abs(c),y>=1){if(y-1>Xn)return 93;c=0}else c=Math.acos(c);n<0&&(c=-c),c=this.a*this.k0*(c-this.lat0)+this.y0}return t.x=l,t.y=c,t}function foe(t){var e,n,r,i,l=(t.x-this.x0)*(1/this.a),c=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+c/this.k0,n=NA(e,this.es,this.en),Math.abs(n)<En){var w=Math.sin(n),S=Math.cos(n),M=Math.abs(S)>Xn?Math.tan(n):0,I=this.ep2*Math.pow(S,2),D=Math.pow(I,2),R=Math.pow(M,2),L=Math.pow(R,2);e=1-this.es*Math.pow(w,2);var V=l*Math.sqrt(e)/this.k0,B=Math.pow(V,2);e=e*M,r=n-e*B/(1-this.es)*.5*(1-B/12*(5+3*R-9*I*R+I-4*D-B/30*(61+90*R-252*I*R+45*L+46*I-B/56*(1385+3633*R+4095*L+1574*L*R)))),i=Kn(this.long0+V*(1-B/6*(1+2*R+I-B/20*(5+28*R+24*L+8*I*R+6*I-B/42*(61+662*R+1320*L+720*L*R))))/S)}else r=En*lx(c),i=0;else{var s=Math.exp(l/this.k0),p=.5*(s-1/s),y=this.lat0+c/this.k0,_=Math.cos(y);e=Math.sqrt((1-Math.pow(_,2))/(1+Math.pow(p,2))),r=Math.asin(e),c<0&&(r=-r),p===0&&_===0?i=0:i=Kn(Math.atan2(p,_)+this.long0)}return t.x=i,t.y=r,t}var poe=["Fast_Transverse_Mercator","Fast Transverse Mercator"];const hb={init:hoe,forward:doe,inverse:foe,names:poe};function sB(t){var e=Math.exp(t);return e=(e-1/e)/2,e}function Ka(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),r=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function moe(t){var e=1+t,n=e-1;return n===0?t:t*Math.log(e)/n}function goe(t){var e=Math.abs(t);return e=moe(e*(1+e/(Ka(1,e)+1))),t<0?-e:e}function BA(t,e){for(var n=2*Math.cos(2*e),r=t.length-1,i=t[r],l=0,c;--r>=0;)c=-l+n*i+t[r],l=i,i=c;return e+c*Math.sin(2*e)}function voe(t,e){for(var n=2*Math.cos(e),r=t.length-1,i=t[r],l=0,c;--r>=0;)c=-l+n*i+t[r],l=i,i=c;return Math.sin(e)*c}function yoe(t){var e=Math.exp(t);return e=(e+1/e)/2,e}function aB(t,e,n){for(var r=Math.sin(e),i=Math.cos(e),l=sB(n),c=yoe(n),s=2*i*c,p=-2*r*l,y=t.length-1,_=t[y],w=0,S=0,M=0,I,D;--y>=0;)I=S,D=w,S=_,w=M,_=-I+s*S-p*w+t[y],M=-D+p*S+s*w;return s=r*c,p=i*l,[s*_-p*M,s*M+p*_]}function _oe(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(hb.init.apply(this),this.forward=hb.forward,this.inverse=hb.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(-2+e*(116/45+e*(26/45+e*(-2854/675)))))),this.cbg[0]=e*(-2+e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))),n=n*e,this.cgb[1]=n*(7/3+e*(-8/5+e*(-227/45+e*(2704/315+e*(2323/945))))),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n=n*e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(8/5+e*(-12686/2835)))),n=n*e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(-12/5+e*(-24832/14175))),n=n*e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n=n*e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=e*(-.5+e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(-3/5+e*(557/1440+e*(281/630+e*(-1983433/1935360))))),n=n*e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n=n*e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n=n*e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n=n*e,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=n*(212378941/319334400);var r=BA(this.cbg,this.lat0);this.Zb=-this.Qn*(r+voe(this.gtu,2*r))}function xoe(t){var e=Kn(t.x-this.long0),n=t.y;n=BA(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),l=Math.sin(e),c=Math.cos(e);n=Math.atan2(r,c*i),e=Math.atan2(l*i,Ka(r,i*c)),e=goe(Math.tan(e));var s=aB(this.gtu,2*n,2*e);n=n+s[0],e=e+s[1];var p,y;return Math.abs(e)<=2.623395162778?(p=this.a*(this.Qn*e)+this.x0,y=this.a*(this.Qn*n+this.Zb)+this.y0):(p=1/0,y=1/0),t.x=p,t.y=y,t}function boe(t){var e=(t.x-this.x0)*(1/this.a),n=(t.y-this.y0)*(1/this.a);n=(n-this.Zb)/this.Qn,e=e/this.Qn;var r,i;if(Math.abs(e)<=2.623395162778){var l=aB(this.utg,2*n,2*e);n=n+l[0],e=e+l[1],e=Math.atan(sB(e));var c=Math.sin(n),s=Math.cos(n),p=Math.sin(e),y=Math.cos(e);n=Math.atan2(c*y,Ka(p,y*s)),e=Math.atan2(p,y*s),r=Kn(e+this.long0),i=BA(this.cgb,n)}else r=1/0,i=1/0;return t.x=r,t.y=i,t}var woe=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"];const db={init:_oe,forward:xoe,inverse:boe,names:woe};function Soe(t,e){if(t===void 0){if(t=Math.floor((Kn(e)+Math.PI)*30/Math.PI)+1,t<0)return 0;if(t>60)return 60}return t}var Moe="etmerc";function Coe(){var t=Soe(this.zone,this.long0);if(t===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*js,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,db.init.apply(this),this.forward=db.forward,this.inverse=db.inverse}var Eoe=["Universal Transverse Mercator System","utm"];const Toe={init:Coe,names:Eoe,dependsOn:Moe};function UA(t,e){return Math.pow((1-t)/(1+t),e)}var Poe=20;function Aoe(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+_i)/(Math.pow(Math.tan(.5*this.lat0+_i),this.C)*UA(this.e*t,this.ratexp))}function Ioe(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+_i),this.C)*UA(this.e*Math.sin(n),this.ratexp))-En,t.x=this.C*e,t}function Roe(t){for(var e=1e-14,n=t.x/this.C,r=t.y,i=Math.pow(Math.tan(.5*r+_i)/this.K,1/this.C),l=Poe;l>0&&(r=2*Math.atan(i*UA(this.e*Math.sin(t.y),-.5*this.e))-En,!(Math.abs(r-t.y)<e));--l)t.y=r;return l?(t.x=n,t.y=r,t):null}const $A={init:Aoe,forward:Ioe,inverse:Roe};function Loe(){$A.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function koe(t){var e,n,r,i;return t.x=Kn(t.x-this.long0),$A.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*r),t.x=i*n*Math.sin(t.x),t.y=i*(this.cosc0*e-this.sinc0*n*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function Doe(t){var e,n,r,i,l;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,l=Ka(t.x,t.y)){var c=2*Math.atan2(l,this.R2);e=Math.sin(c),n=Math.cos(c),i=Math.asin(n*this.sinc0+t.y*e*this.cosc0/l),r=Math.atan2(t.x*e,l*this.cosc0*n-t.y*this.sinc0*e)}else i=this.phic0,r=0;return t.x=r,t.y=i,$A.inverse.apply(this,[t]),t.x=Kn(t.x+this.long0),t}var zoe=["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];const Ooe={init:Loe,forward:koe,inverse:Doe,names:zoe};function Foe(t,e,n){return e*=n,Math.tan(.5*(En+t))*Math.pow((1-e)/(1+e),.5*n)}function Noe(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Xn&&(this.k0=.5*(1+lx(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Xn&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Xn&&Math.abs(Math.cos(this.lat_ts))>Xn&&(this.k0=.5*this.cons*Rh(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/xu(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Rh(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-En,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Boe(t){var e=t.x,n=t.y,r=Math.sin(n),i=Math.cos(n),l,c,s,p,y,_,w=Kn(e-this.long0);return Math.abs(Math.abs(e-this.long0)-Math.PI)<=Xn&&Math.abs(n+this.lat0)<=Xn?(t.x=NaN,t.y=NaN,t):this.sphere?(l=2*this.k0/(1+this.sinlat0*r+this.coslat0*i*Math.cos(w)),t.x=this.a*l*i*Math.sin(w)+this.x0,t.y=this.a*l*(this.coslat0*r-this.sinlat0*i*Math.cos(w))+this.y0,t):(c=2*Math.atan(this.ssfn_(n,r,this.e))-En,p=Math.cos(c),s=Math.sin(c),Math.abs(this.coslat0)<=Xn?(y=xu(this.e,n*this.con,this.con*r),_=2*this.a*this.k0*y/this.cons,t.x=this.x0+_*Math.sin(e-this.long0),t.y=this.y0-this.con*_*Math.cos(e-this.long0),t):(Math.abs(this.sinlat0)<Xn?(l=2*this.a*this.k0/(1+p*Math.cos(w)),t.y=l*s):(l=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*s+this.cosX0*p*Math.cos(w))),t.y=l*(this.cosX0*s-this.sinX0*p*Math.cos(w))+this.y0),t.x=l*p*Math.sin(w)+this.x0,t))}function Uoe(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,l,c=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var s=2*Math.atan(c/(2*this.a*this.k0));return e=this.long0,n=this.lat0,c<=Xn?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(s)*this.sinlat0+t.y*Math.sin(s)*this.coslat0/c),Math.abs(this.coslat0)<Xn?this.lat0>0?e=Kn(this.long0+Math.atan2(t.x,-1*t.y)):e=Kn(this.long0+Math.atan2(t.x,t.y)):e=Kn(this.long0+Math.atan2(t.x*Math.sin(s),c*this.coslat0*Math.cos(s)-t.y*this.sinlat0*Math.sin(s))),t.x=e,t.y=n,t)}else if(Math.abs(this.coslat0)<=Xn){if(c<=Xn)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=c*this.cons/(2*this.a*this.k0),n=this.con*T_(this.e,r),e=this.con*Kn(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else i=2*Math.atan(c*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,c<=Xn?l=this.X0:(l=Math.asin(Math.cos(i)*this.sinX0+t.y*Math.sin(i)*this.cosX0/c),e=Kn(this.long0+Math.atan2(t.x*Math.sin(i),c*this.cosX0*Math.cos(i)-t.y*this.sinX0*Math.sin(i)))),n=-1*T_(this.e,Math.tan(.5*(En+l)));return t.x=e,t.y=n,t}var $oe=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"];const Voe={init:Noe,forward:Boe,inverse:Uoe,names:$oe,ssfn_:Foe};function joe(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,r=this.rf,i=1/r,l=2*i-Math.pow(i,2),c=this.e=Math.sqrt(l);this.R=this.k0*n*Math.sqrt(1-l)/(1-l*Math.pow(e,2)),this.alpha=Math.sqrt(1+l/(1-l)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var s=Math.log(Math.tan(Math.PI/4+this.b0/2)),p=Math.log(Math.tan(Math.PI/4+t/2)),y=Math.log((1+c*e)/(1-c*e));this.K=s-this.alpha*p+this.alpha*c/2*y}function Hoe(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),r=-this.alpha*(e+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),l=this.alpha*(t.x-this.lambda0),c=Math.atan(Math.sin(l)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(l))),s=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(l));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*c+this.x0,t}function Goe(t){for(var e=t.x-this.x0,n=t.y-this.y0,r=e/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),l=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),c=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),s=this.lambda0+c/this.alpha,p=0,y=l,_=-1e3,w=0;Math.abs(y-_)>1e-7;){if(++w>20)return;p=1/this.alpha*(Math.log(Math.tan(Math.PI/4+l/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(y))/2)),_=y,y=2*Math.atan(Math.exp(p))-Math.PI/2}return t.x=s,t.y=y,t}var Woe=["somerc"];const qoe={init:joe,forward:Hoe,inverse:Goe,names:Woe};var xv=1e-7;function Xoe(t){var e=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n=typeof t.PROJECTION=="object"?Object.keys(t.PROJECTION)[0]:t.PROJECTION;return"no_uoff"in t||"no_off"in t||e.indexOf(n)!==-1}function Zoe(){var t,e,n,r,i,l,c,s,p,y,_=0,w,S=0,M=0,I=0,D=0,R=0,L=0;this.no_off=Xoe(this),this.no_rot="no_rot"in this;var V=!1;"alpha"in this&&(V=!0);var B=!1;if("rectified_grid_angle"in this&&(B=!0),V&&(L=this.alpha),B&&(_=this.rectified_grid_angle*js),V||B)S=this.longc;else if(M=this.long1,D=this.lat1,I=this.long2,R=this.lat2,Math.abs(D-R)<=xv||(t=Math.abs(D))<=xv||Math.abs(t-En)<=xv||Math.abs(Math.abs(this.lat0)-En)<=xv||Math.abs(Math.abs(R)-En)<=xv)throw new Error;var H=1-this.es;e=Math.sqrt(H),Math.abs(this.lat0)>Xn?(s=Math.sin(this.lat0),n=Math.cos(this.lat0),t=1-this.es*s*s,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/H),this.A=this.B*this.k0*e/t,r=this.B*e/(n*Math.sqrt(t)),i=r*r-1,i<=0?i=0:(i=Math.sqrt(i),this.lat0<0&&(i=-i)),this.E=i+=r,this.E*=Math.pow(xu(this.e,this.lat0,s),this.B)):(this.B=1/e,this.A=this.k0,this.E=r=i=1),V||B?(V?(w=Math.asin(Math.sin(L)/r),B||(_=L)):(w=_,L=Math.asin(r*Math.sin(w))),this.lam0=S-Math.asin(.5*(i-1/i)*Math.tan(w))/this.B):(l=Math.pow(xu(this.e,D,Math.sin(D)),this.B),c=Math.pow(xu(this.e,R,Math.sin(R)),this.B),i=this.E/l,p=(c-l)/(c+l),y=this.E*this.E,y=(y-c*l)/(y+c*l),t=M-I,t<-Math.pi?I-=C_:t>Math.pi&&(I+=C_),this.lam0=Kn(.5*(M+I)-Math.atan(y*Math.tan(.5*this.B*(M-I))/p)/this.B),w=Math.atan(2*Math.sin(this.B*Kn(M-this.lam0))/(i-1/i)),_=L=Math.asin(r*Math.sin(w))),this.singam=Math.sin(w),this.cosgam=Math.cos(w),this.sinrot=Math.sin(_),this.cosrot=Math.cos(_),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A*this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(L))),this.lat0<0&&(this.u_0=-this.u_0)),i=.5*w,this.v_pole_n=this.ArB*Math.log(Math.tan(_i-i)),this.v_pole_s=this.ArB*Math.log(Math.tan(_i+i))}function Yoe(t){var e={},n,r,i,l,c,s,p,y;if(t.x=t.x-this.lam0,Math.abs(Math.abs(t.y)-En)>Xn){if(c=this.E/Math.pow(xu(this.e,t.y,Math.sin(t.y)),this.B),s=1/c,n=.5*(c-s),r=.5*(c+s),l=Math.sin(this.B*t.x),i=(n*this.singam-l*this.cosgam)/r,Math.abs(Math.abs(i)-1)<Xn)throw new Error;y=.5*this.ArB*Math.log((1-i)/(1+i)),s=Math.cos(this.B*t.x),Math.abs(s)<xv?p=this.A*t.x:p=this.ArB*Math.atan2(n*this.cosgam+l*this.singam,s)}else y=t.y>0?this.v_pole_n:this.v_pole_s,p=this.ArB*t.y;return this.no_rot?(e.x=p,e.y=y):(p-=this.u_0,e.x=y*this.cosrot+p*this.sinrot,e.y=p*this.cosrot-y*this.sinrot),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e}function Koe(t){var e,n,r,i,l,c,s,p={};if(t.x=(t.x-this.x0)*(1/this.a),t.y=(t.y-this.y0)*(1/this.a),this.no_rot?(n=t.y,e=t.x):(n=t.x*this.cosrot-t.y*this.sinrot,e=t.y*this.cosrot+t.x*this.sinrot+this.u_0),r=Math.exp(-this.BrA*n),i=.5*(r-1/r),l=.5*(r+1/r),c=Math.sin(this.BrA*e),s=(c*this.cosgam+i*this.singam)/l,Math.abs(Math.abs(s)-1)<Xn)p.x=0,p.y=s<0?-En:En;else{if(p.y=this.E/Math.sqrt((1+s)/(1-s)),p.y=T_(this.e,Math.pow(p.y,1/this.B)),p.y===1/0)throw new Error;p.x=-this.rB*Math.atan2(i*this.cosgam-c*this.singam,Math.cos(this.BrA*e))}return p.x+=this.lam0,p}var Joe=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"];const Qoe={init:Zoe,forward:Yoe,inverse:Koe,names:Joe};function ese(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Xn)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),r=Rh(this.e,e,n),i=xu(this.e,this.lat1,e),l=Math.sin(this.lat2),c=Math.cos(this.lat2),s=Rh(this.e,l,c),p=xu(this.e,this.lat2,l),y=xu(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Xn?this.ns=Math.log(r/s)/Math.log(i/p):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(y,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function tse(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=Xn&&(n=lx(n)*(En-2*Xn));var r=Math.abs(Math.abs(n)-En),i,l;if(r>Xn)i=xu(this.e,n,Math.sin(n)),l=this.a*this.f0*Math.pow(i,this.ns);else{if(r=n*this.ns,r<=0)return null;l=0}var c=this.ns*Kn(e-this.long0);return t.x=this.k0*(l*Math.sin(c))+this.x0,t.y=this.k0*(this.rh-l*Math.cos(c))+this.y0,t}function nse(t){var e,n,r,i,l,c=(t.x-this.x0)/this.k0,s=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(c*c+s*s),n=1):(e=-Math.sqrt(c*c+s*s),n=-1);var p=0;if(e!==0&&(p=Math.atan2(n*c,n*s)),e!==0||this.ns>0){if(n=1/this.ns,r=Math.pow(e/(this.a*this.f0),n),i=T_(this.e,r),i===-9999)return null}else i=-En;return l=Kn(p/this.ns+this.long0),t.x=l,t.y=i,t}var rse=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"];const ise={init:ese,forward:tse,inverse:nse,names:rse};function ose(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function sse(t){var e,n,r,i,l,c,s,p=t.x,y=t.y,_=Kn(p-this.long0);return e=Math.pow((1+this.e*Math.sin(y))/(1-this.e*Math.sin(y)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(y/2+this.s45),this.alfa)/e)-this.s45),r=-_*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),l=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),c=this.n*l,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),t.y=s*Math.cos(c)/1,t.x=s*Math.sin(c)/1,this.czech||(t.y*=-1,t.x*=-1),t}function ase(t){var e,n,r,i,l,c,s,p,y=t.x;t.x=t.y,t.y=y,this.czech||(t.y*=-1,t.x*=-1),c=Math.sqrt(t.x*t.x+t.y*t.y),l=Math.atan2(t.y,t.x),i=l/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/c,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(e)),t.x=this.long0-n/this.alfa,s=e,p=0;var _=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(s))/(1-this.e*Math.sin(s)),this.e/2))-this.s45),Math.abs(s-t.y)<1e-10&&(p=1),s=t.y,_+=1;while(p===0&&_<15);return _>=15?null:t}var lse=["Krovak","krovak"];const cse={init:ose,forward:sse,inverse:ase,names:lse};function Pa(t,e,n,r,i){return t*i-e*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)}function cx(t){return 1-.25*t*(1+t/16*(3+1.25*t))}function ux(t){return .375*t*(1+.25*t*(1+.46875*t))}function hx(t){return .05859375*t*t*(1+.75*t)}function dx(t){return t*t*t*(35/3072)}function oy(t,e,n){var r=e*n;return t/Math.sqrt(1-r*r)}function _p(t){return Math.abs(t)<En?t:t-lx(t)*Math.PI}function Gb(t,e,n,r,i){var l,c;l=t/e;for(var s=0;s<15;s++)if(c=(t-(e*l-n*Math.sin(2*l)+r*Math.sin(4*l)-i*Math.sin(6*l)))/(e-2*n*Math.cos(2*l)+4*r*Math.cos(4*l)-6*i*Math.cos(6*l)),l+=c,Math.abs(c)<=1e-10)return l;return NaN}function use(){this.sphere||(this.e0=cx(this.es),this.e1=ux(this.es),this.e2=hx(this.es),this.e3=dx(this.es),this.ml0=this.a*Pa(this.e0,this.e1,this.e2,this.e3,this.lat0))}function hse(t){var e,n,r=t.x,i=t.y;if(r=Kn(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var l=Math.sin(i),c=Math.cos(i),s=oy(this.a,this.e,l),p=Math.tan(i)*Math.tan(i),y=r*Math.cos(i),_=y*y,w=this.es*c*c/(1-this.es),S=this.a*Pa(this.e0,this.e1,this.e2,this.e3,i);e=s*y*(1-_*p*(1/6-(8-p+8*w)*_/120)),n=S-this.ml0+s*l/c*_*(.5+(5-p+6*w)*_/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function dse(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i;if(this.sphere){var l=n+this.lat0;r=Math.asin(Math.sin(l)*Math.cos(e)),i=Math.atan2(Math.tan(e),Math.cos(l))}else{var c=this.ml0/this.a+n,s=Gb(c,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-En)<=Xn)return t.x=this.long0,t.y=En,n<0&&(t.y*=-1),t;var p=oy(this.a,this.e,Math.sin(s)),y=p*p*p/this.a/this.a*(1-this.es),_=Math.pow(Math.tan(s),2),w=e*this.a/p,S=w*w;r=s-p*Math.tan(s)/y*w*w*(.5-(1+3*_)*w*w/24),i=w*(1-S*(_/3+(1+3*_)*_*S/15))/Math.cos(s)}return t.x=Kn(i+this.long0),t.y=_p(r),t}var fse=["Cassini","Cassini_Soldner","cass"];const pse={init:use,forward:hse,inverse:dse,names:fse};function Jf(t,e){var n;return t>1e-7?(n=t*e,(1-t*t)*(e/(1-n*n)-.5/t*Math.log((1-n)/(1+n)))):2*e}var mse=1,gse=2,vse=3,yse=4;function _se(){var t=Math.abs(this.lat0);if(Math.abs(t-En)<Xn?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<Xn?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var e;switch(this.qp=Jf(this.e,1),this.mmf=.5/(1-this.es),this.apa=Pse(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Jf(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function xse(t){var e,n,r,i,l,c,s,p,y,_,w=t.x,S=t.y;if(w=Kn(w-this.long0),this.sphere){if(l=Math.sin(S),_=Math.cos(S),r=Math.cos(w),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(n=this.mode===this.EQUIT?1+_*r:1+this.sinph0*l+this.cosph0*_*r,n<=Xn)return null;n=Math.sqrt(2/n),e=n*_*Math.sin(w),n*=this.mode===this.EQUIT?l:this.cosph0*l-this.sinph0*_*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(S+this.lat0)<Xn)return null;n=_i-S*.5,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(w),n*=r}}else{switch(s=0,p=0,y=0,r=Math.cos(w),i=Math.sin(w),l=Math.sin(S),c=Jf(this.e,l),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(s=c/this.qp,p=Math.sqrt(1-s*s)),this.mode){case this.OBLIQ:y=1+this.sinb1*s+this.cosb1*p*r;break;case this.EQUIT:y=1+p*r;break;case this.N_POLE:y=En+S,c=this.qp-c;break;case this.S_POLE:y=S-En,c=this.qp+c;break}if(Math.abs(y)<Xn)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:y=Math.sqrt(2/y),this.mode===this.OBLIQ?n=this.ymf*y*(this.cosb1*s-this.sinb1*p*r):n=(y=Math.sqrt(2/(1+p*r)))*s*this.ymf,e=this.xmf*y*p*i;break;case this.N_POLE:case this.S_POLE:c>=0?(e=(y=Math.sqrt(c))*i,n=r*(this.mode===this.S_POLE?y:-y)):e=n=0;break}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function bse(t){t.x-=this.x0,t.y-=this.y0;var e=t.x/this.a,n=t.y/this.a,r,i,l,c,s,p,y;if(this.sphere){var _=0,w,S=0;if(w=Math.sqrt(e*e+n*n),i=w*.5,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(S=Math.sin(i),_=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(w)<=Xn?0:Math.asin(n*S/w),e*=S,n=_*w;break;case this.OBLIQ:i=Math.abs(w)<=Xn?this.lat0:Math.asin(_*this.sinph0+n*S*this.cosph0/w),e*=S*this.cosph0,n=(_-Math.sin(i)*this.sinph0)*w;break;case this.N_POLE:n=-n,i=En-i;break;case this.S_POLE:i-=En;break}r=n===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(e,n)}else{if(y=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(e/=this.dd,n*=this.dd,p=Math.sqrt(e*e+n*n),p<Xn)return t.x=this.long0,t.y=this.lat0,t;c=2*Math.asin(.5*p/this.rq),l=Math.cos(c),e*=c=Math.sin(c),this.mode===this.OBLIQ?(y=l*this.sinb1+n*c*this.cosb1/p,s=this.qp*y,n=p*this.cosb1*l-n*this.sinb1*c):(y=n*c/p,s=this.qp*y,n=p*l)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),s=e*e+n*n,!s)return t.x=this.long0,t.y=this.lat0,t;y=1-s/this.qp,this.mode===this.S_POLE&&(y=-y)}r=Math.atan2(e,n),i=Ase(Math.asin(y),this.apa)}return t.x=Kn(this.long0+r),t.y=i,t}var wse=.3333333333333333,Sse=.17222222222222222,Mse=.10257936507936508,Cse=.06388888888888888,Ese=.0664021164021164,Tse=.016415012942191543;function Pse(t){var e,n=[];return n[0]=t*wse,e=t*t,n[0]+=e*Sse,n[1]=e*Cse,e*=t,n[0]+=e*Mse,n[1]+=e*Ese,n[2]=e*Tse,n}function Ase(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)}var Ise=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];const Rse={init:_se,forward:xse,inverse:bse,names:Ise,S_POLE:mse,N_POLE:gse,EQUIT:vse,OBLIQ:yse};function cp(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}function Lse(){Math.abs(this.lat1+this.lat2)<Xn||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Rh(this.e3,this.sin_po,this.cos_po),this.qs1=Jf(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Rh(this.e3,this.sin_po,this.cos_po),this.qs2=Jf(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Jf(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Xn?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function kse(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Jf(this.e3,this.sin_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,l=this.ns0*Kn(e-this.long0),c=i*Math.sin(l)+this.x0,s=this.rh-i*Math.cos(l)+this.y0;return t.x=c,t.y=s,t}function Dse(t){var e,n,r,i,l,c;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),r=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),r=-1),i=0,e!==0&&(i=Math.atan2(r*t.x,r*t.y)),r=e*this.ns0/this.a,this.sphere?c=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,c=this.phi1z(this.e3,n)),l=Kn(i/this.ns0+this.long0),t.x=l,t.y=c,t}function zse(t,e){var n,r,i,l,c,s=cp(.5*e);if(t<Xn)return s;for(var p=t*t,y=1;y<=25;y++)if(n=Math.sin(s),r=Math.cos(s),i=t*n,l=1-i*i,c=.5*l*l/r*(e/(1-p)-n/l+.5/t*Math.log((1-i)/(1+i))),s=s+c,Math.abs(c)<=1e-7)return s;return null}var Ose=["Albers_Conic_Equal_Area","Albers","aea"];const Fse={init:Lse,forward:kse,inverse:Dse,names:Ose,phi1z:zse};function Nse(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Bse(t){var e,n,r,i,l,c,s,p,y=t.x,_=t.y;return r=Kn(y-this.long0),e=Math.sin(_),n=Math.cos(_),i=Math.cos(r),c=this.sin_p14*e+this.cos_p14*n*i,l=1,c>0||Math.abs(c)<=Xn?(s=this.x0+this.a*l*n*Math.sin(r)/c,p=this.y0+this.a*l*(this.cos_p14*e-this.sin_p14*n*i)/c):(s=this.x0+this.infinity_dist*n*Math.sin(r),p=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*i)),t.x=s,t.y=p,t}function Use(t){var e,n,r,i,l,c;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(i=Math.atan2(e,this.rc),n=Math.sin(i),r=Math.cos(i),c=cp(r*this.sin_p14+t.y*n*this.cos_p14/e),l=Math.atan2(t.x*n,e*this.cos_p14*r-t.y*this.sin_p14*n),l=Kn(this.long0+l)):(c=this.phic0,l=0),t.x=l,t.y=c,t}var $se=["gnom"];const Vse={init:Nse,forward:Bse,inverse:Use,names:$se};function jse(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*En:En;for(var r=Math.asin(.5*e),i,l,c,s,p=0;p<30;p++)if(l=Math.sin(r),c=Math.cos(r),s=t*l,i=Math.pow(1-s*s,2)/(2*c)*(e/(1-t*t)-l/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),r+=i,Math.abs(i)<=1e-10)return r;return NaN}function Hse(){this.sphere||(this.k0=Rh(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function Gse(t){var e=t.x,n=t.y,r,i,l=Kn(e-this.long0);if(this.sphere)r=this.x0+this.a*l*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var c=Jf(this.e,Math.sin(n));r=this.x0+this.a*this.k0*l,i=this.y0+this.a*c*.5/this.k0}return t.x=r,t.y=i,t}function Wse(t){t.x-=this.x0,t.y-=this.y0;var e,n;return this.sphere?(e=Kn(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=jse(this.e,2*t.y*this.k0/this.a),e=Kn(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t}var qse=["cea"];const Xse={init:Hse,forward:Gse,inverse:Wse,names:qse};function Zse(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Yse(t){var e=t.x,n=t.y,r=Kn(e-this.long0),i=_p(n-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*i,t}function Kse(t){var e=t.x,n=t.y;return t.x=Kn(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=_p(this.lat0+(n-this.y0)/this.a),t}var Jse=["Equirectangular","Equidistant_Cylindrical","eqc"];const Qse={init:Zse,forward:Yse,inverse:Kse,names:Jse};var mk=20;function eae(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=cx(this.es),this.e1=ux(this.es),this.e2=hx(this.es),this.e3=dx(this.es),this.ml0=this.a*Pa(this.e0,this.e1,this.e2,this.e3,this.lat0)}function tae(t){var e=t.x,n=t.y,r,i,l,c=Kn(e-this.long0);if(l=c*Math.sin(n),this.sphere)Math.abs(n)<=Xn?(r=this.a*c,i=-1*this.a*this.lat0):(r=this.a*Math.sin(l)/Math.tan(n),i=this.a*(_p(n-this.lat0)+(1-Math.cos(l))/Math.tan(n)));else if(Math.abs(n)<=Xn)r=this.a*c,i=-1*this.ml0;else{var s=oy(this.a,this.e,Math.sin(n))/Math.tan(n);r=s*Math.sin(l),i=this.a*Pa(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+s*(1-Math.cos(l))}return t.x=r+this.x0,t.y=i+this.y0,t}function nae(t){var e,n,r,i,l,c,s,p,y;if(r=t.x-this.x0,i=t.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=Xn)e=Kn(r/this.a+this.long0),n=0;else{c=this.lat0+i/this.a,s=r*r/this.a/this.a+c*c,p=c;var _;for(l=mk;l;--l)if(_=Math.tan(p),y=-1*(c*(p*_+1)-p-.5*(p*p+s)*_)/((p-c)/_-1),p+=y,Math.abs(y)<=Xn){n=p;break}e=Kn(this.long0+Math.asin(r*Math.tan(p)/this.a)/Math.sin(n))}else if(Math.abs(i+this.ml0)<=Xn)n=0,e=Kn(this.long0+r/this.a);else{c=(this.ml0+i)/this.a,s=r*r/this.a/this.a+c*c,p=c;var w,S,M,I,D;for(l=mk;l;--l)if(D=this.e*Math.sin(p),w=Math.sqrt(1-D*D)*Math.tan(p),S=this.a*Pa(this.e0,this.e1,this.e2,this.e3,p),M=this.e0-2*this.e1*Math.cos(2*p)+4*this.e2*Math.cos(4*p)-6*this.e3*Math.cos(6*p),I=S/this.a,y=(c*(w*I+1)-I-.5*w*(I*I+s))/(this.es*Math.sin(2*p)*(I*I+s-2*c*I)/(4*w)+(c-I)*(w*M-2/Math.sin(2*p))-M),p-=y,Math.abs(y)<=Xn){n=p;break}w=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=Kn(this.long0+Math.asin(r*w/this.a)/Math.sin(n))}return t.x=e,t.y=n,t}var rae=["Polyconic","poly"];const iae={init:eae,forward:tae,inverse:nae,names:rae};function oae(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function sae(t){var e,n=t.x,r=t.y,i=r-this.lat0,l=n-this.long0,c=i/q0*1e-5,s=l,p=1,y=0;for(e=1;e<=10;e++)p=p*c,y=y+this.A[e]*p;var _=y,w=s,S=1,M=0,I,D,R=0,L=0;for(e=1;e<=6;e++)I=S*_-M*w,D=M*_+S*w,S=I,M=D,R=R+this.B_re[e]*S-this.B_im[e]*M,L=L+this.B_im[e]*S+this.B_re[e]*M;return t.x=L*this.a+this.x0,t.y=R*this.a+this.y0,t}function aae(t){var e,n=t.x,r=t.y,i=n-this.x0,l=r-this.y0,c=l/this.a,s=i/this.a,p=1,y=0,_,w,S=0,M=0;for(e=1;e<=6;e++)_=p*c-y*s,w=y*c+p*s,p=_,y=w,S=S+this.C_re[e]*p-this.C_im[e]*y,M=M+this.C_im[e]*p+this.C_re[e]*y;for(var I=0;I<this.iterations;I++){var D=S,R=M,L,V,B=c,H=s;for(e=2;e<=6;e++)L=D*S-R*M,V=R*S+D*M,D=L,R=V,B=B+(e-1)*(this.B_re[e]*D-this.B_im[e]*R),H=H+(e-1)*(this.B_im[e]*D+this.B_re[e]*R);D=1,R=0;var q=this.B_re[1],X=this.B_im[1];for(e=2;e<=6;e++)L=D*S-R*M,V=R*S+D*M,D=L,R=V,q=q+e*(this.B_re[e]*D-this.B_im[e]*R),X=X+e*(this.B_im[e]*D+this.B_re[e]*R);var ee=q*q+X*X;S=(B*q+H*X)/ee,M=(H*q-B*X)/ee}var se=S,J=M,$=1,le=0;for(e=1;e<=9;e++)$=$*se,le=le+this.D[e]*$;var Ce=this.lat0+le*q0*1e5,we=this.long0+J;return t.x=we,t.y=Ce,t}var lae=["New_Zealand_Map_Grid","nzmg"];const cae={init:oae,forward:sae,inverse:aae,names:lae};function uae(){}function hae(t){var e=t.x,n=t.y,r=Kn(e-this.long0),i=this.x0+this.a*r,l=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=i,t.y=l,t}function dae(t){t.x-=this.x0,t.y-=this.y0;var e=Kn(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var fae=["Miller_Cylindrical","mill"];const pae={init:uae,forward:hae,inverse:dae,names:fae};var mae=20;function gae(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=FA(this.es)}function vae(t){var e,n,r=t.x,i=t.y;if(r=Kn(r-this.long0),this.sphere){if(!this.m)i=this.n!==1?Math.asin(this.n*Math.sin(i)):i;else for(var l=this.n*Math.sin(i),c=mae;c;--c){var s=(this.m*i+Math.sin(i)-l)/(this.m+Math.cos(i));if(i-=s,Math.abs(s)<Xn)break}e=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var p=Math.sin(i),y=Math.cos(i);n=this.a*py(i,p,y,this.en),e=this.a*r*y/Math.sqrt(1-this.es*p*p)}return t.x=e,t.y=n,t}function yae(t){var e,n,r,i;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r=r/(this.C_x*(this.m+Math.cos(e))),this.m?e=cp((this.m*e+Math.sin(e))/this.n):this.n!==1&&(e=cp(Math.sin(e)/this.n)),r=Kn(r+this.long0),e=_p(e)):(e=NA(t.y/this.a,this.es,this.en),i=Math.abs(e),i<En?(i=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*i*i)/(this.a*Math.cos(e)),r=Kn(n)):i-Xn<En&&(r=this.long0)),t.x=r,t.y=e,t}var _ae=["Sinusoidal","sinu"];const xae={init:gae,forward:vae,inverse:yae,names:_ae};function bae(){}function wae(t){for(var e=t.x,n=t.y,r=Kn(e-this.long0),i=n,l=Math.PI*Math.sin(n);;){var c=-(i+Math.sin(i)-l)/(1+Math.cos(i));if(i+=c,Math.abs(c)<Xn)break}i/=2,Math.PI/2-Math.abs(n)<Xn&&(r=0);var s=.900316316158*this.a*r*Math.cos(i)+this.x0,p=1.4142135623731*this.a*Math.sin(i)+this.y0;return t.x=s,t.y=p,t}function Sae(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=Kn(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return t.x=r,t.y=i,t}var Mae=["Mollweide","moll"];const Cae={init:bae,forward:wae,inverse:Sae,names:Mae};function Eae(){Math.abs(this.lat1+this.lat2)<Xn||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=cx(this.es),this.e1=ux(this.es),this.e2=hx(this.es),this.e3=dx(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Rh(this.e,this.sinphi,this.cosphi),this.ml1=Pa(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Xn?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Rh(this.e,this.sinphi,this.cosphi),this.ml2=Pa(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Pa(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function Tae(t){var e=t.x,n=t.y,r;if(this.sphere)r=this.a*(this.g-n);else{var i=Pa(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-i)}var l=this.ns*Kn(e-this.long0),c=this.x0+r*Math.sin(l),s=this.y0+this.rh-r*Math.cos(l);return t.x=c,t.y=s,t}function Pae(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,n,r,i;this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var l=0;if(n!==0&&(l=Math.atan2(e*t.x,e*t.y)),this.sphere)return i=Kn(this.long0+l/this.ns),r=_p(this.g-n/this.a),t.x=i,t.y=r,t;var c=this.g-n/this.a;return r=Gb(c,this.e0,this.e1,this.e2,this.e3),i=Kn(this.long0+l/this.ns),t.x=i,t.y=r,t}var Aae=["Equidistant_Conic","eqdc"];const Iae={init:Eae,forward:Tae,inverse:Pae,names:Aae};function Rae(){this.R=this.a}function Lae(t){var e=t.x,n=t.y,r=Kn(e-this.long0),i,l;Math.abs(n)<=Xn&&(i=this.x0+this.R*r,l=this.y0);var c=cp(2*Math.abs(n/Math.PI));(Math.abs(r)<=Xn||Math.abs(Math.abs(n)-En)<=Xn)&&(i=this.x0,n>=0?l=this.y0+Math.PI*this.R*Math.tan(.5*c):l=this.y0+Math.PI*this.R*-Math.tan(.5*c));var s=.5*Math.abs(Math.PI/r-r/Math.PI),p=s*s,y=Math.sin(c),_=Math.cos(c),w=_/(y+_-1),S=w*w,M=w*(2/y-1),I=M*M,D=Math.PI*this.R*(s*(w-I)+Math.sqrt(p*(w-I)*(w-I)-(I+p)*(S-I)))/(I+p);r<0&&(D=-D),i=this.x0+D;var R=p+w;return D=Math.PI*this.R*(M*R-s*Math.sqrt((I+p)*(p+1)-R*R))/(I+p),n>=0?l=this.y0+D:l=this.y0-D,t.x=i,t.y=l,t}function kae(t){var e,n,r,i,l,c,s,p,y,_,w,S,M;return t.x-=this.x0,t.y-=this.y0,w=Math.PI*this.R,r=t.x/w,i=t.y/w,l=r*r+i*i,c=-Math.abs(i)*(1+l),s=c-2*i*i+r*r,p=-2*c+1+2*i*i+l*l,M=i*i/p+(2*s*s*s/p/p/p-9*c*s/p/p)/27,y=(c-s*s/3/p)/p,_=2*Math.sqrt(-y/3),w=3*M/y/_,Math.abs(w)>1&&(w>=0?w=1:w=-1),S=Math.acos(w)/3,t.y>=0?n=(-_*Math.cos(S+Math.PI/3)-s/3/p)*Math.PI:n=-(-_*Math.cos(S+Math.PI/3)-s/3/p)*Math.PI,Math.abs(r)<Xn?e=this.long0:e=Kn(this.long0+Math.PI*(l-1+Math.sqrt(1+2*(r*r-i*i)+l*l))/2/r),t.x=e,t.y=n,t}var Dae=["Van_der_Grinten_I","VanDerGrinten","vandg"];const zae={init:Rae,forward:Lae,inverse:kae,names:Dae};function Oae(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function Fae(t){var e=t.x,n=t.y,r=Math.sin(t.y),i=Math.cos(t.y),l=Kn(e-this.long0),c,s,p,y,_,w,S,M,I,D,R,L,V,B,H,q,X,ee,se,J,$,le,Ce;return this.sphere?Math.abs(this.sin_p12-1)<=Xn?(t.x=this.x0+this.a*(En-n)*Math.sin(l),t.y=this.y0-this.a*(En-n)*Math.cos(l),t):Math.abs(this.sin_p12+1)<=Xn?(t.x=this.x0+this.a*(En+n)*Math.sin(l),t.y=this.y0+this.a*(En+n)*Math.cos(l),t):(ee=this.sin_p12*r+this.cos_p12*i*Math.cos(l),q=Math.acos(ee),X=q?q/Math.sin(q):1,t.x=this.x0+this.a*X*i*Math.sin(l),t.y=this.y0+this.a*X*(this.cos_p12*r-this.sin_p12*i*Math.cos(l)),t):(c=cx(this.es),s=ux(this.es),p=hx(this.es),y=dx(this.es),Math.abs(this.sin_p12-1)<=Xn?(_=this.a*Pa(c,s,p,y,En),w=this.a*Pa(c,s,p,y,n),t.x=this.x0+(_-w)*Math.sin(l),t.y=this.y0-(_-w)*Math.cos(l),t):Math.abs(this.sin_p12+1)<=Xn?(_=this.a*Pa(c,s,p,y,En),w=this.a*Pa(c,s,p,y,n),t.x=this.x0+(_+w)*Math.sin(l),t.y=this.y0+(_+w)*Math.cos(l),t):(S=r/i,M=oy(this.a,this.e,this.sin_p12),I=oy(this.a,this.e,r),D=Math.atan((1-this.es)*S+this.es*M*this.sin_p12/(I*i)),R=Math.atan2(Math.sin(l),this.cos_p12*Math.tan(D)-this.sin_p12*Math.cos(l)),R===0?se=Math.asin(this.cos_p12*Math.sin(D)-this.sin_p12*Math.cos(D)):Math.abs(Math.abs(R)-Math.PI)<=Xn?se=-Math.asin(this.cos_p12*Math.sin(D)-this.sin_p12*Math.cos(D)):se=Math.asin(Math.sin(l)*Math.cos(D)/Math.sin(R)),L=this.e*this.sin_p12/Math.sqrt(1-this.es),V=this.e*this.cos_p12*Math.cos(R)/Math.sqrt(1-this.es),B=L*V,H=V*V,J=se*se,$=J*se,le=$*se,Ce=le*se,q=M*se*(1-J*H*(1-H)/6+$/8*B*(1-2*H)+le/120*(H*(4-7*H)-3*L*L*(1-7*H))-Ce/48*B),t.x=this.x0+q*Math.sin(R),t.y=this.y0+q*Math.cos(R),t))}function Nae(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,i,l,c,s,p,y,_,w,S,M,I,D,R,L,V,B,H,q,X,ee,se;return this.sphere?(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*En*this.a?void 0:(n=e/this.a,r=Math.sin(n),i=Math.cos(n),l=this.long0,Math.abs(e)<=Xn?c=this.lat0:(c=cp(i*this.sin_p12+t.y*r*this.cos_p12/e),s=Math.abs(this.lat0)-En,Math.abs(s)<=Xn?this.lat0>=0?l=Kn(this.long0+Math.atan2(t.x,-t.y)):l=Kn(this.long0-Math.atan2(-t.x,t.y)):l=Kn(this.long0+Math.atan2(t.x*r,e*this.cos_p12*i-t.y*this.sin_p12*r))),t.x=l,t.y=c,t)):(p=cx(this.es),y=ux(this.es),_=hx(this.es),w=dx(this.es),Math.abs(this.sin_p12-1)<=Xn?(S=this.a*Pa(p,y,_,w,En),e=Math.sqrt(t.x*t.x+t.y*t.y),M=S-e,c=Gb(M/this.a,p,y,_,w),l=Kn(this.long0+Math.atan2(t.x,-1*t.y)),t.x=l,t.y=c,t):Math.abs(this.sin_p12+1)<=Xn?(S=this.a*Pa(p,y,_,w,En),e=Math.sqrt(t.x*t.x+t.y*t.y),M=e-S,c=Gb(M/this.a,p,y,_,w),l=Kn(this.long0+Math.atan2(t.x,t.y)),t.x=l,t.y=c,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),R=Math.atan2(t.x,t.y),I=oy(this.a,this.e,this.sin_p12),L=Math.cos(R),V=this.e*this.cos_p12*L,B=-V*V/(1-this.es),H=3*this.es*(1-B)*this.sin_p12*this.cos_p12*L/(1-this.es),q=e/I,X=q-B*(1+B)*Math.pow(q,3)/6-H*(1+3*B)*Math.pow(q,4)/24,ee=1-B*X*X/2-q*X*X*X/6,D=Math.asin(this.sin_p12*Math.cos(X)+this.cos_p12*Math.sin(X)*L),l=Kn(this.long0+Math.asin(Math.sin(R)*Math.sin(X)/Math.cos(D))),se=Math.sin(D),c=Math.atan2((se-this.es*ee*this.sin_p12)*Math.tan(D),se*(1-this.es)),t.x=l,t.y=c,t))}var Bae=["Azimuthal_Equidistant","aeqd"];const Uae={init:Oae,forward:Fae,inverse:Nae,names:Bae};function $ae(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function Vae(t){var e,n,r,i,l,c,s,p,y=t.x,_=t.y;return r=Kn(y-this.long0),e=Math.sin(_),n=Math.cos(_),i=Math.cos(r),c=this.sin_p14*e+this.cos_p14*n*i,l=1,(c>0||Math.abs(c)<=Xn)&&(s=this.a*l*n*Math.sin(r),p=this.y0+this.a*l*(this.cos_p14*e-this.sin_p14*n*i)),t.x=s,t.y=p,t}function jae(t){var e,n,r,i,l,c,s;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=cp(e/this.a),r=Math.sin(n),i=Math.cos(n),c=this.long0,Math.abs(e)<=Xn?(s=this.lat0,t.x=c,t.y=s,t):(s=cp(i*this.sin_p14+t.y*r*this.cos_p14/e),l=Math.abs(this.lat0)-En,Math.abs(l)<=Xn?(this.lat0>=0?c=Kn(this.long0+Math.atan2(t.x,-t.y)):c=Kn(this.long0-Math.atan2(-t.x,t.y)),t.x=c,t.y=s,t):(c=Kn(this.long0+Math.atan2(t.x*r,e*this.cos_p14*i-t.y*this.sin_p14*r)),t.x=c,t.y=s,t))}var Hae=["ortho"];const Gae={init:$ae,forward:Vae,inverse:jae,names:Hae};var lo={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},xi={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function Wae(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=En-_i/2?this.face=lo.TOP:this.lat0<=-(En-_i/2)?this.face=lo.BOTTOM:Math.abs(this.long0)<=_i?this.face=lo.FRONT:Math.abs(this.long0)<=En+_i?this.face=this.long0>0?lo.RIGHT:lo.LEFT:this.face=lo.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function qae(t){var e={x:0,y:0},n,r,i,l,c,s,p={value:0};if(t.x-=this.long0,this.es!==0?n=Math.atan(this.one_minus_f_squared*Math.tan(t.y)):n=t.y,r=t.x,this.face===lo.TOP)l=En-n,r>=_i&&r<=En+_i?(p.value=xi.AREA_0,i=r-En):r>En+_i||r<=-(En+_i)?(p.value=xi.AREA_1,i=r>0?r-ko:r+ko):r>-(En+_i)&&r<=-_i?(p.value=xi.AREA_2,i=r+En):(p.value=xi.AREA_3,i=r);else if(this.face===lo.BOTTOM)l=En+n,r>=_i&&r<=En+_i?(p.value=xi.AREA_0,i=-r+En):r<_i&&r>=-_i?(p.value=xi.AREA_1,i=-r):r<-_i&&r>=-(En+_i)?(p.value=xi.AREA_2,i=-r-En):(p.value=xi.AREA_3,i=r>0?-r+ko:-r-ko);else{var y,_,w,S,M,I,D;this.face===lo.RIGHT?r=Hv(r,+En):this.face===lo.BACK?r=Hv(r,+ko):this.face===lo.LEFT&&(r=Hv(r,-En)),S=Math.sin(n),M=Math.cos(n),I=Math.sin(r),D=Math.cos(r),y=M*D,_=M*I,w=S,this.face===lo.FRONT?(l=Math.acos(y),i=v1(l,w,_,p)):this.face===lo.RIGHT?(l=Math.acos(_),i=v1(l,w,-y,p)):this.face===lo.BACK?(l=Math.acos(-y),i=v1(l,w,-_,p)):this.face===lo.LEFT?(l=Math.acos(-_),i=v1(l,w,y,p)):(l=i=0,p.value=xi.AREA_0)}return s=Math.atan(12/ko*(i+Math.acos(Math.sin(i)*Math.cos(_i))-En)),c=Math.sqrt((1-Math.cos(l))/(Math.cos(s)*Math.cos(s))/(1-Math.cos(Math.atan(1/Math.cos(i))))),p.value===xi.AREA_1?s+=En:p.value===xi.AREA_2?s+=ko:p.value===xi.AREA_3&&(s+=1.5*ko),e.x=c*Math.cos(s),e.y=c*Math.sin(s),e.x=e.x*this.a+this.x0,e.y=e.y*this.a+this.y0,t.x=e.x,t.y=e.y,t}function Xae(t){var e={lam:0,phi:0},n,r,i,l,c,s,p,y,_,w={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,r=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),n=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?w.value=xi.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(w.value=xi.AREA_1,n-=En):t.x<0&&-t.x>=Math.abs(t.y)?(w.value=xi.AREA_2,n=n<0?n+ko:n-ko):(w.value=xi.AREA_3,n+=En),_=ko/12*Math.tan(n),c=Math.sin(_)/(Math.cos(_)-1/Math.sqrt(2)),s=Math.atan(c),i=Math.cos(n),l=Math.tan(r),p=1-i*i*l*l*(1-Math.cos(Math.atan(1/Math.cos(s)))),p<-1?p=-1:p>1&&(p=1),this.face===lo.TOP)y=Math.acos(p),e.phi=En-y,w.value===xi.AREA_0?e.lam=s+En:w.value===xi.AREA_1?e.lam=s<0?s+ko:s-ko:w.value===xi.AREA_2?e.lam=s-En:e.lam=s;else if(this.face===lo.BOTTOM)y=Math.acos(p),e.phi=y-En,w.value===xi.AREA_0?e.lam=-s+En:w.value===xi.AREA_1?e.lam=-s:w.value===xi.AREA_2?e.lam=-s-En:e.lam=s<0?-s-ko:-s+ko;else{var S,M,I;S=p,_=S*S,_>=1?I=0:I=Math.sqrt(1-_)*Math.sin(s),_+=I*I,_>=1?M=0:M=Math.sqrt(1-_),w.value===xi.AREA_1?(_=M,M=-I,I=_):w.value===xi.AREA_2?(M=-M,I=-I):w.value===xi.AREA_3&&(_=M,M=I,I=-_),this.face===lo.RIGHT?(_=S,S=-M,M=_):this.face===lo.BACK?(S=-S,M=-M):this.face===lo.LEFT&&(_=S,S=M,M=-_),e.phi=Math.acos(-I)-En,e.lam=Math.atan2(M,S),this.face===lo.RIGHT?e.lam=Hv(e.lam,-En):this.face===lo.BACK?e.lam=Hv(e.lam,-ko):this.face===lo.LEFT&&(e.lam=Hv(e.lam,+En))}if(this.es!==0){var D,R,L;D=e.phi<0?1:0,R=Math.tan(e.phi),L=this.b/Math.sqrt(R*R+this.one_minus_f_squared),e.phi=Math.atan(Math.sqrt(this.a*this.a-L*L)/(this.one_minus_f*L)),D&&(e.phi=-e.phi)}return e.lam+=this.long0,t.x=e.lam,t.y=e.phi,t}function v1(t,e,n,r){var i;return t<Xn?(r.value=xi.AREA_0,i=0):(i=Math.atan2(e,n),Math.abs(i)<=_i?r.value=xi.AREA_0:i>_i&&i<=En+_i?(r.value=xi.AREA_1,i-=En):i>En+_i||i<=-(En+_i)?(r.value=xi.AREA_2,i=i>=0?i-ko:i+ko):(r.value=xi.AREA_3,i+=En)),i}function Hv(t,e){var n=t+e;return n<-ko?n+=C_:n>+ko&&(n-=C_),n}var Zae=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];const Yae={init:Wae,forward:qae,inverse:Xae,names:Zae};var dT=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],z0=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],lB=.8487,cB=1.3523,uB=bh/5,Kae=1/uB,Rv=18,Wb=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},Jae=function(t,e){return t[1]+e*(2*t[2]+e*3*t[3])};function Qae(t,e,n,r){for(var i=e;r;--r){var l=t(i);if(i-=l,Math.abs(l)<n)break}return i}function ele(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function tle(t){var e=Kn(t.x-this.long0),n=Math.abs(t.y),r=Math.floor(n*uB);r<0?r=0:r>=Rv&&(r=Rv-1),n=bh*(n-Kae*r);var i={x:Wb(dT[r],n)*e,y:Wb(z0[r],n)};return t.y<0&&(i.y=-i.y),i.x=i.x*this.a*lB+this.x0,i.y=i.y*this.a*cB+this.y0,i}function nle(t){var e={x:(t.x-this.x0)/(this.a*lB),y:Math.abs(t.y-this.y0)/(this.a*cB)};if(e.y>=1)e.x/=dT[Rv][0],e.y=t.y<0?-En:En;else{var n=Math.floor(e.y*Rv);for(n<0?n=0:n>=Rv&&(n=Rv-1);;)if(z0[n][0]>e.y)--n;else if(z0[n+1][0]<=e.y)++n;else break;var r=z0[n],i=5*(e.y-r[0])/(z0[n+1][0]-r[0]);i=Qae(function(l){return(Wb(r,l)-e.y)/Jae(r,l)},i,Xn,100),e.x/=Wb(dT[n],i),e.y=(5*n+i)*js,t.y<0&&(e.y=-e.y)}return e.x=Kn(e.x+this.long0),e}var rle=["Robinson","robin"];const ile={init:ele,forward:tle,inverse:nle,names:rle};function ole(){this.name="geocent"}function sle(t){var e=KN(t,this.es,this.a);return e}function ale(t){var e=JN(t,this.es,this.a,this.b);return e}var lle=["Geocentric","geocentric","geocent","Geocent"];const cle={init:ole,forward:sle,inverse:ale,names:lle};var la={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},v0={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};function ule(){if(Object.keys(v0).forEach((function(n){if(typeof this[n]>"u")this[n]=v0[n].def;else{if(v0[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);v0[n].num&&(this[n]=parseFloat(this[n]))}v0[n].degrees&&(this[n]=this[n]*js)}).bind(this)),Math.abs(Math.abs(this.lat0)-En)<Xn?this.mode=this.lat0<0?la.S_POLE:la.N_POLE:Math.abs(this.lat0)<Xn?this.mode=la.EQUIT:(this.mode=la.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var t=this.tilt,e=this.azi;this.cg=Math.cos(e),this.sg=Math.sin(e),this.cw=Math.cos(t),this.sw=Math.sin(t)}function hle(t){t.x-=this.long0;var e=Math.sin(t.y),n=Math.cos(t.y),r=Math.cos(t.x),i,l;switch(this.mode){case la.OBLIQ:l=this.sinph0*e+this.cosph0*n*r;break;case la.EQUIT:l=n*r;break;case la.S_POLE:l=-e;break;case la.N_POLE:l=e;break}switch(l=this.pn1/(this.p-l),i=l*n*Math.sin(t.x),this.mode){case la.OBLIQ:l*=this.cosph0*e-this.sinph0*n*r;break;case la.EQUIT:l*=e;break;case la.N_POLE:l*=-(n*r);break;case la.S_POLE:l*=n*r;break}var c,s;return c=l*this.cg+i*this.sg,s=1/(c*this.sw*this.h1+this.cw),i=(i*this.cg-l*this.sg)*this.cw*s,l=c*s,t.x=i*this.a,t.y=l*this.a,t}function dle(t){t.x/=this.a,t.y/=this.a;var e={x:t.x,y:t.y},n,r,i;i=1/(this.pn1-t.y*this.sw),n=this.pn1*t.x*i,r=this.pn1*t.y*this.cw*i,t.x=n*this.cg+r*this.sg,t.y=r*this.cg-n*this.sg;var l=Ka(t.x,t.y);if(Math.abs(l)<Xn)e.x=0,e.y=t.y;else{var c,s;switch(s=1-l*l*this.pfact,s=(this.p-Math.sqrt(s))/(this.pn1/l+l/this.pn1),c=Math.sqrt(1-s*s),this.mode){case la.OBLIQ:e.y=Math.asin(c*this.sinph0+t.y*s*this.cosph0/l),t.y=(c-this.sinph0*Math.sin(e.y))*l,t.x*=s*this.cosph0;break;case la.EQUIT:e.y=Math.asin(t.y*s/l),t.y=c*l,t.x*=s;break;case la.N_POLE:e.y=Math.asin(c),t.y=-t.y;break;case la.S_POLE:e.y=-Math.asin(c);break}e.x=Math.atan2(t.x,t.y)}return t.x=e.x+this.long0,t.y=e.y,t}var fle=["Tilted_Perspective","tpers"];const ple={init:ule,forward:hle,inverse:dle,names:fle};function mle(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var t=1-this.es,e=1/t;this.radius_p=Math.sqrt(t),this.radius_p2=t,this.radius_p_inv2=e,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")}function gle(t){var e=t.x,n=t.y,r,i,l,c;if(e=e-this.long0,this.shape==="ellipse"){n=Math.atan(this.radius_p2*Math.tan(n));var s=this.radius_p/Ka(this.radius_p*Math.cos(n),Math.sin(n));if(i=s*Math.cos(e)*Math.cos(n),l=s*Math.sin(e)*Math.cos(n),c=s*Math.sin(n),(this.radius_g-i)*i-l*l-c*c*this.radius_p_inv2<0)return t.x=Number.NaN,t.y=Number.NaN,t;r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(l/Ka(c,r)),t.y=this.radius_g_1*Math.atan(c/r)):(t.x=this.radius_g_1*Math.atan(l/r),t.y=this.radius_g_1*Math.atan(c/Ka(l,r)))}else this.shape==="sphere"&&(r=Math.cos(n),i=Math.cos(e)*r,l=Math.sin(e)*r,c=Math.sin(n),r=this.radius_g-i,this.flip_axis?(t.x=this.radius_g_1*Math.atan(l/Ka(c,r)),t.y=this.radius_g_1*Math.atan(c/r)):(t.x=this.radius_g_1*Math.atan(l/r),t.y=this.radius_g_1*Math.atan(c/Ka(l,r))));return t.x=t.x*this.a,t.y=t.y*this.a,t}function vle(t){var e=-1,n=0,r=0,i,l,c,s;if(t.x=t.x/this.a,t.y=t.y/this.a,this.shape==="ellipse"){this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Ka(1,r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Ka(1,n));var p=r/this.radius_p;if(i=n*n+p*p+e*e,l=2*this.radius_g*e,c=l*l-4*i*this.C,c<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-l-Math.sqrt(c))/(2*i),e=this.radius_g+s*e,n*=s,r*=s,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e),t.y=Math.atan(this.radius_p_inv2*Math.tan(t.y))}else if(this.shape==="sphere"){if(this.flip_axis?(r=Math.tan(t.y/this.radius_g_1),n=Math.tan(t.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(t.x/this.radius_g_1),r=Math.tan(t.y/this.radius_g_1)*Math.sqrt(1+n*n)),i=n*n+r*r+e*e,l=2*this.radius_g*e,c=l*l-4*i*this.C,c<0)return t.x=Number.NaN,t.y=Number.NaN,t;s=(-l-Math.sqrt(c))/(2*i),e=this.radius_g+s*e,n*=s,r*=s,t.x=Math.atan2(n,e),t.y=Math.atan(r*Math.cos(t.x)/e)}return t.x=t.x+this.long0,t}var yle=["Geostationary Satellite View","Geostationary_Satellite","geos"];const _le={init:mle,forward:gle,inverse:vle,names:yle};var X0=1.340264,Z0=-.081106,Y0=893e-6,K0=.003796,qb=Math.sqrt(3)/2;function xle(){this.es=0,this.long0=this.long0!==void 0?this.long0:0}function ble(t){var e=Kn(t.x-this.long0),n=t.y,r=Math.asin(qb*Math.sin(n)),i=r*r,l=i*i*i;return t.x=e*Math.cos(r)/(qb*(X0+3*Z0*i+l*(7*Y0+9*K0*i))),t.y=r*(X0+Z0*i+l*(Y0+K0*i)),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function wle(t){t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a;var e=1e-9,n=12,r=t.y,i,l,c,s,p,y;for(y=0;y<n&&(i=r*r,l=i*i*i,c=r*(X0+Z0*i+l*(Y0+K0*i))-t.y,s=X0+3*Z0*i+l*(7*Y0+9*K0*i),r-=p=c/s,!(Math.abs(p)<e));++y);return i=r*r,l=i*i*i,t.x=qb*t.x*(X0+3*Z0*i+l*(7*Y0+9*K0*i))/Math.cos(r),t.y=Math.asin(Math.sin(r)/qb),t.x=Kn(t.x+this.long0),t}var Sle=["eqearth","Equal Earth","Equal_Earth"];const Mle={init:xle,forward:ble,inverse:wle,names:Sle};var P_=1e-10;function Cle(){var t;if(this.phi1=this.lat1,Math.abs(this.phi1)<P_)throw new Error;this.es?(this.en=FA(this.es),this.m1=py(this.phi1,this.am1=Math.sin(this.phi1),t=Math.cos(this.phi1),this.en),this.am1=t/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=Tle,this.forward=Ele):(Math.abs(this.phi1)+P_>=En?this.cphi1=0:this.cphi1=1/Math.tan(this.phi1),this.inverse=Ale,this.forward=Ple)}function Ele(t){var e=Kn(t.x-(this.long0||0)),n=t.y,r,i,l;return r=this.am1+this.m1-py(n,i=Math.sin(n),l=Math.cos(n),this.en),i=l*e/(r*Math.sqrt(1-this.es*i*i)),t.x=r*Math.sin(i),t.y=this.am1-r*Math.cos(i),t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Tle(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r,i;if(n=Ka(t.x,t.y=this.am1-t.y),i=NA(this.am1+this.m1-n,this.es,this.en),(e=Math.abs(i))<En)e=Math.sin(i),r=n*Math.atan2(t.x,t.y)*Math.sqrt(1-this.es*e*e)/Math.cos(i);else if(Math.abs(e-En)<=P_)r=0;else throw new Error;return t.x=Kn(r+(this.long0||0)),t.y=_p(i),t}function Ple(t){var e=Kn(t.x-(this.long0||0)),n=t.y,r,i;return i=this.cphi1+this.phi1-n,Math.abs(i)>P_?(t.x=i*Math.sin(r=e*Math.cos(n)/i),t.y=this.cphi1-i*Math.cos(r)):t.x=t.y=0,t.x=this.a*t.x+(this.x0||0),t.y=this.a*t.y+(this.y0||0),t}function Ale(t){t.x=(t.x-(this.x0||0))/this.a,t.y=(t.y-(this.y0||0))/this.a;var e,n,r=Ka(t.x,t.y=this.cphi1-t.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>En)throw new Error;return Math.abs(Math.abs(n)-En)<=P_?e=0:e=r*Math.atan2(t.x,t.y)/Math.cos(n),t.x=Kn(e+(this.long0||0)),t.y=_p(n),t}var Ile=["bonne","Bonne (Werner lat_1=90)"];const Rle={init:Cle,names:Ile};function Lle(t){t.Proj.projections.add(hb),t.Proj.projections.add(db),t.Proj.projections.add(Toe),t.Proj.projections.add(Ooe),t.Proj.projections.add(Voe),t.Proj.projections.add(qoe),t.Proj.projections.add(Qoe),t.Proj.projections.add(ise),t.Proj.projections.add(cse),t.Proj.projections.add(pse),t.Proj.projections.add(Rse),t.Proj.projections.add(Fse),t.Proj.projections.add(Vse),t.Proj.projections.add(Xse),t.Proj.projections.add(Qse),t.Proj.projections.add(iae),t.Proj.projections.add(cae),t.Proj.projections.add(pae),t.Proj.projections.add(xae),t.Proj.projections.add(Cae),t.Proj.projections.add(Iae),t.Proj.projections.add(zae),t.Proj.projections.add(Uae),t.Proj.projections.add(Gae),t.Proj.projections.add(Yae),t.Proj.projections.add(ile),t.Proj.projections.add(cle),t.Proj.projections.add(ple),t.Proj.projections.add(_le),t.Proj.projections.add(Mle),t.Proj.projections.add(Rle)}ol.defaultDatum="WGS84";ol.Proj=Th;ol.WGS84=new ol.Proj("WGS84");ol.Point=iy;ol.toPoint=QN;ol.defs=Ea;ol.nadgrid=Aie;ol.transform=Hb;ol.mgrs=Gie;ol.version="__VERSION__";Lle(ol);const VA=6370997,Xb=VA*Math.PI/180,Lv={standardParalel1:33,standardParalel2:45,mapOrigin:[39,-96],mapFactor:[-.00017706234,.000176689948]},kle=["+proj=lcc",`+R=${VA}`,`+lat_1=${Lv.standardParalel1}`,`+lat_2=${Lv.standardParalel2}`,`+lat_0=${Lv.mapOrigin[0]}`,`+lon_0=${Lv.mapOrigin[1]}`].join(" "),Dle=ol(kle),hB=([t,e])=>{const n=Dle.forward([t,e]);return[n[0]/Lv.mapFactor[1]/Xb,n[1]/Lv.mapFactor[0]/Xb].map(r=>Number(r.toFixed(10)))},Zf={standardParalel1:37,standardParalel2:65,mapOrigin:[50,15],mapOffset:[16660,4150],mapFactor:[-.000171570875,.0001729241463]},zle=["+proj=lcc",`+R=${VA}`,`+lat_1=${Zf.standardParalel1}`,`+lat_2=${Zf.standardParalel2}`,`+lat_0=${Zf.mapOrigin[0]}`,`+lon_0=${Zf.mapOrigin[1]}`].join(" "),Ole=ol(zle),dB=([t,e])=>{const n=Ole.forward([t,e]);let[r,i]=[n[0]/Zf.mapFactor[1]/Xb,n[1]/Zf.mapFactor[0]/Xb];const l=.75,c=[-31100,-5500],s=r/l-c[0]/2,p=i/l-c[1]/2;return s*l<c[0]&&s*l<c[1]&&(r=s,i=p),[r+Zf.mapOffset[0],i+Zf.mapOffset[1]].map(_=>Number(_.toFixed(10)))},Of={ats:[[-124.477162,25.767968].map(t=>Math.floor(t)),[-88.777474,49.1223839].map(t=>Math.ceil(t))].flat(),ets2:[[-10.025698,34.897275].map(t=>Math.floor(t)),[33.284941,61.881437].map(t=>Math.ceil(t))].flat()},Fle=()=>{const t=mr(ox().current),[e,n]=G.useState(null),[r,i]=G.useState(!1),[l,c]=G.useState(!1),[s,p]=G.useState([]),y=G.useCallback(M=>{M!=="clickaway"&&i(!1)},[]),_=G.useCallback(()=>{c(!1),p([])},[]),w=M=>()=>{i(!0);const I=mr(e).position;switch(M){case"lngLat":navigator.clipboard.writeText(I.lngLat.map(D=>vk(D,4)).join(","));break;case"xz":navigator.clipboard.writeText(mr(I.xz).map(D=>vk(D,1)).join(","));break;default:throw new Su(M)}},S=G.useCallback(()=>{n(null),t.off("move",S)},[]);return G.useEffect(()=>{const M=L=>{const{x:V,y:B}=L.point,H=L.lngLat.toArray();let q;p1(Of.ats,H)?q=hB(H):p1(Of.ets2,H)&&(q=dB(H));const X=xh(H,wL(Of.ats)),ee=xh(H,wL(Of.ets2)),se=X<=ee?"ats":"ets2";n({position:{lngLat:H,xz:q},closestGame:se,anchorEl:{getBoundingClientRect:()=>({width:0,height:0,top:B,right:V,bottom:B,left:V})}}),t.once("move",S)};let I;const D=L=>{I=window.setTimeout(()=>{I=void 0,M(L)},1e3)},R=()=>clearTimeout(I);return t.on("contextmenu",M),t.on("touchstart",D),t.on("touchend",R),t.on("touchmove",R),()=>{t.off("contextmenu",M),t.off("touchstart",D),t.off("touchend",R),t.off("touchmove",R)}},[t]),G.useEffect(()=>{if(!l){t.getCanvas().style.cursor="";return}let M=0;const I=()=>M++,D={type:"Feature",geometry:{type:"LineString",coordinates:s},properties:{id:I()}},R={type:"FeatureCollection",features:[...s.map(B=>yk(B,I())),...s.length>1?[D]:[]]},L=B=>{const H=t.queryRenderedFeatures(B.point,{layers:["measure-points"]}),q=p1(l==="ats"?Of.ats:Of.ets2,B.lngLat.toArray());t.getCanvas().style.cursor=q?H.length?"pointer":"crosshair":"not-allowed"},V=B=>{if(!p1(l==="ats"?Of.ats:Of.ets2,B.lngLat.toArray()))return;const q=t.queryRenderedFeatures(B.point,{layers:["measure-points"]});if(R.features.length>1&&R.features.pop(),q.length){const X=q[0].properties.id;R.features=R.features.filter(ee=>ee.properties.id!==X)}else R.features.push(yk(B.lngLat.toArray(),I()));R.features.length>1&&(D.geometry.coordinates=R.features.map(X=>(mN(X.geometry.type==="Point",`unexpected non-Point geometry: ${X.geometry.type}`),X.geometry.coordinates)),R.features.push(D)),mr(t.getSource("measure")).setData(R),p(R.features.filter(X=>X.geometry.type==="Point").map(X=>X.geometry.coordinates))};return t.on("mousemove",L),t.on("click",V),mr(t.getSource("measure")).setData(R),()=>{t.off("mousemove",L),t.off("click",V),mr(t.getSource("measure")).setData({type:"FeatureCollection",features:[]})}},[t,s,l]),ie.jsxs(ie.Fragment,{children:[ie.jsx("div",{style:{display:e!=null?"block":"none",zIndex:10,position:"absolute",top:0,left:0,right:0,bottom:0},onMouseDown:M=>{M.currentTarget===M.target&&S()},children:ie.jsx(MF,{size:"sm",open:e!=null,anchorEl:e?.anchorEl,placement:"bottom-start",onClick:S,onContextMenu:M=>M.preventDefault(),children:e?ie.jsxs(ie.Fragment,{children:[ie.jsxs(Lm,{sx:{justifyContent:"space-between"},onClick:w("lngLat"),children:[ie.jsx($N,{}),ie.jsx(b_,{children:ie.jsx(gk,{coords:{lng:e.position.lngLat[0],lat:e.position.lngLat[1]},fractionDigits:4})}),ie.jsx(KL,{sx:{ml:1}})]}),e.position.xz?ie.jsxs(ie.Fragment,{children:[ie.jsxs(Lm,{sx:{justifyContent:"space-between"},onClick:w("xz"),children:[ie.jsx(VN,{}),ie.jsx(b_,{children:ie.jsx(gk,{coords:{x:e.position.xz[0],z:e.position.xz[1]},fractionDigits:1})}),ie.jsx(KL,{sx:{ml:1}})]}),ie.jsx(WE,{}),l?ie.jsx(Lm,{onClick:_,children:"Clear measurement"}):ie.jsx(Lm,{onClick:()=>{c(mr(e).closestGame),p([mr(e).position.lngLat])},children:"Measure distance"})]}):ie.jsxs(ie.Fragment,{children:[ie.jsx(WE,{}),ie.jsx(gp,{children:ie.jsxs(Ti,{level:"body-xs",sx:{opacity:.75},children:["Right-click within the"," ",e.closestGame.toUpperCase()," game map for more options."]})})]})]}):null})}),ie.jsx(Nle,{measuring:l,close:_,measuringPoints:s}),ie.jsx(Ble,{open:r,close:y})]})},gk=t=>Object.entries(t.coords).map(([e,n],r)=>ie.jsxs(G.Fragment,{children:[r>0?ie.jsx("span",{children:"  "}):null,ie.jsx(tF,{size:"sm",variant:"plain",sx:{opacity:.4},children:e}),O0(n,t.fractionDigits)]},e)),Nle=G.memo(t=>t.measuring===!1?null:ie.jsx(sA,{open:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",sx:{alignItems:"baseline",mb:4},endDecorator:ie.jsx(Ih,{onClick:t.close,children:ie.jsx(EA,{})}),children:ie.jsxs(ca,{gap:1,children:[ie.jsx(Ti,{level:"title-md",children:"Measure distance"}),t.measuringPoints.length<=1?ie.jsx(Ti,{level:"body-sm",children:"Click on the map to trace a path you want to measure."}):ie.jsxs(ca,{gap:2,children:[ie.jsx(Ti,{level:"body-sm",children:"Click on the map to add to your path. Click on an existing point to remove it from the path."}),ie.jsxs(ca,{direction:{xs:"column",md:"row"},gap:2,children:[ie.jsx(Ti,{level:"title-sm",children:"Total distance:"}),ie.jsxs(ca,{direction:"row",gap:.5,children:[ie.jsx(Ti,{level:"body-xs",children:ie.jsx($N,{})}),ie.jsx(Ti,{level:"title-sm",children:_k(t.measuringPoints,"irl",t.measuring)})]}),ie.jsxs(ca,{direction:"row",gap:.5,children:[ie.jsx(Ti,{level:"body-xs",children:ie.jsx(VN,{})}),ie.jsx(Ti,{level:"title-sm",children:_k(t.measuringPoints,"game",t.measuring)})]})]})]})]})})),Ble=G.memo(t=>ie.jsx(sA,{open:t.open,onClose:(e,n)=>t.close(n),autoHideDuration:3e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",endDecorator:ie.jsx(Ih,{onClick:()=>t.close("escapeKeyDown"),children:ie.jsx(EA,{})}),children:"Copied to clipboard."}));function vk(t,e){return Number(t.toFixed(e))}function O0(t,e){return Number(t.toFixed(e)).toLocaleString(void 0,{maximumFractionDigits:e})}function yk(t,e){return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:{id:e}}}function _k(t,e,n){let r;if(e==="irl")r=t;else{const p=n==="ats"?hB:dB;r=t.map(p)}const i=e==="irl"?xh:(p,y)=>Nb(p,y)/1e3;let l=r[0],c=0;for(const p of r.slice(1))c+=i(l,p),l=p;const s=c<1?`${O0(c*1e3,1)} meters`:`${O0(c,2)} km`;if(e==="irl"){const p=c*.6213712,y=p<1?`${O0(p*5280,0)} ft`:`${O0(p,2)} mi`;return`${n==="ats"?y:s} (${n==="ats"?s:y})`}else return s}const fB={[Co.FuelStation]:{iconName:"gas_ico",label:"Fuel station"},[Co.Toll]:{iconName:"toll_ico",label:"Toll gate"},[Co.Parking]:{iconName:"parking_ico",label:"Rest stop"},[Co.RecruitmentAgency]:{iconName:"recruitment_ico",label:"Recruitment agency"},[Co.Service]:{iconName:"service_ico",label:"Service"},[Co.TruckDealer]:{iconName:"dealer_ico",label:"Truck dealer"},[Co.Port]:{iconName:"port_overlay",label:"Port"},[Co.Train]:{iconName:"train_ico",label:"Train"},[Co.Viewpoint]:{iconName:"viewpoint",label:"Viewpoint"},[Co.PhotoSight]:{iconName:"photo_sight_captured",label:"Photo trophy"},[Co.AgricultureCheck]:{iconName:"agri_check",label:"Agricultural inspection"},[Co.BorderCheck]:{iconName:"border_ico",label:"Border inspection"},[Co.Garage]:{iconName:"garage_large_ico",label:"Garage"},[Co.WeighStation]:{iconName:"weigh_station_ico",label:"Weigh station"},[Co.CityNames]:{iconName:"city_names_ico",label:"City names"},[Co.Company]:{iconName:"companies_ico",label:"Companies"},[Co.RoadNumber]:{iconName:"road_numbers_ico",label:"Road numbers"},[Co.Roadwork]:{iconName:"roadwork",label:"Roadwork"},[Co.RailCrossing]:{iconName:"railcrossing",label:"Rail Crossing"}},xk=new Map(Object.entries(fB).map(([t,e])=>[Number(t),e.label])),bk=new Map(Object.entries(Tte).map(([t,e])=>[Number(t),e]));function Zb(t,e,n){return{selectedItems:t,onSelectAllToggle:r=>e(new Set(r?n:[])),onItemToggle:(r,i)=>{e(l=>{const c=new Set(l);return i?c.add(r):c.delete(r),c})}}}const pB=t=>{const e=G.useRef(null),[n,r]=G.useState(!1),[i,l]=G.useState(0);return sl(()=>({onAdd:()=>mr(e.current),onRemove:()=>mr(e.current).remove()}),{position:"bottom-left"}),ie.jsxs("div",{ref:e,className:"maplibregl-ctrl maplibregl-ctrl-group",children:[ie.jsx(Ih,{title:"Map Options",sx:{minWidth:0,minHeight:0,borderRadius:0},onClick:()=>r(!0),children:ie.jsx(Fre,{})}),ie.jsx(wF,{open:n,onClose:()=>r(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",justifyContent:"end"}}},children:ie.jsxs(EF,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,height:"80%",overflow:"auto"},children:[ie.jsx(vF,{children:"Map Options"}),ie.jsx(CF,{}),ie.jsx(L3,{onChange:(c,s)=>l(Number(s)),children:ie.jsxs($Y,{tabFlex:1,sx:{borderRadius:0},children:[ie.jsx(p2,{children:"Icons"}),ie.jsx(p2,{children:"ATS DLC"}),ie.jsx(p2,{children:"Advanced"})]})}),ie.jsx(gF,{sx:{overflowX:"hidden"},children:ie.jsxs(L3,{value:i,children:[ie.jsx(m2,{sx:{p:0},value:0,children:ie.jsx(wk,{items:xk,selectedItems:t.icons.selectedItems,onItemToggle:t.icons.onItemToggle,icon:c=>ie.jsx("img",{style:{marginLeft:-3},width:32,height:32,src:`map-icons/${fB[c].iconName}.png`})})}),ie.jsx(m2,{sx:{p:0},value:1,children:ie.jsx(wk,{items:bk,selectedItems:t.atsDlcs.selectedItems,onItemToggle:t.atsDlcs.onItemToggle})}),ie.jsx(m2,{sx:{p:0},value:2,children:ie.jsx(jle,{showSecrets:t.advanced.showSecrets,onSecretsToggle:t.advanced.onSecretsToggle,showContours:t.advanced.showContours,onContoursToggle:t.advanced.onContoursToggle})})]})}),ie.jsx(J_,{}),i===0&&ie.jsx(Ule,{enableAutoHiding:t.icons.enableAutoHiding,enableSelectAll:t.icons.selectedItems.size===xk.size,onAutoHidingToggle:t.icons.onAutoHidingToggle,onSelectAllToggle:t.icons.onSelectAllToggle}),i===1&&ie.jsx(Vle,{enableSelectAll:t.atsDlcs.selectedItems.size===bk.size,onSelectAllToggle:t.atsDlcs.onSelectAllToggle})]})})]})},Ule=G.memo(t=>ie.jsxs(ca,{direction:"row",justifyContent:"space-between",gap:1,mx:2,children:[ie.jsx(PF,{enterDelay:500,title:"Enable to hide icons based on zoom and nearby icons. Disable to always show icons.",children:ie.jsx($m,{label:"Enable icon hiding",checked:t.enableAutoHiding,onChange:e=>t.onAutoHidingToggle?.(e.target.checked)})}),ie.jsx($m,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:t.enableSelectAll,onChange:e=>t.onSelectAllToggle?.(e.target.checked)})]})),$le=t=>ie.jsx(jw,{size:"lg",sx:{p:0,[`& .${Fm.root}`]:{flexGrow:1,alignItems:"center",flexDirection:"row-reverse"}},children:[...t.items.entries()].map(([e,n])=>ie.jsxs(gp,{children:[t.icon?.(e),ie.jsx($m,{overlay:!0,label:n,checked:t.selectedItems.has(e),onChange:r=>t.onItemToggle(e,r.target.checked)})]},String(e)))}),wk=G.memo($le),Vle=G.memo(t=>ie.jsx(ca,{direction:"row",justifyContent:"end",gap:1,mx:2,children:ie.jsx($m,{sx:{flexDirection:"row-reverse",flexShrink:0},label:"Select all",checked:t.enableSelectAll,onChange:e=>t.onSelectAllToggle?.(e.target.checked)})})),jle=t=>ie.jsxs(ca,{mx:2,gap:2,children:[ie.jsx(GE,{children:ie.jsx($m,{sx:{flexDirection:"row-reverse"},label:"Show secret roads",checked:t.showSecrets,onChange:e=>t.onSecretsToggle(e.target.checked)})}),ie.jsx(J_,{}),ie.jsx(Ti,{mb:2,level:"title-lg",children:"Experimental Features"}),ie.jsx(ca,{gap:2,children:ie.jsxs(GE,{children:[ie.jsx($m,{sx:{flexDirection:"row-reverse"},label:"Show elevation data",checked:t.showContours,onChange:e=>t.onContoursToggle(e.target.checked)}),ie.jsx(Ti,{level:"body-xs",color:"warning",children:"Note: elevation data for points further away from roads is estimated and likely inaccurate."})]})})]}),jA=()=>{const t=G.useRef(null),{mode:e="light",setMode:n}=Lw();return sl(()=>({onAdd:()=>mr(t.current),onRemove:()=>mr(t.current).remove()})),ie.jsx("div",{ref:t,className:"maplibregl-ctrl maplibregl-ctrl-group",children:ie.jsxs(B7,{children:[ie.jsx(VZ,{slots:{root:Ih},sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Set map theme",children:ie.jsx(Are,{})}),ie.jsxs(MF,{placement:"left",children:[ie.jsx(gp,{sticky:!0,children:ie.jsx(Ti,{m:1,level:"body-xs",textTransform:"uppercase",fontWeight:"lg",children:"Map theme"})}),ie.jsxs(Lm,{onClick:()=>n("light"),selected:e==="light",children:[ie.jsx(Nv,{children:ie.jsx(Rre,{})})," ","Light"]}),ie.jsxs(Lm,{onClick:()=>n("dark"),selected:e==="dark",children:[ie.jsx(Nv,{children:ie.jsx(Lre,{})})," ","Dark"]}),ie.jsxs(Lm,{onClick:()=>n("system"),selected:e==="system",children:[ie.jsx(Nv,{children:ie.jsx(Ire,{})})," ","Auto"]})]})]})})};function Hle(t,e,n){let r=n.get(t);return r==null&&(r=e,n.set(t,r)),r}const Sk=t=>{const{map:e,selectDecorator:n,onSelect:r}=t,[i,l]=G.useState([]);G.useEffect(()=>{const p=e==="usa"?"ats":"ets2";Promise.all([fetch(`${p}-achievements.json`).then(y=>y.json()),fetch(`${p}-achievements.geojson`).then(y=>y.json())]).then(([y,_])=>{const w=new Map;for(const M of _.features)Hle(M.properties.name,[],w).push({coordinates:M.geometry.coordinates,dlcGuard:M.properties.dlcGuard});const S=new Set(_.features.map(M=>M.properties.name));l([...y.data.filter(M=>S.has(M.id)).map(M=>({...M,label:M.title,value:M.id,features:mr(w.get(M.id))})).sort((M,I)=>M.label.localeCompare(I.label))])},()=>console.error("could not load achievements json."))},[e]);const c=i.filter(p=>{if(e==="europe")return!0;const y=ix(t.visibleStateDlcs);return p.features.some(_=>y.has(_.dlcGuard))}),s=W4({stringify:p=>[p.label,p.desc].join(" ")});return ie.jsx(Lb,{onChange:(p,y)=>r(y),placeholder:"Search achievements...",options:c,filterOptions:s,blurOnSelect:!0,autoComplete:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,renderOption:(p,y)=>G.createElement(cF,{...p,key:y.value},ie.jsx(Nv,{sx:{border:"2px solid var(--joy-palette-neutral-outlinedBorder)",borderRadius:6,overflow:"hidden",minWidth:"fit-content",mr:.5},children:ie.jsx("img",{loading:"lazy",width:"48",height:"48",src:y.imgUrl,alt:""})}),ie.jsxs(b_,{children:[ie.jsx(Ti,{level:"title-md",children:y.label}),ie.jsx(Ti,{level:"body-xs",children:y.desc})]}))},e)};function Xd(t){return Array.isArray?Array.isArray(t):vB(t)==="[object Array]"}function Gle(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Wle(t){return t==null?"":Gle(t)}function wh(t){return typeof t=="string"}function mB(t){return typeof t=="number"}function qle(t){return t===!0||t===!1||Xle(t)&&vB(t)=="[object Boolean]"}function gB(t){return typeof t=="object"}function Xle(t){return gB(t)&&t!==null}function Fl(t){return t!=null}function k2(t){return!t.trim().length}function vB(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Zle="Incorrect 'index' type",Yle=t=>`Invalid value for key ${t}`,Kle=t=>`Pattern length exceeds max of ${t}.`,Jle=t=>`Missing ${t} property in key`,Qle=t=>`Property 'weight' in key '${t}' must be a positive integer`,Mk=Object.prototype.hasOwnProperty;class ece{constructor(e){this._keys=[],this._keyMap={};let n=0;e.forEach(r=>{let i=yB(r);this._keys.push(i),this._keyMap[i.id]=i,n+=i.weight}),this._keys.forEach(r=>{r.weight/=n})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function yB(t){let e=null,n=null,r=null,i=1,l=null;if(wh(t)||Xd(t))r=t,e=Ck(t),n=fT(t);else{if(!Mk.call(t,"name"))throw new Error(Jle("name"));const c=t.name;if(r=c,Mk.call(t,"weight")&&(i=t.weight,i<=0))throw new Error(Qle(c));e=Ck(c),n=fT(c),l=t.getFn}return{path:e,id:n,weight:i,src:r,getFn:l}}function Ck(t){return Xd(t)?t:t.split(".")}function fT(t){return Xd(t)?t.join("."):t}function tce(t,e){let n=[],r=!1;const i=(l,c,s)=>{if(Fl(l))if(!c[s])n.push(l);else{let p=c[s];const y=l[p];if(!Fl(y))return;if(s===c.length-1&&(wh(y)||mB(y)||qle(y)))n.push(Wle(y));else if(Xd(y)){r=!0;for(let _=0,w=y.length;_<w;_+=1)i(y[_],c,s+1)}else c.length&&i(y,c,s+1)}};return i(t,wh(e)?e.split("."):e,0),r?n:n[0]}const nce={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},rce={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},ice={location:0,threshold:.6,distance:100},oce={useExtendedSearch:!1,getFn:tce,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var Mr={...rce,...nce,...ice,...oce};const sce=/[^ ]+/g;function ace(t=1,e=3){const n=new Map,r=Math.pow(10,e);return{get(i){const l=i.match(sce).length;if(n.has(l))return n.get(l);const c=1/Math.pow(l,.5*t),s=parseFloat(Math.round(c*r)/r);return n.set(l,s),s},clear(){n.clear()}}}class HA{constructor({getFn:e=Mr.getFn,fieldNormWeight:n=Mr.fieldNormWeight}={}){this.norm=ace(n,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((n,r)=>{this._keysMap[n.id]=r})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,wh(this.docs[0])?this.docs.forEach((e,n)=>{this._addString(e,n)}):this.docs.forEach((e,n)=>{this._addObject(e,n)}),this.norm.clear())}add(e){const n=this.size();wh(e)?this._addString(e,n):this._addObject(e,n)}removeAt(e){this.records.splice(e,1);for(let n=e,r=this.size();n<r;n+=1)this.records[n].i-=1}getValueForItemAtKeyId(e,n){return e[this._keysMap[n]]}size(){return this.records.length}_addString(e,n){if(!Fl(e)||k2(e))return;let r={v:e,i:n,n:this.norm.get(e)};this.records.push(r)}_addObject(e,n){let r={i:n,$:{}};this.keys.forEach((i,l)=>{let c=i.getFn?i.getFn(e):this.getFn(e,i.path);if(Fl(c)){if(Xd(c)){let s=[];const p=[{nestedArrIndex:-1,value:c}];for(;p.length;){const{nestedArrIndex:y,value:_}=p.pop();if(Fl(_))if(wh(_)&&!k2(_)){let w={v:_,i:y,n:this.norm.get(_)};s.push(w)}else Xd(_)&&_.forEach((w,S)=>{p.push({nestedArrIndex:S,value:w})})}r.$[l]=s}else if(wh(c)&&!k2(c)){let s={v:c,n:this.norm.get(c)};r.$[l]=s}}}),this.records.push(r)}toJSON(){return{keys:this.keys,records:this.records}}}function _B(t,e,{getFn:n=Mr.getFn,fieldNormWeight:r=Mr.fieldNormWeight}={}){const i=new HA({getFn:n,fieldNormWeight:r});return i.setKeys(t.map(yB)),i.setSources(e),i.create(),i}function lce(t,{getFn:e=Mr.getFn,fieldNormWeight:n=Mr.fieldNormWeight}={}){const{keys:r,records:i}=t,l=new HA({getFn:e,fieldNormWeight:n});return l.setKeys(r),l.setIndexRecords(i),l}function y1(t,{errors:e=0,currentLocation:n=0,expectedLocation:r=0,distance:i=Mr.distance,ignoreLocation:l=Mr.ignoreLocation}={}){const c=e/t.length;if(l)return c;const s=Math.abs(r-n);return i?c+s/i:s?1:c}function cce(t=[],e=Mr.minMatchCharLength){let n=[],r=-1,i=-1,l=0;for(let c=t.length;l<c;l+=1){let s=t[l];s&&r===-1?r=l:!s&&r!==-1&&(i=l-1,i-r+1>=e&&n.push([r,i]),r=-1)}return t[l-1]&&l-r>=e&&n.push([r,l-1]),n}const Am=32;function uce(t,e,n,{location:r=Mr.location,distance:i=Mr.distance,threshold:l=Mr.threshold,findAllMatches:c=Mr.findAllMatches,minMatchCharLength:s=Mr.minMatchCharLength,includeMatches:p=Mr.includeMatches,ignoreLocation:y=Mr.ignoreLocation}={}){if(e.length>Am)throw new Error(Kle(Am));const _=e.length,w=t.length,S=Math.max(0,Math.min(r,w));let M=l,I=S;const D=s>1||p,R=D?Array(w):[];let L;for(;(L=t.indexOf(e,I))>-1;){let ee=y1(e,{currentLocation:L,expectedLocation:S,distance:i,ignoreLocation:y});if(M=Math.min(ee,M),I=L+_,D){let se=0;for(;se<_;)R[L+se]=1,se+=1}}I=-1;let V=[],B=1,H=_+w;const q=1<<_-1;for(let ee=0;ee<_;ee+=1){let se=0,J=H;for(;se<J;)y1(e,{errors:ee,currentLocation:S+J,expectedLocation:S,distance:i,ignoreLocation:y})<=M?se=J:H=J,J=Math.floor((H-se)/2+se);H=J;let $=Math.max(1,S-J+1),le=c?w:Math.min(S+J,w)+_,Ce=Array(le+2);Ce[le+1]=(1<<ee)-1;for(let We=le;We>=$;We-=1){let Fe=We-1,Me=n[t.charAt(Fe)];if(D&&(R[Fe]=+!!Me),Ce[We]=(Ce[We+1]<<1|1)&Me,ee&&(Ce[We]|=(V[We+1]|V[We])<<1|1|V[We+1]),Ce[We]&q&&(B=y1(e,{errors:ee,currentLocation:Fe,expectedLocation:S,distance:i,ignoreLocation:y}),B<=M)){if(M=B,I=Fe,I<=S)break;$=Math.max(1,2*S-I)}}if(y1(e,{errors:ee+1,currentLocation:S,expectedLocation:S,distance:i,ignoreLocation:y})>M)break;V=Ce}const X={isMatch:I>=0,score:Math.max(.001,B)};if(D){const ee=cce(R,s);ee.length?p&&(X.indices=ee):X.isMatch=!1}return X}function hce(t){let e={};for(let n=0,r=t.length;n<r;n+=1){const i=t.charAt(n);e[i]=(e[i]||0)|1<<r-n-1}return e}const Yb=String.prototype.normalize?t=>t.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):t=>t;class xB{constructor(e,{location:n=Mr.location,threshold:r=Mr.threshold,distance:i=Mr.distance,includeMatches:l=Mr.includeMatches,findAllMatches:c=Mr.findAllMatches,minMatchCharLength:s=Mr.minMatchCharLength,isCaseSensitive:p=Mr.isCaseSensitive,ignoreDiacritics:y=Mr.ignoreDiacritics,ignoreLocation:_=Mr.ignoreLocation}={}){if(this.options={location:n,threshold:r,distance:i,includeMatches:l,findAllMatches:c,minMatchCharLength:s,isCaseSensitive:p,ignoreDiacritics:y,ignoreLocation:_},e=p?e:e.toLowerCase(),e=y?Yb(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const w=(M,I)=>{this.chunks.push({pattern:M,alphabet:hce(M),startIndex:I})},S=this.pattern.length;if(S>Am){let M=0;const I=S%Am,D=S-I;for(;M<D;)w(this.pattern.substr(M,Am),M),M+=Am;if(I){const R=S-Am;w(this.pattern.substr(R),R)}}else w(this.pattern,0)}searchIn(e){const{isCaseSensitive:n,ignoreDiacritics:r,includeMatches:i}=this.options;if(e=n?e:e.toLowerCase(),e=r?Yb(e):e,this.pattern===e){let D={isMatch:!0,score:0};return i&&(D.indices=[[0,e.length-1]]),D}const{location:l,distance:c,threshold:s,findAllMatches:p,minMatchCharLength:y,ignoreLocation:_}=this.options;let w=[],S=0,M=!1;this.chunks.forEach(({pattern:D,alphabet:R,startIndex:L})=>{const{isMatch:V,score:B,indices:H}=uce(e,D,R,{location:l+L,distance:c,threshold:s,findAllMatches:p,minMatchCharLength:y,includeMatches:i,ignoreLocation:_});V&&(M=!0),S+=B,V&&H&&(w=[...w,...H])});let I={isMatch:M,score:M?S/this.chunks.length:1};return M&&i&&(I.indices=w),I}}class xp{constructor(e){this.pattern=e}static isMultiMatch(e){return Ek(e,this.multiRegex)}static isSingleMatch(e){return Ek(e,this.singleRegex)}search(){}}function Ek(t,e){const n=t.match(e);return n?n[1]:null}class dce extends xp{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const n=e===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class fce extends xp{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const r=e.indexOf(this.pattern)===-1;return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class pce extends xp{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const n=e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}class mce extends xp{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const n=!e.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class gce extends xp{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const n=e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class vce extends xp{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const n=!e.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class bB extends xp{constructor(e,{location:n=Mr.location,threshold:r=Mr.threshold,distance:i=Mr.distance,includeMatches:l=Mr.includeMatches,findAllMatches:c=Mr.findAllMatches,minMatchCharLength:s=Mr.minMatchCharLength,isCaseSensitive:p=Mr.isCaseSensitive,ignoreDiacritics:y=Mr.ignoreDiacritics,ignoreLocation:_=Mr.ignoreLocation}={}){super(e),this._bitapSearch=new xB(e,{location:n,threshold:r,distance:i,includeMatches:l,findAllMatches:c,minMatchCharLength:s,isCaseSensitive:p,ignoreDiacritics:y,ignoreLocation:_})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class wB extends xp{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let n=0,r;const i=[],l=this.pattern.length;for(;(r=e.indexOf(this.pattern,n))>-1;)n=r+l,i.push([r,n-1]);const c=!!i.length;return{isMatch:c,score:c?0:1,indices:i}}}const pT=[dce,wB,pce,mce,vce,gce,fce,bB],Tk=pT.length,yce=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,_ce="|";function xce(t,e={}){return t.split(_ce).map(n=>{let r=n.trim().split(yce).filter(l=>l&&!!l.trim()),i=[];for(let l=0,c=r.length;l<c;l+=1){const s=r[l];let p=!1,y=-1;for(;!p&&++y<Tk;){const _=pT[y];let w=_.isMultiMatch(s);w&&(i.push(new _(w,e)),p=!0)}if(!p)for(y=-1;++y<Tk;){const _=pT[y];let w=_.isSingleMatch(s);if(w){i.push(new _(w,e));break}}}return i})}const bce=new Set([bB.type,wB.type]);class wce{constructor(e,{isCaseSensitive:n=Mr.isCaseSensitive,ignoreDiacritics:r=Mr.ignoreDiacritics,includeMatches:i=Mr.includeMatches,minMatchCharLength:l=Mr.minMatchCharLength,ignoreLocation:c=Mr.ignoreLocation,findAllMatches:s=Mr.findAllMatches,location:p=Mr.location,threshold:y=Mr.threshold,distance:_=Mr.distance}={}){this.query=null,this.options={isCaseSensitive:n,ignoreDiacritics:r,includeMatches:i,minMatchCharLength:l,findAllMatches:s,ignoreLocation:c,location:p,threshold:y,distance:_},e=n?e:e.toLowerCase(),e=r?Yb(e):e,this.pattern=e,this.query=xce(this.pattern,this.options)}static condition(e,n){return n.useExtendedSearch}searchIn(e){const n=this.query;if(!n)return{isMatch:!1,score:1};const{includeMatches:r,isCaseSensitive:i,ignoreDiacritics:l}=this.options;e=i?e:e.toLowerCase(),e=l?Yb(e):e;let c=0,s=[],p=0;for(let y=0,_=n.length;y<_;y+=1){const w=n[y];s.length=0,c=0;for(let S=0,M=w.length;S<M;S+=1){const I=w[S],{isMatch:D,indices:R,score:L}=I.search(e);if(D){if(c+=1,p+=L,r){const V=I.constructor.type;bce.has(V)?s=[...s,...R]:s.push(R)}}else{p=0,c=0,s.length=0;break}}if(c){let S={isMatch:!0,score:p/c};return r&&(S.indices=s),S}}return{isMatch:!1,score:1}}}const mT=[];function Sce(...t){mT.push(...t)}function gT(t,e){for(let n=0,r=mT.length;n<r;n+=1){let i=mT[n];if(i.condition(t,e))return new i(t,e)}return new xB(t,e)}const Kb={AND:"$and",OR:"$or"},vT={PATH:"$path",PATTERN:"$val"},yT=t=>!!(t[Kb.AND]||t[Kb.OR]),Mce=t=>!!t[vT.PATH],Cce=t=>!Xd(t)&&gB(t)&&!yT(t),Pk=t=>({[Kb.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function SB(t,e,{auto:n=!0}={}){const r=i=>{let l=Object.keys(i);const c=Mce(i);if(!c&&l.length>1&&!yT(i))return r(Pk(i));if(Cce(i)){const p=c?i[vT.PATH]:l[0],y=c?i[vT.PATTERN]:i[p];if(!wh(y))throw new Error(Yle(p));const _={keyId:fT(p),pattern:y};return n&&(_.searcher=gT(y,e)),_}let s={children:[],operator:l[0]};return l.forEach(p=>{const y=i[p];Xd(y)&&y.forEach(_=>{s.children.push(r(_))})}),s};return yT(t)||(t=Pk(t)),r(t)}function Ece(t,{ignoreFieldNorm:e=Mr.ignoreFieldNorm}){t.forEach(n=>{let r=1;n.matches.forEach(({key:i,norm:l,score:c})=>{const s=i?i.weight:null;r*=Math.pow(c===0&&s?Number.EPSILON:c,(s||1)*(e?1:l))}),n.score=r})}function Tce(t,e){const n=t.matches;e.matches=[],Fl(n)&&n.forEach(r=>{if(!Fl(r.indices)||!r.indices.length)return;const{indices:i,value:l}=r;let c={indices:i,value:l};r.key&&(c.key=r.key.src),r.idx>-1&&(c.refIndex=r.idx),e.matches.push(c)})}function Pce(t,e){e.score=t.score}function Ace(t,e,{includeMatches:n=Mr.includeMatches,includeScore:r=Mr.includeScore}={}){const i=[];return n&&i.push(Tce),r&&i.push(Pce),t.map(l=>{const{idx:c}=l,s={item:e[c],refIndex:c};return i.length&&i.forEach(p=>{p(l,s)}),s})}class my{constructor(e,n={},r){this.options={...Mr,...n},this.options.useExtendedSearch,this._keyStore=new ece(this.options.keys),this.setCollection(e,r)}setCollection(e,n){if(this._docs=e,n&&!(n instanceof HA))throw new Error(Zle);this._myIndex=n||_B(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Fl(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const n=[];for(let r=0,i=this._docs.length;r<i;r+=1){const l=this._docs[r];e(l,r)&&(this.removeAt(r),r-=1,i-=1,n.push(l))}return n}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:n=-1}={}){const{includeMatches:r,includeScore:i,shouldSort:l,sortFn:c,ignoreFieldNorm:s}=this.options;let p=wh(e)?wh(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Ece(p,{ignoreFieldNorm:s}),l&&p.sort(c),mB(n)&&n>-1&&(p=p.slice(0,n)),Ace(p,this._docs,{includeMatches:r,includeScore:i})}_searchStringList(e){const n=gT(e,this.options),{records:r}=this._myIndex,i=[];return r.forEach(({v:l,i:c,n:s})=>{if(!Fl(l))return;const{isMatch:p,score:y,indices:_}=n.searchIn(l);p&&i.push({item:l,idx:c,matches:[{score:y,value:l,norm:s,indices:_}]})}),i}_searchLogical(e){const n=SB(e,this.options),r=(s,p,y)=>{if(!s.children){const{keyId:w,searcher:S}=s,M=this._findMatches({key:this._keyStore.get(w),value:this._myIndex.getValueForItemAtKeyId(p,w),searcher:S});return M&&M.length?[{idx:y,item:p,matches:M}]:[]}const _=[];for(let w=0,S=s.children.length;w<S;w+=1){const M=s.children[w],I=r(M,p,y);if(I.length)_.push(...I);else if(s.operator===Kb.AND)return[]}return _},i=this._myIndex.records,l={},c=[];return i.forEach(({$:s,i:p})=>{if(Fl(s)){let y=r(n,s,p);y.length&&(l[p]||(l[p]={idx:p,item:s,matches:[]},c.push(l[p])),y.forEach(({matches:_})=>{l[p].matches.push(..._)}))}}),c}_searchObjectList(e){const n=gT(e,this.options),{keys:r,records:i}=this._myIndex,l=[];return i.forEach(({$:c,i:s})=>{if(!Fl(c))return;let p=[];r.forEach((y,_)=>{p.push(...this._findMatches({key:y,value:c[_],searcher:n}))}),p.length&&l.push({idx:s,item:c,matches:p})}),l}_findMatches({key:e,value:n,searcher:r}){if(!Fl(n))return[];let i=[];if(Xd(n))n.forEach(({v:l,i:c,n:s})=>{if(!Fl(l))return;const{isMatch:p,score:y,indices:_}=r.searchIn(l);p&&i.push({score:y,key:e,value:l,idx:c,norm:s,indices:_})});else{const{v:l,n:c}=n,{isMatch:s,score:p,indices:y}=r.searchIn(l);s&&i.push({score:p,key:e,value:l,norm:c,indices:y})}return i}}my.version="7.1.0";my.createIndex=_B;my.parseIndex=lce;my.config=Mr;my.parseQuery=SB;Sce(wce);const Ak=100,Ice=t=>t.match(/("[^"]*?"|[^"\s]+)+(?=\s*|\s*$)/g)??[],Ik=t=>{const{map:e,selectDecorator:n,onSelect:r}=t,[i,l]=G.useState({}),[c,s]=G.useState(null),[p,y]=G.useState([]),[_,w]=G.useState(null),[S,M]=G.useState(0),I=R=>setTimeout(()=>M(R),0);G.useEffect(()=>{fetch("sprites@2x.json").then(R=>R.json()).then(R=>l(R),R=>console.error("could not load sprites json",R))},[]),G.useEffect(()=>{fetch(`${e==="usa"?"ats":"ets2"}-search.geojson`).then(L=>L.json()).then(L=>{let V;if(e==="usa"){const q=ix(t.visibleStateDlcs);V=X=>q.has(X.properties.dlcGuard)}else V=()=>!0;const B=L.features.filter(V),H=new my(B,{distance:0,threshold:.2,findAllMatches:!0,ignoreLocation:!0,sortFn:zce,keys:[{name:"properties.label",weight:3},{name:"properties.city.name",weight:2},{name:"properties.stateName",weight:1.5},"properties.stateCode","properties.tags"]});s(H),y(B.map((q,X)=>({type:"poi",id:X.toString(),label:q.properties.label,poi:q})))},L=>console.error("could not load search json.",L))},[e,e==="usa"?t.visibleStateDlcs:null]);const D=(R,{inputValue:L})=>{if(jm.checkState(c!=null),L.length<3)if(_!=null)typeof _=="string"?L=_:L=_.label;else return I(0),[];const V=Ice(L);if(!V.length)return console.warn("empty tokens for search input:",L),I(0),[];const B=c.search({$and:V.map(H=>({$or:[{"properties.label":H},{"properties.city.name":H},{"properties.stateName":H},{"properties.stateCode":H},{"properties.tags":H}]}))});return I(B.length),B.slice(0,Ak).map(H=>R[H.refIndex])};return ie.jsx(Lb,{onChange:(R,L)=>{if(L==null)w(null),r(null);else if(typeof L=="string")w(L);else if(L&&L.type==="poi")M(1),w(L),r(L);else if(L)throw new Error("suggestions not yet supported")},onInputChange:(R,L,V)=>{V!=="reset"&&w(null)},placeholder:"Search cities, companies, points of interest...",options:p,filterOptions:D,getOptionLabel:kce,blurOnSelect:!0,handleHomeEndKeys:!0,freeSolo:!0,sx:{paddingInlineStart:0,flexBasis:"28em"},startDecorator:n,endDecorator:ie.jsx(Rce,{maxResults:Ak,numSearchResults:S}),renderOption:(R,L)=>G.createElement(cF,{...R,key:L.id},ie.jsx(Lce,{option:L,sprites:i}))},e)},Rce=({numSearchResults:t,maxResults:e})=>t>e?ie.jsx(PF,{title:`Showing first ${e} of ${t} results, only. Try adding more terms to narrow your search.`,children:ie.jsx(Dre,{color:"warning",sx:{width:"0.8em"}})}):null,Lce=G.memo(({option:t,sprites:e})=>ie.jsxs(ie.Fragment,{children:[ie.jsx(Nv,{sx:{display:"flex",justifyContent:"center",mx:0},children:ie.jsx(Rk,{option:t,sprites:e})}),ie.jsx(Dce,{option:t}),ie.jsx(Nv,{children:t.type==="poi"&&t.poi.properties.type==="company"?ie.jsx(Rk,{option:t,sprites:e,position:"end"}):null})]})),Rk=({option:t,sprites:e,position:n})=>{if(t.type==="suggestion")return null;if(t.poi.properties.type==="city")return ie.jsx(Nre,{});if(t.poi.properties.type==="scenery")return ie.jsx(zre,{});let r;switch(t.poi.properties.type){case"company":if(!n)return ie.jsx(Bre,{});r=t.poi.properties.sprite;break;case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":r=t.poi.properties.sprite;break;default:throw new Su(t.poi.properties.type)}const i=mr(e[r]);return ie.jsx(qw,{sx:{width:i.width+"px",height:i.height+"px",background:`url(sprites.png) -${i.x}px -${i.y}px`,transform:"scale(0.70)"}})};function kce(t){if(typeof t=="string")return t;if(t.type==="suggestion")return"suggestion";const e=t.poi.properties;switch(e.type){case"city":case"scenery":return`${t.label}, ${e.stateCode}`;case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":{const n=MB(e.label,e.city);switch(n){case 0:return`${t.label} in ${e.city.name}, ${e.stateCode}`;case 1:return`${t.label} near ${e.city.name}, ${e.stateCode}`;case 2:return`${t.label} in ${e.stateName}`;default:throw new Su(n)}}default:throw new Su(e)}}const Dce=({option:t})=>{if(t.type==="suggestion")return"suggestion";const e=t.poi.properties;switch(e.type){case"city":case"scenery":return ie.jsxs(b_,{children:[t.label,", ",e.stateCode]});case"company":case"landmark":case"viewpoint":case"dealer":case"ferry":case"train":{let n;const r=MB(e.label,e.city);switch(r){case 0:n=`${e.city.name}, ${e.stateCode}`;break;case 1:n=`near ${e.city.name}, ${e.stateCode}`;break;case 2:n=`${e.stateName}`;break;default:throw new Su(r)}return ie.jsxs(b_,{children:[ie.jsx(Ti,{children:t.label}),ie.jsx(Ti,{level:"body-sm",children:n})]})}default:throw new Su(e)}};function MB(t,e){return e.distance<=250||t.startsWith(e.name)||t.endsWith(e.name)?0:e.distance<=1e3?1:2}const Lk={company:0,city:1,scenery:1,landmark:2,viewpoint:3,dealer:4,ferry:5,train:6};function zce(t,e){if(t.score!==e.score)return t.score-e.score;const n=t.item[1],r=e.item[1];if(n&&r)return n.v.localeCompare(r.v);if(n&&!r)return 1;if(!n&&r)return-1;const i=t.item[4],l=e.item[4];if(!Array.isArray(i)||!Array.isArray(l))throw new Error("unexpected non-arrays at key 5");const c=mr(i.find(_=>_.i===0)).v,s=mr(l.find(_=>_.i===0)).v;if(c!==s)return Lk[c]-Lk[s];const p=t.item[0],y=e.item[0];return p.v.localeCompare(y.v)}var D2,kk;function CB(){if(kk)return D2;kk=1;var t=Object.prototype.toString;return D2=function(n){var r=t.call(n),i=r==="[object Arguments]";return i||(i=r!=="[object Array]"&&n!==null&&typeof n=="object"&&typeof n.length=="number"&&n.length>=0&&t.call(n.callee)==="[object Function]"),i},D2}var z2,Dk;function Oce(){if(Dk)return z2;Dk=1;var t;if(!Object.keys){var e=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=CB(),i=Object.prototype.propertyIsEnumerable,l=!i.call({toString:null},"toString"),c=i.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],p=function(S){var M=S.constructor;return M&&M.prototype===S},y={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},_=function(){if(typeof window>"u")return!1;for(var S in window)try{if(!y["$"+S]&&e.call(window,S)&&window[S]!==null&&typeof window[S]=="object")try{p(window[S])}catch{return!0}}catch{return!0}return!1}(),w=function(S){if(typeof window>"u"||!_)return p(S);try{return p(S)}catch{return!1}};t=function(M){var I=M!==null&&typeof M=="object",D=n.call(M)==="[object Function]",R=r(M),L=I&&n.call(M)==="[object String]",V=[];if(!I&&!D&&!R)throw new TypeError("Object.keys called on a non-object");var B=c&&D;if(L&&M.length>0&&!e.call(M,0))for(var H=0;H<M.length;++H)V.push(String(H));if(R&&M.length>0)for(var q=0;q<M.length;++q)V.push(String(q));else for(var X in M)!(B&&X==="prototype")&&e.call(M,X)&&V.push(String(X));if(l)for(var ee=w(M),se=0;se<s.length;++se)!(ee&&s[se]==="constructor")&&e.call(M,s[se])&&V.push(s[se]);return V}}return z2=t,z2}var O2,zk;function Fce(){if(zk)return O2;zk=1;var t=Array.prototype.slice,e=CB(),n=Object.keys,r=n?function(c){return n(c)}:Oce(),i=Object.keys;return r.shim=function(){if(Object.keys){var c=function(){var s=Object.keys(arguments);return s&&s.length===arguments.length}(1,2);c||(Object.keys=function(p){return e(p)?i(t.call(p)):i(p)})}else Object.keys=r;return Object.keys||r},O2=r,O2}var F2,Ok;function fx(){if(Ok)return F2;Ok=1;var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch{t=!1}return F2=t,F2}var N2,Fk;function bp(){return Fk||(Fk=1,N2=SyntaxError),N2}var B2,Nk;function Lr(){return Nk||(Nk=1,B2=TypeError),B2}var U2,Bk;function Nce(){return Bk||(Bk=1,U2=Object.getOwnPropertyDescriptor),U2}var $2,Uk;function gy(){if(Uk)return $2;Uk=1;var t=Nce();if(t)try{t([],"length")}catch{t=null}return $2=t,$2}var V2,$k;function EB(){if($k)return V2;$k=1;var t=fx(),e=bp(),n=Lr(),r=gy();return V2=function(l,c,s){if(!l||typeof l!="object"&&typeof l!="function")throw new n("`obj` must be an object or a function`");if(typeof c!="string"&&typeof c!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var p=arguments.length>3?arguments[3]:null,y=arguments.length>4?arguments[4]:null,_=arguments.length>5?arguments[5]:null,w=arguments.length>6?arguments[6]:!1,S=!!r&&r(l,c);if(t)t(l,c,{configurable:_===null&&S?S.configurable:!_,enumerable:p===null&&S?S.enumerable:!p,value:s,writable:y===null&&S?S.writable:!y});else if(w||!p&&!y&&!_)l[c]=s;else throw new e("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},V2}var j2,Vk;function GA(){if(Vk)return j2;Vk=1;var t=fx(),e=function(){return!!t};return e.hasArrayLengthDefineBug=function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},j2=e,j2}var H2,jk;function TB(){if(jk)return H2;jk=1;var t=Fce(),e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,r=Array.prototype.concat,i=EB(),l=function(y){return typeof y=="function"&&n.call(y)==="[object Function]"},c=GA()(),s=function(y,_,w,S){if(_ in y){if(S===!0){if(y[_]===w)return}else if(!l(S)||!S())return}c?i(y,_,w,!0):i(y,_,w)},p=function(y,_){var w=arguments.length>2?arguments[2]:{},S=t(_);e&&(S=r.call(S,Object.getOwnPropertySymbols(_)));for(var M=0;M<S.length;M+=1)s(y,S[M],_[S[M]],w[S[M]])};return p.supportsDescriptors=!!c,H2=p,H2}var G2={exports:{}},W2,Hk;function Bce(){return Hk||(Hk=1,W2=Object),W2}var q2,Gk;function Uce(){return Gk||(Gk=1,q2=Error),q2}var X2,Wk;function $ce(){return Wk||(Wk=1,X2=EvalError),X2}var Z2,qk;function Vce(){return qk||(qk=1,Z2=RangeError),Z2}var Y2,Xk;function jce(){return Xk||(Xk=1,Y2=ReferenceError),Y2}var K2,Zk;function Hce(){return Zk||(Zk=1,K2=URIError),K2}var J2,Yk;function PB(){return Yk||(Yk=1,J2=Math.abs),J2}var Q2,Kk;function AB(){return Kk||(Kk=1,Q2=Math.floor),Q2}var eM,Jk;function Gce(){return Jk||(Jk=1,eM=Math.max),eM}var tM,Qk;function Wce(){return Qk||(Qk=1,tM=Math.min),tM}var nM,eD;function qce(){return eD||(eD=1,nM=Math.pow),nM}var rM,tD;function IB(){return tD||(tD=1,rM=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[n]=i;for(var l in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var c=Object.getOwnPropertySymbols(e);if(c.length!==1||c[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,n);if(s.value!==i||s.enumerable!==!0)return!1}return!0}),rM}var iM,nD;function hS(){if(nD)return iM;nD=1;var t=typeof Symbol<"u"&&Symbol,e=IB();return iM=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},iM}var oM,rD;function Xce(){if(rD)return oM;rD=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,n=Math.max,r="[object Function]",i=function(p,y){for(var _=[],w=0;w<p.length;w+=1)_[w]=p[w];for(var S=0;S<y.length;S+=1)_[S+p.length]=y[S];return _},l=function(p,y){for(var _=[],w=y,S=0;w<p.length;w+=1,S+=1)_[S]=p[w];return _},c=function(s,p){for(var y="",_=0;_<s.length;_+=1)y+=s[_],_+1<s.length&&(y+=p);return y};return oM=function(p){var y=this;if(typeof y!="function"||e.apply(y)!==r)throw new TypeError(t+y);for(var _=l(arguments,1),w,S=function(){if(this instanceof w){var L=y.apply(this,i(_,arguments));return Object(L)===L?L:this}return y.apply(p,i(_,arguments))},M=n(0,y.length-_.length),I=[],D=0;D<M;D++)I[D]="$"+D;if(w=Function("binder","return function ("+c(I,",")+"){ return binder.apply(this,arguments); }")(S),y.prototype){var R=function(){};R.prototype=y.prototype,w.prototype=new R,R.prototype=null}return w},oM}var sM,iD;function px(){if(iD)return sM;iD=1;var t=Xce();return sM=Function.prototype.bind||t,sM}var aM,oD;function WA(){return oD||(oD=1,aM=Function.prototype.call),aM}var lM,sD;function qA(){return sD||(sD=1,lM=Function.prototype.apply),lM}var cM,aD;function Zce(){return aD||(aD=1,cM=typeof Reflect<"u"&&Reflect&&Reflect.apply),cM}var uM,lD;function RB(){if(lD)return uM;lD=1;var t=px(),e=qA(),n=WA(),r=Zce();return uM=r||t.call(n,e),uM}var hM,cD;function XA(){if(cD)return hM;cD=1;var t=px(),e=Lr(),n=WA(),r=RB();return hM=function(l){if(l.length<1||typeof l[0]!="function")throw new e("a function is required");return r(t,n,l)},hM}var dM,uD;function Yce(){if(uD)return dM;uD=1;var t=XA(),e=gy(),n;try{n=[].__proto__===Array.prototype}catch(c){if(!c||typeof c!="object"||!("code"in c)||c.code!=="ERR_PROTO_ACCESS")throw c}var r=!!n&&e&&e(Object.prototype,"__proto__"),i=Object,l=i.getPrototypeOf;return dM=r&&typeof r.get=="function"?t([r.get]):typeof l=="function"?function(s){return l(s==null?s:i(s))}:!1,dM}var fM,hD;function tf(){if(hD)return fM;hD=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,n=px();return fM=n.call(t,e),fM}var pM,dD;function ua(){if(dD)return pM;dD=1;var t,e=Bce(),n=Uce(),r=$ce(),i=Vce(),l=jce(),c=bp(),s=Lr(),p=Hce(),y=PB(),_=AB(),w=Gce(),S=Wce(),M=qce(),I=Function,D=function(Ct){try{return I('"use strict"; return ('+Ct+").constructor;")()}catch{}},R=gy(),L=fx(),V=function(){throw new s},B=R?function(){try{return arguments.callee,V}catch{try{return R(arguments,"callee").get}catch{return V}}}():V,H=hS()(),q=Yce(),X=typeof Reflect=="function"&&Reflect.getPrototypeOf||e.getPrototypeOf||q,ee=qA(),se=WA(),J={},$=typeof Uint8Array>"u"||!X?t:X(Uint8Array),le={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":H&&X?X([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":J,"%AsyncGenerator%":J,"%AsyncGeneratorFunction%":J,"%AsyncIteratorPrototype%":J,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":r,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":I,"%GeneratorFunction%":J,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":H&&X?X(X([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!H||!X?t:X(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":R,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":i,"%ReferenceError%":l,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!H||!X?t:X(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":H&&X?X(""[Symbol.iterator]()):t,"%Symbol%":H?Symbol:t,"%SyntaxError%":c,"%ThrowTypeError%":B,"%TypedArray%":$,"%TypeError%":s,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":p,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet,"%Function.prototype.call%":se,"%Function.prototype.apply%":ee,"%Object.defineProperty%":L,"%Math.abs%":y,"%Math.floor%":_,"%Math.max%":w,"%Math.min%":S,"%Math.pow%":M};if(X)try{null.error}catch(Ct){var Ce=X(X(Ct));le["%Error.prototype%"]=Ce}var we=function Ct(ut){var lt;if(ut==="%AsyncFunction%")lt=D("async function () {}");else if(ut==="%GeneratorFunction%")lt=D("function* () {}");else if(ut==="%AsyncGeneratorFunction%")lt=D("async function* () {}");else if(ut==="%AsyncGenerator%"){var _t=Ct("%AsyncGeneratorFunction%");_t&&(lt=_t.prototype)}else if(ut==="%AsyncIteratorPrototype%"){var wt=Ct("%AsyncGenerator%");wt&&X&&(lt=X(wt.prototype))}return le[ut]=lt,lt},We={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Fe=px(),Me=tf(),Ee=Fe.call(se,Array.prototype.concat),Te=Fe.call(ee,Array.prototype.splice),Ze=Fe.call(se,String.prototype.replace),rt=Fe.call(se,String.prototype.slice),Re=Fe.call(se,RegExp.prototype.exec),Qe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Vt=/\\(\\)?/g,je=function(ut){var lt=rt(ut,0,1),_t=rt(ut,-1);if(lt==="%"&&_t!=="%")throw new c("invalid intrinsic syntax, expected closing `%`");if(_t==="%"&&lt!=="%")throw new c("invalid intrinsic syntax, expected opening `%`");var wt=[];return Ze(ut,Qe,function(cn,dn,tn,Je){wt[wt.length]=tn?Ze(Je,Vt,"$1"):dn||cn}),wt},ct=function(ut,lt){var _t=ut,wt;if(Me(We,_t)&&(wt=We[_t],_t="%"+wt[0]+"%"),Me(le,_t)){var cn=le[_t];if(cn===J&&(cn=we(_t)),typeof cn>"u"&&!lt)throw new s("intrinsic "+ut+" exists, but is not available. Please file an issue!");return{alias:wt,name:_t,value:cn}}throw new c("intrinsic "+ut+" does not exist!")};return pM=function(ut,lt){if(typeof ut!="string"||ut.length===0)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof lt!="boolean")throw new s('"allowMissing" argument must be a boolean');if(Re(/^%?[^%]*%?$/,ut)===null)throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var _t=je(ut),wt=_t.length>0?_t[0]:"",cn=ct("%"+wt+"%",lt),dn=cn.name,tn=cn.value,Je=!1,Tn=cn.alias;Tn&&(wt=Tn[0],Te(_t,Ee([0,1],Tn)));for(var Kt=1,fn=!0;Kt<_t.length;Kt+=1){var Ut=_t[Kt],On=rt(Ut,0,1),vn=rt(Ut,-1);if((On==='"'||On==="'"||On==="`"||vn==='"'||vn==="'"||vn==="`")&&On!==vn)throw new c("property names with quotes must have matching quotes");if((Ut==="constructor"||!fn)&&(Je=!0),wt+="."+Ut,dn="%"+wt+"%",Me(le,dn))tn=le[dn];else if(tn!=null){if(!(Ut in tn)){if(!lt)throw new s("base intrinsic for "+ut+" exists, but the property is not available.");return}if(R&&Kt+1>=_t.length){var Ue=R(tn,Ut);fn=!!Ue,fn&&"get"in Ue&&!("originalValue"in Ue.get)?tn=Ue.get:tn=tn[Ut]}else fn=Me(tn,Ut),tn=tn[Ut];fn&&!Je&&(le[dn]=tn)}}return tn},pM}var mM,fD;function Kce(){if(fD)return mM;fD=1;var t=ua(),e=EB(),n=GA()(),r=gy(),i=Lr(),l=t("%Math.floor%");return mM=function(s,p){if(typeof s!="function")throw new i("`fn` is not a function");if(typeof p!="number"||p<0||p>4294967295||l(p)!==p)throw new i("`length` must be a positive 32-bit integer");var y=arguments.length>2&&!!arguments[2],_=!0,w=!0;if("length"in s&&r){var S=r(s,"length");S&&!S.configurable&&(_=!1),S&&!S.writable&&(w=!1)}return(_||w||!y)&&(n?e(s,"length",p,!0,!0):e(s,"length",p)),s},mM}var gM,pD;function Jce(){if(pD)return gM;pD=1;var t=px(),e=qA(),n=RB();return gM=function(){return n(t,e,arguments)},gM}var mD;function LB(){return mD||(mD=1,function(t){var e=Kce(),n=fx(),r=XA(),i=Jce();t.exports=function(c){var s=r(arguments),p=c.length-(arguments.length-1);return e(s,1+(p>0?p:0),!0)},n?n(t.exports,"apply",{value:i}):t.exports.apply=i}(G2)),G2.exports}var vM,gD;function tg(){return gD||(gD=1,vM=function(e){return typeof e=="string"||typeof e=="symbol"}),vM}var yM,vD;function ng(){if(vD)return yM;vD=1;var t=Lr(),e=tf(),n={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return yM=function(i){if(!i||typeof i!="object")return!1;for(var l in i)if(e(i,l)&&!n[l])return!1;var c=e(i,"[[Value]]")||e(i,"[[Writable]]"),s=e(i,"[[Get]]")||e(i,"[[Set]]");if(c&&s)throw new t("Property Descriptors may not be both accessor and data descriptors");return!0},yM}var _M,yD;function ZA(){if(yD)return _M;yD=1;var t=Lr(),e=tf(),n=ng();return _M=function(i){if(typeof i>"u")return!1;if(!n(i))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!(!e(i,"[[Get]]")&&!e(i,"[[Set]]"))},_M}var xM,_D;function Qce(){return _D||(_D=1,xM=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),xM}var bM,xD;function eue(){if(xD)return bM;xD=1;var t=ua(),e=t("%Object.preventExtensions%",!0),n=t("%Object.isExtensible%",!0),r=Qce();return bM=e?function(l){return!r(l)&&n(l)}:function(l){return!r(l)},bM}var wM,bD;function kB(){if(bD)return wM;bD=1;var t=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,n,r;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{n=Object.defineProperty({},"length",{get:function(){throw r}}),r={},e(function(){throw 42},null,n)}catch(V){V!==r&&(e=null)}else e=null;var i=/^\s*class\b/,l=function(B){try{var H=t.call(B);return i.test(H)}catch{return!1}},c=function(B){try{return l(B)?!1:(t.call(B),!0)}catch{return!1}},s=Object.prototype.toString,p="[object Object]",y="[object Function]",_="[object GeneratorFunction]",w="[object HTMLAllCollection]",S="[object HTML document.all class]",M="[object HTMLCollection]",I=typeof Symbol=="function"&&!!Symbol.toStringTag,D=!(0 in[,]),R=function(){return!1};if(typeof document=="object"){var L=document.all;s.call(L)===s.call(document.all)&&(R=function(B){if((D||!B)&&(typeof B>"u"||typeof B=="object"))try{var H=s.call(B);return(H===w||H===S||H===M||H===p)&&B("")==null}catch{}return!1})}return wM=e?function(B){if(R(B))return!0;if(!B||typeof B!="function"&&typeof B!="object")return!1;try{e(B,null,n)}catch(H){if(H!==r)return!1}return!l(B)&&c(B)}:function(B){if(R(B))return!0;if(!B||typeof B!="function"&&typeof B!="object")return!1;if(I)return c(B);if(l(B))return!1;var H=s.call(B);return H!==y&&H!==_&&!/^\[object HTML/.test(H)?!1:c(B)},wM}var SM,wD;function mx(){return wD||(wD=1,SM=kB()),SM}var MM,SD;function DB(){return SD||(SD=1,MM=function(e){return!!e}),MM}var CM,MD;function Ia(){return MD||(MD=1,CM=function(e){return!!e&&(typeof e=="function"||typeof e=="object")}),CM}var EM,CD;function tue(){if(CD)return EM;CD=1;var t=tf(),e=Lr(),n=mx(),r=DB(),i=Ia();return EM=function(c){if(!i(c))throw new e("ToPropertyDescriptor requires an object");var s={};if(t(c,"enumerable")&&(s["[[Enumerable]]"]=r(c.enumerable)),t(c,"configurable")&&(s["[[Configurable]]"]=r(c.configurable)),t(c,"value")&&(s["[[Value]]"]=c.value),t(c,"writable")&&(s["[[Writable]]"]=r(c.writable)),t(c,"get")){var p=c.get;if(typeof p<"u"&&!n(p))throw new e("getter must be a function");s["[[Get]]"]=p}if(t(c,"set")){var y=c.set;if(typeof y<"u"&&!n(y))throw new e("setter must be a function");s["[[Set]]"]=y}if((t(s,"[[Get]]")||t(s,"[[Set]]"))&&(t(s,"[[Value]]")||t(s,"[[Writable]]")))throw new e("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return s},EM}var TM,ED;function YA(){return ED||(ED=1,TM=Number.isNaN||function(e){return e!==e}),TM}var PM,TD;function KA(){if(TD)return PM;TD=1;var t=YA();return PM=function(n,r){return n===r?n===0?1/n===1/r:!0:t(n)&&t(r)},PM}var AM,PD;function ll(){if(PD)return AM;PD=1;var t=ua(),e=XA(),n=e([t("%String.prototype.indexOf%")]);return AM=function(i,l){var c=t(i,!!l);return typeof c=="function"&&n(i,".prototype.")>-1?e([c]):c},AM}var IM,AD;function JA(){if(AD)return IM;AD=1;var t=ua(),e=t("%Array%"),n=!e.isArray&&ll()("Object.prototype.toString");return IM=e.isArray||function(i){return n(i)==="[object Array]"},IM}var RM,ID;function nue(){if(ID)return RM;ID=1;var t=GA(),e=fx(),n=t.hasArrayLengthDefineBug(),r=n&&JA(),i=ll(),l=i("Object.prototype.propertyIsEnumerable");return RM=function(s,p,y,_,w,S){if(!e){if(!s(S)||!S["[[Configurable]]"]||!S["[[Writable]]"]||w in _&&l(_,w)!==!!S["[[Enumerable]]"])return!1;var M=S["[[Value]]"];return _[w]=M,p(_[w],M)}return n&&w==="length"&&"[[Value]]"in S&&r(_)&&_.length!==S["[[Value]]"]?(_.length=S["[[Value]]"],_.length===S["[[Value]]"]):(e(_,w,y(S)),!0)},RM}var LM,RD;function rue(){if(RD)return LM;RD=1;var t=ng();return LM=function(n,r){return t(r)&&"[[Enumerable]]"in r&&"[[Configurable]]"in r&&(n.IsAccessorDescriptor(r)||n.IsDataDescriptor(r))},LM}var kM,LD;function iue(){return LD||(LD=1,kM=function(e){if(typeof e>"u")return e;var n={};return"[[Value]]"in e&&(n.value=e["[[Value]]"]),"[[Writable]]"in e&&(n.writable=!!e["[[Writable]]"]),"[[Get]]"in e&&(n.get=e["[[Get]]"]),"[[Set]]"in e&&(n.set=e["[[Set]]"]),"[[Enumerable]]"in e&&(n.enumerable=!!e["[[Enumerable]]"]),"[[Configurable]]"in e&&(n.configurable=!!e["[[Configurable]]"]),n}),kM}var DM,kD;function oue(){if(kD)return DM;kD=1;var t=Lr(),e=ng(),n=iue();return DM=function(i){if(typeof i<"u"&&!e(i))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return n(i)},DM}var zM,DD;function zB(){if(DD)return zM;DD=1;var t=Lr(),e=tf(),n=ng();return zM=function(i){if(typeof i>"u")return!1;if(!n(i))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!(!e(i,"[[Value]]")&&!e(i,"[[Writable]]"))},zM}var OM,zD;function sue(){if(zD)return OM;zD=1;var t=Lr(),e=ZA(),n=zB(),r=ng();return OM=function(l){if(typeof l>"u")return!1;if(!r(l))throw new t("Assertion failed: `Desc` must be a Property Descriptor");return!e(l)&&!n(l)},OM}var FM,OD;function aue(){if(OD)return FM;OD=1;var t=Ia();return FM=function(n){if(n===null)return"Null";if(typeof n>"u")return"Undefined";if(t(n))return"Object";if(typeof n=="number")return"Number";if(typeof n=="boolean")return"Boolean";if(typeof n=="string")return"String"},FM}var NM,FD;function lue(){if(FD)return NM;FD=1;var t=aue();return NM=function(n){return typeof n=="symbol"?"Symbol":typeof n=="bigint"?"BigInt":t(n)},NM}var BM,ND;function cue(){if(ND)return BM;ND=1;var t=Lr(),e=nue(),n=rue(),r=ng(),i=oue(),l=ZA(),c=zB(),s=sue(),p=tg(),y=KA(),_=lue(),w=Ia();return BM=function(M,I,D,R,L){var V=_(M);if(typeof M<"u"&&!w(M))throw new t("Assertion failed: O must be undefined or an Object");if(!p(I))throw new t("Assertion failed: P must be a Property Key");if(typeof D!="boolean")throw new t("Assertion failed: extensible must be a Boolean");if(!r(R))throw new t("Assertion failed: Desc must be a Property Descriptor");if(typeof L<"u"&&!r(L))throw new t("Assertion failed: current must be a Property Descriptor, or undefined");if(typeof L>"u")return D?V==="Undefined"?!0:l(R)?e(c,y,i,M,I,R):e(c,y,i,M,I,{"[[Configurable]]":!!R["[[Configurable]]"],"[[Enumerable]]":!!R["[[Enumerable]]"],"[[Value]]":R["[[Value]]"],"[[Writable]]":!!R["[[Writable]]"]}):!1;if(!n({IsAccessorDescriptor:l,IsDataDescriptor:c},L))throw new t("`current`, when present, must be a fully populated and valid Property Descriptor");if(!L["[[Configurable]]"]){if("[[Configurable]]"in R&&R["[[Configurable]]"]||"[[Enumerable]]"in R&&!y(R["[[Enumerable]]"],L["[[Enumerable]]"])||!s(R)&&!y(l(R),l(L)))return!1;if(l(L)){if("[[Get]]"in R&&!y(R["[[Get]]"],L["[[Get]]"])||"[[Set]]"in R&&!y(R["[[Set]]"],L["[[Set]]"]))return!1}else if(!L["[[Writable]]"]&&("[[Writable]]"in R&&R["[[Writable]]"]||"[[Value]]"in R&&!y(R["[[Value]]"],L["[[Value]]"])))return!1}if(V!=="Undefined"){var B,H;return c(L)&&l(R)?(B=("[[Configurable]]"in R?R:L)["[[Configurable]]"],H=("[[Enumerable]]"in R?R:L)["[[Enumerable]]"],e(c,y,i,M,I,{"[[Configurable]]":!!B,"[[Enumerable]]":!!H,"[[Get]]":("[[Get]]"in R?R:L)["[[Get]]"],"[[Set]]":("[[Set]]"in R?R:L)["[[Set]]"]})):l(L)&&c(R)?(B=("[[Configurable]]"in R?R:L)["[[Configurable]]"],H=("[[Enumerable]]"in R?R:L)["[[Enumerable]]"],e(c,y,i,M,I,{"[[Configurable]]":!!B,"[[Enumerable]]":!!H,"[[Value]]":("[[Value]]"in R?R:L)["[[Value]]"],"[[Writable]]":!!("[[Writable]]"in R?R:L)["[[Writable]]"]})):e(c,y,i,M,I,R)}return!0},BM}var UM,BD;function uue(){if(BD)return UM;BD=1;var t=gy(),e=bp(),n=Lr(),r=ng(),i=ZA(),l=eue(),c=tg(),s=tue(),p=KA(),y=cue(),_=Ia();return UM=function(S,M,I){if(!_(S))throw new n("Assertion failed: O must be an Object");if(!c(M))throw new n("Assertion failed: P must be a Property Key");if(!r(I))throw new n("Assertion failed: Desc must be a Property Descriptor");if(!t){if(i(I))throw new e("This environment does not support accessor property descriptors.");var D=!(M in S)&&I["[[Writable]]"]&&I["[[Enumerable]]"]&&I["[[Configurable]]"]&&"[[Value]]"in I,R=M in S&&(!("[[Configurable]]"in I)||I["[[Configurable]]"])&&(!("[[Enumerable]]"in I)||I["[[Enumerable]]"])&&(!("[[Writable]]"in I)||I["[[Writable]]"])&&"[[Value]]"in I;if(D||R)return S[M]=I["[[Value]]"],p(S[M],I["[[Value]]"]);throw new e("This environment does not support defining non-writable, non-enumerable, or non-configurable properties")}var L=t(S,M),V=L&&s(L),B=l(S);return y(S,M,B,I,V)},UM}var $M,UD;function hue(){if(UD)return $M;UD=1;var t=Lr(),e=tg(),n=uue(),r=Ia();return $M=function(l,c,s){if(!r(l))throw new t("Assertion failed: Type(O) is not Object");if(!e(c))throw new t("Assertion failed: P is not a Property Key");var p={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Value]]":s,"[[Writable]]":!0};return n(l,c,p)},$M}var VM,$D;function due(){if($D)return VM;$D=1;var t=Lr(),e=hue(),n=Ia(),r=tg();return VM=function(l,c,s){if(!n(l))throw new t("Assertion failed: Type(O) is not Object");if(!r(c))throw new t("Assertion failed: P is not a Property Key");var p=e(l,c,s);if(!p)throw new t("unable to create data property")},VM}var jM,VD;function QA(){return VD||(VD=1,jM=JA()),jM}var HM,jD;function eI(){return jD||(jD=1,HM=function(e,n){for(var r=0;r<e.length;r+=1)n(e[r],r,e)}),HM}const fue={},pue=Object.freeze(Object.defineProperty({__proto__:null,default:fue},Symbol.toStringTag,{value:"Module"})),mue=fV(pue);var GM,HD;function wp(){if(HD)return GM;HD=1;var t=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,n=t&&e&&typeof e.get=="function"?e.get:null,r=t&&Map.prototype.forEach,i=typeof Set=="function"&&Set.prototype,l=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,c=i&&l&&typeof l.get=="function"?l.get:null,s=i&&Set.prototype.forEach,p=typeof WeakMap=="function"&&WeakMap.prototype,y=p?WeakMap.prototype.has:null,_=typeof WeakSet=="function"&&WeakSet.prototype,w=_?WeakSet.prototype.has:null,S=typeof WeakRef=="function"&&WeakRef.prototype,M=S?WeakRef.prototype.deref:null,I=Boolean.prototype.valueOf,D=Object.prototype.toString,R=Function.prototype.toString,L=String.prototype.match,V=String.prototype.slice,B=String.prototype.replace,H=String.prototype.toUpperCase,q=String.prototype.toLowerCase,X=RegExp.prototype.test,ee=Array.prototype.concat,se=Array.prototype.join,J=Array.prototype.slice,$=Math.floor,le=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ce=Object.getOwnPropertySymbols,we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,We=typeof Symbol=="function"&&typeof Symbol.iterator=="object",Fe=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===We||!0)?Symbol.toStringTag:null,Me=Object.prototype.propertyIsEnumerable,Ee=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(ne){return ne.__proto__}:null);function Te(ne,fe){if(ne===1/0||ne===-1/0||ne!==ne||ne&&ne>-1e3&&ne<1e3||X.call(/e/,fe))return fe;var Oe=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof ne=="number"){var Ke=ne<0?-$(-ne):$(ne);if(Ke!==ne){var ye=String(Ke),Ae=V.call(fe,ye.length+1);return B.call(ye,Oe,"$&_")+"."+B.call(B.call(Ae,/([0-9]{3})/g,"$&_"),/_$/,"")}}return B.call(fe,Oe,"$&_")}var Ze=mue,rt=Ze.custom,Re=tn(rt)?rt:null,Qe={__proto__:null,double:'"',single:"'"},Vt={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};GM=function ne(fe,Oe,Ke,ye){var Ae=Oe||{};if(Kt(Ae,"quoteStyle")&&!Kt(Qe,Ae.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Kt(Ae,"maxStringLength")&&(typeof Ae.maxStringLength=="number"?Ae.maxStringLength<0&&Ae.maxStringLength!==1/0:Ae.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var Be=Kt(Ae,"customInspect")?Ae.customInspect:!0;if(typeof Be!="boolean"&&Be!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Kt(Ae,"indent")&&Ae.indent!==null&&Ae.indent!=="	"&&!(parseInt(Ae.indent,10)===Ae.indent&&Ae.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Kt(Ae,"numericSeparator")&&typeof Ae.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var $e=Ae.numericSeparator;if(typeof fe>"u")return"undefined";if(fe===null)return"null";if(typeof fe=="boolean")return fe?"true":"false";if(typeof fe=="string")return Ot(fe,Ae);if(typeof fe=="number"){if(fe===0)return 1/0/fe>0?"0":"-0";var He=String(fe);return $e?Te(fe,He):He}if(typeof fe=="bigint"){var dt=String(fe)+"n";return $e?Te(fe,dt):dt}var qe=typeof Ae.depth>"u"?5:Ae.depth;if(typeof Ke>"u"&&(Ke=0),Ke>=qe&&qe>0&&typeof fe=="object")return Ct(fe)?"[Array]":"[Object]";var $t=Pe(Ae,Ke);if(typeof ye>"u")ye=[];else if(On(ye,fe)>=0)return"[Circular]";function Jt(hn,kn,Ir){if(kn&&(ye=J.call(ye),ye.push(kn)),Ir){var xr={depth:Ae.depth};return Kt(Ae,"quoteStyle")&&(xr.quoteStyle=Ae.quoteStyle),ne(hn,xr,Ke+1,ye)}return ne(hn,Ae,Ke+1,ye)}if(typeof fe=="function"&&!lt(fe)){var Ie=Ut(fe),ot=ue(fe,Jt);return"[Function"+(Ie?": "+Ie:" (anonymous)")+"]"+(ot.length>0?" { "+se.call(ot,", ")+" }":"")}if(tn(fe)){var mt=We?B.call(String(fe),/^(Symbol\(.*\))_[^)]*$/,"$1"):we.call(fe);return typeof fe=="object"&&!We?Gt(mt):mt}if(Ht(fe)){for(var Wt="<"+q.call(String(fe.nodeName)),nn=fe.attributes||[],mn=0;mn<nn.length;mn++)Wt+=" "+nn[mn].name+"="+je(ct(nn[mn].value),"double",Ae);return Wt+=">",fe.childNodes&&fe.childNodes.length&&(Wt+="..."),Wt+="</"+q.call(String(fe.nodeName))+">",Wt}if(Ct(fe)){if(fe.length===0)return"[]";var on=ue(fe,Jt);return $t&&!Yt(on)?"["+ae(on,$t)+"]":"[ "+se.call(on,", ")+" ]"}if(_t(fe)){var sn=ue(fe,Jt);return!("cause"in Error.prototype)&&"cause"in fe&&!Me.call(fe,"cause")?"{ ["+String(fe)+"] "+se.call(ee.call("[cause]: "+Jt(fe.cause),sn),", ")+" }":sn.length===0?"["+String(fe)+"]":"{ ["+String(fe)+"] "+se.call(sn,", ")+" }"}if(typeof fe=="object"&&Be){if(Re&&typeof fe[Re]=="function"&&Ze)return Ze(fe,{depth:qe-Ke});if(Be!=="symbol"&&typeof fe.inspect=="function")return fe.inspect()}if(vn(fe)){var Dn=[];return r&&r.call(fe,function(hn,kn){Dn.push(Jt(kn,fe,!0)+" => "+Jt(hn,fe))}),Nn("Map",n.call(fe),Dn,$t)}if(yt(fe)){var Et=[];return s&&s.call(fe,function(hn){Et.push(Jt(hn,fe))}),Nn("Set",c.call(fe),Et,$t)}if(Ue(fe))return Zt("WeakMap");if(Nt(fe))return Zt("WeakSet");if(Se(fe))return Zt("WeakRef");if(cn(fe))return Gt(Jt(Number(fe)));if(Je(fe))return Gt(Jt(le.call(fe)));if(dn(fe))return Gt(I.call(fe));if(wt(fe))return Gt(Jt(String(fe)));if(typeof window<"u"&&fe===window)return"{ [object Window] }";if(typeof globalThis<"u"&&fe===globalThis||typeof _R<"u"&&fe===_R)return"{ [object globalThis] }";if(!ut(fe)&&!lt(fe)){var Gn=ue(fe,Jt),Fn=Ee?Ee(fe)===Object.prototype:fe instanceof Object||fe.constructor===Object,or=fe instanceof Object?"":"null prototype",It=!Fn&&Fe&&Object(fe)===fe&&Fe in fe?V.call(fn(fe),8,-1):or?"Object":"",nt=Fn||typeof fe.constructor!="function"?"":fe.constructor.name?fe.constructor.name+" ":"",qt=nt+(It||or?"["+se.call(ee.call([],It||[],or||[]),": ")+"] ":"");return Gn.length===0?qt+"{}":$t?qt+"{"+ae(Gn,$t)+"}":qt+"{ "+se.call(Gn,", ")+" }"}return String(fe)};function je(ne,fe,Oe){var Ke=Oe.quoteStyle||fe,ye=Qe[Ke];return ye+ne+ye}function ct(ne){return B.call(String(ne),/"/g,"&quot;")}function Ct(ne){return fn(ne)==="[object Array]"&&(!Fe||!(typeof ne=="object"&&Fe in ne))}function ut(ne){return fn(ne)==="[object Date]"&&(!Fe||!(typeof ne=="object"&&Fe in ne))}function lt(ne){return fn(ne)==="[object RegExp]"&&(!Fe||!(typeof ne=="object"&&Fe in ne))}function _t(ne){return fn(ne)==="[object Error]"&&(!Fe||!(typeof ne=="object"&&Fe in ne))}function wt(ne){return fn(ne)==="[object String]"&&(!Fe||!(typeof ne=="object"&&Fe in ne))}function cn(ne){return fn(ne)==="[object Number]"&&(!Fe||!(typeof ne=="object"&&Fe in ne))}function dn(ne){return fn(ne)==="[object Boolean]"&&(!Fe||!(typeof ne=="object"&&Fe in ne))}function tn(ne){if(We)return ne&&typeof ne=="object"&&ne instanceof Symbol;if(typeof ne=="symbol")return!0;if(!ne||typeof ne!="object"||!we)return!1;try{return we.call(ne),!0}catch{}return!1}function Je(ne){if(!ne||typeof ne!="object"||!le)return!1;try{return le.call(ne),!0}catch{}return!1}var Tn=Object.prototype.hasOwnProperty||function(ne){return ne in this};function Kt(ne,fe){return Tn.call(ne,fe)}function fn(ne){return D.call(ne)}function Ut(ne){if(ne.name)return ne.name;var fe=L.call(R.call(ne),/^function\s*([\w$]+)/);return fe?fe[1]:null}function On(ne,fe){if(ne.indexOf)return ne.indexOf(fe);for(var Oe=0,Ke=ne.length;Oe<Ke;Oe++)if(ne[Oe]===fe)return Oe;return-1}function vn(ne){if(!n||!ne||typeof ne!="object")return!1;try{n.call(ne);try{c.call(ne)}catch{return!0}return ne instanceof Map}catch{}return!1}function Ue(ne){if(!y||!ne||typeof ne!="object")return!1;try{y.call(ne,y);try{w.call(ne,w)}catch{return!0}return ne instanceof WeakMap}catch{}return!1}function Se(ne){if(!M||!ne||typeof ne!="object")return!1;try{return M.call(ne),!0}catch{}return!1}function yt(ne){if(!c||!ne||typeof ne!="object")return!1;try{c.call(ne);try{n.call(ne)}catch{return!0}return ne instanceof Set}catch{}return!1}function Nt(ne){if(!w||!ne||typeof ne!="object")return!1;try{w.call(ne,w);try{y.call(ne,y)}catch{return!0}return ne instanceof WeakSet}catch{}return!1}function Ht(ne){return!ne||typeof ne!="object"?!1:typeof HTMLElement<"u"&&ne instanceof HTMLElement?!0:typeof ne.nodeName=="string"&&typeof ne.getAttribute=="function"}function Ot(ne,fe){if(ne.length>fe.maxStringLength){var Oe=ne.length-fe.maxStringLength,Ke="... "+Oe+" more character"+(Oe>1?"s":"");return Ot(V.call(ne,0,fe.maxStringLength),fe)+Ke}var ye=Vt[fe.quoteStyle||"single"];ye.lastIndex=0;var Ae=B.call(B.call(ne,ye,"\\$1"),/[\x00-\x1f]/g,un);return je(Ae,"single",fe)}function un(ne){var fe=ne.charCodeAt(0),Oe={8:"b",9:"t",10:"n",12:"f",13:"r"}[fe];return Oe?"\\"+Oe:"\\x"+(fe<16?"0":"")+H.call(fe.toString(16))}function Gt(ne){return"Object("+ne+")"}function Zt(ne){return ne+" { ? }"}function Nn(ne,fe,Oe,Ke){var ye=Ke?ae(Oe,Ke):se.call(Oe,", ");return ne+" ("+fe+") {"+ye+"}"}function Yt(ne){for(var fe=0;fe<ne.length;fe++)if(On(ne[fe],`
`)>=0)return!1;return!0}function Pe(ne,fe){var Oe;if(ne.indent==="	")Oe="	";else if(typeof ne.indent=="number"&&ne.indent>0)Oe=se.call(Array(ne.indent+1)," ");else return null;return{base:Oe,prev:se.call(Array(fe+1),Oe)}}function ae(ne,fe){if(ne.length===0)return"";var Oe=`
`+fe.prev+fe.base;return Oe+se.call(ne,","+Oe)+`
`+fe.prev}function ue(ne,fe){var Oe=Ct(ne),Ke=[];if(Oe){Ke.length=ne.length;for(var ye=0;ye<ne.length;ye++)Ke[ye]=Kt(ne,ye)?fe(ne[ye],ne):""}var Ae=typeof Ce=="function"?Ce(ne):[],Be;if(We){Be={};for(var $e=0;$e<Ae.length;$e++)Be["$"+Ae[$e]]=Ae[$e]}for(var He in ne)Kt(ne,He)&&(Oe&&String(Number(He))===He&&He<ne.length||We&&Be["$"+He]instanceof Symbol||(X.call(/[^\w$]/,He)?Ke.push(fe(He,ne)+": "+fe(ne[He],ne)):Ke.push(He+": "+fe(ne[He],ne))));if(typeof Ce=="function")for(var dt=0;dt<Ae.length;dt++)Me.call(ne,Ae[dt])&&Ke.push("["+fe(Ae[dt])+"]: "+fe(ne[Ae[dt]],ne));return Ke}return GM}var WM,GD;function gue(){if(GD)return WM;GD=1;var t=wp(),e=Lr(),n=function(s,p,y){for(var _=s,w;(w=_.next)!=null;_=w)if(w.key===p)return _.next=w.next,y||(w.next=s.next,s.next=w),w},r=function(s,p){if(s){var y=n(s,p);return y&&y.value}},i=function(s,p,y){var _=n(s,p);_?_.value=y:s.next={key:p,next:s.next,value:y}},l=function(s,p){return s?!!n(s,p):!1},c=function(s,p){if(s)return n(s,p,!0)};return WM=function(){var p,y={assert:function(_){if(!y.has(_))throw new e("Side channel does not contain "+t(_))},delete:function(_){var w=p&&p.next,S=c(p,_);return S&&w&&w===S&&(p=void 0),!!S},get:function(_){return r(p,_)},has:function(_){return l(p,_)},set:function(_,w){p||(p={next:void 0}),i(p,_,w)}};return y},WM}var qM,WD;function OB(){if(WD)return qM;WD=1;var t=ua(),e=ll(),n=wp(),r=Lr(),i=t("%Map%",!0),l=e("Map.prototype.get",!0),c=e("Map.prototype.set",!0),s=e("Map.prototype.has",!0),p=e("Map.prototype.delete",!0),y=e("Map.prototype.size",!0);return qM=!!i&&function(){var w,S={assert:function(M){if(!S.has(M))throw new r("Side channel does not contain "+n(M))},delete:function(M){if(w){var I=p(w,M);return y(w)===0&&(w=void 0),I}return!1},get:function(M){if(w)return l(w,M)},has:function(M){return w?s(w,M):!1},set:function(M,I){w||(w=new i),c(w,M,I)}};return S},qM}var XM,qD;function vue(){if(qD)return XM;qD=1;var t=ua(),e=ll(),n=wp(),r=OB(),i=Lr(),l=t("%WeakMap%",!0),c=e("WeakMap.prototype.get",!0),s=e("WeakMap.prototype.set",!0),p=e("WeakMap.prototype.has",!0),y=e("WeakMap.prototype.delete",!0);return XM=l?function(){var w,S,M={assert:function(I){if(!M.has(I))throw new i("Side channel does not contain "+n(I))},delete:function(I){if(l&&I&&(typeof I=="object"||typeof I=="function")){if(w)return y(w,I)}else if(r&&S)return S.delete(I);return!1},get:function(I){return l&&I&&(typeof I=="object"||typeof I=="function")&&w?c(w,I):S&&S.get(I)},has:function(I){return l&&I&&(typeof I=="object"||typeof I=="function")&&w?p(w,I):!!S&&S.has(I)},set:function(I,D){l&&I&&(typeof I=="object"||typeof I=="function")?(w||(w=new l),s(w,I,D)):r&&(S||(S=r()),S.set(I,D))}};return M}:r,XM}var ZM,XD;function yue(){if(XD)return ZM;XD=1;var t=Lr(),e=wp(),n=gue(),r=OB(),i=vue(),l=i||r||n;return ZM=function(){var s,p={assert:function(y){if(!p.has(y))throw new t("Side channel does not contain "+e(y))},delete:function(y){return!!s&&s.delete(y)},get:function(y){return s&&s.get(y)},has:function(y){return!!s&&s.has(y)},set:function(y,_){s||(s=l()),s.set(y,_)}};return p},ZM}var YM,ZD;function tI(){if(ZD)return YM;ZD=1;var t=tf(),e=yue()(),n=Lr(),r={assert:function(i,l){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");if(e.assert(i),!r.has(i,l))throw new n("`"+l+"` is not present on `O`")},get:function(i,l){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var c=e.get(i);return c&&c["$"+l]},has:function(i,l){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var c=e.get(i);return!!c&&t(c,"$"+l)},set:function(i,l,c){if(!i||typeof i!="object"&&typeof i!="function")throw new n("`O` is not an object");if(typeof l!="string")throw new n("`slot` must be a string");var s=e.get(i);s||(s={},e.set(i,s)),s["$"+l]=c}};return Object.freeze&&Object.freeze(r),YM=r,YM}var KM,YD;function _ue(){if(YD)return KM;YD=1;var t={__proto__:null,foo:{}},e={__proto__:t}.foo===t.foo&&!(t instanceof Object);return KM=function(){return e},KM}var JM,KD;function FB(){if(KD)return JM;KD=1;var t=ua(),e=t("%Object.create%",!0),n=Lr(),r=bp(),i=QA(),l=eI(),c=Ia(),s=tI(),p=_ue()();return JM=function(_){if(_!==null&&!c(_))throw new n("Assertion failed: `proto` must be null or an object");var w=arguments.length<2?[]:arguments[1];if(!i(w))throw new n("Assertion failed: `additionalInternalSlotsList` must be an Array");var S;if(e)S=e(_);else if(p)S={__proto__:_};else{if(_===null)throw new r("native Object.create support is required to create null objects");var M=function(){};M.prototype=_,S=new M}return w.length>0&&l(w,function(I){s.set(S,I,void 0)}),S},JM}var QM,JD;function xue(){return JD||(JD=1,QM=function(e){return e===0&&1/e===-1/0}),QM}var eC,QD;function NB(){return QD||(QD=1,eC=Number.MAX_SAFE_INTEGER||9007199254740991),eC}var tC,e5;function bue(){return e5||(e5=1,tC=function(e,n){for(var r=0;r<e.length;r+=1)if(!n(e[r],r,e))return!1;return!0}),tC}var nC,t5;function wue(){if(t5)return nC;t5=1;var t=Lr(),e=ll(),n=e("Array.prototype.push"),r=KA(),i=JA(),l=bue(),c=eI(),s=tf(),p=function(y){return s(y,"[[Key]]")&&s(y,"[[Elements]]")&&i(y["[[Elements]]"])};return nC=function(_,w,S){if(!i(_)||_.length>0&&!l(_,p))throw new t("Assertion failed: `groups` must be a List of Records with [[Key]] and [[Elements]]");var M=0;if(c(_,function(D){if(r(D["[[Key]]"],w)){if(M+=1,M>1)throw new t("Assertion failed: Exactly one element of groups meets this criterion");n(D["[[Elements]]"],S)}}),M===0){var I={"[[Key]]":w,"[[Elements]]":[S]};n(_,I)}},nC}var rC,n5;function gx(){if(n5)return rC;n5=1;var t=ua(),e=ll(),n=Lr(),r=QA(),i=t("%Reflect.apply%",!0)||e("Function.prototype.apply");return rC=function(c,s){var p=arguments.length>2?arguments[2]:[];if(!r(p))throw new n("Assertion failed: optional `argumentsList`, if provided, must be a List");return i(c,s,p)},rC}var iC,r5;function BB(){return r5||(r5=1,iC=function(e){return typeof e=="number"&&e>=55296&&e<=56319}),iC}var oC,i5;function UB(){return i5||(i5=1,oC=function(e){return typeof e=="number"&&e>=56320&&e<=57343}),oC}var sC,o5;function Sue(){if(o5)return sC;o5=1;var t=ua(),e=Lr(),n=t("%String.fromCharCode%"),r=BB(),i=UB();return sC=function(c,s){if(!r(c)||!i(s))throw new e("Assertion failed: `lead` must be a leading surrogate char code, and `trail` must be a trailing surrogate char code");return n(c)+n(s)},sC}var aC,s5;function Mue(){if(s5)return aC;s5=1;var t=Lr(),e=ll(),n=BB(),r=UB(),i=Sue(),l=e("String.prototype.charAt"),c=e("String.prototype.charCodeAt");return aC=function(p,y){if(typeof p!="string")throw new t("Assertion failed: `string` must be a String");var _=p.length;if(y<0||y>=_)throw new t("Assertion failed: `position` must be >= 0, and < the length of `string`");var w=c(p,y),S=l(p,y),M=n(w),I=r(w);if(!M&&!I)return{"[[CodePoint]]":S,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!1};if(I||y+1===_)return{"[[CodePoint]]":S,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0};var D=c(p,y+1);return r(D)?{"[[CodePoint]]":i(w,D),"[[CodeUnitCount]]":2,"[[IsUnpairedSurrogate]]":!1}:{"[[CodePoint]]":S,"[[CodeUnitCount]]":1,"[[IsUnpairedSurrogate]]":!0}},aC}var lC,a5;function Cue(){if(a5)return lC;a5=1;var t=YA();return lC=function(n){return(typeof n=="number"||typeof n=="bigint")&&!t(n)&&n!==1/0&&n!==-1/0},lC}var cC,l5;function Eue(){if(l5)return cC;l5=1;var t=PB(),e=AB(),n=YA(),r=Cue();return cC=function(l){if(typeof l!="number"||n(l)||!r(l))return!1;var c=t(l);return e(c)===c},cC}var uC,c5;function Tue(){if(c5)return uC;c5=1;var t=Mue(),e=Lr(),n=Eue(),r=NB();return uC=function(l,c,s){if(typeof l!="string")throw new e("Assertion failed: `S` must be a String");if(!n(c)||c<0||c>r)throw new e("Assertion failed: `length` must be an integer >= 0 and <= 2**53");if(typeof s!="boolean")throw new e("Assertion failed: `unicode` must be a Boolean");if(!s)return c+1;var p=l.length;if(c+1>=p)return c+1;var y=t(l,c);return c+y["[[CodeUnitCount]]"]},uC}var hC,u5;function $B(){if(u5)return hC;u5=1;var t=Lr();return hC=function(n,r){if(typeof r!="boolean")throw new t("Assertion failed: Type(done) is not Boolean");return{value:n,done:r}},hC}var dC,h5;function dS(){if(h5)return dC;h5=1;var t=Lr(),e=wp(),n=Ia(),r=tg();return dC=function(l,c){if(!n(l))throw new t("Assertion failed: Type(O) is not Object");if(!r(c))throw new t("Assertion failed: P is not a Property Key, got "+e(c));return l[c]},dC}var fC,d5;function VB(){if(d5)return fC;d5=1;var t=Lr(),e=dS(),n=DB(),r=Ia();return fC=function(l){if(!r(l))throw new t("Assertion failed: Type(iterResult) is not Object");return n(e(l,"done"))},fC}var pC,f5;function jB(){if(f5)return pC;f5=1;var t=Lr(),e=dS(),n=Ia();return pC=function(i){if(!n(i))throw new t("Assertion failed: Type(iterResult) is not Object");return e(i,"value")},pC}var mC,p5;function Pue(){if(p5)return mC;p5=1;var t=ua(),e=LB(),n=bp(),r=t("%Promise.resolve%",!0),i=r&&e(r);return mC=function(c,s){if(!i)throw new n("This environment does not support Promises.");return i(c,s)},mC}var gC,m5;function Aue(){if(m5)return gC;m5=1;var t=ua(),e=bp(),n=Lr(),r=t("%Promise%",!0),i=ll(),l=$B(),c=VB(),s=jB(),p=Pue(),y=Ia(),_=i("Promise.prototype.then",!0);return gC=function(S){if(!y(S))throw new n("Assertion failed: Type(O) is not Object");if(arguments.length>1)throw new e("although AsyncFromSyncIteratorContinuation should take a second argument, it is not used in this implementation");if(!r)throw new e("This environment does not support Promises.");return new r(function(M){var I=c(S),D=s(S),R=p(r,D),L=function(V){return l(V,I)};M(_(R,L))})},gC}var vC,g5;function Iue(){if(g5)return vC;g5=1;var t=Lr(),e=wp(),n=tg();return vC=function(i,l){if(!n(l))throw new t("Assertion failed: P is not a Property Key, got "+e(l));return i[l]},vC}var yC,v5;function nI(){if(v5)return yC;v5=1;var t=Lr(),e=Iue(),n=mx(),r=tg(),i=wp();return yC=function(c,s){if(!r(s))throw new t("Assertion failed: P is not a Property Key");var p=e(c,s);if(p!=null){if(!n(p))throw new t(i(s)+" is not a function: "+i(p));return p}},yC}var _C,y5;function fS(){if(y5)return _C;y5=1;var t=tf();return _C=function(n){return!!n&&typeof n=="object"&&t(n,"[[Iterator]]")&&t(n,"[[NextMethod]]")&&t(n,"[[Done]]")&&typeof n["[[Done]]"]=="boolean"},_C}var xC,_5;function HB(){if(_5)return xC;_5=1;var t=Lr(),e=gx(),n=Ia(),r=fS();return xC=function(l){if(!r(l))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");var c;if(arguments.length<2?c=e(l["[[NextMethod]]"],l["[[Iterator]]"]):c=e(l["[[NextMethod]]"],l["[[Iterator]]"],[arguments[1]]),!n(c))throw new t("iterator next must return an object");return c},xC}var bC,x5;function Rue(){if(x5)return bC;x5=1;var t=ua(),e=bp(),n=Lr(),r=t("%Promise%",!0),i=Aue(),l=gx(),c=$B(),s=dS(),p=nI(),y=HB(),_=FB(),w=Ia(),S=fS(),M=tI(),I=t("%AsyncFromSyncIteratorPrototype%",!0)||{next:function(R){if(!r)throw new e("This environment does not support Promises.");var L=this;M.assert(L,"[[SyncIteratorRecord]]");var V=arguments.length;return new r(function(B){var H=M.get(L,"[[SyncIteratorRecord]]"),q;V>0?q=y(H,R):q=y(H),B(i(q))})},return:function(){if(!r)throw new e("This environment does not support Promises.");var D=this;M.assert(D,"[[SyncIteratorRecord]]");var R=arguments.length>0,L=R?arguments[0]:void 0;return new r(function(V,B){var H=M.get(D,"[[SyncIteratorRecord]]")["[[Iterator]]"],q=p(H,"return");if(typeof q>"u"){var X=c(L,!0);l(V,void 0,[X]);return}var ee;if(R?ee=l(q,H,[L]):ee=l(q,H),!w(ee)){l(B,void 0,[new n("Iterator `return` method returned a non-object value.")]);return}V(i(ee))})},throw:function(){if(!r)throw new e("This environment does not support Promises.");var D=this;M.assert(D,"[[SyncIteratorRecord]]");var R=arguments.length>0,L=R?arguments[0]:void 0;return new r(function(V,B){var H=M.get(D,"[[SyncIteratorRecord]]")["[[Iterator]]"],q=p(H,"throw");if(typeof q>"u"){l(B,void 0,[L]);return}var X;if(R?X=l(q,H,[L]):X=l(q,H),!w(X)){l(B,void 0,[new n("Iterator `throw` method returned a non-object value.")]);return}V(i(X))})}};return bC=function(R){if(!S(R))throw new n("Assertion failed: `syncIteratorRecord` must be an Iterator Record");var L=_(I);M.set(L,"[[SyncIteratorRecord]]",R);var V=s(L,"next");return{"[[Iterator]]":L,"[[NextMethod]]":V,"[[Done]]":!1}},bC}var wC,b5;function Lue(){if(b5)return wC;b5=1;var t=Lr(),e=gx(),n=dS(),r=mx(),i=Ia();return wC=function(c,s){if(!r(s))throw new t("method must be a function");var p=e(s,c);if(!i(p))throw new t("iterator must return an object");var y=n(p,"next");return{"[[Iterator]]":p,"[[NextMethod]]":y,"[[Done]]":!1}},wC}var SC,w5;function rI(){if(w5)return SC;w5=1;var t=IB();return SC=function(){return t()&&!!Symbol.toStringTag},SC}var MC,S5;function kue(){if(S5)return MC;S5=1;var t=ll(),e=t("String.prototype.valueOf"),n=function(s){try{return e(s),!0}catch{return!1}},r=t("Object.prototype.toString"),i="[object String]",l=rI()();return MC=function(s){return typeof s=="string"?!0:!s||typeof s!="object"?!1:l?n(s):r(s)===i},MC}var CC,M5;function Due(){if(M5)return CC;M5=1;var t=hS()(),e=ua(),n=ll(),r=kue(),i=e("%Symbol.iterator%",!0),l=n("String.prototype.slice"),c=e("%String%");return CC=function(p,y){var _;return t?_=p.GetMethod(y,i):p.IsArray(y)?_=function(){var w=-1,S=this;return{next:function(){return w+=1,{done:w>=S.length,value:S[w]}}}}:r(y)&&(_=function(){var w=0;return{next:function(){var S=p.AdvanceStringIndex(c(y),w,!0),M=l(y,w,S);return w=S,{done:S>y.length,value:M}}}}),_},CC}var EC,C5;function zue(){if(C5)return EC;C5=1;var t=ua(),e=Lr(),n=t("%Symbol.asyncIterator%",!0),r=wp(),i=hS()(),l=Tue(),c=Rue(),s=Lue(),p=nI(),y=QA(),_={AdvanceStringIndex:l,GetMethod:p,IsArray:y},w=Due();return EC=function(M,I){if(I!=="SYNC"&&I!=="ASYNC")throw new e("Assertion failed: `kind` must be one of 'sync' or 'async', got "+r(I));var D;if(I==="ASYNC"&&i&&n&&(D=p(M,n)),typeof D>"u"){var R=w(_,M);if(I==="ASYNC"){if(typeof R>"u")throw new e("iterator method is `undefined`");var L=s(M,R);return c(L)}D=R}if(typeof D>"u")throw new e("iterator method is `undefined`");return s(M,D)},EC}var TC,E5;function GB(){if(E5)return TC;E5=1;var t=bp(),e=tI(),n=function r(i,l){if(!(this instanceof r))return new r(i,l);if(i!=="normal"&&i!=="break"&&i!=="continue"&&i!=="return"&&i!=="throw")throw new t('Assertion failed: `type` must be one of "normal", "break", "continue", "return", or "throw"');e.set(this,"[[Type]]",i),e.set(this,"[[Value]]",l)};return n.prototype.type=function(){return e.get(this,"[[Type]]")},n.prototype.value=function(){return e.get(this,"[[Value]]")},n.prototype["?"]=function(){var i=e.get(this,"[[Type]]"),l=e.get(this,"[[Value]]");if(i==="throw")throw l;return l},n.prototype["!"]=function(){var i=e.get(this,"[[Type]]");if(i!=="normal")throw new t('Assertion failed: Completion Record is not of type "normal"');return e.get(this,"[[Value]]")},TC=n,TC}var PC,T5;function Oue(){if(T5)return PC;T5=1;var t=Lr(),e=gx(),n=GB(),r=nI(),i=mx(),l=Ia(),c=fS();return PC=function(p,y){if(!c(p))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");if(!l(p["[[Iterator]]"]))throw new t("Assertion failed: iteratorRecord.[[Iterator]] must be an Object");if(!i(y)&&!(y instanceof n))throw new t("Assertion failed: completion is not a thunk representing a Completion Record, nor a Completion Record instance");var _=y instanceof n?function(){return y["?"]()}:y,w=p["[[Iterator]]"],S;try{S=r(w,"return")}catch(D){throw _(),_=null,D}if(typeof S>"u")return _();var M;try{M=e(S,w,[])}catch(D){throw _(),_=null,D}var I=_();if(_=null,!l(M))throw new t("iterator .return must return an object");return I},PC}var AC,P5;function Fue(){if(P5)return AC;P5=1;var t=Lr(),e=VB(),n=HB(),r=fS();return AC=function(l){if(!r(l))throw new t("Assertion failed: `iteratorRecord` must be an Iterator Record");var c=n(l),s=e(c);return s===!0?!1:c},AC}var IC,A5;function Nue(){if(A5)return IC;A5=1;var t=Lr();return IC=function(n){if(n==null)throw new t(arguments.length>0&&arguments[1]||"Cannot call method on "+n);return n},IC}var RC,I5;function Bue(){return I5||(I5=1,RC=Nue()),RC}var LC,R5;function Uue(){if(R5)return LC;R5=1;var t=GB();return LC=function(n){return new t("throw",n)},LC}var kC,L5;function $ue(){return L5||(L5=1,kC=function(e){return e===null||typeof e!="function"&&typeof e!="object"}),kC}var DC,k5;function Vue(){if(k5)return DC;k5=1;var t=ll(),e=t("Date.prototype.getDay"),n=function(s){try{return e(s),!0}catch{return!1}},r=t("Object.prototype.toString"),i="[object Date]",l=rI()();return DC=function(s){return typeof s!="object"||s===null?!1:l?n(s):r(s)===i},DC}var _1={exports:{}},zC,D5;function jue(){if(D5)return zC;D5=1;var t=ll(),e=rI()(),n=tf(),r=gy(),i;if(e){var l=t("RegExp.prototype.exec"),c={},s=function(){throw c},p={toString:s,valueOf:s};typeof Symbol.toPrimitive=="symbol"&&(p[Symbol.toPrimitive]=s),i=function(S){if(!S||typeof S!="object")return!1;var M=r(S,"lastIndex"),I=M&&n(M,"value");if(!I)return!1;try{l(S,p)}catch(D){return D===c}}}else{var y=t("Object.prototype.toString"),_="[object RegExp]";i=function(S){return!S||typeof S!="object"&&typeof S!="function"?!1:y(S)===_}}return zC=i,zC}var OC,z5;function Hue(){if(z5)return OC;z5=1;var t=ll(),e=jue(),n=t("RegExp.prototype.exec"),r=Lr();return OC=function(l){if(!e(l))throw new r("`regex` must be a RegExp");return function(s){return n(l,s)!==null}},OC}var O5;function Gue(){if(O5)return _1.exports;O5=1;var t=ll(),e=t("Object.prototype.toString"),n=hS()(),r=Hue();if(n){var i=t("Symbol.prototype.toString"),l=r(/^Symbol\(.*\)$/),c=function(p){return typeof p.valueOf()!="symbol"?!1:l(i(p))};_1.exports=function(p){if(typeof p=="symbol")return!0;if(!p||typeof p!="object"||e(p)!=="[object Symbol]")return!1;try{return c(p)}catch{return!1}}}else _1.exports=function(p){return!1};return _1.exports}var FC,F5;function Wue(){if(F5)return FC;F5=1;var t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",e=$ue(),n=kB(),r=Vue(),i=Gue(),l=function(p,y){if(typeof p>"u"||p===null)throw new TypeError("Cannot call method on "+p);if(typeof y!="string"||y!=="number"&&y!=="string")throw new TypeError('hint must be "string" or "number"');var _=y==="string"?["toString","valueOf"]:["valueOf","toString"],w,S,M;for(M=0;M<_.length;++M)if(w=p[_[M]],n(w)&&(S=w.call(p),e(S)))return S;throw new TypeError("No default value")},c=function(p,y){var _=p[y];if(_!==null&&typeof _<"u"){if(!n(_))throw new TypeError(_+" returned for property "+String(y)+" of object "+p+" is not a function");return _}};return FC=function(p){if(e(p))return p;var y="default";arguments.length>1&&(arguments[1]===String?y="string":arguments[1]===Number&&(y="number"));var _;if(t&&(Symbol.toPrimitive?_=c(p,Symbol.toPrimitive):i(p)&&(_=Symbol.prototype.valueOf)),typeof _<"u"){var w=_.call(p,y);if(e(w))return w;throw new TypeError("unable to convert exotic object to primitive")}return y==="default"&&(r(p)||i(p))&&(y="string"),l(p,y==="default"?"number":y)},FC}var NC,N5;function que(){if(N5)return NC;N5=1;var t=Wue();return NC=function(n){return arguments.length>1?t(n,arguments[1]):t(n)},NC}var BC,B5;function Xue(){if(B5)return BC;B5=1;var t=ua(),e=t("%String%"),n=Lr();return BC=function(i){if(typeof i=="symbol")throw new n("Cannot convert a Symbol value to a string");return e(i)},BC}var UC,U5;function Zue(){if(U5)return UC;U5=1;var t=ua(),e=t("%String%"),n=que(),r=Xue();return UC=function(l){var c=n(l,e);return typeof c=="symbol"?c:r(c)},UC}var $C,$5;function Yue(){if($5)return $C;$5=1;var t=Lr(),e=xue(),n=NB(),r=wue(),i=gx(),l=zue(),c=mx(),s=Oue(),p=Fue(),y=jB(),_=Bue(),w=Uue(),S=Zue();return $C=function(I,D,R){if(R!=="PROPERTY"&&R!=="ZERO")throw new t('Assertion failed: `keyCoercion` must be `"PROPERTY"` or `"ZERO"`');if(_(I),!c(D))throw new t("callbackfn must be callable");for(var L=[],V=l(I,"SYNC"),B=0;;){if(B>=n){var H=w(new t("k must be less than 2 ** 53 - 1"));s(V,H);return}var q=p(V);if(!q)return L;var X=y(q),ee;try{ee=i(D,void 0,[X,B])}catch(se){s(V,w(se));return}if(R==="PROPERTY")try{ee=S(ee)}catch(se){s(V,w(se));return}else{if(R!=="ZERO")throw new t("keyCoercion must be ~PROPERTY~ or ~ZERO~");e(ee)&&(ee=0)}r(L,ee,X),B+=1}},$C}var VC,V5;function WB(){if(V5)return VC;V5=1;var t=due(),e=FB(),n=eI(),r=Yue();return VC=function(l,c){var s=r(l,c,"PROPERTY"),p=e(null);return n(s,function(y){t(p,y["[[Key]]"],y["[[Elements]]"])}),p},VC}var jC,j5;function qB(){if(j5)return jC;j5=1;var t=WB();return jC=function(){return Object.groupBy||t},jC}var HC,H5;function Kue(){if(H5)return HC;H5=1;var t=TB(),e=qB();return HC=function(){var r=e();return t(Object,{groupBy:r},{groupBy:function(){return Object.groupBy!==r}}),r},HC}var GC,G5;function Jue(){if(G5)return GC;G5=1;var t=TB(),e=LB(),n=WB(),r=qB(),i=r(),l=Kue(),c=e(i,Object);return t(c,{getPolyfill:r,implementation:n,shim:l}),GC=c,GC}var Que=Jue();const ehe=vw(Que),Jb=[{label:"ATS",value:{map:"usa",search:"places"}},{label:"ATS",value:{map:"usa",search:"achievements"}},{label:"ETS2",value:{map:"europe",search:"places"}},{label:"ETS2",value:{map:"europe",search:"achievements"}}],WC=(t,e)=>Jb.find(r=>r.value.map===t&&r.value.search===e)??mr(Jb.find(r=>r.value.map)),x1=({selected:t,onSelect:e})=>ie.jsx(yY,{sx:{paddingBlock:0,minWidth:"fit-content"},variant:"plain",size:"sm",slotProps:{listbox:{placement:"bottom-start"}},value:t,onChange:(n,r)=>{n!=null&&e(mr(Jb.find(i=>i.value===r)))},renderValue:n=>{if(n)return ie.jsxs(ca,{direction:"row",gap:1,sx:{alignItems:"center"},children:[ie.jsx(Ti,{level:"body-xs",fontWeight:"lg",children:n.value.map==="usa"?"ATS":"ETS2"}),ie.jsx(W5,{search:n.value.search})]})},children:Object.entries(ehe(Jb,({label:n})=>n)).map(([n,r])=>ie.jsxs(jw,{children:[ie.jsx(gp,{children:ie.jsx(Ti,{level:"body-xs",fontWeight:"lg",children:n})}),r?.map(i=>ie.jsxs(oY,{value:i.value,sx:{px:"1em",textTransform:"capitalize"},children:[ie.jsx(W5,{search:i.value.search}),i.value.search]},i.value.search))]},n))}),W5=({search:t})=>{switch(t){case"achievements":return ie.jsx(kre,{});case"places":return ie.jsx(Ure,{});default:throw new Su(t)}},fb={usa:{longitude:-108,latitude:39},europe:{longitude:12,latitude:51}},the=t=>{const e=G.useRef(null);sl(()=>({onAdd:()=>mr(e.current),onRemove:()=>mr(e.current).remove()}),{position:"top-left"});const{current:n}=ox(),[r,i]=G.useState(WC(localStorage.getItem("tm-map")==="europe"?"europe":"usa",rhe(localStorage.getItem("tm-search")))),l=B0.useCallback(M=>{if(M==null||(i(M),localStorage.setItem("tm-map",M.value.map),localStorage.setItem("tm-search",M.value.search),!n||M.value.map===r.value.map))return;const{longitude:I,latitude:D}=fb[M.value.map];n.easeTo({zoom:4,center:[I,D]})},[n,r]);G.useEffect(()=>{if(!n)return;const M=()=>{const I=n.getCenter().lng,D=q5(I,fb.usa.longitude),R=q5(I,fb.europe.longitude);D<R&&r.value.map!=="usa"?(i(WC("usa",r.value.search)),localStorage.setItem("tm-map","usa")):R<D&&r.value.map!=="europe"&&(i(WC("europe",r.value.search)),localStorage.setItem("tm-map","europe"))};return n.on("moveend",M),()=>void n.off("moveend",M)},[n,r]);const c=B0.useCallback(M=>{n==null||M==null||(n.flyTo({curve:1,zoom:10.5,center:M.poi.geometry.coordinates}),n.once("moveend",I=>{const{lat:D,lng:R}=I.target.getCenter(),L=I.target.getZoom(),V=Number(I.target.getBearing().toFixed(1)),B=Math.round(I.target.getPitch());let H;B?H=`#${L}/${D.toFixed(3)}/${R.toFixed(3)}/${V}/${B}`:V?H=`#${L}/${D.toFixed(3)}/${R.toFixed(3)}/${V}`:H=`#${L}/${D.toFixed(3)}/${R.toFixed(3)}`,window.history.replaceState(window.history.state,"",H)}))},[n]),[s,p]=G.useState([]),y=M=>B0.useCallback((I,D={enableFitBounds:!0})=>{if(s.forEach(V=>V.remove()),M(I),n==null||I==null)return;const R=ix(t.visibleStateDlcs),L=I.features.filter(V=>R.has(V.dlcGuard)).map(({coordinates:V})=>new aS.Marker().setLngLat(V).addTo(n.getMap()));if(p(L),L.length&&D.enableFitBounds){const V=gN(L.map(q=>q.getLngLat().toArray())),B=[V[0],V[1]],H=[V[2],V[3]];n.fitBounds([B,H],{curve:1,padding:100,maxZoom:9})}},[n,s,M,p,t.visibleStateDlcs]),[_,w]=G.useState(null),S=y(w);return G.useEffect(()=>{S(_,{enableFitBounds:!1})},[_,t.visibleStateDlcs]),ie.jsx("div",{ref:e,className:"maplibregl-ctrl",style:{width:"calc(100svw - 64px)",pointerEvents:"none"},children:ie.jsx(ca,{direction:"row",gap:1,sx:{pointerEvents:"auto",width:t.reserveRoomForSpecialEventButton?"calc(100% - 44px)":void 0},children:ie.jsx(nhe,{selected:r.value,onMapSelect:l,onPlaceSelect:c,onAchievementSelect:S,visibleStates:t.visibleStates,visibleStateDlcs:t.visibleStateDlcs})})})},nhe=({selected:t,onMapSelect:e,onPlaceSelect:n,onAchievementSelect:r,visibleStateDlcs:i})=>{switch(t.map){case"usa":switch(t.search){case"places":return ie.jsx(Ik,{selectDecorator:ie.jsx(x1,{selected:t,onSelect:e}),map:t.map,onSelect:n,visibleStateDlcs:i});case"achievements":return ie.jsx(Sk,{selectDecorator:ie.jsx(x1,{selected:t,onSelect:e}),map:t.map,onSelect:r,visibleStateDlcs:i});default:throw new Su(t.search)}case"europe":switch(t.search){case"places":return ie.jsx(Ik,{selectDecorator:ie.jsx(x1,{selected:t,onSelect:e}),map:t.map,onSelect:n});case"achievements":return ie.jsx(Sk,{selectDecorator:ie.jsx(x1,{selected:t,onSelect:e}),map:t.map,onSelect:r});default:throw new Su(t.search)}}};function rhe(t){return t==="achievements"?t:"places"}function q5(t,e){const n=Bb(t)/2,r=Bb(e)/2;return Math.abs(Math.sin(n)-Math.sin(r))}const ihe=t=>{const e=G.useRef(null);sl(()=>({onAdd:()=>mr(e.current),onRemove:()=>mr(e.current).remove()}));const n=G.useCallback(()=>{t.onToggle(!t.active)},[t.active]);return ie.jsx("div",{ref:e,className:"maplibregl-ctrl maplibregl-ctrl-group",style:{display:t.visible?"":"none"},children:ie.jsx(Ih,{slots:{root:Ih},sx:{minWidth:0,minHeight:0,borderRadius:0,backgroundColor:t.active?"var(--joy-palette-primary-softHoverBg) !important":void 0},variant:t.active?"soft":"plain",title:"Browse Street View images",onClick:n,children:ie.jsx($re,{})})})},qC=(t,e)=>{const n=Math.pow(10,e);return Math.round(t*n)/n},ohe=()=>{const t=G.useRef(null),[e,n]=G.useState(!1),[r,i]=G.useState(!1),[l,c]=G.useState(window.location.origin),s=ox();return sl(()=>({onAdd:()=>mr(t.current),onRemove:()=>mr(t.current).remove()})),G.useEffect(()=>{const p=s.current;if(!p||!e)return;const y=()=>{const S=p.getCenter(),M=p.getBearing(),I=p.getPitch(),D=M||I?[M,I]:[],R=p.getZoom(),L=_?"?"+new URLSearchParams({mlat:String(qC(_.getLngLat().lat,2)),mlon:String(qC(_.getLngLat().lng,2))}).toString():"",V="#"+[R,S.lat,S.lng,...D].map(B=>qC(B,2)).join("/");c(window.location.origin+L+V)};let _,w;if(r){_=new aS.Marker,_.setLngLat(p.getCenter()).setDraggable(!0).addTo(p.getMap());let S=!0;w=()=>S&&_.setLngLat(p.getCenter()),_.on("dragend",()=>{S=!1,p.easeTo({center:_?.getLngLat()}),p.once("moveend",()=>S=!0)})}return y(),p.on("moveend",y),w&&p.on("move",w),()=>{p.off("moveend",y),w&&p.off("move",w),_?.remove()}},[s,e,r]),ie.jsxs("div",{ref:t,children:[ie.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:ie.jsx(Ih,{sx:{minWidth:0,minHeight:0,borderRadius:0},title:"Share",onClick:()=>n(!e),children:ie.jsx(Ore,{})})}),ie.jsx(wF,{open:e,anchor:"right",onClose:()=>n(!1),variant:"plain",hideBackdrop:!0,slotProps:{root:{sx:{pointerEvents:"none"}},content:{sx:{bgcolor:"transparent",p:1,boxShadow:"none",right:e?48:0}}},children:ie.jsxs(EF,{variant:"outlined",sx:{pointerEvents:"auto",borderRadius:"md",p:2,display:"flex",flexDirection:"column",gap:2,overflow:"auto"},children:[ie.jsx(vF,{children:"Share"}),ie.jsx(CF,{}),ie.jsx(J_,{}),ie.jsxs(gF,{sx:{gap:2,overflow:"hidden",flexGrow:1,justifyContent:"center"},children:[ie.jsx(Ti,{children:"Share a link to this map"}),ie.jsx(Eq,{readOnly:!0,sx:{"--Input-decoratorChildHeight":"36px"},onFocus:p=>p.target.select(),value:l,endDecorator:ie.jsx(dF,{sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0},onClick:()=>void navigator.clipboard.writeText(l).catch(()=>alert("Could not copy to clipboard 🙁")),children:"Copy"})}),ie.jsx($m,{label:"Include marker",checked:r,onChange:p=>i(p.target.checked)})]})]})})]})},iI={halloween:{emoji:"🎃",mapName:"Brackenreach",url:"/brackenreach",centerLngLat:[-120.6266,18.5926],boundsDelta:.5,minZoom:10,mapStyle:hre},christmas:{emoji:"🎄",mapName:"Winterland",url:"/winterland",centerLngLat:[-123.075,13.5243],boundsDelta:1,minZoom:8,mapStyle:dre}},she=t=>{const{specialEvent:e}=t;if(e==null)return null;const n=G.useRef(null);sl(()=>({onAdd:()=>mr(n.current),onRemove:()=>mr(n.current).remove(),getDefaultPosition:()=>"top-left"}));const r=iI[e];return ie.jsx("div",{ref:n,style:{position:"absolute",top:0,right:0},children:ie.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:ie.jsx(SF,{component:"button",underline:"none",title:`Switch to ${r.mapName} Map`,justifyContent:"center",onClick:()=>window.location.href=r.url,sx:{fontSize:"1.75em"},children:ie.jsx(qw,{children:r.emoji})})})})};function XB(t){return new Set([...t].map(ahe).concat(fs.CA))}function ahe(t){switch(t){case Ts.Arizona:return fs.AZ;case Ts.Arkansas:return fs.AR;case Ts.Colorado:return fs.CO;case Ts.Idaho:return fs.ID;case Ts.Iowa:return fs.IA;case Ts.Kansas:return fs.KS;case Ts.Missouri:return fs.MO;case Ts.Montana:return fs.MT;case Ts.Nebraska:return fs.NE;case Ts.Nevada:return fs.NV;case Ts.NewMexico:return fs.NM;case Ts.Oklahoma:return fs.OK;case Ts.Oregon:return fs.OR;case Ts.Texas:return fs.TX;case Ts.Utah:return fs.UT;case Ts.Washington:return fs.WA;case Ts.Wyoming:return fs.WY;default:throw new Su(t)}}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const oI="175",lhe=0,X5=1,che=2,ZB=1,uhe=2,Fd=3,up=0,tl=1,Bd=2,Qf=0,Gv=1,Z5=2,Y5=3,K5=4,hhe=5,Im=100,dhe=101,fhe=102,phe=103,mhe=104,ghe=200,vhe=201,yhe=202,_he=203,_T=204,xT=205,xhe=206,bhe=207,whe=208,She=209,Mhe=210,Che=211,Ehe=212,The=213,Phe=214,bT=0,wT=1,ST=2,sy=3,MT=4,CT=5,ET=6,TT=7,YB=0,Ahe=1,Ihe=2,ep=0,KB=1,Rhe=2,Lhe=3,khe=4,Dhe=5,zhe=6,Ohe=7,JB=300,ay=301,ly=302,PT=303,AT=304,pS=306,IT=1e3,zm=1001,RT=1002,bu=1003,Fhe=1004,b1=1005,Vl=1006,XC=1007,Yf=1008,Zd=1009,QB=1010,e6=1011,A_=1012,sI=1013,Xm=1014,Ud=1015,vx=1016,aI=1017,lI=1018,I_=1020,t6=35902,n6=1021,r6=1022,_u=1023,i6=1024,o6=1025,R_=1026,L_=1027,s6=1028,cI=1029,a6=1030,uI=1031,hI=1033,pb=33776,mb=33777,gb=33778,vb=33779,LT=35840,kT=35841,DT=35842,zT=35843,OT=36196,FT=37492,NT=37496,BT=37808,UT=37809,$T=37810,VT=37811,jT=37812,HT=37813,GT=37814,WT=37815,qT=37816,XT=37817,ZT=37818,YT=37819,KT=37820,JT=37821,yb=36492,QT=36494,eP=36495,l6=36283,tP=36284,nP=36285,rP=36286,Nhe=3200,Bhe=3201,Uhe=0,$he=1,Xf="",Ec="srgb",Zm="srgb-linear",Qb="linear",Li="srgb",tv=7680,J5=519,Vhe=512,jhe=513,Hhe=514,c6=515,Ghe=516,Whe=517,qhe=518,Xhe=519,Q5=35044,ez="300 es",$d=2e3,ew=2001;class vy{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){const r=this._listeners;if(r===void 0)return;const i=r[e];if(i!==void 0){const l=i.indexOf(n);l!==-1&&i.splice(l,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const r=n[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let l=0,c=i.length;l<c;l++)i[l].call(this,e);e.target=null}}}const oa=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let tz=1234567;const J0=Math.PI/180,k_=180/Math.PI;function yy(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(oa[t&255]+oa[t>>8&255]+oa[t>>16&255]+oa[t>>24&255]+"-"+oa[e&255]+oa[e>>8&255]+"-"+oa[e>>16&15|64]+oa[e>>24&255]+"-"+oa[n&63|128]+oa[n>>8&255]+"-"+oa[n>>16&255]+oa[n>>24&255]+oa[r&255]+oa[r>>8&255]+oa[r>>16&255]+oa[r>>24&255]).toLowerCase()}function Qr(t,e,n){return Math.max(e,Math.min(n,t))}function dI(t,e){return(t%e+e)%e}function Zhe(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)}function Yhe(t,e,n){return t!==e?(n-t)/(e-t):0}function Q0(t,e,n){return(1-n)*t+n*e}function Khe(t,e,n,r){return Q0(t,e,1-Math.exp(-n*r))}function Jhe(t,e=1){return e-Math.abs(dI(t,e*2)-e)}function Qhe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function ede(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function tde(t,e){return t+Math.floor(Math.random()*(e-t+1))}function nde(t,e){return t+Math.random()*(e-t)}function rde(t){return t*(.5-Math.random())}function ide(t){t!==void 0&&(tz=t);let e=tz+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function ode(t){return t*J0}function sde(t){return t*k_}function ade(t){return(t&t-1)===0&&t!==0}function lde(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function cde(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function ude(t,e,n,r,i){const l=Math.cos,c=Math.sin,s=l(n/2),p=c(n/2),y=l((e+r)/2),_=c((e+r)/2),w=l((e-r)/2),S=c((e-r)/2),M=l((r-e)/2),I=c((r-e)/2);switch(i){case"XYX":t.set(s*_,p*w,p*S,s*y);break;case"YZY":t.set(p*S,s*_,p*w,s*y);break;case"ZXZ":t.set(p*w,p*S,s*_,s*y);break;case"XZX":t.set(s*_,p*I,p*M,s*y);break;case"YXY":t.set(p*M,s*_,p*I,s*y);break;case"ZYZ":t.set(p*I,p*M,s*_,s*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function bv(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Ma(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const Wr={DEG2RAD:J0,RAD2DEG:k_,generateUUID:yy,clamp:Qr,euclideanModulo:dI,mapLinear:Zhe,inverseLerp:Yhe,lerp:Q0,damp:Khe,pingpong:Jhe,smoothstep:Qhe,smootherstep:ede,randInt:tde,randFloat:nde,randFloatSpread:rde,seededRandom:ide,degToRad:ode,radToDeg:sde,isPowerOfTwo:ade,ceilPowerOfTwo:lde,floorPowerOfTwo:cde,setQuaternionFromProperEuler:ude,normalize:Ma,denormalize:bv};class gi{constructor(e=0,n=0){gi.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,i=e.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Qr(this.x,e.x,n.x),this.y=Qr(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Qr(this.x,e,n),this.y=Qr(this.y,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Qr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Qr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),i=Math.sin(n),l=this.x-e.x,c=this.y-e.y;return this.x=l*r-c*i+e.x,this.y=l*i+c*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class zr{constructor(e,n,r,i,l,c,s,p,y){zr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,i,l,c,s,p,y)}set(e,n,r,i,l,c,s,p,y){const _=this.elements;return _[0]=e,_[1]=i,_[2]=s,_[3]=n,_[4]=l,_[5]=p,_[6]=r,_[7]=c,_[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,l=this.elements,c=r[0],s=r[3],p=r[6],y=r[1],_=r[4],w=r[7],S=r[2],M=r[5],I=r[8],D=i[0],R=i[3],L=i[6],V=i[1],B=i[4],H=i[7],q=i[2],X=i[5],ee=i[8];return l[0]=c*D+s*V+p*q,l[3]=c*R+s*B+p*X,l[6]=c*L+s*H+p*ee,l[1]=y*D+_*V+w*q,l[4]=y*R+_*B+w*X,l[7]=y*L+_*H+w*ee,l[2]=S*D+M*V+I*q,l[5]=S*R+M*B+I*X,l[8]=S*L+M*H+I*ee,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],i=e[2],l=e[3],c=e[4],s=e[5],p=e[6],y=e[7],_=e[8];return n*c*_-n*s*y-r*l*_+r*s*p+i*l*y-i*c*p}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],l=e[3],c=e[4],s=e[5],p=e[6],y=e[7],_=e[8],w=_*c-s*y,S=s*p-_*l,M=y*l-c*p,I=n*w+r*S+i*M;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const D=1/I;return e[0]=w*D,e[1]=(i*y-_*r)*D,e[2]=(s*r-i*c)*D,e[3]=S*D,e[4]=(_*n-i*p)*D,e[5]=(i*l-s*n)*D,e[6]=M*D,e[7]=(r*p-y*n)*D,e[8]=(c*n-r*l)*D,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,i,l,c,s){const p=Math.cos(l),y=Math.sin(l);return this.set(r*p,r*y,-r*(p*c+y*s)+c+e,-i*y,i*p,-i*(-y*c+p*s)+s+n,0,0,1),this}scale(e,n){return this.premultiply(ZC.makeScale(e,n)),this}rotate(e){return this.premultiply(ZC.makeRotation(-e)),this}translate(e,n){return this.premultiply(ZC.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const ZC=new zr;function u6(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function tw(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function hde(){const t=tw("canvas");return t.style.display="block",t}const nz={};function _b(t){t in nz||(nz[t]=!0,console.warn(t))}function dde(t,e,n){return new Promise(function(r,i){function l(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:i();break;case t.TIMEOUT_EXPIRED:setTimeout(l,n);break;default:r()}}setTimeout(l,n)})}function fde(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function pde(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const rz=new zr().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),iz=new zr().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function mde(){const t={enabled:!0,workingColorSpace:Zm,spaces:{},convert:function(i,l,c){return this.enabled===!1||l===c||!l||!c||(this.spaces[l].transfer===Li&&(i.r=Vd(i.r),i.g=Vd(i.g),i.b=Vd(i.b)),this.spaces[l].primaries!==this.spaces[c].primaries&&(i.applyMatrix3(this.spaces[l].toXYZ),i.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===Li&&(i.r=Wv(i.r),i.g=Wv(i.g),i.b=Wv(i.b))),i},fromWorkingColorSpace:function(i,l){return this.convert(i,this.workingColorSpace,l)},toWorkingColorSpace:function(i,l){return this.convert(i,l,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Xf?Qb:this.spaces[i].transfer},getLuminanceCoefficients:function(i,l=this.workingColorSpace){return i.fromArray(this.spaces[l].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,l,c){return i.copy(this.spaces[l].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return t.define({[Zm]:{primaries:e,whitePoint:r,transfer:Qb,toXYZ:rz,fromXYZ:iz,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:Ec},outputColorSpaceConfig:{drawingBufferColorSpace:Ec}},[Ec]:{primaries:e,whitePoint:r,transfer:Li,toXYZ:rz,fromXYZ:iz,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:Ec}}}),t}const li=mde();function Vd(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Wv(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let nv;class gde{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{nv===void 0&&(nv=tw("canvas")),nv.width=e.width,nv.height=e.height;const i=nv.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=nv}return r.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=tw("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),l=i.data;for(let c=0;c<l.length;c++)l[c]=Vd(l[c]/255)*255;return r.putImageData(i,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(Vd(n[r]/255)*255):n[r]=Vd(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let vde=0;class fI{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:vde++}),this.uuid=yy(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let l;if(Array.isArray(i)){l=[];for(let c=0,s=i.length;c<s;c++)i[c].isDataTexture?l.push(YC(i[c].image)):l.push(YC(i[c]))}else l=YC(i);r.url=l}return n||(e.images[this.uuid]=r),r}}function YC(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?gde.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let yde=0;class Xs extends vy{constructor(e=Xs.DEFAULT_IMAGE,n=Xs.DEFAULT_MAPPING,r=zm,i=zm,l=Vl,c=Yf,s=_u,p=Zd,y=Xs.DEFAULT_ANISOTROPY,_=Xf){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:yde++}),this.uuid=yy(),this.name="",this.source=new fI(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=l,this.minFilter=c,this.anisotropy=y,this.format=s,this.internalFormat=null,this.type=p,this.offset=new gi(0,0),this.repeat=new gi(1,1),this.center=new gi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=_,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==JB)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case IT:e.x=e.x-Math.floor(e.x);break;case zm:e.x=e.x<0?0:1;break;case RT:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case IT:e.y=e.y-Math.floor(e.y);break;case zm:e.y=e.y<0?0:1;break;case RT:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Xs.DEFAULT_IMAGE=null;Xs.DEFAULT_MAPPING=JB;Xs.DEFAULT_ANISOTROPY=1;class Do{constructor(e=0,n=0,r=0,i=1){Do.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,i){return this.x=e,this.y=n,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,l=this.w,c=e.elements;return this.x=c[0]*n+c[4]*r+c[8]*i+c[12]*l,this.y=c[1]*n+c[5]*r+c[9]*i+c[13]*l,this.z=c[2]*n+c[6]*r+c[10]*i+c[14]*l,this.w=c[3]*n+c[7]*r+c[11]*i+c[15]*l,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,i,l;const p=e.elements,y=p[0],_=p[4],w=p[8],S=p[1],M=p[5],I=p[9],D=p[2],R=p[6],L=p[10];if(Math.abs(_-S)<.01&&Math.abs(w-D)<.01&&Math.abs(I-R)<.01){if(Math.abs(_+S)<.1&&Math.abs(w+D)<.1&&Math.abs(I+R)<.1&&Math.abs(y+M+L-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const B=(y+1)/2,H=(M+1)/2,q=(L+1)/2,X=(_+S)/4,ee=(w+D)/4,se=(I+R)/4;return B>H&&B>q?B<.01?(r=0,i=.707106781,l=.707106781):(r=Math.sqrt(B),i=X/r,l=ee/r):H>q?H<.01?(r=.707106781,i=0,l=.707106781):(i=Math.sqrt(H),r=X/i,l=se/i):q<.01?(r=.707106781,i=.707106781,l=0):(l=Math.sqrt(q),r=ee/l,i=se/l),this.set(r,i,l,n),this}let V=Math.sqrt((R-I)*(R-I)+(w-D)*(w-D)+(S-_)*(S-_));return Math.abs(V)<.001&&(V=1),this.x=(R-I)/V,this.y=(w-D)/V,this.z=(S-_)/V,this.w=Math.acos((y+M+L-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Qr(this.x,e.x,n.x),this.y=Qr(this.y,e.y,n.y),this.z=Qr(this.z,e.z,n.z),this.w=Qr(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Qr(this.x,e,n),this.y=Qr(this.y,e,n),this.z=Qr(this.z,e,n),this.w=Qr(this.w,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Qr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class _de extends vy{constructor(e=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Do(0,0,e,n),this.scissorTest=!1,this.viewport=new Do(0,0,e,n);const i={width:e,height:n,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Vl,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const l=new Xs(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);l.flipY=!1,l.generateMipmaps=r.generateMipmaps,l.internalFormat=r.internalFormat,this.textures=[];const c=r.count;for(let s=0;s<c;s++)this.textures[s]=l.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,r=1){if(this.width!==e||this.height!==n||this.depth!==r){this.width=e,this.height=n,this.depth=r;for(let i=0,l=this.textures.length;i<l;i++)this.textures[i].image.width=e,this.textures[i].image.height=n,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const i=Object.assign({},e.textures[n].image);this.textures[n].source=new fI(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class hp extends _de{constructor(e=1,n=1,r={}){super(e,n,r),this.isWebGLRenderTarget=!0}}class h6 extends Xs{constructor(e=null,n=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=bu,this.minFilter=bu,this.wrapR=zm,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class xde extends Xs{constructor(e=null,n=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=bu,this.minFilter=bu,this.wrapR=zm,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Sp{constructor(e=0,n=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}static slerpFlat(e,n,r,i,l,c,s){let p=r[i+0],y=r[i+1],_=r[i+2],w=r[i+3];const S=l[c+0],M=l[c+1],I=l[c+2],D=l[c+3];if(s===0){e[n+0]=p,e[n+1]=y,e[n+2]=_,e[n+3]=w;return}if(s===1){e[n+0]=S,e[n+1]=M,e[n+2]=I,e[n+3]=D;return}if(w!==D||p!==S||y!==M||_!==I){let R=1-s;const L=p*S+y*M+_*I+w*D,V=L>=0?1:-1,B=1-L*L;if(B>Number.EPSILON){const q=Math.sqrt(B),X=Math.atan2(q,L*V);R=Math.sin(R*X)/q,s=Math.sin(s*X)/q}const H=s*V;if(p=p*R+S*H,y=y*R+M*H,_=_*R+I*H,w=w*R+D*H,R===1-s){const q=1/Math.sqrt(p*p+y*y+_*_+w*w);p*=q,y*=q,_*=q,w*=q}}e[n]=p,e[n+1]=y,e[n+2]=_,e[n+3]=w}static multiplyQuaternionsFlat(e,n,r,i,l,c){const s=r[i],p=r[i+1],y=r[i+2],_=r[i+3],w=l[c],S=l[c+1],M=l[c+2],I=l[c+3];return e[n]=s*I+_*w+p*M-y*S,e[n+1]=p*I+_*S+y*w-s*M,e[n+2]=y*I+_*M+s*S-p*w,e[n+3]=_*I-s*w-p*S-y*M,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,i){return this._x=e,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,i=e._y,l=e._z,c=e._order,s=Math.cos,p=Math.sin,y=s(r/2),_=s(i/2),w=s(l/2),S=p(r/2),M=p(i/2),I=p(l/2);switch(c){case"XYZ":this._x=S*_*w+y*M*I,this._y=y*M*w-S*_*I,this._z=y*_*I+S*M*w,this._w=y*_*w-S*M*I;break;case"YXZ":this._x=S*_*w+y*M*I,this._y=y*M*w-S*_*I,this._z=y*_*I-S*M*w,this._w=y*_*w+S*M*I;break;case"ZXY":this._x=S*_*w-y*M*I,this._y=y*M*w+S*_*I,this._z=y*_*I+S*M*w,this._w=y*_*w-S*M*I;break;case"ZYX":this._x=S*_*w-y*M*I,this._y=y*M*w+S*_*I,this._z=y*_*I-S*M*w,this._w=y*_*w+S*M*I;break;case"YZX":this._x=S*_*w+y*M*I,this._y=y*M*w+S*_*I,this._z=y*_*I-S*M*w,this._w=y*_*w-S*M*I;break;case"XZY":this._x=S*_*w-y*M*I,this._y=y*M*w-S*_*I,this._z=y*_*I+S*M*w,this._w=y*_*w+S*M*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],i=n[4],l=n[8],c=n[1],s=n[5],p=n[9],y=n[2],_=n[6],w=n[10],S=r+s+w;if(S>0){const M=.5/Math.sqrt(S+1);this._w=.25/M,this._x=(_-p)*M,this._y=(l-y)*M,this._z=(c-i)*M}else if(r>s&&r>w){const M=2*Math.sqrt(1+r-s-w);this._w=(_-p)/M,this._x=.25*M,this._y=(i+c)/M,this._z=(l+y)/M}else if(s>w){const M=2*Math.sqrt(1+s-r-w);this._w=(l-y)/M,this._x=(i+c)/M,this._y=.25*M,this._z=(p+_)/M}else{const M=2*Math.sqrt(1+w-r-s);this._w=(c-i)/M,this._x=(l+y)/M,this._y=(p+_)/M,this._z=.25*M}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Qr(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,n/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,i=e._y,l=e._z,c=e._w,s=n._x,p=n._y,y=n._z,_=n._w;return this._x=r*_+c*s+i*y-l*p,this._y=i*_+c*p+l*s-r*y,this._z=l*_+c*y+r*p-i*s,this._w=c*_-r*s-i*p-l*y,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,i=this._y,l=this._z,c=this._w;let s=c*e._w+r*e._x+i*e._y+l*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=c,this._x=r,this._y=i,this._z=l,this;const p=1-s*s;if(p<=Number.EPSILON){const M=1-n;return this._w=M*c+n*this._w,this._x=M*r+n*this._x,this._y=M*i+n*this._y,this._z=M*l+n*this._z,this.normalize(),this}const y=Math.sqrt(p),_=Math.atan2(y,s),w=Math.sin((1-n)*_)/y,S=Math.sin(n*_)/y;return this._w=c*w+this._w*S,this._x=r*w+this._x*S,this._y=i*w+this._y*S,this._z=l*w+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),l=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),l*Math.sin(n),l*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class At{constructor(e=0,n=0,r=0){At.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(oz.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(oz.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,i=this.z,l=e.elements;return this.x=l[0]*n+l[3]*r+l[6]*i,this.y=l[1]*n+l[4]*r+l[7]*i,this.z=l[2]*n+l[5]*r+l[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,l=e.elements,c=1/(l[3]*n+l[7]*r+l[11]*i+l[15]);return this.x=(l[0]*n+l[4]*r+l[8]*i+l[12])*c,this.y=(l[1]*n+l[5]*r+l[9]*i+l[13])*c,this.z=(l[2]*n+l[6]*r+l[10]*i+l[14])*c,this}applyQuaternion(e){const n=this.x,r=this.y,i=this.z,l=e.x,c=e.y,s=e.z,p=e.w,y=2*(c*i-s*r),_=2*(s*n-l*i),w=2*(l*r-c*n);return this.x=n+p*y+c*w-s*_,this.y=r+p*_+s*y-l*w,this.z=i+p*w+l*_-c*y,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,i=this.z,l=e.elements;return this.x=l[0]*n+l[4]*r+l[8]*i,this.y=l[1]*n+l[5]*r+l[9]*i,this.z=l[2]*n+l[6]*r+l[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Qr(this.x,e.x,n.x),this.y=Qr(this.y,e.y,n.y),this.z=Qr(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Qr(this.x,e,n),this.y=Qr(this.y,e,n),this.z=Qr(this.z,e,n),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Qr(r,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,i=e.y,l=e.z,c=n.x,s=n.y,p=n.z;return this.x=i*p-l*s,this.y=l*c-r*p,this.z=r*s-i*c,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return KC.copy(this).projectOnVector(e),this.sub(KC)}reflect(e){return this.sub(KC.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(Qr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return n*n+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const i=Math.sin(n)*e;return this.x=i*Math.sin(r),this.y=Math.cos(n)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=i,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,r=Math.sqrt(1-n*n);return this.x=r*Math.cos(e),this.y=n,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const KC=new At,oz=new Sp;class _y{constructor(e=new At(1/0,1/0,1/0),n=new At(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(du.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(du.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=du.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const l=r.getAttribute("position");if(n===!0&&l!==void 0&&e.isInstancedMesh!==!0)for(let c=0,s=l.count;c<s;c++)e.isMesh===!0?e.getVertexPosition(c,du):du.fromBufferAttribute(l,c),du.applyMatrix4(e.matrixWorld),this.expandByPoint(du);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),w1.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),w1.copy(r.boundingBox)),w1.applyMatrix4(e.matrixWorld),this.union(w1)}const i=e.children;for(let l=0,c=i.length;l<c;l++)this.expandByObject(i[l],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,du),du.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(y0),S1.subVectors(this.max,y0),rv.subVectors(e.a,y0),iv.subVectors(e.b,y0),ov.subVectors(e.c,y0),Ff.subVectors(iv,rv),Nf.subVectors(ov,iv),ym.subVectors(rv,ov);let n=[0,-Ff.z,Ff.y,0,-Nf.z,Nf.y,0,-ym.z,ym.y,Ff.z,0,-Ff.x,Nf.z,0,-Nf.x,ym.z,0,-ym.x,-Ff.y,Ff.x,0,-Nf.y,Nf.x,0,-ym.y,ym.x,0];return!JC(n,rv,iv,ov,S1)||(n=[1,0,0,0,1,0,0,0,1],!JC(n,rv,iv,ov,S1))?!1:(M1.crossVectors(Ff,Nf),n=[M1.x,M1.y,M1.z],JC(n,rv,iv,ov,S1))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,du).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(du).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ld[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ld[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ld[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ld[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ld[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ld[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ld[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ld[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ld),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ld=[new At,new At,new At,new At,new At,new At,new At,new At],du=new At,w1=new _y,rv=new At,iv=new At,ov=new At,Ff=new At,Nf=new At,ym=new At,y0=new At,S1=new At,M1=new At,_m=new At;function JC(t,e,n,r,i){for(let l=0,c=t.length-3;l<=c;l+=3){_m.fromArray(t,l);const s=i.x*Math.abs(_m.x)+i.y*Math.abs(_m.y)+i.z*Math.abs(_m.z),p=e.dot(_m),y=n.dot(_m),_=r.dot(_m);if(Math.max(-Math.max(p,y,_),Math.min(p,y,_))>s)return!1}return!0}const bde=new _y,_0=new At,QC=new At;class mS{constructor(e=new At,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):bde.setFromPoints(e).getCenter(r);let i=0;for(let l=0,c=e.length;l<c;l++)i=Math.max(i,r.distanceToSquared(e[l]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_0.subVectors(e,this.center);const n=_0.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),i=(r-this.radius)*.5;this.center.addScaledVector(_0,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(QC.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_0.copy(e.center).add(QC)),this.expandByPoint(_0.copy(e.center).sub(QC))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const kd=new At,eE=new At,C1=new At,Bf=new At,tE=new At,E1=new At,nE=new At;class pI{constructor(e=new At,n=new At(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,kd)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=kd.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(kd.copy(this.origin).addScaledVector(this.direction,n),kd.distanceToSquared(e))}distanceSqToSegment(e,n,r,i){eE.copy(e).add(n).multiplyScalar(.5),C1.copy(n).sub(e).normalize(),Bf.copy(this.origin).sub(eE);const l=e.distanceTo(n)*.5,c=-this.direction.dot(C1),s=Bf.dot(this.direction),p=-Bf.dot(C1),y=Bf.lengthSq(),_=Math.abs(1-c*c);let w,S,M,I;if(_>0)if(w=c*p-s,S=c*s-p,I=l*_,w>=0)if(S>=-I)if(S<=I){const D=1/_;w*=D,S*=D,M=w*(w+c*S+2*s)+S*(c*w+S+2*p)+y}else S=l,w=Math.max(0,-(c*S+s)),M=-w*w+S*(S+2*p)+y;else S=-l,w=Math.max(0,-(c*S+s)),M=-w*w+S*(S+2*p)+y;else S<=-I?(w=Math.max(0,-(-c*l+s)),S=w>0?-l:Math.min(Math.max(-l,-p),l),M=-w*w+S*(S+2*p)+y):S<=I?(w=0,S=Math.min(Math.max(-l,-p),l),M=S*(S+2*p)+y):(w=Math.max(0,-(c*l+s)),S=w>0?l:Math.min(Math.max(-l,-p),l),M=-w*w+S*(S+2*p)+y);else S=c>0?-l:l,w=Math.max(0,-(c*S+s)),M=-w*w+S*(S+2*p)+y;return r&&r.copy(this.origin).addScaledVector(this.direction,w),i&&i.copy(eE).addScaledVector(C1,S),M}intersectSphere(e,n){kd.subVectors(e.center,this.origin);const r=kd.dot(this.direction),i=kd.dot(kd)-r*r,l=e.radius*e.radius;if(i>l)return null;const c=Math.sqrt(l-i),s=r-c,p=r+c;return p<0?null:s<0?this.at(p,n):this.at(s,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,i,l,c,s,p;const y=1/this.direction.x,_=1/this.direction.y,w=1/this.direction.z,S=this.origin;return y>=0?(r=(e.min.x-S.x)*y,i=(e.max.x-S.x)*y):(r=(e.max.x-S.x)*y,i=(e.min.x-S.x)*y),_>=0?(l=(e.min.y-S.y)*_,c=(e.max.y-S.y)*_):(l=(e.max.y-S.y)*_,c=(e.min.y-S.y)*_),r>c||l>i||((l>r||isNaN(r))&&(r=l),(c<i||isNaN(i))&&(i=c),w>=0?(s=(e.min.z-S.z)*w,p=(e.max.z-S.z)*w):(s=(e.max.z-S.z)*w,p=(e.min.z-S.z)*w),r>p||s>i)||((s>r||r!==r)&&(r=s),(p<i||i!==i)&&(i=p),i<0)?null:this.at(r>=0?r:i,n)}intersectsBox(e){return this.intersectBox(e,kd)!==null}intersectTriangle(e,n,r,i,l){tE.subVectors(n,e),E1.subVectors(r,e),nE.crossVectors(tE,E1);let c=this.direction.dot(nE),s;if(c>0){if(i)return null;s=1}else if(c<0)s=-1,c=-c;else return null;Bf.subVectors(this.origin,e);const p=s*this.direction.dot(E1.crossVectors(Bf,E1));if(p<0)return null;const y=s*this.direction.dot(tE.cross(Bf));if(y<0||p+y>c)return null;const _=-s*Bf.dot(nE);return _<0?null:this.at(_/c,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Pi{constructor(e,n,r,i,l,c,s,p,y,_,w,S,M,I,D,R){Pi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,i,l,c,s,p,y,_,w,S,M,I,D,R)}set(e,n,r,i,l,c,s,p,y,_,w,S,M,I,D,R){const L=this.elements;return L[0]=e,L[4]=n,L[8]=r,L[12]=i,L[1]=l,L[5]=c,L[9]=s,L[13]=p,L[2]=y,L[6]=_,L[10]=w,L[14]=S,L[3]=M,L[7]=I,L[11]=D,L[15]=R,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Pi().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,i=1/sv.setFromMatrixColumn(e,0).length(),l=1/sv.setFromMatrixColumn(e,1).length(),c=1/sv.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*l,n[5]=r[5]*l,n[6]=r[6]*l,n[7]=0,n[8]=r[8]*c,n[9]=r[9]*c,n[10]=r[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,i=e.y,l=e.z,c=Math.cos(r),s=Math.sin(r),p=Math.cos(i),y=Math.sin(i),_=Math.cos(l),w=Math.sin(l);if(e.order==="XYZ"){const S=c*_,M=c*w,I=s*_,D=s*w;n[0]=p*_,n[4]=-p*w,n[8]=y,n[1]=M+I*y,n[5]=S-D*y,n[9]=-s*p,n[2]=D-S*y,n[6]=I+M*y,n[10]=c*p}else if(e.order==="YXZ"){const S=p*_,M=p*w,I=y*_,D=y*w;n[0]=S+D*s,n[4]=I*s-M,n[8]=c*y,n[1]=c*w,n[5]=c*_,n[9]=-s,n[2]=M*s-I,n[6]=D+S*s,n[10]=c*p}else if(e.order==="ZXY"){const S=p*_,M=p*w,I=y*_,D=y*w;n[0]=S-D*s,n[4]=-c*w,n[8]=I+M*s,n[1]=M+I*s,n[5]=c*_,n[9]=D-S*s,n[2]=-c*y,n[6]=s,n[10]=c*p}else if(e.order==="ZYX"){const S=c*_,M=c*w,I=s*_,D=s*w;n[0]=p*_,n[4]=I*y-M,n[8]=S*y+D,n[1]=p*w,n[5]=D*y+S,n[9]=M*y-I,n[2]=-y,n[6]=s*p,n[10]=c*p}else if(e.order==="YZX"){const S=c*p,M=c*y,I=s*p,D=s*y;n[0]=p*_,n[4]=D-S*w,n[8]=I*w+M,n[1]=w,n[5]=c*_,n[9]=-s*_,n[2]=-y*_,n[6]=M*w+I,n[10]=S-D*w}else if(e.order==="XZY"){const S=c*p,M=c*y,I=s*p,D=s*y;n[0]=p*_,n[4]=-w,n[8]=y*_,n[1]=S*w+D,n[5]=c*_,n[9]=M*w-I,n[2]=I*w-M,n[6]=s*_,n[10]=D*w+S}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(wde,e,Sde)}lookAt(e,n,r){const i=this.elements;return Rl.subVectors(e,n),Rl.lengthSq()===0&&(Rl.z=1),Rl.normalize(),Uf.crossVectors(r,Rl),Uf.lengthSq()===0&&(Math.abs(r.z)===1?Rl.x+=1e-4:Rl.z+=1e-4,Rl.normalize(),Uf.crossVectors(r,Rl)),Uf.normalize(),T1.crossVectors(Rl,Uf),i[0]=Uf.x,i[4]=T1.x,i[8]=Rl.x,i[1]=Uf.y,i[5]=T1.y,i[9]=Rl.y,i[2]=Uf.z,i[6]=T1.z,i[10]=Rl.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,l=this.elements,c=r[0],s=r[4],p=r[8],y=r[12],_=r[1],w=r[5],S=r[9],M=r[13],I=r[2],D=r[6],R=r[10],L=r[14],V=r[3],B=r[7],H=r[11],q=r[15],X=i[0],ee=i[4],se=i[8],J=i[12],$=i[1],le=i[5],Ce=i[9],we=i[13],We=i[2],Fe=i[6],Me=i[10],Ee=i[14],Te=i[3],Ze=i[7],rt=i[11],Re=i[15];return l[0]=c*X+s*$+p*We+y*Te,l[4]=c*ee+s*le+p*Fe+y*Ze,l[8]=c*se+s*Ce+p*Me+y*rt,l[12]=c*J+s*we+p*Ee+y*Re,l[1]=_*X+w*$+S*We+M*Te,l[5]=_*ee+w*le+S*Fe+M*Ze,l[9]=_*se+w*Ce+S*Me+M*rt,l[13]=_*J+w*we+S*Ee+M*Re,l[2]=I*X+D*$+R*We+L*Te,l[6]=I*ee+D*le+R*Fe+L*Ze,l[10]=I*se+D*Ce+R*Me+L*rt,l[14]=I*J+D*we+R*Ee+L*Re,l[3]=V*X+B*$+H*We+q*Te,l[7]=V*ee+B*le+H*Fe+q*Ze,l[11]=V*se+B*Ce+H*Me+q*rt,l[15]=V*J+B*we+H*Ee+q*Re,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],i=e[8],l=e[12],c=e[1],s=e[5],p=e[9],y=e[13],_=e[2],w=e[6],S=e[10],M=e[14],I=e[3],D=e[7],R=e[11],L=e[15];return I*(+l*p*w-i*y*w-l*s*S+r*y*S+i*s*M-r*p*M)+D*(+n*p*M-n*y*S+l*c*S-i*c*M+i*y*_-l*p*_)+R*(+n*y*w-n*s*M-l*c*w+r*c*M+l*s*_-r*y*_)+L*(-i*s*_-n*p*w+n*s*S+i*c*w-r*c*S+r*p*_)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=n,i[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],l=e[3],c=e[4],s=e[5],p=e[6],y=e[7],_=e[8],w=e[9],S=e[10],M=e[11],I=e[12],D=e[13],R=e[14],L=e[15],V=w*R*y-D*S*y+D*p*M-s*R*M-w*p*L+s*S*L,B=I*S*y-_*R*y-I*p*M+c*R*M+_*p*L-c*S*L,H=_*D*y-I*w*y+I*s*M-c*D*M-_*s*L+c*w*L,q=I*w*p-_*D*p-I*s*S+c*D*S+_*s*R-c*w*R,X=n*V+r*B+i*H+l*q;if(X===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ee=1/X;return e[0]=V*ee,e[1]=(D*S*l-w*R*l-D*i*M+r*R*M+w*i*L-r*S*L)*ee,e[2]=(s*R*l-D*p*l+D*i*y-r*R*y-s*i*L+r*p*L)*ee,e[3]=(w*p*l-s*S*l-w*i*y+r*S*y+s*i*M-r*p*M)*ee,e[4]=B*ee,e[5]=(_*R*l-I*S*l+I*i*M-n*R*M-_*i*L+n*S*L)*ee,e[6]=(I*p*l-c*R*l-I*i*y+n*R*y+c*i*L-n*p*L)*ee,e[7]=(c*S*l-_*p*l+_*i*y-n*S*y-c*i*M+n*p*M)*ee,e[8]=H*ee,e[9]=(I*w*l-_*D*l-I*r*M+n*D*M+_*r*L-n*w*L)*ee,e[10]=(c*D*l-I*s*l+I*r*y-n*D*y-c*r*L+n*s*L)*ee,e[11]=(_*s*l-c*w*l-_*r*y+n*w*y+c*r*M-n*s*M)*ee,e[12]=q*ee,e[13]=(_*D*i-I*w*i+I*r*S-n*D*S-_*r*R+n*w*R)*ee,e[14]=(I*s*i-c*D*i-I*r*p+n*D*p+c*r*R-n*s*R)*ee,e[15]=(c*w*i-_*s*i+_*r*p-n*w*p-c*r*S+n*s*S)*ee,this}scale(e){const n=this.elements,r=e.x,i=e.y,l=e.z;return n[0]*=r,n[4]*=i,n[8]*=l,n[1]*=r,n[5]*=i,n[9]*=l,n[2]*=r,n[6]*=i,n[10]*=l,n[3]*=r,n[7]*=i,n[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,i))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),i=Math.sin(n),l=1-r,c=e.x,s=e.y,p=e.z,y=l*c,_=l*s;return this.set(y*c+r,y*s-i*p,y*p+i*s,0,y*s+i*p,_*s+r,_*p-i*c,0,y*p-i*s,_*p+i*c,l*p*p+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,i,l,c){return this.set(1,r,l,0,e,1,c,0,n,i,1,0,0,0,0,1),this}compose(e,n,r){const i=this.elements,l=n._x,c=n._y,s=n._z,p=n._w,y=l+l,_=c+c,w=s+s,S=l*y,M=l*_,I=l*w,D=c*_,R=c*w,L=s*w,V=p*y,B=p*_,H=p*w,q=r.x,X=r.y,ee=r.z;return i[0]=(1-(D+L))*q,i[1]=(M+H)*q,i[2]=(I-B)*q,i[3]=0,i[4]=(M-H)*X,i[5]=(1-(S+L))*X,i[6]=(R+V)*X,i[7]=0,i[8]=(I+B)*ee,i[9]=(R-V)*ee,i[10]=(1-(S+D))*ee,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,n,r){const i=this.elements;let l=sv.set(i[0],i[1],i[2]).length();const c=sv.set(i[4],i[5],i[6]).length(),s=sv.set(i[8],i[9],i[10]).length();this.determinant()<0&&(l=-l),e.x=i[12],e.y=i[13],e.z=i[14],fu.copy(this);const y=1/l,_=1/c,w=1/s;return fu.elements[0]*=y,fu.elements[1]*=y,fu.elements[2]*=y,fu.elements[4]*=_,fu.elements[5]*=_,fu.elements[6]*=_,fu.elements[8]*=w,fu.elements[9]*=w,fu.elements[10]*=w,n.setFromRotationMatrix(fu),r.x=l,r.y=c,r.z=s,this}makePerspective(e,n,r,i,l,c,s=$d){const p=this.elements,y=2*l/(n-e),_=2*l/(r-i),w=(n+e)/(n-e),S=(r+i)/(r-i);let M,I;if(s===$d)M=-(c+l)/(c-l),I=-2*c*l/(c-l);else if(s===ew)M=-c/(c-l),I=-c*l/(c-l);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return p[0]=y,p[4]=0,p[8]=w,p[12]=0,p[1]=0,p[5]=_,p[9]=S,p[13]=0,p[2]=0,p[6]=0,p[10]=M,p[14]=I,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,n,r,i,l,c,s=$d){const p=this.elements,y=1/(n-e),_=1/(r-i),w=1/(c-l),S=(n+e)*y,M=(r+i)*_;let I,D;if(s===$d)I=(c+l)*w,D=-2*w;else if(s===ew)I=l*w,D=-1*w;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return p[0]=2*y,p[4]=0,p[8]=0,p[12]=-S,p[1]=0,p[5]=2*_,p[9]=0,p[13]=-M,p[2]=0,p[6]=0,p[10]=D,p[14]=-I,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const sv=new At,fu=new Pi,wde=new At(0,0,0),Sde=new At(1,1,1),Uf=new At,T1=new At,Rl=new At,sz=new Pi,az=new Sp;class Lh{constructor(e=0,n=0,r=0,i=Lh.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,i=this._order){return this._x=e,this._y=n,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const i=e.elements,l=i[0],c=i[4],s=i[8],p=i[1],y=i[5],_=i[9],w=i[2],S=i[6],M=i[10];switch(n){case"XYZ":this._y=Math.asin(Qr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-_,M),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(S,y),this._z=0);break;case"YXZ":this._x=Math.asin(-Qr(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(s,M),this._z=Math.atan2(p,y)):(this._y=Math.atan2(-w,l),this._z=0);break;case"ZXY":this._x=Math.asin(Qr(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-w,M),this._z=Math.atan2(-c,y)):(this._y=0,this._z=Math.atan2(p,l));break;case"ZYX":this._y=Math.asin(-Qr(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(S,M),this._z=Math.atan2(p,l)):(this._x=0,this._z=Math.atan2(-c,y));break;case"YZX":this._z=Math.asin(Qr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-_,y),this._y=Math.atan2(-w,l)):(this._x=0,this._y=Math.atan2(s,M));break;case"XZY":this._z=Math.asin(-Qr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(S,y),this._y=Math.atan2(s,l)):(this._x=Math.atan2(-_,M),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return sz.makeRotationFromQuaternion(e),this.setFromRotationMatrix(sz,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return az.setFromEuler(this),this.setFromQuaternion(az,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Lh.DEFAULT_ORDER="XYZ";class mI{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Mde=0;const lz=new At,av=new Sp,Dd=new Pi,P1=new At,x0=new At,Cde=new At,Ede=new Sp,cz=new At(1,0,0),uz=new At(0,1,0),hz=new At(0,0,1),dz={type:"added"},Tde={type:"removed"},lv={type:"childadded",child:null},rE={type:"childremoved",child:null};class Zs extends vy{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Mde++}),this.uuid=yy(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zs.DEFAULT_UP.clone();const e=new At,n=new Lh,r=new Sp,i=new At(1,1,1);function l(){r.setFromEuler(n,!1)}function c(){n.setFromQuaternion(r,void 0,!1)}n._onChange(l),r._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Pi},normalMatrix:{value:new zr}}),this.matrix=new Pi,this.matrixWorld=new Pi,this.matrixAutoUpdate=Zs.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Zs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new mI,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return av.setFromAxisAngle(e,n),this.quaternion.multiply(av),this}rotateOnWorldAxis(e,n){return av.setFromAxisAngle(e,n),this.quaternion.premultiply(av),this}rotateX(e){return this.rotateOnAxis(cz,e)}rotateY(e){return this.rotateOnAxis(uz,e)}rotateZ(e){return this.rotateOnAxis(hz,e)}translateOnAxis(e,n){return lz.copy(e).applyQuaternion(this.quaternion),this.position.add(lz.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(cz,e)}translateY(e){return this.translateOnAxis(uz,e)}translateZ(e){return this.translateOnAxis(hz,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Dd.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?P1.copy(e):P1.set(e,n,r);const i=this.parent;this.updateWorldMatrix(!0,!1),x0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Dd.lookAt(x0,P1,this.up):Dd.lookAt(P1,x0,this.up),this.quaternion.setFromRotationMatrix(Dd),i&&(Dd.extractRotation(i.matrixWorld),av.setFromRotationMatrix(Dd),this.quaternion.premultiply(av.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(dz),lv.child=e,this.dispatchEvent(lv),lv.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Tde),rE.child=e,this.dispatchEvent(rE),rE.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Dd.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Dd.multiply(e.parent.matrixWorld)),e.applyMatrix4(Dd),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(dz),lv.child=e,this.dispatchEvent(lv),lv.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,i=this.children.length;r<i;r++){const c=this.children[r].getObjectByProperty(e,n);if(c!==void 0)return c}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const i=this.children;for(let l=0,c=i.length;l<c;l++)i[l].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(x0,e,Cde),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(x0,Ede,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].updateMatrixWorld(e)}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const i=this.children;for(let l=0,c=i.length;l<c;l++)i[l].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function l(s,p){return s[p.uuid]===void 0&&(s[p.uuid]=p.toJSON(e)),p.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=l(e.geometries,this.geometry);const s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){const p=s.shapes;if(Array.isArray(p))for(let y=0,_=p.length;y<_;y++){const w=p[y];l(e.shapes,w)}else l(e.shapes,p)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const s=[];for(let p=0,y=this.material.length;p<y;p++)s.push(l(e.materials,this.material[p]));i.material=s}else i.material=l(e.materials,this.material);if(this.children.length>0){i.children=[];for(let s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let s=0;s<this.animations.length;s++){const p=this.animations[s];i.animations.push(l(e.animations,p))}}if(n){const s=c(e.geometries),p=c(e.materials),y=c(e.textures),_=c(e.images),w=c(e.shapes),S=c(e.skeletons),M=c(e.animations),I=c(e.nodes);s.length>0&&(r.geometries=s),p.length>0&&(r.materials=p),y.length>0&&(r.textures=y),_.length>0&&(r.images=_),w.length>0&&(r.shapes=w),S.length>0&&(r.skeletons=S),M.length>0&&(r.animations=M),I.length>0&&(r.nodes=I)}return r.object=i,r;function c(s){const p=[];for(const y in s){const _=s[y];delete _.metadata,p.push(_)}return p}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Zs.DEFAULT_UP=new At(0,1,0);Zs.DEFAULT_MATRIX_AUTO_UPDATE=!0;Zs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const pu=new At,zd=new At,iE=new At,Od=new At,cv=new At,uv=new At,fz=new At,oE=new At,sE=new At,aE=new At,lE=new Do,cE=new Do,uE=new Do;class vu{constructor(e=new At,n=new At,r=new At){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,i){i.subVectors(r,n),pu.subVectors(e,n),i.cross(pu);const l=i.lengthSq();return l>0?i.multiplyScalar(1/Math.sqrt(l)):i.set(0,0,0)}static getBarycoord(e,n,r,i,l){pu.subVectors(i,n),zd.subVectors(r,n),iE.subVectors(e,n);const c=pu.dot(pu),s=pu.dot(zd),p=pu.dot(iE),y=zd.dot(zd),_=zd.dot(iE),w=c*y-s*s;if(w===0)return l.set(0,0,0),null;const S=1/w,M=(y*p-s*_)*S,I=(c*_-s*p)*S;return l.set(1-M-I,I,M)}static containsPoint(e,n,r,i){return this.getBarycoord(e,n,r,i,Od)===null?!1:Od.x>=0&&Od.y>=0&&Od.x+Od.y<=1}static getInterpolation(e,n,r,i,l,c,s,p){return this.getBarycoord(e,n,r,i,Od)===null?(p.x=0,p.y=0,"z"in p&&(p.z=0),"w"in p&&(p.w=0),null):(p.setScalar(0),p.addScaledVector(l,Od.x),p.addScaledVector(c,Od.y),p.addScaledVector(s,Od.z),p)}static getInterpolatedAttribute(e,n,r,i,l,c){return lE.setScalar(0),cE.setScalar(0),uE.setScalar(0),lE.fromBufferAttribute(e,n),cE.fromBufferAttribute(e,r),uE.fromBufferAttribute(e,i),c.setScalar(0),c.addScaledVector(lE,l.x),c.addScaledVector(cE,l.y),c.addScaledVector(uE,l.z),c}static isFrontFacing(e,n,r,i){return pu.subVectors(r,n),zd.subVectors(e,n),pu.cross(zd).dot(i)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,i){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,n,r,i){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return pu.subVectors(this.c,this.b),zd.subVectors(this.a,this.b),pu.cross(zd).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return vu.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return vu.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,r,i,l){return vu.getInterpolation(e,this.a,this.b,this.c,n,r,i,l)}containsPoint(e){return vu.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return vu.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,i=this.b,l=this.c;let c,s;cv.subVectors(i,r),uv.subVectors(l,r),oE.subVectors(e,r);const p=cv.dot(oE),y=uv.dot(oE);if(p<=0&&y<=0)return n.copy(r);sE.subVectors(e,i);const _=cv.dot(sE),w=uv.dot(sE);if(_>=0&&w<=_)return n.copy(i);const S=p*w-_*y;if(S<=0&&p>=0&&_<=0)return c=p/(p-_),n.copy(r).addScaledVector(cv,c);aE.subVectors(e,l);const M=cv.dot(aE),I=uv.dot(aE);if(I>=0&&M<=I)return n.copy(l);const D=M*y-p*I;if(D<=0&&y>=0&&I<=0)return s=y/(y-I),n.copy(r).addScaledVector(uv,s);const R=_*I-M*w;if(R<=0&&w-_>=0&&M-I>=0)return fz.subVectors(l,i),s=(w-_)/(w-_+(M-I)),n.copy(i).addScaledVector(fz,s);const L=1/(R+D+S);return c=D*L,s=S*L,n.copy(r).addScaledVector(cv,c).addScaledVector(uv,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const d6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$f={h:0,s:0,l:0},A1={h:0,s:0,l:0};function hE(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}let bi=class{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Ec){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,li.toWorkingColorSpace(this,n),this}setRGB(e,n,r,i=li.workingColorSpace){return this.r=e,this.g=n,this.b=r,li.toWorkingColorSpace(this,i),this}setHSL(e,n,r,i=li.workingColorSpace){if(e=dI(e,1),n=Qr(n,0,1),r=Qr(r,0,1),n===0)this.r=this.g=this.b=r;else{const l=r<=.5?r*(1+n):r+n-r*n,c=2*r-l;this.r=hE(c,l,e+1/3),this.g=hE(c,l,e),this.b=hE(c,l,e-1/3)}return li.toWorkingColorSpace(this,i),this}setStyle(e,n=Ec){function r(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const c=i[1],s=i[2];switch(c){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,n);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,n);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=i[1],c=l.length;if(c===3)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,n);if(c===6)return this.setHex(parseInt(l,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Ec){const r=d6[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Vd(e.r),this.g=Vd(e.g),this.b=Vd(e.b),this}copyLinearToSRGB(e){return this.r=Wv(e.r),this.g=Wv(e.g),this.b=Wv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ec){return li.fromWorkingColorSpace(sa.copy(this),e),Math.round(Qr(sa.r*255,0,255))*65536+Math.round(Qr(sa.g*255,0,255))*256+Math.round(Qr(sa.b*255,0,255))}getHexString(e=Ec){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=li.workingColorSpace){li.fromWorkingColorSpace(sa.copy(this),n);const r=sa.r,i=sa.g,l=sa.b,c=Math.max(r,i,l),s=Math.min(r,i,l);let p,y;const _=(s+c)/2;if(s===c)p=0,y=0;else{const w=c-s;switch(y=_<=.5?w/(c+s):w/(2-c-s),c){case r:p=(i-l)/w+(i<l?6:0);break;case i:p=(l-r)/w+2;break;case l:p=(r-i)/w+4;break}p/=6}return e.h=p,e.s=y,e.l=_,e}getRGB(e,n=li.workingColorSpace){return li.fromWorkingColorSpace(sa.copy(this),n),e.r=sa.r,e.g=sa.g,e.b=sa.b,e}getStyle(e=Ec){li.fromWorkingColorSpace(sa.copy(this),e);const n=sa.r,r=sa.g,i=sa.b;return e!==Ec?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,n,r){return this.getHSL($f),this.setHSL($f.h+e,$f.s+n,$f.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL($f),e.getHSL(A1);const r=Q0($f.h,A1.h,n),i=Q0($f.s,A1.s,n),l=Q0($f.l,A1.l,n);return this.setHSL(r,i,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,i=this.b,l=e.elements;return this.r=l[0]*n+l[3]*r+l[6]*i,this.g=l[1]*n+l[4]*r+l[7]*i,this.b=l[2]*n+l[5]*r+l[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const sa=new bi;bi.NAMES=d6;let Pde=0;class yx extends vy{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Pde++}),this.uuid=yy(),this.name="",this.type="Material",this.blending=Gv,this.side=up,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=_T,this.blendDst=xT,this.blendEquation=Im,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new bi(0,0,0),this.blendAlpha=0,this.depthFunc=sy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=J5,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=tv,this.stencilZFail=tv,this.stencilZPass=tv,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const i=this[n];if(i===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Gv&&(r.blending=this.blending),this.side!==up&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==_T&&(r.blendSrc=this.blendSrc),this.blendDst!==xT&&(r.blendDst=this.blendDst),this.blendEquation!==Im&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==sy&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==J5&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==tv&&(r.stencilFail=this.stencilFail),this.stencilZFail!==tv&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==tv&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(l){const c=[];for(const s in l){const p=l[s];delete p.metadata,c.push(p)}return c}if(n){const l=i(e.textures),c=i(e.images);l.length>0&&(r.textures=l),c.length>0&&(r.images=c)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const i=n.length;r=new Array(i);for(let l=0;l!==i;++l)r[l]=n[l].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class dp extends yx{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new bi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Lh,this.combine=YB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Zo=new At,I1=new gi;let Ade=0;class Ph{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Ade++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=Q5,this.updateRanges=[],this.gpuType=Ud,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let i=0,l=this.itemSize;i<l;i++)this.array[e+i]=n.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)I1.fromBufferAttribute(this,n),I1.applyMatrix3(e),this.setXY(n,I1.x,I1.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)Zo.fromBufferAttribute(this,n),Zo.applyMatrix3(e),this.setXYZ(n,Zo.x,Zo.y,Zo.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)Zo.fromBufferAttribute(this,n),Zo.applyMatrix4(e),this.setXYZ(n,Zo.x,Zo.y,Zo.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Zo.fromBufferAttribute(this,n),Zo.applyNormalMatrix(e),this.setXYZ(n,Zo.x,Zo.y,Zo.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Zo.fromBufferAttribute(this,n),Zo.transformDirection(e),this.setXYZ(n,Zo.x,Zo.y,Zo.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=bv(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=Ma(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=bv(n,this.array)),n}setX(e,n){return this.normalized&&(n=Ma(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=bv(n,this.array)),n}setY(e,n){return this.normalized&&(n=Ma(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=bv(n,this.array)),n}setZ(e,n){return this.normalized&&(n=Ma(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=bv(n,this.array)),n}setW(e,n){return this.normalized&&(n=Ma(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=Ma(n,this.array),r=Ma(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,i){return e*=this.itemSize,this.normalized&&(n=Ma(n,this.array),r=Ma(r,this.array),i=Ma(i,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,n,r,i,l){return e*=this.itemSize,this.normalized&&(n=Ma(n,this.array),r=Ma(r,this.array),i=Ma(i,this.array),l=Ma(l,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Q5&&(e.usage=this.usage),e}}class f6 extends Ph{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class p6 extends Ph{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class ql extends Ph{constructor(e,n,r){super(new Float32Array(e),n,r)}}let Ide=0;const wc=new Pi,dE=new Zs,hv=new At,Ll=new _y,b0=new _y,Es=new At;class zh extends vy{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ide++}),this.uuid=yy(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(u6(e)?p6:f6)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const l=new zr().getNormalMatrix(e);r.applyNormalMatrix(l),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return wc.makeRotationFromQuaternion(e),this.applyMatrix4(wc),this}rotateX(e){return wc.makeRotationX(e),this.applyMatrix4(wc),this}rotateY(e){return wc.makeRotationY(e),this.applyMatrix4(wc),this}rotateZ(e){return wc.makeRotationZ(e),this.applyMatrix4(wc),this}translate(e,n,r){return wc.makeTranslation(e,n,r),this.applyMatrix4(wc),this}scale(e,n,r){return wc.makeScale(e,n,r),this.applyMatrix4(wc),this}lookAt(e){return dE.lookAt(e),dE.updateMatrix(),this.applyMatrix4(dE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(hv).negate(),this.translate(hv.x,hv.y,hv.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const r=[];for(let i=0,l=e.length;i<l;i++){const c=e[i];r.push(c.x,c.y,c.z||0)}this.setAttribute("position",new ql(r,3))}else{const r=Math.min(e.length,n.count);for(let i=0;i<r;i++){const l=e[i];n.setXYZ(i,l.x,l.y,l.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new _y);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new At(-1/0,-1/0,-1/0),new At(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,i=n.length;r<i;r++){const l=n[r];Ll.setFromBufferAttribute(l),this.morphTargetsRelative?(Es.addVectors(this.boundingBox.min,Ll.min),this.boundingBox.expandByPoint(Es),Es.addVectors(this.boundingBox.max,Ll.max),this.boundingBox.expandByPoint(Es)):(this.boundingBox.expandByPoint(Ll.min),this.boundingBox.expandByPoint(Ll.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new mS);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new At,1/0);return}if(e){const r=this.boundingSphere.center;if(Ll.setFromBufferAttribute(e),n)for(let l=0,c=n.length;l<c;l++){const s=n[l];b0.setFromBufferAttribute(s),this.morphTargetsRelative?(Es.addVectors(Ll.min,b0.min),Ll.expandByPoint(Es),Es.addVectors(Ll.max,b0.max),Ll.expandByPoint(Es)):(Ll.expandByPoint(b0.min),Ll.expandByPoint(b0.max))}Ll.getCenter(r);let i=0;for(let l=0,c=e.count;l<c;l++)Es.fromBufferAttribute(e,l),i=Math.max(i,r.distanceToSquared(Es));if(n)for(let l=0,c=n.length;l<c;l++){const s=n[l],p=this.morphTargetsRelative;for(let y=0,_=s.count;y<_;y++)Es.fromBufferAttribute(s,y),p&&(hv.fromBufferAttribute(e,y),Es.add(hv)),i=Math.max(i,r.distanceToSquared(Es))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=n.position,i=n.normal,l=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ph(new Float32Array(4*r.count),4));const c=this.getAttribute("tangent"),s=[],p=[];for(let se=0;se<r.count;se++)s[se]=new At,p[se]=new At;const y=new At,_=new At,w=new At,S=new gi,M=new gi,I=new gi,D=new At,R=new At;function L(se,J,$){y.fromBufferAttribute(r,se),_.fromBufferAttribute(r,J),w.fromBufferAttribute(r,$),S.fromBufferAttribute(l,se),M.fromBufferAttribute(l,J),I.fromBufferAttribute(l,$),_.sub(y),w.sub(y),M.sub(S),I.sub(S);const le=1/(M.x*I.y-I.x*M.y);isFinite(le)&&(D.copy(_).multiplyScalar(I.y).addScaledVector(w,-M.y).multiplyScalar(le),R.copy(w).multiplyScalar(M.x).addScaledVector(_,-I.x).multiplyScalar(le),s[se].add(D),s[J].add(D),s[$].add(D),p[se].add(R),p[J].add(R),p[$].add(R))}let V=this.groups;V.length===0&&(V=[{start:0,count:e.count}]);for(let se=0,J=V.length;se<J;++se){const $=V[se],le=$.start,Ce=$.count;for(let we=le,We=le+Ce;we<We;we+=3)L(e.getX(we+0),e.getX(we+1),e.getX(we+2))}const B=new At,H=new At,q=new At,X=new At;function ee(se){q.fromBufferAttribute(i,se),X.copy(q);const J=s[se];B.copy(J),B.sub(q.multiplyScalar(q.dot(J))).normalize(),H.crossVectors(X,J);const le=H.dot(p[se])<0?-1:1;c.setXYZW(se,B.x,B.y,B.z,le)}for(let se=0,J=V.length;se<J;++se){const $=V[se],le=$.start,Ce=$.count;for(let we=le,We=le+Ce;we<We;we+=3)ee(e.getX(we+0)),ee(e.getX(we+1)),ee(e.getX(we+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ph(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let S=0,M=r.count;S<M;S++)r.setXYZ(S,0,0,0);const i=new At,l=new At,c=new At,s=new At,p=new At,y=new At,_=new At,w=new At;if(e)for(let S=0,M=e.count;S<M;S+=3){const I=e.getX(S+0),D=e.getX(S+1),R=e.getX(S+2);i.fromBufferAttribute(n,I),l.fromBufferAttribute(n,D),c.fromBufferAttribute(n,R),_.subVectors(c,l),w.subVectors(i,l),_.cross(w),s.fromBufferAttribute(r,I),p.fromBufferAttribute(r,D),y.fromBufferAttribute(r,R),s.add(_),p.add(_),y.add(_),r.setXYZ(I,s.x,s.y,s.z),r.setXYZ(D,p.x,p.y,p.z),r.setXYZ(R,y.x,y.y,y.z)}else for(let S=0,M=n.count;S<M;S+=3)i.fromBufferAttribute(n,S+0),l.fromBufferAttribute(n,S+1),c.fromBufferAttribute(n,S+2),_.subVectors(c,l),w.subVectors(i,l),_.cross(w),r.setXYZ(S+0,_.x,_.y,_.z),r.setXYZ(S+1,_.x,_.y,_.z),r.setXYZ(S+2,_.x,_.y,_.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)Es.fromBufferAttribute(e,n),Es.normalize(),e.setXYZ(n,Es.x,Es.y,Es.z)}toNonIndexed(){function e(s,p){const y=s.array,_=s.itemSize,w=s.normalized,S=new y.constructor(p.length*_);let M=0,I=0;for(let D=0,R=p.length;D<R;D++){s.isInterleavedBufferAttribute?M=p[D]*s.data.stride+s.offset:M=p[D]*_;for(let L=0;L<_;L++)S[I++]=y[M++]}return new Ph(S,_,w)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new zh,r=this.index.array,i=this.attributes;for(const s in i){const p=i[s],y=e(p,r);n.setAttribute(s,y)}const l=this.morphAttributes;for(const s in l){const p=[],y=l[s];for(let _=0,w=y.length;_<w;_++){const S=y[_],M=e(S,r);p.push(M)}n.morphAttributes[s]=p}n.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let s=0,p=c.length;s<p;s++){const y=c[s];n.addGroup(y.start,y.count,y.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const p=this.parameters;for(const y in p)p[y]!==void 0&&(e[y]=p[y]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const p in r){const y=r[p];e.data.attributes[p]=y.toJSON(e.data)}const i={};let l=!1;for(const p in this.morphAttributes){const y=this.morphAttributes[p],_=[];for(let w=0,S=y.length;w<S;w++){const M=y[w];_.push(M.toJSON(e.data))}_.length>0&&(i[p]=_,l=!0)}l&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(e.data.groups=JSON.parse(JSON.stringify(c)));const s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const i=e.attributes;for(const y in i){const _=i[y];this.setAttribute(y,_.clone(n))}const l=e.morphAttributes;for(const y in l){const _=[],w=l[y];for(let S=0,M=w.length;S<M;S++)_.push(w[S].clone(n));this.morphAttributes[y]=_}this.morphTargetsRelative=e.morphTargetsRelative;const c=e.groups;for(let y=0,_=c.length;y<_;y++){const w=c[y];this.addGroup(w.start,w.count,w.materialIndex)}const s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());const p=e.boundingSphere;return p!==null&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const pz=new Pi,xm=new pI,R1=new mS,mz=new At,L1=new At,k1=new At,D1=new At,fE=new At,z1=new At,gz=new At,O1=new At;class Ja extends Zs{constructor(e=new zh,n=new dp){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,c=i.length;l<c;l++){const s=i[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=l}}}}getVertexPosition(e,n){const r=this.geometry,i=r.attributes.position,l=r.morphAttributes.position,c=r.morphTargetsRelative;n.fromBufferAttribute(i,e);const s=this.morphTargetInfluences;if(l&&s){z1.set(0,0,0);for(let p=0,y=l.length;p<y;p++){const _=s[p],w=l[p];_!==0&&(fE.fromBufferAttribute(w,e),c?z1.addScaledVector(fE,_):z1.addScaledVector(fE.sub(n),_))}n.add(z1)}return n}raycast(e,n){const r=this.geometry,i=this.material,l=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),R1.copy(r.boundingSphere),R1.applyMatrix4(l),xm.copy(e.ray).recast(e.near),!(R1.containsPoint(xm.origin)===!1&&(xm.intersectSphere(R1,mz)===null||xm.origin.distanceToSquared(mz)>(e.far-e.near)**2))&&(pz.copy(l).invert(),xm.copy(e.ray).applyMatrix4(pz),!(r.boundingBox!==null&&xm.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,xm)))}_computeIntersections(e,n,r){let i;const l=this.geometry,c=this.material,s=l.index,p=l.attributes.position,y=l.attributes.uv,_=l.attributes.uv1,w=l.attributes.normal,S=l.groups,M=l.drawRange;if(s!==null)if(Array.isArray(c))for(let I=0,D=S.length;I<D;I++){const R=S[I],L=c[R.materialIndex],V=Math.max(R.start,M.start),B=Math.min(s.count,Math.min(R.start+R.count,M.start+M.count));for(let H=V,q=B;H<q;H+=3){const X=s.getX(H),ee=s.getX(H+1),se=s.getX(H+2);i=F1(this,L,e,r,y,_,w,X,ee,se),i&&(i.faceIndex=Math.floor(H/3),i.face.materialIndex=R.materialIndex,n.push(i))}}else{const I=Math.max(0,M.start),D=Math.min(s.count,M.start+M.count);for(let R=I,L=D;R<L;R+=3){const V=s.getX(R),B=s.getX(R+1),H=s.getX(R+2);i=F1(this,c,e,r,y,_,w,V,B,H),i&&(i.faceIndex=Math.floor(R/3),n.push(i))}}else if(p!==void 0)if(Array.isArray(c))for(let I=0,D=S.length;I<D;I++){const R=S[I],L=c[R.materialIndex],V=Math.max(R.start,M.start),B=Math.min(p.count,Math.min(R.start+R.count,M.start+M.count));for(let H=V,q=B;H<q;H+=3){const X=H,ee=H+1,se=H+2;i=F1(this,L,e,r,y,_,w,X,ee,se),i&&(i.faceIndex=Math.floor(H/3),i.face.materialIndex=R.materialIndex,n.push(i))}}else{const I=Math.max(0,M.start),D=Math.min(p.count,M.start+M.count);for(let R=I,L=D;R<L;R+=3){const V=R,B=R+1,H=R+2;i=F1(this,c,e,r,y,_,w,V,B,H),i&&(i.faceIndex=Math.floor(R/3),n.push(i))}}}}function Rde(t,e,n,r,i,l,c,s){let p;if(e.side===tl?p=r.intersectTriangle(c,l,i,!0,s):p=r.intersectTriangle(i,l,c,e.side===up,s),p===null)return null;O1.copy(s),O1.applyMatrix4(t.matrixWorld);const y=n.ray.origin.distanceTo(O1);return y<n.near||y>n.far?null:{distance:y,point:O1.clone(),object:t}}function F1(t,e,n,r,i,l,c,s,p,y){t.getVertexPosition(s,L1),t.getVertexPosition(p,k1),t.getVertexPosition(y,D1);const _=Rde(t,e,n,r,L1,k1,D1,gz);if(_){const w=new At;vu.getBarycoord(gz,L1,k1,D1,w),i&&(_.uv=vu.getInterpolatedAttribute(i,s,p,y,w,new gi)),l&&(_.uv1=vu.getInterpolatedAttribute(l,s,p,y,w,new gi)),c&&(_.normal=vu.getInterpolatedAttribute(c,s,p,y,w,new At),_.normal.dot(r.direction)>0&&_.normal.multiplyScalar(-1));const S={a:s,b:p,c:y,normal:new At,materialIndex:0};vu.getNormal(L1,k1,D1,S.normal),_.face=S,_.barycoord=w}return _}class _x extends zh{constructor(e=1,n=1,r=1,i=1,l=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:i,heightSegments:l,depthSegments:c};const s=this;i=Math.floor(i),l=Math.floor(l),c=Math.floor(c);const p=[],y=[],_=[],w=[];let S=0,M=0;I("z","y","x",-1,-1,r,n,e,c,l,0),I("z","y","x",1,-1,r,n,-e,c,l,1),I("x","z","y",1,1,e,r,n,i,c,2),I("x","z","y",1,-1,e,r,-n,i,c,3),I("x","y","z",1,-1,e,n,r,i,l,4),I("x","y","z",-1,-1,e,n,-r,i,l,5),this.setIndex(p),this.setAttribute("position",new ql(y,3)),this.setAttribute("normal",new ql(_,3)),this.setAttribute("uv",new ql(w,2));function I(D,R,L,V,B,H,q,X,ee,se,J){const $=H/ee,le=q/se,Ce=H/2,we=q/2,We=X/2,Fe=ee+1,Me=se+1;let Ee=0,Te=0;const Ze=new At;for(let rt=0;rt<Me;rt++){const Re=rt*le-we;for(let Qe=0;Qe<Fe;Qe++){const Vt=Qe*$-Ce;Ze[D]=Vt*V,Ze[R]=Re*B,Ze[L]=We,y.push(Ze.x,Ze.y,Ze.z),Ze[D]=0,Ze[R]=0,Ze[L]=X>0?1:-1,_.push(Ze.x,Ze.y,Ze.z),w.push(Qe/ee),w.push(1-rt/se),Ee+=1}}for(let rt=0;rt<se;rt++)for(let Re=0;Re<ee;Re++){const Qe=S+Re+Fe*rt,Vt=S+Re+Fe*(rt+1),je=S+(Re+1)+Fe*(rt+1),ct=S+(Re+1)+Fe*rt;p.push(Qe,Vt,ct),p.push(Vt,je,ct),Te+=6}s.addGroup(M,Te,J),M+=Te,S+=Ee}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _x(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function cy(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function Ca(t){const e={};for(let n=0;n<t.length;n++){const r=cy(t[n]);for(const i in r)e[i]=r[i]}return e}function Lde(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function m6(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:li.workingColorSpace}const kde={clone:cy,merge:Ca};var Dde=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,zde=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Yd extends yx{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Dde,this.fragmentShader=zde,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cy(e.uniforms),this.uniformsGroups=Lde(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const i in this.uniforms){const c=this.uniforms[i].value;c&&c.isTexture?n.uniforms[i]={type:"t",value:c.toJSON(e).uuid}:c&&c.isColor?n.uniforms[i]={type:"c",value:c.getHex()}:c&&c.isVector2?n.uniforms[i]={type:"v2",value:c.toArray()}:c&&c.isVector3?n.uniforms[i]={type:"v3",value:c.toArray()}:c&&c.isVector4?n.uniforms[i]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?n.uniforms[i]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?n.uniforms[i]={type:"m4",value:c.toArray()}:n.uniforms[i]={value:c}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class g6 extends Zs{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Pi,this.projectionMatrix=new Pi,this.projectionMatrixInverse=new Pi,this.coordinateSystem=$d}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Vf=new At,vz=new gi,yz=new gi;class Nl extends g6{constructor(e=50,n=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=k_*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(J0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return k_*2*Math.atan(Math.tan(J0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,r){Vf.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Vf.x,Vf.y).multiplyScalar(-e/Vf.z),Vf.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Vf.x,Vf.y).multiplyScalar(-e/Vf.z)}getViewSize(e,n){return this.getViewBounds(e,vz,yz),n.subVectors(yz,vz)}setViewOffset(e,n,r,i,l,c){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=l,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(J0*.5*this.fov)/this.zoom,r=2*n,i=this.aspect*r,l=-.5*i;const c=this.view;if(this.view!==null&&this.view.enabled){const p=c.fullWidth,y=c.fullHeight;l+=c.offsetX*i/p,n-=c.offsetY*r/y,i*=c.width/p,r*=c.height/y}const s=this.filmOffset;s!==0&&(l+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+i,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const dv=-90,fv=1;class Ode extends Zs{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Nl(dv,fv,e,n);i.layers=this.layers,this.add(i);const l=new Nl(dv,fv,e,n);l.layers=this.layers,this.add(l);const c=new Nl(dv,fv,e,n);c.layers=this.layers,this.add(c);const s=new Nl(dv,fv,e,n);s.layers=this.layers,this.add(s);const p=new Nl(dv,fv,e,n);p.layers=this.layers,this.add(p);const y=new Nl(dv,fv,e,n);y.layers=this.layers,this.add(y)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,i,l,c,s,p]=n;for(const y of n)this.remove(y);if(e===$d)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),p.up.set(0,1,0),p.lookAt(0,0,-1);else if(e===ew)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),p.up.set(0,-1,0),p.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const y of n)this.add(y),y.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[l,c,s,p,y,_]=this.children,w=e.getRenderTarget(),S=e.getActiveCubeFace(),M=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const D=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(n,l),e.setRenderTarget(r,1,i),e.render(n,c),e.setRenderTarget(r,2,i),e.render(n,s),e.setRenderTarget(r,3,i),e.render(n,p),e.setRenderTarget(r,4,i),e.render(n,y),r.texture.generateMipmaps=D,e.setRenderTarget(r,5,i),e.render(n,_),e.setRenderTarget(w,S,M),e.xr.enabled=I,r.texture.needsPMREMUpdate=!0}}class v6 extends Xs{constructor(e=[],n=ay,r,i,l,c,s,p,y,_){super(e,n,r,i,l,c,s,p,y,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Fde extends hp{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new v6(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Vl}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new _x(5,5,5),l=new Yd({name:"CubemapFromEquirect",uniforms:cy(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:tl,blending:Qf});l.uniforms.tEquirect.value=n;const c=new Ja(i,l),s=n.minFilter;return n.minFilter===Yf&&(n.minFilter=Vl),new Ode(1,10,this).update(e,c),n.minFilter=s,c.geometry.dispose(),c.material.dispose(),this}clear(e,n=!0,r=!0,i=!0){const l=e.getRenderTarget();for(let c=0;c<6;c++)e.setRenderTarget(this,c),e.clear(n,r,i);e.setRenderTarget(l)}}class Kf extends Zs{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Nde={type:"move"};class pE{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Kf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Kf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new At,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new At),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Kf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new At,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new At),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let i=null,l=null,c=null;const s=this._targetRay,p=this._grip,y=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(y&&e.hand){c=!0;for(const D of e.hand.values()){const R=n.getJointPose(D,r),L=this._getHandJoint(y,D);R!==null&&(L.matrix.fromArray(R.transform.matrix),L.matrix.decompose(L.position,L.rotation,L.scale),L.matrixWorldNeedsUpdate=!0,L.jointRadius=R.radius),L.visible=R!==null}const _=y.joints["index-finger-tip"],w=y.joints["thumb-tip"],S=_.position.distanceTo(w.position),M=.02,I=.005;y.inputState.pinching&&S>M+I?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!y.inputState.pinching&&S<=M-I&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else p!==null&&e.gripSpace&&(l=n.getPose(e.gripSpace,r),l!==null&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));s!==null&&(i=n.getPose(e.targetRaySpace,r),i===null&&l!==null&&(i=l),i!==null&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Nde)))}return s!==null&&(s.visible=i!==null),p!==null&&(p.visible=l!==null),y!==null&&(y.visible=c!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new Kf;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class nw extends Zs{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Lh,this.environmentIntensity=1,this.environmentRotation=new Lh,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}const mE=new At,Bde=new At,Ude=new zr;class Cm{constructor(e=new At(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,i){return this.normal.set(e,n,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const i=mE.subVectors(r,n).cross(Bde.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(mE),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/i;return l<0||l>1?null:n.copy(e.start).addScaledVector(r,l)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||Ude.getNormalMatrix(e),i=this.coplanarPoint(mE).applyMatrix4(e),l=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const bm=new mS,N1=new At;class gI{constructor(e=new Cm,n=new Cm,r=new Cm,i=new Cm,l=new Cm,c=new Cm){this.planes=[e,n,r,i,l,c]}set(e,n,r,i,l,c){const s=this.planes;return s[0].copy(e),s[1].copy(n),s[2].copy(r),s[3].copy(i),s[4].copy(l),s[5].copy(c),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=$d){const r=this.planes,i=e.elements,l=i[0],c=i[1],s=i[2],p=i[3],y=i[4],_=i[5],w=i[6],S=i[7],M=i[8],I=i[9],D=i[10],R=i[11],L=i[12],V=i[13],B=i[14],H=i[15];if(r[0].setComponents(p-l,S-y,R-M,H-L).normalize(),r[1].setComponents(p+l,S+y,R+M,H+L).normalize(),r[2].setComponents(p+c,S+_,R+I,H+V).normalize(),r[3].setComponents(p-c,S-_,R-I,H-V).normalize(),r[4].setComponents(p-s,S-w,R-D,H-B).normalize(),n===$d)r[5].setComponents(p+s,S+w,R+D,H+B).normalize();else if(n===ew)r[5].setComponents(s,w,D,B).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),bm.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),bm.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(bm)}intersectsSprite(e){return bm.center.set(0,0,0),bm.radius=.7071067811865476,bm.applyMatrix4(e.matrixWorld),this.intersectsSphere(bm)}intersectsSphere(e){const n=this.planes,r=e.center,i=-e.radius;for(let l=0;l<6;l++)if(n[l].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const i=n[r];if(N1.x=i.normal.x>0?e.max.x:e.min.x,N1.y=i.normal.y>0?e.max.y:e.min.y,N1.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(N1)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class $de extends yx{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new bi(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const rw=new At,iw=new At,_z=new Pi,w0=new pI,B1=new mS,gE=new At,xz=new At;class Vde extends Zs{constructor(e=new zh,n=new $de){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let i=1,l=n.count;i<l;i++)rw.fromBufferAttribute(n,i-1),iw.fromBufferAttribute(n,i),r[i]=r[i-1],r[i]+=rw.distanceTo(iw);e.setAttribute("lineDistance",new ql(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,i=this.matrixWorld,l=e.params.Line.threshold,c=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),B1.copy(r.boundingSphere),B1.applyMatrix4(i),B1.radius+=l,e.ray.intersectsSphere(B1)===!1)return;_z.copy(i).invert(),w0.copy(e.ray).applyMatrix4(_z);const s=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=s*s,y=this.isLineSegments?2:1,_=r.index,S=r.attributes.position;if(_!==null){const M=Math.max(0,c.start),I=Math.min(_.count,c.start+c.count);for(let D=M,R=I-1;D<R;D+=y){const L=_.getX(D),V=_.getX(D+1),B=U1(this,e,w0,p,L,V,D);B&&n.push(B)}if(this.isLineLoop){const D=_.getX(I-1),R=_.getX(M),L=U1(this,e,w0,p,D,R,I-1);L&&n.push(L)}}else{const M=Math.max(0,c.start),I=Math.min(S.count,c.start+c.count);for(let D=M,R=I-1;D<R;D+=y){const L=U1(this,e,w0,p,D,D+1,D);L&&n.push(L)}if(this.isLineLoop){const D=U1(this,e,w0,p,I-1,M,I-1);D&&n.push(D)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,c=i.length;l<c;l++){const s=i[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=l}}}}}function U1(t,e,n,r,i,l,c){const s=t.geometry.attributes.position;if(rw.fromBufferAttribute(s,i),iw.fromBufferAttribute(s,l),n.distanceSqToSegment(rw,iw,gE,xz)>r)return;gE.applyMatrix4(t.matrixWorld);const y=e.ray.origin.distanceTo(gE);if(!(y<e.near||y>e.far))return{distance:y,point:xz.clone().applyMatrix4(t.matrixWorld),index:c,face:null,faceIndex:null,barycoord:null,object:t}}const bz=new At,wz=new At;class jde extends Vde{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[];for(let i=0,l=n.count;i<l;i+=2)bz.fromBufferAttribute(n,i),wz.fromBufferAttribute(n,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+bz.distanceTo(wz);e.setAttribute("lineDistance",new ql(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Hde extends Xs{constructor(e,n,r,i,l=Vl,c=Vl,s,p,y){super(e,n,r,i,l,c,s,p,y),this.isVideoTexture=!0,this.generateMipmaps=!1;const _=this;function w(){_.needsUpdate=!0,e.requestVideoFrameCallback(w)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(w)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class y6 extends Xs{constructor(e,n,r=Xm,i,l,c,s=bu,p=bu,y,_=R_){if(_!==R_&&_!==L_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,i,l,c,s,p,_,r,y),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new fI(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class xx extends zh{constructor(e=1,n=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:i};const l=e/2,c=n/2,s=Math.floor(r),p=Math.floor(i),y=s+1,_=p+1,w=e/s,S=n/p,M=[],I=[],D=[],R=[];for(let L=0;L<_;L++){const V=L*S-c;for(let B=0;B<y;B++){const H=B*w-l;I.push(H,-V,0),D.push(0,0,1),R.push(B/s),R.push(1-L/p)}}for(let L=0;L<p;L++)for(let V=0;V<s;V++){const B=V+y*L,H=V+y*(L+1),q=V+1+y*(L+1),X=V+1+y*L;M.push(B,H,X),M.push(H,q,X)}this.setIndex(M),this.setAttribute("position",new ql(I,3)),this.setAttribute("normal",new ql(D,3)),this.setAttribute("uv",new ql(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xx(e.width,e.height,e.widthSegments,e.heightSegments)}}class xy extends zh{constructor(e=1,n=32,r=16,i=0,l=Math.PI*2,c=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:i,phiLength:l,thetaStart:c,thetaLength:s},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const p=Math.min(c+s,Math.PI);let y=0;const _=[],w=new At,S=new At,M=[],I=[],D=[],R=[];for(let L=0;L<=r;L++){const V=[],B=L/r;let H=0;L===0&&c===0?H=.5/n:L===r&&p===Math.PI&&(H=-.5/n);for(let q=0;q<=n;q++){const X=q/n;w.x=-e*Math.cos(i+X*l)*Math.sin(c+B*s),w.y=e*Math.cos(c+B*s),w.z=e*Math.sin(i+X*l)*Math.sin(c+B*s),I.push(w.x,w.y,w.z),S.copy(w).normalize(),D.push(S.x,S.y,S.z),R.push(X+H,1-B),V.push(y++)}_.push(V)}for(let L=0;L<r;L++)for(let V=0;V<n;V++){const B=_[L][V+1],H=_[L][V],q=_[L+1][V],X=_[L+1][V+1];(L!==0||c>0)&&M.push(B,H,X),(L!==r-1||p<Math.PI)&&M.push(H,q,X)}this.setIndex(M),this.setAttribute("position",new ql(I,3)),this.setAttribute("normal",new ql(D,3)),this.setAttribute("uv",new ql(R,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xy(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Gde extends zh{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],r=new Set,i=new At,l=new At;if(e.index!==null){const c=e.attributes.position,s=e.index;let p=e.groups;p.length===0&&(p=[{start:0,count:s.count,materialIndex:0}]);for(let y=0,_=p.length;y<_;++y){const w=p[y],S=w.start,M=w.count;for(let I=S,D=S+M;I<D;I+=3)for(let R=0;R<3;R++){const L=s.getX(I+R),V=s.getX(I+(R+1)%3);i.fromBufferAttribute(c,L),l.fromBufferAttribute(c,V),Sz(i,l,r)===!0&&(n.push(i.x,i.y,i.z),n.push(l.x,l.y,l.z))}}}else{const c=e.attributes.position;for(let s=0,p=c.count/3;s<p;s++)for(let y=0;y<3;y++){const _=3*s+y,w=3*s+(y+1)%3;i.fromBufferAttribute(c,_),l.fromBufferAttribute(c,w),Sz(i,l,r)===!0&&(n.push(i.x,i.y,i.z),n.push(l.x,l.y,l.z))}}this.setAttribute("position",new ql(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Sz(t,e,n){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(r)===!0||n.has(i)===!0?!1:(n.add(r),n.add(i),!0)}class Wde extends yx{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Nhe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class qde extends yx{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const iP={enabled:!1};class Xde{constructor(e,n,r){const i=this;let l=!1,c=0,s=0,p;const y=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=r,this.itemStart=function(_){s++,l===!1&&i.onStart!==void 0&&i.onStart(_,c,s),l=!0},this.itemEnd=function(_){c++,i.onProgress!==void 0&&i.onProgress(_,c,s),c===s&&(l=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(_){i.onError!==void 0&&i.onError(_)},this.resolveURL=function(_){return p?p(_):_},this.setURLModifier=function(_){return p=_,this},this.addHandler=function(_,w){return y.push(_,w),this},this.removeHandler=function(_){const w=y.indexOf(_);return w!==-1&&y.splice(w,2),this},this.getHandler=function(_){for(let w=0,S=y.length;w<S;w+=2){const M=y[w],I=y[w+1];if(M.global&&(M.lastIndex=0),M.test(_))return I}return null}}}const Zde=new Xde;let vI=class{constructor(e){this.manager=e!==void 0?e:Zde,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const r=this;return new Promise(function(i,l){r.load(e,i,n,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};vI.DEFAULT_MATERIAL_NAME="__DEFAULT";class Yde extends g6{constructor(e=-1,n=1,r=1,i=-1,l=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=i,this.near=l,this.far=c,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,i,l,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=l,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let l=r-e,c=r+e,s=i+n,p=i-n;if(this.view!==null&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=y*this.view.offsetX,c=l+y*this.view.width,s-=_*this.view.offsetY,p=s-_*this.view.height}this.projectionMatrix.makeOrthographic(l,c,s,p,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}class Kde extends Nl{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}}const Mz=new Pi;class Jde{constructor(e,n,r=0,i=1/0){this.ray=new pI(e,n),this.near=r,this.far=i,this.camera=null,this.layers=new mI,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return Mz.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Mz),this}intersectObject(e,n=!0,r=[]){return oP(e,this,r,n),r.sort(Cz),r}intersectObjects(e,n=!0,r=[]){for(let i=0,l=e.length;i<l;i++)oP(e[i],this,r,n);return r.sort(Cz),r}}function Cz(t,e){return t.distance-e.distance}function oP(t,e,n,r){let i=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(i=!1),i===!0&&r===!0){const l=t.children;for(let c=0,s=l.length;c<s;c++)oP(l[c],e,n,!0)}}function Ez(t,e,n,r){const i=Qde(r);switch(n){case n6:return t*e;case i6:return t*e;case o6:return t*e*2;case s6:return t*e/i.components*i.byteLength;case cI:return t*e/i.components*i.byteLength;case a6:return t*e*2/i.components*i.byteLength;case uI:return t*e*2/i.components*i.byteLength;case r6:return t*e*3/i.components*i.byteLength;case _u:return t*e*4/i.components*i.byteLength;case hI:return t*e*4/i.components*i.byteLength;case pb:case mb:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case gb:case vb:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case kT:case zT:return Math.max(t,16)*Math.max(e,8)/4;case LT:case DT:return Math.max(t,8)*Math.max(e,8)/2;case OT:case FT:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case NT:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case BT:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case UT:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case $T:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case VT:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case jT:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case HT:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case GT:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case WT:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case qT:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case XT:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case ZT:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case YT:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case KT:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case JT:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case yb:case QT:case eP:return Math.ceil(t/4)*Math.ceil(e/4)*16;case l6:case tP:return Math.ceil(t/4)*Math.ceil(e/4)*8;case nP:case rP:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function Qde(t){switch(t){case Zd:case QB:return{byteLength:1,components:1};case A_:case e6:case vx:return{byteLength:2,components:1};case aI:case lI:return{byteLength:2,components:4};case Xm:case sI:case Ud:return{byteLength:4,components:1};case t6:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:oI}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=oI);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function _6(){let t=null,e=!1,n=null,r=null;function i(l,c){n(l,c),r=t.requestAnimationFrame(i)}return{start:function(){e!==!0&&n!==null&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(l){n=l},setContext:function(l){t=l}}}function efe(t){const e=new WeakMap;function n(s,p){const y=s.array,_=s.usage,w=y.byteLength,S=t.createBuffer();t.bindBuffer(p,S),t.bufferData(p,y,_),s.onUploadCallback();let M;if(y instanceof Float32Array)M=t.FLOAT;else if(y instanceof Uint16Array)s.isFloat16BufferAttribute?M=t.HALF_FLOAT:M=t.UNSIGNED_SHORT;else if(y instanceof Int16Array)M=t.SHORT;else if(y instanceof Uint32Array)M=t.UNSIGNED_INT;else if(y instanceof Int32Array)M=t.INT;else if(y instanceof Int8Array)M=t.BYTE;else if(y instanceof Uint8Array)M=t.UNSIGNED_BYTE;else if(y instanceof Uint8ClampedArray)M=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+y);return{buffer:S,type:M,bytesPerElement:y.BYTES_PER_ELEMENT,version:s.version,size:w}}function r(s,p,y){const _=p.array,w=p.updateRanges;if(t.bindBuffer(y,s),w.length===0)t.bufferSubData(y,0,_);else{w.sort((M,I)=>M.start-I.start);let S=0;for(let M=1;M<w.length;M++){const I=w[S],D=w[M];D.start<=I.start+I.count+1?I.count=Math.max(I.count,D.start+D.count-I.start):(++S,w[S]=D)}w.length=S+1;for(let M=0,I=w.length;M<I;M++){const D=w[M];t.bufferSubData(y,D.start*_.BYTES_PER_ELEMENT,_,D.start,D.count)}p.clearUpdateRanges()}p.onUploadCallback()}function i(s){return s.isInterleavedBufferAttribute&&(s=s.data),e.get(s)}function l(s){s.isInterleavedBufferAttribute&&(s=s.data);const p=e.get(s);p&&(t.deleteBuffer(p.buffer),e.delete(s))}function c(s,p){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){const _=e.get(s);(!_||_.version<s.version)&&e.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}const y=e.get(s);if(y===void 0)e.set(s,n(s,p));else if(y.version<s.version){if(y.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(y.buffer,s,p),y.version=s.version}}return{get:i,remove:l,update:c}}var tfe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,nfe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,rfe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,ife=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ofe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,sfe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,afe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,lfe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,cfe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,ufe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,hfe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,dfe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,ffe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,pfe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,mfe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,gfe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,vfe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,yfe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,_fe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,xfe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,bfe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,wfe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Sfe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Mfe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Cfe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Efe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Tfe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Pfe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Afe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Ife=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Rfe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Lfe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,kfe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Dfe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,zfe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Ofe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Ffe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Nfe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Bfe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Ufe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,$fe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Vfe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,jfe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Hfe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Gfe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Wfe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,qfe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Xfe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Zfe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Yfe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Kfe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Jfe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Qfe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,epe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,tpe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,npe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,rpe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,ipe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,ope=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,spe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,ape=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,lpe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,cpe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,upe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,hpe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,dpe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,fpe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,ppe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,mpe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,gpe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,vpe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,ype=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,_pe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,xpe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,bpe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wpe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Spe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Mpe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Cpe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Epe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Tpe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Ppe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Ape=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Ipe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Rpe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Lpe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,kpe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Dpe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,zpe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Ope=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Fpe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Npe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Bpe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Upe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,$pe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Vpe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,jpe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Hpe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Gpe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Wpe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,qpe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Xpe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Zpe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Ype=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Kpe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Jpe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Qpe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const eme=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,tme=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nme=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rme=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ime=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,ome=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,sme=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,ame=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,lme=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,cme=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,ume=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,hme=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,dme=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fme=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,pme=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,mme=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gme=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vme=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yme=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,_me=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xme=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,bme=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,wme=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Sme=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Mme=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Cme=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Eme=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Tme=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Pme=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Ame=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Ime=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Rme=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Lme=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,kme=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Br={alphahash_fragment:tfe,alphahash_pars_fragment:nfe,alphamap_fragment:rfe,alphamap_pars_fragment:ife,alphatest_fragment:ofe,alphatest_pars_fragment:sfe,aomap_fragment:afe,aomap_pars_fragment:lfe,batching_pars_vertex:cfe,batching_vertex:ufe,begin_vertex:hfe,beginnormal_vertex:dfe,bsdfs:ffe,iridescence_fragment:pfe,bumpmap_pars_fragment:mfe,clipping_planes_fragment:gfe,clipping_planes_pars_fragment:vfe,clipping_planes_pars_vertex:yfe,clipping_planes_vertex:_fe,color_fragment:xfe,color_pars_fragment:bfe,color_pars_vertex:wfe,color_vertex:Sfe,common:Mfe,cube_uv_reflection_fragment:Cfe,defaultnormal_vertex:Efe,displacementmap_pars_vertex:Tfe,displacementmap_vertex:Pfe,emissivemap_fragment:Afe,emissivemap_pars_fragment:Ife,colorspace_fragment:Rfe,colorspace_pars_fragment:Lfe,envmap_fragment:kfe,envmap_common_pars_fragment:Dfe,envmap_pars_fragment:zfe,envmap_pars_vertex:Ofe,envmap_physical_pars_fragment:qfe,envmap_vertex:Ffe,fog_vertex:Nfe,fog_pars_vertex:Bfe,fog_fragment:Ufe,fog_pars_fragment:$fe,gradientmap_pars_fragment:Vfe,lightmap_pars_fragment:jfe,lights_lambert_fragment:Hfe,lights_lambert_pars_fragment:Gfe,lights_pars_begin:Wfe,lights_toon_fragment:Xfe,lights_toon_pars_fragment:Zfe,lights_phong_fragment:Yfe,lights_phong_pars_fragment:Kfe,lights_physical_fragment:Jfe,lights_physical_pars_fragment:Qfe,lights_fragment_begin:epe,lights_fragment_maps:tpe,lights_fragment_end:npe,logdepthbuf_fragment:rpe,logdepthbuf_pars_fragment:ipe,logdepthbuf_pars_vertex:ope,logdepthbuf_vertex:spe,map_fragment:ape,map_pars_fragment:lpe,map_particle_fragment:cpe,map_particle_pars_fragment:upe,metalnessmap_fragment:hpe,metalnessmap_pars_fragment:dpe,morphinstance_vertex:fpe,morphcolor_vertex:ppe,morphnormal_vertex:mpe,morphtarget_pars_vertex:gpe,morphtarget_vertex:vpe,normal_fragment_begin:ype,normal_fragment_maps:_pe,normal_pars_fragment:xpe,normal_pars_vertex:bpe,normal_vertex:wpe,normalmap_pars_fragment:Spe,clearcoat_normal_fragment_begin:Mpe,clearcoat_normal_fragment_maps:Cpe,clearcoat_pars_fragment:Epe,iridescence_pars_fragment:Tpe,opaque_fragment:Ppe,packing:Ape,premultiplied_alpha_fragment:Ipe,project_vertex:Rpe,dithering_fragment:Lpe,dithering_pars_fragment:kpe,roughnessmap_fragment:Dpe,roughnessmap_pars_fragment:zpe,shadowmap_pars_fragment:Ope,shadowmap_pars_vertex:Fpe,shadowmap_vertex:Npe,shadowmask_pars_fragment:Bpe,skinbase_vertex:Upe,skinning_pars_vertex:$pe,skinning_vertex:Vpe,skinnormal_vertex:jpe,specularmap_fragment:Hpe,specularmap_pars_fragment:Gpe,tonemapping_fragment:Wpe,tonemapping_pars_fragment:qpe,transmission_fragment:Xpe,transmission_pars_fragment:Zpe,uv_pars_fragment:Ype,uv_pars_vertex:Kpe,uv_vertex:Jpe,worldpos_vertex:Qpe,background_vert:eme,background_frag:tme,backgroundCube_vert:nme,backgroundCube_frag:rme,cube_vert:ime,cube_frag:ome,depth_vert:sme,depth_frag:ame,distanceRGBA_vert:lme,distanceRGBA_frag:cme,equirect_vert:ume,equirect_frag:hme,linedashed_vert:dme,linedashed_frag:fme,meshbasic_vert:pme,meshbasic_frag:mme,meshlambert_vert:gme,meshlambert_frag:vme,meshmatcap_vert:yme,meshmatcap_frag:_me,meshnormal_vert:xme,meshnormal_frag:bme,meshphong_vert:wme,meshphong_frag:Sme,meshphysical_vert:Mme,meshphysical_frag:Cme,meshtoon_vert:Eme,meshtoon_frag:Tme,points_vert:Pme,points_frag:Ame,shadow_vert:Ime,shadow_frag:Rme,sprite_vert:Lme,sprite_frag:kme},qn={common:{diffuse:{value:new bi(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new zr},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new zr}},envmap:{envMap:{value:null},envMapRotation:{value:new zr},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new zr}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new zr}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new zr},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new zr},normalScale:{value:new gi(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new zr},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new zr}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new zr}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new zr}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new bi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new bi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0},uvTransform:{value:new zr}},sprite:{diffuse:{value:new bi(16777215)},opacity:{value:1},center:{value:new gi(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new zr},alphaMap:{value:null},alphaMapTransform:{value:new zr},alphaTest:{value:0}}},_h={basic:{uniforms:Ca([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.fog]),vertexShader:Br.meshbasic_vert,fragmentShader:Br.meshbasic_frag},lambert:{uniforms:Ca([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.fog,qn.lights,{emissive:{value:new bi(0)}}]),vertexShader:Br.meshlambert_vert,fragmentShader:Br.meshlambert_frag},phong:{uniforms:Ca([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.fog,qn.lights,{emissive:{value:new bi(0)},specular:{value:new bi(1118481)},shininess:{value:30}}]),vertexShader:Br.meshphong_vert,fragmentShader:Br.meshphong_frag},standard:{uniforms:Ca([qn.common,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.roughnessmap,qn.metalnessmap,qn.fog,qn.lights,{emissive:{value:new bi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Br.meshphysical_vert,fragmentShader:Br.meshphysical_frag},toon:{uniforms:Ca([qn.common,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.gradientmap,qn.fog,qn.lights,{emissive:{value:new bi(0)}}]),vertexShader:Br.meshtoon_vert,fragmentShader:Br.meshtoon_frag},matcap:{uniforms:Ca([qn.common,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.fog,{matcap:{value:null}}]),vertexShader:Br.meshmatcap_vert,fragmentShader:Br.meshmatcap_frag},points:{uniforms:Ca([qn.points,qn.fog]),vertexShader:Br.points_vert,fragmentShader:Br.points_frag},dashed:{uniforms:Ca([qn.common,qn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Br.linedashed_vert,fragmentShader:Br.linedashed_frag},depth:{uniforms:Ca([qn.common,qn.displacementmap]),vertexShader:Br.depth_vert,fragmentShader:Br.depth_frag},normal:{uniforms:Ca([qn.common,qn.bumpmap,qn.normalmap,qn.displacementmap,{opacity:{value:1}}]),vertexShader:Br.meshnormal_vert,fragmentShader:Br.meshnormal_frag},sprite:{uniforms:Ca([qn.sprite,qn.fog]),vertexShader:Br.sprite_vert,fragmentShader:Br.sprite_frag},background:{uniforms:{uvTransform:{value:new zr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Br.background_vert,fragmentShader:Br.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new zr}},vertexShader:Br.backgroundCube_vert,fragmentShader:Br.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Br.cube_vert,fragmentShader:Br.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Br.equirect_vert,fragmentShader:Br.equirect_frag},distanceRGBA:{uniforms:Ca([qn.common,qn.displacementmap,{referencePosition:{value:new At},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Br.distanceRGBA_vert,fragmentShader:Br.distanceRGBA_frag},shadow:{uniforms:Ca([qn.lights,qn.fog,{color:{value:new bi(0)},opacity:{value:1}}]),vertexShader:Br.shadow_vert,fragmentShader:Br.shadow_frag}};_h.physical={uniforms:Ca([_h.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new zr},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new zr},clearcoatNormalScale:{value:new gi(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new zr},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new zr},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new zr},sheen:{value:0},sheenColor:{value:new bi(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new zr},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new zr},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new zr},transmissionSamplerSize:{value:new gi},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new zr},attenuationDistance:{value:0},attenuationColor:{value:new bi(0)},specularColor:{value:new bi(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new zr},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new zr},anisotropyVector:{value:new gi},anisotropyMap:{value:null},anisotropyMapTransform:{value:new zr}}]),vertexShader:Br.meshphysical_vert,fragmentShader:Br.meshphysical_frag};const $1={r:0,b:0,g:0},wm=new Lh,Dme=new Pi;function zme(t,e,n,r,i,l,c){const s=new bi(0);let p=l===!0?0:1,y,_,w=null,S=0,M=null;function I(B){let H=B.isScene===!0?B.background:null;return H&&H.isTexture&&(H=(B.backgroundBlurriness>0?n:e).get(H)),H}function D(B){let H=!1;const q=I(B);q===null?L(s,p):q&&q.isColor&&(L(q,1),H=!0);const X=t.xr.getEnvironmentBlendMode();X==="additive"?r.buffers.color.setClear(0,0,0,1,c):X==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,c),(t.autoClear||H)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function R(B,H){const q=I(H);q&&(q.isCubeTexture||q.mapping===pS)?(_===void 0&&(_=new Ja(new _x(1,1,1),new Yd({name:"BackgroundCubeMaterial",uniforms:cy(_h.backgroundCube.uniforms),vertexShader:_h.backgroundCube.vertexShader,fragmentShader:_h.backgroundCube.fragmentShader,side:tl,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(X,ee,se){this.matrixWorld.copyPosition(se.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(_)),wm.copy(H.backgroundRotation),wm.x*=-1,wm.y*=-1,wm.z*=-1,q.isCubeTexture&&q.isRenderTargetTexture===!1&&(wm.y*=-1,wm.z*=-1),_.material.uniforms.envMap.value=q,_.material.uniforms.flipEnvMap.value=q.isCubeTexture&&q.isRenderTargetTexture===!1?-1:1,_.material.uniforms.backgroundBlurriness.value=H.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=H.backgroundIntensity,_.material.uniforms.backgroundRotation.value.setFromMatrix4(Dme.makeRotationFromEuler(wm)),_.material.toneMapped=li.getTransfer(q.colorSpace)!==Li,(w!==q||S!==q.version||M!==t.toneMapping)&&(_.material.needsUpdate=!0,w=q,S=q.version,M=t.toneMapping),_.layers.enableAll(),B.unshift(_,_.geometry,_.material,0,0,null)):q&&q.isTexture&&(y===void 0&&(y=new Ja(new xx(2,2),new Yd({name:"BackgroundMaterial",uniforms:cy(_h.background.uniforms),vertexShader:_h.background.vertexShader,fragmentShader:_h.background.fragmentShader,side:up,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),y.geometry.deleteAttribute("normal"),Object.defineProperty(y.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(y)),y.material.uniforms.t2D.value=q,y.material.uniforms.backgroundIntensity.value=H.backgroundIntensity,y.material.toneMapped=li.getTransfer(q.colorSpace)!==Li,q.matrixAutoUpdate===!0&&q.updateMatrix(),y.material.uniforms.uvTransform.value.copy(q.matrix),(w!==q||S!==q.version||M!==t.toneMapping)&&(y.material.needsUpdate=!0,w=q,S=q.version,M=t.toneMapping),y.layers.enableAll(),B.unshift(y,y.geometry,y.material,0,0,null))}function L(B,H){B.getRGB($1,m6(t)),r.buffers.color.setClear($1.r,$1.g,$1.b,H,c)}function V(){_!==void 0&&(_.geometry.dispose(),_.material.dispose(),_=void 0),y!==void 0&&(y.geometry.dispose(),y.material.dispose(),y=void 0)}return{getClearColor:function(){return s},setClearColor:function(B,H=1){s.set(B),p=H,L(s,p)},getClearAlpha:function(){return p},setClearAlpha:function(B){p=B,L(s,p)},render:D,addToRenderList:R,dispose:V}}function Ome(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),r={},i=S(null);let l=i,c=!1;function s($,le,Ce,we,We){let Fe=!1;const Me=w(we,Ce,le);l!==Me&&(l=Me,y(l.object)),Fe=M($,we,Ce,We),Fe&&I($,we,Ce,We),We!==null&&e.update(We,t.ELEMENT_ARRAY_BUFFER),(Fe||c)&&(c=!1,H($,le,Ce,we),We!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(We).buffer))}function p(){return t.createVertexArray()}function y($){return t.bindVertexArray($)}function _($){return t.deleteVertexArray($)}function w($,le,Ce){const we=Ce.wireframe===!0;let We=r[$.id];We===void 0&&(We={},r[$.id]=We);let Fe=We[le.id];Fe===void 0&&(Fe={},We[le.id]=Fe);let Me=Fe[we];return Me===void 0&&(Me=S(p()),Fe[we]=Me),Me}function S($){const le=[],Ce=[],we=[];for(let We=0;We<n;We++)le[We]=0,Ce[We]=0,we[We]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:le,enabledAttributes:Ce,attributeDivisors:we,object:$,attributes:{},index:null}}function M($,le,Ce,we){const We=l.attributes,Fe=le.attributes;let Me=0;const Ee=Ce.getAttributes();for(const Te in Ee)if(Ee[Te].location>=0){const rt=We[Te];let Re=Fe[Te];if(Re===void 0&&(Te==="instanceMatrix"&&$.instanceMatrix&&(Re=$.instanceMatrix),Te==="instanceColor"&&$.instanceColor&&(Re=$.instanceColor)),rt===void 0||rt.attribute!==Re||Re&&rt.data!==Re.data)return!0;Me++}return l.attributesNum!==Me||l.index!==we}function I($,le,Ce,we){const We={},Fe=le.attributes;let Me=0;const Ee=Ce.getAttributes();for(const Te in Ee)if(Ee[Te].location>=0){let rt=Fe[Te];rt===void 0&&(Te==="instanceMatrix"&&$.instanceMatrix&&(rt=$.instanceMatrix),Te==="instanceColor"&&$.instanceColor&&(rt=$.instanceColor));const Re={};Re.attribute=rt,rt&&rt.data&&(Re.data=rt.data),We[Te]=Re,Me++}l.attributes=We,l.attributesNum=Me,l.index=we}function D(){const $=l.newAttributes;for(let le=0,Ce=$.length;le<Ce;le++)$[le]=0}function R($){L($,0)}function L($,le){const Ce=l.newAttributes,we=l.enabledAttributes,We=l.attributeDivisors;Ce[$]=1,we[$]===0&&(t.enableVertexAttribArray($),we[$]=1),We[$]!==le&&(t.vertexAttribDivisor($,le),We[$]=le)}function V(){const $=l.newAttributes,le=l.enabledAttributes;for(let Ce=0,we=le.length;Ce<we;Ce++)le[Ce]!==$[Ce]&&(t.disableVertexAttribArray(Ce),le[Ce]=0)}function B($,le,Ce,we,We,Fe,Me){Me===!0?t.vertexAttribIPointer($,le,Ce,We,Fe):t.vertexAttribPointer($,le,Ce,we,We,Fe)}function H($,le,Ce,we){D();const We=we.attributes,Fe=Ce.getAttributes(),Me=le.defaultAttributeValues;for(const Ee in Fe){const Te=Fe[Ee];if(Te.location>=0){let Ze=We[Ee];if(Ze===void 0&&(Ee==="instanceMatrix"&&$.instanceMatrix&&(Ze=$.instanceMatrix),Ee==="instanceColor"&&$.instanceColor&&(Ze=$.instanceColor)),Ze!==void 0){const rt=Ze.normalized,Re=Ze.itemSize,Qe=e.get(Ze);if(Qe===void 0)continue;const Vt=Qe.buffer,je=Qe.type,ct=Qe.bytesPerElement,Ct=je===t.INT||je===t.UNSIGNED_INT||Ze.gpuType===sI;if(Ze.isInterleavedBufferAttribute){const ut=Ze.data,lt=ut.stride,_t=Ze.offset;if(ut.isInstancedInterleavedBuffer){for(let wt=0;wt<Te.locationSize;wt++)L(Te.location+wt,ut.meshPerAttribute);$.isInstancedMesh!==!0&&we._maxInstanceCount===void 0&&(we._maxInstanceCount=ut.meshPerAttribute*ut.count)}else for(let wt=0;wt<Te.locationSize;wt++)R(Te.location+wt);t.bindBuffer(t.ARRAY_BUFFER,Vt);for(let wt=0;wt<Te.locationSize;wt++)B(Te.location+wt,Re/Te.locationSize,je,rt,lt*ct,(_t+Re/Te.locationSize*wt)*ct,Ct)}else{if(Ze.isInstancedBufferAttribute){for(let ut=0;ut<Te.locationSize;ut++)L(Te.location+ut,Ze.meshPerAttribute);$.isInstancedMesh!==!0&&we._maxInstanceCount===void 0&&(we._maxInstanceCount=Ze.meshPerAttribute*Ze.count)}else for(let ut=0;ut<Te.locationSize;ut++)R(Te.location+ut);t.bindBuffer(t.ARRAY_BUFFER,Vt);for(let ut=0;ut<Te.locationSize;ut++)B(Te.location+ut,Re/Te.locationSize,je,rt,Re*ct,Re/Te.locationSize*ut*ct,Ct)}}else if(Me!==void 0){const rt=Me[Ee];if(rt!==void 0)switch(rt.length){case 2:t.vertexAttrib2fv(Te.location,rt);break;case 3:t.vertexAttrib3fv(Te.location,rt);break;case 4:t.vertexAttrib4fv(Te.location,rt);break;default:t.vertexAttrib1fv(Te.location,rt)}}}}V()}function q(){se();for(const $ in r){const le=r[$];for(const Ce in le){const we=le[Ce];for(const We in we)_(we[We].object),delete we[We];delete le[Ce]}delete r[$]}}function X($){if(r[$.id]===void 0)return;const le=r[$.id];for(const Ce in le){const we=le[Ce];for(const We in we)_(we[We].object),delete we[We];delete le[Ce]}delete r[$.id]}function ee($){for(const le in r){const Ce=r[le];if(Ce[$.id]===void 0)continue;const we=Ce[$.id];for(const We in we)_(we[We].object),delete we[We];delete Ce[$.id]}}function se(){J(),c=!0,l!==i&&(l=i,y(l.object))}function J(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:s,reset:se,resetDefaultState:J,dispose:q,releaseStatesOfGeometry:X,releaseStatesOfProgram:ee,initAttributes:D,enableAttribute:R,disableUnusedAttributes:V}}function Fme(t,e,n){let r;function i(y){r=y}function l(y,_){t.drawArrays(r,y,_),n.update(_,r,1)}function c(y,_,w){w!==0&&(t.drawArraysInstanced(r,y,_,w),n.update(_,r,w))}function s(y,_,w){if(w===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,y,0,_,0,w);let M=0;for(let I=0;I<w;I++)M+=_[I];n.update(M,r,1)}function p(y,_,w,S){if(w===0)return;const M=e.get("WEBGL_multi_draw");if(M===null)for(let I=0;I<y.length;I++)c(y[I],_[I],S[I]);else{M.multiDrawArraysInstancedWEBGL(r,y,0,_,0,S,0,w);let I=0;for(let D=0;D<w;D++)I+=_[D]*S[D];n.update(I,r,1)}}this.setMode=i,this.render=l,this.renderInstances=c,this.renderMultiDraw=s,this.renderMultiDrawInstances=p}function Nme(t,e,n,r){let i;function l(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const ee=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(ee.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function c(ee){return!(ee!==_u&&r.convert(ee)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function s(ee){const se=ee===vx&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(ee!==Zd&&r.convert(ee)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&ee!==Ud&&!se)}function p(ee){if(ee==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";ee="mediump"}return ee==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let y=n.precision!==void 0?n.precision:"highp";const _=p(y);_!==y&&(console.warn("THREE.WebGLRenderer:",y,"not supported, using",_,"instead."),y=_);const w=n.logarithmicDepthBuffer===!0,S=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),M=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),I=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),D=t.getParameter(t.MAX_TEXTURE_SIZE),R=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),L=t.getParameter(t.MAX_VERTEX_ATTRIBS),V=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),B=t.getParameter(t.MAX_VARYING_VECTORS),H=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),q=I>0,X=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:l,getMaxPrecision:p,textureFormatReadable:c,textureTypeReadable:s,precision:y,logarithmicDepthBuffer:w,reverseDepthBuffer:S,maxTextures:M,maxVertexTextures:I,maxTextureSize:D,maxCubemapSize:R,maxAttributes:L,maxVertexUniforms:V,maxVaryings:B,maxFragmentUniforms:H,vertexTextures:q,maxSamples:X}}function Bme(t){const e=this;let n=null,r=0,i=!1,l=!1;const c=new Cm,s=new zr,p={value:null,needsUpdate:!1};this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(w,S){const M=w.length!==0||S||r!==0||i;return i=S,r=w.length,M},this.beginShadows=function(){l=!0,_(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(w,S){n=_(w,S,0)},this.setState=function(w,S,M){const I=w.clippingPlanes,D=w.clipIntersection,R=w.clipShadows,L=t.get(w);if(!i||I===null||I.length===0||l&&!R)l?_(null):y();else{const V=l?0:r,B=V*4;let H=L.clippingState||null;p.value=H,H=_(I,S,B,M);for(let q=0;q!==B;++q)H[q]=n[q];L.clippingState=H,this.numIntersection=D?this.numPlanes:0,this.numPlanes+=V}};function y(){p.value!==n&&(p.value=n,p.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function _(w,S,M,I){const D=w!==null?w.length:0;let R=null;if(D!==0){if(R=p.value,I!==!0||R===null){const L=M+D*4,V=S.matrixWorldInverse;s.getNormalMatrix(V),(R===null||R.length<L)&&(R=new Float32Array(L));for(let B=0,H=M;B!==D;++B,H+=4)c.copy(w[B]).applyMatrix4(V,s),c.normal.toArray(R,H),R[H+3]=c.constant}p.value=R,p.needsUpdate=!0}return e.numPlanes=D,e.numIntersection=0,R}}function Ume(t){let e=new WeakMap;function n(c,s){return s===PT?c.mapping=ay:s===AT&&(c.mapping=ly),c}function r(c){if(c&&c.isTexture){const s=c.mapping;if(s===PT||s===AT)if(e.has(c)){const p=e.get(c).texture;return n(p,c.mapping)}else{const p=c.image;if(p&&p.height>0){const y=new Fde(p.height);return y.fromEquirectangularTexture(t,c),e.set(c,y),c.addEventListener("dispose",i),n(y.texture,c.mapping)}else return null}}return c}function i(c){const s=c.target;s.removeEventListener("dispose",i);const p=e.get(s);p!==void 0&&(e.delete(s),p.dispose())}function l(){e=new WeakMap}return{get:r,dispose:l}}const kv=4,Tz=[.125,.215,.35,.446,.526,.582],Rm=20,vE=new Yde,Pz=new bi;let yE=null,_E=0,xE=0,bE=!1;const Em=(1+Math.sqrt(5))/2,pv=1/Em,Az=[new At(-Em,pv,0),new At(Em,pv,0),new At(-pv,0,Em),new At(pv,0,Em),new At(0,Em,-pv),new At(0,Em,pv),new At(-1,1,-1),new At(1,1,-1),new At(-1,1,1),new At(1,1,1)],$me=new At;class Iz{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,i=100,l={}){const{size:c=256,position:s=$me}=l;yE=this._renderer.getRenderTarget(),_E=this._renderer.getActiveCubeFace(),xE=this._renderer.getActiveMipmapLevel(),bE=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(c);const p=this._allocateTargets();return p.depthBuffer=!0,this._sceneToCubeUV(e,r,i,p,s),n>0&&this._blur(p,0,0,n),this._applyPMREM(p),this._cleanup(p),p}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=kz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Lz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(yE,_E,xE),this._renderer.xr.enabled=bE,e.scissorTest=!1,V1(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===ay||e.mapping===ly?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),yE=this._renderer.getRenderTarget(),_E=this._renderer.getActiveCubeFace(),xE=this._renderer.getActiveMipmapLevel(),bE=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:Vl,minFilter:Vl,generateMipmaps:!1,type:vx,format:_u,colorSpace:Zm,depthBuffer:!1},i=Rz(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Rz(e,n,r);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Vme(l)),this._blurMaterial=jme(l,e,n)}return i}_compileMaterial(e){const n=new Ja(this._lodPlanes[0],e);this._renderer.compile(n,vE)}_sceneToCubeUV(e,n,r,i,l){const p=new Nl(90,1,n,r),y=[1,-1,1,1,1,1],_=[1,1,1,-1,-1,-1],w=this._renderer,S=w.autoClear,M=w.toneMapping;w.getClearColor(Pz),w.toneMapping=ep,w.autoClear=!1;const I=new dp({name:"PMREM.Background",side:tl,depthWrite:!1,depthTest:!1}),D=new Ja(new _x,I);let R=!1;const L=e.background;L?L.isColor&&(I.color.copy(L),e.background=null,R=!0):(I.color.copy(Pz),R=!0);for(let V=0;V<6;V++){const B=V%3;B===0?(p.up.set(0,y[V],0),p.position.set(l.x,l.y,l.z),p.lookAt(l.x+_[V],l.y,l.z)):B===1?(p.up.set(0,0,y[V]),p.position.set(l.x,l.y,l.z),p.lookAt(l.x,l.y+_[V],l.z)):(p.up.set(0,y[V],0),p.position.set(l.x,l.y,l.z),p.lookAt(l.x,l.y,l.z+_[V]));const H=this._cubeSize;V1(i,B*H,V>2?H:0,H,H),w.setRenderTarget(i),R&&w.render(D,p),w.render(e,p)}D.geometry.dispose(),D.material.dispose(),w.toneMapping=M,w.autoClear=S,e.background=L}_textureToCubeUV(e,n){const r=this._renderer,i=e.mapping===ay||e.mapping===ly;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=kz()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Lz());const l=i?this._cubemapMaterial:this._equirectMaterial,c=new Ja(this._lodPlanes[0],l),s=l.uniforms;s.envMap.value=e;const p=this._cubeSize;V1(n,0,0,3*p,2*p),r.setRenderTarget(n),r.render(c,vE)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;const i=this._lodPlanes.length;for(let l=1;l<i;l++){const c=Math.sqrt(this._sigmas[l]*this._sigmas[l]-this._sigmas[l-1]*this._sigmas[l-1]),s=Az[(i-l-1)%Az.length];this._blur(e,l-1,l,c,s)}n.autoClear=r}_blur(e,n,r,i,l){const c=this._pingPongRenderTarget;this._halfBlur(e,c,n,r,i,"latitudinal",l),this._halfBlur(c,e,r,r,i,"longitudinal",l)}_halfBlur(e,n,r,i,l,c,s){const p=this._renderer,y=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const _=3,w=new Ja(this._lodPlanes[i],y),S=y.uniforms,M=this._sizeLods[r]-1,I=isFinite(l)?Math.PI/(2*M):2*Math.PI/(2*Rm-1),D=l/I,R=isFinite(l)?1+Math.floor(_*D):Rm;R>Rm&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${R} samples when the maximum is set to ${Rm}`);const L=[];let V=0;for(let ee=0;ee<Rm;++ee){const se=ee/D,J=Math.exp(-se*se/2);L.push(J),ee===0?V+=J:ee<R&&(V+=2*J)}for(let ee=0;ee<L.length;ee++)L[ee]=L[ee]/V;S.envMap.value=e.texture,S.samples.value=R,S.weights.value=L,S.latitudinal.value=c==="latitudinal",s&&(S.poleAxis.value=s);const{_lodMax:B}=this;S.dTheta.value=I,S.mipInt.value=B-r;const H=this._sizeLods[i],q=3*H*(i>B-kv?i-B+kv:0),X=4*(this._cubeSize-H);V1(n,q,X,3*H,2*H),p.setRenderTarget(n),p.render(w,vE)}}function Vme(t){const e=[],n=[],r=[];let i=t;const l=t-kv+1+Tz.length;for(let c=0;c<l;c++){const s=Math.pow(2,i);n.push(s);let p=1/s;c>t-kv?p=Tz[c-t+kv-1]:c===0&&(p=0),r.push(p);const y=1/(s-2),_=-y,w=1+y,S=[_,_,w,_,w,w,_,_,w,w,_,w],M=6,I=6,D=3,R=2,L=1,V=new Float32Array(D*I*M),B=new Float32Array(R*I*M),H=new Float32Array(L*I*M);for(let X=0;X<M;X++){const ee=X%3*2/3-1,se=X>2?0:-1,J=[ee,se,0,ee+2/3,se,0,ee+2/3,se+1,0,ee,se,0,ee+2/3,se+1,0,ee,se+1,0];V.set(J,D*I*X),B.set(S,R*I*X);const $=[X,X,X,X,X,X];H.set($,L*I*X)}const q=new zh;q.setAttribute("position",new Ph(V,D)),q.setAttribute("uv",new Ph(B,R)),q.setAttribute("faceIndex",new Ph(H,L)),e.push(q),i>kv&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function Rz(t,e,n){const r=new hp(t,e,n);return r.texture.mapping=pS,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function V1(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function jme(t,e,n){const r=new Float32Array(Rm),i=new At(0,1,0);return new Yd({name:"SphericalGaussianBlur",defines:{n:Rm,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:yI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Qf,depthTest:!1,depthWrite:!1})}function Lz(){return new Yd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:yI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Qf,depthTest:!1,depthWrite:!1})}function kz(){return new Yd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:yI(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Qf,depthTest:!1,depthWrite:!1})}function yI(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Hme(t){let e=new WeakMap,n=null;function r(s){if(s&&s.isTexture){const p=s.mapping,y=p===PT||p===AT,_=p===ay||p===ly;if(y||_){let w=e.get(s);const S=w!==void 0?w.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==S)return n===null&&(n=new Iz(t)),w=y?n.fromEquirectangular(s,w):n.fromCubemap(s,w),w.texture.pmremVersion=s.pmremVersion,e.set(s,w),w.texture;if(w!==void 0)return w.texture;{const M=s.image;return y&&M&&M.height>0||_&&M&&i(M)?(n===null&&(n=new Iz(t)),w=y?n.fromEquirectangular(s):n.fromCubemap(s),w.texture.pmremVersion=s.pmremVersion,e.set(s,w),s.addEventListener("dispose",l),w.texture):null}}}return s}function i(s){let p=0;const y=6;for(let _=0;_<y;_++)s[_]!==void 0&&p++;return p===y}function l(s){const p=s.target;p.removeEventListener("dispose",l);const y=e.get(p);y!==void 0&&(e.delete(p),y.dispose())}function c(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:c}}function Gme(t){const e={};function n(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(r)}return e[r]=i,i}return{has:function(r){return n(r)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(r){const i=n(r);return i===null&&_b("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function Wme(t,e,n,r){const i={},l=new WeakMap;function c(w){const S=w.target;S.index!==null&&e.remove(S.index);for(const I in S.attributes)e.remove(S.attributes[I]);S.removeEventListener("dispose",c),delete i[S.id];const M=l.get(S);M&&(e.remove(M),l.delete(S)),r.releaseStatesOfGeometry(S),S.isInstancedBufferGeometry===!0&&delete S._maxInstanceCount,n.memory.geometries--}function s(w,S){return i[S.id]===!0||(S.addEventListener("dispose",c),i[S.id]=!0,n.memory.geometries++),S}function p(w){const S=w.attributes;for(const M in S)e.update(S[M],t.ARRAY_BUFFER)}function y(w){const S=[],M=w.index,I=w.attributes.position;let D=0;if(M!==null){const V=M.array;D=M.version;for(let B=0,H=V.length;B<H;B+=3){const q=V[B+0],X=V[B+1],ee=V[B+2];S.push(q,X,X,ee,ee,q)}}else if(I!==void 0){const V=I.array;D=I.version;for(let B=0,H=V.length/3-1;B<H;B+=3){const q=B+0,X=B+1,ee=B+2;S.push(q,X,X,ee,ee,q)}}else return;const R=new(u6(S)?p6:f6)(S,1);R.version=D;const L=l.get(w);L&&e.remove(L),l.set(w,R)}function _(w){const S=l.get(w);if(S){const M=w.index;M!==null&&S.version<M.version&&y(w)}else y(w);return l.get(w)}return{get:s,update:p,getWireframeAttribute:_}}function qme(t,e,n){let r;function i(S){r=S}let l,c;function s(S){l=S.type,c=S.bytesPerElement}function p(S,M){t.drawElements(r,M,l,S*c),n.update(M,r,1)}function y(S,M,I){I!==0&&(t.drawElementsInstanced(r,M,l,S*c,I),n.update(M,r,I))}function _(S,M,I){if(I===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,M,0,l,S,0,I);let R=0;for(let L=0;L<I;L++)R+=M[L];n.update(R,r,1)}function w(S,M,I,D){if(I===0)return;const R=e.get("WEBGL_multi_draw");if(R===null)for(let L=0;L<S.length;L++)y(S[L]/c,M[L],D[L]);else{R.multiDrawElementsInstancedWEBGL(r,M,0,l,S,0,D,0,I);let L=0;for(let V=0;V<I;V++)L+=M[V]*D[V];n.update(L,r,1)}}this.setMode=i,this.setIndex=s,this.render=p,this.renderInstances=y,this.renderMultiDraw=_,this.renderMultiDrawInstances=w}function Xme(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(l,c,s){switch(n.calls++,c){case t.TRIANGLES:n.triangles+=s*(l/3);break;case t.LINES:n.lines+=s*(l/2);break;case t.LINE_STRIP:n.lines+=s*(l-1);break;case t.LINE_LOOP:n.lines+=s*l;break;case t.POINTS:n.points+=s*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function i(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:i,update:r}}function Zme(t,e,n){const r=new WeakMap,i=new Do;function l(c,s,p){const y=c.morphTargetInfluences,_=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,w=_!==void 0?_.length:0;let S=r.get(s);if(S===void 0||S.count!==w){let $=function(){se.dispose(),r.delete(s),s.removeEventListener("dispose",$)};var M=$;S!==void 0&&S.texture.dispose();const I=s.morphAttributes.position!==void 0,D=s.morphAttributes.normal!==void 0,R=s.morphAttributes.color!==void 0,L=s.morphAttributes.position||[],V=s.morphAttributes.normal||[],B=s.morphAttributes.color||[];let H=0;I===!0&&(H=1),D===!0&&(H=2),R===!0&&(H=3);let q=s.attributes.position.count*H,X=1;q>e.maxTextureSize&&(X=Math.ceil(q/e.maxTextureSize),q=e.maxTextureSize);const ee=new Float32Array(q*X*4*w),se=new h6(ee,q,X,w);se.type=Ud,se.needsUpdate=!0;const J=H*4;for(let le=0;le<w;le++){const Ce=L[le],we=V[le],We=B[le],Fe=q*X*4*le;for(let Me=0;Me<Ce.count;Me++){const Ee=Me*J;I===!0&&(i.fromBufferAttribute(Ce,Me),ee[Fe+Ee+0]=i.x,ee[Fe+Ee+1]=i.y,ee[Fe+Ee+2]=i.z,ee[Fe+Ee+3]=0),D===!0&&(i.fromBufferAttribute(we,Me),ee[Fe+Ee+4]=i.x,ee[Fe+Ee+5]=i.y,ee[Fe+Ee+6]=i.z,ee[Fe+Ee+7]=0),R===!0&&(i.fromBufferAttribute(We,Me),ee[Fe+Ee+8]=i.x,ee[Fe+Ee+9]=i.y,ee[Fe+Ee+10]=i.z,ee[Fe+Ee+11]=We.itemSize===4?i.w:1)}}S={count:w,texture:se,size:new gi(q,X)},r.set(s,S),s.addEventListener("dispose",$)}if(c.isInstancedMesh===!0&&c.morphTexture!==null)p.getUniforms().setValue(t,"morphTexture",c.morphTexture,n);else{let I=0;for(let R=0;R<y.length;R++)I+=y[R];const D=s.morphTargetsRelative?1:1-I;p.getUniforms().setValue(t,"morphTargetBaseInfluence",D),p.getUniforms().setValue(t,"morphTargetInfluences",y)}p.getUniforms().setValue(t,"morphTargetsTexture",S.texture,n),p.getUniforms().setValue(t,"morphTargetsTextureSize",S.size)}return{update:l}}function Yme(t,e,n,r){let i=new WeakMap;function l(p){const y=r.render.frame,_=p.geometry,w=e.get(p,_);if(i.get(w)!==y&&(e.update(w),i.set(w,y)),p.isInstancedMesh&&(p.hasEventListener("dispose",s)===!1&&p.addEventListener("dispose",s),i.get(p)!==y&&(n.update(p.instanceMatrix,t.ARRAY_BUFFER),p.instanceColor!==null&&n.update(p.instanceColor,t.ARRAY_BUFFER),i.set(p,y))),p.isSkinnedMesh){const S=p.skeleton;i.get(S)!==y&&(S.update(),i.set(S,y))}return w}function c(){i=new WeakMap}function s(p){const y=p.target;y.removeEventListener("dispose",s),n.remove(y.instanceMatrix),y.instanceColor!==null&&n.remove(y.instanceColor)}return{update:l,dispose:c}}const x6=new Xs,Dz=new y6(1,1),b6=new h6,w6=new xde,S6=new v6,zz=[],Oz=[],Fz=new Float32Array(16),Nz=new Float32Array(9),Bz=new Float32Array(4);function by(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let l=zz[i];if(l===void 0&&(l=new Float32Array(i),zz[i]=l),e!==0){r.toArray(l,0);for(let c=1,s=0;c!==e;++c)s+=n,t[c].toArray(l,s)}return l}function ms(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function gs(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function gS(t,e){let n=Oz[e];n===void 0&&(n=new Int32Array(e),Oz[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function Kme(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Jme(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ms(n,e))return;t.uniform2fv(this.addr,e),gs(n,e)}}function Qme(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(ms(n,e))return;t.uniform3fv(this.addr,e),gs(n,e)}}function ege(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ms(n,e))return;t.uniform4fv(this.addr,e),gs(n,e)}}function tge(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(ms(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),gs(n,e)}else{if(ms(n,r))return;Bz.set(r),t.uniformMatrix2fv(this.addr,!1,Bz),gs(n,r)}}function nge(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(ms(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),gs(n,e)}else{if(ms(n,r))return;Nz.set(r),t.uniformMatrix3fv(this.addr,!1,Nz),gs(n,r)}}function rge(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(ms(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),gs(n,e)}else{if(ms(n,r))return;Fz.set(r),t.uniformMatrix4fv(this.addr,!1,Fz),gs(n,r)}}function ige(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function oge(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ms(n,e))return;t.uniform2iv(this.addr,e),gs(n,e)}}function sge(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(ms(n,e))return;t.uniform3iv(this.addr,e),gs(n,e)}}function age(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ms(n,e))return;t.uniform4iv(this.addr,e),gs(n,e)}}function lge(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function cge(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ms(n,e))return;t.uniform2uiv(this.addr,e),gs(n,e)}}function uge(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(ms(n,e))return;t.uniform3uiv(this.addr,e),gs(n,e)}}function hge(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ms(n,e))return;t.uniform4uiv(this.addr,e),gs(n,e)}}function dge(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i);let l;this.type===t.SAMPLER_2D_SHADOW?(Dz.compareFunction=c6,l=Dz):l=x6,n.setTexture2D(e||l,i)}function fge(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||w6,i)}function pge(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||S6,i)}function mge(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||b6,i)}function gge(t){switch(t){case 5126:return Kme;case 35664:return Jme;case 35665:return Qme;case 35666:return ege;case 35674:return tge;case 35675:return nge;case 35676:return rge;case 5124:case 35670:return ige;case 35667:case 35671:return oge;case 35668:case 35672:return sge;case 35669:case 35673:return age;case 5125:return lge;case 36294:return cge;case 36295:return uge;case 36296:return hge;case 35678:case 36198:case 36298:case 36306:case 35682:return dge;case 35679:case 36299:case 36307:return fge;case 35680:case 36300:case 36308:case 36293:return pge;case 36289:case 36303:case 36311:case 36292:return mge}}function vge(t,e){t.uniform1fv(this.addr,e)}function yge(t,e){const n=by(e,this.size,2);t.uniform2fv(this.addr,n)}function _ge(t,e){const n=by(e,this.size,3);t.uniform3fv(this.addr,n)}function xge(t,e){const n=by(e,this.size,4);t.uniform4fv(this.addr,n)}function bge(t,e){const n=by(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function wge(t,e){const n=by(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Sge(t,e){const n=by(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Mge(t,e){t.uniform1iv(this.addr,e)}function Cge(t,e){t.uniform2iv(this.addr,e)}function Ege(t,e){t.uniform3iv(this.addr,e)}function Tge(t,e){t.uniform4iv(this.addr,e)}function Pge(t,e){t.uniform1uiv(this.addr,e)}function Age(t,e){t.uniform2uiv(this.addr,e)}function Ige(t,e){t.uniform3uiv(this.addr,e)}function Rge(t,e){t.uniform4uiv(this.addr,e)}function Lge(t,e,n){const r=this.cache,i=e.length,l=gS(n,i);ms(r,l)||(t.uniform1iv(this.addr,l),gs(r,l));for(let c=0;c!==i;++c)n.setTexture2D(e[c]||x6,l[c])}function kge(t,e,n){const r=this.cache,i=e.length,l=gS(n,i);ms(r,l)||(t.uniform1iv(this.addr,l),gs(r,l));for(let c=0;c!==i;++c)n.setTexture3D(e[c]||w6,l[c])}function Dge(t,e,n){const r=this.cache,i=e.length,l=gS(n,i);ms(r,l)||(t.uniform1iv(this.addr,l),gs(r,l));for(let c=0;c!==i;++c)n.setTextureCube(e[c]||S6,l[c])}function zge(t,e,n){const r=this.cache,i=e.length,l=gS(n,i);ms(r,l)||(t.uniform1iv(this.addr,l),gs(r,l));for(let c=0;c!==i;++c)n.setTexture2DArray(e[c]||b6,l[c])}function Oge(t){switch(t){case 5126:return vge;case 35664:return yge;case 35665:return _ge;case 35666:return xge;case 35674:return bge;case 35675:return wge;case 35676:return Sge;case 5124:case 35670:return Mge;case 35667:case 35671:return Cge;case 35668:case 35672:return Ege;case 35669:case 35673:return Tge;case 5125:return Pge;case 36294:return Age;case 36295:return Ige;case 36296:return Rge;case 35678:case 36198:case 36298:case 36306:case 35682:return Lge;case 35679:case 36299:case 36307:return kge;case 35680:case 36300:case 36308:case 36293:return Dge;case 36289:case 36303:case 36311:case 36292:return zge}}class Fge{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.setValue=gge(n.type)}}class Nge{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=Oge(n.type)}}class Bge{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const i=this.seq;for(let l=0,c=i.length;l!==c;++l){const s=i[l];s.setValue(e,n[s.id],r)}}}const wE=/(\w+)(\])?(\[|\.)?/g;function Uz(t,e){t.seq.push(e),t.map[e.id]=e}function Uge(t,e,n){const r=t.name,i=r.length;for(wE.lastIndex=0;;){const l=wE.exec(r),c=wE.lastIndex;let s=l[1];const p=l[2]==="]",y=l[3];if(p&&(s=s|0),y===void 0||y==="["&&c+2===i){Uz(n,y===void 0?new Fge(s,t,e):new Nge(s,t,e));break}else{let w=n.map[s];w===void 0&&(w=new Bge(s),Uz(n,w)),n=w}}}class xb{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const l=e.getActiveUniform(n,i),c=e.getUniformLocation(n,l.name);Uge(l,c,this)}}setValue(e,n,r,i){const l=this.map[n];l!==void 0&&l.setValue(e,r,i)}setOptional(e,n,r){const i=n[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,n,r,i){for(let l=0,c=n.length;l!==c;++l){const s=n[l],p=r[s.id];p.needsUpdate!==!1&&s.setValue(e,p.value,i)}}static seqWithValue(e,n){const r=[];for(let i=0,l=e.length;i!==l;++i){const c=e[i];c.id in n&&r.push(c)}return r}}function $z(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}const $ge=37297;let Vge=0;function jge(t,e){const n=t.split(`
`),r=[],i=Math.max(e-6,0),l=Math.min(e+6,n.length);for(let c=i;c<l;c++){const s=c+1;r.push(`${s===e?">":" "} ${s}: ${n[c]}`)}return r.join(`
`)}const Vz=new zr;function Hge(t){li._getMatrix(Vz,li.workingColorSpace,t);const e=`mat3( ${Vz.elements.map(n=>n.toFixed(4))} )`;switch(li.getTransfer(t)){case Qb:return[e,"LinearTransferOETF"];case Li:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function jz(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),i=t.getShaderInfoLog(e).trim();if(r&&i==="")return"";const l=/ERROR: 0:(\d+)/.exec(i);if(l){const c=parseInt(l[1]);return n.toUpperCase()+`

`+i+`

`+jge(t.getShaderSource(e),c)}else return i}function Gge(t,e){const n=Hge(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function Wge(t,e){let n;switch(e){case KB:n="Linear";break;case Rhe:n="Reinhard";break;case Lhe:n="Cineon";break;case khe:n="ACESFilmic";break;case zhe:n="AgX";break;case Ohe:n="Neutral";break;case Dhe:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const j1=new At;function qge(){li.getLuminanceCoefficients(j1);const t=j1.x.toFixed(4),e=j1.y.toFixed(4),n=j1.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Xge(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(F0).join(`
`)}function Zge(t){const e=[];for(const n in t){const r=t[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function Yge(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const l=t.getActiveAttrib(e,i),c=l.name;let s=1;l.type===t.FLOAT_MAT2&&(s=2),l.type===t.FLOAT_MAT3&&(s=3),l.type===t.FLOAT_MAT4&&(s=4),n[c]={type:l.type,location:t.getAttribLocation(e,c),locationSize:s}}return n}function F0(t){return t!==""}function Hz(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Gz(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Kge=/^[ \t]*#include +<([\w\d./]+)>/gm;function sP(t){return t.replace(Kge,Qge)}const Jge=new Map;function Qge(t,e){let n=Br[e];if(n===void 0){const r=Jge.get(e);if(r!==void 0)n=Br[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return sP(n)}const eve=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Wz(t){return t.replace(eve,tve)}function tve(t,e,n,r){let i="";for(let l=parseInt(e);l<parseInt(n);l++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return i}function qz(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function nve(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===ZB?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===uhe?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Fd&&(e="SHADOWMAP_TYPE_VSM"),e}function rve(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case ay:case ly:e="ENVMAP_TYPE_CUBE";break;case pS:e="ENVMAP_TYPE_CUBE_UV";break}return e}function ive(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case ly:e="ENVMAP_MODE_REFRACTION";break}return e}function ove(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case YB:e="ENVMAP_BLENDING_MULTIPLY";break;case Ahe:e="ENVMAP_BLENDING_MIX";break;case Ihe:e="ENVMAP_BLENDING_ADD";break}return e}function sve(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function ave(t,e,n,r){const i=t.getContext(),l=n.defines;let c=n.vertexShader,s=n.fragmentShader;const p=nve(n),y=rve(n),_=ive(n),w=ove(n),S=sve(n),M=Xge(n),I=Zge(l),D=i.createProgram();let R,L,V=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(R=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I].filter(F0).join(`
`),R.length>0&&(R+=`
`),L=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I].filter(F0).join(`
`),L.length>0&&(L+=`
`)):(R=[qz(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+_:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+p:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(F0).join(`
`),L=[qz(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,I,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+y:"",n.envMap?"#define "+_:"",n.envMap?"#define "+w:"",S?"#define CUBEUV_TEXEL_WIDTH "+S.texelWidth:"",S?"#define CUBEUV_TEXEL_HEIGHT "+S.texelHeight:"",S?"#define CUBEUV_MAX_MIP "+S.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+p:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==ep?"#define TONE_MAPPING":"",n.toneMapping!==ep?Br.tonemapping_pars_fragment:"",n.toneMapping!==ep?Wge("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Br.colorspace_pars_fragment,Gge("linearToOutputTexel",n.outputColorSpace),qge(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(F0).join(`
`)),c=sP(c),c=Hz(c,n),c=Gz(c,n),s=sP(s),s=Hz(s,n),s=Gz(s,n),c=Wz(c),s=Wz(s),n.isRawShaderMaterial!==!0&&(V=`#version 300 es
`,R=[M,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+R,L=["#define varying in",n.glslVersion===ez?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===ez?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+L);const B=V+R+c,H=V+L+s,q=$z(i,i.VERTEX_SHADER,B),X=$z(i,i.FRAGMENT_SHADER,H);i.attachShader(D,q),i.attachShader(D,X),n.index0AttributeName!==void 0?i.bindAttribLocation(D,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(D,0,"position"),i.linkProgram(D);function ee(le){if(t.debug.checkShaderErrors){const Ce=i.getProgramInfoLog(D).trim(),we=i.getShaderInfoLog(q).trim(),We=i.getShaderInfoLog(X).trim();let Fe=!0,Me=!0;if(i.getProgramParameter(D,i.LINK_STATUS)===!1)if(Fe=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(i,D,q,X);else{const Ee=jz(i,q,"vertex"),Te=jz(i,X,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(D,i.VALIDATE_STATUS)+`

Material Name: `+le.name+`
Material Type: `+le.type+`

Program Info Log: `+Ce+`
`+Ee+`
`+Te)}else Ce!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Ce):(we===""||We==="")&&(Me=!1);Me&&(le.diagnostics={runnable:Fe,programLog:Ce,vertexShader:{log:we,prefix:R},fragmentShader:{log:We,prefix:L}})}i.deleteShader(q),i.deleteShader(X),se=new xb(i,D),J=Yge(i,D)}let se;this.getUniforms=function(){return se===void 0&&ee(this),se};let J;this.getAttributes=function(){return J===void 0&&ee(this),J};let $=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return $===!1&&($=i.getProgramParameter(D,$ge)),$},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(D),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Vge++,this.cacheKey=e,this.usedTimes=1,this.program=D,this.vertexShader=q,this.fragmentShader=X,this}let lve=0;class cve{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(n),l=this._getShaderStage(r),c=this._getShaderCacheForMaterial(e);return c.has(i)===!1&&(c.add(i),i.usedTimes++),c.has(l)===!1&&(c.add(l),l.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new uve(e),n.set(e,r)),r}}class uve{constructor(e){this.id=lve++,this.code=e,this.usedTimes=0}}function hve(t,e,n,r,i,l,c){const s=new mI,p=new cve,y=new Set,_=[],w=i.logarithmicDepthBuffer,S=i.vertexTextures;let M=i.precision;const I={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function D(J){return y.add(J),J===0?"uv":`uv${J}`}function R(J,$,le,Ce,we){const We=Ce.fog,Fe=we.geometry,Me=J.isMeshStandardMaterial?Ce.environment:null,Ee=(J.isMeshStandardMaterial?n:e).get(J.envMap||Me),Te=Ee&&Ee.mapping===pS?Ee.image.height:null,Ze=I[J.type];J.precision!==null&&(M=i.getMaxPrecision(J.precision),M!==J.precision&&console.warn("THREE.WebGLProgram.getParameters:",J.precision,"not supported, using",M,"instead."));const rt=Fe.morphAttributes.position||Fe.morphAttributes.normal||Fe.morphAttributes.color,Re=rt!==void 0?rt.length:0;let Qe=0;Fe.morphAttributes.position!==void 0&&(Qe=1),Fe.morphAttributes.normal!==void 0&&(Qe=2),Fe.morphAttributes.color!==void 0&&(Qe=3);let Vt,je,ct,Ct;if(Ze){const Ie=_h[Ze];Vt=Ie.vertexShader,je=Ie.fragmentShader}else Vt=J.vertexShader,je=J.fragmentShader,p.update(J),ct=p.getVertexShaderID(J),Ct=p.getFragmentShaderID(J);const ut=t.getRenderTarget(),lt=t.state.buffers.depth.getReversed(),_t=we.isInstancedMesh===!0,wt=we.isBatchedMesh===!0,cn=!!J.map,dn=!!J.matcap,tn=!!Ee,Je=!!J.aoMap,Tn=!!J.lightMap,Kt=!!J.bumpMap,fn=!!J.normalMap,Ut=!!J.displacementMap,On=!!J.emissiveMap,vn=!!J.metalnessMap,Ue=!!J.roughnessMap,Se=J.anisotropy>0,yt=J.clearcoat>0,Nt=J.dispersion>0,Ht=J.iridescence>0,Ot=J.sheen>0,un=J.transmission>0,Gt=Se&&!!J.anisotropyMap,Zt=yt&&!!J.clearcoatMap,Nn=yt&&!!J.clearcoatNormalMap,Yt=yt&&!!J.clearcoatRoughnessMap,Pe=Ht&&!!J.iridescenceMap,ae=Ht&&!!J.iridescenceThicknessMap,ue=Ot&&!!J.sheenColorMap,ne=Ot&&!!J.sheenRoughnessMap,fe=!!J.specularMap,Oe=!!J.specularColorMap,Ke=!!J.specularIntensityMap,ye=un&&!!J.transmissionMap,Ae=un&&!!J.thicknessMap,Be=!!J.gradientMap,$e=!!J.alphaMap,He=J.alphaTest>0,dt=!!J.alphaHash,qe=!!J.extensions;let $t=ep;J.toneMapped&&(ut===null||ut.isXRRenderTarget===!0)&&($t=t.toneMapping);const Jt={shaderID:Ze,shaderType:J.type,shaderName:J.name,vertexShader:Vt,fragmentShader:je,defines:J.defines,customVertexShaderID:ct,customFragmentShaderID:Ct,isRawShaderMaterial:J.isRawShaderMaterial===!0,glslVersion:J.glslVersion,precision:M,batching:wt,batchingColor:wt&&we._colorsTexture!==null,instancing:_t,instancingColor:_t&&we.instanceColor!==null,instancingMorph:_t&&we.morphTexture!==null,supportsVertexTextures:S,outputColorSpace:ut===null?t.outputColorSpace:ut.isXRRenderTarget===!0?ut.texture.colorSpace:Zm,alphaToCoverage:!!J.alphaToCoverage,map:cn,matcap:dn,envMap:tn,envMapMode:tn&&Ee.mapping,envMapCubeUVHeight:Te,aoMap:Je,lightMap:Tn,bumpMap:Kt,normalMap:fn,displacementMap:S&&Ut,emissiveMap:On,normalMapObjectSpace:fn&&J.normalMapType===$he,normalMapTangentSpace:fn&&J.normalMapType===Uhe,metalnessMap:vn,roughnessMap:Ue,anisotropy:Se,anisotropyMap:Gt,clearcoat:yt,clearcoatMap:Zt,clearcoatNormalMap:Nn,clearcoatRoughnessMap:Yt,dispersion:Nt,iridescence:Ht,iridescenceMap:Pe,iridescenceThicknessMap:ae,sheen:Ot,sheenColorMap:ue,sheenRoughnessMap:ne,specularMap:fe,specularColorMap:Oe,specularIntensityMap:Ke,transmission:un,transmissionMap:ye,thicknessMap:Ae,gradientMap:Be,opaque:J.transparent===!1&&J.blending===Gv&&J.alphaToCoverage===!1,alphaMap:$e,alphaTest:He,alphaHash:dt,combine:J.combine,mapUv:cn&&D(J.map.channel),aoMapUv:Je&&D(J.aoMap.channel),lightMapUv:Tn&&D(J.lightMap.channel),bumpMapUv:Kt&&D(J.bumpMap.channel),normalMapUv:fn&&D(J.normalMap.channel),displacementMapUv:Ut&&D(J.displacementMap.channel),emissiveMapUv:On&&D(J.emissiveMap.channel),metalnessMapUv:vn&&D(J.metalnessMap.channel),roughnessMapUv:Ue&&D(J.roughnessMap.channel),anisotropyMapUv:Gt&&D(J.anisotropyMap.channel),clearcoatMapUv:Zt&&D(J.clearcoatMap.channel),clearcoatNormalMapUv:Nn&&D(J.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Yt&&D(J.clearcoatRoughnessMap.channel),iridescenceMapUv:Pe&&D(J.iridescenceMap.channel),iridescenceThicknessMapUv:ae&&D(J.iridescenceThicknessMap.channel),sheenColorMapUv:ue&&D(J.sheenColorMap.channel),sheenRoughnessMapUv:ne&&D(J.sheenRoughnessMap.channel),specularMapUv:fe&&D(J.specularMap.channel),specularColorMapUv:Oe&&D(J.specularColorMap.channel),specularIntensityMapUv:Ke&&D(J.specularIntensityMap.channel),transmissionMapUv:ye&&D(J.transmissionMap.channel),thicknessMapUv:Ae&&D(J.thicknessMap.channel),alphaMapUv:$e&&D(J.alphaMap.channel),vertexTangents:!!Fe.attributes.tangent&&(fn||Se),vertexColors:J.vertexColors,vertexAlphas:J.vertexColors===!0&&!!Fe.attributes.color&&Fe.attributes.color.itemSize===4,pointsUvs:we.isPoints===!0&&!!Fe.attributes.uv&&(cn||$e),fog:!!We,useFog:J.fog===!0,fogExp2:!!We&&We.isFogExp2,flatShading:J.flatShading===!0,sizeAttenuation:J.sizeAttenuation===!0,logarithmicDepthBuffer:w,reverseDepthBuffer:lt,skinning:we.isSkinnedMesh===!0,morphTargets:Fe.morphAttributes.position!==void 0,morphNormals:Fe.morphAttributes.normal!==void 0,morphColors:Fe.morphAttributes.color!==void 0,morphTargetsCount:Re,morphTextureStride:Qe,numDirLights:$.directional.length,numPointLights:$.point.length,numSpotLights:$.spot.length,numSpotLightMaps:$.spotLightMap.length,numRectAreaLights:$.rectArea.length,numHemiLights:$.hemi.length,numDirLightShadows:$.directionalShadowMap.length,numPointLightShadows:$.pointShadowMap.length,numSpotLightShadows:$.spotShadowMap.length,numSpotLightShadowsWithMaps:$.numSpotLightShadowsWithMaps,numLightProbes:$.numLightProbes,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:J.dithering,shadowMapEnabled:t.shadowMap.enabled&&le.length>0,shadowMapType:t.shadowMap.type,toneMapping:$t,decodeVideoTexture:cn&&J.map.isVideoTexture===!0&&li.getTransfer(J.map.colorSpace)===Li,decodeVideoTextureEmissive:On&&J.emissiveMap.isVideoTexture===!0&&li.getTransfer(J.emissiveMap.colorSpace)===Li,premultipliedAlpha:J.premultipliedAlpha,doubleSided:J.side===Bd,flipSided:J.side===tl,useDepthPacking:J.depthPacking>=0,depthPacking:J.depthPacking||0,index0AttributeName:J.index0AttributeName,extensionClipCullDistance:qe&&J.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(qe&&J.extensions.multiDraw===!0||wt)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:J.customProgramCacheKey()};return Jt.vertexUv1s=y.has(1),Jt.vertexUv2s=y.has(2),Jt.vertexUv3s=y.has(3),y.clear(),Jt}function L(J){const $=[];if(J.shaderID?$.push(J.shaderID):($.push(J.customVertexShaderID),$.push(J.customFragmentShaderID)),J.defines!==void 0)for(const le in J.defines)$.push(le),$.push(J.defines[le]);return J.isRawShaderMaterial===!1&&(V($,J),B($,J),$.push(t.outputColorSpace)),$.push(J.customProgramCacheKey),$.join()}function V(J,$){J.push($.precision),J.push($.outputColorSpace),J.push($.envMapMode),J.push($.envMapCubeUVHeight),J.push($.mapUv),J.push($.alphaMapUv),J.push($.lightMapUv),J.push($.aoMapUv),J.push($.bumpMapUv),J.push($.normalMapUv),J.push($.displacementMapUv),J.push($.emissiveMapUv),J.push($.metalnessMapUv),J.push($.roughnessMapUv),J.push($.anisotropyMapUv),J.push($.clearcoatMapUv),J.push($.clearcoatNormalMapUv),J.push($.clearcoatRoughnessMapUv),J.push($.iridescenceMapUv),J.push($.iridescenceThicknessMapUv),J.push($.sheenColorMapUv),J.push($.sheenRoughnessMapUv),J.push($.specularMapUv),J.push($.specularColorMapUv),J.push($.specularIntensityMapUv),J.push($.transmissionMapUv),J.push($.thicknessMapUv),J.push($.combine),J.push($.fogExp2),J.push($.sizeAttenuation),J.push($.morphTargetsCount),J.push($.morphAttributeCount),J.push($.numDirLights),J.push($.numPointLights),J.push($.numSpotLights),J.push($.numSpotLightMaps),J.push($.numHemiLights),J.push($.numRectAreaLights),J.push($.numDirLightShadows),J.push($.numPointLightShadows),J.push($.numSpotLightShadows),J.push($.numSpotLightShadowsWithMaps),J.push($.numLightProbes),J.push($.shadowMapType),J.push($.toneMapping),J.push($.numClippingPlanes),J.push($.numClipIntersection),J.push($.depthPacking)}function B(J,$){s.disableAll(),$.supportsVertexTextures&&s.enable(0),$.instancing&&s.enable(1),$.instancingColor&&s.enable(2),$.instancingMorph&&s.enable(3),$.matcap&&s.enable(4),$.envMap&&s.enable(5),$.normalMapObjectSpace&&s.enable(6),$.normalMapTangentSpace&&s.enable(7),$.clearcoat&&s.enable(8),$.iridescence&&s.enable(9),$.alphaTest&&s.enable(10),$.vertexColors&&s.enable(11),$.vertexAlphas&&s.enable(12),$.vertexUv1s&&s.enable(13),$.vertexUv2s&&s.enable(14),$.vertexUv3s&&s.enable(15),$.vertexTangents&&s.enable(16),$.anisotropy&&s.enable(17),$.alphaHash&&s.enable(18),$.batching&&s.enable(19),$.dispersion&&s.enable(20),$.batchingColor&&s.enable(21),J.push(s.mask),s.disableAll(),$.fog&&s.enable(0),$.useFog&&s.enable(1),$.flatShading&&s.enable(2),$.logarithmicDepthBuffer&&s.enable(3),$.reverseDepthBuffer&&s.enable(4),$.skinning&&s.enable(5),$.morphTargets&&s.enable(6),$.morphNormals&&s.enable(7),$.morphColors&&s.enable(8),$.premultipliedAlpha&&s.enable(9),$.shadowMapEnabled&&s.enable(10),$.doubleSided&&s.enable(11),$.flipSided&&s.enable(12),$.useDepthPacking&&s.enable(13),$.dithering&&s.enable(14),$.transmission&&s.enable(15),$.sheen&&s.enable(16),$.opaque&&s.enable(17),$.pointsUvs&&s.enable(18),$.decodeVideoTexture&&s.enable(19),$.decodeVideoTextureEmissive&&s.enable(20),$.alphaToCoverage&&s.enable(21),J.push(s.mask)}function H(J){const $=I[J.type];let le;if($){const Ce=_h[$];le=kde.clone(Ce.uniforms)}else le=J.uniforms;return le}function q(J,$){let le;for(let Ce=0,we=_.length;Ce<we;Ce++){const We=_[Ce];if(We.cacheKey===$){le=We,++le.usedTimes;break}}return le===void 0&&(le=new ave(t,$,J,l),_.push(le)),le}function X(J){if(--J.usedTimes===0){const $=_.indexOf(J);_[$]=_[_.length-1],_.pop(),J.destroy()}}function ee(J){p.remove(J)}function se(){p.dispose()}return{getParameters:R,getProgramCacheKey:L,getUniforms:H,acquireProgram:q,releaseProgram:X,releaseShaderCache:ee,programs:_,dispose:se}}function dve(){let t=new WeakMap;function e(c){return t.has(c)}function n(c){let s=t.get(c);return s===void 0&&(s={},t.set(c,s)),s}function r(c){t.delete(c)}function i(c,s,p){t.get(c)[s]=p}function l(){t=new WeakMap}return{has:e,get:n,remove:r,update:i,dispose:l}}function fve(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Xz(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Zz(){const t=[];let e=0;const n=[],r=[],i=[];function l(){e=0,n.length=0,r.length=0,i.length=0}function c(w,S,M,I,D,R){let L=t[e];return L===void 0?(L={id:w.id,object:w,geometry:S,material:M,groupOrder:I,renderOrder:w.renderOrder,z:D,group:R},t[e]=L):(L.id=w.id,L.object=w,L.geometry=S,L.material=M,L.groupOrder=I,L.renderOrder=w.renderOrder,L.z=D,L.group=R),e++,L}function s(w,S,M,I,D,R){const L=c(w,S,M,I,D,R);M.transmission>0?r.push(L):M.transparent===!0?i.push(L):n.push(L)}function p(w,S,M,I,D,R){const L=c(w,S,M,I,D,R);M.transmission>0?r.unshift(L):M.transparent===!0?i.unshift(L):n.unshift(L)}function y(w,S){n.length>1&&n.sort(w||fve),r.length>1&&r.sort(S||Xz),i.length>1&&i.sort(S||Xz)}function _(){for(let w=e,S=t.length;w<S;w++){const M=t[w];if(M.id===null)break;M.id=null,M.object=null,M.geometry=null,M.material=null,M.group=null}}return{opaque:n,transmissive:r,transparent:i,init:l,push:s,unshift:p,finish:_,sort:y}}function pve(){let t=new WeakMap;function e(r,i){const l=t.get(r);let c;return l===void 0?(c=new Zz,t.set(r,[c])):i>=l.length?(c=new Zz,l.push(c)):c=l[i],c}function n(){t=new WeakMap}return{get:e,dispose:n}}function mve(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new At,color:new bi};break;case"SpotLight":n={position:new At,direction:new At,color:new bi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new At,color:new bi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new At,skyColor:new bi,groundColor:new bi};break;case"RectAreaLight":n={color:new bi,position:new At,halfWidth:new At,halfHeight:new At};break}return t[e.id]=n,n}}}function gve(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gi};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gi};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gi,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let vve=0;function yve(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function _ve(t){const e=new mve,n=gve(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let y=0;y<9;y++)r.probe.push(new At);const i=new At,l=new Pi,c=new Pi;function s(y){let _=0,w=0,S=0;for(let J=0;J<9;J++)r.probe[J].set(0,0,0);let M=0,I=0,D=0,R=0,L=0,V=0,B=0,H=0,q=0,X=0,ee=0;y.sort(yve);for(let J=0,$=y.length;J<$;J++){const le=y[J],Ce=le.color,we=le.intensity,We=le.distance,Fe=le.shadow&&le.shadow.map?le.shadow.map.texture:null;if(le.isAmbientLight)_+=Ce.r*we,w+=Ce.g*we,S+=Ce.b*we;else if(le.isLightProbe){for(let Me=0;Me<9;Me++)r.probe[Me].addScaledVector(le.sh.coefficients[Me],we);ee++}else if(le.isDirectionalLight){const Me=e.get(le);if(Me.color.copy(le.color).multiplyScalar(le.intensity),le.castShadow){const Ee=le.shadow,Te=n.get(le);Te.shadowIntensity=Ee.intensity,Te.shadowBias=Ee.bias,Te.shadowNormalBias=Ee.normalBias,Te.shadowRadius=Ee.radius,Te.shadowMapSize=Ee.mapSize,r.directionalShadow[M]=Te,r.directionalShadowMap[M]=Fe,r.directionalShadowMatrix[M]=le.shadow.matrix,V++}r.directional[M]=Me,M++}else if(le.isSpotLight){const Me=e.get(le);Me.position.setFromMatrixPosition(le.matrixWorld),Me.color.copy(Ce).multiplyScalar(we),Me.distance=We,Me.coneCos=Math.cos(le.angle),Me.penumbraCos=Math.cos(le.angle*(1-le.penumbra)),Me.decay=le.decay,r.spot[D]=Me;const Ee=le.shadow;if(le.map&&(r.spotLightMap[q]=le.map,q++,Ee.updateMatrices(le),le.castShadow&&X++),r.spotLightMatrix[D]=Ee.matrix,le.castShadow){const Te=n.get(le);Te.shadowIntensity=Ee.intensity,Te.shadowBias=Ee.bias,Te.shadowNormalBias=Ee.normalBias,Te.shadowRadius=Ee.radius,Te.shadowMapSize=Ee.mapSize,r.spotShadow[D]=Te,r.spotShadowMap[D]=Fe,H++}D++}else if(le.isRectAreaLight){const Me=e.get(le);Me.color.copy(Ce).multiplyScalar(we),Me.halfWidth.set(le.width*.5,0,0),Me.halfHeight.set(0,le.height*.5,0),r.rectArea[R]=Me,R++}else if(le.isPointLight){const Me=e.get(le);if(Me.color.copy(le.color).multiplyScalar(le.intensity),Me.distance=le.distance,Me.decay=le.decay,le.castShadow){const Ee=le.shadow,Te=n.get(le);Te.shadowIntensity=Ee.intensity,Te.shadowBias=Ee.bias,Te.shadowNormalBias=Ee.normalBias,Te.shadowRadius=Ee.radius,Te.shadowMapSize=Ee.mapSize,Te.shadowCameraNear=Ee.camera.near,Te.shadowCameraFar=Ee.camera.far,r.pointShadow[I]=Te,r.pointShadowMap[I]=Fe,r.pointShadowMatrix[I]=le.shadow.matrix,B++}r.point[I]=Me,I++}else if(le.isHemisphereLight){const Me=e.get(le);Me.skyColor.copy(le.color).multiplyScalar(we),Me.groundColor.copy(le.groundColor).multiplyScalar(we),r.hemi[L]=Me,L++}}R>0&&(t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=qn.LTC_FLOAT_1,r.rectAreaLTC2=qn.LTC_FLOAT_2):(r.rectAreaLTC1=qn.LTC_HALF_1,r.rectAreaLTC2=qn.LTC_HALF_2)),r.ambient[0]=_,r.ambient[1]=w,r.ambient[2]=S;const se=r.hash;(se.directionalLength!==M||se.pointLength!==I||se.spotLength!==D||se.rectAreaLength!==R||se.hemiLength!==L||se.numDirectionalShadows!==V||se.numPointShadows!==B||se.numSpotShadows!==H||se.numSpotMaps!==q||se.numLightProbes!==ee)&&(r.directional.length=M,r.spot.length=D,r.rectArea.length=R,r.point.length=I,r.hemi.length=L,r.directionalShadow.length=V,r.directionalShadowMap.length=V,r.pointShadow.length=B,r.pointShadowMap.length=B,r.spotShadow.length=H,r.spotShadowMap.length=H,r.directionalShadowMatrix.length=V,r.pointShadowMatrix.length=B,r.spotLightMatrix.length=H+q-X,r.spotLightMap.length=q,r.numSpotLightShadowsWithMaps=X,r.numLightProbes=ee,se.directionalLength=M,se.pointLength=I,se.spotLength=D,se.rectAreaLength=R,se.hemiLength=L,se.numDirectionalShadows=V,se.numPointShadows=B,se.numSpotShadows=H,se.numSpotMaps=q,se.numLightProbes=ee,r.version=vve++)}function p(y,_){let w=0,S=0,M=0,I=0,D=0;const R=_.matrixWorldInverse;for(let L=0,V=y.length;L<V;L++){const B=y[L];if(B.isDirectionalLight){const H=r.directional[w];H.direction.setFromMatrixPosition(B.matrixWorld),i.setFromMatrixPosition(B.target.matrixWorld),H.direction.sub(i),H.direction.transformDirection(R),w++}else if(B.isSpotLight){const H=r.spot[M];H.position.setFromMatrixPosition(B.matrixWorld),H.position.applyMatrix4(R),H.direction.setFromMatrixPosition(B.matrixWorld),i.setFromMatrixPosition(B.target.matrixWorld),H.direction.sub(i),H.direction.transformDirection(R),M++}else if(B.isRectAreaLight){const H=r.rectArea[I];H.position.setFromMatrixPosition(B.matrixWorld),H.position.applyMatrix4(R),c.identity(),l.copy(B.matrixWorld),l.premultiply(R),c.extractRotation(l),H.halfWidth.set(B.width*.5,0,0),H.halfHeight.set(0,B.height*.5,0),H.halfWidth.applyMatrix4(c),H.halfHeight.applyMatrix4(c),I++}else if(B.isPointLight){const H=r.point[S];H.position.setFromMatrixPosition(B.matrixWorld),H.position.applyMatrix4(R),S++}else if(B.isHemisphereLight){const H=r.hemi[D];H.direction.setFromMatrixPosition(B.matrixWorld),H.direction.transformDirection(R),D++}}}return{setup:s,setupView:p,state:r}}function Yz(t){const e=new _ve(t),n=[],r=[];function i(_){y.camera=_,n.length=0,r.length=0}function l(_){n.push(_)}function c(_){r.push(_)}function s(){e.setup(n)}function p(_){e.setupView(n,_)}const y={lightsArray:n,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:y,setupLights:s,setupLightsView:p,pushLight:l,pushShadow:c}}function xve(t){let e=new WeakMap;function n(i,l=0){const c=e.get(i);let s;return c===void 0?(s=new Yz(t),e.set(i,[s])):l>=c.length?(s=new Yz(t),c.push(s)):s=c[l],s}function r(){e=new WeakMap}return{get:n,dispose:r}}const bve=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,wve=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Sve(t,e,n){let r=new gI;const i=new gi,l=new gi,c=new Do,s=new Wde({depthPacking:Bhe}),p=new qde,y={},_=n.maxTextureSize,w={[up]:tl,[tl]:up,[Bd]:Bd},S=new Yd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gi},radius:{value:4}},vertexShader:bve,fragmentShader:wve}),M=S.clone();M.defines.HORIZONTAL_PASS=1;const I=new zh;I.setAttribute("position",new Ph(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const D=new Ja(I,S),R=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ZB;let L=this.type;this.render=function(X,ee,se){if(R.enabled===!1||R.autoUpdate===!1&&R.needsUpdate===!1||X.length===0)return;const J=t.getRenderTarget(),$=t.getActiveCubeFace(),le=t.getActiveMipmapLevel(),Ce=t.state;Ce.setBlending(Qf),Ce.buffers.color.setClear(1,1,1,1),Ce.buffers.depth.setTest(!0),Ce.setScissorTest(!1);const we=L!==Fd&&this.type===Fd,We=L===Fd&&this.type!==Fd;for(let Fe=0,Me=X.length;Fe<Me;Fe++){const Ee=X[Fe],Te=Ee.shadow;if(Te===void 0){console.warn("THREE.WebGLShadowMap:",Ee,"has no shadow.");continue}if(Te.autoUpdate===!1&&Te.needsUpdate===!1)continue;i.copy(Te.mapSize);const Ze=Te.getFrameExtents();if(i.multiply(Ze),l.copy(Te.mapSize),(i.x>_||i.y>_)&&(i.x>_&&(l.x=Math.floor(_/Ze.x),i.x=l.x*Ze.x,Te.mapSize.x=l.x),i.y>_&&(l.y=Math.floor(_/Ze.y),i.y=l.y*Ze.y,Te.mapSize.y=l.y)),Te.map===null||we===!0||We===!0){const Re=this.type!==Fd?{minFilter:bu,magFilter:bu}:{};Te.map!==null&&Te.map.dispose(),Te.map=new hp(i.x,i.y,Re),Te.map.texture.name=Ee.name+".shadowMap",Te.camera.updateProjectionMatrix()}t.setRenderTarget(Te.map),t.clear();const rt=Te.getViewportCount();for(let Re=0;Re<rt;Re++){const Qe=Te.getViewport(Re);c.set(l.x*Qe.x,l.y*Qe.y,l.x*Qe.z,l.y*Qe.w),Ce.viewport(c),Te.updateMatrices(Ee,Re),r=Te.getFrustum(),H(ee,se,Te.camera,Ee,this.type)}Te.isPointLightShadow!==!0&&this.type===Fd&&V(Te,se),Te.needsUpdate=!1}L=this.type,R.needsUpdate=!1,t.setRenderTarget(J,$,le)};function V(X,ee){const se=e.update(D);S.defines.VSM_SAMPLES!==X.blurSamples&&(S.defines.VSM_SAMPLES=X.blurSamples,M.defines.VSM_SAMPLES=X.blurSamples,S.needsUpdate=!0,M.needsUpdate=!0),X.mapPass===null&&(X.mapPass=new hp(i.x,i.y)),S.uniforms.shadow_pass.value=X.map.texture,S.uniforms.resolution.value=X.mapSize,S.uniforms.radius.value=X.radius,t.setRenderTarget(X.mapPass),t.clear(),t.renderBufferDirect(ee,null,se,S,D,null),M.uniforms.shadow_pass.value=X.mapPass.texture,M.uniforms.resolution.value=X.mapSize,M.uniforms.radius.value=X.radius,t.setRenderTarget(X.map),t.clear(),t.renderBufferDirect(ee,null,se,M,D,null)}function B(X,ee,se,J){let $=null;const le=se.isPointLight===!0?X.customDistanceMaterial:X.customDepthMaterial;if(le!==void 0)$=le;else if($=se.isPointLight===!0?p:s,t.localClippingEnabled&&ee.clipShadows===!0&&Array.isArray(ee.clippingPlanes)&&ee.clippingPlanes.length!==0||ee.displacementMap&&ee.displacementScale!==0||ee.alphaMap&&ee.alphaTest>0||ee.map&&ee.alphaTest>0){const Ce=$.uuid,we=ee.uuid;let We=y[Ce];We===void 0&&(We={},y[Ce]=We);let Fe=We[we];Fe===void 0&&(Fe=$.clone(),We[we]=Fe,ee.addEventListener("dispose",q)),$=Fe}if($.visible=ee.visible,$.wireframe=ee.wireframe,J===Fd?$.side=ee.shadowSide!==null?ee.shadowSide:ee.side:$.side=ee.shadowSide!==null?ee.shadowSide:w[ee.side],$.alphaMap=ee.alphaMap,$.alphaTest=ee.alphaTest,$.map=ee.map,$.clipShadows=ee.clipShadows,$.clippingPlanes=ee.clippingPlanes,$.clipIntersection=ee.clipIntersection,$.displacementMap=ee.displacementMap,$.displacementScale=ee.displacementScale,$.displacementBias=ee.displacementBias,$.wireframeLinewidth=ee.wireframeLinewidth,$.linewidth=ee.linewidth,se.isPointLight===!0&&$.isMeshDistanceMaterial===!0){const Ce=t.properties.get($);Ce.light=se}return $}function H(X,ee,se,J,$){if(X.visible===!1)return;if(X.layers.test(ee.layers)&&(X.isMesh||X.isLine||X.isPoints)&&(X.castShadow||X.receiveShadow&&$===Fd)&&(!X.frustumCulled||r.intersectsObject(X))){X.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,X.matrixWorld);const we=e.update(X),We=X.material;if(Array.isArray(We)){const Fe=we.groups;for(let Me=0,Ee=Fe.length;Me<Ee;Me++){const Te=Fe[Me],Ze=We[Te.materialIndex];if(Ze&&Ze.visible){const rt=B(X,Ze,J,$);X.onBeforeShadow(t,X,ee,se,we,rt,Te),t.renderBufferDirect(se,null,we,rt,X,Te),X.onAfterShadow(t,X,ee,se,we,rt,Te)}}}else if(We.visible){const Fe=B(X,We,J,$);X.onBeforeShadow(t,X,ee,se,we,Fe,null),t.renderBufferDirect(se,null,we,Fe,X,null),X.onAfterShadow(t,X,ee,se,we,Fe,null)}}const Ce=X.children;for(let we=0,We=Ce.length;we<We;we++)H(Ce[we],ee,se,J,$)}function q(X){X.target.removeEventListener("dispose",q);for(const se in y){const J=y[se],$=X.target.uuid;$ in J&&(J[$].dispose(),delete J[$])}}}const Mve={[bT]:wT,[ST]:ET,[MT]:TT,[sy]:CT,[wT]:bT,[ET]:ST,[TT]:MT,[CT]:sy};function Cve(t,e){function n(){let ye=!1;const Ae=new Do;let Be=null;const $e=new Do(0,0,0,0);return{setMask:function(He){Be!==He&&!ye&&(t.colorMask(He,He,He,He),Be=He)},setLocked:function(He){ye=He},setClear:function(He,dt,qe,$t,Jt){Jt===!0&&(He*=$t,dt*=$t,qe*=$t),Ae.set(He,dt,qe,$t),$e.equals(Ae)===!1&&(t.clearColor(He,dt,qe,$t),$e.copy(Ae))},reset:function(){ye=!1,Be=null,$e.set(-1,0,0,0)}}}function r(){let ye=!1,Ae=!1,Be=null,$e=null,He=null;return{setReversed:function(dt){if(Ae!==dt){const qe=e.get("EXT_clip_control");dt?qe.clipControlEXT(qe.LOWER_LEFT_EXT,qe.ZERO_TO_ONE_EXT):qe.clipControlEXT(qe.LOWER_LEFT_EXT,qe.NEGATIVE_ONE_TO_ONE_EXT),Ae=dt;const $t=He;He=null,this.setClear($t)}},getReversed:function(){return Ae},setTest:function(dt){dt?ut(t.DEPTH_TEST):lt(t.DEPTH_TEST)},setMask:function(dt){Be!==dt&&!ye&&(t.depthMask(dt),Be=dt)},setFunc:function(dt){if(Ae&&(dt=Mve[dt]),$e!==dt){switch(dt){case bT:t.depthFunc(t.NEVER);break;case wT:t.depthFunc(t.ALWAYS);break;case ST:t.depthFunc(t.LESS);break;case sy:t.depthFunc(t.LEQUAL);break;case MT:t.depthFunc(t.EQUAL);break;case CT:t.depthFunc(t.GEQUAL);break;case ET:t.depthFunc(t.GREATER);break;case TT:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}$e=dt}},setLocked:function(dt){ye=dt},setClear:function(dt){He!==dt&&(Ae&&(dt=1-dt),t.clearDepth(dt),He=dt)},reset:function(){ye=!1,Be=null,$e=null,He=null,Ae=!1}}}function i(){let ye=!1,Ae=null,Be=null,$e=null,He=null,dt=null,qe=null,$t=null,Jt=null;return{setTest:function(Ie){ye||(Ie?ut(t.STENCIL_TEST):lt(t.STENCIL_TEST))},setMask:function(Ie){Ae!==Ie&&!ye&&(t.stencilMask(Ie),Ae=Ie)},setFunc:function(Ie,ot,mt){(Be!==Ie||$e!==ot||He!==mt)&&(t.stencilFunc(Ie,ot,mt),Be=Ie,$e=ot,He=mt)},setOp:function(Ie,ot,mt){(dt!==Ie||qe!==ot||$t!==mt)&&(t.stencilOp(Ie,ot,mt),dt=Ie,qe=ot,$t=mt)},setLocked:function(Ie){ye=Ie},setClear:function(Ie){Jt!==Ie&&(t.clearStencil(Ie),Jt=Ie)},reset:function(){ye=!1,Ae=null,Be=null,$e=null,He=null,dt=null,qe=null,$t=null,Jt=null}}}const l=new n,c=new r,s=new i,p=new WeakMap,y=new WeakMap;let _={},w={},S=new WeakMap,M=[],I=null,D=!1,R=null,L=null,V=null,B=null,H=null,q=null,X=null,ee=new bi(0,0,0),se=0,J=!1,$=null,le=null,Ce=null,we=null,We=null;const Fe=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Me=!1,Ee=0;const Te=t.getParameter(t.VERSION);Te.indexOf("WebGL")!==-1?(Ee=parseFloat(/^WebGL (\d)/.exec(Te)[1]),Me=Ee>=1):Te.indexOf("OpenGL ES")!==-1&&(Ee=parseFloat(/^OpenGL ES (\d)/.exec(Te)[1]),Me=Ee>=2);let Ze=null,rt={};const Re=t.getParameter(t.SCISSOR_BOX),Qe=t.getParameter(t.VIEWPORT),Vt=new Do().fromArray(Re),je=new Do().fromArray(Qe);function ct(ye,Ae,Be,$e){const He=new Uint8Array(4),dt=t.createTexture();t.bindTexture(ye,dt),t.texParameteri(ye,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(ye,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let qe=0;qe<Be;qe++)ye===t.TEXTURE_3D||ye===t.TEXTURE_2D_ARRAY?t.texImage3D(Ae,0,t.RGBA,1,1,$e,0,t.RGBA,t.UNSIGNED_BYTE,He):t.texImage2D(Ae+qe,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,He);return dt}const Ct={};Ct[t.TEXTURE_2D]=ct(t.TEXTURE_2D,t.TEXTURE_2D,1),Ct[t.TEXTURE_CUBE_MAP]=ct(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ct[t.TEXTURE_2D_ARRAY]=ct(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),Ct[t.TEXTURE_3D]=ct(t.TEXTURE_3D,t.TEXTURE_3D,1,1),l.setClear(0,0,0,1),c.setClear(1),s.setClear(0),ut(t.DEPTH_TEST),c.setFunc(sy),Kt(!1),fn(X5),ut(t.CULL_FACE),Je(Qf);function ut(ye){_[ye]!==!0&&(t.enable(ye),_[ye]=!0)}function lt(ye){_[ye]!==!1&&(t.disable(ye),_[ye]=!1)}function _t(ye,Ae){return w[ye]!==Ae?(t.bindFramebuffer(ye,Ae),w[ye]=Ae,ye===t.DRAW_FRAMEBUFFER&&(w[t.FRAMEBUFFER]=Ae),ye===t.FRAMEBUFFER&&(w[t.DRAW_FRAMEBUFFER]=Ae),!0):!1}function wt(ye,Ae){let Be=M,$e=!1;if(ye){Be=S.get(Ae),Be===void 0&&(Be=[],S.set(Ae,Be));const He=ye.textures;if(Be.length!==He.length||Be[0]!==t.COLOR_ATTACHMENT0){for(let dt=0,qe=He.length;dt<qe;dt++)Be[dt]=t.COLOR_ATTACHMENT0+dt;Be.length=He.length,$e=!0}}else Be[0]!==t.BACK&&(Be[0]=t.BACK,$e=!0);$e&&t.drawBuffers(Be)}function cn(ye){return I!==ye?(t.useProgram(ye),I=ye,!0):!1}const dn={[Im]:t.FUNC_ADD,[dhe]:t.FUNC_SUBTRACT,[fhe]:t.FUNC_REVERSE_SUBTRACT};dn[phe]=t.MIN,dn[mhe]=t.MAX;const tn={[ghe]:t.ZERO,[vhe]:t.ONE,[yhe]:t.SRC_COLOR,[_T]:t.SRC_ALPHA,[Mhe]:t.SRC_ALPHA_SATURATE,[whe]:t.DST_COLOR,[xhe]:t.DST_ALPHA,[_he]:t.ONE_MINUS_SRC_COLOR,[xT]:t.ONE_MINUS_SRC_ALPHA,[She]:t.ONE_MINUS_DST_COLOR,[bhe]:t.ONE_MINUS_DST_ALPHA,[Che]:t.CONSTANT_COLOR,[Ehe]:t.ONE_MINUS_CONSTANT_COLOR,[The]:t.CONSTANT_ALPHA,[Phe]:t.ONE_MINUS_CONSTANT_ALPHA};function Je(ye,Ae,Be,$e,He,dt,qe,$t,Jt,Ie){if(ye===Qf){D===!0&&(lt(t.BLEND),D=!1);return}if(D===!1&&(ut(t.BLEND),D=!0),ye!==hhe){if(ye!==R||Ie!==J){if((L!==Im||H!==Im)&&(t.blendEquation(t.FUNC_ADD),L=Im,H=Im),Ie)switch(ye){case Gv:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Z5:t.blendFunc(t.ONE,t.ONE);break;case Y5:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case K5:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}else switch(ye){case Gv:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Z5:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case Y5:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case K5:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}V=null,B=null,q=null,X=null,ee.set(0,0,0),se=0,R=ye,J=Ie}return}He=He||Ae,dt=dt||Be,qe=qe||$e,(Ae!==L||He!==H)&&(t.blendEquationSeparate(dn[Ae],dn[He]),L=Ae,H=He),(Be!==V||$e!==B||dt!==q||qe!==X)&&(t.blendFuncSeparate(tn[Be],tn[$e],tn[dt],tn[qe]),V=Be,B=$e,q=dt,X=qe),($t.equals(ee)===!1||Jt!==se)&&(t.blendColor($t.r,$t.g,$t.b,Jt),ee.copy($t),se=Jt),R=ye,J=!1}function Tn(ye,Ae){ye.side===Bd?lt(t.CULL_FACE):ut(t.CULL_FACE);let Be=ye.side===tl;Ae&&(Be=!Be),Kt(Be),ye.blending===Gv&&ye.transparent===!1?Je(Qf):Je(ye.blending,ye.blendEquation,ye.blendSrc,ye.blendDst,ye.blendEquationAlpha,ye.blendSrcAlpha,ye.blendDstAlpha,ye.blendColor,ye.blendAlpha,ye.premultipliedAlpha),c.setFunc(ye.depthFunc),c.setTest(ye.depthTest),c.setMask(ye.depthWrite),l.setMask(ye.colorWrite);const $e=ye.stencilWrite;s.setTest($e),$e&&(s.setMask(ye.stencilWriteMask),s.setFunc(ye.stencilFunc,ye.stencilRef,ye.stencilFuncMask),s.setOp(ye.stencilFail,ye.stencilZFail,ye.stencilZPass)),On(ye.polygonOffset,ye.polygonOffsetFactor,ye.polygonOffsetUnits),ye.alphaToCoverage===!0?ut(t.SAMPLE_ALPHA_TO_COVERAGE):lt(t.SAMPLE_ALPHA_TO_COVERAGE)}function Kt(ye){$!==ye&&(ye?t.frontFace(t.CW):t.frontFace(t.CCW),$=ye)}function fn(ye){ye!==lhe?(ut(t.CULL_FACE),ye!==le&&(ye===X5?t.cullFace(t.BACK):ye===che?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):lt(t.CULL_FACE),le=ye}function Ut(ye){ye!==Ce&&(Me&&t.lineWidth(ye),Ce=ye)}function On(ye,Ae,Be){ye?(ut(t.POLYGON_OFFSET_FILL),(we!==Ae||We!==Be)&&(t.polygonOffset(Ae,Be),we=Ae,We=Be)):lt(t.POLYGON_OFFSET_FILL)}function vn(ye){ye?ut(t.SCISSOR_TEST):lt(t.SCISSOR_TEST)}function Ue(ye){ye===void 0&&(ye=t.TEXTURE0+Fe-1),Ze!==ye&&(t.activeTexture(ye),Ze=ye)}function Se(ye,Ae,Be){Be===void 0&&(Ze===null?Be=t.TEXTURE0+Fe-1:Be=Ze);let $e=rt[Be];$e===void 0&&($e={type:void 0,texture:void 0},rt[Be]=$e),($e.type!==ye||$e.texture!==Ae)&&(Ze!==Be&&(t.activeTexture(Be),Ze=Be),t.bindTexture(ye,Ae||Ct[ye]),$e.type=ye,$e.texture=Ae)}function yt(){const ye=rt[Ze];ye!==void 0&&ye.type!==void 0&&(t.bindTexture(ye.type,null),ye.type=void 0,ye.texture=void 0)}function Nt(){try{t.compressedTexImage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ht(){try{t.compressedTexImage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ot(){try{t.texSubImage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function un(){try{t.texSubImage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Gt(){try{t.compressedTexSubImage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Zt(){try{t.compressedTexSubImage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Nn(){try{t.texStorage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Yt(){try{t.texStorage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Pe(){try{t.texImage2D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ae(){try{t.texImage3D(...arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ue(ye){Vt.equals(ye)===!1&&(t.scissor(ye.x,ye.y,ye.z,ye.w),Vt.copy(ye))}function ne(ye){je.equals(ye)===!1&&(t.viewport(ye.x,ye.y,ye.z,ye.w),je.copy(ye))}function fe(ye,Ae){let Be=y.get(Ae);Be===void 0&&(Be=new WeakMap,y.set(Ae,Be));let $e=Be.get(ye);$e===void 0&&($e=t.getUniformBlockIndex(Ae,ye.name),Be.set(ye,$e))}function Oe(ye,Ae){const $e=y.get(Ae).get(ye);p.get(Ae)!==$e&&(t.uniformBlockBinding(Ae,$e,ye.__bindingPointIndex),p.set(Ae,$e))}function Ke(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),c.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),_={},Ze=null,rt={},w={},S=new WeakMap,M=[],I=null,D=!1,R=null,L=null,V=null,B=null,H=null,q=null,X=null,ee=new bi(0,0,0),se=0,J=!1,$=null,le=null,Ce=null,we=null,We=null,Vt.set(0,0,t.canvas.width,t.canvas.height),je.set(0,0,t.canvas.width,t.canvas.height),l.reset(),c.reset(),s.reset()}return{buffers:{color:l,depth:c,stencil:s},enable:ut,disable:lt,bindFramebuffer:_t,drawBuffers:wt,useProgram:cn,setBlending:Je,setMaterial:Tn,setFlipSided:Kt,setCullFace:fn,setLineWidth:Ut,setPolygonOffset:On,setScissorTest:vn,activeTexture:Ue,bindTexture:Se,unbindTexture:yt,compressedTexImage2D:Nt,compressedTexImage3D:Ht,texImage2D:Pe,texImage3D:ae,updateUBOMapping:fe,uniformBlockBinding:Oe,texStorage2D:Nn,texStorage3D:Yt,texSubImage2D:Ot,texSubImage3D:un,compressedTexSubImage2D:Gt,compressedTexSubImage3D:Zt,scissor:ue,viewport:ne,reset:Ke}}function Eve(t,e,n,r,i,l,c){const s=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,p=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),y=new gi,_=new WeakMap;let w;const S=new WeakMap;let M=!1;try{M=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function I(Ue,Se){return M?new OffscreenCanvas(Ue,Se):tw("canvas")}function D(Ue,Se,yt){let Nt=1;const Ht=vn(Ue);if((Ht.width>yt||Ht.height>yt)&&(Nt=yt/Math.max(Ht.width,Ht.height)),Nt<1)if(typeof HTMLImageElement<"u"&&Ue instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ue instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ue instanceof ImageBitmap||typeof VideoFrame<"u"&&Ue instanceof VideoFrame){const Ot=Math.floor(Nt*Ht.width),un=Math.floor(Nt*Ht.height);w===void 0&&(w=I(Ot,un));const Gt=Se?I(Ot,un):w;return Gt.width=Ot,Gt.height=un,Gt.getContext("2d").drawImage(Ue,0,0,Ot,un),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ht.width+"x"+Ht.height+") to ("+Ot+"x"+un+")."),Gt}else return"data"in Ue&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ht.width+"x"+Ht.height+")."),Ue;return Ue}function R(Ue){return Ue.generateMipmaps}function L(Ue){t.generateMipmap(Ue)}function V(Ue){return Ue.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:Ue.isWebGL3DRenderTarget?t.TEXTURE_3D:Ue.isWebGLArrayRenderTarget||Ue.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function B(Ue,Se,yt,Nt,Ht=!1){if(Ue!==null){if(t[Ue]!==void 0)return t[Ue];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ue+"'")}let Ot=Se;if(Se===t.RED&&(yt===t.FLOAT&&(Ot=t.R32F),yt===t.HALF_FLOAT&&(Ot=t.R16F),yt===t.UNSIGNED_BYTE&&(Ot=t.R8)),Se===t.RED_INTEGER&&(yt===t.UNSIGNED_BYTE&&(Ot=t.R8UI),yt===t.UNSIGNED_SHORT&&(Ot=t.R16UI),yt===t.UNSIGNED_INT&&(Ot=t.R32UI),yt===t.BYTE&&(Ot=t.R8I),yt===t.SHORT&&(Ot=t.R16I),yt===t.INT&&(Ot=t.R32I)),Se===t.RG&&(yt===t.FLOAT&&(Ot=t.RG32F),yt===t.HALF_FLOAT&&(Ot=t.RG16F),yt===t.UNSIGNED_BYTE&&(Ot=t.RG8)),Se===t.RG_INTEGER&&(yt===t.UNSIGNED_BYTE&&(Ot=t.RG8UI),yt===t.UNSIGNED_SHORT&&(Ot=t.RG16UI),yt===t.UNSIGNED_INT&&(Ot=t.RG32UI),yt===t.BYTE&&(Ot=t.RG8I),yt===t.SHORT&&(Ot=t.RG16I),yt===t.INT&&(Ot=t.RG32I)),Se===t.RGB_INTEGER&&(yt===t.UNSIGNED_BYTE&&(Ot=t.RGB8UI),yt===t.UNSIGNED_SHORT&&(Ot=t.RGB16UI),yt===t.UNSIGNED_INT&&(Ot=t.RGB32UI),yt===t.BYTE&&(Ot=t.RGB8I),yt===t.SHORT&&(Ot=t.RGB16I),yt===t.INT&&(Ot=t.RGB32I)),Se===t.RGBA_INTEGER&&(yt===t.UNSIGNED_BYTE&&(Ot=t.RGBA8UI),yt===t.UNSIGNED_SHORT&&(Ot=t.RGBA16UI),yt===t.UNSIGNED_INT&&(Ot=t.RGBA32UI),yt===t.BYTE&&(Ot=t.RGBA8I),yt===t.SHORT&&(Ot=t.RGBA16I),yt===t.INT&&(Ot=t.RGBA32I)),Se===t.RGB&&yt===t.UNSIGNED_INT_5_9_9_9_REV&&(Ot=t.RGB9_E5),Se===t.RGBA){const un=Ht?Qb:li.getTransfer(Nt);yt===t.FLOAT&&(Ot=t.RGBA32F),yt===t.HALF_FLOAT&&(Ot=t.RGBA16F),yt===t.UNSIGNED_BYTE&&(Ot=un===Li?t.SRGB8_ALPHA8:t.RGBA8),yt===t.UNSIGNED_SHORT_4_4_4_4&&(Ot=t.RGBA4),yt===t.UNSIGNED_SHORT_5_5_5_1&&(Ot=t.RGB5_A1)}return(Ot===t.R16F||Ot===t.R32F||Ot===t.RG16F||Ot===t.RG32F||Ot===t.RGBA16F||Ot===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ot}function H(Ue,Se){let yt;return Ue?Se===null||Se===Xm||Se===I_?yt=t.DEPTH24_STENCIL8:Se===Ud?yt=t.DEPTH32F_STENCIL8:Se===A_&&(yt=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Se===null||Se===Xm||Se===I_?yt=t.DEPTH_COMPONENT24:Se===Ud?yt=t.DEPTH_COMPONENT32F:Se===A_&&(yt=t.DEPTH_COMPONENT16),yt}function q(Ue,Se){return R(Ue)===!0||Ue.isFramebufferTexture&&Ue.minFilter!==bu&&Ue.minFilter!==Vl?Math.log2(Math.max(Se.width,Se.height))+1:Ue.mipmaps!==void 0&&Ue.mipmaps.length>0?Ue.mipmaps.length:Ue.isCompressedTexture&&Array.isArray(Ue.image)?Se.mipmaps.length:1}function X(Ue){const Se=Ue.target;Se.removeEventListener("dispose",X),se(Se),Se.isVideoTexture&&_.delete(Se)}function ee(Ue){const Se=Ue.target;Se.removeEventListener("dispose",ee),$(Se)}function se(Ue){const Se=r.get(Ue);if(Se.__webglInit===void 0)return;const yt=Ue.source,Nt=S.get(yt);if(Nt){const Ht=Nt[Se.__cacheKey];Ht.usedTimes--,Ht.usedTimes===0&&J(Ue),Object.keys(Nt).length===0&&S.delete(yt)}r.remove(Ue)}function J(Ue){const Se=r.get(Ue);t.deleteTexture(Se.__webglTexture);const yt=Ue.source,Nt=S.get(yt);delete Nt[Se.__cacheKey],c.memory.textures--}function $(Ue){const Se=r.get(Ue);if(Ue.depthTexture&&(Ue.depthTexture.dispose(),r.remove(Ue.depthTexture)),Ue.isWebGLCubeRenderTarget)for(let Nt=0;Nt<6;Nt++){if(Array.isArray(Se.__webglFramebuffer[Nt]))for(let Ht=0;Ht<Se.__webglFramebuffer[Nt].length;Ht++)t.deleteFramebuffer(Se.__webglFramebuffer[Nt][Ht]);else t.deleteFramebuffer(Se.__webglFramebuffer[Nt]);Se.__webglDepthbuffer&&t.deleteRenderbuffer(Se.__webglDepthbuffer[Nt])}else{if(Array.isArray(Se.__webglFramebuffer))for(let Nt=0;Nt<Se.__webglFramebuffer.length;Nt++)t.deleteFramebuffer(Se.__webglFramebuffer[Nt]);else t.deleteFramebuffer(Se.__webglFramebuffer);if(Se.__webglDepthbuffer&&t.deleteRenderbuffer(Se.__webglDepthbuffer),Se.__webglMultisampledFramebuffer&&t.deleteFramebuffer(Se.__webglMultisampledFramebuffer),Se.__webglColorRenderbuffer)for(let Nt=0;Nt<Se.__webglColorRenderbuffer.length;Nt++)Se.__webglColorRenderbuffer[Nt]&&t.deleteRenderbuffer(Se.__webglColorRenderbuffer[Nt]);Se.__webglDepthRenderbuffer&&t.deleteRenderbuffer(Se.__webglDepthRenderbuffer)}const yt=Ue.textures;for(let Nt=0,Ht=yt.length;Nt<Ht;Nt++){const Ot=r.get(yt[Nt]);Ot.__webglTexture&&(t.deleteTexture(Ot.__webglTexture),c.memory.textures--),r.remove(yt[Nt])}r.remove(Ue)}let le=0;function Ce(){le=0}function we(){const Ue=le;return Ue>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Ue+" texture units while this GPU supports only "+i.maxTextures),le+=1,Ue}function We(Ue){const Se=[];return Se.push(Ue.wrapS),Se.push(Ue.wrapT),Se.push(Ue.wrapR||0),Se.push(Ue.magFilter),Se.push(Ue.minFilter),Se.push(Ue.anisotropy),Se.push(Ue.internalFormat),Se.push(Ue.format),Se.push(Ue.type),Se.push(Ue.generateMipmaps),Se.push(Ue.premultiplyAlpha),Se.push(Ue.flipY),Se.push(Ue.unpackAlignment),Se.push(Ue.colorSpace),Se.join()}function Fe(Ue,Se){const yt=r.get(Ue);if(Ue.isVideoTexture&&Ut(Ue),Ue.isRenderTargetTexture===!1&&Ue.version>0&&yt.__version!==Ue.version){const Nt=Ue.image;if(Nt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Nt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{je(yt,Ue,Se);return}}n.bindTexture(t.TEXTURE_2D,yt.__webglTexture,t.TEXTURE0+Se)}function Me(Ue,Se){const yt=r.get(Ue);if(Ue.version>0&&yt.__version!==Ue.version){je(yt,Ue,Se);return}n.bindTexture(t.TEXTURE_2D_ARRAY,yt.__webglTexture,t.TEXTURE0+Se)}function Ee(Ue,Se){const yt=r.get(Ue);if(Ue.version>0&&yt.__version!==Ue.version){je(yt,Ue,Se);return}n.bindTexture(t.TEXTURE_3D,yt.__webglTexture,t.TEXTURE0+Se)}function Te(Ue,Se){const yt=r.get(Ue);if(Ue.version>0&&yt.__version!==Ue.version){ct(yt,Ue,Se);return}n.bindTexture(t.TEXTURE_CUBE_MAP,yt.__webglTexture,t.TEXTURE0+Se)}const Ze={[IT]:t.REPEAT,[zm]:t.CLAMP_TO_EDGE,[RT]:t.MIRRORED_REPEAT},rt={[bu]:t.NEAREST,[Fhe]:t.NEAREST_MIPMAP_NEAREST,[b1]:t.NEAREST_MIPMAP_LINEAR,[Vl]:t.LINEAR,[XC]:t.LINEAR_MIPMAP_NEAREST,[Yf]:t.LINEAR_MIPMAP_LINEAR},Re={[Vhe]:t.NEVER,[Xhe]:t.ALWAYS,[jhe]:t.LESS,[c6]:t.LEQUAL,[Hhe]:t.EQUAL,[qhe]:t.GEQUAL,[Ghe]:t.GREATER,[Whe]:t.NOTEQUAL};function Qe(Ue,Se){if(Se.type===Ud&&e.has("OES_texture_float_linear")===!1&&(Se.magFilter===Vl||Se.magFilter===XC||Se.magFilter===b1||Se.magFilter===Yf||Se.minFilter===Vl||Se.minFilter===XC||Se.minFilter===b1||Se.minFilter===Yf)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(Ue,t.TEXTURE_WRAP_S,Ze[Se.wrapS]),t.texParameteri(Ue,t.TEXTURE_WRAP_T,Ze[Se.wrapT]),(Ue===t.TEXTURE_3D||Ue===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Ue,t.TEXTURE_WRAP_R,Ze[Se.wrapR]),t.texParameteri(Ue,t.TEXTURE_MAG_FILTER,rt[Se.magFilter]),t.texParameteri(Ue,t.TEXTURE_MIN_FILTER,rt[Se.minFilter]),Se.compareFunction&&(t.texParameteri(Ue,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Ue,t.TEXTURE_COMPARE_FUNC,Re[Se.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Se.magFilter===bu||Se.minFilter!==b1&&Se.minFilter!==Yf||Se.type===Ud&&e.has("OES_texture_float_linear")===!1)return;if(Se.anisotropy>1||r.get(Se).__currentAnisotropy){const yt=e.get("EXT_texture_filter_anisotropic");t.texParameterf(Ue,yt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Se.anisotropy,i.getMaxAnisotropy())),r.get(Se).__currentAnisotropy=Se.anisotropy}}}function Vt(Ue,Se){let yt=!1;Ue.__webglInit===void 0&&(Ue.__webglInit=!0,Se.addEventListener("dispose",X));const Nt=Se.source;let Ht=S.get(Nt);Ht===void 0&&(Ht={},S.set(Nt,Ht));const Ot=We(Se);if(Ot!==Ue.__cacheKey){Ht[Ot]===void 0&&(Ht[Ot]={texture:t.createTexture(),usedTimes:0},c.memory.textures++,yt=!0),Ht[Ot].usedTimes++;const un=Ht[Ue.__cacheKey];un!==void 0&&(Ht[Ue.__cacheKey].usedTimes--,un.usedTimes===0&&J(Se)),Ue.__cacheKey=Ot,Ue.__webglTexture=Ht[Ot].texture}return yt}function je(Ue,Se,yt){let Nt=t.TEXTURE_2D;(Se.isDataArrayTexture||Se.isCompressedArrayTexture)&&(Nt=t.TEXTURE_2D_ARRAY),Se.isData3DTexture&&(Nt=t.TEXTURE_3D);const Ht=Vt(Ue,Se),Ot=Se.source;n.bindTexture(Nt,Ue.__webglTexture,t.TEXTURE0+yt);const un=r.get(Ot);if(Ot.version!==un.__version||Ht===!0){n.activeTexture(t.TEXTURE0+yt);const Gt=li.getPrimaries(li.workingColorSpace),Zt=Se.colorSpace===Xf?null:li.getPrimaries(Se.colorSpace),Nn=Se.colorSpace===Xf||Gt===Zt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,Se.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Se.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,Se.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Nn);let Yt=D(Se.image,!1,i.maxTextureSize);Yt=On(Se,Yt);const Pe=l.convert(Se.format,Se.colorSpace),ae=l.convert(Se.type);let ue=B(Se.internalFormat,Pe,ae,Se.colorSpace,Se.isVideoTexture);Qe(Nt,Se);let ne;const fe=Se.mipmaps,Oe=Se.isVideoTexture!==!0,Ke=un.__version===void 0||Ht===!0,ye=Ot.dataReady,Ae=q(Se,Yt);if(Se.isDepthTexture)ue=H(Se.format===L_,Se.type),Ke&&(Oe?n.texStorage2D(t.TEXTURE_2D,1,ue,Yt.width,Yt.height):n.texImage2D(t.TEXTURE_2D,0,ue,Yt.width,Yt.height,0,Pe,ae,null));else if(Se.isDataTexture)if(fe.length>0){Oe&&Ke&&n.texStorage2D(t.TEXTURE_2D,Ae,ue,fe[0].width,fe[0].height);for(let Be=0,$e=fe.length;Be<$e;Be++)ne=fe[Be],Oe?ye&&n.texSubImage2D(t.TEXTURE_2D,Be,0,0,ne.width,ne.height,Pe,ae,ne.data):n.texImage2D(t.TEXTURE_2D,Be,ue,ne.width,ne.height,0,Pe,ae,ne.data);Se.generateMipmaps=!1}else Oe?(Ke&&n.texStorage2D(t.TEXTURE_2D,Ae,ue,Yt.width,Yt.height),ye&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Yt.width,Yt.height,Pe,ae,Yt.data)):n.texImage2D(t.TEXTURE_2D,0,ue,Yt.width,Yt.height,0,Pe,ae,Yt.data);else if(Se.isCompressedTexture)if(Se.isCompressedArrayTexture){Oe&&Ke&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Ae,ue,fe[0].width,fe[0].height,Yt.depth);for(let Be=0,$e=fe.length;Be<$e;Be++)if(ne=fe[Be],Se.format!==_u)if(Pe!==null)if(Oe){if(ye)if(Se.layerUpdates.size>0){const He=Ez(ne.width,ne.height,Se.format,Se.type);for(const dt of Se.layerUpdates){const qe=ne.data.subarray(dt*He/ne.data.BYTES_PER_ELEMENT,(dt+1)*He/ne.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Be,0,0,dt,ne.width,ne.height,1,Pe,qe)}Se.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Be,0,0,0,ne.width,ne.height,Yt.depth,Pe,ne.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Be,ue,ne.width,ne.height,Yt.depth,0,ne.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Oe?ye&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,Be,0,0,0,ne.width,ne.height,Yt.depth,Pe,ae,ne.data):n.texImage3D(t.TEXTURE_2D_ARRAY,Be,ue,ne.width,ne.height,Yt.depth,0,Pe,ae,ne.data)}else{Oe&&Ke&&n.texStorage2D(t.TEXTURE_2D,Ae,ue,fe[0].width,fe[0].height);for(let Be=0,$e=fe.length;Be<$e;Be++)ne=fe[Be],Se.format!==_u?Pe!==null?Oe?ye&&n.compressedTexSubImage2D(t.TEXTURE_2D,Be,0,0,ne.width,ne.height,Pe,ne.data):n.compressedTexImage2D(t.TEXTURE_2D,Be,ue,ne.width,ne.height,0,ne.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Oe?ye&&n.texSubImage2D(t.TEXTURE_2D,Be,0,0,ne.width,ne.height,Pe,ae,ne.data):n.texImage2D(t.TEXTURE_2D,Be,ue,ne.width,ne.height,0,Pe,ae,ne.data)}else if(Se.isDataArrayTexture)if(Oe){if(Ke&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Ae,ue,Yt.width,Yt.height,Yt.depth),ye)if(Se.layerUpdates.size>0){const Be=Ez(Yt.width,Yt.height,Se.format,Se.type);for(const $e of Se.layerUpdates){const He=Yt.data.subarray($e*Be/Yt.data.BYTES_PER_ELEMENT,($e+1)*Be/Yt.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,$e,Yt.width,Yt.height,1,Pe,ae,He)}Se.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,Yt.width,Yt.height,Yt.depth,Pe,ae,Yt.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,ue,Yt.width,Yt.height,Yt.depth,0,Pe,ae,Yt.data);else if(Se.isData3DTexture)Oe?(Ke&&n.texStorage3D(t.TEXTURE_3D,Ae,ue,Yt.width,Yt.height,Yt.depth),ye&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,Yt.width,Yt.height,Yt.depth,Pe,ae,Yt.data)):n.texImage3D(t.TEXTURE_3D,0,ue,Yt.width,Yt.height,Yt.depth,0,Pe,ae,Yt.data);else if(Se.isFramebufferTexture){if(Ke)if(Oe)n.texStorage2D(t.TEXTURE_2D,Ae,ue,Yt.width,Yt.height);else{let Be=Yt.width,$e=Yt.height;for(let He=0;He<Ae;He++)n.texImage2D(t.TEXTURE_2D,He,ue,Be,$e,0,Pe,ae,null),Be>>=1,$e>>=1}}else if(fe.length>0){if(Oe&&Ke){const Be=vn(fe[0]);n.texStorage2D(t.TEXTURE_2D,Ae,ue,Be.width,Be.height)}for(let Be=0,$e=fe.length;Be<$e;Be++)ne=fe[Be],Oe?ye&&n.texSubImage2D(t.TEXTURE_2D,Be,0,0,Pe,ae,ne):n.texImage2D(t.TEXTURE_2D,Be,ue,Pe,ae,ne);Se.generateMipmaps=!1}else if(Oe){if(Ke){const Be=vn(Yt);n.texStorage2D(t.TEXTURE_2D,Ae,ue,Be.width,Be.height)}ye&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,Pe,ae,Yt)}else n.texImage2D(t.TEXTURE_2D,0,ue,Pe,ae,Yt);R(Se)&&L(Nt),un.__version=Ot.version,Se.onUpdate&&Se.onUpdate(Se)}Ue.__version=Se.version}function ct(Ue,Se,yt){if(Se.image.length!==6)return;const Nt=Vt(Ue,Se),Ht=Se.source;n.bindTexture(t.TEXTURE_CUBE_MAP,Ue.__webglTexture,t.TEXTURE0+yt);const Ot=r.get(Ht);if(Ht.version!==Ot.__version||Nt===!0){n.activeTexture(t.TEXTURE0+yt);const un=li.getPrimaries(li.workingColorSpace),Gt=Se.colorSpace===Xf?null:li.getPrimaries(Se.colorSpace),Zt=Se.colorSpace===Xf||un===Gt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,Se.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Se.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,Se.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Zt);const Nn=Se.isCompressedTexture||Se.image[0].isCompressedTexture,Yt=Se.image[0]&&Se.image[0].isDataTexture,Pe=[];for(let $e=0;$e<6;$e++)!Nn&&!Yt?Pe[$e]=D(Se.image[$e],!0,i.maxCubemapSize):Pe[$e]=Yt?Se.image[$e].image:Se.image[$e],Pe[$e]=On(Se,Pe[$e]);const ae=Pe[0],ue=l.convert(Se.format,Se.colorSpace),ne=l.convert(Se.type),fe=B(Se.internalFormat,ue,ne,Se.colorSpace),Oe=Se.isVideoTexture!==!0,Ke=Ot.__version===void 0||Nt===!0,ye=Ht.dataReady;let Ae=q(Se,ae);Qe(t.TEXTURE_CUBE_MAP,Se);let Be;if(Nn){Oe&&Ke&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Ae,fe,ae.width,ae.height);for(let $e=0;$e<6;$e++){Be=Pe[$e].mipmaps;for(let He=0;He<Be.length;He++){const dt=Be[He];Se.format!==_u?ue!==null?Oe?ye&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He,0,0,dt.width,dt.height,ue,dt.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He,fe,dt.width,dt.height,0,dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He,0,0,dt.width,dt.height,ue,ne,dt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He,fe,dt.width,dt.height,0,ue,ne,dt.data)}}}else{if(Be=Se.mipmaps,Oe&&Ke){Be.length>0&&Ae++;const $e=vn(Pe[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Ae,fe,$e.width,$e.height)}for(let $e=0;$e<6;$e++)if(Yt){Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,0,0,Pe[$e].width,Pe[$e].height,ue,ne,Pe[$e].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,fe,Pe[$e].width,Pe[$e].height,0,ue,ne,Pe[$e].data);for(let He=0;He<Be.length;He++){const qe=Be[He].image[$e].image;Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He+1,0,0,qe.width,qe.height,ue,ne,qe.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He+1,fe,qe.width,qe.height,0,ue,ne,qe.data)}}else{Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,0,0,ue,ne,Pe[$e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,0,fe,ue,ne,Pe[$e]);for(let He=0;He<Be.length;He++){const dt=Be[He];Oe?ye&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He+1,0,0,ue,ne,dt.image[$e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+$e,He+1,fe,ue,ne,dt.image[$e])}}}R(Se)&&L(t.TEXTURE_CUBE_MAP),Ot.__version=Ht.version,Se.onUpdate&&Se.onUpdate(Se)}Ue.__version=Se.version}function Ct(Ue,Se,yt,Nt,Ht,Ot){const un=l.convert(yt.format,yt.colorSpace),Gt=l.convert(yt.type),Zt=B(yt.internalFormat,un,Gt,yt.colorSpace),Nn=r.get(Se),Yt=r.get(yt);if(Yt.__renderTarget=Se,!Nn.__hasExternalTextures){const Pe=Math.max(1,Se.width>>Ot),ae=Math.max(1,Se.height>>Ot);Ht===t.TEXTURE_3D||Ht===t.TEXTURE_2D_ARRAY?n.texImage3D(Ht,Ot,Zt,Pe,ae,Se.depth,0,un,Gt,null):n.texImage2D(Ht,Ot,Zt,Pe,ae,0,un,Gt,null)}n.bindFramebuffer(t.FRAMEBUFFER,Ue),fn(Se)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Nt,Ht,Yt.__webglTexture,0,Kt(Se)):(Ht===t.TEXTURE_2D||Ht>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Ht<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Nt,Ht,Yt.__webglTexture,Ot),n.bindFramebuffer(t.FRAMEBUFFER,null)}function ut(Ue,Se,yt){if(t.bindRenderbuffer(t.RENDERBUFFER,Ue),Se.depthBuffer){const Nt=Se.depthTexture,Ht=Nt&&Nt.isDepthTexture?Nt.type:null,Ot=H(Se.stencilBuffer,Ht),un=Se.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Gt=Kt(Se);fn(Se)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Gt,Ot,Se.width,Se.height):yt?t.renderbufferStorageMultisample(t.RENDERBUFFER,Gt,Ot,Se.width,Se.height):t.renderbufferStorage(t.RENDERBUFFER,Ot,Se.width,Se.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,un,t.RENDERBUFFER,Ue)}else{const Nt=Se.textures;for(let Ht=0;Ht<Nt.length;Ht++){const Ot=Nt[Ht],un=l.convert(Ot.format,Ot.colorSpace),Gt=l.convert(Ot.type),Zt=B(Ot.internalFormat,un,Gt,Ot.colorSpace),Nn=Kt(Se);yt&&fn(Se)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Nn,Zt,Se.width,Se.height):fn(Se)?s.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Nn,Zt,Se.width,Se.height):t.renderbufferStorage(t.RENDERBUFFER,Zt,Se.width,Se.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function lt(Ue,Se){if(Se&&Se.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,Ue),!(Se.depthTexture&&Se.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Nt=r.get(Se.depthTexture);Nt.__renderTarget=Se,(!Nt.__webglTexture||Se.depthTexture.image.width!==Se.width||Se.depthTexture.image.height!==Se.height)&&(Se.depthTexture.image.width=Se.width,Se.depthTexture.image.height=Se.height,Se.depthTexture.needsUpdate=!0),Fe(Se.depthTexture,0);const Ht=Nt.__webglTexture,Ot=Kt(Se);if(Se.depthTexture.format===R_)fn(Se)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ht,0,Ot):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Ht,0);else if(Se.depthTexture.format===L_)fn(Se)?s.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ht,0,Ot):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Ht,0);else throw new Error("Unknown depthTexture format")}function _t(Ue){const Se=r.get(Ue),yt=Ue.isWebGLCubeRenderTarget===!0;if(Se.__boundDepthTexture!==Ue.depthTexture){const Nt=Ue.depthTexture;if(Se.__depthDisposeCallback&&Se.__depthDisposeCallback(),Nt){const Ht=()=>{delete Se.__boundDepthTexture,delete Se.__depthDisposeCallback,Nt.removeEventListener("dispose",Ht)};Nt.addEventListener("dispose",Ht),Se.__depthDisposeCallback=Ht}Se.__boundDepthTexture=Nt}if(Ue.depthTexture&&!Se.__autoAllocateDepthBuffer){if(yt)throw new Error("target.depthTexture not supported in Cube render targets");lt(Se.__webglFramebuffer,Ue)}else if(yt){Se.__webglDepthbuffer=[];for(let Nt=0;Nt<6;Nt++)if(n.bindFramebuffer(t.FRAMEBUFFER,Se.__webglFramebuffer[Nt]),Se.__webglDepthbuffer[Nt]===void 0)Se.__webglDepthbuffer[Nt]=t.createRenderbuffer(),ut(Se.__webglDepthbuffer[Nt],Ue,!1);else{const Ht=Ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ot=Se.__webglDepthbuffer[Nt];t.bindRenderbuffer(t.RENDERBUFFER,Ot),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ht,t.RENDERBUFFER,Ot)}}else if(n.bindFramebuffer(t.FRAMEBUFFER,Se.__webglFramebuffer),Se.__webglDepthbuffer===void 0)Se.__webglDepthbuffer=t.createRenderbuffer(),ut(Se.__webglDepthbuffer,Ue,!1);else{const Nt=Ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ht=Se.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Ht),t.framebufferRenderbuffer(t.FRAMEBUFFER,Nt,t.RENDERBUFFER,Ht)}n.bindFramebuffer(t.FRAMEBUFFER,null)}function wt(Ue,Se,yt){const Nt=r.get(Ue);Se!==void 0&&Ct(Nt.__webglFramebuffer,Ue,Ue.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),yt!==void 0&&_t(Ue)}function cn(Ue){const Se=Ue.texture,yt=r.get(Ue),Nt=r.get(Se);Ue.addEventListener("dispose",ee);const Ht=Ue.textures,Ot=Ue.isWebGLCubeRenderTarget===!0,un=Ht.length>1;if(un||(Nt.__webglTexture===void 0&&(Nt.__webglTexture=t.createTexture()),Nt.__version=Se.version,c.memory.textures++),Ot){yt.__webglFramebuffer=[];for(let Gt=0;Gt<6;Gt++)if(Se.mipmaps&&Se.mipmaps.length>0){yt.__webglFramebuffer[Gt]=[];for(let Zt=0;Zt<Se.mipmaps.length;Zt++)yt.__webglFramebuffer[Gt][Zt]=t.createFramebuffer()}else yt.__webglFramebuffer[Gt]=t.createFramebuffer()}else{if(Se.mipmaps&&Se.mipmaps.length>0){yt.__webglFramebuffer=[];for(let Gt=0;Gt<Se.mipmaps.length;Gt++)yt.__webglFramebuffer[Gt]=t.createFramebuffer()}else yt.__webglFramebuffer=t.createFramebuffer();if(un)for(let Gt=0,Zt=Ht.length;Gt<Zt;Gt++){const Nn=r.get(Ht[Gt]);Nn.__webglTexture===void 0&&(Nn.__webglTexture=t.createTexture(),c.memory.textures++)}if(Ue.samples>0&&fn(Ue)===!1){yt.__webglMultisampledFramebuffer=t.createFramebuffer(),yt.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,yt.__webglMultisampledFramebuffer);for(let Gt=0;Gt<Ht.length;Gt++){const Zt=Ht[Gt];yt.__webglColorRenderbuffer[Gt]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,yt.__webglColorRenderbuffer[Gt]);const Nn=l.convert(Zt.format,Zt.colorSpace),Yt=l.convert(Zt.type),Pe=B(Zt.internalFormat,Nn,Yt,Zt.colorSpace,Ue.isXRRenderTarget===!0),ae=Kt(Ue);t.renderbufferStorageMultisample(t.RENDERBUFFER,ae,Pe,Ue.width,Ue.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Gt,t.RENDERBUFFER,yt.__webglColorRenderbuffer[Gt])}t.bindRenderbuffer(t.RENDERBUFFER,null),Ue.depthBuffer&&(yt.__webglDepthRenderbuffer=t.createRenderbuffer(),ut(yt.__webglDepthRenderbuffer,Ue,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ot){n.bindTexture(t.TEXTURE_CUBE_MAP,Nt.__webglTexture),Qe(t.TEXTURE_CUBE_MAP,Se);for(let Gt=0;Gt<6;Gt++)if(Se.mipmaps&&Se.mipmaps.length>0)for(let Zt=0;Zt<Se.mipmaps.length;Zt++)Ct(yt.__webglFramebuffer[Gt][Zt],Ue,Se,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Gt,Zt);else Ct(yt.__webglFramebuffer[Gt],Ue,Se,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Gt,0);R(Se)&&L(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(un){for(let Gt=0,Zt=Ht.length;Gt<Zt;Gt++){const Nn=Ht[Gt],Yt=r.get(Nn);n.bindTexture(t.TEXTURE_2D,Yt.__webglTexture),Qe(t.TEXTURE_2D,Nn),Ct(yt.__webglFramebuffer,Ue,Nn,t.COLOR_ATTACHMENT0+Gt,t.TEXTURE_2D,0),R(Nn)&&L(t.TEXTURE_2D)}n.unbindTexture()}else{let Gt=t.TEXTURE_2D;if((Ue.isWebGL3DRenderTarget||Ue.isWebGLArrayRenderTarget)&&(Gt=Ue.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Gt,Nt.__webglTexture),Qe(Gt,Se),Se.mipmaps&&Se.mipmaps.length>0)for(let Zt=0;Zt<Se.mipmaps.length;Zt++)Ct(yt.__webglFramebuffer[Zt],Ue,Se,t.COLOR_ATTACHMENT0,Gt,Zt);else Ct(yt.__webglFramebuffer,Ue,Se,t.COLOR_ATTACHMENT0,Gt,0);R(Se)&&L(Gt),n.unbindTexture()}Ue.depthBuffer&&_t(Ue)}function dn(Ue){const Se=Ue.textures;for(let yt=0,Nt=Se.length;yt<Nt;yt++){const Ht=Se[yt];if(R(Ht)){const Ot=V(Ue),un=r.get(Ht).__webglTexture;n.bindTexture(Ot,un),L(Ot),n.unbindTexture()}}}const tn=[],Je=[];function Tn(Ue){if(Ue.samples>0){if(fn(Ue)===!1){const Se=Ue.textures,yt=Ue.width,Nt=Ue.height;let Ht=t.COLOR_BUFFER_BIT;const Ot=Ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,un=r.get(Ue),Gt=Se.length>1;if(Gt)for(let Zt=0;Zt<Se.length;Zt++)n.bindFramebuffer(t.FRAMEBUFFER,un.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,un.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,un.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,un.__webglFramebuffer);for(let Zt=0;Zt<Se.length;Zt++){if(Ue.resolveDepthBuffer&&(Ue.depthBuffer&&(Ht|=t.DEPTH_BUFFER_BIT),Ue.stencilBuffer&&Ue.resolveStencilBuffer&&(Ht|=t.STENCIL_BUFFER_BIT)),Gt){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,un.__webglColorRenderbuffer[Zt]);const Nn=r.get(Se[Zt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Nn,0)}t.blitFramebuffer(0,0,yt,Nt,0,0,yt,Nt,Ht,t.NEAREST),p===!0&&(tn.length=0,Je.length=0,tn.push(t.COLOR_ATTACHMENT0+Zt),Ue.depthBuffer&&Ue.resolveDepthBuffer===!1&&(tn.push(Ot),Je.push(Ot),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,Je)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,tn))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Gt)for(let Zt=0;Zt<Se.length;Zt++){n.bindFramebuffer(t.FRAMEBUFFER,un.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.RENDERBUFFER,un.__webglColorRenderbuffer[Zt]);const Nn=r.get(Se[Zt]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,un.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Zt,t.TEXTURE_2D,Nn,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,un.__webglMultisampledFramebuffer)}else if(Ue.depthBuffer&&Ue.resolveDepthBuffer===!1&&p){const Se=Ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Se])}}}function Kt(Ue){return Math.min(i.maxSamples,Ue.samples)}function fn(Ue){const Se=r.get(Ue);return Ue.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Se.__useRenderToTexture!==!1}function Ut(Ue){const Se=c.render.frame;_.get(Ue)!==Se&&(_.set(Ue,Se),Ue.update())}function On(Ue,Se){const yt=Ue.colorSpace,Nt=Ue.format,Ht=Ue.type;return Ue.isCompressedTexture===!0||Ue.isVideoTexture===!0||yt!==Zm&&yt!==Xf&&(li.getTransfer(yt)===Li?(Nt!==_u||Ht!==Zd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",yt)),Se}function vn(Ue){return typeof HTMLImageElement<"u"&&Ue instanceof HTMLImageElement?(y.width=Ue.naturalWidth||Ue.width,y.height=Ue.naturalHeight||Ue.height):typeof VideoFrame<"u"&&Ue instanceof VideoFrame?(y.width=Ue.displayWidth,y.height=Ue.displayHeight):(y.width=Ue.width,y.height=Ue.height),y}this.allocateTextureUnit=we,this.resetTextureUnits=Ce,this.setTexture2D=Fe,this.setTexture2DArray=Me,this.setTexture3D=Ee,this.setTextureCube=Te,this.rebindTextures=wt,this.setupRenderTarget=cn,this.updateRenderTargetMipmap=dn,this.updateMultisampleRenderTarget=Tn,this.setupDepthRenderbuffer=_t,this.setupFrameBufferTexture=Ct,this.useMultisampledRTT=fn}function Tve(t,e){function n(r,i=Xf){let l;const c=li.getTransfer(i);if(r===Zd)return t.UNSIGNED_BYTE;if(r===aI)return t.UNSIGNED_SHORT_4_4_4_4;if(r===lI)return t.UNSIGNED_SHORT_5_5_5_1;if(r===t6)return t.UNSIGNED_INT_5_9_9_9_REV;if(r===QB)return t.BYTE;if(r===e6)return t.SHORT;if(r===A_)return t.UNSIGNED_SHORT;if(r===sI)return t.INT;if(r===Xm)return t.UNSIGNED_INT;if(r===Ud)return t.FLOAT;if(r===vx)return t.HALF_FLOAT;if(r===n6)return t.ALPHA;if(r===r6)return t.RGB;if(r===_u)return t.RGBA;if(r===i6)return t.LUMINANCE;if(r===o6)return t.LUMINANCE_ALPHA;if(r===R_)return t.DEPTH_COMPONENT;if(r===L_)return t.DEPTH_STENCIL;if(r===s6)return t.RED;if(r===cI)return t.RED_INTEGER;if(r===a6)return t.RG;if(r===uI)return t.RG_INTEGER;if(r===hI)return t.RGBA_INTEGER;if(r===pb||r===mb||r===gb||r===vb)if(c===Li)if(l=e.get("WEBGL_compressed_texture_s3tc_srgb"),l!==null){if(r===pb)return l.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===mb)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===gb)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===vb)return l.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(l=e.get("WEBGL_compressed_texture_s3tc"),l!==null){if(r===pb)return l.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===mb)return l.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===gb)return l.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===vb)return l.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===LT||r===kT||r===DT||r===zT)if(l=e.get("WEBGL_compressed_texture_pvrtc"),l!==null){if(r===LT)return l.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===kT)return l.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===DT)return l.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===zT)return l.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===OT||r===FT||r===NT)if(l=e.get("WEBGL_compressed_texture_etc"),l!==null){if(r===OT||r===FT)return c===Li?l.COMPRESSED_SRGB8_ETC2:l.COMPRESSED_RGB8_ETC2;if(r===NT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:l.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===BT||r===UT||r===$T||r===VT||r===jT||r===HT||r===GT||r===WT||r===qT||r===XT||r===ZT||r===YT||r===KT||r===JT)if(l=e.get("WEBGL_compressed_texture_astc"),l!==null){if(r===BT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:l.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===UT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:l.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===$T)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:l.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===VT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:l.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===jT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:l.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===HT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:l.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===GT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:l.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===WT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:l.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===qT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:l.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===XT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:l.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===ZT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:l.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===YT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:l.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===KT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:l.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===JT)return c===Li?l.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:l.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===yb||r===QT||r===eP)if(l=e.get("EXT_texture_compression_bptc"),l!==null){if(r===yb)return c===Li?l.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:l.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===QT)return l.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===eP)return l.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===l6||r===tP||r===nP||r===rP)if(l=e.get("EXT_texture_compression_rgtc"),l!==null){if(r===yb)return l.COMPRESSED_RED_RGTC1_EXT;if(r===tP)return l.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===nP)return l.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===rP)return l.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===I_?t.UNSIGNED_INT_24_8:t[r]!==void 0?t[r]:null}return{convert:n}}const Pve=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Ave=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Ive{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,r){if(this.texture===null){const i=new Xs,l=e.properties.get(i);l.__webglTexture=n.texture,(n.depthNear!==r.depthNear||n.depthFar!==r.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,r=new Yd({vertexShader:Pve,fragmentShader:Ave,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Ja(new xx(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Rve extends vy{constructor(e,n){super();const r=this;let i=null,l=1,c=null,s="local-floor",p=1,y=null,_=null,w=null,S=null,M=null,I=null;const D=new Ive,R=n.getContextAttributes();let L=null,V=null;const B=[],H=[],q=new gi;let X=null;const ee=new Nl;ee.viewport=new Do;const se=new Nl;se.viewport=new Do;const J=[ee,se],$=new Kde;let le=null,Ce=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(je){let ct=B[je];return ct===void 0&&(ct=new pE,B[je]=ct),ct.getTargetRaySpace()},this.getControllerGrip=function(je){let ct=B[je];return ct===void 0&&(ct=new pE,B[je]=ct),ct.getGripSpace()},this.getHand=function(je){let ct=B[je];return ct===void 0&&(ct=new pE,B[je]=ct),ct.getHandSpace()};function we(je){const ct=H.indexOf(je.inputSource);if(ct===-1)return;const Ct=B[ct];Ct!==void 0&&(Ct.update(je.inputSource,je.frame,y||c),Ct.dispatchEvent({type:je.type,data:je.inputSource}))}function We(){i.removeEventListener("select",we),i.removeEventListener("selectstart",we),i.removeEventListener("selectend",we),i.removeEventListener("squeeze",we),i.removeEventListener("squeezestart",we),i.removeEventListener("squeezeend",we),i.removeEventListener("end",We),i.removeEventListener("inputsourceschange",Fe);for(let je=0;je<B.length;je++){const ct=H[je];ct!==null&&(H[je]=null,B[je].disconnect(ct))}le=null,Ce=null,D.reset(),e.setRenderTarget(L),M=null,S=null,w=null,i=null,V=null,Vt.stop(),r.isPresenting=!1,e.setPixelRatio(X),e.setSize(q.width,q.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(je){l=je,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(je){s=je,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y||c},this.setReferenceSpace=function(je){y=je},this.getBaseLayer=function(){return S!==null?S:M},this.getBinding=function(){return w},this.getFrame=function(){return I},this.getSession=function(){return i},this.setSession=async function(je){if(i=je,i!==null){if(L=e.getRenderTarget(),i.addEventListener("select",we),i.addEventListener("selectstart",we),i.addEventListener("selectend",we),i.addEventListener("squeeze",we),i.addEventListener("squeezestart",we),i.addEventListener("squeezeend",we),i.addEventListener("end",We),i.addEventListener("inputsourceschange",Fe),R.xrCompatible!==!0&&await n.makeXRCompatible(),X=e.getPixelRatio(),e.getSize(q),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ct=null,ut=null,lt=null;R.depth&&(lt=R.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,Ct=R.stencil?L_:R_,ut=R.stencil?I_:Xm);const _t={colorFormat:n.RGBA8,depthFormat:lt,scaleFactor:l};w=new XRWebGLBinding(i,n),S=w.createProjectionLayer(_t),i.updateRenderState({layers:[S]}),e.setPixelRatio(1),e.setSize(S.textureWidth,S.textureHeight,!1),V=new hp(S.textureWidth,S.textureHeight,{format:_u,type:Zd,depthTexture:new y6(S.textureWidth,S.textureHeight,ut,void 0,void 0,void 0,void 0,void 0,void 0,Ct),stencilBuffer:R.stencil,colorSpace:e.outputColorSpace,samples:R.antialias?4:0,resolveDepthBuffer:S.ignoreDepthValues===!1,resolveStencilBuffer:S.ignoreDepthValues===!1})}else{const Ct={antialias:R.antialias,alpha:!0,depth:R.depth,stencil:R.stencil,framebufferScaleFactor:l};M=new XRWebGLLayer(i,n,Ct),i.updateRenderState({baseLayer:M}),e.setPixelRatio(1),e.setSize(M.framebufferWidth,M.framebufferHeight,!1),V=new hp(M.framebufferWidth,M.framebufferHeight,{format:_u,type:Zd,colorSpace:e.outputColorSpace,stencilBuffer:R.stencil,resolveDepthBuffer:M.ignoreDepthValues===!1,resolveStencilBuffer:M.ignoreDepthValues===!1})}V.isXRRenderTarget=!0,this.setFoveation(p),y=null,c=await i.requestReferenceSpace(s),Vt.setContext(i),Vt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return D.getDepthTexture()};function Fe(je){for(let ct=0;ct<je.removed.length;ct++){const Ct=je.removed[ct],ut=H.indexOf(Ct);ut>=0&&(H[ut]=null,B[ut].disconnect(Ct))}for(let ct=0;ct<je.added.length;ct++){const Ct=je.added[ct];let ut=H.indexOf(Ct);if(ut===-1){for(let _t=0;_t<B.length;_t++)if(_t>=H.length){H.push(Ct),ut=_t;break}else if(H[_t]===null){H[_t]=Ct,ut=_t;break}if(ut===-1)break}const lt=B[ut];lt&&lt.connect(Ct)}}const Me=new At,Ee=new At;function Te(je,ct,Ct){Me.setFromMatrixPosition(ct.matrixWorld),Ee.setFromMatrixPosition(Ct.matrixWorld);const ut=Me.distanceTo(Ee),lt=ct.projectionMatrix.elements,_t=Ct.projectionMatrix.elements,wt=lt[14]/(lt[10]-1),cn=lt[14]/(lt[10]+1),dn=(lt[9]+1)/lt[5],tn=(lt[9]-1)/lt[5],Je=(lt[8]-1)/lt[0],Tn=(_t[8]+1)/_t[0],Kt=wt*Je,fn=wt*Tn,Ut=ut/(-Je+Tn),On=Ut*-Je;if(ct.matrixWorld.decompose(je.position,je.quaternion,je.scale),je.translateX(On),je.translateZ(Ut),je.matrixWorld.compose(je.position,je.quaternion,je.scale),je.matrixWorldInverse.copy(je.matrixWorld).invert(),lt[10]===-1)je.projectionMatrix.copy(ct.projectionMatrix),je.projectionMatrixInverse.copy(ct.projectionMatrixInverse);else{const vn=wt+Ut,Ue=cn+Ut,Se=Kt-On,yt=fn+(ut-On),Nt=dn*cn/Ue*vn,Ht=tn*cn/Ue*vn;je.projectionMatrix.makePerspective(Se,yt,Nt,Ht,vn,Ue),je.projectionMatrixInverse.copy(je.projectionMatrix).invert()}}function Ze(je,ct){ct===null?je.matrixWorld.copy(je.matrix):je.matrixWorld.multiplyMatrices(ct.matrixWorld,je.matrix),je.matrixWorldInverse.copy(je.matrixWorld).invert()}this.updateCamera=function(je){if(i===null)return;let ct=je.near,Ct=je.far;D.texture!==null&&(D.depthNear>0&&(ct=D.depthNear),D.depthFar>0&&(Ct=D.depthFar)),$.near=se.near=ee.near=ct,$.far=se.far=ee.far=Ct,(le!==$.near||Ce!==$.far)&&(i.updateRenderState({depthNear:$.near,depthFar:$.far}),le=$.near,Ce=$.far),ee.layers.mask=je.layers.mask|2,se.layers.mask=je.layers.mask|4,$.layers.mask=ee.layers.mask|se.layers.mask;const ut=je.parent,lt=$.cameras;Ze($,ut);for(let _t=0;_t<lt.length;_t++)Ze(lt[_t],ut);lt.length===2?Te($,ee,se):$.projectionMatrix.copy(ee.projectionMatrix),rt(je,$,ut)};function rt(je,ct,Ct){Ct===null?je.matrix.copy(ct.matrixWorld):(je.matrix.copy(Ct.matrixWorld),je.matrix.invert(),je.matrix.multiply(ct.matrixWorld)),je.matrix.decompose(je.position,je.quaternion,je.scale),je.updateMatrixWorld(!0),je.projectionMatrix.copy(ct.projectionMatrix),je.projectionMatrixInverse.copy(ct.projectionMatrixInverse),je.isPerspectiveCamera&&(je.fov=k_*2*Math.atan(1/je.projectionMatrix.elements[5]),je.zoom=1)}this.getCamera=function(){return $},this.getFoveation=function(){if(!(S===null&&M===null))return p},this.setFoveation=function(je){p=je,S!==null&&(S.fixedFoveation=je),M!==null&&M.fixedFoveation!==void 0&&(M.fixedFoveation=je)},this.hasDepthSensing=function(){return D.texture!==null},this.getDepthSensingMesh=function(){return D.getMesh($)};let Re=null;function Qe(je,ct){if(_=ct.getViewerPose(y||c),I=ct,_!==null){const Ct=_.views;M!==null&&(e.setRenderTargetFramebuffer(V,M.framebuffer),e.setRenderTarget(V));let ut=!1;Ct.length!==$.cameras.length&&($.cameras.length=0,ut=!0);for(let wt=0;wt<Ct.length;wt++){const cn=Ct[wt];let dn=null;if(M!==null)dn=M.getViewport(cn);else{const Je=w.getViewSubImage(S,cn);dn=Je.viewport,wt===0&&(e.setRenderTargetTextures(V,Je.colorTexture,Je.depthStencilTexture),e.setRenderTarget(V))}let tn=J[wt];tn===void 0&&(tn=new Nl,tn.layers.enable(wt),tn.viewport=new Do,J[wt]=tn),tn.matrix.fromArray(cn.transform.matrix),tn.matrix.decompose(tn.position,tn.quaternion,tn.scale),tn.projectionMatrix.fromArray(cn.projectionMatrix),tn.projectionMatrixInverse.copy(tn.projectionMatrix).invert(),tn.viewport.set(dn.x,dn.y,dn.width,dn.height),wt===0&&($.matrix.copy(tn.matrix),$.matrix.decompose($.position,$.quaternion,$.scale)),ut===!0&&$.cameras.push(tn)}const lt=i.enabledFeatures;if(lt&&lt.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&w){const wt=w.getDepthInformation(Ct[0]);wt&&wt.isValid&&wt.texture&&D.init(e,wt,i.renderState)}}for(let Ct=0;Ct<B.length;Ct++){const ut=H[Ct],lt=B[Ct];ut!==null&&lt!==void 0&&lt.update(ut,ct,y||c)}Re&&Re(je,ct),ct.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:ct}),I=null}const Vt=new _6;Vt.setAnimationLoop(Qe),this.setAnimationLoop=function(je){Re=je},this.dispose=function(){}}}const Sm=new Lh,Lve=new Pi;function kve(t,e){function n(R,L){R.matrixAutoUpdate===!0&&R.updateMatrix(),L.value.copy(R.matrix)}function r(R,L){L.color.getRGB(R.fogColor.value,m6(t)),L.isFog?(R.fogNear.value=L.near,R.fogFar.value=L.far):L.isFogExp2&&(R.fogDensity.value=L.density)}function i(R,L,V,B,H){L.isMeshBasicMaterial||L.isMeshLambertMaterial?l(R,L):L.isMeshToonMaterial?(l(R,L),w(R,L)):L.isMeshPhongMaterial?(l(R,L),_(R,L)):L.isMeshStandardMaterial?(l(R,L),S(R,L),L.isMeshPhysicalMaterial&&M(R,L,H)):L.isMeshMatcapMaterial?(l(R,L),I(R,L)):L.isMeshDepthMaterial?l(R,L):L.isMeshDistanceMaterial?(l(R,L),D(R,L)):L.isMeshNormalMaterial?l(R,L):L.isLineBasicMaterial?(c(R,L),L.isLineDashedMaterial&&s(R,L)):L.isPointsMaterial?p(R,L,V,B):L.isSpriteMaterial?y(R,L):L.isShadowMaterial?(R.color.value.copy(L.color),R.opacity.value=L.opacity):L.isShaderMaterial&&(L.uniformsNeedUpdate=!1)}function l(R,L){R.opacity.value=L.opacity,L.color&&R.diffuse.value.copy(L.color),L.emissive&&R.emissive.value.copy(L.emissive).multiplyScalar(L.emissiveIntensity),L.map&&(R.map.value=L.map,n(L.map,R.mapTransform)),L.alphaMap&&(R.alphaMap.value=L.alphaMap,n(L.alphaMap,R.alphaMapTransform)),L.bumpMap&&(R.bumpMap.value=L.bumpMap,n(L.bumpMap,R.bumpMapTransform),R.bumpScale.value=L.bumpScale,L.side===tl&&(R.bumpScale.value*=-1)),L.normalMap&&(R.normalMap.value=L.normalMap,n(L.normalMap,R.normalMapTransform),R.normalScale.value.copy(L.normalScale),L.side===tl&&R.normalScale.value.negate()),L.displacementMap&&(R.displacementMap.value=L.displacementMap,n(L.displacementMap,R.displacementMapTransform),R.displacementScale.value=L.displacementScale,R.displacementBias.value=L.displacementBias),L.emissiveMap&&(R.emissiveMap.value=L.emissiveMap,n(L.emissiveMap,R.emissiveMapTransform)),L.specularMap&&(R.specularMap.value=L.specularMap,n(L.specularMap,R.specularMapTransform)),L.alphaTest>0&&(R.alphaTest.value=L.alphaTest);const V=e.get(L),B=V.envMap,H=V.envMapRotation;B&&(R.envMap.value=B,Sm.copy(H),Sm.x*=-1,Sm.y*=-1,Sm.z*=-1,B.isCubeTexture&&B.isRenderTargetTexture===!1&&(Sm.y*=-1,Sm.z*=-1),R.envMapRotation.value.setFromMatrix4(Lve.makeRotationFromEuler(Sm)),R.flipEnvMap.value=B.isCubeTexture&&B.isRenderTargetTexture===!1?-1:1,R.reflectivity.value=L.reflectivity,R.ior.value=L.ior,R.refractionRatio.value=L.refractionRatio),L.lightMap&&(R.lightMap.value=L.lightMap,R.lightMapIntensity.value=L.lightMapIntensity,n(L.lightMap,R.lightMapTransform)),L.aoMap&&(R.aoMap.value=L.aoMap,R.aoMapIntensity.value=L.aoMapIntensity,n(L.aoMap,R.aoMapTransform))}function c(R,L){R.diffuse.value.copy(L.color),R.opacity.value=L.opacity,L.map&&(R.map.value=L.map,n(L.map,R.mapTransform))}function s(R,L){R.dashSize.value=L.dashSize,R.totalSize.value=L.dashSize+L.gapSize,R.scale.value=L.scale}function p(R,L,V,B){R.diffuse.value.copy(L.color),R.opacity.value=L.opacity,R.size.value=L.size*V,R.scale.value=B*.5,L.map&&(R.map.value=L.map,n(L.map,R.uvTransform)),L.alphaMap&&(R.alphaMap.value=L.alphaMap,n(L.alphaMap,R.alphaMapTransform)),L.alphaTest>0&&(R.alphaTest.value=L.alphaTest)}function y(R,L){R.diffuse.value.copy(L.color),R.opacity.value=L.opacity,R.rotation.value=L.rotation,L.map&&(R.map.value=L.map,n(L.map,R.mapTransform)),L.alphaMap&&(R.alphaMap.value=L.alphaMap,n(L.alphaMap,R.alphaMapTransform)),L.alphaTest>0&&(R.alphaTest.value=L.alphaTest)}function _(R,L){R.specular.value.copy(L.specular),R.shininess.value=Math.max(L.shininess,1e-4)}function w(R,L){L.gradientMap&&(R.gradientMap.value=L.gradientMap)}function S(R,L){R.metalness.value=L.metalness,L.metalnessMap&&(R.metalnessMap.value=L.metalnessMap,n(L.metalnessMap,R.metalnessMapTransform)),R.roughness.value=L.roughness,L.roughnessMap&&(R.roughnessMap.value=L.roughnessMap,n(L.roughnessMap,R.roughnessMapTransform)),L.envMap&&(R.envMapIntensity.value=L.envMapIntensity)}function M(R,L,V){R.ior.value=L.ior,L.sheen>0&&(R.sheenColor.value.copy(L.sheenColor).multiplyScalar(L.sheen),R.sheenRoughness.value=L.sheenRoughness,L.sheenColorMap&&(R.sheenColorMap.value=L.sheenColorMap,n(L.sheenColorMap,R.sheenColorMapTransform)),L.sheenRoughnessMap&&(R.sheenRoughnessMap.value=L.sheenRoughnessMap,n(L.sheenRoughnessMap,R.sheenRoughnessMapTransform))),L.clearcoat>0&&(R.clearcoat.value=L.clearcoat,R.clearcoatRoughness.value=L.clearcoatRoughness,L.clearcoatMap&&(R.clearcoatMap.value=L.clearcoatMap,n(L.clearcoatMap,R.clearcoatMapTransform)),L.clearcoatRoughnessMap&&(R.clearcoatRoughnessMap.value=L.clearcoatRoughnessMap,n(L.clearcoatRoughnessMap,R.clearcoatRoughnessMapTransform)),L.clearcoatNormalMap&&(R.clearcoatNormalMap.value=L.clearcoatNormalMap,n(L.clearcoatNormalMap,R.clearcoatNormalMapTransform),R.clearcoatNormalScale.value.copy(L.clearcoatNormalScale),L.side===tl&&R.clearcoatNormalScale.value.negate())),L.dispersion>0&&(R.dispersion.value=L.dispersion),L.iridescence>0&&(R.iridescence.value=L.iridescence,R.iridescenceIOR.value=L.iridescenceIOR,R.iridescenceThicknessMinimum.value=L.iridescenceThicknessRange[0],R.iridescenceThicknessMaximum.value=L.iridescenceThicknessRange[1],L.iridescenceMap&&(R.iridescenceMap.value=L.iridescenceMap,n(L.iridescenceMap,R.iridescenceMapTransform)),L.iridescenceThicknessMap&&(R.iridescenceThicknessMap.value=L.iridescenceThicknessMap,n(L.iridescenceThicknessMap,R.iridescenceThicknessMapTransform))),L.transmission>0&&(R.transmission.value=L.transmission,R.transmissionSamplerMap.value=V.texture,R.transmissionSamplerSize.value.set(V.width,V.height),L.transmissionMap&&(R.transmissionMap.value=L.transmissionMap,n(L.transmissionMap,R.transmissionMapTransform)),R.thickness.value=L.thickness,L.thicknessMap&&(R.thicknessMap.value=L.thicknessMap,n(L.thicknessMap,R.thicknessMapTransform)),R.attenuationDistance.value=L.attenuationDistance,R.attenuationColor.value.copy(L.attenuationColor)),L.anisotropy>0&&(R.anisotropyVector.value.set(L.anisotropy*Math.cos(L.anisotropyRotation),L.anisotropy*Math.sin(L.anisotropyRotation)),L.anisotropyMap&&(R.anisotropyMap.value=L.anisotropyMap,n(L.anisotropyMap,R.anisotropyMapTransform))),R.specularIntensity.value=L.specularIntensity,R.specularColor.value.copy(L.specularColor),L.specularColorMap&&(R.specularColorMap.value=L.specularColorMap,n(L.specularColorMap,R.specularColorMapTransform)),L.specularIntensityMap&&(R.specularIntensityMap.value=L.specularIntensityMap,n(L.specularIntensityMap,R.specularIntensityMapTransform))}function I(R,L){L.matcap&&(R.matcap.value=L.matcap)}function D(R,L){const V=e.get(L).light;R.referencePosition.value.setFromMatrixPosition(V.matrixWorld),R.nearDistance.value=V.shadow.camera.near,R.farDistance.value=V.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function Dve(t,e,n,r){let i={},l={},c=[];const s=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function p(V,B){const H=B.program;r.uniformBlockBinding(V,H)}function y(V,B){let H=i[V.id];H===void 0&&(I(V),H=_(V),i[V.id]=H,V.addEventListener("dispose",R));const q=B.program;r.updateUBOMapping(V,q);const X=e.render.frame;l[V.id]!==X&&(S(V),l[V.id]=X)}function _(V){const B=w();V.__bindingPointIndex=B;const H=t.createBuffer(),q=V.__size,X=V.usage;return t.bindBuffer(t.UNIFORM_BUFFER,H),t.bufferData(t.UNIFORM_BUFFER,q,X),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,B,H),H}function w(){for(let V=0;V<s;V++)if(c.indexOf(V)===-1)return c.push(V),V;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function S(V){const B=i[V.id],H=V.uniforms,q=V.__cache;t.bindBuffer(t.UNIFORM_BUFFER,B);for(let X=0,ee=H.length;X<ee;X++){const se=Array.isArray(H[X])?H[X]:[H[X]];for(let J=0,$=se.length;J<$;J++){const le=se[J];if(M(le,X,J,q)===!0){const Ce=le.__offset,we=Array.isArray(le.value)?le.value:[le.value];let We=0;for(let Fe=0;Fe<we.length;Fe++){const Me=we[Fe],Ee=D(Me);typeof Me=="number"||typeof Me=="boolean"?(le.__data[0]=Me,t.bufferSubData(t.UNIFORM_BUFFER,Ce+We,le.__data)):Me.isMatrix3?(le.__data[0]=Me.elements[0],le.__data[1]=Me.elements[1],le.__data[2]=Me.elements[2],le.__data[3]=0,le.__data[4]=Me.elements[3],le.__data[5]=Me.elements[4],le.__data[6]=Me.elements[5],le.__data[7]=0,le.__data[8]=Me.elements[6],le.__data[9]=Me.elements[7],le.__data[10]=Me.elements[8],le.__data[11]=0):(Me.toArray(le.__data,We),We+=Ee.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,Ce,le.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function M(V,B,H,q){const X=V.value,ee=B+"_"+H;if(q[ee]===void 0)return typeof X=="number"||typeof X=="boolean"?q[ee]=X:q[ee]=X.clone(),!0;{const se=q[ee];if(typeof X=="number"||typeof X=="boolean"){if(se!==X)return q[ee]=X,!0}else if(se.equals(X)===!1)return se.copy(X),!0}return!1}function I(V){const B=V.uniforms;let H=0;const q=16;for(let ee=0,se=B.length;ee<se;ee++){const J=Array.isArray(B[ee])?B[ee]:[B[ee]];for(let $=0,le=J.length;$<le;$++){const Ce=J[$],we=Array.isArray(Ce.value)?Ce.value:[Ce.value];for(let We=0,Fe=we.length;We<Fe;We++){const Me=we[We],Ee=D(Me),Te=H%q,Ze=Te%Ee.boundary,rt=Te+Ze;H+=Ze,rt!==0&&q-rt<Ee.storage&&(H+=q-rt),Ce.__data=new Float32Array(Ee.storage/Float32Array.BYTES_PER_ELEMENT),Ce.__offset=H,H+=Ee.storage}}}const X=H%q;return X>0&&(H+=q-X),V.__size=H,V.__cache={},this}function D(V){const B={boundary:0,storage:0};return typeof V=="number"||typeof V=="boolean"?(B.boundary=4,B.storage=4):V.isVector2?(B.boundary=8,B.storage=8):V.isVector3||V.isColor?(B.boundary=16,B.storage=12):V.isVector4?(B.boundary=16,B.storage=16):V.isMatrix3?(B.boundary=48,B.storage=48):V.isMatrix4?(B.boundary=64,B.storage=64):V.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",V),B}function R(V){const B=V.target;B.removeEventListener("dispose",R);const H=c.indexOf(B.__bindingPointIndex);c.splice(H,1),t.deleteBuffer(i[B.id]),delete i[B.id],delete l[B.id]}function L(){for(const V in i)t.deleteBuffer(i[V]);c=[],i={},l={}}return{bind:p,update:y,dispose:L}}class zve{constructor(e={}){const{canvas:n=hde(),context:r=null,depth:i=!0,stencil:l=!1,alpha:c=!1,antialias:s=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:y=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:w=!1,reverseDepthBuffer:S=!1}=e;this.isWebGLRenderer=!0;let M;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");M=r.getContextAttributes().alpha}else M=c;const I=new Uint32Array(4),D=new Int32Array(4);let R=null,L=null;const V=[],B=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ep,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const H=this;let q=!1;this._outputColorSpace=Ec;let X=0,ee=0,se=null,J=-1,$=null;const le=new Do,Ce=new Do;let we=null;const We=new bi(0);let Fe=0,Me=n.width,Ee=n.height,Te=1,Ze=null,rt=null;const Re=new Do(0,0,Me,Ee),Qe=new Do(0,0,Me,Ee);let Vt=!1;const je=new gI;let ct=!1,Ct=!1;const ut=new Pi,lt=new Pi,_t=new At,wt=new Do,cn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let dn=!1;function tn(){return se===null?Te:1}let Je=r;function Tn(xe,vt){return n.getContext(xe,vt)}try{const xe={alpha:!0,depth:i,stencil:l,antialias:s,premultipliedAlpha:p,preserveDrawingBuffer:y,powerPreference:_,failIfMajorPerformanceCaveat:w};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${oI}`),n.addEventListener("webglcontextlost",$e,!1),n.addEventListener("webglcontextrestored",He,!1),n.addEventListener("webglcontextcreationerror",dt,!1),Je===null){const vt="webgl2";if(Je=Tn(vt,xe),Je===null)throw Tn(vt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(xe){throw console.error("THREE.WebGLRenderer: "+xe.message),xe}let Kt,fn,Ut,On,vn,Ue,Se,yt,Nt,Ht,Ot,un,Gt,Zt,Nn,Yt,Pe,ae,ue,ne,fe,Oe,Ke,ye;function Ae(){Kt=new Gme(Je),Kt.init(),Oe=new Tve(Je,Kt),fn=new Nme(Je,Kt,e,Oe),Ut=new Cve(Je,Kt),fn.reverseDepthBuffer&&S&&Ut.buffers.depth.setReversed(!0),On=new Xme(Je),vn=new dve,Ue=new Eve(Je,Kt,Ut,vn,fn,Oe,On),Se=new Ume(H),yt=new Hme(H),Nt=new efe(Je),Ke=new Ome(Je,Nt),Ht=new Wme(Je,Nt,On,Ke),Ot=new Yme(Je,Ht,Nt,On),ue=new Zme(Je,fn,Ue),Yt=new Bme(vn),un=new hve(H,Se,yt,Kt,fn,Ke,Yt),Gt=new kve(H,vn),Zt=new pve,Nn=new xve(Kt),ae=new zme(H,Se,yt,Ut,Ot,M,p),Pe=new Sve(H,Ot,fn),ye=new Dve(Je,On,fn,Ut),ne=new Fme(Je,Kt,On),fe=new qme(Je,Kt,On),On.programs=un.programs,H.capabilities=fn,H.extensions=Kt,H.properties=vn,H.renderLists=Zt,H.shadowMap=Pe,H.state=Ut,H.info=On}Ae();const Be=new Rve(H,Je);this.xr=Be,this.getContext=function(){return Je},this.getContextAttributes=function(){return Je.getContextAttributes()},this.forceContextLoss=function(){const xe=Kt.get("WEBGL_lose_context");xe&&xe.loseContext()},this.forceContextRestore=function(){const xe=Kt.get("WEBGL_lose_context");xe&&xe.restoreContext()},this.getPixelRatio=function(){return Te},this.setPixelRatio=function(xe){xe!==void 0&&(Te=xe,this.setSize(Me,Ee,!1))},this.getSize=function(xe){return xe.set(Me,Ee)},this.setSize=function(xe,vt,Dt=!0){if(Be.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Me=xe,Ee=vt,n.width=Math.floor(xe*Te),n.height=Math.floor(vt*Te),Dt===!0&&(n.style.width=xe+"px",n.style.height=vt+"px"),this.setViewport(0,0,xe,vt)},this.getDrawingBufferSize=function(xe){return xe.set(Me*Te,Ee*Te).floor()},this.setDrawingBufferSize=function(xe,vt,Dt){Me=xe,Ee=vt,Te=Dt,n.width=Math.floor(xe*Dt),n.height=Math.floor(vt*Dt),this.setViewport(0,0,xe,vt)},this.getCurrentViewport=function(xe){return xe.copy(le)},this.getViewport=function(xe){return xe.copy(Re)},this.setViewport=function(xe,vt,Dt,bt){xe.isVector4?Re.set(xe.x,xe.y,xe.z,xe.w):Re.set(xe,vt,Dt,bt),Ut.viewport(le.copy(Re).multiplyScalar(Te).round())},this.getScissor=function(xe){return xe.copy(Qe)},this.setScissor=function(xe,vt,Dt,bt){xe.isVector4?Qe.set(xe.x,xe.y,xe.z,xe.w):Qe.set(xe,vt,Dt,bt),Ut.scissor(Ce.copy(Qe).multiplyScalar(Te).round())},this.getScissorTest=function(){return Vt},this.setScissorTest=function(xe){Ut.setScissorTest(Vt=xe)},this.setOpaqueSort=function(xe){Ze=xe},this.setTransparentSort=function(xe){rt=xe},this.getClearColor=function(xe){return xe.copy(ae.getClearColor())},this.setClearColor=function(){ae.setClearColor(...arguments)},this.getClearAlpha=function(){return ae.getClearAlpha()},this.setClearAlpha=function(){ae.setClearAlpha(...arguments)},this.clear=function(xe=!0,vt=!0,Dt=!0){let bt=0;if(xe){let St=!1;if(se!==null){const pn=se.texture.format;St=pn===hI||pn===uI||pn===cI}if(St){const pn=se.texture.type,An=pn===Zd||pn===Xm||pn===A_||pn===I_||pn===aI||pn===lI,gn=ae.getClearColor(),Pn=ae.getClearAlpha(),Qt=gn.r,Zn=gn.g,In=gn.b;An?(I[0]=Qt,I[1]=Zn,I[2]=In,I[3]=Pn,Je.clearBufferuiv(Je.COLOR,0,I)):(D[0]=Qt,D[1]=Zn,D[2]=In,D[3]=Pn,Je.clearBufferiv(Je.COLOR,0,D))}else bt|=Je.COLOR_BUFFER_BIT}vt&&(bt|=Je.DEPTH_BUFFER_BIT),Dt&&(bt|=Je.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Je.clear(bt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",$e,!1),n.removeEventListener("webglcontextrestored",He,!1),n.removeEventListener("webglcontextcreationerror",dt,!1),ae.dispose(),Zt.dispose(),Nn.dispose(),vn.dispose(),Se.dispose(),yt.dispose(),Ot.dispose(),Ke.dispose(),ye.dispose(),un.dispose(),Be.dispose(),Be.removeEventListener("sessionstart",Wt),Be.removeEventListener("sessionend",nn),mn.stop()};function $e(xe){xe.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),q=!0}function He(){console.log("THREE.WebGLRenderer: Context Restored."),q=!1;const xe=On.autoReset,vt=Pe.enabled,Dt=Pe.autoUpdate,bt=Pe.needsUpdate,St=Pe.type;Ae(),On.autoReset=xe,Pe.enabled=vt,Pe.autoUpdate=Dt,Pe.needsUpdate=bt,Pe.type=St}function dt(xe){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",xe.statusMessage)}function qe(xe){const vt=xe.target;vt.removeEventListener("dispose",qe),$t(vt)}function $t(xe){Jt(xe),vn.remove(xe)}function Jt(xe){const vt=vn.get(xe).programs;vt!==void 0&&(vt.forEach(function(Dt){un.releaseProgram(Dt)}),xe.isShaderMaterial&&un.releaseShaderCache(xe))}this.renderBufferDirect=function(xe,vt,Dt,bt,St,pn){vt===null&&(vt=cn);const An=St.isMesh&&St.matrixWorld.determinant()<0,gn=nt(xe,vt,Dt,bt,St);Ut.setMaterial(bt,An);let Pn=Dt.index,Qt=1;if(bt.wireframe===!0){if(Pn=Ht.getWireframeAttribute(Dt),Pn===void 0)return;Qt=2}const Zn=Dt.drawRange,In=Dt.attributes.position;let Wn=Zn.start*Qt,tr=(Zn.start+Zn.count)*Qt;pn!==null&&(Wn=Math.max(Wn,pn.start*Qt),tr=Math.min(tr,(pn.start+pn.count)*Qt)),Pn!==null?(Wn=Math.max(Wn,0),tr=Math.min(tr,Pn.count)):In!=null&&(Wn=Math.max(Wn,0),tr=Math.min(tr,In.count));const Or=tr-Wn;if(Or<0||Or===1/0)return;Ke.setup(St,bt,gn,Dt,Pn);let Fr,wr=ne;if(Pn!==null&&(Fr=Nt.get(Pn),wr=fe,wr.setIndex(Fr)),St.isMesh)bt.wireframe===!0?(Ut.setLineWidth(bt.wireframeLinewidth*tn()),wr.setMode(Je.LINES)):wr.setMode(Je.TRIANGLES);else if(St.isLine){let ur=bt.linewidth;ur===void 0&&(ur=1),Ut.setLineWidth(ur*tn()),St.isLineSegments?wr.setMode(Je.LINES):St.isLineLoop?wr.setMode(Je.LINE_LOOP):wr.setMode(Je.LINE_STRIP)}else St.isPoints?wr.setMode(Je.POINTS):St.isSprite&&wr.setMode(Je.TRIANGLES);if(St.isBatchedMesh)if(St._multiDrawInstances!==null)_b("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),wr.renderMultiDrawInstances(St._multiDrawStarts,St._multiDrawCounts,St._multiDrawCount,St._multiDrawInstances);else if(Kt.get("WEBGL_multi_draw"))wr.renderMultiDraw(St._multiDrawStarts,St._multiDrawCounts,St._multiDrawCount);else{const ur=St._multiDrawStarts,ui=St._multiDrawCounts,kr=St._multiDrawCount,Eo=Pn?Nt.get(Pn).bytesPerElement:1,Ys=vn.get(bt).currentProgram.getUniforms();for(let Jo=0;Jo<kr;Jo++)Ys.setValue(Je,"_gl_DrawID",Jo),wr.render(ur[Jo]/Eo,ui[Jo])}else if(St.isInstancedMesh)wr.renderInstances(Wn,Or,St.count);else if(Dt.isInstancedBufferGeometry){const ur=Dt._maxInstanceCount!==void 0?Dt._maxInstanceCount:1/0,ui=Math.min(Dt.instanceCount,ur);wr.renderInstances(Wn,Or,ui)}else wr.render(Wn,Or)};function Ie(xe,vt,Dt){xe.transparent===!0&&xe.side===Bd&&xe.forceSinglePass===!1?(xe.side=tl,xe.needsUpdate=!0,Fn(xe,vt,Dt),xe.side=up,xe.needsUpdate=!0,Fn(xe,vt,Dt),xe.side=Bd):Fn(xe,vt,Dt)}this.compile=function(xe,vt,Dt=null){Dt===null&&(Dt=xe),L=Nn.get(Dt),L.init(vt),B.push(L),Dt.traverseVisible(function(St){St.isLight&&St.layers.test(vt.layers)&&(L.pushLight(St),St.castShadow&&L.pushShadow(St))}),xe!==Dt&&xe.traverseVisible(function(St){St.isLight&&St.layers.test(vt.layers)&&(L.pushLight(St),St.castShadow&&L.pushShadow(St))}),L.setupLights();const bt=new Set;return xe.traverse(function(St){if(!(St.isMesh||St.isPoints||St.isLine||St.isSprite))return;const pn=St.material;if(pn)if(Array.isArray(pn))for(let An=0;An<pn.length;An++){const gn=pn[An];Ie(gn,Dt,St),bt.add(gn)}else Ie(pn,Dt,St),bt.add(pn)}),L=B.pop(),bt},this.compileAsync=function(xe,vt,Dt=null){const bt=this.compile(xe,vt,Dt);return new Promise(St=>{function pn(){if(bt.forEach(function(An){vn.get(An).currentProgram.isReady()&&bt.delete(An)}),bt.size===0){St(xe);return}setTimeout(pn,10)}Kt.get("KHR_parallel_shader_compile")!==null?pn():setTimeout(pn,10)})};let ot=null;function mt(xe){ot&&ot(xe)}function Wt(){mn.stop()}function nn(){mn.start()}const mn=new _6;mn.setAnimationLoop(mt),typeof self<"u"&&mn.setContext(self),this.setAnimationLoop=function(xe){ot=xe,Be.setAnimationLoop(xe),xe===null?mn.stop():mn.start()},Be.addEventListener("sessionstart",Wt),Be.addEventListener("sessionend",nn),this.render=function(xe,vt){if(vt!==void 0&&vt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(q===!0)return;if(xe.matrixWorldAutoUpdate===!0&&xe.updateMatrixWorld(),vt.parent===null&&vt.matrixWorldAutoUpdate===!0&&vt.updateMatrixWorld(),Be.enabled===!0&&Be.isPresenting===!0&&(Be.cameraAutoUpdate===!0&&Be.updateCamera(vt),vt=Be.getCamera()),xe.isScene===!0&&xe.onBeforeRender(H,xe,vt,se),L=Nn.get(xe,B.length),L.init(vt),B.push(L),lt.multiplyMatrices(vt.projectionMatrix,vt.matrixWorldInverse),je.setFromProjectionMatrix(lt),Ct=this.localClippingEnabled,ct=Yt.init(this.clippingPlanes,Ct),R=Zt.get(xe,V.length),R.init(),V.push(R),Be.enabled===!0&&Be.isPresenting===!0){const pn=H.xr.getDepthSensingMesh();pn!==null&&on(pn,vt,-1/0,H.sortObjects)}on(xe,vt,0,H.sortObjects),R.finish(),H.sortObjects===!0&&R.sort(Ze,rt),dn=Be.enabled===!1||Be.isPresenting===!1||Be.hasDepthSensing()===!1,dn&&ae.addToRenderList(R,xe),this.info.render.frame++,ct===!0&&Yt.beginShadows();const Dt=L.state.shadowsArray;Pe.render(Dt,xe,vt),ct===!0&&Yt.endShadows(),this.info.autoReset===!0&&this.info.reset();const bt=R.opaque,St=R.transmissive;if(L.setupLights(),vt.isArrayCamera){const pn=vt.cameras;if(St.length>0)for(let An=0,gn=pn.length;An<gn;An++){const Pn=pn[An];Dn(bt,St,xe,Pn)}dn&&ae.render(xe);for(let An=0,gn=pn.length;An<gn;An++){const Pn=pn[An];sn(R,xe,Pn,Pn.viewport)}}else St.length>0&&Dn(bt,St,xe,vt),dn&&ae.render(xe),sn(R,xe,vt);se!==null&&ee===0&&(Ue.updateMultisampleRenderTarget(se),Ue.updateRenderTargetMipmap(se)),xe.isScene===!0&&xe.onAfterRender(H,xe,vt),Ke.resetDefaultState(),J=-1,$=null,B.pop(),B.length>0?(L=B[B.length-1],ct===!0&&Yt.setGlobalState(H.clippingPlanes,L.state.camera)):L=null,V.pop(),V.length>0?R=V[V.length-1]:R=null};function on(xe,vt,Dt,bt){if(xe.visible===!1)return;if(xe.layers.test(vt.layers)){if(xe.isGroup)Dt=xe.renderOrder;else if(xe.isLOD)xe.autoUpdate===!0&&xe.update(vt);else if(xe.isLight)L.pushLight(xe),xe.castShadow&&L.pushShadow(xe);else if(xe.isSprite){if(!xe.frustumCulled||je.intersectsSprite(xe)){bt&&wt.setFromMatrixPosition(xe.matrixWorld).applyMatrix4(lt);const An=Ot.update(xe),gn=xe.material;gn.visible&&R.push(xe,An,gn,Dt,wt.z,null)}}else if((xe.isMesh||xe.isLine||xe.isPoints)&&(!xe.frustumCulled||je.intersectsObject(xe))){const An=Ot.update(xe),gn=xe.material;if(bt&&(xe.boundingSphere!==void 0?(xe.boundingSphere===null&&xe.computeBoundingSphere(),wt.copy(xe.boundingSphere.center)):(An.boundingSphere===null&&An.computeBoundingSphere(),wt.copy(An.boundingSphere.center)),wt.applyMatrix4(xe.matrixWorld).applyMatrix4(lt)),Array.isArray(gn)){const Pn=An.groups;for(let Qt=0,Zn=Pn.length;Qt<Zn;Qt++){const In=Pn[Qt],Wn=gn[In.materialIndex];Wn&&Wn.visible&&R.push(xe,An,Wn,Dt,wt.z,In)}}else gn.visible&&R.push(xe,An,gn,Dt,wt.z,null)}}const pn=xe.children;for(let An=0,gn=pn.length;An<gn;An++)on(pn[An],vt,Dt,bt)}function sn(xe,vt,Dt,bt){const St=xe.opaque,pn=xe.transmissive,An=xe.transparent;L.setupLightsView(Dt),ct===!0&&Yt.setGlobalState(H.clippingPlanes,Dt),bt&&Ut.viewport(le.copy(bt)),St.length>0&&Et(St,vt,Dt),pn.length>0&&Et(pn,vt,Dt),An.length>0&&Et(An,vt,Dt),Ut.buffers.depth.setTest(!0),Ut.buffers.depth.setMask(!0),Ut.buffers.color.setMask(!0),Ut.setPolygonOffset(!1)}function Dn(xe,vt,Dt,bt){if((Dt.isScene===!0?Dt.overrideMaterial:null)!==null)return;L.state.transmissionRenderTarget[bt.id]===void 0&&(L.state.transmissionRenderTarget[bt.id]=new hp(1,1,{generateMipmaps:!0,type:Kt.has("EXT_color_buffer_half_float")||Kt.has("EXT_color_buffer_float")?vx:Zd,minFilter:Yf,samples:4,stencilBuffer:l,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:li.workingColorSpace}));const pn=L.state.transmissionRenderTarget[bt.id],An=bt.viewport||le;pn.setSize(An.z*H.transmissionResolutionScale,An.w*H.transmissionResolutionScale);const gn=H.getRenderTarget();H.setRenderTarget(pn),H.getClearColor(We),Fe=H.getClearAlpha(),Fe<1&&H.setClearColor(16777215,.5),H.clear(),dn&&ae.render(Dt);const Pn=H.toneMapping;H.toneMapping=ep;const Qt=bt.viewport;if(bt.viewport!==void 0&&(bt.viewport=void 0),L.setupLightsView(bt),ct===!0&&Yt.setGlobalState(H.clippingPlanes,bt),Et(xe,Dt,bt),Ue.updateMultisampleRenderTarget(pn),Ue.updateRenderTargetMipmap(pn),Kt.has("WEBGL_multisampled_render_to_texture")===!1){let Zn=!1;for(let In=0,Wn=vt.length;In<Wn;In++){const tr=vt[In],Or=tr.object,Fr=tr.geometry,wr=tr.material,ur=tr.group;if(wr.side===Bd&&Or.layers.test(bt.layers)){const ui=wr.side;wr.side=tl,wr.needsUpdate=!0,Gn(Or,Dt,bt,Fr,wr,ur),wr.side=ui,wr.needsUpdate=!0,Zn=!0}}Zn===!0&&(Ue.updateMultisampleRenderTarget(pn),Ue.updateRenderTargetMipmap(pn))}H.setRenderTarget(gn),H.setClearColor(We,Fe),Qt!==void 0&&(bt.viewport=Qt),H.toneMapping=Pn}function Et(xe,vt,Dt){const bt=vt.isScene===!0?vt.overrideMaterial:null;for(let St=0,pn=xe.length;St<pn;St++){const An=xe[St],gn=An.object,Pn=An.geometry,Qt=An.group;let Zn=An.material;Zn.allowOverride===!0&&bt!==null&&(Zn=bt),gn.layers.test(Dt.layers)&&Gn(gn,vt,Dt,Pn,Zn,Qt)}}function Gn(xe,vt,Dt,bt,St,pn){xe.onBeforeRender(H,vt,Dt,bt,St,pn),xe.modelViewMatrix.multiplyMatrices(Dt.matrixWorldInverse,xe.matrixWorld),xe.normalMatrix.getNormalMatrix(xe.modelViewMatrix),St.onBeforeRender(H,vt,Dt,bt,xe,pn),St.transparent===!0&&St.side===Bd&&St.forceSinglePass===!1?(St.side=tl,St.needsUpdate=!0,H.renderBufferDirect(Dt,vt,bt,St,xe,pn),St.side=up,St.needsUpdate=!0,H.renderBufferDirect(Dt,vt,bt,St,xe,pn),St.side=Bd):H.renderBufferDirect(Dt,vt,bt,St,xe,pn),xe.onAfterRender(H,vt,Dt,bt,St,pn)}function Fn(xe,vt,Dt){vt.isScene!==!0&&(vt=cn);const bt=vn.get(xe),St=L.state.lights,pn=L.state.shadowsArray,An=St.state.version,gn=un.getParameters(xe,St.state,pn,vt,Dt),Pn=un.getProgramCacheKey(gn);let Qt=bt.programs;bt.environment=xe.isMeshStandardMaterial?vt.environment:null,bt.fog=vt.fog,bt.envMap=(xe.isMeshStandardMaterial?yt:Se).get(xe.envMap||bt.environment),bt.envMapRotation=bt.environment!==null&&xe.envMap===null?vt.environmentRotation:xe.envMapRotation,Qt===void 0&&(xe.addEventListener("dispose",qe),Qt=new Map,bt.programs=Qt);let Zn=Qt.get(Pn);if(Zn!==void 0){if(bt.currentProgram===Zn&&bt.lightsStateVersion===An)return It(xe,gn),Zn}else gn.uniforms=un.getUniforms(xe),xe.onBeforeCompile(gn,H),Zn=un.acquireProgram(gn,Pn),Qt.set(Pn,Zn),bt.uniforms=gn.uniforms;const In=bt.uniforms;return(!xe.isShaderMaterial&&!xe.isRawShaderMaterial||xe.clipping===!0)&&(In.clippingPlanes=Yt.uniform),It(xe,gn),bt.needsLights=hn(xe),bt.lightsStateVersion=An,bt.needsLights&&(In.ambientLightColor.value=St.state.ambient,In.lightProbe.value=St.state.probe,In.directionalLights.value=St.state.directional,In.directionalLightShadows.value=St.state.directionalShadow,In.spotLights.value=St.state.spot,In.spotLightShadows.value=St.state.spotShadow,In.rectAreaLights.value=St.state.rectArea,In.ltc_1.value=St.state.rectAreaLTC1,In.ltc_2.value=St.state.rectAreaLTC2,In.pointLights.value=St.state.point,In.pointLightShadows.value=St.state.pointShadow,In.hemisphereLights.value=St.state.hemi,In.directionalShadowMap.value=St.state.directionalShadowMap,In.directionalShadowMatrix.value=St.state.directionalShadowMatrix,In.spotShadowMap.value=St.state.spotShadowMap,In.spotLightMatrix.value=St.state.spotLightMatrix,In.spotLightMap.value=St.state.spotLightMap,In.pointShadowMap.value=St.state.pointShadowMap,In.pointShadowMatrix.value=St.state.pointShadowMatrix),bt.currentProgram=Zn,bt.uniformsList=null,Zn}function or(xe){if(xe.uniformsList===null){const vt=xe.currentProgram.getUniforms();xe.uniformsList=xb.seqWithValue(vt.seq,xe.uniforms)}return xe.uniformsList}function It(xe,vt){const Dt=vn.get(xe);Dt.outputColorSpace=vt.outputColorSpace,Dt.batching=vt.batching,Dt.batchingColor=vt.batchingColor,Dt.instancing=vt.instancing,Dt.instancingColor=vt.instancingColor,Dt.instancingMorph=vt.instancingMorph,Dt.skinning=vt.skinning,Dt.morphTargets=vt.morphTargets,Dt.morphNormals=vt.morphNormals,Dt.morphColors=vt.morphColors,Dt.morphTargetsCount=vt.morphTargetsCount,Dt.numClippingPlanes=vt.numClippingPlanes,Dt.numIntersection=vt.numClipIntersection,Dt.vertexAlphas=vt.vertexAlphas,Dt.vertexTangents=vt.vertexTangents,Dt.toneMapping=vt.toneMapping}function nt(xe,vt,Dt,bt,St){vt.isScene!==!0&&(vt=cn),Ue.resetTextureUnits();const pn=vt.fog,An=bt.isMeshStandardMaterial?vt.environment:null,gn=se===null?H.outputColorSpace:se.isXRRenderTarget===!0?se.texture.colorSpace:Zm,Pn=(bt.isMeshStandardMaterial?yt:Se).get(bt.envMap||An),Qt=bt.vertexColors===!0&&!!Dt.attributes.color&&Dt.attributes.color.itemSize===4,Zn=!!Dt.attributes.tangent&&(!!bt.normalMap||bt.anisotropy>0),In=!!Dt.morphAttributes.position,Wn=!!Dt.morphAttributes.normal,tr=!!Dt.morphAttributes.color;let Or=ep;bt.toneMapped&&(se===null||se.isXRRenderTarget===!0)&&(Or=H.toneMapping);const Fr=Dt.morphAttributes.position||Dt.morphAttributes.normal||Dt.morphAttributes.color,wr=Fr!==void 0?Fr.length:0,ur=vn.get(bt),ui=L.state.lights;if(ct===!0&&(Ct===!0||xe!==$)){const ho=xe===$&&bt.id===J;Yt.setState(bt,xe,ho)}let kr=!1;bt.version===ur.__version?(ur.needsLights&&ur.lightsStateVersion!==ui.state.version||ur.outputColorSpace!==gn||St.isBatchedMesh&&ur.batching===!1||!St.isBatchedMesh&&ur.batching===!0||St.isBatchedMesh&&ur.batchingColor===!0&&St.colorTexture===null||St.isBatchedMesh&&ur.batchingColor===!1&&St.colorTexture!==null||St.isInstancedMesh&&ur.instancing===!1||!St.isInstancedMesh&&ur.instancing===!0||St.isSkinnedMesh&&ur.skinning===!1||!St.isSkinnedMesh&&ur.skinning===!0||St.isInstancedMesh&&ur.instancingColor===!0&&St.instanceColor===null||St.isInstancedMesh&&ur.instancingColor===!1&&St.instanceColor!==null||St.isInstancedMesh&&ur.instancingMorph===!0&&St.morphTexture===null||St.isInstancedMesh&&ur.instancingMorph===!1&&St.morphTexture!==null||ur.envMap!==Pn||bt.fog===!0&&ur.fog!==pn||ur.numClippingPlanes!==void 0&&(ur.numClippingPlanes!==Yt.numPlanes||ur.numIntersection!==Yt.numIntersection)||ur.vertexAlphas!==Qt||ur.vertexTangents!==Zn||ur.morphTargets!==In||ur.morphNormals!==Wn||ur.morphColors!==tr||ur.toneMapping!==Or||ur.morphTargetsCount!==wr)&&(kr=!0):(kr=!0,ur.__version=bt.version);let Eo=ur.currentProgram;kr===!0&&(Eo=Fn(bt,vt,St));let Ys=!1,Jo=!1,Ra=!1;const Zr=Eo.getUniforms(),uo=ur.uniforms;if(Ut.useProgram(Eo.program)&&(Ys=!0,Jo=!0,Ra=!0),bt.id!==J&&(J=bt.id,Jo=!0),Ys||$!==xe){Ut.buffers.depth.getReversed()?(ut.copy(xe.projectionMatrix),fde(ut),pde(ut),Zr.setValue(Je,"projectionMatrix",ut)):Zr.setValue(Je,"projectionMatrix",xe.projectionMatrix),Zr.setValue(Je,"viewMatrix",xe.matrixWorldInverse);const Vi=Zr.map.cameraPosition;Vi!==void 0&&Vi.setValue(Je,_t.setFromMatrixPosition(xe.matrixWorld)),fn.logarithmicDepthBuffer&&Zr.setValue(Je,"logDepthBufFC",2/(Math.log(xe.far+1)/Math.LN2)),(bt.isMeshPhongMaterial||bt.isMeshToonMaterial||bt.isMeshLambertMaterial||bt.isMeshBasicMaterial||bt.isMeshStandardMaterial||bt.isShaderMaterial)&&Zr.setValue(Je,"isOrthographic",xe.isOrthographicCamera===!0),$!==xe&&($=xe,Jo=!0,Ra=!0)}if(St.isSkinnedMesh){Zr.setOptional(Je,St,"bindMatrix"),Zr.setOptional(Je,St,"bindMatrixInverse");const ho=St.skeleton;ho&&(ho.boneTexture===null&&ho.computeBoneTexture(),Zr.setValue(Je,"boneTexture",ho.boneTexture,Ue))}St.isBatchedMesh&&(Zr.setOptional(Je,St,"batchingTexture"),Zr.setValue(Je,"batchingTexture",St._matricesTexture,Ue),Zr.setOptional(Je,St,"batchingIdTexture"),Zr.setValue(Je,"batchingIdTexture",St._indirectTexture,Ue),Zr.setOptional(Je,St,"batchingColorTexture"),St._colorsTexture!==null&&Zr.setValue(Je,"batchingColorTexture",St._colorsTexture,Ue));const Xi=Dt.morphAttributes;if((Xi.position!==void 0||Xi.normal!==void 0||Xi.color!==void 0)&&ue.update(St,Dt,Eo),(Jo||ur.receiveShadow!==St.receiveShadow)&&(ur.receiveShadow=St.receiveShadow,Zr.setValue(Je,"receiveShadow",St.receiveShadow)),bt.isMeshGouraudMaterial&&bt.envMap!==null&&(uo.envMap.value=Pn,uo.flipEnvMap.value=Pn.isCubeTexture&&Pn.isRenderTargetTexture===!1?-1:1),bt.isMeshStandardMaterial&&bt.envMap===null&&vt.environment!==null&&(uo.envMapIntensity.value=vt.environmentIntensity),Jo&&(Zr.setValue(Je,"toneMappingExposure",H.toneMappingExposure),ur.needsLights&&qt(uo,Ra),pn&&bt.fog===!0&&Gt.refreshFogUniforms(uo,pn),Gt.refreshMaterialUniforms(uo,bt,Te,Ee,L.state.transmissionRenderTarget[xe.id]),xb.upload(Je,or(ur),uo,Ue)),bt.isShaderMaterial&&bt.uniformsNeedUpdate===!0&&(xb.upload(Je,or(ur),uo,Ue),bt.uniformsNeedUpdate=!1),bt.isSpriteMaterial&&Zr.setValue(Je,"center",St.center),Zr.setValue(Je,"modelViewMatrix",St.modelViewMatrix),Zr.setValue(Je,"normalMatrix",St.normalMatrix),Zr.setValue(Je,"modelMatrix",St.matrixWorld),bt.isShaderMaterial||bt.isRawShaderMaterial){const ho=bt.uniformsGroups;for(let Vi=0,Nr=ho.length;Vi<Nr;Vi++){const io=ho[Vi];ye.update(io,Eo),ye.bind(io,Eo)}}return Eo}function qt(xe,vt){xe.ambientLightColor.needsUpdate=vt,xe.lightProbe.needsUpdate=vt,xe.directionalLights.needsUpdate=vt,xe.directionalLightShadows.needsUpdate=vt,xe.pointLights.needsUpdate=vt,xe.pointLightShadows.needsUpdate=vt,xe.spotLights.needsUpdate=vt,xe.spotLightShadows.needsUpdate=vt,xe.rectAreaLights.needsUpdate=vt,xe.hemisphereLights.needsUpdate=vt}function hn(xe){return xe.isMeshLambertMaterial||xe.isMeshToonMaterial||xe.isMeshPhongMaterial||xe.isMeshStandardMaterial||xe.isShadowMaterial||xe.isShaderMaterial&&xe.lights===!0}this.getActiveCubeFace=function(){return X},this.getActiveMipmapLevel=function(){return ee},this.getRenderTarget=function(){return se},this.setRenderTargetTextures=function(xe,vt,Dt){const bt=vn.get(xe);bt.__autoAllocateDepthBuffer=xe.resolveDepthBuffer===!1,bt.__autoAllocateDepthBuffer===!1&&(bt.__useRenderToTexture=!1),vn.get(xe.texture).__webglTexture=vt,vn.get(xe.depthTexture).__webglTexture=bt.__autoAllocateDepthBuffer?void 0:Dt,bt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(xe,vt){const Dt=vn.get(xe);Dt.__webglFramebuffer=vt,Dt.__useDefaultFramebuffer=vt===void 0};const kn=Je.createFramebuffer();this.setRenderTarget=function(xe,vt=0,Dt=0){se=xe,X=vt,ee=Dt;let bt=!0,St=null,pn=!1,An=!1;if(xe){const Pn=vn.get(xe);if(Pn.__useDefaultFramebuffer!==void 0)Ut.bindFramebuffer(Je.FRAMEBUFFER,null),bt=!1;else if(Pn.__webglFramebuffer===void 0)Ue.setupRenderTarget(xe);else if(Pn.__hasExternalTextures)Ue.rebindTextures(xe,vn.get(xe.texture).__webglTexture,vn.get(xe.depthTexture).__webglTexture);else if(xe.depthBuffer){const In=xe.depthTexture;if(Pn.__boundDepthTexture!==In){if(In!==null&&vn.has(In)&&(xe.width!==In.image.width||xe.height!==In.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Ue.setupDepthRenderbuffer(xe)}}const Qt=xe.texture;(Qt.isData3DTexture||Qt.isDataArrayTexture||Qt.isCompressedArrayTexture)&&(An=!0);const Zn=vn.get(xe).__webglFramebuffer;xe.isWebGLCubeRenderTarget?(Array.isArray(Zn[vt])?St=Zn[vt][Dt]:St=Zn[vt],pn=!0):xe.samples>0&&Ue.useMultisampledRTT(xe)===!1?St=vn.get(xe).__webglMultisampledFramebuffer:Array.isArray(Zn)?St=Zn[Dt]:St=Zn,le.copy(xe.viewport),Ce.copy(xe.scissor),we=xe.scissorTest}else le.copy(Re).multiplyScalar(Te).floor(),Ce.copy(Qe).multiplyScalar(Te).floor(),we=Vt;if(Dt!==0&&(St=kn),Ut.bindFramebuffer(Je.FRAMEBUFFER,St)&&bt&&Ut.drawBuffers(xe,St),Ut.viewport(le),Ut.scissor(Ce),Ut.setScissorTest(we),pn){const Pn=vn.get(xe.texture);Je.framebufferTexture2D(Je.FRAMEBUFFER,Je.COLOR_ATTACHMENT0,Je.TEXTURE_CUBE_MAP_POSITIVE_X+vt,Pn.__webglTexture,Dt)}else if(An){const Pn=vn.get(xe.texture),Qt=vt;Je.framebufferTextureLayer(Je.FRAMEBUFFER,Je.COLOR_ATTACHMENT0,Pn.__webglTexture,Dt,Qt)}else if(xe!==null&&Dt!==0){const Pn=vn.get(xe.texture);Je.framebufferTexture2D(Je.FRAMEBUFFER,Je.COLOR_ATTACHMENT0,Je.TEXTURE_2D,Pn.__webglTexture,Dt)}J=-1},this.readRenderTargetPixels=function(xe,vt,Dt,bt,St,pn,An){if(!(xe&&xe.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let gn=vn.get(xe).__webglFramebuffer;if(xe.isWebGLCubeRenderTarget&&An!==void 0&&(gn=gn[An]),gn){Ut.bindFramebuffer(Je.FRAMEBUFFER,gn);try{const Pn=xe.texture,Qt=Pn.format,Zn=Pn.type;if(!fn.textureFormatReadable(Qt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!fn.textureTypeReadable(Zn)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}vt>=0&&vt<=xe.width-bt&&Dt>=0&&Dt<=xe.height-St&&Je.readPixels(vt,Dt,bt,St,Oe.convert(Qt),Oe.convert(Zn),pn)}finally{const Pn=se!==null?vn.get(se).__webglFramebuffer:null;Ut.bindFramebuffer(Je.FRAMEBUFFER,Pn)}}},this.readRenderTargetPixelsAsync=async function(xe,vt,Dt,bt,St,pn,An){if(!(xe&&xe.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let gn=vn.get(xe).__webglFramebuffer;if(xe.isWebGLCubeRenderTarget&&An!==void 0&&(gn=gn[An]),gn)if(vt>=0&&vt<=xe.width-bt&&Dt>=0&&Dt<=xe.height-St){Ut.bindFramebuffer(Je.FRAMEBUFFER,gn);const Pn=xe.texture,Qt=Pn.format,Zn=Pn.type;if(!fn.textureFormatReadable(Qt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!fn.textureTypeReadable(Zn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const In=Je.createBuffer();Je.bindBuffer(Je.PIXEL_PACK_BUFFER,In),Je.bufferData(Je.PIXEL_PACK_BUFFER,pn.byteLength,Je.STREAM_READ),Je.readPixels(vt,Dt,bt,St,Oe.convert(Qt),Oe.convert(Zn),0);const Wn=se!==null?vn.get(se).__webglFramebuffer:null;Ut.bindFramebuffer(Je.FRAMEBUFFER,Wn);const tr=Je.fenceSync(Je.SYNC_GPU_COMMANDS_COMPLETE,0);return Je.flush(),await dde(Je,tr,4),Je.bindBuffer(Je.PIXEL_PACK_BUFFER,In),Je.getBufferSubData(Je.PIXEL_PACK_BUFFER,0,pn),Je.deleteBuffer(In),Je.deleteSync(tr),pn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(xe,vt=null,Dt=0){const bt=Math.pow(2,-Dt),St=Math.floor(xe.image.width*bt),pn=Math.floor(xe.image.height*bt),An=vt!==null?vt.x:0,gn=vt!==null?vt.y:0;Ue.setTexture2D(xe,0),Je.copyTexSubImage2D(Je.TEXTURE_2D,Dt,0,0,An,gn,St,pn),Ut.unbindTexture()};const Ir=Je.createFramebuffer(),xr=Je.createFramebuffer();this.copyTextureToTexture=function(xe,vt,Dt=null,bt=null,St=0,pn=null){pn===null&&(St!==0?(_b("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),pn=St,St=0):pn=0);let An,gn,Pn,Qt,Zn,In,Wn,tr,Or;const Fr=xe.isCompressedTexture?xe.mipmaps[pn]:xe.image;if(Dt!==null)An=Dt.max.x-Dt.min.x,gn=Dt.max.y-Dt.min.y,Pn=Dt.isBox3?Dt.max.z-Dt.min.z:1,Qt=Dt.min.x,Zn=Dt.min.y,In=Dt.isBox3?Dt.min.z:0;else{const Xi=Math.pow(2,-St);An=Math.floor(Fr.width*Xi),gn=Math.floor(Fr.height*Xi),xe.isDataArrayTexture?Pn=Fr.depth:xe.isData3DTexture?Pn=Math.floor(Fr.depth*Xi):Pn=1,Qt=0,Zn=0,In=0}bt!==null?(Wn=bt.x,tr=bt.y,Or=bt.z):(Wn=0,tr=0,Or=0);const wr=Oe.convert(vt.format),ur=Oe.convert(vt.type);let ui;vt.isData3DTexture?(Ue.setTexture3D(vt,0),ui=Je.TEXTURE_3D):vt.isDataArrayTexture||vt.isCompressedArrayTexture?(Ue.setTexture2DArray(vt,0),ui=Je.TEXTURE_2D_ARRAY):(Ue.setTexture2D(vt,0),ui=Je.TEXTURE_2D),Je.pixelStorei(Je.UNPACK_FLIP_Y_WEBGL,vt.flipY),Je.pixelStorei(Je.UNPACK_PREMULTIPLY_ALPHA_WEBGL,vt.premultiplyAlpha),Je.pixelStorei(Je.UNPACK_ALIGNMENT,vt.unpackAlignment);const kr=Je.getParameter(Je.UNPACK_ROW_LENGTH),Eo=Je.getParameter(Je.UNPACK_IMAGE_HEIGHT),Ys=Je.getParameter(Je.UNPACK_SKIP_PIXELS),Jo=Je.getParameter(Je.UNPACK_SKIP_ROWS),Ra=Je.getParameter(Je.UNPACK_SKIP_IMAGES);Je.pixelStorei(Je.UNPACK_ROW_LENGTH,Fr.width),Je.pixelStorei(Je.UNPACK_IMAGE_HEIGHT,Fr.height),Je.pixelStorei(Je.UNPACK_SKIP_PIXELS,Qt),Je.pixelStorei(Je.UNPACK_SKIP_ROWS,Zn),Je.pixelStorei(Je.UNPACK_SKIP_IMAGES,In);const Zr=xe.isDataArrayTexture||xe.isData3DTexture,uo=vt.isDataArrayTexture||vt.isData3DTexture;if(xe.isDepthTexture){const Xi=vn.get(xe),ho=vn.get(vt),Vi=vn.get(Xi.__renderTarget),Nr=vn.get(ho.__renderTarget);Ut.bindFramebuffer(Je.READ_FRAMEBUFFER,Vi.__webglFramebuffer),Ut.bindFramebuffer(Je.DRAW_FRAMEBUFFER,Nr.__webglFramebuffer);for(let io=0;io<Pn;io++)Zr&&(Je.framebufferTextureLayer(Je.READ_FRAMEBUFFER,Je.COLOR_ATTACHMENT0,vn.get(xe).__webglTexture,St,In+io),Je.framebufferTextureLayer(Je.DRAW_FRAMEBUFFER,Je.COLOR_ATTACHMENT0,vn.get(vt).__webglTexture,pn,Or+io)),Je.blitFramebuffer(Qt,Zn,An,gn,Wn,tr,An,gn,Je.DEPTH_BUFFER_BIT,Je.NEAREST);Ut.bindFramebuffer(Je.READ_FRAMEBUFFER,null),Ut.bindFramebuffer(Je.DRAW_FRAMEBUFFER,null)}else if(St!==0||xe.isRenderTargetTexture||vn.has(xe)){const Xi=vn.get(xe),ho=vn.get(vt);Ut.bindFramebuffer(Je.READ_FRAMEBUFFER,Ir),Ut.bindFramebuffer(Je.DRAW_FRAMEBUFFER,xr);for(let Vi=0;Vi<Pn;Vi++)Zr?Je.framebufferTextureLayer(Je.READ_FRAMEBUFFER,Je.COLOR_ATTACHMENT0,Xi.__webglTexture,St,In+Vi):Je.framebufferTexture2D(Je.READ_FRAMEBUFFER,Je.COLOR_ATTACHMENT0,Je.TEXTURE_2D,Xi.__webglTexture,St),uo?Je.framebufferTextureLayer(Je.DRAW_FRAMEBUFFER,Je.COLOR_ATTACHMENT0,ho.__webglTexture,pn,Or+Vi):Je.framebufferTexture2D(Je.DRAW_FRAMEBUFFER,Je.COLOR_ATTACHMENT0,Je.TEXTURE_2D,ho.__webglTexture,pn),St!==0?Je.blitFramebuffer(Qt,Zn,An,gn,Wn,tr,An,gn,Je.COLOR_BUFFER_BIT,Je.NEAREST):uo?Je.copyTexSubImage3D(ui,pn,Wn,tr,Or+Vi,Qt,Zn,An,gn):Je.copyTexSubImage2D(ui,pn,Wn,tr,Qt,Zn,An,gn);Ut.bindFramebuffer(Je.READ_FRAMEBUFFER,null),Ut.bindFramebuffer(Je.DRAW_FRAMEBUFFER,null)}else uo?xe.isDataTexture||xe.isData3DTexture?Je.texSubImage3D(ui,pn,Wn,tr,Or,An,gn,Pn,wr,ur,Fr.data):vt.isCompressedArrayTexture?Je.compressedTexSubImage3D(ui,pn,Wn,tr,Or,An,gn,Pn,wr,Fr.data):Je.texSubImage3D(ui,pn,Wn,tr,Or,An,gn,Pn,wr,ur,Fr):xe.isDataTexture?Je.texSubImage2D(Je.TEXTURE_2D,pn,Wn,tr,An,gn,wr,ur,Fr.data):xe.isCompressedTexture?Je.compressedTexSubImage2D(Je.TEXTURE_2D,pn,Wn,tr,Fr.width,Fr.height,wr,Fr.data):Je.texSubImage2D(Je.TEXTURE_2D,pn,Wn,tr,An,gn,wr,ur,Fr);Je.pixelStorei(Je.UNPACK_ROW_LENGTH,kr),Je.pixelStorei(Je.UNPACK_IMAGE_HEIGHT,Eo),Je.pixelStorei(Je.UNPACK_SKIP_PIXELS,Ys),Je.pixelStorei(Je.UNPACK_SKIP_ROWS,Jo),Je.pixelStorei(Je.UNPACK_SKIP_IMAGES,Ra),pn===0&&vt.generateMipmaps&&Je.generateMipmap(ui),Ut.unbindTexture()},this.copyTextureToTexture3D=function(xe,vt,Dt=null,bt=null,St=0){return _b('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(xe,vt,Dt,bt,St)},this.initRenderTarget=function(xe){vn.get(xe).__webglFramebuffer===void 0&&Ue.setupRenderTarget(xe)},this.initTexture=function(xe){xe.isCubeTexture?Ue.setTextureCube(xe,0):xe.isData3DTexture?Ue.setTexture3D(xe,0):xe.isDataArrayTexture||xe.isCompressedArrayTexture?Ue.setTexture2DArray(xe,0):Ue.setTexture2D(xe,0),Ut.unbindTexture()},this.resetState=function(){X=0,ee=0,se=null,Ut.reset(),Ke.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return $d}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=li._getDrawingBufferColorSpace(e),n.unpackColorSpace=li._getUnpackColorSpace()}}/*!
 * Photo Sphere Viewer 5.13.4
 * @copyright 2014-2015 Jérémy Heleine
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var Ove=Object.defineProperty,_I=(t,e)=>{for(var n in e)Ove(t,n,{get:e[n],enumerable:!0})},uy={};_I(uy,{ACTIONS:()=>A6,ANIMATION_MIN_DURATION:()=>aP,CAPTURE_EVENTS_CLASS:()=>bx,CTRLZOOM_TIMEOUT:()=>P6,DBLCLICK_DELAY:()=>C6,EASINGS:()=>bb,ICONS:()=>Mu,IDS:()=>Ws,KEY_CODES:()=>As,LONGTOUCH_DELAY:()=>E6,MOVE_THRESHOLD:()=>M6,SPHERE_RADIUS:()=>Ym,TWOFINGERSOVERLAY_DELAY:()=>T6,VIEWER_DATA:()=>fp});var Fve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>
`,Nve='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',Bve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>
`,Uve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,$ve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,Vve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>
`,jve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kunák from the Noun Project--></svg>
`,Hve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,Gve=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,aP=500,M6=4,C6=300,E6=500,T6=100,P6=2e3,Ym=10,fp="photoSphereViewer",bx="psv--capture-event",A6=(t=>(t.ROTATE_UP="ROTATE_UP",t.ROTATE_DOWN="ROTATE_DOWN",t.ROTATE_RIGHT="ROTATE_RIGHT",t.ROTATE_LEFT="ROTATE_LEFT",t.ZOOM_IN="ZOOM_IN",t.ZOOM_OUT="ZOOM_OUT",t))(A6||{}),Ws={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},As={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},Mu={arrow:Fve,close:Nve,download:Bve,fullscreenIn:Uve,fullscreenOut:$ve,info:Vve,menu:jve,zoomIn:Hve,zoomOut:Gve},bb={linear:t=>t,inQuad:t=>t*t,outQuad:t=>t*(2-t),inOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,inCubic:t=>t*t*t,outCubic:t=>--t*t*t+1,inOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,inQuart:t=>t*t*t*t,outQuart:t=>1- --t*t*t*t,inOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,inQuint:t=>t*t*t*t*t,outQuint:t=>1+--t*t*t*t*t,inOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,inSine:t=>1-Math.cos(t*(Math.PI/2)),outSine:t=>Math.sin(t*(Math.PI/2)),inOutSine:t=>.5-.5*Math.cos(Math.PI*t),inExpo:t=>Math.pow(2,10*(t-1)),outExpo:t=>1-Math.pow(2,-10*t),inOutExpo:t=>(t=t*2-1)<0?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t),inCirc:t=>1-Math.sqrt(1-t*t),outCirc:t=>Math.sqrt(1-(t-1)*(t-1)),inOutCirc:t=>(t*=2)<1?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)},Qn={};_I(Qn,{Animation:()=>cw,Dynamic:()=>N0,MultiDynamic:()=>J6,PressHandler:()=>bS,Slider:()=>eU,SliderDirection:()=>Q6,addClasses:()=>xI,angle:()=>R6,applyEulerInverse:()=>dP,checkClosedShadowDom:()=>Y6,checkStylesheet:()=>Z6,checkVersion:()=>CI,cleanCssPosition:()=>q6,clone:()=>yS,createTexture:()=>hP,cssPositionIsOrdered:()=>MI,dasherize:()=>Yve,deepEqual:()=>H6,deepmerge:()=>V6,distance:()=>I6,exitFullscreen:()=>U6,firstNonNull:()=>Hf,getAbortError:()=>cP,getAngle:()=>k6,getClosest:()=>z6,getConfigParser:()=>xS,getElement:()=>D6,getEventTarget:()=>ow,getMatchingTarget:()=>O6,getPosition:()=>F6,getShortestArc:()=>L6,getStyleProperty:()=>Sh,getTouchData:()=>lP,getXMPValue:()=>kl,greatArcDistance:()=>qve,hasParent:()=>Zve,invertResolvableBoolean:()=>_S,isAbortError:()=>W6,isEmpty:()=>j6,isExtendedPosition:()=>SI,isFullscreenEnabled:()=>N6,isNil:()=>Is,isPlainObject:()=>bI,logWarn:()=>qs,mergePanoData:()=>K6,parseAngle:()=>gh,parsePoint:()=>Kve,parseSpeed:()=>X6,removeClasses:()=>Xve,requestFullscreen:()=>B6,resolveBoolean:()=>wI,speedToDuration:()=>uP,sum:()=>Wve,throttle:()=>$6,toggleClass:()=>vS,wrap:()=>e_});function e_(t,e){let n=t%e;return n<0&&(n+=e),n}function Wve(t){return t.reduce((e,n)=>e+n,0)}function I6(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function R6(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function L6(t,e){return[0,Math.PI*2,-Math.PI*2].reduce((r,i)=>{const l=e-t+i;return Math.abs(l)<Math.abs(r)?l:r},1/0)}function k6(t,e){return Math.acos(Math.cos(t.pitch)*Math.cos(e.pitch)*Math.cos(t.yaw-e.yaw)+Math.sin(t.pitch)*Math.sin(e.pitch))}function qve([t,e],[n,r]){t-n>Math.PI?t-=2*Math.PI:t-n<-Math.PI&&(t+=2*Math.PI);const i=(n-t)*Math.cos((e+r)/2),l=r-e;return Math.sqrt(i*i+l*l)}function D6(t){return typeof t=="string"?t.match(/^[a-z]/i)?document.getElementById(t):document.querySelector(t):t}function vS(t,e,n){n===void 0?t.classList.toggle(e):n?t.classList.add(e):n||t.classList.remove(e)}function xI(t,e){t.classList.add(...e.split(" ").filter(n=>!!n))}function Xve(t,e){t.classList.remove(...e.split(" ").filter(n=>!!n))}function Zve(t,e){let n=t;do{if(n===e)return!0;n=n.parentElement}while(n);return!1}function z6(t,e){if(!t?.matches)return null;let n=t;do{if(n.matches(e))return n;n=n.parentElement}while(n);return null}function ow(t){return t?.composedPath()[0]||null}function O6(t,e){return t?t.composedPath().find(n=>!(n instanceof HTMLElement)&&!(n instanceof SVGElement)?!1:n.matches(e)):null}function F6(t){let e=0,n=0,r=t;for(;r;)e+=r.offsetLeft-r.scrollLeft+r.clientLeft,n+=r.offsetTop-r.scrollTop+r.clientTop,r=r.offsetParent;return e-=window.scrollX,n-=window.scrollY,{x:e,y:n}}function Sh(t,e){return window.getComputedStyle(t).getPropertyValue(e)}function lP(t){if(t.touches.length<2)return null;const e={x:t.touches[0].clientX,y:t.touches[0].clientY},n={x:t.touches[1].clientX,y:t.touches[1].clientY};return{distance:I6(e,n),angle:R6(e,n),center:{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}}var sw;function N6(t,e=!1){return e?t===sw:document.fullscreenElement===t}function B6(t,e=!1){e?(sw=t,t.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):t.requestFullscreen()}function U6(t=!1){t?(sw.classList.remove("psv-fullscreen-emulation"),sw=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function Yve(t){return t.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(e,n)=>(n>0?"-":"")+e.toLowerCase())}function $6(t,e){let n=!1;return function(...r){n||(n=!0,setTimeout(()=>{t.apply(this,r),n=!1},e))}}function bI(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function V6(t,e){const n=e;return function r(i,l){return Array.isArray(l)?(!i||!Array.isArray(i)?i=[]:i.length=0,l.forEach((c,s)=>{i[s]=r(null,c)})):typeof l=="object"?((!i||Array.isArray(i))&&(i={}),Object.keys(l).forEach(c=>{c!=="__proto__"&&(typeof l[c]!="object"||!l[c]||!bI(l[c])?i[c]=l[c]:l[c]!==n&&(i[c]?r(i[c],l[c]):i[c]=r(null,l[c])))})):i=l,i}(t,e)}function yS(t){return V6(null,t)}function j6(t){return!t||Object.keys(t).length===0&&t.constructor===Object}function Is(t){return t==null}function Hf(...t){for(const e of t)if(!Is(e))return e;return null}function H6(t,e){if(t===e)return!0;if(Kz(t)&&Kz(e)){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n of Object.keys(t))if(!H6(t[n],e[n]))return!1;return!0}else return!1}function Kz(t){return typeof t=="object"&&t!==null}var jn=class G6 extends Error{constructor(e,n){super(n&&n instanceof Error?`${e}: ${n.message}`:e),this.name="PSVError",Error.captureStackTrace?.(this,G6)}};function wI(t,e){bI(t)?(e(t.initial,!0),t.promise.then(n=>e(n,!1))):e(t,!0)}function _S(t){return{initial:!t.initial,promise:t.promise.then(e=>!e)}}function cP(){const t=new Error("Loading was aborted.");return t.name="AbortError",t}function W6(t){return t?.name==="AbortError"}function qs(t){console.warn(`PhotoSphereViewer: ${t}`)}function SI(t){return!t||Array.isArray(t)?!1:[["textureX","textureY"],["yaw","pitch"]].some(([e,n])=>t[e]!==void 0&&t[n]!==void 0)}function kl(t,e,n=!0){let r=t.match("<GPano:"+e+">(.*)</GPano:"+e+">");if(r!==null){const i=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(i)?null:i}if(r=t.match("GPano:"+e+'="(.*?)"'),r!==null){const i=n?parseInt(r[1],10):parseFloat(r[1]);return isNaN(i)?null:i}return null}var Jz={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},aw=["left","center","right"],lw=["top","center","bottom"],Qz=[...aw,...lw],Sc="center";function Kve(t){if(!t)return{x:.5,y:.5};if(typeof t=="object")return t;let e=t.toLocaleLowerCase().split(" ").slice(0,2);e.length===1&&(Jz[e[0]]?e=[e[0],Sc]:e=[e[0],e[0]]);const n=e[1]!=="left"&&e[1]!=="right"&&e[0]!=="top"&&e[0]!=="bottom";e=e.map(i=>Jz[i]||i),n||e.reverse();const r=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return r?{x:parseFloat(r[1])/100,y:parseFloat(r[2])/100}:{x:.5,y:.5}}function q6(t,{allowCenter:e,cssOrder:n}={allowCenter:!0,cssOrder:!0}){return t?(typeof t=="string"&&(t=t.split(" ")),t.length===1&&(t[0]===Sc?t=[Sc,Sc]:aw.indexOf(t[0])!==-1?t=[Sc,t[0]]:lw.indexOf(t[0])!==-1&&(t=[t[0],Sc])),t.length!==2||Qz.indexOf(t[0])===-1||Qz.indexOf(t[1])===-1?(qs(`Unparsable position ${t}`),null):!e&&t[0]===Sc&&t[1]===Sc?(qs("Invalid position center center"),null):(n&&!MI(t)&&(t=[t[1],t[0]]),t[1]===Sc&&aw.indexOf(t[0])!==-1&&(t=[Sc,t[0]]),t[0]===Sc&&lw.indexOf(t[1])!==-1&&(t=[t[1],Sc]),t)):null}function MI(t){return lw.indexOf(t[0])!==-1&&aw.indexOf(t[1])!==-1}function X6(t){let e;if(typeof t=="string"){const n=t.toString().trim();let r=parseFloat(n.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const i=n.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(i.match(/(pm|per minute)$/)&&(r/=60),i){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=Wr.degToRad(r);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":e=r;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=r*Math.PI*2;break;default:throw new jn(`Unknown speed unit "${i}"`)}}else e=t;return e}function uP(t,e){if(typeof t!="number"){const n=X6(t);return e/Math.abs(n)*1e3}else return Math.abs(t)}function gh(t,e=!1,n=e){let r;if(typeof t=="string"){const i=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!i)throw new jn(`Unknown angle "${t}"`);const l=parseFloat(i[1]),c=i[2];if(c)switch(c){case"deg":case"degs":r=Wr.degToRad(l);break;case"rad":case"rads":r=l;break;default:throw new jn(`Unknown angle unit "${c}"`)}else r=l}else if(typeof t=="number"&&!isNaN(t))r=t;else throw new jn(`Unknown angle "${t}"`);return r=e_(e?r+Math.PI:r,Math.PI*2),e?Wr.clamp(r-Math.PI,-Math.PI/(n?2:1),Math.PI/(n?2:1)):r}function hP(t,e=!1){const n=new Xs(t);return n.needsUpdate=!0,n.minFilter=e?Yf:Vl,n.generateMipmaps=e,n.anisotropy=e?2:1,n}var eO=new Sp;function dP(t,e){eO.setFromEuler(e).invert(),t.applyQuaternion(eO)}function xS(t,e){const n=function(r){const i=yS({...t,...r}),l={};for(let[c,s]of Object.entries(i)){if(e&&c in e)s=e[c](s,{rawConfig:i,defValue:t[c]});else if(!(c in t)){qs(`Unknown option ${c}`);continue}l[c]=s}return l};return n.defaults=t,n.parsers=e||{},n}function Z6(t,e){Sh(t,`--psv-${e}-loaded`)!=="true"&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${e}/index.css" is not loaded`)}function CI(t,e,n){e&&e!==n&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${t} is in version ${e} but @photo-sphere-viewer/core is in version ${n}`)}function Y6(t){do{if(t instanceof ShadowRoot&&t.mode==="closed"){console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");return}t=t.parentNode}while(t)}function K6(t,e,n,r){const i={isEquirectangular:!0,fullWidth:Hf(n?.fullWidth,r?.fullWidth),fullHeight:Hf(n?.fullHeight,r?.fullHeight),croppedWidth:t,croppedHeight:e,croppedX:Hf(n?.croppedX,r?.croppedX),croppedY:Hf(n?.croppedY,r?.croppedY),poseHeading:Hf(n?.poseHeading,r?.poseHeading,0),posePitch:Hf(n?.posePitch,r?.posePitch,0),poseRoll:Hf(n?.poseRoll,r?.poseRoll,0),initialHeading:r?.initialHeading,initialPitch:r?.initialPitch,initialFov:r?.initialFov};return!i.fullWidth&&!i.fullHeight&&(i.fullWidth=Math.max(t,e*2),i.fullHeight=Math.round(i.fullWidth/2)),i.fullWidth||(i.fullWidth=i.fullHeight*2),i.fullHeight||(i.fullHeight=Math.round(i.fullWidth/2)),i.croppedX===null&&(i.croppedX=Math.round((i.fullWidth-t)/2)),i.croppedY===null&&(i.croppedY=Math.round((i.fullHeight-e)/2)),Math.abs(i.fullWidth-i.fullHeight*2)>1&&(qs("Invalid panoData, fullWidth should be twice fullHeight"),i.fullHeight=Math.round(i.fullWidth/2)),i.croppedX+i.croppedWidth>i.fullWidth&&(qs("Invalid panoData, croppedX + croppedWidth > fullWidth"),i.croppedX=i.fullWidth-i.croppedWidth),i.croppedY+i.croppedHeight>i.fullHeight&&(qs("Invalid panoData, croppedY + croppedHeight > fullHeight"),i.croppedY=i.fullHeight-i.croppedHeight),i.croppedX<0&&(qs("Invalid panoData, croppedX < 0"),i.croppedX=0),i.croppedY<0&&(qs("Invalid panoData, croppedY < 0"),i.croppedY=0),i}var cw=class{constructor(t){this.easing=bb.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=t,t?(t.easing&&(this.easing=typeof t.easing=="function"?t.easing:bb[t.easing]||bb.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(e=>this.__run(e))},t.delay||0)):this.resolved=!0}__run(t){if(this.cancelled)return;this.start||(this.start=t);const e=(t-this.start)/this.options.duration,n={};if(e<1){for(const[r,i]of Object.entries(this.options.properties))if(i){const l=i.start+(i.end-i.start)*this.easing(e);n[r]=l}this.options.onTick(n,e),this.animationFrame=window.requestAnimationFrame(r=>this.__run(r))}else{for(const[r,i]of Object.entries(this.options.properties))i&&(n[r]=i.end);this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(t){t?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(e=>e(t)),this.callbacks.length=0}then(t){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(t):new Promise(e=>{this.callbacks.push(e)}).then(t)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},N0=class{constructor(t,e){if(this.fn=t,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=e.min,this.max=e.max,this.wrap=e.wrap,this.current=e.defaultValue,this.wrap&&this.min!==0)throw new jn("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(t){this.__current=t}setSpeed(t){this.speed=t}goto(t,e=1){this.mode=2,this.target=this.wrap?e_(t,this.max):Wr.clamp(t,this.min,this.max),this.speedMult=e}step(t,e=1){e===0?this.setValue(this.current+t):(this.mode!==2&&(this.target=this.current),this.goto(this.target+t,e))}roll(t=!1,e=1){this.mode=1,this.target=t?-1/0:1/0,this.speedMult=e}stop(){this.mode=0}setValue(t){return this.target=this.wrap?e_(t,this.max):Wr.clamp(t,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current?(this.current=this.target,this.fn&&this.fn(this.current),!0):!1}update(t){if(this.mode===2){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const r=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=r&&(this.mode=0)}let e=this.mode===0?0:this.speed*this.speedMult;this.target<this.current&&(e=-e),this.currentSpeed<e?this.currentSpeed=Math.min(e,this.currentSpeed+t/1e3*this.speed*this.speedMult*2):this.currentSpeed>e&&(this.currentSpeed=Math.max(e,this.currentSpeed-t/1e3*this.speed*this.speedMult*2));let n=null;return this.current>this.target&&this.currentSpeed?n=Math.max(this.target,this.current+this.currentSpeed*t/1e3):this.current<this.target&&this.currentSpeed&&(n=Math.min(this.target,this.current+this.currentSpeed*t/1e3)),n!==null&&(n=this.wrap?e_(n,this.max):Wr.clamp(n,this.min,this.max),n!==this.current)?(this.current=n,this.fn&&this.fn(this.current),!0):!1}},J6=class{constructor(t,e){this.fn=t,this.dynamics=e,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((t,[e,n])=>(t[e]=n.current,t),{})}setSpeed(t){for(const e of Object.values(this.dynamics))e.setSpeed(t)}goto(t,e=1){for(const[n,r]of Object.entries(t))this.dynamics[n].goto(r,e)}step(t,e=1){if(e===0)this.setValue(Object.keys(t).reduce((n,r)=>(n[r]=t[r]+this.dynamics[r].current,n),{}));else for(const[n,r]of Object.entries(t))this.dynamics[n].step(r,e)}roll(t,e=1){for(const[n,r]of Object.entries(t))this.dynamics[n].roll(r,e)}stop(){for(const t of Object.values(this.dynamics))t.stop()}setValue(t){let e=!1;for(const[n,r]of Object.entries(t))e=this.dynamics[n].setValue(r)||e;return e&&this.fn&&this.fn(this.current),e}update(t){let e=!1;for(const n of Object.values(this.dynamics))e=n.update(t)||e;return e&&this.fn&&this.fn(this.current),e}},bS=class{constructor(t=200){this.delay=t,this.time=0,this.delay=t}get pending(){return this.time!==0}down(t){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime(),this.data=t}up(t){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{t(this.data),this.timeout=void 0,this.time=0,this.data=void 0},this.delay):(t(this.data),this.time=0,this.data=void 0)}},Q6=(t=>(t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t))(Q6||{}),eU=class{constructor(t,e,n){this.container=t,this.direction=e,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return this.direction==="VERTICAL"}get isHorizontal(){return this.direction==="HORIZONTAL"}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(t){switch(t.type){case"click":t.stopPropagation();break;case"mousedown":this.__onMouseDown(t);break;case"mouseenter":this.__onMouseEnter(t);break;case"mouseleave":this.__onMouseLeave(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break}}__onMouseDown(t){this.mousedown=!0,this.__update(t.clientX,t.clientY,!0)}__onMouseEnter(t){this.mouseover=!0,this.__update(t.clientX,t.clientY,!0)}__onTouchStart(t){this.mouseover=!0,this.mousedown=!0;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}__onMouseMove(t){(this.mousedown||this.mouseover)&&(t.stopPropagation(),this.__update(t.clientX,t.clientY,!0))}__onTouchMove(t){if(this.mousedown||this.mouseover){t.stopPropagation();const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}}__onMouseUp(t){this.mousedown&&(this.mousedown=!1,this.__update(t.clientX,t.clientY,!1))}__onMouseLeave(t){this.mouseover&&(this.mouseover=!1,this.__update(t.clientX,t.clientY,!0))}__onTouchEnd(t){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!1)}}__update(t,e,n){const r=this.container.getBoundingClientRect();let i;this.isVertical?i=Wr.clamp((r.bottom-e)/r.height,0,1):i=Wr.clamp((t-r.left)/r.width,0,1),this.listener({value:i,click:!n,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:t,clientY:e}})}},nr={};_I(nr,{BeforeAnimateEvent:()=>EI,BeforeRenderEvent:()=>t_,BeforeRotateEvent:()=>lU,ClickEvent:()=>hU,ConfigChangedEvent:()=>nl,DoubleClickEvent:()=>gU,FullscreenEvent:()=>n_,HideNotificationEvent:()=>r_,HideOverlayEvent:()=>SU,HidePanelEvent:()=>tp,HideTooltipEvent:()=>PU,KeypressEvent:()=>np,LoadProgressEvent:()=>kU,ObjectEnterEvent:()=>y$,ObjectEvent:()=>wS,ObjectHoverEvent:()=>S$,ObjectLeaveEvent:()=>fP,PanoramaErrorEvent:()=>$U,PanoramaLoadEvent:()=>OU,PanoramaLoadedEvent:()=>qv,PositionUpdatedEvent:()=>i_,ReadyEvent:()=>s_,RenderEvent:()=>QU,RollUpdatedEvent:()=>o_,ShowNotificationEvent:()=>a_,ShowOverlayEvent:()=>i$,ShowPanelEvent:()=>rp,ShowTooltipEvent:()=>c$,SizeUpdatedEvent:()=>l_,StopAllEvent:()=>c_,TransitionDoneEvent:()=>HU,ViewerEvent:()=>wi,ZoomUpdatedEvent:()=>jd});var wx=class extends Event{constructor(t,e=!1){super(t,{cancelable:e})}},tU=class extends EventTarget{dispatchEvent(t){return super.dispatchEvent(t)}addEventListener(t,e,n){super.addEventListener(t,e,n)}removeEventListener(t,e,n){super.removeEventListener(t,e,n)}},wi=class extends wx{},nU=class rU extends wi{constructor(e,n){super(rU.type,!0),this.position=e,this.zoomLevel=n}};nU.type="before-animate";var EI=nU,iU=class oU extends wi{constructor(e,n){super(oU.type),this.timestamp=e,this.elapsed=n}};iU.type="before-render";var t_=iU,sU=class aU extends wi{constructor(e){super(aU.type,!0),this.position=e}};sU.type="before-rotate";var lU=sU,cU=class uU extends wi{constructor(e){super(uU.type),this.data=e}};cU.type="click";var hU=cU,dU=class fU extends wi{constructor(e){super(fU.type),this.options=e}containsOptions(...e){return e.some(n=>this.options.includes(n))}};dU.type="config-changed";var nl=dU,pU=class mU extends wi{constructor(e){super(mU.type),this.data=e}};pU.type="dblclick";var gU=pU,vU=class yU extends wi{constructor(e){super(yU.type),this.fullscreenEnabled=e}};vU.type="fullscreen";var n_=vU,_U=class xU extends wi{constructor(e){super(xU.type),this.notificationId=e}};_U.type="hide-notification";var r_=_U,bU=class wU extends wi{constructor(e){super(wU.type),this.overlayId=e}};bU.type="hide-overlay";var SU=bU,MU=class CU extends wi{constructor(e){super(CU.type),this.panelId=e}};MU.type="hide-panel";var tp=MU,EU=class TU extends wi{constructor(e){super(TU.type),this.tooltipData=e}};EU.type="hide-tooltip";var PU=EU,AU=class IU extends wi{constructor(e,n){super(IU.type,!0),this.key=e,this.originalEvent=n}};AU.type="key-press";var np=AU,RU=class LU extends wi{constructor(e){super(LU.type),this.progress=e}};RU.type="load-progress";var kU=RU,DU=class zU extends wi{constructor(e){super(zU.type),this.panorama=e}};DU.type="panorama-load";var OU=DU,FU=class NU extends wi{constructor(e){super(NU.type),this.data=e}};FU.type="panorama-loaded";var qv=FU,BU=class UU extends wi{constructor(e,n){super(UU.type),this.panorama=e,this.error=n}};BU.type="panorama-error";var $U=BU,VU=class jU extends wi{constructor(e){super(jU.type),this.completed=e}};VU.type="transition-done";var HU=VU,GU=class WU extends wi{constructor(e){super(WU.type),this.position=e}};GU.type="position-updated";var i_=GU,qU=class XU extends wi{constructor(e){super(XU.type),this.roll=e}};qU.type="roll-updated";var o_=qU,ZU=class YU extends wi{constructor(){super(YU.type)}};ZU.type="ready";var s_=ZU,KU=class JU extends wi{constructor(){super(JU.type)}};KU.type="render";var QU=KU,e$=class t$ extends wi{constructor(e){super(t$.type),this.notificationId=e}};e$.type="show-notification";var a_=e$,n$=class r$ extends wi{constructor(e){super(r$.type),this.overlayId=e}};n$.type="show-overlay";var i$=n$,o$=class s$ extends wi{constructor(e){super(s$.type),this.panelId=e}};o$.type="show-panel";var rp=o$,a$=class l$ extends wi{constructor(e,n){super(l$.type),this.tooltip=e,this.tooltipData=n}};a$.type="show-tooltip";var c$=a$,u$=class h$ extends wi{constructor(e){super(h$.type),this.size=e}};u$.type="size-updated";var l_=u$,d$=class f$ extends wi{constructor(){super(f$.type)}};d$.type="stop-all";var c_=d$,p$=class m$ extends wi{constructor(e){super(m$.type),this.zoomLevel=e}};p$.type="zoom-updated";var jd=p$,wS=class extends wi{constructor(t,e,n,r,i){super(t),this.originalEvent=e,this.object=n,this.viewerPoint=r,this.userDataKey=i}},g$=class v$ extends wS{constructor(e,n,r,i){super(v$.type,e,n,r,i)}};g$.type="enter-object";var y$=g$,_$=class x$ extends wS{constructor(e,n,r,i){super(x$.type,e,n,r,i)}};_$.type="leave-object";var fP=_$,b$=class w$ extends wS{constructor(e,n,r,i){super(w$.type,e,n,r,i)}};b$.type="hover-object";var S$=b$,SS=class{constructor(t){this.viewer=t}init(){}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}textureCoordsToSphericalCoords(t,e){throw new jn("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(t,e){throw new jn("Current adapter does not support texture coordinates.")}};SS.supportsDownload=!1;function tO(t){if(t){for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof SS)return CI(e.id,e.VERSION,"5.13.4"),e}return null}var S0=`${fp}_touchSupport`,Ta={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return this.__maxCanvasWidth===null&&(this.__maxCanvasWidth=eye(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const t=Jve();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!t,this.maxTextureWidth=t?t.getParameter(t.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=Qve(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!Ta.isWebGLSupported)throw new jn("WebGL 2 is not supported.");if(Ta.maxTextureWidth===0)throw new jn("Unable to detect system capabilities")}};function Jve(){try{return document.createElement("canvas").getContext("webgl2")}catch{return null}}function Qve(){let t="ontouchstart"in window||navigator.maxTouchPoints>0;S0 in localStorage&&(t=localStorage[S0]==="true");const e=new Promise(n=>{const r=()=>{window.removeEventListener("mousedown",i),window.removeEventListener("touchstart",l),clearTimeout(s)},i=()=>{r(),localStorage[S0]=!1,n(!1)},l=()=>{r(),localStorage[S0]=!0,n(!0)},c=()=>{r(),localStorage[S0]=t,n(t)};window.addEventListener("mousedown",i,!1),window.addEventListener("touchstart",l,!1);const s=setTimeout(c,1e4)});return{initial:t,promise:e}}function eye(t){let e=t,n=!1;const r=document.createElement("canvas"),i=r.getContext("2d");for(r.width=1,r.height=1;e>1024&&!n;){const l=document.createElement("canvas"),c=l.getContext("2d");l.width=e,l.height=e/2;try{c.fillStyle="white",c.fillRect(e-1,e/2-1,1,1),i.drawImage(l,e-1,e/2-1,1,1,0,0,1,1),i.getImageData(0,0,1,1).data[0]>0&&(n=!0)}catch{}l.width=0,l.height=0,n||(e/=2)}if(n)return e;throw new jn("Unable to detect system capabilities")}var tye=xS({resolution:64,useXmpData:!0,blur:!1},{resolution:t=>{if(!t||!Wr.isPowerOfTwo(t))throw new jn("EquirectangularAdapter resolution must be power of two.");return t}}),MS=class M$ extends SS{static withConfig(e){return[M$,e]}constructor(e,n){super(e),this.config=tye(n),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(e,n){if(Is(e.textureX)||Is(e.textureY))throw new jn("Texture position is missing 'textureX' or 'textureY'");const r=(e.textureX+n.croppedX)/n.fullWidth*Math.PI*2,i=(e.textureY+n.croppedY)/n.fullHeight*Math.PI;return{yaw:r>=Math.PI?r-Math.PI:r+Math.PI,pitch:Math.PI/2-i}}sphericalCoordsToTextureCoords(e,n){const r=e.yaw/Math.PI/2*n.fullWidth,i=e.pitch/Math.PI*n.fullHeight;let l=Math.round(e.yaw<Math.PI?r+n.fullWidth/2:r-n.fullWidth/2)-n.croppedX,c=Math.round(n.fullHeight/2-i)-n.croppedY;return(l<0||l>n.croppedWidth||c<0||c>n.croppedHeight)&&(l=c=void 0),{textureX:l,textureY:c}}async loadTexture(e,n=!0,r,i=this.config.useXmpData){if(typeof e!="string"&&(typeof e!="object"||!e.path))return Promise.reject(new jn("Invalid panorama url, are you using the right adapter?"));let l;typeof e=="string"?l={path:e,data:r}:l={data:r,...e};const c=await this.viewer.textureLoader.loadFile(l.path,n?w=>this.viewer.textureLoader.dispatchProgress(w):null,l.path),s=i?await this.loadXMP(c):null,p=await this.viewer.textureLoader.blobToImage(c);typeof l.data=="function"&&(l.data=l.data(p,s));const y=K6(p.width,p.height,l.data,s),_=this.createEquirectangularTexture(p);return{panorama:e,texture:_,panoData:y,cacheKey:l.path}}async loadXMP(e){const n=await this.loadBlobAsString(e),r=n.indexOf("<x:xmpmeta");if(r===-1)return null;const i=n.indexOf("</x:xmpmeta>",r);if(i===-1)return null;const l=n.substring(r,i);return l.includes("GPano:")?{fullWidth:kl(l,"FullPanoWidthPixels"),fullHeight:kl(l,"FullPanoHeightPixels"),croppedWidth:kl(l,"CroppedAreaImageWidthPixels"),croppedHeight:kl(l,"CroppedAreaImageHeightPixels"),croppedX:kl(l,"CroppedAreaLeftPixels"),croppedY:kl(l,"CroppedAreaTopPixels"),poseHeading:kl(l,"PoseHeadingDegrees",!1),posePitch:kl(l,"PosePitchDegrees",!1),poseRoll:kl(l,"PoseRollDegrees",!1),initialHeading:kl(l,"InitialViewHeadingDegrees",!1),initialPitch:kl(l,"InitialViewPitchDegrees",!1),initialFov:kl(l,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(e){return new Promise((n,r)=>{const i=new FileReader;i.onload=()=>n(i.result),i.onerror=r,i.readAsText(e)})}createEquirectangularTexture(e){if(this.config.blur||e.width>Ta.maxTextureWidth){const n=Math.min(1,Ta.maxCanvasWidth/e.width),r=new OffscreenCanvas(Math.floor(e.width*n),Math.floor(e.height*n)),i=r.getContext("2d");return this.config.blur&&(i.filter=`blur(${r.width/2048}px)`),i.drawImage(e,0,0,r.width,r.height),hP(r)}return hP(e)}createMesh(e){const n=e.croppedX/e.fullWidth*2*Math.PI,r=e.croppedWidth/e.fullWidth*2*Math.PI,i=e.croppedY/e.fullHeight*Math.PI,l=e.croppedHeight/e.fullHeight*Math.PI,c=new xy(Ym,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*r),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*l),-Math.PI/2+n,r,i,l).scale(-1,1,1),s=new dp({depthTest:!1,depthWrite:!1});return new Ja(c,s)}setTexture(e,n){e.material.map=n.texture}setTextureOpacity(e,n){e.material.opacity=n,e.material.transparent=n<1}disposeTexture({texture:e}){e.dispose()}disposeMesh(e){e.geometry.dispose(),e.material.dispose()}};MS.id="equirectangular";MS.VERSION="5.13.4";MS.supportsDownload=!0;var TI=MS,C$=class E$ extends TI{static withConfig(e){return[E$,e]}constructor(e,n){super(e,{resolution:n?.resolution??64,useXmpData:!1})}async loadTexture(e,n){const r=await super.loadTexture(e,n,null,!1);return r.panoData=null,r}createMesh(){const e=new xy(Ym,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),n=e.getAttribute("uv"),r=e.getAttribute("normal");for(let l=0;l<n.count;l++)for(let c=0;c<3;c++){const s=l*3+c,p=r.getX(s),y=r.getY(s),_=r.getZ(s),w=.947;if(l<n.count/6){const S=p===0&&_===0?1:Math.acos(y)/Math.sqrt(p*p+_*_)*(2/Math.PI);n.setXY(s,p*(w/4)*S+1/4,_*(w/2)*S+1/2)}else{const S=p===0&&_===0?1:Math.acos(-y)/Math.sqrt(p*p+_*_)*(2/Math.PI);n.setXY(s,-p*(w/4)*S+3/4,_*(w/2)*S+1/2)}}e.rotateX(-Math.PI/2),e.rotateY(Math.PI);const i=new dp({depthTest:!1,depthWrite:!1});return new Ja(e,i)}};C$.id="dual-fisheye";C$.VERSION="5.13.4";var Mp=class T${constructor(e,n){this.parent=e,this.children=[],this.state={visible:!0},this.viewer=e instanceof T$?e.viewer:e,this.container=document.createElement(n.tagName??"div"),this.container.className=n.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const e=this.parent.children.indexOf(this);e!==-1&&this.parent.children.splice(e,1),this.children.slice().forEach(n=>n.destroy()),this.children.length=0}toggle(e=!this.isVisible()){e?this.show():this.hide()}hide(e){this.container.style.display="none",this.state.visible=!1}show(e){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},nye=xS({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),Aa=class extends Mp{constructor(t,e){super(t,{tagName:e.tagName,className:`psv-button ${e.hoverScale?"psv-button--hover-scale":""} ${e.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=nye(e),e.id||(this.config.id=this.constructor.id),e.icon&&this.__setIcon(e.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.viewer.config.lang[this.config.title]??this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),e.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",n=>{this.state.enabled&&this.onClick(),n.stopPropagation()}),this.container.addEventListener("keydown",n=>{n.key===As.Enter&&this.state.enabled&&(this.onClick(),n.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(t=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),t&&this.viewer.navbar.autoSize())}hide(t=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",t&&this.viewer.navbar.autoSize())}checkSupported(){wI(this.isSupported(),(t,e)=>{this.state&&(this.state.supported=t,e?t||this.hide():this.toggle(t))})}autoSize(){}isSupported(){return!0}toggleActive(t=!this.state.active){t!==this.state.active&&(this.state.active=t,vS(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(t){this.container.innerHTML=t,xI(this.container.querySelector("svg"),"psv-button-svg")}},rye=class extends Aa{constructor(t,e){super(t,{id:e.id??`psvButton-${Math.random().toString(36).substring(2)}`,className:`psv-custom-button ${e.className||""}`,hoverScale:!1,collapsable:e.collapsable!==!1,tabbable:e.tabbable!==!1,title:e.title}),this.customOnClick=e.onClick,e.content&&(typeof e.content=="string"?this.container.innerHTML=e.content:(this.container.classList.add("psv-custom-button--no-padding"),e.content.style.height="100%",e.content.attachViewer?.(this.viewer),this.container.appendChild(e.content))),this.state.width=this.container.offsetWidth,e.disabled&&this.disable(),e.visible===!1&&this.hide()}onClick(){this.customOnClick?.(this.viewer)}},D_=class extends Aa{constructor(t){super(t,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Mu.info}),this.mode=0,this.viewer.addEventListener(r_.type,this),this.viewer.addEventListener(a_.type,this),this.viewer.addEventListener(tp.type,this),this.viewer.addEventListener(rp.type,this),this.viewer.addEventListener(nl.type,this)}destroy(){this.viewer.removeEventListener(r_.type,this),this.viewer.removeEventListener(a_.type,this),this.viewer.removeEventListener(tp.type,this),this.viewer.removeEventListener(rp.type,this),this.viewer.removeEventListener(nl.type,this),super.destroy()}handleEvent(t){if(t instanceof nl){t.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let e=!1;t instanceof r_?e=this.mode===1:t instanceof a_?e=this.mode===1&&t.notificationId!==Ws.DESCRIPTION:t instanceof tp?e=this.mode===2:t instanceof rp&&(e=this.mode===2&&t.panelId!==Ws.DESCRIPTION),e&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(t){super.hide(t),this.mode&&this.__close()}autoSize(t=!1){if(t){const e=this.viewer.navbar.getButton("caption",!1),n=e&&!e.isVisible(),r=!!this.viewer.config.description;n||r?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(Ws.DESCRIPTION);break;case 2:this.viewer.panel.hide(Ws.DESCRIPTION);break}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:Ws.DESCRIPTION,content:`${this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:""}${this.viewer.config.description}`})):(this.mode=1,this.viewer.notification.show({id:Ws.DESCRIPTION,content:this.viewer.config.caption}))}};D_.id="description";var P$=class extends Aa{constructor(t){super(t,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:Mu.download}),this.viewer.addEventListener(nl.type,this),this.viewer.addEventListener(qv.type,this)}destroy(){this.viewer.removeEventListener(nl.type,this),this.viewer.removeEventListener(qv.type,this),super.destroy()}handleEvent(t){t instanceof nl?(t.containsOptions("downloadUrl")&&this.checkSupported(),t.containsOptions("downloadUrl","downloadName")&&this.__update()):t instanceof qv&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){const t=this.container;t.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,t.target="_blank",t.href.startsWith("data:")&&!this.viewer.config.downloadName?t.download="panorama."+t.href.substring(0,t.href.indexOf(";")).split("/").pop():t.download=this.viewer.config.downloadName||t.href.split("/").pop()}};P$.id="download";var A$=class extends Aa{constructor(t){super(t,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Mu.fullscreenIn,iconActive:Mu.fullscreenOut}),this.viewer.addEventListener(n_.type,this)}destroy(){this.viewer.removeEventListener(n_.type,this),super.destroy()}handleEvent(t){t instanceof n_&&this.toggleActive(t.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};A$.id="fullscreen";var iye="psvButton",oye=(t,e)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${Mu.menu} ${e}</h1>
  <ul class="psv-panel-menu-list">
    ${t.map(n=>`
    <li data-psv-button="${n.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${n.content}</span>
      <span class="psv-panel-menu-item-label">${n.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`,wb=class extends Aa{constructor(t){super(t,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Mu.menu}),this.viewer.addEventListener(rp.type,this),this.viewer.addEventListener(tp.type,this),super.hide()}destroy(){this.viewer.removeEventListener(rp.type,this),this.viewer.removeEventListener(tp.type,this),super.destroy()}handleEvent(t){t instanceof rp?this.toggleActive(t.panelId===Ws.MENU):t instanceof tp&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(t){super.hide(t),this.__hideMenu()}show(t){super.show(t),this.state.active&&this.__showMenu()}__showMenu(){this.viewer.panel.show({id:Ws.MENU,content:oye(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:t=>{const e=t?z6(t,".psv-panel-menu-item"):void 0,n=e?e.dataset[iye]:void 0;n&&(this.viewer.navbar.getButton(n).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(Ws.MENU)}};wb.id="menu";function sye(t){let e=0;switch(t){case 0:e=90;break;case 1:e=-90;break;case 3:e=180;break;default:e=0;break}return Mu.arrow.replace("rotate(0",`rotate(${e}`)}var Sx=class extends Aa{constructor(t,e){super(t,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:sye(e)}),this.direction=e,this.handler=new bS,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":t.key===As.Enter&&this.__onMouseDown();break;case"keyup":t.key===As.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return _S(Ta.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const t={};switch(this.direction){case 0:t.pitch=!1;break;case 1:t.pitch=!0;break;case 3:t.yaw=!1;break;default:t.yaw=!0;break}this.viewer.stopAll(),this.viewer.dynamics.position.roll(t),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};Sx.groupId="move";var I$=class extends Sx{constructor(t){super(t,1)}};I$.id="moveDown";var R$=class extends Sx{constructor(t){super(t,2)}};R$.id="moveLeft";var L$=class extends Sx{constructor(t){super(t,3)}};L$.id="moveRight";var k$=class extends Sx{constructor(t){super(t,0)}};k$.id="moveUp";var PI=class extends Aa{constructor(t,e,n){super(t,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=n,this.handler=new bS,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":t.key===As.Enter&&this.__onMouseDown();break;case"keyup":t.key===As.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return _S(Ta.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(this.direction===1),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};PI.groupId="zoom";var D$=class extends PI{constructor(t){super(t,Mu.zoomIn,0)}};D$.id="zoomIn";var z$=class extends PI{constructor(t){super(t,Mu.zoomOut,1)}};z$.id="zoomOut";var AI=class extends Aa{constructor(t){super(t,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new eU(this.container,"HORIZONTAL",e=>this.__onSliderUpdate(e)),this.mediaMinWidth=parseInt(Sh(this.container,"max-width"),10),this.viewer.addEventListener(jd.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(s_.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(jd.type,this),this.viewer.removeEventListener(s_.type,this),super.destroy()}handleEvent(t){t instanceof jd?this.__moveZoomValue(t.zoomLevel):t instanceof s_&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return _S(Ta.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(t){this.zoomValue.style.left=t/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(t){t.mousedown&&this.viewer.zoom(t.value*100)}};AI.id="zoomRange";AI.groupId="zoom";var O$=class extends tU{constructor(t){super(),this.viewer=t}init(){}destroy(){}},II=class extends O${constructor(t,e){super(t),this.config=this.constructor.configParser(e)}setOption(t,e){this.setOptions({[t]:e})}setOptions(t){const e={...this.config,...t},n=this.constructor,r=n.configParser,i=n.readonlyOptions,l=n.id;for(let[c,s]of Object.entries(t)){if(!(c in r.defaults)){qs(`${l}: Unknown option "${c}"`);continue}if(i.includes(c)){qs(`${l}: Option "${c}" cannot be updated`);continue}c in r.parsers&&(s=r.parsers[c](s,{rawConfig:e,defValue:r.defaults[c]})),this.config[c]=s}}};II.readonlyOptions=[];function pP(t){if(t){for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof O$)return CI(e.id,e.VERSION,"5.13.4"),e}return null}var Kd={panorama:null,container:null,adapter:[TI,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:()=>!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[As.ArrowUp]:"ROTATE_UP",[As.ArrowDown]:"ROTATE_DOWN",[As.ArrowRight]:"ROTATE_RIGHT",[As.ArrowLeft]:"ROTATE_LEFT",[As.PageUp]:"ZOOM_IN",[As.PageDown]:"ZOOM_OUT",[As.Plus]:"ZOOM_IN",[As.Minus]:"ZOOM_OUT"}},nO={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},mP={container:t=>{if(!t)throw new jn("No value given for container.");return t},adapter:(t,{defValue:e})=>{if(t?Array.isArray(t)?t=[tO(t[0]),t[1]]:t=[tO(t),null]:t=e,!t[0])throw new jn("An undefined value was given for adapter.");if(!t[0].id)throw new jn("Adapter has no id.");return t},defaultYaw:t=>gh(t),defaultPitch:t=>gh(t,!0),defaultZoomLvl:t=>Wr.clamp(t,0,100),minFov:(t,{rawConfig:e})=>(e.maxFov<t&&(qs("maxFov cannot be lower than minFov"),t=e.maxFov),Wr.clamp(t,1,179)),maxFov:(t,{rawConfig:e})=>(t<e.minFov&&(t=e.minFov),Wr.clamp(t,1,179)),moveInertia:(t,{defValue:e})=>t===!0?e:t===!1?0:t,lang:t=>({...Kd.lang,...t}),keyboardActions:(t,{rawConfig:e})=>e.keyboard&&typeof e.keyboard=="object"?e.keyboard:t,fisheye:t=>t===!0?1:t===!1?0:t,requestHeaders:t=>t&&typeof t=="object"?()=>t:typeof t=="function"?t:null,withCredentials:t=>typeof t=="boolean"?()=>t:typeof t=="function"?t:()=>!1,defaultTransition:(t,{defValue:e})=>t===null||t.speed===0?null:{...e,...t},rendererParameters:(t,{defValue:e})=>({...t,...e}),plugins:t=>t.map((e,n)=>{if(Array.isArray(e)?e=[pP(e[0]),e[1]]:e=[pP(e),null],!e[0])throw new jn(`An undefined value was given for plugin ${n}.`);if(!e[0].id)throw new jn(`Plugin ${n} has no id.`);return e}),navbar:t=>t===!1?null:t===!0?yS(Kd.navbar):typeof t=="string"?t.split(/[ ,]/):t},aye=xS(Kd,mP),Dv=class extends Aa{constructor(t){super(t,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(t){this.show(),this.contentElt.innerHTML=t??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){this.viewer.navbar.getButton(D_.id,!1)?.autoSize(!0)}};Dv.id="caption";var gP={},uw={};function RI(t,e){if(!t.id)throw new jn("Button id is required");if(gP[t.id]=t,t.groupId&&(uw[t.groupId]=uw[t.groupId]||[]).push(t),e){const n=Kd.navbar;switch(e){case"start":n.unshift(t.id);break;case"end":n.push(t.id);break;default:{const[r,i]=e.split(":"),l=n.indexOf(r);if(!r||!i||l===-1)throw new jn(`Invalid defaultPosition ${e}`);n.splice(l+(i==="right"?1:0),0,t.id)}}}}[z$,AI,D$,D_,Dv,P$,A$,R$,L$,k$,I$].forEach(t=>RI(t));var lye=class extends Mp{constructor(t){super(t,{className:`psv-navbar ${bx}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(t){this.children.slice().forEach(e=>e.destroy()),this.children.length=0,t.indexOf(Dv.id)!==-1&&t.indexOf(D_.id)===-1&&t.splice(t.indexOf(Dv.id),0,D_.id),t.forEach(e=>{typeof e=="object"?new rye(this,e):gP[e]?new gP[e](this):uw[e]?uw[e].forEach(n=>{new n(this)}):qs(`Unknown button ${e}`)}),new wb(this),this.children.forEach(e=>{e instanceof Aa&&e.checkSupported()}),this.autoSize()}setCaption(t){this.children.some(e=>e instanceof Dv?(e.setCaption(t),!0):!1)}getButton(t,e=!0){const n=this.children.find(r=>r instanceof Aa&&r.id===t);return!n&&e&&qs(`button "${t}" not found in the navbar`),n}focusButton(t){this.isVisible()&&(this.getButton(t,!1)?.container||this.container.firstElementChild)?.focus()}autoSize(){this.children.forEach(r=>{r instanceof Aa&&r.autoSize()});const t=this.container.offsetWidth;let e=0;const n=[];this.children.forEach(r=>{r.isVisible()&&r instanceof Aa&&(e+=r.width,r.collapsable&&n.push(r))}),e!==0&&(t<e&&n.length>0?(n.forEach(r=>r.collapse()),this.collapsed=n,this.getButton(wb.id).show(!1)):t>=e&&this.collapsed.length>0&&(this.collapsed.forEach(r=>r.uncollapse()),this.collapsed=[],this.getButton(wb.id).hide(!1)),this.getButton(Dv.id,!1)?.autoSize())}};iP.enabled=!1;var wv={enabled:!0,maxItems:10,ttl:10*60,items:{},purgeInterval:null,init(){iP.enabled&&(qs("ThreeJS cache should be disabled"),iP.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval(()=>this.purge(),60*1e3))},add(t,e,n){this.enabled&&e&&(this.items[e]=this.items[e]??{files:{},lastAccess:null},this.items[e].files[t]=n,this.items[e].lastAccess=Date.now())},get(t,e){if(this.enabled&&e&&this.items[e])return this.items[e].lastAccess=Date.now(),this.items[e].files[t]},remove(t,e){this.enabled&&e&&this.items[e]&&(delete this.items[e].files[t],Object.keys(this.items[e].files).length===0&&delete this.items[e])},purge(){Object.entries(this.items).sort(([,t],[,e])=>e.lastAccess-t.lastAccess).forEach(([t,{lastAccess:e}],n)=>{n>0&&(Date.now()-e>=this.ttl*1e3||n>=this.maxItems)&&delete this.items[t]})}},cye=class extends Mp{constructor(t){super(t,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=Sh(this.loader,"color"),this.color=Sh(this.canvas,"color"),this.border=parseInt(Sh(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(Sh(this.loader,"--psv-loader-tickness"),10);const e=this.size/2;this.canvas.innerHTML=`
            <circle cx="${e}" cy="${e}" r="${e}" fill="${this.color}"/>
            <path d="" fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>
        `,this.viewer.addEventListener(nl.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(nl.type,this),super.destroy()}handleEvent(t){t instanceof nl&&t.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(t){this.container.classList.remove("psv-loader--undefined");const e=Wr.clamp(t,0,99.999)/100*Math.PI*2,n=this.size/2,r=n,i=this.thickness/2+this.border,l=(this.size-this.thickness)/2-this.border,c=Math.sin(e)*l+n,s=-Math.cos(e)*l+n,p=t>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d",`M ${r} ${i} A ${l} ${l} 0 ${p} 1 ${c} ${s}`)}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){const t=this.loader.querySelector(".psv-loader-image, .psv-loader-text");t&&this.loader.removeChild(t);let e;if(this.viewer.config.loadingImg?(e=document.createElement("img"),e.className="psv-loader-image",e.src=this.viewer.config.loadingImg):this.viewer.config.loadingTxt!==null&&(e=document.createElement("div"),e.className="psv-loader-text",e.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),e){const n=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));e.style.maxWidth=n+"px",e.style.maxHeight=n+"px",this.loader.appendChild(e)}}},uye=class extends Mp{constructor(t){super(t,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",()=>this.hide())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new jn("Notification cannot be toggled")}show(t){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),typeof t=="string"&&(t={content:t}),this.state.contentId=t.id||null,this.content.innerHTML=t.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new a_(this.state.contentId)),t.timeout&&(this.state.timeout=setTimeout(()=>this.hide(this.state.contentId),t.timeout))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new r_(e))}}},hye=class extends Mp{constructor(t){super(t,{className:`psv-overlay ${bx}`}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(np.type,this),super.hide()}destroy(){this.viewer.removeEventListener(np.type,this),super.destroy()}handleEvent(t){t.type==="click"?this.isVisible()&&this.state.dismissible&&(this.hide(),t.stopPropagation()):t instanceof np&&this.isVisible()&&this.state.dismissible&&t.key===As.Escape&&(this.hide(),t.preventDefault())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new jn("Overlay cannot be toggled")}show(t){typeof t=="string"&&(t={title:t}),this.state.contentId=t.id||null,this.state.dismissible=t.dismissible!==!1,this.image.innerHTML=t.image||"",this.title.innerHTML=t.title||"",this.text.innerHTML=t.text||"",super.show(),this.viewer.dispatchEvent(new i$(this.state.contentId))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new SU(e))}}},dye=200,SE="psv-panel-content--no-interaction",fye=class extends Mp{constructor(t){super(t,{className:`psv-panel ${bx}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const e=document.createElement("div");e.className="psv-panel-resizer",this.container.appendChild(e);const n=document.createElement("div");n.className="psv-panel-close-button",n.innerHTML=Mu.close,n.title=t.config.lang.close,this.container.appendChild(n),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),n.addEventListener("click",()=>this.hide()),e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(np.type,this)}destroy(){this.viewer.removeEventListener(np.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break;case np.type:this.__onKeyPress(t);break}}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new jn("Panel cannot be toggled")}show(t){typeof t=="string"&&(t={content:t});const e=this.isVisible(t.id);this.state.contentId=t.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),t.id&&this.state.width[t.id]?this.container.style.width=this.state.width[t.id]:t.width?this.container.style.width=t.width:this.container.style.width=null,this.content.innerHTML=t.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),vS(this.content,"psv-panel-content--no-margin",t.noMargin===!0),t.clickHandler&&(this.state.clickHandler=n=>{t.clickHandler(ow(n))},this.state.keyHandler=n=>{n.key===As.Enter&&t.clickHandler(ow(n))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),e||setTimeout(()=>{this.content.querySelector("a,button,[tabindex]")?.focus()},300)),this.viewer.dispatchEvent(new rp(this.state.contentId))}hide(t){if(this.isVisible(t)){const e=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new tp(e))}}__onMouseDown(t){t.stopPropagation(),this.__startResize(t.clientX,t.clientY)}__onTouchStart(t){if(t.stopPropagation(),t.touches.length===1){const e=t.touches[0];this.__startResize(e.clientX,e.clientY)}}__onMouseUp(t){this.state.mousedown&&(t.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(SE))}__onTouchEnd(t){this.state.mousedown&&(t.stopPropagation(),t.touches.length===0&&(this.state.mousedown=!1,this.content.classList.remove(SE)))}__onMouseMove(t){this.state.mousedown&&(t.stopPropagation(),this.__resize(t.clientX,t.clientY))}__onTouchMove(t){if(this.state.mousedown){const e=t.touches[0];this.__resize(e.clientX,e.clientY)}}__onKeyPress(t){this.isVisible()&&t.key===As.Escape&&(this.hide(),t.preventDefault())}__startResize(t,e){this.state.mouseX=t,this.state.mouseY=e,this.state.mousedown=!0,this.content.classList.add(SE)}__resize(t,e){const n=t,r=e,i=Math.max(dye,this.container.offsetWidth-(n-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=i),this.container.style.width=i,this.state.mouseX=n,this.state.mouseY=r}},pye=class extends Mp{constructor(t,e){super(t,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",n=>n.stopPropagation()),this.container.addEventListener("mousedown",n=>n.stopPropagation()),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(e)}handleEvent(t){t.type==="transitionend"&&this.__onTransitionEnd(t)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new jn("Tooltip cannot be toggled")}show(t){if(this.state.state!==0)throw new jn("Initialized tooltip cannot be re-initialized");t.className&&xI(this.container,t.className),t.style&&Object.assign(this.container.style,t.style),this.state.state=3,this.update(t.content,t),this.state.data=t.data,this.state.state=1,this.viewer.dispatchEvent(new c$(this,this.state.data)),this.__waitImages()}update(t,e){this.content.innerHTML=t;const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.state.arrow=parseInt(Sh(this.arrow,"border-top-width"),10),this.state.border=parseInt(Sh(this.container,"border-top-left-radius"),10),this.move(e??this.state.config),this.__waitImages()}move(t){if(this.state.state!==1&&this.state.state!==3)throw new jn("Uninitialized tooltip cannot be moved");t.box=t.box??this.state.config?.box??{width:0,height:0},this.state.config=t;const e=this.container,n=this.arrow,r={posClass:q6(t.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(r,t);let i=null,l=null;if(r.top<0?i="bottom":r.top+r.height>this.viewer.state.size.height&&(i="top"),r.left<0?l="right":r.left+r.width>this.viewer.state.size.width&&(l="left"),l||i){const s=MI(r.posClass);i&&(r.posClass[s?0:1]=i),l&&(r.posClass[s?1:0]=l),this.__computeTooltipPosition(r,t)}e.style.top=r.top+"px",e.style.left=r.left+"px",n.style.top=r.arrowTop+"px",n.style.left=r.arrowLeft+"px";const c=r.posClass.join("-");c!==this.state.pos&&(e.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=c,e.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new PU(this.state.data));const t=parseFloat(Sh(this.container,"transition-duration"));this.state.hideTimeout=setTimeout(()=>{this.destroy()},t*2)}__onTransitionEnd(t){if(t.propertyName==="transform")switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy();break}}__computeTooltipPosition(t,e){const n=this.state.arrow,r=e.top,i=t.height,l=e.left,c=t.width,s=n+this.state.border,p=e.box.width/2+n*2,y=e.box.height/2+n*2;switch(t.posClass.join("-")){case"top-left":t.top=r-y-i,t.left=l+s-c,t.arrowTop=i,t.arrowLeft=c-s-n;break;case"top-center":t.top=r-y-i,t.left=l-c/2,t.arrowTop=i,t.arrowLeft=c/2-n;break;case"top-right":t.top=r-y-i,t.left=l-s,t.arrowTop=i,t.arrowLeft=n;break;case"bottom-left":t.top=r+y,t.left=l+s-c,t.arrowTop=-n*2,t.arrowLeft=c-s-n;break;case"bottom-center":t.top=r+y,t.left=l-c/2,t.arrowTop=-n*2,t.arrowLeft=c/2-n;break;case"bottom-right":t.top=r+y,t.left=l-s,t.arrowTop=-n*2,t.arrowLeft=n;break;case"left-top":t.top=r+s-i,t.left=l-p-c,t.arrowTop=i-s-n,t.arrowLeft=c;break;case"center-left":t.top=r-i/2,t.left=l-p-c,t.arrowTop=i/2-n,t.arrowLeft=c;break;case"left-bottom":t.top=r-s,t.left=l-p-c,t.arrowTop=n,t.arrowLeft=c;break;case"right-top":t.top=r+s-i,t.left=l+p,t.arrowTop=i-s-n,t.arrowLeft=-n*2;break;case"center-right":t.top=r-i/2,t.left=l+p,t.arrowTop=i/2-n,t.arrowLeft=-n*2;break;case"right-bottom":t.top=r-s,t.left=l+p,t.arrowTop=n,t.arrowLeft=-n*2;break}}__waitImages(){const t=this.content.querySelectorAll("img");if(t.length>0){const e=[];t.forEach(n=>{n.complete||e.push(new Promise(r=>{n.onload=r,n.onerror=r}))}),e.length&&Promise.all(e).then(()=>{if(this.state.state===1||this.state.state===3){const n=this.container.getBoundingClientRect();this.state.width=n.right-n.left,this.state.height=n.bottom-n.top,this.move(this.state.config)}})}}},mye=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/><!--Created by Shastry from the Noun Project--></svg>
`,Mx=class{constructor(t){this.viewer=t,this.config=t.config,this.state=t.state}destroy(){}},mu=new At,H1=new Lh(0,0,0,"ZXY"),gye=class extends Mx{constructor(t){super(t)}fovToZoomLevel(t){const e=Math.round((t-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return Wr.clamp(e-2*(e-50),0,100)}zoomLevelToFov(t){return this.config.maxFov+t/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(t){return Wr.radToDeg(2*Math.atan(Math.tan(Wr.degToRad(t)/2)*this.state.aspect))}hFovToVFov(t){return Wr.radToDeg(2*Math.atan(Math.tan(Wr.degToRad(t)/2)/this.state.aspect))}getAnimationProperties(t,e,n){const r=!Is(e),i=!Is(n),l={};let c=null;if(r){const s=this.viewer.getPosition(),p=L6(s.yaw,e.yaw);l.yaw={start:s.yaw,end:s.yaw+p},l.pitch={start:s.pitch,end:e.pitch},c=uP(t,k6(s,e))}if(i){const s=this.viewer.getZoomLevel(),p=Math.abs(n-s);l.zoom={start:s,end:n},c===null&&(c=uP(t,Math.PI/4*p/100))}return c===null?typeof t=="number"?c=t:c=aP:c=Math.max(aP,c),{duration:c,properties:l}}getTransitionOptions(t){let e;const n=this.config.defaultTransition??Kd.defaultTransition;return t.transition===!1||t.transition===null?e=null:t.transition===!0?e={...n}:typeof t.transition=="object"?e={...n,...t.transition}:e=this.config.defaultTransition,e}textureCoordsToSphericalCoords(t){if(!this.state.textureData?.panoData)throw new jn("Current adapter does not support texture coordinates or no texture has been loaded");const e=this.viewer.adapter.textureCoordsToSphericalCoords(t,this.state.textureData.panoData);return!H1.equals(this.viewer.renderer.panoramaPose)||!H1.equals(this.viewer.renderer.sphereCorrection)?(this.sphericalCoordsToVector3(e,mu),mu.applyEuler(this.viewer.renderer.panoramaPose),mu.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(mu)):e}sphericalCoordsToTextureCoords(t){if(!this.state.textureData?.panoData)throw new jn("Current adapter does not support texture coordinates or no texture has been loaded");return(!H1.equals(this.viewer.renderer.panoramaPose)||!H1.equals(this.viewer.renderer.sphereCorrection))&&(this.sphericalCoordsToVector3(t,mu),dP(mu,this.viewer.renderer.sphereCorrection),dP(mu,this.viewer.renderer.panoramaPose),t=this.vector3ToSphericalCoords(mu)),this.viewer.adapter.sphericalCoordsToTextureCoords(t,this.state.textureData.panoData)}sphericalCoordsToVector3(t,e,n=Ym){return e||(e=new At),e.x=n*-Math.cos(t.pitch)*Math.sin(t.yaw),e.y=n*Math.sin(t.pitch),e.z=n*Math.cos(t.pitch)*Math.cos(t.yaw),e}vector3ToSphericalCoords(t){const e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),n=Math.atan2(t.x,t.z);return{yaw:n<0?-n:Math.PI*2-n,pitch:Math.PI/2-e}}viewerCoordsToVector3(t){const e=this.viewer.renderer.getIntersections(t).filter(n=>n.object.userData[fp]);return e.length?e[0].point:null}viewerCoordsToSphericalCoords(t){const e=this.viewerCoordsToVector3(t);return e?this.vector3ToSphericalCoords(e):null}vector3ToViewerCoords(t){const e=t.clone();return e.project(this.viewer.renderer.camera),{x:Math.round((e.x+1)/2*this.state.size.width),y:Math.round((1-e.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(t){return this.sphericalCoordsToVector3(t,mu),this.vector3ToViewerCoords(mu)}isPointVisible(t){let e,n;if(t instanceof At)e=t,n=this.vector3ToViewerCoords(t);else if(SI(t))e=this.sphericalCoordsToVector3(t,mu),n=this.vector3ToViewerCoords(e);else return!1;return e.dot(this.viewer.state.direction)>0&&n.x>=0&&n.x<=this.viewer.state.size.width&&n.y>=0&&n.y<=this.viewer.state.size.height}cleanPosition(t){if("yaw"in t||"pitch"in t){if(!("yaw"in t)||!("pitch"in t))throw new jn("Position is missing 'yaw' or 'pitch'");return{yaw:gh(t.yaw),pitch:gh(t.pitch,!0)}}else return this.textureCoordsToSphericalCoords(t)}cleanSphereCorrection(t){return{pan:gh(t?.pan||0),tilt:gh(t?.tilt||0,!0),roll:gh(t?.roll||0,!0,!1)}}cleanPanoramaPose(t){return{pan:Wr.degToRad(t?.poseHeading||0),tilt:Wr.degToRad(t?.posePitch||0),roll:Wr.degToRad(t?.poseRoll||0)}}cleanPanoramaOptions(t,e){return e?.isEquirectangular&&(Is(t.zoom)&&!Is(e.initialFov)&&(t={...t,zoom:this.fovToZoomLevel(this.hFovToVFov(e.initialFov))}),Is(t.position)&&!Is(e.initialHeading)&&!Is(e.initialPitch)&&(t={...t,position:{yaw:gh(e.initialHeading),pitch:gh(e.initialPitch,!0)}})),t}},vye=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/><!--Created by AomAm from the Noun Project--></svg>
`,yye=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/><!-- Created by Icon Island from the Noun Project --></svg>
`,CS=class F${constructor(){this.$=F$.IDLE}is(...e){return e.some(n=>this.$&n)}set(e){this.$=e}add(e){this.$|=e}remove(e){this.$&=~e}};CS.IDLE=0;CS.CLICK=1;CS.MOVING=2;var Yo=CS,_ye=class extends Mx{constructor(t){super(t),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new Yo,this.keyHandler=new bS,this.resizeObserver=new ResizeObserver($6(()=>this.viewer.autoSize(),50)),this.moveThreshold=M6*Ta.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(t_.type,this),this.viewer.addEventListener(c_.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(t_.type,this),this.viewer.removeEventListener(c_.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(t){switch(t.type){case"keydown":this.__onKeyDown(t);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchmove":this.__onTouchMove(t);break;case"touchend":this.__onTouchEnd(t);break;case"fullscreenchange":this.__onFullscreenChange();break;case t_.type:this.__applyMoveDelta();break;case c_.type:this.__clearMoveDelta();break}if(!O6(t,"."+bx))switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"wheel":this.__onMouseWheel(t);break}}__onKeyDown(t){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=t.key===As.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(Ws.CTRL_ZOOM))),!this.viewer.dispatchEvent(new np(t.key,t))||!this.state.keyboardEnabled)return;const e=this.config.keyboardActions?.[t.key];if(typeof e=="function"){e(this.viewer,t),t.preventDefault();return}if(!(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)&&e&&!this.keyHandler.pending){switch(e!=="ZOOM_IN"&&e!=="ZOOM_OUT"&&this.viewer.stopAll(),e){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0);break}this.keyHandler.down(e),t.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(t=>{t==="ZOOM_IN"||t==="ZOOM_OUT"?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())})}__onMouseDown(t){this.step.add(Yo.CLICK),this.data.startMouseX=t.clientX,this.data.startMouseY=t.clientY,this.config.mousemove&&t.preventDefault()}__onMouseUp(t){this.step.is(Yo.CLICK,Yo.MOVING)&&this.__stopMove(t.clientX,t.clientY,t,t.button===2)}__onMouseMove(t){this.config.mousemove&&this.step.is(Yo.CLICK,Yo.MOVING)&&(t.preventDefault(),this.__doMove(t.clientX,t.clientY)),this.__handleObjectsEvents(t)}__onTouchStart(t){t.touches.length===1?(this.step.add(Yo.CLICK),this.data.startMouseX=t.touches[0].clientX,this.data.startMouseY=t.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(()=>{const e=t.touches[0];this.__stopMove(e.clientX,e.clientY,t,!0),this.data.longtouchTimeout=null},E6))):t.touches.length===2&&(this.step.set(Yo.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(t),t.preventDefault()))}__onTouchEnd(t){if(this.__cancelLongTouch(),this.step.is(Yo.CLICK,Yo.MOVING)){if(t.preventDefault(),this.__cancelTwoFingersOverlay(),t.touches.length===1)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(t.touches.length===0){const e=t.changedTouches[0];this.__stopMove(e.clientX,e.clientY,t)}}}__onTouchMove(t){if(this.__cancelLongTouch(),!!this.config.mousemove)if(t.touches.length===1){if(this.config.touchmoveTwoFingers)this.step.is(Yo.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(()=>{this.viewer.overlay.show({id:Ws.TWO_FINGERS,image:vye,title:this.config.lang.twoFingers})},T6));else if(this.step.is(Yo.CLICK,Yo.MOVING)){t.preventDefault();const e=t.touches[0];this.__doMove(e.clientX,e.clientY)}}else this.__doMoveZoom(t),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(Ws.TWO_FINGERS))}__onMouseWheel(t){if(!this.config.mousewheel||!t.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown){this.viewer.overlay.show({id:Ws.CTRL_ZOOM,image:yye,title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),this.data.ctrlZoomTimeout=setTimeout(()=>this.viewer.overlay.hide(Ws.CTRL_ZOOM),P6);return}t.preventDefault(),t.stopPropagation();const e=t.deltaY/Math.abs(t.deltaY)*5*this.config.zoomSpeed;e!==0&&this.viewer.dynamics.zoom.step(-e,5)}__onFullscreenChange(){const t=this.viewer.isFullscreenEnabled();this.config.keyboard==="fullscreen"&&(t?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new n_(t))}__resetMove(){this.step.set(Yo.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(t){this.viewer.stopAll(),this.__resetMove();const e=lP(t);this.step.set(Yo.MOVING),this.data.accumulatorFactor=this.config.moveInertia,{distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=e}__stopMove(t,e,n,r=!1){this.step.is(Yo.CLICK)&&!this.__moveThresholdReached(t,e)&&this.__doClick(t,e,n,r),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(t,e,n,r=!1){const i=this.viewer.container.getBoundingClientRect(),l=t-i.left,c=e-i.top,s=this.viewer.renderer.getIntersections({x:l,y:c}),p=s.find(y=>y.object.userData[fp]);if(p){const y=this.viewer.dataHelper.vector3ToSphericalCoords(p.point),_={rightclick:r,originalEvent:n,target:ow(n),clientX:t,clientY:e,viewerX:l,viewerY:c,yaw:y.yaw,pitch:y.pitch,objects:s.map(w=>w.object).filter(w=>!w.userData[fp])};try{const w=this.viewer.dataHelper.sphericalCoordsToTextureCoords(_);Object.assign(_,w)}catch{}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-_.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-_.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new gU(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new hU(_)),this.data.dblclickData=yS(_),this.data.dblclickTimeout=setTimeout(()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null},C6))}}__handleObjectsEvents(t){if(!j6(this.state.objectsObservers)&&t.composedPath().includes(this.viewer.container)){const e=F6(this.viewer.container),n={x:t.clientX-e.x,y:t.clientY-e.y},r=this.viewer.renderer.getIntersections(n),i=(l,c,s)=>{this.viewer.dispatchEvent(new s(t,l,n,c))};for(const[l,c]of Object.entries(this.state.objectsObservers)){const s=r.find(p=>p.object.userData[l]);s?(c&&s.object!==c&&(i(c,l,fP),this.state.objectsObservers[l]=null),c?i(s.object,l,S$):(this.state.objectsObservers[l]=s.object,i(s.object,l,y$))):c&&(i(c,l,fP),this.state.objectsObservers[l]=null)}}}__doMove(t,e){if(this.step.is(Yo.CLICK)&&this.__moveThresholdReached(t,e))this.viewer.stopAll(),this.__resetMove(),this.step.set(Yo.MOVING),this.data.mouseX=t,this.data.mouseY=e,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(Yo.MOVING)){const n=(t-this.data.mouseX)*Math.cos(this.state.roll)-(e-this.data.mouseY)*Math.sin(this.state.roll),r=(e-this.data.mouseY)*Math.cos(this.state.roll)+(t-this.data.mouseX)*Math.sin(this.state.roll),i={yaw:this.config.moveSpeed*(n/this.state.size.width)*Wr.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(r/this.state.size.height)*Wr.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=i.yaw,this.data.moveDelta.pitch+=i.pitch,this.data.mouseX=t,this.data.mouseY=e}}__moveThresholdReached(t,e){return Math.abs(t-this.data.startMouseX)>=this.moveThreshold||Math.abs(e-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(t){if(this.step.is(Yo.MOVING)){t.preventDefault();const e=lP(t);this.__doMove(e.center.x,e.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((e.distance-this.data.pinchDist)/Ta.pixelRatio),this.data.pinchDist=e.distance}}__applyMoveDelta(){if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){const e=this.viewer.getPosition();this.viewer.rotate({yaw:e.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:e.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,Math.abs(this.data.moveDelta.yaw)<=.001&&(this.data.moveDelta.yaw=0),Math.abs(this.data.moveDelta.pitch)<=.001&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){const e=this.viewer.getZoomLevel();this.viewer.zoom(e+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,Math.abs(this.data.moveDelta.zoom)<=.001&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};li.enabled=!1;var G1=new gi,rO=new Pi,iO=new _y,xye=class extends Mx{constructor(t){super(t),this.frustumNeedsUpdate=!0,this.renderer=new zve(this.config.rendererParameters),this.renderer.setPixelRatio(Ta.pixelRatio),this.renderer.outputColorSpace=Zm,this.renderer.toneMapping=KB,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new nw,this.camera=new Nl(50,16/9,.1,2*Ym),this.camera.matrixAutoUpdate=!1;const e=new Ja(new xy(Ym).scale(-1,1,1),new dp({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));e.userData={[fp]:!0},this.scene.add(e),this.raycaster=new Jde,this.frustum=new gI,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",n=>n.preventDefault()),this.viewer.addEventListener(l_.type,this),this.viewer.addEventListener(jd.type,this),this.viewer.addEventListener(i_.type,this),this.viewer.addEventListener(o_.type,this),this.viewer.addEventListener(nl.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop(t=>this.__renderLoop(t))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(l_.type,this),this.viewer.removeEventListener(jd.type,this),this.viewer.removeEventListener(i_.type,this),this.viewer.removeEventListener(o_.type,this),this.viewer.removeEventListener(nl.type,this),super.destroy()}handleEvent(t){switch(t.type){case l_.type:this.__onSizeUpdated();break;case jd.type:this.__onZoomUpdated();break;case i_.type:this.__onPositionUpdated();break;case o_.type:this.__onPositionUpdated();break;case nl.type:t.containsOptions("fisheye")&&this.__onPositionUpdated(),t.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground);break}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(t){t?this.customRenderer=t(this.renderer):this.customRenderer=null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(t){const e=this.timestamp?t-this.timestamp:0;this.timestamp=t,this.viewer.dispatchEvent(new t_(t,e)),this.viewer.dynamics.update(e),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new QU))}setTexture(t){this.meshContainer||(this.meshContainer=new Kf,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(t.panoData),this.viewer.adapter.setTexture(this.mesh,t,!1),this.meshContainer.add(this.mesh),this.state.textureData=t,this.viewer.needsUpdate()}setPanoramaPose(t,e=this.mesh){const n=this.viewer.dataHelper.cleanPanoramaPose(t);e.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}setSphereCorrection(t,e=this.meshContainer){const n=this.viewer.dataHelper.cleanSphereCorrection(t);e.rotation.set(n.tilt,n.pan,n.roll,"YXZ")}transition(t,e,n){const r=n.effect==="fade"||n.rotation,i=!Is(e.position),l=!Is(e.zoom),c=new EI(i?this.viewer.dataHelper.cleanPosition(e.position):void 0,e.zoom);this.viewer.dispatchEvent(c);const s=new Kf,p=this.viewer.adapter.createMesh(t.panoData);if(this.viewer.adapter.setTexture(p,t,!0),this.viewer.adapter.setTextureOpacity(p,0),this.setPanoramaPose(t.panoData,p),this.setSphereCorrection(e.sphereCorrection,s),i&&!n.rotation){const S=this.viewer.getPosition(),M=new At(0,1,0);s.rotateOnWorldAxis(M,c.position.yaw-S.yaw);const I=new At(0,1,0).cross(this.camera.getWorldDirection(new At)).normalize();s.rotateOnWorldAxis(I,c.position.pitch-S.pitch)}s.add(p),this.scene.add(s),this.renderer.setRenderTarget(new hp),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:y,properties:_}=this.viewer.dataHelper.getAnimationProperties(n.speed,n.rotation?c.position:null,r?c.zoomLevel:null),w=new cw({properties:{..._,opacity:{start:0,end:1}},duration:y,easing:"inOutCubic",onTick:S=>{switch(n.effect){case"fade":this.viewer.adapter.setTextureOpacity(p,S.opacity);break;case"black":case"white":S.opacity<.5?this.renderer.toneMappingExposure=n.effect==="black"?Wr.mapLinear(S.opacity,0,.5,1,0):Wr.mapLinear(S.opacity,0,.5,1,4):(this.renderer.toneMappingExposure=n.effect==="black"?Wr.mapLinear(S.opacity,.5,1,0,1):Wr.mapLinear(S.opacity,.5,1,4,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(p,1),l&&!r&&this.viewer.dynamics.zoom.setValue(c.zoomLevel));break}i&&n.rotation&&this.viewer.dynamics.position.setValue({yaw:S.yaw,pitch:S.pitch}),l&&r&&this.viewer.dynamics.zoom.setValue(S.zoom),this.viewer.needsUpdate()}});return w.then(S=>{s.remove(p),this.scene.remove(s),S?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=p,this.meshContainer.add(p),this.state.textureData=t,this.setPanoramaPose(t.panoData),this.setSphereCorrection(e.sphereCorrection),i&&!n.rotation&&this.viewer.rotate(e.position)):(this.viewer.adapter.disposeTexture(t),this.viewer.adapter.disposeMesh(p))}),w}getIntersections(t){G1.x=2*t.x/this.state.size.width-1,G1.y=-2*t.y/this.state.size.height+1,this.raycaster.setFromCamera(G1,this.camera);const e=this.raycaster.intersectObjects(this.scene.children,!0).filter(n=>n.object.visible).filter(n=>n.object.isMesh&&!!n.object.userData);return this.customRenderer?.getIntersections&&e.push(...this.customRenderer.getIntersections(this.raycaster,G1)),e}isObjectVisible(t){if(!t)return!1;if(this.frustumNeedsUpdate&&(rO.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(rO),this.frustumNeedsUpdate=!1),t.isVector3)return this.frustum.containsPoint(t);if(t.isMesh&&t.geometry){const e=t;return e.geometry.boundingBox||e.geometry.computeBoundingBox(),iO.copy(e.geometry.boundingBox).applyMatrix4(e.matrixWorld),this.frustum.intersectsBox(iO)}else return t.isObject3D?this.frustum.intersectsObject(t):!1}addObject(t){this.scene.add(t)}removeObject(t){this.scene.remove(t)}cleanScene(t){const e=n=>{n.map?.dispose(),n.uniforms&&Object.values(n.uniforms).forEach(r=>{r.value?.dispose?.()}),n.dispose()};t.traverse(n=>{n.geometry?.dispose(),n.material&&(Array.isArray(n.material)?n.material.forEach(r=>{e(r)}):e(n.material)),n instanceof nw||n.dispose?.(),n!==t&&this.cleanScene(n)})}},bye=class extends vI{load(t,e,n,r,i){const l=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(l,{signal:i}).then(c=>{if(c.status===200||c.status===0){const s=c.body.getReader(),p=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),y=p?parseInt(p):0,_=y!==0;let w=0;const S=new ReadableStream({start(M){I();function I(){s.read().then(({done:D,value:R})=>{if(D)M.close();else{w+=R.byteLength;const L=new ProgressEvent("progress",{lengthComputable:_,loaded:w,total:y});n(L),M.enqueue(R),I()}}).catch(D=>{r(D)})}}});return new Response(S)}else throw new Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>c.blob()).then(c=>{e(c)}).catch(c=>{r(c)})}},wye=class extends vI{load(t,e,n,r){const i=document.createElement("img");function l(){p(),e(this)}function c(y){if(p(),r?.aborted){const _=new Error;_.name="AbortError",_.message="The operation was aborted.",n(_)}else n(y)}function s(){i.src=""}function p(){i.removeEventListener("load",l,!1),i.removeEventListener("error",c,!1),r?.removeEventListener("abort",s,!1)}return i.addEventListener("load",l,!1),i.addEventListener("error",c,!1),r?.addEventListener("abort",s,!1),t.startsWith("data:")||(i.crossOrigin=this.withCredentials?"use-credentials":"anonymous"),i.src=t,i}},Sye=class extends Mx{constructor(t){super(t),this.abortCtrl={},this.fileLoader=new bye,this.imageLoader=new wye}destroy(){this.abortLoading(),super.destroy()}abortLoading(){Object.values(this.abortCtrl).forEach(t=>t.abort()),this.abortCtrl={}}loadFile(t,e,n){const r=wv.get(t,n);if(r){if(r instanceof Blob)return e?.(100),Promise.resolve(r);wv.remove(t,n)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(t)),this.fileLoader.setWithCredentials(this.config.withCredentials(t)),new Promise((i,l)=>{let c=0;e?.(c),this.fileLoader.load(t,s=>{c=100,e?.(c),wv.add(t,n,s),i(s)},s=>{if(s.lengthComputable){const p=s.loaded/s.total*100;p>c&&(c=p,e?.(c))}},s=>{l(s)},this.__getAbortSignal(n))})}loadImage(t,e,n){const r=wv.get(t,n);return r?(e?.(100),r instanceof Blob?this.blobToImage(r):Promise.resolve(r)):!e&&!this.config.requestHeaders?(this.imageLoader.setWithCredentials(this.config.withCredentials(t)),new Promise((i,l)=>{this.imageLoader.load(t,c=>{wv.add(t,n,c),i(c)},c=>{l(c)},this.__getAbortSignal(n))})):this.loadFile(t,e,n).then(i=>this.blobToImage(i))}blobToImage(t){return new Promise((e,n)=>{const r=document.createElement("img");r.onload=()=>{URL.revokeObjectURL(r.src),e(r)},r.onerror=n,r.src=URL.createObjectURL(t)})}preloadPanorama(t){return this.viewer.adapter.supportsPreload(t)?this.viewer.adapter.loadTexture(t,!1):Promise.reject(new jn("Current adapter does not support preload"))}dispatchProgress(t){this.viewer.loader.setProgress(t),this.viewer.dispatchEvent(new kU(Math.round(t)))}__getAbortSignal(t){return t?(this.abortCtrl[t]?.signal.aborted&&delete this.abortCtrl[t],this.abortCtrl[t]||(this.abortCtrl[t]=new AbortController),this.abortCtrl[t].signal):null}},Mye=class extends Mx{constructor(t){super(t),this.zoom=new N0(e=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(e),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new jd(e))},{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new J6(e=>{this.viewer.dataHelper.sphericalCoordsToVector3(e,this.viewer.state.direction),this.viewer.dispatchEvent(new i_(e))},{yaw:new N0(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new N0(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new N0(e=>{this.viewer.state.roll=e,this.viewer.dispatchEvent(new o_(e))},{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(this.config.zoomSpeed*50),this.position.setSpeed(Wr.degToRad(this.config.moveSpeed*50)),this.roll.setSpeed(Wr.degToRad(this.config.moveSpeed*50))}update(t){this.zoom.update(t),this.position.update(t),this.roll.update(t)}},Cye=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new At(0,0,Ym),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},Eye=class extends tU{constructor(t){if(super(),this.plugins={},this.children=[],this.parent=D6(t.container),!this.parent)throw new jn('"container" element not found.');this.parent[fp]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),Y6(this.parent),Z6(this.container,"core"),this.state=new Cye,this.config=aye(t),this.__setSize(this.config.size),this.overlay=new hye(this);try{Ta.load()}catch(e){console.error(e),this.showError(this.config.lang.webglError);return}wv.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new xye(this),this.textureLoader=new Sye(this),this.eventsHandler=new _ye(this),this.dataHelper=new gye(this),this.dynamics=new Mye(this),this.adapter.init?.(),this.loader=new cye(this),this.navbar=new lye(this),this.panel=new fye(this),this.notification=new uye(this),this.autoSize(),this.setCursor(null),wI(Ta.isTouchEnabled,e=>{vS(this.container,"psv--is-touch",e)}),this.config.plugins.forEach(([e,n])=>{this.plugins[e.id]=new e(this,n)});for(const e of Object.values(this.plugins))e.init?.();this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[t,e]of Object.entries(this.plugins))e.destroy(),delete this.plugins[t];this.children.slice().forEach(t=>t.destroy()),this.children.length=0,this.eventsHandler?.destroy(),this.renderer?.destroy(),this.textureLoader?.destroy(),this.dataHelper?.destroy(),this.adapter?.destroy(),this.dynamics?.destroy(),this.parent.removeChild(this.container),delete this.parent[fp]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),this.config.keyboard==="always"&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new s_)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(t){if(typeof t=="string")return this.plugins[t];{const e=pP(t);return e?this.plugins[e.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return N6(this.parent,Ta.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(t){t?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){(this.container.clientWidth!==this.state.size.width||this.container.clientHeight!==this.state.size.height)&&(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new l_(this.getSize())),this.navbar.autoSize())}setPanorama(t,e={}){this.textureLoader.abortLoading(),this.state.transitionAnimation?.cancel();const n=this.dataHelper.getTransitionOptions(e);e.showLoader===void 0&&(e.showLoader=!0),e.caption===void 0&&(e.caption=this.config.caption),e.description===void 0&&(e.description=this.config.description),!e.panoData&&typeof this.config.panoData=="function"&&(e.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=t,this.config.caption=e.caption,this.config.description=e.description,this.config.sphereCorrection=e.sphereCorrection;const r=l=>{if(W6(l))return!1;if(this.loader.hide(),this.state.loadingPromise=null,l)throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(l),this.dispatchEvent(new $U(t,l)),l;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),(e.showLoader||!this.state.ready)&&this.loader.show(),this.dispatchEvent(new OU(t));const i=this.adapter.loadTexture(this.config.panorama,!0,e.panoData).then(l=>{if(l.panorama!==this.config.panorama)throw this.adapter.disposeTexture(l),cP();const c=this.dataHelper.cleanPanoramaOptions(e,l.panoData);return(!Is(c.zoom)||!Is(c.position))&&this.stopAll(),{textureData:l,cleanOptions:c}});return!n||!this.state.ready||!this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=i.then(({textureData:l,cleanOptions:c})=>{this.renderer.show(),this.renderer.setTexture(l),this.renderer.setPanoramaPose(l.panoData),this.renderer.setSphereCorrection(e.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new qv(l)),Is(c.zoom)||this.zoom(c.zoom),Is(c.position)||this.rotate(c.position)}).then(()=>r(),l=>r(l)):this.state.loadingPromise=i.then(({textureData:l,cleanOptions:c})=>(this.loader.hide(),this.dispatchEvent(new qv(l)),this.state.transitionAnimation=this.renderer.transition(l,c,n),this.state.transitionAnimation)).then(l=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new HU(l)),!l)throw cP()}).then(()=>r(),l=>r(l)),this.state.loadingPromise}setOptions(t){const e={...this.config,...t};for(let[n,r]of Object.entries(t)){if(!(n in Kd)){qs(`Unknown option ${n}`);continue}if(n in nO){qs(nO[n]);continue}switch(n in mP&&(r=mP[n](r,{rawConfig:e,defValue:Kd[n]})),this.config[n]=r,n){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new jd(this.getZoomLevel()));break;case"keyboard":this.config.keyboard==="always"?this.startKeyboardControl():this.stopKeyboardControl();break}}this.needsUpdate(),this.dispatchEvent(new nl(Object.keys(t)))}setOption(t,e){this.setOptions({[t]:e})}showError(t){this.overlay.show({id:Ws.ERROR,image:mye,title:t,dismissible:!1})}hideError(){this.overlay.hide(Ws.ERROR)}rotate(t){const e=new lU(this.dataHelper.cleanPosition(t));this.dispatchEvent(e),!e.defaultPrevented&&this.dynamics.position.setValue(e.position)}zoom(t){this.dynamics.zoom.setValue(t)}zoomIn(t=1){this.dynamics.zoom.step(t)}zoomOut(t=1){this.dynamics.zoom.step(-t)}animate(t){const e=SI(t),n=!Is(t.zoom),r=new EI(e?this.dataHelper.cleanPosition(t):void 0,t.zoom);if(this.dispatchEvent(r),r.defaultPrevented)return;this.stopAll();const{duration:i,properties:l}=this.dataHelper.getAnimationProperties(t.speed,r.position,r.zoomLevel);return i?(this.state.animation=new cw({properties:l,duration:i,easing:t.easing||"inOutSine",onTick:c=>{e&&this.dynamics.position.setValue({yaw:c.yaw,pitch:c.pitch}),n&&this.dynamics.zoom.setValue(c.zoom)}}),this.state.animation.then(()=>{this.state.animation=null,this.resetIdleTimer()}),this.state.animation):(e&&this.rotate(r.position),n&&this.zoom(r.zoomLevel),new cw(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(t){this.__setSize(t),this.autoSize()}__setSize(t){["width","height"].forEach(e=>{t?.[e]&&(/^[0-9.]+$/.test(t[e])&&(t[e]+="px"),this.parent.style[e]=t[e])})}enterFullscreen(){this.isFullscreenEnabled()||B6(this.parent,Ta.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&U6(Ta.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(t){return new pye(this,t)}setCursor(t){this.state.cursorOverride=t,t?this.container.style.cursor=t:this.container.style.cursor=this.config.mousemove?"move":"default"}observeObjects(t){this.state.objectsObservers[t]||(this.state.objectsObservers[t]=null)}unobserveObjects(t){delete this.state.objectsObservers[t]}stopAll(){return this.dispatchEvent(new c_),this.disableIdleTimer(),this.stopAnimation()}};/*!
 * Photo Sphere Viewer / Equirectangular Tiles Adapter 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var Tye=class{constructor(t,e,n){this.id=t,this.priority=e,this.fn=n,this.status=1}start(){return this.status=2,this.fn(this).then(()=>{this.status=4},()=>{this.status=5})}cancel(){this.status=3}isCancelled(){return this.status===3}},Pye=class{constructor(e=8){this.concurency=e,this.runningTasks={},this.tasks={}}enqueue(e){this.tasks[e.id]=e}clear(){Object.values(this.tasks).forEach(e=>e.cancel()),this.tasks={},this.runningTasks={}}setPriority(e,n){const r=this.tasks[e];r&&(r.priority=n,r.status===0&&(r.status=1))}disableAllTasks(){Object.values(this.tasks).forEach(e=>{e.status=0})}start(){if(Object.keys(this.runningTasks).length>=this.concurency)return;const e=Object.values(this.tasks).filter(n=>n.status===1).sort((n,r)=>r.priority-n.priority).pop();e&&(this.runningTasks[e.id]=!0,e.start().then(()=>{e.isCancelled()||(delete this.tasks[e.id],delete this.runningTasks[e.id],this.start())}),this.start())}};function Aye(t){let e=0;t.forEach((n,r)=>{if(!n.zoomRange||n.zoomRange.length!==2)throw new jn(`Tiles level ${r} is missing "zoomRange" property`);if(n.zoomRange[0]>=n.zoomRange[1]||n.zoomRange[0]!==e||r===0&&n.zoomRange[0]!==0||r===t.length-1&&n.zoomRange[1]!==100)throw new jn(`Tiles levels' "zoomRange" are not orderer or are not covering the whole 0-100 range`);e=n.zoomRange[1]})}function Iye(t,e){return t.findIndex(n=>e>=n.zoomRange[0]&&e<=n.zoomRange[1])}function Rye(){const t=new OffscreenCanvas(512,512),e=t.getContext("2d");return e.fillStyle="#333",e.fillRect(0,0,t.width,t.height),e.font=`${t.width/5}px serif`,e.fillStyle="#a22",e.textAlign="center",e.textBaseline="middle",e.fillText("⚠",t.width/2,t.height/2),new dp({map:Qn.createTexture(t)})}function Lye(t){const e=new Gde(t),n=new jde(e);return n.material.depthTest=!1,n.material.depthWrite=!1,n.material.opacity=.25,n.material.transparent=!0,n}var oO=["dodgerblue","limegreen","indianred"];function kye(t,e,n){const r=document.createElement("canvas");r.width=t.width,r.height=t.height;const i=r.getContext("2d");i.fillStyle=oO[e%oO.length],i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="multiply",i.drawImage(t,0,0);const l=t.width/7;return i.globalCompositeOperation="source-over",i.fillStyle="white",i.font=`${l}px monospace`,i.textAlign="center",n.split(`
`).forEach((c,s)=>{i.fillText(c,t.width/2,t.height/2+l*(.3+s))}),r}function LI(t){return!!t.levels}function N$(t,e,n){return{...t,level:e,colSize:t.width/t.cols,rowSize:t.width/2/t.rows,facesByCol:n.SPHERE_SEGMENTS/t.cols,facesByRow:n.SPHERE_HORIZONTAL_SEGMENTS/t.rows}}function sO(t,e,n){let r,i;return LI(t)?(i=Iye(t.levels,e),r=t.levels[i]):(i=0,r={...t,zoomRange:[0,100]}),N$(r,i,n)}function Dye(t,e,n){return!LI(t)||!t.levels[e]?null:N$(t.levels[e],e,n)}function zye(t,e){if(typeof t!="object"||!t.tileUrl)throw new jn("Invalid panorama configuration, are you using the right adapter?");LI(t)?(t.levels.forEach(n=>aO(n,e)),Aye(t.levels)):aO(t,e)}function aO(t,e){if(!t.width||!t.cols||!t.rows)throw new jn("Invalid panorama configuration, are you using the right adapter?");if(t.cols>e.SPHERE_SEGMENTS)throw new jn(`Panorama cols must not be greater than ${e.SPHERE_SEGMENTS}.`);if(t.rows>e.SPHERE_HORIZONTAL_SEGMENTS)throw new jn(`Panorama rows must not be greater than ${e.SPHERE_HORIZONTAL_SEGMENTS}.`);if(!Wr.isPowerOfTwo(t.cols)||!Wr.isPowerOfTwo(t.rows))throw new jn("Panorama cols and rows must be powers of 2.")}function Oye(t,e){for(let n=0;n<e.cols;n++){const r=t.tileUrl(n,e.rows/2,e.level);if(r)return r}return t.tileUrl.toString()}var M0=6,qa=3,Fye="uv",Nye="position",lO=-1;function ME(t){return`${t.col}x${t.row}/${t.config.level}`}function W1(t){return t.children}var Bye=Qn.getConfigParser({resolution:64,showErrorTile:!0,baseBlur:!0,antialias:!0,debug:!1,useXmpData:!1}),q1=new At,ES=class B$ extends SS{constructor(e,n){super(e),this.state={tileConfig:null,tiles:{},faces:{},geom:null,materials:[],errorMaterial:null,inTransition:!1},this.queue=new Pye,this.config=Bye(n),this.adapter=new TI(this.viewer,{resolution:this.config.resolution,blur:this.config.baseBlur}),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2,this.NB_VERTICES=2*this.SPHERE_SEGMENTS*qa+(this.SPHERE_HORIZONTAL_SEGMENTS-2)*this.SPHERE_SEGMENTS*M0,this.NB_GROUPS=this.SPHERE_SEGMENTS*this.SPHERE_HORIZONTAL_SEGMENTS,this.viewer.config.requestHeaders&&Qn.logWarn('EquirectangularTilesAdapter fallbacks to file loader because "requestHeaders" where provided. Consider removing "requestHeaders" if you experience performances issues.')}static withConfig(e){return[B$,e]}init(){super.init(),this.viewer.addEventListener(nr.TransitionDoneEvent.type,this),this.viewer.addEventListener(nr.PositionUpdatedEvent.type,this),this.viewer.addEventListener(nr.ZoomUpdatedEvent.type,this)}destroy(){this.viewer.removeEventListener(nr.TransitionDoneEvent.type,this),this.viewer.removeEventListener(nr.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(nr.ZoomUpdatedEvent.type,this),this.__cleanup(),this.state.errorMaterial?.map?.dispose(),this.state.errorMaterial?.dispose(),this.adapter.destroy(),delete this.adapter,delete this.state.geom,delete this.state.errorMaterial,super.destroy()}handleEvent(e){switch(e.type){case nr.PositionUpdatedEvent.type:case nr.ZoomUpdatedEvent.type:this.__refresh();break;case nr.TransitionDoneEvent.type:this.state.inTransition=!1,e.completed&&this.__switchMesh(this.viewer.renderer.mesh);break}}supportsTransition(e){return!!e.baseUrl}supportsPreload(e){return!!e.baseUrl}textureCoordsToSphericalCoords(e,n){return this.adapter.textureCoordsToSphericalCoords(e,n)}sphericalCoordsToTextureCoords(e,n){return this.adapter.sphericalCoordsToTextureCoords(e,n)}async loadTexture(e,n=!0){zye(e,this);const r=sO(e,0,this),i={isEquirectangular:!0,fullWidth:r.width,fullHeight:r.width/2,croppedWidth:r.width,croppedHeight:r.width/2,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0};if(e.baseUrl){const l=await this.adapter.loadTexture(e.baseUrl,n,e.basePanoData,!0);return{panorama:e,panoData:{...i,baseData:l.panoData},cacheKey:l.cacheKey,texture:l.texture}}else return{panorama:e,panoData:{...i,baseData:null},cacheKey:Oye(e,r),texture:null}}createMesh(e){const n=this.adapter.createMesh(e.baseData??e),r=new xy(uy.SPHERE_RADIUS,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1).toNonIndexed();r.clearGroups();let i=0,l=0;for(;i<this.SPHERE_SEGMENTS*qa;i+=qa)r.addGroup(i,qa,l++);for(;i<this.NB_VERTICES-this.SPHERE_SEGMENTS*qa;i+=M0)r.addGroup(i,M0,l++);for(;i<this.NB_VERTICES;i+=qa)r.addGroup(i,qa,l++);const c=[],s=new dp({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1});for(let _=0;_<this.NB_GROUPS;_++)c.push(s);const p=new Ja(r,c);p.renderOrder=1;const y=new Kf;return y.add(n),y.add(p),y}setTexture(e,n,r){const[i]=W1(e);n.texture?this.adapter.setTexture(i,{panorama:n.panorama.baseUrl,texture:n.texture,panoData:n.panoData.baseData}):i.visible=!1,r?this.state.inTransition=!0:this.__switchMesh(e)}setTextureOpacity(e,n){const[r]=W1(e);this.adapter.setTextureOpacity(r,n)}disposeTexture({texture:e}){e?.dispose()}disposeMesh(e){const[n,r]=W1(e);n.geometry.dispose(),n.material.dispose(),r.geometry.dispose(),r.material.forEach(i=>{i.map?.dispose(),i.dispose()})}__refresh(){if(!this.state.geom||this.state.inTransition)return;const e=this.viewer.config.panorama,n=this.viewer.getZoomLevel(),r=sO(e,n,this),i=this.state.geom.getAttribute(Nye),l={};for(let c=0;c<this.NB_VERTICES;c+=1)if(q1.fromBufferAttribute(i,c),q1.applyEuler(this.viewer.renderer.sphereCorrection),this.viewer.renderer.isObjectVisible(q1)){let s;c<this.SPHERE_SEGMENTS*qa?s=Math.floor(c/3):c<this.NB_VERTICES-this.SPHERE_SEGMENTS*qa?s=Math.floor((c/3-this.SPHERE_SEGMENTS)/2)+this.SPHERE_SEGMENTS:s=Math.floor((c-this.NB_VERTICES-this.SPHERE_SEGMENTS*qa)/3)+this.SPHERE_HORIZONTAL_SEGMENTS*(this.SPHERE_SEGMENTS-1);const p=Math.floor(s/this.SPHERE_SEGMENTS),y=s-p*this.SPHERE_SEGMENTS;let _=r;for(;_;){const w=Math.floor(p/_.facesByRow),S=Math.floor(y/_.facesByCol);let M=q1.angleTo(this.viewer.state.direction);(w===0||w===_.rows-1)&&(M*=2);const I={row:w,col:S,angle:M,config:_,url:null},D=ME(I);if(l[D]){l[D].angle=Math.min(l[D].angle,M);break}else if(I.url=e.tileUrl(S,w,_.level),I.url){l[D]=I;break}else _=Dye(e,_.level-1,this)}}this.state.tileConfig=r,this.__loadTiles(Object.values(l))}__loadTiles(e){this.queue.disableAllTasks(),e.forEach(n=>{const r=ME(n);this.state.tiles[r]?this.queue.setPriority(r,n.angle):(this.state.tiles[r]=!0,this.queue.enqueue(new Tye(r,n.angle,i=>this.__loadTile(n,i))))}),this.queue.start()}__loadTile(e,n){return this.viewer.textureLoader.loadImage(e.url,null,this.viewer.state.textureData.cacheKey).then(r=>{if(!n.isCancelled()){this.config.debug&&(r=kye(r,e.config.level,ME(e)));const i=this.config.antialias&&e.config.level>0,l=new dp({map:Qn.createTexture(r,i)});this.__swapMaterial(e,l,!1),this.viewer.needsUpdate()}}).catch(r=>{!Qn.isAbortError(r)&&!n.isCancelled()&&this.config.showErrorTile&&(this.state.errorMaterial||(this.state.errorMaterial=Rye()),this.__swapMaterial(e,this.state.errorMaterial,!0),this.viewer.needsUpdate())})}__swapMaterial(e,n,r){const i=this.state.geom.getAttribute(Fye);for(let l=0;l<e.config.facesByCol;l++)for(let c=0;c<e.config.facesByRow;c++){const s=e.col*e.config.facesByCol+l,p=e.row*e.config.facesByRow+c,y=p===0,_=p===this.SPHERE_HORIZONTAL_SEGMENTS-1;let w;if(y?w=s*qa:_?w=this.NB_VERTICES-this.SPHERE_SEGMENTS*qa+s*qa:w=this.SPHERE_SEGMENTS*qa+(p-1)*this.SPHERE_SEGMENTS*M0+s*M0,r&&this.state.faces[w]>lO||this.state.faces[w]>e.config.level)continue;this.state.faces[w]=r?lO:e.config.level;const S=this.state.geom.groups.find(L=>L.start===w).materialIndex;this.state.materials[S]=n;const M=1-c/e.config.facesByRow,I=1-(c+1)/e.config.facesByRow,D=l/e.config.facesByCol,R=(l+1)/e.config.facesByCol;y?(i.setXY(w,(D+R)/2,M),i.setXY(w+1,D,I),i.setXY(w+2,R,I)):_?(i.setXY(w,R,M),i.setXY(w+1,D,M),i.setXY(w+2,(D+R)/2,I)):(i.setXY(w,R,M),i.setXY(w+1,D,M),i.setXY(w+2,R,I),i.setXY(w+3,D,M),i.setXY(w+4,D,I),i.setXY(w+5,R,I))}i.needsUpdate=!0}__switchMesh(e){const[,n]=W1(e);if(this.__cleanup(),this.state.materials=n.material,this.state.geom=n.geometry,this.config.debug){const r=Lye(this.state.geom);this.viewer.renderer.addObject(r),this.viewer.renderer.setSphereCorrection(this.viewer.config.sphereCorrection,r)}setTimeout(()=>this.__refresh())}__cleanup(){this.queue.clear(),this.state.tiles={},this.state.faces={},this.state.materials=[],this.state.inTransition=!1}};ES.id="equirectangular-tiles";ES.VERSION="5.13.4";ES.supportsDownload=!1;var U$=ES;/*!
 * Photo Sphere Viewer / Virtual Tour Plugin 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var Uye=Object.defineProperty,$ye=(t,e)=>{for(var n in e)Uye(t,n,{get:e[n],enumerable:!0})},Vye={};$ye(Vye,{EnterArrowEvent:()=>W$,LeaveArrowEvent:()=>Z$,NodeChangedEvent:()=>j$});var $$=class V$ extends wx{constructor(e,n){super(V$.type),this.node=e,this.data=n}};$$.type="node-changed";var j$=$$,H$=class G$ extends wx{constructor(e,n){super(G$.type),this.link=e,this.node=n}};H$.type="enter-arrow";var W$=H$,q$=class X$ extends wx{constructor(e,n){super(X$.type),this.link=e,this.node=n}};q$.type="leave-arrow";var Z$=q$,jye=class extends Zs{constructor(t=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new gi(.5,.5),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&e.element.parentNode!==null&&e.element.remove()})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this.center=t.center,this}},mv=new At,cO=new Pi,uO=new Pi,hO=new At,dO=new At,Hye=class{constructor(t={}){const e=this;let n,r,i,l;const c={objects:new WeakMap},s=t.element!==void 0?t.element:document.createElement("div");s.style.overflow="hidden",this.domElement=s,this.getSize=function(){return{width:n,height:r}},this.render=function(M,I){M.matrixWorldAutoUpdate===!0&&M.updateMatrixWorld(),I.parent===null&&I.matrixWorldAutoUpdate===!0&&I.updateMatrixWorld(),cO.copy(I.matrixWorldInverse),uO.multiplyMatrices(I.projectionMatrix,cO),y(M,M,I),S(M)},this.setSize=function(M,I){n=M,r=I,i=n/2,l=r/2,s.style.width=M+"px",s.style.height=I+"px"};function p(M){M.isCSS2DObject&&(M.element.style.display="none");for(let I=0,D=M.children.length;I<D;I++)p(M.children[I])}function y(M,I,D){if(M.visible===!1){p(M);return}if(M.isCSS2DObject){mv.setFromMatrixPosition(M.matrixWorld),mv.applyMatrix4(uO);const R=mv.z>=-1&&mv.z<=1&&M.layers.test(D.layers)===!0,L=M.element;L.style.display=R===!0?"":"none",R===!0&&(M.onBeforeRender(e,I,D),L.style.transform="translate("+-100*M.center.x+"%,"+-100*M.center.y+"%)translate("+(mv.x*i+i)+"px,"+(-mv.y*l+l)+"px)",L.parentNode!==s&&s.appendChild(L),M.onAfterRender(e,I,D));const V={distanceToCameraSquared:_(D,M)};c.objects.set(M,V)}for(let R=0,L=M.children.length;R<L;R++)y(M.children[R],I,D)}function _(M,I){return hO.setFromMatrixPosition(M.matrixWorld),dO.setFromMatrixPosition(I.matrixWorld),hO.distanceToSquared(dO)}function w(M){const I=[];return M.traverseVisible(function(D){D.isCSS2DObject&&I.push(D)}),I}function S(M){const I=w(M).sort(function(R,L){if(R.renderOrder!==L.renderOrder)return L.renderOrder-R.renderOrder;const V=c.objects.get(R).distanceToCameraSquared,B=c.objects.get(L).distanceToCameraSquared;return V-B}),D=I.length;for(let R=0,L=I.length;R<L;R++)I[R].element.style.zIndex=D-R}}},fO=new At,Gye=new Sp,pO=new At,Wye=class extends Zs{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof n.element.ownerDocument.defaultView.Element&&n.element.parentNode!==null&&n.element.remove()})})}copy(e,n){return super.copy(e,n),this.element=e.element.cloneNode(!0),this}},fh=new Pi,qye=new Pi,Xye=class{constructor(e={}){const n=this;let r,i,l,c;const s={camera:{style:""},objects:new WeakMap},p=e.element!==void 0?e.element:document.createElement("div");p.style.overflow="hidden",this.domElement=p;const y=document.createElement("div");y.style.transformOrigin="0 0",y.style.pointerEvents="none",p.appendChild(y);const _=document.createElement("div");_.style.transformStyle="preserve-3d",y.appendChild(_),this.getSize=function(){return{width:r,height:i}},this.render=function(R,L){const V=L.projectionMatrix.elements[5]*c;L.view&&L.view.enabled?(y.style.transform=`translate( ${-L.view.offsetX*(r/L.view.width)}px, ${-L.view.offsetY*(i/L.view.height)}px )`,y.style.transform+=`scale( ${L.view.fullWidth/L.view.width}, ${L.view.fullHeight/L.view.height} )`):y.style.transform="",R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld(),L.parent===null&&L.matrixWorldAutoUpdate===!0&&L.updateMatrixWorld();let B,H;L.isOrthographicCamera&&(B=-(L.right+L.left)/2,H=(L.top+L.bottom)/2);const q=L.view&&L.view.enabled?L.view.height/L.view.fullHeight:1,X=L.isOrthographicCamera?`scale( ${q} )scale(`+V+")translate("+w(B)+"px,"+w(H)+"px)"+S(L.matrixWorldInverse):`scale( ${q} )translateZ(`+V+"px)"+S(L.matrixWorldInverse),se=(L.isPerspectiveCamera?"perspective("+V+"px) ":"")+X+"translate("+l+"px,"+c+"px)";s.camera.style!==se&&(_.style.transform=se,s.camera.style=se),D(R,R,L)},this.setSize=function(R,L){r=R,i=L,l=r/2,c=i/2,p.style.width=R+"px",p.style.height=L+"px",y.style.width=R+"px",y.style.height=L+"px",_.style.width=R+"px",_.style.height=L+"px"};function w(R){return Math.abs(R)<1e-10?0:R}function S(R){const L=R.elements;return"matrix3d("+w(L[0])+","+w(-L[1])+","+w(L[2])+","+w(L[3])+","+w(L[4])+","+w(-L[5])+","+w(L[6])+","+w(L[7])+","+w(L[8])+","+w(-L[9])+","+w(L[10])+","+w(L[11])+","+w(L[12])+","+w(-L[13])+","+w(L[14])+","+w(L[15])+")"}function M(R){const L=R.elements;return"translate(-50%,-50%)"+("matrix3d("+w(L[0])+","+w(L[1])+","+w(L[2])+","+w(L[3])+","+w(-L[4])+","+w(-L[5])+","+w(-L[6])+","+w(-L[7])+","+w(L[8])+","+w(L[9])+","+w(L[10])+","+w(L[11])+","+w(L[12])+","+w(L[13])+","+w(L[14])+","+w(L[15])+")")}function I(R){R.isCSS3DObject&&(R.element.style.display="none");for(let L=0,V=R.children.length;L<V;L++)I(R.children[L])}function D(R,L,V,B){if(R.visible===!1){I(R);return}if(R.isCSS3DObject){const H=R.layers.test(V.layers)===!0,q=R.element;if(q.style.display=H===!0?"":"none",H===!0){R.onBeforeRender(n,L,V);let X;R.isCSS3DSprite?(fh.copy(V.matrixWorldInverse),fh.transpose(),R.rotation2D!==0&&fh.multiply(qye.makeRotationZ(R.rotation2D)),R.matrixWorld.decompose(fO,Gye,pO),fh.setPosition(fO),fh.scale(pO),fh.elements[3]=0,fh.elements[7]=0,fh.elements[11]=0,fh.elements[15]=1,X=M(fh)):X=M(R.matrixWorld);const ee=s.objects.get(R);if(ee===void 0||ee.style!==X){q.style.transform=X;const se={style:X};s.objects.set(R,se)}q.parentNode!==_&&_.appendChild(q),R.onAfterRender(n,L,V)}}for(let H=0,q=R.children.length;H<q;H++)D(R.children[H],L,V)}}},Zye=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
    <path fill-rule="even-odd" fill="currentColor" d="
        M50,50 m45,0
        a45,45 0 1,0 -90,0
        a45,45 0 1,0  90,0

        M50,50 m38,0
        a38,38 0 0,1 -76,0
        a38,38 0 0,1  76,0

        M50,50 m30,0
        a30,30 0 1,0 -60,0
        a30,30 0 1,0  60,0
        
        M50,40 m2.5,-2.5
        l17.5,17.5
        a 2.5,2.5 0 0 1 -5,5
        l-15,-15
        l-15,15
        a 2.5,2.5 0 0 1 -5,-5
        l17.5,-17.5
        a 3.5,3.5 0 0 1 5,0
    "/>
</svg>`,hw="tourLink",gv="__tour-link__",Yye={className:"psv-virtual-tour-tooltip",content:'<div class="psv-virtual-tour-loader"><div></div><div></div><div></div></div>'},Kye={element:()=>{const t=document.createElement("button");return t.className="psv-virtual-tour-arrow",t.innerHTML=Zye,t},size:{width:80,height:80}},CE="arrow",Jye=class extends Mp{constructor(t,e){super(t,{className:"psv-virtual-tour-arrows"}),this.plugin=e,this.renderer=this.is3D?new Xye({element:this.container}):new Hye({element:this.container}),this.camera=this.is3D?new Nl(30,1):null,this.scene=new nw,this.viewer.addEventListener(nr.ReadyEvent.type,this,{once:!0}),this.viewer.addEventListener(nr.PositionUpdatedEvent.type,this),this.viewer.addEventListener(nr.SizeUpdatedEvent.type,this),this.viewer.addEventListener(nr.RenderEvent.type,this),this.viewer.addEventListener(nr.ClickEvent.type,this),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("contextmenu",n=>n.preventDefault())}get is3D(){return this.plugin.is3D}get arrowsPosition(){return this.plugin.config.arrowsPosition}get arrowStyle(){return this.plugin.config.arrowStyle}init(){this.is3D&&(this.gallery=this.viewer.getPlugin("gallery"),this.gallery?.addEventListener("show-gallery",this),this.gallery?.addEventListener("hide-gallery",this))}destroy(){this.viewer.removeEventListener(nr.ReadyEvent.type,this),this.viewer.removeEventListener(nr.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(nr.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(nr.RenderEvent.type,this),this.viewer.removeEventListener(nr.ClickEvent.type,this),this.gallery?.removeEventListener("show-gallery",this),this.gallery?.removeEventListener("hide-gallery",this),super.destroy()}handleEvent(t){switch(t.type){case nr.ReadyEvent.type:case nr.SizeUpdatedEvent.type:case nr.PositionUpdatedEvent.type:this.__updateCamera();break;case nr.RenderEvent.type:this.render();break;case nr.ClickEvent.type:{if(t.data.rightclick)break;const e=this.__getTargetLink(t.data.target,!0);e&&this.plugin.setCurrentNode(e.nodeId,null,e);break}case"mouseenter":{const e=this.__getTargetLink(Qn.getEventTarget(t));e&&this.plugin.__onEnterArrow(e,t);break}case"mouseleave":{const e=this.__getTargetLink(Qn.getEventTarget(t));e&&this.plugin.__onLeaveArrow(e);break}case"mousemove":{this.__getTargetLink(Qn.getEventTarget(t),!0)&&this.plugin.__onHoverArrow(t);break}case"hide-gallery":this.__onToggleGallery(!1);break;case"show-gallery":t.fullscreen||this.__onToggleGallery(!0);break}}__updateCamera(){const t=this.viewer.getSize();if(this.renderer.setSize(t.width,t.height),this.is3D){const e=this.viewer.getPosition();e.pitch=Wr.clamp(e.pitch,-this.arrowsPosition.maxPitch,-this.arrowsPosition.minPitch),this.viewer.dataHelper.sphericalCoordsToVector3(e,this.camera.position,t.height*2).negate(),this.camera.lookAt(0,0,0),this.camera.translateY(t.height/3),this.camera.updateProjectionMatrix()}}render(){if(this.is3D){const t=this.viewer.getPosition(),e=[];let n=Number.MAX_SAFE_INTEGER;this.scene.children.forEach(r=>{const i=r.userData[CE];if(i.conflict){const l=Math.abs(Qn.getShortestArc(t.yaw,i.yaw));n=Math.min(n,l),e.push([r,l])}}),e.forEach(([r,i])=>{const l=i!==n;r.element.style.opacity=l?"0.5":null,r.element.style.zIndex=l?"-1":null}),this.renderer.render(this.scene,this.camera)}else this.renderer.render(this.scene,this.viewer.renderer.camera)}clear(){this.scene.clear()}__buildArrowElement(t,e){if(e?.image){const n=document.createElement("img");return n.src=e.image,n}else if(e?.element)return typeof e.element=="function"?e.element(t):e.element}addLinkArrow(t,e,n=1){let r=this.__buildArrowElement(t,t.arrowStyle);r||(r=this.__buildArrowElement(t,this.arrowStyle)),r[hw]=t;const i={...this.arrowStyle,...t.arrowStyle};if(r.classList.add("psv-virtual-tour-link"),i.className&&Qn.addClasses(r,i.className),i.style&&Object.assign(r.style,i.style),this.is3D){r.style.width=i.size.width*1.5+"px",r.style.height=i.size.height*1.5+"px";let l=!1;this.scene.children.forEach(s=>{const p=s.userData[CE];Math.abs(Qn.getShortestArc(p.yaw,e.yaw))<this.arrowsPosition.linkOverlapAngle&&(p.conflict=!0,l=!0)});const c=new Wye(r);c.userData[CE]={yaw:e.yaw,conflict:l},c.rotation.set(-Math.PI/2,0,Math.PI-e.yaw),this.viewer.dataHelper.sphericalCoordsToVector3({yaw:e.yaw,pitch:0},c.position,n*100),this.scene.add(c)}else{r.style.width=i.size.width+"px",r.style.height=i.size.height+"px",r.style.pointerEvents="auto";const l=new jye(r);this.viewer.dataHelper.sphericalCoordsToVector3(e,l.position),this.scene.add(l)}}__getTargetLink(t,e=!1){const n=e?Qn.getClosest(t,".psv-virtual-tour-link"):t;return n?n[hw]:void 0}__onToggleGallery(t){t?this.container.style.marginBottom=this.viewer.container.querySelector(".psv-gallery").offsetHeight+"px":this.container.style.marginBottom=""}},Y$=class{constructor(t,e){this.plugin=t,this.viewer=e,this.nodes={}}destroy(){}checkNode(t){if(!t.id)throw new jn("No id given for node");if(!t.panorama)throw new jn(`No panorama provided for node ${t.id}`);if(this.plugin.isGps&&!(t.gps?.length>=2))throw new jn(`No GPS position provided for node ${t.id}`);if(!this.plugin.isGps&&t.markers?.some(e=>e.gps&&!e.position))throw new jn("Cannot use GPS positioning for markers in manual mode");t.links||(Qn.logWarn(`Node ${t.id} has no links`),t.links=[])}checkLink(t,e){if(!e.nodeId)throw new jn(`Link of node ${t.id} has no target id`);if(e.nodeId===t.id)throw new jn(`Node ${t.id} links to itself`);if(!this.plugin.isGps&&!Qn.isExtendedPosition(e.position))throw new jn(`No position provided for link ${e.nodeId} of node ${t.id}`);if(this.plugin.isGps&&!e.gps)throw new jn(`No GPS position provided for link ${e.nodeId} of node ${t.id}`)}},Qye=class extends Y${async loadNode(t){if(this.nodes[t])return this.nodes[t];throw new jn(`Node ${t} not found`)}setNodes(t){if(!t?.length)throw new jn("No nodes provided");const e={},n={};t.forEach(r=>{if(this.checkNode(r),e[r.id])throw new jn(`Duplicate node ${r.id}`);e[r.id]=r}),t.forEach(r=>{this.__checkLinks(r,e),r.links.forEach(i=>{n[i.nodeId]=!0})}),t.forEach(r=>{n[r.id]||Qn.logWarn(`Node ${r.id} is never linked to`)}),this.nodes=e}updateNode(t){if(!t.id)throw new jn("No id given for node");const e=this.nodes[t.id];if(!e)throw new jn(`Node ${t.id} does not exist`);return Object.assign(e,t),this.checkNode(e),this.__checkLinks(e,this.nodes),e}__checkLinks(t,e){t.links.forEach(n=>{if(!e[n.nodeId])throw new jn(`Target node ${n.nodeId} of node ${t.id} does not exists`);n.gps=n.gps||e[n.nodeId].gps,this.checkLink(t,n)})}},e0e=class extends Y${constructor(t,e){if(super(t,e),!t.config.getNode)throw new jn("Missing getNode() option.");this.nodeResolver=t.config.getNode}async loadNode(t){if(this.nodes[t])return this.nodes[t];{const e=await this.nodeResolver(t);return this.checkNode(e),e.links.forEach(n=>{this.checkLink(e,n)}),this.nodes[t]=e,e}}clearCache(){this.nodes={}}};function mO(t,e){const n=gO(t),r=gO(e),i=t[2]??0,l=e[2]??0;let c=0;return i!==l&&(c=Math.atan((l-i)/t0e(n,r))),{yaw:n0e(n,r),pitch:c}}function gO(t){return[Wr.degToRad(t[0]),Wr.degToRad(t[1])]}function t0e(t,e){return Qn.greatArcDistance(t,e)*6371e3}function n0e(t,e){const[n,r]=t,[i,l]=e,c=Math.sin(i-n)*Math.cos(l),s=Math.cos(r)*Math.sin(l)-Math.sin(r)*Math.cos(l)*Math.cos(i-n);return Math.atan2(c,s)}var kI=Qn.getConfigParser({dataMode:"client",positionMode:"manual",renderMode:"3d",nodes:null,getNode:null,startNodeId:null,preload:!1,transitionOptions:{showLoader:!0,speed:"20rpm",effect:"fade",rotation:!0},linksOnCompass:!0,showLinkTooltip:!0,getLinkTooltip:null,arrowStyle:Kye,arrowsPosition:{minPitch:.3,maxPitch:Math.PI/2,linkOverlapAngle:Math.PI/4,linkPitchOffset:-.1},map:null},{dataMode(t){if(t!=="client"&&t!=="server")throw new jn("VirtualTourPlugin: invalid dataMode");return t},positionMode(t){if(t!=="gps"&&t!=="manual")throw new jn("VirtualTourPlugin: invalid positionMode");return t},renderMode(t){if(t!=="3d"&&t!=="2d")throw new jn("VirtualTourPlugin: invalid renderMode");return t},arrowsPosition(t,{defValue:e}){return{...e,...t}},arrowStyle(t,{defValue:e}){return{...e,...t}},map(t,{rawConfig:e}){if(t){if(e.dataMode==="server")return Qn.logWarn("VirtualTourPlugin: The map cannot be used in server side mode"),null;if(!t.imageUrl)return Qn.logWarn('VirtualTourPlugin: configuring the map requires at least "imageUrl"'),null}return t}}),Cx=class K$ extends II{constructor(e,n){super(e,n),this.state={currentNode:null,currentTooltip:null,loadingNode:null,preload:{}},this.arrowsRenderer=new Jye(this.viewer,this)}get is3D(){return this.config.renderMode==="3d"}get isServerSide(){return this.config.dataMode==="server"}get isGps(){return this.config.positionMode==="gps"}static withConfig(e){return[K$,e]}init(){super.init(),this.arrowsRenderer.init(),Qn.checkStylesheet(this.viewer.container,"virtual-tour-plugin"),this.markers=this.viewer.getPlugin("markers"),this.compass=this.viewer.getPlugin("compass"),this.markers?.config.markers&&(Qn.logWarn("No default markers can be configured on the MarkersPlugin when using the VirtualTourPlugin. Consider defining `markers` on each tour node."),delete this.markers.config.markers),this.isGps&&(this.plan=this.viewer.getPlugin("plan")),this.isServerSide||(this.gallery=this.viewer.getPlugin("gallery"),this.map=this.viewer.getPlugin("map"),this.config.map&&!this.map&&Qn.logWarn("The map is configured on the VirtualTourPlugin but the MapPlugin is not loaded.")),this.datasource=this.isServerSide?new e0e(this,this.viewer):new Qye(this,this.viewer),this.map&&(this.map.addEventListener("select-hotspot",this),this.map.setImage(this.config.map.imageUrl)),this.plan?.addEventListener("select-hotspot",this),this.isServerSide?this.config.startNodeId&&this.setCurrentNode(this.config.startNodeId):this.config.nodes&&(this.setNodes(this.config.nodes,this.config.startNodeId),delete this.config.nodes)}destroy(){this.map?.removeEventListener("select-hotspot",this),this.plan?.removeEventListener("select-hotspot",this),this.datasource.destroy(),this.arrowsRenderer.destroy(),delete this.datasource,delete this.markers,delete this.compass,delete this.gallery,delete this.arrowsRenderer,super.destroy()}handleEvent(e){if(e instanceof nr.ClickEvent){const n=e.data.objects.find(r=>r.userData[hw])?.userData[hw];n&&this.setCurrentNode(n.nodeId,null,n)}else if(e.type==="select-hotspot"){const n=e.hotspotId;n.startsWith(gv)&&this.setCurrentNode(n.substring(gv.length))}}getCurrentNode(){return this.state.currentNode}setNodes(e,n){if(this.isServerSide)throw new jn("Cannot set nodes in server side mode");this.__hideTooltip(),this.state.currentNode=null,this.datasource.setNodes(e),n?this.datasource.nodes[n]||(n=e[0].id,Qn.logWarn(`startNodeId not found is provided nodes, resetted to ${n}`)):n=e[0].id,this.setCurrentNode(n),this.__setGalleryItems(),this.__setMapHotspots(),this.__setPlanHotspots()}setCurrentNode(e,n,r){if(e===this.state.currentNode?.id&&!n?.forceUpdate)return Promise.resolve(!0);n?.forceUpdate&&this.isServerSide&&this.datasource.clearCache(),this.viewer.hideError(),this.state.loadingNode=e;const i=this.state.currentNode,l=i&&r?this.__getLinkPosition(i,r):null;return Promise.resolve(this.state.preload[e]).then(()=>{if(this.state.loadingNode!==e)throw Qn.getAbortError();return this.datasource.loadNode(e)}).then(c=>{if(this.state.loadingNode!==e)throw Qn.getAbortError();const s={...kI.defaults.transitionOptions,rotateTo:l,zoomTo:l?this.viewer.getZoomLevel():null,...typeof this.config.transitionOptions=="function"?this.config.transitionOptions(c,i,r):this.config.transitionOptions,...n};return s.effect||(s.effect="none"),this.viewer.panel.hide("description"),this.__hideTooltip(),this.arrowsRenderer.clear(),this.gallery?.config.hideOnClick&&this.gallery.hide(),this.map?.config.minimizeOnHotspotClick&&this.map.minimize(),this.plan?.config.minimizeOnHotspotClick&&this.plan.minimize(),s.rotation&&s.effect==="none"?this.viewer.animate({...s.rotateTo,zoom:s.zoomTo,speed:s.speed}).then(()=>[c,s]):Promise.resolve([c,s])}).then(([c,s])=>{if(this.state.loadingNode!==e)throw Qn.getAbortError();return this.markers?.clearMarkers(),this.config.linksOnCompass&&this.compass?.clearHotspots(),this.viewer.setPanorama(c.panorama,{caption:c.caption,description:c.description,panoData:c.panoData,sphereCorrection:c.sphereCorrection,showLoader:s.showLoader,position:s.rotateTo,zoom:s.zoomTo,transition:s.effect==="none"?!1:{effect:s.effect,rotation:s.rotation,speed:s.speed}}).then(p=>{if(!p)throw Qn.getAbortError();return c})}).then(c=>{if(this.state.loadingNode!==e)throw Qn.getAbortError();return this.state.currentNode=c,this.map&&this.map.setCenter(this.__getNodeMapPosition(c)??this.map.config.center),this.plan?.setCoordinates(c.gps),this.__addNodeMarkers(c),this.__renderLinks(c),this.__preload(c),this.state.loadingNode=null,this.dispatchEvent(new j$(c,{fromNode:i,fromLink:r,fromLinkPosition:l})),this.viewer.resetIdleTimer(),!0}).catch(c=>{if(Qn.isAbortError(c))return!1;throw this.viewer.showError(this.viewer.config.lang.loadError),this.viewer.loader.hide(),this.viewer.navbar.setCaption(""),this.state.loadingNode=null,c})}async gotoLink(e,n="8rpm"){const r=this.getLinkPosition(e);n?await this.viewer.animate({...r,speed:n}):this.viewer.rotate(r)}getLinkPosition(e){const n=this.state.currentNode?.links.find(r=>r.nodeId===e);if(!n)throw new jn(`Cannot find link "${e}"`);return this.__getLinkPosition(this.state.currentNode,n)}updateNode(e){if(this.isServerSide)throw new jn("Cannot update node in server side mode");const n=this.datasource.updateNode(e);if((e.name||e.thumbnail||e.panorama)&&this.__setGalleryItems(),(e.name||e.gps||e.map)&&this.__setMapHotspots(),(e.name||e.gps||e.plan)&&this.__setPlanHotspots(),this.state.currentNode?.id===n.id){if(this.__hideTooltip(),e.panorama||e.panoData||e.sphereCorrection){this.setCurrentNode(n.id,{forceUpdate:!0});return}e.caption&&this.viewer.setOption("caption",n.caption),e.description&&this.viewer.setOption("description",n.description),(e.links||e.gps)&&this.__renderLinks(n),e.gps&&this.plan?.setCoordinates(n.gps),(e.map||e.gps)&&this.map?.setCenter(this.__getNodeMapPosition(n)),(e.markers||e.gps)&&this.__addNodeMarkers(n)}}__setGalleryItems(){this.gallery&&this.gallery.setItems(Object.values(this.datasource.nodes).filter(e=>e.showInGallery!==!1).map(e=>({id:e.id,panorama:e.panorama,name:e.name,thumbnail:e.thumbnail})),e=>{this.setCurrentNode(e)})}__setMapHotspots(){this.map&&this.map.setHotspots(Object.values(this.datasource.nodes).filter(e=>e.map!==!1).map(e=>({tooltip:e.name,...e.map||{},...this.__getNodeMapPosition(e),id:gv+e.id})))}__setPlanHotspots(){this.plan&&this.plan.setHotspots(Object.values(this.datasource.nodes).filter(e=>e.plan!==!1).map(e=>({tooltip:e.name,...e.plan||{},coordinates:e.gps,id:gv+e.id})))}__renderLinks(e){this.arrowsRenderer.clear();const n=[];e.links.forEach(r=>{const i=this.__getLinkPosition(e,r);i.yaw+=r.linkOffset?.yaw??0,i.pitch+=r.linkOffset?.pitch??0,this.isGps&&!this.is3D&&(i.pitch+=this.config.arrowsPosition.linkPitchOffset),n.push(i),this.arrowsRenderer.addLinkArrow(r,i,r.linkOffset?.depth)}),this.arrowsRenderer.render(),this.config.linksOnCompass&&this.compass?.setHotspots(n)}__getLinkPosition(e,n){return this.isGps?mO(e.gps,n.gps):this.viewer.dataHelper.cleanPosition(n.position)}async __getTooltipContent(e){const n=await this.datasource.loadNode(e.nodeId),r=[];(n.name||n.thumbnail||n.caption)&&(n.name&&r.push(`<h3>${n.name}</h3>`),n.thumbnail&&r.push(`<img src="${n.thumbnail}">`),n.caption&&r.push(`<p>${n.caption}</p>`));let i=r.join("");return this.config.getLinkTooltip&&(i=this.config.getLinkTooltip(i,e,n)),i}__onEnterArrow(e,n){const r=Qn.getPosition(this.viewer.container),i={x:n.clientX-r.x,y:n.clientY-r.y};this.config.showLinkTooltip&&(this.state.currentTooltip=this.viewer.createTooltip({...Yye,left:i.x,top:i.y,box:{width:20,height:20}}),this.__getTooltipContent(e).then(l=>{l?this.state.currentTooltip.update(l):this.__hideTooltip()})),this.map?.setActiveHotspot(gv+e.nodeId),this.plan?.setActiveHotspot(gv+e.nodeId),this.dispatchEvent(new W$(e,this.state.currentNode))}__onHoverArrow(e){const n=Qn.getPosition(this.viewer.container),r={x:e.clientX-n.x,y:e.clientY-n.y};this.state.currentTooltip?.move({left:r.x,top:r.y})}__onLeaveArrow(e){this.__hideTooltip(),this.map?.setActiveHotspot(null),this.plan?.setActiveHotspot(null),this.dispatchEvent(new Z$(e,this.state.currentNode))}__hideTooltip(){this.state.currentTooltip?.hide(),this.state.currentTooltip=null}__preload(e){this.config.preload&&(this.state.preload[e.id]=!0,this.state.currentNode.links.filter(n=>!this.state.preload[n.nodeId]).filter(n=>typeof this.config.preload=="function"?this.config.preload(this.state.currentNode,n):!0).forEach(n=>{this.state.preload[n.nodeId]=this.datasource.loadNode(n.nodeId).then(r=>this.viewer.textureLoader.preloadPanorama(r.panorama)).then(()=>{this.state.preload[n.nodeId]=!0}).catch(()=>{delete this.state.preload[n.nodeId]})}))}__addNodeMarkers(e){e.markers&&(this.markers?this.markers.setMarkers(e.markers.map(n=>(n.gps&&this.isGps&&(n.position=mO(e.gps,n.gps),n.data?.map&&Object.assign(n.data.map,this.__getGpsMapPosition(n.gps)),n.data?.plan&&(n.data.plan.coordinates=n.gps)),n))):Qn.logWarn(`Node ${e.id} markers ignored because the plugin is not loaded.`))}__getNodeMapPosition(e){const n=this.__getGpsMapPosition(e.gps);return n||(e.map?{x:e.map.x,y:e.map.y}:null)}__getGpsMapPosition(e){const n=this.config.map;return this.isGps&&n&&n.extent&&n.size?{x:Wr.mapLinear(e[0],n.extent[0],n.extent[2],0,n.size.width),y:Wr.mapLinear(e[1],n.extent[1],n.extent[3],0,n.size.height)}:null}};Cx.id="virtual-tour";Cx.VERSION="5.13.4";Cx.configParser=kI;Cx.readonlyOptions=Object.keys(kI.defaults);var u_=Cx;function vO(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function r0e(t){if(Array.isArray(t))return t}function i0e(t,e,n){return(e=l0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o0e(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,l,c,s=[],p=!0,y=!1;try{if(l=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;p=!1}else for(;!(p=(r=l.call(n)).done)&&(s.push(r.value),s.length!==e);p=!0);}catch(_){y=!0,i=_}finally{try{if(!p&&n.return!=null&&(c=n.return(),Object(c)!==c))return}finally{if(y)throw i}}return s}}function s0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yO(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function vP(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yO(Object(n),!0).forEach(function(r){i0e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yO(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Sv(t,e){return r0e(t)||o0e(t,e)||c0e(t,e)||s0e()}function a0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l0e(t){var e=a0e(t,"string");return typeof e=="symbol"?e:e+""}function dw(t){"@babel/helpers - typeof";return dw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dw(t)}function c0e(t,e){if(t){if(typeof t=="string")return vO(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vO(t,e):void 0}}function u0e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var J$={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(p,y,_){this.fn=p,this.context=y,this.once=_||!1}function l(p,y,_,w,S){if(typeof _!="function")throw new TypeError("The listener must be a function");var M=new i(_,w||p,S),I=n?n+y:y;return p._events[I]?p._events[I].fn?p._events[I]=[p._events[I],M]:p._events[I].push(M):(p._events[I]=M,p._eventsCount++),p}function c(p,y){--p._eventsCount===0?p._events=new r:delete p._events[y]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var y=[],_,w;if(this._eventsCount===0)return y;for(w in _=this._events)e.call(_,w)&&y.push(n?w.slice(1):w);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(_)):y},s.prototype.listeners=function(y){var _=n?n+y:y,w=this._events[_];if(!w)return[];if(w.fn)return[w.fn];for(var S=0,M=w.length,I=new Array(M);S<M;S++)I[S]=w[S].fn;return I},s.prototype.listenerCount=function(y){var _=n?n+y:y,w=this._events[_];return w?w.fn?1:w.length:0},s.prototype.emit=function(y,_,w,S,M,I){var D=n?n+y:y;if(!this._events[D])return!1;var R=this._events[D],L=arguments.length,V,B;if(R.fn){switch(R.once&&this.removeListener(y,R.fn,void 0,!0),L){case 1:return R.fn.call(R.context),!0;case 2:return R.fn.call(R.context,_),!0;case 3:return R.fn.call(R.context,_,w),!0;case 4:return R.fn.call(R.context,_,w,S),!0;case 5:return R.fn.call(R.context,_,w,S,M),!0;case 6:return R.fn.call(R.context,_,w,S,M,I),!0}for(B=1,V=new Array(L-1);B<L;B++)V[B-1]=arguments[B];R.fn.apply(R.context,V)}else{var H=R.length,q;for(B=0;B<H;B++)switch(R[B].once&&this.removeListener(y,R[B].fn,void 0,!0),L){case 1:R[B].fn.call(R[B].context);break;case 2:R[B].fn.call(R[B].context,_);break;case 3:R[B].fn.call(R[B].context,_,w);break;case 4:R[B].fn.call(R[B].context,_,w,S);break;default:if(!V)for(q=1,V=new Array(L-1);q<L;q++)V[q-1]=arguments[q];R[B].fn.apply(R[B].context,V)}}return!0},s.prototype.on=function(y,_,w){return l(this,y,_,w,!1)},s.prototype.once=function(y,_,w){return l(this,y,_,w,!0)},s.prototype.removeListener=function(y,_,w,S){var M=n?n+y:y;if(!this._events[M])return this;if(!_)return c(this,M),this;var I=this._events[M];if(I.fn)I.fn===_&&(!S||I.once)&&(!w||I.context===w)&&c(this,M);else{for(var D=0,R=[],L=I.length;D<L;D++)(I[D].fn!==_||S&&!I[D].once||w&&I[D].context!==w)&&R.push(I[D]);R.length?this._events[M]=R.length===1?R[0]:R:c(this,M)}return this},s.prototype.removeAllListeners=function(y){var _;return y?(_=n?n+y:y,this._events[_]&&c(this,_)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s})(J$);var h0e=J$.exports,d0e=u0e(h0e),X1=new d0e,Xa={on:function(e,n){return X1.on(e,n)},once:function(e,n){return X1.once(e,n)},off:function(e,n){return X1.off(e,n)},emit:function(e,n){return X1.emit(e,n)}};Object.freeze(Xa);var f0e=["src","height","width","hideNavbarButton","containerClass","littlePlanet","onPositionChange","onZoomChange","onClick","onDblclick","onReady"],yP=["zoom","fullscreen"];function p0e(t){var e=vP({},t);for(var n in e)f0e.includes(n)&&delete e[n];return e}function m0e(t,e,n,r,i){return(t-e)*(i-r)/(n-e)+r}function _O(t){return t==null?yP:Array.isArray(t)?t:typeof t=="string"?t===""?!1:[t]:t?yP:!1}function g0e(){var t=G.useState(),e=Sv(t,2),n=e[0],r=e[1],i=G.useCallback(function(l){l&&l!==n&&r(l)},[n]);return[n,i]}var DI=G.forwardRef(function(t,e){var n=g0e(),r=Sv(n,2),i=r[0],l=r[1],c=G.useMemo(function(){return t},[t.panorama,t.src,t.size,t.canvasBackground,t.navbar,t.height,t.width,t.containerClass,t.hideNavbarButton||!0,t.littlePlanet,t.fishEye,t.lang,t.onPositionChange,t.onZoomChange,t.onClick,t.onDblclick,t.onReady,t.moveSpeed,t.zoomSpeed,t.moveInertia,t.mousewheel,t.mousemove,t.mousewheelCtrlKey,t.touchmoveTwoFingers,t.panoData,t.requestHeaders,t.withCredentials,t.keyboard,t.keyboardActions,t.plugins,t.adapter,t.sphereCorrection,t.minFov,t.maxFov,t.defaultZoomLvl,t.defaultYaw,t.defaultPitch,t.caption,t.description,t.downloadUrl,t.downloadName,t.loadingImg,t.loadingTxt,t.rendererParameters,t.defaultTransition]),s=G.useRef(null),p=130,y=G.useState(-90),_=Sv(y,1),w=_[0],S=G.useState(2),M=Sv(S,1),I=M[0],D=G.useState(0),R=Sv(D,1),L=R[0],V=G.useState(yP),B=Sv(V,2),H=B[0],q=B[1],X=G.useRef(!0);G.useEffect(function(){function se(){var J=window.innerWidth/window.innerHeight;p=Math.floor(m0e(J,.5,1.8,140,115))}return window.addEventListener("resize",se),se(),function(){return window.removeEventListener("resize",se)}},[]),G.useEffect(function(){if(i&&!s.current){var se,J,$,le,Ce,we,We,Fe,Me,Ee=new Eye(vP(vP({},p0e(c)),{},{container:i,panorama:c.panorama||c.src,size:{height:c.height,width:c.width||"100px"},fisheye:c.littlePlanet?I:c.fisheye||!1,minFov:(se=c.minFov)!==null&&se!==void 0?se:30,maxFov:c.littlePlanet?p:(J=c.maxFov)!==null&&J!==void 0?J:90,defaultZoomLvl:c.littlePlanet?L:($=c.defaultZoomLvl)!==null&&$!==void 0?$:50,defaultYaw:(le=c.defaultYaw)!==null&&le!==void 0?le:0,defaultPitch:c.littlePlanet?w:(Ce=c.defaultPitch)!==null&&Ce!==void 0?Ce:0,sphereCorrection:c.sphereCorrection||{pan:0,tilt:0,roll:0},moveSpeed:c.moveSpeed||1,zoomSpeed:c.zoomSpeed||1,moveInertia:(we=c.moveInertia)!==null&&we!==void 0?we:!0,mousewheel:c.littlePlanet?!1:(We=c.mousewheel)!==null&&We!==void 0?We:!0,mousemove:(Fe=c.mousemove)!==null&&Fe!==void 0?Fe:!0,mousewheelCtrlKey:c.mousewheelCtrlKey||!1,touchmoveTwoFingers:c.touchmoveTwoFingers||!1,panoData:c.panoData||void 0,requestHeaders:c.requestHeaders||void 0,withCredentials:c.withCredentials||!1,navbar:_O(c.navbar),lang:c.lang||{},keyboard:c.keyboard||"fullscreen",plugins:(Me=c.plugins)!==null&&Me!==void 0?Me:[]}));Ee.addEventListener("ready",function(){c.onReady&&c.onReady(Ee)},{once:!0}),Ee.addEventListener("click",function(je){c.onClick&&c.onClick(je,Ee),c.littlePlanet&&X.current&&(X.current=!1,Ee.animate({yaw:0,pitch:w,zoom:75,speed:"3rpm"}).then(function(){Ee.animate({yaw:0,pitch:0,zoom:90,speed:"10rpm"}).then(function(){var ct;Ee.setOption("maxFov",c.maxFov||70),Ee.setOption("mousewheel",(ct=c.mousewheel)!==null&&ct!==void 0?ct:!0)})}))}),Ee.addEventListener("dblclick",function(je){c.onDblclick&&c.onDblclick(je,Ee)}),Ee.addEventListener("zoom-updated",function(je){c.onZoomChange&&c.onZoomChange(je,Ee)}),Ee.addEventListener("position-updated",function(je){c.onPositionChange&&c.onPositionChange(je.position.pitch,je.position.yaw,Ee)});var Te=_O(c.navbar);if(c.littlePlanet){var Ze,rt,Re=`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 20C16.4183 20 20 16.4183 20 12C20 11.8805 19.9974 11.7615 19.9922 11.6433C20.2479 11.4141 20.4882 11.1864 20.7118 10.9611C21.0037 10.6672 21.002 10.1923 20.708 9.90049C20.4336 9.628 20.0014 9.61143 19.7077 9.84972C19.4023 8.75248 18.8688 7.75024 18.1616 6.89725C18.4607 6.84611 18.7436 6.8084 19.0087 6.784C19.4212 6.74604 19.7247 6.38089 19.6868 5.96842C19.6488 5.55595 19.2837 5.25235 18.8712 5.29032C18.4474 5.32932 17.9972 5.39638 17.5262 5.48921C17.3267 5.52851 17.1614 5.64353 17.0543 5.79852C15.6765 4.67424 13.917 4 12 4C7.58172 4 4 7.58172 4 12C4 12.2776 4.01414 12.552 4.04175 12.8223C3.78987 12.7532 3.50899 12.8177 3.31137 13.0159C2.97651 13.3517 2.67596 13.6846 2.415 14.0113C2.15647 14.3349 2.20924 14.8069 2.53287 15.0654C2.8565 15.3239 3.32843 15.2711 3.58696 14.9475C3.78866 14.695 4.02466 14.4302 4.2938 14.1557C4.60754 15.2796 5.16056 16.3037 5.8945 17.1697C5.66824 17.3368 5.54578 17.6248 5.60398 17.919C5.68437 18.3253 6.07894 18.5896 6.48528 18.5092C6.7024 18.4662 6.92455 18.4177 7.15125 18.3637C8.49656 19.3903 10.1771 20 12 20ZM7.15125 18.3637C6.69042 18.012 6.26891 17.6114 5.8945 17.1697C5.98073 17.106 6.08204 17.0599 6.19417 17.0377C7.19089 16.8405 8.33112 16.5084 9.55581 16.0486C9.94359 15.903 10.376 16.0994 10.5216 16.4872C10.6671 16.8749 10.4708 17.3073 10.083 17.4529C9.05325 17.8395 8.0653 18.1459 7.15125 18.3637ZM19.7077 9.84972C19.6869 9.86663 19.6667 9.88483 19.6474 9.90431C18.9609 10.5957 18.0797 11.3337 17.0388 12.0753C16.7014 12.3157 16.6228 12.784 16.8631 13.1213C17.1035 13.4587 17.5718 13.5373 17.9091 13.297C18.6809 12.7471 19.3806 12.1912 19.9922 11.6433C19.965 11.0246 19.8676 10.4241 19.7077 9.84972ZM20.9366 5.37924C20.5336 5.28378 20.1294 5.53313 20.034 5.93619C19.9385 6.33925 20.1879 6.74339 20.5909 6.83886C20.985 6.93219 21.1368 7.07125 21.1932 7.16142C21.2565 7.26269 21.3262 7.52732 21.0363 8.10938C20.8516 8.48014 21.0025 8.93042 21.3732 9.1151C21.744 9.29979 22.1943 9.14894 22.379 8.77818C22.7566 8.02003 22.9422 7.12886 22.4648 6.36582C22.1206 5.81574 21.5416 5.52252 20.9366 5.37924ZM2.81481 16.2501C2.94057 15.8555 2.72259 15.4336 2.32793 15.3078C1.93327 15.1821 1.51138 15.4 1.38562 15.7947C1.19392 16.3963 1.17354 17.0573 1.53488 17.6349C1.98775 18.3587 2.84153 18.6413 3.68907 18.7224C4.1014 18.7619 4.46765 18.4596 4.50712 18.0473C4.54658 17.635 4.24432 17.2687 3.83199 17.2293C3.13763 17.1628 2.88355 16.9624 2.80651 16.8393C2.75679 16.7598 2.70479 16.5954 2.81481 16.2501ZM15.7504 14.704C16.106 14.4915 16.2218 14.0309 16.0093 13.6754C15.7967 13.3199 15.3362 13.204 14.9807 13.4166C14.4991 13.7045 13.9974 13.9881 13.4781 14.2648C12.9445 14.5491 12.4132 14.8149 11.8883 15.0615C11.5134 15.2376 11.3522 15.6843 11.5283 16.0592C11.7044 16.4341 12.1511 16.5953 12.526 16.4192C13.0739 16.1618 13.6277 15.8847 14.1834 15.5887C14.7242 15.3005 15.2474 15.0048 15.7504 14.704Z" fill="rgba(255,255,255,.7)"/>
                </svg>`,Qe={id:"resetLittlePlanetButton",content:((Ze=t.lang)===null||Ze===void 0?void 0:Ze.littlePlanetIcon)||Re,title:((rt=t.lang)===null||rt===void 0?void 0:rt.littlePlanetButton)||"Reset Little Planet",className:"resetLittlePlanetButton",onClick:function(){X.current=!0,Ee.setOption("maxFov",p),Ee.setOption("mousewheel",!1),Ee.animate({yaw:0,pitch:w,zoom:L,speed:"10rpm"})}};Te!==!1&&!Te.find(function(je){return dw(je)==="object"&&je?.id==="resetLittlePlanetButton"})&&Te.splice(1,0,Qe)}if(c.hideNavbarButton){var Vt={id:"hideNavbarButton",content:`<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="none">
                            <g clip-path="url(#clip0_429_11083)">
                            <path d="M7 7.00006L17 17.0001M7 17.0001L17 7.00006" stroke="rgba(255,255,255,.7)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </g>
                            <defs>
                            <clipPath id="clip0_429_11083">
                            <rect width="24" height="24" fill="white"/>
                            </clipPath>
                            </defs>
                            </svg>`,title:"Hide Navbar",className:"hideNavbarButton",onClick:function(){Ee.navbar.hide();var ct=document.createElement("a");ct.className="showNavbarButton",ct.innerHTML=`<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 26 26" style="enable-background:new 0 0 26 26;" xml:space="preserve" class="icon icon-back-to-top">
                                        <g>
                                        <path d="M13.8,1.3L21.6,9c0.1,0.1,0.1,0.3,0.2,0.4c0.1,0.1,0.1,0.3,0.1,0.4s0,0.3-0.1,0.4c-0.1,0.1-0.1,0.3-0.3,0.4
                                            c-0.1,0.1-0.2,0.2-0.4,0.3c-0.2,0.1-0.3,0.1-0.4,0.1c-0.1,0-0.3,0-0.4-0.1c-0.2-0.1-0.3-0.2-0.4-0.3L14.2,5l0,19.1
                                            c0,0.2-0.1,0.3-0.1,0.5c0,0.1-0.1,0.3-0.3,0.4c-0.1,0.1-0.2,0.2-0.4,0.3c-0.1,0.1-0.3,0.1-0.5,0.1c-0.1,0-0.3,0-0.4-0.1
                                            c-0.1-0.1-0.3-0.1-0.4-0.3c-0.1-0.1-0.2-0.2-0.3-0.4c-0.1-0.1-0.1-0.3-0.1-0.5l0-19.1l-5.7,5.7C6,10.8,5.8,10.9,5.7,11
                                            c-0.1,0.1-0.3,0.1-0.4,0.1c-0.2,0-0.3,0-0.4-0.1c-0.1-0.1-0.3-0.2-0.4-0.3c-0.1-0.1-0.1-0.2-0.2-0.4C4.1,10.2,4,10.1,4.1,9.9
                                            c0-0.1,0-0.3,0.1-0.4c0-0.1,0.1-0.3,0.3-0.4l7.7-7.8c0.1,0,0.2-0.1,0.2-0.1c0,0,0.1-0.1,0.2-0.1c0.1,0,0.2,0,0.2-0.1
                                            c0.1,0,0.1,0,0.2,0c0,0,0.1,0,0.2,0c0.1,0,0.2,0,0.2,0.1c0.1,0,0.1,0.1,0.2,0.1C13.7,1.2,13.8,1.2,13.8,1.3z"></path>
                                        </g>
                                        </svg>`,ct.title="Show Navbar",ct.onclick=function(Ct){Ct.preventDefault(),Ee.navbar.show(),ct.remove()},document.body.appendChild(ct)}};Te!==!1&&!Te.find(function(je){return dw(je)==="object"&&je?.id==="hideNavbarButton"})&&Te.push(Vt)}Te!==!1?(Ee.setOption("navbar",Te),q(Te)):Ee.navbar.hide(),Xa.on("animate",function(je){Ee.animate(je)}).on("stop-animation",function(){Ee.stopAnimation()}).on("destroy",function(){Ee.destroy()}).on("rotate",function(je){Ee.rotate(je)}).on("setOption",function(je){var ct=je.option,Ct=je.value;Ee.setOption(ct,Ct)}).on("setOptions",function(je){Ee.setOptions(je)}).on("zoom",function(je){Ee.zoom(je)}).on("zoomIn",function(je){Ee.zoomIn(je)}).on("zoomOut",function(je){Ee.zoomOut(je)}).on("resize",function(je){Ee.resize(je)}).on("enterFullscreen",function(){Ee.enterFullscreen()}).on("exitFullscreen",function(){Ee.exitFullscreen()}).on("toggleFullscreen",function(){Ee.toggleFullscreen()}).on("needsContinuousUpdate",function(je){Ee.needsContinuousUpdate(je)}).on("observeObjects",function(je){Ee.observeObjects(je)}).on("unobserveObjects",function(je){Ee.unobserveObjects(je)}).on("setCursor",function(je){Ee.setCursor(je)}).on("setPanorama",function(je){Ee.setPanorama(je.path,je.options)}).on("showError",function(je){Ee.showError(je)}).on("hideError",function(){Ee.hideError()}).on("startKeyboardControl",function(){Ee.startKeyboardControl()}).on("stopKeyboardControl",function(){Ee.stopKeyboardControl()}),s.current=Ee}},[i,c]),G.useEffect(function(){var se=s.current;if(se&&se.container&&se.container.parentNode&&se&&se.container&&se.container.parentNode){var J,$,le,Ce;(J=se.renderer)===null||J===void 0||($=J.renderer)===null||$===void 0||$.dispose(),(le=se.renderer)===null||le===void 0||(Ce=le.renderer)===null||Ce===void 0||Ce.forceContextLoss(),se.destroy()}},[s]),G.useEffect(function(){var se,J=(se=c.panorama)!==null&&se!==void 0?se:c.src;s.current&&J&&s.current.setPanorama(J,{})},[c.src,c.panorama]);var ee=function(){return{animate:function($){Xa.emit("animate",$)},destroy:function(){Xa.emit("destroy",{})},createTooltip:function($){var le;return(le=s.current)===null||le===void 0?void 0:le.createTooltip($)},needsContinuousUpdate:function($){Xa.emit("needsContinuousUpdate",$)},observeObjects:function($){Xa.emit("observeObjects",$)},unobserveObjects:function($){Xa.emit("unobserveObjects",$)},setCursor:function($){Xa.emit("setCursor",$)},stopAnimation:function(){Xa.emit("stop-animation",{})},rotate:function($){Xa.emit("rotate",$)},setOption:function($,le){Xa.emit("setOption",{option:$,value:le})},setOptions:function($){var le;return(le=s.current)===null||le===void 0?void 0:le.setOptions($)},getCurrentNavbar:function(){return H},zoom:function($){Xa.emit("zoom",$)},zoomIn:function($){Xa.emit("zoomIn",{step:$})},zoomOut:function($){Xa.emit("zoomOut",{step:$})},resize:function($){var le;return(le=s.current)===null||le===void 0?void 0:le.resize($)},enterFullscreen:function(){var $;return($=s.current)===null||$===void 0?void 0:$.enterFullscreen()},exitFullscreen:function(){var $;return($=s.current)===null||$===void 0?void 0:$.exitFullscreen()},toggleFullscreen:function(){var $;return($=s.current)===null||$===void 0?void 0:$.toggleFullscreen()},isFullscreenEnabled:function(){var $;return($=s.current)===null||$===void 0?void 0:$.isFullscreenEnabled()},getPlugin:function($){var le;return(le=s.current)===null||le===void 0?void 0:le.getPlugin($)},getPosition:function(){var $;return($=s.current)===null||$===void 0?void 0:$.getPosition()},getZoomLevel:function(){var $;return($=s.current)===null||$===void 0?void 0:$.getZoomLevel()},getSize:function(){var $;return($=s.current)===null||$===void 0?void 0:$.getSize()},needsUpdate:function(){var $;return($=s.current)===null||$===void 0?void 0:$.needsUpdate()},autoSize:function(){var $;return($=s.current)===null||$===void 0?void 0:$.autoSize()},setPanorama:function($,le){var Ce;return(Ce=s.current)===null||Ce===void 0?void 0:Ce.setPanorama($,le)},showError:function($){var le;return(le=s.current)===null||le===void 0?void 0:le.showError($)},hideError:function(){var $;return($=s.current)===null||$===void 0?void 0:$.hideError()},startKeyboardControl:function(){var $;return($=s.current)===null||$===void 0?void 0:$.startKeyboardControl()},stopKeyboardControl:function(){var $;return($=s.current)===null||$===void 0?void 0:$.stopKeyboardControl()}}};return G.useImperativeHandle(e,ee,[s.current,i,c,e]),B0.createElement("div",{className:c.containerClass||"view-container",ref:l})});DI.displayName="ReactPhotoSphereViewer";const Q$=t=>{const e=t.getCenter(),n=t.getBearing(),r=t.getPitch(),i=n||r?[n,r]:[];return"#"+[t.getZoom(),e.lat,e.lng,...i].map(c=>Number(c.toFixed(3))).join("/")},fw=[15,90],e8=fw[1]-fw[0],v0e=t=>{const[e,n,r,i="0",l="0"]=t.slice(1).split("/");return{zoom:Number(e),lngLat:[Number(r),Number(n)],bearing:Number(i),pitch:Number(l)}},xO=(t,e)=>{const[n]=e.split("!");if(!n||n===Q$(t))return;const r=v0e(n);t.setZoom(r.zoom),t.setCenter(r.lngLat),t.setBearing(r.bearing),t.setPitch(r.pitch)},y0e=(t,e)=>{const{yaw:n,pitch:r}=t.getPosition(),i=t.getZoomLevel(),l=Number(SL(n).toFixed(2)),c=Number(SL(r).toFixed(2)),s=Number(((1-i/100)*e8+fw[0]).toFixed(2));return"!"+[e,l,c,s].join("/")},_0e=t=>{jm.checkArgument(t.startsWith("!"));const[e,n,r,i]=t.slice(1).split("/");return{id:e,yaw:Number(Bb(Number(n??0)).toFixed(3)),pitch:Number(Bb(Number(r??0)).toFixed(3)),zoom:Math.round((1-(Number(i??0)-fw[0])/e8)*100)}},x0e=[{name:"Trucker Mudgeon",avatarUrl:"https://avatars.githubusercontent.com/u/121829201?v=4"},{name:"San_Sany4",avatarUrl:"https://avatars.githubusercontent.com/u/3860505?v=4"}],b0e=(t,e)=>({width:8192,cols:16,rows:8,baseUrl:`${t}/${e}_thumb.jpg`,tileUrl:(n,r)=>`${t}/${e}_${n}_${r}.jpg`}),w0e=t=>e=>({baseUrl:`${t}/${e}/thumb.jpg`,tileUrl:function(n,r,i=0){return`${t}/${e}/${i}/${n}_${r}.jpg`},width:15520,cols:32,rows:16,levels:[{width:15520/2,cols:32/2,rows:16/2,zoomRange:[0,60]},{width:15520,cols:32,rows:16,zoomRange:[60,100]}]}),S0e=(t,e)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>{t(...r)},e)}},M0e=G.memo(t=>{const{panorama:e,tileRootUrl:n,pixelRootUrl:r,mode:i="light"}=t,[l,c]=G.useState(e.find(J=>J.active)??e[0]),[s,p]=G.useState(((e.find(J=>J.active)??e[0]).yaw??0)/Math.PI*180),y=G.useRef(null),_=G.useRef(null),w=G.useRef(null),S=()=>{const J=_.current;if(!J)return;const le=mr(J.getPlugin(u_)).getCurrentNode()??ee.nodes?.find(Fe=>Fe.id===ee.startNodeId);if(!le){console.warn("StreetView hashUpdater: could not find node");return}const Ce=le.id,we=y0e(J,Ce),[We]=window.location.hash.split("!");c(mr(e.find(Fe=>Fe.id===Ce))),window.history.replaceState(window.history.state,"",We+we)},M=S0e(S,300),I=(J,$)=>{p($/Math.PI*180),M()},D=()=>{M()},R=({node:J})=>{const[$,le]=mr(J.gps),Ce=[$,le];y.current?.panTo(Ce),w.current?.setLngLat(Ce),c(mr(e.find(we=>we.id===J.id)))},L=()=>{const J=mr(_.current);mr(J.getPlugin(u_)).addEventListener("node-changed",R),S()},{yaw:V,pitch:B,zoom:H}=e[0],q=J=>b0e(r,J),X=w0e(r),ee=G.useMemo(()=>{const J={positionMode:"gps",nodes:e.map(($,le)=>({id:$.id,panorama:$.driverId===0?q($.id):X($.id),gps:$.point,links:[{nodeId:e[le-1]?.id},{nodeId:e[le+1]?.id}].filter(Ce=>Ce.nodeId!=null)})),startNodeId:e.find($=>$.active)?.id};if(e.length>=3&&e.some($=>$.loop)){const $=J.nodes.at(0),le=J.nodes.at(-1);$.links.push({nodeId:le.id}),le.links.push({nodeId:$.id})}return J},[e]),se=ee.nodes.at(0).panorama;return ie.jsxs(ie.Fragment,{children:[ie.jsx(DI,{ref:_,adapter:U$,minFov:15,plugins:[u_.withConfig(ee)],src:se,height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:I,onZoomChange:D,defaultYaw:V,defaultPitch:B,defaultZoomLvl:H,onReady:L}),ie.jsx(GE,{sx:{position:"absolute",m:2.5,top:0,left:0,background:"#000a"},color:"neutral",invertedColors:!0,variant:"solid",children:ie.jsxs(ca,{direction:"row",gap:2,alignItems:"flex-start",children:[ie.jsx(Ih,{onClick:t.onClose,children:ie.jsx(Pre,{htmlColor:"#fff8"})}),ie.jsx(C0e,{pano:l})]})}),ie.jsx("div",{className:"credits",children:"Game data and images © SCS Software."}),ie.jsxs(sx,{ref:y,style:{position:"absolute",left:20,bottom:20,width:"200px",height:"200px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:9,maxZoom:14,maxBounds:[l.point.map(J=>J-1),l.point.map(J=>J+1)],mapStyle:cS,attributionControl:!1,initialViewState:{longitude:l.point[0],latitude:l.point[1],zoom:10},children:[ie.jsx(PA,{ref:w,longitude:l.point[0],latitude:l.point[1],rotation:s,rotationAlignment:"map",children:ie.jsx("div",{className:"street-view-marker"})}),ie.jsx(lS,{tileRootUrl:n,mode:i}),ie.jsx(ry,{tileRootUrl:n,game:"ats",mode:i,enableIconAutoHide:!0,visibleIcons:Gm,dlcs:Hm})]})]})},(t,e)=>{const n=JSON.stringify(t.panorama.map(i=>i.id)),r=JSON.stringify(e.panorama.map(i=>i.id));return n===r}),C0e=({pano:t})=>{const{name:e,avatarUrl:n}=x0e[t.driverId];return ie.jsxs(qw,{sx:{display:"flex",flexDirection:"column",gap:1},children:[ie.jsxs(Ti,{level:"title-lg",sx:{lineHeight:1},children:[t.label,ie.jsxs(Ti,{level:"body-xs",sx:{opacity:.8},children:[ie.jsx("br",{}),t.location]})]}),ie.jsxs(ca,{direction:"row",alignItems:"center",gap:1,sx:{transformOrigin:"left",transform:"scale(0.8)",mt:-.5},children:[ie.jsx(pX,{src:n,size:"sm"}),ie.jsx(Ti,{level:"title-sm",children:e})]}),ie.jsx(J_,{}),ie.jsx(ca,{direction:"row",gap:2,children:ie.jsx(Ti,{level:"body-xs",children:t.captureDate})})]})},t8=8192,Mv=512,E0e=t8/360,bO=t8/Mv,vv=100,T0e=t=>{const{pixelRootUrl:e,panorama:n}=t,r=TA(n.yaw??0)*180/Math.PI+180,i=Math.floor(E0e*r);let l,c;return i%Mv<Mv/2?(c=Math.floor(i/Mv),l=c===0?bO-1:c-1):(l=Math.floor(i/Mv),c=l===bO-1?0:l+1),ie.jsx("div",{style:{overflow:"hidden",width:vv},children:ie.jsxs("div",{style:{display:"flex",position:"relative",left:-r*vv/Mv},children:[ie.jsx("img",{width:vv,height:vv,src:`${e}/${n.id}_${l}_3.jpg`}),ie.jsx("img",{width:vv,height:vv,src:`${e}/${n.id}_${c}_3.jpg`})]})})},wO=(t,[e,n])=>!isNaN(t)&&e<=t&&t<=n,P0e=t=>{const{tileRootUrl:e,pixelRootUrl:n,specialEvent:r}=t,{mode:i,systemMode:l}=Lw(),c=i==="system"?l:i,{longitude:s,latitude:p}=fb[A0e(localStorage.getItem("tm-map"))];window.location.hash||window.history.replaceState(window.history.state,"","#"+[4,Number(p.toFixed(3)),Number(s.toFixed(3))].join("/"));const[y]=iQ(),_=Number(y.get("mlat")??void 0),w=Number(y.get("mlon")??void 0),S=wO(_,[-90,90])&&wO(w,[-180,180])?{lat:_,lon:w}:void 0,M=new Set([...Gm].filter(ct=>!BN.includes(ct))),[I,D]=G.useState(!0),[R,L]=G.useState(M),[V,B]=G.useState(new Set(Hm)),H=XB(V),q=Zb(R,L,Gm),X=Zb(V,B,Hm),[ee,se]=G.useState(localStorage.getItem("tm-secrets")!=="hide"),[J,$]=G.useState(!1),le=G.useRef(null),[Ce,we]=G.useState(!1),[We,Fe]=G.useState(null),[Me,Ee]=G.useState(null),Te=G.useCallback(()=>Fe(null),[]),[Ze,rt]=G.useState(null),[Re,Qe]=G.useState(localStorage.getItem("tm-map")==="europe"?"europe":"usa");G.useEffect(()=>{if(!le.current||!Ze)return;const ct=le.current;xO(ct,window.location.hash),Vt(window.location.hash.split("!")[1]);const Ct=()=>window.history.replaceState(window.history.state,"",Q$(ct)),ut=()=>Qe(localStorage.getItem("tm-map")==="europe"?"europe":"usa");ct.on("moveend",Ct),ct.on("moveend",ut);const lt=()=>{const[_t,wt]=window.location.hash.split("!");xO(ct,_t),Vt(wt)};return window.addEventListener("hashchange",lt),()=>{window.removeEventListener("hashchange",lt),ct.off("moveend",Ct),ct.off("moveend",ut)}},[le.current,Ze]);const Vt=G.useCallback(ct=>{if(Ze==null||ct==null)return;const{id:Ct,yaw:ut,pitch:lt,zoom:_t}=_0e("!"+ct);if(We?.some(dn=>dn.id===Ct))return;const wt=Ze.features.find(dn=>dn.properties.id===Ct&&dn.geometry.type==="Point");if(wt){Ce||we(!0),Fe([{...wt.properties,point:wt.geometry.coordinates,active:!0,yaw:ut,pitch:lt,zoom:_t}]);return}const cn=Ze.features.find(dn=>dn.geometry.type==="LineString"&&dn.properties.panos.some(tn=>tn.id===Ct));if(cn){Ce||we(!0),Fe(cn.properties.panos.map((dn,tn)=>({...SO(dn,tn,cn,dn.id===Ct),yaw:ut,pitch:lt,zoom:_t})));return}},[Ze,We,Ce]);G.useEffect(()=>{fetch("/street-view.geojson").then(ct=>ct.json()).then(ct=>rt(ct)).catch(ct=>console.error(ct))},[]),G.useEffect(()=>{if(!le.current||!Ce||!Ze)return;const ct=le.current,Ct=_t=>{const wt=ct.queryRenderedFeatures(_t.point,{layers:["photo-spheres"]})[0],cn=ct.queryRenderedFeatures(_t.point,{layers:["sv-streets"]})[0];if(ct.getCanvas().style.cursor=wt||cn?"pointer":"",wt){if(Me?.id!==wt.properties.id){const dn=wt;Ee({...dn.properties,point:dn.geometry.coordinates,active:!0})}}else Me&&Ee(null)},ut=_t=>{const wt=ct.queryRenderedFeatures(_t.point,{layers:["photo-spheres"]})[0];if(wt&&wt.properties.cluster!==!0){Ee(null),Fe(Me==null?null:[Me]);return}const cn=ct.queryRenderedFeatures(_t.point,{layers:["sv-streets"]})[0];if(cn){Ee(null);const dn=cn.properties.id,tn=mr(Ze.features.find(On=>On.properties.id===dn)),Je=_t.lngLat.toArray(),Tn=Tre(tn,Je).properties.index,Kt=Nb(tn.geometry.coordinates[Tn],Je),fn=Nb(tn.geometry.coordinates[Tn+1],Je),Ut=Kt<fn?Tn:Tn<tn.properties.panos.length?Tn+1:0;Fe(tn.properties.panos.map((On,vn)=>SO(On,vn,tn,vn===Ut)))}},lt=_t=>{We!=null&&_t.key==="Escape"&&Fe(null)};return We&&document.addEventListener("keydown",lt),ct.on("mousemove",Ct),ct.on("click",ut),()=>{ct.off("mousemove",Ct),ct.off("click",ut),document.removeEventListener("keydown",lt)}},[le.current,Ce,We,Me,Ze]);const je=ie.jsxs(sx,{ref:le,style:{width:"100svw",height:"100svh",display:We?"none":void 0},minZoom:4,maxZoom:15,mapStyle:cS,attributionControl:!1,initialViewState:{longitude:s,latitude:p,zoom:4},children:[S&&ie.jsx(PA,{longitude:S.lon,latitude:S.lat}),ie.jsxs(lS,{tileRootUrl:e,mode:c,children:[ie.jsx(oT,{tileRootUrl:e,game:"ats",showContours:J}),ie.jsx(oT,{tileRootUrl:e,game:"ets2",showContours:J})]}),ie.jsx(ry,{tileRootUrl:e,game:"ats",mode:c,enableIconAutoHide:I,visibleIcons:R,showSecrets:ee,dlcs:V}),ie.jsx(ry,{tileRootUrl:e,game:"ets2",mode:c,enableIconAutoHide:I,visibleIcons:R,showSecrets:ee}),R.has(Co.CityNames)&&ie.jsx(aT,{game:"ats",mode:c,enableAutoHide:I,enabledStates:H}),R.has(Co.CityNames)&&ie.jsx(aT,{game:"ets2",mode:c,enableAutoHide:I}),Ce&&ie.jsxs(ap,{id:"street-view",type:"geojson",data:"/street-view.geojson",cluster:!1,clusterMaxZoom:7,clusterRadius:10,children:[ie.jsx(Rr,{id:"photo-spheres-halo",type:"circle",paint:{"circle-radius":10,"circle-color":c==="light"?"#fff8":"#8884","circle-blur":.75},filter:["in","$type","Point"]}),ie.jsx(Rr,{id:"photo-spheres",type:"circle",paint:{"circle-radius":5,"circle-color":"#48f2","circle-stroke-width":2,"circle-stroke-color":"#48f"},filter:["in","$type","Point"]}),ie.jsx(Rr,{id:"sv-streets-case",type:"line",paint:{"line-color":"#aef","line-width":2,"line-gap-width":4},filter:["in","$type","LineString"]}),ie.jsx(Rr,{id:"sv-streets",type:"line",paint:{"line-color":"#2ab","line-width":4},filter:["in","$type","LineString"]})]}),ie.jsxs(ap,{id:"measure",type:"geojson",data:{type:"FeatureCollection",features:[]},children:[ie.jsx(Rr,{id:"measure-lines",type:"line",paint:{"line-color":"#f00","line-width":3,"line-opacity":1},filter:["in","$type","LineString"]}),ie.jsx(Rr,{id:"measure-points",type:"circle",paint:{"circle-radius":5,"circle-color":"#fff","circle-stroke-width":3,"circle-stroke-color":"#f00"},filter:["in","$type","Point"]})]}),ie.jsx(IA,{visualizePitch:!0}),ie.jsx(ihe,{visible:Re==="usa",active:Ce,onToggle:we}),ie.jsx(AA,{containerId:"fsElem"}),ie.jsx(ohe,{}),ie.jsx(jA,{}),ie.jsx(she,{specialEvent:r}),ie.jsx(wN,{compact:!0,style:{marginLeft:54},customAttribution:"© Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a> and <a href='https://forum.scssoft.com/viewtopic.php?p=1946956#p1946956'>krmarci</a>."}),ie.jsx(the,{reserveRoomForSpecialEventButton:r!=null,visibleStates:H,visibleStateDlcs:V}),ie.jsx(pB,{icons:{...q,enableAutoHiding:I,onAutoHidingToggle:D},advanced:{showSecrets:ee,onSecretsToggle:ct=>{se(ct),localStorage.setItem("tm-secrets",ct?"showAsNormal":"hide")},showContours:J,onContoursToggle:$},atsDlcs:X}),Me&&ie.jsx(Wte,{className:"pano-preview-popup",closeButton:!1,closeOnClick:!1,closeOnMove:!0,longitude:Me.point[0],latitude:Me.point[1],children:ie.jsx(T0e,{panorama:Me,pixelRootUrl:n})}),ie.jsx(Fle,{}),ie.jsx(sA,{open:Re==="usa"&&Ce,anchorOrigin:{vertical:"bottom",horizontal:"center"},size:"sm",children:ie.jsxs(ca,{direction:"column",gap:1,width:"100%",children:[ie.jsx(Ti,{level:"title-md",children:"Images"}),ie.jsxs(ca,{direction:"row",justifyContent:"space-around",children:[ie.jsxs(Ti,{level:"body-sm",children:[ie.jsx("span",{style:{display:"inline-block",width:"1.25em",height:"1em",marginRight:"1ex",position:"relative"},children:ie.jsx("span",{style:{position:"absolute",top:"50%",width:"100%",height:1,border:"2px solid #2ab",outline:"1px solid #aef"}})}),"Street View"]}),ie.jsxs(Ti,{level:"body-sm",sx:{position:"relative"},children:[ie.jsx("span",{style:{display:"inline-block",position:"relative",top:2,width:"1em",height:"1em",marginRight:"1ex",borderRadius:"50%",background:"#48f2",border:"2px solid #48f"}}),"Photo Sphere"]})]}),ie.jsx(Ti,{level:"body-xs",children:"Click highlighted areas to see images."})]})})]});return ie.jsxs(ie.Fragment,{children:[je,We&&ie.jsxs(ie.Fragment,{children:[ie.jsx(M0e,{tileRootUrl:e,pixelRootUrl:n,panorama:We,mode:c,onClose:Te}),ie.jsx(Ih,{sx:{background:"#000a",position:"absolute",borderRadius:"50%",m:2.5,top:0,right:0},size:"lg",variant:"solid",onClick:Te,children:ie.jsx(EA,{})})]})]})};function SO(t,e,n,r){return{...t,location:n.properties.location,point:n.geometry.coordinates[e],active:r,dlcGuard:0}}function A0e(t){return t==="europe"?t:"usa"}var I0e=Object.defineProperty,R0e=(t,e,n)=>e in t?I0e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,L0e=(t,e,n)=>(R0e(t,e+"",n),n);class k0e{constructor(e){L0e(this,"_kind"),this._kind=e}}function D0e(t,e){const n=t.toString(),r=e.toString();return n>r?1:n<r?-1:0}const z0e=D0e;var O0e=Object.defineProperty,F0e=(t,e,n)=>e in t?O0e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,MO=(t,e,n)=>(F0e(t,typeof e!="symbol"?e+"":e,n),n);function N0e(t,e,n){const r=e*2,i=e*2+1;let l=e;return r<t.length&&n(t[l],t[r])<0&&(l=r),i<t.length&&n(t[l],t[i])<0&&(l=i),l}function zI(t,e,n){const r=N0e(t,e,n);if(r!==e){const i=t[e];t[e]=t[r],t[r]=i,zI(t,r,n)}}function CO(t){for(let e=Math.floor(t.collection.length/2)-1;e>=0;--e)zI(t.collection,e,t.comparator)}class pw extends k0e{constructor({comparator:e=z0e}={}){super("BinaryHeap"),MO(this,"comparator"),MO(this,"collection",[]),this.comparator=e}static from(e,n={}){const r=new pw(n);return r.collection=Array.from(e),CO(r),r}clear(){this.collection.length=0}toArray(){return[...this.collection].sort(this.comparator)}get length(){return this.collection.length}top(){if(this.length===0)throw new Error("invalid operation: top() called for empty BinaryHeap");return this.collection[0]}pop(){if(this.length===0)throw new Error("invalid operation: pop() called for empty BinaryHeap");const e=this.collection[0];return this.collection.length>1?(this.collection[0]=this.collection.pop(),zI(this.collection,0,this.comparator)):this.collection.pop(),e}push(e){this.collection.push(e);const n=this.collection;for(let r=n.length-1,i=Math.floor(r/2);r>0&&this.comparator(n[i],n[r])<0;r=i,i=Math.floor(i/2)){const l=n[r];n[r]=n[i],n[i]=l}}merge(e){e instanceof pw?this.collection=this.collection.concat(e.collection):this.collection=this.collection.concat(e.toArray()),CO(this),e.clear()}isEmpty(){return!this.collection.length}}function B0e(t,e,n,r,i){const l=`${t}-${e}-${n}-${r}`,{nodeLUT:c,graph:s}=i,p=mr(c.get(t)),y=mr(c.get(e)),_=new $0e({comparator:(V,B)=>{const H=R.get(V)??1/0;return(R.get(B)??1/0)-H}}),w={nodeUid:t,distance:0,direction:n,dlcGuard:-1};_.push(w);const S=new Map,M=new Map;M.set(w,0);const I=V=>Nb(V,y),D=(V,B)=>{switch(r){case"shortest":return B.distance;case"smallRoads":return B.isOneLaneRoad?B.distance:B.distance*10;default:throw new Su(r)}},R=new Map;R.set(w,I(p));let L=0;for(;!_.isEmpty();){L++;const V=_.pop();if(V.nodeUid===e)return{success:!0,key:l,mode:r,...U0e(S,V)};const B=s.get(V.nodeUid);if(!B)continue;const H=V.direction==="forward"?B.forward:B.backward;for(const q of H){if(!i.enabledDlcGuards.has(q.dlcGuard))continue;const X=(M.get(V)??1/0)+D(V,q);X<(M.get(q)??1/0)&&(S.set(q,V),M.set(q,X),R.set(q,X+I(mr(c.get(q.nodeUid)))),_.has(q)||_.push(q))}}return{success:!1,key:l,mode:r,numIters:L}}function U0e(t,e){let n=0;const r=[e];for(;t.has(e);)e=t.get(e),r.unshift(e),n+=e.distance;return r.length===1&&r.push(r[0]),{route:r,distance:n}}class $0e extends pw{items=new Set;constructor(e){super(e)}has(e){return this.items.has(e)}push(e){jm.checkState(!this.items.has(e)),super.push(e),this.items.add(e)}pop(){const e=super.pop();return jm.checkState(this.items.has(e)),this.items.delete(e),e}clear(){super.clear(),this.items.clear()}merge(e){super.merge(e);for(const n of this.collection)this.items.add(n)}}const V0e=t=>{const{tileRootUrl:e}=t,{mode:n,systemMode:r}=Lw(),i=n==="system"?r:n,[l,c]=G.useState(!0),[s,p]=G.useState(new Set(Gm)),[y,_]=G.useState(new Set(Hm)),w=XB(y),S=Zb(s,p,Gm),M=Zb(y,_,Hm),[I,D]=G.useState(!0),[R,L]=G.useState(!1);return ie.jsxs(sx,{style:{width:"100vw",height:"100vh"},minZoom:4,maxZoom:15,maxBounds:[[-135,21],[-84,54]],mapStyle:cS,attributionControl:!1,initialViewState:{longitude:-115,latitude:36,zoom:9},children:[ie.jsx(lS,{tileRootUrl:e,mode:i,children:ie.jsx(oT,{tileRootUrl:e,game:"ats",showContours:R})}),ie.jsx(ry,{tileRootUrl:e,game:"ats",mode:i,enableIconAutoHide:l,visibleIcons:s,dlcs:y,showSecrets:I}),ie.jsx(aT,{game:"ats",mode:i,enableAutoHide:l,enabledStates:w}),ie.jsx(ap,{id:"route1",type:"geojson",data:{type:"FeatureCollection",features:[]},children:ie.jsx(Rr,{type:"line",paint:{"line-color":["match",["get","mode"],"shortest","#f00","smallRoads","#0f0","#f0f"],"line-width":3,"line-opacity":.7}})}),ie.jsx(IA,{visualizePitch:!0}),ie.jsx(AA,{}),ie.jsx(jA,{}),ie.jsx(wN,{compact:!0,customAttribution:"© Trucker Mudgeon. scenery town data by <a href='https://github.com/nautofon/ats-towns'>nautofon</a>."}),ie.jsx(j0e,{dlcs:y}),ie.jsx(pB,{icons:{...S,enableAutoHiding:l,onAutoHidingToggle:c},advanced:{showSecrets:I,onSecretsToggle:D,showContours:R,onContoursToggle:L},atsDlcs:M})]})},j0e=t=>{const{current:e}=ox(),n=ix(t.dlcs),[r,i]=G.useState(void 0),[l,c]=G.useState(void 0),[s,p]=G.useState([]),[y,_]=G.useState([]);G.useEffect(()=>{fetch("usa-graph-demo.json").then(ee=>ee.json()).then(ee=>{p(ee.demoCompanies.map(PO)),c(H0e(ee)),i(ee)},()=>console.error("could not load usa-graph-demo.json"))},[]);const[w,S]=G.useState(void 0),[M,I]=G.useState(void 0),D=G.useCallback(ee=>{ee=mr(ee),S(ee.value);let se;if(r!=null){se=mr(r.demoCompanies.find(le=>le.n===ee.value));const J=mr(r.demoCompanyDefs.find(le=>le.t===se.t)),$=new Set(J.d);_(r.demoCompanies.filter(le=>$.has(le.t)).map(PO))}if(!(e==null||l==null)&&(M!=null&&(mr(e.getSource("route1")).setData({type:"FeatureCollection",features:[]}),I(void 0)),se)){const J=mr(l.nodeLUT.get(BigInt(parseInt(se.n,36))));e.flyTo({curve:1,zoom:9,center:[J.x,J.y]})}},[e,M,l,r]),R=G.useCallback(ee=>{ee=mr(ee),I(ee.value),!(e==null||l==null)&&L(mr(w),ee.value,e,{...l,enabledDlcGuards:n})},[e,w,l,t.dlcs]),L=(ee,se,J,$)=>{Promise.all([AO(ee,se,"shortest",$),AO(ee,se,"smallRoads",$)]).then(le=>{const Ce=mr(J.getSource("route1"));if(le.some(We=>We==null)){alert("Cannot calculate a route 🙁"),Ce.setData({type:"FeatureCollection",features:[]});return}const we=le;Ce.setData({type:"FeatureCollection",features:we}),J.fitBounds(gN(we.flatMap(We=>We.geometry.coordinates)),{padding:150,curve:1,duration:2500})},le=>{console.error("error finding route",le)})},V=new Map;if(r)for(const[,ee]of r.demoGraph)for(const se of[...ee.b??[],...ee.f??[]]){const J=V.get(se.n)??0;V.set(se.n,J||se.g)}const B=ee=>{if(l==null)return!0;const se=mr(V.get(ee.value));return n.has(se)},H=(ee,se)=>ee.city!==se.city?ee.city.localeCompare(se.city):ee.label.localeCompare(se.label),q=s.filter(B).sort(H),X=y.filter(B).sort(H);return ie.jsxs("div",{style:{width:300,margin:20,display:"grid",position:"relative",gridTemplateColumns:"100px auto",alignItems:"center"},children:[ie.jsx("h2",{children:"Start"}),ie.jsx(Lb,{options:q,onChange:(ee,se)=>se&&D(se),groupBy:ee=>ee.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,renderGroup:EO}),ie.jsx("h2",{children:"End"}),ie.jsx(Lb,{options:X,onChange:(ee,se)=>se&&R(se),groupBy:ee=>ee.city,placeholder:"Select...",blurOnSelect:!0,autoComplete:!0,disableClearable:!0,disabled:w==null,renderGroup:EO},w)]})};function EO(t){return ie.jsxs(ie.Fragment,{children:[ie.jsx(Ti,{m:1,level:"body-xs",textTransform:"uppercase",children:t.group}),ie.jsx(jw,{children:t.children}),ie.jsx(WE,{})]})}function H0e(t){const e=new Map,n=new Map;for(const[r,i]of t.demoGraph)e.set(BigInt(parseInt(r,36)),{forward:(i.f??[]).map(TO),backward:(i.b??[]).map(TO)});for(const[r,i]of t.demoNodes)n.set(BigInt(parseInt(r,36)),{x:i[0],y:i[1]});return{graph:e,nodeLUT:n}}function TO(t){return{nodeUid:BigInt(parseInt(t.n,36)),distance:t.l,isOneLaneRoad:t.o,direction:t.d==="f"?"forward":"backward",dlcGuard:t.g}}function PO(t){return{label:t.t,city:t.c,value:t.n}}function AO(t,e,n,r){return new Promise(i=>{const l=B0e(BigInt(parseInt(t,36)),BigInt(parseInt(e,36)),"forward",n,r);if(!l.success){i(void 0);return}i({type:"Feature",geometry:{type:"LineString",coordinates:l.route.map(c=>{const s=mr(r.nodeLUT.get(c.nodeUid));return[s.x,s.y]})},properties:{distance:l.distance,mode:n}})})}var EE={exports:{}},TE,IO;function n8(){return IO||(IO=1,TE={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),TE}var PE={exports:{}},AE,RO;function G0e(){return RO||(RO=1,AE=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}),AE}var LO;function W0e(){if(LO)return PE.exports;LO=1;var t=G0e(),e=Array.prototype.concat,n=Array.prototype.slice,r=PE.exports=function(l){for(var c=[],s=0,p=l.length;s<p;s++){var y=l[s];t(y)?c=e.call(c,n.call(y)):c.push(y)}return c};return r.wrap=function(i){return function(){return i(r(arguments))}},PE.exports}var kO;function q0e(){if(kO)return EE.exports;kO=1;var t=n8(),e=W0e(),n=Object.hasOwnProperty,r=Object.create(null);for(var i in t)n.call(t,i)&&(r[t[i]]=i);var l=EE.exports={to:{},get:{}};l.get=function(p){var y=p.substring(0,3).toLowerCase(),_,w;switch(y){case"hsl":_=l.get.hsl(p),w="hsl";break;case"hwb":_=l.get.hwb(p),w="hwb";break;default:_=l.get.rgb(p),w="rgb";break}return _?{model:w,value:_}:null},l.get.rgb=function(p){if(!p)return null;var y=/^#([a-f0-9]{3,4})$/i,_=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,w=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,S=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,M=/^(\w+)$/,I=[0,0,0,1],D,R,L;if(D=p.match(_)){for(L=D[2],D=D[1],R=0;R<3;R++){var V=R*2;I[R]=parseInt(D.slice(V,V+2),16)}L&&(I[3]=parseInt(L,16)/255)}else if(D=p.match(y)){for(D=D[1],L=D[3],R=0;R<3;R++)I[R]=parseInt(D[R]+D[R],16);L&&(I[3]=parseInt(L+L,16)/255)}else if(D=p.match(w)){for(R=0;R<3;R++)I[R]=parseInt(D[R+1],0);D[4]&&(D[5]?I[3]=parseFloat(D[4])*.01:I[3]=parseFloat(D[4]))}else if(D=p.match(S)){for(R=0;R<3;R++)I[R]=Math.round(parseFloat(D[R+1])*2.55);D[4]&&(D[5]?I[3]=parseFloat(D[4])*.01:I[3]=parseFloat(D[4]))}else return(D=p.match(M))?D[1]==="transparent"?[0,0,0,0]:n.call(t,D[1])?(I=t[D[1]],I[3]=1,I):null:null;for(R=0;R<3;R++)I[R]=c(I[R],0,255);return I[3]=c(I[3],0,1),I},l.get.hsl=function(p){if(!p)return null;var y=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,_=p.match(y);if(_){var w=parseFloat(_[4]),S=(parseFloat(_[1])%360+360)%360,M=c(parseFloat(_[2]),0,100),I=c(parseFloat(_[3]),0,100),D=c(isNaN(w)?1:w,0,1);return[S,M,I,D]}return null},l.get.hwb=function(p){if(!p)return null;var y=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,_=p.match(y);if(_){var w=parseFloat(_[4]),S=(parseFloat(_[1])%360+360)%360,M=c(parseFloat(_[2]),0,100),I=c(parseFloat(_[3]),0,100),D=c(isNaN(w)?1:w,0,1);return[S,M,I,D]}return null},l.to.hex=function(){var p=e(arguments);return"#"+s(p[0])+s(p[1])+s(p[2])+(p[3]<1?s(Math.round(p[3]*255)):"")},l.to.rgb=function(){var p=e(arguments);return p.length<4||p[3]===1?"rgb("+Math.round(p[0])+", "+Math.round(p[1])+", "+Math.round(p[2])+")":"rgba("+Math.round(p[0])+", "+Math.round(p[1])+", "+Math.round(p[2])+", "+p[3]+")"},l.to.rgb.percent=function(){var p=e(arguments),y=Math.round(p[0]/255*100),_=Math.round(p[1]/255*100),w=Math.round(p[2]/255*100);return p.length<4||p[3]===1?"rgb("+y+"%, "+_+"%, "+w+"%)":"rgba("+y+"%, "+_+"%, "+w+"%, "+p[3]+")"},l.to.hsl=function(){var p=e(arguments);return p.length<4||p[3]===1?"hsl("+p[0]+", "+p[1]+"%, "+p[2]+"%)":"hsla("+p[0]+", "+p[1]+"%, "+p[2]+"%, "+p[3]+")"},l.to.hwb=function(){var p=e(arguments),y="";return p.length>=4&&p[3]!==1&&(y=", "+p[3]),"hwb("+p[0]+", "+p[1]+"%, "+p[2]+"%"+y+")"},l.to.keyword=function(p){return r[p.slice(0,3)]};function c(p,y,_){return Math.min(Math.max(y,p),_)}function s(p){var y=Math.round(p).toString(16).toUpperCase();return y.length<2?"0"+y:y}return EE.exports}var IE,DO;function r8(){if(DO)return IE;DO=1;const t=n8(),e={};for(const i of Object.keys(t))e[t[i]]=i;const n={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};IE=n;for(const i of Object.keys(n)){if(!("channels"in n[i]))throw new Error("missing channels property: "+i);if(!("labels"in n[i]))throw new Error("missing channel labels property: "+i);if(n[i].labels.length!==n[i].channels)throw new Error("channel and label counts mismatch: "+i);const{channels:l,labels:c}=n[i];delete n[i].channels,delete n[i].labels,Object.defineProperty(n[i],"channels",{value:l}),Object.defineProperty(n[i],"labels",{value:c})}n.rgb.hsl=function(i){const l=i[0]/255,c=i[1]/255,s=i[2]/255,p=Math.min(l,c,s),y=Math.max(l,c,s),_=y-p;let w,S;y===p?w=0:l===y?w=(c-s)/_:c===y?w=2+(s-l)/_:s===y&&(w=4+(l-c)/_),w=Math.min(w*60,360),w<0&&(w+=360);const M=(p+y)/2;return y===p?S=0:M<=.5?S=_/(y+p):S=_/(2-y-p),[w,S*100,M*100]},n.rgb.hsv=function(i){let l,c,s,p,y;const _=i[0]/255,w=i[1]/255,S=i[2]/255,M=Math.max(_,w,S),I=M-Math.min(_,w,S),D=function(R){return(M-R)/6/I+1/2};return I===0?(p=0,y=0):(y=I/M,l=D(_),c=D(w),s=D(S),_===M?p=s-c:w===M?p=1/3+l-s:S===M&&(p=2/3+c-l),p<0?p+=1:p>1&&(p-=1)),[p*360,y*100,M*100]},n.rgb.hwb=function(i){const l=i[0],c=i[1];let s=i[2];const p=n.rgb.hsl(i)[0],y=1/255*Math.min(l,Math.min(c,s));return s=1-1/255*Math.max(l,Math.max(c,s)),[p,y*100,s*100]},n.rgb.cmyk=function(i){const l=i[0]/255,c=i[1]/255,s=i[2]/255,p=Math.min(1-l,1-c,1-s),y=(1-l-p)/(1-p)||0,_=(1-c-p)/(1-p)||0,w=(1-s-p)/(1-p)||0;return[y*100,_*100,w*100,p*100]};function r(i,l){return(i[0]-l[0])**2+(i[1]-l[1])**2+(i[2]-l[2])**2}return n.rgb.keyword=function(i){const l=e[i];if(l)return l;let c=1/0,s;for(const p of Object.keys(t)){const y=t[p],_=r(i,y);_<c&&(c=_,s=p)}return s},n.keyword.rgb=function(i){return t[i]},n.rgb.xyz=function(i){let l=i[0]/255,c=i[1]/255,s=i[2]/255;l=l>.04045?((l+.055)/1.055)**2.4:l/12.92,c=c>.04045?((c+.055)/1.055)**2.4:c/12.92,s=s>.04045?((s+.055)/1.055)**2.4:s/12.92;const p=l*.4124+c*.3576+s*.1805,y=l*.2126+c*.7152+s*.0722,_=l*.0193+c*.1192+s*.9505;return[p*100,y*100,_*100]},n.rgb.lab=function(i){const l=n.rgb.xyz(i);let c=l[0],s=l[1],p=l[2];c/=95.047,s/=100,p/=108.883,c=c>.008856?c**(1/3):7.787*c+16/116,s=s>.008856?s**(1/3):7.787*s+16/116,p=p>.008856?p**(1/3):7.787*p+16/116;const y=116*s-16,_=500*(c-s),w=200*(s-p);return[y,_,w]},n.hsl.rgb=function(i){const l=i[0]/360,c=i[1]/100,s=i[2]/100;let p,y,_;if(c===0)return _=s*255,[_,_,_];s<.5?p=s*(1+c):p=s+c-s*c;const w=2*s-p,S=[0,0,0];for(let M=0;M<3;M++)y=l+1/3*-(M-1),y<0&&y++,y>1&&y--,6*y<1?_=w+(p-w)*6*y:2*y<1?_=p:3*y<2?_=w+(p-w)*(2/3-y)*6:_=w,S[M]=_*255;return S},n.hsl.hsv=function(i){const l=i[0];let c=i[1]/100,s=i[2]/100,p=c;const y=Math.max(s,.01);s*=2,c*=s<=1?s:2-s,p*=y<=1?y:2-y;const _=(s+c)/2,w=s===0?2*p/(y+p):2*c/(s+c);return[l,w*100,_*100]},n.hsv.rgb=function(i){const l=i[0]/60,c=i[1]/100;let s=i[2]/100;const p=Math.floor(l)%6,y=l-Math.floor(l),_=255*s*(1-c),w=255*s*(1-c*y),S=255*s*(1-c*(1-y));switch(s*=255,p){case 0:return[s,S,_];case 1:return[w,s,_];case 2:return[_,s,S];case 3:return[_,w,s];case 4:return[S,_,s];case 5:return[s,_,w]}},n.hsv.hsl=function(i){const l=i[0],c=i[1]/100,s=i[2]/100,p=Math.max(s,.01);let y,_;_=(2-c)*s;const w=(2-c)*p;return y=c*p,y/=w<=1?w:2-w,y=y||0,_/=2,[l,y*100,_*100]},n.hwb.rgb=function(i){const l=i[0]/360;let c=i[1]/100,s=i[2]/100;const p=c+s;let y;p>1&&(c/=p,s/=p);const _=Math.floor(6*l),w=1-s;y=6*l-_,(_&1)!==0&&(y=1-y);const S=c+y*(w-c);let M,I,D;switch(_){default:case 6:case 0:M=w,I=S,D=c;break;case 1:M=S,I=w,D=c;break;case 2:M=c,I=w,D=S;break;case 3:M=c,I=S,D=w;break;case 4:M=S,I=c,D=w;break;case 5:M=w,I=c,D=S;break}return[M*255,I*255,D*255]},n.cmyk.rgb=function(i){const l=i[0]/100,c=i[1]/100,s=i[2]/100,p=i[3]/100,y=1-Math.min(1,l*(1-p)+p),_=1-Math.min(1,c*(1-p)+p),w=1-Math.min(1,s*(1-p)+p);return[y*255,_*255,w*255]},n.xyz.rgb=function(i){const l=i[0]/100,c=i[1]/100,s=i[2]/100;let p,y,_;return p=l*3.2406+c*-1.5372+s*-.4986,y=l*-.9689+c*1.8758+s*.0415,_=l*.0557+c*-.204+s*1.057,p=p>.0031308?1.055*p**(1/2.4)-.055:p*12.92,y=y>.0031308?1.055*y**(1/2.4)-.055:y*12.92,_=_>.0031308?1.055*_**(1/2.4)-.055:_*12.92,p=Math.min(Math.max(0,p),1),y=Math.min(Math.max(0,y),1),_=Math.min(Math.max(0,_),1),[p*255,y*255,_*255]},n.xyz.lab=function(i){let l=i[0],c=i[1],s=i[2];l/=95.047,c/=100,s/=108.883,l=l>.008856?l**(1/3):7.787*l+16/116,c=c>.008856?c**(1/3):7.787*c+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;const p=116*c-16,y=500*(l-c),_=200*(c-s);return[p,y,_]},n.lab.xyz=function(i){const l=i[0],c=i[1],s=i[2];let p,y,_;y=(l+16)/116,p=c/500+y,_=y-s/200;const w=y**3,S=p**3,M=_**3;return y=w>.008856?w:(y-16/116)/7.787,p=S>.008856?S:(p-16/116)/7.787,_=M>.008856?M:(_-16/116)/7.787,p*=95.047,y*=100,_*=108.883,[p,y,_]},n.lab.lch=function(i){const l=i[0],c=i[1],s=i[2];let p;p=Math.atan2(s,c)*360/2/Math.PI,p<0&&(p+=360);const _=Math.sqrt(c*c+s*s);return[l,_,p]},n.lch.lab=function(i){const l=i[0],c=i[1],p=i[2]/360*2*Math.PI,y=c*Math.cos(p),_=c*Math.sin(p);return[l,y,_]},n.rgb.ansi16=function(i,l=null){const[c,s,p]=i;let y=l===null?n.rgb.hsv(i)[2]:l;if(y=Math.round(y/50),y===0)return 30;let _=30+(Math.round(p/255)<<2|Math.round(s/255)<<1|Math.round(c/255));return y===2&&(_+=60),_},n.hsv.ansi16=function(i){return n.rgb.ansi16(n.hsv.rgb(i),i[2])},n.rgb.ansi256=function(i){const l=i[0],c=i[1],s=i[2];return l===c&&c===s?l<8?16:l>248?231:Math.round((l-8)/247*24)+232:16+36*Math.round(l/255*5)+6*Math.round(c/255*5)+Math.round(s/255*5)},n.ansi16.rgb=function(i){let l=i%10;if(l===0||l===7)return i>50&&(l+=3.5),l=l/10.5*255,[l,l,l];const c=(~~(i>50)+1)*.5,s=(l&1)*c*255,p=(l>>1&1)*c*255,y=(l>>2&1)*c*255;return[s,p,y]},n.ansi256.rgb=function(i){if(i>=232){const y=(i-232)*10+8;return[y,y,y]}i-=16;let l;const c=Math.floor(i/36)/5*255,s=Math.floor((l=i%36)/6)/5*255,p=l%6/5*255;return[c,s,p]},n.rgb.hex=function(i){const c=(((Math.round(i[0])&255)<<16)+((Math.round(i[1])&255)<<8)+(Math.round(i[2])&255)).toString(16).toUpperCase();return"000000".substring(c.length)+c},n.hex.rgb=function(i){const l=i.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!l)return[0,0,0];let c=l[0];l[0].length===3&&(c=c.split("").map(w=>w+w).join(""));const s=parseInt(c,16),p=s>>16&255,y=s>>8&255,_=s&255;return[p,y,_]},n.rgb.hcg=function(i){const l=i[0]/255,c=i[1]/255,s=i[2]/255,p=Math.max(Math.max(l,c),s),y=Math.min(Math.min(l,c),s),_=p-y;let w,S;return _<1?w=y/(1-_):w=0,_<=0?S=0:p===l?S=(c-s)/_%6:p===c?S=2+(s-l)/_:S=4+(l-c)/_,S/=6,S%=1,[S*360,_*100,w*100]},n.hsl.hcg=function(i){const l=i[1]/100,c=i[2]/100,s=c<.5?2*l*c:2*l*(1-c);let p=0;return s<1&&(p=(c-.5*s)/(1-s)),[i[0],s*100,p*100]},n.hsv.hcg=function(i){const l=i[1]/100,c=i[2]/100,s=l*c;let p=0;return s<1&&(p=(c-s)/(1-s)),[i[0],s*100,p*100]},n.hcg.rgb=function(i){const l=i[0]/360,c=i[1]/100,s=i[2]/100;if(c===0)return[s*255,s*255,s*255];const p=[0,0,0],y=l%1*6,_=y%1,w=1-_;let S=0;switch(Math.floor(y)){case 0:p[0]=1,p[1]=_,p[2]=0;break;case 1:p[0]=w,p[1]=1,p[2]=0;break;case 2:p[0]=0,p[1]=1,p[2]=_;break;case 3:p[0]=0,p[1]=w,p[2]=1;break;case 4:p[0]=_,p[1]=0,p[2]=1;break;default:p[0]=1,p[1]=0,p[2]=w}return S=(1-c)*s,[(c*p[0]+S)*255,(c*p[1]+S)*255,(c*p[2]+S)*255]},n.hcg.hsv=function(i){const l=i[1]/100,c=i[2]/100,s=l+c*(1-l);let p=0;return s>0&&(p=l/s),[i[0],p*100,s*100]},n.hcg.hsl=function(i){const l=i[1]/100,s=i[2]/100*(1-l)+.5*l;let p=0;return s>0&&s<.5?p=l/(2*s):s>=.5&&s<1&&(p=l/(2*(1-s))),[i[0],p*100,s*100]},n.hcg.hwb=function(i){const l=i[1]/100,c=i[2]/100,s=l+c*(1-l);return[i[0],(s-l)*100,(1-s)*100]},n.hwb.hcg=function(i){const l=i[1]/100,s=1-i[2]/100,p=s-l;let y=0;return p<1&&(y=(s-p)/(1-p)),[i[0],p*100,y*100]},n.apple.rgb=function(i){return[i[0]/65535*255,i[1]/65535*255,i[2]/65535*255]},n.rgb.apple=function(i){return[i[0]/255*65535,i[1]/255*65535,i[2]/255*65535]},n.gray.rgb=function(i){return[i[0]/100*255,i[0]/100*255,i[0]/100*255]},n.gray.hsl=function(i){return[0,0,i[0]]},n.gray.hsv=n.gray.hsl,n.gray.hwb=function(i){return[0,100,i[0]]},n.gray.cmyk=function(i){return[0,0,0,i[0]]},n.gray.lab=function(i){return[i[0],0,0]},n.gray.hex=function(i){const l=Math.round(i[0]/100*255)&255,s=((l<<16)+(l<<8)+l).toString(16).toUpperCase();return"000000".substring(s.length)+s},n.rgb.gray=function(i){return[(i[0]+i[1]+i[2])/3/255*100]},IE}var RE,zO;function X0e(){if(zO)return RE;zO=1;const t=r8();function e(){const l={},c=Object.keys(t);for(let s=c.length,p=0;p<s;p++)l[c[p]]={distance:-1,parent:null};return l}function n(l){const c=e(),s=[l];for(c[l].distance=0;s.length;){const p=s.pop(),y=Object.keys(t[p]);for(let _=y.length,w=0;w<_;w++){const S=y[w],M=c[S];M.distance===-1&&(M.distance=c[p].distance+1,M.parent=p,s.unshift(S))}}return c}function r(l,c){return function(s){return c(l(s))}}function i(l,c){const s=[c[l].parent,l];let p=t[c[l].parent][l],y=c[l].parent;for(;c[y].parent;)s.unshift(c[y].parent),p=r(t[c[y].parent][y],p),y=c[y].parent;return p.conversion=s,p}return RE=function(l){const c=n(l),s={},p=Object.keys(c);for(let y=p.length,_=0;_<y;_++){const w=p[_];c[w].parent!==null&&(s[w]=i(w,c))}return s},RE}var LE,OO;function Z0e(){if(OO)return LE;OO=1;const t=r8(),e=X0e(),n={},r=Object.keys(t);function i(c){const s=function(...p){const y=p[0];return y==null?y:(y.length>1&&(p=y),c(p))};return"conversion"in c&&(s.conversion=c.conversion),s}function l(c){const s=function(...p){const y=p[0];if(y==null)return y;y.length>1&&(p=y);const _=c(p);if(typeof _=="object")for(let w=_.length,S=0;S<w;S++)_[S]=Math.round(_[S]);return _};return"conversion"in c&&(s.conversion=c.conversion),s}return r.forEach(c=>{n[c]={},Object.defineProperty(n[c],"channels",{value:t[c].channels}),Object.defineProperty(n[c],"labels",{value:t[c].labels});const s=e(c);Object.keys(s).forEach(y=>{const _=s[y];n[c][y]=l(_),n[c][y].raw=i(_)})}),LE=n,LE}var kE,FO;function Y0e(){if(FO)return kE;FO=1;const t=q0e(),e=Z0e(),n=["keyword","gray","hex"],r={};for(const S of Object.keys(e))r[[...e[S].labels].sort().join("")]=S;const i={};function l(S,M){if(!(this instanceof l))return new l(S,M);if(M&&M in n&&(M=null),M&&!(M in e))throw new Error("Unknown model: "+M);let I,D;if(S==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(S instanceof l)this.model=S.model,this.color=[...S.color],this.valpha=S.valpha;else if(typeof S=="string"){const R=t.get(S);if(R===null)throw new Error("Unable to parse color from string: "+S);this.model=R.model,D=e[this.model].channels,this.color=R.value.slice(0,D),this.valpha=typeof R.value[D]=="number"?R.value[D]:1}else if(S.length>0){this.model=M||"rgb",D=e[this.model].channels;const R=Array.prototype.slice.call(S,0,D);this.color=w(R,D),this.valpha=typeof S[D]=="number"?S[D]:1}else if(typeof S=="number")this.model="rgb",this.color=[S>>16&255,S>>8&255,S&255],this.valpha=1;else{this.valpha=1;const R=Object.keys(S);"alpha"in S&&(R.splice(R.indexOf("alpha"),1),this.valpha=typeof S.alpha=="number"?S.alpha:0);const L=R.sort().join("");if(!(L in r))throw new Error("Unable to parse color from object: "+JSON.stringify(S));this.model=r[L];const{labels:V}=e[this.model],B=[];for(I=0;I<V.length;I++)B.push(S[V[I]]);this.color=w(B)}if(i[this.model])for(D=e[this.model].channels,I=0;I<D;I++){const R=i[this.model][I];R&&(this.color[I]=R(this.color[I]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}l.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(S){let M=this.model in t.to?this:this.rgb();M=M.round(typeof S=="number"?S:1);const I=M.valpha===1?M.color:[...M.color,this.valpha];return t.to[M.model](I)},percentString(S){const M=this.rgb().round(typeof S=="number"?S:1),I=M.valpha===1?M.color:[...M.color,this.valpha];return t.to.rgb.percent(I)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const S={},{channels:M}=e[this.model],{labels:I}=e[this.model];for(let D=0;D<M;D++)S[I[D]]=this.color[D];return this.valpha!==1&&(S.alpha=this.valpha),S},unitArray(){const S=this.rgb().color;return S[0]/=255,S[1]/=255,S[2]/=255,this.valpha!==1&&S.push(this.valpha),S},unitObject(){const S=this.rgb().object();return S.r/=255,S.g/=255,S.b/=255,this.valpha!==1&&(S.alpha=this.valpha),S},round(S){return S=Math.max(S||0,0),new l([...this.color.map(s(S)),this.valpha],this.model)},alpha(S){return S!==void 0?new l([...this.color,Math.max(0,Math.min(1,S))],this.model):this.valpha},red:p("rgb",0,y(255)),green:p("rgb",1,y(255)),blue:p("rgb",2,y(255)),hue:p(["hsl","hsv","hsl","hwb","hcg"],0,S=>(S%360+360)%360),saturationl:p("hsl",1,y(100)),lightness:p("hsl",2,y(100)),saturationv:p("hsv",1,y(100)),value:p("hsv",2,y(100)),chroma:p("hcg",1,y(100)),gray:p("hcg",2,y(100)),white:p("hwb",1,y(100)),wblack:p("hwb",2,y(100)),cyan:p("cmyk",0,y(100)),magenta:p("cmyk",1,y(100)),yellow:p("cmyk",2,y(100)),black:p("cmyk",3,y(100)),x:p("xyz",0,y(95.047)),y:p("xyz",1,y(100)),z:p("xyz",2,y(108.833)),l:p("lab",0,y(100)),a:p("lab",1),b:p("lab",2),keyword(S){return S!==void 0?new l(S):e[this.model].keyword(this.color)},hex(S){return S!==void 0?new l(S):t.to.hex(this.rgb().round().color)},hexa(S){if(S!==void 0)return new l(S);const M=this.rgb().round().color;let I=Math.round(this.valpha*255).toString(16).toUpperCase();return I.length===1&&(I="0"+I),t.to.hex(M)+I},rgbNumber(){const S=this.rgb().color;return(S[0]&255)<<16|(S[1]&255)<<8|S[2]&255},luminosity(){const S=this.rgb().color,M=[];for(const[I,D]of S.entries()){const R=D/255;M[I]=R<=.04045?R/12.92:((R+.055)/1.055)**2.4}return .2126*M[0]+.7152*M[1]+.0722*M[2]},contrast(S){const M=this.luminosity(),I=S.luminosity();return M>I?(M+.05)/(I+.05):(I+.05)/(M+.05)},level(S){const M=this.contrast(S);return M>=7?"AAA":M>=4.5?"AA":""},isDark(){const S=this.rgb().color;return(S[0]*2126+S[1]*7152+S[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const S=this.rgb();for(let M=0;M<3;M++)S.color[M]=255-S.color[M];return S},lighten(S){const M=this.hsl();return M.color[2]+=M.color[2]*S,M},darken(S){const M=this.hsl();return M.color[2]-=M.color[2]*S,M},saturate(S){const M=this.hsl();return M.color[1]+=M.color[1]*S,M},desaturate(S){const M=this.hsl();return M.color[1]-=M.color[1]*S,M},whiten(S){const M=this.hwb();return M.color[1]+=M.color[1]*S,M},blacken(S){const M=this.hwb();return M.color[2]+=M.color[2]*S,M},grayscale(){const S=this.rgb().color,M=S[0]*.3+S[1]*.59+S[2]*.11;return l.rgb(M,M,M)},fade(S){return this.alpha(this.valpha-this.valpha*S)},opaquer(S){return this.alpha(this.valpha+this.valpha*S)},rotate(S){const M=this.hsl();let I=M.color[0];return I=(I+S)%360,I=I<0?360+I:I,M.color[0]=I,M},mix(S,M){if(!S||!S.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof S);const I=S.rgb(),D=this.rgb(),R=M===void 0?.5:M,L=2*R-1,V=I.alpha()-D.alpha(),B=((L*V===-1?L:(L+V)/(1+L*V))+1)/2,H=1-B;return l.rgb(B*I.red()+H*D.red(),B*I.green()+H*D.green(),B*I.blue()+H*D.blue(),I.alpha()*R+D.alpha()*(1-R))}};for(const S of Object.keys(e)){if(n.includes(S))continue;const{channels:M}=e[S];l.prototype[S]=function(...I){return this.model===S?new l(this):I.length>0?new l(I,S):new l([..._(e[this.model][S].raw(this.color)),this.valpha],S)},l[S]=function(...I){let D=I[0];return typeof D=="number"&&(D=w(I,M)),new l(D,S)}}function c(S,M){return Number(S.toFixed(M))}function s(S){return function(M){return c(M,S)}}function p(S,M,I){S=Array.isArray(S)?S:[S];for(const D of S)(i[D]||(i[D]=[]))[M]=I;return S=S[0],function(D){let R;return D!==void 0?(I&&(D=I(D)),R=this[S](),R.color[M]=D,R):(R=this[S]().color[M],I&&(R=I(R)),R)}}function y(S){return function(M){return Math.max(0,Math.min(S,M))}}function _(S){return Array.isArray(S)?S:[S]}function w(S,M){for(let I=0;I<M;I++)typeof S[I]!="number"&&(S[I]=0);return S}return kE=l,kE}var K0e=Y0e();const J0e=vw(K0e),Q0e=t=>{const{tileRootUrl:e,specialEvent:n}=t,{mode:r="light",systemMode:i="light"}=Lw(),l=r==="system"?i:r,s=t_e(localStorage.getItem("tm-map"))==="usa"?"🌎":"🌍",p=sS[l],y=iI[n],[_,w]=y.centerLngLat;return ie.jsxs(sx,{style:{width:"100svw",height:"100svh"},minZoom:y.minZoom,maxZoom:15,mapStyle:y.mapStyle,attributionControl:!1,initialViewState:{longitude:_,latitude:w,zoom:y.minZoom+.5},maxBounds:[[_-y.boundsDelta,w-y.boundsDelta],[_+y.boundsDelta,w+y.boundsDelta]],children:[ie.jsx(Rr,{id:"background",type:"background",paint:{"background-color":J0e(p.land).darken(.2).toString()}}),ie.jsx(ry,{tileRootUrl:e,game:"ats",specialEvent:n,mode:l,showSecrets:!0,enableIconAutoHide:!1}),ie.jsx(IA,{visualizePitch:!0}),ie.jsx(AA,{containerId:"fsElem"}),ie.jsx(jA,{}),ie.jsx(e_e,{emoji:s,onClick:()=>window.location.href="/"})]})},e_e=t=>{const e=G.useRef(null);return sl(()=>({onAdd:()=>mr(e.current),onRemove:()=>mr(e.current).remove()})),ie.jsx("div",{ref:e,style:{position:"absolute",top:0,right:44},children:ie.jsx("div",{className:"maplibregl-ctrl maplibregl-ctrl-group",children:ie.jsx(SF,{component:"button",underline:"none",title:"Switch to ATS/ETS2 Map",justifyContent:"center",onClick:()=>window.location.href="/",sx:{fontSize:"1.75em"},children:ie.jsx(qw,{children:t.emoji})})})})};function t_e(t){return t==="europe"?t:"usa"}/*!
 * Photo Sphere Viewer / Markers Plugin 5.13.4
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var n_e=Object.defineProperty,r_e=(t,e)=>{for(var n in e)n_e(t,n,{get:e[n],enumerable:!0})},i_e={};r_e(i_e,{EnterMarkerEvent:()=>p8,GotoMarkerDoneEvent:()=>_P,HideMarkersEvent:()=>h_,LeaveMarkerEvent:()=>h8,MarkerVisibilityEvent:()=>s8,MarkersPluginEvent:()=>zc,RenderMarkersListEvent:()=>k8,SelectMarkerEvent:()=>v8,SelectMarkerListEvent:()=>x8,SetMarkersEvent:()=>P8,ShowMarkersEvent:()=>d_,UnselectMarkerEvent:()=>S8});var zc=class extends wx{},i8=class o8 extends zc{constructor(e,n){super(o8.type),this.marker=e,this.visible=n}};i8.type="marker-visibility";var s8=i8,a8=class l8 extends zc{constructor(e){super(l8.type),this.marker=e}};a8.type="goto-marker-done";var _P=a8,c8=class u8 extends zc{constructor(e){super(u8.type),this.marker=e}};c8.type="leave-marker";var h8=c8,d8=class f8 extends zc{constructor(e){super(f8.type),this.marker=e}};d8.type="enter-marker";var p8=d8,m8=class g8 extends zc{constructor(e,n,r){super(g8.type),this.marker=e,this.doubleClick=n,this.rightClick=r}};m8.type="select-marker";var v8=m8,y8=class _8 extends zc{constructor(e){super(_8.type),this.marker=e}};y8.type="select-marker-list";var x8=y8,b8=class w8 extends zc{constructor(e){super(w8.type),this.marker=e}};b8.type="unselect-marker";var S8=b8,M8=class C8 extends zc{constructor(){super(C8.type)}};M8.type="hide-markers";var h_=M8,E8=class T8 extends zc{constructor(e){super(T8.type),this.markers=e}};E8.type="set-markers";var P8=E8,A8=class I8 extends zc{constructor(){super(I8.type)}};A8.type="show-markers";var d_=A8,R8=class L8 extends zc{constructor(e){super(L8.type),this.markers=e}};R8.type="render-markers-list";var k8=R8,o_e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,z_=class extends Aa{constructor(t){super(t,{className:"psv-markers-button",icon:o_e,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(d_.type,this),this.plugin.addEventListener(h_.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(d_.type,this),this.plugin.removeEventListener(h_.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof d_?this.toggleActive(!0):t instanceof h_&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};z_.id="markers";var D8=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,mw="http://www.w3.org/2000/svg",ro="psvMarker",s_e=Qn.dasherize(ro),C0="marker",Cv="markersList",xP={amount:2,duration:100,easing:"linear"},a_e=(t,e)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
    <h1 class="psv-panel-menu-title">${D8} ${e}</h1>
    <ul class="psv-panel-menu-list">
    ${t.map(n=>`
        <li data-${s_e}="${n.id}" class="psv-panel-menu-item" tabindex="0">
          ${n.type==="image"?`<span class="psv-panel-menu-item-icon"><img src="${n.definition}"/></span>`:""}
          <span class="psv-panel-menu-item-label">${n.getListContent()}</span>
        </li>
    `).join("")}
    </ul>
</div>
`,TS=class extends Aa{constructor(t){super(t,{className:" psv-markers-list-button",icon:D8,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(nr.ShowPanelEvent.type,this),this.viewer.addEventListener(nr.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(nr.ShowPanelEvent.type,this),this.viewer.removeEventListener(nr.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof nr.ShowPanelEvent?this.toggleActive(t.panelId===Cv):t instanceof nr.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};TS.id="markersList";var NO=new At,l_e=new Sp,BO=new At,c_e=class extends Zs{constructor(t=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(e){e.element instanceof e.element.ownerDocument.defaultView.Element&&e.element.parentNode!==null&&e.element.remove()})})}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this}},ph=new Pi,u_e=new Pi,h_e=class{constructor(t={}){const e=this;let n,r,i,l;const c={camera:{style:""},objects:new WeakMap},s=t.element!==void 0?t.element:document.createElement("div");s.style.overflow="hidden",this.domElement=s;const p=document.createElement("div");p.style.transformOrigin="0 0",p.style.pointerEvents="none",s.appendChild(p);const y=document.createElement("div");y.style.transformStyle="preserve-3d",p.appendChild(y),this.getSize=function(){return{width:n,height:r}},this.render=function(D,R){const L=R.projectionMatrix.elements[5]*l;R.view&&R.view.enabled?(p.style.transform=`translate( ${-R.view.offsetX*(n/R.view.width)}px, ${-R.view.offsetY*(r/R.view.height)}px )`,p.style.transform+=`scale( ${R.view.fullWidth/R.view.width}, ${R.view.fullHeight/R.view.height} )`):p.style.transform="",D.matrixWorldAutoUpdate===!0&&D.updateMatrixWorld(),R.parent===null&&R.matrixWorldAutoUpdate===!0&&R.updateMatrixWorld();let V,B;R.isOrthographicCamera&&(V=-(R.right+R.left)/2,B=(R.top+R.bottom)/2);const H=R.view&&R.view.enabled?R.view.height/R.view.fullHeight:1,q=R.isOrthographicCamera?`scale( ${H} )scale(`+L+")translate("+_(V)+"px,"+_(B)+"px)"+w(R.matrixWorldInverse):`scale( ${H} )translateZ(`+L+"px)"+w(R.matrixWorldInverse),ee=(R.isPerspectiveCamera?"perspective("+L+"px) ":"")+q+"translate("+i+"px,"+l+"px)";c.camera.style!==ee&&(y.style.transform=ee,c.camera.style=ee),I(D,D,R)},this.setSize=function(D,R){n=D,r=R,i=n/2,l=r/2,s.style.width=D+"px",s.style.height=R+"px",p.style.width=D+"px",p.style.height=R+"px",y.style.width=D+"px",y.style.height=R+"px"};function _(D){return Math.abs(D)<1e-10?0:D}function w(D){const R=D.elements;return"matrix3d("+_(R[0])+","+_(-R[1])+","+_(R[2])+","+_(R[3])+","+_(R[4])+","+_(-R[5])+","+_(R[6])+","+_(R[7])+","+_(R[8])+","+_(-R[9])+","+_(R[10])+","+_(R[11])+","+_(R[12])+","+_(-R[13])+","+_(R[14])+","+_(R[15])+")"}function S(D){const R=D.elements;return"translate(-50%,-50%)"+("matrix3d("+_(R[0])+","+_(R[1])+","+_(R[2])+","+_(R[3])+","+_(-R[4])+","+_(-R[5])+","+_(-R[6])+","+_(-R[7])+","+_(R[8])+","+_(R[9])+","+_(R[10])+","+_(R[11])+","+_(R[12])+","+_(R[13])+","+_(R[14])+","+_(R[15])+")")}function M(D){D.isCSS3DObject&&(D.element.style.display="none");for(let R=0,L=D.children.length;R<L;R++)M(D.children[R])}function I(D,R,L,V){if(D.visible===!1){M(D);return}if(D.isCSS3DObject){const B=D.layers.test(L.layers)===!0,H=D.element;if(H.style.display=B===!0?"":"none",B===!0){D.onBeforeRender(e,R,L);let q;D.isCSS3DSprite?(ph.copy(L.matrixWorldInverse),ph.transpose(),D.rotation2D!==0&&ph.multiply(u_e.makeRotationZ(D.rotation2D)),D.matrixWorld.decompose(NO,l_e,BO),ph.setPosition(NO),ph.scale(BO),ph.elements[3]=0,ph.elements[7]=0,ph.elements[11]=0,ph.elements[15]=1,q=S(ph)):q=S(D.matrixWorld);const X=c.objects.get(D);if(X===void 0||X.style!==q){H.style.transform=q;const ee={style:q};c.objects.set(D,ee)}H.parentNode!==y&&y.appendChild(H),D.onAfterRender(e,R,L)}}for(let B=0,H=D.children.length;B<H;B++)I(D.children[B],R,L)}}},d_e=class{constructor(t){this.viewer=t,this.element=document.createElement("div"),this.element.className="psv-markers-css3d-container",this.renderer=new h_e({element:this.element}),this.scene=new nw,this.intersectionObserver=new IntersectionObserver(e=>{e.forEach(n=>{const r=n.target[ro];r.config.visible&&(r.viewportIntersection=n.isIntersecting)})},{root:this.element}),t.addEventListener(nr.ReadyEvent.type,this,{once:!0}),t.addEventListener(nr.SizeUpdatedEvent.type,this),t.addEventListener(nr.RenderEvent.type,this)}handleEvent(t){switch(t.type){case nr.ReadyEvent.type:case nr.SizeUpdatedEvent.type:this.updateSize();break;case nr.RenderEvent.type:this.render();break}}destroy(){this.viewer.removeEventListener(nr.ReadyEvent.type,this),this.viewer.removeEventListener(nr.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(nr.RenderEvent.type,this),this.intersectionObserver.disconnect()}updateSize(){const t=this.viewer.getSize();this.renderer.setSize(t.width,t.height)}render(){this.renderer.render(this.scene,this.viewer.renderer.camera)}addObject(t){this.scene.add(t.threeElement),this.intersectionObserver.observe(t.domElement)}removeObject(t){this.scene.remove(t.threeElement),this.intersectionObserver.unobserve(t.domElement)}},Sb=(t=>(t.image="image",t.html="html",t.element="element",t.imageLayer="imageLayer",t.videoLayer="videoLayer",t.elementLayer="elementLayer",t.polygon="polygon",t.polygonPixels="polygonPixels",t.polyline="polyline",t.polylinePixels="polylinePixels",t.square="square",t.rect="rect",t.circle="circle",t.ellipse="ellipse",t.path="path",t))(Sb||{});function bP(t,e=!1){const n=[];if(Object.keys(Sb).forEach(r=>{t[r]&&n.push(r)}),n.length===0&&!e)throw new jn(`missing marker content, either ${Object.keys(Sb).join(", ")}`);if(n.length>1)throw new jn(`multiple marker content, either ${Object.keys(Sb).join(", ")}`);return n[0]}var z8=class{constructor(t,e,n){if(this.viewer=t,this.plugin=e,this.state={anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!n.id)throw new jn("missing marker id");this.type=bP(n),this.createElement(),this.update(n)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return null}get threeElement(){return null}get video(){return null}destroy(){delete this.viewer,delete this.plugin,delete this.element,this.hideTooltip()}is3d(){return!1}isNormal(){return!1}isPoly(){return!1}isSvg(){return!1}isCss3d(){return!1}update(t){const e=bP(t,!0);if(e!==void 0&&e!==this.type)throw new jn(`cannot change marker ${t.id} type`);if(this.config=Qn.deepmerge(this.config,t),typeof this.config.tooltip=="string"&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),Qn.isNil(this.config.visible)&&(this.config.visible=!0),Qn.isNil(this.config.zIndex)&&(this.config.zIndex=1),Qn.isNil(this.config.opacity)&&(this.config.opacity=1),this.config.rotation){const n=this.config.rotation;typeof n=="object"?this.config.rotation={yaw:n.yaw?Qn.parseAngle(n.yaw,!0,!1):0,pitch:n.pitch?Qn.parseAngle(n.pitch,!0,!1):0,roll:n.roll?Qn.parseAngle(n.roll,!0,!1):0}:this.config.rotation={yaw:0,pitch:0,roll:Qn.parseAngle(n,!0,!1)}}else this.config.rotation={yaw:0,pitch:0,roll:0};this.state.anchor=Qn.parsePoint(this.config.anchor)}getListContent(){return this.config.listContent?this.config.listContent:this.config.tooltip?.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(t,e,n=!1){if(this.state.visible&&this.config.tooltip?.content&&this.state.position2D){const r={...this.config.tooltip,style:{pointerEvents:this.state.staticTooltip?"auto":"none"},data:this,top:0,left:0};if(this.isPoly()||this.is3d()||this.isCss3d())if(t||e){const i=Qn.getPosition(this.viewer.container);r.top=e-i.y+10,r.left=t-i.x,r.box={width:20,height:20}}else r.top=this.state.position2D.y,r.left=this.state.position2D.x;else{const i=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);let l=this.state.size.width,c=this.state.size.height;this.config.hoverScale&&!this.state.staticTooltip&&(l*=this.config.hoverScale.amount,c*=this.config.hoverScale.amount),r.top=i.y-c*this.state.anchor.y+c/2,r.left=i.x-l*this.state.anchor.x+l/2,r.box={width:l,height:c}}this.tooltip?n?this.tooltip.update(this.config.tooltip.content,r):this.tooltip.move(r):this.tooltip=this.viewer.createTooltip(r)}}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}},OI=class extends z8{get domElement(){return this.element}constructor(t,e,n){super(t,e,n)}afterCreateElement(){this.element[ro]=this}destroy(){delete this.element[ro],super.destroy()}update(t){super.update(t);const e=this.domElement;e.id=`psv-marker-${this.config.id}`,e.setAttribute("class","psv-marker"),this.state.visible&&e.classList.add("psv-marker--visible"),this.config.tooltip&&e.classList.add("psv-marker--has-tooltip"),this.config.content&&e.classList.add("psv-marker--has-content"),this.config.className&&Qn.addClasses(e,this.config.className),e.style.opacity=`${this.config.opacity}`,e.style.zIndex=`${30+this.config.zIndex}`,this.config.style&&Object.assign(e.style,this.config.style)}},gw=class extends OI{constructor(t,e,n){super(t,e,n)}afterCreateElement(){super.afterCreateElement(),this.domElement.addEventListener("transitionend",()=>{this.domElement.style.transition=""})}render({viewerPosition:t,zoomLevel:e,hoveringMarker:n}){this.__updateSize();const r=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);return r.x-=this.state.size.width*this.state.anchor.x,r.y-=this.state.size.height*this.state.anchor.y,this.state.positions3D[0].dot(this.viewer.state.direction)>0&&r.x+this.state.size.width>=0&&r.x-this.state.size.width<=this.viewer.state.size.width&&r.y+this.state.size.height>=0&&r.y-this.state.size.height<=this.viewer.state.size.height?(this.domElement.style.translate=`${r.x}px ${r.y}px 0px`,this.applyScale({zoomLevel:e,viewerPosition:t,mouseover:this===n}),r):null}update(t){if(super.update(t),!Qn.isExtendedPosition(this.config.position))throw new jn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(n){throw new jn(`invalid marker ${this.id} position`,n)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.domElement;e.classList.add("psv-marker--normal"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),typeof this.config.hoverScale=="boolean"?this.config.hoverScale=this.config.hoverScale?this.plugin.config.defaultHoverScale||xP:null:typeof this.config.hoverScale=="number"?this.config.hoverScale={amount:this.config.hoverScale}:this.config.hoverScale||(this.config.hoverScale=this.plugin.config.defaultHoverScale),this.config.hoverScale&&(this.config.hoverScale={...this.plugin.config.defaultHoverScale,...this.config.hoverScale}),e.style.rotate=this.config.rotation.roll!==0?Wr.radToDeg(this.config.rotation.roll)+"deg":null,e.style.transformOrigin=`${this.state.anchor.x*100}% ${this.state.anchor.y*100}%`}__updateSize(){if(!this.needsUpdateSize)return;const t=this.domElement,e=!this.state.visible||!this.state.size;if(e&&t.classList.add("psv-marker--transparent"),this.isSvg()){const n=t.firstElementChild.getBoundingClientRect();this.state.size={width:n.width,height:n.height}}else this.state.size={width:t.offsetWidth,height:t.offsetHeight};e&&t.classList.remove("psv-marker--transparent"),this.isSvg()&&(t.style.width=this.state.size.width+"px",t.style.height=this.state.size.height+"px"),this.type!=="element"&&(this.needsUpdateSize=!1)}applyScale({zoomLevel:t,viewerPosition:e,mouseover:n}){n!==null&&this.config.hoverScale&&(this.domElement.style.transition=`scale ${this.config.hoverScale.duration}ms ${this.config.hoverScale.easing}`);let r=1;if(typeof this.config.scale=="function")r=this.config.scale(t,e);else if(this.config.scale){if(Array.isArray(this.config.scale.zoom)){const[i,l]=this.config.scale.zoom;r*=i+(l-i)*uy.EASINGS.inQuad(t/100)}if(Array.isArray(this.config.scale.yaw)){const[i,l]=this.config.scale.yaw,c=Wr.degToRad(this.viewer.state.hFov)/2,s=Math.abs(Qn.getShortestArc(this.state.position.yaw,e.yaw));r*=l+(i-l)*uy.EASINGS.outQuad(Math.max(0,(c-s)/c))}}n&&this.config.hoverScale&&(r*=this.config.hoverScale.amount),this.domElement.style.scale=`${r}`}},f_e=`// https://www.8thwall.com/playground/chromakey-threejs

uniform sampler2D map;
uniform float alpha;
uniform bool keying;
uniform vec3 color;
uniform float similarity;
uniform float smoothness;
uniform float spill;

varying vec2 vUv;

vec2 RGBtoUV(vec3 rgb) {
    return vec2(
        rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,
        rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5
    );
}

void main(void) {
    gl_FragColor = texture2D(map, vUv);

    if (keying) {
        float chromaDist = distance(RGBtoUV(gl_FragColor.rgb), RGBtoUV(color));

        float baseMask = chromaDist - similarity;
        float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);
        gl_FragColor.a *= fullMask * alpha;

        float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);
        float desat = clamp(gl_FragColor.r * 0.2126 + gl_FragColor.g * 0.7152 + gl_FragColor.b * 0.0722, 0., 1.);
        gl_FragColor.rgb = mix(vec3(desat, desat, desat), gl_FragColor.rgb, spillVal);
    } else {
        gl_FragColor.a *= alpha;
    }
}
`,p_e=`varying vec2 vUv;
uniform vec2 repeat;
uniform vec2 offset;

void main() {
    vUv = uv * repeat + offset;
    gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );
}
`,m_e=class extends Yd{get map(){return this.uniforms.map.value}set map(t){this.uniforms.map.value=t}set alpha(t){this.uniforms.alpha.value=t}get offset(){return this.uniforms.offset.value}get repeat(){return this.uniforms.repeat.value}set chromaKey(t){this.uniforms.keying.value=t?.enabled===!0,t?.enabled&&(typeof t.color=="object"&&"r"in t.color?this.uniforms.color.value.set(t.color.r/255,t.color.g/255,t.color.b/255):this.uniforms.color.value.set(t.color??65280),this.uniforms.similarity.value=t.similarity??.2,this.uniforms.smoothness.value=t.smoothness??.2)}constructor(t){super({transparent:!0,depthTest:!1,depthWrite:!1,uniforms:{map:{value:t?.map},repeat:{value:new gi(1,1)},offset:{value:new gi(0,0)},alpha:{value:t?.alpha??1},keying:{value:!1},color:{value:new bi(65280)},similarity:{value:.2},smoothness:{value:.2},spill:{value:.1}},vertexShader:p_e,fragmentShader:f_e}),this.chromaKey=t?.chromaKey}};function g_e({src:t,withCredentials:e,muted:n,autoplay:r}){const i=document.createElement("video");return i.crossOrigin=e?"use-credentials":"anonymous",i.loop=!0,i.playsInline=!0,i.autoplay=r,i.muted=n,i.preload="metadata",t instanceof MediaStream?i.srcObject=t:i.src=t,i}function v_e(t,e,n){const[r,i]=t,[l,c]=e,s=Qn.greatArcDistance(t,e),p=Math.sin((1-n)*s)/Math.sin(s),y=Math.sin(n*s)/Math.sin(s),_=p*Math.cos(i)*Math.cos(r)+y*Math.cos(c)*Math.cos(l),w=p*Math.cos(i)*Math.sin(r)+y*Math.cos(c)*Math.sin(l),S=p*Math.sin(i)+y*Math.sin(c);return[Math.atan2(w,_),Math.atan2(S,Math.sqrt(_*_+w*w))]}function y_e(t){const e=[t[0]];let n=0;for(let r=1;r<t.length;r++){const i=t[r-1][0]-t[r][0];i>Math.PI?n+=1:i<-Math.PI&&(n-=1),e.push([t[r][0]+n*2*Math.PI,t[r][1]])}return e}function O8(t){return t.reduce((e,n)=>e.add(n),new At).normalize()}function __e(t){const e=y_e(t);let n=0;const r=[];for(let l=0;l<e.length-1;l++){const c=Qn.greatArcDistance(e[l],e[l+1])*uy.SPHERE_RADIUS;r.push(c),n+=c}let i=0;for(let l=0;l<e.length-1;l++){if(i+r[l]>n/2){const c=(n/2-i)/r[l];return v_e(e[l],e[l+1],c)}i+=r[l]}return e[Math.round(e.length/2)]}var Z1=new At,UO=new At,DE=new At,$O=new At,VO=new At,jO=new At;function x_e(t,e,n){Z1.copy(n).normalize(),UO.crossVectors(t,e).normalize(),DE.crossVectors(UO,t).normalize(),$O.copy(t).multiplyScalar(-Z1.dot(DE)),VO.copy(DE).multiplyScalar(Z1.dot(t));const r=new At().addVectors($O,VO).normalize();return jO.crossVectors(r,Z1),r.applyAxisAngle(jO,.01).multiplyScalar(uy.SPHERE_RADIUS)}var b_e=class extends z8{get threeElement(){return this.element}get threeMesh(){return this.threeElement.children[0]}get video(){return this.type==="videoLayer"?this.threeMesh.material.map.image:null}constructor(t,e,n){super(t,e,n)}is3d(){return!0}createElement(){const t=new m_e({alpha:0}),e=new xx(1,1),n=new Ja(e,t);n.userData={[ro]:this},Object.defineProperty(n,"visible",{enumerable:!0,get:function(){return this.userData[ro].config.visible},set:function(r){this.userData[ro].config.visible=r}}),this.element=new Kf().add(n),this.type==="videoLayer"&&this.viewer.needsContinuousUpdate(!0)}destroy(){delete this.threeMesh.userData[ro],this.type==="videoLayer"&&(this.video.pause(),this.viewer.needsContinuousUpdate(!1)),super.destroy()}render(){return this.viewer.renderer.isObjectVisible(this.threeMesh)?this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position):null}update(t){super.update(t);const e=this.threeMesh,n=e.parent,r=e.material;if(Qn.isExtendedPosition(this.config.position)){try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(l){throw new jn(`invalid marker ${this.id} position`,l)}if(!this.config.size)throw new jn(`missing marker ${this.id} size`);this.state.size=this.config.size,e.scale.set(this.config.size.width/100,this.config.size.height/100,1),e.position.set(e.scale.x*(.5-this.state.anchor.x),e.scale.y*(this.state.anchor.y-.5),0),e.rotation.set(0,0,0),this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position,n.position),n.lookAt(0,n.position.y,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll);const i=e.geometry.getAttribute("position");this.state.positions3D=[0,1,3,2].map(l=>{const c=new At;return c.fromBufferAttribute(i,l),e.localToWorld(c)})}else{if(this.config.position?.length!==4)throw new jn(`missing marker ${this.id} position`);let i;try{i=this.config.position.map(p=>this.viewer.dataHelper.cleanPosition(p))}catch(p){throw new jn(`invalid marker ${this.id} position`,p)}const l=i.map(p=>this.viewer.dataHelper.sphericalCoordsToVector3(p)),c=O8(l);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(c),this.state.positions3D=l;const s=e.geometry.getAttribute("position");[l[0],l[1],l[3],l[2]].forEach((p,y)=>{s.setX(y,p.x),s.setY(y,p.y),s.setZ(y,p.z)}),s.needsUpdate=!0,this.__setTextureWrap(r)}switch(this.type){case"videoLayer":if(this.definition!==this.config.videoLayer){r.map?.dispose();const i=g_e({src:this.config.videoLayer,withCredentials:this.viewer.config.withCredentials(this.config.videoLayer),muted:!0,autoplay:this.config.autoplay??!0}),l=new Hde(i);r.map=l,r.alpha=0,i.addEventListener("loadedmetadata",()=>{this.viewer&&(r.alpha=this.config.opacity,Qn.isExtendedPosition(this.config.position)||(e.material.userData[ro]={width:i.videoWidth,height:i.videoHeight},this.__setTextureWrap(r)))},{once:!0}),i.autoplay&&i.play(),this.definition=this.config.videoLayer}else r.alpha=this.config.opacity;break;case"imageLayer":if(this.definition!==this.config.imageLayer){r.map?.dispose();const i=new Xs;r.map=i,r.alpha=0,this.viewer.textureLoader.loadImage(this.config.imageLayer).then(l=>{this.viewer&&(Qn.isExtendedPosition(this.config.position)||(e.material.userData[ro]={width:l.width,height:l.height},this.__setTextureWrap(r)),i.image=l,i.anisotropy=4,i.needsUpdate=!0,r.alpha=this.config.opacity,this.viewer.needsUpdate())}),this.definition=this.config.imageLayer}else r.alpha=this.config.opacity;break}r.chromaKey=this.config.chromaKey,e.renderOrder=1e3+this.config.zIndex,e.geometry.boundingBox=null}__setTextureWrap(t){const e=t.userData[ro];if(!e||!e.height||!e.width){t.repeat.set(1,1),t.offset.set(0,0);return}const n=this.config.position.map(w=>this.viewer.dataHelper.cleanPosition(w)),r=Qn.greatArcDistance([n[0].yaw,n[0].pitch],[n[1].yaw,n[1].pitch]),i=Qn.greatArcDistance([n[3].yaw,n[3].pitch],[n[2].yaw,n[2].pitch]),l=Qn.greatArcDistance([n[1].yaw,n[1].pitch],[n[2].yaw,n[2].pitch]),c=Qn.greatArcDistance([n[0].yaw,n[0].pitch],[n[3].yaw,n[3].pitch]),s=(r+i)/(l+c),p=e.width/e.height;let y=0,_=0;s<p?y=p-s:_=1/p-1/s,t.repeat.set(1-y,1-_),t.offset.set(y/2,_/2)}},w_e=class extends OI{constructor(t,e,n){super(t,e,n),this.viewportIntersection=!1}get threeElement(){return this.object}isCss3d(){return!0}createElement(){this.element=document.createElement("div"),this.object=new c_e(this.element),this.object.userData={[ro]:this},Object.defineProperty(this.object,"visible",{enumerable:!0,get:function(){return this.userData[ro].config.visible},set:function(t){this.userData[ro].config.visible=t}}),this.afterCreateElement()}destroy(){delete this.object.userData[ro],delete this.object,super.destroy()}render({viewerPosition:t,zoomLevel:e}){const n=this.domElement;if(this.state.size={width:n.offsetWidth,height:n.offsetHeight},this.state.positions3D[0].dot(this.viewer.state.direction)>0&&this.viewportIntersection){const i=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position);return this.config.elementLayer.updateMarker?.({marker:this,position:i,viewerPosition:t,zoomLevel:e,viewerSize:this.viewer.state.size}),i}else return null}update(t){if(super.update(t),!Qn.isExtendedPosition(this.config.position))throw new jn(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(r){throw new jn(`invalid marker ${this.id} position`,r)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.threeElement,n=this.domElement;n.classList.add("psv-marker--css3d"),n.childNodes.forEach(r=>r.remove()),n.appendChild(this.config.elementLayer),this.config.elementLayer.style.display="block",e.position.copy(this.state.positions3D[0]).multiplyScalar(100),e.lookAt(0,this.state.positions3D[0].y*100,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll)}},S_e=class extends gw{constructor(t,e,n){super(t,e,n)}isNormal(){return!0}createElement(){this.element=document.createElement("div"),this.afterCreateElement()}render(t){const e=super.render(t);return e&&this.type==="element"&&this.config.element.updateMarker?.({marker:this,position:e,viewerPosition:t.viewerPosition,zoomLevel:t.zoomLevel,viewerSize:this.viewer.state.size}),e}update(t){super.update(t);const e=this.domElement;if(this.config.image&&!this.config.size)throw new jn(`missing marker ${this.id} size`);switch(this.config.size?(this.needsUpdateSize=!1,this.state.size=this.config.size,e.style.width=this.config.size.width+"px",e.style.height=this.config.size.height+"px"):this.needsUpdateSize=!0,this.type){case"image":this.definition=this.config.image,e.style.backgroundImage=`url("${this.config.image}")`;break;case"html":this.definition=this.config.html,e.innerHTML=this.config.html;break;case"element":this.definition!==this.config.element&&(this.definition=this.config.element,e.childNodes.forEach(n=>n.remove()),e.appendChild(this.config.element),this.config.element.style.display="block");break}}},M_e=class extends OI{constructor(t,e,n){super(t,e,n)}createElement(){this.element=document.createElementNS(mw,"path"),this.element[ro]=this}isPoly(){return!0}get isPixels(){return this.type==="polygonPixels"||this.type==="polylinePixels"}get isPolygon(){return this.type==="polygon"||this.type==="polygonPixels"}get isPolyline(){return this.type==="polyline"||this.type==="polylinePixels"}get coords(){return this.definition}render(){const t=this.__getAllPolyPositions();if(t[0].length>(this.isPolygon?2:1)){const n=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position),r=t.filter(i=>i.length>0).map(i=>{let l="M";return l+=i.map(c=>`${c.x-n.x},${c.y-n.y}`).join("L"),this.isPolygon&&(l+="Z"),l}).join(" ");return this.domElement.setAttributeNS(null,"d",r),this.domElement.setAttributeNS(null,"transform",`translate(${n.x} ${n.y})`),n}else return null}update(t){super.update(t);const e=this.domElement;e.classList.add("psv-marker--poly"),this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach(([n,r])=>{e.setAttributeNS(null,Qn.dasherize(n),r)}),this.isPolyline&&!this.config.svgStyle.fill&&e.setAttributeNS(null,"fill","none")):this.isPolygon?e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline&&(e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke","rgb(0,0,0)"));try{let n=this.config[this.type];if(!Array.isArray(n[0])&&typeof n[0]!="object")for(let r=0;r<n.length;r++)n.splice(r,2,[n[r],n[r+1]]);if(!Array.isArray(n[0][0])&&typeof n[0][0]!="object"&&(n=[n]),this.isPolyline&&n.length>1)throw new jn("polylines cannot have holes");this.isPixels?this.definition=n.map(r=>r.map(i=>{let l;return Qn.isExtendedPosition(i)?l=this.viewer.dataHelper.cleanPosition(i):l=this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:i[0],textureY:i[1]}),[l.yaw,l.pitch]})):this.definition=n.map(r=>r.map(i=>{let l;return Qn.isExtendedPosition(i)?l=this.viewer.dataHelper.cleanPosition(i):l=this.viewer.dataHelper.cleanPosition({yaw:i[0],pitch:i[1]}),[l.yaw,l.pitch]}))}catch(n){throw new jn(`invalid marker ${this.id} position`,n)}if(this.positions3D=this.coords.map(n=>n.map(r=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:r[0],pitch:r[1]}))),this.isPolygon){const n=O8(this.positions3D[0]);this.state.position=this.viewer.dataHelper.vector3ToSphericalCoords(n)}else{const n=__e(this.coords[0]);this.state.position={yaw:n[0],pitch:n[1]}}this.state.positions3D=this.positions3D[0]}__getAllPolyPositions(){return this.positions3D.map(t=>this.__getPolyPositions(t))}__getPolyPositions(t){const e=t.length,n=t.map(i=>({vector:i,visible:i.dot(this.viewer.state.direction)>0})),r=[];return n.forEach((i,l)=>{i.visible||[l===0?n[e-1]:n[l-1],l===e-1?n[0]:n[l+1]].forEach(s=>{s.visible&&r.push({visible:s.vector,invisible:i.vector,index:l})})}),r.reverse().forEach(i=>{n.splice(i.index,0,{vector:x_e(i.visible,i.invisible,this.viewer.state.direction),visible:!0})}),n.filter(i=>i.visible).map(i=>this.viewer.dataHelper.vector3ToViewerCoords(i.vector))}},C_e=class extends gw{get svgElement(){return this.domElement.firstElementChild}constructor(t,e,n){super(t,e,n)}isSvg(){return!0}createElement(){const t=this.type==="square"?"rect":this.type,e=document.createElementNS(mw,t);this.element=document.createElementNS(mw,"svg"),this.element.appendChild(e),this.afterCreateElement()}update(t){super.update(t);const e=this.svgElement;switch(this.needsUpdateSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path};break}Object.entries(this.definition).forEach(([n,r])=>{e.setAttributeNS(null,n,r)}),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach(([n,r])=>{e.setAttributeNS(null,Qn.dasherize(n),r)}):e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)")}},E_e=Qn.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null,defaultHoverScale:null},{defaultHoverScale(t){return t?(t===!0&&(t=xP),typeof t=="number"&&(t={amount:t}),{...xP,...t}):null}});function T_e(t){switch(bP(t,!1)){case"image":case"html":case"element":return S_e;case"imageLayer":case"videoLayer":return b_e;case"elementLayer":return w_e;case"polygon":case"polyline":case"polygonPixels":case"polylinePixels":return M_e;case"square":case"rect":case"circle":case"ellipse":case"path":return C_e;default:throw new jn("invalid marker type")}}var Ex=class F8 extends II{constructor(e,n){super(e,n),this.markers={},this.state={allVisible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null,needsReRender:!1,lastClientX:null,lastClientY:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",r=>r.preventDefault()),this.svgContainer=document.createElementNS(mw,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.css3DContainer=new d_e(e),this.container.appendChild(this.css3DContainer.element),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0)}static withConfig(e){return[F8,e]}init(){super.init(),Qn.checkStylesheet(this.viewer.container,"markers-plugin"),this.viewer.addEventListener(nr.ClickEvent.type,this),this.viewer.addEventListener(nr.DoubleClickEvent.type,this),this.viewer.addEventListener(nr.RenderEvent.type,this),this.viewer.addEventListener(nr.ConfigChangedEvent.type,this),this.viewer.addEventListener(nr.ObjectEnterEvent.type,this),this.viewer.addEventListener(nr.ObjectHoverEvent.type,this),this.viewer.addEventListener(nr.ObjectLeaveEvent.type,this),this.viewer.addEventListener(nr.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(ro),this.viewer.removeEventListener(nr.ClickEvent.type,this),this.viewer.removeEventListener(nr.DoubleClickEvent.type,this),this.viewer.removeEventListener(nr.RenderEvent.type,this),this.viewer.removeEventListener(nr.ObjectEnterEvent.type,this),this.viewer.removeEventListener(nr.ObjectHoverEvent.type,this),this.viewer.removeEventListener(nr.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(nr.ReadyEvent.type,this),this.css3DContainer.destroy(),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(e){switch(e.type){case nr.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case nr.RenderEvent.type:this.renderMarkers();break;case nr.ClickEvent.type:this.__onClick(e,!1);break;case nr.DoubleClickEvent.type:this.__onClick(e,!0);break;case nr.ObjectEnterEvent.type:case nr.ObjectLeaveEvent.type:case nr.ObjectHoverEvent.type:if(e.userDataKey===ro){const n=e.originalEvent,r=e.object.userData[ro];switch(e.type){case nr.ObjectEnterEvent.type:r.config.style?.cursor?this.viewer.setCursor(r.config.style.cursor):(r.config.tooltip||r.config.content)&&this.viewer.setCursor("pointer"),this.__onEnterMarker(n,r);break;case nr.ObjectLeaveEvent.type:this.viewer.setCursor(null),this.__onLeaveMarker(r);break;case nr.ObjectHoverEvent.type:this.__onHoverMarker(n,r);break}}break;case"mouseenter":{const n=this.__getTargetMarker(Qn.getEventTarget(e));this.__onEnterMarker(e,n);break}case"mouseleave":{const n=this.__getTargetMarker(Qn.getEventTarget(e));this.__onLeaveMarker(n);break}case"mousemove":{const n=this.__getTargetMarker(Qn.getEventTarget(e),!0);this.__onHoverMarker(e,n);break}}}toggleAllMarkers(){this.state.allVisible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.allVisible=!0,Object.values(this.markers).forEach(e=>{e.config.visible=!0}),this.renderMarkers(),this.dispatchEvent(new d_)}hideAllMarkers(){this.state.allVisible=!1,Object.values(this.markers).forEach(e=>{e.config.visible=!1}),this.renderMarkers(),this.dispatchEvent(new h_)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach(e=>{e.state.staticTooltip=!0,e.showTooltip()})}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach(e=>{e.state.staticTooltip=!1,e.hideTooltip()})}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(e,n=!0){if(this.markers[e.id])throw new jn(`marker "${e.id}" already exists`);const r=new(T_e(e))(this.viewer,this,e);r.isPoly()?this.svgContainer.appendChild(r.domElement):r.isCss3d()?this.css3DContainer.addObject(r):r.is3d()?this.viewer.renderer.addObject(r.threeElement):this.container.appendChild(r.domElement),this.markers[r.id]=r,this.state.showAllTooltips&&(r.state.staticTooltip=!0),n&&this.__afterChangeMarkers()}getMarker(e){const n=typeof e=="object"?e.id:e;if(!this.markers[n])throw new jn(`cannot find marker "${n}"`);return this.markers[n]}getCurrentMarker(){return this.state.currentMarker}updateMarker(e,n=!0){const r=this.getMarker(e.id);r.update(e),n&&(this.__afterChangeMarkers(),(r===this.state.hoveringMarker&&r.config.tooltip?.trigger==="hover"||r.state.staticTooltip)&&r.showTooltip(this.state.lastClientX,this.state.lastClientY,!0))}removeMarker(e,n=!0){const r=this.getMarker(e);r.isPoly()?this.svgContainer.removeChild(r.domElement):r.isCss3d()?this.css3DContainer.removeObject(r):r.is3d()?this.viewer.renderer.removeObject(r.threeElement):this.container.removeChild(r.domElement),this.state.hoveringMarker===r&&(this.state.hoveringMarker=null),this.state.currentMarker===r&&(this.state.currentMarker=null),r.destroy(),delete this.markers[r.id],n&&this.__afterChangeMarkers()}removeMarkers(e,n=!0){e.forEach(r=>this.removeMarker(r,!1)),n&&this.__afterChangeMarkers()}setMarkers(e,n=!0){this.clearMarkers(!1),e?.forEach(r=>{this.addMarker(r,!1)}),n&&this.__afterChangeMarkers()}clearMarkers(e=!0){Object.keys(this.markers).forEach(n=>{this.removeMarker(n,!1)}),e&&this.__afterChangeMarkers()}gotoMarker(e,n=this.config.gotoMarkerSpeed){const r=this.getMarker(e);return n?this.viewer.animate({...r.state.position,zoom:r.config.zoomLvl,speed:n}).then(()=>{this.dispatchEvent(new _P(r))}):(this.viewer.rotate(r.state.position),Qn.isNil(r.config.zoomLvl)||this.viewer.zoom(r.config.zoomLvl),this.dispatchEvent(new _P(r)),Promise.resolve())}hideMarker(e){this.toggleMarker(e,!1)}showMarker(e){this.toggleMarker(e,!0)}showMarkerTooltip(e){const n=this.getMarker(e);n.state.staticTooltip=!0,n.showTooltip()}hideMarkerTooltip(e){const n=this.getMarker(e);n.state.staticTooltip=!1,n.hideTooltip()}toggleMarker(e,n){const r=this.getMarker(e);r.config.visible=Qn.isNil(n)?!r.config.visible:n,this.renderMarkers()}showMarkerPanel(e){const n=this.getMarker(e);n.config.content?this.viewer.panel.show({id:C0,content:n.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(C0)}toggleMarkersList(){this.viewer.panel.isVisible(Cv)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let e=[];Object.values(this.markers).forEach(r=>{r.config.visible&&!r.config.hideList&&e.push(r)});const n=new k8(e);this.dispatchEvent(n),e=n.markers,this.viewer.panel.show({id:Cv,content:a_e(e,this.viewer.config.lang[z_.id]),noMargin:!0,clickHandler:r=>{const i=Qn.getClosest(r,".psv-panel-menu-item"),l=i?i.dataset[ro]:void 0;if(l){const c=this.getMarker(l);this.dispatchEvent(new x8(c)),this.gotoMarker(c.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(Cv)}renderMarkers(){if(this.state.needsReRender){this.state.needsReRender=!1;return}const e=this.viewer.getZoomLevel(),n=this.viewer.getPosition(),r=this.state.hoveringMarker;Object.values(this.markers).forEach(i=>{let l=i.config.visible,c=!1,s=null;l&&(s=i.render({viewerPosition:n,zoomLevel:e,hoveringMarker:r}),l=!!s),c=i.state.visible!==l,i.state.visible=l,i.state.position2D=s,i.domElement&&Qn.toggleClass(i.domElement,"psv-marker--visible",l),l?i.state.staticTooltip?i.showTooltip():i!==this.state.hoveringMarker&&i.hideTooltip():i.hideTooltip(),c&&(this.dispatchEvent(new s8(i,l)),(i.is3d()||i.isCss3d())&&(this.state.needsReRender=!0))}),this.state.needsReRender&&this.viewer.needsUpdate()}__getTargetMarker(e,n=!1){if(e instanceof Node){const r=n?Qn.getClosest(e,".psv-marker"):e;return r?r[ro]:void 0}else return Array.isArray(e)?e.map(r=>r.userData[ro]).filter(r=>!!r).sort((r,i)=>i.config.zIndex-r.config.zIndex)[0]:null}__onEnterMarker(e,n){n&&(this.state.hoveringMarker=n,this.state.lastClientX=e.clientX,this.state.lastClientY=e.clientY,this.dispatchEvent(new p8(n)),n instanceof gw&&n.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!0}),!n.state.staticTooltip&&n.config.tooltip?.trigger==="hover"&&n.showTooltip(e.clientX,e.clientY))}__onLeaveMarker(e){e&&(this.dispatchEvent(new h8(e)),e instanceof gw&&e.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!1}),this.state.hoveringMarker=null,!e.state.staticTooltip&&e.config.tooltip?.trigger==="hover"?e.hideTooltip():e.state.staticTooltip&&e.showTooltip())}__onHoverMarker(e,n){n&&(this.state.lastClientX=e.clientX,this.state.lastClientY=e.clientY,(n.isPoly()||n.is3d()||n.isCss3d())&&n.config.tooltip?.trigger==="hover"&&n.showTooltip(e.clientX,e.clientY))}__onClick(e,n){const r=this.__getTargetMarker(e.data.objects),l=this.__getTargetMarker(e.data.target,!0)||r;this.state.currentMarker&&this.state.currentMarker!==l&&(this.dispatchEvent(new S8(this.state.currentMarker)),this.viewer.panel.hide(C0),!this.state.showAllTooltips&&this.state.currentMarker.config.tooltip?.trigger==="click"&&this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null),l&&(this.state.currentMarker=l,this.dispatchEvent(new v8(l,n,e.data.rightclick)),this.config.clickEventOnMarker?e.data.marker=l:e.stopImmediatePropagation(),this.markers[l.id]&&!e.data.rightclick&&(l.config.tooltip?.trigger==="click"?l.tooltip?this.hideMarkerTooltip(l.id):this.showMarkerTooltip(l.id):this.showMarkerPanel(l.id)))}__afterChangeMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new P8(this.getMarkers()))}__refreshUi(){const e=Object.values(this.markers).filter(n=>!n.config.hideList).length;e===0?(this.viewer.panel.hide(C0),this.viewer.panel.hide(Cv)):this.viewer.panel.isVisible(Cv)?this.showMarkersList():this.viewer.panel.isVisible(C0)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),this.viewer.navbar.getButton(z_.id,!1)?.toggle(e>0),this.viewer.navbar.getButton(TS.id,!1)?.toggle(e>0)}__checkObjectsObserver(){Object.values(this.markers).some(n=>n.is3d())?this.viewer.observeObjects(ro):this.viewer.unobserveObjects(ro)}};Ex.id="markers";Ex.VERSION="5.13.4";Ex.configParser=E_e;Ex.readonlyOptions=["markers"];var P_e=Ex;Kd.lang[z_.id]="Markers";Kd.lang[TS.id]="Markers list";RI(z_,"caption:left");RI(TS,"caption:left");const Tm=[{id:"0",point:[-92.12572989672026,38.53421432713342]},{id:"1",point:[-92.12304341293509,38.53672723512331]},{id:"2",point:[-92.11945284530871,38.54133496582979]},{id:"3",point:[-92.11576785749503,38.54478606247235]},{id:"4",point:[-92.10778464530942,38.544770729312454]},{id:"5",point:[-92.10258732764407,38.541357585467786]},{id:"6",point:[-92.09670854574377,38.53854148846571]},{id:"7",point:[-92.09328790813723,38.53629576427041]},{id:"8",point:[-92.11176575050796,38.5479069429093]}],A_e={id:"marker-viewpoint",image:"map-icons/viewpoint.png",gps:[-92.102043,38.54042],size:{width:32,height:32}},I_e={id:"marker-photo-trophy",image:"map-icons/photo_sight_captured.png",gps:[-92.157874,38.578638],size:{width:32,height:32}},E0=[A_e,I_e],R_e=t=>e=>({width:8192,cols:16,rows:8,baseUrl:`${t}/${e}_thumb.jpg`,tileUrl:(n,r)=>`${t}/${e}_${n}_${r}.jpg`}),L_e=t=>{const e=i=>({id:`node-${i}`,panorama:t(i),gps:Tm[i].point}),n=(...i)=>i.map(l=>({nodeId:`node-${l}`}));return{positionMode:"gps",nodes:[{...e(0),links:n(1)},{...e(1),links:n(0,2)},{...e(2),links:n(1,3)},{...e(3),links:n(2,8)},{...e(4),links:n(8,5),markers:E0},{...e(5),links:n(4,6),markers:E0},{...e(6),links:n(5,7),markers:E0},{...e(7),links:n(6),markers:E0},{...e(8),links:n(3,4),markers:E0}]}},k_e=t=>{const e=G.useRef(null),n=G.useRef(null),r=G.useRef(null),i=R_e(t.pixelRootUrl),l=L_e(i),c=(y,_)=>mr(r.current).setRotation(_/Math.PI*180),s=({node:y})=>{const[_,w]=mr(y.gps),S=[_,w];mr(e.current).panTo(S),mr(r.current).setLngLat(S)},p=()=>{const y=mr(n.current);mr(y.getPlugin(u_)).addEventListener("node-changed",s)};return G.useEffect(()=>{document.title="ATS Street View Proof of Concept"}),ie.jsxs(ie.Fragment,{children:[ie.jsx(DI,{ref:n,adapter:U$,plugins:[u_.withConfig(l),P_e],src:i(0),height:"100vh",width:"100%",navbar:!1,moveInertia:.9,onPositionChange:c,onReady:p}),ie.jsx("div",{className:"credits",children:"Game data and images © SCS Software. Images captured by Trucker Mudgeon."}),ie.jsxs(sx,{ref:e,style:{position:"absolute",left:20,bottom:20,width:"250px",height:"125px",border:"2px solid black",borderRadius:8,zIndex:100},minZoom:4,maxZoom:15,maxBounds:[Tm[0].point.map(y=>y-1),Tm[0].point.map(y=>y+1)],mapStyle:cS,attributionControl:!1,initialViewState:{longitude:Tm[0].point[0],latitude:Tm[0].point[1],zoom:12},children:[ie.jsx(PA,{ref:r,longitude:Tm[0].point[0],latitude:Tm[0].point[1],rotationAlignment:"map",children:ie.jsx("div",{className:"street-view-marker"})}),ie.jsx(lS,{tileRootUrl:t.tileRootUrl,mode:"light"}),ie.jsx(ry,{tileRootUrl:t.tileRootUrl,game:"ats",mode:"light",enableIconAutoHide:!0,visibleIcons:Gm,dlcs:Hm})]})]})},Y1="https://maps.truckermudgeon.com",HO="https://pixels.truckermudgeon.com",D_e="halloween",z_e=KJ(EJ([ie.jsx(I0,{path:"/",element:ie.jsx(P0e,{tileRootUrl:Y1,pixelRootUrl:HO,specialEvent:D_e})}),ie.jsx(I0,{path:"routes",element:ie.jsx(V0e,{tileRootUrl:Y1})}),ie.jsx(I0,{path:"street-view",element:ie.jsx(k_e,{tileRootUrl:Y1,pixelRootUrl:HO})})].concat(Object.entries(iI).map(([t,e])=>ie.jsx(I0,{path:e.url,element:ie.jsx(Q0e,{tileRootUrl:Y1,specialEvent:t})}))))),O_e=I4({components:{JoyIconButton:{styleOverrides:{root:{backgroundColor:"var(--joy-palette-background-surface)"}}}}}),F_e=document.getElementById("root"),N_e=nK.createRoot(F_e);N_e.render(ie.jsx(G.StrictMode,{children:ie.jsxs(M7,{defaultMode:"system",modeStorageKey:"tm-mode",theme:O_e,children:[ie.jsx(ZX,{}),ie.jsx(uQ,{router:z_e})]})}))});export default B_e();
